var Fw=r=>{throw TypeError(r)};var Cm=(r,t,e)=>t.has(r)||Fw("Cannot "+e);var H=(r,t,e)=>(Cm(r,t,"read from private field"),e?e.call(r):t.get(r)),Fe=(r,t,e)=>t.has(r)?Fw("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(r):t.set(r,e),we=(r,t,e,n)=>(Cm(r,t,"write to private field"),n?n.call(r,e):t.set(r,e),e),Ye=(r,t,e)=>(Cm(r,t,"access private method"),e);var bh=(r,t,e,n)=>({set _(a){we(r,t,a,e)},get _(){return H(r,t,n)}});import{g as iS}from"./index-Bnzk24J4.js";var Rm={exports:{}},Zl={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Bw;function oD(){if(Bw)return Zl;Bw=1;var r=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function e(n,a,i){var s=null;if(i!==void 0&&(s=""+i),a.key!==void 0&&(s=""+a.key),"key"in a){i={};for(var l in a)l!=="key"&&(i[l]=a[l])}else i=a;return a=i.ref,{$$typeof:r,type:n,key:s,ref:a!==void 0?a:null,props:i}}return Zl.Fragment=t,Zl.jsx=e,Zl.jsxs=e,Zl}var Lw;function sD(){return Lw||(Lw=1,Rm.exports=oD()),Rm.exports}var uD=sD(),Tm={exports:{}},Ql={},Am={exports:{}},Dm={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Pw;function lD(){return Pw||(Pw=1,function(r){function t(U,G){var X=U.length;U.push(G);e:for(;0<X;){var J=X-1>>>1,F=U[J];if(0<a(F,G))U[J]=G,U[X]=F,X=J;else break e}}function e(U){return U.length===0?null:U[0]}function n(U){if(U.length===0)return null;var G=U[0],X=U.pop();if(X!==G){U[0]=X;e:for(var J=0,F=U.length,K=F>>>1;J<K;){var oe=2*(J+1)-1,ue=U[oe],pe=oe+1,ge=U[pe];if(0>a(ue,X))pe<F&&0>a(ge,ue)?(U[J]=ge,U[pe]=X,J=pe):(U[J]=ue,U[oe]=X,J=oe);else if(pe<F&&0>a(ge,X))U[J]=ge,U[pe]=X,J=pe;else break e}}return G}function a(U,G){var X=U.sortIndex-G.sortIndex;return X!==0?X:U.id-G.id}if(r.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var i=performance;r.unstable_now=function(){return i.now()}}else{var s=Date,l=s.now();r.unstable_now=function(){return s.now()-l}}var c=[],f=[],d=1,v=null,m=3,g=!1,b=!1,w=!1,_=!1,S=typeof setTimeout=="function"?setTimeout:null,E=typeof clearTimeout=="function"?clearTimeout:null,C=typeof setImmediate<"u"?setImmediate:null;function R(U){for(var G=e(f);G!==null;){if(G.callback===null)n(f);else if(G.startTime<=U)n(f),G.sortIndex=G.expirationTime,t(c,G);else break;G=e(f)}}function T(U){if(w=!1,R(U),!b)if(e(c)!==null)b=!0,D||(D=!0,P());else{var G=e(f);G!==null&&ee(T,G.startTime-U)}}var D=!1,k=-1,M=5,N=-1;function I(){return _?!0:!(r.unstable_now()-N<M)}function z(){if(_=!1,D){var U=r.unstable_now();N=U;var G=!0;try{e:{b=!1,w&&(w=!1,E(k),k=-1),g=!0;var X=m;try{t:{for(R(U),v=e(c);v!==null&&!(v.expirationTime>U&&I());){var J=v.callback;if(typeof J=="function"){v.callback=null,m=v.priorityLevel;var F=J(v.expirationTime<=U);if(U=r.unstable_now(),typeof F=="function"){v.callback=F,R(U),G=!0;break t}v===e(c)&&n(c),R(U)}else n(c);v=e(c)}if(v!==null)G=!0;else{var K=e(f);K!==null&&ee(T,K.startTime-U),G=!1}}break e}finally{v=null,m=X,g=!1}G=void 0}}finally{G?P():D=!1}}}var P;if(typeof C=="function")P=function(){C(z)};else if(typeof MessageChannel<"u"){var ne=new MessageChannel,re=ne.port2;ne.port1.onmessage=z,P=function(){re.postMessage(null)}}else P=function(){S(z,0)};function ee(U,G){k=S(function(){U(r.unstable_now())},G)}r.unstable_IdlePriority=5,r.unstable_ImmediatePriority=1,r.unstable_LowPriority=4,r.unstable_NormalPriority=3,r.unstable_Profiling=null,r.unstable_UserBlockingPriority=2,r.unstable_cancelCallback=function(U){U.callback=null},r.unstable_forceFrameRate=function(U){0>U||125<U?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):M=0<U?Math.floor(1e3/U):5},r.unstable_getCurrentPriorityLevel=function(){return m},r.unstable_next=function(U){switch(m){case 1:case 2:case 3:var G=3;break;default:G=m}var X=m;m=G;try{return U()}finally{m=X}},r.unstable_requestPaint=function(){_=!0},r.unstable_runWithPriority=function(U,G){switch(U){case 1:case 2:case 3:case 4:case 5:break;default:U=3}var X=m;m=U;try{return G()}finally{m=X}},r.unstable_scheduleCallback=function(U,G,X){var J=r.unstable_now();switch(typeof X=="object"&&X!==null?(X=X.delay,X=typeof X=="number"&&0<X?J+X:J):X=J,U){case 1:var F=-1;break;case 2:F=250;break;case 5:F=1073741823;break;case 4:F=1e4;break;default:F=5e3}return F=X+F,U={id:d++,callback:G,priorityLevel:U,startTime:X,expirationTime:F,sortIndex:-1},X>J?(U.sortIndex=X,t(f,U),e(c)===null&&U===e(f)&&(w?(E(k),k=-1):w=!0,ee(T,X-J))):(U.sortIndex=F,t(c,U),b||g||(b=!0,D||(D=!0,P()))),U},r.unstable_shouldYield=I,r.unstable_wrapCallback=function(U){var G=m;return function(){var X=m;m=G;try{return U.apply(this,arguments)}finally{m=X}}}}(Dm)),Dm}var zw;function cD(){return zw||(zw=1,Am.exports=lD()),Am.exports}var km={exports:{}},Xe={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Uw;function fD(){if(Uw)return Xe;Uw=1;var r=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),e=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),i=Symbol.for("react.consumer"),s=Symbol.for("react.context"),l=Symbol.for("react.forward_ref"),c=Symbol.for("react.suspense"),f=Symbol.for("react.memo"),d=Symbol.for("react.lazy"),v=Symbol.iterator;function m(F){return F===null||typeof F!="object"?null:(F=v&&F[v]||F["@@iterator"],typeof F=="function"?F:null)}var g={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},b=Object.assign,w={};function _(F,K,oe){this.props=F,this.context=K,this.refs=w,this.updater=oe||g}_.prototype.isReactComponent={},_.prototype.setState=function(F,K){if(typeof F!="object"&&typeof F!="function"&&F!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,F,K,"setState")},_.prototype.forceUpdate=function(F){this.updater.enqueueForceUpdate(this,F,"forceUpdate")};function S(){}S.prototype=_.prototype;function E(F,K,oe){this.props=F,this.context=K,this.refs=w,this.updater=oe||g}var C=E.prototype=new S;C.constructor=E,b(C,_.prototype),C.isPureReactComponent=!0;var R=Array.isArray,T={H:null,A:null,T:null,S:null,V:null},D=Object.prototype.hasOwnProperty;function k(F,K,oe,ue,pe,ge){return oe=ge.ref,{$$typeof:r,type:F,key:K,ref:oe!==void 0?oe:null,props:ge}}function M(F,K){return k(F.type,K,void 0,void 0,void 0,F.props)}function N(F){return typeof F=="object"&&F!==null&&F.$$typeof===r}function I(F){var K={"=":"=0",":":"=2"};return"$"+F.replace(/[=:]/g,function(oe){return K[oe]})}var z=/\/+/g;function P(F,K){return typeof F=="object"&&F!==null&&F.key!=null?I(""+F.key):K.toString(36)}function ne(){}function re(F){switch(F.status){case"fulfilled":return F.value;case"rejected":throw F.reason;default:switch(typeof F.status=="string"?F.then(ne,ne):(F.status="pending",F.then(function(K){F.status==="pending"&&(F.status="fulfilled",F.value=K)},function(K){F.status==="pending"&&(F.status="rejected",F.reason=K)})),F.status){case"fulfilled":return F.value;case"rejected":throw F.reason}}throw F}function ee(F,K,oe,ue,pe){var ge=typeof F;(ge==="undefined"||ge==="boolean")&&(F=null);var me=!1;if(F===null)me=!0;else switch(ge){case"bigint":case"string":case"number":me=!0;break;case"object":switch(F.$$typeof){case r:case t:me=!0;break;case d:return me=F._init,ee(me(F._payload),K,oe,ue,pe)}}if(me)return pe=pe(F),me=ue===""?"."+P(F,0):ue,R(pe)?(oe="",me!=null&&(oe=me.replace(z,"$&/")+"/"),ee(pe,K,oe,"",function(Ie){return Ie})):pe!=null&&(N(pe)&&(pe=M(pe,oe+(pe.key==null||F&&F.key===pe.key?"":(""+pe.key).replace(z,"$&/")+"/")+me)),K.push(pe)),1;me=0;var Ne=ue===""?".":ue+":";if(R(F))for(var xe=0;xe<F.length;xe++)ue=F[xe],ge=Ne+P(ue,xe),me+=ee(ue,K,oe,ge,pe);else if(xe=m(F),typeof xe=="function")for(F=xe.call(F),xe=0;!(ue=F.next()).done;)ue=ue.value,ge=Ne+P(ue,xe++),me+=ee(ue,K,oe,ge,pe);else if(ge==="object"){if(typeof F.then=="function")return ee(re(F),K,oe,ue,pe);throw K=String(F),Error("Objects are not valid as a React child (found: "+(K==="[object Object]"?"object with keys {"+Object.keys(F).join(", ")+"}":K)+"). If you meant to render a collection of children, use an array instead.")}return me}function U(F,K,oe){if(F==null)return F;var ue=[],pe=0;return ee(F,ue,"","",function(ge){return K.call(oe,ge,pe++)}),ue}function G(F){if(F._status===-1){var K=F._result;K=K(),K.then(function(oe){(F._status===0||F._status===-1)&&(F._status=1,F._result=oe)},function(oe){(F._status===0||F._status===-1)&&(F._status=2,F._result=oe)}),F._status===-1&&(F._status=0,F._result=K)}if(F._status===1)return F._result.default;throw F._result}var X=typeof reportError=="function"?reportError:function(F){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var K=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof F=="object"&&F!==null&&typeof F.message=="string"?String(F.message):String(F),error:F});if(!window.dispatchEvent(K))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",F);return}console.error(F)};function J(){}return Xe.Children={map:U,forEach:function(F,K,oe){U(F,function(){K.apply(this,arguments)},oe)},count:function(F){var K=0;return U(F,function(){K++}),K},toArray:function(F){return U(F,function(K){return K})||[]},only:function(F){if(!N(F))throw Error("React.Children.only expected to receive a single React element child.");return F}},Xe.Component=_,Xe.Fragment=e,Xe.Profiler=a,Xe.PureComponent=E,Xe.StrictMode=n,Xe.Suspense=c,Xe.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=T,Xe.__COMPILER_RUNTIME={__proto__:null,c:function(F){return T.H.useMemoCache(F)}},Xe.cache=function(F){return function(){return F.apply(null,arguments)}},Xe.cloneElement=function(F,K,oe){if(F==null)throw Error("The argument must be a React element, but you passed "+F+".");var ue=b({},F.props),pe=F.key,ge=void 0;if(K!=null)for(me in K.ref!==void 0&&(ge=void 0),K.key!==void 0&&(pe=""+K.key),K)!D.call(K,me)||me==="key"||me==="__self"||me==="__source"||me==="ref"&&K.ref===void 0||(ue[me]=K[me]);var me=arguments.length-2;if(me===1)ue.children=oe;else if(1<me){for(var Ne=Array(me),xe=0;xe<me;xe++)Ne[xe]=arguments[xe+2];ue.children=Ne}return k(F.type,pe,void 0,void 0,ge,ue)},Xe.createContext=function(F){return F={$$typeof:s,_currentValue:F,_currentValue2:F,_threadCount:0,Provider:null,Consumer:null},F.Provider=F,F.Consumer={$$typeof:i,_context:F},F},Xe.createElement=function(F,K,oe){var ue,pe={},ge=null;if(K!=null)for(ue in K.key!==void 0&&(ge=""+K.key),K)D.call(K,ue)&&ue!=="key"&&ue!=="__self"&&ue!=="__source"&&(pe[ue]=K[ue]);var me=arguments.length-2;if(me===1)pe.children=oe;else if(1<me){for(var Ne=Array(me),xe=0;xe<me;xe++)Ne[xe]=arguments[xe+2];pe.children=Ne}if(F&&F.defaultProps)for(ue in me=F.defaultProps,me)pe[ue]===void 0&&(pe[ue]=me[ue]);return k(F,ge,void 0,void 0,null,pe)},Xe.createRef=function(){return{current:null}},Xe.forwardRef=function(F){return{$$typeof:l,render:F}},Xe.isValidElement=N,Xe.lazy=function(F){return{$$typeof:d,_payload:{_status:-1,_result:F},_init:G}},Xe.memo=function(F,K){return{$$typeof:f,type:F,compare:K===void 0?null:K}},Xe.startTransition=function(F){var K=T.T,oe={};T.T=oe;try{var ue=F(),pe=T.S;pe!==null&&pe(oe,ue),typeof ue=="object"&&ue!==null&&typeof ue.then=="function"&&ue.then(J,X)}catch(ge){X(ge)}finally{T.T=K}},Xe.unstable_useCacheRefresh=function(){return T.H.useCacheRefresh()},Xe.use=function(F){return T.H.use(F)},Xe.useActionState=function(F,K,oe){return T.H.useActionState(F,K,oe)},Xe.useCallback=function(F,K){return T.H.useCallback(F,K)},Xe.useContext=function(F){return T.H.useContext(F)},Xe.useDebugValue=function(){},Xe.useDeferredValue=function(F,K){return T.H.useDeferredValue(F,K)},Xe.useEffect=function(F,K,oe){var ue=T.H;if(typeof oe=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return ue.useEffect(F,K)},Xe.useId=function(){return T.H.useId()},Xe.useImperativeHandle=function(F,K,oe){return T.H.useImperativeHandle(F,K,oe)},Xe.useInsertionEffect=function(F,K){return T.H.useInsertionEffect(F,K)},Xe.useLayoutEffect=function(F,K){return T.H.useLayoutEffect(F,K)},Xe.useMemo=function(F,K){return T.H.useMemo(F,K)},Xe.useOptimistic=function(F,K){return T.H.useOptimistic(F,K)},Xe.useReducer=function(F,K,oe){return T.H.useReducer(F,K,oe)},Xe.useRef=function(F){return T.H.useRef(F)},Xe.useState=function(F){return T.H.useState(F)},Xe.useSyncExternalStore=function(F,K,oe){return T.H.useSyncExternalStore(F,K,oe)},Xe.useTransition=function(){return T.H.useTransition()},Xe.version="19.1.0",Xe}var Vw;function Sy(){return Vw||(Vw=1,km.exports=fD()),km.exports}var Om={exports:{}},Tn={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Hw;function hD(){if(Hw)return Tn;Hw=1;var r=Sy();function t(c){var f="https://react.dev/errors/"+c;if(1<arguments.length){f+="?args[]="+encodeURIComponent(arguments[1]);for(var d=2;d<arguments.length;d++)f+="&args[]="+encodeURIComponent(arguments[d])}return"Minified React error #"+c+"; visit "+f+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function e(){}var n={d:{f:e,r:function(){throw Error(t(522))},D:e,C:e,L:e,m:e,X:e,S:e,M:e},p:0,findDOMNode:null},a=Symbol.for("react.portal");function i(c,f,d){var v=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:a,key:v==null?null:""+v,children:c,containerInfo:f,implementation:d}}var s=r.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function l(c,f){if(c==="font")return"";if(typeof f=="string")return f==="use-credentials"?f:""}return Tn.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=n,Tn.createPortal=function(c,f){var d=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!f||f.nodeType!==1&&f.nodeType!==9&&f.nodeType!==11)throw Error(t(299));return i(c,f,null,d)},Tn.flushSync=function(c){var f=s.T,d=n.p;try{if(s.T=null,n.p=2,c)return c()}finally{s.T=f,n.p=d,n.d.f()}},Tn.preconnect=function(c,f){typeof c=="string"&&(f?(f=f.crossOrigin,f=typeof f=="string"?f==="use-credentials"?f:"":void 0):f=null,n.d.C(c,f))},Tn.prefetchDNS=function(c){typeof c=="string"&&n.d.D(c)},Tn.preinit=function(c,f){if(typeof c=="string"&&f&&typeof f.as=="string"){var d=f.as,v=l(d,f.crossOrigin),m=typeof f.integrity=="string"?f.integrity:void 0,g=typeof f.fetchPriority=="string"?f.fetchPriority:void 0;d==="style"?n.d.S(c,typeof f.precedence=="string"?f.precedence:void 0,{crossOrigin:v,integrity:m,fetchPriority:g}):d==="script"&&n.d.X(c,{crossOrigin:v,integrity:m,fetchPriority:g,nonce:typeof f.nonce=="string"?f.nonce:void 0})}},Tn.preinitModule=function(c,f){if(typeof c=="string")if(typeof f=="object"&&f!==null){if(f.as==null||f.as==="script"){var d=l(f.as,f.crossOrigin);n.d.M(c,{crossOrigin:d,integrity:typeof f.integrity=="string"?f.integrity:void 0,nonce:typeof f.nonce=="string"?f.nonce:void 0})}}else f==null&&n.d.M(c)},Tn.preload=function(c,f){if(typeof c=="string"&&typeof f=="object"&&f!==null&&typeof f.as=="string"){var d=f.as,v=l(d,f.crossOrigin);n.d.L(c,d,{crossOrigin:v,integrity:typeof f.integrity=="string"?f.integrity:void 0,nonce:typeof f.nonce=="string"?f.nonce:void 0,type:typeof f.type=="string"?f.type:void 0,fetchPriority:typeof f.fetchPriority=="string"?f.fetchPriority:void 0,referrerPolicy:typeof f.referrerPolicy=="string"?f.referrerPolicy:void 0,imageSrcSet:typeof f.imageSrcSet=="string"?f.imageSrcSet:void 0,imageSizes:typeof f.imageSizes=="string"?f.imageSizes:void 0,media:typeof f.media=="string"?f.media:void 0})}},Tn.preloadModule=function(c,f){if(typeof c=="string")if(f){var d=l(f.as,f.crossOrigin);n.d.m(c,{as:typeof f.as=="string"&&f.as!=="script"?f.as:void 0,crossOrigin:d,integrity:typeof f.integrity=="string"?f.integrity:void 0})}else n.d.m(c)},Tn.requestFormReset=function(c){n.d.r(c)},Tn.unstable_batchedUpdates=function(c,f){return c(f)},Tn.useFormState=function(c,f,d){return s.H.useFormState(c,f,d)},Tn.useFormStatus=function(){return s.H.useHostTransitionStatus()},Tn.version="19.1.0",Tn}var jw;function dD(){if(jw)return Om.exports;jw=1;function r(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(r)}catch(t){console.error(t)}}return r(),Om.exports=hD(),Om.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ww;function pD(){if(Ww)return Ql;Ww=1;var r=cD(),t=Sy(),e=dD();function n(o){var u="https://react.dev/errors/"+o;if(1<arguments.length){u+="?args[]="+encodeURIComponent(arguments[1]);for(var h=2;h<arguments.length;h++)u+="&args[]="+encodeURIComponent(arguments[h])}return"Minified React error #"+o+"; visit "+u+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(o){return!(!o||o.nodeType!==1&&o.nodeType!==9&&o.nodeType!==11)}function i(o){var u=o,h=o;if(o.alternate)for(;u.return;)u=u.return;else{o=u;do u=o,(u.flags&4098)!==0&&(h=u.return),o=u.return;while(o)}return u.tag===3?h:null}function s(o){if(o.tag===13){var u=o.memoizedState;if(u===null&&(o=o.alternate,o!==null&&(u=o.memoizedState)),u!==null)return u.dehydrated}return null}function l(o){if(i(o)!==o)throw Error(n(188))}function c(o){var u=o.alternate;if(!u){if(u=i(o),u===null)throw Error(n(188));return u!==o?null:o}for(var h=o,p=u;;){var y=h.return;if(y===null)break;var x=y.alternate;if(x===null){if(p=y.return,p!==null){h=p;continue}break}if(y.child===x.child){for(x=y.child;x;){if(x===h)return l(y),o;if(x===p)return l(y),u;x=x.sibling}throw Error(n(188))}if(h.return!==p.return)h=y,p=x;else{for(var A=!1,O=y.child;O;){if(O===h){A=!0,h=y,p=x;break}if(O===p){A=!0,p=y,h=x;break}O=O.sibling}if(!A){for(O=x.child;O;){if(O===h){A=!0,h=x,p=y;break}if(O===p){A=!0,p=x,h=y;break}O=O.sibling}if(!A)throw Error(n(189))}}if(h.alternate!==p)throw Error(n(190))}if(h.tag!==3)throw Error(n(188));return h.stateNode.current===h?o:u}function f(o){var u=o.tag;if(u===5||u===26||u===27||u===6)return o;for(o=o.child;o!==null;){if(u=f(o),u!==null)return u;o=o.sibling}return null}var d=Object.assign,v=Symbol.for("react.element"),m=Symbol.for("react.transitional.element"),g=Symbol.for("react.portal"),b=Symbol.for("react.fragment"),w=Symbol.for("react.strict_mode"),_=Symbol.for("react.profiler"),S=Symbol.for("react.provider"),E=Symbol.for("react.consumer"),C=Symbol.for("react.context"),R=Symbol.for("react.forward_ref"),T=Symbol.for("react.suspense"),D=Symbol.for("react.suspense_list"),k=Symbol.for("react.memo"),M=Symbol.for("react.lazy"),N=Symbol.for("react.activity"),I=Symbol.for("react.memo_cache_sentinel"),z=Symbol.iterator;function P(o){return o===null||typeof o!="object"?null:(o=z&&o[z]||o["@@iterator"],typeof o=="function"?o:null)}var ne=Symbol.for("react.client.reference");function re(o){if(o==null)return null;if(typeof o=="function")return o.$$typeof===ne?null:o.displayName||o.name||null;if(typeof o=="string")return o;switch(o){case b:return"Fragment";case _:return"Profiler";case w:return"StrictMode";case T:return"Suspense";case D:return"SuspenseList";case N:return"Activity"}if(typeof o=="object")switch(o.$$typeof){case g:return"Portal";case C:return(o.displayName||"Context")+".Provider";case E:return(o._context.displayName||"Context")+".Consumer";case R:var u=o.render;return o=o.displayName,o||(o=u.displayName||u.name||"",o=o!==""?"ForwardRef("+o+")":"ForwardRef"),o;case k:return u=o.displayName||null,u!==null?u:re(o.type)||"Memo";case M:u=o._payload,o=o._init;try{return re(o(u))}catch{}}return null}var ee=Array.isArray,U=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,G=e.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,X={pending:!1,data:null,method:null,action:null},J=[],F=-1;function K(o){return{current:o}}function oe(o){0>F||(o.current=J[F],J[F]=null,F--)}function ue(o,u){F++,J[F]=o.current,o.current=u}var pe=K(null),ge=K(null),me=K(null),Ne=K(null);function xe(o,u){switch(ue(me,u),ue(ge,o),ue(pe,null),u.nodeType){case 9:case 11:o=(o=u.documentElement)&&(o=o.namespaceURI)?lw(o):0;break;default:if(o=u.tagName,u=u.namespaceURI)u=lw(u),o=cw(u,o);else switch(o){case"svg":o=1;break;case"math":o=2;break;default:o=0}}oe(pe),ue(pe,o)}function Ie(){oe(pe),oe(ge),oe(me)}function ct(o){o.memoizedState!==null&&ue(Ne,o);var u=pe.current,h=cw(u,o.type);u!==h&&(ue(ge,o),ue(pe,h))}function Pe(o){ge.current===o&&(oe(pe),oe(ge)),Ne.current===o&&(oe(Ne),ql._currentValue=X)}var qe=Object.prototype.hasOwnProperty,Je=r.unstable_scheduleCallback,dt=r.unstable_cancelCallback,Et=r.unstable_shouldYield,xt=r.unstable_requestPaint,Vt=r.unstable_now,gr=r.unstable_getCurrentPriorityLevel,En=r.unstable_ImmediatePriority,ka=r.unstable_UserBlockingPriority,Vn=r.unstable_NormalPriority,ea=r.unstable_LowPriority,yr=r.unstable_IdlePriority,pi=r.log,Br=r.unstable_setDisableYieldValue,Oa=null,Gt=null;function Yt(o){if(typeof pi=="function"&&Br(o),Gt&&typeof Gt.setStrictMode=="function")try{Gt.setStrictMode(Oa,o)}catch{}}var gn=Math.clz32?Math.clz32:dp,fp=Math.log,hp=Math.LN2;function dp(o){return o>>>=0,o===0?32:31-(fp(o)/hp|0)|0}var vi=256,mi=4194304;function Lr(o){var u=o&42;if(u!==0)return u;switch(o&-o){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return o&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return o}}function uf(o,u,h){var p=o.pendingLanes;if(p===0)return 0;var y=0,x=o.suspendedLanes,A=o.pingedLanes;o=o.warmLanes;var O=p&134217727;return O!==0?(p=O&~x,p!==0?y=Lr(p):(A&=O,A!==0?y=Lr(A):h||(h=O&~o,h!==0&&(y=Lr(h))))):(O=p&~x,O!==0?y=Lr(O):A!==0?y=Lr(A):h||(h=p&~o,h!==0&&(y=Lr(h)))),y===0?0:u!==0&&u!==y&&(u&x)===0&&(x=y&-y,h=u&-u,x>=h||x===32&&(h&4194048)!==0)?u:y}function tl(o,u){return(o.pendingLanes&~(o.suspendedLanes&~o.pingedLanes)&u)===0}function KR(o,u){switch(o){case 1:case 2:case 4:case 8:case 64:return u+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return u+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function q0(){var o=vi;return vi<<=1,(vi&4194048)===0&&(vi=256),o}function K0(){var o=mi;return mi<<=1,(mi&62914560)===0&&(mi=4194304),o}function pp(o){for(var u=[],h=0;31>h;h++)u.push(o);return u}function nl(o,u){o.pendingLanes|=u,u!==268435456&&(o.suspendedLanes=0,o.pingedLanes=0,o.warmLanes=0)}function XR(o,u,h,p,y,x){var A=o.pendingLanes;o.pendingLanes=h,o.suspendedLanes=0,o.pingedLanes=0,o.warmLanes=0,o.expiredLanes&=h,o.entangledLanes&=h,o.errorRecoveryDisabledLanes&=h,o.shellSuspendCounter=0;var O=o.entanglements,V=o.expirationTimes,Q=o.hiddenUpdates;for(h=A&~h;0<h;){var ce=31-gn(h),he=1<<ce;O[ce]=0,V[ce]=-1;var te=Q[ce];if(te!==null)for(Q[ce]=null,ce=0;ce<te.length;ce++){var ae=te[ce];ae!==null&&(ae.lane&=-536870913)}h&=~he}p!==0&&X0(o,p,0),x!==0&&y===0&&o.tag!==0&&(o.suspendedLanes|=x&~(A&~u))}function X0(o,u,h){o.pendingLanes|=u,o.suspendedLanes&=~u;var p=31-gn(u);o.entangledLanes|=u,o.entanglements[p]=o.entanglements[p]|1073741824|h&4194090}function $0(o,u){var h=o.entangledLanes|=u;for(o=o.entanglements;h;){var p=31-gn(h),y=1<<p;y&u|o[p]&u&&(o[p]|=u),h&=~y}}function vp(o){switch(o){case 2:o=1;break;case 8:o=4;break;case 32:o=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:o=128;break;case 268435456:o=134217728;break;default:o=0}return o}function mp(o){return o&=-o,2<o?8<o?(o&134217727)!==0?32:268435456:8:2}function Y0(){var o=G.p;return o!==0?o:(o=window.event,o===void 0?32:Dw(o.type))}function $R(o,u){var h=G.p;try{return G.p=o,u()}finally{G.p=h}}var gi=Math.random().toString(36).slice(2),Cn="__reactFiber$"+gi,Hn="__reactProps$"+gi,ps="__reactContainer$"+gi,gp="__reactEvents$"+gi,YR="__reactListeners$"+gi,ZR="__reactHandles$"+gi,Z0="__reactResources$"+gi,rl="__reactMarker$"+gi;function yp(o){delete o[Cn],delete o[Hn],delete o[gp],delete o[YR],delete o[ZR]}function vs(o){var u=o[Cn];if(u)return u;for(var h=o.parentNode;h;){if(u=h[ps]||h[Cn]){if(h=u.alternate,u.child!==null||h!==null&&h.child!==null)for(o=pw(o);o!==null;){if(h=o[Cn])return h;o=pw(o)}return u}o=h,h=o.parentNode}return null}function ms(o){if(o=o[Cn]||o[ps]){var u=o.tag;if(u===5||u===6||u===13||u===26||u===27||u===3)return o}return null}function al(o){var u=o.tag;if(u===5||u===26||u===27||u===6)return o.stateNode;throw Error(n(33))}function gs(o){var u=o[Z0];return u||(u=o[Z0]={hoistableStyles:new Map,hoistableScripts:new Map}),u}function un(o){o[rl]=!0}var Q0=new Set,J0={};function bo(o,u){ys(o,u),ys(o+"Capture",u)}function ys(o,u){for(J0[o]=u,o=0;o<u.length;o++)Q0.add(u[o])}var QR=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),eb={},tb={};function JR(o){return qe.call(tb,o)?!0:qe.call(eb,o)?!1:QR.test(o)?tb[o]=!0:(eb[o]=!0,!1)}function lf(o,u,h){if(JR(u))if(h===null)o.removeAttribute(u);else{switch(typeof h){case"undefined":case"function":case"symbol":o.removeAttribute(u);return;case"boolean":var p=u.toLowerCase().slice(0,5);if(p!=="data-"&&p!=="aria-"){o.removeAttribute(u);return}}o.setAttribute(u,""+h)}}function cf(o,u,h){if(h===null)o.removeAttribute(u);else{switch(typeof h){case"undefined":case"function":case"symbol":case"boolean":o.removeAttribute(u);return}o.setAttribute(u,""+h)}}function Na(o,u,h,p){if(p===null)o.removeAttribute(h);else{switch(typeof p){case"undefined":case"function":case"symbol":case"boolean":o.removeAttribute(h);return}o.setAttributeNS(u,h,""+p)}}var bp,nb;function bs(o){if(bp===void 0)try{throw Error()}catch(h){var u=h.stack.trim().match(/\n( *(at )?)/);bp=u&&u[1]||"",nb=-1<h.stack.indexOf(`
    at`)?" (<anonymous>)":-1<h.stack.indexOf("@")?"@unknown:0:0":""}return`
`+bp+o+nb}var xp=!1;function wp(o,u){if(!o||xp)return"";xp=!0;var h=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var p={DetermineComponentFrameRoot:function(){try{if(u){var he=function(){throw Error()};if(Object.defineProperty(he.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(he,[])}catch(ae){var te=ae}Reflect.construct(o,[],he)}else{try{he.call()}catch(ae){te=ae}o.call(he.prototype)}}else{try{throw Error()}catch(ae){te=ae}(he=o())&&typeof he.catch=="function"&&he.catch(function(){})}}catch(ae){if(ae&&te&&typeof ae.stack=="string")return[ae.stack,te.stack]}return[null,null]}};p.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var y=Object.getOwnPropertyDescriptor(p.DetermineComponentFrameRoot,"name");y&&y.configurable&&Object.defineProperty(p.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var x=p.DetermineComponentFrameRoot(),A=x[0],O=x[1];if(A&&O){var V=A.split(`
`),Q=O.split(`
`);for(y=p=0;p<V.length&&!V[p].includes("DetermineComponentFrameRoot");)p++;for(;y<Q.length&&!Q[y].includes("DetermineComponentFrameRoot");)y++;if(p===V.length||y===Q.length)for(p=V.length-1,y=Q.length-1;1<=p&&0<=y&&V[p]!==Q[y];)y--;for(;1<=p&&0<=y;p--,y--)if(V[p]!==Q[y]){if(p!==1||y!==1)do if(p--,y--,0>y||V[p]!==Q[y]){var ce=`
`+V[p].replace(" at new "," at ");return o.displayName&&ce.includes("<anonymous>")&&(ce=ce.replace("<anonymous>",o.displayName)),ce}while(1<=p&&0<=y);break}}}finally{xp=!1,Error.prepareStackTrace=h}return(h=o?o.displayName||o.name:"")?bs(h):""}function eT(o){switch(o.tag){case 26:case 27:case 5:return bs(o.type);case 16:return bs("Lazy");case 13:return bs("Suspense");case 19:return bs("SuspenseList");case 0:case 15:return wp(o.type,!1);case 11:return wp(o.type.render,!1);case 1:return wp(o.type,!0);case 31:return bs("Activity");default:return""}}function rb(o){try{var u="";do u+=eT(o),o=o.return;while(o);return u}catch(h){return`
Error generating stack: `+h.message+`
`+h.stack}}function br(o){switch(typeof o){case"bigint":case"boolean":case"number":case"string":case"undefined":return o;case"object":return o;default:return""}}function ab(o){var u=o.type;return(o=o.nodeName)&&o.toLowerCase()==="input"&&(u==="checkbox"||u==="radio")}function tT(o){var u=ab(o)?"checked":"value",h=Object.getOwnPropertyDescriptor(o.constructor.prototype,u),p=""+o[u];if(!o.hasOwnProperty(u)&&typeof h<"u"&&typeof h.get=="function"&&typeof h.set=="function"){var y=h.get,x=h.set;return Object.defineProperty(o,u,{configurable:!0,get:function(){return y.call(this)},set:function(A){p=""+A,x.call(this,A)}}),Object.defineProperty(o,u,{enumerable:h.enumerable}),{getValue:function(){return p},setValue:function(A){p=""+A},stopTracking:function(){o._valueTracker=null,delete o[u]}}}}function ff(o){o._valueTracker||(o._valueTracker=tT(o))}function ib(o){if(!o)return!1;var u=o._valueTracker;if(!u)return!0;var h=u.getValue(),p="";return o&&(p=ab(o)?o.checked?"true":"false":o.value),o=p,o!==h?(u.setValue(o),!0):!1}function hf(o){if(o=o||(typeof document<"u"?document:void 0),typeof o>"u")return null;try{return o.activeElement||o.body}catch{return o.body}}var nT=/[\n"\\]/g;function xr(o){return o.replace(nT,function(u){return"\\"+u.charCodeAt(0).toString(16)+" "})}function _p(o,u,h,p,y,x,A,O){o.name="",A!=null&&typeof A!="function"&&typeof A!="symbol"&&typeof A!="boolean"?o.type=A:o.removeAttribute("type"),u!=null?A==="number"?(u===0&&o.value===""||o.value!=u)&&(o.value=""+br(u)):o.value!==""+br(u)&&(o.value=""+br(u)):A!=="submit"&&A!=="reset"||o.removeAttribute("value"),u!=null?Sp(o,A,br(u)):h!=null?Sp(o,A,br(h)):p!=null&&o.removeAttribute("value"),y==null&&x!=null&&(o.defaultChecked=!!x),y!=null&&(o.checked=y&&typeof y!="function"&&typeof y!="symbol"),O!=null&&typeof O!="function"&&typeof O!="symbol"&&typeof O!="boolean"?o.name=""+br(O):o.removeAttribute("name")}function ob(o,u,h,p,y,x,A,O){if(x!=null&&typeof x!="function"&&typeof x!="symbol"&&typeof x!="boolean"&&(o.type=x),u!=null||h!=null){if(!(x!=="submit"&&x!=="reset"||u!=null))return;h=h!=null?""+br(h):"",u=u!=null?""+br(u):h,O||u===o.value||(o.value=u),o.defaultValue=u}p=p??y,p=typeof p!="function"&&typeof p!="symbol"&&!!p,o.checked=O?o.checked:!!p,o.defaultChecked=!!p,A!=null&&typeof A!="function"&&typeof A!="symbol"&&typeof A!="boolean"&&(o.name=A)}function Sp(o,u,h){u==="number"&&hf(o.ownerDocument)===o||o.defaultValue===""+h||(o.defaultValue=""+h)}function xs(o,u,h,p){if(o=o.options,u){u={};for(var y=0;y<h.length;y++)u["$"+h[y]]=!0;for(h=0;h<o.length;h++)y=u.hasOwnProperty("$"+o[h].value),o[h].selected!==y&&(o[h].selected=y),y&&p&&(o[h].defaultSelected=!0)}else{for(h=""+br(h),u=null,y=0;y<o.length;y++){if(o[y].value===h){o[y].selected=!0,p&&(o[y].defaultSelected=!0);return}u!==null||o[y].disabled||(u=o[y])}u!==null&&(u.selected=!0)}}function sb(o,u,h){if(u!=null&&(u=""+br(u),u!==o.value&&(o.value=u),h==null)){o.defaultValue!==u&&(o.defaultValue=u);return}o.defaultValue=h!=null?""+br(h):""}function ub(o,u,h,p){if(u==null){if(p!=null){if(h!=null)throw Error(n(92));if(ee(p)){if(1<p.length)throw Error(n(93));p=p[0]}h=p}h==null&&(h=""),u=h}h=br(u),o.defaultValue=h,p=o.textContent,p===h&&p!==""&&p!==null&&(o.value=p)}function ws(o,u){if(u){var h=o.firstChild;if(h&&h===o.lastChild&&h.nodeType===3){h.nodeValue=u;return}}o.textContent=u}var rT=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function lb(o,u,h){var p=u.indexOf("--")===0;h==null||typeof h=="boolean"||h===""?p?o.setProperty(u,""):u==="float"?o.cssFloat="":o[u]="":p?o.setProperty(u,h):typeof h!="number"||h===0||rT.has(u)?u==="float"?o.cssFloat=h:o[u]=(""+h).trim():o[u]=h+"px"}function cb(o,u,h){if(u!=null&&typeof u!="object")throw Error(n(62));if(o=o.style,h!=null){for(var p in h)!h.hasOwnProperty(p)||u!=null&&u.hasOwnProperty(p)||(p.indexOf("--")===0?o.setProperty(p,""):p==="float"?o.cssFloat="":o[p]="");for(var y in u)p=u[y],u.hasOwnProperty(y)&&h[y]!==p&&lb(o,y,p)}else for(var x in u)u.hasOwnProperty(x)&&lb(o,x,u[x])}function Ep(o){if(o.indexOf("-")===-1)return!1;switch(o){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var aT=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),iT=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function df(o){return iT.test(""+o)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":o}var Cp=null;function Rp(o){return o=o.target||o.srcElement||window,o.correspondingUseElement&&(o=o.correspondingUseElement),o.nodeType===3?o.parentNode:o}var _s=null,Ss=null;function fb(o){var u=ms(o);if(u&&(o=u.stateNode)){var h=o[Hn]||null;e:switch(o=u.stateNode,u.type){case"input":if(_p(o,h.value,h.defaultValue,h.defaultValue,h.checked,h.defaultChecked,h.type,h.name),u=h.name,h.type==="radio"&&u!=null){for(h=o;h.parentNode;)h=h.parentNode;for(h=h.querySelectorAll('input[name="'+xr(""+u)+'"][type="radio"]'),u=0;u<h.length;u++){var p=h[u];if(p!==o&&p.form===o.form){var y=p[Hn]||null;if(!y)throw Error(n(90));_p(p,y.value,y.defaultValue,y.defaultValue,y.checked,y.defaultChecked,y.type,y.name)}}for(u=0;u<h.length;u++)p=h[u],p.form===o.form&&ib(p)}break e;case"textarea":sb(o,h.value,h.defaultValue);break e;case"select":u=h.value,u!=null&&xs(o,!!h.multiple,u,!1)}}}var Tp=!1;function hb(o,u,h){if(Tp)return o(u,h);Tp=!0;try{var p=o(u);return p}finally{if(Tp=!1,(_s!==null||Ss!==null)&&(Qf(),_s&&(u=_s,o=Ss,Ss=_s=null,fb(u),o)))for(u=0;u<o.length;u++)fb(o[u])}}function il(o,u){var h=o.stateNode;if(h===null)return null;var p=h[Hn]||null;if(p===null)return null;h=p[u];e:switch(u){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(p=!p.disabled)||(o=o.type,p=!(o==="button"||o==="input"||o==="select"||o==="textarea")),o=!p;break e;default:o=!1}if(o)return null;if(h&&typeof h!="function")throw Error(n(231,u,typeof h));return h}var Ma=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Ap=!1;if(Ma)try{var ol={};Object.defineProperty(ol,"passive",{get:function(){Ap=!0}}),window.addEventListener("test",ol,ol),window.removeEventListener("test",ol,ol)}catch{Ap=!1}var yi=null,Dp=null,pf=null;function db(){if(pf)return pf;var o,u=Dp,h=u.length,p,y="value"in yi?yi.value:yi.textContent,x=y.length;for(o=0;o<h&&u[o]===y[o];o++);var A=h-o;for(p=1;p<=A&&u[h-p]===y[x-p];p++);return pf=y.slice(o,1<p?1-p:void 0)}function vf(o){var u=o.keyCode;return"charCode"in o?(o=o.charCode,o===0&&u===13&&(o=13)):o=u,o===10&&(o=13),32<=o||o===13?o:0}function mf(){return!0}function pb(){return!1}function jn(o){function u(h,p,y,x,A){this._reactName=h,this._targetInst=y,this.type=p,this.nativeEvent=x,this.target=A,this.currentTarget=null;for(var O in o)o.hasOwnProperty(O)&&(h=o[O],this[O]=h?h(x):x[O]);return this.isDefaultPrevented=(x.defaultPrevented!=null?x.defaultPrevented:x.returnValue===!1)?mf:pb,this.isPropagationStopped=pb,this}return d(u.prototype,{preventDefault:function(){this.defaultPrevented=!0;var h=this.nativeEvent;h&&(h.preventDefault?h.preventDefault():typeof h.returnValue!="unknown"&&(h.returnValue=!1),this.isDefaultPrevented=mf)},stopPropagation:function(){var h=this.nativeEvent;h&&(h.stopPropagation?h.stopPropagation():typeof h.cancelBubble!="unknown"&&(h.cancelBubble=!0),this.isPropagationStopped=mf)},persist:function(){},isPersistent:mf}),u}var xo={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(o){return o.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},gf=jn(xo),sl=d({},xo,{view:0,detail:0}),oT=jn(sl),kp,Op,ul,yf=d({},sl,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Mp,button:0,buttons:0,relatedTarget:function(o){return o.relatedTarget===void 0?o.fromElement===o.srcElement?o.toElement:o.fromElement:o.relatedTarget},movementX:function(o){return"movementX"in o?o.movementX:(o!==ul&&(ul&&o.type==="mousemove"?(kp=o.screenX-ul.screenX,Op=o.screenY-ul.screenY):Op=kp=0,ul=o),kp)},movementY:function(o){return"movementY"in o?o.movementY:Op}}),vb=jn(yf),sT=d({},yf,{dataTransfer:0}),uT=jn(sT),lT=d({},sl,{relatedTarget:0}),Np=jn(lT),cT=d({},xo,{animationName:0,elapsedTime:0,pseudoElement:0}),fT=jn(cT),hT=d({},xo,{clipboardData:function(o){return"clipboardData"in o?o.clipboardData:window.clipboardData}}),dT=jn(hT),pT=d({},xo,{data:0}),mb=jn(pT),vT={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},mT={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},gT={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function yT(o){var u=this.nativeEvent;return u.getModifierState?u.getModifierState(o):(o=gT[o])?!!u[o]:!1}function Mp(){return yT}var bT=d({},sl,{key:function(o){if(o.key){var u=vT[o.key]||o.key;if(u!=="Unidentified")return u}return o.type==="keypress"?(o=vf(o),o===13?"Enter":String.fromCharCode(o)):o.type==="keydown"||o.type==="keyup"?mT[o.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Mp,charCode:function(o){return o.type==="keypress"?vf(o):0},keyCode:function(o){return o.type==="keydown"||o.type==="keyup"?o.keyCode:0},which:function(o){return o.type==="keypress"?vf(o):o.type==="keydown"||o.type==="keyup"?o.keyCode:0}}),xT=jn(bT),wT=d({},yf,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),gb=jn(wT),_T=d({},sl,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Mp}),ST=jn(_T),ET=d({},xo,{propertyName:0,elapsedTime:0,pseudoElement:0}),CT=jn(ET),RT=d({},yf,{deltaX:function(o){return"deltaX"in o?o.deltaX:"wheelDeltaX"in o?-o.wheelDeltaX:0},deltaY:function(o){return"deltaY"in o?o.deltaY:"wheelDeltaY"in o?-o.wheelDeltaY:"wheelDelta"in o?-o.wheelDelta:0},deltaZ:0,deltaMode:0}),TT=jn(RT),AT=d({},xo,{newState:0,oldState:0}),DT=jn(AT),kT=[9,13,27,32],Ip=Ma&&"CompositionEvent"in window,ll=null;Ma&&"documentMode"in document&&(ll=document.documentMode);var OT=Ma&&"TextEvent"in window&&!ll,yb=Ma&&(!Ip||ll&&8<ll&&11>=ll),bb=" ",xb=!1;function wb(o,u){switch(o){case"keyup":return kT.indexOf(u.keyCode)!==-1;case"keydown":return u.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function _b(o){return o=o.detail,typeof o=="object"&&"data"in o?o.data:null}var Es=!1;function NT(o,u){switch(o){case"compositionend":return _b(u);case"keypress":return u.which!==32?null:(xb=!0,bb);case"textInput":return o=u.data,o===bb&&xb?null:o;default:return null}}function MT(o,u){if(Es)return o==="compositionend"||!Ip&&wb(o,u)?(o=db(),pf=Dp=yi=null,Es=!1,o):null;switch(o){case"paste":return null;case"keypress":if(!(u.ctrlKey||u.altKey||u.metaKey)||u.ctrlKey&&u.altKey){if(u.char&&1<u.char.length)return u.char;if(u.which)return String.fromCharCode(u.which)}return null;case"compositionend":return yb&&u.locale!=="ko"?null:u.data;default:return null}}var IT={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Sb(o){var u=o&&o.nodeName&&o.nodeName.toLowerCase();return u==="input"?!!IT[o.type]:u==="textarea"}function Eb(o,u,h,p){_s?Ss?Ss.push(p):Ss=[p]:_s=p,u=ah(u,"onChange"),0<u.length&&(h=new gf("onChange","change",null,h,p),o.push({event:h,listeners:u}))}var cl=null,fl=null;function FT(o){aw(o,0)}function bf(o){var u=al(o);if(ib(u))return o}function Cb(o,u){if(o==="change")return u}var Rb=!1;if(Ma){var Fp;if(Ma){var Bp="oninput"in document;if(!Bp){var Tb=document.createElement("div");Tb.setAttribute("oninput","return;"),Bp=typeof Tb.oninput=="function"}Fp=Bp}else Fp=!1;Rb=Fp&&(!document.documentMode||9<document.documentMode)}function Ab(){cl&&(cl.detachEvent("onpropertychange",Db),fl=cl=null)}function Db(o){if(o.propertyName==="value"&&bf(fl)){var u=[];Eb(u,fl,o,Rp(o)),hb(FT,u)}}function BT(o,u,h){o==="focusin"?(Ab(),cl=u,fl=h,cl.attachEvent("onpropertychange",Db)):o==="focusout"&&Ab()}function LT(o){if(o==="selectionchange"||o==="keyup"||o==="keydown")return bf(fl)}function PT(o,u){if(o==="click")return bf(u)}function zT(o,u){if(o==="input"||o==="change")return bf(u)}function UT(o,u){return o===u&&(o!==0||1/o===1/u)||o!==o&&u!==u}var tr=typeof Object.is=="function"?Object.is:UT;function hl(o,u){if(tr(o,u))return!0;if(typeof o!="object"||o===null||typeof u!="object"||u===null)return!1;var h=Object.keys(o),p=Object.keys(u);if(h.length!==p.length)return!1;for(p=0;p<h.length;p++){var y=h[p];if(!qe.call(u,y)||!tr(o[y],u[y]))return!1}return!0}function kb(o){for(;o&&o.firstChild;)o=o.firstChild;return o}function Ob(o,u){var h=kb(o);o=0;for(var p;h;){if(h.nodeType===3){if(p=o+h.textContent.length,o<=u&&p>=u)return{node:h,offset:u-o};o=p}e:{for(;h;){if(h.nextSibling){h=h.nextSibling;break e}h=h.parentNode}h=void 0}h=kb(h)}}function Nb(o,u){return o&&u?o===u?!0:o&&o.nodeType===3?!1:u&&u.nodeType===3?Nb(o,u.parentNode):"contains"in o?o.contains(u):o.compareDocumentPosition?!!(o.compareDocumentPosition(u)&16):!1:!1}function Mb(o){o=o!=null&&o.ownerDocument!=null&&o.ownerDocument.defaultView!=null?o.ownerDocument.defaultView:window;for(var u=hf(o.document);u instanceof o.HTMLIFrameElement;){try{var h=typeof u.contentWindow.location.href=="string"}catch{h=!1}if(h)o=u.contentWindow;else break;u=hf(o.document)}return u}function Lp(o){var u=o&&o.nodeName&&o.nodeName.toLowerCase();return u&&(u==="input"&&(o.type==="text"||o.type==="search"||o.type==="tel"||o.type==="url"||o.type==="password")||u==="textarea"||o.contentEditable==="true")}var VT=Ma&&"documentMode"in document&&11>=document.documentMode,Cs=null,Pp=null,dl=null,zp=!1;function Ib(o,u,h){var p=h.window===h?h.document:h.nodeType===9?h:h.ownerDocument;zp||Cs==null||Cs!==hf(p)||(p=Cs,"selectionStart"in p&&Lp(p)?p={start:p.selectionStart,end:p.selectionEnd}:(p=(p.ownerDocument&&p.ownerDocument.defaultView||window).getSelection(),p={anchorNode:p.anchorNode,anchorOffset:p.anchorOffset,focusNode:p.focusNode,focusOffset:p.focusOffset}),dl&&hl(dl,p)||(dl=p,p=ah(Pp,"onSelect"),0<p.length&&(u=new gf("onSelect","select",null,u,h),o.push({event:u,listeners:p}),u.target=Cs)))}function wo(o,u){var h={};return h[o.toLowerCase()]=u.toLowerCase(),h["Webkit"+o]="webkit"+u,h["Moz"+o]="moz"+u,h}var Rs={animationend:wo("Animation","AnimationEnd"),animationiteration:wo("Animation","AnimationIteration"),animationstart:wo("Animation","AnimationStart"),transitionrun:wo("Transition","TransitionRun"),transitionstart:wo("Transition","TransitionStart"),transitioncancel:wo("Transition","TransitionCancel"),transitionend:wo("Transition","TransitionEnd")},Up={},Fb={};Ma&&(Fb=document.createElement("div").style,"AnimationEvent"in window||(delete Rs.animationend.animation,delete Rs.animationiteration.animation,delete Rs.animationstart.animation),"TransitionEvent"in window||delete Rs.transitionend.transition);function _o(o){if(Up[o])return Up[o];if(!Rs[o])return o;var u=Rs[o],h;for(h in u)if(u.hasOwnProperty(h)&&h in Fb)return Up[o]=u[h];return o}var Bb=_o("animationend"),Lb=_o("animationiteration"),Pb=_o("animationstart"),HT=_o("transitionrun"),jT=_o("transitionstart"),WT=_o("transitioncancel"),zb=_o("transitionend"),Ub=new Map,Vp="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Vp.push("scrollEnd");function Pr(o,u){Ub.set(o,u),bo(u,[o])}var Vb=new WeakMap;function wr(o,u){if(typeof o=="object"&&o!==null){var h=Vb.get(o);return h!==void 0?h:(u={value:o,source:u,stack:rb(u)},Vb.set(o,u),u)}return{value:o,source:u,stack:rb(u)}}var _r=[],Ts=0,Hp=0;function xf(){for(var o=Ts,u=Hp=Ts=0;u<o;){var h=_r[u];_r[u++]=null;var p=_r[u];_r[u++]=null;var y=_r[u];_r[u++]=null;var x=_r[u];if(_r[u++]=null,p!==null&&y!==null){var A=p.pending;A===null?y.next=y:(y.next=A.next,A.next=y),p.pending=y}x!==0&&Hb(h,y,x)}}function wf(o,u,h,p){_r[Ts++]=o,_r[Ts++]=u,_r[Ts++]=h,_r[Ts++]=p,Hp|=p,o.lanes|=p,o=o.alternate,o!==null&&(o.lanes|=p)}function jp(o,u,h,p){return wf(o,u,h,p),_f(o)}function As(o,u){return wf(o,null,null,u),_f(o)}function Hb(o,u,h){o.lanes|=h;var p=o.alternate;p!==null&&(p.lanes|=h);for(var y=!1,x=o.return;x!==null;)x.childLanes|=h,p=x.alternate,p!==null&&(p.childLanes|=h),x.tag===22&&(o=x.stateNode,o===null||o._visibility&1||(y=!0)),o=x,x=x.return;return o.tag===3?(x=o.stateNode,y&&u!==null&&(y=31-gn(h),o=x.hiddenUpdates,p=o[y],p===null?o[y]=[u]:p.push(u),u.lane=h|536870912),x):null}function _f(o){if(50<Pl)throw Pl=0,$v=null,Error(n(185));for(var u=o.return;u!==null;)o=u,u=o.return;return o.tag===3?o.stateNode:null}var Ds={};function GT(o,u,h,p){this.tag=o,this.key=h,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=u,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=p,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function nr(o,u,h,p){return new GT(o,u,h,p)}function Wp(o){return o=o.prototype,!(!o||!o.isReactComponent)}function Ia(o,u){var h=o.alternate;return h===null?(h=nr(o.tag,u,o.key,o.mode),h.elementType=o.elementType,h.type=o.type,h.stateNode=o.stateNode,h.alternate=o,o.alternate=h):(h.pendingProps=u,h.type=o.type,h.flags=0,h.subtreeFlags=0,h.deletions=null),h.flags=o.flags&65011712,h.childLanes=o.childLanes,h.lanes=o.lanes,h.child=o.child,h.memoizedProps=o.memoizedProps,h.memoizedState=o.memoizedState,h.updateQueue=o.updateQueue,u=o.dependencies,h.dependencies=u===null?null:{lanes:u.lanes,firstContext:u.firstContext},h.sibling=o.sibling,h.index=o.index,h.ref=o.ref,h.refCleanup=o.refCleanup,h}function jb(o,u){o.flags&=65011714;var h=o.alternate;return h===null?(o.childLanes=0,o.lanes=u,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=h.childLanes,o.lanes=h.lanes,o.child=h.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=h.memoizedProps,o.memoizedState=h.memoizedState,o.updateQueue=h.updateQueue,o.type=h.type,u=h.dependencies,o.dependencies=u===null?null:{lanes:u.lanes,firstContext:u.firstContext}),o}function Sf(o,u,h,p,y,x){var A=0;if(p=o,typeof o=="function")Wp(o)&&(A=1);else if(typeof o=="string")A=KA(o,h,pe.current)?26:o==="html"||o==="head"||o==="body"?27:5;else e:switch(o){case N:return o=nr(31,h,u,y),o.elementType=N,o.lanes=x,o;case b:return So(h.children,y,x,u);case w:A=8,y|=24;break;case _:return o=nr(12,h,u,y|2),o.elementType=_,o.lanes=x,o;case T:return o=nr(13,h,u,y),o.elementType=T,o.lanes=x,o;case D:return o=nr(19,h,u,y),o.elementType=D,o.lanes=x,o;default:if(typeof o=="object"&&o!==null)switch(o.$$typeof){case S:case C:A=10;break e;case E:A=9;break e;case R:A=11;break e;case k:A=14;break e;case M:A=16,p=null;break e}A=29,h=Error(n(130,o===null?"null":typeof o,"")),p=null}return u=nr(A,h,u,y),u.elementType=o,u.type=p,u.lanes=x,u}function So(o,u,h,p){return o=nr(7,o,p,u),o.lanes=h,o}function Gp(o,u,h){return o=nr(6,o,null,u),o.lanes=h,o}function qp(o,u,h){return u=nr(4,o.children!==null?o.children:[],o.key,u),u.lanes=h,u.stateNode={containerInfo:o.containerInfo,pendingChildren:null,implementation:o.implementation},u}var ks=[],Os=0,Ef=null,Cf=0,Sr=[],Er=0,Eo=null,Fa=1,Ba="";function Co(o,u){ks[Os++]=Cf,ks[Os++]=Ef,Ef=o,Cf=u}function Wb(o,u,h){Sr[Er++]=Fa,Sr[Er++]=Ba,Sr[Er++]=Eo,Eo=o;var p=Fa;o=Ba;var y=32-gn(p)-1;p&=~(1<<y),h+=1;var x=32-gn(u)+y;if(30<x){var A=y-y%5;x=(p&(1<<A)-1).toString(32),p>>=A,y-=A,Fa=1<<32-gn(u)+y|h<<y|p,Ba=x+o}else Fa=1<<x|h<<y|p,Ba=o}function Kp(o){o.return!==null&&(Co(o,1),Wb(o,1,0))}function Xp(o){for(;o===Ef;)Ef=ks[--Os],ks[Os]=null,Cf=ks[--Os],ks[Os]=null;for(;o===Eo;)Eo=Sr[--Er],Sr[Er]=null,Ba=Sr[--Er],Sr[Er]=null,Fa=Sr[--Er],Sr[Er]=null}var Bn=null,Lt=null,pt=!1,Ro=null,ta=!1,$p=Error(n(519));function To(o){var u=Error(n(418,""));throw ml(wr(u,o)),$p}function Gb(o){var u=o.stateNode,h=o.type,p=o.memoizedProps;switch(u[Cn]=o,u[Hn]=p,h){case"dialog":at("cancel",u),at("close",u);break;case"iframe":case"object":case"embed":at("load",u);break;case"video":case"audio":for(h=0;h<Ul.length;h++)at(Ul[h],u);break;case"source":at("error",u);break;case"img":case"image":case"link":at("error",u),at("load",u);break;case"details":at("toggle",u);break;case"input":at("invalid",u),ob(u,p.value,p.defaultValue,p.checked,p.defaultChecked,p.type,p.name,!0),ff(u);break;case"select":at("invalid",u);break;case"textarea":at("invalid",u),ub(u,p.value,p.defaultValue,p.children),ff(u)}h=p.children,typeof h!="string"&&typeof h!="number"&&typeof h!="bigint"||u.textContent===""+h||p.suppressHydrationWarning===!0||uw(u.textContent,h)?(p.popover!=null&&(at("beforetoggle",u),at("toggle",u)),p.onScroll!=null&&at("scroll",u),p.onScrollEnd!=null&&at("scrollend",u),p.onClick!=null&&(u.onclick=ih),u=!0):u=!1,u||To(o)}function qb(o){for(Bn=o.return;Bn;)switch(Bn.tag){case 5:case 13:ta=!1;return;case 27:case 3:ta=!0;return;default:Bn=Bn.return}}function pl(o){if(o!==Bn)return!1;if(!pt)return qb(o),pt=!0,!1;var u=o.tag,h;if((h=u!==3&&u!==27)&&((h=u===5)&&(h=o.type,h=!(h!=="form"&&h!=="button")||fm(o.type,o.memoizedProps)),h=!h),h&&Lt&&To(o),qb(o),u===13){if(o=o.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(n(317));e:{for(o=o.nextSibling,u=0;o;){if(o.nodeType===8)if(h=o.data,h==="/$"){if(u===0){Lt=Ur(o.nextSibling);break e}u--}else h!=="$"&&h!=="$!"&&h!=="$?"||u++;o=o.nextSibling}Lt=null}}else u===27?(u=Lt,Ii(o.type)?(o=vm,vm=null,Lt=o):Lt=u):Lt=Bn?Ur(o.stateNode.nextSibling):null;return!0}function vl(){Lt=Bn=null,pt=!1}function Kb(){var o=Ro;return o!==null&&(qn===null?qn=o:qn.push.apply(qn,o),Ro=null),o}function ml(o){Ro===null?Ro=[o]:Ro.push(o)}var Yp=K(null),Ao=null,La=null;function bi(o,u,h){ue(Yp,u._currentValue),u._currentValue=h}function Pa(o){o._currentValue=Yp.current,oe(Yp)}function Zp(o,u,h){for(;o!==null;){var p=o.alternate;if((o.childLanes&u)!==u?(o.childLanes|=u,p!==null&&(p.childLanes|=u)):p!==null&&(p.childLanes&u)!==u&&(p.childLanes|=u),o===h)break;o=o.return}}function Qp(o,u,h,p){var y=o.child;for(y!==null&&(y.return=o);y!==null;){var x=y.dependencies;if(x!==null){var A=y.child;x=x.firstContext;e:for(;x!==null;){var O=x;x=y;for(var V=0;V<u.length;V++)if(O.context===u[V]){x.lanes|=h,O=x.alternate,O!==null&&(O.lanes|=h),Zp(x.return,h,o),p||(A=null);break e}x=O.next}}else if(y.tag===18){if(A=y.return,A===null)throw Error(n(341));A.lanes|=h,x=A.alternate,x!==null&&(x.lanes|=h),Zp(A,h,o),A=null}else A=y.child;if(A!==null)A.return=y;else for(A=y;A!==null;){if(A===o){A=null;break}if(y=A.sibling,y!==null){y.return=A.return,A=y;break}A=A.return}y=A}}function gl(o,u,h,p){o=null;for(var y=u,x=!1;y!==null;){if(!x){if((y.flags&524288)!==0)x=!0;else if((y.flags&262144)!==0)break}if(y.tag===10){var A=y.alternate;if(A===null)throw Error(n(387));if(A=A.memoizedProps,A!==null){var O=y.type;tr(y.pendingProps.value,A.value)||(o!==null?o.push(O):o=[O])}}else if(y===Ne.current){if(A=y.alternate,A===null)throw Error(n(387));A.memoizedState.memoizedState!==y.memoizedState.memoizedState&&(o!==null?o.push(ql):o=[ql])}y=y.return}o!==null&&Qp(u,o,h,p),u.flags|=262144}function Rf(o){for(o=o.firstContext;o!==null;){if(!tr(o.context._currentValue,o.memoizedValue))return!0;o=o.next}return!1}function Do(o){Ao=o,La=null,o=o.dependencies,o!==null&&(o.firstContext=null)}function Rn(o){return Xb(Ao,o)}function Tf(o,u){return Ao===null&&Do(o),Xb(o,u)}function Xb(o,u){var h=u._currentValue;if(u={context:u,memoizedValue:h,next:null},La===null){if(o===null)throw Error(n(308));La=u,o.dependencies={lanes:0,firstContext:u},o.flags|=524288}else La=La.next=u;return h}var qT=typeof AbortController<"u"?AbortController:function(){var o=[],u=this.signal={aborted:!1,addEventListener:function(h,p){o.push(p)}};this.abort=function(){u.aborted=!0,o.forEach(function(h){return h()})}},KT=r.unstable_scheduleCallback,XT=r.unstable_NormalPriority,Zt={$$typeof:C,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Jp(){return{controller:new qT,data:new Map,refCount:0}}function yl(o){o.refCount--,o.refCount===0&&KT(XT,function(){o.controller.abort()})}var bl=null,ev=0,Ns=0,Ms=null;function $T(o,u){if(bl===null){var h=bl=[];ev=0,Ns=nm(),Ms={status:"pending",value:void 0,then:function(p){h.push(p)}}}return ev++,u.then($b,$b),u}function $b(){if(--ev===0&&bl!==null){Ms!==null&&(Ms.status="fulfilled");var o=bl;bl=null,Ns=0,Ms=null;for(var u=0;u<o.length;u++)(0,o[u])()}}function YT(o,u){var h=[],p={status:"pending",value:null,reason:null,then:function(y){h.push(y)}};return o.then(function(){p.status="fulfilled",p.value=u;for(var y=0;y<h.length;y++)(0,h[y])(u)},function(y){for(p.status="rejected",p.reason=y,y=0;y<h.length;y++)(0,h[y])(void 0)}),p}var Yb=U.S;U.S=function(o,u){typeof u=="object"&&u!==null&&typeof u.then=="function"&&$T(o,u),Yb!==null&&Yb(o,u)};var ko=K(null);function tv(){var o=ko.current;return o!==null?o:Rt.pooledCache}function Af(o,u){u===null?ue(ko,ko.current):ue(ko,u.pool)}function Zb(){var o=tv();return o===null?null:{parent:Zt._currentValue,pool:o}}var xl=Error(n(460)),Qb=Error(n(474)),Df=Error(n(542)),nv={then:function(){}};function Jb(o){return o=o.status,o==="fulfilled"||o==="rejected"}function kf(){}function e1(o,u,h){switch(h=o[h],h===void 0?o.push(u):h!==u&&(u.then(kf,kf),u=h),u.status){case"fulfilled":return u.value;case"rejected":throw o=u.reason,n1(o),o;default:if(typeof u.status=="string")u.then(kf,kf);else{if(o=Rt,o!==null&&100<o.shellSuspendCounter)throw Error(n(482));o=u,o.status="pending",o.then(function(p){if(u.status==="pending"){var y=u;y.status="fulfilled",y.value=p}},function(p){if(u.status==="pending"){var y=u;y.status="rejected",y.reason=p}})}switch(u.status){case"fulfilled":return u.value;case"rejected":throw o=u.reason,n1(o),o}throw wl=u,xl}}var wl=null;function t1(){if(wl===null)throw Error(n(459));var o=wl;return wl=null,o}function n1(o){if(o===xl||o===Df)throw Error(n(483))}var xi=!1;function rv(o){o.updateQueue={baseState:o.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function av(o,u){o=o.updateQueue,u.updateQueue===o&&(u.updateQueue={baseState:o.baseState,firstBaseUpdate:o.firstBaseUpdate,lastBaseUpdate:o.lastBaseUpdate,shared:o.shared,callbacks:null})}function wi(o){return{lane:o,tag:0,payload:null,callback:null,next:null}}function _i(o,u,h){var p=o.updateQueue;if(p===null)return null;if(p=p.shared,(yt&2)!==0){var y=p.pending;return y===null?u.next=u:(u.next=y.next,y.next=u),p.pending=u,u=_f(o),Hb(o,null,h),u}return wf(o,p,u,h),_f(o)}function _l(o,u,h){if(u=u.updateQueue,u!==null&&(u=u.shared,(h&4194048)!==0)){var p=u.lanes;p&=o.pendingLanes,h|=p,u.lanes=h,$0(o,h)}}function iv(o,u){var h=o.updateQueue,p=o.alternate;if(p!==null&&(p=p.updateQueue,h===p)){var y=null,x=null;if(h=h.firstBaseUpdate,h!==null){do{var A={lane:h.lane,tag:h.tag,payload:h.payload,callback:null,next:null};x===null?y=x=A:x=x.next=A,h=h.next}while(h!==null);x===null?y=x=u:x=x.next=u}else y=x=u;h={baseState:p.baseState,firstBaseUpdate:y,lastBaseUpdate:x,shared:p.shared,callbacks:p.callbacks},o.updateQueue=h;return}o=h.lastBaseUpdate,o===null?h.firstBaseUpdate=u:o.next=u,h.lastBaseUpdate=u}var ov=!1;function Sl(){if(ov){var o=Ms;if(o!==null)throw o}}function El(o,u,h,p){ov=!1;var y=o.updateQueue;xi=!1;var x=y.firstBaseUpdate,A=y.lastBaseUpdate,O=y.shared.pending;if(O!==null){y.shared.pending=null;var V=O,Q=V.next;V.next=null,A===null?x=Q:A.next=Q,A=V;var ce=o.alternate;ce!==null&&(ce=ce.updateQueue,O=ce.lastBaseUpdate,O!==A&&(O===null?ce.firstBaseUpdate=Q:O.next=Q,ce.lastBaseUpdate=V))}if(x!==null){var he=y.baseState;A=0,ce=Q=V=null,O=x;do{var te=O.lane&-536870913,ae=te!==O.lane;if(ae?(st&te)===te:(p&te)===te){te!==0&&te===Ns&&(ov=!0),ce!==null&&(ce=ce.next={lane:0,tag:O.tag,payload:O.payload,callback:null,next:null});e:{var Ue=o,Be=O;te=u;var St=h;switch(Be.tag){case 1:if(Ue=Be.payload,typeof Ue=="function"){he=Ue.call(St,he,te);break e}he=Ue;break e;case 3:Ue.flags=Ue.flags&-65537|128;case 0:if(Ue=Be.payload,te=typeof Ue=="function"?Ue.call(St,he,te):Ue,te==null)break e;he=d({},he,te);break e;case 2:xi=!0}}te=O.callback,te!==null&&(o.flags|=64,ae&&(o.flags|=8192),ae=y.callbacks,ae===null?y.callbacks=[te]:ae.push(te))}else ae={lane:te,tag:O.tag,payload:O.payload,callback:O.callback,next:null},ce===null?(Q=ce=ae,V=he):ce=ce.next=ae,A|=te;if(O=O.next,O===null){if(O=y.shared.pending,O===null)break;ae=O,O=ae.next,ae.next=null,y.lastBaseUpdate=ae,y.shared.pending=null}}while(!0);ce===null&&(V=he),y.baseState=V,y.firstBaseUpdate=Q,y.lastBaseUpdate=ce,x===null&&(y.shared.lanes=0),ki|=A,o.lanes=A,o.memoizedState=he}}function r1(o,u){if(typeof o!="function")throw Error(n(191,o));o.call(u)}function a1(o,u){var h=o.callbacks;if(h!==null)for(o.callbacks=null,o=0;o<h.length;o++)r1(h[o],u)}var Is=K(null),Of=K(0);function i1(o,u){o=Ga,ue(Of,o),ue(Is,u),Ga=o|u.baseLanes}function sv(){ue(Of,Ga),ue(Is,Is.current)}function uv(){Ga=Of.current,oe(Is),oe(Of)}var Si=0,et=null,wt=null,qt=null,Nf=!1,Fs=!1,Oo=!1,Mf=0,Cl=0,Bs=null,ZT=0;function Ht(){throw Error(n(321))}function lv(o,u){if(u===null)return!1;for(var h=0;h<u.length&&h<o.length;h++)if(!tr(o[h],u[h]))return!1;return!0}function cv(o,u,h,p,y,x){return Si=x,et=u,u.memoizedState=null,u.updateQueue=null,u.lanes=0,U.H=o===null||o.memoizedState===null?H1:j1,Oo=!1,x=h(p,y),Oo=!1,Fs&&(x=s1(u,h,p,y)),o1(o),x}function o1(o){U.H=zf;var u=wt!==null&&wt.next!==null;if(Si=0,qt=wt=et=null,Nf=!1,Cl=0,Bs=null,u)throw Error(n(300));o===null||ln||(o=o.dependencies,o!==null&&Rf(o)&&(ln=!0))}function s1(o,u,h,p){et=o;var y=0;do{if(Fs&&(Bs=null),Cl=0,Fs=!1,25<=y)throw Error(n(301));if(y+=1,qt=wt=null,o.updateQueue!=null){var x=o.updateQueue;x.lastEffect=null,x.events=null,x.stores=null,x.memoCache!=null&&(x.memoCache.index=0)}U.H=aA,x=u(h,p)}while(Fs);return x}function QT(){var o=U.H,u=o.useState()[0];return u=typeof u.then=="function"?Rl(u):u,o=o.useState()[0],(wt!==null?wt.memoizedState:null)!==o&&(et.flags|=1024),u}function fv(){var o=Mf!==0;return Mf=0,o}function hv(o,u,h){u.updateQueue=o.updateQueue,u.flags&=-2053,o.lanes&=~h}function dv(o){if(Nf){for(o=o.memoizedState;o!==null;){var u=o.queue;u!==null&&(u.pending=null),o=o.next}Nf=!1}Si=0,qt=wt=et=null,Fs=!1,Cl=Mf=0,Bs=null}function Wn(){var o={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return qt===null?et.memoizedState=qt=o:qt=qt.next=o,qt}function Kt(){if(wt===null){var o=et.alternate;o=o!==null?o.memoizedState:null}else o=wt.next;var u=qt===null?et.memoizedState:qt.next;if(u!==null)qt=u,wt=o;else{if(o===null)throw et.alternate===null?Error(n(467)):Error(n(310));wt=o,o={memoizedState:wt.memoizedState,baseState:wt.baseState,baseQueue:wt.baseQueue,queue:wt.queue,next:null},qt===null?et.memoizedState=qt=o:qt=qt.next=o}return qt}function pv(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Rl(o){var u=Cl;return Cl+=1,Bs===null&&(Bs=[]),o=e1(Bs,o,u),u=et,(qt===null?u.memoizedState:qt.next)===null&&(u=u.alternate,U.H=u===null||u.memoizedState===null?H1:j1),o}function If(o){if(o!==null&&typeof o=="object"){if(typeof o.then=="function")return Rl(o);if(o.$$typeof===C)return Rn(o)}throw Error(n(438,String(o)))}function vv(o){var u=null,h=et.updateQueue;if(h!==null&&(u=h.memoCache),u==null){var p=et.alternate;p!==null&&(p=p.updateQueue,p!==null&&(p=p.memoCache,p!=null&&(u={data:p.data.map(function(y){return y.slice()}),index:0})))}if(u==null&&(u={data:[],index:0}),h===null&&(h=pv(),et.updateQueue=h),h.memoCache=u,h=u.data[u.index],h===void 0)for(h=u.data[u.index]=Array(o),p=0;p<o;p++)h[p]=I;return u.index++,h}function za(o,u){return typeof u=="function"?u(o):u}function Ff(o){var u=Kt();return mv(u,wt,o)}function mv(o,u,h){var p=o.queue;if(p===null)throw Error(n(311));p.lastRenderedReducer=h;var y=o.baseQueue,x=p.pending;if(x!==null){if(y!==null){var A=y.next;y.next=x.next,x.next=A}u.baseQueue=y=x,p.pending=null}if(x=o.baseState,y===null)o.memoizedState=x;else{u=y.next;var O=A=null,V=null,Q=u,ce=!1;do{var he=Q.lane&-536870913;if(he!==Q.lane?(st&he)===he:(Si&he)===he){var te=Q.revertLane;if(te===0)V!==null&&(V=V.next={lane:0,revertLane:0,action:Q.action,hasEagerState:Q.hasEagerState,eagerState:Q.eagerState,next:null}),he===Ns&&(ce=!0);else if((Si&te)===te){Q=Q.next,te===Ns&&(ce=!0);continue}else he={lane:0,revertLane:Q.revertLane,action:Q.action,hasEagerState:Q.hasEagerState,eagerState:Q.eagerState,next:null},V===null?(O=V=he,A=x):V=V.next=he,et.lanes|=te,ki|=te;he=Q.action,Oo&&h(x,he),x=Q.hasEagerState?Q.eagerState:h(x,he)}else te={lane:he,revertLane:Q.revertLane,action:Q.action,hasEagerState:Q.hasEagerState,eagerState:Q.eagerState,next:null},V===null?(O=V=te,A=x):V=V.next=te,et.lanes|=he,ki|=he;Q=Q.next}while(Q!==null&&Q!==u);if(V===null?A=x:V.next=O,!tr(x,o.memoizedState)&&(ln=!0,ce&&(h=Ms,h!==null)))throw h;o.memoizedState=x,o.baseState=A,o.baseQueue=V,p.lastRenderedState=x}return y===null&&(p.lanes=0),[o.memoizedState,p.dispatch]}function gv(o){var u=Kt(),h=u.queue;if(h===null)throw Error(n(311));h.lastRenderedReducer=o;var p=h.dispatch,y=h.pending,x=u.memoizedState;if(y!==null){h.pending=null;var A=y=y.next;do x=o(x,A.action),A=A.next;while(A!==y);tr(x,u.memoizedState)||(ln=!0),u.memoizedState=x,u.baseQueue===null&&(u.baseState=x),h.lastRenderedState=x}return[x,p]}function u1(o,u,h){var p=et,y=Kt(),x=pt;if(x){if(h===void 0)throw Error(n(407));h=h()}else h=u();var A=!tr((wt||y).memoizedState,h);A&&(y.memoizedState=h,ln=!0),y=y.queue;var O=f1.bind(null,p,y,o);if(Tl(2048,8,O,[o]),y.getSnapshot!==u||A||qt!==null&&qt.memoizedState.tag&1){if(p.flags|=2048,Ls(9,Bf(),c1.bind(null,p,y,h,u),null),Rt===null)throw Error(n(349));x||(Si&124)!==0||l1(p,u,h)}return h}function l1(o,u,h){o.flags|=16384,o={getSnapshot:u,value:h},u=et.updateQueue,u===null?(u=pv(),et.updateQueue=u,u.stores=[o]):(h=u.stores,h===null?u.stores=[o]:h.push(o))}function c1(o,u,h,p){u.value=h,u.getSnapshot=p,h1(u)&&d1(o)}function f1(o,u,h){return h(function(){h1(u)&&d1(o)})}function h1(o){var u=o.getSnapshot;o=o.value;try{var h=u();return!tr(o,h)}catch{return!0}}function d1(o){var u=As(o,2);u!==null&&sr(u,o,2)}function yv(o){var u=Wn();if(typeof o=="function"){var h=o;if(o=h(),Oo){Yt(!0);try{h()}finally{Yt(!1)}}}return u.memoizedState=u.baseState=o,u.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:za,lastRenderedState:o},u}function p1(o,u,h,p){return o.baseState=h,mv(o,wt,typeof p=="function"?p:za)}function JT(o,u,h,p,y){if(Pf(o))throw Error(n(485));if(o=u.action,o!==null){var x={payload:y,action:o,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(A){x.listeners.push(A)}};U.T!==null?h(!0):x.isTransition=!1,p(x),h=u.pending,h===null?(x.next=u.pending=x,v1(u,x)):(x.next=h.next,u.pending=h.next=x)}}function v1(o,u){var h=u.action,p=u.payload,y=o.state;if(u.isTransition){var x=U.T,A={};U.T=A;try{var O=h(y,p),V=U.S;V!==null&&V(A,O),m1(o,u,O)}catch(Q){bv(o,u,Q)}finally{U.T=x}}else try{x=h(y,p),m1(o,u,x)}catch(Q){bv(o,u,Q)}}function m1(o,u,h){h!==null&&typeof h=="object"&&typeof h.then=="function"?h.then(function(p){g1(o,u,p)},function(p){return bv(o,u,p)}):g1(o,u,h)}function g1(o,u,h){u.status="fulfilled",u.value=h,y1(u),o.state=h,u=o.pending,u!==null&&(h=u.next,h===u?o.pending=null:(h=h.next,u.next=h,v1(o,h)))}function bv(o,u,h){var p=o.pending;if(o.pending=null,p!==null){p=p.next;do u.status="rejected",u.reason=h,y1(u),u=u.next;while(u!==p)}o.action=null}function y1(o){o=o.listeners;for(var u=0;u<o.length;u++)(0,o[u])()}function b1(o,u){return u}function x1(o,u){if(pt){var h=Rt.formState;if(h!==null){e:{var p=et;if(pt){if(Lt){t:{for(var y=Lt,x=ta;y.nodeType!==8;){if(!x){y=null;break t}if(y=Ur(y.nextSibling),y===null){y=null;break t}}x=y.data,y=x==="F!"||x==="F"?y:null}if(y){Lt=Ur(y.nextSibling),p=y.data==="F!";break e}}To(p)}p=!1}p&&(u=h[0])}}return h=Wn(),h.memoizedState=h.baseState=u,p={pending:null,lanes:0,dispatch:null,lastRenderedReducer:b1,lastRenderedState:u},h.queue=p,h=z1.bind(null,et,p),p.dispatch=h,p=yv(!1),x=Ev.bind(null,et,!1,p.queue),p=Wn(),y={state:u,dispatch:null,action:o,pending:null},p.queue=y,h=JT.bind(null,et,y,x,h),y.dispatch=h,p.memoizedState=o,[u,h,!1]}function w1(o){var u=Kt();return _1(u,wt,o)}function _1(o,u,h){if(u=mv(o,u,b1)[0],o=Ff(za)[0],typeof u=="object"&&u!==null&&typeof u.then=="function")try{var p=Rl(u)}catch(A){throw A===xl?Df:A}else p=u;u=Kt();var y=u.queue,x=y.dispatch;return h!==u.memoizedState&&(et.flags|=2048,Ls(9,Bf(),eA.bind(null,y,h),null)),[p,x,o]}function eA(o,u){o.action=u}function S1(o){var u=Kt(),h=wt;if(h!==null)return _1(u,h,o);Kt(),u=u.memoizedState,h=Kt();var p=h.queue.dispatch;return h.memoizedState=o,[u,p,!1]}function Ls(o,u,h,p){return o={tag:o,create:h,deps:p,inst:u,next:null},u=et.updateQueue,u===null&&(u=pv(),et.updateQueue=u),h=u.lastEffect,h===null?u.lastEffect=o.next=o:(p=h.next,h.next=o,o.next=p,u.lastEffect=o),o}function Bf(){return{destroy:void 0,resource:void 0}}function E1(){return Kt().memoizedState}function Lf(o,u,h,p){var y=Wn();p=p===void 0?null:p,et.flags|=o,y.memoizedState=Ls(1|u,Bf(),h,p)}function Tl(o,u,h,p){var y=Kt();p=p===void 0?null:p;var x=y.memoizedState.inst;wt!==null&&p!==null&&lv(p,wt.memoizedState.deps)?y.memoizedState=Ls(u,x,h,p):(et.flags|=o,y.memoizedState=Ls(1|u,x,h,p))}function C1(o,u){Lf(8390656,8,o,u)}function R1(o,u){Tl(2048,8,o,u)}function T1(o,u){return Tl(4,2,o,u)}function A1(o,u){return Tl(4,4,o,u)}function D1(o,u){if(typeof u=="function"){o=o();var h=u(o);return function(){typeof h=="function"?h():u(null)}}if(u!=null)return o=o(),u.current=o,function(){u.current=null}}function k1(o,u,h){h=h!=null?h.concat([o]):null,Tl(4,4,D1.bind(null,u,o),h)}function xv(){}function O1(o,u){var h=Kt();u=u===void 0?null:u;var p=h.memoizedState;return u!==null&&lv(u,p[1])?p[0]:(h.memoizedState=[o,u],o)}function N1(o,u){var h=Kt();u=u===void 0?null:u;var p=h.memoizedState;if(u!==null&&lv(u,p[1]))return p[0];if(p=o(),Oo){Yt(!0);try{o()}finally{Yt(!1)}}return h.memoizedState=[p,u],p}function wv(o,u,h){return h===void 0||(Si&1073741824)!==0?o.memoizedState=u:(o.memoizedState=h,o=Fx(),et.lanes|=o,ki|=o,h)}function M1(o,u,h,p){return tr(h,u)?h:Is.current!==null?(o=wv(o,h,p),tr(o,u)||(ln=!0),o):(Si&42)===0?(ln=!0,o.memoizedState=h):(o=Fx(),et.lanes|=o,ki|=o,u)}function I1(o,u,h,p,y){var x=G.p;G.p=x!==0&&8>x?x:8;var A=U.T,O={};U.T=O,Ev(o,!1,u,h);try{var V=y(),Q=U.S;if(Q!==null&&Q(O,V),V!==null&&typeof V=="object"&&typeof V.then=="function"){var ce=YT(V,p);Al(o,u,ce,or(o))}else Al(o,u,p,or(o))}catch(he){Al(o,u,{then:function(){},status:"rejected",reason:he},or())}finally{G.p=x,U.T=A}}function tA(){}function _v(o,u,h,p){if(o.tag!==5)throw Error(n(476));var y=F1(o).queue;I1(o,y,u,X,h===null?tA:function(){return B1(o),h(p)})}function F1(o){var u=o.memoizedState;if(u!==null)return u;u={memoizedState:X,baseState:X,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:za,lastRenderedState:X},next:null};var h={};return u.next={memoizedState:h,baseState:h,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:za,lastRenderedState:h},next:null},o.memoizedState=u,o=o.alternate,o!==null&&(o.memoizedState=u),u}function B1(o){var u=F1(o).next.queue;Al(o,u,{},or())}function Sv(){return Rn(ql)}function L1(){return Kt().memoizedState}function P1(){return Kt().memoizedState}function nA(o){for(var u=o.return;u!==null;){switch(u.tag){case 24:case 3:var h=or();o=wi(h);var p=_i(u,o,h);p!==null&&(sr(p,u,h),_l(p,u,h)),u={cache:Jp()},o.payload=u;return}u=u.return}}function rA(o,u,h){var p=or();h={lane:p,revertLane:0,action:h,hasEagerState:!1,eagerState:null,next:null},Pf(o)?U1(u,h):(h=jp(o,u,h,p),h!==null&&(sr(h,o,p),V1(h,u,p)))}function z1(o,u,h){var p=or();Al(o,u,h,p)}function Al(o,u,h,p){var y={lane:p,revertLane:0,action:h,hasEagerState:!1,eagerState:null,next:null};if(Pf(o))U1(u,y);else{var x=o.alternate;if(o.lanes===0&&(x===null||x.lanes===0)&&(x=u.lastRenderedReducer,x!==null))try{var A=u.lastRenderedState,O=x(A,h);if(y.hasEagerState=!0,y.eagerState=O,tr(O,A))return wf(o,u,y,0),Rt===null&&xf(),!1}catch{}finally{}if(h=jp(o,u,y,p),h!==null)return sr(h,o,p),V1(h,u,p),!0}return!1}function Ev(o,u,h,p){if(p={lane:2,revertLane:nm(),action:p,hasEagerState:!1,eagerState:null,next:null},Pf(o)){if(u)throw Error(n(479))}else u=jp(o,h,p,2),u!==null&&sr(u,o,2)}function Pf(o){var u=o.alternate;return o===et||u!==null&&u===et}function U1(o,u){Fs=Nf=!0;var h=o.pending;h===null?u.next=u:(u.next=h.next,h.next=u),o.pending=u}function V1(o,u,h){if((h&4194048)!==0){var p=u.lanes;p&=o.pendingLanes,h|=p,u.lanes=h,$0(o,h)}}var zf={readContext:Rn,use:If,useCallback:Ht,useContext:Ht,useEffect:Ht,useImperativeHandle:Ht,useLayoutEffect:Ht,useInsertionEffect:Ht,useMemo:Ht,useReducer:Ht,useRef:Ht,useState:Ht,useDebugValue:Ht,useDeferredValue:Ht,useTransition:Ht,useSyncExternalStore:Ht,useId:Ht,useHostTransitionStatus:Ht,useFormState:Ht,useActionState:Ht,useOptimistic:Ht,useMemoCache:Ht,useCacheRefresh:Ht},H1={readContext:Rn,use:If,useCallback:function(o,u){return Wn().memoizedState=[o,u===void 0?null:u],o},useContext:Rn,useEffect:C1,useImperativeHandle:function(o,u,h){h=h!=null?h.concat([o]):null,Lf(4194308,4,D1.bind(null,u,o),h)},useLayoutEffect:function(o,u){return Lf(4194308,4,o,u)},useInsertionEffect:function(o,u){Lf(4,2,o,u)},useMemo:function(o,u){var h=Wn();u=u===void 0?null:u;var p=o();if(Oo){Yt(!0);try{o()}finally{Yt(!1)}}return h.memoizedState=[p,u],p},useReducer:function(o,u,h){var p=Wn();if(h!==void 0){var y=h(u);if(Oo){Yt(!0);try{h(u)}finally{Yt(!1)}}}else y=u;return p.memoizedState=p.baseState=y,o={pending:null,lanes:0,dispatch:null,lastRenderedReducer:o,lastRenderedState:y},p.queue=o,o=o.dispatch=rA.bind(null,et,o),[p.memoizedState,o]},useRef:function(o){var u=Wn();return o={current:o},u.memoizedState=o},useState:function(o){o=yv(o);var u=o.queue,h=z1.bind(null,et,u);return u.dispatch=h,[o.memoizedState,h]},useDebugValue:xv,useDeferredValue:function(o,u){var h=Wn();return wv(h,o,u)},useTransition:function(){var o=yv(!1);return o=I1.bind(null,et,o.queue,!0,!1),Wn().memoizedState=o,[!1,o]},useSyncExternalStore:function(o,u,h){var p=et,y=Wn();if(pt){if(h===void 0)throw Error(n(407));h=h()}else{if(h=u(),Rt===null)throw Error(n(349));(st&124)!==0||l1(p,u,h)}y.memoizedState=h;var x={value:h,getSnapshot:u};return y.queue=x,C1(f1.bind(null,p,x,o),[o]),p.flags|=2048,Ls(9,Bf(),c1.bind(null,p,x,h,u),null),h},useId:function(){var o=Wn(),u=Rt.identifierPrefix;if(pt){var h=Ba,p=Fa;h=(p&~(1<<32-gn(p)-1)).toString(32)+h,u="«"+u+"R"+h,h=Mf++,0<h&&(u+="H"+h.toString(32)),u+="»"}else h=ZT++,u="«"+u+"r"+h.toString(32)+"»";return o.memoizedState=u},useHostTransitionStatus:Sv,useFormState:x1,useActionState:x1,useOptimistic:function(o){var u=Wn();u.memoizedState=u.baseState=o;var h={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return u.queue=h,u=Ev.bind(null,et,!0,h),h.dispatch=u,[o,u]},useMemoCache:vv,useCacheRefresh:function(){return Wn().memoizedState=nA.bind(null,et)}},j1={readContext:Rn,use:If,useCallback:O1,useContext:Rn,useEffect:R1,useImperativeHandle:k1,useInsertionEffect:T1,useLayoutEffect:A1,useMemo:N1,useReducer:Ff,useRef:E1,useState:function(){return Ff(za)},useDebugValue:xv,useDeferredValue:function(o,u){var h=Kt();return M1(h,wt.memoizedState,o,u)},useTransition:function(){var o=Ff(za)[0],u=Kt().memoizedState;return[typeof o=="boolean"?o:Rl(o),u]},useSyncExternalStore:u1,useId:L1,useHostTransitionStatus:Sv,useFormState:w1,useActionState:w1,useOptimistic:function(o,u){var h=Kt();return p1(h,wt,o,u)},useMemoCache:vv,useCacheRefresh:P1},aA={readContext:Rn,use:If,useCallback:O1,useContext:Rn,useEffect:R1,useImperativeHandle:k1,useInsertionEffect:T1,useLayoutEffect:A1,useMemo:N1,useReducer:gv,useRef:E1,useState:function(){return gv(za)},useDebugValue:xv,useDeferredValue:function(o,u){var h=Kt();return wt===null?wv(h,o,u):M1(h,wt.memoizedState,o,u)},useTransition:function(){var o=gv(za)[0],u=Kt().memoizedState;return[typeof o=="boolean"?o:Rl(o),u]},useSyncExternalStore:u1,useId:L1,useHostTransitionStatus:Sv,useFormState:S1,useActionState:S1,useOptimistic:function(o,u){var h=Kt();return wt!==null?p1(h,wt,o,u):(h.baseState=o,[o,h.queue.dispatch])},useMemoCache:vv,useCacheRefresh:P1},Ps=null,Dl=0;function Uf(o){var u=Dl;return Dl+=1,Ps===null&&(Ps=[]),e1(Ps,o,u)}function kl(o,u){u=u.props.ref,o.ref=u!==void 0?u:null}function Vf(o,u){throw u.$$typeof===v?Error(n(525)):(o=Object.prototype.toString.call(u),Error(n(31,o==="[object Object]"?"object with keys {"+Object.keys(u).join(", ")+"}":o)))}function W1(o){var u=o._init;return u(o._payload)}function G1(o){function u($,W){if(o){var Y=$.deletions;Y===null?($.deletions=[W],$.flags|=16):Y.push(W)}}function h($,W){if(!o)return null;for(;W!==null;)u($,W),W=W.sibling;return null}function p($){for(var W=new Map;$!==null;)$.key!==null?W.set($.key,$):W.set($.index,$),$=$.sibling;return W}function y($,W){return $=Ia($,W),$.index=0,$.sibling=null,$}function x($,W,Y){return $.index=Y,o?(Y=$.alternate,Y!==null?(Y=Y.index,Y<W?($.flags|=67108866,W):Y):($.flags|=67108866,W)):($.flags|=1048576,W)}function A($){return o&&$.alternate===null&&($.flags|=67108866),$}function O($,W,Y,fe){return W===null||W.tag!==6?(W=Gp(Y,$.mode,fe),W.return=$,W):(W=y(W,Y),W.return=$,W)}function V($,W,Y,fe){var Ee=Y.type;return Ee===b?ce($,W,Y.props.children,fe,Y.key):W!==null&&(W.elementType===Ee||typeof Ee=="object"&&Ee!==null&&Ee.$$typeof===M&&W1(Ee)===W.type)?(W=y(W,Y.props),kl(W,Y),W.return=$,W):(W=Sf(Y.type,Y.key,Y.props,null,$.mode,fe),kl(W,Y),W.return=$,W)}function Q($,W,Y,fe){return W===null||W.tag!==4||W.stateNode.containerInfo!==Y.containerInfo||W.stateNode.implementation!==Y.implementation?(W=qp(Y,$.mode,fe),W.return=$,W):(W=y(W,Y.children||[]),W.return=$,W)}function ce($,W,Y,fe,Ee){return W===null||W.tag!==7?(W=So(Y,$.mode,fe,Ee),W.return=$,W):(W=y(W,Y),W.return=$,W)}function he($,W,Y){if(typeof W=="string"&&W!==""||typeof W=="number"||typeof W=="bigint")return W=Gp(""+W,$.mode,Y),W.return=$,W;if(typeof W=="object"&&W!==null){switch(W.$$typeof){case m:return Y=Sf(W.type,W.key,W.props,null,$.mode,Y),kl(Y,W),Y.return=$,Y;case g:return W=qp(W,$.mode,Y),W.return=$,W;case M:var fe=W._init;return W=fe(W._payload),he($,W,Y)}if(ee(W)||P(W))return W=So(W,$.mode,Y,null),W.return=$,W;if(typeof W.then=="function")return he($,Uf(W),Y);if(W.$$typeof===C)return he($,Tf($,W),Y);Vf($,W)}return null}function te($,W,Y,fe){var Ee=W!==null?W.key:null;if(typeof Y=="string"&&Y!==""||typeof Y=="number"||typeof Y=="bigint")return Ee!==null?null:O($,W,""+Y,fe);if(typeof Y=="object"&&Y!==null){switch(Y.$$typeof){case m:return Y.key===Ee?V($,W,Y,fe):null;case g:return Y.key===Ee?Q($,W,Y,fe):null;case M:return Ee=Y._init,Y=Ee(Y._payload),te($,W,Y,fe)}if(ee(Y)||P(Y))return Ee!==null?null:ce($,W,Y,fe,null);if(typeof Y.then=="function")return te($,W,Uf(Y),fe);if(Y.$$typeof===C)return te($,W,Tf($,Y),fe);Vf($,Y)}return null}function ae($,W,Y,fe,Ee){if(typeof fe=="string"&&fe!==""||typeof fe=="number"||typeof fe=="bigint")return $=$.get(Y)||null,O(W,$,""+fe,Ee);if(typeof fe=="object"&&fe!==null){switch(fe.$$typeof){case m:return $=$.get(fe.key===null?Y:fe.key)||null,V(W,$,fe,Ee);case g:return $=$.get(fe.key===null?Y:fe.key)||null,Q(W,$,fe,Ee);case M:var tt=fe._init;return fe=tt(fe._payload),ae($,W,Y,fe,Ee)}if(ee(fe)||P(fe))return $=$.get(Y)||null,ce(W,$,fe,Ee,null);if(typeof fe.then=="function")return ae($,W,Y,Uf(fe),Ee);if(fe.$$typeof===C)return ae($,W,Y,Tf(W,fe),Ee);Vf(W,fe)}return null}function Ue($,W,Y,fe){for(var Ee=null,tt=null,Me=W,Le=W=0,fn=null;Me!==null&&Le<Y.length;Le++){Me.index>Le?(fn=Me,Me=null):fn=Me.sibling;var ft=te($,Me,Y[Le],fe);if(ft===null){Me===null&&(Me=fn);break}o&&Me&&ft.alternate===null&&u($,Me),W=x(ft,W,Le),tt===null?Ee=ft:tt.sibling=ft,tt=ft,Me=fn}if(Le===Y.length)return h($,Me),pt&&Co($,Le),Ee;if(Me===null){for(;Le<Y.length;Le++)Me=he($,Y[Le],fe),Me!==null&&(W=x(Me,W,Le),tt===null?Ee=Me:tt.sibling=Me,tt=Me);return pt&&Co($,Le),Ee}for(Me=p(Me);Le<Y.length;Le++)fn=ae(Me,$,Le,Y[Le],fe),fn!==null&&(o&&fn.alternate!==null&&Me.delete(fn.key===null?Le:fn.key),W=x(fn,W,Le),tt===null?Ee=fn:tt.sibling=fn,tt=fn);return o&&Me.forEach(function(zi){return u($,zi)}),pt&&Co($,Le),Ee}function Be($,W,Y,fe){if(Y==null)throw Error(n(151));for(var Ee=null,tt=null,Me=W,Le=W=0,fn=null,ft=Y.next();Me!==null&&!ft.done;Le++,ft=Y.next()){Me.index>Le?(fn=Me,Me=null):fn=Me.sibling;var zi=te($,Me,ft.value,fe);if(zi===null){Me===null&&(Me=fn);break}o&&Me&&zi.alternate===null&&u($,Me),W=x(zi,W,Le),tt===null?Ee=zi:tt.sibling=zi,tt=zi,Me=fn}if(ft.done)return h($,Me),pt&&Co($,Le),Ee;if(Me===null){for(;!ft.done;Le++,ft=Y.next())ft=he($,ft.value,fe),ft!==null&&(W=x(ft,W,Le),tt===null?Ee=ft:tt.sibling=ft,tt=ft);return pt&&Co($,Le),Ee}for(Me=p(Me);!ft.done;Le++,ft=Y.next())ft=ae(Me,$,Le,ft.value,fe),ft!==null&&(o&&ft.alternate!==null&&Me.delete(ft.key===null?Le:ft.key),W=x(ft,W,Le),tt===null?Ee=ft:tt.sibling=ft,tt=ft);return o&&Me.forEach(function(iD){return u($,iD)}),pt&&Co($,Le),Ee}function St($,W,Y,fe){if(typeof Y=="object"&&Y!==null&&Y.type===b&&Y.key===null&&(Y=Y.props.children),typeof Y=="object"&&Y!==null){switch(Y.$$typeof){case m:e:{for(var Ee=Y.key;W!==null;){if(W.key===Ee){if(Ee=Y.type,Ee===b){if(W.tag===7){h($,W.sibling),fe=y(W,Y.props.children),fe.return=$,$=fe;break e}}else if(W.elementType===Ee||typeof Ee=="object"&&Ee!==null&&Ee.$$typeof===M&&W1(Ee)===W.type){h($,W.sibling),fe=y(W,Y.props),kl(fe,Y),fe.return=$,$=fe;break e}h($,W);break}else u($,W);W=W.sibling}Y.type===b?(fe=So(Y.props.children,$.mode,fe,Y.key),fe.return=$,$=fe):(fe=Sf(Y.type,Y.key,Y.props,null,$.mode,fe),kl(fe,Y),fe.return=$,$=fe)}return A($);case g:e:{for(Ee=Y.key;W!==null;){if(W.key===Ee)if(W.tag===4&&W.stateNode.containerInfo===Y.containerInfo&&W.stateNode.implementation===Y.implementation){h($,W.sibling),fe=y(W,Y.children||[]),fe.return=$,$=fe;break e}else{h($,W);break}else u($,W);W=W.sibling}fe=qp(Y,$.mode,fe),fe.return=$,$=fe}return A($);case M:return Ee=Y._init,Y=Ee(Y._payload),St($,W,Y,fe)}if(ee(Y))return Ue($,W,Y,fe);if(P(Y)){if(Ee=P(Y),typeof Ee!="function")throw Error(n(150));return Y=Ee.call(Y),Be($,W,Y,fe)}if(typeof Y.then=="function")return St($,W,Uf(Y),fe);if(Y.$$typeof===C)return St($,W,Tf($,Y),fe);Vf($,Y)}return typeof Y=="string"&&Y!==""||typeof Y=="number"||typeof Y=="bigint"?(Y=""+Y,W!==null&&W.tag===6?(h($,W.sibling),fe=y(W,Y),fe.return=$,$=fe):(h($,W),fe=Gp(Y,$.mode,fe),fe.return=$,$=fe),A($)):h($,W)}return function($,W,Y,fe){try{Dl=0;var Ee=St($,W,Y,fe);return Ps=null,Ee}catch(Me){if(Me===xl||Me===Df)throw Me;var tt=nr(29,Me,null,$.mode);return tt.lanes=fe,tt.return=$,tt}finally{}}}var zs=G1(!0),q1=G1(!1),Cr=K(null),na=null;function Ei(o){var u=o.alternate;ue(Qt,Qt.current&1),ue(Cr,o),na===null&&(u===null||Is.current!==null||u.memoizedState!==null)&&(na=o)}function K1(o){if(o.tag===22){if(ue(Qt,Qt.current),ue(Cr,o),na===null){var u=o.alternate;u!==null&&u.memoizedState!==null&&(na=o)}}else Ci()}function Ci(){ue(Qt,Qt.current),ue(Cr,Cr.current)}function Ua(o){oe(Cr),na===o&&(na=null),oe(Qt)}var Qt=K(0);function Hf(o){for(var u=o;u!==null;){if(u.tag===13){var h=u.memoizedState;if(h!==null&&(h=h.dehydrated,h===null||h.data==="$?"||pm(h)))return u}else if(u.tag===19&&u.memoizedProps.revealOrder!==void 0){if((u.flags&128)!==0)return u}else if(u.child!==null){u.child.return=u,u=u.child;continue}if(u===o)break;for(;u.sibling===null;){if(u.return===null||u.return===o)return null;u=u.return}u.sibling.return=u.return,u=u.sibling}return null}function Cv(o,u,h,p){u=o.memoizedState,h=h(p,u),h=h==null?u:d({},u,h),o.memoizedState=h,o.lanes===0&&(o.updateQueue.baseState=h)}var Rv={enqueueSetState:function(o,u,h){o=o._reactInternals;var p=or(),y=wi(p);y.payload=u,h!=null&&(y.callback=h),u=_i(o,y,p),u!==null&&(sr(u,o,p),_l(u,o,p))},enqueueReplaceState:function(o,u,h){o=o._reactInternals;var p=or(),y=wi(p);y.tag=1,y.payload=u,h!=null&&(y.callback=h),u=_i(o,y,p),u!==null&&(sr(u,o,p),_l(u,o,p))},enqueueForceUpdate:function(o,u){o=o._reactInternals;var h=or(),p=wi(h);p.tag=2,u!=null&&(p.callback=u),u=_i(o,p,h),u!==null&&(sr(u,o,h),_l(u,o,h))}};function X1(o,u,h,p,y,x,A){return o=o.stateNode,typeof o.shouldComponentUpdate=="function"?o.shouldComponentUpdate(p,x,A):u.prototype&&u.prototype.isPureReactComponent?!hl(h,p)||!hl(y,x):!0}function $1(o,u,h,p){o=u.state,typeof u.componentWillReceiveProps=="function"&&u.componentWillReceiveProps(h,p),typeof u.UNSAFE_componentWillReceiveProps=="function"&&u.UNSAFE_componentWillReceiveProps(h,p),u.state!==o&&Rv.enqueueReplaceState(u,u.state,null)}function No(o,u){var h=u;if("ref"in u){h={};for(var p in u)p!=="ref"&&(h[p]=u[p])}if(o=o.defaultProps){h===u&&(h=d({},h));for(var y in o)h[y]===void 0&&(h[y]=o[y])}return h}var jf=typeof reportError=="function"?reportError:function(o){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var u=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof o=="object"&&o!==null&&typeof o.message=="string"?String(o.message):String(o),error:o});if(!window.dispatchEvent(u))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",o);return}console.error(o)};function Y1(o){jf(o)}function Z1(o){console.error(o)}function Q1(o){jf(o)}function Wf(o,u){try{var h=o.onUncaughtError;h(u.value,{componentStack:u.stack})}catch(p){setTimeout(function(){throw p})}}function J1(o,u,h){try{var p=o.onCaughtError;p(h.value,{componentStack:h.stack,errorBoundary:u.tag===1?u.stateNode:null})}catch(y){setTimeout(function(){throw y})}}function Tv(o,u,h){return h=wi(h),h.tag=3,h.payload={element:null},h.callback=function(){Wf(o,u)},h}function ex(o){return o=wi(o),o.tag=3,o}function tx(o,u,h,p){var y=h.type.getDerivedStateFromError;if(typeof y=="function"){var x=p.value;o.payload=function(){return y(x)},o.callback=function(){J1(u,h,p)}}var A=h.stateNode;A!==null&&typeof A.componentDidCatch=="function"&&(o.callback=function(){J1(u,h,p),typeof y!="function"&&(Oi===null?Oi=new Set([this]):Oi.add(this));var O=p.stack;this.componentDidCatch(p.value,{componentStack:O!==null?O:""})})}function iA(o,u,h,p,y){if(h.flags|=32768,p!==null&&typeof p=="object"&&typeof p.then=="function"){if(u=h.alternate,u!==null&&gl(u,h,y,!0),h=Cr.current,h!==null){switch(h.tag){case 13:return na===null?Zv():h.alternate===null&&Pt===0&&(Pt=3),h.flags&=-257,h.flags|=65536,h.lanes=y,p===nv?h.flags|=16384:(u=h.updateQueue,u===null?h.updateQueue=new Set([p]):u.add(p),Jv(o,p,y)),!1;case 22:return h.flags|=65536,p===nv?h.flags|=16384:(u=h.updateQueue,u===null?(u={transitions:null,markerInstances:null,retryQueue:new Set([p])},h.updateQueue=u):(h=u.retryQueue,h===null?u.retryQueue=new Set([p]):h.add(p)),Jv(o,p,y)),!1}throw Error(n(435,h.tag))}return Jv(o,p,y),Zv(),!1}if(pt)return u=Cr.current,u!==null?((u.flags&65536)===0&&(u.flags|=256),u.flags|=65536,u.lanes=y,p!==$p&&(o=Error(n(422),{cause:p}),ml(wr(o,h)))):(p!==$p&&(u=Error(n(423),{cause:p}),ml(wr(u,h))),o=o.current.alternate,o.flags|=65536,y&=-y,o.lanes|=y,p=wr(p,h),y=Tv(o.stateNode,p,y),iv(o,y),Pt!==4&&(Pt=2)),!1;var x=Error(n(520),{cause:p});if(x=wr(x,h),Ll===null?Ll=[x]:Ll.push(x),Pt!==4&&(Pt=2),u===null)return!0;p=wr(p,h),h=u;do{switch(h.tag){case 3:return h.flags|=65536,o=y&-y,h.lanes|=o,o=Tv(h.stateNode,p,o),iv(h,o),!1;case 1:if(u=h.type,x=h.stateNode,(h.flags&128)===0&&(typeof u.getDerivedStateFromError=="function"||x!==null&&typeof x.componentDidCatch=="function"&&(Oi===null||!Oi.has(x))))return h.flags|=65536,y&=-y,h.lanes|=y,y=ex(y),tx(y,o,h,p),iv(h,y),!1}h=h.return}while(h!==null);return!1}var nx=Error(n(461)),ln=!1;function yn(o,u,h,p){u.child=o===null?q1(u,null,h,p):zs(u,o.child,h,p)}function rx(o,u,h,p,y){h=h.render;var x=u.ref;if("ref"in p){var A={};for(var O in p)O!=="ref"&&(A[O]=p[O])}else A=p;return Do(u),p=cv(o,u,h,A,x,y),O=fv(),o!==null&&!ln?(hv(o,u,y),Va(o,u,y)):(pt&&O&&Kp(u),u.flags|=1,yn(o,u,p,y),u.child)}function ax(o,u,h,p,y){if(o===null){var x=h.type;return typeof x=="function"&&!Wp(x)&&x.defaultProps===void 0&&h.compare===null?(u.tag=15,u.type=x,ix(o,u,x,p,y)):(o=Sf(h.type,null,p,u,u.mode,y),o.ref=u.ref,o.return=u,u.child=o)}if(x=o.child,!Fv(o,y)){var A=x.memoizedProps;if(h=h.compare,h=h!==null?h:hl,h(A,p)&&o.ref===u.ref)return Va(o,u,y)}return u.flags|=1,o=Ia(x,p),o.ref=u.ref,o.return=u,u.child=o}function ix(o,u,h,p,y){if(o!==null){var x=o.memoizedProps;if(hl(x,p)&&o.ref===u.ref)if(ln=!1,u.pendingProps=p=x,Fv(o,y))(o.flags&131072)!==0&&(ln=!0);else return u.lanes=o.lanes,Va(o,u,y)}return Av(o,u,h,p,y)}function ox(o,u,h){var p=u.pendingProps,y=p.children,x=o!==null?o.memoizedState:null;if(p.mode==="hidden"){if((u.flags&128)!==0){if(p=x!==null?x.baseLanes|h:h,o!==null){for(y=u.child=o.child,x=0;y!==null;)x=x|y.lanes|y.childLanes,y=y.sibling;u.childLanes=x&~p}else u.childLanes=0,u.child=null;return sx(o,u,p,h)}if((h&536870912)!==0)u.memoizedState={baseLanes:0,cachePool:null},o!==null&&Af(u,x!==null?x.cachePool:null),x!==null?i1(u,x):sv(),K1(u);else return u.lanes=u.childLanes=536870912,sx(o,u,x!==null?x.baseLanes|h:h,h)}else x!==null?(Af(u,x.cachePool),i1(u,x),Ci(),u.memoizedState=null):(o!==null&&Af(u,null),sv(),Ci());return yn(o,u,y,h),u.child}function sx(o,u,h,p){var y=tv();return y=y===null?null:{parent:Zt._currentValue,pool:y},u.memoizedState={baseLanes:h,cachePool:y},o!==null&&Af(u,null),sv(),K1(u),o!==null&&gl(o,u,p,!0),null}function Gf(o,u){var h=u.ref;if(h===null)o!==null&&o.ref!==null&&(u.flags|=4194816);else{if(typeof h!="function"&&typeof h!="object")throw Error(n(284));(o===null||o.ref!==h)&&(u.flags|=4194816)}}function Av(o,u,h,p,y){return Do(u),h=cv(o,u,h,p,void 0,y),p=fv(),o!==null&&!ln?(hv(o,u,y),Va(o,u,y)):(pt&&p&&Kp(u),u.flags|=1,yn(o,u,h,y),u.child)}function ux(o,u,h,p,y,x){return Do(u),u.updateQueue=null,h=s1(u,p,h,y),o1(o),p=fv(),o!==null&&!ln?(hv(o,u,x),Va(o,u,x)):(pt&&p&&Kp(u),u.flags|=1,yn(o,u,h,x),u.child)}function lx(o,u,h,p,y){if(Do(u),u.stateNode===null){var x=Ds,A=h.contextType;typeof A=="object"&&A!==null&&(x=Rn(A)),x=new h(p,x),u.memoizedState=x.state!==null&&x.state!==void 0?x.state:null,x.updater=Rv,u.stateNode=x,x._reactInternals=u,x=u.stateNode,x.props=p,x.state=u.memoizedState,x.refs={},rv(u),A=h.contextType,x.context=typeof A=="object"&&A!==null?Rn(A):Ds,x.state=u.memoizedState,A=h.getDerivedStateFromProps,typeof A=="function"&&(Cv(u,h,A,p),x.state=u.memoizedState),typeof h.getDerivedStateFromProps=="function"||typeof x.getSnapshotBeforeUpdate=="function"||typeof x.UNSAFE_componentWillMount!="function"&&typeof x.componentWillMount!="function"||(A=x.state,typeof x.componentWillMount=="function"&&x.componentWillMount(),typeof x.UNSAFE_componentWillMount=="function"&&x.UNSAFE_componentWillMount(),A!==x.state&&Rv.enqueueReplaceState(x,x.state,null),El(u,p,x,y),Sl(),x.state=u.memoizedState),typeof x.componentDidMount=="function"&&(u.flags|=4194308),p=!0}else if(o===null){x=u.stateNode;var O=u.memoizedProps,V=No(h,O);x.props=V;var Q=x.context,ce=h.contextType;A=Ds,typeof ce=="object"&&ce!==null&&(A=Rn(ce));var he=h.getDerivedStateFromProps;ce=typeof he=="function"||typeof x.getSnapshotBeforeUpdate=="function",O=u.pendingProps!==O,ce||typeof x.UNSAFE_componentWillReceiveProps!="function"&&typeof x.componentWillReceiveProps!="function"||(O||Q!==A)&&$1(u,x,p,A),xi=!1;var te=u.memoizedState;x.state=te,El(u,p,x,y),Sl(),Q=u.memoizedState,O||te!==Q||xi?(typeof he=="function"&&(Cv(u,h,he,p),Q=u.memoizedState),(V=xi||X1(u,h,V,p,te,Q,A))?(ce||typeof x.UNSAFE_componentWillMount!="function"&&typeof x.componentWillMount!="function"||(typeof x.componentWillMount=="function"&&x.componentWillMount(),typeof x.UNSAFE_componentWillMount=="function"&&x.UNSAFE_componentWillMount()),typeof x.componentDidMount=="function"&&(u.flags|=4194308)):(typeof x.componentDidMount=="function"&&(u.flags|=4194308),u.memoizedProps=p,u.memoizedState=Q),x.props=p,x.state=Q,x.context=A,p=V):(typeof x.componentDidMount=="function"&&(u.flags|=4194308),p=!1)}else{x=u.stateNode,av(o,u),A=u.memoizedProps,ce=No(h,A),x.props=ce,he=u.pendingProps,te=x.context,Q=h.contextType,V=Ds,typeof Q=="object"&&Q!==null&&(V=Rn(Q)),O=h.getDerivedStateFromProps,(Q=typeof O=="function"||typeof x.getSnapshotBeforeUpdate=="function")||typeof x.UNSAFE_componentWillReceiveProps!="function"&&typeof x.componentWillReceiveProps!="function"||(A!==he||te!==V)&&$1(u,x,p,V),xi=!1,te=u.memoizedState,x.state=te,El(u,p,x,y),Sl();var ae=u.memoizedState;A!==he||te!==ae||xi||o!==null&&o.dependencies!==null&&Rf(o.dependencies)?(typeof O=="function"&&(Cv(u,h,O,p),ae=u.memoizedState),(ce=xi||X1(u,h,ce,p,te,ae,V)||o!==null&&o.dependencies!==null&&Rf(o.dependencies))?(Q||typeof x.UNSAFE_componentWillUpdate!="function"&&typeof x.componentWillUpdate!="function"||(typeof x.componentWillUpdate=="function"&&x.componentWillUpdate(p,ae,V),typeof x.UNSAFE_componentWillUpdate=="function"&&x.UNSAFE_componentWillUpdate(p,ae,V)),typeof x.componentDidUpdate=="function"&&(u.flags|=4),typeof x.getSnapshotBeforeUpdate=="function"&&(u.flags|=1024)):(typeof x.componentDidUpdate!="function"||A===o.memoizedProps&&te===o.memoizedState||(u.flags|=4),typeof x.getSnapshotBeforeUpdate!="function"||A===o.memoizedProps&&te===o.memoizedState||(u.flags|=1024),u.memoizedProps=p,u.memoizedState=ae),x.props=p,x.state=ae,x.context=V,p=ce):(typeof x.componentDidUpdate!="function"||A===o.memoizedProps&&te===o.memoizedState||(u.flags|=4),typeof x.getSnapshotBeforeUpdate!="function"||A===o.memoizedProps&&te===o.memoizedState||(u.flags|=1024),p=!1)}return x=p,Gf(o,u),p=(u.flags&128)!==0,x||p?(x=u.stateNode,h=p&&typeof h.getDerivedStateFromError!="function"?null:x.render(),u.flags|=1,o!==null&&p?(u.child=zs(u,o.child,null,y),u.child=zs(u,null,h,y)):yn(o,u,h,y),u.memoizedState=x.state,o=u.child):o=Va(o,u,y),o}function cx(o,u,h,p){return vl(),u.flags|=256,yn(o,u,h,p),u.child}var Dv={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function kv(o){return{baseLanes:o,cachePool:Zb()}}function Ov(o,u,h){return o=o!==null?o.childLanes&~h:0,u&&(o|=Rr),o}function fx(o,u,h){var p=u.pendingProps,y=!1,x=(u.flags&128)!==0,A;if((A=x)||(A=o!==null&&o.memoizedState===null?!1:(Qt.current&2)!==0),A&&(y=!0,u.flags&=-129),A=(u.flags&32)!==0,u.flags&=-33,o===null){if(pt){if(y?Ei(u):Ci(),pt){var O=Lt,V;if(V=O){e:{for(V=O,O=ta;V.nodeType!==8;){if(!O){O=null;break e}if(V=Ur(V.nextSibling),V===null){O=null;break e}}O=V}O!==null?(u.memoizedState={dehydrated:O,treeContext:Eo!==null?{id:Fa,overflow:Ba}:null,retryLane:536870912,hydrationErrors:null},V=nr(18,null,null,0),V.stateNode=O,V.return=u,u.child=V,Bn=u,Lt=null,V=!0):V=!1}V||To(u)}if(O=u.memoizedState,O!==null&&(O=O.dehydrated,O!==null))return pm(O)?u.lanes=32:u.lanes=536870912,null;Ua(u)}return O=p.children,p=p.fallback,y?(Ci(),y=u.mode,O=qf({mode:"hidden",children:O},y),p=So(p,y,h,null),O.return=u,p.return=u,O.sibling=p,u.child=O,y=u.child,y.memoizedState=kv(h),y.childLanes=Ov(o,A,h),u.memoizedState=Dv,p):(Ei(u),Nv(u,O))}if(V=o.memoizedState,V!==null&&(O=V.dehydrated,O!==null)){if(x)u.flags&256?(Ei(u),u.flags&=-257,u=Mv(o,u,h)):u.memoizedState!==null?(Ci(),u.child=o.child,u.flags|=128,u=null):(Ci(),y=p.fallback,O=u.mode,p=qf({mode:"visible",children:p.children},O),y=So(y,O,h,null),y.flags|=2,p.return=u,y.return=u,p.sibling=y,u.child=p,zs(u,o.child,null,h),p=u.child,p.memoizedState=kv(h),p.childLanes=Ov(o,A,h),u.memoizedState=Dv,u=y);else if(Ei(u),pm(O)){if(A=O.nextSibling&&O.nextSibling.dataset,A)var Q=A.dgst;A=Q,p=Error(n(419)),p.stack="",p.digest=A,ml({value:p,source:null,stack:null}),u=Mv(o,u,h)}else if(ln||gl(o,u,h,!1),A=(h&o.childLanes)!==0,ln||A){if(A=Rt,A!==null&&(p=h&-h,p=(p&42)!==0?1:vp(p),p=(p&(A.suspendedLanes|h))!==0?0:p,p!==0&&p!==V.retryLane))throw V.retryLane=p,As(o,p),sr(A,o,p),nx;O.data==="$?"||Zv(),u=Mv(o,u,h)}else O.data==="$?"?(u.flags|=192,u.child=o.child,u=null):(o=V.treeContext,Lt=Ur(O.nextSibling),Bn=u,pt=!0,Ro=null,ta=!1,o!==null&&(Sr[Er++]=Fa,Sr[Er++]=Ba,Sr[Er++]=Eo,Fa=o.id,Ba=o.overflow,Eo=u),u=Nv(u,p.children),u.flags|=4096);return u}return y?(Ci(),y=p.fallback,O=u.mode,V=o.child,Q=V.sibling,p=Ia(V,{mode:"hidden",children:p.children}),p.subtreeFlags=V.subtreeFlags&65011712,Q!==null?y=Ia(Q,y):(y=So(y,O,h,null),y.flags|=2),y.return=u,p.return=u,p.sibling=y,u.child=p,p=y,y=u.child,O=o.child.memoizedState,O===null?O=kv(h):(V=O.cachePool,V!==null?(Q=Zt._currentValue,V=V.parent!==Q?{parent:Q,pool:Q}:V):V=Zb(),O={baseLanes:O.baseLanes|h,cachePool:V}),y.memoizedState=O,y.childLanes=Ov(o,A,h),u.memoizedState=Dv,p):(Ei(u),h=o.child,o=h.sibling,h=Ia(h,{mode:"visible",children:p.children}),h.return=u,h.sibling=null,o!==null&&(A=u.deletions,A===null?(u.deletions=[o],u.flags|=16):A.push(o)),u.child=h,u.memoizedState=null,h)}function Nv(o,u){return u=qf({mode:"visible",children:u},o.mode),u.return=o,o.child=u}function qf(o,u){return o=nr(22,o,null,u),o.lanes=0,o.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},o}function Mv(o,u,h){return zs(u,o.child,null,h),o=Nv(u,u.pendingProps.children),o.flags|=2,u.memoizedState=null,o}function hx(o,u,h){o.lanes|=u;var p=o.alternate;p!==null&&(p.lanes|=u),Zp(o.return,u,h)}function Iv(o,u,h,p,y){var x=o.memoizedState;x===null?o.memoizedState={isBackwards:u,rendering:null,renderingStartTime:0,last:p,tail:h,tailMode:y}:(x.isBackwards=u,x.rendering=null,x.renderingStartTime=0,x.last=p,x.tail=h,x.tailMode=y)}function dx(o,u,h){var p=u.pendingProps,y=p.revealOrder,x=p.tail;if(yn(o,u,p.children,h),p=Qt.current,(p&2)!==0)p=p&1|2,u.flags|=128;else{if(o!==null&&(o.flags&128)!==0)e:for(o=u.child;o!==null;){if(o.tag===13)o.memoizedState!==null&&hx(o,h,u);else if(o.tag===19)hx(o,h,u);else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===u)break e;for(;o.sibling===null;){if(o.return===null||o.return===u)break e;o=o.return}o.sibling.return=o.return,o=o.sibling}p&=1}switch(ue(Qt,p),y){case"forwards":for(h=u.child,y=null;h!==null;)o=h.alternate,o!==null&&Hf(o)===null&&(y=h),h=h.sibling;h=y,h===null?(y=u.child,u.child=null):(y=h.sibling,h.sibling=null),Iv(u,!1,y,h,x);break;case"backwards":for(h=null,y=u.child,u.child=null;y!==null;){if(o=y.alternate,o!==null&&Hf(o)===null){u.child=y;break}o=y.sibling,y.sibling=h,h=y,y=o}Iv(u,!0,h,null,x);break;case"together":Iv(u,!1,null,null,void 0);break;default:u.memoizedState=null}return u.child}function Va(o,u,h){if(o!==null&&(u.dependencies=o.dependencies),ki|=u.lanes,(h&u.childLanes)===0)if(o!==null){if(gl(o,u,h,!1),(h&u.childLanes)===0)return null}else return null;if(o!==null&&u.child!==o.child)throw Error(n(153));if(u.child!==null){for(o=u.child,h=Ia(o,o.pendingProps),u.child=h,h.return=u;o.sibling!==null;)o=o.sibling,h=h.sibling=Ia(o,o.pendingProps),h.return=u;h.sibling=null}return u.child}function Fv(o,u){return(o.lanes&u)!==0?!0:(o=o.dependencies,!!(o!==null&&Rf(o)))}function oA(o,u,h){switch(u.tag){case 3:xe(u,u.stateNode.containerInfo),bi(u,Zt,o.memoizedState.cache),vl();break;case 27:case 5:ct(u);break;case 4:xe(u,u.stateNode.containerInfo);break;case 10:bi(u,u.type,u.memoizedProps.value);break;case 13:var p=u.memoizedState;if(p!==null)return p.dehydrated!==null?(Ei(u),u.flags|=128,null):(h&u.child.childLanes)!==0?fx(o,u,h):(Ei(u),o=Va(o,u,h),o!==null?o.sibling:null);Ei(u);break;case 19:var y=(o.flags&128)!==0;if(p=(h&u.childLanes)!==0,p||(gl(o,u,h,!1),p=(h&u.childLanes)!==0),y){if(p)return dx(o,u,h);u.flags|=128}if(y=u.memoizedState,y!==null&&(y.rendering=null,y.tail=null,y.lastEffect=null),ue(Qt,Qt.current),p)break;return null;case 22:case 23:return u.lanes=0,ox(o,u,h);case 24:bi(u,Zt,o.memoizedState.cache)}return Va(o,u,h)}function px(o,u,h){if(o!==null)if(o.memoizedProps!==u.pendingProps)ln=!0;else{if(!Fv(o,h)&&(u.flags&128)===0)return ln=!1,oA(o,u,h);ln=(o.flags&131072)!==0}else ln=!1,pt&&(u.flags&1048576)!==0&&Wb(u,Cf,u.index);switch(u.lanes=0,u.tag){case 16:e:{o=u.pendingProps;var p=u.elementType,y=p._init;if(p=y(p._payload),u.type=p,typeof p=="function")Wp(p)?(o=No(p,o),u.tag=1,u=lx(null,u,p,o,h)):(u.tag=0,u=Av(null,u,p,o,h));else{if(p!=null){if(y=p.$$typeof,y===R){u.tag=11,u=rx(null,u,p,o,h);break e}else if(y===k){u.tag=14,u=ax(null,u,p,o,h);break e}}throw u=re(p)||p,Error(n(306,u,""))}}return u;case 0:return Av(o,u,u.type,u.pendingProps,h);case 1:return p=u.type,y=No(p,u.pendingProps),lx(o,u,p,y,h);case 3:e:{if(xe(u,u.stateNode.containerInfo),o===null)throw Error(n(387));p=u.pendingProps;var x=u.memoizedState;y=x.element,av(o,u),El(u,p,null,h);var A=u.memoizedState;if(p=A.cache,bi(u,Zt,p),p!==x.cache&&Qp(u,[Zt],h,!0),Sl(),p=A.element,x.isDehydrated)if(x={element:p,isDehydrated:!1,cache:A.cache},u.updateQueue.baseState=x,u.memoizedState=x,u.flags&256){u=cx(o,u,p,h);break e}else if(p!==y){y=wr(Error(n(424)),u),ml(y),u=cx(o,u,p,h);break e}else{switch(o=u.stateNode.containerInfo,o.nodeType){case 9:o=o.body;break;default:o=o.nodeName==="HTML"?o.ownerDocument.body:o}for(Lt=Ur(o.firstChild),Bn=u,pt=!0,Ro=null,ta=!0,h=q1(u,null,p,h),u.child=h;h;)h.flags=h.flags&-3|4096,h=h.sibling}else{if(vl(),p===y){u=Va(o,u,h);break e}yn(o,u,p,h)}u=u.child}return u;case 26:return Gf(o,u),o===null?(h=yw(u.type,null,u.pendingProps,null))?u.memoizedState=h:pt||(h=u.type,o=u.pendingProps,p=oh(me.current).createElement(h),p[Cn]=u,p[Hn]=o,xn(p,h,o),un(p),u.stateNode=p):u.memoizedState=yw(u.type,o.memoizedProps,u.pendingProps,o.memoizedState),null;case 27:return ct(u),o===null&&pt&&(p=u.stateNode=vw(u.type,u.pendingProps,me.current),Bn=u,ta=!0,y=Lt,Ii(u.type)?(vm=y,Lt=Ur(p.firstChild)):Lt=y),yn(o,u,u.pendingProps.children,h),Gf(o,u),o===null&&(u.flags|=4194304),u.child;case 5:return o===null&&pt&&((y=p=Lt)&&(p=IA(p,u.type,u.pendingProps,ta),p!==null?(u.stateNode=p,Bn=u,Lt=Ur(p.firstChild),ta=!1,y=!0):y=!1),y||To(u)),ct(u),y=u.type,x=u.pendingProps,A=o!==null?o.memoizedProps:null,p=x.children,fm(y,x)?p=null:A!==null&&fm(y,A)&&(u.flags|=32),u.memoizedState!==null&&(y=cv(o,u,QT,null,null,h),ql._currentValue=y),Gf(o,u),yn(o,u,p,h),u.child;case 6:return o===null&&pt&&((o=h=Lt)&&(h=FA(h,u.pendingProps,ta),h!==null?(u.stateNode=h,Bn=u,Lt=null,o=!0):o=!1),o||To(u)),null;case 13:return fx(o,u,h);case 4:return xe(u,u.stateNode.containerInfo),p=u.pendingProps,o===null?u.child=zs(u,null,p,h):yn(o,u,p,h),u.child;case 11:return rx(o,u,u.type,u.pendingProps,h);case 7:return yn(o,u,u.pendingProps,h),u.child;case 8:return yn(o,u,u.pendingProps.children,h),u.child;case 12:return yn(o,u,u.pendingProps.children,h),u.child;case 10:return p=u.pendingProps,bi(u,u.type,p.value),yn(o,u,p.children,h),u.child;case 9:return y=u.type._context,p=u.pendingProps.children,Do(u),y=Rn(y),p=p(y),u.flags|=1,yn(o,u,p,h),u.child;case 14:return ax(o,u,u.type,u.pendingProps,h);case 15:return ix(o,u,u.type,u.pendingProps,h);case 19:return dx(o,u,h);case 31:return p=u.pendingProps,h=u.mode,p={mode:p.mode,children:p.children},o===null?(h=qf(p,h),h.ref=u.ref,u.child=h,h.return=u,u=h):(h=Ia(o.child,p),h.ref=u.ref,u.child=h,h.return=u,u=h),u;case 22:return ox(o,u,h);case 24:return Do(u),p=Rn(Zt),o===null?(y=tv(),y===null&&(y=Rt,x=Jp(),y.pooledCache=x,x.refCount++,x!==null&&(y.pooledCacheLanes|=h),y=x),u.memoizedState={parent:p,cache:y},rv(u),bi(u,Zt,y)):((o.lanes&h)!==0&&(av(o,u),El(u,null,null,h),Sl()),y=o.memoizedState,x=u.memoizedState,y.parent!==p?(y={parent:p,cache:p},u.memoizedState=y,u.lanes===0&&(u.memoizedState=u.updateQueue.baseState=y),bi(u,Zt,p)):(p=x.cache,bi(u,Zt,p),p!==y.cache&&Qp(u,[Zt],h,!0))),yn(o,u,u.pendingProps.children,h),u.child;case 29:throw u.pendingProps}throw Error(n(156,u.tag))}function Ha(o){o.flags|=4}function vx(o,u){if(u.type!=="stylesheet"||(u.state.loading&4)!==0)o.flags&=-16777217;else if(o.flags|=16777216,!Sw(u)){if(u=Cr.current,u!==null&&((st&4194048)===st?na!==null:(st&62914560)!==st&&(st&536870912)===0||u!==na))throw wl=nv,Qb;o.flags|=8192}}function Kf(o,u){u!==null&&(o.flags|=4),o.flags&16384&&(u=o.tag!==22?K0():536870912,o.lanes|=u,js|=u)}function Ol(o,u){if(!pt)switch(o.tailMode){case"hidden":u=o.tail;for(var h=null;u!==null;)u.alternate!==null&&(h=u),u=u.sibling;h===null?o.tail=null:h.sibling=null;break;case"collapsed":h=o.tail;for(var p=null;h!==null;)h.alternate!==null&&(p=h),h=h.sibling;p===null?u||o.tail===null?o.tail=null:o.tail.sibling=null:p.sibling=null}}function Ot(o){var u=o.alternate!==null&&o.alternate.child===o.child,h=0,p=0;if(u)for(var y=o.child;y!==null;)h|=y.lanes|y.childLanes,p|=y.subtreeFlags&65011712,p|=y.flags&65011712,y.return=o,y=y.sibling;else for(y=o.child;y!==null;)h|=y.lanes|y.childLanes,p|=y.subtreeFlags,p|=y.flags,y.return=o,y=y.sibling;return o.subtreeFlags|=p,o.childLanes=h,u}function sA(o,u,h){var p=u.pendingProps;switch(Xp(u),u.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ot(u),null;case 1:return Ot(u),null;case 3:return h=u.stateNode,p=null,o!==null&&(p=o.memoizedState.cache),u.memoizedState.cache!==p&&(u.flags|=2048),Pa(Zt),Ie(),h.pendingContext&&(h.context=h.pendingContext,h.pendingContext=null),(o===null||o.child===null)&&(pl(u)?Ha(u):o===null||o.memoizedState.isDehydrated&&(u.flags&256)===0||(u.flags|=1024,Kb())),Ot(u),null;case 26:return h=u.memoizedState,o===null?(Ha(u),h!==null?(Ot(u),vx(u,h)):(Ot(u),u.flags&=-16777217)):h?h!==o.memoizedState?(Ha(u),Ot(u),vx(u,h)):(Ot(u),u.flags&=-16777217):(o.memoizedProps!==p&&Ha(u),Ot(u),u.flags&=-16777217),null;case 27:Pe(u),h=me.current;var y=u.type;if(o!==null&&u.stateNode!=null)o.memoizedProps!==p&&Ha(u);else{if(!p){if(u.stateNode===null)throw Error(n(166));return Ot(u),null}o=pe.current,pl(u)?Gb(u):(o=vw(y,p,h),u.stateNode=o,Ha(u))}return Ot(u),null;case 5:if(Pe(u),h=u.type,o!==null&&u.stateNode!=null)o.memoizedProps!==p&&Ha(u);else{if(!p){if(u.stateNode===null)throw Error(n(166));return Ot(u),null}if(o=pe.current,pl(u))Gb(u);else{switch(y=oh(me.current),o){case 1:o=y.createElementNS("http://www.w3.org/2000/svg",h);break;case 2:o=y.createElementNS("http://www.w3.org/1998/Math/MathML",h);break;default:switch(h){case"svg":o=y.createElementNS("http://www.w3.org/2000/svg",h);break;case"math":o=y.createElementNS("http://www.w3.org/1998/Math/MathML",h);break;case"script":o=y.createElement("div"),o.innerHTML="<script><\/script>",o=o.removeChild(o.firstChild);break;case"select":o=typeof p.is=="string"?y.createElement("select",{is:p.is}):y.createElement("select"),p.multiple?o.multiple=!0:p.size&&(o.size=p.size);break;default:o=typeof p.is=="string"?y.createElement(h,{is:p.is}):y.createElement(h)}}o[Cn]=u,o[Hn]=p;e:for(y=u.child;y!==null;){if(y.tag===5||y.tag===6)o.appendChild(y.stateNode);else if(y.tag!==4&&y.tag!==27&&y.child!==null){y.child.return=y,y=y.child;continue}if(y===u)break e;for(;y.sibling===null;){if(y.return===null||y.return===u)break e;y=y.return}y.sibling.return=y.return,y=y.sibling}u.stateNode=o;e:switch(xn(o,h,p),h){case"button":case"input":case"select":case"textarea":o=!!p.autoFocus;break e;case"img":o=!0;break e;default:o=!1}o&&Ha(u)}}return Ot(u),u.flags&=-16777217,null;case 6:if(o&&u.stateNode!=null)o.memoizedProps!==p&&Ha(u);else{if(typeof p!="string"&&u.stateNode===null)throw Error(n(166));if(o=me.current,pl(u)){if(o=u.stateNode,h=u.memoizedProps,p=null,y=Bn,y!==null)switch(y.tag){case 27:case 5:p=y.memoizedProps}o[Cn]=u,o=!!(o.nodeValue===h||p!==null&&p.suppressHydrationWarning===!0||uw(o.nodeValue,h)),o||To(u)}else o=oh(o).createTextNode(p),o[Cn]=u,u.stateNode=o}return Ot(u),null;case 13:if(p=u.memoizedState,o===null||o.memoizedState!==null&&o.memoizedState.dehydrated!==null){if(y=pl(u),p!==null&&p.dehydrated!==null){if(o===null){if(!y)throw Error(n(318));if(y=u.memoizedState,y=y!==null?y.dehydrated:null,!y)throw Error(n(317));y[Cn]=u}else vl(),(u.flags&128)===0&&(u.memoizedState=null),u.flags|=4;Ot(u),y=!1}else y=Kb(),o!==null&&o.memoizedState!==null&&(o.memoizedState.hydrationErrors=y),y=!0;if(!y)return u.flags&256?(Ua(u),u):(Ua(u),null)}if(Ua(u),(u.flags&128)!==0)return u.lanes=h,u;if(h=p!==null,o=o!==null&&o.memoizedState!==null,h){p=u.child,y=null,p.alternate!==null&&p.alternate.memoizedState!==null&&p.alternate.memoizedState.cachePool!==null&&(y=p.alternate.memoizedState.cachePool.pool);var x=null;p.memoizedState!==null&&p.memoizedState.cachePool!==null&&(x=p.memoizedState.cachePool.pool),x!==y&&(p.flags|=2048)}return h!==o&&h&&(u.child.flags|=8192),Kf(u,u.updateQueue),Ot(u),null;case 4:return Ie(),o===null&&om(u.stateNode.containerInfo),Ot(u),null;case 10:return Pa(u.type),Ot(u),null;case 19:if(oe(Qt),y=u.memoizedState,y===null)return Ot(u),null;if(p=(u.flags&128)!==0,x=y.rendering,x===null)if(p)Ol(y,!1);else{if(Pt!==0||o!==null&&(o.flags&128)!==0)for(o=u.child;o!==null;){if(x=Hf(o),x!==null){for(u.flags|=128,Ol(y,!1),o=x.updateQueue,u.updateQueue=o,Kf(u,o),u.subtreeFlags=0,o=h,h=u.child;h!==null;)jb(h,o),h=h.sibling;return ue(Qt,Qt.current&1|2),u.child}o=o.sibling}y.tail!==null&&Vt()>Yf&&(u.flags|=128,p=!0,Ol(y,!1),u.lanes=4194304)}else{if(!p)if(o=Hf(x),o!==null){if(u.flags|=128,p=!0,o=o.updateQueue,u.updateQueue=o,Kf(u,o),Ol(y,!0),y.tail===null&&y.tailMode==="hidden"&&!x.alternate&&!pt)return Ot(u),null}else 2*Vt()-y.renderingStartTime>Yf&&h!==536870912&&(u.flags|=128,p=!0,Ol(y,!1),u.lanes=4194304);y.isBackwards?(x.sibling=u.child,u.child=x):(o=y.last,o!==null?o.sibling=x:u.child=x,y.last=x)}return y.tail!==null?(u=y.tail,y.rendering=u,y.tail=u.sibling,y.renderingStartTime=Vt(),u.sibling=null,o=Qt.current,ue(Qt,p?o&1|2:o&1),u):(Ot(u),null);case 22:case 23:return Ua(u),uv(),p=u.memoizedState!==null,o!==null?o.memoizedState!==null!==p&&(u.flags|=8192):p&&(u.flags|=8192),p?(h&536870912)!==0&&(u.flags&128)===0&&(Ot(u),u.subtreeFlags&6&&(u.flags|=8192)):Ot(u),h=u.updateQueue,h!==null&&Kf(u,h.retryQueue),h=null,o!==null&&o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(h=o.memoizedState.cachePool.pool),p=null,u.memoizedState!==null&&u.memoizedState.cachePool!==null&&(p=u.memoizedState.cachePool.pool),p!==h&&(u.flags|=2048),o!==null&&oe(ko),null;case 24:return h=null,o!==null&&(h=o.memoizedState.cache),u.memoizedState.cache!==h&&(u.flags|=2048),Pa(Zt),Ot(u),null;case 25:return null;case 30:return null}throw Error(n(156,u.tag))}function uA(o,u){switch(Xp(u),u.tag){case 1:return o=u.flags,o&65536?(u.flags=o&-65537|128,u):null;case 3:return Pa(Zt),Ie(),o=u.flags,(o&65536)!==0&&(o&128)===0?(u.flags=o&-65537|128,u):null;case 26:case 27:case 5:return Pe(u),null;case 13:if(Ua(u),o=u.memoizedState,o!==null&&o.dehydrated!==null){if(u.alternate===null)throw Error(n(340));vl()}return o=u.flags,o&65536?(u.flags=o&-65537|128,u):null;case 19:return oe(Qt),null;case 4:return Ie(),null;case 10:return Pa(u.type),null;case 22:case 23:return Ua(u),uv(),o!==null&&oe(ko),o=u.flags,o&65536?(u.flags=o&-65537|128,u):null;case 24:return Pa(Zt),null;case 25:return null;default:return null}}function mx(o,u){switch(Xp(u),u.tag){case 3:Pa(Zt),Ie();break;case 26:case 27:case 5:Pe(u);break;case 4:Ie();break;case 13:Ua(u);break;case 19:oe(Qt);break;case 10:Pa(u.type);break;case 22:case 23:Ua(u),uv(),o!==null&&oe(ko);break;case 24:Pa(Zt)}}function Nl(o,u){try{var h=u.updateQueue,p=h!==null?h.lastEffect:null;if(p!==null){var y=p.next;h=y;do{if((h.tag&o)===o){p=void 0;var x=h.create,A=h.inst;p=x(),A.destroy=p}h=h.next}while(h!==y)}}catch(O){Ct(u,u.return,O)}}function Ri(o,u,h){try{var p=u.updateQueue,y=p!==null?p.lastEffect:null;if(y!==null){var x=y.next;p=x;do{if((p.tag&o)===o){var A=p.inst,O=A.destroy;if(O!==void 0){A.destroy=void 0,y=u;var V=h,Q=O;try{Q()}catch(ce){Ct(y,V,ce)}}}p=p.next}while(p!==x)}}catch(ce){Ct(u,u.return,ce)}}function gx(o){var u=o.updateQueue;if(u!==null){var h=o.stateNode;try{a1(u,h)}catch(p){Ct(o,o.return,p)}}}function yx(o,u,h){h.props=No(o.type,o.memoizedProps),h.state=o.memoizedState;try{h.componentWillUnmount()}catch(p){Ct(o,u,p)}}function Ml(o,u){try{var h=o.ref;if(h!==null){switch(o.tag){case 26:case 27:case 5:var p=o.stateNode;break;case 30:p=o.stateNode;break;default:p=o.stateNode}typeof h=="function"?o.refCleanup=h(p):h.current=p}}catch(y){Ct(o,u,y)}}function ra(o,u){var h=o.ref,p=o.refCleanup;if(h!==null)if(typeof p=="function")try{p()}catch(y){Ct(o,u,y)}finally{o.refCleanup=null,o=o.alternate,o!=null&&(o.refCleanup=null)}else if(typeof h=="function")try{h(null)}catch(y){Ct(o,u,y)}else h.current=null}function bx(o){var u=o.type,h=o.memoizedProps,p=o.stateNode;try{e:switch(u){case"button":case"input":case"select":case"textarea":h.autoFocus&&p.focus();break e;case"img":h.src?p.src=h.src:h.srcSet&&(p.srcset=h.srcSet)}}catch(y){Ct(o,o.return,y)}}function Bv(o,u,h){try{var p=o.stateNode;DA(p,o.type,h,u),p[Hn]=u}catch(y){Ct(o,o.return,y)}}function xx(o){return o.tag===5||o.tag===3||o.tag===26||o.tag===27&&Ii(o.type)||o.tag===4}function Lv(o){e:for(;;){for(;o.sibling===null;){if(o.return===null||xx(o.return))return null;o=o.return}for(o.sibling.return=o.return,o=o.sibling;o.tag!==5&&o.tag!==6&&o.tag!==18;){if(o.tag===27&&Ii(o.type)||o.flags&2||o.child===null||o.tag===4)continue e;o.child.return=o,o=o.child}if(!(o.flags&2))return o.stateNode}}function Pv(o,u,h){var p=o.tag;if(p===5||p===6)o=o.stateNode,u?(h.nodeType===9?h.body:h.nodeName==="HTML"?h.ownerDocument.body:h).insertBefore(o,u):(u=h.nodeType===9?h.body:h.nodeName==="HTML"?h.ownerDocument.body:h,u.appendChild(o),h=h._reactRootContainer,h!=null||u.onclick!==null||(u.onclick=ih));else if(p!==4&&(p===27&&Ii(o.type)&&(h=o.stateNode,u=null),o=o.child,o!==null))for(Pv(o,u,h),o=o.sibling;o!==null;)Pv(o,u,h),o=o.sibling}function Xf(o,u,h){var p=o.tag;if(p===5||p===6)o=o.stateNode,u?h.insertBefore(o,u):h.appendChild(o);else if(p!==4&&(p===27&&Ii(o.type)&&(h=o.stateNode),o=o.child,o!==null))for(Xf(o,u,h),o=o.sibling;o!==null;)Xf(o,u,h),o=o.sibling}function wx(o){var u=o.stateNode,h=o.memoizedProps;try{for(var p=o.type,y=u.attributes;y.length;)u.removeAttributeNode(y[0]);xn(u,p,h),u[Cn]=o,u[Hn]=h}catch(x){Ct(o,o.return,x)}}var ja=!1,jt=!1,zv=!1,_x=typeof WeakSet=="function"?WeakSet:Set,cn=null;function lA(o,u){if(o=o.containerInfo,lm=hh,o=Mb(o),Lp(o)){if("selectionStart"in o)var h={start:o.selectionStart,end:o.selectionEnd};else e:{h=(h=o.ownerDocument)&&h.defaultView||window;var p=h.getSelection&&h.getSelection();if(p&&p.rangeCount!==0){h=p.anchorNode;var y=p.anchorOffset,x=p.focusNode;p=p.focusOffset;try{h.nodeType,x.nodeType}catch{h=null;break e}var A=0,O=-1,V=-1,Q=0,ce=0,he=o,te=null;t:for(;;){for(var ae;he!==h||y!==0&&he.nodeType!==3||(O=A+y),he!==x||p!==0&&he.nodeType!==3||(V=A+p),he.nodeType===3&&(A+=he.nodeValue.length),(ae=he.firstChild)!==null;)te=he,he=ae;for(;;){if(he===o)break t;if(te===h&&++Q===y&&(O=A),te===x&&++ce===p&&(V=A),(ae=he.nextSibling)!==null)break;he=te,te=he.parentNode}he=ae}h=O===-1||V===-1?null:{start:O,end:V}}else h=null}h=h||{start:0,end:0}}else h=null;for(cm={focusedElem:o,selectionRange:h},hh=!1,cn=u;cn!==null;)if(u=cn,o=u.child,(u.subtreeFlags&1024)!==0&&o!==null)o.return=u,cn=o;else for(;cn!==null;){switch(u=cn,x=u.alternate,o=u.flags,u.tag){case 0:break;case 11:case 15:break;case 1:if((o&1024)!==0&&x!==null){o=void 0,h=u,y=x.memoizedProps,x=x.memoizedState,p=h.stateNode;try{var Ue=No(h.type,y,h.elementType===h.type);o=p.getSnapshotBeforeUpdate(Ue,x),p.__reactInternalSnapshotBeforeUpdate=o}catch(Be){Ct(h,h.return,Be)}}break;case 3:if((o&1024)!==0){if(o=u.stateNode.containerInfo,h=o.nodeType,h===9)dm(o);else if(h===1)switch(o.nodeName){case"HEAD":case"HTML":case"BODY":dm(o);break;default:o.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((o&1024)!==0)throw Error(n(163))}if(o=u.sibling,o!==null){o.return=u.return,cn=o;break}cn=u.return}}function Sx(o,u,h){var p=h.flags;switch(h.tag){case 0:case 11:case 15:Ti(o,h),p&4&&Nl(5,h);break;case 1:if(Ti(o,h),p&4)if(o=h.stateNode,u===null)try{o.componentDidMount()}catch(A){Ct(h,h.return,A)}else{var y=No(h.type,u.memoizedProps);u=u.memoizedState;try{o.componentDidUpdate(y,u,o.__reactInternalSnapshotBeforeUpdate)}catch(A){Ct(h,h.return,A)}}p&64&&gx(h),p&512&&Ml(h,h.return);break;case 3:if(Ti(o,h),p&64&&(o=h.updateQueue,o!==null)){if(u=null,h.child!==null)switch(h.child.tag){case 27:case 5:u=h.child.stateNode;break;case 1:u=h.child.stateNode}try{a1(o,u)}catch(A){Ct(h,h.return,A)}}break;case 27:u===null&&p&4&&wx(h);case 26:case 5:Ti(o,h),u===null&&p&4&&bx(h),p&512&&Ml(h,h.return);break;case 12:Ti(o,h);break;case 13:Ti(o,h),p&4&&Rx(o,h),p&64&&(o=h.memoizedState,o!==null&&(o=o.dehydrated,o!==null&&(h=yA.bind(null,h),BA(o,h))));break;case 22:if(p=h.memoizedState!==null||ja,!p){u=u!==null&&u.memoizedState!==null||jt,y=ja;var x=jt;ja=p,(jt=u)&&!x?Ai(o,h,(h.subtreeFlags&8772)!==0):Ti(o,h),ja=y,jt=x}break;case 30:break;default:Ti(o,h)}}function Ex(o){var u=o.alternate;u!==null&&(o.alternate=null,Ex(u)),o.child=null,o.deletions=null,o.sibling=null,o.tag===5&&(u=o.stateNode,u!==null&&yp(u)),o.stateNode=null,o.return=null,o.dependencies=null,o.memoizedProps=null,o.memoizedState=null,o.pendingProps=null,o.stateNode=null,o.updateQueue=null}var kt=null,Gn=!1;function Wa(o,u,h){for(h=h.child;h!==null;)Cx(o,u,h),h=h.sibling}function Cx(o,u,h){if(Gt&&typeof Gt.onCommitFiberUnmount=="function")try{Gt.onCommitFiberUnmount(Oa,h)}catch{}switch(h.tag){case 26:jt||ra(h,u),Wa(o,u,h),h.memoizedState?h.memoizedState.count--:h.stateNode&&(h=h.stateNode,h.parentNode.removeChild(h));break;case 27:jt||ra(h,u);var p=kt,y=Gn;Ii(h.type)&&(kt=h.stateNode,Gn=!1),Wa(o,u,h),Hl(h.stateNode),kt=p,Gn=y;break;case 5:jt||ra(h,u);case 6:if(p=kt,y=Gn,kt=null,Wa(o,u,h),kt=p,Gn=y,kt!==null)if(Gn)try{(kt.nodeType===9?kt.body:kt.nodeName==="HTML"?kt.ownerDocument.body:kt).removeChild(h.stateNode)}catch(x){Ct(h,u,x)}else try{kt.removeChild(h.stateNode)}catch(x){Ct(h,u,x)}break;case 18:kt!==null&&(Gn?(o=kt,dw(o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o,h.stateNode),Yl(o)):dw(kt,h.stateNode));break;case 4:p=kt,y=Gn,kt=h.stateNode.containerInfo,Gn=!0,Wa(o,u,h),kt=p,Gn=y;break;case 0:case 11:case 14:case 15:jt||Ri(2,h,u),jt||Ri(4,h,u),Wa(o,u,h);break;case 1:jt||(ra(h,u),p=h.stateNode,typeof p.componentWillUnmount=="function"&&yx(h,u,p)),Wa(o,u,h);break;case 21:Wa(o,u,h);break;case 22:jt=(p=jt)||h.memoizedState!==null,Wa(o,u,h),jt=p;break;default:Wa(o,u,h)}}function Rx(o,u){if(u.memoizedState===null&&(o=u.alternate,o!==null&&(o=o.memoizedState,o!==null&&(o=o.dehydrated,o!==null))))try{Yl(o)}catch(h){Ct(u,u.return,h)}}function cA(o){switch(o.tag){case 13:case 19:var u=o.stateNode;return u===null&&(u=o.stateNode=new _x),u;case 22:return o=o.stateNode,u=o._retryCache,u===null&&(u=o._retryCache=new _x),u;default:throw Error(n(435,o.tag))}}function Uv(o,u){var h=cA(o);u.forEach(function(p){var y=bA.bind(null,o,p);h.has(p)||(h.add(p),p.then(y,y))})}function rr(o,u){var h=u.deletions;if(h!==null)for(var p=0;p<h.length;p++){var y=h[p],x=o,A=u,O=A;e:for(;O!==null;){switch(O.tag){case 27:if(Ii(O.type)){kt=O.stateNode,Gn=!1;break e}break;case 5:kt=O.stateNode,Gn=!1;break e;case 3:case 4:kt=O.stateNode.containerInfo,Gn=!0;break e}O=O.return}if(kt===null)throw Error(n(160));Cx(x,A,y),kt=null,Gn=!1,x=y.alternate,x!==null&&(x.return=null),y.return=null}if(u.subtreeFlags&13878)for(u=u.child;u!==null;)Tx(u,o),u=u.sibling}var zr=null;function Tx(o,u){var h=o.alternate,p=o.flags;switch(o.tag){case 0:case 11:case 14:case 15:rr(u,o),ar(o),p&4&&(Ri(3,o,o.return),Nl(3,o),Ri(5,o,o.return));break;case 1:rr(u,o),ar(o),p&512&&(jt||h===null||ra(h,h.return)),p&64&&ja&&(o=o.updateQueue,o!==null&&(p=o.callbacks,p!==null&&(h=o.shared.hiddenCallbacks,o.shared.hiddenCallbacks=h===null?p:h.concat(p))));break;case 26:var y=zr;if(rr(u,o),ar(o),p&512&&(jt||h===null||ra(h,h.return)),p&4){var x=h!==null?h.memoizedState:null;if(p=o.memoizedState,h===null)if(p===null)if(o.stateNode===null){e:{p=o.type,h=o.memoizedProps,y=y.ownerDocument||y;t:switch(p){case"title":x=y.getElementsByTagName("title")[0],(!x||x[rl]||x[Cn]||x.namespaceURI==="http://www.w3.org/2000/svg"||x.hasAttribute("itemprop"))&&(x=y.createElement(p),y.head.insertBefore(x,y.querySelector("head > title"))),xn(x,p,h),x[Cn]=o,un(x),p=x;break e;case"link":var A=ww("link","href",y).get(p+(h.href||""));if(A){for(var O=0;O<A.length;O++)if(x=A[O],x.getAttribute("href")===(h.href==null||h.href===""?null:h.href)&&x.getAttribute("rel")===(h.rel==null?null:h.rel)&&x.getAttribute("title")===(h.title==null?null:h.title)&&x.getAttribute("crossorigin")===(h.crossOrigin==null?null:h.crossOrigin)){A.splice(O,1);break t}}x=y.createElement(p),xn(x,p,h),y.head.appendChild(x);break;case"meta":if(A=ww("meta","content",y).get(p+(h.content||""))){for(O=0;O<A.length;O++)if(x=A[O],x.getAttribute("content")===(h.content==null?null:""+h.content)&&x.getAttribute("name")===(h.name==null?null:h.name)&&x.getAttribute("property")===(h.property==null?null:h.property)&&x.getAttribute("http-equiv")===(h.httpEquiv==null?null:h.httpEquiv)&&x.getAttribute("charset")===(h.charSet==null?null:h.charSet)){A.splice(O,1);break t}}x=y.createElement(p),xn(x,p,h),y.head.appendChild(x);break;default:throw Error(n(468,p))}x[Cn]=o,un(x),p=x}o.stateNode=p}else _w(y,o.type,o.stateNode);else o.stateNode=xw(y,p,o.memoizedProps);else x!==p?(x===null?h.stateNode!==null&&(h=h.stateNode,h.parentNode.removeChild(h)):x.count--,p===null?_w(y,o.type,o.stateNode):xw(y,p,o.memoizedProps)):p===null&&o.stateNode!==null&&Bv(o,o.memoizedProps,h.memoizedProps)}break;case 27:rr(u,o),ar(o),p&512&&(jt||h===null||ra(h,h.return)),h!==null&&p&4&&Bv(o,o.memoizedProps,h.memoizedProps);break;case 5:if(rr(u,o),ar(o),p&512&&(jt||h===null||ra(h,h.return)),o.flags&32){y=o.stateNode;try{ws(y,"")}catch(ae){Ct(o,o.return,ae)}}p&4&&o.stateNode!=null&&(y=o.memoizedProps,Bv(o,y,h!==null?h.memoizedProps:y)),p&1024&&(zv=!0);break;case 6:if(rr(u,o),ar(o),p&4){if(o.stateNode===null)throw Error(n(162));p=o.memoizedProps,h=o.stateNode;try{h.nodeValue=p}catch(ae){Ct(o,o.return,ae)}}break;case 3:if(lh=null,y=zr,zr=sh(u.containerInfo),rr(u,o),zr=y,ar(o),p&4&&h!==null&&h.memoizedState.isDehydrated)try{Yl(u.containerInfo)}catch(ae){Ct(o,o.return,ae)}zv&&(zv=!1,Ax(o));break;case 4:p=zr,zr=sh(o.stateNode.containerInfo),rr(u,o),ar(o),zr=p;break;case 12:rr(u,o),ar(o);break;case 13:rr(u,o),ar(o),o.child.flags&8192&&o.memoizedState!==null!=(h!==null&&h.memoizedState!==null)&&(qv=Vt()),p&4&&(p=o.updateQueue,p!==null&&(o.updateQueue=null,Uv(o,p)));break;case 22:y=o.memoizedState!==null;var V=h!==null&&h.memoizedState!==null,Q=ja,ce=jt;if(ja=Q||y,jt=ce||V,rr(u,o),jt=ce,ja=Q,ar(o),p&8192)e:for(u=o.stateNode,u._visibility=y?u._visibility&-2:u._visibility|1,y&&(h===null||V||ja||jt||Mo(o)),h=null,u=o;;){if(u.tag===5||u.tag===26){if(h===null){V=h=u;try{if(x=V.stateNode,y)A=x.style,typeof A.setProperty=="function"?A.setProperty("display","none","important"):A.display="none";else{O=V.stateNode;var he=V.memoizedProps.style,te=he!=null&&he.hasOwnProperty("display")?he.display:null;O.style.display=te==null||typeof te=="boolean"?"":(""+te).trim()}}catch(ae){Ct(V,V.return,ae)}}}else if(u.tag===6){if(h===null){V=u;try{V.stateNode.nodeValue=y?"":V.memoizedProps}catch(ae){Ct(V,V.return,ae)}}}else if((u.tag!==22&&u.tag!==23||u.memoizedState===null||u===o)&&u.child!==null){u.child.return=u,u=u.child;continue}if(u===o)break e;for(;u.sibling===null;){if(u.return===null||u.return===o)break e;h===u&&(h=null),u=u.return}h===u&&(h=null),u.sibling.return=u.return,u=u.sibling}p&4&&(p=o.updateQueue,p!==null&&(h=p.retryQueue,h!==null&&(p.retryQueue=null,Uv(o,h))));break;case 19:rr(u,o),ar(o),p&4&&(p=o.updateQueue,p!==null&&(o.updateQueue=null,Uv(o,p)));break;case 30:break;case 21:break;default:rr(u,o),ar(o)}}function ar(o){var u=o.flags;if(u&2){try{for(var h,p=o.return;p!==null;){if(xx(p)){h=p;break}p=p.return}if(h==null)throw Error(n(160));switch(h.tag){case 27:var y=h.stateNode,x=Lv(o);Xf(o,x,y);break;case 5:var A=h.stateNode;h.flags&32&&(ws(A,""),h.flags&=-33);var O=Lv(o);Xf(o,O,A);break;case 3:case 4:var V=h.stateNode.containerInfo,Q=Lv(o);Pv(o,Q,V);break;default:throw Error(n(161))}}catch(ce){Ct(o,o.return,ce)}o.flags&=-3}u&4096&&(o.flags&=-4097)}function Ax(o){if(o.subtreeFlags&1024)for(o=o.child;o!==null;){var u=o;Ax(u),u.tag===5&&u.flags&1024&&u.stateNode.reset(),o=o.sibling}}function Ti(o,u){if(u.subtreeFlags&8772)for(u=u.child;u!==null;)Sx(o,u.alternate,u),u=u.sibling}function Mo(o){for(o=o.child;o!==null;){var u=o;switch(u.tag){case 0:case 11:case 14:case 15:Ri(4,u,u.return),Mo(u);break;case 1:ra(u,u.return);var h=u.stateNode;typeof h.componentWillUnmount=="function"&&yx(u,u.return,h),Mo(u);break;case 27:Hl(u.stateNode);case 26:case 5:ra(u,u.return),Mo(u);break;case 22:u.memoizedState===null&&Mo(u);break;case 30:Mo(u);break;default:Mo(u)}o=o.sibling}}function Ai(o,u,h){for(h=h&&(u.subtreeFlags&8772)!==0,u=u.child;u!==null;){var p=u.alternate,y=o,x=u,A=x.flags;switch(x.tag){case 0:case 11:case 15:Ai(y,x,h),Nl(4,x);break;case 1:if(Ai(y,x,h),p=x,y=p.stateNode,typeof y.componentDidMount=="function")try{y.componentDidMount()}catch(Q){Ct(p,p.return,Q)}if(p=x,y=p.updateQueue,y!==null){var O=p.stateNode;try{var V=y.shared.hiddenCallbacks;if(V!==null)for(y.shared.hiddenCallbacks=null,y=0;y<V.length;y++)r1(V[y],O)}catch(Q){Ct(p,p.return,Q)}}h&&A&64&&gx(x),Ml(x,x.return);break;case 27:wx(x);case 26:case 5:Ai(y,x,h),h&&p===null&&A&4&&bx(x),Ml(x,x.return);break;case 12:Ai(y,x,h);break;case 13:Ai(y,x,h),h&&A&4&&Rx(y,x);break;case 22:x.memoizedState===null&&Ai(y,x,h),Ml(x,x.return);break;case 30:break;default:Ai(y,x,h)}u=u.sibling}}function Vv(o,u){var h=null;o!==null&&o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(h=o.memoizedState.cachePool.pool),o=null,u.memoizedState!==null&&u.memoizedState.cachePool!==null&&(o=u.memoizedState.cachePool.pool),o!==h&&(o!=null&&o.refCount++,h!=null&&yl(h))}function Hv(o,u){o=null,u.alternate!==null&&(o=u.alternate.memoizedState.cache),u=u.memoizedState.cache,u!==o&&(u.refCount++,o!=null&&yl(o))}function aa(o,u,h,p){if(u.subtreeFlags&10256)for(u=u.child;u!==null;)Dx(o,u,h,p),u=u.sibling}function Dx(o,u,h,p){var y=u.flags;switch(u.tag){case 0:case 11:case 15:aa(o,u,h,p),y&2048&&Nl(9,u);break;case 1:aa(o,u,h,p);break;case 3:aa(o,u,h,p),y&2048&&(o=null,u.alternate!==null&&(o=u.alternate.memoizedState.cache),u=u.memoizedState.cache,u!==o&&(u.refCount++,o!=null&&yl(o)));break;case 12:if(y&2048){aa(o,u,h,p),o=u.stateNode;try{var x=u.memoizedProps,A=x.id,O=x.onPostCommit;typeof O=="function"&&O(A,u.alternate===null?"mount":"update",o.passiveEffectDuration,-0)}catch(V){Ct(u,u.return,V)}}else aa(o,u,h,p);break;case 13:aa(o,u,h,p);break;case 23:break;case 22:x=u.stateNode,A=u.alternate,u.memoizedState!==null?x._visibility&2?aa(o,u,h,p):Il(o,u):x._visibility&2?aa(o,u,h,p):(x._visibility|=2,Us(o,u,h,p,(u.subtreeFlags&10256)!==0)),y&2048&&Vv(A,u);break;case 24:aa(o,u,h,p),y&2048&&Hv(u.alternate,u);break;default:aa(o,u,h,p)}}function Us(o,u,h,p,y){for(y=y&&(u.subtreeFlags&10256)!==0,u=u.child;u!==null;){var x=o,A=u,O=h,V=p,Q=A.flags;switch(A.tag){case 0:case 11:case 15:Us(x,A,O,V,y),Nl(8,A);break;case 23:break;case 22:var ce=A.stateNode;A.memoizedState!==null?ce._visibility&2?Us(x,A,O,V,y):Il(x,A):(ce._visibility|=2,Us(x,A,O,V,y)),y&&Q&2048&&Vv(A.alternate,A);break;case 24:Us(x,A,O,V,y),y&&Q&2048&&Hv(A.alternate,A);break;default:Us(x,A,O,V,y)}u=u.sibling}}function Il(o,u){if(u.subtreeFlags&10256)for(u=u.child;u!==null;){var h=o,p=u,y=p.flags;switch(p.tag){case 22:Il(h,p),y&2048&&Vv(p.alternate,p);break;case 24:Il(h,p),y&2048&&Hv(p.alternate,p);break;default:Il(h,p)}u=u.sibling}}var Fl=8192;function Vs(o){if(o.subtreeFlags&Fl)for(o=o.child;o!==null;)kx(o),o=o.sibling}function kx(o){switch(o.tag){case 26:Vs(o),o.flags&Fl&&o.memoizedState!==null&&$A(zr,o.memoizedState,o.memoizedProps);break;case 5:Vs(o);break;case 3:case 4:var u=zr;zr=sh(o.stateNode.containerInfo),Vs(o),zr=u;break;case 22:o.memoizedState===null&&(u=o.alternate,u!==null&&u.memoizedState!==null?(u=Fl,Fl=16777216,Vs(o),Fl=u):Vs(o));break;default:Vs(o)}}function Ox(o){var u=o.alternate;if(u!==null&&(o=u.child,o!==null)){u.child=null;do u=o.sibling,o.sibling=null,o=u;while(o!==null)}}function Bl(o){var u=o.deletions;if((o.flags&16)!==0){if(u!==null)for(var h=0;h<u.length;h++){var p=u[h];cn=p,Mx(p,o)}Ox(o)}if(o.subtreeFlags&10256)for(o=o.child;o!==null;)Nx(o),o=o.sibling}function Nx(o){switch(o.tag){case 0:case 11:case 15:Bl(o),o.flags&2048&&Ri(9,o,o.return);break;case 3:Bl(o);break;case 12:Bl(o);break;case 22:var u=o.stateNode;o.memoizedState!==null&&u._visibility&2&&(o.return===null||o.return.tag!==13)?(u._visibility&=-3,$f(o)):Bl(o);break;default:Bl(o)}}function $f(o){var u=o.deletions;if((o.flags&16)!==0){if(u!==null)for(var h=0;h<u.length;h++){var p=u[h];cn=p,Mx(p,o)}Ox(o)}for(o=o.child;o!==null;){switch(u=o,u.tag){case 0:case 11:case 15:Ri(8,u,u.return),$f(u);break;case 22:h=u.stateNode,h._visibility&2&&(h._visibility&=-3,$f(u));break;default:$f(u)}o=o.sibling}}function Mx(o,u){for(;cn!==null;){var h=cn;switch(h.tag){case 0:case 11:case 15:Ri(8,h,u);break;case 23:case 22:if(h.memoizedState!==null&&h.memoizedState.cachePool!==null){var p=h.memoizedState.cachePool.pool;p!=null&&p.refCount++}break;case 24:yl(h.memoizedState.cache)}if(p=h.child,p!==null)p.return=h,cn=p;else e:for(h=o;cn!==null;){p=cn;var y=p.sibling,x=p.return;if(Ex(p),p===h){cn=null;break e}if(y!==null){y.return=x,cn=y;break e}cn=x}}}var fA={getCacheForType:function(o){var u=Rn(Zt),h=u.data.get(o);return h===void 0&&(h=o(),u.data.set(o,h)),h}},hA=typeof WeakMap=="function"?WeakMap:Map,yt=0,Rt=null,rt=null,st=0,bt=0,ir=null,Di=!1,Hs=!1,jv=!1,Ga=0,Pt=0,ki=0,Io=0,Wv=0,Rr=0,js=0,Ll=null,qn=null,Gv=!1,qv=0,Yf=1/0,Zf=null,Oi=null,bn=0,Ni=null,Ws=null,Gs=0,Kv=0,Xv=null,Ix=null,Pl=0,$v=null;function or(){if((yt&2)!==0&&st!==0)return st&-st;if(U.T!==null){var o=Ns;return o!==0?o:nm()}return Y0()}function Fx(){Rr===0&&(Rr=(st&536870912)===0||pt?q0():536870912);var o=Cr.current;return o!==null&&(o.flags|=32),Rr}function sr(o,u,h){(o===Rt&&(bt===2||bt===9)||o.cancelPendingCommit!==null)&&(qs(o,0),Mi(o,st,Rr,!1)),nl(o,h),((yt&2)===0||o!==Rt)&&(o===Rt&&((yt&2)===0&&(Io|=h),Pt===4&&Mi(o,st,Rr,!1)),ia(o))}function Bx(o,u,h){if((yt&6)!==0)throw Error(n(327));var p=!h&&(u&124)===0&&(u&o.expiredLanes)===0||tl(o,u),y=p?vA(o,u):Qv(o,u,!0),x=p;do{if(y===0){Hs&&!p&&Mi(o,u,0,!1);break}else{if(h=o.current.alternate,x&&!dA(h)){y=Qv(o,u,!1),x=!1;continue}if(y===2){if(x=u,o.errorRecoveryDisabledLanes&x)var A=0;else A=o.pendingLanes&-536870913,A=A!==0?A:A&536870912?536870912:0;if(A!==0){u=A;e:{var O=o;y=Ll;var V=O.current.memoizedState.isDehydrated;if(V&&(qs(O,A).flags|=256),A=Qv(O,A,!1),A!==2){if(jv&&!V){O.errorRecoveryDisabledLanes|=x,Io|=x,y=4;break e}x=qn,qn=y,x!==null&&(qn===null?qn=x:qn.push.apply(qn,x))}y=A}if(x=!1,y!==2)continue}}if(y===1){qs(o,0),Mi(o,u,0,!0);break}e:{switch(p=o,x=y,x){case 0:case 1:throw Error(n(345));case 4:if((u&4194048)!==u)break;case 6:Mi(p,u,Rr,!Di);break e;case 2:qn=null;break;case 3:case 5:break;default:throw Error(n(329))}if((u&62914560)===u&&(y=qv+300-Vt(),10<y)){if(Mi(p,u,Rr,!Di),uf(p,0,!0)!==0)break e;p.timeoutHandle=fw(Lx.bind(null,p,h,qn,Zf,Gv,u,Rr,Io,js,Di,x,2,-0,0),y);break e}Lx(p,h,qn,Zf,Gv,u,Rr,Io,js,Di,x,0,-0,0)}}break}while(!0);ia(o)}function Lx(o,u,h,p,y,x,A,O,V,Q,ce,he,te,ae){if(o.timeoutHandle=-1,he=u.subtreeFlags,(he&8192||(he&16785408)===16785408)&&(Gl={stylesheets:null,count:0,unsuspend:XA},kx(u),he=YA(),he!==null)){o.cancelPendingCommit=he(Wx.bind(null,o,u,x,h,p,y,A,O,V,ce,1,te,ae)),Mi(o,x,A,!Q);return}Wx(o,u,x,h,p,y,A,O,V)}function dA(o){for(var u=o;;){var h=u.tag;if((h===0||h===11||h===15)&&u.flags&16384&&(h=u.updateQueue,h!==null&&(h=h.stores,h!==null)))for(var p=0;p<h.length;p++){var y=h[p],x=y.getSnapshot;y=y.value;try{if(!tr(x(),y))return!1}catch{return!1}}if(h=u.child,u.subtreeFlags&16384&&h!==null)h.return=u,u=h;else{if(u===o)break;for(;u.sibling===null;){if(u.return===null||u.return===o)return!0;u=u.return}u.sibling.return=u.return,u=u.sibling}}return!0}function Mi(o,u,h,p){u&=~Wv,u&=~Io,o.suspendedLanes|=u,o.pingedLanes&=~u,p&&(o.warmLanes|=u),p=o.expirationTimes;for(var y=u;0<y;){var x=31-gn(y),A=1<<x;p[x]=-1,y&=~A}h!==0&&X0(o,h,u)}function Qf(){return(yt&6)===0?(zl(0),!1):!0}function Yv(){if(rt!==null){if(bt===0)var o=rt.return;else o=rt,La=Ao=null,dv(o),Ps=null,Dl=0,o=rt;for(;o!==null;)mx(o.alternate,o),o=o.return;rt=null}}function qs(o,u){var h=o.timeoutHandle;h!==-1&&(o.timeoutHandle=-1,OA(h)),h=o.cancelPendingCommit,h!==null&&(o.cancelPendingCommit=null,h()),Yv(),Rt=o,rt=h=Ia(o.current,null),st=u,bt=0,ir=null,Di=!1,Hs=tl(o,u),jv=!1,js=Rr=Wv=Io=ki=Pt=0,qn=Ll=null,Gv=!1,(u&8)!==0&&(u|=u&32);var p=o.entangledLanes;if(p!==0)for(o=o.entanglements,p&=u;0<p;){var y=31-gn(p),x=1<<y;u|=o[y],p&=~x}return Ga=u,xf(),h}function Px(o,u){et=null,U.H=zf,u===xl||u===Df?(u=t1(),bt=3):u===Qb?(u=t1(),bt=4):bt=u===nx?8:u!==null&&typeof u=="object"&&typeof u.then=="function"?6:1,ir=u,rt===null&&(Pt=1,Wf(o,wr(u,o.current)))}function zx(){var o=U.H;return U.H=zf,o===null?zf:o}function Ux(){var o=U.A;return U.A=fA,o}function Zv(){Pt=4,Di||(st&4194048)!==st&&Cr.current!==null||(Hs=!0),(ki&134217727)===0&&(Io&134217727)===0||Rt===null||Mi(Rt,st,Rr,!1)}function Qv(o,u,h){var p=yt;yt|=2;var y=zx(),x=Ux();(Rt!==o||st!==u)&&(Zf=null,qs(o,u)),u=!1;var A=Pt;e:do try{if(bt!==0&&rt!==null){var O=rt,V=ir;switch(bt){case 8:Yv(),A=6;break e;case 3:case 2:case 9:case 6:Cr.current===null&&(u=!0);var Q=bt;if(bt=0,ir=null,Ks(o,O,V,Q),h&&Hs){A=0;break e}break;default:Q=bt,bt=0,ir=null,Ks(o,O,V,Q)}}pA(),A=Pt;break}catch(ce){Px(o,ce)}while(!0);return u&&o.shellSuspendCounter++,La=Ao=null,yt=p,U.H=y,U.A=x,rt===null&&(Rt=null,st=0,xf()),A}function pA(){for(;rt!==null;)Vx(rt)}function vA(o,u){var h=yt;yt|=2;var p=zx(),y=Ux();Rt!==o||st!==u?(Zf=null,Yf=Vt()+500,qs(o,u)):Hs=tl(o,u);e:do try{if(bt!==0&&rt!==null){u=rt;var x=ir;t:switch(bt){case 1:bt=0,ir=null,Ks(o,u,x,1);break;case 2:case 9:if(Jb(x)){bt=0,ir=null,Hx(u);break}u=function(){bt!==2&&bt!==9||Rt!==o||(bt=7),ia(o)},x.then(u,u);break e;case 3:bt=7;break e;case 4:bt=5;break e;case 7:Jb(x)?(bt=0,ir=null,Hx(u)):(bt=0,ir=null,Ks(o,u,x,7));break;case 5:var A=null;switch(rt.tag){case 26:A=rt.memoizedState;case 5:case 27:var O=rt;if(!A||Sw(A)){bt=0,ir=null;var V=O.sibling;if(V!==null)rt=V;else{var Q=O.return;Q!==null?(rt=Q,Jf(Q)):rt=null}break t}}bt=0,ir=null,Ks(o,u,x,5);break;case 6:bt=0,ir=null,Ks(o,u,x,6);break;case 8:Yv(),Pt=6;break e;default:throw Error(n(462))}}mA();break}catch(ce){Px(o,ce)}while(!0);return La=Ao=null,U.H=p,U.A=y,yt=h,rt!==null?0:(Rt=null,st=0,xf(),Pt)}function mA(){for(;rt!==null&&!Et();)Vx(rt)}function Vx(o){var u=px(o.alternate,o,Ga);o.memoizedProps=o.pendingProps,u===null?Jf(o):rt=u}function Hx(o){var u=o,h=u.alternate;switch(u.tag){case 15:case 0:u=ux(h,u,u.pendingProps,u.type,void 0,st);break;case 11:u=ux(h,u,u.pendingProps,u.type.render,u.ref,st);break;case 5:dv(u);default:mx(h,u),u=rt=jb(u,Ga),u=px(h,u,Ga)}o.memoizedProps=o.pendingProps,u===null?Jf(o):rt=u}function Ks(o,u,h,p){La=Ao=null,dv(u),Ps=null,Dl=0;var y=u.return;try{if(iA(o,y,u,h,st)){Pt=1,Wf(o,wr(h,o.current)),rt=null;return}}catch(x){if(y!==null)throw rt=y,x;Pt=1,Wf(o,wr(h,o.current)),rt=null;return}u.flags&32768?(pt||p===1?o=!0:Hs||(st&536870912)!==0?o=!1:(Di=o=!0,(p===2||p===9||p===3||p===6)&&(p=Cr.current,p!==null&&p.tag===13&&(p.flags|=16384))),jx(u,o)):Jf(u)}function Jf(o){var u=o;do{if((u.flags&32768)!==0){jx(u,Di);return}o=u.return;var h=sA(u.alternate,u,Ga);if(h!==null){rt=h;return}if(u=u.sibling,u!==null){rt=u;return}rt=u=o}while(u!==null);Pt===0&&(Pt=5)}function jx(o,u){do{var h=uA(o.alternate,o);if(h!==null){h.flags&=32767,rt=h;return}if(h=o.return,h!==null&&(h.flags|=32768,h.subtreeFlags=0,h.deletions=null),!u&&(o=o.sibling,o!==null)){rt=o;return}rt=o=h}while(o!==null);Pt=6,rt=null}function Wx(o,u,h,p,y,x,A,O,V){o.cancelPendingCommit=null;do eh();while(bn!==0);if((yt&6)!==0)throw Error(n(327));if(u!==null){if(u===o.current)throw Error(n(177));if(x=u.lanes|u.childLanes,x|=Hp,XR(o,h,x,A,O,V),o===Rt&&(rt=Rt=null,st=0),Ws=u,Ni=o,Gs=h,Kv=x,Xv=y,Ix=p,(u.subtreeFlags&10256)!==0||(u.flags&10256)!==0?(o.callbackNode=null,o.callbackPriority=0,xA(Vn,function(){return $x(),null})):(o.callbackNode=null,o.callbackPriority=0),p=(u.flags&13878)!==0,(u.subtreeFlags&13878)!==0||p){p=U.T,U.T=null,y=G.p,G.p=2,A=yt,yt|=4;try{lA(o,u,h)}finally{yt=A,G.p=y,U.T=p}}bn=1,Gx(),qx(),Kx()}}function Gx(){if(bn===1){bn=0;var o=Ni,u=Ws,h=(u.flags&13878)!==0;if((u.subtreeFlags&13878)!==0||h){h=U.T,U.T=null;var p=G.p;G.p=2;var y=yt;yt|=4;try{Tx(u,o);var x=cm,A=Mb(o.containerInfo),O=x.focusedElem,V=x.selectionRange;if(A!==O&&O&&O.ownerDocument&&Nb(O.ownerDocument.documentElement,O)){if(V!==null&&Lp(O)){var Q=V.start,ce=V.end;if(ce===void 0&&(ce=Q),"selectionStart"in O)O.selectionStart=Q,O.selectionEnd=Math.min(ce,O.value.length);else{var he=O.ownerDocument||document,te=he&&he.defaultView||window;if(te.getSelection){var ae=te.getSelection(),Ue=O.textContent.length,Be=Math.min(V.start,Ue),St=V.end===void 0?Be:Math.min(V.end,Ue);!ae.extend&&Be>St&&(A=St,St=Be,Be=A);var $=Ob(O,Be),W=Ob(O,St);if($&&W&&(ae.rangeCount!==1||ae.anchorNode!==$.node||ae.anchorOffset!==$.offset||ae.focusNode!==W.node||ae.focusOffset!==W.offset)){var Y=he.createRange();Y.setStart($.node,$.offset),ae.removeAllRanges(),Be>St?(ae.addRange(Y),ae.extend(W.node,W.offset)):(Y.setEnd(W.node,W.offset),ae.addRange(Y))}}}}for(he=[],ae=O;ae=ae.parentNode;)ae.nodeType===1&&he.push({element:ae,left:ae.scrollLeft,top:ae.scrollTop});for(typeof O.focus=="function"&&O.focus(),O=0;O<he.length;O++){var fe=he[O];fe.element.scrollLeft=fe.left,fe.element.scrollTop=fe.top}}hh=!!lm,cm=lm=null}finally{yt=y,G.p=p,U.T=h}}o.current=u,bn=2}}function qx(){if(bn===2){bn=0;var o=Ni,u=Ws,h=(u.flags&8772)!==0;if((u.subtreeFlags&8772)!==0||h){h=U.T,U.T=null;var p=G.p;G.p=2;var y=yt;yt|=4;try{Sx(o,u.alternate,u)}finally{yt=y,G.p=p,U.T=h}}bn=3}}function Kx(){if(bn===4||bn===3){bn=0,xt();var o=Ni,u=Ws,h=Gs,p=Ix;(u.subtreeFlags&10256)!==0||(u.flags&10256)!==0?bn=5:(bn=0,Ws=Ni=null,Xx(o,o.pendingLanes));var y=o.pendingLanes;if(y===0&&(Oi=null),mp(h),u=u.stateNode,Gt&&typeof Gt.onCommitFiberRoot=="function")try{Gt.onCommitFiberRoot(Oa,u,void 0,(u.current.flags&128)===128)}catch{}if(p!==null){u=U.T,y=G.p,G.p=2,U.T=null;try{for(var x=o.onRecoverableError,A=0;A<p.length;A++){var O=p[A];x(O.value,{componentStack:O.stack})}}finally{U.T=u,G.p=y}}(Gs&3)!==0&&eh(),ia(o),y=o.pendingLanes,(h&4194090)!==0&&(y&42)!==0?o===$v?Pl++:(Pl=0,$v=o):Pl=0,zl(0)}}function Xx(o,u){(o.pooledCacheLanes&=u)===0&&(u=o.pooledCache,u!=null&&(o.pooledCache=null,yl(u)))}function eh(o){return Gx(),qx(),Kx(),$x()}function $x(){if(bn!==5)return!1;var o=Ni,u=Kv;Kv=0;var h=mp(Gs),p=U.T,y=G.p;try{G.p=32>h?32:h,U.T=null,h=Xv,Xv=null;var x=Ni,A=Gs;if(bn=0,Ws=Ni=null,Gs=0,(yt&6)!==0)throw Error(n(331));var O=yt;if(yt|=4,Nx(x.current),Dx(x,x.current,A,h),yt=O,zl(0,!1),Gt&&typeof Gt.onPostCommitFiberRoot=="function")try{Gt.onPostCommitFiberRoot(Oa,x)}catch{}return!0}finally{G.p=y,U.T=p,Xx(o,u)}}function Yx(o,u,h){u=wr(h,u),u=Tv(o.stateNode,u,2),o=_i(o,u,2),o!==null&&(nl(o,2),ia(o))}function Ct(o,u,h){if(o.tag===3)Yx(o,o,h);else for(;u!==null;){if(u.tag===3){Yx(u,o,h);break}else if(u.tag===1){var p=u.stateNode;if(typeof u.type.getDerivedStateFromError=="function"||typeof p.componentDidCatch=="function"&&(Oi===null||!Oi.has(p))){o=wr(h,o),h=ex(2),p=_i(u,h,2),p!==null&&(tx(h,p,u,o),nl(p,2),ia(p));break}}u=u.return}}function Jv(o,u,h){var p=o.pingCache;if(p===null){p=o.pingCache=new hA;var y=new Set;p.set(u,y)}else y=p.get(u),y===void 0&&(y=new Set,p.set(u,y));y.has(h)||(jv=!0,y.add(h),o=gA.bind(null,o,u,h),u.then(o,o))}function gA(o,u,h){var p=o.pingCache;p!==null&&p.delete(u),o.pingedLanes|=o.suspendedLanes&h,o.warmLanes&=~h,Rt===o&&(st&h)===h&&(Pt===4||Pt===3&&(st&62914560)===st&&300>Vt()-qv?(yt&2)===0&&qs(o,0):Wv|=h,js===st&&(js=0)),ia(o)}function Zx(o,u){u===0&&(u=K0()),o=As(o,u),o!==null&&(nl(o,u),ia(o))}function yA(o){var u=o.memoizedState,h=0;u!==null&&(h=u.retryLane),Zx(o,h)}function bA(o,u){var h=0;switch(o.tag){case 13:var p=o.stateNode,y=o.memoizedState;y!==null&&(h=y.retryLane);break;case 19:p=o.stateNode;break;case 22:p=o.stateNode._retryCache;break;default:throw Error(n(314))}p!==null&&p.delete(u),Zx(o,h)}function xA(o,u){return Je(o,u)}var th=null,Xs=null,em=!1,nh=!1,tm=!1,Fo=0;function ia(o){o!==Xs&&o.next===null&&(Xs===null?th=Xs=o:Xs=Xs.next=o),nh=!0,em||(em=!0,_A())}function zl(o,u){if(!tm&&nh){tm=!0;do for(var h=!1,p=th;p!==null;){if(o!==0){var y=p.pendingLanes;if(y===0)var x=0;else{var A=p.suspendedLanes,O=p.pingedLanes;x=(1<<31-gn(42|o)+1)-1,x&=y&~(A&~O),x=x&201326741?x&201326741|1:x?x|2:0}x!==0&&(h=!0,tw(p,x))}else x=st,x=uf(p,p===Rt?x:0,p.cancelPendingCommit!==null||p.timeoutHandle!==-1),(x&3)===0||tl(p,x)||(h=!0,tw(p,x));p=p.next}while(h);tm=!1}}function wA(){Qx()}function Qx(){nh=em=!1;var o=0;Fo!==0&&(kA()&&(o=Fo),Fo=0);for(var u=Vt(),h=null,p=th;p!==null;){var y=p.next,x=Jx(p,u);x===0?(p.next=null,h===null?th=y:h.next=y,y===null&&(Xs=h)):(h=p,(o!==0||(x&3)!==0)&&(nh=!0)),p=y}zl(o)}function Jx(o,u){for(var h=o.suspendedLanes,p=o.pingedLanes,y=o.expirationTimes,x=o.pendingLanes&-62914561;0<x;){var A=31-gn(x),O=1<<A,V=y[A];V===-1?((O&h)===0||(O&p)!==0)&&(y[A]=KR(O,u)):V<=u&&(o.expiredLanes|=O),x&=~O}if(u=Rt,h=st,h=uf(o,o===u?h:0,o.cancelPendingCommit!==null||o.timeoutHandle!==-1),p=o.callbackNode,h===0||o===u&&(bt===2||bt===9)||o.cancelPendingCommit!==null)return p!==null&&p!==null&&dt(p),o.callbackNode=null,o.callbackPriority=0;if((h&3)===0||tl(o,h)){if(u=h&-h,u===o.callbackPriority)return u;switch(p!==null&&dt(p),mp(h)){case 2:case 8:h=ka;break;case 32:h=Vn;break;case 268435456:h=yr;break;default:h=Vn}return p=ew.bind(null,o),h=Je(h,p),o.callbackPriority=u,o.callbackNode=h,u}return p!==null&&p!==null&&dt(p),o.callbackPriority=2,o.callbackNode=null,2}function ew(o,u){if(bn!==0&&bn!==5)return o.callbackNode=null,o.callbackPriority=0,null;var h=o.callbackNode;if(eh()&&o.callbackNode!==h)return null;var p=st;return p=uf(o,o===Rt?p:0,o.cancelPendingCommit!==null||o.timeoutHandle!==-1),p===0?null:(Bx(o,p,u),Jx(o,Vt()),o.callbackNode!=null&&o.callbackNode===h?ew.bind(null,o):null)}function tw(o,u){if(eh())return null;Bx(o,u,!0)}function _A(){NA(function(){(yt&6)!==0?Je(En,wA):Qx()})}function nm(){return Fo===0&&(Fo=q0()),Fo}function nw(o){return o==null||typeof o=="symbol"||typeof o=="boolean"?null:typeof o=="function"?o:df(""+o)}function rw(o,u){var h=u.ownerDocument.createElement("input");return h.name=u.name,h.value=u.value,o.id&&h.setAttribute("form",o.id),u.parentNode.insertBefore(h,u),o=new FormData(o),h.parentNode.removeChild(h),o}function SA(o,u,h,p,y){if(u==="submit"&&h&&h.stateNode===y){var x=nw((y[Hn]||null).action),A=p.submitter;A&&(u=(u=A[Hn]||null)?nw(u.formAction):A.getAttribute("formAction"),u!==null&&(x=u,A=null));var O=new gf("action","action",null,p,y);o.push({event:O,listeners:[{instance:null,listener:function(){if(p.defaultPrevented){if(Fo!==0){var V=A?rw(y,A):new FormData(y);_v(h,{pending:!0,data:V,method:y.method,action:x},null,V)}}else typeof x=="function"&&(O.preventDefault(),V=A?rw(y,A):new FormData(y),_v(h,{pending:!0,data:V,method:y.method,action:x},x,V))},currentTarget:y}]})}}for(var rm=0;rm<Vp.length;rm++){var am=Vp[rm],EA=am.toLowerCase(),CA=am[0].toUpperCase()+am.slice(1);Pr(EA,"on"+CA)}Pr(Bb,"onAnimationEnd"),Pr(Lb,"onAnimationIteration"),Pr(Pb,"onAnimationStart"),Pr("dblclick","onDoubleClick"),Pr("focusin","onFocus"),Pr("focusout","onBlur"),Pr(HT,"onTransitionRun"),Pr(jT,"onTransitionStart"),Pr(WT,"onTransitionCancel"),Pr(zb,"onTransitionEnd"),ys("onMouseEnter",["mouseout","mouseover"]),ys("onMouseLeave",["mouseout","mouseover"]),ys("onPointerEnter",["pointerout","pointerover"]),ys("onPointerLeave",["pointerout","pointerover"]),bo("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),bo("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),bo("onBeforeInput",["compositionend","keypress","textInput","paste"]),bo("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),bo("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),bo("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ul="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),RA=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Ul));function aw(o,u){u=(u&4)!==0;for(var h=0;h<o.length;h++){var p=o[h],y=p.event;p=p.listeners;e:{var x=void 0;if(u)for(var A=p.length-1;0<=A;A--){var O=p[A],V=O.instance,Q=O.currentTarget;if(O=O.listener,V!==x&&y.isPropagationStopped())break e;x=O,y.currentTarget=Q;try{x(y)}catch(ce){jf(ce)}y.currentTarget=null,x=V}else for(A=0;A<p.length;A++){if(O=p[A],V=O.instance,Q=O.currentTarget,O=O.listener,V!==x&&y.isPropagationStopped())break e;x=O,y.currentTarget=Q;try{x(y)}catch(ce){jf(ce)}y.currentTarget=null,x=V}}}}function at(o,u){var h=u[gp];h===void 0&&(h=u[gp]=new Set);var p=o+"__bubble";h.has(p)||(iw(u,o,2,!1),h.add(p))}function im(o,u,h){var p=0;u&&(p|=4),iw(h,o,p,u)}var rh="_reactListening"+Math.random().toString(36).slice(2);function om(o){if(!o[rh]){o[rh]=!0,Q0.forEach(function(h){h!=="selectionchange"&&(RA.has(h)||im(h,!1,o),im(h,!0,o))});var u=o.nodeType===9?o:o.ownerDocument;u===null||u[rh]||(u[rh]=!0,im("selectionchange",!1,u))}}function iw(o,u,h,p){switch(Dw(u)){case 2:var y=JA;break;case 8:y=eD;break;default:y=xm}h=y.bind(null,u,h,o),y=void 0,!Ap||u!=="touchstart"&&u!=="touchmove"&&u!=="wheel"||(y=!0),p?y!==void 0?o.addEventListener(u,h,{capture:!0,passive:y}):o.addEventListener(u,h,!0):y!==void 0?o.addEventListener(u,h,{passive:y}):o.addEventListener(u,h,!1)}function sm(o,u,h,p,y){var x=p;if((u&1)===0&&(u&2)===0&&p!==null)e:for(;;){if(p===null)return;var A=p.tag;if(A===3||A===4){var O=p.stateNode.containerInfo;if(O===y)break;if(A===4)for(A=p.return;A!==null;){var V=A.tag;if((V===3||V===4)&&A.stateNode.containerInfo===y)return;A=A.return}for(;O!==null;){if(A=vs(O),A===null)return;if(V=A.tag,V===5||V===6||V===26||V===27){p=x=A;continue e}O=O.parentNode}}p=p.return}hb(function(){var Q=x,ce=Rp(h),he=[];e:{var te=Ub.get(o);if(te!==void 0){var ae=gf,Ue=o;switch(o){case"keypress":if(vf(h)===0)break e;case"keydown":case"keyup":ae=xT;break;case"focusin":Ue="focus",ae=Np;break;case"focusout":Ue="blur",ae=Np;break;case"beforeblur":case"afterblur":ae=Np;break;case"click":if(h.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ae=vb;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ae=uT;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ae=ST;break;case Bb:case Lb:case Pb:ae=fT;break;case zb:ae=CT;break;case"scroll":case"scrollend":ae=oT;break;case"wheel":ae=TT;break;case"copy":case"cut":case"paste":ae=dT;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ae=gb;break;case"toggle":case"beforetoggle":ae=DT}var Be=(u&4)!==0,St=!Be&&(o==="scroll"||o==="scrollend"),$=Be?te!==null?te+"Capture":null:te;Be=[];for(var W=Q,Y;W!==null;){var fe=W;if(Y=fe.stateNode,fe=fe.tag,fe!==5&&fe!==26&&fe!==27||Y===null||$===null||(fe=il(W,$),fe!=null&&Be.push(Vl(W,fe,Y))),St)break;W=W.return}0<Be.length&&(te=new ae(te,Ue,null,h,ce),he.push({event:te,listeners:Be}))}}if((u&7)===0){e:{if(te=o==="mouseover"||o==="pointerover",ae=o==="mouseout"||o==="pointerout",te&&h!==Cp&&(Ue=h.relatedTarget||h.fromElement)&&(vs(Ue)||Ue[ps]))break e;if((ae||te)&&(te=ce.window===ce?ce:(te=ce.ownerDocument)?te.defaultView||te.parentWindow:window,ae?(Ue=h.relatedTarget||h.toElement,ae=Q,Ue=Ue?vs(Ue):null,Ue!==null&&(St=i(Ue),Be=Ue.tag,Ue!==St||Be!==5&&Be!==27&&Be!==6)&&(Ue=null)):(ae=null,Ue=Q),ae!==Ue)){if(Be=vb,fe="onMouseLeave",$="onMouseEnter",W="mouse",(o==="pointerout"||o==="pointerover")&&(Be=gb,fe="onPointerLeave",$="onPointerEnter",W="pointer"),St=ae==null?te:al(ae),Y=Ue==null?te:al(Ue),te=new Be(fe,W+"leave",ae,h,ce),te.target=St,te.relatedTarget=Y,fe=null,vs(ce)===Q&&(Be=new Be($,W+"enter",Ue,h,ce),Be.target=Y,Be.relatedTarget=St,fe=Be),St=fe,ae&&Ue)t:{for(Be=ae,$=Ue,W=0,Y=Be;Y;Y=$s(Y))W++;for(Y=0,fe=$;fe;fe=$s(fe))Y++;for(;0<W-Y;)Be=$s(Be),W--;for(;0<Y-W;)$=$s($),Y--;for(;W--;){if(Be===$||$!==null&&Be===$.alternate)break t;Be=$s(Be),$=$s($)}Be=null}else Be=null;ae!==null&&ow(he,te,ae,Be,!1),Ue!==null&&St!==null&&ow(he,St,Ue,Be,!0)}}e:{if(te=Q?al(Q):window,ae=te.nodeName&&te.nodeName.toLowerCase(),ae==="select"||ae==="input"&&te.type==="file")var Ee=Cb;else if(Sb(te))if(Rb)Ee=zT;else{Ee=LT;var tt=BT}else ae=te.nodeName,!ae||ae.toLowerCase()!=="input"||te.type!=="checkbox"&&te.type!=="radio"?Q&&Ep(Q.elementType)&&(Ee=Cb):Ee=PT;if(Ee&&(Ee=Ee(o,Q))){Eb(he,Ee,h,ce);break e}tt&&tt(o,te,Q),o==="focusout"&&Q&&te.type==="number"&&Q.memoizedProps.value!=null&&Sp(te,"number",te.value)}switch(tt=Q?al(Q):window,o){case"focusin":(Sb(tt)||tt.contentEditable==="true")&&(Cs=tt,Pp=Q,dl=null);break;case"focusout":dl=Pp=Cs=null;break;case"mousedown":zp=!0;break;case"contextmenu":case"mouseup":case"dragend":zp=!1,Ib(he,h,ce);break;case"selectionchange":if(VT)break;case"keydown":case"keyup":Ib(he,h,ce)}var Me;if(Ip)e:{switch(o){case"compositionstart":var Le="onCompositionStart";break e;case"compositionend":Le="onCompositionEnd";break e;case"compositionupdate":Le="onCompositionUpdate";break e}Le=void 0}else Es?wb(o,h)&&(Le="onCompositionEnd"):o==="keydown"&&h.keyCode===229&&(Le="onCompositionStart");Le&&(yb&&h.locale!=="ko"&&(Es||Le!=="onCompositionStart"?Le==="onCompositionEnd"&&Es&&(Me=db()):(yi=ce,Dp="value"in yi?yi.value:yi.textContent,Es=!0)),tt=ah(Q,Le),0<tt.length&&(Le=new mb(Le,o,null,h,ce),he.push({event:Le,listeners:tt}),Me?Le.data=Me:(Me=_b(h),Me!==null&&(Le.data=Me)))),(Me=OT?NT(o,h):MT(o,h))&&(Le=ah(Q,"onBeforeInput"),0<Le.length&&(tt=new mb("onBeforeInput","beforeinput",null,h,ce),he.push({event:tt,listeners:Le}),tt.data=Me)),SA(he,o,Q,h,ce)}aw(he,u)})}function Vl(o,u,h){return{instance:o,listener:u,currentTarget:h}}function ah(o,u){for(var h=u+"Capture",p=[];o!==null;){var y=o,x=y.stateNode;if(y=y.tag,y!==5&&y!==26&&y!==27||x===null||(y=il(o,h),y!=null&&p.unshift(Vl(o,y,x)),y=il(o,u),y!=null&&p.push(Vl(o,y,x))),o.tag===3)return p;o=o.return}return[]}function $s(o){if(o===null)return null;do o=o.return;while(o&&o.tag!==5&&o.tag!==27);return o||null}function ow(o,u,h,p,y){for(var x=u._reactName,A=[];h!==null&&h!==p;){var O=h,V=O.alternate,Q=O.stateNode;if(O=O.tag,V!==null&&V===p)break;O!==5&&O!==26&&O!==27||Q===null||(V=Q,y?(Q=il(h,x),Q!=null&&A.unshift(Vl(h,Q,V))):y||(Q=il(h,x),Q!=null&&A.push(Vl(h,Q,V)))),h=h.return}A.length!==0&&o.push({event:u,listeners:A})}var TA=/\r\n?/g,AA=/\u0000|\uFFFD/g;function sw(o){return(typeof o=="string"?o:""+o).replace(TA,`
`).replace(AA,"")}function uw(o,u){return u=sw(u),sw(o)===u}function ih(){}function _t(o,u,h,p,y,x){switch(h){case"children":typeof p=="string"?u==="body"||u==="textarea"&&p===""||ws(o,p):(typeof p=="number"||typeof p=="bigint")&&u!=="body"&&ws(o,""+p);break;case"className":cf(o,"class",p);break;case"tabIndex":cf(o,"tabindex",p);break;case"dir":case"role":case"viewBox":case"width":case"height":cf(o,h,p);break;case"style":cb(o,p,x);break;case"data":if(u!=="object"){cf(o,"data",p);break}case"src":case"href":if(p===""&&(u!=="a"||h!=="href")){o.removeAttribute(h);break}if(p==null||typeof p=="function"||typeof p=="symbol"||typeof p=="boolean"){o.removeAttribute(h);break}p=df(""+p),o.setAttribute(h,p);break;case"action":case"formAction":if(typeof p=="function"){o.setAttribute(h,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof x=="function"&&(h==="formAction"?(u!=="input"&&_t(o,u,"name",y.name,y,null),_t(o,u,"formEncType",y.formEncType,y,null),_t(o,u,"formMethod",y.formMethod,y,null),_t(o,u,"formTarget",y.formTarget,y,null)):(_t(o,u,"encType",y.encType,y,null),_t(o,u,"method",y.method,y,null),_t(o,u,"target",y.target,y,null)));if(p==null||typeof p=="symbol"||typeof p=="boolean"){o.removeAttribute(h);break}p=df(""+p),o.setAttribute(h,p);break;case"onClick":p!=null&&(o.onclick=ih);break;case"onScroll":p!=null&&at("scroll",o);break;case"onScrollEnd":p!=null&&at("scrollend",o);break;case"dangerouslySetInnerHTML":if(p!=null){if(typeof p!="object"||!("__html"in p))throw Error(n(61));if(h=p.__html,h!=null){if(y.children!=null)throw Error(n(60));o.innerHTML=h}}break;case"multiple":o.multiple=p&&typeof p!="function"&&typeof p!="symbol";break;case"muted":o.muted=p&&typeof p!="function"&&typeof p!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(p==null||typeof p=="function"||typeof p=="boolean"||typeof p=="symbol"){o.removeAttribute("xlink:href");break}h=df(""+p),o.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",h);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":p!=null&&typeof p!="function"&&typeof p!="symbol"?o.setAttribute(h,""+p):o.removeAttribute(h);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":p&&typeof p!="function"&&typeof p!="symbol"?o.setAttribute(h,""):o.removeAttribute(h);break;case"capture":case"download":p===!0?o.setAttribute(h,""):p!==!1&&p!=null&&typeof p!="function"&&typeof p!="symbol"?o.setAttribute(h,p):o.removeAttribute(h);break;case"cols":case"rows":case"size":case"span":p!=null&&typeof p!="function"&&typeof p!="symbol"&&!isNaN(p)&&1<=p?o.setAttribute(h,p):o.removeAttribute(h);break;case"rowSpan":case"start":p==null||typeof p=="function"||typeof p=="symbol"||isNaN(p)?o.removeAttribute(h):o.setAttribute(h,p);break;case"popover":at("beforetoggle",o),at("toggle",o),lf(o,"popover",p);break;case"xlinkActuate":Na(o,"http://www.w3.org/1999/xlink","xlink:actuate",p);break;case"xlinkArcrole":Na(o,"http://www.w3.org/1999/xlink","xlink:arcrole",p);break;case"xlinkRole":Na(o,"http://www.w3.org/1999/xlink","xlink:role",p);break;case"xlinkShow":Na(o,"http://www.w3.org/1999/xlink","xlink:show",p);break;case"xlinkTitle":Na(o,"http://www.w3.org/1999/xlink","xlink:title",p);break;case"xlinkType":Na(o,"http://www.w3.org/1999/xlink","xlink:type",p);break;case"xmlBase":Na(o,"http://www.w3.org/XML/1998/namespace","xml:base",p);break;case"xmlLang":Na(o,"http://www.w3.org/XML/1998/namespace","xml:lang",p);break;case"xmlSpace":Na(o,"http://www.w3.org/XML/1998/namespace","xml:space",p);break;case"is":lf(o,"is",p);break;case"innerText":case"textContent":break;default:(!(2<h.length)||h[0]!=="o"&&h[0]!=="O"||h[1]!=="n"&&h[1]!=="N")&&(h=aT.get(h)||h,lf(o,h,p))}}function um(o,u,h,p,y,x){switch(h){case"style":cb(o,p,x);break;case"dangerouslySetInnerHTML":if(p!=null){if(typeof p!="object"||!("__html"in p))throw Error(n(61));if(h=p.__html,h!=null){if(y.children!=null)throw Error(n(60));o.innerHTML=h}}break;case"children":typeof p=="string"?ws(o,p):(typeof p=="number"||typeof p=="bigint")&&ws(o,""+p);break;case"onScroll":p!=null&&at("scroll",o);break;case"onScrollEnd":p!=null&&at("scrollend",o);break;case"onClick":p!=null&&(o.onclick=ih);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!J0.hasOwnProperty(h))e:{if(h[0]==="o"&&h[1]==="n"&&(y=h.endsWith("Capture"),u=h.slice(2,y?h.length-7:void 0),x=o[Hn]||null,x=x!=null?x[h]:null,typeof x=="function"&&o.removeEventListener(u,x,y),typeof p=="function")){typeof x!="function"&&x!==null&&(h in o?o[h]=null:o.hasAttribute(h)&&o.removeAttribute(h)),o.addEventListener(u,p,y);break e}h in o?o[h]=p:p===!0?o.setAttribute(h,""):lf(o,h,p)}}}function xn(o,u,h){switch(u){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":at("error",o),at("load",o);var p=!1,y=!1,x;for(x in h)if(h.hasOwnProperty(x)){var A=h[x];if(A!=null)switch(x){case"src":p=!0;break;case"srcSet":y=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(n(137,u));default:_t(o,u,x,A,h,null)}}y&&_t(o,u,"srcSet",h.srcSet,h,null),p&&_t(o,u,"src",h.src,h,null);return;case"input":at("invalid",o);var O=x=A=y=null,V=null,Q=null;for(p in h)if(h.hasOwnProperty(p)){var ce=h[p];if(ce!=null)switch(p){case"name":y=ce;break;case"type":A=ce;break;case"checked":V=ce;break;case"defaultChecked":Q=ce;break;case"value":x=ce;break;case"defaultValue":O=ce;break;case"children":case"dangerouslySetInnerHTML":if(ce!=null)throw Error(n(137,u));break;default:_t(o,u,p,ce,h,null)}}ob(o,x,O,V,Q,A,y,!1),ff(o);return;case"select":at("invalid",o),p=A=x=null;for(y in h)if(h.hasOwnProperty(y)&&(O=h[y],O!=null))switch(y){case"value":x=O;break;case"defaultValue":A=O;break;case"multiple":p=O;default:_t(o,u,y,O,h,null)}u=x,h=A,o.multiple=!!p,u!=null?xs(o,!!p,u,!1):h!=null&&xs(o,!!p,h,!0);return;case"textarea":at("invalid",o),x=y=p=null;for(A in h)if(h.hasOwnProperty(A)&&(O=h[A],O!=null))switch(A){case"value":p=O;break;case"defaultValue":y=O;break;case"children":x=O;break;case"dangerouslySetInnerHTML":if(O!=null)throw Error(n(91));break;default:_t(o,u,A,O,h,null)}ub(o,p,y,x),ff(o);return;case"option":for(V in h)if(h.hasOwnProperty(V)&&(p=h[V],p!=null))switch(V){case"selected":o.selected=p&&typeof p!="function"&&typeof p!="symbol";break;default:_t(o,u,V,p,h,null)}return;case"dialog":at("beforetoggle",o),at("toggle",o),at("cancel",o),at("close",o);break;case"iframe":case"object":at("load",o);break;case"video":case"audio":for(p=0;p<Ul.length;p++)at(Ul[p],o);break;case"image":at("error",o),at("load",o);break;case"details":at("toggle",o);break;case"embed":case"source":case"link":at("error",o),at("load",o);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(Q in h)if(h.hasOwnProperty(Q)&&(p=h[Q],p!=null))switch(Q){case"children":case"dangerouslySetInnerHTML":throw Error(n(137,u));default:_t(o,u,Q,p,h,null)}return;default:if(Ep(u)){for(ce in h)h.hasOwnProperty(ce)&&(p=h[ce],p!==void 0&&um(o,u,ce,p,h,void 0));return}}for(O in h)h.hasOwnProperty(O)&&(p=h[O],p!=null&&_t(o,u,O,p,h,null))}function DA(o,u,h,p){switch(u){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var y=null,x=null,A=null,O=null,V=null,Q=null,ce=null;for(ae in h){var he=h[ae];if(h.hasOwnProperty(ae)&&he!=null)switch(ae){case"checked":break;case"value":break;case"defaultValue":V=he;default:p.hasOwnProperty(ae)||_t(o,u,ae,null,p,he)}}for(var te in p){var ae=p[te];if(he=h[te],p.hasOwnProperty(te)&&(ae!=null||he!=null))switch(te){case"type":x=ae;break;case"name":y=ae;break;case"checked":Q=ae;break;case"defaultChecked":ce=ae;break;case"value":A=ae;break;case"defaultValue":O=ae;break;case"children":case"dangerouslySetInnerHTML":if(ae!=null)throw Error(n(137,u));break;default:ae!==he&&_t(o,u,te,ae,p,he)}}_p(o,A,O,V,Q,ce,x,y);return;case"select":ae=A=O=te=null;for(x in h)if(V=h[x],h.hasOwnProperty(x)&&V!=null)switch(x){case"value":break;case"multiple":ae=V;default:p.hasOwnProperty(x)||_t(o,u,x,null,p,V)}for(y in p)if(x=p[y],V=h[y],p.hasOwnProperty(y)&&(x!=null||V!=null))switch(y){case"value":te=x;break;case"defaultValue":O=x;break;case"multiple":A=x;default:x!==V&&_t(o,u,y,x,p,V)}u=O,h=A,p=ae,te!=null?xs(o,!!h,te,!1):!!p!=!!h&&(u!=null?xs(o,!!h,u,!0):xs(o,!!h,h?[]:"",!1));return;case"textarea":ae=te=null;for(O in h)if(y=h[O],h.hasOwnProperty(O)&&y!=null&&!p.hasOwnProperty(O))switch(O){case"value":break;case"children":break;default:_t(o,u,O,null,p,y)}for(A in p)if(y=p[A],x=h[A],p.hasOwnProperty(A)&&(y!=null||x!=null))switch(A){case"value":te=y;break;case"defaultValue":ae=y;break;case"children":break;case"dangerouslySetInnerHTML":if(y!=null)throw Error(n(91));break;default:y!==x&&_t(o,u,A,y,p,x)}sb(o,te,ae);return;case"option":for(var Ue in h)if(te=h[Ue],h.hasOwnProperty(Ue)&&te!=null&&!p.hasOwnProperty(Ue))switch(Ue){case"selected":o.selected=!1;break;default:_t(o,u,Ue,null,p,te)}for(V in p)if(te=p[V],ae=h[V],p.hasOwnProperty(V)&&te!==ae&&(te!=null||ae!=null))switch(V){case"selected":o.selected=te&&typeof te!="function"&&typeof te!="symbol";break;default:_t(o,u,V,te,p,ae)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Be in h)te=h[Be],h.hasOwnProperty(Be)&&te!=null&&!p.hasOwnProperty(Be)&&_t(o,u,Be,null,p,te);for(Q in p)if(te=p[Q],ae=h[Q],p.hasOwnProperty(Q)&&te!==ae&&(te!=null||ae!=null))switch(Q){case"children":case"dangerouslySetInnerHTML":if(te!=null)throw Error(n(137,u));break;default:_t(o,u,Q,te,p,ae)}return;default:if(Ep(u)){for(var St in h)te=h[St],h.hasOwnProperty(St)&&te!==void 0&&!p.hasOwnProperty(St)&&um(o,u,St,void 0,p,te);for(ce in p)te=p[ce],ae=h[ce],!p.hasOwnProperty(ce)||te===ae||te===void 0&&ae===void 0||um(o,u,ce,te,p,ae);return}}for(var $ in h)te=h[$],h.hasOwnProperty($)&&te!=null&&!p.hasOwnProperty($)&&_t(o,u,$,null,p,te);for(he in p)te=p[he],ae=h[he],!p.hasOwnProperty(he)||te===ae||te==null&&ae==null||_t(o,u,he,te,p,ae)}var lm=null,cm=null;function oh(o){return o.nodeType===9?o:o.ownerDocument}function lw(o){switch(o){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function cw(o,u){if(o===0)switch(u){case"svg":return 1;case"math":return 2;default:return 0}return o===1&&u==="foreignObject"?0:o}function fm(o,u){return o==="textarea"||o==="noscript"||typeof u.children=="string"||typeof u.children=="number"||typeof u.children=="bigint"||typeof u.dangerouslySetInnerHTML=="object"&&u.dangerouslySetInnerHTML!==null&&u.dangerouslySetInnerHTML.__html!=null}var hm=null;function kA(){var o=window.event;return o&&o.type==="popstate"?o===hm?!1:(hm=o,!0):(hm=null,!1)}var fw=typeof setTimeout=="function"?setTimeout:void 0,OA=typeof clearTimeout=="function"?clearTimeout:void 0,hw=typeof Promise=="function"?Promise:void 0,NA=typeof queueMicrotask=="function"?queueMicrotask:typeof hw<"u"?function(o){return hw.resolve(null).then(o).catch(MA)}:fw;function MA(o){setTimeout(function(){throw o})}function Ii(o){return o==="head"}function dw(o,u){var h=u,p=0,y=0;do{var x=h.nextSibling;if(o.removeChild(h),x&&x.nodeType===8)if(h=x.data,h==="/$"){if(0<p&&8>p){h=p;var A=o.ownerDocument;if(h&1&&Hl(A.documentElement),h&2&&Hl(A.body),h&4)for(h=A.head,Hl(h),A=h.firstChild;A;){var O=A.nextSibling,V=A.nodeName;A[rl]||V==="SCRIPT"||V==="STYLE"||V==="LINK"&&A.rel.toLowerCase()==="stylesheet"||h.removeChild(A),A=O}}if(y===0){o.removeChild(x),Yl(u);return}y--}else h==="$"||h==="$?"||h==="$!"?y++:p=h.charCodeAt(0)-48;else p=0;h=x}while(h);Yl(u)}function dm(o){var u=o.firstChild;for(u&&u.nodeType===10&&(u=u.nextSibling);u;){var h=u;switch(u=u.nextSibling,h.nodeName){case"HTML":case"HEAD":case"BODY":dm(h),yp(h);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(h.rel.toLowerCase()==="stylesheet")continue}o.removeChild(h)}}function IA(o,u,h,p){for(;o.nodeType===1;){var y=h;if(o.nodeName.toLowerCase()!==u.toLowerCase()){if(!p&&(o.nodeName!=="INPUT"||o.type!=="hidden"))break}else if(p){if(!o[rl])switch(u){case"meta":if(!o.hasAttribute("itemprop"))break;return o;case"link":if(x=o.getAttribute("rel"),x==="stylesheet"&&o.hasAttribute("data-precedence"))break;if(x!==y.rel||o.getAttribute("href")!==(y.href==null||y.href===""?null:y.href)||o.getAttribute("crossorigin")!==(y.crossOrigin==null?null:y.crossOrigin)||o.getAttribute("title")!==(y.title==null?null:y.title))break;return o;case"style":if(o.hasAttribute("data-precedence"))break;return o;case"script":if(x=o.getAttribute("src"),(x!==(y.src==null?null:y.src)||o.getAttribute("type")!==(y.type==null?null:y.type)||o.getAttribute("crossorigin")!==(y.crossOrigin==null?null:y.crossOrigin))&&x&&o.hasAttribute("async")&&!o.hasAttribute("itemprop"))break;return o;default:return o}}else if(u==="input"&&o.type==="hidden"){var x=y.name==null?null:""+y.name;if(y.type==="hidden"&&o.getAttribute("name")===x)return o}else return o;if(o=Ur(o.nextSibling),o===null)break}return null}function FA(o,u,h){if(u==="")return null;for(;o.nodeType!==3;)if((o.nodeType!==1||o.nodeName!=="INPUT"||o.type!=="hidden")&&!h||(o=Ur(o.nextSibling),o===null))return null;return o}function pm(o){return o.data==="$!"||o.data==="$?"&&o.ownerDocument.readyState==="complete"}function BA(o,u){var h=o.ownerDocument;if(o.data!=="$?"||h.readyState==="complete")u();else{var p=function(){u(),h.removeEventListener("DOMContentLoaded",p)};h.addEventListener("DOMContentLoaded",p),o._reactRetry=p}}function Ur(o){for(;o!=null;o=o.nextSibling){var u=o.nodeType;if(u===1||u===3)break;if(u===8){if(u=o.data,u==="$"||u==="$!"||u==="$?"||u==="F!"||u==="F")break;if(u==="/$")return null}}return o}var vm=null;function pw(o){o=o.previousSibling;for(var u=0;o;){if(o.nodeType===8){var h=o.data;if(h==="$"||h==="$!"||h==="$?"){if(u===0)return o;u--}else h==="/$"&&u++}o=o.previousSibling}return null}function vw(o,u,h){switch(u=oh(h),o){case"html":if(o=u.documentElement,!o)throw Error(n(452));return o;case"head":if(o=u.head,!o)throw Error(n(453));return o;case"body":if(o=u.body,!o)throw Error(n(454));return o;default:throw Error(n(451))}}function Hl(o){for(var u=o.attributes;u.length;)o.removeAttributeNode(u[0]);yp(o)}var Tr=new Map,mw=new Set;function sh(o){return typeof o.getRootNode=="function"?o.getRootNode():o.nodeType===9?o:o.ownerDocument}var qa=G.d;G.d={f:LA,r:PA,D:zA,C:UA,L:VA,m:HA,X:WA,S:jA,M:GA};function LA(){var o=qa.f(),u=Qf();return o||u}function PA(o){var u=ms(o);u!==null&&u.tag===5&&u.type==="form"?B1(u):qa.r(o)}var Ys=typeof document>"u"?null:document;function gw(o,u,h){var p=Ys;if(p&&typeof u=="string"&&u){var y=xr(u);y='link[rel="'+o+'"][href="'+y+'"]',typeof h=="string"&&(y+='[crossorigin="'+h+'"]'),mw.has(y)||(mw.add(y),o={rel:o,crossOrigin:h,href:u},p.querySelector(y)===null&&(u=p.createElement("link"),xn(u,"link",o),un(u),p.head.appendChild(u)))}}function zA(o){qa.D(o),gw("dns-prefetch",o,null)}function UA(o,u){qa.C(o,u),gw("preconnect",o,u)}function VA(o,u,h){qa.L(o,u,h);var p=Ys;if(p&&o&&u){var y='link[rel="preload"][as="'+xr(u)+'"]';u==="image"&&h&&h.imageSrcSet?(y+='[imagesrcset="'+xr(h.imageSrcSet)+'"]',typeof h.imageSizes=="string"&&(y+='[imagesizes="'+xr(h.imageSizes)+'"]')):y+='[href="'+xr(o)+'"]';var x=y;switch(u){case"style":x=Zs(o);break;case"script":x=Qs(o)}Tr.has(x)||(o=d({rel:"preload",href:u==="image"&&h&&h.imageSrcSet?void 0:o,as:u},h),Tr.set(x,o),p.querySelector(y)!==null||u==="style"&&p.querySelector(jl(x))||u==="script"&&p.querySelector(Wl(x))||(u=p.createElement("link"),xn(u,"link",o),un(u),p.head.appendChild(u)))}}function HA(o,u){qa.m(o,u);var h=Ys;if(h&&o){var p=u&&typeof u.as=="string"?u.as:"script",y='link[rel="modulepreload"][as="'+xr(p)+'"][href="'+xr(o)+'"]',x=y;switch(p){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":x=Qs(o)}if(!Tr.has(x)&&(o=d({rel:"modulepreload",href:o},u),Tr.set(x,o),h.querySelector(y)===null)){switch(p){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(h.querySelector(Wl(x)))return}p=h.createElement("link"),xn(p,"link",o),un(p),h.head.appendChild(p)}}}function jA(o,u,h){qa.S(o,u,h);var p=Ys;if(p&&o){var y=gs(p).hoistableStyles,x=Zs(o);u=u||"default";var A=y.get(x);if(!A){var O={loading:0,preload:null};if(A=p.querySelector(jl(x)))O.loading=5;else{o=d({rel:"stylesheet",href:o,"data-precedence":u},h),(h=Tr.get(x))&&mm(o,h);var V=A=p.createElement("link");un(V),xn(V,"link",o),V._p=new Promise(function(Q,ce){V.onload=Q,V.onerror=ce}),V.addEventListener("load",function(){O.loading|=1}),V.addEventListener("error",function(){O.loading|=2}),O.loading|=4,uh(A,u,p)}A={type:"stylesheet",instance:A,count:1,state:O},y.set(x,A)}}}function WA(o,u){qa.X(o,u);var h=Ys;if(h&&o){var p=gs(h).hoistableScripts,y=Qs(o),x=p.get(y);x||(x=h.querySelector(Wl(y)),x||(o=d({src:o,async:!0},u),(u=Tr.get(y))&&gm(o,u),x=h.createElement("script"),un(x),xn(x,"link",o),h.head.appendChild(x)),x={type:"script",instance:x,count:1,state:null},p.set(y,x))}}function GA(o,u){qa.M(o,u);var h=Ys;if(h&&o){var p=gs(h).hoistableScripts,y=Qs(o),x=p.get(y);x||(x=h.querySelector(Wl(y)),x||(o=d({src:o,async:!0,type:"module"},u),(u=Tr.get(y))&&gm(o,u),x=h.createElement("script"),un(x),xn(x,"link",o),h.head.appendChild(x)),x={type:"script",instance:x,count:1,state:null},p.set(y,x))}}function yw(o,u,h,p){var y=(y=me.current)?sh(y):null;if(!y)throw Error(n(446));switch(o){case"meta":case"title":return null;case"style":return typeof h.precedence=="string"&&typeof h.href=="string"?(u=Zs(h.href),h=gs(y).hoistableStyles,p=h.get(u),p||(p={type:"style",instance:null,count:0,state:null},h.set(u,p)),p):{type:"void",instance:null,count:0,state:null};case"link":if(h.rel==="stylesheet"&&typeof h.href=="string"&&typeof h.precedence=="string"){o=Zs(h.href);var x=gs(y).hoistableStyles,A=x.get(o);if(A||(y=y.ownerDocument||y,A={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},x.set(o,A),(x=y.querySelector(jl(o)))&&!x._p&&(A.instance=x,A.state.loading=5),Tr.has(o)||(h={rel:"preload",as:"style",href:h.href,crossOrigin:h.crossOrigin,integrity:h.integrity,media:h.media,hrefLang:h.hrefLang,referrerPolicy:h.referrerPolicy},Tr.set(o,h),x||qA(y,o,h,A.state))),u&&p===null)throw Error(n(528,""));return A}if(u&&p!==null)throw Error(n(529,""));return null;case"script":return u=h.async,h=h.src,typeof h=="string"&&u&&typeof u!="function"&&typeof u!="symbol"?(u=Qs(h),h=gs(y).hoistableScripts,p=h.get(u),p||(p={type:"script",instance:null,count:0,state:null},h.set(u,p)),p):{type:"void",instance:null,count:0,state:null};default:throw Error(n(444,o))}}function Zs(o){return'href="'+xr(o)+'"'}function jl(o){return'link[rel="stylesheet"]['+o+"]"}function bw(o){return d({},o,{"data-precedence":o.precedence,precedence:null})}function qA(o,u,h,p){o.querySelector('link[rel="preload"][as="style"]['+u+"]")?p.loading=1:(u=o.createElement("link"),p.preload=u,u.addEventListener("load",function(){return p.loading|=1}),u.addEventListener("error",function(){return p.loading|=2}),xn(u,"link",h),un(u),o.head.appendChild(u))}function Qs(o){return'[src="'+xr(o)+'"]'}function Wl(o){return"script[async]"+o}function xw(o,u,h){if(u.count++,u.instance===null)switch(u.type){case"style":var p=o.querySelector('style[data-href~="'+xr(h.href)+'"]');if(p)return u.instance=p,un(p),p;var y=d({},h,{"data-href":h.href,"data-precedence":h.precedence,href:null,precedence:null});return p=(o.ownerDocument||o).createElement("style"),un(p),xn(p,"style",y),uh(p,h.precedence,o),u.instance=p;case"stylesheet":y=Zs(h.href);var x=o.querySelector(jl(y));if(x)return u.state.loading|=4,u.instance=x,un(x),x;p=bw(h),(y=Tr.get(y))&&mm(p,y),x=(o.ownerDocument||o).createElement("link"),un(x);var A=x;return A._p=new Promise(function(O,V){A.onload=O,A.onerror=V}),xn(x,"link",p),u.state.loading|=4,uh(x,h.precedence,o),u.instance=x;case"script":return x=Qs(h.src),(y=o.querySelector(Wl(x)))?(u.instance=y,un(y),y):(p=h,(y=Tr.get(x))&&(p=d({},h),gm(p,y)),o=o.ownerDocument||o,y=o.createElement("script"),un(y),xn(y,"link",p),o.head.appendChild(y),u.instance=y);case"void":return null;default:throw Error(n(443,u.type))}else u.type==="stylesheet"&&(u.state.loading&4)===0&&(p=u.instance,u.state.loading|=4,uh(p,h.precedence,o));return u.instance}function uh(o,u,h){for(var p=h.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),y=p.length?p[p.length-1]:null,x=y,A=0;A<p.length;A++){var O=p[A];if(O.dataset.precedence===u)x=O;else if(x!==y)break}x?x.parentNode.insertBefore(o,x.nextSibling):(u=h.nodeType===9?h.head:h,u.insertBefore(o,u.firstChild))}function mm(o,u){o.crossOrigin==null&&(o.crossOrigin=u.crossOrigin),o.referrerPolicy==null&&(o.referrerPolicy=u.referrerPolicy),o.title==null&&(o.title=u.title)}function gm(o,u){o.crossOrigin==null&&(o.crossOrigin=u.crossOrigin),o.referrerPolicy==null&&(o.referrerPolicy=u.referrerPolicy),o.integrity==null&&(o.integrity=u.integrity)}var lh=null;function ww(o,u,h){if(lh===null){var p=new Map,y=lh=new Map;y.set(h,p)}else y=lh,p=y.get(h),p||(p=new Map,y.set(h,p));if(p.has(o))return p;for(p.set(o,null),h=h.getElementsByTagName(o),y=0;y<h.length;y++){var x=h[y];if(!(x[rl]||x[Cn]||o==="link"&&x.getAttribute("rel")==="stylesheet")&&x.namespaceURI!=="http://www.w3.org/2000/svg"){var A=x.getAttribute(u)||"";A=o+A;var O=p.get(A);O?O.push(x):p.set(A,[x])}}return p}function _w(o,u,h){o=o.ownerDocument||o,o.head.insertBefore(h,u==="title"?o.querySelector("head > title"):null)}function KA(o,u,h){if(h===1||u.itemProp!=null)return!1;switch(o){case"meta":case"title":return!0;case"style":if(typeof u.precedence!="string"||typeof u.href!="string"||u.href==="")break;return!0;case"link":if(typeof u.rel!="string"||typeof u.href!="string"||u.href===""||u.onLoad||u.onError)break;switch(u.rel){case"stylesheet":return o=u.disabled,typeof u.precedence=="string"&&o==null;default:return!0}case"script":if(u.async&&typeof u.async!="function"&&typeof u.async!="symbol"&&!u.onLoad&&!u.onError&&u.src&&typeof u.src=="string")return!0}return!1}function Sw(o){return!(o.type==="stylesheet"&&(o.state.loading&3)===0)}var Gl=null;function XA(){}function $A(o,u,h){if(Gl===null)throw Error(n(475));var p=Gl;if(u.type==="stylesheet"&&(typeof h.media!="string"||matchMedia(h.media).matches!==!1)&&(u.state.loading&4)===0){if(u.instance===null){var y=Zs(h.href),x=o.querySelector(jl(y));if(x){o=x._p,o!==null&&typeof o=="object"&&typeof o.then=="function"&&(p.count++,p=ch.bind(p),o.then(p,p)),u.state.loading|=4,u.instance=x,un(x);return}x=o.ownerDocument||o,h=bw(h),(y=Tr.get(y))&&mm(h,y),x=x.createElement("link"),un(x);var A=x;A._p=new Promise(function(O,V){A.onload=O,A.onerror=V}),xn(x,"link",h),u.instance=x}p.stylesheets===null&&(p.stylesheets=new Map),p.stylesheets.set(u,o),(o=u.state.preload)&&(u.state.loading&3)===0&&(p.count++,u=ch.bind(p),o.addEventListener("load",u),o.addEventListener("error",u))}}function YA(){if(Gl===null)throw Error(n(475));var o=Gl;return o.stylesheets&&o.count===0&&ym(o,o.stylesheets),0<o.count?function(u){var h=setTimeout(function(){if(o.stylesheets&&ym(o,o.stylesheets),o.unsuspend){var p=o.unsuspend;o.unsuspend=null,p()}},6e4);return o.unsuspend=u,function(){o.unsuspend=null,clearTimeout(h)}}:null}function ch(){if(this.count--,this.count===0){if(this.stylesheets)ym(this,this.stylesheets);else if(this.unsuspend){var o=this.unsuspend;this.unsuspend=null,o()}}}var fh=null;function ym(o,u){o.stylesheets=null,o.unsuspend!==null&&(o.count++,fh=new Map,u.forEach(ZA,o),fh=null,ch.call(o))}function ZA(o,u){if(!(u.state.loading&4)){var h=fh.get(o);if(h)var p=h.get(null);else{h=new Map,fh.set(o,h);for(var y=o.querySelectorAll("link[data-precedence],style[data-precedence]"),x=0;x<y.length;x++){var A=y[x];(A.nodeName==="LINK"||A.getAttribute("media")!=="not all")&&(h.set(A.dataset.precedence,A),p=A)}p&&h.set(null,p)}y=u.instance,A=y.getAttribute("data-precedence"),x=h.get(A)||p,x===p&&h.set(null,y),h.set(A,y),this.count++,p=ch.bind(this),y.addEventListener("load",p),y.addEventListener("error",p),x?x.parentNode.insertBefore(y,x.nextSibling):(o=o.nodeType===9?o.head:o,o.insertBefore(y,o.firstChild)),u.state.loading|=4}}var ql={$$typeof:C,Provider:null,Consumer:null,_currentValue:X,_currentValue2:X,_threadCount:0};function QA(o,u,h,p,y,x,A,O){this.tag=1,this.containerInfo=o,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=pp(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=pp(0),this.hiddenUpdates=pp(null),this.identifierPrefix=p,this.onUncaughtError=y,this.onCaughtError=x,this.onRecoverableError=A,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=O,this.incompleteTransitions=new Map}function Ew(o,u,h,p,y,x,A,O,V,Q,ce,he){return o=new QA(o,u,h,A,O,V,Q,he),u=1,x===!0&&(u|=24),x=nr(3,null,null,u),o.current=x,x.stateNode=o,u=Jp(),u.refCount++,o.pooledCache=u,u.refCount++,x.memoizedState={element:p,isDehydrated:h,cache:u},rv(x),o}function Cw(o){return o?(o=Ds,o):Ds}function Rw(o,u,h,p,y,x){y=Cw(y),p.context===null?p.context=y:p.pendingContext=y,p=wi(u),p.payload={element:h},x=x===void 0?null:x,x!==null&&(p.callback=x),h=_i(o,p,u),h!==null&&(sr(h,o,u),_l(h,o,u))}function Tw(o,u){if(o=o.memoizedState,o!==null&&o.dehydrated!==null){var h=o.retryLane;o.retryLane=h!==0&&h<u?h:u}}function bm(o,u){Tw(o,u),(o=o.alternate)&&Tw(o,u)}function Aw(o){if(o.tag===13){var u=As(o,67108864);u!==null&&sr(u,o,67108864),bm(o,67108864)}}var hh=!0;function JA(o,u,h,p){var y=U.T;U.T=null;var x=G.p;try{G.p=2,xm(o,u,h,p)}finally{G.p=x,U.T=y}}function eD(o,u,h,p){var y=U.T;U.T=null;var x=G.p;try{G.p=8,xm(o,u,h,p)}finally{G.p=x,U.T=y}}function xm(o,u,h,p){if(hh){var y=wm(p);if(y===null)sm(o,u,p,dh,h),kw(o,p);else if(nD(y,o,u,h,p))p.stopPropagation();else if(kw(o,p),u&4&&-1<tD.indexOf(o)){for(;y!==null;){var x=ms(y);if(x!==null)switch(x.tag){case 3:if(x=x.stateNode,x.current.memoizedState.isDehydrated){var A=Lr(x.pendingLanes);if(A!==0){var O=x;for(O.pendingLanes|=2,O.entangledLanes|=2;A;){var V=1<<31-gn(A);O.entanglements[1]|=V,A&=~V}ia(x),(yt&6)===0&&(Yf=Vt()+500,zl(0))}}break;case 13:O=As(x,2),O!==null&&sr(O,x,2),Qf(),bm(x,2)}if(x=wm(p),x===null&&sm(o,u,p,dh,h),x===y)break;y=x}y!==null&&p.stopPropagation()}else sm(o,u,p,null,h)}}function wm(o){return o=Rp(o),_m(o)}var dh=null;function _m(o){if(dh=null,o=vs(o),o!==null){var u=i(o);if(u===null)o=null;else{var h=u.tag;if(h===13){if(o=s(u),o!==null)return o;o=null}else if(h===3){if(u.stateNode.current.memoizedState.isDehydrated)return u.tag===3?u.stateNode.containerInfo:null;o=null}else u!==o&&(o=null)}}return dh=o,null}function Dw(o){switch(o){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(gr()){case En:return 2;case ka:return 8;case Vn:case ea:return 32;case yr:return 268435456;default:return 32}default:return 32}}var Sm=!1,Fi=null,Bi=null,Li=null,Kl=new Map,Xl=new Map,Pi=[],tD="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function kw(o,u){switch(o){case"focusin":case"focusout":Fi=null;break;case"dragenter":case"dragleave":Bi=null;break;case"mouseover":case"mouseout":Li=null;break;case"pointerover":case"pointerout":Kl.delete(u.pointerId);break;case"gotpointercapture":case"lostpointercapture":Xl.delete(u.pointerId)}}function $l(o,u,h,p,y,x){return o===null||o.nativeEvent!==x?(o={blockedOn:u,domEventName:h,eventSystemFlags:p,nativeEvent:x,targetContainers:[y]},u!==null&&(u=ms(u),u!==null&&Aw(u)),o):(o.eventSystemFlags|=p,u=o.targetContainers,y!==null&&u.indexOf(y)===-1&&u.push(y),o)}function nD(o,u,h,p,y){switch(u){case"focusin":return Fi=$l(Fi,o,u,h,p,y),!0;case"dragenter":return Bi=$l(Bi,o,u,h,p,y),!0;case"mouseover":return Li=$l(Li,o,u,h,p,y),!0;case"pointerover":var x=y.pointerId;return Kl.set(x,$l(Kl.get(x)||null,o,u,h,p,y)),!0;case"gotpointercapture":return x=y.pointerId,Xl.set(x,$l(Xl.get(x)||null,o,u,h,p,y)),!0}return!1}function Ow(o){var u=vs(o.target);if(u!==null){var h=i(u);if(h!==null){if(u=h.tag,u===13){if(u=s(h),u!==null){o.blockedOn=u,$R(o.priority,function(){if(h.tag===13){var p=or();p=vp(p);var y=As(h,p);y!==null&&sr(y,h,p),bm(h,p)}});return}}else if(u===3&&h.stateNode.current.memoizedState.isDehydrated){o.blockedOn=h.tag===3?h.stateNode.containerInfo:null;return}}}o.blockedOn=null}function ph(o){if(o.blockedOn!==null)return!1;for(var u=o.targetContainers;0<u.length;){var h=wm(o.nativeEvent);if(h===null){h=o.nativeEvent;var p=new h.constructor(h.type,h);Cp=p,h.target.dispatchEvent(p),Cp=null}else return u=ms(h),u!==null&&Aw(u),o.blockedOn=h,!1;u.shift()}return!0}function Nw(o,u,h){ph(o)&&h.delete(u)}function rD(){Sm=!1,Fi!==null&&ph(Fi)&&(Fi=null),Bi!==null&&ph(Bi)&&(Bi=null),Li!==null&&ph(Li)&&(Li=null),Kl.forEach(Nw),Xl.forEach(Nw)}function vh(o,u){o.blockedOn===u&&(o.blockedOn=null,Sm||(Sm=!0,r.unstable_scheduleCallback(r.unstable_NormalPriority,rD)))}var mh=null;function Mw(o){mh!==o&&(mh=o,r.unstable_scheduleCallback(r.unstable_NormalPriority,function(){mh===o&&(mh=null);for(var u=0;u<o.length;u+=3){var h=o[u],p=o[u+1],y=o[u+2];if(typeof p!="function"){if(_m(p||h)===null)continue;break}var x=ms(h);x!==null&&(o.splice(u,3),u-=3,_v(x,{pending:!0,data:y,method:h.method,action:p},p,y))}}))}function Yl(o){function u(V){return vh(V,o)}Fi!==null&&vh(Fi,o),Bi!==null&&vh(Bi,o),Li!==null&&vh(Li,o),Kl.forEach(u),Xl.forEach(u);for(var h=0;h<Pi.length;h++){var p=Pi[h];p.blockedOn===o&&(p.blockedOn=null)}for(;0<Pi.length&&(h=Pi[0],h.blockedOn===null);)Ow(h),h.blockedOn===null&&Pi.shift();if(h=(o.ownerDocument||o).$$reactFormReplay,h!=null)for(p=0;p<h.length;p+=3){var y=h[p],x=h[p+1],A=y[Hn]||null;if(typeof x=="function")A||Mw(h);else if(A){var O=null;if(x&&x.hasAttribute("formAction")){if(y=x,A=x[Hn]||null)O=A.formAction;else if(_m(y)!==null)continue}else O=A.action;typeof O=="function"?h[p+1]=O:(h.splice(p,3),p-=3),Mw(h)}}}function Em(o){this._internalRoot=o}gh.prototype.render=Em.prototype.render=function(o){var u=this._internalRoot;if(u===null)throw Error(n(409));var h=u.current,p=or();Rw(h,p,o,u,null,null)},gh.prototype.unmount=Em.prototype.unmount=function(){var o=this._internalRoot;if(o!==null){this._internalRoot=null;var u=o.containerInfo;Rw(o.current,2,null,o,null,null),Qf(),u[ps]=null}};function gh(o){this._internalRoot=o}gh.prototype.unstable_scheduleHydration=function(o){if(o){var u=Y0();o={blockedOn:null,target:o,priority:u};for(var h=0;h<Pi.length&&u!==0&&u<Pi[h].priority;h++);Pi.splice(h,0,o),h===0&&Ow(o)}};var Iw=t.version;if(Iw!=="19.1.0")throw Error(n(527,Iw,"19.1.0"));G.findDOMNode=function(o){var u=o._reactInternals;if(u===void 0)throw typeof o.render=="function"?Error(n(188)):(o=Object.keys(o).join(","),Error(n(268,o)));return o=c(u),o=o!==null?f(o):null,o=o===null?null:o.stateNode,o};var aD={bundleType:0,version:"19.1.0",rendererPackageName:"react-dom",currentDispatcherRef:U,reconcilerVersion:"19.1.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var yh=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!yh.isDisabled&&yh.supportsFiber)try{Oa=yh.inject(aD),Gt=yh}catch{}}return Ql.createRoot=function(o,u){if(!a(o))throw Error(n(299));var h=!1,p="",y=Y1,x=Z1,A=Q1,O=null;return u!=null&&(u.unstable_strictMode===!0&&(h=!0),u.identifierPrefix!==void 0&&(p=u.identifierPrefix),u.onUncaughtError!==void 0&&(y=u.onUncaughtError),u.onCaughtError!==void 0&&(x=u.onCaughtError),u.onRecoverableError!==void 0&&(A=u.onRecoverableError),u.unstable_transitionCallbacks!==void 0&&(O=u.unstable_transitionCallbacks)),u=Ew(o,1,!1,null,null,h,p,y,x,A,O,null),o[ps]=u.current,om(o),new Em(u)},Ql.hydrateRoot=function(o,u,h){if(!a(o))throw Error(n(299));var p=!1,y="",x=Y1,A=Z1,O=Q1,V=null,Q=null;return h!=null&&(h.unstable_strictMode===!0&&(p=!0),h.identifierPrefix!==void 0&&(y=h.identifierPrefix),h.onUncaughtError!==void 0&&(x=h.onUncaughtError),h.onCaughtError!==void 0&&(A=h.onCaughtError),h.onRecoverableError!==void 0&&(O=h.onRecoverableError),h.unstable_transitionCallbacks!==void 0&&(V=h.unstable_transitionCallbacks),h.formState!==void 0&&(Q=h.formState)),u=Ew(o,1,!0,u,h??null,p,y,x,A,O,V,Q),u.context=Cw(null),h=u.current,p=or(),p=vp(p),y=wi(p),y.callback=null,_i(h,y,p),h=p,u.current.lanes=h,nl(u,h),ia(u),o[ps]=u.current,om(o),new gh(u)},Ql.version="19.1.0",Ql}var Gw;function vD(){if(Gw)return Tm.exports;Gw=1;function r(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(r)}catch(t){console.error(t)}}return r(),Tm.exports=pD(),Tm.exports}var mD=vD();const QU=iS(mD);var Z=Sy();const Zn=iS(Z);var pn=function(){return pn=Object.assign||function(t){for(var e,n=1,a=arguments.length;n<a;n++){e=arguments[n];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}return t},pn.apply(this,arguments)};function Bu(r,t,e){if(e||arguments.length===2)for(var n=0,a=t.length,i;n<a;n++)(i||!(n in t))&&(i||(i=Array.prototype.slice.call(t,0,n)),i[n]=t[n]);return r.concat(i||Array.prototype.slice.call(t))}var At="-ms-",fc="-moz-",vt="-webkit-",oS="comm",Pd="rule",Ey="decl",gD="@import",sS="@keyframes",yD="@layer",uS=Math.abs,Cy=String.fromCharCode,bg=Object.assign;function bD(r,t){return dn(r,0)^45?(((t<<2^dn(r,0))<<2^dn(r,1))<<2^dn(r,2))<<2^dn(r,3):0}function lS(r){return r.trim()}function Za(r,t){return(r=t.exec(r))?r[0]:r}function Ze(r,t,e){return r.replace(t,e)}function Vh(r,t,e){return r.indexOf(t,e)}function dn(r,t){return r.charCodeAt(t)|0}function Lu(r,t,e){return r.slice(t,e)}function ha(r){return r.length}function cS(r){return r.length}function sc(r,t){return t.push(r),r}function xD(r,t){return r.map(t).join("")}function qw(r,t){return r.filter(function(e){return!Za(e,t)})}var zd=1,Pu=1,fS=0,Ir=0,Xt=0,$u="";function Ud(r,t,e,n,a,i,s,l){return{value:r,root:t,parent:e,type:n,props:a,children:i,line:zd,column:Pu,length:s,return:"",siblings:l}}function Hi(r,t){return bg(Ud("",null,null,"",null,null,0,r.siblings),r,{length:-r.length},t)}function Js(r){for(;r.root;)r=Hi(r.root,{children:[r]});sc(r,r.siblings)}function wD(){return Xt}function _D(){return Xt=Ir>0?dn($u,--Ir):0,Pu--,Xt===10&&(Pu=1,zd--),Xt}function Kr(){return Xt=Ir<fS?dn($u,Ir++):0,Pu++,Xt===10&&(Pu=1,zd++),Xt}function Zo(){return dn($u,Ir)}function Hh(){return Ir}function Vd(r,t){return Lu($u,r,t)}function xg(r){switch(r){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function SD(r){return zd=Pu=1,fS=ha($u=r),Ir=0,[]}function ED(r){return $u="",r}function Nm(r){return lS(Vd(Ir-1,wg(r===91?r+2:r===40?r+1:r)))}function CD(r){for(;(Xt=Zo())&&Xt<33;)Kr();return xg(r)>2||xg(Xt)>3?"":" "}function RD(r,t){for(;--t&&Kr()&&!(Xt<48||Xt>102||Xt>57&&Xt<65||Xt>70&&Xt<97););return Vd(r,Hh()+(t<6&&Zo()==32&&Kr()==32))}function wg(r){for(;Kr();)switch(Xt){case r:return Ir;case 34:case 39:r!==34&&r!==39&&wg(Xt);break;case 40:r===41&&wg(r);break;case 92:Kr();break}return Ir}function TD(r,t){for(;Kr()&&r+Xt!==57;)if(r+Xt===84&&Zo()===47)break;return"/*"+Vd(t,Ir-1)+"*"+Cy(r===47?r:Kr())}function AD(r){for(;!xg(Zo());)Kr();return Vd(r,Ir)}function DD(r){return ED(jh("",null,null,null,[""],r=SD(r),0,[0],r))}function jh(r,t,e,n,a,i,s,l,c){for(var f=0,d=0,v=s,m=0,g=0,b=0,w=1,_=1,S=1,E=0,C="",R=a,T=i,D=n,k=C;_;)switch(b=E,E=Kr()){case 40:if(b!=108&&dn(k,v-1)==58){Vh(k+=Ze(Nm(E),"&","&\f"),"&\f",uS(f?l[f-1]:0))!=-1&&(S=-1);break}case 34:case 39:case 91:k+=Nm(E);break;case 9:case 10:case 13:case 32:k+=CD(b);break;case 92:k+=RD(Hh()-1,7);continue;case 47:switch(Zo()){case 42:case 47:sc(kD(TD(Kr(),Hh()),t,e,c),c);break;default:k+="/"}break;case 123*w:l[f++]=ha(k)*S;case 125*w:case 59:case 0:switch(E){case 0:case 125:_=0;case 59+d:S==-1&&(k=Ze(k,/\f/g,"")),g>0&&ha(k)-v&&sc(g>32?Xw(k+";",n,e,v-1,c):Xw(Ze(k," ","")+";",n,e,v-2,c),c);break;case 59:k+=";";default:if(sc(D=Kw(k,t,e,f,d,a,l,C,R=[],T=[],v,i),i),E===123)if(d===0)jh(k,t,D,D,R,i,v,l,T);else switch(m===99&&dn(k,3)===110?100:m){case 100:case 108:case 109:case 115:jh(r,D,D,n&&sc(Kw(r,D,D,0,0,a,l,C,a,R=[],v,T),T),a,T,v,l,n?R:T);break;default:jh(k,D,D,D,[""],T,0,l,T)}}f=d=g=0,w=S=1,C=k="",v=s;break;case 58:v=1+ha(k),g=b;default:if(w<1){if(E==123)--w;else if(E==125&&w++==0&&_D()==125)continue}switch(k+=Cy(E),E*w){case 38:S=d>0?1:(k+="\f",-1);break;case 44:l[f++]=(ha(k)-1)*S,S=1;break;case 64:Zo()===45&&(k+=Nm(Kr())),m=Zo(),d=v=ha(C=k+=AD(Hh())),E++;break;case 45:b===45&&ha(k)==2&&(w=0)}}return i}function Kw(r,t,e,n,a,i,s,l,c,f,d,v){for(var m=a-1,g=a===0?i:[""],b=cS(g),w=0,_=0,S=0;w<n;++w)for(var E=0,C=Lu(r,m+1,m=uS(_=s[w])),R=r;E<b;++E)(R=lS(_>0?g[E]+" "+C:Ze(C,/&\f/g,g[E])))&&(c[S++]=R);return Ud(r,t,e,a===0?Pd:l,c,f,d,v)}function kD(r,t,e,n){return Ud(r,t,e,oS,Cy(wD()),Lu(r,2,-2),0,n)}function Xw(r,t,e,n,a){return Ud(r,t,e,Ey,Lu(r,0,n),Lu(r,n+1,-1),n,a)}function hS(r,t,e){switch(bD(r,t)){case 5103:return vt+"print-"+r+r;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return vt+r+r;case 4789:return fc+r+r;case 5349:case 4246:case 4810:case 6968:case 2756:return vt+r+fc+r+At+r+r;case 5936:switch(dn(r,t+11)){case 114:return vt+r+At+Ze(r,/[svh]\w+-[tblr]{2}/,"tb")+r;case 108:return vt+r+At+Ze(r,/[svh]\w+-[tblr]{2}/,"tb-rl")+r;case 45:return vt+r+At+Ze(r,/[svh]\w+-[tblr]{2}/,"lr")+r}case 6828:case 4268:case 2903:return vt+r+At+r+r;case 6165:return vt+r+At+"flex-"+r+r;case 5187:return vt+r+Ze(r,/(\w+).+(:[^]+)/,vt+"box-$1$2"+At+"flex-$1$2")+r;case 5443:return vt+r+At+"flex-item-"+Ze(r,/flex-|-self/g,"")+(Za(r,/flex-|baseline/)?"":At+"grid-row-"+Ze(r,/flex-|-self/g,""))+r;case 4675:return vt+r+At+"flex-line-pack"+Ze(r,/align-content|flex-|-self/g,"")+r;case 5548:return vt+r+At+Ze(r,"shrink","negative")+r;case 5292:return vt+r+At+Ze(r,"basis","preferred-size")+r;case 6060:return vt+"box-"+Ze(r,"-grow","")+vt+r+At+Ze(r,"grow","positive")+r;case 4554:return vt+Ze(r,/([^-])(transform)/g,"$1"+vt+"$2")+r;case 6187:return Ze(Ze(Ze(r,/(zoom-|grab)/,vt+"$1"),/(image-set)/,vt+"$1"),r,"")+r;case 5495:case 3959:return Ze(r,/(image-set\([^]*)/,vt+"$1$`$1");case 4968:return Ze(Ze(r,/(.+:)(flex-)?(.*)/,vt+"box-pack:$3"+At+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+vt+r+r;case 4200:if(!Za(r,/flex-|baseline/))return At+"grid-column-align"+Lu(r,t)+r;break;case 2592:case 3360:return At+Ze(r,"template-","")+r;case 4384:case 3616:return e&&e.some(function(n,a){return t=a,Za(n.props,/grid-\w+-end/)})?~Vh(r+(e=e[t].value),"span",0)?r:At+Ze(r,"-start","")+r+At+"grid-row-span:"+(~Vh(e,"span",0)?Za(e,/\d+/):+Za(e,/\d+/)-+Za(r,/\d+/))+";":At+Ze(r,"-start","")+r;case 4896:case 4128:return e&&e.some(function(n){return Za(n.props,/grid-\w+-start/)})?r:At+Ze(Ze(r,"-end","-span"),"span ","")+r;case 4095:case 3583:case 4068:case 2532:return Ze(r,/(.+)-inline(.+)/,vt+"$1$2")+r;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(ha(r)-1-t>6)switch(dn(r,t+1)){case 109:if(dn(r,t+4)!==45)break;case 102:return Ze(r,/(.+:)(.+)-([^]+)/,"$1"+vt+"$2-$3$1"+fc+(dn(r,t+3)==108?"$3":"$2-$3"))+r;case 115:return~Vh(r,"stretch",0)?hS(Ze(r,"stretch","fill-available"),t,e)+r:r}break;case 5152:case 5920:return Ze(r,/(.+?):(\d+)(\s*\/\s*(span)?\s*(\d+))?(.*)/,function(n,a,i,s,l,c,f){return At+a+":"+i+f+(s?At+a+"-span:"+(l?c:+c-+i)+f:"")+r});case 4949:if(dn(r,t+6)===121)return Ze(r,":",":"+vt)+r;break;case 6444:switch(dn(r,dn(r,14)===45?18:11)){case 120:return Ze(r,/(.+:)([^;\s!]+)(;|(\s+)?!.+)?/,"$1"+vt+(dn(r,14)===45?"inline-":"")+"box$3$1"+vt+"$2$3$1"+At+"$2box$3")+r;case 100:return Ze(r,":",":"+At)+r}break;case 5719:case 2647:case 2135:case 3927:case 2391:return Ze(r,"scroll-","scroll-snap-")+r}return r}function Yh(r,t){for(var e="",n=0;n<r.length;n++)e+=t(r[n],n,r,t)||"";return e}function OD(r,t,e,n){switch(r.type){case yD:if(r.children.length)break;case gD:case Ey:return r.return=r.return||r.value;case oS:return"";case sS:return r.return=r.value+"{"+Yh(r.children,n)+"}";case Pd:if(!ha(r.value=r.props.join(",")))return""}return ha(e=Yh(r.children,n))?r.return=r.value+"{"+e+"}":""}function ND(r){var t=cS(r);return function(e,n,a,i){for(var s="",l=0;l<t;l++)s+=r[l](e,n,a,i)||"";return s}}function MD(r){return function(t){t.root||(t=t.return)&&r(t)}}function ID(r,t,e,n){if(r.length>-1&&!r.return)switch(r.type){case Ey:r.return=hS(r.value,r.length,e);return;case sS:return Yh([Hi(r,{value:Ze(r.value,"@","@"+vt)})],n);case Pd:if(r.length)return xD(e=r.props,function(a){switch(Za(a,n=/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":Js(Hi(r,{props:[Ze(a,/:(read-\w+)/,":"+fc+"$1")]})),Js(Hi(r,{props:[a]})),bg(r,{props:qw(e,n)});break;case"::placeholder":Js(Hi(r,{props:[Ze(a,/:(plac\w+)/,":"+vt+"input-$1")]})),Js(Hi(r,{props:[Ze(a,/:(plac\w+)/,":"+fc+"$1")]})),Js(Hi(r,{props:[Ze(a,/:(plac\w+)/,At+"input-$1")]})),Js(Hi(r,{props:[a]})),bg(r,{props:qw(e,n)});break}return""})}}var FD={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},ur={},zu=typeof process<"u"&&ur!==void 0&&(ur.REACT_APP_SC_ATTR||ur.SC_ATTR)||"data-styled",dS="active",pS="data-styled-version",Hd="6.1.17",Ry=`/*!sc*/
`,Zh=typeof window<"u"&&"HTMLElement"in window,BD=!!(typeof SC_DISABLE_SPEEDY=="boolean"?SC_DISABLE_SPEEDY:typeof process<"u"&&ur!==void 0&&ur.REACT_APP_SC_DISABLE_SPEEDY!==void 0&&ur.REACT_APP_SC_DISABLE_SPEEDY!==""?ur.REACT_APP_SC_DISABLE_SPEEDY!=="false"&&ur.REACT_APP_SC_DISABLE_SPEEDY:typeof process<"u"&&ur!==void 0&&ur.SC_DISABLE_SPEEDY!==void 0&&ur.SC_DISABLE_SPEEDY!==""&&ur.SC_DISABLE_SPEEDY!=="false"&&ur.SC_DISABLE_SPEEDY),LD={},jd=Object.freeze([]),Uu=Object.freeze({});function vS(r,t,e){return e===void 0&&(e=Uu),r.theme!==e.theme&&r.theme||t||e.theme}var mS=new Set(["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","tr","track","u","ul","use","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","marker","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"]),PD=/[!"#$%&'()*+,./:;<=>?@[\\\]^`{|}~-]+/g,zD=/(^-|-$)/g;function $w(r){return r.replace(PD,"-").replace(zD,"")}var UD=/(a)(d)/gi,xh=52,Yw=function(r){return String.fromCharCode(r+(r>25?39:97))};function _g(r){var t,e="";for(t=Math.abs(r);t>xh;t=t/xh|0)e=Yw(t%xh)+e;return(Yw(t%xh)+e).replace(UD,"$1-$2")}var Mm,gS=5381,hu=function(r,t){for(var e=t.length;e;)r=33*r^t.charCodeAt(--e);return r},yS=function(r){return hu(gS,r)};function Ty(r){return _g(yS(r)>>>0)}function VD(r){return r.displayName||r.name||"Component"}function Im(r){return typeof r=="string"&&!0}var bS=typeof Symbol=="function"&&Symbol.for,xS=bS?Symbol.for("react.memo"):60115,HD=bS?Symbol.for("react.forward_ref"):60112,jD={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},WD={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},wS={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},GD=((Mm={})[HD]={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},Mm[xS]=wS,Mm);function Zw(r){return("type"in(t=r)&&t.type.$$typeof)===xS?wS:"$$typeof"in r?GD[r.$$typeof]:jD;var t}var qD=Object.defineProperty,KD=Object.getOwnPropertyNames,Qw=Object.getOwnPropertySymbols,XD=Object.getOwnPropertyDescriptor,$D=Object.getPrototypeOf,Jw=Object.prototype;function _S(r,t,e){if(typeof t!="string"){if(Jw){var n=$D(t);n&&n!==Jw&&_S(r,n,e)}var a=KD(t);Qw&&(a=a.concat(Qw(t)));for(var i=Zw(r),s=Zw(t),l=0;l<a.length;++l){var c=a[l];if(!(c in WD||e&&e[c]||s&&c in s||i&&c in i)){var f=XD(t,c);try{qD(r,c,f)}catch{}}}}return r}function ns(r){return typeof r=="function"}function Ay(r){return typeof r=="object"&&"styledComponentId"in r}function Uo(r,t){return r&&t?"".concat(r," ").concat(t):r||t||""}function Qh(r,t){if(r.length===0)return"";for(var e=r[0],n=1;n<r.length;n++)e+=r[n];return e}function mc(r){return r!==null&&typeof r=="object"&&r.constructor.name===Object.name&&!("props"in r&&r.$$typeof)}function Sg(r,t,e){if(e===void 0&&(e=!1),!e&&!mc(r)&&!Array.isArray(r))return t;if(Array.isArray(t))for(var n=0;n<t.length;n++)r[n]=Sg(r[n],t[n]);else if(mc(t))for(var n in t)r[n]=Sg(r[n],t[n]);return r}function Dy(r,t){Object.defineProperty(r,"toString",{value:t})}function uo(r){for(var t=[],e=1;e<arguments.length;e++)t[e-1]=arguments[e];return new Error("An error occurred. See https://github.com/styled-components/styled-components/blob/main/packages/styled-components/src/utils/errors.md#".concat(r," for more information.").concat(t.length>0?" Args: ".concat(t.join(", ")):""))}var YD=function(){function r(t){this.groupSizes=new Uint32Array(512),this.length=512,this.tag=t}return r.prototype.indexOfGroup=function(t){for(var e=0,n=0;n<t;n++)e+=this.groupSizes[n];return e},r.prototype.insertRules=function(t,e){if(t>=this.groupSizes.length){for(var n=this.groupSizes,a=n.length,i=a;t>=i;)if((i<<=1)<0)throw uo(16,"".concat(t));this.groupSizes=new Uint32Array(i),this.groupSizes.set(n),this.length=i;for(var s=a;s<i;s++)this.groupSizes[s]=0}for(var l=this.indexOfGroup(t+1),c=(s=0,e.length);s<c;s++)this.tag.insertRule(l,e[s])&&(this.groupSizes[t]++,l++)},r.prototype.clearGroup=function(t){if(t<this.length){var e=this.groupSizes[t],n=this.indexOfGroup(t),a=n+e;this.groupSizes[t]=0;for(var i=n;i<a;i++)this.tag.deleteRule(n)}},r.prototype.getGroup=function(t){var e="";if(t>=this.length||this.groupSizes[t]===0)return e;for(var n=this.groupSizes[t],a=this.indexOfGroup(t),i=a+n,s=a;s<i;s++)e+="".concat(this.tag.getRule(s)).concat(Ry);return e},r}(),Wh=new Map,Jh=new Map,Gh=1,wh=function(r){if(Wh.has(r))return Wh.get(r);for(;Jh.has(Gh);)Gh++;var t=Gh++;return Wh.set(r,t),Jh.set(t,r),t},ZD=function(r,t){Gh=t+1,Wh.set(r,t),Jh.set(t,r)},QD="style[".concat(zu,"][").concat(pS,'="').concat(Hd,'"]'),JD=new RegExp("^".concat(zu,'\\.g(\\d+)\\[id="([\\w\\d-]+)"\\].*?"([^"]*)')),ek=function(r,t,e){for(var n,a=e.split(","),i=0,s=a.length;i<s;i++)(n=a[i])&&r.registerName(t,n)},tk=function(r,t){for(var e,n=((e=t.textContent)!==null&&e!==void 0?e:"").split(Ry),a=[],i=0,s=n.length;i<s;i++){var l=n[i].trim();if(l){var c=l.match(JD);if(c){var f=0|parseInt(c[1],10),d=c[2];f!==0&&(ZD(d,f),ek(r,d,c[3]),r.getTag().insertRules(f,a)),a.length=0}else a.push(l)}}},e2=function(r){for(var t=document.querySelectorAll(QD),e=0,n=t.length;e<n;e++){var a=t[e];a&&a.getAttribute(zu)!==dS&&(tk(r,a),a.parentNode&&a.parentNode.removeChild(a))}};function nk(){return typeof __webpack_nonce__<"u"?__webpack_nonce__:null}var SS=function(r){var t=document.head,e=r||t,n=document.createElement("style"),a=function(l){var c=Array.from(l.querySelectorAll("style[".concat(zu,"]")));return c[c.length-1]}(e),i=a!==void 0?a.nextSibling:null;n.setAttribute(zu,dS),n.setAttribute(pS,Hd);var s=nk();return s&&n.setAttribute("nonce",s),e.insertBefore(n,i),n},rk=function(){function r(t){this.element=SS(t),this.element.appendChild(document.createTextNode("")),this.sheet=function(e){if(e.sheet)return e.sheet;for(var n=document.styleSheets,a=0,i=n.length;a<i;a++){var s=n[a];if(s.ownerNode===e)return s}throw uo(17)}(this.element),this.length=0}return r.prototype.insertRule=function(t,e){try{return this.sheet.insertRule(e,t),this.length++,!0}catch{return!1}},r.prototype.deleteRule=function(t){this.sheet.deleteRule(t),this.length--},r.prototype.getRule=function(t){var e=this.sheet.cssRules[t];return e&&e.cssText?e.cssText:""},r}(),ak=function(){function r(t){this.element=SS(t),this.nodes=this.element.childNodes,this.length=0}return r.prototype.insertRule=function(t,e){if(t<=this.length&&t>=0){var n=document.createTextNode(e);return this.element.insertBefore(n,this.nodes[t]||null),this.length++,!0}return!1},r.prototype.deleteRule=function(t){this.element.removeChild(this.nodes[t]),this.length--},r.prototype.getRule=function(t){return t<this.length?this.nodes[t].textContent:""},r}(),ik=function(){function r(t){this.rules=[],this.length=0}return r.prototype.insertRule=function(t,e){return t<=this.length&&(this.rules.splice(t,0,e),this.length++,!0)},r.prototype.deleteRule=function(t){this.rules.splice(t,1),this.length--},r.prototype.getRule=function(t){return t<this.length?this.rules[t]:""},r}(),t2=Zh,ok={isServer:!Zh,useCSSOMInjection:!BD},ed=function(){function r(t,e,n){t===void 0&&(t=Uu),e===void 0&&(e={});var a=this;this.options=pn(pn({},ok),t),this.gs=e,this.names=new Map(n),this.server=!!t.isServer,!this.server&&Zh&&t2&&(t2=!1,e2(this)),Dy(this,function(){return function(i){for(var s=i.getTag(),l=s.length,c="",f=function(v){var m=function(S){return Jh.get(S)}(v);if(m===void 0)return"continue";var g=i.names.get(m),b=s.getGroup(v);if(g===void 0||!g.size||b.length===0)return"continue";var w="".concat(zu,".g").concat(v,'[id="').concat(m,'"]'),_="";g!==void 0&&g.forEach(function(S){S.length>0&&(_+="".concat(S,","))}),c+="".concat(b).concat(w,'{content:"').concat(_,'"}').concat(Ry)},d=0;d<l;d++)f(d);return c}(a)})}return r.registerId=function(t){return wh(t)},r.prototype.rehydrate=function(){!this.server&&Zh&&e2(this)},r.prototype.reconstructWithOptions=function(t,e){return e===void 0&&(e=!0),new r(pn(pn({},this.options),t),this.gs,e&&this.names||void 0)},r.prototype.allocateGSInstance=function(t){return this.gs[t]=(this.gs[t]||0)+1},r.prototype.getTag=function(){return this.tag||(this.tag=(t=function(e){var n=e.useCSSOMInjection,a=e.target;return e.isServer?new ik(a):n?new rk(a):new ak(a)}(this.options),new YD(t)));var t},r.prototype.hasNameForId=function(t,e){return this.names.has(t)&&this.names.get(t).has(e)},r.prototype.registerName=function(t,e){if(wh(t),this.names.has(t))this.names.get(t).add(e);else{var n=new Set;n.add(e),this.names.set(t,n)}},r.prototype.insertRules=function(t,e,n){this.registerName(t,e),this.getTag().insertRules(wh(t),n)},r.prototype.clearNames=function(t){this.names.has(t)&&this.names.get(t).clear()},r.prototype.clearRules=function(t){this.getTag().clearGroup(wh(t)),this.clearNames(t)},r.prototype.clearTag=function(){this.tag=void 0},r}(),sk=/&/g,uk=/^\s*\/\/.*$/gm;function ES(r,t){return r.map(function(e){return e.type==="rule"&&(e.value="".concat(t," ").concat(e.value),e.value=e.value.replaceAll(",",",".concat(t," ")),e.props=e.props.map(function(n){return"".concat(t," ").concat(n)})),Array.isArray(e.children)&&e.type!=="@keyframes"&&(e.children=ES(e.children,t)),e})}function lk(r){var t,e,n,a=Uu,i=a.options,s=i===void 0?Uu:i,l=a.plugins,c=l===void 0?jd:l,f=function(m,g,b){return b.startsWith(e)&&b.endsWith(e)&&b.replaceAll(e,"").length>0?".".concat(t):m},d=c.slice();d.push(function(m){m.type===Pd&&m.value.includes("&")&&(m.props[0]=m.props[0].replace(sk,e).replace(n,f))}),s.prefix&&d.push(ID),d.push(OD);var v=function(m,g,b,w){g===void 0&&(g=""),b===void 0&&(b=""),w===void 0&&(w="&"),t=w,e=g,n=new RegExp("\\".concat(e,"\\b"),"g");var _=m.replace(uk,""),S=DD(b||g?"".concat(b," ").concat(g," { ").concat(_," }"):_);s.namespace&&(S=ES(S,s.namespace));var E=[];return Yh(S,ND(d.concat(MD(function(C){return E.push(C)})))),E};return v.hash=c.length?c.reduce(function(m,g){return g.name||uo(15),hu(m,g.name)},gS).toString():"",v}var ck=new ed,Eg=lk(),CS=Zn.createContext({shouldForwardProp:void 0,styleSheet:ck,stylis:Eg});CS.Consumer;Zn.createContext(void 0);function Cg(){return Z.useContext(CS)}var RS=function(){function r(t,e){var n=this;this.inject=function(a,i){i===void 0&&(i=Eg);var s=n.name+i.hash;a.hasNameForId(n.id,s)||a.insertRules(n.id,s,i(n.rules,s,"@keyframes"))},this.name=t,this.id="sc-keyframes-".concat(t),this.rules=e,Dy(this,function(){throw uo(12,String(n.name))})}return r.prototype.getName=function(t){return t===void 0&&(t=Eg),this.name+t.hash},r}(),fk=function(r){return r>="A"&&r<="Z"};function n2(r){for(var t="",e=0;e<r.length;e++){var n=r[e];if(e===1&&n==="-"&&r[0]==="-")return r;fk(n)?t+="-"+n.toLowerCase():t+=n}return t.startsWith("ms-")?"-"+t:t}var TS=function(r){return r==null||r===!1||r===""},AS=function(r){var t,e,n=[];for(var a in r){var i=r[a];r.hasOwnProperty(a)&&!TS(i)&&(Array.isArray(i)&&i.isCss||ns(i)?n.push("".concat(n2(a),":"),i,";"):mc(i)?n.push.apply(n,Bu(Bu(["".concat(a," {")],AS(i),!1),["}"],!1)):n.push("".concat(n2(a),": ").concat((t=a,(e=i)==null||typeof e=="boolean"||e===""?"":typeof e!="number"||e===0||t in FD||t.startsWith("--")?String(e).trim():"".concat(e,"px")),";")))}return n};function ao(r,t,e,n){if(TS(r))return[];if(Ay(r))return[".".concat(r.styledComponentId)];if(ns(r)){if(!ns(i=r)||i.prototype&&i.prototype.isReactComponent||!t)return[r];var a=r(t);return ao(a,t,e,n)}var i;return r instanceof RS?e?(r.inject(e,n),[r.getName(n)]):[r]:mc(r)?AS(r):Array.isArray(r)?Array.prototype.concat.apply(jd,r.map(function(s){return ao(s,t,e,n)})):[r.toString()]}function DS(r){for(var t=0;t<r.length;t+=1){var e=r[t];if(ns(e)&&!Ay(e))return!1}return!0}var hk=yS(Hd),dk=function(){function r(t,e,n){this.rules=t,this.staticRulesId="",this.isStatic=(n===void 0||n.isStatic)&&DS(t),this.componentId=e,this.baseHash=hu(hk,e),this.baseStyle=n,ed.registerId(e)}return r.prototype.generateAndInjectStyles=function(t,e,n){var a=this.baseStyle?this.baseStyle.generateAndInjectStyles(t,e,n):"";if(this.isStatic&&!n.hash)if(this.staticRulesId&&e.hasNameForId(this.componentId,this.staticRulesId))a=Uo(a,this.staticRulesId);else{var i=Qh(ao(this.rules,t,e,n)),s=_g(hu(this.baseHash,i)>>>0);if(!e.hasNameForId(this.componentId,s)){var l=n(i,".".concat(s),void 0,this.componentId);e.insertRules(this.componentId,s,l)}a=Uo(a,s),this.staticRulesId=s}else{for(var c=hu(this.baseHash,n.hash),f="",d=0;d<this.rules.length;d++){var v=this.rules[d];if(typeof v=="string")f+=v;else if(v){var m=Qh(ao(v,t,e,n));c=hu(c,m+d),f+=m}}if(f){var g=_g(c>>>0);e.hasNameForId(this.componentId,g)||e.insertRules(this.componentId,g,n(f,".".concat(g),void 0,this.componentId)),a=Uo(a,g)}}return a},r}(),Vu=Zn.createContext(void 0);Vu.Consumer;function JU(){var r=Z.useContext(Vu);if(!r)throw uo(18);return r}function e6(r){var t=Zn.useContext(Vu),e=Z.useMemo(function(){return function(n,a){if(!n)throw uo(14);if(ns(n)){var i=n(a);return i}if(Array.isArray(n)||typeof n!="object")throw uo(8);return a?pn(pn({},a),n):n}(r.theme,t)},[r.theme,t]);return r.children?Zn.createElement(Vu.Provider,{value:e},r.children):null}var Fm={};function pk(r,t,e){var n=Ay(r),a=r,i=!Im(r),s=t.attrs,l=s===void 0?jd:s,c=t.componentId,f=c===void 0?function(R,T){var D=typeof R!="string"?"sc":$w(R);Fm[D]=(Fm[D]||0)+1;var k="".concat(D,"-").concat(Ty(Hd+D+Fm[D]));return T?"".concat(T,"-").concat(k):k}(t.displayName,t.parentComponentId):c,d=t.displayName,v=d===void 0?function(R){return Im(R)?"styled.".concat(R):"Styled(".concat(VD(R),")")}(r):d,m=t.displayName&&t.componentId?"".concat($w(t.displayName),"-").concat(t.componentId):t.componentId||f,g=n&&a.attrs?a.attrs.concat(l).filter(Boolean):l,b=t.shouldForwardProp;if(n&&a.shouldForwardProp){var w=a.shouldForwardProp;if(t.shouldForwardProp){var _=t.shouldForwardProp;b=function(R,T){return w(R,T)&&_(R,T)}}else b=w}var S=new dk(e,m,n?a.componentStyle:void 0);function E(R,T){return function(D,k,M){var N=D.attrs,I=D.componentStyle,z=D.defaultProps,P=D.foldedComponentIds,ne=D.styledComponentId,re=D.target,ee=Zn.useContext(Vu),U=Cg(),G=D.shouldForwardProp||U.shouldForwardProp,X=vS(k,ee,z)||Uu,J=function(ge,me,Ne){for(var xe,Ie=pn(pn({},me),{className:void 0,theme:Ne}),ct=0;ct<ge.length;ct+=1){var Pe=ns(xe=ge[ct])?xe(Ie):xe;for(var qe in Pe)Ie[qe]=qe==="className"?Uo(Ie[qe],Pe[qe]):qe==="style"?pn(pn({},Ie[qe]),Pe[qe]):Pe[qe]}return me.className&&(Ie.className=Uo(Ie.className,me.className)),Ie}(N,k,X),F=J.as||re,K={};for(var oe in J)J[oe]===void 0||oe[0]==="$"||oe==="as"||oe==="theme"&&J.theme===X||(oe==="forwardedAs"?K.as=J.forwardedAs:G&&!G(oe,F)||(K[oe]=J[oe]));var ue=function(ge,me){var Ne=Cg(),xe=ge.generateAndInjectStyles(me,Ne.styleSheet,Ne.stylis);return xe}(I,J),pe=Uo(P,ne);return ue&&(pe+=" "+ue),J.className&&(pe+=" "+J.className),K[Im(F)&&!mS.has(F)?"class":"className"]=pe,M&&(K.ref=M),Z.createElement(F,K)}(C,R,T)}E.displayName=v;var C=Zn.forwardRef(E);return C.attrs=g,C.componentStyle=S,C.displayName=v,C.shouldForwardProp=b,C.foldedComponentIds=n?Uo(a.foldedComponentIds,a.styledComponentId):"",C.styledComponentId=m,C.target=n?a.target:r,Object.defineProperty(C,"defaultProps",{get:function(){return this._foldedDefaultProps},set:function(R){this._foldedDefaultProps=n?function(T){for(var D=[],k=1;k<arguments.length;k++)D[k-1]=arguments[k];for(var M=0,N=D;M<N.length;M++)Sg(T,N[M],!0);return T}({},a.defaultProps,R):R}}),Dy(C,function(){return".".concat(C.styledComponentId)}),i&&_S(C,r,{attrs:!0,componentStyle:!0,displayName:!0,foldedComponentIds:!0,shouldForwardProp:!0,styledComponentId:!0,target:!0}),C}function r2(r,t){for(var e=[r[0]],n=0,a=t.length;n<a;n+=1)e.push(t[n],r[n+1]);return e}var a2=function(r){return Object.assign(r,{isCss:!0})};function ky(r){for(var t=[],e=1;e<arguments.length;e++)t[e-1]=arguments[e];if(ns(r)||mc(r))return a2(ao(r2(jd,Bu([r],t,!0))));var n=r;return t.length===0&&n.length===1&&typeof n[0]=="string"?ao(n):a2(ao(r2(n,t)))}function Rg(r,t,e){if(e===void 0&&(e=Uu),!t)throw uo(1,t);var n=function(a){for(var i=[],s=1;s<arguments.length;s++)i[s-1]=arguments[s];return r(t,e,ky.apply(void 0,Bu([a],i,!1)))};return n.attrs=function(a){return Rg(r,t,pn(pn({},e),{attrs:Array.prototype.concat(e.attrs,a).filter(Boolean)}))},n.withConfig=function(a){return Rg(r,t,pn(pn({},e),a))},n}var kS=function(r){return Rg(pk,r)},vk=kS;mS.forEach(function(r){vk[r]=kS(r)});var mk=function(){function r(t,e){this.rules=t,this.componentId=e,this.isStatic=DS(t),ed.registerId(this.componentId+1)}return r.prototype.createStyles=function(t,e,n,a){var i=a(Qh(ao(this.rules,e,n,a)),""),s=this.componentId+t;n.insertRules(s,s,i)},r.prototype.removeStyles=function(t,e){e.clearRules(this.componentId+t)},r.prototype.renderStyles=function(t,e,n,a){t>2&&ed.registerId(this.componentId+t),this.removeStyles(t,n),this.createStyles(t,e,n,a)},r}();function t6(r){for(var t=[],e=1;e<arguments.length;e++)t[e-1]=arguments[e];var n=ky.apply(void 0,Bu([r],t,!1)),a="sc-global-".concat(Ty(JSON.stringify(n))),i=new mk(n,a),s=function(c){var f=Cg(),d=Zn.useContext(Vu),v=Zn.useRef(f.styleSheet.allocateGSInstance(a)).current;return f.styleSheet.server&&l(v,c,f.styleSheet,d,f.stylis),Zn.useLayoutEffect(function(){if(!f.styleSheet.server)return l(v,c,f.styleSheet,d,f.stylis),function(){return i.removeStyles(v,f.styleSheet)}},[v,c,f.styleSheet,d,f.stylis]),null};function l(c,f,d,v,m){if(i.isStatic)i.renderStyles(c,LD,d,m);else{var g=pn(pn({},f),{theme:vS(f,v,s.defaultProps)});i.renderStyles(c,g,d,m)}}return Zn.memo(s)}function n6(r){for(var t=[],e=1;e<arguments.length;e++)t[e-1]=arguments[e];var n=Qh(ky.apply(void 0,Bu([r],t,!1))),a=Ty(n);return new RS(a,n)}var Jl={},i2;function gk(){if(i2)return Jl;i2=1,Object.defineProperty(Jl,"__esModule",{value:!0}),Jl.parse=s,Jl.serialize=f;const r=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,t=/^[\u0021-\u003A\u003C-\u007E]*$/,e=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,n=/^[\u0020-\u003A\u003D-\u007E]*$/,a=Object.prototype.toString,i=(()=>{const m=function(){};return m.prototype=Object.create(null),m})();function s(m,g){const b=new i,w=m.length;if(w<2)return b;const _=(g==null?void 0:g.decode)||d;let S=0;do{const E=m.indexOf("=",S);if(E===-1)break;const C=m.indexOf(";",S),R=C===-1?w:C;if(E>R){S=m.lastIndexOf(";",E-1)+1;continue}const T=l(m,S,E),D=c(m,E,T),k=m.slice(T,D);if(b[k]===void 0){let M=l(m,E+1,R),N=c(m,R,M);const I=_(m.slice(M,N));b[k]=I}S=R+1}while(S<w);return b}function l(m,g,b){do{const w=m.charCodeAt(g);if(w!==32&&w!==9)return g}while(++g<b);return b}function c(m,g,b){for(;g>b;){const w=m.charCodeAt(--g);if(w!==32&&w!==9)return g+1}return b}function f(m,g,b){const w=(b==null?void 0:b.encode)||encodeURIComponent;if(!r.test(m))throw new TypeError(`argument name is invalid: ${m}`);const _=w(g);if(!t.test(_))throw new TypeError(`argument val is invalid: ${g}`);let S=m+"="+_;if(!b)return S;if(b.maxAge!==void 0){if(!Number.isInteger(b.maxAge))throw new TypeError(`option maxAge is invalid: ${b.maxAge}`);S+="; Max-Age="+b.maxAge}if(b.domain){if(!e.test(b.domain))throw new TypeError(`option domain is invalid: ${b.domain}`);S+="; Domain="+b.domain}if(b.path){if(!n.test(b.path))throw new TypeError(`option path is invalid: ${b.path}`);S+="; Path="+b.path}if(b.expires){if(!v(b.expires)||!Number.isFinite(b.expires.valueOf()))throw new TypeError(`option expires is invalid: ${b.expires}`);S+="; Expires="+b.expires.toUTCString()}if(b.httpOnly&&(S+="; HttpOnly"),b.secure&&(S+="; Secure"),b.partitioned&&(S+="; Partitioned"),b.priority)switch(typeof b.priority=="string"?b.priority.toLowerCase():void 0){case"low":S+="; Priority=Low";break;case"medium":S+="; Priority=Medium";break;case"high":S+="; Priority=High";break;default:throw new TypeError(`option priority is invalid: ${b.priority}`)}if(b.sameSite)switch(typeof b.sameSite=="string"?b.sameSite.toLowerCase():b.sameSite){case!0:case"strict":S+="; SameSite=Strict";break;case"lax":S+="; SameSite=Lax";break;case"none":S+="; SameSite=None";break;default:throw new TypeError(`option sameSite is invalid: ${b.sameSite}`)}return S}function d(m){if(m.indexOf("%")===-1)return m;try{return decodeURIComponent(m)}catch{return m}}function v(m){return a.call(m)==="[object Date]"}return Jl}gk();var o2="popstate";function yk(r={}){function t(n,a){let{pathname:i,search:s,hash:l}=n.location;return Tg("",{pathname:i,search:s,hash:l},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function e(n,a){return typeof a=="string"?a:gc(a)}return xk(t,e,null,r)}function Ft(r,t){if(r===!1||r===null||typeof r>"u")throw new Error(t)}function Yr(r,t){if(!r){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function bk(){return Math.random().toString(36).substring(2,10)}function s2(r,t){return{usr:r.state,key:r.key,idx:t}}function Tg(r,t,e=null,n){return{pathname:typeof r=="string"?r:r.pathname,search:"",hash:"",...typeof t=="string"?Yu(t):t,state:e,key:t&&t.key||n||bk()}}function gc({pathname:r="/",search:t="",hash:e=""}){return t&&t!=="?"&&(r+=t.charAt(0)==="?"?t:"?"+t),e&&e!=="#"&&(r+=e.charAt(0)==="#"?e:"#"+e),r}function Yu(r){let t={};if(r){let e=r.indexOf("#");e>=0&&(t.hash=r.substring(e),r=r.substring(0,e));let n=r.indexOf("?");n>=0&&(t.search=r.substring(n),r=r.substring(0,n)),r&&(t.pathname=r)}return t}function xk(r,t,e,n={}){let{window:a=document.defaultView,v5Compat:i=!1}=n,s=a.history,l="POP",c=null,f=d();f==null&&(f=0,s.replaceState({...s.state,idx:f},""));function d(){return(s.state||{idx:null}).idx}function v(){l="POP";let _=d(),S=_==null?null:_-f;f=_,c&&c({action:l,location:w.location,delta:S})}function m(_,S){l="PUSH";let E=Tg(w.location,_,S);f=d()+1;let C=s2(E,f),R=w.createHref(E);try{s.pushState(C,"",R)}catch(T){if(T instanceof DOMException&&T.name==="DataCloneError")throw T;a.location.assign(R)}i&&c&&c({action:l,location:w.location,delta:1})}function g(_,S){l="REPLACE";let E=Tg(w.location,_,S);f=d();let C=s2(E,f),R=w.createHref(E);s.replaceState(C,"",R),i&&c&&c({action:l,location:w.location,delta:0})}function b(_){let S=a.location.origin!=="null"?a.location.origin:a.location.href,E=typeof _=="string"?_:gc(_);return E=E.replace(/ $/,"%20"),Ft(S,`No window.location.(origin|href) available to create URL for href: ${E}`),new URL(E,S)}let w={get action(){return l},get location(){return r(a,s)},listen(_){if(c)throw new Error("A history only accepts one active listener");return a.addEventListener(o2,v),c=_,()=>{a.removeEventListener(o2,v),c=null}},createHref(_){return t(a,_)},createURL:b,encodeLocation(_){let S=b(_);return{pathname:S.pathname,search:S.search,hash:S.hash}},push:m,replace:g,go(_){return s.go(_)}};return w}function OS(r,t,e="/"){return wk(r,t,e,!1)}function wk(r,t,e,n){let a=typeof t=="string"?Yu(t):t,i=ai(a.pathname||"/",e);if(i==null)return null;let s=NS(r);_k(s);let l=null;for(let c=0;l==null&&c<s.length;++c){let f=Mk(i);l=Ok(s[c],f,n)}return l}function NS(r,t=[],e=[],n=""){let a=(i,s,l)=>{let c={relativePath:l===void 0?i.path||"":l,caseSensitive:i.caseSensitive===!0,childrenIndex:s,route:i};c.relativePath.startsWith("/")&&(Ft(c.relativePath.startsWith(n),`Absolute route path "${c.relativePath}" nested under path "${n}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),c.relativePath=c.relativePath.slice(n.length));let f=ni([n,c.relativePath]),d=e.concat(c);i.children&&i.children.length>0&&(Ft(i.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${f}".`),NS(i.children,t,d,f)),!(i.path==null&&!i.index)&&t.push({path:f,score:Dk(f,i.index),routesMeta:d})};return r.forEach((i,s)=>{var l;if(i.path===""||!((l=i.path)!=null&&l.includes("?")))a(i,s);else for(let c of MS(i.path))a(i,s,c)}),t}function MS(r){let t=r.split("/");if(t.length===0)return[];let[e,...n]=t,a=e.endsWith("?"),i=e.replace(/\?$/,"");if(n.length===0)return a?[i,""]:[i];let s=MS(n.join("/")),l=[];return l.push(...s.map(c=>c===""?i:[i,c].join("/"))),a&&l.push(...s),l.map(c=>r.startsWith("/")&&c===""?"/":c)}function _k(r){r.sort((t,e)=>t.score!==e.score?e.score-t.score:kk(t.routesMeta.map(n=>n.childrenIndex),e.routesMeta.map(n=>n.childrenIndex)))}var Sk=/^:[\w-]+$/,Ek=3,Ck=2,Rk=1,Tk=10,Ak=-2,u2=r=>r==="*";function Dk(r,t){let e=r.split("/"),n=e.length;return e.some(u2)&&(n+=Ak),t&&(n+=Ck),e.filter(a=>!u2(a)).reduce((a,i)=>a+(Sk.test(i)?Ek:i===""?Rk:Tk),n)}function kk(r,t){return r.length===t.length&&r.slice(0,-1).every((n,a)=>n===t[a])?r[r.length-1]-t[t.length-1]:0}function Ok(r,t,e=!1){let{routesMeta:n}=r,a={},i="/",s=[];for(let l=0;l<n.length;++l){let c=n[l],f=l===n.length-1,d=i==="/"?t:t.slice(i.length)||"/",v=td({path:c.relativePath,caseSensitive:c.caseSensitive,end:f},d),m=c.route;if(!v&&f&&e&&!n[n.length-1].route.index&&(v=td({path:c.relativePath,caseSensitive:c.caseSensitive,end:!1},d)),!v)return null;Object.assign(a,v.params),s.push({params:a,pathname:ni([i,v.pathname]),pathnameBase:Lk(ni([i,v.pathnameBase])),route:m}),v.pathnameBase!=="/"&&(i=ni([i,v.pathnameBase]))}return s}function td(r,t){typeof r=="string"&&(r={path:r,caseSensitive:!1,end:!0});let[e,n]=Nk(r.path,r.caseSensitive,r.end),a=t.match(e);if(!a)return null;let i=a[0],s=i.replace(/(.)\/+$/,"$1"),l=a.slice(1);return{params:n.reduce((f,{paramName:d,isOptional:v},m)=>{if(d==="*"){let b=l[m]||"";s=i.slice(0,i.length-b.length).replace(/(.)\/+$/,"$1")}const g=l[m];return v&&!g?f[d]=void 0:f[d]=(g||"").replace(/%2F/g,"/"),f},{}),pathname:i,pathnameBase:s,pattern:r}}function Nk(r,t=!1,e=!0){Yr(r==="*"||!r.endsWith("*")||r.endsWith("/*"),`Route path "${r}" will be treated as if it were "${r.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${r.replace(/\*$/,"/*")}".`);let n=[],a="^"+r.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(s,l,c)=>(n.push({paramName:l,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)"));return r.endsWith("*")?(n.push({paramName:"*"}),a+=r==="*"||r==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):e?a+="\\/*$":r!==""&&r!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,t?void 0:"i"),n]}function Mk(r){try{return r.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return Yr(!1,`The URL path "${r}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${t}).`),r}}function ai(r,t){if(t==="/")return r;if(!r.toLowerCase().startsWith(t.toLowerCase()))return null;let e=t.endsWith("/")?t.length-1:t.length,n=r.charAt(e);return n&&n!=="/"?null:r.slice(e)||"/"}function Ik(r,t="/"){let{pathname:e,search:n="",hash:a=""}=typeof r=="string"?Yu(r):r;return{pathname:e?e.startsWith("/")?e:Fk(e,t):t,search:Pk(n),hash:zk(a)}}function Fk(r,t){let e=t.replace(/\/+$/,"").split("/");return r.split("/").forEach(a=>{a===".."?e.length>1&&e.pop():a!=="."&&e.push(a)}),e.length>1?e.join("/"):"/"}function Bm(r,t,e,n){return`Cannot include a '${r}' character in a manually specified \`to.${t}\` field [${JSON.stringify(n)}].  Please separate it out to the \`to.${e}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function Bk(r){return r.filter((t,e)=>e===0||t.route.path&&t.route.path.length>0)}function IS(r){let t=Bk(r);return t.map((e,n)=>n===t.length-1?e.pathname:e.pathnameBase)}function FS(r,t,e,n=!1){let a;typeof r=="string"?a=Yu(r):(a={...r},Ft(!a.pathname||!a.pathname.includes("?"),Bm("?","pathname","search",a)),Ft(!a.pathname||!a.pathname.includes("#"),Bm("#","pathname","hash",a)),Ft(!a.search||!a.search.includes("#"),Bm("#","search","hash",a)));let i=r===""||a.pathname==="",s=i?"/":a.pathname,l;if(s==null)l=e;else{let v=t.length-1;if(!n&&s.startsWith("..")){let m=s.split("/");for(;m[0]==="..";)m.shift(),v-=1;a.pathname=m.join("/")}l=v>=0?t[v]:"/"}let c=Ik(a,l),f=s&&s!=="/"&&s.endsWith("/"),d=(i||s===".")&&e.endsWith("/");return!c.pathname.endsWith("/")&&(f||d)&&(c.pathname+="/"),c}var ni=r=>r.join("/").replace(/\/\/+/g,"/"),Lk=r=>r.replace(/\/+$/,"").replace(/^\/*/,"/"),Pk=r=>!r||r==="?"?"":r.startsWith("?")?r:"?"+r,zk=r=>!r||r==="#"?"":r.startsWith("#")?r:"#"+r;function Uk(r){return r!=null&&typeof r.status=="number"&&typeof r.statusText=="string"&&typeof r.internal=="boolean"&&"data"in r}var BS=["POST","PUT","PATCH","DELETE"];new Set(BS);var Vk=["GET",...BS];new Set(Vk);var Zu=Z.createContext(null);Zu.displayName="DataRouter";var Wd=Z.createContext(null);Wd.displayName="DataRouterState";var LS=Z.createContext({isTransitioning:!1});LS.displayName="ViewTransition";var Hk=Z.createContext(new Map);Hk.displayName="Fetchers";var jk=Z.createContext(null);jk.displayName="Await";var Ra=Z.createContext(null);Ra.displayName="Navigation";var Kc=Z.createContext(null);Kc.displayName="Location";var si=Z.createContext({outlet:null,matches:[],isDataRoute:!1});si.displayName="Route";var Oy=Z.createContext(null);Oy.displayName="RouteError";function Wk(r,{relative:t}={}){Ft(Xc(),"useHref() may be used only in the context of a <Router> component.");let{basename:e,navigator:n}=Z.useContext(Ra),{hash:a,pathname:i,search:s}=$c(r,{relative:t}),l=i;return e!=="/"&&(l=i==="/"?e:ni([e,i])),n.createHref({pathname:l,search:s,hash:a})}function Xc(){return Z.useContext(Kc)!=null}function vo(){return Ft(Xc(),"useLocation() may be used only in the context of a <Router> component."),Z.useContext(Kc).location}var PS="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function zS(r){Z.useContext(Ra).static||Z.useLayoutEffect(r)}function US(){let{isDataRoute:r}=Z.useContext(si);return r?rO():Gk()}function Gk(){Ft(Xc(),"useNavigate() may be used only in the context of a <Router> component.");let r=Z.useContext(Zu),{basename:t,navigator:e}=Z.useContext(Ra),{matches:n}=Z.useContext(si),{pathname:a}=vo(),i=JSON.stringify(IS(n)),s=Z.useRef(!1);return zS(()=>{s.current=!0}),Z.useCallback((c,f={})=>{if(Yr(s.current,PS),!s.current)return;if(typeof c=="number"){e.go(c);return}let d=FS(c,JSON.parse(i),a,f.relative==="path");r==null&&t!=="/"&&(d.pathname=d.pathname==="/"?t:ni([t,d.pathname])),(f.replace?e.replace:e.push)(d,f.state,f)},[t,e,i,a,r])}Z.createContext(null);function $c(r,{relative:t}={}){let{matches:e}=Z.useContext(si),{pathname:n}=vo(),a=JSON.stringify(IS(e));return Z.useMemo(()=>FS(r,JSON.parse(a),n,t==="path"),[r,a,n,t])}function qk(r,t){return VS(r,t)}function VS(r,t,e,n){var E;Ft(Xc(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:a,static:i}=Z.useContext(Ra),{matches:s}=Z.useContext(si),l=s[s.length-1],c=l?l.params:{},f=l?l.pathname:"/",d=l?l.pathnameBase:"/",v=l&&l.route;{let C=v&&v.path||"";HS(f,!v||C.endsWith("*")||C.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${f}" (under <Route path="${C}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${C}"> to <Route path="${C==="/"?"*":`${C}/*`}">.`)}let m=vo(),g;if(t){let C=typeof t=="string"?Yu(t):t;Ft(d==="/"||((E=C.pathname)==null?void 0:E.startsWith(d)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${d}" but pathname "${C.pathname}" was given in the \`location\` prop.`),g=C}else g=m;let b=g.pathname||"/",w=b;if(d!=="/"){let C=d.replace(/^\//,"").split("/");w="/"+b.replace(/^\//,"").split("/").slice(C.length).join("/")}let _=!i&&e&&e.matches&&e.matches.length>0?e.matches:OS(r,{pathname:w});Yr(v||_!=null,`No routes matched location "${g.pathname}${g.search}${g.hash}" `),Yr(_==null||_[_.length-1].route.element!==void 0||_[_.length-1].route.Component!==void 0||_[_.length-1].route.lazy!==void 0,`Matched leaf route at location "${g.pathname}${g.search}${g.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let S=Zk(_&&_.map(C=>Object.assign({},C,{params:Object.assign({},c,C.params),pathname:ni([d,a.encodeLocation?a.encodeLocation(C.pathname).pathname:C.pathname]),pathnameBase:C.pathnameBase==="/"?d:ni([d,a.encodeLocation?a.encodeLocation(C.pathnameBase).pathname:C.pathnameBase])})),s,e,n);return t&&S?Z.createElement(Kc.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...g},navigationType:"POP"}},S):S}function Kk(){let r=nO(),t=Uk(r)?`${r.status} ${r.statusText}`:r instanceof Error?r.message:JSON.stringify(r),e=r instanceof Error?r.stack:null,n="rgba(200,200,200, 0.5)",a={padding:"0.5rem",backgroundColor:n},i={padding:"2px 4px",backgroundColor:n},s=null;return console.error("Error handled by React Router default ErrorBoundary:",r),s=Z.createElement(Z.Fragment,null,Z.createElement("p",null,"💿 Hey developer 👋"),Z.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",Z.createElement("code",{style:i},"ErrorBoundary")," or"," ",Z.createElement("code",{style:i},"errorElement")," prop on your route.")),Z.createElement(Z.Fragment,null,Z.createElement("h2",null,"Unexpected Application Error!"),Z.createElement("h3",{style:{fontStyle:"italic"}},t),e?Z.createElement("pre",{style:a},e):null,s)}var Xk=Z.createElement(Kk,null),$k=class extends Z.Component{constructor(r){super(r),this.state={location:r.location,revalidation:r.revalidation,error:r.error}}static getDerivedStateFromError(r){return{error:r}}static getDerivedStateFromProps(r,t){return t.location!==r.location||t.revalidation!=="idle"&&r.revalidation==="idle"?{error:r.error,location:r.location,revalidation:r.revalidation}:{error:r.error!==void 0?r.error:t.error,location:t.location,revalidation:r.revalidation||t.revalidation}}componentDidCatch(r,t){console.error("React Router caught the following error during render",r,t)}render(){return this.state.error!==void 0?Z.createElement(si.Provider,{value:this.props.routeContext},Z.createElement(Oy.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function Yk({routeContext:r,match:t,children:e}){let n=Z.useContext(Zu);return n&&n.static&&n.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(n.staticContext._deepestRenderedBoundaryId=t.route.id),Z.createElement(si.Provider,{value:r},e)}function Zk(r,t=[],e=null,n=null){if(r==null){if(!e)return null;if(e.errors)r=e.matches;else if(t.length===0&&!e.initialized&&e.matches.length>0)r=e.matches;else return null}let a=r,i=e==null?void 0:e.errors;if(i!=null){let c=a.findIndex(f=>f.route.id&&(i==null?void 0:i[f.route.id])!==void 0);Ft(c>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(i).join(",")}`),a=a.slice(0,Math.min(a.length,c+1))}let s=!1,l=-1;if(e)for(let c=0;c<a.length;c++){let f=a[c];if((f.route.HydrateFallback||f.route.hydrateFallbackElement)&&(l=c),f.route.id){let{loaderData:d,errors:v}=e,m=f.route.loader&&!d.hasOwnProperty(f.route.id)&&(!v||v[f.route.id]===void 0);if(f.route.lazy||m){s=!0,l>=0?a=a.slice(0,l+1):a=[a[0]];break}}}return a.reduceRight((c,f,d)=>{let v,m=!1,g=null,b=null;e&&(v=i&&f.route.id?i[f.route.id]:void 0,g=f.route.errorElement||Xk,s&&(l<0&&d===0?(HS("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),m=!0,b=null):l===d&&(m=!0,b=f.route.hydrateFallbackElement||null)));let w=t.concat(a.slice(0,d+1)),_=()=>{let S;return v?S=g:m?S=b:f.route.Component?S=Z.createElement(f.route.Component,null):f.route.element?S=f.route.element:S=c,Z.createElement(Yk,{match:f,routeContext:{outlet:c,matches:w,isDataRoute:e!=null},children:S})};return e&&(f.route.ErrorBoundary||f.route.errorElement||d===0)?Z.createElement($k,{location:e.location,revalidation:e.revalidation,component:g,error:v,children:_(),routeContext:{outlet:null,matches:w,isDataRoute:!0}}):_()},null)}function Ny(r){return`${r} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function Qk(r){let t=Z.useContext(Zu);return Ft(t,Ny(r)),t}function Jk(r){let t=Z.useContext(Wd);return Ft(t,Ny(r)),t}function eO(r){let t=Z.useContext(si);return Ft(t,Ny(r)),t}function My(r){let t=eO(r),e=t.matches[t.matches.length-1];return Ft(e.route.id,`${r} can only be used on routes that contain a unique "id"`),e.route.id}function tO(){return My("useRouteId")}function nO(){var n;let r=Z.useContext(Oy),t=Jk("useRouteError"),e=My("useRouteError");return r!==void 0?r:(n=t.errors)==null?void 0:n[e]}function rO(){let{router:r}=Qk("useNavigate"),t=My("useNavigate"),e=Z.useRef(!1);return zS(()=>{e.current=!0}),Z.useCallback(async(a,i={})=>{Yr(e.current,PS),e.current&&(typeof a=="number"?r.navigate(a):await r.navigate(a,{fromRouteId:t,...i}))},[r,t])}var l2={};function HS(r,t,e){!t&&!l2[r]&&(l2[r]=!0,Yr(!1,e))}Z.memo(aO);function aO({routes:r,future:t,state:e}){return VS(r,void 0,e,t)}function iO(r){Ft(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function oO({basename:r="/",children:t=null,location:e,navigationType:n="POP",navigator:a,static:i=!1}){Ft(!Xc(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let s=r.replace(/^\/*/,"/"),l=Z.useMemo(()=>({basename:s,navigator:a,static:i,future:{}}),[s,a,i]);typeof e=="string"&&(e=Yu(e));let{pathname:c="/",search:f="",hash:d="",state:v=null,key:m="default"}=e,g=Z.useMemo(()=>{let b=ai(c,s);return b==null?null:{location:{pathname:b,search:f,hash:d,state:v,key:m},navigationType:n}},[s,c,f,d,v,m,n]);return Yr(g!=null,`<Router basename="${s}"> is not able to match the URL "${c}${f}${d}" because it does not start with the basename, so the <Router> won't render anything.`),g==null?null:Z.createElement(Ra.Provider,{value:l},Z.createElement(Kc.Provider,{children:t,value:g}))}function r6({children:r,location:t}){return qk(Ag(r),t)}function Ag(r,t=[]){let e=[];return Z.Children.forEach(r,(n,a)=>{if(!Z.isValidElement(n))return;let i=[...t,a];if(n.type===Z.Fragment){e.push.apply(e,Ag(n.props.children,i));return}Ft(n.type===iO,`[${typeof n.type=="string"?n.type:n.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),Ft(!n.props.index||!n.props.children,"An index route cannot have child routes.");let s={id:n.props.id||i.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,hydrateFallbackElement:n.props.hydrateFallbackElement,HydrateFallback:n.props.HydrateFallback,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.hasErrorBoundary===!0||n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(s.children=Ag(n.props.children,i)),e.push(s)}),e}var qh="get",Kh="application/x-www-form-urlencoded";function Gd(r){return r!=null&&typeof r.tagName=="string"}function sO(r){return Gd(r)&&r.tagName.toLowerCase()==="button"}function uO(r){return Gd(r)&&r.tagName.toLowerCase()==="form"}function lO(r){return Gd(r)&&r.tagName.toLowerCase()==="input"}function cO(r){return!!(r.metaKey||r.altKey||r.ctrlKey||r.shiftKey)}function fO(r,t){return r.button===0&&(!t||t==="_self")&&!cO(r)}function Dg(r=""){return new URLSearchParams(typeof r=="string"||Array.isArray(r)||r instanceof URLSearchParams?r:Object.keys(r).reduce((t,e)=>{let n=r[e];return t.concat(Array.isArray(n)?n.map(a=>[e,a]):[[e,n]])},[]))}function hO(r,t){let e=Dg(r);return t&&t.forEach((n,a)=>{e.has(a)||t.getAll(a).forEach(i=>{e.append(a,i)})}),e}var _h=null;function dO(){if(_h===null)try{new FormData(document.createElement("form"),0),_h=!1}catch{_h=!0}return _h}var pO=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function Lm(r){return r!=null&&!pO.has(r)?(Yr(!1,`"${r}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Kh}"`),null):r}function vO(r,t){let e,n,a,i,s;if(uO(r)){let l=r.getAttribute("action");n=l?ai(l,t):null,e=r.getAttribute("method")||qh,a=Lm(r.getAttribute("enctype"))||Kh,i=new FormData(r)}else if(sO(r)||lO(r)&&(r.type==="submit"||r.type==="image")){let l=r.form;if(l==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let c=r.getAttribute("formaction")||l.getAttribute("action");if(n=c?ai(c,t):null,e=r.getAttribute("formmethod")||l.getAttribute("method")||qh,a=Lm(r.getAttribute("formenctype"))||Lm(l.getAttribute("enctype"))||Kh,i=new FormData(l,r),!dO()){let{name:f,type:d,value:v}=r;if(d==="image"){let m=f?`${f}.`:"";i.append(`${m}x`,"0"),i.append(`${m}y`,"0")}else f&&i.append(f,v)}}else{if(Gd(r))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');e=qh,n=null,a=Kh,s=r}return i&&a==="text/plain"&&(s=i,i=void 0),{action:n,method:e.toLowerCase(),encType:a,formData:i,body:s}}function Iy(r,t){if(r===!1||r===null||typeof r>"u")throw new Error(t)}async function mO(r,t){if(r.id in t)return t[r.id];try{let e=await import(r.module);return t[r.id]=e,e}catch(e){return console.error(`Error loading route module \`${r.module}\`, reloading page...`),console.error(e),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function gO(r){return r==null?!1:r.href==null?r.rel==="preload"&&typeof r.imageSrcSet=="string"&&typeof r.imageSizes=="string":typeof r.rel=="string"&&typeof r.href=="string"}async function yO(r,t,e){let n=await Promise.all(r.map(async a=>{let i=t.routes[a.route.id];if(i){let s=await mO(i,e);return s.links?s.links():[]}return[]}));return _O(n.flat(1).filter(gO).filter(a=>a.rel==="stylesheet"||a.rel==="preload").map(a=>a.rel==="stylesheet"?{...a,rel:"prefetch",as:"style"}:{...a,rel:"prefetch"}))}function c2(r,t,e,n,a,i){let s=(c,f)=>e[f]?c.route.id!==e[f].route.id:!0,l=(c,f)=>{var d;return e[f].pathname!==c.pathname||((d=e[f].route.path)==null?void 0:d.endsWith("*"))&&e[f].params["*"]!==c.params["*"]};return i==="assets"?t.filter((c,f)=>s(c,f)||l(c,f)):i==="data"?t.filter((c,f)=>{var v;let d=n.routes[c.route.id];if(!d||!d.hasLoader)return!1;if(s(c,f)||l(c,f))return!0;if(c.route.shouldRevalidate){let m=c.route.shouldRevalidate({currentUrl:new URL(a.pathname+a.search+a.hash,window.origin),currentParams:((v=e[0])==null?void 0:v.params)||{},nextUrl:new URL(r,window.origin),nextParams:c.params,defaultShouldRevalidate:!0});if(typeof m=="boolean")return m}return!0}):[]}function bO(r,t,{includeHydrateFallback:e}={}){return xO(r.map(n=>{let a=t.routes[n.route.id];if(!a)return[];let i=[a.module];return a.clientActionModule&&(i=i.concat(a.clientActionModule)),a.clientLoaderModule&&(i=i.concat(a.clientLoaderModule)),e&&a.hydrateFallbackModule&&(i=i.concat(a.hydrateFallbackModule)),a.imports&&(i=i.concat(a.imports)),i}).flat(1))}function xO(r){return[...new Set(r)]}function wO(r){let t={},e=Object.keys(r).sort();for(let n of e)t[n]=r[n];return t}function _O(r,t){let e=new Set;return new Set(t),r.reduce((n,a)=>{let i=JSON.stringify(wO(a));return e.has(i)||(e.add(i),n.push({key:i,link:a})),n},[])}var SO=new Set([100,101,204,205]);function EO(r,t){let e=typeof r=="string"?new URL(r,typeof window>"u"?"server://singlefetch/":window.location.origin):r;return e.pathname==="/"?e.pathname="_root.data":t&&ai(e.pathname,t)==="/"?e.pathname=`${t.replace(/\/$/,"")}/_root.data`:e.pathname=`${e.pathname.replace(/\/$/,"")}.data`,e}function jS(){let r=Z.useContext(Zu);return Iy(r,"You must render this element inside a <DataRouterContext.Provider> element"),r}function CO(){let r=Z.useContext(Wd);return Iy(r,"You must render this element inside a <DataRouterStateContext.Provider> element"),r}var Fy=Z.createContext(void 0);Fy.displayName="FrameworkContext";function WS(){let r=Z.useContext(Fy);return Iy(r,"You must render this element inside a <HydratedRouter> element"),r}function RO(r,t){let e=Z.useContext(Fy),[n,a]=Z.useState(!1),[i,s]=Z.useState(!1),{onFocus:l,onBlur:c,onMouseEnter:f,onMouseLeave:d,onTouchStart:v}=t,m=Z.useRef(null);Z.useEffect(()=>{if(r==="render"&&s(!0),r==="viewport"){let w=S=>{S.forEach(E=>{s(E.isIntersecting)})},_=new IntersectionObserver(w,{threshold:.5});return m.current&&_.observe(m.current),()=>{_.disconnect()}}},[r]),Z.useEffect(()=>{if(n){let w=setTimeout(()=>{s(!0)},100);return()=>{clearTimeout(w)}}},[n]);let g=()=>{a(!0)},b=()=>{a(!1),s(!1)};return e?r!=="intent"?[i,m,{}]:[i,m,{onFocus:ec(l,g),onBlur:ec(c,b),onMouseEnter:ec(f,g),onMouseLeave:ec(d,b),onTouchStart:ec(v,g)}]:[!1,m,{}]}function ec(r,t){return e=>{r&&r(e),e.defaultPrevented||t(e)}}function TO({page:r,...t}){let{router:e}=jS(),n=Z.useMemo(()=>OS(e.routes,r,e.basename),[e.routes,r,e.basename]);return n?Z.createElement(DO,{page:r,matches:n,...t}):null}function AO(r){let{manifest:t,routeModules:e}=WS(),[n,a]=Z.useState([]);return Z.useEffect(()=>{let i=!1;return yO(r,t,e).then(s=>{i||a(s)}),()=>{i=!0}},[r,t,e]),n}function DO({page:r,matches:t,...e}){let n=vo(),{manifest:a,routeModules:i}=WS(),{basename:s}=jS(),{loaderData:l,matches:c}=CO(),f=Z.useMemo(()=>c2(r,t,c,a,n,"data"),[r,t,c,a,n]),d=Z.useMemo(()=>c2(r,t,c,a,n,"assets"),[r,t,c,a,n]),v=Z.useMemo(()=>{if(r===n.pathname+n.search+n.hash)return[];let b=new Set,w=!1;if(t.forEach(S=>{var C;let E=a.routes[S.route.id];!E||!E.hasLoader||(!f.some(R=>R.route.id===S.route.id)&&S.route.id in l&&((C=i[S.route.id])!=null&&C.shouldRevalidate)||E.hasClientLoader?w=!0:b.add(S.route.id))}),b.size===0)return[];let _=EO(r,s);return w&&b.size>0&&_.searchParams.set("_routes",t.filter(S=>b.has(S.route.id)).map(S=>S.route.id).join(",")),[_.pathname+_.search]},[s,l,n,a,f,t,r,i]),m=Z.useMemo(()=>bO(d,a),[d,a]),g=AO(d);return Z.createElement(Z.Fragment,null,v.map(b=>Z.createElement("link",{key:b,rel:"prefetch",as:"fetch",href:b,...e})),m.map(b=>Z.createElement("link",{key:b,rel:"modulepreload",href:b,...e})),g.map(({key:b,link:w})=>Z.createElement("link",{key:b,...w})))}function kO(...r){return t=>{r.forEach(e=>{typeof e=="function"?e(t):e!=null&&(e.current=t)})}}var GS=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{GS&&(window.__reactRouterVersion="7.5.3")}catch{}function a6({basename:r,children:t,window:e}){let n=Z.useRef();n.current==null&&(n.current=yk({window:e,v5Compat:!0}));let a=n.current,[i,s]=Z.useState({action:a.action,location:a.location}),l=Z.useCallback(c=>{Z.startTransition(()=>s(c))},[s]);return Z.useLayoutEffect(()=>a.listen(l),[a,l]),Z.createElement(oO,{basename:r,children:t,location:i.location,navigationType:i.action,navigator:a})}var qS=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,KS=Z.forwardRef(function({onClick:t,discover:e="render",prefetch:n="none",relative:a,reloadDocument:i,replace:s,state:l,target:c,to:f,preventScrollReset:d,viewTransition:v,...m},g){let{basename:b}=Z.useContext(Ra),w=typeof f=="string"&&qS.test(f),_,S=!1;if(typeof f=="string"&&w&&(_=f,GS))try{let N=new URL(window.location.href),I=f.startsWith("//")?new URL(N.protocol+f):new URL(f),z=ai(I.pathname,b);I.origin===N.origin&&z!=null?f=z+I.search+I.hash:S=!0}catch{Yr(!1,`<Link to="${f}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let E=Wk(f,{relative:a}),[C,R,T]=RO(n,m),D=IO(f,{replace:s,state:l,target:c,preventScrollReset:d,relative:a,viewTransition:v});function k(N){t&&t(N),N.defaultPrevented||D(N)}let M=Z.createElement("a",{...m,...T,href:_||E,onClick:S||i?t:k,ref:kO(g,R),target:c,"data-discover":!w&&e==="render"?"true":void 0});return C&&!w?Z.createElement(Z.Fragment,null,M,Z.createElement(TO,{page:E})):M});KS.displayName="Link";var OO=Z.forwardRef(function({"aria-current":t="page",caseSensitive:e=!1,className:n="",end:a=!1,style:i,to:s,viewTransition:l,children:c,...f},d){let v=$c(s,{relative:f.relative}),m=vo(),g=Z.useContext(Wd),{navigator:b,basename:w}=Z.useContext(Ra),_=g!=null&&zO(v)&&l===!0,S=b.encodeLocation?b.encodeLocation(v).pathname:v.pathname,E=m.pathname,C=g&&g.navigation&&g.navigation.location?g.navigation.location.pathname:null;e||(E=E.toLowerCase(),C=C?C.toLowerCase():null,S=S.toLowerCase()),C&&w&&(C=ai(C,w)||C);const R=S!=="/"&&S.endsWith("/")?S.length-1:S.length;let T=E===S||!a&&E.startsWith(S)&&E.charAt(R)==="/",D=C!=null&&(C===S||!a&&C.startsWith(S)&&C.charAt(S.length)==="/"),k={isActive:T,isPending:D,isTransitioning:_},M=T?t:void 0,N;typeof n=="function"?N=n(k):N=[n,T?"active":null,D?"pending":null,_?"transitioning":null].filter(Boolean).join(" ");let I=typeof i=="function"?i(k):i;return Z.createElement(KS,{...f,"aria-current":M,className:N,ref:d,style:I,to:s,viewTransition:l},typeof c=="function"?c(k):c)});OO.displayName="NavLink";var NO=Z.forwardRef(({discover:r="render",fetcherKey:t,navigate:e,reloadDocument:n,replace:a,state:i,method:s=qh,action:l,onSubmit:c,relative:f,preventScrollReset:d,viewTransition:v,...m},g)=>{let b=LO(),w=PO(l,{relative:f}),_=s.toLowerCase()==="get"?"get":"post",S=typeof l=="string"&&qS.test(l),E=C=>{if(c&&c(C),C.defaultPrevented)return;C.preventDefault();let R=C.nativeEvent.submitter,T=(R==null?void 0:R.getAttribute("formmethod"))||s;b(R||C.currentTarget,{fetcherKey:t,method:T,navigate:e,replace:a,state:i,relative:f,preventScrollReset:d,viewTransition:v})};return Z.createElement("form",{ref:g,method:_,action:w,onSubmit:n?c:E,...m,"data-discover":!S&&r==="render"?"true":void 0})});NO.displayName="Form";function MO(r){return`${r} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function XS(r){let t=Z.useContext(Zu);return Ft(t,MO(r)),t}function IO(r,{target:t,replace:e,state:n,preventScrollReset:a,relative:i,viewTransition:s}={}){let l=US(),c=vo(),f=$c(r,{relative:i});return Z.useCallback(d=>{if(fO(d,t)){d.preventDefault();let v=e!==void 0?e:gc(c)===gc(f);l(r,{replace:v,state:n,preventScrollReset:a,relative:i,viewTransition:s})}},[c,l,f,e,n,t,r,a,i,s])}function i6(r){Yr(typeof URLSearchParams<"u","You cannot use the `useSearchParams` hook in a browser that does not support the URLSearchParams API. If you need to support Internet Explorer 11, we recommend you load a polyfill such as https://github.com/ungap/url-search-params.");let t=Z.useRef(Dg(r)),e=Z.useRef(!1),n=vo(),a=Z.useMemo(()=>hO(n.search,e.current?null:t.current),[n.search]),i=US(),s=Z.useCallback((l,c)=>{const f=Dg(typeof l=="function"?l(a):l);e.current=!0,i("?"+f,c)},[i,a]);return[a,s]}var FO=0,BO=()=>`__${String(++FO)}__`;function LO(){let{router:r}=XS("useSubmit"),{basename:t}=Z.useContext(Ra),e=tO();return Z.useCallback(async(n,a={})=>{let{action:i,method:s,encType:l,formData:c,body:f}=vO(n,t);if(a.navigate===!1){let d=a.fetcherKey||BO();await r.fetch(d,e,a.action||i,{preventScrollReset:a.preventScrollReset,formData:c,body:f,formMethod:a.method||s,formEncType:a.encType||l,flushSync:a.flushSync})}else await r.navigate(a.action||i,{preventScrollReset:a.preventScrollReset,formData:c,body:f,formMethod:a.method||s,formEncType:a.encType||l,replace:a.replace,state:a.state,fromRouteId:e,flushSync:a.flushSync,viewTransition:a.viewTransition})},[r,t,e])}function PO(r,{relative:t}={}){let{basename:e}=Z.useContext(Ra),n=Z.useContext(si);Ft(n,"useFormAction must be used inside a RouteContext");let[a]=n.matches.slice(-1),i={...$c(r||".",{relative:t})},s=vo();if(r==null){i.search=s.search;let l=new URLSearchParams(i.search),c=l.getAll("index");if(c.some(d=>d==="")){l.delete("index"),c.filter(v=>v).forEach(v=>l.append("index",v));let d=l.toString();i.search=d?`?${d}`:""}}return(!r||r===".")&&a.route.index&&(i.search=i.search?i.search.replace(/^\?/,"?index&"):"?index"),e!=="/"&&(i.pathname=i.pathname==="/"?e:ni([e,i.pathname])),gc(i)}function zO(r,t={}){let e=Z.useContext(LS);Ft(e!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:n}=XS("useViewTransitionState"),a=$c(r,{relative:t.relative});if(!e.isTransitioning)return!1;let i=ai(e.currentLocation.pathname,n)||e.currentLocation.pathname,s=ai(e.nextLocation.pathname,n)||e.nextLocation.pathname;return td(a.pathname,s)!=null||td(a.pathname,i)!=null}new TextEncoder;[...SO];function UO(r={}){const{nonce:t,onScriptLoadSuccess:e,onScriptLoadError:n}=r,[a,i]=Z.useState(!1),s=Z.useRef(e);s.current=e;const l=Z.useRef(n);return l.current=n,Z.useEffect(()=>{const c=document.createElement("script");return c.src="https://accounts.google.com/gsi/client",c.async=!0,c.defer=!0,c.nonce=t,c.onload=()=>{var f;i(!0),(f=s.current)===null||f===void 0||f.call(s)},c.onerror=()=>{var f;i(!1),(f=l.current)===null||f===void 0||f.call(l)},document.body.appendChild(c),()=>{document.body.removeChild(c)}},[t]),a}const $S=Z.createContext(null);function o6({clientId:r,nonce:t,onScriptLoadSuccess:e,onScriptLoadError:n,children:a}){const i=UO({nonce:t,onScriptLoadSuccess:e,onScriptLoadError:n}),s=Z.useMemo(()=>({clientId:r,scriptLoadedSuccessfully:i}),[r,i]);return Zn.createElement($S.Provider,{value:s},a)}function VO(){const r=Z.useContext($S);if(!r)throw new Error("Google OAuth components must be used within GoogleOAuthProvider");return r}function s6({flow:r="implicit",scope:t="",onSuccess:e,onError:n,onNonOAuthError:a,overrideScope:i,state:s,...l}){const{clientId:c,scriptLoadedSuccessfully:f}=VO(),d=Z.useRef(),v=Z.useRef(e);v.current=e;const m=Z.useRef(n);m.current=n;const g=Z.useRef(a);g.current=a,Z.useEffect(()=>{var _,S;if(!f)return;const E=r==="implicit"?"initTokenClient":"initCodeClient",C=(S=(_=window==null?void 0:window.google)===null||_===void 0?void 0:_.accounts)===null||S===void 0?void 0:S.oauth2[E]({client_id:c,scope:i?t:`openid profile email ${t}`,callback:R=>{var T,D;if(R.error)return(T=m.current)===null||T===void 0?void 0:T.call(m,R);(D=v.current)===null||D===void 0||D.call(v,R)},error_callback:R=>{var T;(T=g.current)===null||T===void 0||T.call(g,R)},state:s,...l});d.current=C},[c,f,r,t,s]);const b=Z.useCallback(_=>{var S;return(S=d.current)===null||S===void 0?void 0:S.requestAccessToken(_)},[]),w=Z.useCallback(()=>{var _;return(_=d.current)===null||_===void 0?void 0:_.requestCode()},[]);return r==="implicit"?b:w}var Qu=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(r){return this.listeners.add(r),this.onSubscribe(),()=>{this.listeners.delete(r),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},rs=typeof window>"u"||"Deno"in globalThis;function Dr(){}function HO(r,t){return typeof r=="function"?r(t):r}function kg(r){return typeof r=="number"&&r>=0&&r!==1/0}function YS(r,t){return Math.max(r+(t||0)-Date.now(),0)}function pu(r,t){return typeof r=="function"?r(t):r}function jr(r,t){return typeof r=="function"?r(t):r}function f2(r,t){const{type:e="all",exact:n,fetchStatus:a,predicate:i,queryKey:s,stale:l}=r;if(s){if(n){if(t.queryHash!==By(s,t.options))return!1}else if(!yc(t.queryKey,s))return!1}if(e!=="all"){const c=t.isActive();if(e==="active"&&!c||e==="inactive"&&c)return!1}return!(typeof l=="boolean"&&t.isStale()!==l||a&&a!==t.state.fetchStatus||i&&!i(t))}function h2(r,t){const{exact:e,status:n,predicate:a,mutationKey:i}=r;if(i){if(!t.options.mutationKey)return!1;if(e){if(as(t.options.mutationKey)!==as(i))return!1}else if(!yc(t.options.mutationKey,i))return!1}return!(n&&t.state.status!==n||a&&!a(t))}function By(r,t){return((t==null?void 0:t.queryKeyHashFn)||as)(r)}function as(r){return JSON.stringify(r,(t,e)=>Og(e)?Object.keys(e).sort().reduce((n,a)=>(n[a]=e[a],n),{}):e)}function yc(r,t){return r===t?!0:typeof r!=typeof t?!1:r&&t&&typeof r=="object"&&typeof t=="object"?Object.keys(t).every(e=>yc(r[e],t[e])):!1}function ZS(r,t){if(r===t)return r;const e=d2(r)&&d2(t);if(e||Og(r)&&Og(t)){const n=e?r:Object.keys(r),a=n.length,i=e?t:Object.keys(t),s=i.length,l=e?[]:{};let c=0;for(let f=0;f<s;f++){const d=e?f:i[f];(!e&&n.includes(d)||e)&&r[d]===void 0&&t[d]===void 0?(l[d]=void 0,c++):(l[d]=ZS(r[d],t[d]),l[d]===r[d]&&r[d]!==void 0&&c++)}return a===s&&c===a?r:l}return t}function nd(r,t){if(!t||Object.keys(r).length!==Object.keys(t).length)return!1;for(const e in r)if(r[e]!==t[e])return!1;return!0}function d2(r){return Array.isArray(r)&&r.length===Object.keys(r).length}function Og(r){if(!p2(r))return!1;const t=r.constructor;if(t===void 0)return!0;const e=t.prototype;return!(!p2(e)||!e.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(r)!==Object.prototype)}function p2(r){return Object.prototype.toString.call(r)==="[object Object]"}function jO(r){return new Promise(t=>{setTimeout(t,r)})}function Ng(r,t,e){return typeof e.structuralSharing=="function"?e.structuralSharing(r,t):e.structuralSharing!==!1?ZS(r,t):t}function WO(r,t,e=0){const n=[...r,t];return e&&n.length>e?n.slice(1):n}function GO(r,t,e=0){const n=[t,...r];return e&&n.length>e?n.slice(0,-1):n}var Ly=Symbol();function QS(r,t){return!r.queryFn&&(t!=null&&t.initialPromise)?()=>t.initialPromise:!r.queryFn||r.queryFn===Ly?()=>Promise.reject(new Error(`Missing queryFn: '${r.queryHash}'`)):r.queryFn}var jo,Gi,Su,$_,qO=($_=class extends Qu{constructor(){super();Fe(this,jo);Fe(this,Gi);Fe(this,Su);we(this,Su,t=>{if(!rs&&window.addEventListener){const e=()=>t();return window.addEventListener("visibilitychange",e,!1),()=>{window.removeEventListener("visibilitychange",e)}}})}onSubscribe(){H(this,Gi)||this.setEventListener(H(this,Su))}onUnsubscribe(){var t;this.hasListeners()||((t=H(this,Gi))==null||t.call(this),we(this,Gi,void 0))}setEventListener(t){var e;we(this,Su,t),(e=H(this,Gi))==null||e.call(this),we(this,Gi,t(n=>{typeof n=="boolean"?this.setFocused(n):this.onFocus()}))}setFocused(t){H(this,jo)!==t&&(we(this,jo,t),this.onFocus())}onFocus(){const t=this.isFocused();this.listeners.forEach(e=>{e(t)})}isFocused(){var t;return typeof H(this,jo)=="boolean"?H(this,jo):((t=globalThis.document)==null?void 0:t.visibilityState)!=="hidden"}},jo=new WeakMap,Gi=new WeakMap,Su=new WeakMap,$_),Py=new qO,Eu,qi,Cu,Y_,KO=(Y_=class extends Qu{constructor(){super();Fe(this,Eu,!0);Fe(this,qi);Fe(this,Cu);we(this,Cu,t=>{if(!rs&&window.addEventListener){const e=()=>t(!0),n=()=>t(!1);return window.addEventListener("online",e,!1),window.addEventListener("offline",n,!1),()=>{window.removeEventListener("online",e),window.removeEventListener("offline",n)}}})}onSubscribe(){H(this,qi)||this.setEventListener(H(this,Cu))}onUnsubscribe(){var t;this.hasListeners()||((t=H(this,qi))==null||t.call(this),we(this,qi,void 0))}setEventListener(t){var e;we(this,Cu,t),(e=H(this,qi))==null||e.call(this),we(this,qi,t(this.setOnline.bind(this)))}setOnline(t){H(this,Eu)!==t&&(we(this,Eu,t),this.listeners.forEach(n=>{n(t)}))}isOnline(){return H(this,Eu)}},Eu=new WeakMap,qi=new WeakMap,Cu=new WeakMap,Y_),rd=new KO;function Mg(){let r,t;const e=new Promise((a,i)=>{r=a,t=i});e.status="pending",e.catch(()=>{});function n(a){Object.assign(e,a),delete e.resolve,delete e.reject}return e.resolve=a=>{n({status:"fulfilled",value:a}),r(a)},e.reject=a=>{n({status:"rejected",reason:a}),t(a)},e}function XO(r){return Math.min(1e3*2**r,3e4)}function JS(r){return(r??"online")==="online"?rd.isOnline():!0}var eE=class extends Error{constructor(r){super("CancelledError"),this.revert=r==null?void 0:r.revert,this.silent=r==null?void 0:r.silent}};function Pm(r){return r instanceof eE}function tE(r){let t=!1,e=0,n=!1,a;const i=Mg(),s=w=>{var _;n||(m(new eE(w)),(_=r.abort)==null||_.call(r))},l=()=>{t=!0},c=()=>{t=!1},f=()=>Py.isFocused()&&(r.networkMode==="always"||rd.isOnline())&&r.canRun(),d=()=>JS(r.networkMode)&&r.canRun(),v=w=>{var _;n||(n=!0,(_=r.onSuccess)==null||_.call(r,w),a==null||a(),i.resolve(w))},m=w=>{var _;n||(n=!0,(_=r.onError)==null||_.call(r,w),a==null||a(),i.reject(w))},g=()=>new Promise(w=>{var _;a=S=>{(n||f())&&w(S)},(_=r.onPause)==null||_.call(r)}).then(()=>{var w;a=void 0,n||(w=r.onContinue)==null||w.call(r)}),b=()=>{if(n)return;let w;const _=e===0?r.initialPromise:void 0;try{w=_??r.fn()}catch(S){w=Promise.reject(S)}Promise.resolve(w).then(v).catch(S=>{var D;if(n)return;const E=r.retry??(rs?0:3),C=r.retryDelay??XO,R=typeof C=="function"?C(e,S):C,T=E===!0||typeof E=="number"&&e<E||typeof E=="function"&&E(e,S);if(t||!T){m(S);return}e++,(D=r.onFail)==null||D.call(r,e,S),jO(R).then(()=>f()?void 0:g()).then(()=>{t?m(S):b()})})};return{promise:i,cancel:s,continue:()=>(a==null||a(),i),cancelRetry:l,continueRetry:c,canStart:d,start:()=>(d()?b():g().then(b),i)}}var $O=r=>setTimeout(r,0);function YO(){let r=[],t=0,e=l=>{l()},n=l=>{l()},a=$O;const i=l=>{t?r.push(l):a(()=>{e(l)})},s=()=>{const l=r;r=[],l.length&&a(()=>{n(()=>{l.forEach(c=>{e(c)})})})};return{batch:l=>{let c;t++;try{c=l()}finally{t--,t||s()}return c},batchCalls:l=>(...c)=>{i(()=>{l(...c)})},schedule:i,setNotifyFunction:l=>{e=l},setBatchNotifyFunction:l=>{n=l},setScheduler:l=>{a=l}}}var tn=YO(),Wo,Z_,nE=(Z_=class{constructor(){Fe(this,Wo)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),kg(this.gcTime)&&we(this,Wo,setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(r){this.gcTime=Math.max(this.gcTime||0,r??(rs?1/0:5*60*1e3))}clearGcTimeout(){H(this,Wo)&&(clearTimeout(H(this,Wo)),we(this,Wo,void 0))}},Wo=new WeakMap,Z_),Ru,Tu,Ar,Go,An,jc,qo,Vr,Xa,Q_,ZO=(Q_=class extends nE{constructor(t){super();Fe(this,Vr);Fe(this,Ru);Fe(this,Tu);Fe(this,Ar);Fe(this,Go);Fe(this,An);Fe(this,jc);Fe(this,qo);we(this,qo,!1),we(this,jc,t.defaultOptions),this.setOptions(t.options),this.observers=[],we(this,Go,t.client),we(this,Ar,H(this,Go).getQueryCache()),this.queryKey=t.queryKey,this.queryHash=t.queryHash,we(this,Ru,QO(this.options)),this.state=t.state??H(this,Ru),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var t;return(t=H(this,An))==null?void 0:t.promise}setOptions(t){this.options={...H(this,jc),...t},this.updateGcTime(this.options.gcTime)}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&H(this,Ar).remove(this)}setData(t,e){const n=Ng(this.state.data,t,this.options);return Ye(this,Vr,Xa).call(this,{data:n,type:"success",dataUpdatedAt:e==null?void 0:e.updatedAt,manual:e==null?void 0:e.manual}),n}setState(t,e){Ye(this,Vr,Xa).call(this,{type:"setState",state:t,setStateOptions:e})}cancel(t){var n,a;const e=(n=H(this,An))==null?void 0:n.promise;return(a=H(this,An))==null||a.cancel(t),e?e.then(Dr).catch(Dr):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(H(this,Ru))}isActive(){return this.observers.some(t=>jr(t.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===Ly||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStale(){return this.state.isInvalidated?!0:this.getObserversCount()>0?this.observers.some(t=>t.getCurrentResult().isStale):this.state.data===void 0}isStaleByTime(t=0){return this.state.isInvalidated||this.state.data===void 0||!YS(this.state.dataUpdatedAt,t)}onFocus(){var e;const t=this.observers.find(n=>n.shouldFetchOnWindowFocus());t==null||t.refetch({cancelRefetch:!1}),(e=H(this,An))==null||e.continue()}onOnline(){var e;const t=this.observers.find(n=>n.shouldFetchOnReconnect());t==null||t.refetch({cancelRefetch:!1}),(e=H(this,An))==null||e.continue()}addObserver(t){this.observers.includes(t)||(this.observers.push(t),this.clearGcTimeout(),H(this,Ar).notify({type:"observerAdded",query:this,observer:t}))}removeObserver(t){this.observers.includes(t)&&(this.observers=this.observers.filter(e=>e!==t),this.observers.length||(H(this,An)&&(H(this,qo)?H(this,An).cancel({revert:!0}):H(this,An).cancelRetry()),this.scheduleGc()),H(this,Ar).notify({type:"observerRemoved",query:this,observer:t}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||Ye(this,Vr,Xa).call(this,{type:"invalidate"})}fetch(t,e){var c,f,d;if(this.state.fetchStatus!=="idle"){if(this.state.data!==void 0&&(e!=null&&e.cancelRefetch))this.cancel({silent:!0});else if(H(this,An))return H(this,An).continueRetry(),H(this,An).promise}if(t&&this.setOptions(t),!this.options.queryFn){const v=this.observers.find(m=>m.options.queryFn);v&&this.setOptions(v.options)}const n=new AbortController,a=v=>{Object.defineProperty(v,"signal",{enumerable:!0,get:()=>(we(this,qo,!0),n.signal)})},i=()=>{const v=QS(this.options,e),m={client:H(this,Go),queryKey:this.queryKey,meta:this.meta};return a(m),we(this,qo,!1),this.options.persister?this.options.persister(v,m,this):v(m)},s={fetchOptions:e,options:this.options,queryKey:this.queryKey,client:H(this,Go),state:this.state,fetchFn:i};a(s),(c=this.options.behavior)==null||c.onFetch(s,this),we(this,Tu,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((f=s.fetchOptions)==null?void 0:f.meta))&&Ye(this,Vr,Xa).call(this,{type:"fetch",meta:(d=s.fetchOptions)==null?void 0:d.meta});const l=v=>{var m,g,b,w;Pm(v)&&v.silent||Ye(this,Vr,Xa).call(this,{type:"error",error:v}),Pm(v)||((g=(m=H(this,Ar).config).onError)==null||g.call(m,v,this),(w=(b=H(this,Ar).config).onSettled)==null||w.call(b,this.state.data,v,this)),this.scheduleGc()};return we(this,An,tE({initialPromise:e==null?void 0:e.initialPromise,fn:s.fetchFn,abort:n.abort.bind(n),onSuccess:v=>{var m,g,b,w;if(v===void 0){l(new Error(`${this.queryHash} data is undefined`));return}try{this.setData(v)}catch(_){l(_);return}(g=(m=H(this,Ar).config).onSuccess)==null||g.call(m,v,this),(w=(b=H(this,Ar).config).onSettled)==null||w.call(b,v,this.state.error,this),this.scheduleGc()},onError:l,onFail:(v,m)=>{Ye(this,Vr,Xa).call(this,{type:"failed",failureCount:v,error:m})},onPause:()=>{Ye(this,Vr,Xa).call(this,{type:"pause"})},onContinue:()=>{Ye(this,Vr,Xa).call(this,{type:"continue"})},retry:s.options.retry,retryDelay:s.options.retryDelay,networkMode:s.options.networkMode,canRun:()=>!0})),H(this,An).start()}},Ru=new WeakMap,Tu=new WeakMap,Ar=new WeakMap,Go=new WeakMap,An=new WeakMap,jc=new WeakMap,qo=new WeakMap,Vr=new WeakSet,Xa=function(t){const e=n=>{switch(t.type){case"failed":return{...n,fetchFailureCount:t.failureCount,fetchFailureReason:t.error};case"pause":return{...n,fetchStatus:"paused"};case"continue":return{...n,fetchStatus:"fetching"};case"fetch":return{...n,...rE(n.data,this.options),fetchMeta:t.meta??null};case"success":return{...n,data:t.data,dataUpdateCount:n.dataUpdateCount+1,dataUpdatedAt:t.dataUpdatedAt??Date.now(),error:null,isInvalidated:!1,status:"success",...!t.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};case"error":const a=t.error;return Pm(a)&&a.revert&&H(this,Tu)?{...H(this,Tu),fetchStatus:"idle"}:{...n,error:a,errorUpdateCount:n.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:n.fetchFailureCount+1,fetchFailureReason:a,fetchStatus:"idle",status:"error"};case"invalidate":return{...n,isInvalidated:!0};case"setState":return{...n,...t.state}}};this.state=e(this.state),tn.batch(()=>{this.observers.forEach(n=>{n.onQueryUpdate()}),H(this,Ar).notify({query:this,type:"updated",action:t})})},Q_);function rE(r,t){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:JS(t.networkMode)?"fetching":"paused",...r===void 0&&{error:null,status:"pending"}}}function QO(r){const t=typeof r.initialData=="function"?r.initialData():r.initialData,e=t!==void 0,n=e?typeof r.initialDataUpdatedAt=="function"?r.initialDataUpdatedAt():r.initialDataUpdatedAt:0;return{data:t,dataUpdateCount:0,dataUpdatedAt:e?n??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:e?"success":"pending",fetchStatus:"idle"}}var la,J_,JO=(J_=class extends Qu{constructor(t={}){super();Fe(this,la);this.config=t,we(this,la,new Map)}build(t,e,n){const a=e.queryKey,i=e.queryHash??By(a,e);let s=this.get(i);return s||(s=new ZO({client:t,queryKey:a,queryHash:i,options:t.defaultQueryOptions(e),state:n,defaultOptions:t.getQueryDefaults(a)}),this.add(s)),s}add(t){H(this,la).has(t.queryHash)||(H(this,la).set(t.queryHash,t),this.notify({type:"added",query:t}))}remove(t){const e=H(this,la).get(t.queryHash);e&&(t.destroy(),e===t&&H(this,la).delete(t.queryHash),this.notify({type:"removed",query:t}))}clear(){tn.batch(()=>{this.getAll().forEach(t=>{this.remove(t)})})}get(t){return H(this,la).get(t)}getAll(){return[...H(this,la).values()]}find(t){const e={exact:!0,...t};return this.getAll().find(n=>f2(e,n))}findAll(t={}){const e=this.getAll();return Object.keys(t).length>0?e.filter(n=>f2(t,n)):e}notify(t){tn.batch(()=>{this.listeners.forEach(e=>{e(t)})})}onFocus(){tn.batch(()=>{this.getAll().forEach(t=>{t.onFocus()})})}onOnline(){tn.batch(()=>{this.getAll().forEach(t=>{t.onOnline()})})}},la=new WeakMap,J_),ca,Ln,Ko,fa,ji,eS,eN=(eS=class extends nE{constructor(t){super();Fe(this,fa);Fe(this,ca);Fe(this,Ln);Fe(this,Ko);this.mutationId=t.mutationId,we(this,Ln,t.mutationCache),we(this,ca,[]),this.state=t.state||aE(),this.setOptions(t.options),this.scheduleGc()}setOptions(t){this.options=t,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(t){H(this,ca).includes(t)||(H(this,ca).push(t),this.clearGcTimeout(),H(this,Ln).notify({type:"observerAdded",mutation:this,observer:t}))}removeObserver(t){we(this,ca,H(this,ca).filter(e=>e!==t)),this.scheduleGc(),H(this,Ln).notify({type:"observerRemoved",mutation:this,observer:t})}optionalRemove(){H(this,ca).length||(this.state.status==="pending"?this.scheduleGc():H(this,Ln).remove(this))}continue(){var t;return((t=H(this,Ko))==null?void 0:t.continue())??this.execute(this.state.variables)}async execute(t){var i,s,l,c,f,d,v,m,g,b,w,_,S,E,C,R,T,D,k,M;const e=()=>{Ye(this,fa,ji).call(this,{type:"continue"})};we(this,Ko,tE({fn:()=>this.options.mutationFn?this.options.mutationFn(t):Promise.reject(new Error("No mutationFn found")),onFail:(N,I)=>{Ye(this,fa,ji).call(this,{type:"failed",failureCount:N,error:I})},onPause:()=>{Ye(this,fa,ji).call(this,{type:"pause"})},onContinue:e,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>H(this,Ln).canRun(this)}));const n=this.state.status==="pending",a=!H(this,Ko).canStart();try{if(n)e();else{Ye(this,fa,ji).call(this,{type:"pending",variables:t,isPaused:a}),await((s=(i=H(this,Ln).config).onMutate)==null?void 0:s.call(i,t,this));const I=await((c=(l=this.options).onMutate)==null?void 0:c.call(l,t));I!==this.state.context&&Ye(this,fa,ji).call(this,{type:"pending",context:I,variables:t,isPaused:a})}const N=await H(this,Ko).start();return await((d=(f=H(this,Ln).config).onSuccess)==null?void 0:d.call(f,N,t,this.state.context,this)),await((m=(v=this.options).onSuccess)==null?void 0:m.call(v,N,t,this.state.context)),await((b=(g=H(this,Ln).config).onSettled)==null?void 0:b.call(g,N,null,this.state.variables,this.state.context,this)),await((_=(w=this.options).onSettled)==null?void 0:_.call(w,N,null,t,this.state.context)),Ye(this,fa,ji).call(this,{type:"success",data:N}),N}catch(N){try{throw await((E=(S=H(this,Ln).config).onError)==null?void 0:E.call(S,N,t,this.state.context,this)),await((R=(C=this.options).onError)==null?void 0:R.call(C,N,t,this.state.context)),await((D=(T=H(this,Ln).config).onSettled)==null?void 0:D.call(T,void 0,N,this.state.variables,this.state.context,this)),await((M=(k=this.options).onSettled)==null?void 0:M.call(k,void 0,N,t,this.state.context)),N}finally{Ye(this,fa,ji).call(this,{type:"error",error:N})}}finally{H(this,Ln).runNext(this)}}},ca=new WeakMap,Ln=new WeakMap,Ko=new WeakMap,fa=new WeakSet,ji=function(t){const e=n=>{switch(t.type){case"failed":return{...n,failureCount:t.failureCount,failureReason:t.error};case"pause":return{...n,isPaused:!0};case"continue":return{...n,isPaused:!1};case"pending":return{...n,context:t.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:t.isPaused,status:"pending",variables:t.variables,submittedAt:Date.now()};case"success":return{...n,data:t.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...n,data:void 0,error:t.error,failureCount:n.failureCount+1,failureReason:t.error,isPaused:!1,status:"error"}}};this.state=e(this.state),tn.batch(()=>{H(this,ca).forEach(n=>{n.onMutationUpdate(t)}),H(this,Ln).notify({mutation:this,type:"updated",action:t})})},eS);function aE(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var Ja,Hr,Wc,tS,tN=(tS=class extends Qu{constructor(t={}){super();Fe(this,Ja);Fe(this,Hr);Fe(this,Wc);this.config=t,we(this,Ja,new Set),we(this,Hr,new Map),we(this,Wc,0)}build(t,e,n){const a=new eN({mutationCache:this,mutationId:++bh(this,Wc)._,options:t.defaultMutationOptions(e),state:n});return this.add(a),a}add(t){H(this,Ja).add(t);const e=Sh(t);if(typeof e=="string"){const n=H(this,Hr).get(e);n?n.push(t):H(this,Hr).set(e,[t])}this.notify({type:"added",mutation:t})}remove(t){if(H(this,Ja).delete(t)){const e=Sh(t);if(typeof e=="string"){const n=H(this,Hr).get(e);if(n)if(n.length>1){const a=n.indexOf(t);a!==-1&&n.splice(a,1)}else n[0]===t&&H(this,Hr).delete(e)}}this.notify({type:"removed",mutation:t})}canRun(t){const e=Sh(t);if(typeof e=="string"){const n=H(this,Hr).get(e),a=n==null?void 0:n.find(i=>i.state.status==="pending");return!a||a===t}else return!0}runNext(t){var n;const e=Sh(t);if(typeof e=="string"){const a=(n=H(this,Hr).get(e))==null?void 0:n.find(i=>i!==t&&i.state.isPaused);return(a==null?void 0:a.continue())??Promise.resolve()}else return Promise.resolve()}clear(){tn.batch(()=>{H(this,Ja).forEach(t=>{this.notify({type:"removed",mutation:t})}),H(this,Ja).clear(),H(this,Hr).clear()})}getAll(){return Array.from(H(this,Ja))}find(t){const e={exact:!0,...t};return this.getAll().find(n=>h2(e,n))}findAll(t={}){return this.getAll().filter(e=>h2(t,e))}notify(t){tn.batch(()=>{this.listeners.forEach(e=>{e(t)})})}resumePausedMutations(){const t=this.getAll().filter(e=>e.state.isPaused);return tn.batch(()=>Promise.all(t.map(e=>e.continue().catch(Dr))))}},Ja=new WeakMap,Hr=new WeakMap,Wc=new WeakMap,tS);function Sh(r){var t;return(t=r.options.scope)==null?void 0:t.id}function v2(r){return{onFetch:(t,e)=>{var d,v,m,g,b;const n=t.options,a=(m=(v=(d=t.fetchOptions)==null?void 0:d.meta)==null?void 0:v.fetchMore)==null?void 0:m.direction,i=((g=t.state.data)==null?void 0:g.pages)||[],s=((b=t.state.data)==null?void 0:b.pageParams)||[];let l={pages:[],pageParams:[]},c=0;const f=async()=>{let w=!1;const _=C=>{Object.defineProperty(C,"signal",{enumerable:!0,get:()=>(t.signal.aborted?w=!0:t.signal.addEventListener("abort",()=>{w=!0}),t.signal)})},S=QS(t.options,t.fetchOptions),E=async(C,R,T)=>{if(w)return Promise.reject();if(R==null&&C.pages.length)return Promise.resolve(C);const D={client:t.client,queryKey:t.queryKey,pageParam:R,direction:T?"backward":"forward",meta:t.options.meta};_(D);const k=await S(D),{maxPages:M}=t.options,N=T?GO:WO;return{pages:N(C.pages,k,M),pageParams:N(C.pageParams,R,M)}};if(a&&i.length){const C=a==="backward",R=C?nN:m2,T={pages:i,pageParams:s},D=R(n,T);l=await E(T,D,C)}else{const C=r??i.length;do{const R=c===0?s[0]??n.initialPageParam:m2(n,l);if(c>0&&R==null)break;l=await E(l,R),c++}while(c<C)}return l};t.options.persister?t.fetchFn=()=>{var w,_;return(_=(w=t.options).persister)==null?void 0:_.call(w,f,{client:t.client,queryKey:t.queryKey,meta:t.options.meta,signal:t.signal},e)}:t.fetchFn=f}}}function m2(r,{pages:t,pageParams:e}){const n=t.length-1;return t.length>0?r.getNextPageParam(t[n],t,e[n],e):void 0}function nN(r,{pages:t,pageParams:e}){var n;return t.length>0?(n=r.getPreviousPageParam)==null?void 0:n.call(r,t[0],t,e[0],e):void 0}var Ut,Ki,Xi,Au,Du,$i,ku,Ou,nS,u6=(nS=class{constructor(r={}){Fe(this,Ut);Fe(this,Ki);Fe(this,Xi);Fe(this,Au);Fe(this,Du);Fe(this,$i);Fe(this,ku);Fe(this,Ou);we(this,Ut,r.queryCache||new JO),we(this,Ki,r.mutationCache||new tN),we(this,Xi,r.defaultOptions||{}),we(this,Au,new Map),we(this,Du,new Map),we(this,$i,0)}mount(){bh(this,$i)._++,H(this,$i)===1&&(we(this,ku,Py.subscribe(async r=>{r&&(await this.resumePausedMutations(),H(this,Ut).onFocus())})),we(this,Ou,rd.subscribe(async r=>{r&&(await this.resumePausedMutations(),H(this,Ut).onOnline())})))}unmount(){var r,t;bh(this,$i)._--,H(this,$i)===0&&((r=H(this,ku))==null||r.call(this),we(this,ku,void 0),(t=H(this,Ou))==null||t.call(this),we(this,Ou,void 0))}isFetching(r){return H(this,Ut).findAll({...r,fetchStatus:"fetching"}).length}isMutating(r){return H(this,Ki).findAll({...r,status:"pending"}).length}getQueryData(r){var e;const t=this.defaultQueryOptions({queryKey:r});return(e=H(this,Ut).get(t.queryHash))==null?void 0:e.state.data}ensureQueryData(r){const t=this.defaultQueryOptions(r),e=H(this,Ut).build(this,t),n=e.state.data;return n===void 0?this.fetchQuery(r):(r.revalidateIfStale&&e.isStaleByTime(pu(t.staleTime,e))&&this.prefetchQuery(t),Promise.resolve(n))}getQueriesData(r){return H(this,Ut).findAll(r).map(({queryKey:t,state:e})=>{const n=e.data;return[t,n]})}setQueryData(r,t,e){const n=this.defaultQueryOptions({queryKey:r}),a=H(this,Ut).get(n.queryHash),i=a==null?void 0:a.state.data,s=HO(t,i);if(s!==void 0)return H(this,Ut).build(this,n).setData(s,{...e,manual:!0})}setQueriesData(r,t,e){return tn.batch(()=>H(this,Ut).findAll(r).map(({queryKey:n})=>[n,this.setQueryData(n,t,e)]))}getQueryState(r){var e;const t=this.defaultQueryOptions({queryKey:r});return(e=H(this,Ut).get(t.queryHash))==null?void 0:e.state}removeQueries(r){const t=H(this,Ut);tn.batch(()=>{t.findAll(r).forEach(e=>{t.remove(e)})})}resetQueries(r,t){const e=H(this,Ut);return tn.batch(()=>(e.findAll(r).forEach(n=>{n.reset()}),this.refetchQueries({type:"active",...r},t)))}cancelQueries(r,t={}){const e={revert:!0,...t},n=tn.batch(()=>H(this,Ut).findAll(r).map(a=>a.cancel(e)));return Promise.all(n).then(Dr).catch(Dr)}invalidateQueries(r,t={}){return tn.batch(()=>(H(this,Ut).findAll(r).forEach(e=>{e.invalidate()}),(r==null?void 0:r.refetchType)==="none"?Promise.resolve():this.refetchQueries({...r,type:(r==null?void 0:r.refetchType)??(r==null?void 0:r.type)??"active"},t)))}refetchQueries(r,t={}){const e={...t,cancelRefetch:t.cancelRefetch??!0},n=tn.batch(()=>H(this,Ut).findAll(r).filter(a=>!a.isDisabled()).map(a=>{let i=a.fetch(void 0,e);return e.throwOnError||(i=i.catch(Dr)),a.state.fetchStatus==="paused"?Promise.resolve():i}));return Promise.all(n).then(Dr)}fetchQuery(r){const t=this.defaultQueryOptions(r);t.retry===void 0&&(t.retry=!1);const e=H(this,Ut).build(this,t);return e.isStaleByTime(pu(t.staleTime,e))?e.fetch(t):Promise.resolve(e.state.data)}prefetchQuery(r){return this.fetchQuery(r).then(Dr).catch(Dr)}fetchInfiniteQuery(r){return r.behavior=v2(r.pages),this.fetchQuery(r)}prefetchInfiniteQuery(r){return this.fetchInfiniteQuery(r).then(Dr).catch(Dr)}ensureInfiniteQueryData(r){return r.behavior=v2(r.pages),this.ensureQueryData(r)}resumePausedMutations(){return rd.isOnline()?H(this,Ki).resumePausedMutations():Promise.resolve()}getQueryCache(){return H(this,Ut)}getMutationCache(){return H(this,Ki)}getDefaultOptions(){return H(this,Xi)}setDefaultOptions(r){we(this,Xi,r)}setQueryDefaults(r,t){H(this,Au).set(as(r),{queryKey:r,defaultOptions:t})}getQueryDefaults(r){const t=[...H(this,Au).values()],e={};return t.forEach(n=>{yc(r,n.queryKey)&&Object.assign(e,n.defaultOptions)}),e}setMutationDefaults(r,t){H(this,Du).set(as(r),{mutationKey:r,defaultOptions:t})}getMutationDefaults(r){const t=[...H(this,Du).values()],e={};return t.forEach(n=>{yc(r,n.mutationKey)&&Object.assign(e,n.defaultOptions)}),e}defaultQueryOptions(r){if(r._defaulted)return r;const t={...H(this,Xi).queries,...this.getQueryDefaults(r.queryKey),...r,_defaulted:!0};return t.queryHash||(t.queryHash=By(t.queryKey,t)),t.refetchOnReconnect===void 0&&(t.refetchOnReconnect=t.networkMode!=="always"),t.throwOnError===void 0&&(t.throwOnError=!!t.suspense),!t.networkMode&&t.persister&&(t.networkMode="offlineFirst"),t.queryFn===Ly&&(t.enabled=!1),t}defaultMutationOptions(r){return r!=null&&r._defaulted?r:{...H(this,Xi).mutations,...(r==null?void 0:r.mutationKey)&&this.getMutationDefaults(r.mutationKey),...r,_defaulted:!0}}clear(){H(this,Ut).clear(),H(this,Ki).clear()}},Ut=new WeakMap,Ki=new WeakMap,Xi=new WeakMap,Au=new WeakMap,Du=new WeakMap,$i=new WeakMap,ku=new WeakMap,Ou=new WeakMap,nS),Kn,ot,Gc,Pn,Xo,Nu,Yi,Zi,qc,Mu,Iu,$o,Yo,Qi,Fu,mt,uc,Ig,Fg,Bg,Lg,Pg,zg,Ug,iE,rS,rN=(rS=class extends Qu{constructor(t,e){super();Fe(this,mt);Fe(this,Kn);Fe(this,ot);Fe(this,Gc);Fe(this,Pn);Fe(this,Xo);Fe(this,Nu);Fe(this,Yi);Fe(this,Zi);Fe(this,qc);Fe(this,Mu);Fe(this,Iu);Fe(this,$o);Fe(this,Yo);Fe(this,Qi);Fe(this,Fu,new Set);this.options=e,we(this,Kn,t),we(this,Zi,null),we(this,Yi,Mg()),this.options.experimental_prefetchInRender||H(this,Yi).reject(new Error("experimental_prefetchInRender feature flag is not enabled")),this.bindMethods(),this.setOptions(e)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(H(this,ot).addObserver(this),g2(H(this,ot),this.options)?Ye(this,mt,uc).call(this):this.updateResult(),Ye(this,mt,Lg).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return Vg(H(this,ot),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return Vg(H(this,ot),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,Ye(this,mt,Pg).call(this),Ye(this,mt,zg).call(this),H(this,ot).removeObserver(this)}setOptions(t){const e=this.options,n=H(this,ot);if(this.options=H(this,Kn).defaultQueryOptions(t),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof jr(this.options.enabled,H(this,ot))!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");Ye(this,mt,Ug).call(this),H(this,ot).setOptions(this.options),e._defaulted&&!nd(this.options,e)&&H(this,Kn).getQueryCache().notify({type:"observerOptionsUpdated",query:H(this,ot),observer:this});const a=this.hasListeners();a&&y2(H(this,ot),n,this.options,e)&&Ye(this,mt,uc).call(this),this.updateResult(),a&&(H(this,ot)!==n||jr(this.options.enabled,H(this,ot))!==jr(e.enabled,H(this,ot))||pu(this.options.staleTime,H(this,ot))!==pu(e.staleTime,H(this,ot)))&&Ye(this,mt,Ig).call(this);const i=Ye(this,mt,Fg).call(this);a&&(H(this,ot)!==n||jr(this.options.enabled,H(this,ot))!==jr(e.enabled,H(this,ot))||i!==H(this,Qi))&&Ye(this,mt,Bg).call(this,i)}getOptimisticResult(t){const e=H(this,Kn).getQueryCache().build(H(this,Kn),t),n=this.createResult(e,t);return iN(this,n)&&(we(this,Pn,n),we(this,Nu,this.options),we(this,Xo,H(this,ot).state)),n}getCurrentResult(){return H(this,Pn)}trackResult(t,e){return new Proxy(t,{get:(n,a)=>(this.trackProp(a),e==null||e(a),Reflect.get(n,a))})}trackProp(t){H(this,Fu).add(t)}getCurrentQuery(){return H(this,ot)}refetch({...t}={}){return this.fetch({...t})}fetchOptimistic(t){const e=H(this,Kn).defaultQueryOptions(t),n=H(this,Kn).getQueryCache().build(H(this,Kn),e);return n.fetch().then(()=>this.createResult(n,e))}fetch(t){return Ye(this,mt,uc).call(this,{...t,cancelRefetch:t.cancelRefetch??!0}).then(()=>(this.updateResult(),H(this,Pn)))}createResult(t,e){var N;const n=H(this,ot),a=this.options,i=H(this,Pn),s=H(this,Xo),l=H(this,Nu),f=t!==n?t.state:H(this,Gc),{state:d}=t;let v={...d},m=!1,g;if(e._optimisticResults){const I=this.hasListeners(),z=!I&&g2(t,e),P=I&&y2(t,n,e,a);(z||P)&&(v={...v,...rE(d.data,t.options)}),e._optimisticResults==="isRestoring"&&(v.fetchStatus="idle")}let{error:b,errorUpdatedAt:w,status:_}=v;g=v.data;let S=!1;if(e.placeholderData!==void 0&&g===void 0&&_==="pending"){let I;i!=null&&i.isPlaceholderData&&e.placeholderData===(l==null?void 0:l.placeholderData)?(I=i.data,S=!0):I=typeof e.placeholderData=="function"?e.placeholderData((N=H(this,Iu))==null?void 0:N.state.data,H(this,Iu)):e.placeholderData,I!==void 0&&(_="success",g=Ng(i==null?void 0:i.data,I,e),m=!0)}if(e.select&&g!==void 0&&!S)if(i&&g===(s==null?void 0:s.data)&&e.select===H(this,qc))g=H(this,Mu);else try{we(this,qc,e.select),g=e.select(g),g=Ng(i==null?void 0:i.data,g,e),we(this,Mu,g),we(this,Zi,null)}catch(I){we(this,Zi,I)}H(this,Zi)&&(b=H(this,Zi),g=H(this,Mu),w=Date.now(),_="error");const E=v.fetchStatus==="fetching",C=_==="pending",R=_==="error",T=C&&E,D=g!==void 0,M={status:_,fetchStatus:v.fetchStatus,isPending:C,isSuccess:_==="success",isError:R,isInitialLoading:T,isLoading:T,data:g,dataUpdatedAt:v.dataUpdatedAt,error:b,errorUpdatedAt:w,failureCount:v.fetchFailureCount,failureReason:v.fetchFailureReason,errorUpdateCount:v.errorUpdateCount,isFetched:v.dataUpdateCount>0||v.errorUpdateCount>0,isFetchedAfterMount:v.dataUpdateCount>f.dataUpdateCount||v.errorUpdateCount>f.errorUpdateCount,isFetching:E,isRefetching:E&&!C,isLoadingError:R&&!D,isPaused:v.fetchStatus==="paused",isPlaceholderData:m,isRefetchError:R&&D,isStale:zy(t,e),refetch:this.refetch,promise:H(this,Yi)};if(this.options.experimental_prefetchInRender){const I=ne=>{M.status==="error"?ne.reject(M.error):M.data!==void 0&&ne.resolve(M.data)},z=()=>{const ne=we(this,Yi,M.promise=Mg());I(ne)},P=H(this,Yi);switch(P.status){case"pending":t.queryHash===n.queryHash&&I(P);break;case"fulfilled":(M.status==="error"||M.data!==P.value)&&z();break;case"rejected":(M.status!=="error"||M.error!==P.reason)&&z();break}}return M}updateResult(){const t=H(this,Pn),e=this.createResult(H(this,ot),this.options);if(we(this,Xo,H(this,ot).state),we(this,Nu,this.options),H(this,Xo).data!==void 0&&we(this,Iu,H(this,ot)),nd(e,t))return;we(this,Pn,e);const n=()=>{if(!t)return!0;const{notifyOnChangeProps:a}=this.options,i=typeof a=="function"?a():a;if(i==="all"||!i&&!H(this,Fu).size)return!0;const s=new Set(i??H(this,Fu));return this.options.throwOnError&&s.add("error"),Object.keys(H(this,Pn)).some(l=>{const c=l;return H(this,Pn)[c]!==t[c]&&s.has(c)})};Ye(this,mt,iE).call(this,{listeners:n()})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&Ye(this,mt,Lg).call(this)}},Kn=new WeakMap,ot=new WeakMap,Gc=new WeakMap,Pn=new WeakMap,Xo=new WeakMap,Nu=new WeakMap,Yi=new WeakMap,Zi=new WeakMap,qc=new WeakMap,Mu=new WeakMap,Iu=new WeakMap,$o=new WeakMap,Yo=new WeakMap,Qi=new WeakMap,Fu=new WeakMap,mt=new WeakSet,uc=function(t){Ye(this,mt,Ug).call(this);let e=H(this,ot).fetch(this.options,t);return t!=null&&t.throwOnError||(e=e.catch(Dr)),e},Ig=function(){Ye(this,mt,Pg).call(this);const t=pu(this.options.staleTime,H(this,ot));if(rs||H(this,Pn).isStale||!kg(t))return;const n=YS(H(this,Pn).dataUpdatedAt,t)+1;we(this,$o,setTimeout(()=>{H(this,Pn).isStale||this.updateResult()},n))},Fg=function(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(H(this,ot)):this.options.refetchInterval)??!1},Bg=function(t){Ye(this,mt,zg).call(this),we(this,Qi,t),!(rs||jr(this.options.enabled,H(this,ot))===!1||!kg(H(this,Qi))||H(this,Qi)===0)&&we(this,Yo,setInterval(()=>{(this.options.refetchIntervalInBackground||Py.isFocused())&&Ye(this,mt,uc).call(this)},H(this,Qi)))},Lg=function(){Ye(this,mt,Ig).call(this),Ye(this,mt,Bg).call(this,Ye(this,mt,Fg).call(this))},Pg=function(){H(this,$o)&&(clearTimeout(H(this,$o)),we(this,$o,void 0))},zg=function(){H(this,Yo)&&(clearInterval(H(this,Yo)),we(this,Yo,void 0))},Ug=function(){const t=H(this,Kn).getQueryCache().build(H(this,Kn),this.options);if(t===H(this,ot))return;const e=H(this,ot);we(this,ot,t),we(this,Gc,t.state),this.hasListeners()&&(e==null||e.removeObserver(this),t.addObserver(this))},iE=function(t){tn.batch(()=>{t.listeners&&this.listeners.forEach(e=>{e(H(this,Pn))}),H(this,Kn).getQueryCache().notify({query:H(this,ot),type:"observerResultsUpdated"})})},rS);function aN(r,t){return jr(t.enabled,r)!==!1&&r.state.data===void 0&&!(r.state.status==="error"&&t.retryOnMount===!1)}function g2(r,t){return aN(r,t)||r.state.data!==void 0&&Vg(r,t,t.refetchOnMount)}function Vg(r,t,e){if(jr(t.enabled,r)!==!1){const n=typeof e=="function"?e(r):e;return n==="always"||n!==!1&&zy(r,t)}return!1}function y2(r,t,e,n){return(r!==t||jr(n.enabled,r)===!1)&&(!e.suspense||r.state.status!=="error")&&zy(r,e)}function zy(r,t){return jr(t.enabled,r)!==!1&&r.isStaleByTime(pu(t.staleTime,r))}function iN(r,t){return!nd(r.getCurrentResult(),t)}var Ji,eo,Xn,ei,ri,Xh,Hg,aS,oN=(aS=class extends Qu{constructor(e,n){super();Fe(this,ri);Fe(this,Ji);Fe(this,eo);Fe(this,Xn);Fe(this,ei);we(this,Ji,e),this.setOptions(n),this.bindMethods(),Ye(this,ri,Xh).call(this)}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(e){var a;const n=this.options;this.options=H(this,Ji).defaultMutationOptions(e),nd(this.options,n)||H(this,Ji).getMutationCache().notify({type:"observerOptionsUpdated",mutation:H(this,Xn),observer:this}),n!=null&&n.mutationKey&&this.options.mutationKey&&as(n.mutationKey)!==as(this.options.mutationKey)?this.reset():((a=H(this,Xn))==null?void 0:a.state.status)==="pending"&&H(this,Xn).setOptions(this.options)}onUnsubscribe(){var e;this.hasListeners()||(e=H(this,Xn))==null||e.removeObserver(this)}onMutationUpdate(e){Ye(this,ri,Xh).call(this),Ye(this,ri,Hg).call(this,e)}getCurrentResult(){return H(this,eo)}reset(){var e;(e=H(this,Xn))==null||e.removeObserver(this),we(this,Xn,void 0),Ye(this,ri,Xh).call(this),Ye(this,ri,Hg).call(this)}mutate(e,n){var a;return we(this,ei,n),(a=H(this,Xn))==null||a.removeObserver(this),we(this,Xn,H(this,Ji).getMutationCache().build(H(this,Ji),this.options)),H(this,Xn).addObserver(this),H(this,Xn).execute(e)}},Ji=new WeakMap,eo=new WeakMap,Xn=new WeakMap,ei=new WeakMap,ri=new WeakSet,Xh=function(){var n;const e=((n=H(this,Xn))==null?void 0:n.state)??aE();we(this,eo,{...e,isPending:e.status==="pending",isSuccess:e.status==="success",isError:e.status==="error",isIdle:e.status==="idle",mutate:this.mutate,reset:this.reset})},Hg=function(e){tn.batch(()=>{var n,a,i,s,l,c,f,d;if(H(this,ei)&&this.hasListeners()){const v=H(this,eo).variables,m=H(this,eo).context;(e==null?void 0:e.type)==="success"?((a=(n=H(this,ei)).onSuccess)==null||a.call(n,e.data,v,m),(s=(i=H(this,ei)).onSettled)==null||s.call(i,e.data,null,v,m)):(e==null?void 0:e.type)==="error"&&((c=(l=H(this,ei)).onError)==null||c.call(l,e.error,v,m),(d=(f=H(this,ei)).onSettled)==null||d.call(f,void 0,e.error,v,m))}this.listeners.forEach(v=>{v(H(this,eo))})})},aS),oE=Z.createContext(void 0),sE=r=>{const t=Z.useContext(oE);if(!t)throw new Error("No QueryClient set, use QueryClientProvider to set one");return t},c6=({client:r,children:t})=>(Z.useEffect(()=>(r.mount(),()=>{r.unmount()}),[r]),uD.jsx(oE.Provider,{value:r,children:t})),uE=Z.createContext(!1),sN=()=>Z.useContext(uE);uE.Provider;function uN(){let r=!1;return{clearReset:()=>{r=!1},reset:()=>{r=!0},isReset:()=>r}}var lN=Z.createContext(uN()),cN=()=>Z.useContext(lN);function lE(r,t){return typeof r=="function"?r(...t):!!r}function jg(){}var fN=(r,t)=>{(r.suspense||r.throwOnError||r.experimental_prefetchInRender)&&(t.isReset()||(r.retryOnMount=!1))},hN=r=>{Z.useEffect(()=>{r.clearReset()},[r])},dN=({result:r,errorResetBoundary:t,throwOnError:e,query:n,suspense:a})=>r.isError&&!t.isReset()&&!r.isFetching&&n&&(a&&r.data===void 0||lE(e,[r.error,n])),pN=r=>{const t=r.staleTime;r.suspense&&(r.staleTime=typeof t=="function"?(...e)=>Math.max(t(...e),1e3):Math.max(t??1e3,1e3),typeof r.gcTime=="number"&&(r.gcTime=Math.max(r.gcTime,1e3)))},vN=(r,t)=>r.isLoading&&r.isFetching&&!t,mN=(r,t)=>(r==null?void 0:r.suspense)&&t.isPending,b2=(r,t,e)=>t.fetchOptimistic(r).catch(()=>{e.clearReset()});function gN(r,t,e){var v,m,g,b,w;const n=sE(),a=sN(),i=cN(),s=n.defaultQueryOptions(r);(m=(v=n.getDefaultOptions().queries)==null?void 0:v._experimental_beforeQuery)==null||m.call(v,s),s._optimisticResults=a?"isRestoring":"optimistic",pN(s),fN(s,i),hN(i);const l=!n.getQueryCache().get(s.queryHash),[c]=Z.useState(()=>new t(n,s)),f=c.getOptimisticResult(s),d=!a&&r.subscribed!==!1;if(Z.useSyncExternalStore(Z.useCallback(_=>{const S=d?c.subscribe(tn.batchCalls(_)):jg;return c.updateResult(),S},[c,d]),()=>c.getCurrentResult(),()=>c.getCurrentResult()),Z.useEffect(()=>{c.setOptions(s)},[s,c]),mN(s,f))throw b2(s,c,i);if(dN({result:f,errorResetBoundary:i,throwOnError:s.throwOnError,query:n.getQueryCache().get(s.queryHash),suspense:s.suspense}))throw f.error;if((b=(g=n.getDefaultOptions().queries)==null?void 0:g._experimental_afterQuery)==null||b.call(g,s,f),s.experimental_prefetchInRender&&!rs&&vN(f,a)){const _=l?b2(s,c,i):(w=n.getQueryCache().get(s.queryHash))==null?void 0:w.promise;_==null||_.catch(jg).finally(()=>{c.updateResult()})}return s.notifyOnChangeProps?f:c.trackResult(f)}function f6(r,t){return gN(r,rN)}function h6(r,t){const e=sE(),[n]=Z.useState(()=>new oN(e,r));Z.useEffect(()=>{n.setOptions(r)},[n,r]);const a=Z.useSyncExternalStore(Z.useCallback(s=>n.subscribe(tn.batchCalls(s)),[n]),()=>n.getCurrentResult(),()=>n.getCurrentResult()),i=Z.useCallback((s,l)=>{n.mutate(s,l).catch(jg)},[n]);if(a.error&&lE(n.options.throwOnError,[a.error]))throw a.error;return{...a,mutate:i,mutateAsync:a.mutate}}var d6=function(){return null};const yN=(r,t,e,n)=>{var i,s,l,c;const a=[e,{code:t,...n||{}}];if((s=(i=r==null?void 0:r.services)==null?void 0:i.logger)!=null&&s.forward)return r.services.logger.forward(a,"warn","react-i18next::",!0);Qo(a[0])&&(a[0]=`react-i18next:: ${a[0]}`),(c=(l=r==null?void 0:r.services)==null?void 0:l.logger)!=null&&c.warn?r.services.logger.warn(...a):console!=null&&console.warn&&console.warn(...a)},x2={},Wg=(r,t,e,n)=>{Qo(e)&&x2[e]||(Qo(e)&&(x2[e]=new Date),yN(r,t,e,n))},cE=(r,t)=>()=>{if(r.isInitialized)t();else{const e=()=>{setTimeout(()=>{r.off("initialized",e)},0),t()};r.on("initialized",e)}},Gg=(r,t,e)=>{r.loadNamespaces(t,cE(r,e))},w2=(r,t,e,n)=>{if(Qo(e)&&(e=[e]),r.options.preload&&r.options.preload.indexOf(t)>-1)return Gg(r,e,n);e.forEach(a=>{r.options.ns.indexOf(a)<0&&r.options.ns.push(a)}),r.loadLanguages(t,cE(r,n))},bN=(r,t,e={})=>!t.languages||!t.languages.length?(Wg(t,"NO_LANGUAGES","i18n.languages were undefined or empty",{languages:t.languages}),!0):t.hasLoadedNamespace(r,{lng:e.lng,precheck:(n,a)=>{var i;if(((i=e.bindI18n)==null?void 0:i.indexOf("languageChanging"))>-1&&n.services.backendConnector.backend&&n.isLanguageChangingTo&&!a(n.isLanguageChangingTo,r))return!1}}),Qo=r=>typeof r=="string",xN=r=>typeof r=="object"&&r!==null,wN=/&(?:amp|#38|lt|#60|gt|#62|apos|#39|quot|#34|nbsp|#160|copy|#169|reg|#174|hellip|#8230|#x2F|#47);/g,_N={"&amp;":"&","&#38;":"&","&lt;":"<","&#60;":"<","&gt;":">","&#62;":">","&apos;":"'","&#39;":"'","&quot;":'"',"&#34;":'"',"&nbsp;":" ","&#160;":" ","&copy;":"©","&#169;":"©","&reg;":"®","&#174;":"®","&hellip;":"…","&#8230;":"…","&#x2F;":"/","&#47;":"/"},SN=r=>_N[r],EN=r=>r.replace(wN,SN);let qg={bindI18n:"languageChanged",bindI18nStore:"",transEmptyNodeValue:"",transSupportBasicHtmlNodes:!0,transWrapTextNodes:"",transKeepBasicHtmlNodesFor:["br","strong","i","p"],useSuspense:!0,unescape:EN};const CN=(r={})=>{qg={...qg,...r}},RN=()=>qg;let fE;const TN=r=>{fE=r},AN=()=>fE,p6={type:"3rdParty",init(r){CN(r.options.react),TN(r)}},hE=Z.createContext();class DN{constructor(){this.usedNamespaces={}}addUsedNamespaces(t){t.forEach(e=>{this.usedNamespaces[e]||(this.usedNamespaces[e]=!0)})}getUsedNamespaces(){return Object.keys(this.usedNamespaces)}}const kN=(r,t)=>{const e=Z.useRef();return Z.useEffect(()=>{e.current=r},[r,t]),e.current},dE=(r,t,e,n)=>r.getFixedT(t,e,n),ON=(r,t,e,n)=>Z.useCallback(dE(r,t,e,n),[r,t,e,n]),v6=(r,t={})=>{var R,T,D,k;const{i18n:e}=t,{i18n:n,defaultNS:a}=Z.useContext(hE)||{},i=e||n||AN();if(i&&!i.reportNamespaces&&(i.reportNamespaces=new DN),!i){Wg(i,"NO_I18NEXT_INSTANCE","useTranslation: You will need to pass in an i18next instance by using initReactI18next");const M=(I,z)=>Qo(z)?z:xN(z)&&Qo(z.defaultValue)?z.defaultValue:Array.isArray(I)?I[I.length-1]:I,N=[M,{},!1];return N.t=M,N.i18n={},N.ready=!1,N}(R=i.options.react)!=null&&R.wait&&Wg(i,"DEPRECATED_OPTION","useTranslation: It seems you are still using the old wait option, you may migrate to the new useSuspense behaviour.");const s={...RN(),...i.options.react,...t},{useSuspense:l,keyPrefix:c}=s;let f=a||((T=i.options)==null?void 0:T.defaultNS);f=Qo(f)?[f]:f||["translation"],(k=(D=i.reportNamespaces).addUsedNamespaces)==null||k.call(D,f);const d=(i.isInitialized||i.initializedStoreOnce)&&f.every(M=>bN(M,i,s)),v=ON(i,t.lng||null,s.nsMode==="fallback"?f:f[0],c),m=()=>v,g=()=>dE(i,t.lng||null,s.nsMode==="fallback"?f:f[0],c),[b,w]=Z.useState(m);let _=f.join();t.lng&&(_=`${t.lng}${_}`);const S=kN(_),E=Z.useRef(!0);Z.useEffect(()=>{const{bindI18n:M,bindI18nStore:N}=s;E.current=!0,!d&&!l&&(t.lng?w2(i,t.lng,f,()=>{E.current&&w(g)}):Gg(i,f,()=>{E.current&&w(g)})),d&&S&&S!==_&&E.current&&w(g);const I=()=>{E.current&&w(g)};return M&&(i==null||i.on(M,I)),N&&(i==null||i.store.on(N,I)),()=>{E.current=!1,i&&(M==null||M.split(" ").forEach(z=>i.off(z,I))),N&&i&&N.split(" ").forEach(z=>i.store.off(z,I))}},[i,_]),Z.useEffect(()=>{E.current&&d&&w(m)},[i,c,d]);const C=[b,i,d];if(C.t=b,C.i18n=i,C.ready=d,d||!d&&!l)return C;throw new Promise(M=>{t.lng?w2(i,t.lng,f,()=>M()):Gg(i,f,()=>M())})};function m6({i18n:r,defaultNS:t,children:e}){const n=Z.useMemo(()=>({i18n:r,defaultNS:t}),[r,t]);return Z.createElement(hE.Provider,{value:n},e)}function NN(r,t){if(r==null)return{};var e={};for(var n in r)if({}.hasOwnProperty.call(r,n)){if(t.indexOf(n)!==-1)continue;e[n]=r[n]}return e}function ad(){return ad=Object.assign?Object.assign.bind():function(r){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var n in e)({}).hasOwnProperty.call(e,n)&&(r[n]=e[n])}return r},ad.apply(null,arguments)}function Kg(r,t){return Kg=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,n){return e.__proto__=n,e},Kg(r,t)}function MN(r,t){r.prototype=Object.create(t.prototype),r.prototype.constructor=r,Kg(r,t)}function zm(r,t,e){if(e||arguments.length===2)for(var n=0,a=t.length,i;n<a;n++)(i||!(n in t))&&(i||(i=Array.prototype.slice.call(t,0,n)),i[n]=t[n]);return r.concat(i||Array.prototype.slice.call(t))}var Eh={};/*!
 * content-type
 * Copyright(c) 2015 Douglas Christopher Wilson
 * MIT Licensed
 */var _2;function IN(){if(_2)return Eh;_2=1;var r=/; *([!#$%&'*+.^_`|~0-9A-Za-z-]+) *= *("(?:[\u000b\u0020\u0021\u0023-\u005b\u005d-\u007e\u0080-\u00ff]|\\[\u000b\u0020-\u00ff])*"|[!#$%&'*+.^_`|~0-9A-Za-z-]+) */g,t=/^[\u000b\u0020-\u007e\u0080-\u00ff]+$/,e=/^[!#$%&'*+.^_`|~0-9A-Za-z-]+$/,n=/\\([\u000b\u0020-\u00ff])/g,a=/([\\"])/g,i=/^[!#$%&'*+.^_`|~0-9A-Za-z-]+\/[!#$%&'*+.^_`|~0-9A-Za-z-]+$/;Eh.format=s,Eh.parse=l;function s(v){if(!v||typeof v!="object")throw new TypeError("argument obj is required");var m=v.parameters,g=v.type;if(!g||!i.test(g))throw new TypeError("invalid type");var b=g;if(m&&typeof m=="object")for(var w,_=Object.keys(m).sort(),S=0;S<_.length;S++){if(w=_[S],!e.test(w))throw new TypeError("invalid parameter name");b+="; "+w+"="+f(m[w])}return b}function l(v){if(!v)throw new TypeError("argument string is required");var m=typeof v=="object"?c(v):v;if(typeof m!="string")throw new TypeError("argument string is required to be a string");var g=m.indexOf(";"),b=g!==-1?m.slice(0,g).trim():m.trim();if(!i.test(b))throw new TypeError("invalid media type");var w=new d(b.toLowerCase());if(g!==-1){var _,S,E;for(r.lastIndex=g;S=r.exec(m);){if(S.index!==g)throw new TypeError("invalid parameter format");g+=S[0].length,_=S[1].toLowerCase(),E=S[2],E.charCodeAt(0)===34&&(E=E.slice(1,-1),E.indexOf("\\")!==-1&&(E=E.replace(n,"$1"))),w.parameters[_]=E}if(g!==m.length)throw new TypeError("invalid parameter format")}return w}function c(v){var m;if(typeof v.getHeader=="function"?m=v.getHeader("content-type"):typeof v.headers=="object"&&(m=v.headers&&v.headers["content-type"]),typeof m!="string")throw new TypeError("content-type header is missing from object");return m}function f(v){var m=String(v);if(e.test(m))return m;if(m.length>0&&!t.test(m))throw new TypeError("invalid parameter value");return'"'+m.replace(a,"\\$1")+'"'}function d(v){this.parameters=Object.create(null),this.type=v}return Eh}var FN=IN(),ou=new Map,pE=function(t){return t.cloneNode(!0)},S2=function(){return window.location.protocol==="file:"},vE=function(t,e,n){var a=new XMLHttpRequest;a.onreadystatechange=function(){try{if(!/\.svg/i.test(t)&&a.readyState===2){var i=a.getResponseHeader("Content-Type");if(!i)throw new Error("Content type not found");var s=FN.parse(i).type;if(!(s==="image/svg+xml"||s==="text/plain"))throw new Error("Invalid content type: ".concat(s))}if(a.readyState===4){if(a.status===404||a.responseXML===null)throw new Error(S2()?"Note: SVG injection ajax calls do not work locally without adjusting security settings in your browser. Or consider using a local webserver.":"Unable to load SVG file: "+t);if(a.status===200||S2()&&a.status===0)n(null,a);else throw new Error("There was a problem injecting the SVG: "+a.status+" "+a.statusText)}}catch(l){if(a.abort(),l instanceof Error)n(l,a);else throw l}},a.open("GET",t),a.withCredentials=e,a.overrideMimeType&&a.overrideMimeType("text/xml"),a.send()},Wi={},E2=function(t,e){Wi[t]=Wi[t]||[],Wi[t].push(e)},BN=function(t){for(var e=function(s,l){setTimeout(function(){if(Array.isArray(Wi[t])){var c=ou.get(t),f=Wi[t][s];c instanceof SVGSVGElement&&f(null,pE(c)),c instanceof Error&&f(c),s===Wi[t].length-1&&delete Wi[t]}},0)},n=0,a=Wi[t].length;n<a;n++)e(n)},LN=function(t,e,n){if(ou.has(t)){var a=ou.get(t);if(a===void 0){E2(t,n);return}if(a instanceof SVGSVGElement){n(null,pE(a));return}}ou.set(t,void 0),E2(t,n),vE(t,e,function(i,s){var l;i?ou.set(t,i):((l=s.responseXML)===null||l===void 0?void 0:l.documentElement)instanceof SVGSVGElement&&ou.set(t,s.responseXML.documentElement),BN(t)})},PN=function(t,e,n){vE(t,e,function(a,i){var s;a?n(a):((s=i.responseXML)===null||s===void 0?void 0:s.documentElement)instanceof SVGSVGElement&&n(null,i.responseXML.documentElement)})},zN=0,UN=function(){return++zN},oa=[],C2={},VN="http://www.w3.org/2000/svg",Um="http://www.w3.org/1999/xlink",R2=function(t,e,n,a,i,s,l){var c=t.getAttribute("data-src")||t.getAttribute("src");if(!c){l(new Error("Invalid data-src or src attribute"));return}if(oa.indexOf(t)!==-1){oa.splice(oa.indexOf(t),1),t=null;return}oa.push(t),t.setAttribute("src","");var f=a?LN:PN;f(c,i,function(d,v){if(!v){oa.splice(oa.indexOf(t),1),t=null,l(d);return}var m=t.getAttribute("id");m&&v.setAttribute("id",m);var g=t.getAttribute("title");g&&v.setAttribute("title",g);var b=t.getAttribute("width");b&&v.setAttribute("width",b);var w=t.getAttribute("height");w&&v.setAttribute("height",w);var _=Array.from(new Set(zm(zm(zm([],(v.getAttribute("class")||"").split(" "),!0),["injected-svg"],!1),(t.getAttribute("class")||"").split(" "),!0))).join(" ").trim();v.setAttribute("class",_);var S=t.getAttribute("style");S&&v.setAttribute("style",S),v.setAttribute("data-src",c);var E=[].filter.call(t.attributes,function(X){return/^data-\w[\w-]*$/.test(X.name)});if(Array.prototype.forEach.call(E,function(X){X.name&&X.value&&v.setAttribute(X.name,X.value)}),n){var C={clipPath:["clip-path"],"color-profile":["color-profile"],cursor:["cursor"],filter:["filter"],linearGradient:["fill","stroke"],marker:["marker","marker-start","marker-mid","marker-end"],mask:["mask"],path:[],pattern:["fill","stroke"],radialGradient:["fill","stroke"]},R,T,D,k,M;Object.keys(C).forEach(function(X){R=X,D=C[X],T=v.querySelectorAll(R+"[id]");for(var J=function(ue,pe){k=T[ue].id,M=k+"-"+UN();var ge;Array.prototype.forEach.call(D,function(Je){ge=v.querySelectorAll("["+Je+'*="'+k+'"]');for(var dt=0,Et=ge.length;dt<Et;dt++){var xt=ge[dt].getAttribute(Je);xt&&!xt.match(new RegExp('url\\("?#'+k+'"?\\)'))||ge[dt].setAttribute(Je,"url(#"+M+")")}});for(var me=v.querySelectorAll("[*|href]"),Ne=[],xe=0,Ie=me.length;xe<Ie;xe++){var ct=me[xe].getAttributeNS(Um,"href");ct&&ct.toString()==="#"+T[ue].id&&Ne.push(me[xe])}for(var Pe=0,qe=Ne.length;Pe<qe;Pe++)Ne[Pe].setAttributeNS(Um,"href","#"+M);T[ue].id=M},F=0,K=T.length;F<K;F++)J(F)})}v.removeAttribute("xmlns:a");for(var N=v.querySelectorAll("script"),I=[],z,P,ne=0,re=N.length;ne<re;ne++)P=N[ne].getAttribute("type"),(!P||P==="application/ecmascript"||P==="application/javascript"||P==="text/javascript")&&(z=N[ne].innerText||N[ne].textContent,z&&I.push(z),v.removeChild(N[ne]));if(I.length>0&&(e==="always"||e==="once"&&!C2[c])){for(var ee=0,U=I.length;ee<U;ee++)new Function(I[ee])(window);C2[c]=!0}var G=v.querySelectorAll("style");if(Array.prototype.forEach.call(G,function(X){X.textContent+=""}),v.setAttribute("xmlns",VN),v.setAttribute("xmlns:xlink",Um),s(v),!t.parentNode){oa.splice(oa.indexOf(t),1),t=null,l(new Error("Parent node is null"));return}t.parentNode.replaceChild(v,t),oa.splice(oa.indexOf(t),1),t=null,l(null,v)})},HN=function(t,e){var n=e===void 0?{}:e,a=n.afterAll,i=a===void 0?function(){}:a,s=n.afterEach,l=s===void 0?function(){}:s,c=n.beforeEach,f=c===void 0?function(){}:c,d=n.cacheRequests,v=d===void 0?!0:d,m=n.evalScripts,g=m===void 0?"never":m,b=n.httpRequestWithCredentials,w=b===void 0?!1:b,_=n.renumerateIRIElements,S=_===void 0?!0:_;if(t&&"length"in t)for(var E=0,C=0,R=t.length;C<R;C++)R2(t[C],g,S,v,w,f,function(T,D){l(T,D),t&&"length"in t&&t.length===++E&&i(E)});else t?R2(t,g,S,v,w,f,function(T,D){l(T,D),i(1),t=null}):i(0)},Vm={exports:{}},Hm,T2;function jN(){if(T2)return Hm;T2=1;var r="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return Hm=r,Hm}var jm,A2;function WN(){if(A2)return jm;A2=1;var r=jN();function t(){}function e(){}return e.resetWarningCache=t,jm=function(){function n(s,l,c,f,d,v){if(v!==r){var m=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw m.name="Invariant Violation",m}}n.isRequired=n;function a(){return n}var i={array:n,bigint:n,bool:n,func:n,number:n,object:n,string:n,symbol:n,any:n,arrayOf:a,element:n,elementType:n,instanceOf:a,node:n,objectOf:a,oneOf:a,oneOfType:a,shape:a,exact:a,checkPropTypes:e,resetWarningCache:t};return i.PropTypes=i,i},jm}var D2;function GN(){return D2||(D2=1,Vm.exports=WN()()),Vm.exports}var Jt=GN(),qN=function(t){var e=(t==null?void 0:t.ownerDocument)||document;return e.defaultView||window},KN=function(t,e){for(var n in t)if(!(n in e))return!0;for(var a in e)if(t[a]!==e[a])return!0;return!1},XN=["afterInjection","beforeInjection","desc","evalScripts","fallback","httpRequestWithCredentials","loading","renumerateIRIElements","src","title","useRequestCache","wrapper"],Ch="http://www.w3.org/2000/svg",k2="http://www.w3.org/1999/xlink",mE=function(r){function t(){for(var n,a=arguments.length,i=new Array(a),s=0;s<a;s++)i[s]=arguments[s];return n=r.call.apply(r,[this].concat(i))||this,n.initialState={hasError:!1,isLoading:!0},n.state=n.initialState,n._isMounted=!1,n.reactWrapper=void 0,n.nonReactWrapper=void 0,n.refCallback=function(l){n.reactWrapper=l},n}MN(t,r);var e=t.prototype;return e.renderSVG=function(){var a=this;if(this.reactWrapper instanceof qN(this.reactWrapper).Node){var i=this.props,s=i.desc,l=i.evalScripts,c=i.httpRequestWithCredentials,f=i.renumerateIRIElements,d=i.src,v=i.title,m=i.useRequestCache,g=this.props.onError,b=this.props.beforeInjection,w=this.props.afterInjection,_=this.props.wrapper,S,E;_==="svg"?(S=document.createElementNS(Ch,_),S.setAttribute("xmlns",Ch),S.setAttribute("xmlns:xlink",k2),E=document.createElementNS(Ch,_)):(S=document.createElement(_),E=document.createElement(_)),S.appendChild(E),E.dataset.src=d,this.nonReactWrapper=this.reactWrapper.appendChild(S);var C=function(k){if(a.removeSVG(),!a._isMounted){g(k);return}a.setState(function(){return{hasError:!0,isLoading:!1}},function(){g(k)})},R=function(k,M){if(k){C(k);return}a._isMounted&&a.setState(function(){return{isLoading:!1}},function(){try{w(M)}catch(N){C(N)}})},T=function(k){if(k.setAttribute("role","img"),s){var M=k.querySelector(":scope > desc");M&&k.removeChild(M);var N=document.createElement("desc");N.innerHTML=s,k.prepend(N)}if(v){var I=k.querySelector(":scope > title");I&&k.removeChild(I);var z=document.createElement("title");z.innerHTML=v,k.prepend(z)}try{b(k)}catch(P){C(P)}};HN(E,{afterEach:R,beforeEach:T,cacheRequests:m,evalScripts:l,httpRequestWithCredentials:c,renumerateIRIElements:f})}},e.removeSVG=function(){var a;(a=this.nonReactWrapper)!=null&&a.parentNode&&(this.nonReactWrapper.parentNode.removeChild(this.nonReactWrapper),this.nonReactWrapper=null)},e.componentDidMount=function(){this._isMounted=!0,this.renderSVG()},e.componentDidUpdate=function(a){var i=this;KN(ad({},a),this.props)&&this.setState(function(){return i.initialState},function(){i.removeSVG(),i.renderSVG()})},e.componentWillUnmount=function(){this._isMounted=!1,this.removeSVG()},e.render=function(){var a=this.props;a.afterInjection,a.beforeInjection,a.desc,a.evalScripts;var i=a.fallback;a.httpRequestWithCredentials;var s=a.loading;a.renumerateIRIElements,a.src,a.title,a.useRequestCache;var l=a.wrapper,c=NN(a,XN),f=l;return Z.createElement(f,ad({},c,{ref:this.refCallback},l==="svg"?{xmlns:Ch,xmlnsXlink:k2}:{}),this.state.isLoading&&s&&Z.createElement(s,null),this.state.hasError&&i&&Z.createElement(i,null))},t}(Z.Component);mE.defaultProps={afterInjection:function(){},beforeInjection:function(){},desc:"",evalScripts:"never",fallback:null,httpRequestWithCredentials:!1,loading:null,onError:function(){},renumerateIRIElements:!0,title:"",useRequestCache:!0,wrapper:"div"};mE.propTypes={afterInjection:Jt.func,beforeInjection:Jt.func,desc:Jt.string,evalScripts:Jt.oneOf(["always","once","never"]),fallback:Jt.oneOfType([Jt.func,Jt.object,Jt.string]),httpRequestWithCredentials:Jt.bool,loading:Jt.oneOfType([Jt.func,Jt.object,Jt.string]),onError:Jt.func,renumerateIRIElements:Jt.bool,src:Jt.string.isRequired,title:Jt.string,useRequestCache:Jt.bool,wrapper:Jt.oneOf(["div","span","svg"])};const je=r=>typeof r=="string",tc=()=>{let r,t;const e=new Promise((n,a)=>{r=n,t=a});return e.resolve=r,e.reject=t,e},O2=r=>r==null?"":""+r,$N=(r,t,e)=>{r.forEach(n=>{t[n]&&(e[n]=t[n])})},YN=/###/g,N2=r=>r&&r.indexOf("###")>-1?r.replace(YN,"."):r,M2=r=>!r||je(r),hc=(r,t,e)=>{const n=je(t)?t.split("."):t;let a=0;for(;a<n.length-1;){if(M2(r))return{};const i=N2(n[a]);!r[i]&&e&&(r[i]=new e),Object.prototype.hasOwnProperty.call(r,i)?r=r[i]:r={},++a}return M2(r)?{}:{obj:r,k:N2(n[a])}},I2=(r,t,e)=>{const{obj:n,k:a}=hc(r,t,Object);if(n!==void 0||t.length===1){n[a]=e;return}let i=t[t.length-1],s=t.slice(0,t.length-1),l=hc(r,s,Object);for(;l.obj===void 0&&s.length;)i=`${s[s.length-1]}.${i}`,s=s.slice(0,s.length-1),l=hc(r,s,Object),l!=null&&l.obj&&typeof l.obj[`${l.k}.${i}`]<"u"&&(l.obj=void 0);l.obj[`${l.k}.${i}`]=e},ZN=(r,t,e,n)=>{const{obj:a,k:i}=hc(r,t,Object);a[i]=a[i]||[],a[i].push(e)},id=(r,t)=>{const{obj:e,k:n}=hc(r,t);if(e&&Object.prototype.hasOwnProperty.call(e,n))return e[n]},QN=(r,t,e)=>{const n=id(r,e);return n!==void 0?n:id(t,e)},gE=(r,t,e)=>{for(const n in t)n!=="__proto__"&&n!=="constructor"&&(n in r?je(r[n])||r[n]instanceof String||je(t[n])||t[n]instanceof String?e&&(r[n]=t[n]):gE(r[n],t[n],e):r[n]=t[n]);return r},eu=r=>r.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&");var JN={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};const e3=r=>je(r)?r.replace(/[&<>"'\/]/g,t=>JN[t]):r;class t3{constructor(t){this.capacity=t,this.regExpMap=new Map,this.regExpQueue=[]}getRegExp(t){const e=this.regExpMap.get(t);if(e!==void 0)return e;const n=new RegExp(t);return this.regExpQueue.length===this.capacity&&this.regExpMap.delete(this.regExpQueue.shift()),this.regExpMap.set(t,n),this.regExpQueue.push(t),n}}const n3=[" ",",","?","!",";"],r3=new t3(20),a3=(r,t,e)=>{t=t||"",e=e||"";const n=n3.filter(s=>t.indexOf(s)<0&&e.indexOf(s)<0);if(n.length===0)return!0;const a=r3.getRegExp(`(${n.map(s=>s==="?"?"\\?":s).join("|")})`);let i=!a.test(r);if(!i){const s=r.indexOf(e);s>0&&!a.test(r.substring(0,s))&&(i=!0)}return i},Xg=function(r,t){let e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:".";if(!r)return;if(r[t])return Object.prototype.hasOwnProperty.call(r,t)?r[t]:void 0;const n=t.split(e);let a=r;for(let i=0;i<n.length;){if(!a||typeof a!="object")return;let s,l="";for(let c=i;c<n.length;++c)if(c!==i&&(l+=e),l+=n[c],s=a[l],s!==void 0){if(["string","number","boolean"].indexOf(typeof s)>-1&&c<n.length-1)continue;i+=c-i+1;break}a=s}return a},od=r=>r==null?void 0:r.replace("_","-"),i3={type:"logger",log(r){this.output("log",r)},warn(r){this.output("warn",r)},error(r){this.output("error",r)},output(r,t){var e,n;(n=(e=console==null?void 0:console[r])==null?void 0:e.apply)==null||n.call(e,console,t)}};class sd{constructor(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.init(t,e)}init(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.prefix=e.prefix||"i18next:",this.logger=t||i3,this.options=e,this.debug=e.debug}log(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return this.forward(e,"log","",!0)}warn(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return this.forward(e,"warn","",!0)}error(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return this.forward(e,"error","")}deprecate(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return this.forward(e,"warn","WARNING DEPRECATED: ",!0)}forward(t,e,n,a){return a&&!this.debug?null:(je(t[0])&&(t[0]=`${n}${this.prefix} ${t[0]}`),this.logger[e](t))}create(t){return new sd(this.logger,{prefix:`${this.prefix}:${t}:`,...this.options})}clone(t){return t=t||this.options,t.prefix=t.prefix||this.prefix,new sd(this.logger,t)}}var ma=new sd;class qd{constructor(){this.observers={}}on(t,e){return t.split(" ").forEach(n=>{this.observers[n]||(this.observers[n]=new Map);const a=this.observers[n].get(e)||0;this.observers[n].set(e,a+1)}),this}off(t,e){if(this.observers[t]){if(!e){delete this.observers[t];return}this.observers[t].delete(e)}}emit(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),a=1;a<e;a++)n[a-1]=arguments[a];this.observers[t]&&Array.from(this.observers[t].entries()).forEach(s=>{let[l,c]=s;for(let f=0;f<c;f++)l(...n)}),this.observers["*"]&&Array.from(this.observers["*"].entries()).forEach(s=>{let[l,c]=s;for(let f=0;f<c;f++)l.apply(l,[t,...n])})}}class F2 extends qd{constructor(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{ns:["translation"],defaultNS:"translation"};super(),this.data=t||{},this.options=e,this.options.keySeparator===void 0&&(this.options.keySeparator="."),this.options.ignoreJSONStructure===void 0&&(this.options.ignoreJSONStructure=!0)}addNamespaces(t){this.options.ns.indexOf(t)<0&&this.options.ns.push(t)}removeNamespaces(t){const e=this.options.ns.indexOf(t);e>-1&&this.options.ns.splice(e,1)}getResource(t,e,n){var f,d;let a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};const i=a.keySeparator!==void 0?a.keySeparator:this.options.keySeparator,s=a.ignoreJSONStructure!==void 0?a.ignoreJSONStructure:this.options.ignoreJSONStructure;let l;t.indexOf(".")>-1?l=t.split("."):(l=[t,e],n&&(Array.isArray(n)?l.push(...n):je(n)&&i?l.push(...n.split(i)):l.push(n)));const c=id(this.data,l);return!c&&!e&&!n&&t.indexOf(".")>-1&&(t=l[0],e=l[1],n=l.slice(2).join(".")),c||!s||!je(n)?c:Xg((d=(f=this.data)==null?void 0:f[t])==null?void 0:d[e],n,i)}addResource(t,e,n,a){let i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{silent:!1};const s=i.keySeparator!==void 0?i.keySeparator:this.options.keySeparator;let l=[t,e];n&&(l=l.concat(s?n.split(s):n)),t.indexOf(".")>-1&&(l=t.split("."),a=e,e=l[1]),this.addNamespaces(e),I2(this.data,l,a),i.silent||this.emit("added",t,e,n,a)}addResources(t,e,n){let a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{silent:!1};for(const i in n)(je(n[i])||Array.isArray(n[i]))&&this.addResource(t,e,i,n[i],{silent:!0});a.silent||this.emit("added",t,e,n)}addResourceBundle(t,e,n,a,i){let s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:{silent:!1,skipCopy:!1},l=[t,e];t.indexOf(".")>-1&&(l=t.split("."),a=n,n=e,e=l[1]),this.addNamespaces(e);let c=id(this.data,l)||{};s.skipCopy||(n=JSON.parse(JSON.stringify(n))),a?gE(c,n,i):c={...c,...n},I2(this.data,l,c),s.silent||this.emit("added",t,e,n)}removeResourceBundle(t,e){this.hasResourceBundle(t,e)&&delete this.data[t][e],this.removeNamespaces(e),this.emit("removed",t,e)}hasResourceBundle(t,e){return this.getResource(t,e)!==void 0}getResourceBundle(t,e){return e||(e=this.options.defaultNS),this.getResource(t,e)}getDataByLanguage(t){return this.data[t]}hasLanguageSomeTranslations(t){const e=this.getDataByLanguage(t);return!!(e&&Object.keys(e)||[]).find(a=>e[a]&&Object.keys(e[a]).length>0)}toJSON(){return this.data}}var yE={processors:{},addPostProcessor(r){this.processors[r.name]=r},handle(r,t,e,n,a){return r.forEach(i=>{var s;t=((s=this.processors[i])==null?void 0:s.process(t,e,n,a))??t}),t}};const B2={},L2=r=>!je(r)&&typeof r!="boolean"&&typeof r!="number";class ud extends qd{constructor(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),$N(["resourceStore","languageUtils","pluralResolver","interpolator","backendConnector","i18nFormat","utils"],t,this),this.options=e,this.options.keySeparator===void 0&&(this.options.keySeparator="."),this.logger=ma.create("translator")}changeLanguage(t){t&&(this.language=t)}exists(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{interpolation:{}};if(t==null)return!1;const n=this.resolve(t,e);return(n==null?void 0:n.res)!==void 0}extractFromKey(t,e){let n=e.nsSeparator!==void 0?e.nsSeparator:this.options.nsSeparator;n===void 0&&(n=":");const a=e.keySeparator!==void 0?e.keySeparator:this.options.keySeparator;let i=e.ns||this.options.defaultNS||[];const s=n&&t.indexOf(n)>-1,l=!this.options.userDefinedKeySeparator&&!e.keySeparator&&!this.options.userDefinedNsSeparator&&!e.nsSeparator&&!a3(t,n,a);if(s&&!l){const c=t.match(this.interpolator.nestingRegexp);if(c&&c.length>0)return{key:t,namespaces:je(i)?[i]:i};const f=t.split(n);(n!==a||n===a&&this.options.ns.indexOf(f[0])>-1)&&(i=f.shift()),t=f.join(a)}return{key:t,namespaces:je(i)?[i]:i}}translate(t,e,n){if(typeof e!="object"&&this.options.overloadTranslationOptionHandler&&(e=this.options.overloadTranslationOptionHandler(arguments)),typeof options=="object"&&(e={...e}),e||(e={}),t==null)return"";Array.isArray(t)||(t=[String(t)]);const a=e.returnDetails!==void 0?e.returnDetails:this.options.returnDetails,i=e.keySeparator!==void 0?e.keySeparator:this.options.keySeparator,{key:s,namespaces:l}=this.extractFromKey(t[t.length-1],e),c=l[l.length-1],f=e.lng||this.language,d=e.appendNamespaceToCIMode||this.options.appendNamespaceToCIMode;if((f==null?void 0:f.toLowerCase())==="cimode"){if(d){const z=e.nsSeparator||this.options.nsSeparator;return a?{res:`${c}${z}${s}`,usedKey:s,exactUsedKey:s,usedLng:f,usedNS:c,usedParams:this.getUsedParamsDetails(e)}:`${c}${z}${s}`}return a?{res:s,usedKey:s,exactUsedKey:s,usedLng:f,usedNS:c,usedParams:this.getUsedParamsDetails(e)}:s}const v=this.resolve(t,e);let m=v==null?void 0:v.res;const g=(v==null?void 0:v.usedKey)||s,b=(v==null?void 0:v.exactUsedKey)||s,w=["[object Number]","[object Function]","[object RegExp]"],_=e.joinArrays!==void 0?e.joinArrays:this.options.joinArrays,S=!this.i18nFormat||this.i18nFormat.handleAsObject,E=e.count!==void 0&&!je(e.count),C=ud.hasDefaultValue(e),R=E?this.pluralResolver.getSuffix(f,e.count,e):"",T=e.ordinal&&E?this.pluralResolver.getSuffix(f,e.count,{ordinal:!1}):"",D=E&&!e.ordinal&&e.count===0,k=D&&e[`defaultValue${this.options.pluralSeparator}zero`]||e[`defaultValue${R}`]||e[`defaultValue${T}`]||e.defaultValue;let M=m;S&&!m&&C&&(M=k);const N=L2(M),I=Object.prototype.toString.apply(M);if(S&&M&&N&&w.indexOf(I)<0&&!(je(_)&&Array.isArray(M))){if(!e.returnObjects&&!this.options.returnObjects){this.options.returnedObjectHandler||this.logger.warn("accessing an object - but returnObjects options is not enabled!");const z=this.options.returnedObjectHandler?this.options.returnedObjectHandler(g,M,{...e,ns:l}):`key '${s} (${this.language})' returned an object instead of string.`;return a?(v.res=z,v.usedParams=this.getUsedParamsDetails(e),v):z}if(i){const z=Array.isArray(M),P=z?[]:{},ne=z?b:g;for(const re in M)if(Object.prototype.hasOwnProperty.call(M,re)){const ee=`${ne}${i}${re}`;C&&!m?P[re]=this.translate(ee,{...e,defaultValue:L2(k)?k[re]:void 0,joinArrays:!1,ns:l}):P[re]=this.translate(ee,{...e,joinArrays:!1,ns:l}),P[re]===ee&&(P[re]=M[re])}m=P}}else if(S&&je(_)&&Array.isArray(m))m=m.join(_),m&&(m=this.extendTranslation(m,t,e,n));else{let z=!1,P=!1;!this.isValidLookup(m)&&C&&(z=!0,m=k),this.isValidLookup(m)||(P=!0,m=s);const re=(e.missingKeyNoValueFallbackToKey||this.options.missingKeyNoValueFallbackToKey)&&P?void 0:m,ee=C&&k!==m&&this.options.updateMissing;if(P||z||ee){if(this.logger.log(ee?"updateKey":"missingKey",f,c,s,ee?k:m),i){const J=this.resolve(s,{...e,keySeparator:!1});J&&J.res&&this.logger.warn("Seems the loaded translations were in flat JSON format instead of nested. Either set keySeparator: false on init or make sure your translations are published in nested format.")}let U=[];const G=this.languageUtils.getFallbackCodes(this.options.fallbackLng,e.lng||this.language);if(this.options.saveMissingTo==="fallback"&&G&&G[0])for(let J=0;J<G.length;J++)U.push(G[J]);else this.options.saveMissingTo==="all"?U=this.languageUtils.toResolveHierarchy(e.lng||this.language):U.push(e.lng||this.language);const X=(J,F,K)=>{var ue;const oe=C&&K!==m?K:re;this.options.missingKeyHandler?this.options.missingKeyHandler(J,c,F,oe,ee,e):(ue=this.backendConnector)!=null&&ue.saveMissing&&this.backendConnector.saveMissing(J,c,F,oe,ee,e),this.emit("missingKey",J,c,F,m)};this.options.saveMissing&&(this.options.saveMissingPlurals&&E?U.forEach(J=>{const F=this.pluralResolver.getSuffixes(J,e);D&&e[`defaultValue${this.options.pluralSeparator}zero`]&&F.indexOf(`${this.options.pluralSeparator}zero`)<0&&F.push(`${this.options.pluralSeparator}zero`),F.forEach(K=>{X([J],s+K,e[`defaultValue${K}`]||k)})}):X(U,s,k))}m=this.extendTranslation(m,t,e,v,n),P&&m===s&&this.options.appendNamespaceToMissingKey&&(m=`${c}:${s}`),(P||z)&&this.options.parseMissingKeyHandler&&(m=this.options.parseMissingKeyHandler(this.options.appendNamespaceToMissingKey?`${c}:${s}`:s,z?m:void 0))}return a?(v.res=m,v.usedParams=this.getUsedParamsDetails(e),v):m}extendTranslation(t,e,n,a,i){var f,d;var s=this;if((f=this.i18nFormat)!=null&&f.parse)t=this.i18nFormat.parse(t,{...this.options.interpolation.defaultVariables,...n},n.lng||this.language||a.usedLng,a.usedNS,a.usedKey,{resolved:a});else if(!n.skipInterpolation){n.interpolation&&this.interpolator.init({...n,interpolation:{...this.options.interpolation,...n.interpolation}});const v=je(t)&&(((d=n==null?void 0:n.interpolation)==null?void 0:d.skipOnVariables)!==void 0?n.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables);let m;if(v){const b=t.match(this.interpolator.nestingRegexp);m=b&&b.length}let g=n.replace&&!je(n.replace)?n.replace:n;if(this.options.interpolation.defaultVariables&&(g={...this.options.interpolation.defaultVariables,...g}),t=this.interpolator.interpolate(t,g,n.lng||this.language||a.usedLng,n),v){const b=t.match(this.interpolator.nestingRegexp),w=b&&b.length;m<w&&(n.nest=!1)}!n.lng&&a&&a.res&&(n.lng=this.language||a.usedLng),n.nest!==!1&&(t=this.interpolator.nest(t,function(){for(var b=arguments.length,w=new Array(b),_=0;_<b;_++)w[_]=arguments[_];return(i==null?void 0:i[0])===w[0]&&!n.context?(s.logger.warn(`It seems you are nesting recursively key: ${w[0]} in key: ${e[0]}`),null):s.translate(...w,e)},n)),n.interpolation&&this.interpolator.reset()}const l=n.postProcess||this.options.postProcess,c=je(l)?[l]:l;return t!=null&&(c!=null&&c.length)&&n.applyPostProcessor!==!1&&(t=yE.handle(c,t,e,this.options&&this.options.postProcessPassResolved?{i18nResolved:{...a,usedParams:this.getUsedParamsDetails(n)},...n}:n,this)),t}resolve(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n,a,i,s,l;return je(t)&&(t=[t]),t.forEach(c=>{if(this.isValidLookup(n))return;const f=this.extractFromKey(c,e),d=f.key;a=d;let v=f.namespaces;this.options.fallbackNS&&(v=v.concat(this.options.fallbackNS));const m=e.count!==void 0&&!je(e.count),g=m&&!e.ordinal&&e.count===0,b=e.context!==void 0&&(je(e.context)||typeof e.context=="number")&&e.context!=="",w=e.lngs?e.lngs:this.languageUtils.toResolveHierarchy(e.lng||this.language,e.fallbackLng);v.forEach(_=>{var S,E;this.isValidLookup(n)||(l=_,!B2[`${w[0]}-${_}`]&&((S=this.utils)!=null&&S.hasLoadedNamespace)&&!((E=this.utils)!=null&&E.hasLoadedNamespace(l))&&(B2[`${w[0]}-${_}`]=!0,this.logger.warn(`key "${a}" for languages "${w.join(", ")}" won't get resolved as namespace "${l}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!")),w.forEach(C=>{var D;if(this.isValidLookup(n))return;s=C;const R=[d];if((D=this.i18nFormat)!=null&&D.addLookupKeys)this.i18nFormat.addLookupKeys(R,d,C,_,e);else{let k;m&&(k=this.pluralResolver.getSuffix(C,e.count,e));const M=`${this.options.pluralSeparator}zero`,N=`${this.options.pluralSeparator}ordinal${this.options.pluralSeparator}`;if(m&&(R.push(d+k),e.ordinal&&k.indexOf(N)===0&&R.push(d+k.replace(N,this.options.pluralSeparator)),g&&R.push(d+M)),b){const I=`${d}${this.options.contextSeparator}${e.context}`;R.push(I),m&&(R.push(I+k),e.ordinal&&k.indexOf(N)===0&&R.push(I+k.replace(N,this.options.pluralSeparator)),g&&R.push(I+M))}}let T;for(;T=R.pop();)this.isValidLookup(n)||(i=T,n=this.getResource(C,_,T,e))}))})}),{res:n,usedKey:a,exactUsedKey:i,usedLng:s,usedNS:l}}isValidLookup(t){return t!==void 0&&!(!this.options.returnNull&&t===null)&&!(!this.options.returnEmptyString&&t==="")}getResource(t,e,n){var i;let a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};return(i=this.i18nFormat)!=null&&i.getResource?this.i18nFormat.getResource(t,e,n,a):this.resourceStore.getResource(t,e,n,a)}getUsedParamsDetails(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=["defaultValue","ordinal","context","replace","lng","lngs","fallbackLng","ns","keySeparator","nsSeparator","returnObjects","returnDetails","joinArrays","postProcess","interpolation"],n=t.replace&&!je(t.replace);let a=n?t.replace:t;if(n&&typeof t.count<"u"&&(a.count=t.count),this.options.interpolation.defaultVariables&&(a={...this.options.interpolation.defaultVariables,...a}),!n){a={...a};for(const i of e)delete a[i]}return a}static hasDefaultValue(t){const e="defaultValue";for(const n in t)if(Object.prototype.hasOwnProperty.call(t,n)&&e===n.substring(0,e.length)&&t[n]!==void 0)return!0;return!1}}class P2{constructor(t){this.options=t,this.supportedLngs=this.options.supportedLngs||!1,this.logger=ma.create("languageUtils")}getScriptPartFromCode(t){if(t=od(t),!t||t.indexOf("-")<0)return null;const e=t.split("-");return e.length===2||(e.pop(),e[e.length-1].toLowerCase()==="x")?null:this.formatLanguageCode(e.join("-"))}getLanguagePartFromCode(t){if(t=od(t),!t||t.indexOf("-")<0)return t;const e=t.split("-");return this.formatLanguageCode(e[0])}formatLanguageCode(t){if(je(t)&&t.indexOf("-")>-1){let e;try{e=Intl.getCanonicalLocales(t)[0]}catch{}return e&&this.options.lowerCaseLng&&(e=e.toLowerCase()),e||(this.options.lowerCaseLng?t.toLowerCase():t)}return this.options.cleanCode||this.options.lowerCaseLng?t.toLowerCase():t}isSupportedCode(t){return(this.options.load==="languageOnly"||this.options.nonExplicitSupportedLngs)&&(t=this.getLanguagePartFromCode(t)),!this.supportedLngs||!this.supportedLngs.length||this.supportedLngs.indexOf(t)>-1}getBestMatchFromCodes(t){if(!t)return null;let e;return t.forEach(n=>{if(e)return;const a=this.formatLanguageCode(n);(!this.options.supportedLngs||this.isSupportedCode(a))&&(e=a)}),!e&&this.options.supportedLngs&&t.forEach(n=>{if(e)return;const a=this.getScriptPartFromCode(n);if(this.isSupportedCode(a))return e=a;const i=this.getLanguagePartFromCode(n);if(this.isSupportedCode(i))return e=i;e=this.options.supportedLngs.find(s=>{if(s===i)return s;if(!(s.indexOf("-")<0&&i.indexOf("-")<0)&&(s.indexOf("-")>0&&i.indexOf("-")<0&&s.substring(0,s.indexOf("-"))===i||s.indexOf(i)===0&&i.length>1))return s})}),e||(e=this.getFallbackCodes(this.options.fallbackLng)[0]),e}getFallbackCodes(t,e){if(!t)return[];if(typeof t=="function"&&(t=t(e)),je(t)&&(t=[t]),Array.isArray(t))return t;if(!e)return t.default||[];let n=t[e];return n||(n=t[this.getScriptPartFromCode(e)]),n||(n=t[this.formatLanguageCode(e)]),n||(n=t[this.getLanguagePartFromCode(e)]),n||(n=t.default),n||[]}toResolveHierarchy(t,e){const n=this.getFallbackCodes(e||this.options.fallbackLng||[],t),a=[],i=s=>{s&&(this.isSupportedCode(s)?a.push(s):this.logger.warn(`rejecting language code not found in supportedLngs: ${s}`))};return je(t)&&(t.indexOf("-")>-1||t.indexOf("_")>-1)?(this.options.load!=="languageOnly"&&i(this.formatLanguageCode(t)),this.options.load!=="languageOnly"&&this.options.load!=="currentOnly"&&i(this.getScriptPartFromCode(t)),this.options.load!=="currentOnly"&&i(this.getLanguagePartFromCode(t))):je(t)&&i(this.formatLanguageCode(t)),n.forEach(s=>{a.indexOf(s)<0&&i(this.formatLanguageCode(s))}),a}}const z2={zero:0,one:1,two:2,few:3,many:4,other:5},U2={select:r=>r===1?"one":"other",resolvedOptions:()=>({pluralCategories:["one","other"]})};class o3{constructor(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.languageUtils=t,this.options=e,this.logger=ma.create("pluralResolver"),this.pluralRulesCache={}}addRule(t,e){this.rules[t]=e}clearCache(){this.pluralRulesCache={}}getRule(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=od(t==="dev"?"en":t),a=e.ordinal?"ordinal":"cardinal",i=JSON.stringify({cleanedCode:n,type:a});if(i in this.pluralRulesCache)return this.pluralRulesCache[i];let s;try{s=new Intl.PluralRules(n,{type:a})}catch{if(!Intl)return this.logger.error("No Intl support, please use an Intl polyfill!"),U2;if(!t.match(/-|_/))return U2;const c=this.languageUtils.getLanguagePartFromCode(t);s=this.getRule(c,e)}return this.pluralRulesCache[i]=s,s}needsPlural(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=this.getRule(t,e);return n||(n=this.getRule("dev",e)),(n==null?void 0:n.resolvedOptions().pluralCategories.length)>1}getPluralFormsOfKey(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return this.getSuffixes(t,n).map(a=>`${e}${a}`)}getSuffixes(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=this.getRule(t,e);return n||(n=this.getRule("dev",e)),n?n.resolvedOptions().pluralCategories.sort((a,i)=>z2[a]-z2[i]).map(a=>`${this.options.prepend}${e.ordinal?`ordinal${this.options.prepend}`:""}${a}`):[]}getSuffix(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const a=this.getRule(t,n);return a?`${this.options.prepend}${n.ordinal?`ordinal${this.options.prepend}`:""}${a.select(e)}`:(this.logger.warn(`no plural rule found for: ${t}`),this.getSuffix("dev",e,n))}}const V2=function(r,t,e){let n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:".",a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,i=QN(r,t,e);return!i&&a&&je(e)&&(i=Xg(r,e,n),i===void 0&&(i=Xg(t,e,n))),i},Wm=r=>r.replace(/\$/g,"$$$$");class s3{constructor(){var e;let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.logger=ma.create("interpolator"),this.options=t,this.format=((e=t==null?void 0:t.interpolation)==null?void 0:e.format)||(n=>n),this.init(t)}init(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};t.interpolation||(t.interpolation={escapeValue:!0});const{escape:e,escapeValue:n,useRawValueToEscape:a,prefix:i,prefixEscaped:s,suffix:l,suffixEscaped:c,formatSeparator:f,unescapeSuffix:d,unescapePrefix:v,nestingPrefix:m,nestingPrefixEscaped:g,nestingSuffix:b,nestingSuffixEscaped:w,nestingOptionsSeparator:_,maxReplaces:S,alwaysFormat:E}=t.interpolation;this.escape=e!==void 0?e:e3,this.escapeValue=n!==void 0?n:!0,this.useRawValueToEscape=a!==void 0?a:!1,this.prefix=i?eu(i):s||"{{",this.suffix=l?eu(l):c||"}}",this.formatSeparator=f||",",this.unescapePrefix=d?"":v||"-",this.unescapeSuffix=this.unescapePrefix?"":d||"",this.nestingPrefix=m?eu(m):g||eu("$t("),this.nestingSuffix=b?eu(b):w||eu(")"),this.nestingOptionsSeparator=_||",",this.maxReplaces=S||1e3,this.alwaysFormat=E!==void 0?E:!1,this.resetRegExp()}reset(){this.options&&this.init(this.options)}resetRegExp(){const t=(e,n)=>(e==null?void 0:e.source)===n?(e.lastIndex=0,e):new RegExp(n,"g");this.regexp=t(this.regexp,`${this.prefix}(.+?)${this.suffix}`),this.regexpUnescape=t(this.regexpUnescape,`${this.prefix}${this.unescapePrefix}(.+?)${this.unescapeSuffix}${this.suffix}`),this.nestingRegexp=t(this.nestingRegexp,`${this.nestingPrefix}(.+?)${this.nestingSuffix}`)}interpolate(t,e,n,a){var g;let i,s,l;const c=this.options&&this.options.interpolation&&this.options.interpolation.defaultVariables||{},f=b=>{if(b.indexOf(this.formatSeparator)<0){const E=V2(e,c,b,this.options.keySeparator,this.options.ignoreJSONStructure);return this.alwaysFormat?this.format(E,void 0,n,{...a,...e,interpolationkey:b}):E}const w=b.split(this.formatSeparator),_=w.shift().trim(),S=w.join(this.formatSeparator).trim();return this.format(V2(e,c,_,this.options.keySeparator,this.options.ignoreJSONStructure),S,n,{...a,...e,interpolationkey:_})};this.resetRegExp();const d=(a==null?void 0:a.missingInterpolationHandler)||this.options.missingInterpolationHandler,v=((g=a==null?void 0:a.interpolation)==null?void 0:g.skipOnVariables)!==void 0?a.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables;return[{regex:this.regexpUnescape,safeValue:b=>Wm(b)},{regex:this.regexp,safeValue:b=>this.escapeValue?Wm(this.escape(b)):Wm(b)}].forEach(b=>{for(l=0;i=b.regex.exec(t);){const w=i[1].trim();if(s=f(w),s===void 0)if(typeof d=="function"){const S=d(t,i,a);s=je(S)?S:""}else if(a&&Object.prototype.hasOwnProperty.call(a,w))s="";else if(v){s=i[0];continue}else this.logger.warn(`missed to pass in variable ${w} for interpolating ${t}`),s="";else!je(s)&&!this.useRawValueToEscape&&(s=O2(s));const _=b.safeValue(s);if(t=t.replace(i[0],_),v?(b.regex.lastIndex+=s.length,b.regex.lastIndex-=i[0].length):b.regex.lastIndex=0,l++,l>=this.maxReplaces)break}}),t}nest(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},a,i,s;const l=(c,f)=>{const d=this.nestingOptionsSeparator;if(c.indexOf(d)<0)return c;const v=c.split(new RegExp(`${d}[ ]*{`));let m=`{${v[1]}`;c=v[0],m=this.interpolate(m,s);const g=m.match(/'/g),b=m.match(/"/g);(((g==null?void 0:g.length)??0)%2===0&&!b||b.length%2!==0)&&(m=m.replace(/'/g,'"'));try{s=JSON.parse(m),f&&(s={...f,...s})}catch(w){return this.logger.warn(`failed parsing options string in nesting for key ${c}`,w),`${c}${d}${m}`}return s.defaultValue&&s.defaultValue.indexOf(this.prefix)>-1&&delete s.defaultValue,c};for(;a=this.nestingRegexp.exec(t);){let c=[];s={...n},s=s.replace&&!je(s.replace)?s.replace:s,s.applyPostProcessor=!1,delete s.defaultValue;let f=!1;if(a[0].indexOf(this.formatSeparator)!==-1&&!/{.*}/.test(a[1])){const d=a[1].split(this.formatSeparator).map(v=>v.trim());a[1]=d.shift(),c=d,f=!0}if(i=e(l.call(this,a[1].trim(),s),s),i&&a[0]===t&&!je(i))return i;je(i)||(i=O2(i)),i||(this.logger.warn(`missed to resolve ${a[1]} for nesting ${t}`),i=""),f&&(i=c.reduce((d,v)=>this.format(d,v,n.lng,{...n,interpolationkey:a[1].trim()}),i.trim())),t=t.replace(a[0],i),this.regexp.lastIndex=0}return t}}const u3=r=>{let t=r.toLowerCase().trim();const e={};if(r.indexOf("(")>-1){const n=r.split("(");t=n[0].toLowerCase().trim();const a=n[1].substring(0,n[1].length-1);t==="currency"&&a.indexOf(":")<0?e.currency||(e.currency=a.trim()):t==="relativetime"&&a.indexOf(":")<0?e.range||(e.range=a.trim()):a.split(";").forEach(s=>{if(s){const[l,...c]=s.split(":"),f=c.join(":").trim().replace(/^'+|'+$/g,""),d=l.trim();e[d]||(e[d]=f),f==="false"&&(e[d]=!1),f==="true"&&(e[d]=!0),isNaN(f)||(e[d]=parseInt(f,10))}})}return{formatName:t,formatOptions:e}},tu=r=>{const t={};return(e,n,a)=>{let i=a;a&&a.interpolationkey&&a.formatParams&&a.formatParams[a.interpolationkey]&&a[a.interpolationkey]&&(i={...i,[a.interpolationkey]:void 0});const s=n+JSON.stringify(i);let l=t[s];return l||(l=r(od(n),a),t[s]=l),l(e)}};class l3{constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.logger=ma.create("formatter"),this.options=t,this.formats={number:tu((e,n)=>{const a=new Intl.NumberFormat(e,{...n});return i=>a.format(i)}),currency:tu((e,n)=>{const a=new Intl.NumberFormat(e,{...n,style:"currency"});return i=>a.format(i)}),datetime:tu((e,n)=>{const a=new Intl.DateTimeFormat(e,{...n});return i=>a.format(i)}),relativetime:tu((e,n)=>{const a=new Intl.RelativeTimeFormat(e,{...n});return i=>a.format(i,n.range||"day")}),list:tu((e,n)=>{const a=new Intl.ListFormat(e,{...n});return i=>a.format(i)})},this.init(t)}init(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{interpolation:{}};this.formatSeparator=e.interpolation.formatSeparator||","}add(t,e){this.formats[t.toLowerCase().trim()]=e}addCached(t,e){this.formats[t.toLowerCase().trim()]=tu(e)}format(t,e,n){let a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};const i=e.split(this.formatSeparator);if(i.length>1&&i[0].indexOf("(")>1&&i[0].indexOf(")")<0&&i.find(l=>l.indexOf(")")>-1)){const l=i.findIndex(c=>c.indexOf(")")>-1);i[0]=[i[0],...i.splice(1,l)].join(this.formatSeparator)}return i.reduce((l,c)=>{var v;const{formatName:f,formatOptions:d}=u3(c);if(this.formats[f]){let m=l;try{const g=((v=a==null?void 0:a.formatParams)==null?void 0:v[a.interpolationkey])||{},b=g.locale||g.lng||a.locale||a.lng||n;m=this.formats[f](l,b,{...d,...a,...g})}catch(g){this.logger.warn(g)}return m}else this.logger.warn(`there was no format function for ${f}`);return l},t)}}const c3=(r,t)=>{r.pending[t]!==void 0&&(delete r.pending[t],r.pendingCount--)};class f3 extends qd{constructor(t,e,n){var i,s;let a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};super(),this.backend=t,this.store=e,this.services=n,this.languageUtils=n.languageUtils,this.options=a,this.logger=ma.create("backendConnector"),this.waitingReads=[],this.maxParallelReads=a.maxParallelReads||10,this.readingCalls=0,this.maxRetries=a.maxRetries>=0?a.maxRetries:5,this.retryTimeout=a.retryTimeout>=1?a.retryTimeout:350,this.state={},this.queue=[],(s=(i=this.backend)==null?void 0:i.init)==null||s.call(i,n,a.backend,a)}queueLoad(t,e,n,a){const i={},s={},l={},c={};return t.forEach(f=>{let d=!0;e.forEach(v=>{const m=`${f}|${v}`;!n.reload&&this.store.hasResourceBundle(f,v)?this.state[m]=2:this.state[m]<0||(this.state[m]===1?s[m]===void 0&&(s[m]=!0):(this.state[m]=1,d=!1,s[m]===void 0&&(s[m]=!0),i[m]===void 0&&(i[m]=!0),c[v]===void 0&&(c[v]=!0)))}),d||(l[f]=!0)}),(Object.keys(i).length||Object.keys(s).length)&&this.queue.push({pending:s,pendingCount:Object.keys(s).length,loaded:{},errors:[],callback:a}),{toLoad:Object.keys(i),pending:Object.keys(s),toLoadLanguages:Object.keys(l),toLoadNamespaces:Object.keys(c)}}loaded(t,e,n){const a=t.split("|"),i=a[0],s=a[1];e&&this.emit("failedLoading",i,s,e),!e&&n&&this.store.addResourceBundle(i,s,n,void 0,void 0,{skipCopy:!0}),this.state[t]=e?-1:2,e&&n&&(this.state[t]=0);const l={};this.queue.forEach(c=>{ZN(c.loaded,[i],s),c3(c,t),e&&c.errors.push(e),c.pendingCount===0&&!c.done&&(Object.keys(c.loaded).forEach(f=>{l[f]||(l[f]={});const d=c.loaded[f];d.length&&d.forEach(v=>{l[f][v]===void 0&&(l[f][v]=!0)})}),c.done=!0,c.errors.length?c.callback(c.errors):c.callback())}),this.emit("loaded",l),this.queue=this.queue.filter(c=>!c.done)}read(t,e,n){let a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:this.retryTimeout,s=arguments.length>5?arguments[5]:void 0;if(!t.length)return s(null,{});if(this.readingCalls>=this.maxParallelReads){this.waitingReads.push({lng:t,ns:e,fcName:n,tried:a,wait:i,callback:s});return}this.readingCalls++;const l=(f,d)=>{if(this.readingCalls--,this.waitingReads.length>0){const v=this.waitingReads.shift();this.read(v.lng,v.ns,v.fcName,v.tried,v.wait,v.callback)}if(f&&d&&a<this.maxRetries){setTimeout(()=>{this.read.call(this,t,e,n,a+1,i*2,s)},i);return}s(f,d)},c=this.backend[n].bind(this.backend);if(c.length===2){try{const f=c(t,e);f&&typeof f.then=="function"?f.then(d=>l(null,d)).catch(l):l(null,f)}catch(f){l(f)}return}return c(t,e,l)}prepareLoading(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},a=arguments.length>3?arguments[3]:void 0;if(!this.backend)return this.logger.warn("No backend was added via i18next.use. Will not load resources."),a&&a();je(t)&&(t=this.languageUtils.toResolveHierarchy(t)),je(e)&&(e=[e]);const i=this.queueLoad(t,e,n,a);if(!i.toLoad.length)return i.pending.length||a(),null;i.toLoad.forEach(s=>{this.loadOne(s)})}load(t,e,n){this.prepareLoading(t,e,{},n)}reload(t,e,n){this.prepareLoading(t,e,{reload:!0},n)}loadOne(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";const n=t.split("|"),a=n[0],i=n[1];this.read(a,i,"read",void 0,void 0,(s,l)=>{s&&this.logger.warn(`${e}loading namespace ${i} for language ${a} failed`,s),!s&&l&&this.logger.log(`${e}loaded namespace ${i} for language ${a}`,l),this.loaded(t,s,l)})}saveMissing(t,e,n,a,i){var c,f,d,v,m;let s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:{},l=arguments.length>6&&arguments[6]!==void 0?arguments[6]:()=>{};if((f=(c=this.services)==null?void 0:c.utils)!=null&&f.hasLoadedNamespace&&!((v=(d=this.services)==null?void 0:d.utils)!=null&&v.hasLoadedNamespace(e))){this.logger.warn(`did not save key "${n}" as the namespace "${e}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!");return}if(!(n==null||n==="")){if((m=this.backend)!=null&&m.create){const g={...s,isUpdate:i},b=this.backend.create.bind(this.backend);if(b.length<6)try{let w;b.length===5?w=b(t,e,n,a,g):w=b(t,e,n,a),w&&typeof w.then=="function"?w.then(_=>l(null,_)).catch(l):l(null,w)}catch(w){l(w)}else b(t,e,n,a,l,g)}!t||!t[0]||this.store.addResource(t[0],e,n,a)}}}const H2=()=>({debug:!1,initAsync:!0,ns:["translation"],defaultNS:["translation"],fallbackLng:["dev"],fallbackNS:!1,supportedLngs:!1,nonExplicitSupportedLngs:!1,load:"all",preload:!1,simplifyPluralSuffix:!0,keySeparator:".",nsSeparator:":",pluralSeparator:"_",contextSeparator:"_",partialBundledLanguages:!1,saveMissing:!1,updateMissing:!1,saveMissingTo:"fallback",saveMissingPlurals:!0,missingKeyHandler:!1,missingInterpolationHandler:!1,postProcess:!1,postProcessPassResolved:!1,returnNull:!1,returnEmptyString:!0,returnObjects:!1,joinArrays:!1,returnedObjectHandler:!1,parseMissingKeyHandler:!1,appendNamespaceToMissingKey:!1,appendNamespaceToCIMode:!1,overloadTranslationOptionHandler:r=>{let t={};if(typeof r[1]=="object"&&(t=r[1]),je(r[1])&&(t.defaultValue=r[1]),je(r[2])&&(t.tDescription=r[2]),typeof r[2]=="object"||typeof r[3]=="object"){const e=r[3]||r[2];Object.keys(e).forEach(n=>{t[n]=e[n]})}return t},interpolation:{escapeValue:!0,format:r=>r,prefix:"{{",suffix:"}}",formatSeparator:",",unescapePrefix:"-",nestingPrefix:"$t(",nestingSuffix:")",nestingOptionsSeparator:",",maxReplaces:1e3,skipOnVariables:!0}}),j2=r=>{var t,e;return je(r.ns)&&(r.ns=[r.ns]),je(r.fallbackLng)&&(r.fallbackLng=[r.fallbackLng]),je(r.fallbackNS)&&(r.fallbackNS=[r.fallbackNS]),((e=(t=r.supportedLngs)==null?void 0:t.indexOf)==null?void 0:e.call(t,"cimode"))<0&&(r.supportedLngs=r.supportedLngs.concat(["cimode"])),typeof r.initImmediate=="boolean"&&(r.initAsync=r.initImmediate),r},Rh=()=>{},h3=r=>{Object.getOwnPropertyNames(Object.getPrototypeOf(r)).forEach(e=>{typeof r[e]=="function"&&(r[e]=r[e].bind(r))})};class bc extends qd{constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=arguments.length>1?arguments[1]:void 0;if(super(),this.options=j2(t),this.services={},this.logger=ma,this.modules={external:[]},h3(this),e&&!this.isInitialized&&!t.isClone){if(!this.options.initAsync)return this.init(t,e),this;setTimeout(()=>{this.init(t,e)},0)}}init(){var t=this;let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=arguments.length>1?arguments[1]:void 0;this.isInitializing=!0,typeof e=="function"&&(n=e,e={}),e.defaultNS==null&&e.ns&&(je(e.ns)?e.defaultNS=e.ns:e.ns.indexOf("translation")<0&&(e.defaultNS=e.ns[0]));const a=H2();this.options={...a,...this.options,...j2(e)},this.options.interpolation={...a.interpolation,...this.options.interpolation},e.keySeparator!==void 0&&(this.options.userDefinedKeySeparator=e.keySeparator),e.nsSeparator!==void 0&&(this.options.userDefinedNsSeparator=e.nsSeparator);const i=d=>d?typeof d=="function"?new d:d:null;if(!this.options.isClone){this.modules.logger?ma.init(i(this.modules.logger),this.options):ma.init(null,this.options);let d;this.modules.formatter?d=this.modules.formatter:d=l3;const v=new P2(this.options);this.store=new F2(this.options.resources,this.options);const m=this.services;m.logger=ma,m.resourceStore=this.store,m.languageUtils=v,m.pluralResolver=new o3(v,{prepend:this.options.pluralSeparator,simplifyPluralSuffix:this.options.simplifyPluralSuffix}),d&&(!this.options.interpolation.format||this.options.interpolation.format===a.interpolation.format)&&(m.formatter=i(d),m.formatter.init(m,this.options),this.options.interpolation.format=m.formatter.format.bind(m.formatter)),m.interpolator=new s3(this.options),m.utils={hasLoadedNamespace:this.hasLoadedNamespace.bind(this)},m.backendConnector=new f3(i(this.modules.backend),m.resourceStore,m,this.options),m.backendConnector.on("*",function(g){for(var b=arguments.length,w=new Array(b>1?b-1:0),_=1;_<b;_++)w[_-1]=arguments[_];t.emit(g,...w)}),this.modules.languageDetector&&(m.languageDetector=i(this.modules.languageDetector),m.languageDetector.init&&m.languageDetector.init(m,this.options.detection,this.options)),this.modules.i18nFormat&&(m.i18nFormat=i(this.modules.i18nFormat),m.i18nFormat.init&&m.i18nFormat.init(this)),this.translator=new ud(this.services,this.options),this.translator.on("*",function(g){for(var b=arguments.length,w=new Array(b>1?b-1:0),_=1;_<b;_++)w[_-1]=arguments[_];t.emit(g,...w)}),this.modules.external.forEach(g=>{g.init&&g.init(this)})}if(this.format=this.options.interpolation.format,n||(n=Rh),this.options.fallbackLng&&!this.services.languageDetector&&!this.options.lng){const d=this.services.languageUtils.getFallbackCodes(this.options.fallbackLng);d.length>0&&d[0]!=="dev"&&(this.options.lng=d[0])}!this.services.languageDetector&&!this.options.lng&&this.logger.warn("init: no languageDetector is used and no lng is defined"),["getResource","hasResourceBundle","getResourceBundle","getDataByLanguage"].forEach(d=>{this[d]=function(){return t.store[d](...arguments)}}),["addResource","addResources","addResourceBundle","removeResourceBundle"].forEach(d=>{this[d]=function(){return t.store[d](...arguments),t}});const c=tc(),f=()=>{const d=(v,m)=>{this.isInitializing=!1,this.isInitialized&&!this.initializedStoreOnce&&this.logger.warn("init: i18next is already initialized. You should call init just once!"),this.isInitialized=!0,this.options.isClone||this.logger.log("initialized",this.options),this.emit("initialized",this.options),c.resolve(m),n(v,m)};if(this.languages&&!this.isInitialized)return d(null,this.t.bind(this));this.changeLanguage(this.options.lng,d)};return this.options.resources||!this.options.initAsync?f():setTimeout(f,0),c}loadResources(t){var i,s;let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Rh;const a=je(t)?t:this.language;if(typeof t=="function"&&(n=t),!this.options.resources||this.options.partialBundledLanguages){if((a==null?void 0:a.toLowerCase())==="cimode"&&(!this.options.preload||this.options.preload.length===0))return n();const l=[],c=f=>{if(!f||f==="cimode")return;this.services.languageUtils.toResolveHierarchy(f).forEach(v=>{v!=="cimode"&&l.indexOf(v)<0&&l.push(v)})};a?c(a):this.services.languageUtils.getFallbackCodes(this.options.fallbackLng).forEach(d=>c(d)),(s=(i=this.options.preload)==null?void 0:i.forEach)==null||s.call(i,f=>c(f)),this.services.backendConnector.load(l,this.options.ns,f=>{!f&&!this.resolvedLanguage&&this.language&&this.setResolvedLanguage(this.language),n(f)})}else n(null)}reloadResources(t,e,n){const a=tc();return typeof t=="function"&&(n=t,t=void 0),typeof e=="function"&&(n=e,e=void 0),t||(t=this.languages),e||(e=this.options.ns),n||(n=Rh),this.services.backendConnector.reload(t,e,i=>{a.resolve(),n(i)}),a}use(t){if(!t)throw new Error("You are passing an undefined module! Please check the object you are passing to i18next.use()");if(!t.type)throw new Error("You are passing a wrong module! Please check the object you are passing to i18next.use()");return t.type==="backend"&&(this.modules.backend=t),(t.type==="logger"||t.log&&t.warn&&t.error)&&(this.modules.logger=t),t.type==="languageDetector"&&(this.modules.languageDetector=t),t.type==="i18nFormat"&&(this.modules.i18nFormat=t),t.type==="postProcessor"&&yE.addPostProcessor(t),t.type==="formatter"&&(this.modules.formatter=t),t.type==="3rdParty"&&this.modules.external.push(t),this}setResolvedLanguage(t){if(!(!t||!this.languages)&&!(["cimode","dev"].indexOf(t)>-1)){for(let e=0;e<this.languages.length;e++){const n=this.languages[e];if(!(["cimode","dev"].indexOf(n)>-1)&&this.store.hasLanguageSomeTranslations(n)){this.resolvedLanguage=n;break}}!this.resolvedLanguage&&this.languages.indexOf(t)<0&&this.store.hasLanguageSomeTranslations(t)&&(this.resolvedLanguage=t,this.languages.unshift(t))}}changeLanguage(t,e){var n=this;this.isLanguageChangingTo=t;const a=tc();this.emit("languageChanging",t);const i=c=>{this.language=c,this.languages=this.services.languageUtils.toResolveHierarchy(c),this.resolvedLanguage=void 0,this.setResolvedLanguage(c)},s=(c,f)=>{f?this.isLanguageChangingTo===t&&(i(f),this.translator.changeLanguage(f),this.isLanguageChangingTo=void 0,this.emit("languageChanged",f),this.logger.log("languageChanged",f)):this.isLanguageChangingTo=void 0,a.resolve(function(){return n.t(...arguments)}),e&&e(c,function(){return n.t(...arguments)})},l=c=>{var v,m;!t&&!c&&this.services.languageDetector&&(c=[]);const f=je(c)?c:c&&c[0],d=this.store.hasLanguageSomeTranslations(f)?f:this.services.languageUtils.getBestMatchFromCodes(je(c)?[c]:c);d&&(this.language||i(d),this.translator.language||this.translator.changeLanguage(d),(m=(v=this.services.languageDetector)==null?void 0:v.cacheUserLanguage)==null||m.call(v,d)),this.loadResources(d,g=>{s(g,d)})};return!t&&this.services.languageDetector&&!this.services.languageDetector.async?l(this.services.languageDetector.detect()):!t&&this.services.languageDetector&&this.services.languageDetector.async?this.services.languageDetector.detect.length===0?this.services.languageDetector.detect().then(l):this.services.languageDetector.detect(l):l(t),a}getFixedT(t,e,n){var a=this;const i=function(s,l){let c;if(typeof l!="object"){for(var f=arguments.length,d=new Array(f>2?f-2:0),v=2;v<f;v++)d[v-2]=arguments[v];c=a.options.overloadTranslationOptionHandler([s,l].concat(d))}else c={...l};c.lng=c.lng||i.lng,c.lngs=c.lngs||i.lngs,c.ns=c.ns||i.ns,c.keyPrefix!==""&&(c.keyPrefix=c.keyPrefix||n||i.keyPrefix);const m=a.options.keySeparator||".";let g;return c.keyPrefix&&Array.isArray(s)?g=s.map(b=>`${c.keyPrefix}${m}${b}`):g=c.keyPrefix?`${c.keyPrefix}${m}${s}`:s,a.t(g,c)};return je(t)?i.lng=t:i.lngs=t,i.ns=e,i.keyPrefix=n,i}t(){var a;for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return(a=this.translator)==null?void 0:a.translate(...e)}exists(){var a;for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return(a=this.translator)==null?void 0:a.exists(...e)}setDefaultNamespace(t){this.options.defaultNS=t}hasLoadedNamespace(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!this.isInitialized)return this.logger.warn("hasLoadedNamespace: i18next was not initialized",this.languages),!1;if(!this.languages||!this.languages.length)return this.logger.warn("hasLoadedNamespace: i18n.languages were undefined or empty",this.languages),!1;const n=e.lng||this.resolvedLanguage||this.languages[0],a=this.options?this.options.fallbackLng:!1,i=this.languages[this.languages.length-1];if(n.toLowerCase()==="cimode")return!0;const s=(l,c)=>{const f=this.services.backendConnector.state[`${l}|${c}`];return f===-1||f===0||f===2};if(e.precheck){const l=e.precheck(this,s);if(l!==void 0)return l}return!!(this.hasResourceBundle(n,t)||!this.services.backendConnector.backend||this.options.resources&&!this.options.partialBundledLanguages||s(n,t)&&(!a||s(i,t)))}loadNamespaces(t,e){const n=tc();return this.options.ns?(je(t)&&(t=[t]),t.forEach(a=>{this.options.ns.indexOf(a)<0&&this.options.ns.push(a)}),this.loadResources(a=>{n.resolve(),e&&e(a)}),n):(e&&e(),Promise.resolve())}loadLanguages(t,e){const n=tc();je(t)&&(t=[t]);const a=this.options.preload||[],i=t.filter(s=>a.indexOf(s)<0&&this.services.languageUtils.isSupportedCode(s));return i.length?(this.options.preload=a.concat(i),this.loadResources(s=>{n.resolve(),e&&e(s)}),n):(e&&e(),Promise.resolve())}dir(t){var a,i;if(t||(t=this.resolvedLanguage||(((a=this.languages)==null?void 0:a.length)>0?this.languages[0]:this.language)),!t)return"rtl";const e=["ar","shu","sqr","ssh","xaa","yhd","yud","aao","abh","abv","acm","acq","acw","acx","acy","adf","ads","aeb","aec","afb","ajp","apc","apd","arb","arq","ars","ary","arz","auz","avl","ayh","ayl","ayn","ayp","bbz","pga","he","iw","ps","pbt","pbu","pst","prp","prd","ug","ur","ydd","yds","yih","ji","yi","hbo","men","xmn","fa","jpr","peo","pes","prs","dv","sam","ckb"],n=((i=this.services)==null?void 0:i.languageUtils)||new P2(H2());return e.indexOf(n.getLanguagePartFromCode(t))>-1||t.toLowerCase().indexOf("-arab")>1?"rtl":"ltr"}static createInstance(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=arguments.length>1?arguments[1]:void 0;return new bc(t,e)}cloneInstance(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Rh;const n=t.forkResourceStore;n&&delete t.forkResourceStore;const a={...this.options,...t,isClone:!0},i=new bc(a);if((t.debug!==void 0||t.prefix!==void 0)&&(i.logger=i.logger.clone(t)),["store","services","language"].forEach(l=>{i[l]=this[l]}),i.services={...this.services},i.services.utils={hasLoadedNamespace:i.hasLoadedNamespace.bind(i)},n){const l=Object.keys(this.store.data).reduce((c,f)=>(c[f]={...this.store.data[f]},c[f]=Object.keys(c[f]).reduce((d,v)=>(d[v]={...c[f][v]},d),c[f]),c),{});i.store=new F2(l,a),i.services.resourceStore=i.store}return i.translator=new ud(i.services,a),i.translator.on("*",function(l){for(var c=arguments.length,f=new Array(c>1?c-1:0),d=1;d<c;d++)f[d-1]=arguments[d];i.emit(l,...f)}),i.init(a,e),i.translator.options=a,i.translator.backendConnector.services.utils={hasLoadedNamespace:i.hasLoadedNamespace.bind(i)},i}toJSON(){return{options:this.options,store:this.store,language:this.language,languages:this.languages,resolvedLanguage:this.resolvedLanguage}}}const Un=bc.createInstance();Un.createInstance=bc.createInstance;Un.createInstance;Un.dir;Un.init;Un.loadResources;Un.reloadResources;Un.use;Un.changeLanguage;Un.getFixedT;Un.t;Un.exists;Un.setDefaultNamespace;Un.hasLoadedNamespace;Un.loadNamespaces;Un.loadLanguages;const W2=r=>{let t;const e=new Set,n=(f,d)=>{const v=typeof f=="function"?f(t):f;if(!Object.is(v,t)){const m=t;t=d??(typeof v!="object"||v===null)?v:Object.assign({},t,v),e.forEach(g=>g(t,m))}},a=()=>t,l={setState:n,getState:a,getInitialState:()=>c,subscribe:f=>(e.add(f),()=>e.delete(f))},c=t=r(n,a,l);return l},d3=r=>r?W2(r):W2,p3=r=>r;function v3(r,t=p3){const e=Zn.useSyncExternalStore(r.subscribe,()=>t(r.getState()),()=>t(r.getInitialState()));return Zn.useDebugValue(e),e}const m3=r=>{const t=d3(r),e=n=>v3(t,n);return Object.assign(e,t),e},g6=r=>m3;function g3(r,t){let e;try{e=r()}catch{return}return{getItem:a=>{var i;const s=c=>c===null?null:JSON.parse(c,void 0),l=(i=e.getItem(a))!=null?i:null;return l instanceof Promise?l.then(s):s(l)},setItem:(a,i)=>e.setItem(a,JSON.stringify(i,void 0)),removeItem:a=>e.removeItem(a)}}const $g=r=>t=>{try{const e=r(t);return e instanceof Promise?e:{then(n){return $g(n)(e)},catch(n){return this}}}catch(e){return{then(n){return this},catch(n){return $g(n)(e)}}}},y3=(r,t)=>(e,n,a)=>{let i={storage:g3(()=>localStorage),partialize:w=>w,version:0,merge:(w,_)=>({..._,...w}),...t},s=!1;const l=new Set,c=new Set;let f=i.storage;if(!f)return r((...w)=>{console.warn(`[zustand persist middleware] Unable to update item '${i.name}', the given storage is currently unavailable.`),e(...w)},n,a);const d=()=>{const w=i.partialize({...n()});return f.setItem(i.name,{state:w,version:i.version})},v=a.setState;a.setState=(w,_)=>{v(w,_),d()};const m=r((...w)=>{e(...w),d()},n,a);a.getInitialState=()=>m;let g;const b=()=>{var w,_;if(!f)return;s=!1,l.forEach(E=>{var C;return E((C=n())!=null?C:m)});const S=((_=i.onRehydrateStorage)==null?void 0:_.call(i,(w=n())!=null?w:m))||void 0;return $g(f.getItem.bind(f))(i.name).then(E=>{if(E)if(typeof E.version=="number"&&E.version!==i.version){if(i.migrate){const C=i.migrate(E.state,E.version);return C instanceof Promise?C.then(R=>[!0,R]):[!0,C]}console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,E.state];return[!1,void 0]}).then(E=>{var C;const[R,T]=E;if(g=i.merge(T,(C=n())!=null?C:m),e(g,!0),R)return d()}).then(()=>{S==null||S(g,void 0),g=n(),s=!0,c.forEach(E=>E(g))}).catch(E=>{S==null||S(void 0,E)})};return a.persist={setOptions:w=>{i={...i,...w},w.storage&&(f=w.storage)},clearStorage:()=>{f==null||f.removeItem(i.name)},getOptions:()=>i,rehydrate:()=>b(),hasHydrated:()=>s,onHydrate:w=>(l.add(w),()=>{l.delete(w)}),onFinishHydration:w=>(c.add(w),()=>{c.delete(w)})},i.skipHydration||b(),g||m},y6=y3;var ut;(function(r){r.assertEqual=a=>a;function t(a){}r.assertIs=t;function e(a){throw new Error}r.assertNever=e,r.arrayToEnum=a=>{const i={};for(const s of a)i[s]=s;return i},r.getValidEnumValues=a=>{const i=r.objectKeys(a).filter(l=>typeof a[a[l]]!="number"),s={};for(const l of i)s[l]=a[l];return r.objectValues(s)},r.objectValues=a=>r.objectKeys(a).map(function(i){return a[i]}),r.objectKeys=typeof Object.keys=="function"?a=>Object.keys(a):a=>{const i=[];for(const s in a)Object.prototype.hasOwnProperty.call(a,s)&&i.push(s);return i},r.find=(a,i)=>{for(const s of a)if(i(s))return s},r.isInteger=typeof Number.isInteger=="function"?a=>Number.isInteger(a):a=>typeof a=="number"&&isFinite(a)&&Math.floor(a)===a;function n(a,i=" | "){return a.map(s=>typeof s=="string"?`'${s}'`:s).join(i)}r.joinValues=n,r.jsonStringifyReplacer=(a,i)=>typeof i=="bigint"?i.toString():i})(ut||(ut={}));var Yg;(function(r){r.mergeShapes=(t,e)=>({...t,...e})})(Yg||(Yg={}));const _e=ut.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),Qa=r=>{switch(typeof r){case"undefined":return _e.undefined;case"string":return _e.string;case"number":return isNaN(r)?_e.nan:_e.number;case"boolean":return _e.boolean;case"function":return _e.function;case"bigint":return _e.bigint;case"symbol":return _e.symbol;case"object":return Array.isArray(r)?_e.array:r===null?_e.null:r.then&&typeof r.then=="function"&&r.catch&&typeof r.catch=="function"?_e.promise:typeof Map<"u"&&r instanceof Map?_e.map:typeof Set<"u"&&r instanceof Set?_e.set:typeof Date<"u"&&r instanceof Date?_e.date:_e.object;default:return _e.unknown}},ve=ut.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),b3=r=>JSON.stringify(r,null,2).replace(/"([^"]+)":/g,"$1:");class pr extends Error{get errors(){return this.issues}constructor(t){super(),this.issues=[],this.addIssue=n=>{this.issues=[...this.issues,n]},this.addIssues=(n=[])=>{this.issues=[...this.issues,...n]};const e=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,e):this.__proto__=e,this.name="ZodError",this.issues=t}format(t){const e=t||function(i){return i.message},n={_errors:[]},a=i=>{for(const s of i.issues)if(s.code==="invalid_union")s.unionErrors.map(a);else if(s.code==="invalid_return_type")a(s.returnTypeError);else if(s.code==="invalid_arguments")a(s.argumentsError);else if(s.path.length===0)n._errors.push(e(s));else{let l=n,c=0;for(;c<s.path.length;){const f=s.path[c];c===s.path.length-1?(l[f]=l[f]||{_errors:[]},l[f]._errors.push(e(s))):l[f]=l[f]||{_errors:[]},l=l[f],c++}}};return a(this),n}static assert(t){if(!(t instanceof pr))throw new Error(`Not a ZodError: ${t}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,ut.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(t=e=>e.message){const e={},n=[];for(const a of this.issues)a.path.length>0?(e[a.path[0]]=e[a.path[0]]||[],e[a.path[0]].push(t(a))):n.push(t(a));return{formErrors:n,fieldErrors:e}}get formErrors(){return this.flatten()}}pr.create=r=>new pr(r);const Hu=(r,t)=>{let e;switch(r.code){case ve.invalid_type:r.received===_e.undefined?e="Required":e=`Expected ${r.expected}, received ${r.received}`;break;case ve.invalid_literal:e=`Invalid literal value, expected ${JSON.stringify(r.expected,ut.jsonStringifyReplacer)}`;break;case ve.unrecognized_keys:e=`Unrecognized key(s) in object: ${ut.joinValues(r.keys,", ")}`;break;case ve.invalid_union:e="Invalid input";break;case ve.invalid_union_discriminator:e=`Invalid discriminator value. Expected ${ut.joinValues(r.options)}`;break;case ve.invalid_enum_value:e=`Invalid enum value. Expected ${ut.joinValues(r.options)}, received '${r.received}'`;break;case ve.invalid_arguments:e="Invalid function arguments";break;case ve.invalid_return_type:e="Invalid function return type";break;case ve.invalid_date:e="Invalid date";break;case ve.invalid_string:typeof r.validation=="object"?"includes"in r.validation?(e=`Invalid input: must include "${r.validation.includes}"`,typeof r.validation.position=="number"&&(e=`${e} at one or more positions greater than or equal to ${r.validation.position}`)):"startsWith"in r.validation?e=`Invalid input: must start with "${r.validation.startsWith}"`:"endsWith"in r.validation?e=`Invalid input: must end with "${r.validation.endsWith}"`:ut.assertNever(r.validation):r.validation!=="regex"?e=`Invalid ${r.validation}`:e="Invalid";break;case ve.too_small:r.type==="array"?e=`Array must contain ${r.exact?"exactly":r.inclusive?"at least":"more than"} ${r.minimum} element(s)`:r.type==="string"?e=`String must contain ${r.exact?"exactly":r.inclusive?"at least":"over"} ${r.minimum} character(s)`:r.type==="number"?e=`Number must be ${r.exact?"exactly equal to ":r.inclusive?"greater than or equal to ":"greater than "}${r.minimum}`:r.type==="date"?e=`Date must be ${r.exact?"exactly equal to ":r.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(r.minimum))}`:e="Invalid input";break;case ve.too_big:r.type==="array"?e=`Array must contain ${r.exact?"exactly":r.inclusive?"at most":"less than"} ${r.maximum} element(s)`:r.type==="string"?e=`String must contain ${r.exact?"exactly":r.inclusive?"at most":"under"} ${r.maximum} character(s)`:r.type==="number"?e=`Number must be ${r.exact?"exactly":r.inclusive?"less than or equal to":"less than"} ${r.maximum}`:r.type==="bigint"?e=`BigInt must be ${r.exact?"exactly":r.inclusive?"less than or equal to":"less than"} ${r.maximum}`:r.type==="date"?e=`Date must be ${r.exact?"exactly":r.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(r.maximum))}`:e="Invalid input";break;case ve.custom:e="Invalid input";break;case ve.invalid_intersection_types:e="Intersection results could not be merged";break;case ve.not_multiple_of:e=`Number must be a multiple of ${r.multipleOf}`;break;case ve.not_finite:e="Number must be finite";break;default:e=t.defaultError,ut.assertNever(r)}return{message:e}};let bE=Hu;function x3(r){bE=r}function ld(){return bE}const cd=r=>{const{data:t,path:e,errorMaps:n,issueData:a}=r,i=[...e,...a.path||[]],s={...a,path:i};if(a.message!==void 0)return{...a,path:i,message:a.message};let l="";const c=n.filter(f=>!!f).slice().reverse();for(const f of c)l=f(s,{data:t,defaultError:l}).message;return{...a,path:i,message:l}},w3=[];function be(r,t){const e=ld(),n=cd({issueData:t,data:r.data,path:r.path,errorMaps:[r.common.contextualErrorMap,r.schemaErrorMap,e,e===Hu?void 0:Hu].filter(a=>!!a)});r.common.issues.push(n)}class In{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(t,e){const n=[];for(const a of e){if(a.status==="aborted")return Ve;a.status==="dirty"&&t.dirty(),n.push(a.value)}return{status:t.value,value:n}}static async mergeObjectAsync(t,e){const n=[];for(const a of e){const i=await a.key,s=await a.value;n.push({key:i,value:s})}return In.mergeObjectSync(t,n)}static mergeObjectSync(t,e){const n={};for(const a of e){const{key:i,value:s}=a;if(i.status==="aborted"||s.status==="aborted")return Ve;i.status==="dirty"&&t.dirty(),s.status==="dirty"&&t.dirty(),i.value!=="__proto__"&&(typeof s.value<"u"||a.alwaysSet)&&(n[i.value]=s.value)}return{status:t.value,value:n}}}const Ve=Object.freeze({status:"aborted"}),du=r=>({status:"dirty",value:r}),zn=r=>({status:"valid",value:r}),Zg=r=>r.status==="aborted",Qg=r=>r.status==="dirty",is=r=>r.status==="valid",xc=r=>typeof Promise<"u"&&r instanceof Promise;function fd(r,t,e,n){if(typeof t=="function"?r!==t||!0:!t.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t.get(r)}function xE(r,t,e,n,a){if(typeof t=="function"?r!==t||!0:!t.has(r))throw new TypeError("Cannot write private member to an object whose class did not declare it");return t.set(r,e),e}var Ae;(function(r){r.errToObj=t=>typeof t=="string"?{message:t}:t||{},r.toString=t=>typeof t=="string"?t:t==null?void 0:t.message})(Ae||(Ae={}));var lc,cc;class _a{constructor(t,e,n,a){this._cachedPath=[],this.parent=t,this.data=e,this._path=n,this._key=a}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const G2=(r,t)=>{if(is(t))return{success:!0,data:t.value};if(!r.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const e=new pr(r.common.issues);return this._error=e,this._error}}};function Ke(r){if(!r)return{};const{errorMap:t,invalid_type_error:e,required_error:n,description:a}=r;if(t&&(e||n))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return t?{errorMap:t,description:a}:{errorMap:(s,l)=>{var c,f;const{message:d}=r;return s.code==="invalid_enum_value"?{message:d??l.defaultError}:typeof l.data>"u"?{message:(c=d??n)!==null&&c!==void 0?c:l.defaultError}:s.code!=="invalid_type"?{message:l.defaultError}:{message:(f=d??e)!==null&&f!==void 0?f:l.defaultError}},description:a}}class Qe{get description(){return this._def.description}_getType(t){return Qa(t.data)}_getOrReturnCtx(t,e){return e||{common:t.parent.common,data:t.data,parsedType:Qa(t.data),schemaErrorMap:this._def.errorMap,path:t.path,parent:t.parent}}_processInputParams(t){return{status:new In,ctx:{common:t.parent.common,data:t.data,parsedType:Qa(t.data),schemaErrorMap:this._def.errorMap,path:t.path,parent:t.parent}}}_parseSync(t){const e=this._parse(t);if(xc(e))throw new Error("Synchronous parse encountered promise.");return e}_parseAsync(t){const e=this._parse(t);return Promise.resolve(e)}parse(t,e){const n=this.safeParse(t,e);if(n.success)return n.data;throw n.error}safeParse(t,e){var n;const a={common:{issues:[],async:(n=e==null?void 0:e.async)!==null&&n!==void 0?n:!1,contextualErrorMap:e==null?void 0:e.errorMap},path:(e==null?void 0:e.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:Qa(t)},i=this._parseSync({data:t,path:a.path,parent:a});return G2(a,i)}"~validate"(t){var e,n;const a={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:Qa(t)};if(!this["~standard"].async)try{const i=this._parseSync({data:t,path:[],parent:a});return is(i)?{value:i.value}:{issues:a.common.issues}}catch(i){!((n=(e=i==null?void 0:i.message)===null||e===void 0?void 0:e.toLowerCase())===null||n===void 0)&&n.includes("encountered")&&(this["~standard"].async=!0),a.common={issues:[],async:!0}}return this._parseAsync({data:t,path:[],parent:a}).then(i=>is(i)?{value:i.value}:{issues:a.common.issues})}async parseAsync(t,e){const n=await this.safeParseAsync(t,e);if(n.success)return n.data;throw n.error}async safeParseAsync(t,e){const n={common:{issues:[],contextualErrorMap:e==null?void 0:e.errorMap,async:!0},path:(e==null?void 0:e.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:Qa(t)},a=this._parse({data:t,path:n.path,parent:n}),i=await(xc(a)?a:Promise.resolve(a));return G2(n,i)}refine(t,e){const n=a=>typeof e=="string"||typeof e>"u"?{message:e}:typeof e=="function"?e(a):e;return this._refinement((a,i)=>{const s=t(a),l=()=>i.addIssue({code:ve.custom,...n(a)});return typeof Promise<"u"&&s instanceof Promise?s.then(c=>c?!0:(l(),!1)):s?!0:(l(),!1)})}refinement(t,e){return this._refinement((n,a)=>t(n)?!0:(a.addIssue(typeof e=="function"?e(n,a):e),!1))}_refinement(t){return new Zr({schema:this,typeName:ze.ZodEffects,effect:{type:"refinement",refinement:t}})}superRefine(t){return this._refinement(t)}constructor(t){this.spa=this.safeParseAsync,this._def=t,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:e=>this["~validate"](e)}}optional(){return ya.create(this,this._def)}nullable(){return ho.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return Xr.create(this)}promise(){return Wu.create(this,this._def)}or(t){return Ec.create([this,t],this._def)}and(t){return Cc.create(this,t,this._def)}transform(t){return new Zr({...Ke(this._def),schema:this,typeName:ze.ZodEffects,effect:{type:"transform",transform:t}})}default(t){const e=typeof t=="function"?t:()=>t;return new kc({...Ke(this._def),innerType:this,defaultValue:e,typeName:ze.ZodDefault})}brand(){return new Uy({typeName:ze.ZodBranded,type:this,...Ke(this._def)})}catch(t){const e=typeof t=="function"?t:()=>t;return new Oc({...Ke(this._def),innerType:this,catchValue:e,typeName:ze.ZodCatch})}describe(t){const e=this.constructor;return new e({...this._def,description:t})}pipe(t){return Yc.create(this,t)}readonly(){return Nc.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const _3=/^c[^\s-]{8,}$/i,S3=/^[0-9a-z]+$/,E3=/^[0-9A-HJKMNP-TV-Z]{26}$/i,C3=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,R3=/^[a-z0-9_-]{21}$/i,T3=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,A3=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,D3=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,k3="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let Gm;const O3=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,N3=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,M3=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,I3=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,F3=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,B3=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,wE="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",L3=new RegExp(`^${wE}$`);function _E(r){let t="([01]\\d|2[0-3]):[0-5]\\d:[0-5]\\d";return r.precision?t=`${t}\\.\\d{${r.precision}}`:r.precision==null&&(t=`${t}(\\.\\d+)?`),t}function P3(r){return new RegExp(`^${_E(r)}$`)}function SE(r){let t=`${wE}T${_E(r)}`;const e=[];return e.push(r.local?"Z?":"Z"),r.offset&&e.push("([+-]\\d{2}:?\\d{2})"),t=`${t}(${e.join("|")})`,new RegExp(`^${t}$`)}function z3(r,t){return!!((t==="v4"||!t)&&O3.test(r)||(t==="v6"||!t)&&M3.test(r))}function U3(r,t){if(!T3.test(r))return!1;try{const[e]=r.split("."),n=e.replace(/-/g,"+").replace(/_/g,"/").padEnd(e.length+(4-e.length%4)%4,"="),a=JSON.parse(atob(n));return!(typeof a!="object"||a===null||!a.typ||!a.alg||t&&a.alg!==t)}catch{return!1}}function V3(r,t){return!!((t==="v4"||!t)&&N3.test(r)||(t==="v6"||!t)&&I3.test(r))}class Gr extends Qe{_parse(t){if(this._def.coerce&&(t.data=String(t.data)),this._getType(t)!==_e.string){const i=this._getOrReturnCtx(t);return be(i,{code:ve.invalid_type,expected:_e.string,received:i.parsedType}),Ve}const n=new In;let a;for(const i of this._def.checks)if(i.kind==="min")t.data.length<i.value&&(a=this._getOrReturnCtx(t,a),be(a,{code:ve.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),n.dirty());else if(i.kind==="max")t.data.length>i.value&&(a=this._getOrReturnCtx(t,a),be(a,{code:ve.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),n.dirty());else if(i.kind==="length"){const s=t.data.length>i.value,l=t.data.length<i.value;(s||l)&&(a=this._getOrReturnCtx(t,a),s?be(a,{code:ve.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}):l&&be(a,{code:ve.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}),n.dirty())}else if(i.kind==="email")D3.test(t.data)||(a=this._getOrReturnCtx(t,a),be(a,{validation:"email",code:ve.invalid_string,message:i.message}),n.dirty());else if(i.kind==="emoji")Gm||(Gm=new RegExp(k3,"u")),Gm.test(t.data)||(a=this._getOrReturnCtx(t,a),be(a,{validation:"emoji",code:ve.invalid_string,message:i.message}),n.dirty());else if(i.kind==="uuid")C3.test(t.data)||(a=this._getOrReturnCtx(t,a),be(a,{validation:"uuid",code:ve.invalid_string,message:i.message}),n.dirty());else if(i.kind==="nanoid")R3.test(t.data)||(a=this._getOrReturnCtx(t,a),be(a,{validation:"nanoid",code:ve.invalid_string,message:i.message}),n.dirty());else if(i.kind==="cuid")_3.test(t.data)||(a=this._getOrReturnCtx(t,a),be(a,{validation:"cuid",code:ve.invalid_string,message:i.message}),n.dirty());else if(i.kind==="cuid2")S3.test(t.data)||(a=this._getOrReturnCtx(t,a),be(a,{validation:"cuid2",code:ve.invalid_string,message:i.message}),n.dirty());else if(i.kind==="ulid")E3.test(t.data)||(a=this._getOrReturnCtx(t,a),be(a,{validation:"ulid",code:ve.invalid_string,message:i.message}),n.dirty());else if(i.kind==="url")try{new URL(t.data)}catch{a=this._getOrReturnCtx(t,a),be(a,{validation:"url",code:ve.invalid_string,message:i.message}),n.dirty()}else i.kind==="regex"?(i.regex.lastIndex=0,i.regex.test(t.data)||(a=this._getOrReturnCtx(t,a),be(a,{validation:"regex",code:ve.invalid_string,message:i.message}),n.dirty())):i.kind==="trim"?t.data=t.data.trim():i.kind==="includes"?t.data.includes(i.value,i.position)||(a=this._getOrReturnCtx(t,a),be(a,{code:ve.invalid_string,validation:{includes:i.value,position:i.position},message:i.message}),n.dirty()):i.kind==="toLowerCase"?t.data=t.data.toLowerCase():i.kind==="toUpperCase"?t.data=t.data.toUpperCase():i.kind==="startsWith"?t.data.startsWith(i.value)||(a=this._getOrReturnCtx(t,a),be(a,{code:ve.invalid_string,validation:{startsWith:i.value},message:i.message}),n.dirty()):i.kind==="endsWith"?t.data.endsWith(i.value)||(a=this._getOrReturnCtx(t,a),be(a,{code:ve.invalid_string,validation:{endsWith:i.value},message:i.message}),n.dirty()):i.kind==="datetime"?SE(i).test(t.data)||(a=this._getOrReturnCtx(t,a),be(a,{code:ve.invalid_string,validation:"datetime",message:i.message}),n.dirty()):i.kind==="date"?L3.test(t.data)||(a=this._getOrReturnCtx(t,a),be(a,{code:ve.invalid_string,validation:"date",message:i.message}),n.dirty()):i.kind==="time"?P3(i).test(t.data)||(a=this._getOrReturnCtx(t,a),be(a,{code:ve.invalid_string,validation:"time",message:i.message}),n.dirty()):i.kind==="duration"?A3.test(t.data)||(a=this._getOrReturnCtx(t,a),be(a,{validation:"duration",code:ve.invalid_string,message:i.message}),n.dirty()):i.kind==="ip"?z3(t.data,i.version)||(a=this._getOrReturnCtx(t,a),be(a,{validation:"ip",code:ve.invalid_string,message:i.message}),n.dirty()):i.kind==="jwt"?U3(t.data,i.alg)||(a=this._getOrReturnCtx(t,a),be(a,{validation:"jwt",code:ve.invalid_string,message:i.message}),n.dirty()):i.kind==="cidr"?V3(t.data,i.version)||(a=this._getOrReturnCtx(t,a),be(a,{validation:"cidr",code:ve.invalid_string,message:i.message}),n.dirty()):i.kind==="base64"?F3.test(t.data)||(a=this._getOrReturnCtx(t,a),be(a,{validation:"base64",code:ve.invalid_string,message:i.message}),n.dirty()):i.kind==="base64url"?B3.test(t.data)||(a=this._getOrReturnCtx(t,a),be(a,{validation:"base64url",code:ve.invalid_string,message:i.message}),n.dirty()):ut.assertNever(i);return{status:n.value,value:t.data}}_regex(t,e,n){return this.refinement(a=>t.test(a),{validation:e,code:ve.invalid_string,...Ae.errToObj(n)})}_addCheck(t){return new Gr({...this._def,checks:[...this._def.checks,t]})}email(t){return this._addCheck({kind:"email",...Ae.errToObj(t)})}url(t){return this._addCheck({kind:"url",...Ae.errToObj(t)})}emoji(t){return this._addCheck({kind:"emoji",...Ae.errToObj(t)})}uuid(t){return this._addCheck({kind:"uuid",...Ae.errToObj(t)})}nanoid(t){return this._addCheck({kind:"nanoid",...Ae.errToObj(t)})}cuid(t){return this._addCheck({kind:"cuid",...Ae.errToObj(t)})}cuid2(t){return this._addCheck({kind:"cuid2",...Ae.errToObj(t)})}ulid(t){return this._addCheck({kind:"ulid",...Ae.errToObj(t)})}base64(t){return this._addCheck({kind:"base64",...Ae.errToObj(t)})}base64url(t){return this._addCheck({kind:"base64url",...Ae.errToObj(t)})}jwt(t){return this._addCheck({kind:"jwt",...Ae.errToObj(t)})}ip(t){return this._addCheck({kind:"ip",...Ae.errToObj(t)})}cidr(t){return this._addCheck({kind:"cidr",...Ae.errToObj(t)})}datetime(t){var e,n;return typeof t=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:t}):this._addCheck({kind:"datetime",precision:typeof(t==null?void 0:t.precision)>"u"?null:t==null?void 0:t.precision,offset:(e=t==null?void 0:t.offset)!==null&&e!==void 0?e:!1,local:(n=t==null?void 0:t.local)!==null&&n!==void 0?n:!1,...Ae.errToObj(t==null?void 0:t.message)})}date(t){return this._addCheck({kind:"date",message:t})}time(t){return typeof t=="string"?this._addCheck({kind:"time",precision:null,message:t}):this._addCheck({kind:"time",precision:typeof(t==null?void 0:t.precision)>"u"?null:t==null?void 0:t.precision,...Ae.errToObj(t==null?void 0:t.message)})}duration(t){return this._addCheck({kind:"duration",...Ae.errToObj(t)})}regex(t,e){return this._addCheck({kind:"regex",regex:t,...Ae.errToObj(e)})}includes(t,e){return this._addCheck({kind:"includes",value:t,position:e==null?void 0:e.position,...Ae.errToObj(e==null?void 0:e.message)})}startsWith(t,e){return this._addCheck({kind:"startsWith",value:t,...Ae.errToObj(e)})}endsWith(t,e){return this._addCheck({kind:"endsWith",value:t,...Ae.errToObj(e)})}min(t,e){return this._addCheck({kind:"min",value:t,...Ae.errToObj(e)})}max(t,e){return this._addCheck({kind:"max",value:t,...Ae.errToObj(e)})}length(t,e){return this._addCheck({kind:"length",value:t,...Ae.errToObj(e)})}nonempty(t){return this.min(1,Ae.errToObj(t))}trim(){return new Gr({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new Gr({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new Gr({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(t=>t.kind==="datetime")}get isDate(){return!!this._def.checks.find(t=>t.kind==="date")}get isTime(){return!!this._def.checks.find(t=>t.kind==="time")}get isDuration(){return!!this._def.checks.find(t=>t.kind==="duration")}get isEmail(){return!!this._def.checks.find(t=>t.kind==="email")}get isURL(){return!!this._def.checks.find(t=>t.kind==="url")}get isEmoji(){return!!this._def.checks.find(t=>t.kind==="emoji")}get isUUID(){return!!this._def.checks.find(t=>t.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(t=>t.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(t=>t.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(t=>t.kind==="cuid2")}get isULID(){return!!this._def.checks.find(t=>t.kind==="ulid")}get isIP(){return!!this._def.checks.find(t=>t.kind==="ip")}get isCIDR(){return!!this._def.checks.find(t=>t.kind==="cidr")}get isBase64(){return!!this._def.checks.find(t=>t.kind==="base64")}get isBase64url(){return!!this._def.checks.find(t=>t.kind==="base64url")}get minLength(){let t=null;for(const e of this._def.checks)e.kind==="min"&&(t===null||e.value>t)&&(t=e.value);return t}get maxLength(){let t=null;for(const e of this._def.checks)e.kind==="max"&&(t===null||e.value<t)&&(t=e.value);return t}}Gr.create=r=>{var t;return new Gr({checks:[],typeName:ze.ZodString,coerce:(t=r==null?void 0:r.coerce)!==null&&t!==void 0?t:!1,...Ke(r)})};function H3(r,t){const e=(r.toString().split(".")[1]||"").length,n=(t.toString().split(".")[1]||"").length,a=e>n?e:n,i=parseInt(r.toFixed(a).replace(".","")),s=parseInt(t.toFixed(a).replace(".",""));return i%s/Math.pow(10,a)}class lo extends Qe{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(t){if(this._def.coerce&&(t.data=Number(t.data)),this._getType(t)!==_e.number){const i=this._getOrReturnCtx(t);return be(i,{code:ve.invalid_type,expected:_e.number,received:i.parsedType}),Ve}let n;const a=new In;for(const i of this._def.checks)i.kind==="int"?ut.isInteger(t.data)||(n=this._getOrReturnCtx(t,n),be(n,{code:ve.invalid_type,expected:"integer",received:"float",message:i.message}),a.dirty()):i.kind==="min"?(i.inclusive?t.data<i.value:t.data<=i.value)&&(n=this._getOrReturnCtx(t,n),be(n,{code:ve.too_small,minimum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),a.dirty()):i.kind==="max"?(i.inclusive?t.data>i.value:t.data>=i.value)&&(n=this._getOrReturnCtx(t,n),be(n,{code:ve.too_big,maximum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),a.dirty()):i.kind==="multipleOf"?H3(t.data,i.value)!==0&&(n=this._getOrReturnCtx(t,n),be(n,{code:ve.not_multiple_of,multipleOf:i.value,message:i.message}),a.dirty()):i.kind==="finite"?Number.isFinite(t.data)||(n=this._getOrReturnCtx(t,n),be(n,{code:ve.not_finite,message:i.message}),a.dirty()):ut.assertNever(i);return{status:a.value,value:t.data}}gte(t,e){return this.setLimit("min",t,!0,Ae.toString(e))}gt(t,e){return this.setLimit("min",t,!1,Ae.toString(e))}lte(t,e){return this.setLimit("max",t,!0,Ae.toString(e))}lt(t,e){return this.setLimit("max",t,!1,Ae.toString(e))}setLimit(t,e,n,a){return new lo({...this._def,checks:[...this._def.checks,{kind:t,value:e,inclusive:n,message:Ae.toString(a)}]})}_addCheck(t){return new lo({...this._def,checks:[...this._def.checks,t]})}int(t){return this._addCheck({kind:"int",message:Ae.toString(t)})}positive(t){return this._addCheck({kind:"min",value:0,inclusive:!1,message:Ae.toString(t)})}negative(t){return this._addCheck({kind:"max",value:0,inclusive:!1,message:Ae.toString(t)})}nonpositive(t){return this._addCheck({kind:"max",value:0,inclusive:!0,message:Ae.toString(t)})}nonnegative(t){return this._addCheck({kind:"min",value:0,inclusive:!0,message:Ae.toString(t)})}multipleOf(t,e){return this._addCheck({kind:"multipleOf",value:t,message:Ae.toString(e)})}finite(t){return this._addCheck({kind:"finite",message:Ae.toString(t)})}safe(t){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:Ae.toString(t)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:Ae.toString(t)})}get minValue(){let t=null;for(const e of this._def.checks)e.kind==="min"&&(t===null||e.value>t)&&(t=e.value);return t}get maxValue(){let t=null;for(const e of this._def.checks)e.kind==="max"&&(t===null||e.value<t)&&(t=e.value);return t}get isInt(){return!!this._def.checks.find(t=>t.kind==="int"||t.kind==="multipleOf"&&ut.isInteger(t.value))}get isFinite(){let t=null,e=null;for(const n of this._def.checks){if(n.kind==="finite"||n.kind==="int"||n.kind==="multipleOf")return!0;n.kind==="min"?(e===null||n.value>e)&&(e=n.value):n.kind==="max"&&(t===null||n.value<t)&&(t=n.value)}return Number.isFinite(e)&&Number.isFinite(t)}}lo.create=r=>new lo({checks:[],typeName:ze.ZodNumber,coerce:(r==null?void 0:r.coerce)||!1,...Ke(r)});class co extends Qe{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(t){if(this._def.coerce)try{t.data=BigInt(t.data)}catch{return this._getInvalidInput(t)}if(this._getType(t)!==_e.bigint)return this._getInvalidInput(t);let n;const a=new In;for(const i of this._def.checks)i.kind==="min"?(i.inclusive?t.data<i.value:t.data<=i.value)&&(n=this._getOrReturnCtx(t,n),be(n,{code:ve.too_small,type:"bigint",minimum:i.value,inclusive:i.inclusive,message:i.message}),a.dirty()):i.kind==="max"?(i.inclusive?t.data>i.value:t.data>=i.value)&&(n=this._getOrReturnCtx(t,n),be(n,{code:ve.too_big,type:"bigint",maximum:i.value,inclusive:i.inclusive,message:i.message}),a.dirty()):i.kind==="multipleOf"?t.data%i.value!==BigInt(0)&&(n=this._getOrReturnCtx(t,n),be(n,{code:ve.not_multiple_of,multipleOf:i.value,message:i.message}),a.dirty()):ut.assertNever(i);return{status:a.value,value:t.data}}_getInvalidInput(t){const e=this._getOrReturnCtx(t);return be(e,{code:ve.invalid_type,expected:_e.bigint,received:e.parsedType}),Ve}gte(t,e){return this.setLimit("min",t,!0,Ae.toString(e))}gt(t,e){return this.setLimit("min",t,!1,Ae.toString(e))}lte(t,e){return this.setLimit("max",t,!0,Ae.toString(e))}lt(t,e){return this.setLimit("max",t,!1,Ae.toString(e))}setLimit(t,e,n,a){return new co({...this._def,checks:[...this._def.checks,{kind:t,value:e,inclusive:n,message:Ae.toString(a)}]})}_addCheck(t){return new co({...this._def,checks:[...this._def.checks,t]})}positive(t){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:Ae.toString(t)})}negative(t){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:Ae.toString(t)})}nonpositive(t){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:Ae.toString(t)})}nonnegative(t){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:Ae.toString(t)})}multipleOf(t,e){return this._addCheck({kind:"multipleOf",value:t,message:Ae.toString(e)})}get minValue(){let t=null;for(const e of this._def.checks)e.kind==="min"&&(t===null||e.value>t)&&(t=e.value);return t}get maxValue(){let t=null;for(const e of this._def.checks)e.kind==="max"&&(t===null||e.value<t)&&(t=e.value);return t}}co.create=r=>{var t;return new co({checks:[],typeName:ze.ZodBigInt,coerce:(t=r==null?void 0:r.coerce)!==null&&t!==void 0?t:!1,...Ke(r)})};class wc extends Qe{_parse(t){if(this._def.coerce&&(t.data=!!t.data),this._getType(t)!==_e.boolean){const n=this._getOrReturnCtx(t);return be(n,{code:ve.invalid_type,expected:_e.boolean,received:n.parsedType}),Ve}return zn(t.data)}}wc.create=r=>new wc({typeName:ze.ZodBoolean,coerce:(r==null?void 0:r.coerce)||!1,...Ke(r)});class os extends Qe{_parse(t){if(this._def.coerce&&(t.data=new Date(t.data)),this._getType(t)!==_e.date){const i=this._getOrReturnCtx(t);return be(i,{code:ve.invalid_type,expected:_e.date,received:i.parsedType}),Ve}if(isNaN(t.data.getTime())){const i=this._getOrReturnCtx(t);return be(i,{code:ve.invalid_date}),Ve}const n=new In;let a;for(const i of this._def.checks)i.kind==="min"?t.data.getTime()<i.value&&(a=this._getOrReturnCtx(t,a),be(a,{code:ve.too_small,message:i.message,inclusive:!0,exact:!1,minimum:i.value,type:"date"}),n.dirty()):i.kind==="max"?t.data.getTime()>i.value&&(a=this._getOrReturnCtx(t,a),be(a,{code:ve.too_big,message:i.message,inclusive:!0,exact:!1,maximum:i.value,type:"date"}),n.dirty()):ut.assertNever(i);return{status:n.value,value:new Date(t.data.getTime())}}_addCheck(t){return new os({...this._def,checks:[...this._def.checks,t]})}min(t,e){return this._addCheck({kind:"min",value:t.getTime(),message:Ae.toString(e)})}max(t,e){return this._addCheck({kind:"max",value:t.getTime(),message:Ae.toString(e)})}get minDate(){let t=null;for(const e of this._def.checks)e.kind==="min"&&(t===null||e.value>t)&&(t=e.value);return t!=null?new Date(t):null}get maxDate(){let t=null;for(const e of this._def.checks)e.kind==="max"&&(t===null||e.value<t)&&(t=e.value);return t!=null?new Date(t):null}}os.create=r=>new os({checks:[],coerce:(r==null?void 0:r.coerce)||!1,typeName:ze.ZodDate,...Ke(r)});class hd extends Qe{_parse(t){if(this._getType(t)!==_e.symbol){const n=this._getOrReturnCtx(t);return be(n,{code:ve.invalid_type,expected:_e.symbol,received:n.parsedType}),Ve}return zn(t.data)}}hd.create=r=>new hd({typeName:ze.ZodSymbol,...Ke(r)});class _c extends Qe{_parse(t){if(this._getType(t)!==_e.undefined){const n=this._getOrReturnCtx(t);return be(n,{code:ve.invalid_type,expected:_e.undefined,received:n.parsedType}),Ve}return zn(t.data)}}_c.create=r=>new _c({typeName:ze.ZodUndefined,...Ke(r)});class Sc extends Qe{_parse(t){if(this._getType(t)!==_e.null){const n=this._getOrReturnCtx(t);return be(n,{code:ve.invalid_type,expected:_e.null,received:n.parsedType}),Ve}return zn(t.data)}}Sc.create=r=>new Sc({typeName:ze.ZodNull,...Ke(r)});class ju extends Qe{constructor(){super(...arguments),this._any=!0}_parse(t){return zn(t.data)}}ju.create=r=>new ju({typeName:ze.ZodAny,...Ke(r)});class Jo extends Qe{constructor(){super(...arguments),this._unknown=!0}_parse(t){return zn(t.data)}}Jo.create=r=>new Jo({typeName:ze.ZodUnknown,...Ke(r)});class ii extends Qe{_parse(t){const e=this._getOrReturnCtx(t);return be(e,{code:ve.invalid_type,expected:_e.never,received:e.parsedType}),Ve}}ii.create=r=>new ii({typeName:ze.ZodNever,...Ke(r)});class dd extends Qe{_parse(t){if(this._getType(t)!==_e.undefined){const n=this._getOrReturnCtx(t);return be(n,{code:ve.invalid_type,expected:_e.void,received:n.parsedType}),Ve}return zn(t.data)}}dd.create=r=>new dd({typeName:ze.ZodVoid,...Ke(r)});class Xr extends Qe{_parse(t){const{ctx:e,status:n}=this._processInputParams(t),a=this._def;if(e.parsedType!==_e.array)return be(e,{code:ve.invalid_type,expected:_e.array,received:e.parsedType}),Ve;if(a.exactLength!==null){const s=e.data.length>a.exactLength.value,l=e.data.length<a.exactLength.value;(s||l)&&(be(e,{code:s?ve.too_big:ve.too_small,minimum:l?a.exactLength.value:void 0,maximum:s?a.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:a.exactLength.message}),n.dirty())}if(a.minLength!==null&&e.data.length<a.minLength.value&&(be(e,{code:ve.too_small,minimum:a.minLength.value,type:"array",inclusive:!0,exact:!1,message:a.minLength.message}),n.dirty()),a.maxLength!==null&&e.data.length>a.maxLength.value&&(be(e,{code:ve.too_big,maximum:a.maxLength.value,type:"array",inclusive:!0,exact:!1,message:a.maxLength.message}),n.dirty()),e.common.async)return Promise.all([...e.data].map((s,l)=>a.type._parseAsync(new _a(e,s,e.path,l)))).then(s=>In.mergeArray(n,s));const i=[...e.data].map((s,l)=>a.type._parseSync(new _a(e,s,e.path,l)));return In.mergeArray(n,i)}get element(){return this._def.type}min(t,e){return new Xr({...this._def,minLength:{value:t,message:Ae.toString(e)}})}max(t,e){return new Xr({...this._def,maxLength:{value:t,message:Ae.toString(e)}})}length(t,e){return new Xr({...this._def,exactLength:{value:t,message:Ae.toString(e)}})}nonempty(t){return this.min(1,t)}}Xr.create=(r,t)=>new Xr({type:r,minLength:null,maxLength:null,exactLength:null,typeName:ze.ZodArray,...Ke(t)});function su(r){if(r instanceof Nt){const t={};for(const e in r.shape){const n=r.shape[e];t[e]=ya.create(su(n))}return new Nt({...r._def,shape:()=>t})}else return r instanceof Xr?new Xr({...r._def,type:su(r.element)}):r instanceof ya?ya.create(su(r.unwrap())):r instanceof ho?ho.create(su(r.unwrap())):r instanceof Sa?Sa.create(r.items.map(t=>su(t))):r}class Nt extends Qe{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const t=this._def.shape(),e=ut.objectKeys(t);return this._cached={shape:t,keys:e}}_parse(t){if(this._getType(t)!==_e.object){const f=this._getOrReturnCtx(t);return be(f,{code:ve.invalid_type,expected:_e.object,received:f.parsedType}),Ve}const{status:n,ctx:a}=this._processInputParams(t),{shape:i,keys:s}=this._getCached(),l=[];if(!(this._def.catchall instanceof ii&&this._def.unknownKeys==="strip"))for(const f in a.data)s.includes(f)||l.push(f);const c=[];for(const f of s){const d=i[f],v=a.data[f];c.push({key:{status:"valid",value:f},value:d._parse(new _a(a,v,a.path,f)),alwaysSet:f in a.data})}if(this._def.catchall instanceof ii){const f=this._def.unknownKeys;if(f==="passthrough")for(const d of l)c.push({key:{status:"valid",value:d},value:{status:"valid",value:a.data[d]}});else if(f==="strict")l.length>0&&(be(a,{code:ve.unrecognized_keys,keys:l}),n.dirty());else if(f!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const f=this._def.catchall;for(const d of l){const v=a.data[d];c.push({key:{status:"valid",value:d},value:f._parse(new _a(a,v,a.path,d)),alwaysSet:d in a.data})}}return a.common.async?Promise.resolve().then(async()=>{const f=[];for(const d of c){const v=await d.key,m=await d.value;f.push({key:v,value:m,alwaysSet:d.alwaysSet})}return f}).then(f=>In.mergeObjectSync(n,f)):In.mergeObjectSync(n,c)}get shape(){return this._def.shape()}strict(t){return Ae.errToObj,new Nt({...this._def,unknownKeys:"strict",...t!==void 0?{errorMap:(e,n)=>{var a,i,s,l;const c=(s=(i=(a=this._def).errorMap)===null||i===void 0?void 0:i.call(a,e,n).message)!==null&&s!==void 0?s:n.defaultError;return e.code==="unrecognized_keys"?{message:(l=Ae.errToObj(t).message)!==null&&l!==void 0?l:c}:{message:c}}}:{}})}strip(){return new Nt({...this._def,unknownKeys:"strip"})}passthrough(){return new Nt({...this._def,unknownKeys:"passthrough"})}extend(t){return new Nt({...this._def,shape:()=>({...this._def.shape(),...t})})}merge(t){return new Nt({unknownKeys:t._def.unknownKeys,catchall:t._def.catchall,shape:()=>({...this._def.shape(),...t._def.shape()}),typeName:ze.ZodObject})}setKey(t,e){return this.augment({[t]:e})}catchall(t){return new Nt({...this._def,catchall:t})}pick(t){const e={};return ut.objectKeys(t).forEach(n=>{t[n]&&this.shape[n]&&(e[n]=this.shape[n])}),new Nt({...this._def,shape:()=>e})}omit(t){const e={};return ut.objectKeys(this.shape).forEach(n=>{t[n]||(e[n]=this.shape[n])}),new Nt({...this._def,shape:()=>e})}deepPartial(){return su(this)}partial(t){const e={};return ut.objectKeys(this.shape).forEach(n=>{const a=this.shape[n];t&&!t[n]?e[n]=a:e[n]=a.optional()}),new Nt({...this._def,shape:()=>e})}required(t){const e={};return ut.objectKeys(this.shape).forEach(n=>{if(t&&!t[n])e[n]=this.shape[n];else{let i=this.shape[n];for(;i instanceof ya;)i=i._def.innerType;e[n]=i}}),new Nt({...this._def,shape:()=>e})}keyof(){return EE(ut.objectKeys(this.shape))}}Nt.create=(r,t)=>new Nt({shape:()=>r,unknownKeys:"strip",catchall:ii.create(),typeName:ze.ZodObject,...Ke(t)});Nt.strictCreate=(r,t)=>new Nt({shape:()=>r,unknownKeys:"strict",catchall:ii.create(),typeName:ze.ZodObject,...Ke(t)});Nt.lazycreate=(r,t)=>new Nt({shape:r,unknownKeys:"strip",catchall:ii.create(),typeName:ze.ZodObject,...Ke(t)});class Ec extends Qe{_parse(t){const{ctx:e}=this._processInputParams(t),n=this._def.options;function a(i){for(const l of i)if(l.result.status==="valid")return l.result;for(const l of i)if(l.result.status==="dirty")return e.common.issues.push(...l.ctx.common.issues),l.result;const s=i.map(l=>new pr(l.ctx.common.issues));return be(e,{code:ve.invalid_union,unionErrors:s}),Ve}if(e.common.async)return Promise.all(n.map(async i=>{const s={...e,common:{...e.common,issues:[]},parent:null};return{result:await i._parseAsync({data:e.data,path:e.path,parent:s}),ctx:s}})).then(a);{let i;const s=[];for(const c of n){const f={...e,common:{...e.common,issues:[]},parent:null},d=c._parseSync({data:e.data,path:e.path,parent:f});if(d.status==="valid")return d;d.status==="dirty"&&!i&&(i={result:d,ctx:f}),f.common.issues.length&&s.push(f.common.issues)}if(i)return e.common.issues.push(...i.ctx.common.issues),i.result;const l=s.map(c=>new pr(c));return be(e,{code:ve.invalid_union,unionErrors:l}),Ve}}get options(){return this._def.options}}Ec.create=(r,t)=>new Ec({options:r,typeName:ze.ZodUnion,...Ke(t)});const $a=r=>r instanceof Tc?$a(r.schema):r instanceof Zr?$a(r.innerType()):r instanceof Ac?[r.value]:r instanceof fo?r.options:r instanceof Dc?ut.objectValues(r.enum):r instanceof kc?$a(r._def.innerType):r instanceof _c?[void 0]:r instanceof Sc?[null]:r instanceof ya?[void 0,...$a(r.unwrap())]:r instanceof ho?[null,...$a(r.unwrap())]:r instanceof Uy||r instanceof Nc?$a(r.unwrap()):r instanceof Oc?$a(r._def.innerType):[];class Kd extends Qe{_parse(t){const{ctx:e}=this._processInputParams(t);if(e.parsedType!==_e.object)return be(e,{code:ve.invalid_type,expected:_e.object,received:e.parsedType}),Ve;const n=this.discriminator,a=e.data[n],i=this.optionsMap.get(a);return i?e.common.async?i._parseAsync({data:e.data,path:e.path,parent:e}):i._parseSync({data:e.data,path:e.path,parent:e}):(be(e,{code:ve.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[n]}),Ve)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(t,e,n){const a=new Map;for(const i of e){const s=$a(i.shape[t]);if(!s.length)throw new Error(`A discriminator value for key \`${t}\` could not be extracted from all schema options`);for(const l of s){if(a.has(l))throw new Error(`Discriminator property ${String(t)} has duplicate value ${String(l)}`);a.set(l,i)}}return new Kd({typeName:ze.ZodDiscriminatedUnion,discriminator:t,options:e,optionsMap:a,...Ke(n)})}}function Jg(r,t){const e=Qa(r),n=Qa(t);if(r===t)return{valid:!0,data:r};if(e===_e.object&&n===_e.object){const a=ut.objectKeys(t),i=ut.objectKeys(r).filter(l=>a.indexOf(l)!==-1),s={...r,...t};for(const l of i){const c=Jg(r[l],t[l]);if(!c.valid)return{valid:!1};s[l]=c.data}return{valid:!0,data:s}}else if(e===_e.array&&n===_e.array){if(r.length!==t.length)return{valid:!1};const a=[];for(let i=0;i<r.length;i++){const s=r[i],l=t[i],c=Jg(s,l);if(!c.valid)return{valid:!1};a.push(c.data)}return{valid:!0,data:a}}else return e===_e.date&&n===_e.date&&+r==+t?{valid:!0,data:r}:{valid:!1}}class Cc extends Qe{_parse(t){const{status:e,ctx:n}=this._processInputParams(t),a=(i,s)=>{if(Zg(i)||Zg(s))return Ve;const l=Jg(i.value,s.value);return l.valid?((Qg(i)||Qg(s))&&e.dirty(),{status:e.value,value:l.data}):(be(n,{code:ve.invalid_intersection_types}),Ve)};return n.common.async?Promise.all([this._def.left._parseAsync({data:n.data,path:n.path,parent:n}),this._def.right._parseAsync({data:n.data,path:n.path,parent:n})]).then(([i,s])=>a(i,s)):a(this._def.left._parseSync({data:n.data,path:n.path,parent:n}),this._def.right._parseSync({data:n.data,path:n.path,parent:n}))}}Cc.create=(r,t,e)=>new Cc({left:r,right:t,typeName:ze.ZodIntersection,...Ke(e)});class Sa extends Qe{_parse(t){const{status:e,ctx:n}=this._processInputParams(t);if(n.parsedType!==_e.array)return be(n,{code:ve.invalid_type,expected:_e.array,received:n.parsedType}),Ve;if(n.data.length<this._def.items.length)return be(n,{code:ve.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),Ve;!this._def.rest&&n.data.length>this._def.items.length&&(be(n,{code:ve.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),e.dirty());const i=[...n.data].map((s,l)=>{const c=this._def.items[l]||this._def.rest;return c?c._parse(new _a(n,s,n.path,l)):null}).filter(s=>!!s);return n.common.async?Promise.all(i).then(s=>In.mergeArray(e,s)):In.mergeArray(e,i)}get items(){return this._def.items}rest(t){return new Sa({...this._def,rest:t})}}Sa.create=(r,t)=>{if(!Array.isArray(r))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new Sa({items:r,typeName:ze.ZodTuple,rest:null,...Ke(t)})};class Rc extends Qe{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(t){const{status:e,ctx:n}=this._processInputParams(t);if(n.parsedType!==_e.object)return be(n,{code:ve.invalid_type,expected:_e.object,received:n.parsedType}),Ve;const a=[],i=this._def.keyType,s=this._def.valueType;for(const l in n.data)a.push({key:i._parse(new _a(n,l,n.path,l)),value:s._parse(new _a(n,n.data[l],n.path,l)),alwaysSet:l in n.data});return n.common.async?In.mergeObjectAsync(e,a):In.mergeObjectSync(e,a)}get element(){return this._def.valueType}static create(t,e,n){return e instanceof Qe?new Rc({keyType:t,valueType:e,typeName:ze.ZodRecord,...Ke(n)}):new Rc({keyType:Gr.create(),valueType:t,typeName:ze.ZodRecord,...Ke(e)})}}class pd extends Qe{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(t){const{status:e,ctx:n}=this._processInputParams(t);if(n.parsedType!==_e.map)return be(n,{code:ve.invalid_type,expected:_e.map,received:n.parsedType}),Ve;const a=this._def.keyType,i=this._def.valueType,s=[...n.data.entries()].map(([l,c],f)=>({key:a._parse(new _a(n,l,n.path,[f,"key"])),value:i._parse(new _a(n,c,n.path,[f,"value"]))}));if(n.common.async){const l=new Map;return Promise.resolve().then(async()=>{for(const c of s){const f=await c.key,d=await c.value;if(f.status==="aborted"||d.status==="aborted")return Ve;(f.status==="dirty"||d.status==="dirty")&&e.dirty(),l.set(f.value,d.value)}return{status:e.value,value:l}})}else{const l=new Map;for(const c of s){const f=c.key,d=c.value;if(f.status==="aborted"||d.status==="aborted")return Ve;(f.status==="dirty"||d.status==="dirty")&&e.dirty(),l.set(f.value,d.value)}return{status:e.value,value:l}}}}pd.create=(r,t,e)=>new pd({valueType:t,keyType:r,typeName:ze.ZodMap,...Ke(e)});class ss extends Qe{_parse(t){const{status:e,ctx:n}=this._processInputParams(t);if(n.parsedType!==_e.set)return be(n,{code:ve.invalid_type,expected:_e.set,received:n.parsedType}),Ve;const a=this._def;a.minSize!==null&&n.data.size<a.minSize.value&&(be(n,{code:ve.too_small,minimum:a.minSize.value,type:"set",inclusive:!0,exact:!1,message:a.minSize.message}),e.dirty()),a.maxSize!==null&&n.data.size>a.maxSize.value&&(be(n,{code:ve.too_big,maximum:a.maxSize.value,type:"set",inclusive:!0,exact:!1,message:a.maxSize.message}),e.dirty());const i=this._def.valueType;function s(c){const f=new Set;for(const d of c){if(d.status==="aborted")return Ve;d.status==="dirty"&&e.dirty(),f.add(d.value)}return{status:e.value,value:f}}const l=[...n.data.values()].map((c,f)=>i._parse(new _a(n,c,n.path,f)));return n.common.async?Promise.all(l).then(c=>s(c)):s(l)}min(t,e){return new ss({...this._def,minSize:{value:t,message:Ae.toString(e)}})}max(t,e){return new ss({...this._def,maxSize:{value:t,message:Ae.toString(e)}})}size(t,e){return this.min(t,e).max(t,e)}nonempty(t){return this.min(1,t)}}ss.create=(r,t)=>new ss({valueType:r,minSize:null,maxSize:null,typeName:ze.ZodSet,...Ke(t)});class vu extends Qe{constructor(){super(...arguments),this.validate=this.implement}_parse(t){const{ctx:e}=this._processInputParams(t);if(e.parsedType!==_e.function)return be(e,{code:ve.invalid_type,expected:_e.function,received:e.parsedType}),Ve;function n(l,c){return cd({data:l,path:e.path,errorMaps:[e.common.contextualErrorMap,e.schemaErrorMap,ld(),Hu].filter(f=>!!f),issueData:{code:ve.invalid_arguments,argumentsError:c}})}function a(l,c){return cd({data:l,path:e.path,errorMaps:[e.common.contextualErrorMap,e.schemaErrorMap,ld(),Hu].filter(f=>!!f),issueData:{code:ve.invalid_return_type,returnTypeError:c}})}const i={errorMap:e.common.contextualErrorMap},s=e.data;if(this._def.returns instanceof Wu){const l=this;return zn(async function(...c){const f=new pr([]),d=await l._def.args.parseAsync(c,i).catch(g=>{throw f.addIssue(n(c,g)),f}),v=await Reflect.apply(s,this,d);return await l._def.returns._def.type.parseAsync(v,i).catch(g=>{throw f.addIssue(a(v,g)),f})})}else{const l=this;return zn(function(...c){const f=l._def.args.safeParse(c,i);if(!f.success)throw new pr([n(c,f.error)]);const d=Reflect.apply(s,this,f.data),v=l._def.returns.safeParse(d,i);if(!v.success)throw new pr([a(d,v.error)]);return v.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...t){return new vu({...this._def,args:Sa.create(t).rest(Jo.create())})}returns(t){return new vu({...this._def,returns:t})}implement(t){return this.parse(t)}strictImplement(t){return this.parse(t)}static create(t,e,n){return new vu({args:t||Sa.create([]).rest(Jo.create()),returns:e||Jo.create(),typeName:ze.ZodFunction,...Ke(n)})}}class Tc extends Qe{get schema(){return this._def.getter()}_parse(t){const{ctx:e}=this._processInputParams(t);return this._def.getter()._parse({data:e.data,path:e.path,parent:e})}}Tc.create=(r,t)=>new Tc({getter:r,typeName:ze.ZodLazy,...Ke(t)});class Ac extends Qe{_parse(t){if(t.data!==this._def.value){const e=this._getOrReturnCtx(t);return be(e,{received:e.data,code:ve.invalid_literal,expected:this._def.value}),Ve}return{status:"valid",value:t.data}}get value(){return this._def.value}}Ac.create=(r,t)=>new Ac({value:r,typeName:ze.ZodLiteral,...Ke(t)});function EE(r,t){return new fo({values:r,typeName:ze.ZodEnum,...Ke(t)})}class fo extends Qe{constructor(){super(...arguments),lc.set(this,void 0)}_parse(t){if(typeof t.data!="string"){const e=this._getOrReturnCtx(t),n=this._def.values;return be(e,{expected:ut.joinValues(n),received:e.parsedType,code:ve.invalid_type}),Ve}if(fd(this,lc)||xE(this,lc,new Set(this._def.values)),!fd(this,lc).has(t.data)){const e=this._getOrReturnCtx(t),n=this._def.values;return be(e,{received:e.data,code:ve.invalid_enum_value,options:n}),Ve}return zn(t.data)}get options(){return this._def.values}get enum(){const t={};for(const e of this._def.values)t[e]=e;return t}get Values(){const t={};for(const e of this._def.values)t[e]=e;return t}get Enum(){const t={};for(const e of this._def.values)t[e]=e;return t}extract(t,e=this._def){return fo.create(t,{...this._def,...e})}exclude(t,e=this._def){return fo.create(this.options.filter(n=>!t.includes(n)),{...this._def,...e})}}lc=new WeakMap;fo.create=EE;class Dc extends Qe{constructor(){super(...arguments),cc.set(this,void 0)}_parse(t){const e=ut.getValidEnumValues(this._def.values),n=this._getOrReturnCtx(t);if(n.parsedType!==_e.string&&n.parsedType!==_e.number){const a=ut.objectValues(e);return be(n,{expected:ut.joinValues(a),received:n.parsedType,code:ve.invalid_type}),Ve}if(fd(this,cc)||xE(this,cc,new Set(ut.getValidEnumValues(this._def.values))),!fd(this,cc).has(t.data)){const a=ut.objectValues(e);return be(n,{received:n.data,code:ve.invalid_enum_value,options:a}),Ve}return zn(t.data)}get enum(){return this._def.values}}cc=new WeakMap;Dc.create=(r,t)=>new Dc({values:r,typeName:ze.ZodNativeEnum,...Ke(t)});class Wu extends Qe{unwrap(){return this._def.type}_parse(t){const{ctx:e}=this._processInputParams(t);if(e.parsedType!==_e.promise&&e.common.async===!1)return be(e,{code:ve.invalid_type,expected:_e.promise,received:e.parsedType}),Ve;const n=e.parsedType===_e.promise?e.data:Promise.resolve(e.data);return zn(n.then(a=>this._def.type.parseAsync(a,{path:e.path,errorMap:e.common.contextualErrorMap})))}}Wu.create=(r,t)=>new Wu({type:r,typeName:ze.ZodPromise,...Ke(t)});class Zr extends Qe{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===ze.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(t){const{status:e,ctx:n}=this._processInputParams(t),a=this._def.effect||null,i={addIssue:s=>{be(n,s),s.fatal?e.abort():e.dirty()},get path(){return n.path}};if(i.addIssue=i.addIssue.bind(i),a.type==="preprocess"){const s=a.transform(n.data,i);if(n.common.async)return Promise.resolve(s).then(async l=>{if(e.value==="aborted")return Ve;const c=await this._def.schema._parseAsync({data:l,path:n.path,parent:n});return c.status==="aborted"?Ve:c.status==="dirty"||e.value==="dirty"?du(c.value):c});{if(e.value==="aborted")return Ve;const l=this._def.schema._parseSync({data:s,path:n.path,parent:n});return l.status==="aborted"?Ve:l.status==="dirty"||e.value==="dirty"?du(l.value):l}}if(a.type==="refinement"){const s=l=>{const c=a.refinement(l,i);if(n.common.async)return Promise.resolve(c);if(c instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return l};if(n.common.async===!1){const l=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});return l.status==="aborted"?Ve:(l.status==="dirty"&&e.dirty(),s(l.value),{status:e.value,value:l.value})}else return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(l=>l.status==="aborted"?Ve:(l.status==="dirty"&&e.dirty(),s(l.value).then(()=>({status:e.value,value:l.value}))))}if(a.type==="transform")if(n.common.async===!1){const s=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});if(!is(s))return s;const l=a.transform(s.value,i);if(l instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:e.value,value:l}}else return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(s=>is(s)?Promise.resolve(a.transform(s.value,i)).then(l=>({status:e.value,value:l})):s);ut.assertNever(a)}}Zr.create=(r,t,e)=>new Zr({schema:r,typeName:ze.ZodEffects,effect:t,...Ke(e)});Zr.createWithPreprocess=(r,t,e)=>new Zr({schema:t,effect:{type:"preprocess",transform:r},typeName:ze.ZodEffects,...Ke(e)});class ya extends Qe{_parse(t){return this._getType(t)===_e.undefined?zn(void 0):this._def.innerType._parse(t)}unwrap(){return this._def.innerType}}ya.create=(r,t)=>new ya({innerType:r,typeName:ze.ZodOptional,...Ke(t)});class ho extends Qe{_parse(t){return this._getType(t)===_e.null?zn(null):this._def.innerType._parse(t)}unwrap(){return this._def.innerType}}ho.create=(r,t)=>new ho({innerType:r,typeName:ze.ZodNullable,...Ke(t)});class kc extends Qe{_parse(t){const{ctx:e}=this._processInputParams(t);let n=e.data;return e.parsedType===_e.undefined&&(n=this._def.defaultValue()),this._def.innerType._parse({data:n,path:e.path,parent:e})}removeDefault(){return this._def.innerType}}kc.create=(r,t)=>new kc({innerType:r,typeName:ze.ZodDefault,defaultValue:typeof t.default=="function"?t.default:()=>t.default,...Ke(t)});class Oc extends Qe{_parse(t){const{ctx:e}=this._processInputParams(t),n={...e,common:{...e.common,issues:[]}},a=this._def.innerType._parse({data:n.data,path:n.path,parent:{...n}});return xc(a)?a.then(i=>({status:"valid",value:i.status==="valid"?i.value:this._def.catchValue({get error(){return new pr(n.common.issues)},input:n.data})})):{status:"valid",value:a.status==="valid"?a.value:this._def.catchValue({get error(){return new pr(n.common.issues)},input:n.data})}}removeCatch(){return this._def.innerType}}Oc.create=(r,t)=>new Oc({innerType:r,typeName:ze.ZodCatch,catchValue:typeof t.catch=="function"?t.catch:()=>t.catch,...Ke(t)});class vd extends Qe{_parse(t){if(this._getType(t)!==_e.nan){const n=this._getOrReturnCtx(t);return be(n,{code:ve.invalid_type,expected:_e.nan,received:n.parsedType}),Ve}return{status:"valid",value:t.data}}}vd.create=r=>new vd({typeName:ze.ZodNaN,...Ke(r)});const j3=Symbol("zod_brand");class Uy extends Qe{_parse(t){const{ctx:e}=this._processInputParams(t),n=e.data;return this._def.type._parse({data:n,path:e.path,parent:e})}unwrap(){return this._def.type}}class Yc extends Qe{_parse(t){const{status:e,ctx:n}=this._processInputParams(t);if(n.common.async)return(async()=>{const i=await this._def.in._parseAsync({data:n.data,path:n.path,parent:n});return i.status==="aborted"?Ve:i.status==="dirty"?(e.dirty(),du(i.value)):this._def.out._parseAsync({data:i.value,path:n.path,parent:n})})();{const a=this._def.in._parseSync({data:n.data,path:n.path,parent:n});return a.status==="aborted"?Ve:a.status==="dirty"?(e.dirty(),{status:"dirty",value:a.value}):this._def.out._parseSync({data:a.value,path:n.path,parent:n})}}static create(t,e){return new Yc({in:t,out:e,typeName:ze.ZodPipeline})}}class Nc extends Qe{_parse(t){const e=this._def.innerType._parse(t),n=a=>(is(a)&&(a.value=Object.freeze(a.value)),a);return xc(e)?e.then(a=>n(a)):n(e)}unwrap(){return this._def.innerType}}Nc.create=(r,t)=>new Nc({innerType:r,typeName:ze.ZodReadonly,...Ke(t)});function q2(r,t){const e=typeof r=="function"?r(t):typeof r=="string"?{message:r}:r;return typeof e=="string"?{message:e}:e}function CE(r,t={},e){return r?ju.create().superRefine((n,a)=>{var i,s;const l=r(n);if(l instanceof Promise)return l.then(c=>{var f,d;if(!c){const v=q2(t,n),m=(d=(f=v.fatal)!==null&&f!==void 0?f:e)!==null&&d!==void 0?d:!0;a.addIssue({code:"custom",...v,fatal:m})}});if(!l){const c=q2(t,n),f=(s=(i=c.fatal)!==null&&i!==void 0?i:e)!==null&&s!==void 0?s:!0;a.addIssue({code:"custom",...c,fatal:f})}}):ju.create()}const W3={object:Nt.lazycreate};var ze;(function(r){r.ZodString="ZodString",r.ZodNumber="ZodNumber",r.ZodNaN="ZodNaN",r.ZodBigInt="ZodBigInt",r.ZodBoolean="ZodBoolean",r.ZodDate="ZodDate",r.ZodSymbol="ZodSymbol",r.ZodUndefined="ZodUndefined",r.ZodNull="ZodNull",r.ZodAny="ZodAny",r.ZodUnknown="ZodUnknown",r.ZodNever="ZodNever",r.ZodVoid="ZodVoid",r.ZodArray="ZodArray",r.ZodObject="ZodObject",r.ZodUnion="ZodUnion",r.ZodDiscriminatedUnion="ZodDiscriminatedUnion",r.ZodIntersection="ZodIntersection",r.ZodTuple="ZodTuple",r.ZodRecord="ZodRecord",r.ZodMap="ZodMap",r.ZodSet="ZodSet",r.ZodFunction="ZodFunction",r.ZodLazy="ZodLazy",r.ZodLiteral="ZodLiteral",r.ZodEnum="ZodEnum",r.ZodEffects="ZodEffects",r.ZodNativeEnum="ZodNativeEnum",r.ZodOptional="ZodOptional",r.ZodNullable="ZodNullable",r.ZodDefault="ZodDefault",r.ZodCatch="ZodCatch",r.ZodPromise="ZodPromise",r.ZodBranded="ZodBranded",r.ZodPipeline="ZodPipeline",r.ZodReadonly="ZodReadonly"})(ze||(ze={}));const G3=(r,t={message:`Input not instance of ${r.name}`})=>CE(e=>e instanceof r,t),RE=Gr.create,TE=lo.create,q3=vd.create,K3=co.create,AE=wc.create,X3=os.create,$3=hd.create,Y3=_c.create,Z3=Sc.create,Q3=ju.create,J3=Jo.create,e4=ii.create,t4=dd.create,n4=Xr.create,r4=Nt.create,a4=Nt.strictCreate,i4=Ec.create,o4=Kd.create,s4=Cc.create,u4=Sa.create,l4=Rc.create,c4=pd.create,f4=ss.create,h4=vu.create,d4=Tc.create,p4=Ac.create,v4=fo.create,m4=Dc.create,g4=Wu.create,K2=Zr.create,y4=ya.create,b4=ho.create,x4=Zr.createWithPreprocess,w4=Yc.create,_4=()=>RE().optional(),S4=()=>TE().optional(),E4=()=>AE().optional(),C4={string:r=>Gr.create({...r,coerce:!0}),number:r=>lo.create({...r,coerce:!0}),boolean:r=>wc.create({...r,coerce:!0}),bigint:r=>co.create({...r,coerce:!0}),date:r=>os.create({...r,coerce:!0})},R4=Ve;var b6=Object.freeze({__proto__:null,defaultErrorMap:Hu,setErrorMap:x3,getErrorMap:ld,makeIssue:cd,EMPTY_PATH:w3,addIssueToContext:be,ParseStatus:In,INVALID:Ve,DIRTY:du,OK:zn,isAborted:Zg,isDirty:Qg,isValid:is,isAsync:xc,get util(){return ut},get objectUtil(){return Yg},ZodParsedType:_e,getParsedType:Qa,ZodType:Qe,datetimeRegex:SE,ZodString:Gr,ZodNumber:lo,ZodBigInt:co,ZodBoolean:wc,ZodDate:os,ZodSymbol:hd,ZodUndefined:_c,ZodNull:Sc,ZodAny:ju,ZodUnknown:Jo,ZodNever:ii,ZodVoid:dd,ZodArray:Xr,ZodObject:Nt,ZodUnion:Ec,ZodDiscriminatedUnion:Kd,ZodIntersection:Cc,ZodTuple:Sa,ZodRecord:Rc,ZodMap:pd,ZodSet:ss,ZodFunction:vu,ZodLazy:Tc,ZodLiteral:Ac,ZodEnum:fo,ZodNativeEnum:Dc,ZodPromise:Wu,ZodEffects:Zr,ZodTransformer:Zr,ZodOptional:ya,ZodNullable:ho,ZodDefault:kc,ZodCatch:Oc,ZodNaN:vd,BRAND:j3,ZodBranded:Uy,ZodPipeline:Yc,ZodReadonly:Nc,custom:CE,Schema:Qe,ZodSchema:Qe,late:W3,get ZodFirstPartyTypeKind(){return ze},coerce:C4,any:Q3,array:n4,bigint:K3,boolean:AE,date:X3,discriminatedUnion:o4,effect:K2,enum:v4,function:h4,instanceof:G3,intersection:s4,lazy:d4,literal:p4,map:c4,nan:q3,nativeEnum:m4,never:e4,null:Z3,nullable:b4,number:TE,object:r4,oboolean:E4,onumber:S4,optional:y4,ostring:_4,pipeline:w4,preprocess:x4,promise:g4,record:l4,set:f4,strictObject:a4,string:RE,symbol:$3,transformer:K2,tuple:u4,undefined:Y3,union:i4,unknown:J3,void:t4,NEVER:R4,ZodIssueCode:ve,quotelessJson:b3,ZodError:pr});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var DE=function(r,t){return(DE=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var a in n)n.hasOwnProperty(a)&&(e[a]=n[a])})(r,t)};function Qr(r,t){function e(){this.constructor=r}DE(r,t),r.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}function Ce(r,t,e,n){return new(e||(e=Promise))(function(a,i){function s(f){try{c(n.next(f))}catch(d){i(d)}}function l(f){try{c(n.throw(f))}catch(d){i(d)}}function c(f){f.done?a(f.value):new e(function(d){d(f.value)}).then(s,l)}c((n=n.apply(r,[])).next())})}function Re(r,t){var e,n,a,i,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},typeof Symbol=="function"&&(i[Symbol.iterator]=function(){return this}),i;function l(c){return function(f){return function(d){if(e)throw new TypeError("Generator is already executing.");for(;s;)try{if(e=1,n&&(a=2&d[0]?n.return:d[0]?n.throw||((a=n.return)&&a.call(n),0):n.next)&&!(a=a.call(n,d[1])).done)return a;switch(n=0,a&&(d=[2&d[0],a.value]),d[0]){case 0:case 1:a=d;break;case 4:return s.label++,{value:d[1],done:!1};case 5:s.label++,n=d[1],d=[0];continue;case 7:d=s.ops.pop(),s.trys.pop();continue;default:if(!(a=(a=s.trys).length>0&&a[a.length-1])&&(d[0]===6||d[0]===2)){s=0;continue}if(d[0]===3&&(!a||d[1]>a[0]&&d[1]<a[3])){s.label=d[1];break}if(d[0]===6&&s.label<a[1]){s.label=a[1],a=d;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(d);break}a[2]&&s.ops.pop(),s.trys.pop();continue}d=t.call(r,s)}catch(v){d=[6,v],n=0}finally{e=a=0}if(5&d[0])throw d[1];return{value:d[0]?d[1]:void 0,done:!0}}([c,f])}}}var T4=function(){function r(t){this.global=t,this.flags={},this.flagRegistry={},this.urlFlags={},this.populateURLFlags()}return r.prototype.setPlatform=function(t,e){this.platform!=null&&console.warn("Platform "+this.platformName+" has already been set. Overwriting the platform with "+e+"."),this.platformName=t,this.platform=e},r.prototype.registerFlag=function(t,e,n){if(this.flagRegistry[t]={evaluationFn:e,setHook:n},this.urlFlags[t]!=null){var a=this.urlFlags[t];console.warn("Setting feature override from URL "+t+": "+a+"."),this.set(t,a)}},r.prototype.get=function(t){return t in this.flags?this.flags[t]:(this.flags[t]=this.evaluateFlag(t),this.flags[t])},r.prototype.getNumber=function(t){return this.get(t)},r.prototype.getBool=function(t){return this.get(t)},r.prototype.getFlags=function(){return this.flags},Object.defineProperty(r.prototype,"features",{get:function(){return this.flags},enumerable:!0,configurable:!0}),r.prototype.set=function(t,e){if(this.flagRegistry[t]==null)throw new Error("Cannot set flag "+t+" as it has not been registered.");this.flags[t]=e,this.flagRegistry[t].setHook!=null&&this.flagRegistry[t].setHook(e)},r.prototype.evaluateFlag=function(t){if(this.flagRegistry[t]==null)throw new Error("Cannot evaluate flag '"+t+"': no evaluation function found.");return this.flagRegistry[t].evaluationFn()},r.prototype.setFlags=function(t){this.flags=Object.assign({},t)},r.prototype.reset=function(){this.flags={},this.urlFlags={},this.populateURLFlags()},r.prototype.populateURLFlags=function(){var t=this;if(this.global!==void 0&&this.global.location!==void 0&&this.global.location.search!==void 0){var e,n,a=(e=this.global.location.search,n={},e.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,function(i){for(var s=[],l=1;l<arguments.length;l++)s[l-1]=arguments[l];return A4(n,s[0],s[1]),s.join("=")}),n);"tfjsflags"in a&&a.tfjsflags.split(",").forEach(function(i){var s=i.split(":"),l=s[0],c=s[1];t.urlFlags[l]=function(f,d){if((d=d.toLowerCase())==="true"||d==="false")return d==="true";if(""+ +d===d)return+d;throw new Error("Could not parse value flag value "+d+" for flag "+f+".")}(l,c)})}},r}();function A4(r,t,e){r[decodeURIComponent(t)]=decodeURIComponent(e||"")}function le(){return kE}var kE=null,md=new Map,ey=new Map;function OE(r,t){var e=ME(r,t);return md.get(e)}function D4(r){return ey.get(r)}function X2(r){for(var t=md.entries(),e=[];;){var n=t.next(),a=n.done,i=n.value;if(a)break;var s=i[0],l=i[1];s.split("_")[0]===r&&e.push(l)}return e}function NE(r){var t=r.kernelName,e=r.backendName,n=ME(t,e);if(md.has(n))throw new Error("The kernel '"+t+"' for backend '"+e+"' is already registered");md.set(n,r)}function k4(r){var t=r.kernelName;ey.has(t)&&console.warn("Overriding the gradient for '"+t+"'"),ey.set(t,r)}function ME(r,t){return t+"_"+r}function ty(r,t,e){return Math.max(r,Math.min(t,e))}function IE(r){return r%2==0?r:r+1}function O4(r){for(var t=0,e=0;e<r.length;e++)t+=r[e];return t}function L(r,t){if(!r)throw new Error(typeof t=="string"?t:t())}function gt(r,t,e){e===void 0&&(e=""),L(vn(r,t),function(){return e+" Shapes "+r+" and "+t+" must match"})}function Ju(r){L(r!=null,function(){return"The input to the tensor constructor must be a non-null value."})}function Gu(r,t,e){if(t===void 0&&(t=[]),e===void 0&&(e=!1),t==null&&(t=[]),Array.isArray(r)||ba(r)&&!e)for(var n=0;n<r.length;++n)Gu(r[n],t,e);else t.push(r);return t}function Te(r){if(r.length===0)return 1;for(var t=r[0],e=1;e<r.length;e++)t*=r[e];return t}function vn(r,t){if(r===t)return!0;if(r==null||t==null||r.length!==t.length)return!1;for(var e=0;e<r.length;e++)if(r[e]!==t[e])return!1;return!0}function Wt(r){return r%1==0}function N4(r){if(Math.tanh!=null)return Math.tanh(r);if(r===1/0)return 1;if(r===-1/0)return-1;var t=Math.exp(2*r);return(t-1)/(t+1)}function ny(r){var t=Math.ceil(Math.sqrt(r));return[t,Math.ceil(r/t)]}function mu(r,t){return t<=r.length?r:r+" ".repeat(t-r.length)}function $2(r,t,e){return t===void 0&&(t=function(n){return 0}),new Promise(function(n,a){var i=0,s=function(){if(r())n();else{i++;var l=t(i);e!=null&&i>=e?a():setTimeout(s,l)}};s()})}function M4(r,t){for(var e=1,n=-1,a=0;a<r.length;++a)if(r[a]>=0)e*=r[a];else if(r[a]===-1){if(n!==-1)throw Error("Shapes can only have 1 implicit size. Found -1 at dim "+n+" and dim "+a);n=a}else if(r[a]<0)throw Error("Shapes can not be < 0. Found "+r[a]+" at dim "+a);if(n===-1){if(t>0&&t!==e)throw Error("Size("+t+") must match the product of shape "+r);return r}if(e===0)throw Error("Cannot infer the missing size in ["+r+"] when there are 0 elements");if(t%e!=0)throw Error("The implicit shape can't be a fractional number. Got "+t+" / "+e);var i=r.slice();return i[n]=t/e,i}function sn(r,t){var e=t.length;return L((r=r==null?t.map(function(n,a){return a}):[].concat(r)).every(function(n){return n>=-e&&n<e}),function(){return"All values in axis param must be in range [-"+e+", "+e+") but got axis "+r}),L(r.every(function(n){return Wt(n)}),function(){return"All values in axis param must be integers but got axis "+r}),r.map(function(n){return n<0?e+n:n})}function zo(r,t){for(var e=[],n=[],a=t!=null&&Array.isArray(t)&&t.length===0,i=t==null||a?null:sn(t,r).sort(),s=0,l=0;l<r.length;++l){if(i!=null){if(i[s]===l&&r[l]!==1)throw new Error("Can't squeeze axis "+l+" since its dim '"+r[l]+"' is not 1");(i[s]==null||i[s]>l)&&r[l]===1&&(e.push(r[l]),n.push(l)),i[s]<=l&&s++}r[l]!==1&&(e.push(r[l]),n.push(l))}return{newShape:e,keptDims:n}}function Mc(r,t){var e=null;if(r==null||r==="float32")e=new Float32Array(t);else if(r==="int32")e=new Int32Array(t);else{if(r!=="bool")throw new Error("Unknown data type "+r);e=new Uint8Array(t)}return e}function gd(r,t){var e=null;if(r==null||r==="float32")e=new Float32Array(t);else if(r==="int32")e=new Int32Array(t);else if(r==="bool")e=new Uint8Array(t);else{if(r!=="string")throw new Error("Unknown data type "+r);e=new Array(t)}return e}function I4(r,t){for(var e=0;e<r.length;e++){var n=r[e];if(isNaN(n)||!isFinite(n))throw Error("A tensor of type "+t+" being uploaded contains "+n+".")}}function F4(r){return r==="bool"||r==="complex64"||r==="float32"||r==="int32"||r==="string"}function B4(r,t){return t!=="complex64"&&(t!=="float32"||r==="complex64")&&(t!=="int32"||r==="float32"||r==="complex64")&&(t!=="bool"||r!=="bool")}function ba(r){return r instanceof Float32Array||r instanceof Int32Array||r instanceof Uint8Array}function FE(r){if(r==="float32"||r==="int32")return 4;if(r==="complex64")return 8;if(r==="bool")return 1;throw new Error("Unknown dtype "+r)}function L4(r){if(r==null)return 0;var t=0;return r.forEach(function(e){return t+=e.length}),t}function Vy(r){return typeof r=="string"||r instanceof String}function P4(r){return typeof r=="boolean"}function z4(r){return typeof r=="number"}function Zc(r){return Array.isArray(r)?Zc(r[0]):r instanceof Float32Array?"float32":r instanceof Int32Array||r instanceof Uint8Array?"int32":z4(r)?"float32":Vy(r)?"string":P4(r)?"bool":"float32"}function ry(r){return!!(r&&r.constructor&&r.call&&r.apply)}function ay(r,t){for(var e=t;e<r;++e)if(r%e==0)return e;return r}function xa(r){var t=r.length;if(t<2)return[];var e=new Array(t-1);e[t-2]=r[t-1];for(var n=t-3;n>=0;--n)e[n]=e[n+1]*r[n+1];return e}function BE(r,t,e){if(t==="string")throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(r)&&(r=Gu(r)),e&&I4(r,t),function(i,s){return i instanceof Float32Array&&s==="float32"||i instanceof Int32Array&&s==="int32"||i instanceof Uint8Array&&s==="bool"}(r,t))return r;if(t==null||t==="float32"||t==="complex64")return new Float32Array(r);if(t==="int32")return new Int32Array(r);if(t==="bool"){for(var n=new Uint8Array(r.length),a=0;a<n.length;++a)Math.round(r[a])!==0&&(n[a]=1);return n}throw new Error("Unknown data type "+t)}function Y2(r,t){if(r.length===0)return t[0];var e=r.reduce(function(n,a){return n*a});if(e===0)return[];if(e!==t.length)throw new Error("["+r+"] does not match the input size.");return function n(a,i,s){var l=new Array;if(i.length===1)for(var c=i[0],f=0;f<c;f++)l[f]=s[a+f];else{c=i[0];var d=i.slice(1),v=d.reduce(function(m,g){return m*g});for(f=0;f<c;f++)l[f]=n(a+f*v,d,s)}return l}(0,r,t)}function LE(r,t){for(var e=Qc(r,t),n=0;n<e.length;n++)e[n]=1;return e}function Qc(r,t){if(t==null||t==="float32"||t==="complex64")return new Float32Array(r);if(t==="int32")return new Int32Array(r);if(t==="bool")return new Uint8Array(r);throw new Error("Unknown data type "+t)}function da(){return le().platform.now()}function PE(r){r.forEach(function(t){L(Number.isInteger(t)&&t>=0,function(){return"Tensor must have a shape comprised of positive integers but got shape ["+r+"]."})})}function U4(r,t){return t===void 0&&(t="utf-8"),t=t||"utf-8",le().platform.encode(r,t)}function yd(r,t){return t===void 0&&(t="utf-8"),t=t||"utf-8",le().platform.decode(r,t)}function Z2(r,t,e){if(t===0)return 0;if(t===1)return r[0];for(var n=r[r.length-1],a=0;a<r.length-1;++a)n+=e[a]*r[a];return n}function V4(r,t,e){if(t===0)return[];if(t===1)return[r];for(var n=new Array(t),a=0;a<n.length-1;++a)n[a]=Math.floor(r/e[a]),r-=n[a]*e[a];return n[n.length-1]=r,n}var H4=function(){function r(t,e){this.backendTimer=t,this.logger=e,e==null&&(this.logger=new j4)}return r.prototype.profileKernel=function(t,e,n){var a,i=this,s=this.backendTimer.time(function(){a=n()});return a.forEach(function(l){l.data().then(function(c){(function(f,d,v){if(d!=="float32")return!1;for(var m=0;m<f.length;m++){var g=f[m];if(isNaN(g)||!isFinite(g))return console.warn("Found "+g+" in the result of '"+v+"'"),!0}})(c,l.dtype,t),s.then(function(f){var d="";f.getExtraProfileInfo!=null&&(d=f.getExtraProfileInfo()),i.logger.logKernelProfile(t,l,c,f.kernelMs,e,d)})})}),a},r}(),j4=function(){function r(){}return r.prototype.logKernelProfile=function(t,e,n,a,i,s){var l=typeof a=="number"?mu(a+"ms",9):a.error,c=mu(t,25),f=e.rank,d=e.size,v=mu(e.shape.toString(),14),m="";for(var g in i){var b=i[g].shape||e.shape,w=b.length;m+=g+": "+w+"D "+(w>0?b:"")+" "}console.log("%c"+c+"	%c"+l+"	%c"+f+"D "+v+"	%c"+d+"	%c"+m+"	%c"+s,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")},r}(),Q2=20,nc=3,qm=7;function W4(r,t,e,n){var a=xa(t),i=function(f,d,v,m){var g=Te(d),b=m[m.length-1],w=new Array(b).fill(0),_=d.length,S=v==="complex64"?ac(f):f;if(_>1)for(var E=0;E<g/b;E++)for(var C=E*b,R=0;R<b;R++)w[R]=Math.max(w[R],rc(S[C+R],0,v).length);return w}(r,t,e,a),s=t.length,l=function f(d,v,m,g,b,w){w===void 0&&(w=!0);var _=m==="complex64"?2:1,S=v[0],E=v.length;if(E===0)return m==="complex64"?[rc(ac(d)[0],0,m)]:m==="bool"?[zE(d[0])]:[d[0].toString()];if(E===1){if(S>Q2){var C=nc*_,R=Array.from(d.slice(0,C)),T=Array.from(d.slice((S-nc)*_,S*_));return m==="complex64"&&(R=ac(R),T=ac(T)),["["+R.map(function(ee,U){return rc(ee,b[U],m)}).join(", ")+", ..., "+T.map(function(ee,U){return rc(ee,b[S-nc+U],m)}).join(", ")+"]"]}return["["+(m==="complex64"?ac(d):Array.from(d)).map(function(ee,U){return rc(ee,b[U],m)}).join(", ")+"]"]}var D=v.slice(1),k=g.slice(1),M=g[0]*_,N=[];if(S>Q2){for(var I=0;I<nc;I++){var z=(P=I*M)+M;N.push.apply(N,f(d.slice(P,z),D,m,k,b,!1))}for(N.push("..."),I=S-nc;I<S;I++)z=(P=I*M)+M,N.push.apply(N,f(d.slice(P,z),D,m,k,b,I===S-1))}else for(I=0;I<S;I++){var P;z=(P=I*M)+M,N.push.apply(N,f(d.slice(P,z),D,m,k,b,I===S-1))}var ne=E===2?",":"";for(N[0]="["+N[0]+ne,I=1;I<N.length-1;I++)N[I]=" "+N[I]+ne;var re=`,
`;for(I=2;I<E;I++)re+=`
`;return N[N.length-1]=" "+N[N.length-1]+"]"+(w?"":re),N}(r,t,e,a,i),c=["Tensor"];return n&&(c.push("  dtype: "+e),c.push("  rank: "+s),c.push("  shape: ["+t+"]"),c.push("  values:")),c.push(l.map(function(f){return"    "+f}).join(`
`)),c.join(`
`)}function rc(r,t,e){return mu(Array.isArray(r)?parseFloat(r[0].toFixed(qm))+" + "+parseFloat(r[1].toFixed(qm))+"j":Vy(r)?"'"+r+"'":e==="bool"?zE(r):parseFloat(r.toFixed(qm)).toString(),t)}function zE(r){return r===0?"false":"true"}function ac(r){for(var t=[],e=0;e<r.length;e+=2)t.push([r[e],r[e+1]]);return t}var Ic=function(){function r(t,e,n){var a=this;if(this.dtype=e,this.shape=t.slice(),this.size=Te(t),n!=null){var i=n.length;L(i===this.size,function(){return"Length of values '"+i+"' does not match the size inferred by the shape '"+a.size+"'."})}if(e==="complex64")throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=n||gd(e,this.size),this.strides=xa(t)}return r.prototype.set=function(t){for(var e=this,n=[],a=1;a<arguments.length;a++)n[a-1]=arguments[a];n.length===0&&(n=[0]),L(n.length===this.rank,function(){return"The number of provided coordinates ("+n.length+") must match the rank ("+e.rank+")"});var i=this.locToIndex(n);this.values[i]=t},r.prototype.get=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];t.length===0&&(t=[0]);for(var n=0,a=0,i=t;a<i.length;a++){var s=i[a];if(s<0||s>=this.shape[n]){var l="Requested out of range element at "+t+".   Buffer shape="+this.shape;throw new Error(l)}n++}for(var c=t[t.length-1],f=0;f<t.length-1;++f)c+=this.strides[f]*t[f];return this.values[c]},r.prototype.locToIndex=function(t){if(this.rank===0)return 0;if(this.rank===1)return t[0];for(var e=t[t.length-1],n=0;n<t.length-1;++n)e+=this.strides[n]*t[n];return e},r.prototype.indexToLoc=function(t){if(this.rank===0)return[];if(this.rank===1)return[t];for(var e=new Array(this.shape.length),n=0;n<e.length-1;++n)e[n]=Math.floor(t/this.strides[n]),t-=e[n]*this.strides[n];return e[e.length-1]=t,e},Object.defineProperty(r.prototype,"rank",{get:function(){return this.shape.length},enumerable:!0,configurable:!0}),r.prototype.toTensor=function(){return pa().makeTensor(this.values,this.shape,this.dtype)},r}(),pa=null,se=null,UE=null,Mt=function(){function r(t,e,n,a){this.kept=!1,this.isDisposedInternal=!1,this.shape=t.slice(),this.dtype=e||"float32",this.size=Te(t),this.strides=xa(t),this.dataId=n,this.id=a,this.rankType=this.rank<5?this.rank.toString():"higher"}return r.prototype.flatten=function(){return this.throwIfDisposed(),this.as1D()},r.prototype.asScalar=function(){return this.throwIfDisposed(),L(this.size===1,function(){return"The array must have only 1 element."}),this.reshape([])},r.prototype.as1D=function(){return this.throwIfDisposed(),this.reshape([this.size])},r.prototype.as2D=function(t,e){return this.throwIfDisposed(),this.reshape([t,e])},r.prototype.as3D=function(t,e,n){return this.throwIfDisposed(),this.reshape([t,e,n])},r.prototype.as4D=function(t,e,n,a){return this.throwIfDisposed(),this.reshape([t,e,n,a])},r.prototype.as5D=function(t,e,n,a,i){return this.throwIfDisposed(),this.reshape([t,e,n,a,i])},r.prototype.asType=function(t){return this.throwIfDisposed(),se.cast(this,t)},Object.defineProperty(r.prototype,"rank",{get:function(){return this.shape.length},enumerable:!0,configurable:!0}),r.prototype.buffer=function(){return Ce(this,void 0,void 0,function(){var t;return Re(this,function(e){switch(e.label){case 0:return[4,this.data()];case 1:return t=e.sent(),[2,se.buffer(this.shape,this.dtype,t)]}})})},r.prototype.bufferSync=function(){return se.buffer(this.shape,this.dtype,this.dataSync())},r.prototype.array=function(){return Ce(this,void 0,void 0,function(){var t;return Re(this,function(e){switch(e.label){case 0:return[4,this.data()];case 1:return t=e.sent(),[2,Y2(this.shape,t)]}})})},r.prototype.arraySync=function(){return Y2(this.shape,this.dataSync())},r.prototype.data=function(){return Ce(this,void 0,void 0,function(){var t,e;return Re(this,function(n){switch(n.label){case 0:return this.throwIfDisposed(),t=pa().read(this.dataId),this.dtype!=="string"?[3,2]:[4,t];case 1:e=n.sent();try{return[2,e.map(function(a){return yd(a)})]}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}n.label=2;case 2:return[2,t]}})})},r.prototype.dataSync=function(){this.throwIfDisposed();var t=pa().readSync(this.dataId);if(this.dtype==="string")try{return t.map(function(e){return yd(e)})}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return t},r.prototype.bytes=function(){return Ce(this,void 0,void 0,function(){var t;return Re(this,function(e){switch(e.label){case 0:return this.throwIfDisposed(),[4,pa().read(this.dataId)];case 1:return t=e.sent(),this.dtype==="string"?[2,t]:[2,new Uint8Array(t.buffer)]}})})},r.prototype.dispose=function(){this.isDisposed||(pa().disposeTensor(this),this.isDisposedInternal=!0)},Object.defineProperty(r.prototype,"isDisposed",{get:function(){return this.isDisposedInternal},enumerable:!0,configurable:!0}),r.prototype.throwIfDisposed=function(){if(this.isDisposed)throw new Error("Tensor is disposed.")},r.prototype.toFloat=function(){return this.asType("float32")},r.prototype.toInt=function(){return this.asType("int32")},r.prototype.toBool=function(){return this.asType("bool")},r.prototype.print=function(t){return t===void 0&&(t=!1),se.print(this,t)},r.prototype.reshape=function(t){return this.throwIfDisposed(),se.reshape(this,t)},r.prototype.reshapeAs=function(t){return this.throwIfDisposed(),this.reshape(t.shape)},r.prototype.expandDims=function(t){return t===void 0&&(t=0),se.expandDims(this,t)},r.prototype.cumsum=function(t,e,n){return t===void 0&&(t=0),e===void 0&&(e=!1),n===void 0&&(n=!1),se.cumsum(this,t,e,n)},r.prototype.squeeze=function(t){return this.throwIfDisposed(),se.squeeze(this,t)},r.prototype.clone=function(){return this.throwIfDisposed(),se.clone(this)},r.prototype.oneHot=function(t,e,n){return this.throwIfDisposed(),se.oneHot(this,t,e,n)},r.prototype.toString=function(t){return t===void 0&&(t=!1),W4(this.dataSync(),this.shape,this.dtype,t)},r.prototype.tile=function(t){return this.throwIfDisposed(),se.tile(this,t)},r.prototype.gather=function(t,e){return e===void 0&&(e=0),this.throwIfDisposed(),se.gather(this,t,e)},r.prototype.matMul=function(t,e,n){return e===void 0&&(e=!1),n===void 0&&(n=!1),this.throwIfDisposed(),se.matMul(this,t,e,n)},r.prototype.dot=function(t){return this.throwIfDisposed(),se.dot(this,t)},r.prototype.norm=function(t,e,n){return t===void 0&&(t="euclidean"),e===void 0&&(e=null),n===void 0&&(n=!1),this.throwIfDisposed(),se.norm(this,t,e,n)},r.prototype.slice=function(t,e){return this.throwIfDisposed(),se.slice(this,t,e)},r.prototype.reverse=function(t){return this.throwIfDisposed(),se.reverse(this,t)},r.prototype.concat=function(t,e){return e===void 0&&(e=0),this.throwIfDisposed(),t instanceof r&&(t=[t]),se.concat([this].concat(t),e)},r.prototype.split=function(t,e){return e===void 0&&(e=0),this.throwIfDisposed(),se.split(this,t,e)},r.prototype.stack=function(t,e){return e===void 0&&(e=0),se.stack([this,t],e)},r.prototype.unstack=function(t){return t===void 0&&(t=0),se.unstack(this,t)},r.prototype.pad=function(t,e){return e===void 0&&(e=0),se.pad(this,t,e)},r.prototype.batchNormalization=function(t,e,n,a,i){return n===void 0&&(n=.001),UE("tf.batchNormalization() is going away. Use tf.batchNorm() instead, and note the positional argument change of scale, offset, and varianceEpsilon"),this.batchNorm(t,e,i,a,n)},r.prototype.batchNorm=function(t,e,n,a,i){return i===void 0&&(i=.001),this.throwIfDisposed(),se.batchNorm(this,t,e,n,a,i)},r.prototype.all=function(t,e){return t===void 0&&(t=null),e===void 0&&(e=!1),this.throwIfDisposed(),se.all(this,t,e)},r.prototype.any=function(t,e){return t===void 0&&(t=null),e===void 0&&(e=!1),this.throwIfDisposed(),se.any(this,t,e)},r.prototype.logSumExp=function(t,e){return t===void 0&&(t=null),e===void 0&&(e=!1),this.throwIfDisposed(),se.logSumExp(this,t,e)},r.prototype.sum=function(t,e){return t===void 0&&(t=null),e===void 0&&(e=!1),this.throwIfDisposed(),se.sum(this,t,e)},r.prototype.prod=function(t,e){return t===void 0&&(t=null),e===void 0&&(e=!1),this.throwIfDisposed(),se.prod(this,t,e)},r.prototype.mean=function(t,e){return t===void 0&&(t=null),e===void 0&&(e=!1),this.throwIfDisposed(),se.mean(this,t,e)},r.prototype.min=function(t,e){return t===void 0&&(t=null),e===void 0&&(e=!1),this.throwIfDisposed(),se.min(this,t,e)},r.prototype.max=function(t,e){return t===void 0&&(t=null),e===void 0&&(e=!1),this.throwIfDisposed(),se.max(this,t,e)},r.prototype.argMin=function(t){return t===void 0&&(t=null),this.throwIfDisposed(),se.argMin(this,t)},r.prototype.argMax=function(t){return t===void 0&&(t=null),this.throwIfDisposed(),se.argMax(this,t)},r.prototype.cast=function(t){return this.throwIfDisposed(),se.cast(this,t)},r.prototype.add=function(t){return this.throwIfDisposed(),se.add(this,t)},r.prototype.addStrict=function(t){return this.throwIfDisposed(),se.addStrict(this,t)},r.prototype.atan2=function(t){return this.throwIfDisposed(),se.atan2(this,t)},r.prototype.sub=function(t){return this.throwIfDisposed(),se.sub(this,t)},r.prototype.subStrict=function(t){return this.throwIfDisposed(),se.subStrict(this,t)},r.prototype.pow=function(t){return this.throwIfDisposed(),se.pow(this,t)},r.prototype.powStrict=function(t){return this.throwIfDisposed(),se.powStrict(this,t)},r.prototype.mul=function(t){return this.throwIfDisposed(),se.mul(this,t)},r.prototype.mulStrict=function(t){return this.throwIfDisposed(),se.mulStrict(this,t)},r.prototype.div=function(t){return this.throwIfDisposed(),se.div(this,t)},r.prototype.divNoNan=function(t){return this.throwIfDisposed(),se.divNoNan(this,t)},r.prototype.floorDiv=function(t){return this.throwIfDisposed(),se.floorDiv(this,t)},r.prototype.divStrict=function(t){return this.throwIfDisposed(),se.divStrict(this,t)},r.prototype.minimum=function(t){return this.throwIfDisposed(),se.minimum(this,t)},r.prototype.minimumStrict=function(t){return this.throwIfDisposed(),se.minimumStrict(this,t)},r.prototype.maximum=function(t){return this.throwIfDisposed(),se.maximum(this,t)},r.prototype.maximumStrict=function(t){return this.throwIfDisposed(),se.maximumStrict(this,t)},r.prototype.mod=function(t){return this.throwIfDisposed(),se.mod(this,t)},r.prototype.modStrict=function(t){return this.throwIfDisposed(),se.modStrict(this,t)},r.prototype.squaredDifferenceStrict=function(t){return this.throwIfDisposed(),se.squaredDifferenceStrict(this,t)},r.prototype.transpose=function(t){return this.throwIfDisposed(),se.transpose(this,t)},r.prototype.notEqual=function(t){return this.throwIfDisposed(),se.notEqual(this,t)},r.prototype.notEqualStrict=function(t){return this.throwIfDisposed(),se.notEqualStrict(this,t)},r.prototype.less=function(t){return this.throwIfDisposed(),se.less(this,t)},r.prototype.lessStrict=function(t){return this.throwIfDisposed(),se.lessStrict(this,t)},r.prototype.equal=function(t){return this.throwIfDisposed(),se.equal(this,t)},r.prototype.equalStrict=function(t){return this.throwIfDisposed(),se.equalStrict(this,t)},r.prototype.lessEqual=function(t){return this.throwIfDisposed(),se.lessEqual(this,t)},r.prototype.lessEqualStrict=function(t){return this.throwIfDisposed(),se.lessEqualStrict(this,t)},r.prototype.greater=function(t){return this.throwIfDisposed(),se.greater(this,t)},r.prototype.greaterStrict=function(t){return this.throwIfDisposed(),se.greaterStrict(this,t)},r.prototype.greaterEqual=function(t){return this.throwIfDisposed(),se.greaterEqual(this,t)},r.prototype.greaterEqualStrict=function(t){return this.throwIfDisposed(),se.greaterEqualStrict(this,t)},r.prototype.logicalAnd=function(t){return this.throwIfDisposed(),se.logicalAnd(this,t)},r.prototype.logicalOr=function(t){return this.throwIfDisposed(),se.logicalOr(this,t)},r.prototype.logicalNot=function(){return this.throwIfDisposed(),se.logicalNot(this)},r.prototype.logicalXor=function(t){return this.throwIfDisposed(),se.logicalXor(this,t)},r.prototype.where=function(t,e){return this.throwIfDisposed(),se.where(t,this,e)},r.prototype.neg=function(){return this.throwIfDisposed(),se.neg(this)},r.prototype.ceil=function(){return this.throwIfDisposed(),se.ceil(this)},r.prototype.floor=function(){return this.throwIfDisposed(),se.floor(this)},r.prototype.sign=function(){return this.throwIfDisposed(),se.sign(this)},r.prototype.isNaN=function(){return this.throwIfDisposed(),se.isNaN(this)},r.prototype.isInf=function(){return this.throwIfDisposed(),se.isInf(this)},r.prototype.isFinite=function(){return this.throwIfDisposed(),se.isFinite(this)},r.prototype.exp=function(){return this.throwIfDisposed(),se.exp(this)},r.prototype.expm1=function(){return this.throwIfDisposed(),se.expm1(this)},r.prototype.log=function(){return this.throwIfDisposed(),se.log(this)},r.prototype.log1p=function(){return this.throwIfDisposed(),se.log1p(this)},r.prototype.sqrt=function(){return this.throwIfDisposed(),se.sqrt(this)},r.prototype.rsqrt=function(){return this.throwIfDisposed(),se.rsqrt(this)},r.prototype.square=function(){return this.throwIfDisposed(),se.square(this)},r.prototype.reciprocal=function(){return this.throwIfDisposed(),se.reciprocal(this)},r.prototype.abs=function(){return this.throwIfDisposed(),se.abs(this)},r.prototype.clipByValue=function(t,e){return this.throwIfDisposed(),se.clipByValue(this,t,e)},r.prototype.relu=function(){return this.throwIfDisposed(),se.relu(this)},r.prototype.relu6=function(){return this.throwIfDisposed(),se.relu6(this)},r.prototype.elu=function(){return this.throwIfDisposed(),se.elu(this)},r.prototype.selu=function(){return this.throwIfDisposed(),se.selu(this)},r.prototype.leakyRelu=function(t){return t===void 0&&(t=.2),this.throwIfDisposed(),se.leakyRelu(this,t)},r.prototype.prelu=function(t){return this.throwIfDisposed(),se.prelu(this,t)},r.prototype.sigmoid=function(){return this.throwIfDisposed(),se.sigmoid(this)},r.prototype.logSigmoid=function(){return this.throwIfDisposed(),se.logSigmoid(this)},r.prototype.softplus=function(){return this.throwIfDisposed(),se.softplus(this)},r.prototype.zerosLike=function(){return this.throwIfDisposed(),se.zerosLike(this)},r.prototype.onesLike=function(){return this.throwIfDisposed(),se.onesLike(this)},r.prototype.sin=function(){return this.throwIfDisposed(),se.sin(this)},r.prototype.cos=function(){return this.throwIfDisposed(),se.cos(this)},r.prototype.tan=function(){return this.throwIfDisposed(),se.tan(this)},r.prototype.asin=function(){return this.throwIfDisposed(),se.asin(this)},r.prototype.acos=function(){return this.throwIfDisposed(),se.acos(this)},r.prototype.atan=function(){return this.throwIfDisposed(),se.atan(this)},r.prototype.sinh=function(){return this.throwIfDisposed(),se.sinh(this)},r.prototype.cosh=function(){return this.throwIfDisposed(),se.cosh(this)},r.prototype.tanh=function(){return this.throwIfDisposed(),se.tanh(this)},r.prototype.asinh=function(){return this.throwIfDisposed(),se.asinh(this)},r.prototype.acosh=function(){return this.throwIfDisposed(),se.acosh(this)},r.prototype.atanh=function(){return this.throwIfDisposed(),se.atanh(this)},r.prototype.erf=function(){return this.throwIfDisposed(),se.erf(this)},r.prototype.round=function(){return this.throwIfDisposed(),se.round(this)},r.prototype.step=function(t){return t===void 0&&(t=0),this.throwIfDisposed(),se.step(this,t)},r.prototype.softmax=function(t){return t===void 0&&(t=-1),this.throwIfDisposed(),se.softmax(this,t)},r.prototype.logSoftmax=function(t){return t===void 0&&(t=-1),this.throwIfDisposed(),se.logSoftmax(this,t)},r.prototype.resizeBilinear=function(t,e){return e===void 0&&(e=!1),this.throwIfDisposed(),se.image.resizeBilinear(this,t,e)},r.prototype.resizeNearestNeighbor=function(t,e){return e===void 0&&(e=!1),this.throwIfDisposed(),se.image.resizeNearestNeighbor(this,t,e)},r.prototype.conv1d=function(t,e,n,a,i,s){return a===void 0&&(a="NWC"),i===void 0&&(i=1),this.throwIfDisposed(),se.conv1d(this,t,e,n,a,i,s)},r.prototype.conv2d=function(t,e,n,a,i,s){return a===void 0&&(a="NHWC"),i===void 0&&(i=[1,1]),this.throwIfDisposed(),se.conv2d(this,t,e,n,a,i,s)},r.prototype.conv2dTranspose=function(t,e,n,a,i){return this.throwIfDisposed(),se.conv2dTranspose(this,t,e,n,a,i)},r.prototype.depthwiseConv2D=function(t,e,n,a,i,s){return a===void 0&&(a="NHWC"),i===void 0&&(i=[1,1]),this.throwIfDisposed(),se.depthwiseConv2d(this,t,e,n,a,i,s)},r.prototype.separableConv2d=function(t,e,n,a,i,s){return i===void 0&&(i=[1,1]),s===void 0&&(s="NHWC"),this.throwIfDisposed(),se.separableConv2d(this,t,e,n,a,i,s)},r.prototype.avgPool=function(t,e,n,a){return this.throwIfDisposed(),se.avgPool(this,t,e,n,a)},r.prototype.maxPool=function(t,e,n,a){return this.throwIfDisposed(),se.maxPool(this,t,e,n,a)},r.prototype.localResponseNormalization=function(t,e,n,a){return t===void 0&&(t=5),e===void 0&&(e=1),n===void 0&&(n=1),a===void 0&&(a=.5),se.localResponseNormalization(this,t,e,n,a)},r.prototype.pool=function(t,e,n,a,i){return this.throwIfDisposed(),se.pool(this,t,e,n,a,i)},r.prototype.variable=function(t,e,n){return t===void 0&&(t=!0),this.throwIfDisposed(),pa().makeVariable(this,t,e,n)},r.prototype.unsortedSegmentSum=function(t,e){return this.throwIfDisposed(),se.unsortedSegmentSum(this,t,e)},r.prototype.batchToSpaceND=function(t,e){return this.throwIfDisposed(),se.batchToSpaceND(this,t,e)},r.prototype.spaceToBatchND=function(t,e){return this.throwIfDisposed(),se.spaceToBatchND(this,t,e)},r.prototype.topk=function(t,e){return t===void 0&&(t=1),e===void 0&&(e=!0),this.throwIfDisposed(),se.topk(this,t,e)},r.prototype.stridedSlice=function(t,e,n,a,i,s,l,c){return a===void 0&&(a=0),i===void 0&&(i=0),s===void 0&&(s=0),l===void 0&&(l=0),c===void 0&&(c=0),this.throwIfDisposed(),se.stridedSlice(this,t,e,n,a,i,s,l,c)},r.prototype.depthToSpace=function(t,e){return this.throwIfDisposed(),se.depthToSpace(this,t,e)},r.prototype.fft=function(){return this.throwIfDisposed(),se.spectral.fft(this)},r.prototype.ifft=function(){return this.throwIfDisposed(),se.spectral.ifft(this)},r.prototype.rfft=function(){return this.throwIfDisposed(),se.spectral.rfft(this)},r.prototype.irfft=function(){return this.throwIfDisposed(),se.spectral.irfft(this)},r}();Object.defineProperty(Mt,Symbol.hasInstance,{value:function(r){return!!r&&r.dataId!=null&&r.shape!=null&&r.dtype!=null}});var J2,iy,oy,sy,uy,qu=function(r){function t(e,n,a,i){var s=r.call(this,e.shape,e.dtype,e.dataId,i)||this;return s.trainable=n,s.name=a,s}return Qr(t,r),t.prototype.assign=function(e){if(e.dtype!==this.dtype)throw new Error("dtype of the new value ("+e.dtype+") and previous value ("+this.dtype+") must match");if(!vn(e.shape,this.shape))throw new Error("shape of the new value ("+e.shape+") and previous value ("+this.shape+") must match");pa().disposeTensor(this),this.dataId=e.dataId,pa().incRef(this,null)},t.prototype.dispose=function(){pa().disposeVariable(this),this.isDisposedInternal=!0},t}(Mt);Object.defineProperty(qu,Symbol.hasInstance,{value:function(r){return r instanceof Mt&&r.assign!=null&&r.assign instanceof Function}}),function(r){r.R0="R0",r.R1="R1",r.R2="R2",r.R3="R3",r.R4="R4",r.R5="R5",r.R6="R6"}(J2||(J2={})),function(r){r.float32="float32",r.int32="int32",r.bool="int32",r.complex64="complex64"}(iy||(iy={})),function(r){r.float32="float32",r.int32="int32",r.bool="bool",r.complex64="complex64"}(oy||(oy={})),function(r){r.float32="float32",r.int32="float32",r.bool="float32",r.complex64="complex64"}(sy||(sy={})),function(r){r.float32="complex64",r.int32="complex64",r.bool="complex64",r.complex64="complex64"}(uy||(uy={}));var G4={float32:sy,int32:iy,bool:oy,complex64:uy};function _n(r,t){if(r==="string"||t==="string"){if(r==="string"&&t==="string")return"string";throw new Error("Can not upcast "+r+" with "+t)}return G4[r][t]}function Km(r){return _n(r,"int32")}function Bt(r,t){if(r.dtype===t.dtype)return[r,t];var e=_n(r.dtype,t.dtype);return[r.cast(e),t.cast(e)]}function q4(r,t){L(r.dtype===t.dtype,function(){return"The dtypes of the first("+r.dtype+") and second("+t.dtype+") input must match"})}function VE(r){var t=[];return function e(n,a,i){if(n!=null){if(n instanceof Mt)return void a.push(n);if(s=n,!(!Array.isArray(s)&&typeof s!="object")){var s,l=n;for(var c in l){var f=l[c];i.has(f)||(i.add(f),e(f,a,i))}}}}(r,t,new Set),t}var Xm,e_=function(){function r(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null}}return r.prototype.dispose=function(){for(var t in this.registeredVariables)this.registeredVariables[t].dispose()},r}(),K4=function(){function r(t){this.ENV=t,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new e_}return r.prototype.ready=function(){return Ce(this,void 0,void 0,function(){var t,e,n;return Re(this,function(a){switch(a.label){case 0:if(this.pendingBackendInit!=null)return[2,this.pendingBackendInit.then(function(){})];if(this.backendInstance!=null)return[2];t=this.getSortedBackends(),e=0,a.label=1;case 1:return e<t.length?(n=t[e],[4,this.initializeBackend(n).success]):[3,5];case 2:return a.sent()?[4,this.setBackend(n)]:[3,4];case 3:return a.sent(),[2];case 4:return e++,[3,1];case 5:throw new Error("Could not initialize any backends, all backend initializations failed.")}})})},Object.defineProperty(r.prototype,"backend",{get:function(){if(this.pendingBackendInit!=null)throw new Error("Backend '"+this.backendName+"' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods");if(this.backendInstance==null){var t=this.initializeBackendsAndReturnBest(),e=t.name;if(t.asyncInit)throw new Error("The highest priority backend '"+e+"' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods");this.setBackend(e)}return this.backendInstance},enumerable:!0,configurable:!0}),r.prototype.backendNames=function(){return Object.keys(this.registryFactory)},r.prototype.findBackend=function(t){return!(t in this.registry)&&(!(t in this.registryFactory)||this.initializeBackend(t).asyncInit)?null:this.registry[t]},r.prototype.findBackendFactory=function(t){return t in this.registryFactory?this.registryFactory[t].factory:null},r.prototype.registerBackend=function(t,e,n){return n===void 0&&(n=1),t in this.registryFactory?(console.warn(t+" backend was already registered. Reusing existing backend factory."),!1):(this.registryFactory[t]={factory:e,priority:n},!0)},r.prototype.setBackend=function(t){return Ce(this,void 0,void 0,function(){var e,n,a;return Re(this,function(i){switch(i.label){case 0:if(this.registryFactory[t]==null)throw new Error("Backend name '"+t+"' not found in registry");return this.backendName=t,this.registry[t]!=null?[3,4]:(this.backendInstance=null,e=this.initializeBackend(t),n=e.success,e.asyncInit?[4,n]:[3,2]);case 1:return a=i.sent(),[3,3];case 2:a=n,i.label=3;case 3:if(!a)return[2,!1];i.label=4;case 4:return this.backendInstance=this.registry[t],this.setupRegisteredKernels(),this.profiler=new H4(this.backendInstance),[2,!0]}})})},r.prototype.setupRegisteredKernels=function(){var t=this;X2(this.backendName).forEach(function(e){e.setupFunc!=null&&e.setupFunc(t.backendInstance)})},r.prototype.disposeRegisteredKernels=function(t){var e=this;X2(t).forEach(function(n){n.disposeFunc!=null&&n.disposeFunc(e.registry[t])})},r.prototype.initializeBackend=function(t){var e=this,n=this.registryFactory[t];if(n==null)throw new Error("Cannot initialize backend "+t+", no registration found.");try{var a=n.factory();if(Promise.resolve(a)===a){var i=++this.pendingBackendInitId,s=a.then(function(l){return!(i<e.pendingBackendInitId)&&(e.registry[t]=l,e.pendingBackendInit=null,!0)}).catch(function(l){return!(i<e.pendingBackendInitId)&&(e.pendingBackendInit=null,console.warn("Initialization of backend "+t+" failed"),console.warn(l.stack||l.message),!1)});return this.pendingBackendInit=s,{success:s,asyncInit:!0}}return this.registry[t]=a,{success:!0,asyncInit:!1}}catch(l){return console.warn("Initialization of backend "+t+" failed"),console.warn(l.stack||l.message),{success:!1,asyncInit:!1}}},r.prototype.removeBackend=function(t){if(!(t in this.registryFactory))throw new Error(t+" backend not found in registry");this.backendName===t&&this.pendingBackendInit!=null&&this.pendingBackendInitId++,t in this.registry&&(this.disposeRegisteredKernels(t),this.registry[t].dispose(),delete this.registry[t]),delete this.registryFactory[t],this.backendName===t&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)},r.prototype.getSortedBackends=function(){var t=this;if(Object.keys(this.registryFactory).length===0)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort(function(e,n){return t.registryFactory[n].priority-t.registryFactory[e].priority})},r.prototype.initializeBackendsAndReturnBest=function(){for(var t=this.getSortedBackends(),e=0;e<t.length;e++){var n=t[e],a=this.initializeBackend(n),i=a.success,s=a.asyncInit;if(s||i)return{name:n,asyncInit:s}}throw new Error("Could not initialize any backends, all backend initializations failed.")},r.prototype.moveData=function(t,e){var n=this.state.tensorInfo.get(e),a=n.backend,i=this.readSync(e);a.disposeData(e),n.backend=t,t.move(e,i,n.shape,n.dtype),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++},r.prototype.tidy=function(t,e){var n,a=this,i=null;if(e==null){if(typeof t!="function")throw new Error("Please provide a function to tidy()");e=t}else{if(typeof t!="string"&&!(t instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if(typeof e!="function")throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");i=t}return this.scopedRun(function(){return a.startScope(i)},function(){return a.endScope(n)},function(){return(n=e())instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),n})},r.prototype.scopedRun=function(t,e,n){t();try{var a=n();return e(),a}catch(i){throw e(),i}},r.prototype.nextTensorId=function(){return r.nextTensorId++},r.prototype.nextVariableId=function(){return r.nextVariableId++},r.prototype.clone=function(t){var e=this.makeTensorFromDataId(t.dataId,t.shape,t.dtype),n={x:t};return this.addTapeNode(this.state.activeScope.name,n,[e],function(a){return{x:function(){return a.toFloat()}}},[]),e},r.prototype.runKernel=function(t,e,n,a,i){return this.runKernelFunc(null,e,null,t,n,a,i)},r.prototype.shouldCheckForMemLeaks=function(){return this.ENV.getBool("IS_TEST")},r.prototype.checkKernelForMemLeak=function(t,e,n){var a=this.backend.numDataIds(),i=0;n.forEach(function(c){i+=c.dtype==="complex64"?3:1});var s=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],l=a-e-i-s;if(l>0)throw new Error("Backend '"+this.backendName+"' has an internal memory leak ("+l+" data ids) after running '"+t+"'")},r.prototype.runKernelFunc=function(t,e,n,a,i,s,l){var c,f=this;s===void 0&&(s=[]),l===void 0&&(l=[]);var d=[],v=this.isTapeOn();a==null&&(a=this.state.activeScope!=null?this.state.activeScope.name:"");var m,g=function(E){v&&(d=E.map(function(C){return f.keep(f.clone(C))}))},b=this.state.numBytes,w=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0);var _,S=OE(a,this.backendName);return m=S!=null?function(){var E=f.backend.numDataIds();_=S.kernelFunc({inputs:e,attrs:i,backend:f.backend});var C=Array.isArray(_)?_:[_];f.shouldCheckForMemLeaks()&&f.checkKernelForMemLeak(a,E,C);var R=C.map(function(D){var k=D.dataId,M=D.shape,N=D.dtype;return f.makeTensorFromDataId(k,M,N)}),T=R.filter(function(D,k){return l[k]});return g((s||[]).slice().concat(T)),R}:function(){var E=f.backend.numDataIds();_=f.tidy(function(){return t(f.backend,g)});var C=Array.isArray(_)?_:[_];return f.shouldCheckForMemLeaks()&&f.checkKernelForMemLeak(a,E,C),C},this.scopedRun(function(){return f.state.kernelDepth++},function(){return f.state.kernelDepth--},function(){c=f.ENV.getBool("DEBUG")?f.profiler.profileKernel(a,e,function(){return m()}):m()}),v&&this.addTapeNode(a,e,c,n,d),this.state.profiling&&this.state.activeProfile.kernels.push({name:a,bytesAdded:this.state.numBytes-b,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-w,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(e).map(function(E){return e[E].shape}),outputShapes:c.map(function(E){return E.shape})}),Array.isArray(_)?c:c[0]},r.prototype.makeTensor=function(t,e,n,a){if(t==null)throw new Error("Values passed to engine.makeTensor() are null");n=n||"float32",a=a||this.backend;var i=t;n==="string"&&Vy(t[0])&&(i=t.map(function(d){return U4(d)}));var s=a.write(i,e,n),l=new Mt(e,n,s,this.nextTensorId());if(this.incRef(l,a),n==="string"){var c=this.state.tensorInfo.get(s),f=L4(i);this.state.numBytes+=f-c.bytes,c.bytes=f}return l},r.prototype.makeTensorFromDataId=function(t,e,n,a){var i=new Mt(e,n=n||"float32",t,this.nextTensorId());return this.incRef(i,a),i},r.prototype.makeVariable=function(t,e,n,a){e===void 0&&(e=!0),n=n||this.nextVariableId().toString(),a!=null&&a!==t.dtype&&(t=t.asType(a));var i=new qu(t,e,n,this.nextTensorId());if(this.state.registeredVariables[i.name]!=null)throw new Error("Variable with name "+i.name+" was already registered");return this.state.registeredVariables[i.name]=i,this.incRef(i,this.backend),i},r.prototype.incRef=function(t,e){var n=this.state.tensorInfo.has(t.dataId)?this.state.tensorInfo.get(t.dataId).refCount:0;if(this.state.numTensors++,t.dtype==="string"&&this.state.numStringTensors++,n===0){this.state.numDataBuffers++;var a=0;t.dtype!=="complex64"&&t.dtype!=="string"&&(a=t.size*FE(t.dtype)),this.state.tensorInfo.set(t.dataId,{backend:e||this.backend,dtype:t.dtype,shape:t.shape,bytes:a,refCount:0}),this.state.numBytes+=a}this.state.tensorInfo.get(t.dataId).refCount++,t instanceof qu||this.track(t)},r.prototype.disposeTensor=function(t){if(this.state.tensorInfo.has(t.dataId)){this.state.numTensors--,t.dtype==="string"&&this.state.numStringTensors--;var e=this.state.tensorInfo.get(t.dataId);e.refCount<=1?(t.dtype!=="complex64"&&(this.state.numBytes-=e.bytes),this.state.numDataBuffers--,e.backend.disposeData(t.dataId),this.state.tensorInfo.delete(t.dataId)):this.state.tensorInfo.get(t.dataId).refCount--}},r.prototype.disposeVariables=function(){for(var t in this.state.registeredVariables){var e=this.state.registeredVariables[t];this.disposeVariable(e)}},r.prototype.disposeVariable=function(t){this.disposeTensor(t),this.state.registeredVariables[t.name]!=null&&delete this.state.registeredVariables[t.name]},r.prototype.memory=function(){var t=this.backend.memory();return t.numTensors=this.state.numTensors,t.numDataBuffers=this.state.numDataBuffers,t.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(t.unreliable=!0,t.reasons==null&&(t.reasons=[]),t.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),t},r.prototype.profile=function(t){return Ce(this,void 0,void 0,function(){var e,n;return Re(this,function(a){return this.state.profiling=!0,e=this.state.numBytes,n=this.state.numTensors,this.state.activeProfile.kernels=[],this.state.activeProfile.result=t(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max.apply(Math,this.state.activeProfile.kernels.map(function(i){return i.totalBytesSnapshot})),this.state.activeProfile.newBytes=this.state.numBytes-e,this.state.activeProfile.newTensors=this.state.numTensors-n,[2,this.state.activeProfile]})})},r.prototype.isTapeOn=function(){return this.state.gradientDepth>0&&this.state.kernelDepth===0},r.prototype.addTapeNode=function(t,e,n,a,i){var s=this,l={id:this.state.nextTapeNodeId++,kernelName:t,inputs:e,outputs:n,saved:i},c=D4(t);c!=null&&(a=c.gradFunc),a!=null&&(l.gradient=function(f){return f=f.map(function(d,v){if(d==null){var m=n[v],g=Qc(m.size,m.dtype);return s.makeTensor(g,m.shape,m.dtype)}return d}),a(f.length>1?f:f[0],i)}),this.state.activeTape.push(l)},r.prototype.keep=function(t){return t.kept=!0,t},r.prototype.startTape=function(){this.state.gradientDepth===0&&(this.state.activeTape=[]),this.state.gradientDepth++},r.prototype.endTape=function(){this.state.gradientDepth--},r.prototype.startScope=function(t){var e={track:[],name:"unnamed scope",id:this.state.nextScopeId++};t&&(e.name=t),this.state.scopeStack.push(e),this.state.activeScope=e},r.prototype.endScope=function(t){for(var e=this,n=VE(t),a=new Set(n.map(function(c){return c.id})),i=0;i<this.state.activeScope.track.length;i++){var s=this.state.activeScope.track[i];s.kept||a.has(s.id)||s.dispose()}var l=this.state.scopeStack.pop();this.state.activeScope=this.state.scopeStack.length===0?null:this.state.scopeStack[this.state.scopeStack.length-1],n.forEach(function(c){c.kept||c.scopeId!==l.id||e.track(c)})},r.prototype.gradients=function(t,e,n,a){var i=this;if(a===void 0&&(a=!1),L(e.length>0,function(){return"gradients() received an empty list of xs."}),n!=null&&n.dtype!=="float32")throw new Error("dy must have 'float32' dtype, but has '"+n.dtype+"'");var s=this.scopedRun(function(){return i.startTape()},function(){return i.endTape()},function(){return i.tidy("forward",t)});L(s instanceof Mt,function(){return"The result y returned by f() must be a tensor."});var l=function(c,f,d){for(var v={},m={},g=0;g<f.length;g++)v[f[g].id]=!0;for(g=0;g<c.length;g++){var b=(D=c[g]).inputs;for(var w in b){for(var _=b[w],S=!1,E=0;E<f.length;E++)if(v[_.id]){D.outputs.forEach(function(I){return v[I.id]=!0}),S=!0,m[D.id]=!0;break}if(S)break}}var C={};C[d.id]=!0;var R={};for(g=c.length-1;g>=0;g--)for(b=(D=c[g]).inputs,E=0;E<D.outputs.length;E++)if(C[D.outputs[E].id]){for(var w in b)C[b[w].id]=!0,R[D.id]=!0;break}var T=[];for(g=0;g<c.length;g++){var D;if(m[(D=c[g]).id]&&R[D.id]){var k={};for(var w in D.inputs){var M=D.inputs[w];v[M.id]&&(k[w]=M)}var N=Object.assign({},D);N.inputs=k,N.outputs=D.outputs,T.push(N)}}return T}(this.state.activeTape,e,s);if(!a&&l.length===0&&e.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",function(){var c,f,d={};d[s.id]=n??(c=s.shape,f=LE(Te(c),"float32"),q.makeTensor(f,c,"float32")),function(m,g,b){for(var w=function(S){var E=g[S],C=[];if(E.outputs.forEach(function(k){var M=m[k.id];M!=null?C.push(M):C.push(null)}),E.gradient==null)throw new Error("Cannot compute gradient: gradient function not found for "+E.kernelName+".");var R=E.gradient(C),T=function(k){if(!(k in R))throw new Error("Cannot backprop through input "+k+". Available gradients found: "+Object.keys(R)+".");var M=b(function(){return R[k]()});if(M.dtype!=="float32")throw new Error("Error in gradient for op "+E.kernelName+". The gradient of input "+k+" must have 'float32' dtype, but has '"+M.dtype+"'");var N=E.inputs[k];if(!vn(M.shape,N.shape))throw new Error("Error in gradient for op "+E.kernelName+". The gradient of input '"+k+"' has shape '"+M.shape+"', which does not match the shape of the input '"+N.shape+"'");if(m[N.id]==null)m[N.id]=M;else{var I=m[N.id];m[N.id]=I.add(M),I.dispose()}};for(var D in E.inputs)T(D)},_=g.length-1;_>=0;_--)w(_)}(d,l,function(m){return i.tidy(m)});var v=e.map(function(m){return d[m.id]});return i.state.gradientDepth===0&&(i.state.activeTape.forEach(function(m){for(var g=0,b=m.saved;g<b.length;g++)b[g].dispose()}),i.state.activeTape=null),{value:s,grads:v}})},r.prototype.customGrad=function(t){var e=this;return L(ry(t),function(){return"The f passed in customGrad(f) must be a function."}),function(){for(var n,a=[],i=0;i<arguments.length;i++)a[i]=arguments[i];L(a.every(function(l){return l instanceof Mt}),function(){return"The args passed in customGrad(f)(x1, x2,...) must all be tensors"});var s={};return a.forEach(function(l,c){s[c]=l}),e.runKernelFunc(function(l,c){return L((n=t.apply(void 0,a.concat([c]))).value instanceof Mt,function(){return"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"}),L(ry(n.gradFunc),function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."}),n.value},s,function(l,c){var f=n.gradFunc(l,c),d=Array.isArray(f)?f:[f];L(d.length===a.length,function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."}),L(d.every(function(m){return m instanceof Mt}),function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors."});var v={};return d.forEach(function(m,g){v[g]=function(){return m}}),v})}},r.prototype.readSync=function(t){return this.state.tensorInfo.get(t).backend.readSync(t)},r.prototype.read=function(t){return this.state.tensorInfo.get(t).backend.read(t)},r.prototype.time=function(t){return Ce(this,void 0,void 0,function(){var e,n;return Re(this,function(a){switch(a.label){case 0:return e=da(),[4,this.backend.time(t)];case 1:return(n=a.sent()).wallMs=da()-e,[2,n]}})})},r.prototype.track=function(t){return this.state.activeScope!=null&&(t.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(t)),t},Object.defineProperty(r.prototype,"registeredVariables",{get:function(){return this.state.registeredVariables},enumerable:!0,configurable:!0}),r.prototype.reset=function(){for(var t in this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new e_,this.registry)this.disposeRegisteredKernels(t),this.registry[t].dispose(),delete this.registry[t];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null},r.nextTensorId=0,r.nextVariableId=0,r}(),q=function(){var r=function(){if(Xm==null){var e=void 0;if(typeof window<"u")e=window;else if(typeof global<"u")e=global;else if(typeof process<"u")e=process;else{if(typeof self>"u")throw new Error("Could not find a global object");e=self}Xm=e}return Xm}();if(r._tfengine==null){var t=new T4(r);r._tfengine=new K4(t)}return function(e){kE=e}(r._tfengine.ENV),pa=function(){return r._tfengine},r._tfengine}();function HE(){return typeof window<"u"&&window.document!=null||typeof WorkerGlobalScope<"u"}var Ka=le();Ka.registerFlag("DEBUG",function(){return!1},function(r){r&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")}),Ka.registerFlag("IS_BROWSER",function(){return HE()}),Ka.registerFlag("IS_NODE",function(){return typeof process<"u"&&process.versions!==void 0&&process.versions.node!==void 0}),Ka.registerFlag("IS_CHROME",function(){return typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)}),Ka.registerFlag("PROD",function(){return!1}),Ka.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",function(){return Ka.getBool("DEBUG")}),Ka.registerFlag("DEPRECATION_WARNINGS_ENABLED",function(){return!0}),Ka.registerFlag("IS_TEST",function(){return!1});var Fc,fr,cr,Lo={},$m={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function X4(r,t){Lo[r]=t}function Ta(r){r in Lo||(Lo[r]=function(e){if(e!==1&&e!==2)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");var n=function(a){if(typeof OffscreenCanvas<"u"&&a===2)return new OffscreenCanvas(300,150);if(typeof document<"u")return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}(e);return n.addEventListener("webglcontextlost",function(a){a.preventDefault(),delete Lo[e]},!1),e===1?n.getContext("webgl",$m)||n.getContext("experimental-webgl",$m):n.getContext("webgl2",$m)}(r));var t=Lo[r];return t.isContextLost()?(delete Lo[r],Ta(r)):(t.disable(t.DEPTH_TEST),t.disable(t.STENCIL_TEST),t.disable(t.BLEND),t.disable(t.DITHER),t.disable(t.POLYGON_OFFSET_FILL),t.disable(t.SAMPLE_COVERAGE),t.enable(t.SCISSOR_TEST),t.enable(t.CULL_FACE),t.cullFace(t.BACK),Lo[r])}function Xd(r,t){return[t,r]}function dc(r){var t=Te(r);return ny(Math.ceil(t/4))}function Jc(r,t){return[Math.max(1,Math.ceil(t/2)),Math.max(1,Math.ceil(r/2))]}function Hy(r,t){var e,n,a,i,s,l,c,f,d,v=r;return le().getNumber("WEBGL_VERSION")===2?(e=v.R32F,n=v.R16F,a=v.RGBA16F,i=v.RGBA32F,s=v.RED,l=4,c=1,f=v.HALF_FLOAT,d=v.FLOAT):(e=r.RGBA,n=r.RGBA,a=r.RGBA,i=v.RGBA,s=r.RGBA,l=4,c=4,f=t!=null?t.HALF_FLOAT_OES:null,d=r.FLOAT),{internalFormatFloat:e,internalFormatHalfFloat:n,internalFormatPackedHalfFloat:a,internalFormatPackedFloat:i,textureFormatFloat:s,downloadTextureFormat:r.RGBA,downloadUnpackNumChannels:l,defaultNumChannels:c,textureTypeHalfFloat:f,textureTypeFloat:d}}function De(r,t,e){var n=e();return t&&function(a){var i=a.getError();if(i!==a.NO_ERROR)throw new Error("WebGL Error: "+Q4(a,i))}(r),n}(function(r){r[r.DENSE=0]="DENSE",r[r.SHARED_BATCH=1]="SHARED_BATCH"})(Fc||(Fc={})),function(r){r[r.RENDER=0]="RENDER",r[r.UPLOAD=1]="UPLOAD",r[r.PIXELS=2]="PIXELS",r[r.DOWNLOAD=3]="DOWNLOAD"}(fr||(fr={})),function(r){r[r.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",r[r.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",r[r.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",r[r.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",r[r.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"}(cr||(cr={}));var $4=596e-10,Y4=65504;function Z4(r){return!!(le().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||r===0||$4<Math.abs(r)&&Math.abs(r)<Y4)}function Q4(r,t){switch(t){case r.NO_ERROR:return"NO_ERROR";case r.INVALID_ENUM:return"INVALID_ENUM";case r.INVALID_VALUE:return"INVALID_VALUE";case r.INVALID_OPERATION:return"INVALID_OPERATION";case r.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case r.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case r.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return"Unknown error code "+t}}function Th(r,t,e){return ui(r,t,function(){return r.getExtension(e)},'Extension "'+e+'" not supported on this browser.')}function J4(r,t,e){var n=ui(r,t,function(){return r.createShader(r.VERTEX_SHADER)},"Unable to create vertex WebGLShader.");if(De(r,t,function(){return r.shaderSource(n,e)}),De(r,t,function(){return r.compileShader(n)}),r.getShaderParameter(n,r.COMPILE_STATUS)===!1)throw console.log(r.getShaderInfoLog(n)),new Error("Failed to compile vertex shader.");return n}function eM(r,t,e){var n=ui(r,t,function(){return r.createShader(r.FRAGMENT_SHADER)},"Unable to create fragment WebGLShader.");if(De(r,t,function(){return r.shaderSource(n,e)}),De(r,t,function(){return r.compileShader(n)}),r.getShaderParameter(n,r.COMPILE_STATUS)===!1)throw function(a,i){var s=tM.exec(i);if(s==null)return console.log("Couldn't parse line number in error: "+i),void console.log(a);for(var l=+s[1],c=a.split(`
`),f=c.length.toString().length+2,d=c.map(function(_,S){return mu((S+1).toString(),f)+_}),v=0,m=0;m<d.length;m++)v=Math.max(d[m].length,v);var g=d.slice(0,l-1),b=d.slice(l-1,l),w=d.slice(l);console.log(g.join(`
`)),console.log(i.split(`
`)[0]),console.log("%c "+mu(b[0],v),"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(w.join(`
`))}(e,r.getShaderInfoLog(n)),new Error("Failed to compile fragment shader.");return n}var Ym,Zm,tM=/ERROR: [0-9]+:([0-9]+):/g;function nM(r,t){return ui(r,t,function(){return r.createProgram()},"Unable to create WebGLProgram.")}function rM(r,t,e){if(De(r,t,function(){return r.linkProgram(e)}),r.getProgramParameter(e,r.LINK_STATUS)===!1)throw console.log(r.getProgramInfoLog(e)),new Error("Failed to link vertex and fragment shaders.")}function Qm(r,t,e){if(De(r,t,function(){return r.validateProgram(e)}),r.getProgramParameter(e,r.VALIDATE_STATUS)===!1)throw console.log(r.getProgramInfoLog(e)),new Error("Shader program validation failed.")}function aM(r,t,e){var n=ui(r,t,function(){return r.createBuffer()},"Unable to create WebGLBuffer");return De(r,t,function(){return r.bindBuffer(r.ARRAY_BUFFER,n)}),De(r,t,function(){return r.bufferData(r.ARRAY_BUFFER,e,r.STATIC_DRAW)}),n}function iM(r,t,e){var n=ui(r,t,function(){return r.createBuffer()},"Unable to create WebGLBuffer");return De(r,t,function(){return r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,n)}),De(r,t,function(){return r.bufferData(r.ELEMENT_ARRAY_BUFFER,e,r.STATIC_DRAW)}),n}function oM(r,t){return ui(r,t,function(){return r.createTexture()},"Unable to create WebGLTexture.")}function sM(r,t){var e=le().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(r<=0||t<=0){var n="["+r+"x"+t+"]";throw new Error("Requested texture size "+n+" is invalid.")}if(r>e||t>e)throw n="["+r+"x"+t+"]",new Error("Requested texture size "+n+" greater than WebGL maximum on this browser / GPU "+("["+e+"x"+e+"]")+".")}function uM(r,t){return ui(r,t,function(){return r.createFramebuffer()},"Unable to create WebGLFramebuffer.")}function t_(r,t,e,n,a,i,s,l){var c=r.getAttribLocation(e,n);return c!==-1&&(De(r,t,function(){return r.bindBuffer(r.ARRAY_BUFFER,a)}),De(r,t,function(){return r.vertexAttribPointer(c,i,r.FLOAT,!1,s,l)}),De(r,t,function(){return r.enableVertexAttribArray(c)}),!0)}function lM(r,t,e,n){pM(r,n),De(r,t,function(){return r.activeTexture(r.TEXTURE0+n)}),De(r,t,function(){return r.bindTexture(r.TEXTURE_2D,e)})}function cM(r,t,e,n){return ui(r,t,function(){return r.getUniformLocation(e,n)},'uniform "'+n+'" not present in program.')}function fM(r,t,e){return r.getUniformLocation(t,e)}function hM(r,t,e,n,a,i){De(r,t,function(){return lM(r,t,n,i)}),De(r,t,function(){return r.uniform1i(a,i)})}function Jm(r,t,e,n){De(r,t,function(){return r.bindFramebuffer(r.FRAMEBUFFER,n)}),De(r,t,function(){return r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,e,0)})}function n_(r,t,e){De(r,t,function(){return r.bindFramebuffer(r.FRAMEBUFFER,e)}),De(r,t,function(){return r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,null,0)})}function Ah(r){var t=r.checkFramebufferStatus(r.FRAMEBUFFER);if(t!==r.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+dM(r,t))}function dM(r,t){switch(t){case r.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case r.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case r.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case r.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return"unknown error "+t}}function ui(r,t,e,n){var a=De(r,t,function(){return e()});if(a==null)throw new Error(n);return a}function pM(r,t){var e=r.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,n=t+r.TEXTURE0;if(n<r.TEXTURE0||n>e)throw new Error("textureUnit must be in "+("[gl.TEXTURE0, gl.TEXTURE"+e+"]")+".")}function bd(r,t){return t===void 0&&(t=2),Te(r.slice(0,r.length-t))}function xd(r){if(r.length===0)throw Error("Cannot get rows and columns of an empty shape array.");return[r.length>1?r[r.length-2]:1,r[r.length-1]]}function eg(r){var t=[1,1,1];return r.length===0||r.length===1&&r[0]===1||(t=[bd(r)].concat(xd(r))),t}function vM(r,t){var e;t===void 0&&(t=!1);var n=le().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(t&&(n*=2,(r=r.map(function(f,d){return d>=r.length-2?IE(r[d]):r[d]})).length===1&&(r=[2,r[0]])),r.length!==2){var a=zo(r);r=a.newShape}var i=Te(r);if(r.length<=1&&i<=n)return[1,i];if(r.length===2&&r[0]<=n&&r[1]<=n)return r;if(r.length===3&&r[0]*r[1]<=n&&r[2]<=n)return[r[0]*r[1],r[2]];if(r.length===3&&r[0]<=n&&r[1]*r[2]<=n)return[r[0],r[1]*r[2]];if(r.length===4&&r[0]*r[1]*r[2]<=n&&r[3]<=n)return[r[0]*r[1]*r[2],r[3]];if(r.length===4&&r[0]<=n&&r[1]*r[2]*r[3]<=n)return[r[0],r[1]*r[2]*r[3]];if(t){var s=bd(r),l=2,c=2;return r.length&&(l=(e=xd(r))[0],c=e[1]),ny(i=s*(l/2)*(c/2)).map(function(f){return 2*f})}return ny(i)}function Dh(r){return r%2==0}function kh(r,t){if(vn(r=r.slice(-2),t=t.slice(-2))||!r.length||!t.length||r[0]===0||r[1]===0||t[0]===0||t[1]===0)return!0;if(r.length!==t.length){var e=r.slice(-1)[0],n=t.slice(-1)[0];if(e===n||Dh(e)&&Dh(n)&&(r[0]===1||t[0]===1))return!0}return r[1]===t[1]&&Dh(r[0])&&Dh(t[0])}function mM(r){if(Ym==null){var t=Ta(r);Ym=t.getParameter(t.MAX_TEXTURE_SIZE)}return Ym}function gM(r){if(Zm==null){var t=Ta(r);Zm=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,Zm)}function yM(r){if(r===0)return 0;var t=Ta(r);return Nr(t,"EXT_disjoint_timer_query_webgl2")&&r===2?2:Nr(t,"EXT_disjoint_timer_query")?1:0}function Nr(r,t){return r.getExtension(t)!=null}function r_(r){try{if(Ta(r)!=null)return!0}catch{return!1}return!1}function bM(r){if(r===0)return!1;var t=Ta(r);if(r===1){if(!Nr(t,"OES_texture_float"))return!1}else if(!Nr(t,"EXT_color_buffer_float"))return!1;return ly(t)}function xM(r){if(r===0)return!1;var t=Ta(r);if(r!==1){if(Nr(t,"EXT_color_buffer_float"))return ly(t);if(Nr(t,"EXT_color_buffer_half_float")){var e=t.getExtension("EXT_color_buffer_half_float");return function(n,a){var i=Hy(n,a),s=n.createTexture();n.bindTexture(n.TEXTURE_2D,s),n.texImage2D(n.TEXTURE_2D,0,i.internalFormatHalfFloat,1,1,0,i.textureFormatFloat,i.textureTypeHalfFloat,null);var l=n.createFramebuffer();n.bindFramebuffer(n.FRAMEBUFFER,l),n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,s,0);var c=n.checkFramebufferStatus(n.FRAMEBUFFER)===n.FRAMEBUFFER_COMPLETE;return n.bindTexture(n.TEXTURE_2D,null),n.bindFramebuffer(n.FRAMEBUFFER,null),n.deleteTexture(s),n.deleteFramebuffer(l),c}(t,e)}return!1}return!!Nr(t,"OES_texture_float")&&!!Nr(t,"WEBGL_color_buffer_float")&&ly(t)}function ly(r){var t=Hy(r),e=r.createTexture();r.bindTexture(r.TEXTURE_2D,e),r.texImage2D(r.TEXTURE_2D,0,t.internalFormatFloat,1,1,0,t.textureFormatFloat,t.textureTypeFloat,null);var n=r.createFramebuffer();r.bindFramebuffer(r.FRAMEBUFFER,n),r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,e,0);var a=r.checkFramebufferStatus(r.FRAMEBUFFER)===r.FRAMEBUFFER_COMPLETE;return r.bindTexture(r.TEXTURE_2D,null),r.bindFramebuffer(r.FRAMEBUFFER,null),r.deleteTexture(e),r.deleteFramebuffer(n),a}function wM(r){return r===2&&Ta(r).fenceSync!=null}var He=le();function jE(r){le().getBool("DEPRECATION_WARNINGS_ENABLED")&&console.warn(r+" You can disable deprecation warnings with tf.disableDeprecationWarnings().")}function Se(r,t){return q.tidy(r,t)}function Qn(r){VE(r).forEach(function(t){return t.dispose()})}function _M(r){return q.keep(r)}function wd(){for(var r=[],t=0;t<arguments.length;t++)r[t]=arguments[t];le().getBool("IS_TEST")||console.warn.apply(console,r)}function mo(r,t){var e=r;if(ba(r))return t==="string"?[]:[r.length];if(!Array.isArray(r))return[];for(var n=[];Array.isArray(e)||ba(e)&&t!=="string";)n.push(e.length),e=e[0];return Array.isArray(r)&&le().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&function a(i,s,l){if(l=l||[],!Array.isArray(i)&&!ba(i))return void L(s.length===0,function(){return"Element arr["+l.join("][")+"] is a primitive, but should be an array/TypedArray of "+s[0]+" elements"});L(s.length>0,function(){return"Element arr["+l.join("][")+"] should be a primitive, but is an array of "+i.length+" elements"}),L(i.length===s[0],function(){return"Element arr["+l.join("][")+"] should have "+s[0]+" elements, but has "+i.length+" elements"});for(var c=s.slice(1),f=0;f<i.length;++f)a(i[f],c,l.concat(f))}(r,n,[]),n}function a_(r,t,e,n){if(r!=null&&(r!=="numeric"&&r!==t||r==="numeric"&&t==="string"))throw new Error("Argument '"+e+"' passed to '"+n+"' must be "+r+" tensor, but got "+t+" tensor")}function B(r,t,e,n){if(n===void 0&&(n="numeric"),r instanceof Mt)return a_(n,r.dtype,t,e),r;var a=Zc(r);if(a!=="string"&&["bool","int32","float32"].indexOf(n)>=0&&(a=n),a_(n,a,t,e),r==null||!ba(r)&&!Array.isArray(r)&&typeof r!="number"&&typeof r!="boolean"&&typeof r!="string"){var i=r==null?"null":r.constructor.name;throw new Error("Argument '"+t+"' passed to '"+e+"' must be a Tensor or TensorLike, but got '"+i+"'")}var s=mo(r,a);ba(r)||Array.isArray(r)||(r=[r]);var l=a!=="string"?BE(r,a,le().getBool("DEBUG")):Gu(r,[],!0);return q.makeTensor(l,s,a)}function _d(r,t,e,n){if(n===void 0&&(n="numeric"),!Array.isArray(r))throw new Error("Argument "+t+" passed to "+e+" must be a `Tensor[]` or `TensorLike[]`");return r.map(function(a,i){return B(a,t+"["+i+"]",e)},n)}function WE(r,t){for(var e=0;e<r.length;++e)if(r[r.length-e-1]!==t-1-e)return!1;return!0}function SM(r,t,e){for(var n=r.length+t.length,a=[],i=0,s=0,l=0;l<n;l++)e.indexOf(l)===-1?a.push(r[i++]):a.push(t[s++]);return a}function Dn(r,t){for(var e=[],n=r.length,a=0;a<n;a++)t.indexOf(a)===-1&&e.push(r[a]);return[e,t.map(function(i){return r[i]})]}function Jn(r,t){return SM(r,t.map(function(e){return 1}),t)}function lr(r,t,e){L(WE(t,e),function(){return r+" supports only inner-most axes for now. Got axes "+t+" and rank-"+e+" input."})}function Aa(r,t){if(WE(r,t))return null;for(var e=[],n=0;n<t;++n)r.indexOf(n)===-1&&e.push(n);return r.forEach(function(a){return e.push(a)}),e}function jy(r){return r.map(function(t,e){return[e,t]}).sort(function(t,e){return t[1]-e[1]}).map(function(t){return t[0]})}function Da(r,t){for(var e=[],n=t-r;n<t;++n)e.push(n);return e}function EM(r,t){var e=r[0].length;r.forEach(function(a,i){L(a.length===e,function(){return"Error in concat"+e+"D: rank of tensors["+i+"] must be the same as the rank of the rest ("+e+")"})}),L(t>=0&&t<e,function(){return"Error in concat"+e+"D: axis must be between 0 and "+(e-1)+"."});var n=r[0];r.forEach(function(a,i){for(var s=0;s<e;s++)L(s===t||a[s]===n[s],function(){return"Error in concat"+e+"D: Shape of tensors["+i+"] ("+a+") does not match the shape of the rest ("+n+") along the non-concatenated axis "+i+"."})})}function Ku(r,t){for(var e=r[0].slice(),n=1;n<r.length;n++)e[t]+=r[n][t];return e}function j(r){var t=Object.keys(r);if(t.length!==1)throw new Error("Please provide an object with a single key (operation name) mapping to a function. Got an object with "+t.length+" keys.");var e=t[0],n=r[e];e.endsWith("_")&&(e=e.substring(0,e.length-1));var a=function(){for(var i=[],s=0;s<arguments.length;s++)i[s]=arguments[s];q.startScope(e);try{var l=n.apply(void 0,i);return l instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),q.endScope(l),l}catch(c){throw q.endScope(null),c}};return Object.defineProperty(a,"name",{value:e,configurable:!0}),a}He.registerFlag("HAS_WEBGL",function(){return He.getNumber("WEBGL_VERSION")>0}),He.registerFlag("WEBGL_VERSION",function(){return r_(2)?2:r_(1)?1:0}),He.registerFlag("WEBGL_BUFFER_SUPPORTED",function(){return He.get("WEBGL_VERSION")===2}),He.registerFlag("WEBGL_CPU_FORWARD",function(){return!0}),He.registerFlag("WEBGL_FORCE_F16_TEXTURES",function(){return!1}),He.registerFlag("WEBGL_PACK",function(){return He.getBool("HAS_WEBGL")}),He.registerFlag("WEBGL_PACK_NORMALIZATION",function(){return He.getBool("WEBGL_PACK")}),He.registerFlag("WEBGL_PACK_CLIP",function(){return He.getBool("WEBGL_PACK")}),He.registerFlag("WEBGL_PACK_DEPTHWISECONV",function(){return!1}),He.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",function(){return He.getBool("WEBGL_PACK")}),He.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",function(){return He.getBool("WEBGL_PACK")}),He.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",function(){return He.getBool("WEBGL_PACK")}),He.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",function(){return He.getBool("WEBGL_PACK")}),He.registerFlag("WEBGL_PACK_REDUCE",function(){return He.getBool("WEBGL_PACK")}),He.registerFlag("WEBGL_LAZILY_UNPACK",function(){return He.getBool("WEBGL_PACK")}),He.registerFlag("WEBGL_CONV_IM2COL",function(){return He.getBool("WEBGL_PACK")}),He.registerFlag("WEBGL_MAX_TEXTURE_SIZE",function(){return mM(He.getNumber("WEBGL_VERSION"))}),He.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",function(){return gM(He.getNumber("WEBGL_VERSION"))}),He.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",function(){var r=He.getNumber("WEBGL_VERSION");return r===0?0:yM(r)}),He.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",function(){return He.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&(r=navigator.userAgent||navigator.vendor||window.opera,!(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(r)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(r.substr(0,4))));var r}),He.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",function(){return bM(He.getNumber("WEBGL_VERSION"))}),He.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",function(){return!He.getBool("WEBGL_FORCE_F16_TEXTURES")&&He.getBool("WEBGL_RENDER_FLOAT32_CAPABLE")}),He.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",function(){return xM(He.getNumber("WEBGL_VERSION"))}),He.registerFlag("WEBGL_FENCE_API_ENABLED",function(){return wM(He.getNumber("WEBGL_VERSION"))}),He.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",function(){return He.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0}),UE=jE;var wn=j({complex_:function(r,t){var e=B(r,"real","complex"),n=B(t,"imag","complex");return gt(e.shape,n.shape,"real and imag shapes, "+e.shape+" and "+n.shape+", must match in call to tf.complex()."),q.runKernelFunc(function(a){return a.complex(e,n)},{$real:e,$imag:n})}}),Or=j({real_:function(r){var t=B(r,"input","real");return q.runKernelFunc(function(e){return e.real(t)},{$input:t})}}),va=j({imag_:function(r){var t=B(r,"input","imag");return q.runKernelFunc(function(e){return e.imag(t)},{$input:t})}});function Sn(r,t,e){return go(r,t,mo(r,e),e)}function go(r,t,e,n){if(n==null&&(n=Zc(r)),n==="complex64")throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(!ba(r)&&!Array.isArray(r)&&typeof r!="number"&&typeof r!="boolean"&&typeof r!="string")throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(t!=null){PE(t);var a=Te(t),i=Te(e);L(a===i,function(){return"Based on the provided shape, ["+t+"], the tensor should have "+a+" values but has "+i});for(var s=0;s<e.length;++s){var l=e[s],c=s!==e.length-1||l!==Te(t.slice(s));L(e[s]===t[s]||!c,function(){return"Error creating a new Tensor. Inferred shape ("+e+") does not match the provided shape ("+t+"). "})}}return ba(r)||Array.isArray(r)||(r=[r]),t=t||e,r=n!=="string"?BE(r,n,le().getBool("DEBUG")):Gu(r,[],!0),q.makeTensor(r,t,n)}function ye(r,t){if((ba(r)&&t!=="string"||Array.isArray(r))&&t!=="complex64")throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if(t==="string"&&ba(r)&&!(r instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return go(r,[],[],t)}function $t(r,t){Ju(r);var e=mo(r,t);if(e.length!==1)throw new Error("tensor1d() requires values to be a flat/TypedArray");return go(r,null,e,t)}function io(r,t,e){if(Ju(r),t!=null&&t.length!==2)throw new Error("tensor2d() requires shape to have two numbers");var n=mo(r,e);if(n.length!==2&&n.length!==1)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(n.length===1&&t==null)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return go(r,t,n,e)}function Wy(r,t,e){if(Ju(r),t!=null&&t.length!==3)throw new Error("tensor3d() requires shape to have three numbers");var n=mo(r,e);if(n.length!==3&&n.length!==1)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(n.length===1&&t==null)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return go(r,t,n,e)}function $n(r,t,e){if(Ju(r),t!=null&&t.length!==4)throw new Error("tensor4d() requires shape to have four numbers");var n=mo(r,e);if(n.length!==4&&n.length!==1)throw new Error("tensor4d() requires values to be number[][][][] or flat/TypedArray");if(n.length===1&&t==null)throw new Error("tensor4d() requires shape to be provided when `values` are a flat array");return go(r,t,n,e)}function CM(r,t,e){if(Ju(r),t!=null&&t.length!==5)throw new Error("tensor5d() requires shape to have five numbers");var n=mo(r,e);if(n.length!==5&&n.length!==1)throw new Error("tensor5d() requires values to be number[][][][][] or flat/TypedArray");if(n.length===1&&t==null)throw new Error("tensor5d() requires shape to be provided when `values` are a flat array");return go(r,t,n,e)}function RM(r,t,e){if(Ju(r),t!=null&&t.length!==6)throw new Error("tensor6d() requires shape to have six numbers");var n=mo(r,e);if(n.length!==6&&n.length!==1)throw new Error("tensor6d() requires values to be number[][][][][][] or flat/TypedArray");if(n.length===1&&t==null)throw new Error("tensor6d() requires shape to be provided when `values` are a flat array");return go(r,t=t||n,n,e)}function TM(r,t,e,n){return t===void 0&&(t=!0),q.makeVariable(r,t,e,n)}function el(r,t){if(t===void 0&&(t="float32"),t==="complex64"){var e=el(r,"float32"),n=Dt(r,"float32");return wn(e,n)}var a=LE(Te(r),t);return q.makeTensor(a,r,t)}function Dt(r,t){if(t===void 0&&(t="float32"),t==="complex64"){var e=Dt(r,"float32"),n=Dt(r,"float32");return wn(e,n)}var a=Qc(Te(r),t);return q.makeTensor(a,r,t)}function wa(r,t,e){return q.runKernelFunc(function(n){return n.fill(r,t,e)},{})}function AM(r,t,e){if(e<=0)throw new Error("The number of values should be positive.");return q.runKernelFunc(function(n){return n.linspace(r,t,e)},{})}function Sd(r,t,e,n){if(e===void 0&&(e=1),n===void 0&&(n="float32"),e===0)throw new Error("Cannot have a step of zero");if(r===t||r<t&&e<0||t<r&&e>1)return Dt([0],n);var a=Qc(Math.abs(Math.ceil((t-r)/e)),n);t<r&&e===1&&(e=-1),a[0]=r;for(var i=1;i<a.length;i++)a[i]=a[i-1]+e;return $t(a,n)}var GE=j({onesLike_:function(r){var t=B(r,"x","onesLike");if(t.dtype==="complex64"){var e=GE(Or(t)),n=lt(va(t));return wn(e,n)}return q.runKernelFunc(function(a){return a.onesLike(t)},{$x:t},function(a,i){return{$x:function(){return lt(a)}}})}}),lt=j({zerosLike_:function(r){var t=B(r,"x","zerosLike");return q.runKernelFunc(function(e){return e.zerosLike(t)},{$x:t},function(e,n){return{$x:function(){return lt(e)}}})}}),nn=j({concat_:function(r,t){t===void 0&&(t=0),L(r.length>=1,function(){return"Pass at least one tensor to concat"});var e=_d(r,"tensors","concat");e[0].dtype==="complex64"&&e.forEach(function(l){if(l.dtype!=="complex64")throw new Error(`Cannot concatenate complex64 tensors with a tensor
          with dtype `+l.dtype+". ")}),t=sn(t,e[0].shape)[0];var n=Ku(e.map(function(l){return l.shape}),t);if(Te(n)===0)return Sn([],n);if((e=e.filter(function(l){return l.size>0})).length===1)return e[0];var a=e.map(function(l){return l.shape});EM(a,t);var i=e,s={axis:t};return q.runKernelFunc(function(l){return l.concat(e,t)},i,function(l){var c=a.map(function(f){return f[t]});return Gy(l,c,t).map(function(f){return function(){return f}})},"Concat",s)}}),DM=j({concat1d_:function(r){return nn(r,0)}}),kM=j({concat2d_:function(r,t){return nn(r,t)}}),OM=j({concat3d_:function(r,t){return nn(r,t)}}),NM=j({concat4d_:function(r,t){return nn(r,t)}}),Gy=j({split_:function(r,t,e){e===void 0&&(e=0);var n,a=B(r,"x","split");return e=sn(e,a.shape)[0],typeof t=="number"?(L(a.shape[e]%t==0,function(){return"Number of splits must evenly divide the axis."}),n=new Array(t).fill(a.shape[e]/t)):(L(a.shape[e]===t.reduce(function(i,s){return i+s}),function(){return"The sum of sizes must match the size of the axis dimension."}),n=t),q.runKernelFunc(function(i){return i.split(a,n,e)},{$x:a},function(i){return{$x:function(){return nn(i,e)}}})}});function ls(r,t){return r(t={exports:{}},t.exports),t.exports}var MM=ls(function(r){(function(t,e,n){function a(l){var c,f=this,d=(c=4022871197,function(v){v=v.toString();for(var m=0;m<v.length;m++){var g=.02519603282416938*(c+=v.charCodeAt(m));g-=c=g>>>0,c=(g*=c)>>>0,c+=4294967296*(g-=c)}return 23283064365386963e-26*(c>>>0)});f.next=function(){var v=2091639*f.s0+23283064365386963e-26*f.c;return f.s0=f.s1,f.s1=f.s2,f.s2=v-(f.c=0|v)},f.c=1,f.s0=d(" "),f.s1=d(" "),f.s2=d(" "),f.s0-=d(l),f.s0<0&&(f.s0+=1),f.s1-=d(l),f.s1<0&&(f.s1+=1),f.s2-=d(l),f.s2<0&&(f.s2+=1),d=null}function i(l,c){return c.c=l.c,c.s0=l.s0,c.s1=l.s1,c.s2=l.s2,c}function s(l,c){var f=new a(l),d=c&&c.state,v=f.next;return v.int32=function(){return 4294967296*f.next()|0},v.double=function(){return v()+11102230246251565e-32*(2097152*v()|0)},v.quick=v,d&&(typeof d=="object"&&i(d,f),v.state=function(){return i(f,{})}),v}e&&e.exports?e.exports=s:this.alea=s})(0,r)}),IM=ls(function(r){(function(t,e,n){function a(l){var c=this,f="";c.x=0,c.y=0,c.z=0,c.w=0,c.next=function(){var v=c.x^c.x<<11;return c.x=c.y,c.y=c.z,c.z=c.w,c.w^=c.w>>>19^v^v>>>8},l===(0|l)?c.x=l:f+=l;for(var d=0;d<f.length+64;d++)c.x^=0|f.charCodeAt(d),c.next()}function i(l,c){return c.x=l.x,c.y=l.y,c.z=l.z,c.w=l.w,c}function s(l,c){var f=new a(l),d=c&&c.state,v=function(){return(f.next()>>>0)/4294967296};return v.double=function(){do var m=((f.next()>>>11)+(f.next()>>>0)/4294967296)/2097152;while(m===0);return m},v.int32=f.next,v.quick=v,d&&(typeof d=="object"&&i(d,f),v.state=function(){return i(f,{})}),v}e&&e.exports?e.exports=s:this.xor128=s})(0,r)}),FM=ls(function(r){(function(t,e,n){function a(l){var c=this,f="";c.next=function(){var v=c.x^c.x>>>2;return c.x=c.y,c.y=c.z,c.z=c.w,c.w=c.v,(c.d=c.d+362437|0)+(c.v=c.v^c.v<<4^v^v<<1)|0},c.x=0,c.y=0,c.z=0,c.w=0,c.v=0,l===(0|l)?c.x=l:f+=l;for(var d=0;d<f.length+64;d++)c.x^=0|f.charCodeAt(d),d==f.length&&(c.d=c.x<<10^c.x>>>4),c.next()}function i(l,c){return c.x=l.x,c.y=l.y,c.z=l.z,c.w=l.w,c.v=l.v,c.d=l.d,c}function s(l,c){var f=new a(l),d=c&&c.state,v=function(){return(f.next()>>>0)/4294967296};return v.double=function(){do var m=((f.next()>>>11)+(f.next()>>>0)/4294967296)/2097152;while(m===0);return m},v.int32=f.next,v.quick=v,d&&(typeof d=="object"&&i(d,f),v.state=function(){return i(f,{})}),v}e&&e.exports?e.exports=s:this.xorwow=s})(0,r)}),BM=ls(function(r){(function(t,e,n){function a(l){var c=this;c.next=function(){var f,d,v=c.x,m=c.i;return f=v[m],d=(f^=f>>>7)^f<<24,d^=(f=v[m+1&7])^f>>>10,d^=(f=v[m+3&7])^f>>>3,d^=(f=v[m+4&7])^f<<7,f=v[m+7&7],d^=(f^=f<<13)^f<<9,v[m]=d,c.i=m+1&7,d},function(f,d){var v,m=[];if(d===(0|d))m[0]=d;else for(d=""+d,v=0;v<d.length;++v)m[7&v]=m[7&v]<<15^d.charCodeAt(v)+m[v+1&7]<<13;for(;m.length<8;)m.push(0);for(v=0;v<8&&m[v]===0;++v);for(v==8?m[7]=-1:m[v],f.x=m,f.i=0,v=256;v>0;--v)f.next()}(c,l)}function i(l,c){return c.x=l.x.slice(),c.i=l.i,c}function s(l,c){l==null&&(l=+new Date);var f=new a(l),d=c&&c.state,v=function(){return(f.next()>>>0)/4294967296};return v.double=function(){do var m=((f.next()>>>11)+(f.next()>>>0)/4294967296)/2097152;while(m===0);return m},v.int32=f.next,v.quick=v,d&&(d.x&&i(d,f),v.state=function(){return i(f,{})}),v}e&&e.exports?e.exports=s:this.xorshift7=s})(0,r)}),LM=ls(function(r){(function(t,e,n){function a(l){var c=this;c.next=function(){var f,d,v=c.w,m=c.X,g=c.i;return c.w=v=v+1640531527|0,d=m[g+34&127],f=m[g=g+1&127],d^=d<<13,f^=f<<17,d^=d>>>15,f^=f>>>12,d=m[g]=d^f,c.i=g,d+(v^v>>>16)|0},function(f,d){var v,m,g,b,w,_=[],S=128;for(d===(0|d)?(m=d,d=null):(d+="\0",m=0,S=Math.max(S,d.length)),g=0,b=-32;b<S;++b)d&&(m^=d.charCodeAt((b+32)%d.length)),b===0&&(w=m),m^=m<<10,m^=m>>>15,m^=m<<4,m^=m>>>13,b>=0&&(w=w+1640531527|0,g=(v=_[127&b]^=m+w)==0?g+1:0);for(g>=128&&(_[127&(d&&d.length||0)]=-1),g=127,b=512;b>0;--b)m=_[g+34&127],v=_[g=g+1&127],m^=m<<13,v^=v<<17,m^=m>>>15,v^=v>>>12,_[g]=m^v;f.w=w,f.X=_,f.i=g}(c,l)}function i(l,c){return c.i=l.i,c.w=l.w,c.X=l.X.slice(),c}function s(l,c){l==null&&(l=+new Date);var f=new a(l),d=c&&c.state,v=function(){return(f.next()>>>0)/4294967296};return v.double=function(){do var m=((f.next()>>>11)+(f.next()>>>0)/4294967296)/2097152;while(m===0);return m},v.int32=f.next,v.quick=v,d&&(d.X&&i(d,f),v.state=function(){return i(f,{})}),v}e&&e.exports?e.exports=s:this.xor4096=s})(0,r)}),PM=ls(function(r){(function(t,e,n){function a(l){var c=this,f="";c.next=function(){var v=c.b,m=c.c,g=c.d,b=c.a;return v=v<<25^v>>>7^m,m=m-g|0,g=g<<24^g>>>8^b,b=b-v|0,c.b=v=v<<20^v>>>12^m,c.c=m=m-g|0,c.d=g<<16^m>>>16^b,c.a=b-v|0},c.a=0,c.b=0,c.c=-1640531527,c.d=1367130551,l===Math.floor(l)?(c.a=l/4294967296|0,c.b=0|l):f+=l;for(var d=0;d<f.length+20;d++)c.b^=0|f.charCodeAt(d),c.next()}function i(l,c){return c.a=l.a,c.b=l.b,c.c=l.c,c.d=l.d,c}function s(l,c){var f=new a(l),d=c&&c.state,v=function(){return(f.next()>>>0)/4294967296};return v.double=function(){do var m=((f.next()>>>11)+(f.next()>>>0)/4294967296)/2097152;while(m===0);return m},v.int32=f.next,v.quick=v,d&&(typeof d=="object"&&i(d,f),v.state=function(){return i(f,{})}),v}e&&e.exports?e.exports=s:this.tychei=s})(0,r)}),Po=ls(function(r){(function(t,e){var n,a=this,i=256,s=6,l="random",c=e.pow(i,s),f=e.pow(2,52),d=2*f,v=i-1;function m(S,E,C){var R=[],T=w(function M(N,I){var z,P=[],ne=typeof N;if(I&&ne=="object")for(z in N)try{P.push(M(N[z],I-1))}catch{}return P.length?P:ne=="string"?N:N+"\0"}((E=E==1?{entropy:!0}:E||{}).entropy?[S,_(t)]:S??function(){try{var M;return n&&(M=n.randomBytes)?M=M(i):(M=new Uint8Array(i),(a.crypto||a.msCrypto).getRandomValues(M)),_(M)}catch{var N=a.navigator,I=N&&N.plugins;return[+new Date,a,I,a.screen,_(t)]}}(),3),R),D=new g(R),k=function(){for(var M=D.g(s),N=c,I=0;M<f;)M=(M+I)*i,N*=i,I=D.g(1);for(;M>=d;)M/=2,N/=2,I>>>=1;return(M+I)/N};return k.int32=function(){return 0|D.g(4)},k.quick=function(){return D.g(4)/4294967296},k.double=k,w(_(D.S),t),(E.pass||C||function(M,N,I,z){return z&&(z.S&&b(z,D),M.state=function(){return b(D,{})}),I?(e[l]=M,N):M})(k,T,"global"in E?E.global:this==e,E.state)}function g(S){var E,C=S.length,R=this,T=0,D=R.i=R.j=0,k=R.S=[];for(C||(S=[C++]);T<i;)k[T]=T++;for(T=0;T<i;T++)k[T]=k[D=v&D+S[T%C]+(E=k[T])],k[D]=E;(R.g=function(M){for(var N,I=0,z=R.i,P=R.j,ne=R.S;M--;)N=ne[z=v&z+1],I=I*i+ne[v&(ne[z]=ne[P=v&P+N])+(ne[P]=N)];return R.i=z,R.j=P,I})(i)}function b(S,E){return E.i=S.i,E.j=S.j,E.S=S.S.slice(),E}function w(S,E){for(var C,R=S+"",T=0;T<R.length;)E[v&T]=v&(C^=19*E[v&T])+R.charCodeAt(T++);return _(E)}function _(S){return String.fromCharCode.apply(0,S)}if(e["seed"+l]=m,w(e.random(),t),r.exports){r.exports=m;try{n=require("crypto")}catch{}}})([],Math)});Po.alea=MM,Po.xor128=IM,Po.xorwow=FM,Po.xorshift7=BM,Po.xor4096=LM,Po.tychei=PM;var $d=Po.alea,qy=function(){function r(t,e,n,a,i){this.mean=t,this.stdDev=e,this.dtype=n,this.nextVal=NaN,this.truncated=a,this.truncated&&(this.upper=this.mean+2*this.stdDev,this.lower=this.mean-2*this.stdDev);var s=i||Math.random();this.random=$d(s.toString())}return r.prototype.nextValue=function(){if(!isNaN(this.nextVal)){var t=this.nextVal;return this.nextVal=NaN,t}for(var e,n,a=!1;!a;){var i=void 0,s=void 0,l=void 0;do l=(i=2*this.random()-1)*i+(s=2*this.random()-1)*s;while(l>=1||l===0);var c=Math.sqrt(-2*Math.log(l)/l);e=this.mean+this.stdDev*i*c,n=this.mean+this.stdDev*s*c,this.truncated&&!this.isValidTruncated(e)||(a=!0)}return this.truncated&&!this.isValidTruncated(n)||(this.nextVal=this.convertValue(n)),this.convertValue(e)},r.prototype.convertValue=function(t){return this.dtype==null||this.dtype==="float32"?t:Math.round(t)},r.prototype.isValidTruncated=function(t){return t<=this.upper&&t>=this.lower},r}(),zM=function(){function r(t,e,n,a){this.alpha=t,this.beta=1/e,this.dtype=n;var i=a||Math.random();this.randu=$d(i.toString()),this.randn=new qy(0,1,n,!1,this.randu()),this.d=t<1?t+2/3:t-1/3,this.c=1/Math.sqrt(9*this.d)}return r.prototype.nextValue=function(){for(var t,e,n,a,i,s;;){do a=this.randn.nextValue(),s=1+this.c*a;while(s<=0);if(s*=s*s,e=1-.331*(t=a*a)*t,n=.5*t+this.d*(1-s+Math.log(s)),(i=this.randu())<e||Math.log(i)<n)break}return s=1/this.beta*this.d*s,this.alpha<1&&(s*=Math.pow(this.randu(),1/this.alpha)),this.convertValue(s)},r.prototype.convertValue=function(t){return this.dtype==="float32"?t:Math.round(t)},r}(),UM=function(){function r(t,e,n,a){var i=this;if(t===void 0&&(t=0),e===void 0&&(e=1),this.canReturnFloat=function(){return i.dtype==null||i.dtype==="float32"},this.min=t,this.range=e-t,this.dtype=n,a==null&&(a=Math.random()),typeof a=="number"&&(a=a.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error("The difference between "+t+" - "+e+" <= 1 and dtype is not float");this.random=$d(a)}return r.prototype.convertValue=function(t){return this.canReturnFloat()?t:Math.round(t)},r.prototype.nextValue=function(){return this.convertValue(this.min+this.range*this.random())},r}();function Ge(r,t,e){return t===void 0&&(t="float32"),t=t||"float32",PE(r),new Ic(r,t,e)}function VM(r,t){t===void 0&&(t=!1),console.log(r.toString(t))}var qE=j({batchToSpaceND_:function(r,t,e){var n=B(r,"x","batchToSpaceND"),a=t.reduce(function(i,s){return i*s});return L(n.rank>=1+t.length,function(){return"input rank is "+n.rank+" but should be > than blockShape.length "+t.length}),L(e.length===t.length,function(){return"crops.length is "+e.length+" but should be equal to blockShape.length  "+t.length}),L(n.shape[0]%a==0,function(){return"input tensor batch is "+n.shape[0]+" but is not divisible by the product of the elements of blockShape "+t.join(" * ")+" === "+a}),q.runKernelFunc(function(i){return i.batchToSpaceND(n,t,e)},{$x:n},function(i){return{$x:function(){return i.spaceToBatchND(t,e)}}})}}),HM=j({broadcastTo_:function(r,t){var e=B(r,"broadcastTo","x"),n=e.shape;if(t.some(function(c){return!(c>0)||c%1!=0}))throw new Error("broadcastTo(): Invalid broadcast shape ["+t+"].");if(t.length<e.rank)throw new Error("broadcastTo(): shape.length="+t.length+" < input.rank="+e.rank+".");if(t.length>e.rank){for(var a=e.shape.slice();a.length<t.length;)a.unshift(1);e=e.reshape(a)}for(var i=Array.from(t),s=t.length-1;s>=0;s--)if(e.shape[s]===t[s])i[s]=1;else if(e.shape[s]!==1)throw new Error("broadcastTo(): ["+n+"] cannot be broadcast to ["+t+"].");var l=i.map(function(c,f){return c>1?f:-1}).filter(function(c){return c>=0});return l.length===0?e.clone():q.runKernelFunc(function(c){return c.tile(e,i)},{input:e},function(c){return{input:function(){return c.sum(l,!0)}}})}}),jM=j({cast_:function(r,t){var e=B(r,"x","cast");if(!F4(t))throw new Error("Failed to cast to unknown dtype "+t);if(t==="string"&&e.dtype!=="string"||t!=="string"&&e.dtype==="string")throw new Error("Only strings can be casted to strings");var n={dtype:t};return q.runKernelFunc(function(a){return a.cast(e,t)},{x:e},function(a){return{x:function(){return a.clone()}}},"Cast",n)}}),WM=j({clone_:function(r){var t=B(r,"x","clone",null);return q.runKernelFunc(function(){return q.makeTensorFromDataId(t.dataId,t.shape,t.dtype)},{$x:t},function(e){return{$x:function(){return e.toFloat()}}})}}),GM=j({cumsum_:function(r,t,e,n){t===void 0&&(t=0),e===void 0&&(e=!1),n===void 0&&(n=!1);var a=B(r,"x","cumsum"),i=Aa([t|=0],a.rank),s=a;i!=null&&(s=a.transpose(i));var l=Da(1,a.rank)[0],c=q.runKernelFunc(function(f){return f.cumsum(s,l,e,n)},{permutedX:s},function(f){return{permutedX:function(){return f.cumsum(t,e,!n)}}});return i!=null&&(c=c.transpose(i)),c}}),qM=j({depthToSpace_:function(r,t,e){e===void 0&&(e="NHWC");var n=B(r,"x","depthToSpace"),a=e==="NHWC"?n.shape[1]:n.shape[2],i=e==="NHWC"?n.shape[2]:n.shape[3],s=e==="NHWC"?n.shape[3]:n.shape[1];return L(a*t>=0,function(){return`Negative dimension size caused by overflow when multiplying
      `+a+" and "+t+`  for depthToSpace with input shape
      `+n.shape}),L(i*t>=0,function(){return`Negative dimension size caused by overflow when multiplying
      `+i+" and "+t+` for depthToSpace with input shape
          `+n.shape}),L(s%(t*t)==0,function(){return"Dimension size must be evenly divisible by "+t*t+" but is "+s+" for depthToSpace with input shape "+n.shape}),q.runKernelFunc(function(l){return l.depthToSpace(n,t,e)},{$x:n})}}),kr=j({expandDims_:function(r,t){t===void 0&&(t=0);var e=B(r,"x","expandDims",null);L(t<=e.rank,function(){return"Axis must be <= rank of the tensor"});var n=e.shape.slice();return t<0&&(L(-(e.rank+1)<=t,function(){return"Axis must be in the interval ["+-(e.rank+1)+", "+e.rank+"]"}),t=e.rank+t+1),n.splice(t,0,1),qr(e,n)}}),KE=j({eye_:function(r,t,e,n){n===void 0&&(n="float32"),t==null&&(t=r);for(var a=Ge([r,t],n),i=r<=t?r:t,s=0;s<i;++s)a.set(1,s,s);var l=a.toTensor().as2D(r,t);if(e==null)return l;if(e.length===1)return gu(kr(l,0),[e[0],1,1]);if(e.length===2)return gu(kr(kr(l,0),0),[e[0],e[1],1,1]);if(e.length===3)return gu(kr(kr(kr(l,0),0),0),[e[0],e[1],e[2],1,1]);throw new Error("eye() currently supports only 1D and 2D batchShapes, but received "+e.length+"D.")}}),KM=j({multinomial_:function(r,t,e,n){n===void 0&&(n=!1);var a=B(r,"logits","multinomial"),i=a.size,s=a.rank;if(i<2)throw new Error("Error in multinomial: you need at least 2 outcomes, but got "+i+".");if(s>2)throw new Error("Rank of probabilities must be 1 or 2, but is "+s);e=e||Math.random();var l=s===1?a.as2D(1,-1):a,c=q.runKernelFunc(function(f){return f.multinomial(l,n,t,e)},{logits2D:l});return s===1?c.as1D():c}}),cy=j({oneHot_:function(r,t,e,n){if(e===void 0&&(e=1),n===void 0&&(n=0),t<2)throw new Error("Error in oneHot: depth must be >=2, but it is "+t);var a=B(r,"indices","oneHot","int32"),i=a.shape.concat([t]);return a=a.flatten(),q.runKernelFunc(function(s){return s.oneHot(a,t,e,n)},{$indices:a},function(s){return{$indices:function(){return Dt(a.shape,"float32")}}}).reshape(i)}}),cs=j({pad_:function(r,t,e){e===void 0&&(e=0);var n=B(r,"x","pad");if(n.rank===0)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");var a={paddings:t,constantValue:e};return q.runKernelFunc(function(i){return i.pad(n,t,e)},{x:n},function(i){var s=t.map(function(l){return l[0]});return{x:function(){return i.slice(s,n.shape)}}},"PadV2",a)}}),XM=j({pad1d_:function(r,t,e){return e===void 0&&(e=0),L(t.length===2,function(){return"Invalid number of paddings. Must be length of 2."}),cs(r,[t],e)}}),$M=j({pad2d_:function(r,t,e){return e===void 0&&(e=0),L(t.length===2&&t[0].length===2&&t[1].length===2,function(){return"Invalid number of paddings. Must be length of 2 each."}),cs(r,t,e)}}),YM=j({pad3d_:function(r,t,e){return e===void 0&&(e=0),L(t.length===3&&t[0].length===2&&t[1].length===2&&t[2].length===2,function(){return"Invalid number of paddings. Must be length of 2 each."}),cs(r,t,e)}}),ZM=j({pad4d_:function(r,t,e){return e===void 0&&(e=0),L(t.length===4&&t[0].length===2&&t[1].length===2&&t[2].length===2&&t[3].length===2,function(){return"Invalid number of paddings. Must be length of 2 each."}),cs(r,t,e)}}),QM=j({rand_:function(r,t,e){var n=Te(r),a=null;if(e==null||e==="float32")a=new Float32Array(n);else if(e==="int32")a=new Int32Array(n);else{if(e!=="bool")throw new Error("Unknown data type "+e);a=new Uint8Array(n)}for(var i=0;i<n;i++)a[i]=t();return q.makeTensor(a,r,e)}}),JM=j({randomNormal_:function(r,t,e,n,a){if(t===void 0&&(t=0),e===void 0&&(e=1),n!=null&&n==="bool")throw new Error("Unsupported data type "+n);for(var i=new qy(t,e,n,!1,a),s=Ge(r,n),l=0;l<s.values.length;l++)s.values[l]=i.nextValue();return s.toTensor()}}),eI=j({randomGamma_:function(r,t,e,n,a){if(e===void 0&&(e=1),n===void 0&&(n="float32"),e==null&&(e=1),n==null&&(n="float32"),n!=="float32"&&n!=="int32")throw new Error("Unsupported data type "+n);for(var i=new zM(t,e,n,a),s=Ge(r,n),l=0;l<s.values.length;l++)s.values[l]=i.nextValue();return s.toTensor()}}),XE=j({randomUniform_:function(r,t,e,n,a){t===void 0&&(t=0),e===void 0&&(e=1),n===void 0&&(n="float32");for(var i=Ge(r,n),s=new UM(t,e,null,a),l=0;l<i.values.length;l++)i.values[l]=s.nextValue();return i.toTensor()}}),qr=j({reshape_:function(r,t){var e=B(r,"x","reshape",null);t=M4(t,e.size),L(e.size===Te(t),function(){return"new shape and old shape must have the same number of elements."});var n={shape:t};return q.runKernelFunc(function(a){return a.reshape(e,t)},{x:e},function(a){return{x:function(){return a.reshape(e.shape)}}},"Reshape",n)}}),$E=j({spaceToBatchND_:function(r,t,e){var n=B(r,"x","spaceToBatchND");return L(n.rank>=1+t.length,function(){return"input rank "+n.rank+" should be > than [blockShape] "+t.length}),L(e.length===t.length,function(){return"paddings.shape[0] "+e.length+" must be equal to [blockShape] "+t.length}),L(n.shape.reduce(function(a,i,s){return s>0&&s<=t.length?a&&(i+e[s-1][0]+e[s-1][1])%t[s-1]==0:a},!0),function(){return"input spatial dimensions "+n.shape.slice(1)+" with paddings "+e.toString()+" must be divisible by blockShapes "+t.toString()}),q.runKernelFunc(function(a){return a.spaceToBatchND(n,t,e)},{$x:n},function(a){return{$x:function(){return a.batchToSpaceND(t,e)}}})}}),YE=j({squeeze_:function(r,t){var e=B(r,"x","squeeze");return qr(e,zo(e.shape,t).newShape)}}),vr=j({stack_:function(r,t){t===void 0&&(t=0);var e=_d(r,"tensors","stack");if(L(e.length>=1,function(){return"Pass at least one tensor to tf.stack"}),e.length===1)return e[0].expandDims(t);var n=e[0].rank,a=e[0].shape,i=e[0].dtype;L(t<=n,function(){return"Axis must be <= rank of the tensor"}),e.forEach(function(l){gt(a,l.shape,"All tensors passed to stack must have matching shapes")}),e.forEach(function(l){L(i===l.dtype,function(){return"All tensors passed to stack must have matching dtypes"})});var s=e.map(function(l){return l.expandDims(t)});return nn(s,t)}}),gu=j({tile_:function(r,t){var e=B(r,"x","tile",null);L(e.rank===t.length,function(){return"Error in transpose: rank of input "+e.rank+" must match length of reps "+t+"."});var n=[e],a={reps:t};return q.runKernelFunc(function(i,s){var l=i.tile(e,t);return s([e]),l},{x:e},function(i,s){var l=s[0];return{x:function(){var c=lt(l);if(l.rank===1)for(var f=0;f<t[0];++f)c=c.add(i.slice([f*l.shape[0]],[l.shape[0]]));else if(l.rank===2)for(f=0;f<t[0];++f)for(var d=0;d<t[1];++d)c=c.add(i.slice([f*l.shape[0],d*l.shape[1]],[l.shape[0],l.shape[1]]));else if(l.rank===3)for(f=0;f<t[0];++f)for(d=0;d<t[1];++d)for(var v=0;v<t[2];++v)c=c.add(i.slice([f*l.shape[0],d*l.shape[1],v*l.shape[2]],[l.shape[0],l.shape[1],l.shape[2]]));else{if(l.rank!==4)throw new Error("Gradient for tile operation is not implemented for rank-"+l.rank+" tensors yet.");for(f=0;f<t[0];++f)for(d=0;d<t[1];++d)for(v=0;v<t[2];++v)for(var m=0;m<t[3];++m)c=c.add(i.slice([f*l.shape[0],d*l.shape[1],v*l.shape[2],m*l.shape[3]],[l.shape[0],l.shape[1],l.shape[2],l.shape[3]]))}return c}}},"Tile",a,n)}}),tI=j({truncatedNormal_:function(r,t,e,n,a){if(t===void 0&&(t=0),e===void 0&&(e=1),n!=null&&n==="bool")throw new Error("Unsupported data type "+n);for(var i=new qy(t,e,n,!0,a),s=Ge(r,n),l=0;l<s.values.length;l++)s.values[l]=i.nextValue();return s.toTensor()}}),rn=j({unstack_:function(r,t){t===void 0&&(t=0),t=t||0;var e=B(r,"x","unstack");L(t>=-e.shape.length&&t<e.shape.length,function(){return"Axis = "+t+" is not in [-"+e.shape.length+", "+e.shape.length+")"}),t<0&&(t+=e.shape.length);var n={axis:t};return q.runKernelFunc(function(a){return a.unstack(e,t)},{x:e},function(a){return{x:function(){return vr(a,t)}}},"Unpack",n)}}),nI=function(r,t){return Ce(this,void 0,void 0,function(){var e,n,a,i,s,l,c,f,d,v;return Re(this,function(m){switch(m.label){case 0:return e=B(r,"x","setdiff1d"),n=B(t,"y","setdiff1d"),L(e.dtype===n.dtype,function(){return"x and y should have the same dtype, but got x ("+e.dtype+") and y ("+n.dtype+")."}),L(e.rank===1,function(){return"x should be 1D tensor, but got x ("+e.shape+")."}),L(n.rank===1,function(){return"y should be 1D tensor, but got y ("+n.shape+")."}),[4,e.data()];case 1:return a=m.sent(),[4,n.data()];case 2:for(i=m.sent(),s=new Set(i),l=0,d=0;d<a.length;d++)s.has(a[d])||l++;for(c=new Ic([l],e.dtype),f=new Ic([l],"int32"),d=0,v=0;d<a.length;d++)s.has(a[d])||(c.values[v]=a[d],f.values[v]=d,v++);return[2,[c.toTensor(),f.toTensor()]]}})})};function Ed(r,t,e,n){n===void 0&&(n=!0);var a=[];if(n)(a=a.concat(t.slice(0))).push(r[0]/e),a=a.concat(r.slice(1));else{a=a.concat(r[0]);for(var i=t.length,s=0;s<i;++s)a=a.concat([r[s+1]/t[s],t[s]]);a=a.concat(r.slice(i+1))}return a}function Cd(r,t,e){e===void 0&&(e=!0);var n=[];if(e){n.push(t);for(var a=t+1;a<r;++a)a<=2*t?(n.push(a),n.push(a-(t+1))):n.push(a)}else{var i=[],s=[];for(a=1;a<r;++a)a>=2*t+1||a%2==1?s.push(a):i.push(a);n.push.apply(n,i),n.push(0),n.push.apply(n,s)}return n}function Rd(r,t,e,n){n===void 0&&(n=!0);var a=[];n?a.push(r[0]/e):a.push(r[0]*e);for(var i=1;i<r.length;++i)i<=t.length?n?a.push(t[i-1]*r[i]):a.push(r[i]/t[i-1]):a.push(r[i]);return a}function ZE(r,t){for(var e=[0],n=0;n<t;++n)e.push(r[n][0]);return e}function QE(r,t,e){for(var n=r.slice(0,1),a=0;a<e;++a)n.push(r[a+1]-t[a][0]-t[a][1]);return n}function JE(r,t){if(r.rank<1)throw new Error("tf.gatherND() expects the input to be rank 1 or higher, but the rank was "+r.rank+".");if(t.rank<1)throw new Error("tf.gatherND() expects the indices to be rank 1 or higher, but the rank was "+t.rank+".");if(t.dtype!=="int32")throw new Error("tf.gatherND() expects the indices to be int32 type, but the dtype was "+t.dtype+".");if(t.shape[t.rank-1]>r.rank)throw new Error("index innermost dimension length must be <= tensor rank; saw: "+t.shape[t.rank-1]+" vs. "+r.rank);if(r.size===0)throw new Error("Requested more than 0 entries, but input is empty. Input shape: "+r.shape+".");for(var e=t.shape,n=e[e.length-1],a=1,i=0;i<e.length-1;++i)a*=e[i];var s=r.shape,l=e.slice();l.pop();var c=1;for(i=n;i<r.rank;++i)c*=s[i],l.push(s[i]);var f=xa(r.shape).map(function(d){return d/c}).concat([1]).slice(0,n);return[l,a,c,f]}var eC=30;function tg(r){return r<=eC?r:ay(r,Math.floor(Math.sqrt(r)))}function rI(r,t,e){var n=t.rank>1?t.shape[t.rank-1]:1,a=t.rank>1?t.rank-1:1,i="Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: "+e.shape+", indices.shape: "+t.shape+", shape: "+r+", sliceDim: "+n+", and batchDim: "+a+".";if(e.rank<a)throw new Error(i+" update.rank < "+a+". ");if(r.length<n+(e.rank-a))throw new Error(i+" Output shape length < "+(n+(e.rank-a)));if(e.rank!==a+r.length-n)throw new Error(i+" update.rank != "+(a+r.length-n));for(var s=0;s<a;++s)if(e.shape[s]!==t.shape[s])throw new Error(i+" updates.shape["+s+"] ("+e.shape[s]+") != indices.shape["+s+"] ("+t.shape[s]+").");for(s=0;s<e.rank-a;++s)if(e.shape[s+a]!==r[s+n])throw new Error(i+" updates.shape["+(s+a)+"] ("+e.shape[s+a]+") != shape["+(s+a)+"] ("+r[s+a]+")")}function aI(r,t,e){if(t.rank<1)throw new Error("tf.scatterND() expects the indices to be rank 1 or higher, but the rank was "+t.rank+".");if(r.rank<1)throw new Error("tf.scatterND() expects the updates to be rank 1 or higher, but the rank was "+r.rank+".");if(t.dtype!=="int32")throw new Error("The dtype of 'indices' should be int32, but got dtype: "+t.dtype);if(e.length<1)throw new Error("Output rank must be greater or equal to 1, but got shape: "+e);if(e.length===0){if(t.size===0)throw new Error("Indices specified for empty output. indices shape: "+t.shape);if(r.size===0)throw new Error("Updates specified for empty output. updates shape: "+r.shape)}rI(e,t,r)}function Td(r,t,e){for(var n=t.shape.length,a=n>1?t.shape[n-1]:1,i=e.length,s=1,l=a;l<i;++l)s*=e[l];var c=a<1?1:a;return{sliceRank:a,numUpdates:Te(t.shape)/c,sliceSize:s,strides:xa(e.slice(0,a)).concat([1]),outputSize:Te(e)}}function iI(r,t,e){L(r.rank===t.length,function(){return"Error in slice"+r.rank+"D: Length of begin "+t+" must match the rank of the array ("+r.rank+")."}),L(r.rank===e.length,function(){return"Error in slice"+r.rank+"D: Length of size "+e+" must match the rank of the array ("+r.rank+")."});for(var n=function(i){L(t[i]+e[i]<=r.shape[i],function(){return"Error in slice"+r.rank+"D: begin["+i+"] + size["+i+"] ("+(t[i]+e[i])+") would overflow input.shape["+i+"] ("+r.shape[i]+")"})},a=0;a<r.rank;++a)n(a)}function i_(r){for(var t=[],e=0;r>0;)1&r&&t.push(e),r/=2,e++;return t}function Ky(r,t,e){for(var n=[],a=0;a<r.length;a++)n[a]=Math.ceil((t[a]-r[a])/e[a]);return n}function oI(r,t,e,n,a){var i=t[a],s=e[a]||1;(r&1<<a||i==null)&&(i=s>0?Number.MIN_SAFE_INTEGER:Number.MAX_SAFE_INTEGER);var l=n[a];return i<0&&(i+=l),i=ty(0,i,l-1)}function sI(r,t,e,n,a){var i=t[a],s=e[a]||1;(r&1<<a||i==null)&&(i=s>0?Number.MAX_SAFE_INTEGER:Number.MIN_SAFE_INTEGER);var l=n[a];return i<0&&(i+=l),i=s>0?ty(0,i,l):ty(-1,i,l-1)}function tC(r,t,e){for(var n=e.length,a=0;a<e.length;a++)if(e[a]>1){n=a;break}for(a=n+1;a<e.length;a++)if(t[a]>0||e[a]!==r[a])return!1;return!0}function nC(r,t){for(var e=r.length>0?r[r.length-1]:1,n=0;n<r.length-1;n++)e+=r[n]*t[n];return e}function uI(r,t){L(ry(r),function(){return"The f passed in variableGrads(f) must be a function"}),L(t==null||Array.isArray(t)&&t.every(function(d){return d instanceof qu}),function(){return"The varList passed in variableGrads(f, varList) must be an array of variables"});var e=t!=null;if(!e)for(var n in t=[],q.registeredVariables)t.push(q.registeredVariables[n]);var a=e?t.filter(function(d){return!d.trainable}):null,i=t.length;L((t=t.filter(function(d){return d.trainable})).length>0,function(){return"variableGrads() expects at least one of the input variables to be trainable, but none of the "+i+" variables is trainable."});var s=q.gradients(r,t,null,!0),l=s.value,c=s.grads;L(c.some(function(d){return d!=null}),function(){return"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."}),L(l.rank===0,function(){return"The f passed in variableGrads(f) must return a scalar, but it returned a rank-"+l.rank+" tensor"});var f={};return t.forEach(function(d,v){c[v]!=null&&(f[d.name]=c[v])}),a!=null&&a.forEach(function(d){return f[d.name]=null}),{value:l,grads:f}}function Yd(r){return q.customGrad(r)}var li=j({softmax_:function(r,t){t===void 0&&(t=-1);var e=B(r,"logits","softmax","float32");if(t===-1&&(t=e.rank-1),t!==e.rank-1)throw Error("Softmax along a non-last dimension is not yet supported. Logits was rank "+e.rank+" and dim was "+t);return q.runKernelFunc(function(n,a){var i=n.softmax(e,t);return a([i]),i},{logits:e},function(n,a){var i=a[0],s=n.mul(i);return{logits:function(){return s.sub(s.sum([t],!0).mul(i))}}},"Softmax",{dim:t},[],[!0])}}),lI=j({logSoftmax_:function(r,t){t===void 0&&(t=-1);var e=B(r,"logits","logSoftmax");if(t===-1&&(t=e.rank-1),t!==e.rank-1)throw Error("Log Softmax along a non-last dimension is not yet supported. Logits was rank "+e.rank+" and axis was "+t);return Yd(function(n,a){var i=n.max(t,!0),s=n.sub(i),l=s.toFloat().sub(s.exp().sum(t,!0).log());return a([l]),{value:l,gradFunc:function(c,f){var d=f[0].exp();return c.sub(c.sum(t,!0).mul(d))}}})(e)}}),rC=function(){function r(t,e){this.backend=t,this.dataMover=e,this.data=new WeakMap,this.dataIdsCount=0}return r.prototype.get=function(t){return this.data.has(t)||this.dataMover.moveData(this.backend,t),this.data.get(t)},r.prototype.set=function(t,e){this.dataIdsCount++,this.data.set(t,e)},r.prototype.has=function(t){return this.data.has(t)},r.prototype.delete=function(t){return this.dataIdsCount--,this.data.delete(t)},r.prototype.numDataIds=function(){return this.dataIdsCount},r}(),aC=function(){function r(){}return r.prototype.time=function(t){return ie("time")},r.prototype.read=function(t){return ie("read")},r.prototype.readSync=function(t){return ie("readSync")},r.prototype.numDataIds=function(){return ie("numDataIds")},r.prototype.disposeData=function(t){return ie("disposeData")},r.prototype.write=function(t,e,n){return ie("write")},r.prototype.move=function(t,e,n,a){return ie("move")},r.prototype.memory=function(){return ie("memory")},r.prototype.floatPrecision=function(){return ie("floatPrecision")},r.prototype.epsilon=function(){return this.floatPrecision()===32?1e-7:1e-4},r.prototype.batchMatMul=function(t,e,n,a){return ie("batchMatMul")},r.prototype.fusedBatchMatMul=function(t){return t.a,t.b,t.transposeA,t.transposeB,t.bias,t.activation,t.preluActivationWeights,ie("fusedBatchMatMul")},r.prototype.slice=function(t,e,n){return ie("slice")},r.prototype.stridedSlice=function(t,e,n,a){return ie("stridedSlice")},r.prototype.unstack=function(t,e){return ie("unstack")},r.prototype.reverse=function(t,e){return ie("reverse")},r.prototype.concat=function(t,e){return ie("concat")},r.prototype.neg=function(t){return ie("neg")},r.prototype.add=function(t,e){return ie("add")},r.prototype.addN=function(t){return ie("addN")},r.prototype.subtract=function(t,e){return ie("subtract")},r.prototype.multiply=function(t,e){return ie("multiply")},r.prototype.realDivide=function(t,e){return ie("realDivide")},r.prototype.floorDiv=function(t,e){return ie("floorDiv")},r.prototype.sum=function(t,e){return ie("sum")},r.prototype.prod=function(t,e){return ie("prod")},r.prototype.unsortedSegmentSum=function(t,e,n){return ie("unsortedSegmentSum")},r.prototype.argMin=function(t,e){return ie("argMin")},r.prototype.argMax=function(t,e){return ie("argMax")},r.prototype.equal=function(t,e){return ie("equal")},r.prototype.notEqual=function(t,e){return ie("notEqual")},r.prototype.less=function(t,e){return ie("less")},r.prototype.lessEqual=function(t,e){return ie("lessEqual")},r.prototype.greater=function(t,e){return ie("greater")},r.prototype.greaterEqual=function(t,e){return ie("greaterEqual")},r.prototype.logicalNot=function(t){return ie("logicalNot")},r.prototype.logicalAnd=function(t,e){return ie("logicalAnd")},r.prototype.logicalOr=function(t,e){return ie("logicalOr")},r.prototype.where=function(t){return ie("where")},r.prototype.select=function(t,e,n){return ie("select")},r.prototype.topk=function(t,e,n){return ie("topk")},r.prototype.min=function(t,e){return ie("min")},r.prototype.minimum=function(t,e){return ie("minimum")},r.prototype.mod=function(t,e){return ie("mod")},r.prototype.max=function(t,e){return ie("max")},r.prototype.maximum=function(t,e){return ie("maximum")},r.prototype.all=function(t,e){return ie("all")},r.prototype.any=function(t,e){return ie("any")},r.prototype.squaredDifference=function(t,e){return ie("squaredDifference")},r.prototype.ceil=function(t){return ie("ceil")},r.prototype.floor=function(t){return ie("floor")},r.prototype.round=function(t){return ie("round")},r.prototype.sign=function(t){return ie("sign")},r.prototype.isNaN=function(t){return ie("isNaN")},r.prototype.isInf=function(t){return ie("isInf")},r.prototype.isFinite=function(t){return ie("isFinite")},r.prototype.pow=function(t,e){return ie("pow")},r.prototype.exp=function(t){return ie("exp")},r.prototype.expm1=function(t){return ie("expm1")},r.prototype.softmax=function(t,e){return ie("softmax")},r.prototype.log=function(t){return ie("log")},r.prototype.log1p=function(t){return ie("log1p")},r.prototype.sqrt=function(t){return ie("sqrt")},r.prototype.rsqrt=function(t){return ie("rsqrt")},r.prototype.square=function(t){return ie("square")},r.prototype.reciprocal=function(t){return ie("reciprocal")},r.prototype.relu=function(t){return ie("relu")},r.prototype.relu6=function(t){return ie("relu6")},r.prototype.prelu=function(t,e){return ie("prelu")},r.prototype.elu=function(t){return ie("elu")},r.prototype.eluDer=function(t,e){return ie("eluDer")},r.prototype.selu=function(t){return ie("selu")},r.prototype.int=function(t){return ie("int")},r.prototype.clip=function(t,e,n){return ie("clip")},r.prototype.abs=function(t){return ie("abs")},r.prototype.complexAbs=function(t){return ie("complexAbs")},r.prototype.sigmoid=function(t){return ie("sigmoid")},r.prototype.softplus=function(t){return ie("softplus")},r.prototype.sin=function(t){return ie("sin")},r.prototype.cos=function(t){return ie("cos")},r.prototype.tan=function(t){return ie("tan")},r.prototype.asin=function(t){return ie("asin")},r.prototype.acos=function(t){return ie("acos")},r.prototype.atan=function(t){return ie("atan")},r.prototype.atan2=function(t,e){return ie("atan2")},r.prototype.sinh=function(t){return ie("sinh")},r.prototype.cosh=function(t){return ie("cosh")},r.prototype.tanh=function(t){return ie("tanh")},r.prototype.asinh=function(t){return ie("asinh")},r.prototype.acosh=function(t){return ie("acosh")},r.prototype.atanh=function(t){return ie("atanh")},r.prototype.erf=function(t){return ie("erf")},r.prototype.step=function(t,e){return ie("step")},r.prototype.fusedConv2d=function(t){return t.input,t.filter,t.convInfo,t.bias,t.activation,t.preluActivationWeights,ie("fusedConv2d")},r.prototype.conv2d=function(t,e,n){return ie("conv2d")},r.prototype.conv2dDerInput=function(t,e,n){return ie("conv2dDerInput")},r.prototype.conv2dDerFilter=function(t,e,n){return ie("conv2dDerFilter")},r.prototype.fusedDepthwiseConv2D=function(t){return t.input,t.filter,t.convInfo,t.bias,t.activation,t.preluActivationWeights,ie("fusedDepthwiseConv2D")},r.prototype.depthwiseConv2D=function(t,e,n){return ie("depthwiseConv2D")},r.prototype.depthwiseConv2DDerInput=function(t,e,n){return ie("depthwiseConv2DDerInput")},r.prototype.depthwiseConv2DDerFilter=function(t,e,n){return ie("depthwiseConv2DDerFilter")},r.prototype.conv3d=function(t,e,n){return ie("conv3d")},r.prototype.conv3dDerInput=function(t,e,n){return ie("conv3dDerInput")},r.prototype.conv3dDerFilter=function(t,e,n){return ie("conv3dDerFilter")},r.prototype.maxPool=function(t,e){return ie("maxPool")},r.prototype.maxPoolBackprop=function(t,e,n,a){return ie("maxPoolBackprop")},r.prototype.avgPool=function(t,e){return ie("avgPool")},r.prototype.avgPoolBackprop=function(t,e,n){return ie("avgPoolBackprop")},r.prototype.avgPool3d=function(t,e){return ie("avgPool3d")},r.prototype.avgPool3dBackprop=function(t,e,n){return ie("avgPool3dBackprop")},r.prototype.maxPool3d=function(t,e){return ie("maxPool3d")},r.prototype.maxPool3dBackprop=function(t,e,n,a){return ie("maxPool3dBackprop")},r.prototype.reshape=function(t,e){return ie("reshape")},r.prototype.cast=function(t,e){return ie("cast")},r.prototype.tile=function(t,e){return ie("tile")},r.prototype.pad=function(t,e,n){return ie("pad")},r.prototype.transpose=function(t,e){return ie("transpose")},r.prototype.gather=function(t,e,n){return ie("gather")},r.prototype.gatherND=function(t,e){return ie("gatherND")},r.prototype.scatterND=function(t,e,n){return ie("scatterND")},r.prototype.batchToSpaceND=function(t,e,n){return ie("batchToSpaceND")},r.prototype.spaceToBatchND=function(t,e,n){return ie("spaceToBatchND")},r.prototype.resizeBilinear=function(t,e,n,a){return ie("resizeBilinear")},r.prototype.resizeBilinearBackprop=function(t,e,n){return ie("resizeBilinearBackprop")},r.prototype.resizeNearestNeighbor=function(t,e,n,a){return ie("resizeNearestNeighbor")},r.prototype.resizeNearestNeighborBackprop=function(t,e,n){return ie("resizeNearestNeighborBackprop")},r.prototype.batchNormalization=function(t,e,n,a,i,s){return ie("batchNormalization")},r.prototype.localResponseNormalization4D=function(t,e,n,a,i){return ie("localResponseNormalization4D")},r.prototype.LRNGrad=function(t,e,n,a,i,s,l){return ie("LRNGrad")},r.prototype.multinomial=function(t,e,n,a){return ie("multinomial")},r.prototype.oneHot=function(t,e,n,a){return ie("oneHot")},r.prototype.cumsum=function(t,e,n,a){return ie("cumsum")},r.prototype.nonMaxSuppression=function(t,e,n,a,i){return ie("nonMaxSuppression")},r.prototype.fft=function(t){return ie("fft")},r.prototype.ifft=function(t){return ie("ifft")},r.prototype.complex=function(t,e){return ie("complex")},r.prototype.real=function(t){return ie("real")},r.prototype.imag=function(t){return ie("imag")},r.prototype.cropAndResize=function(t,e,n,a,i,s){return ie("cropAndResize")},r.prototype.depthToSpace=function(t,e,n){return ie("depthToSpace")},r.prototype.split=function(t,e,n){return ie("split")},r.prototype.sparseToDense=function(t,e,n,a){return ie("sparseToDense")},r.prototype.diag=function(t){return ie("diag")},r.prototype.fill=function(t,e,n){return ie("fill")},r.prototype.onesLike=function(t){return ie("onesLike")},r.prototype.zerosLike=function(t){return ie("zerosLike")},r.prototype.linspace=function(t,e,n){return ie("linspace")},r.prototype.dispose=function(){return ie("dispose")},r}();function ie(r){throw new Error("'"+r+"' not yet implemented or not found in the registry. Did you forget to import the kernel?")}function to(r,t){for(var e=r.length,n=[],a=0;a<e;a++){var i=e-1-a,s=r[i]||1;(t[t.length-1-a]||1)>1&&s===1&&n.unshift(i)}return n}function an(r,t){for(var e=[],n=0;n<t.length;n++){var a=r[r.length-n-1],i=t.length-n-1,s=t[i];(a==null||a===1&&s>1)&&e.unshift(i)}return e}function it(r,t){for(var e=[],n=Math.max(r.length,t.length),a=0;a<n;a++){var i=r[r.length-a-1];i==null&&(i=1);var s=t[t.length-a-1];if(s==null&&(s=1),i===1)e.unshift(s);else if(s===1)e.unshift(i);else{if(i!==s)throw Error("Operands could not be broadcast together with shapes "+r+" and "+t+".");e.unshift(i)}}return e}function Bc(r,t,e,n,a,i,s){s===void 0&&(s="channelsLast");var l,c=kd(t),f=c[0],d=c[1];if(s==="channelsLast")l=[f,d,r[3],r[3]];else{if(s!=="channelsFirst")throw new Error("Unknown dataFormat "+s);l=[f,d,r[1],r[1]]}return fs(r,l,e,n,a,i,!1,s)}function Ad(r,t,e,n,a,i,s){s===void 0&&(s="NDHWC");var l,c,f=fy(t),d=f[0],v=f[1],m=f[2];if(s==="NDHWC")c="channelsLast",l=[d,v,m,r[4],r[4]];else{if(s!=="NCDHW")throw new Error("Unknown dataFormat "+s);c="channelsFirst",l=[d,v,m,r[1],r[1]]}return Dd(r,l,e,n,a,!1,c,i)}function fs(r,t,e,n,a,i,s,l){s===void 0&&(s=!1),l===void 0&&(l="channelsLast");var c=[-1,-1,-1,-1],f=c[0],d=c[1],v=c[2],m=c[3];if(l==="channelsLast")f=r[0],d=r[1],v=r[2],m=r[3];else{if(l!=="channelsFirst")throw new Error("Unknown dataFormat "+l);f=r[0],m=r[1],d=r[2],v=r[3]}var g,b=t[0],w=t[1],_=t[3],S=kd(e),E=S[0],C=S[1],R=kd(n),T=R[0],D=R[1],k=yu(b,T),M=yu(w,D),N=function(re,ee,U,G,X,J,F,K){var oe,ue,pe;if(typeof re=="number"){oe={top:re,bottom:re,left:re,right:re,type:re===0?"VALID":"NUMBER"};var ge=function(Pe,qe,Je,dt,Et){dt==null&&(dt=iC(Pe,qe,Je));var xt=Pe[0],Vt=Pe[1],gr=pc((xt-qe+2*dt)/Je+1,Et);L(Wt(gr),function(){return"The output # of rows ("+gr+") must be an integer. Change the stride and/or zero pad parameters"});var En=pc((Vt-qe+2*dt)/Je+1,Et);return L(Wt(En),function(){return"The output # of columns ("+En+") must be an integer. Change the stride and/or zero pad parameters"}),[gr,En]}([ee,U],J,G,re,K);ue=ge[0],pe=ge[1]}else if(re==="same"){ue=Math.ceil(ee/G),pe=Math.ceil(U/X);var me=Math.max(0,(ue-1)*G+J-ee),Ne=Math.max(0,(pe-1)*X+F-U),xe=Math.floor(me/2),Ie=me-xe,ct=Math.floor(Ne/2);oe={top:xe,bottom:Ie,left:ct,right:Ne-ct,type:"SAME"}}else{if(re!=="valid")throw Error("Unknown padding parameter: "+re);oe={top:0,bottom:0,left:0,right:0,type:"VALID"},ue=Math.ceil((ee-J+1)/G),pe=Math.ceil((U-F+1)/X)}return{padInfo:oe,outHeight:ue,outWidth:pe}}(a,d,v,E,C,k,M,i),I=N.padInfo,z=N.outHeight,P=N.outWidth,ne=s?_*m:_;return l==="channelsFirst"?g=[f,ne,z,P]:l==="channelsLast"&&(g=[f,z,P,ne]),{batchSize:f,dataFormat:l,inHeight:d,inWidth:v,inChannels:m,outHeight:z,outWidth:P,outChannels:ne,padInfo:I,strideHeight:E,strideWidth:C,filterHeight:b,filterWidth:w,effectiveFilterHeight:k,effectiveFilterWidth:M,dilationHeight:T,dilationWidth:D,inShape:r,outShape:g,filterShape:t}}function Dd(r,t,e,n,a,i,s,l){i===void 0&&(i=!1),s===void 0&&(s="channelsLast");var c=[-1,-1,-1,-1,-1],f=c[0],d=c[1],v=c[2],m=c[3],g=c[4];if(s==="channelsLast")f=r[0],d=r[1],v=r[2],m=r[3],g=r[4];else{if(s!=="channelsFirst")throw new Error("Unknown dataFormat "+s);f=r[0],g=r[1],d=r[2],v=r[3],m=r[4]}var b,w=t[0],_=t[1],S=t[2],E=t[4],C=fy(e),R=C[0],T=C[1],D=C[2],k=fy(n),M=k[0],N=k[1],I=k[2],z=yu(w,M),P=yu(_,N),ne=yu(S,I),re=function(F,K,oe,ue,pe,ge,me,Ne,xe,Ie,ct){var Pe,qe,Je,dt;if(typeof F=="number"){Pe={top:F,bottom:F,left:F,right:F,front:F,back:F,type:F===0?"VALID":"NUMBER"};var Et=function(pi,Br,Oa,Gt,Yt,gn){Yt==null&&(Yt=iC(pi,Br,Gt));var fp=pi[0],hp=pi[1],dp=pi[2],vi=pc((fp-Br+2*Yt)/Gt+1,gn);L(Wt(vi),function(){return"The output # of depths ("+vi+") must be an integer. Change the stride and/or zero pad parameters"});var mi=pc((hp-Br+2*Yt)/Gt+1,gn);L(Wt(mi),function(){return"The output # of rows ("+mi+") must be an integer. Change the stride and/or zero pad parameters"});var Lr=pc((dp-Br+2*Yt)/Gt+1,gn);return L(Wt(Lr),function(){return"The output # of columns ("+Lr+") must be an integer. Change the stride and/or zero pad parameters"}),[vi,mi,Lr,Oa]}([K,oe,ue,1],Ne,1,pe,F,ct);qe=Et[0],Je=Et[1],dt=Et[2]}else if(F==="same"){qe=Math.ceil(K/pe),Je=Math.ceil(oe/ge),dt=Math.ceil(ue/me);var xt=(qe-1)*pe+Ne-K,Vt=(Je-1)*ge+xe-oe,gr=(dt-1)*me+Ie-ue,En=Math.floor(xt/2),ka=xt-En,Vn=Math.floor(Vt/2),ea=Vt-Vn,yr=Math.floor(gr/2);Pe={top:Vn,bottom:ea,left:yr,right:gr-yr,front:En,back:ka,type:"SAME"}}else{if(F!=="valid")throw Error("Unknown padding parameter: "+F);Pe={top:0,bottom:0,left:0,right:0,front:0,back:0,type:"VALID"},qe=Math.ceil((K-Ne+1)/pe),Je=Math.ceil((oe-xe+1)/ge),dt=Math.ceil((ue-Ie+1)/me)}return{padInfo:Pe,outDepth:qe,outHeight:Je,outWidth:dt}}(a,d,v,m,R,T,D,z,P,ne,l),ee=re.padInfo,U=re.outDepth,G=re.outHeight,X=re.outWidth,J=i?E*g:E;return s==="channelsFirst"?b=[f,J,U,G,X]:s==="channelsLast"&&(b=[f,U,G,X,J]),{batchSize:f,dataFormat:s,inDepth:d,inHeight:v,inWidth:m,inChannels:g,outDepth:U,outHeight:G,outWidth:X,outChannels:J,padInfo:ee,strideDepth:R,strideHeight:T,strideWidth:D,filterDepth:w,filterHeight:_,filterWidth:S,effectiveFilterDepth:z,effectiveFilterHeight:P,effectiveFilterWidth:ne,dilationDepth:M,dilationHeight:N,dilationWidth:I,inShape:r,outShape:b,filterShape:t}}function iC(r,t,e,n){n===void 0&&(n=1);var a=yu(t,n);return Math.floor((r[0]*(e-1)-e+a)/2)}function kd(r){return typeof r=="number"?[r,r,r]:r.length===2?[r[0],r[1],1]:r}function fy(r){return typeof r=="number"?[r,r,r]:r}function yu(r,t){return t<=1?r:r+(r-1)*(t-1)}function pc(r,t){if(!t)return r;switch(t){case"round":return Math.round(r);case"ceil":return Math.ceil(r);case"floor":return Math.floor(r);default:throw new Error("Unknown roundingMode "+t)}}function Xu(r){var t=kd(r),e=t[0],n=t[1],a=t[2];return e===1&&n===1&&a===1}function er(r,t){return Xu(r)||Xu(t)}function Xy(r){if(r==="NHWC")return"channelsLast";if(r==="NCHW")return"channelsFirst";throw new Error("Unknown dataFormat "+r)}function oC(r,t,e){if(t==="complex64"){if(r.dtype==="complex64")return r.clone();var n=Dt(r.shape),a=r.toFloat(),i=e.complex(a,n);return n.dispose(),a.dispose(),i}if(!B4(r.dtype,t))return q.makeTensorFromDataId(r.dataId,r.shape,t);if(r.dtype==="complex64"){var s=e.real(r);return i=s.cast(t),s.dispose(),i}if(t==="int32")return e.int(r);if(t==="bool"){var l=ye(0,r.dtype);return i=e.notEqual(r,l),l.dispose(),i}throw new Error("Error in Cast: failed to cast "+r.dtype+" to "+t)}function hy(r,t){return q.makeTensorFromDataId(r.dataId,t,r.dtype)}function sC(r,t,e){var n=(t-r)/(e-1),a=Qc(e,"float32");a[0]=r;for(var i=1;i<a.length;i++)a[i]=a[i-1]+n;return $t(a,"float32")}function dy(r,t){if(r.length!==t.length)throw new Error("Cannot merge real and imag arrays of different lengths. real:"+r.length+", imag: "+t.length+".");for(var e=new Float32Array(2*r.length),n=0;n<e.length;n+=2)e[n]=r[n/2],e[n+1]=t[n/2];return e}function o_(r,t){return{real:r[2*t],imag:r[2*t+1]}}function cI(r,t,e,n){r[2*n]=t,r[2*n+1]=e}function fI(r,t,e){var n=(e?2:-2)*Math.PI*(r/t);return{real:Math.cos(n),imag:Math.sin(n)}}function hI(r,t,e){var n=function(i,s,l){return function(c,f,d){for(var v=0,m=c.length,g=0,b=!1;v<m;){var w=d(f,c[g=v+(m-v>>>1)]);w>0?v=g+1:(m=g,b=!w)}return b?v:-v-1}(i,s,l||dI)}(r,t,e),a=n<0?-(n+1):n;r.splice(a,0,t)}function dI(r,t){return r>t?1:r<t?-1:0}function $y(r,t,e,n,a){return uC(r,t,e,n,a,0).selectedIndices}function Yy(r,t,e,n,a,i){var s=uC(r,t,e,n,a,i);return s.numValidOutputs.dispose(),{selectedIndices:s.selectedIndices,selectedScores:s.selectedScores}}function uC(r,t,e,n,a,i,s,l){l===void 0&&(l=!1);for(var c=Array.from(t).map(function(R,T){return{score:R,boxIndex:T,suppressBeginIndex:0}}).filter(function(R){return R.score>a}).sort(s_),f=i>0?-.5/i:0,d=[],v=[];d.length<e&&c.length>0;){var m=c.pop(),g=m.score,b=m.boxIndex,w=m.suppressBeginIndex;if(g<a)break;for(var _=!1,S=d.length-1;S>=w;--S){var E=pI(r,b,d[S]);if(E>=n){_=!0;break}if(m.score=m.score*vI(n,f,E),m.score<=a)break}m.suppressBeginIndex=d.length,_||(m.score===g?(d.push(b),v.push(m.score)):m.score>a&&hI(c,m,s_))}var C=d.length;return l&&(d.fill(0,C),v.fill(0,C)),{selectedIndices:$t(d,"int32"),selectedScores:$t(v,"float32"),numValidOutputs:ye(C,"int32")}}function pI(r,t,e){var n=r.subarray(4*t,4*t+4),a=r.subarray(4*e,4*e+4),i=Math.min(n[0],n[2]),s=Math.min(n[1],n[3]),l=Math.max(n[0],n[2]),c=Math.max(n[1],n[3]),f=Math.min(a[0],a[2]),d=Math.min(a[1],a[3]),v=Math.max(a[0],a[2]),m=Math.max(a[1],a[3]),g=(l-i)*(c-s),b=(v-f)*(m-d);if(g<=0||b<=0)return 0;var w=Math.max(i,f),_=Math.max(s,d),S=Math.min(l,v),E=Math.min(c,m),C=Math.max(S-w,0)*Math.max(E-_,0);return C/(g+b-C)}function vI(r,t,e){var n=Math.exp(t*e*e);return e<=r?n:0}function s_(r,t){return r.score-t.score||r.score===t.score&&t.boxIndex-r.boxIndex}function lC(r,t,e){var n=new Array(r.rank).fill(0),a=r.shape.slice();return t.map(function(i){a[e]=i;var s=r.slice(n,a);return n[e]+=i,s})}function cC(r,t){for(var e=new Array(r.rank),n=0;n<e.length;n++)e[n]=r.shape[n]*t[n];var a=Ge(e,r.dtype);for(n=0;n<a.values.length;++n){for(var i=a.indexToLoc(n),s=new Array(r.rank),l=0;l<s.length;l++)s[l]=i[l]%r.shape[l];var c=r.locToIndex(s);a.values[n]=r.values[c]}return a.toTensor()}function fC(r,t,e,n,a){for(var i=t[t.length-1],s=[r.length/i,i],l=s[0],c=s[1],f=Mc(e,l*n),d=Mc("int32",l*n),v=0;v<l;v++){for(var m=v*c,g=r.subarray(m,m+c),b=[],w=0;w<g.length;w++)b.push({value:g[w],index:w});b.sort(function(R,T){return T.value-R.value});var _=v*n,S=f.subarray(_,_+n),E=d.subarray(_,_+n);for(w=0;w<n;w++)S[w]=b[w].value,E[w]=b[w].index}var C=t.slice();return C[C.length-1]=n,[Sn(f,C,e),Sn(d,C,"int32")]}function Zy(r,t){for(var e=[],n=0;n<t.length;n++)t[n]&&e.push(n);var a=Ge(r,"int32"),i=Ge([e.length,r.length],"int32");for(n=0;n<e.length;n++){var s=a.indexToLoc(e[n]),l=n*r.length;i.values.set(s,l)}return i.toTensor()}var mI=function(r,t){this.outputShape=[],this.outputShape=r,this.variableNames=t.map(function(a,i){return"T"+i});var e=[];this.variableNames.forEach(function(a){e.push("float v"+a+" = get"+a+"AtOutCoords();")});var n=this.variableNames.map(function(a){return"v"+a}).join(" + ");this.userCode=`
      void main() {
        `+e.join(`
        `)+`

        float result = `+n+`;
        setOutput(result);
      }
    `},gI=function(r,t){this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=r,this.variableNames=t.map(function(a,i){return"T"+i});var e=[];this.variableNames.forEach(function(a){e.push("vec4 v"+a+" = get"+a+"AtOutCoords();")});var n=this.variableNames.map(function(a){return"v"+a}).join(" + ");this.userCode=`
      void main() {
        `+e.join(`
        `)+`

        vec4 result = `+n+`;
        setOutput(result);
      }
    `},yI=function(r,t,e){this.variableNames=["A"];var n=r.windowSize,a=r.batchSize,i=r.inSize,s=Math.ceil(i/n);e||this.variableNames.push("bestIndicesA"),this.outputShape=[a,s];var l=t==="max"?">":"<",c=e?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));";this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * `+n+`;

        int bestIndex = inOffset;
        float bestValue = getA(batch, bestIndex);

        for (int i = 0; i < `+n+`; i++) {
          int inIdx = `+c+`;
          float candidate = getA(batch, inIdx);
          if (candidate `+l+` bestValue) {
            bestValue = candidate;
            bestIndex = inIdx;
          }
        }
        setOutput(float(bestIndex));
      }
    `};function hC(r,t){return["x","y","z","w","u","v"].slice(0,t).map(function(e){return r+"."+e})}function Yn(r,t){return t===1?[r]:hC(r,t)}function On(){var r,t,e,n,a,i,s,l,c,f;return le().getNumber("WEBGL_VERSION")===2?(r="#version 300 es",t="in",e="out",n="in",a="texture",i="outputColor",s="out vec4 outputColor;",l=`
      bool isnan_custom(float val) {
        return (val > 0.0 || val < 0.0) ? false : val != 0.0;
      }

      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan_custom(val.x),
          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));
      }

      #define isnan(value) isnan_custom(value)
    `,c="",f=`
      #define round(value) newRound(value)
      int newRound(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 newRound(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `):(r="",t="attribute",e="varying",n="varying",a="texture2D",i="gl_FragColor",s="",l=`
      #define isnan(value) isnan_custom(value)
      bool isnan_custom(float val) {
        return (val > 0. || val < 1. || val == 0.) ? false : true;
      }
      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));
      }
    `,c=`
      uniform float INFINITY;

      bool isinf(float val) {
        return abs(val) == INFINITY;
      }
      bvec4 isinf(vec4 val) {
        return equal(abs(val), vec4(INFINITY));
      }
    `,f=`
      int round(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 round(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `),{version:r,attribute:t,varyingVs:e,varyingFs:n,texture2D:a,output:i,defineOutput:s,defineSpecialNaN:l,defineSpecialInf:c,defineRound:f}}function Vo(r,t,e){e===void 0&&(e="index");var n=xa(t);return n.map(function(a,i){return"int "+r[i]+" = "+e+" / "+a+"; "+(i===n.length-1?"int "+r[i+1]+" = "+e+" - "+r[i]+" * "+a:"index -= "+r[i]+" * "+a)+";"}).join("")}function Qy(r){var t=xa(r).map(function(e){return e.toString()});return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * `+t[0]+" + coords.y * "+t[1]+` + coords.z;
  }
`}var dC=`
  const float FLOAT_MAX = 1.70141184e38;
  const float FLOAT_MIN = 1.17549435e-38;

  lowp vec4 encode_float(highp float v) {
    if (isnan(v)) {
      return vec4(255, 255, 255, 255);
    }

    highp float av = abs(v);

    if(av < FLOAT_MIN) {
      return vec4(0.0, 0.0, 0.0, 0.0);
    } else if(v > FLOAT_MAX) {
      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;
    } else if(v < -FLOAT_MAX) {
      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;
    }

    highp vec4 c = vec4(0,0,0,0);

    highp float e = floor(log2(av));
    highp float m = exp2(fract(log2(av))) - 1.0;

    c[2] = floor(128.0 * m);
    m -= c[2] / 128.0;
    c[1] = floor(32768.0 * m);
    m -= c[1] / 32768.0;
    c[0] = floor(8388608.0 * m);

    highp float ebias = e + 127.0;
    c[3] = floor(ebias / 2.0);
    ebias -= c[3] * 2.0;
    c[2] += floor(ebias) * 128.0;

    c[3] += 128.0 * step(0.0, -v);

    return c / 255.0;
  }
`;function bI(r,t,e,n){var a=[];r.forEach(function(g){var b=Te(g.shapeInfo.logicalShape);g.shapeInfo.isUniform?a.push("uniform float "+g.name+(b>1?"["+b+"]":"")+";"):(a.push("uniform sampler2D "+g.name+";"),a.push("uniform int offset"+g.name+";"))});var i,s,l=a.join(`
`),c=r.map(function(g){return function(b,w,_){_===void 0&&(_=!1);var S="";S+=_?pC(b):uu(b);var E=b.shapeInfo.logicalShape,C=w.logicalShape;return E.length<=C.length&&(S+=_?function(R,T){var D,k=R.name,M=k.charAt(0).toUpperCase()+k.slice(1),N="get"+M+"AtOutCoords",I=R.shapeInfo.logicalShape.length,z=T.logicalShape.length,P=to(R.shapeInfo.logicalShape,T.logicalShape),ne=Tt(z),re=z-I,ee=["x","y","z","w","u","v"];D=I===0?"":z<2&&P.length>=1?"coords = 0;":P.map(function(oe){return"coords."+ee[oe+re]+" = 0;"}).join(`
`);var U="";U=z<2&&I>0?"coords":R.shapeInfo.logicalShape.map(function(oe,ue){return"coords."+ee[ue+re]}).join(", ");var G="return outputValue;",X=Te(R.shapeInfo.logicalShape)===1,J=Te(T.logicalShape)===1;if(I!==1||X||J){if(X&&!J)G=z===1?`
        return vec4(outputValue.x, outputValue.x, 0., 0.);
      `:`
        return vec4(outputValue.x);
      `;else if(P.length){var F=I-2,K=I-1;P.indexOf(F)>-1&&P.indexOf(K)>-1?G="return vec4(outputValue.x);":P.indexOf(F)>-1?G="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":P.indexOf(K)>-1&&(G="return vec4(outputValue.xx, outputValue.zz);")}}else G=`
      return vec4(outputValue.xy, outputValue.xy);
    `;return`
    vec4 `+N+`() {
      `+ne+` coords = getOutputCoords();
      `+D+`
      vec4 outputValue = get`+M+"("+U+`);
      `+G+`
    }
  `}(b,w):function(R,T){var D=R.name,k=D.charAt(0).toUpperCase()+D.slice(1),M="get"+k+"AtOutCoords",N=T.texShape,I=R.shapeInfo.texShape,z=R.shapeInfo.logicalShape.length,P=T.logicalShape.length;if(!R.shapeInfo.isUniform&&z===P&&R.shapeInfo.flatOffset==null&&vn(I,N))return`
      float `+M+`() {
        return sampleTexture(`+D+`, resultUV);
      }
    `;var ne,re=Tt(P),ee=to(R.shapeInfo.logicalShape,T.logicalShape),U=P-z,G=["x","y","z","w","u","v"];ne=z===0?"":P<2&&ee.length>=1?"coords = 0;":ee.map(function(J){return"coords."+G[J+U]+" = 0;"}).join(`
`);var X="";return X=P<2&&z>0?"coords":R.shapeInfo.logicalShape.map(function(J,F){return"coords."+G[F+U]}).join(", "),`
    float `+M+`() {
      `+re+` coords = getOutputCoords();
      `+ne+`
      return get`+k+"("+X+`);
    }
  `}(b,w)),S}(g,t,n)}).join(`
`),f=t.texShape,d=On(),v=function(g){return`
    float sampleTexture(sampler2D textureSampler, vec2 uv) {
      return `+g.texture2D+`(textureSampler, uv).r;
    }
  `}(d),m=function(g){return g.version+`
    precision highp float;
    precision highp int;
    precision highp sampler2D;
    `+g.varyingFs+` vec2 resultUV;
    `+g.defineOutput+`
    const vec2 halfCR = vec2(0.5, 0.5);

    struct ivec5
    {
      int x;
      int y;
      int z;
      int w;
      int u;
    };

    struct ivec6
    {
      int x;
      int y;
      int z;
      int w;
      int u;
      int v;
    };

    uniform float NAN;
    `+g.defineSpecialNaN+`
    `+g.defineSpecialInf+`
    `+g.defineRound+`

    int imod(int x, int y) {
      return x - y * (x / y);
    }

    int idiv(int a, int b, float sign) {
      int res = a / b;
      int mod = imod(a, b);
      if (sign < 0. && mod != 0) {
        res -= 1;
      }
      return res;
    }

    //Based on the work of Dave Hoskins
    //https://www.shadertoy.com/view/4djSRW
    #define HASHSCALE1 443.8975
    float random(float seed){
      vec2 p = resultUV * seed;
      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);
      p3 += dot(p3, p3.yzx + 19.19);
      return fract((p3.x + p3.y) * p3.z);
    }

    `+xI+`
    `+wI+`
    `+_I+`
  `}(d);return t.isPacked?(i=function(g,b){switch(g.length){case 0:return`
    int getOutputCoords() {
      return 0;
    }
  `;case 1:return function(R,T){var D=[Math.ceil(T[0]/2),Math.ceil(T[1]/2)];return D[0]===1?`
      int getOutputCoords() {
        return 2 * int(resultUV.x * `+D[1]+`.0);
      }
    `:D[1]===1?`
      int getOutputCoords() {
        return 2 * int(resultUV.y * `+D[0]+`.0);
      }
    `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+D[0]+", "+D[1]+`));
      return 2 * (resTexRC.x * `+D[1]+` + resTexRC.y);
    }
  `}(0,b);case 2:return function(R,T){var D=[Math.ceil(T[0]/2),Math.ceil(T[1]/2)];if(vn(R,T))return`
      ivec2 getOutputCoords() {
        return 2 * ivec2(resultUV.yx * vec2(`+D[0]+", "+D[1]+`));
      }
    `;var k=Math.ceil(R[1]/2);return`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+D[0]+", "+D[1]+`));

      int index = resTexRC.x * `+D[1]+` + resTexRC.y;
      int r = 2 * (index / `+k+`);
      int c = imod(index, `+k+`) * 2;

      return ivec2(r, c);
    }
  `}(g,b);case 3:return w=g,_=b,S=[Math.ceil(_[0]/2),Math.ceil(_[1]/2)],E=Math.ceil(w[2]/2),C=E*Math.ceil(w[1]/2),`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+S[0]+", "+S[1]+`));
      int index = resTexRC.x * `+S[1]+` + resTexRC.y;

      int b = index / `+C+`;
      index -= b * `+C+`;

      int r = 2 * (index / `+E+`);
      int c = imod(index, `+E+`) * 2;

      return ivec3(b, r, c);
    }
  `;default:return function(R,T){for(var D=[Math.ceil(T[0]/2),Math.ceil(T[1]/2)],k=Math.ceil(R[R.length-1]/2),M=k*Math.ceil(R[R.length-2]/2),N=M,I="",z="b, r, c",P=2;P<R.length-1;P++)N*=R[R.length-P-1],I=`
      int b`+P+" = index / "+N+`;
      index -= b`+P+" * "+N+`;
    `+I,z="b"+P+", "+z;return`
    ivec`+R.length+` getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+D[0]+", "+D[1]+`));
      int index = resTexRC.x * `+D[1]+` + resTexRC.y;

      `+I+`

      int b = index / `+M+`;
      index -= b * `+M+`;

      int r = 2 * (index / `+k+`);
      int c = imod(index, `+k+`) * 2;

      return ivec`+R.length+"("+z+`);
    }
  `}(g,b)}var w,_,S,E,C}(t.logicalShape,f),s=function(g){return`
    void setOutput(vec4 val) {
      `+g.output+` = val;
    }
  `}(d)):(i=function(g,b){switch(g.length){case 0:return`
    int getOutputCoords() {
      return 0;
    }
  `;case 1:return function(S,E){return E[0]===1?`
      int getOutputCoords() {
        return int(resultUV.x * `+E[1]+`.0);
      }
    `:E[1]===1?`
      int getOutputCoords() {
        return int(resultUV.y * `+E[0]+`.0);
      }
    `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+E[0]+", "+E[1]+`));
      return resTexRC.x * `+E[1]+` + resTexRC.y;
    }
  `}(0,b);case 2:return function(S,E){return vn(S,E)?`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(`+E[0]+", "+E[1]+`));
      }
    `:S[1]===1?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(`+E[0]+", "+E[1]+`));
        int index = resTexRC.x * `+E[1]+` + resTexRC.y;
        return ivec2(index, 0);
      }
    `:S[0]===1?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(`+E[0]+", "+E[1]+`));
        int index = resTexRC.x * `+E[1]+` + resTexRC.y;
        return ivec2(0, index);
      }
    `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+E[0]+", "+E[1]+`));
      int index = resTexRC.x * `+E[1]+` + resTexRC.y;
      int r = index / `+S[1]+`;
      int c = index - r * `+S[1]+`;
      return ivec2(r, c);
    }
  `}(g,b);case 3:return w=b,_=Vo(["r","c","d"],g),`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+w[0]+", "+w[1]+`));
      int index = resTexRC.x * `+w[1]+` + resTexRC.y;
      `+_+`
      return ivec3(r, c, d);
    }
  `;case 4:return function(S,E){var C=Vo(["r","c","d","d2"],S);return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(`+E[0]+", "+E[1]+`));
      int index = resTexRC.x * `+E[1]+` + resTexRC.y;
      `+C+`
      return ivec4(r, c, d, d2);
    }
  `}(g,b);case 5:return function(S,E){var C=Vo(["r","c","d","d2","d3"],S);return`
    ivec5 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx * vec2(`+E[0]+`,
                             `+E[1]+`));

      int index = resTexRC.x * `+E[1]+` + resTexRC.y;

      `+C+`

      ivec5 outShape = ivec5(r, c, d, d2, d3);
      return outShape;
    }
  `}(g,b);case 6:return function(S,E){var C=Vo(["r","c","d","d2","d3","d4"],S);return`
    ivec6 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(`+E[0]+", "+E[1]+`));
      int index = resTexRC.x * `+E[1]+` + resTexRC.y;

      `+C+`

      ivec6 result = ivec6(r, c, d, d2, d3, d4);
      return result;
    }
  `}(g,b);default:throw new Error(g.length+"-D output sampling is not yet supported")}var w,_}(t.logicalShape,f),s=function(g){return`
    void setOutput(float val) {
      `+g.output+` = vec4(val, 0, 0, 0);
    }
  `}(d)),n&&(m+=SI),[m,v,s,l,i,c,e].join(`
`)}function uu(r){var t=r.shapeInfo.logicalShape;switch(t.length){case 0:return function(e){var n=e.name,a="get"+n.charAt(0).toUpperCase()+n.slice(1);if(e.shapeInfo.isUniform)return"float "+a+"() {return "+n+";}";var i=e.shapeInfo.texShape,s=i[0],l=i[1];if(s===1&&l===1)return`
      float `+a+`() {
        return sampleTexture(`+n+`, halfCR);
      }
    `;var c=e.shapeInfo.texShape,f=c[0],d=c[1],v=Bo(n);return`
    float `+a+`() {
      vec2 uv = uvFromFlat(`+f+", "+d+", "+v+`);
      return sampleTexture(`+n+`, uv);
    }
  `}(r);case 1:return function(e){var n=e.name,a="get"+n.charAt(0).toUpperCase()+n.slice(1);if(e.shapeInfo.isUniform)return`
      float `+a+`(int index) {
        `+nu(e)+`
      }
    `;var i=e.shapeInfo.texShape,s=i[0],l=i[1];if(l===1&&s===1)return`
      float `+a+`(int index) {
        return sampleTexture(`+n+`, halfCR);
      }
    `;var c=Bo(n);return l===1?`
      float `+a+`(int index) {
        vec2 uv = vec2(0.5, (float(index + `+c+") + 0.5) / "+s+`.0);
        return sampleTexture(`+n+`, uv);
      }
    `:s===1?`
      float `+a+`(int index) {
        vec2 uv = vec2((float(index + `+c+") + 0.5) / "+l+`.0, 0.5);
        return sampleTexture(`+n+`, uv);
      }
    `:`
    float `+a+`(int index) {
      vec2 uv = uvFromFlat(`+s+", "+l+", index + "+c+`);
      return sampleTexture(`+n+`, uv);
    }
  `}(r);case 2:return function(e){var n=e.shapeInfo.logicalShape,a=e.name,i="get"+a.charAt(0).toUpperCase()+a.slice(1),s=e.shapeInfo.texShape;if(s!=null&&vn(n,s)){var l=s[0],c=s[1];return`
    float `+i+`(int row, int col) {
      vec2 uv = (vec2(col, row) + halfCR) / vec2(`+c+".0, "+l+`.0);
      return sampleTexture(`+a+`, uv);
    }
  `}var f=zo(n),d=f.newShape,v=f.keptDims,m=d;if(m.length<n.length){var g=lu(e,m);return`
      `+uu(g)+`
      float `+i+`(int row, int col) {
        return `+i+"("+cu(["row","col"],v)+`);
      }
    `}if(e.shapeInfo.isUniform)return`
      float `+i+`(int row, int col) {
        int index = round(dot(vec2(row, col), vec2(`+n[1]+`, 1)));
        `+nu(e)+`
      }
    `;var b=s[0],w=s[1],_=Bo(a);return w===1?`
    float `+i+`(int row, int col) {
      float index = dot(vec3(row, col, `+_+"), vec3("+n[1]+`, 1, 1));
      vec2 uv = vec2(0.5, (index + 0.5) / `+b+`.0);
      return sampleTexture(`+a+`, uv);
    }
  `:b===1?`
    float `+i+`(int row, int col) {
      float index = dot(vec3(row, col, `+_+"), vec3("+n[1]+`, 1, 1));
      vec2 uv = vec2((index + 0.5) / `+w+`.0, 0.5);
      return sampleTexture(`+a+`, uv);
    }
  `:`
  float `+i+`(int row, int col) {
    // Explicitly use integer operations as dot() only works on floats.
    int index = row * `+n[1]+" + col + "+_+`;
    vec2 uv = uvFromFlat(`+b+", "+w+`, index);
    return sampleTexture(`+a+`, uv);
  }
`}(r);case 3:return function(e){var n=e.shapeInfo.logicalShape,a=e.name,i="get"+a.charAt(0).toUpperCase()+a.slice(1),s=n[1]*n[2],l=n[2],c=zo(n),f=c.newShape,d=c.keptDims,v=f;if(v.length<n.length){var m=lu(e,v);return`
        `+uu(m)+`
        float `+i+`(int row, int col, int depth) {
          return `+i+"("+cu(["row","col","depth"],d)+`);
        }
      `}if(e.shapeInfo.isUniform)return`
      float `+i+`(int row, int col, int depth) {
        int index = round(dot(vec3(row, col, depth),
                          vec3(`+s+", "+l+`, 1)));
        `+nu(e)+`
      }
    `;var g=e.shapeInfo.texShape,b=g[0],w=g[1],_=e.shapeInfo.flatOffset;if(w===s&&_==null)return`
        float `+i+`(int row, int col, int depth) {
          float texR = float(row);
          float texC = dot(vec2(col, depth), vec2(`+l+`, 1));
          vec2 uv = (vec2(texC, texR) + halfCR) /
                     vec2(`+w+".0, "+b+`.0);
          return sampleTexture(`+a+`, uv);
        }
      `;if(w===l&&_==null)return`
    float `+i+`(int row, int col, int depth) {
      float texR = dot(vec2(row, col), vec2(`+n[1]+`, 1));
      float texC = float(depth);
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(`+w+".0, "+b+`.0);
      return sampleTexture(`+a+`, uv);
    }
  `;var S=Bo(a);return`
      float `+i+`(int row, int col, int depth) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * `+s+" + col * "+l+" + depth + "+S+`;
        vec2 uv = uvFromFlat(`+b+", "+w+`, index);
        return sampleTexture(`+a+`, uv);
      }
  `}(r);case 4:return function(e){var n=e.shapeInfo.logicalShape,a=e.name,i="get"+a.charAt(0).toUpperCase()+a.slice(1),s=n[3],l=n[2]*s,c=n[1]*l,f=zo(n),d=f.newShape,v=f.keptDims;if(d.length<n.length){var m=lu(e,d);return`
      `+uu(m)+`
      float `+i+`(int row, int col, int depth, int depth2) {
        return `+i+"("+cu(["row","col","depth","depth2"],v)+`);
      }
    `}if(e.shapeInfo.isUniform)return`
      float `+i+`(int row, int col, int depth, int depth2) {
        int index = round(dot(vec4(row, col, depth, depth2),
                          vec4(`+c+", "+l+", "+s+`, 1)));
        `+nu(e)+`
      }
    `;var g=e.shapeInfo.flatOffset,b=e.shapeInfo.texShape,w=b[0],_=b[1];if(_===c&&g==null)return`
      float `+i+`(int row, int col, int depth, int depth2) {
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(`+l+", "+s+`, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(`+_+".0, "+w+`.0);
        return sampleTexture(`+a+`, uv);
      }
    `;if(_===s&&g==null)return`
      float `+i+`(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(`+n[1]*n[2]+", "+n[2]+`, 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(`+_+".0, "+w+`.0);
        return sampleTexture(`+a+`, uv);
      }
    `;var S=Bo(a);return`
    float `+i+`(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * `+c+" + col * "+l+` +
          depth * `+s+` + depth2;
      vec2 uv = uvFromFlat(`+w+", "+_+", index + "+S+`);
      return sampleTexture(`+a+`, uv);
    }
  `}(r);case 5:return function(e){var n=e.shapeInfo.logicalShape,a=e.name,i="get"+a.charAt(0).toUpperCase()+a.slice(1),s=n[4],l=n[3]*s,c=n[2]*l,f=n[1]*c,d=zo(n),v=d.newShape,m=d.keptDims;if(v.length<n.length){var g=lu(e,v);return`
      `+uu(g)+`
      float `+i+`(int row, int col, int depth, int depth2, int depth3) {
        return `+i+"("+cu(["row","col","depth","depth2","depth3"],m)+`);
      }
    `}if(e.shapeInfo.isUniform)return`
      float `+i+`(int row, int col, int depth, int depth2, int depth3) {
        float index = dot(
          vec4(row, col, depth, depth2),
          vec4(`+f+", "+c+", "+l+", "+s+`)) +
          depth3;
        `+nu(e)+`
      }
    `;var b=e.shapeInfo.flatOffset,w=e.shapeInfo.texShape,_=w[0],S=w[1];if(S===f&&b==null)return`
      float `+i+`(int row, int col, int depth, int depth2, int depth3) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
                         vec4(`+c+", "+l+", "+s+`, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(`+S+".0, "+_+`.0);
        return sampleTexture(`+a+`, uv);
      }
    `;if(S===s&&b==null)return`
      float `+i+`(int row, int col, int depth, int depth2, int depth3) {
        float texR = dot(
          vec4(row, col, depth, depth2),
          vec4(`+n[1]*n[2]*n[3]+`,
               `+n[2]*n[3]+", "+n[3]+`, 1));
        int texC = depth3;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(`+S+".0, "+_+`.0);
        return sampleTexture(`+a+`, uv);
      }
    `;var E=Bo(a);return`
    float `+i+`(int row, int col, int depth, int depth2, int depth3) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * `+f+" + col * "+c+" + depth * "+l+` +
          depth2 * `+s+" + depth3 + "+E+`;
      vec2 uv = uvFromFlat(`+_+", "+S+`, index);
      return sampleTexture(`+a+`, uv);
    }
  `}(r);case 6:return function(e){var n=e.shapeInfo.logicalShape,a=e.name,i="get"+a.charAt(0).toUpperCase()+a.slice(1),s=zo(n),l=s.newShape,c=s.keptDims;if(l.length<n.length){var f=lu(e,l);return`
      `+uu(f)+`
      float `+i+`(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        return `+i+"("+cu(["row","col","depth","depth2","depth3","depth4"],c)+`);
      }
    `}var d=n[5],v=n[4]*d,m=n[3]*v,g=n[2]*m,b=n[1]*g;if(e.shapeInfo.isUniform)return`
      float `+i+`(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
        int index = round(dot(
          vec4(row, col, depth, depth2),
          vec4(`+b+", "+g+", "+m+", "+v+`)) +
          dot(
            vec2(depth3, depth4),
            vec2(`+d+`, 1)));
        `+nu(e)+`
      }
    `;var w=e.shapeInfo.flatOffset,_=e.shapeInfo.texShape,S=_[0],E=_[1];if(E===b&&w==null)return`
      float `+i+`(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
          vec4(`+g+", "+m+", "+v+", "+d+`)) +
               float(depth4);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(`+E+".0, "+S+`.0);
        return sampleTexture(`+a+`, uv);
      }
    `;if(E===d&&w==null)return`
      float `+i+`(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        float texR = dot(vec4(row, col, depth, depth2),
          vec4(`+n[1]*n[2]*n[3]*n[4]+`,
               `+n[2]*n[3]*n[4]+`,
               `+n[3]*n[4]+`,
               `+n[4]+`)) + float(depth3);
        int texC = depth4;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(`+E+".0, "+S+`.0);
        return sampleTexture(`+a+`, uv);
      }
    `;var C=Bo(a);return`
    float `+i+`(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * `+b+" + col * "+g+" + depth * "+m+` +
          depth2 * `+v+" + depth3 * "+d+" + depth4 + "+C+`;
      vec2 uv = uvFromFlat(`+S+", "+E+`, index);
      return sampleTexture(`+a+`, uv);
    }
  `}(r);default:throw new Error(t.length+"-D input sampling is not yet supported")}}function pC(r){var t,e,n;switch(r.shapeInfo.logicalShape.length){case 0:return t=r.name,e="get"+t.charAt(0).toUpperCase()+t.slice(1),n=On(),`
    vec4 `+e+`() {
      return `+n.texture2D+"("+t+`, halfCR);
    }
  `;case 1:return function(a){var i=a.name,s="get"+i.charAt(0).toUpperCase()+i.slice(1),l=a.shapeInfo.texShape,c=[Math.ceil(l[0]/2),Math.ceil(l[1]/2)],f=On();return`
    vec4 `+s+`(int index) {
      vec2 uv = packedUVfrom1D(
        `+c[0]+", "+c[1]+`, index);
      return `+f.texture2D+"("+i+`, uv);
    }
  `}(r);case 2:return function(a){var i=a.shapeInfo.logicalShape,s=a.name,l="get"+s.charAt(0).toUpperCase()+s.slice(1),c=a.shapeInfo.texShape,f=c[0],d=c[1],v=On();if(c!=null&&vn(i,c))return`
      vec4 `+l+`(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(`+d+".0, "+f+`.0);

        return `+v.texture2D+"("+s+`, uv);
      }
    `;var m=[Math.ceil(c[0]/2),Math.ceil(c[1]/2)],g=Math.ceil(i[1]/2);return`
    vec4 `+l+`(int row, int col) {
      vec2 uv = packedUVfrom2D(`+g+", "+m[0]+", "+m[1]+`, row, col);
      return `+v.texture2D+"("+s+`, uv);
    }
  `}(r);case 3:return function(a){var i=a.shapeInfo.logicalShape,s=a.name,l="get"+s.charAt(0).toUpperCase()+s.slice(1),c=a.shapeInfo.texShape,f=[Math.ceil(c[0]/2),Math.ceil(c[1]/2)];if(i[0]===1){var d=i.slice(1),v=lu(a,d);return`
        `+pC(v)+`
        vec4 `+l+`(int b, int row, int col) {
          return `+l+"("+cu(["b","row","col"],[1,2])+`);
        }
      `}var m=f[0],g=f[1],b=Math.ceil(i[2]/2),w=b*Math.ceil(i[1]/2),_=On();return`
    vec4 `+l+`(int b, int row, int col) {
      vec2 uv = packedUVfrom3D(
        `+m+", "+g+", "+w+", "+b+`, b, row, col);
      return `+_.texture2D+"("+s+`, uv);
    }
  `}(r);default:return function(a){for(var i=a.shapeInfo.logicalShape,s=i.length,l=a.name,c="get"+l.charAt(0).toUpperCase()+l.slice(1),f=a.shapeInfo.texShape,d=[Math.ceil(f[0]/2),Math.ceil(f[1]/2)],v=d[0],m=d[1],g=Math.ceil(i[s-1]/2),b=g*Math.ceil(i[s-2]/2),w="int b, int row, int col",_="b * "+b+" + (row / 2) * "+g+" + (col / 2)",S=2;S<s-1;S++)w="int b"+S+", "+w,b*=i[s-S-1],_="b"+S+" * "+b+" + "+_;var E=On();return`
    vec4 `+c+"("+w+`) {
      int index = `+_+`;
      int texR = index / `+m+`;
      int texC = index - texR * `+m+`;
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(`+m+", "+v+`);
      return `+E.texture2D+"("+l+`, uv);
    }
  `}(r)}}var xI=`
vec2 uvFromFlat(int texNumR, int texNumC, int index) {
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
vec2 packedUVfrom1D(int texNumR, int texNumC, int index) {
  int texelIndex = index / 2;
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,wI=`
vec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,
  int texNumC, int row, int col) {
  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,_I=`
vec2 packedUVfrom3D(int texNumR, int texNumC,
    int texelsInBatch, int texelsInLogicalRow, int b,
    int row, int col) {
  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,SI=`
  float getChannel(vec4 frag, vec2 innerDims) {
    vec2 modCoord = mod(innerDims, 2.);
    return modCoord.x == 0. ?
      (modCoord.y == 0. ? frag.r : frag.g) :
      (modCoord.y == 0. ? frag.b : frag.a);
  }
  float getChannel(vec4 frag, int dim) {
    float modCoord = mod(float(dim), 2.);
    return modCoord == 0. ? frag.r : frag.g;
  }
`;function Bo(r){return"offset"+r}function nu(r){var t=r.name,e=Te(r.shapeInfo.logicalShape);return e<2?"return "+t+";":`
    for (int i = 0; i < `+e+`; i++) {
      if (i == index) {
        return `+t+`[i];
      }
    }
  `}function Tt(r){if(r<=1)return"int";if(r===2)return"ivec2";if(r===3)return"ivec3";if(r===4)return"ivec4";if(r===5)return"ivec5";if(r===6)return"ivec6";throw Error("GPU for rank "+r+" is not yet supported")}function lu(r,t){var e=JSON.parse(JSON.stringify(r));return e.shapeInfo.logicalShape=t,e}function cu(r,t){return t.map(function(e){return r[e]}).join(", ")}var EI=function(r,t,e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,L(r.length>2,function(){return"Packed arg"+(e.charAt(0).toUpperCase()+e.slice(1))+" supports only inputs with rank above 2."});var a=r[r.length-1],i=Math.ceil(a/t);this.outputShape=r.slice(0,-1),i>1&&this.outputShape.push(i),n||this.variableNames.push("bestIndicesA");var s,l,c=this.outputShape,f=c.length,d=Tt(f),v=Yn("coords",f);if(i===1){var m=Tt(l=f+1);s=`
        `+m+" sourceLocR = "+m+"("+v.join()+`, 0);
        ++`+v[f-1]+`;
        `+m+" sourceLocG = "+m+"("+v.join()+`, 0);
        ++`+v[f-2]+`;
        `+m+" sourceLocA = "+m+"("+v.join()+`, 0);
        --`+v[f-1]+`;
        `+m+" sourceLocB = "+m+"("+v.join()+`, 0);
        --`+v[f-2]+";"}else l=f,s=`
        `+d+` sourceLocR = coords;
        ++`+v[f-1]+`;
        `+d+` sourceLocG = coords;
        ++`+v[f-2]+`;
        `+d+` sourceLocA = coords;
        --`+v[f-1]+`;
        `+d+` sourceLocB = coords;
        --`+v[f-2]+";";var g=["x","y","z","w","u","v"].slice(0,l),b="."+g[l-1],w=g.map(function(M){return"int "+M}),_=Yn("sourceLocR",l-1).concat("inIdx.r"),S=Yn("sourceLocG",l-1).concat("inIdx.g"),E=Yn("sourceLocB",l-1).concat("inIdx.b"),C=Yn("sourceLocA",l-1).concat("inIdx.a"),R=e==="max"?"greaterThan":"lessThan",T=n?"":`
          inIdx = round(vec4(getBestIndicesAChannel(`+_.join()+`),
                             getBestIndicesAChannel(`+S.join()+`),
                             getBestIndicesAChannel(`+E.join()+`),
                             getBestIndicesAChannel(`+C.join()+")));",D=`vec4(
            getAChannel(`+_.join()+`),
            hasNextCol ? getAChannel(`+S.join()+`) : 0.,
            hasNextRow ? getAChannel(`+E.join()+`) : 0.,
            hasNextRow && hasNextCol ? getAChannel(`+C.join()+") : 0.)",k=n?"":`
      float getBestIndicesAChannel(`+w.join()+`) {
        return getChannel(getBestIndicesA(`+g.join()+`),
                                          vec2(`+g.slice(-2).join()+`));
      }`;this.userCode=`
      float getAChannel(`+w.join()+`) {
        return getChannel(getA(`+g.join()+`),
                               vec2(`+g.slice(-2).join()+`));
      }
      `+k+`
      void main() {
        `+d+` coords = getOutputCoords();
        bool hasNextCol = `+v[f-1]+" < "+(c[f-1]-1)+`;
        bool hasNextRow = `+v[f-2]+" < "+(c[f-2]-1)+`;
        `+s+`
        ivec4 srcIdx = ivec4(sourceLocR`+b+", sourceLocG"+b+`,
          sourceLocB`+b+", sourceLocA"+b+") * "+t+`;
        ivec4 inIdx = srcIdx;
        vec4 bestIndex = vec4(inIdx);
        vec4 bestValue = `+D+`;

        for (int i = 0; i < `+t+`; i++) {
          inIdx = srcIdx;
          `+T+`
          vec4 candidate = `+D+`;
          bvec4 nan = isnan(candidate);
          bvec4 replace = bvec4(
            vec4(`+R+`(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));

          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,
                           replace.y  ? candidate.y : bestValue.y,
                           replace.z  ? candidate.z : bestValue.z,
                           replace.w  ? candidate.w : bestValue.w);
          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));
          srcIdx++;
        }
        setOutput(bestIndex);
      }
    `},CI=function(r){this.variableNames=["dy"],this.outputShape=r.inShape;var t=r.filterHeight,e=r.filterWidth,n=r.strideHeight,a=r.strideWidth,i=r.dilationHeight,s=r.dilationWidth,l=r.effectiveFilterHeight,c=r.effectiveFilterWidth,f=l-1-r.padInfo.top,d=c-1-r.padInfo.left,v=1/(t*e);this.userCode=`
      const ivec2 pads = ivec2(`+f+", "+d+`);
      const float avgMultiplier = float(`+v+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < `+l+`;
            wR += `+i+`) {
          float dyR = float(dyRCorner + wR) / `+n+`.0;

          if (dyR < 0.0 || dyR >= `+r.outHeight+`.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < `+c+`;
            wC+= `+s+`) {
            float dyC = float(dyCCorner + wC) / `+a+`.0;

            if (dyC < 0.0 || dyC >= `+r.outWidth+`.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);

            dotProd += dyValue * avgMultiplier;
          }
        }
        setOutput(dotProd);
      }
    `},RI=function(r){this.variableNames=["dy"],this.outputShape=r.inShape;var t=r.filterDepth,e=r.filterHeight,n=r.filterWidth,a=r.strideDepth,i=r.strideHeight,s=r.strideWidth,l=r.dilationDepth,c=r.dilationHeight,f=r.dilationWidth,d=r.effectiveFilterDepth,v=r.effectiveFilterHeight,m=r.effectiveFilterWidth,g=d-1-r.padInfo.front,b=v-1-r.padInfo.top,w=m-1-r.padInfo.left,_=1/(t*e*n);this.userCode=`
      const ivec3 pads = ivec3(`+g+", "+b+", "+w+`);
      const float avgMultiplier = float(`+_+`);

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < `+d+`;
            wD += `+l+`) {
          float dyD = float(dyDCorner + wD) / `+a+`.0;

          if (dyD < 0.0 || dyD >= `+r.outDepth+`.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < `+v+`;
              wR += `+c+`) {
            float dyR = float(dyRCorner + wR) / `+i+`.0;

            if (dyR < 0.0 || dyR >= `+r.outHeight+`.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < `+m+`;
                wC += `+f+`) {
              float dyC = float(dyCCorner + wC) / `+s+`.0;

              if (dyC < 0.0 || dyC >= `+r.outWidth+`.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);

              dotProd += dyValue * avgMultiplier;
            }
          }
        }
        setOutput(dotProd);
      }
    `},TI=function(r,t,e,n,a,i){this.outputShape=[],this.variableNames=["x","mean","variance"],it(r,t),it(r,e);var s="0.0";n!=null&&(it(r,n),this.variableNames.push("offset"),s="getOffsetAtOutCoords()");var l="1.0";a!=null&&(it(r,a),this.variableNames.push("scale"),l="getScaleAtOutCoords()"),this.outputShape=r,this.userCode=`
      void main() {
        float x = getXAtOutCoords();
        float mean = getMeanAtOutCoords();
        float variance = getVarianceAtOutCoords();
        float offset = `+s+`;
        float scale = `+l+`;
        float inv = scale * inversesqrt(variance + float(`+i+`));
        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));
      }
    `},AI=function(r,t,e,n,a,i){this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],it(r,t),it(r,e);var s="vec4(0.0)";n!=null&&(it(r,n),this.variableNames.push("offset"),s="getOffsetAtOutCoords()");var l="vec4(1.0)";a!=null&&(it(r,a),this.variableNames.push("scale"),l="getScaleAtOutCoords()"),this.outputShape=r,this.userCode=`
      void main() {
        vec4 offset = `+s+`;
        vec4 scale = `+l+`;

        vec4 x = getXAtOutCoords();
        vec4 mean = getMeanAtOutCoords();
        vec4 variance = getVarianceAtOutCoords();

        vec4 inv = scale * inversesqrt(variance + vec4(`+i+`));

        setOutput((x - mean) * inv + offset);
      }
    `},DI="return areal * breal - aimag * bimag;",kI="return areal * bimag + aimag * breal;",u_=function(r,t,e){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=it(t,e),this.userCode=`
      float binaryOpComplex(
          float areal, float aimag, float breal, float bimag) {
        `+r+`
      }

      void main() {
        float areal = getARealAtOutCoords();
        float aimag = getAImagAtOutCoords();
        float breal = getBRealAtOutCoords();
        float bimag = getBImagAtOutCoords();
        setOutput(binaryOpComplex(areal, aimag, breal, bimag));
      }
    `},ng="return a + b;",rg="return a - b;",l_="return a * b;",vC="return (a < 0.) ? b * a : a;",zt=function(r,t,e){this.variableNames=["A","B"],this.outputShape=it(t,e),this.userCode=`
      float binaryOperation(float a, float b) {
        `+r+`
      }

      void main() {
        float a = getAAtOutCoords();
        float b = getBAtOutCoords();
        setOutput(binaryOperation(a, b));
      }
    `},mC=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`,Ya=function(r,t,e,n){n===void 0&&(n=!1),this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=it(t,e);var a=this.outputShape.length,i="";if(n)if(a===0||Te(this.outputShape)===1)i=`
          result.y = 0.;
          result.z = 0.;
          result.w = 0.;
        `;else if(i=`
          `+Tt(a)+` coords = getOutputCoords();
        `,a===1)i+=`
            result.y = (coords + 1) >= `+this.outputShape[0]+` ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `;else{var s=Yn("coords",a);i+=`
            bool nextRowOutOfBounds =
              (`+s[a-2]+" + 1) >= "+this.outputShape[a-2]+`;
            bool nextColOutOfBounds =
              (`+s[a-1]+" + 1) >= "+this.outputShape[a-1]+`;
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `}this.userCode=`
      vec4 binaryOperation(vec4 a, vec4 b) {
        `+r+`
      }

      void main() {
        vec4 a = getAAtOutCoords();
        vec4 b = getBAtOutCoords();

        vec4 result = binaryOperation(a, b);
        `+i+`

        setOutput(result);
      }
    `},OI=function(){function r(t){this.variableNames=["A"],this.outputShape=t,this.userCode=`
      uniform float minVal;
      uniform float maxVal;

      void main() {
        float value = getAAtOutCoords();
        if (isnan(value)) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, minVal, maxVal));
      }
    `}return r.prototype.getCustomSetupFunc=function(t,e){var n=this;return function(a,i){n.minLoc==null&&(n.minLoc=a.getUniformLocationNoThrow(i,"minVal"),n.maxLoc=a.getUniformLocationNoThrow(i,"maxVal")),a.gl.uniform1f(n.minLoc,t),a.gl.uniform1f(n.maxLoc,e)}},r}(),NI=function(){function r(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.userCode=`
      uniform float minVal;
      uniform float maxVal;

      void main() {
        vec4 value = getAAtOutCoords();

        if (any(isnan(value))) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));
      }
    `}return r.prototype.getCustomSetupFunc=function(t,e){var n=this;return function(a,i){n.minLoc==null&&(n.minLoc=a.getUniformLocationNoThrow(i,"minVal"),n.maxLoc=a.getUniformLocationNoThrow(i,"maxVal")),a.gl.uniform1f(n.minLoc,t),a.gl.uniform1f(n.maxLoc,e)}},r}(),MI=function(r){this.variableNames=["real","imag"],this.outputShape=r,this.userCode=`
      void main() {
        float re = abs(getRealAtOutCoords());
        float im = abs(getImagAtOutCoords());
        float mx = max(re, im);

        // sadly the length function in glsl is not underflow-safe
        // (at least not on Intel GPUs). So the safe solution is
        // to ensure underflow-safety in all cases.
        setOutput(
          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))
        );
      }
    `},II=function(r){this.outputShape=[],this.outputShape=Ku(r,1),this.variableNames=r.map(function(l,c){return"T"+c});var t=new Array(r.length-1);t[0]=r[0][1];for(var e=1;e<t.length;e++)t[e]=t[e-1]+r[e][1];var n=["if (yC < "+t[0]+") setOutput(getT0(yR, yC));"];for(e=1;e<t.length;e++){var a=t[e-1];n.push("else if (yC < "+t[e]+") setOutput(getT"+e+"(yR, yC-"+a+"));")}var i=t.length,s=t[t.length-1];n.push("else setOutput(getT"+i+"(yR, yC-"+s+"));"),this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int yR = coords.x;
        int yC = coords.y;

        `+n.join(`
        `)+`
      }
    `},FI=function(r,t){this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=Ku(r,t);var e=this.outputShape,n=e.length,a=Tt(n),i=Yn("coords",n),s=["x","y","z","w","u","v"].slice(0,n);this.variableNames=r.map(function(_,S){return"T"+S});var l=new Array(r.length-1);l[0]=r[0][t];for(var c=1;c<l.length;c++)l[c]=l[c-1]+r[c][t];var f=s[t],d=s.slice(-2),v=s.join(),m="if ("+f+" < "+l[0]+`) {
        return getChannel(
            getT0(`+v+"), vec2("+d.join()+`));
        }`;for(c=1;c<l.length;c++){var g=l[c-1];m+=`
        if (`+f+" < "+l[c]+"  && "+f+" >= "+l[c-1]+`) {
          return getChannel(
            getT`+c+"("+Oh(s,f,g)+`),
            vec2(`+Oh(d,f,g)+`));
        }`}var b=l.length,w=l[l.length-1];m+=`
        return getChannel(
          getT`+b+"("+Oh(s,f,w)+`),
          vec2(`+Oh(d,f,w)+"));",this.userCode=`
      float getValue(`+s.map(function(_){return"int "+_})+`) {
        `+m+`
      }

      void main() {
        `+a+` coords = getOutputCoords();
        vec4 result = vec4(getValue(`+i+`), 0., 0., 0.);

        `+i[n-1]+" = "+i[n-1]+` + 1;
        if (`+i[n-1]+" < "+e[n-1]+`) {
          result.g = getValue(`+i+`);
        }

        `+i[n-2]+" = "+i[n-2]+` + 1;
        if (`+i[n-2]+" < "+e[n-2]+`) {
          result.a = getValue(`+i+`);
        }

        `+i[n-1]+" = "+i[n-1]+` - 1;
        if (`+i[n-2]+" < "+e[n-2]+` &&
            `+i[n-1]+" < "+e[n-1]+`) {
          result.b = getValue(`+i+`);
        }
        setOutput(result);
      }
    `};function Oh(r,t,e){var n=r.indexOf(t);return r.map(function(a,i){return i===n?a+" - "+e:a}).join()}var BI=function(r){this.variableNames=["x","dy"],this.outputShape=r.filterShape;var t=r.strideHeight,e=r.strideWidth,n=r.padInfo.top,a=r.padInfo.left,i=r.dataFormat==="channelsLast";this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int d2 = coords.w;

        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int b = 0; b < `+r.batchSize+`; b++) {
          for (int yR = 0; yR < `+r.outHeight+`; yR++) {
            int xR = wR + yR * `+t+" - "+n+`;

            if (xR < 0 || xR >= `+r.inHeight+`) {
              continue;
            }

            for (int yC = 0; yC < `+r.outWidth+`; yC++) {
              int xC = wC + yC * `+e+" - "+a+`;

              if (xC < 0 || xC >= `+r.inWidth+`) {
                continue;
              }

              if (`+i+`) {
                float dyValue = getDy(b, yR, yC, d2);
                float xValue = getX(b, xR, xC, d1);
                dotProd += (xValue * dyValue);
              } else {
                float dyValue = getDy(b, d2, yR, yC);
                float xValue = getX(b, d1, xR, xC);
                dotProd += (xValue * dyValue);
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `},LI=function(r){this.variableNames=["dy","W"],this.outputShape=r.inShape;var t=r.filterHeight,e=r.filterWidth,n=r.strideHeight,a=r.strideWidth,i=r.dataFormat==="channelsLast",s=t-1-r.padInfo.top,l=e-1-r.padInfo.left,c=i?1:2,f=i?2:3,d=i?3:1;this.userCode=`
      const ivec2 pads = ivec2(`+s+", "+l+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[`+d+`];

        ivec2 dyCorner = ivec2(coords[`+c+"], coords["+f+`]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < `+t+`; wR++) {
          float dyR = float(dyRCorner + wR) / `+n+`.0;

          if (dyR < 0.0 || dyR >= `+r.outHeight+`.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = `+t+` - 1 - wR;

          for (int wC = 0; wC < `+e+`; wC++) {
            float dyC = float(dyCCorner + wC) / `+a+`.0;

            if (dyC < 0.0 || dyC >= `+r.outWidth+`.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = `+e+` - 1 - wC;

            for (int d2 = 0; d2 < `+r.outChannels+`; d2++) {

              if (`+i+`) {
                float xValue = getDy(batch, idyR, idyC, d2);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              } else {
                float xValue = getDy(batch, d2, idyR, idyC);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `},PI=function(r){this.variableNames=["x","dy"],this.outputShape=r.filterShape;var t=r.strideDepth,e=r.strideHeight,n=r.strideWidth,a=r.padInfo.front,i=r.padInfo.top,s=r.padInfo.left;this.userCode=`
      void main() {
        ivec5 coords = getOutputCoords();
        int wF = coords.x;
        int wR = coords.y;
        int wC = coords.z;
        int d1 = coords.w;
        int d2 = coords.u;

        float dotProd = 0.0;

        for (int b = 0; b < `+r.batchSize+`; b++) {
          for (int yF = 0; yF < `+r.outDepth+`; yF++) {
            int xF = wF + yF * `+t+" - "+a+`;

            if (xF < 0 || xF >= `+r.inDepth+`) {
              continue;
            }

            for (int yR = 0; yR < `+r.outHeight+`; yR++) {
              int xR = wR + yR * `+e+" - "+i+`;

              if (xR < 0 || xR >= `+r.inHeight+`) {
                continue;
              }

              for (int yC = 0; yC < `+r.outWidth+`; yC++) {
                int xC = wC + yC * `+n+" - "+s+`;

                if (xC < 0 || xC >= `+r.inWidth+`) {
                  continue;
                }

                float dyValue = getDy(b, yF, yR, yC, d2);
                float xValue = getX(b, xF, xR, xC, d1);
                dotProd += (xValue * dyValue);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `},zI=function(r){this.variableNames=["dy","W"],this.outputShape=r.inShape;var t=r.filterDepth,e=r.filterHeight,n=r.filterWidth,a=r.strideDepth,i=r.strideHeight,s=r.strideWidth,l=t-1-r.padInfo.front,c=e-1-r.padInfo.top,f=n-1-r.padInfo.left;this.userCode=`
      const ivec3 pads = ivec3(`+l+", "+c+", "+f+`);

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.u;


        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyFCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        float dotProd = 0.0;
        for (int wF = 0; wF < `+t+`; wF++) {
          float dyF = float(dyFCorner + wF) / `+a+`.0;

          if (dyF < 0.0 || dyF >= `+r.outDepth+`.0 || fract(dyF) > 0.0) {
            continue;
          }
          int idyF = int(dyF);

          int wFPerm = `+t+` - 1 - wF;

          for (int wR = 0; wR < `+e+`; wR++) {
            float dyR = float(dyRCorner + wR) / `+i+`.0;

            if (dyR < 0.0 || dyR >= `+r.outHeight+`.0 ||
              fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            int wRPerm = `+e+` - 1 - wR;

            for (int wC = 0; wC < `+n+`; wC++) {
              float dyC = float(dyCCorner + wC) / `+s+`.0;

              if (dyC < 0.0 || dyC >= `+r.outWidth+`.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              int wCPerm = `+n+` - 1 - wC;

              for (int d2 = 0; d2 < `+r.outChannels+`; d2++) {
                float xValue = getDy(batch, idyF, idyR, idyC, d2);
                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `},UI=function(r){this.variableNames=["x","dy"],this.outputShape=r.filterShape;var t=r.strideHeight,e=r.strideWidth,n=r.padInfo.top,a=r.padInfo.left,i=r.outChannels/r.inChannels;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int dm = coords.w;
        int d2 = d1 * `+i+` + dm;

        float dotProd = 0.0;

        // TO DO: Vec4 over the batch size
        for (int b = 0; b < `+r.batchSize+`; b++) {
          for (int yR = 0; yR < `+r.outHeight+`; yR++) {
            int xR = wR + yR * `+t+" - "+n+`;

            if (xR < 0 || xR >= `+r.inHeight+`) {
              continue;
            }

            for (int yC = 0; yC < `+r.outWidth+`; yC++) {
              int xC = wC + yC * `+e+" - "+a+`;

              if (xC < 0 || xC >= `+r.inWidth+`) {
                continue;
              }

              float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);
            }
          }
        }
        setOutput(dotProd);
      }
    `},VI=function(r){this.variableNames=["dy","W"],this.outputShape=r.inShape;var t=r.filterHeight,e=r.filterWidth,n=r.strideHeight,a=r.strideWidth,i=t-1-r.padInfo.top,s=e-1-r.padInfo.left,l=r.outChannels/r.inChannels;this.userCode=`
      const ivec2 pads = ivec2(`+i+", "+s+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];
        ivec2 dyCorner = coords.yz - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        float dotProd = 0.0;

        for (int wR = 0; wR < `+t+`; wR++) {
          float dyR = float(dyRCorner + wR) / `+n+`.0;

          if (dyR < 0.0 || dyR >= `+r.outHeight+`.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = `+t+` - 1 - wR;

          for (int wC = 0; wC < `+e+`; wC++) {
            float dyC = float(dyCCorner + wC) / `+a+`.0;

            if (dyC < 0.0 || dyC >= `+r.outWidth+`.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = `+e+` - 1 - wC;

            // TO DO: Vec4 over the channelMul
            for (int dm = 0; dm < `+l+`; dm++) {
              int d2 = d1 * `+l+` + dm;
              float xValue = getDy(batch, idyR, idyC, d2);
              float wValue = getW(wRPerm, wCPerm, d1, dm);
              dotProd += xValue * wValue;
            }
          }
        }
        setOutput(dotProd);
      }
    `},c_=function(r,t,e,n){t===void 0&&(t=!1),e===void 0&&(e=null),n===void 0&&(n=!1),this.variableNames=["x","W"],this.outputShape=r.outShape;var a=r.padInfo.top,i=r.padInfo.left,s=r.strideHeight,l=r.strideWidth,c=r.dilationHeight,f=r.dilationWidth,d=r.filterHeight,v=r.filterWidth,m=4*Math.floor(r.inChannels/4),g=r.inChannels%4,b=r.dataFormat==="channelsLast",w=b?1:2,_=b?2:3,S=b?3:1,E="",C="";e&&(E=n?`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          `+e+`
        }`:`
          float activation(float x) {
            `+e+`
          }
        `,C="result = activation(result);");var R=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),n&&this.variableNames.push("preluActivationWeights"),this.userCode=`
      `+E+`

      const ivec2 strides = ivec2(`+s+", "+l+`);
      const ivec2 pads = ivec2(`+a+", "+i+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d2 = coords[`+S+`];

        ivec2 xRCCorner =
            ivec2(coords[`+w+"], coords["+_+`]) * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < `+d+`; wR++) {
          int xR = xRCorner + wR * `+c+`;

          if (xR < 0 || xR >= `+r.inHeight+`) {
            continue;
          }

          for (int wC = 0; wC < `+v+`; wC++) {
            int xC = xCCorner + wC * `+f+`;

            if (xC < 0 || xC >= `+r.inWidth+`) {
              continue;
            }

            for (int d1 = 0; d1 < `+m+`; d1 += 4) {
              vec4 wValues = vec4(
                getW(wR, wC, d1, d2),
                getW(wR, wC, d1 + 1, d2),
                getW(wR, wC, d1 + 2, d2),
                getW(wR, wC, d1 + 3, d2)
              );

              if (`+b+`) {
                vec4 xValues = vec4(
                  getX(batch, xR, xC, d1),
                  getX(batch, xR, xC, d1 + 1),
                  getX(batch, xR, xC, d1 + 2),
                  getX(batch, xR, xC, d1 + 3)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec4 xValues = vec4(
                  getX(batch, d1, xR, xC),
                  getX(batch, d1 + 1, xR, xC),
                  getX(batch, d1 + 2, xR, xC),
                  getX(batch, d1 + 3, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }
            }

            if (`+(g===1)+`) {

              if (`+b+`) {
                dotProd +=
                    getX(batch, xR, xC, `+m+`) *
                    getW(wR, wC, `+m+`, d2);
              } else {
                dotProd +=
                    getX(batch, `+m+`, xR, xC) *
                    getW(wR, wC, `+m+`, d2);
              }

            } else if (`+(g===2)+`) {
              vec2 wValues = vec2(
                getW(wR, wC, `+m+`, d2),
                getW(wR, wC, `+m+` + 1, d2)
              );

              if (`+b+`) {
                vec2 xValues = vec2(
                  getX(batch, xR, xC, `+m+`),
                  getX(batch, xR, xC, `+m+` + 1)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec2 xValues = vec2(
                  getX(batch, `+m+`, xR, xC),
                  getX(batch, `+m+` + 1, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            } else if (`+(g===3)+`) {
              vec3 wValues = vec3(
                getW(wR, wC, `+m+`, d2),
                getW(wR, wC, `+m+` + 1, d2),
                getW(wR, wC, `+m+` + 2, d2)
              );

              if (`+b+`) {
                vec3 xValues = vec3(
                  getX(batch, xR, xC, `+m+`),
                  getX(batch, xR, xC, `+m+` + 1),
                  getX(batch, xR, xC, `+m+` + 2)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec3 xValues = vec3(
                  getX(batch, `+m+`, xR, xC),
                  getX(batch, `+m+` + 1, xR, xC),
                  getX(batch, `+m+` + 2, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            }
          }
        }

        float result = dotProd;
        `+R+`
        `+C+`
        setOutput(result);
      }
    `},HI=function(r){this.variableNames=["x","W"],this.outputShape=r.outShape;var t=r.padInfo.front,e=r.padInfo.top,n=r.padInfo.left,a=r.strideDepth,i=r.strideHeight,s=r.strideWidth,l=r.dilationDepth,c=r.dilationHeight,f=r.dilationWidth,d=r.filterDepth,v=r.filterHeight,m=r.filterWidth,g=4*Math.floor(r.inChannels/4),b=r.inChannels%4;this.userCode=`
      const ivec3 strides = ivec3(`+a+", "+i+", "+s+`);
      const ivec3 pads = ivec3(`+t+", "+e+", "+n+`);

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d2 = coords.u;

        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xFCorner = xFRCCorner.x;
        int xRCorner = xFRCCorner.y;
        int xCCorner = xFRCCorner.z;

        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get
        // y(yF, yR, yC, d2). ? = to be determined. : = across all
        // values in that axis.
        float dotProd = 0.0;
        for (int wF = 0; wF < `+d+`; wF++) {
          int xF = xFCorner + wF * `+l+`;

          if (xF < 0 || xF >= `+r.inDepth+`) {
            continue;
          }

          for (int wR = 0; wR < `+v+`; wR++) {
            int xR = xRCorner + wR * `+c+`;

            if (xR < 0 || xR >= `+r.inHeight+`) {
              continue;
            }

            for (int wC = 0; wC < `+m+`; wC++) {
              int xC = xCCorner + wC * `+f+`;

              if (xC < 0 || xC >= `+r.inWidth+`) {
                continue;
              }

              for (int d1 = 0; d1 < `+g+`; d1 += 4) {
                vec4 xValues = vec4(
                  getX(batch, xF, xR, xC, d1),
                  getX(batch, xF, xR, xC, d1 + 1),
                  getX(batch, xF, xR, xC, d1 + 2),
                  getX(batch, xF, xR, xC, d1 + 3)
                );
                vec4 wValues = vec4(
                  getW(wF, wR, wC, d1, d2),
                  getW(wF, wR, wC, d1 + 1, d2),
                  getW(wF, wR, wC, d1 + 2, d2),
                  getW(wF, wR, wC, d1 + 3, d2)
                );

                dotProd += dot(xValues, wValues);
              }

              if (`+(b===1)+`) {
                dotProd +=
                  getX(batch, xF, xR, xC, `+g+`) *
                  getW(wF, wR, wC, `+g+`, d2);
              } else if (`+(b===2)+`) {
                vec2 xValues = vec2(
                  getX(batch, xF, xR, xC, `+g+`),
                  getX(batch, xF, xR, xC, `+g+` + 1)
                );
                vec2 wValues = vec2(
                  getW(wF, wR, wC, `+g+`, d2),
                  getW(wF, wR, wC, `+g+` + 1, d2)
                );
                dotProd += dot(xValues, wValues);
              } else if (`+(b===3)+`) {
                vec3 xValues = vec3(
                  getX(batch, xF, xR, xC, `+g+`),
                  getX(batch, xF, xR, xC, `+g+` + 1),
                  getX(batch, xF, xR, xC, `+g+` + 2)
                );
                vec3 wValues = vec3(
                  getW(wF, wR, wC, `+g+`, d2),
                  getW(wF, wR, wC, `+g+` + 1, d2),
                  getW(wF, wR, wC, `+g+` + 2, d2)
                );
                dotProd += dot(xValues, wValues);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `},f_=function(r,t,e,n){t===void 0&&(t=!1),e===void 0&&(e=null),n===void 0&&(n=!1),this.variableNames=["x","W"],this.outputShape=r.outShape;var a=r.inHeight,i=r.inWidth,s=r.padInfo.top,l=r.padInfo.left,c=r.strideHeight,f=r.strideWidth,d=r.dilationHeight,v=r.dilationWidth,m=r.filterHeight,g=r.filterWidth,b=r.outChannels/r.inChannels,w="",_="";e&&(w=n?`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          `+e+`
        }`:`
          float activation(float x) {
            `+e+`
          }
        `,_="result = activation(result);");var S=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),n&&this.variableNames.push("preluActivationWeights"),this.userCode=`
      `+w+`

      const ivec2 strides = ivec2(`+c+", "+f+`);
      const ivec2 pads = ivec2(`+s+", "+l+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / `+b+`;
        int q = d2 - d1 * `+b+`;

        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.
        for (int wR = 0; wR < `+m+`; wR++) {
          int xR = xRCorner + wR * `+d+`;

          if (xR < 0 || xR >= `+a+`) {
            continue;
          }

          for (int wC = 0; wC < `+g+`; wC++) {
            int xC = xCCorner + wC * `+v+`;

            if (xC < 0 || xC >= `+i+`) {
              continue;
            }

            float xVal = getX(batch, xR, xC, d1);
            float wVal = getW(wR, wC, d1, q);
            dotProd += xVal * wVal;
          }
        }

        float result = dotProd;
        `+S+`
        `+_+`
        setOutput(result);
      }
    `},h_=function(r,t,e,n){t===void 0&&(t=!1),e===void 0&&(e=null),n===void 0&&(n=!1),this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=r.outShape;for(var a=r.inHeight,i=r.inWidth,s=r.padInfo.top,l=r.padInfo.left,c=r.strideHeight,f=r.strideWidth,d=r.dilationHeight,v=r.dilationWidth,m=r.filterHeight,g=r.filterWidth,b=g,w="int xR; int xC; int xCOffset;",_=0;_<m;_++)for(var S=0;S<g;S++)w+=`
          vec4 xTexelR`+_+"C"+2*S+` = vec4(0.);
          vec4 wR`+_+"C"+S+` = vec4(0.);
          vec4 xR`+_+"C"+S+" = vec4(0.);";for(_=0;_<m;_++)for(var E=0;E<b;E++){if(w+=`
          xR = xRCorner + `+_*d+`;
          xC = xCCorner + `+(S=2*E)*v+`;
        `,f===1){if(S<g&&(w+=l%2==1?`
                xCOffset = xC + 1;
                if(xR >= 0 && xR < `+a+" && xCOffset >= 0 && xCOffset < "+i+`) {
                  xTexelR`+_+"C"+S+` = getX(batch, xR, xCOffset, d1);

                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if(xCOffset + 1 >= `+i+`) {
                    xTexelR`+_+"C"+S+`.zw = vec2(0.);
                  }
                } else {
                  xTexelR`+_+"C"+S+` = vec4(0.);
                }

                xCOffset = xC + 1 - 2;
                if(xR >= 0 && xR < `+a+" && xCOffset >= 0 && xCOffset < "+i+`) {
                  vec4 previous = getX(batch, xR, xCOffset, d1);

                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if(xCOffset + 1 >= `+i+`) {
                    previous.zw = vec2(0.);
                  }

                  xR`+_+"C"+S+" = vec4(previous.zw, xTexelR"+_+"C"+S+`.xy);
                } else {
                  xR`+_+"C"+S+" = vec4(0, 0, xTexelR"+_+"C"+S+`.xy);
                }
              `:`
                if(xR >= 0 && xR < `+a+" && xC >= 0 && xC < "+i+`) {
                  xTexelR`+_+"C"+S+` = getX(batch, xR, xC, d1);
                } else {
                  xTexelR`+_+"C"+S+` = vec4(0.);
                }

                xR`+_+"C"+S+" = xTexelR"+_+"C"+S+`;
              `,S+1<g)){var C=l%2==0?IE(v):v;v%2==0&&l%2==1||v%2!=0&&l%2!=1?(w+=`
                  xCOffset = xC + `+l%2+" + "+C+`;

                  if(xR >= 0 && xR < `+a+` &&
                    xCOffset >= 0 && xCOffset < `+i+`) {
                    xTexelR`+_+"C"+(S+2)+` = getX(batch, xR, xCOffset, d1);
                  }
                `,v>1&&(w+=`
                    xCOffset -= 2;
                    if(xR >= 0 && xR < `+a+` &&
                      xCOffset >= 0 && xCOffset < `+i+`) {
                      xTexelR`+_+"C"+S+` = getX(batch, xR, xCOffset, d1);
                    } else {
                      xTexelR`+_+"C"+S+` = vec4(0.);
                    }
                  `),w+=`
                  xR`+_+"C"+(S+1)+` = vec4(
                    xTexelR`+_+"C"+S+".zw, xTexelR"+_+"C"+(S+2)+`.xy);
                `):w+=`
                  xCOffset = xC + `+C+`;

                  if(xR >= 0 && xR < `+a+` &&
                    xCOffset >= 0 && xCOffset < `+i+`) {
                    xTexelR`+_+"C"+(S+2)+` = getX(batch, xR, xCOffset, d1);
                  }

                  xR`+_+"C"+(S+1)+" = xTexelR"+_+"C"+(S+2)+`;
                `}}else S<g&&(w+=`
              if(xR >= 0 && xR < `+a+`) {
            `,l%2==1?(w+=`
                xCOffset = xC + 1 - `+f+`;
                if(xCOffset >= 0 && xCOffset < `+i+`) {
                  xTexelR`+_+"C"+S+` = getX(batch, xR, xCOffset, d1);
                } else {
                  xTexelR`+_+"C"+S+` = vec4(0.);
                }

                if(xC + 1 >= 0 && xC + 1 < `+i+`) {
                  xTexelR`+_+"C"+(S+2)+` = getX(batch, xR, xC + 1, d1);
                } else {
                  xTexelR`+_+"C"+(S+2)+` = vec4(0.);
                }

                xR`+_+"C"+S+` = vec4(
                  xTexelR`+_+"C"+S+".zw, xTexelR"+_+"C"+(S+2)+`.zw);
              `,S+1<g&&(w+=`
                  vec4 final = vec4(0.);
                  xCOffset = xC + 1 + `+f+`;
                  if(xCOffset >= 0 && xCOffset < `+i+`) {
                    final = getX(batch, xR, xCOffset, d1);
                  }
                  xR`+_+"C"+(S+1)+" = vec4(xTexelR"+_+"C"+(S+2)+`.xy, final.xy);
                `)):(w+=`
                if(xC >= 0 && xC < `+i+`) {
                  xTexelR`+_+"C"+S+` = getX(batch, xR, xC, d1);
                } else {
                  xTexelR`+_+"C"+S+` = vec4(0.);
                }

                xCOffset = xC + `+f+`;
                if(xCOffset >= 0 && xCOffset < `+i+`) {
                  xTexelR`+_+"C"+(S+2)+` = getX(batch, xR, xCOffset, d1);
                } else {
                  xTexelR`+_+"C"+(S+2)+` = vec4(0.);
                }

                xR`+_+"C"+S+` = vec4(
                  xTexelR`+_+"C"+S+".xy, xTexelR"+_+"C"+(S+2)+`.xy);
              `,S+1<g&&(w+=`
                  xR`+_+"C"+(S+1)+` = vec4(
                    xTexelR`+_+"C"+S+".zw, xTexelR"+_+"C"+(S+2)+`.zw);
                `)),w+="}");S<g&&(w+=`
            vec4 wTexelR`+_+"C"+S+" = getW("+_+", "+S+`, d1, q);
            wR`+_+"C"+S+" = vec4(wTexelR"+_+"C"+S+".xz, wTexelR"+_+"C"+S+`.xz);
          `,S+1<g&&(w+=`
              vec4 wTexelR`+_+"C"+(S+1)+" = getW("+_+", "+(S+1)+`, d1, q);
              wR`+_+"C"+(S+1)+` =
                vec4(wTexelR`+_+"C"+(S+1)+".xz, wTexelR"+_+"C"+(S+1)+".xz);"))}for(_=0;_<m;_++)for(S=0;S<g;S++)w+="dotProd += xR"+_+"C"+S+" * wR"+_+"C"+S+";";var R="",T="";e&&(R=n?`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          `+e+`
        }`:`vec4 activation(vec4 x) {
          `+e+`
        }`,T="result = activation(result);");var D=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),n&&this.variableNames.push("preluActivationWeights"),this.userCode=`
      `+R+`

      const ivec2 strides = ivec2(`+c+", "+f+`);
      const ivec2 pads = ivec2(`+s+", "+l+`);

      void main() {

        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2;
        int q = 0;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        vec4 dotProd = vec4(0.);

        `+w+`

        vec4 result = dotProd;
        `+D+`
        `+T+`
        setOutput(result);
      }
    `},jI=function(r,t,e,n,a){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];var i=r[0],s=r[1],l=r[2],c=r[3],f=t[0],d=e[0],v=e[1];this.outputShape=[f,d,v,c];var m=n==="bilinear"?1:0,g=[s-1+".0",l-1+".0"],b=g[0],w=g[1],_=d>1?[""+(s-1)/(d-1),"(y2-y1) * height_ratio","y1*"+b+" + float(y)*(height_scale)"]:["0.0","0.0","0.5 * (y1+y2) * "+b],S=_[0],E=_[1],C=_[2],R=v>1?[""+(l-1)/(v-1),"(x2-x1) * width_ratio","x1*"+w+" + float(x)*(width_scale)"]:["0.0","0.0","0.5 * (x1+x2) * "+w],T=R[0],D=R[1],k=R[2];this.userCode=`
      const float height_ratio = float(`+S+`);
      const float width_ratio = float(`+T+`);
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int y = coords[1];
        int x = coords[2];
        int d = coords[3];

        // get box vals
        float y1 = getBoxes(b,0);
        float x1 = getBoxes(b,1);
        float y2 = getBoxes(b,2);
        float x2 = getBoxes(b,3);

        // get image in batch index
        int bInd = round(getBoxInd(b));
        if(bInd < 0 || bInd >= `+i+`) {
          return;
        }

        float height_scale = `+E+`;
        float width_scale = `+D+`;

        float in_y = `+C+`;
        if( in_y < 0.0 || in_y > `+b+` ) {
          setOutput(float(`+a+`));
          return;
        }
        float in_x = `+k+`;
        if( in_x < 0.0 || in_x > `+w+` ) {
          setOutput(float(`+a+`));
          return;
        }

        vec2 sourceFracIndexCR = vec2(in_x,in_y);
        if(`+m+` == 1) {
          // Compute the four integer indices.
          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);
          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));

          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);
          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);
          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);
          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);

          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);

          float top = topLeft + (topRight - topLeft) * fracCR.x;
          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;
          float newValue = top + (bottom - top) * fracCR.y;
          setOutput(newValue);
        } else {
          // Compute the coordinators of nearest neighbor point.
          ivec2 sourceNearestCR = ivec2(floor(
            sourceFracIndexCR + vec2(0.5,0.5)));
          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);
          setOutput(newValue);
        }
      }
    `},WI=function(r,t,e){this.variableNames=["x"],this.outputShape=r;var n=r.length,a=r[r.length-1],i=e?"<":">";this.userCode=`
      int getIndex(int i) {
        `+(e?"return "+a+" -i - 1;":"return i;")+`
      }

      void main() {
        `+Tt(n)+` coords = getOutputCoords();
        int end = `+d_(n,"coords")+`;
        float val = 0.0;
        for (int i = `+a+` - 1; i >= 0; i -= 1) {
          int idx = getIndex(i);
          if (idx `+i+` end) {
            continue;
          }
          if (idx == end && `+t+`) {
            continue;
          }
          `+d_(n,"coords")+` = idx;
          val += getX(`+function(s,l){if(s===1)return""+l;if(s===2)return l+".x, "+l+".y";if(s===3)return l+".x, "+l+".y, "+l+".z";if(s===4)return l+".x, "+l+".y, "+l+".z, "+l+".w";throw Error("Cumulative sum for rank "+s+" is not yet supported")}(n,"coords")+`);
        }
        setOutput(val);
      }
    `};function d_(r,t){if(r===1)return""+t;if(r===2)return t+".y";if(r===3)return t+".z";if(r===4)return t+".w";throw Error("Cumulative sum for rank "+r+" is not yet supported")}var GI=function(r){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=Fc.DENSE;var t=dc(r),e=On();this.outputShape=r,this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        `+Vo(["r","c","d"],r)+`
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx *
          vec2(`+t[0]+", "+t[1]+`));
        int index = 4 * (resTexRC.x * `+t[1]+` + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getA(rc.x, rc.y, rc.z);
        }

        `+e.output+` = result;
      }
    `},qI=function(r){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=Fc.DENSE;var t=dc(r),e=On();this.outputShape=r,this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        `+Vo(["r","c","d"],r)+`
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx *
          vec2(`+t[0]+", "+t[1]+`));
        int index = 4 * (resTexRC.x * `+t[1]+` + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));
        }

        `+e.output+` = result;
      }
    `},KI=function(){function r(t,e,n){this.variableNames=["x"],this.outputShape=[],this.outputShape=t,this.blockSize=e,this.dataFormat=n,this.userCode=`
    void main() {
      ivec4 coords = getOutputCoords();
      int b = coords[0];
      int h = `+this.getHeightCoordString()+`;
      int w = `+this.getWidthCoordString()+`;
      int d = `+this.getDepthCoordString()+`;

      int in_h = h / `+e+`;
      int offset_h = imod(h, `+e+`);
      int in_w = w / `+e+`;
      int offset_w = imod(w, `+e+`);
      int offset_d = (offset_h * `+e+` + offset_w) *
        `+this.getOutputDepthSize()+`;
      int in_d = d + offset_d;

      float result = `+this.getInputSamplingString()+`;
      setOutput(result);
    }
  `}return r.prototype.getHeightCoordString=function(){return this.dataFormat==="NHWC"?"coords[1]":"coords[2]"},r.prototype.getWidthCoordString=function(){return this.dataFormat==="NHWC"?"coords[2]":"coords[3]"},r.prototype.getDepthCoordString=function(){return this.dataFormat==="NHWC"?"coords[3]":"coords[1]"},r.prototype.getOutputDepthSize=function(){return this.dataFormat==="NHWC"?this.outputShape[3]:this.outputShape[1]},r.prototype.getInputSamplingString=function(){return this.dataFormat==="NHWC"?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"},r}(),XI=function(r){this.variableNames=["X"],this.outputShape=[r,r],this.userCode=`
      void main() {
          ivec2 coords = getOutputCoords();
          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;
          setOutput(val);
      }
    `},$I=function(r){this.variableNames=["A"],this.outTexUsage=fr.DOWNLOAD;var t=On();this.outputShape=r,this.userCode=`
      `+dC+`

      void main() {
        float x = getAAtOutCoords();
        `+t.output+` = encode_float(x);
      }
    `},YI=function(r){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=fr.DOWNLOAD;var t=On();this.outputShape=r,this.userCode=`
      `+dC+`

      void main() {
        ivec3 coords = getOutputCoords();
        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));
        `+t.output+` = encode_float(x);
      }
    `},ZI=function(r,t,e){e===void 0&&(e=!1),this.variableNames=["A"];var n=On(),a=t[0],i=t[1];this.outputShape=r;var s="result";e&&(s="floor(result * 255. + 0.5)"),this.userCode=`
      `+Qy(r)+`

      void main() {
        ivec3 coords = getOutputCoords();

        int flatIndex = getFlatIndex(coords);
        int offset = imod(flatIndex, 4);

        flatIndex = idiv(flatIndex, 4, 1.);
        
        int r = flatIndex / `+i+`;
        int c = imod(flatIndex, `+i+`);
        vec2 uv = (vec2(c, r) + halfCR) / vec2(`+i+".0, "+a+`.0);
        vec4 values = `+n.texture2D+`(A, uv);

        float result;

        if(offset == 0) {
          result = values[0];
        } else if(offset == 1) {
          result = values[1];
        } else if(offset == 2) {
          result = values[2];
        } else {
          result = values[3];
        }

        `+n.output+" = vec4("+s+`, 0., 0., 0.);
      }
    `},QI=function(r,t,e){e===void 0&&(e=!1),this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;var n=On(),a=t[0],i=t[1];this.outputShape=r;var s="",l="result";e&&(l="floor(result * 255. + 0.5)");for(var c=0;c<=1;c++)for(var f=0;f<=1;f++){var d=2*c+f;s+=`
          localCoords = coords;
          if(localCoords[2] + `+f+" < "+r[2]+`) {
            localCoords[2] += `+f+`;
            if(localCoords[1] + `+c+" < "+r[1]+`) {
              localCoords[1] += `+c+`;

              flatIndex = getFlatIndex(localCoords);
              offset = imod(flatIndex, 4);

              flatIndex = idiv(flatIndex, 4, 1.);

              r = flatIndex / `+i+`;
              c = imod(flatIndex, `+i+`);
              uv = (vec2(c, r) + halfCR) / vec2(`+i+".0, "+a+`.0);
              values = `+n.texture2D+`(A, uv);

              if(offset == 0) {
                result[`+d+`] = values[0];
              } else if(offset == 1) {
                result[`+d+`] = values[1];
              } else if(offset == 2) {
                result[`+d+`] = values[2];
              } else {
                result[`+d+`] = values[3];
              }
            }
          }
        `}this.userCode=`
      `+Qy(r)+`

      void main() {
        ivec3 coords = getOutputCoords();

        vec4 result = vec4(0.);
        int flatIndex, r, c, offset;
        ivec3 localCoords;
        vec2 uv;
        vec4 values;

        `+s+`

        `+n.output+" = "+l+`;
      }
    `},JI="return real * expR - imag * expI;",eF="return real * expI + imag * expR;",p_=function(r,t,e){this.variableNames=["real","imag"];var n=t[1];this.outputShape=t;var a=e?"2.0 * "+Math.PI:"-2.0 * "+Math.PI,i=e?n+".0":"1.0";this.userCode=`
      const float exponentMultiplier = `+a+`;

      float unaryOpComplex(float real, float expR, float imag, float expI) {
        `+r+`
      }

      float mulMatDFT(int batch, int index) {
        float indexRatio = float(index) / float(`+n+`);
        float exponentMultiplierTimesIndexRatio =
            exponentMultiplier * indexRatio;

        float result = 0.0;

        for (int i = 0; i < `+n+`; i++) {
          // x = (-2|2 * PI / N) * index * i;
          float x = exponentMultiplierTimesIndexRatio * float(i);
          float expR = cos(x);
          float expI = sin(x);
          float real = getReal(batch, i);
          float imag = getImag(batch, i);

          result +=
              unaryOpComplex(real, expR, imag, expI) / `+i+`;
        }

        return result;
      }

      void main() {
        ivec2 coords = getOutputCoords();
        setOutput(mulMatDFT(coords[0], coords[1]));
      }
    `},tF=function(){function r(t,e){this.outputShape=[],this.variableNames=["x"],this.outputShape=t,this.userCode=`
      uniform float value;
      void main() {
        // Input can be obtained from uniform value.
        setOutput(value);
      }
    `}return r.prototype.getCustomSetupFunc=function(t){var e=this;return function(n,a){e.valueLoc==null&&(e.valueLoc=n.getUniformLocationNoThrow(a,"value")),n.gl.uniform1f(e.valueLoc,t)}},r}(),nF=function(r,t,e){this.variableNames=["A","indices"];var n=r.slice();n[e]=t,this.outputShape=n,this.rank=n.length;var a=Tt(this.rank),i=function(s,l){var c=s.length;if(c>4)throw Error("Gather for rank "+c+" is not yet supported");if(c===1)return"int(getIndices(resRC))";for(var f=["resRC.x","resRC.y","resRC.z","resRC.w"],d=[],v=0;v<s.length;v++)v===l?d.push("int(getIndices("+f[v]+"))"):d.push(""+f[v]);return d.join()}(r,e);this.userCode=`
      void main() {
        `+a+` resRC = getOutputCoords();
        setOutput(getA(`+i+`));
      }
    `},rF=function(r,t,e){this.sliceDim=r,this.strides=t,this.variableNames=["x","indices"],this.outputShape=e;var n=Tt(t.length),a=Tt(e.length),i=this.sliceDim>1?"strides[j]":"strides";this.userCode=`
        `+n+" strides = "+n+"("+this.strides+`);
         void main() {
          `+a+` coords = getOutputCoords();
          int flattenIndex = 0;
          for (int j = 0; j < `+this.sliceDim+`; j++) {
            int index = round(getIndices(coords[0], j));
            flattenIndex += index * `+i+`;
          }
          setOutput(getX(flattenIndex, coords[1]));
        }
      `};function aF(r,t){var e=On();return J4(r,t,e.version+`
    precision highp float;
    `+e.attribute+` vec3 clipSpacePos;
    `+e.attribute+` vec2 uv;
    `+e.varyingVs+` vec2 resultUV;

    void main() {
      gl_Position = vec4(clipSpacePos, 1);
      resultUV = uv;
    }`)}function iF(r,t){return aM(r,t,new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]))}function oF(r,t){return iM(r,t,new Uint16Array([0,1,2,2,1,3]))}function ef(r,t,e,n,a,i,s){sM(e,n);var l=oM(r,t),c=r.TEXTURE_2D;return De(r,t,function(){return r.bindTexture(c,l)}),De(r,t,function(){return r.texParameteri(c,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE)}),De(r,t,function(){return r.texParameteri(c,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE)}),De(r,t,function(){return r.texParameteri(c,r.TEXTURE_MIN_FILTER,r.NEAREST)}),De(r,t,function(){return r.texParameteri(c,r.TEXTURE_MAG_FILTER,r.NEAREST)}),De(r,t,function(){return r.texImage2D(c,0,a,e,n,0,i,s,null)}),De(r,t,function(){return r.bindTexture(r.TEXTURE_2D,null)}),l}function sF(r,t,e,n,a){var i=Xd(e,n);return ef(r,t,i[0],i[1],a.internalFormatFloat,a.textureFormatFloat,r.FLOAT)}function uF(r,t,e,n,a){var i=Xd(e,n);return ef(r,t,i[0],i[1],a.internalFormatHalfFloat,a.textureFormatFloat,a.textureTypeHalfFloat)}function lF(r,t,e,n,a){var i=Xd(e,n);return ef(r,t,i[0],i[1],r.RGBA,r.RGBA,r.UNSIGNED_BYTE)}function cF(r,t,e,n,a){var i=Jc(e,n);return ef(r,t,i[0],i[1],a.internalFormatPackedFloat,r.RGBA,r.FLOAT)}function fF(r,t,e,n,a){var i=Jc(e,n);return ef(r,t,i[0],i[1],a.internalFormatPackedHalfFloat,r.RGBA,a.textureTypeHalfFloat)}function hF(r,t,e,n){return De(r,t,function(){return r.bindBuffer(r.ARRAY_BUFFER,n)}),t_(r,t,e,"clipSpacePos",n,3,20,0)&&t_(r,t,e,"uv",n,2,20,12)}function dF(r,t,e,n,a,i,s){var l,c,f;De(r,t,function(){return r.bindTexture(r.TEXTURE_2D,e)}),i instanceof Uint8Array?(l=new Uint8Array(n*a*4),c=r.UNSIGNED_BYTE,f=r.RGBA):(l=new Float32Array(n*a*4),c=r.FLOAT,f=s.internalFormatPackedFloat),l.set(i),De(r,t,function(){return r.texImage2D(r.TEXTURE_2D,0,f,n,a,0,r.RGBA,c,l)}),De(r,t,function(){return r.bindTexture(r.TEXTURE_2D,null)})}function pF(r,t,e,n){De(r,t,function(){return r.bindTexture(r.TEXTURE_2D,e)}),n.data instanceof Uint8Array?De(r,t,function(){return r.texImage2D(r.TEXTURE_2D,0,r.RGBA,n.width,n.height,0,r.RGBA,r.UNSIGNED_BYTE,n.data)}):De(r,t,function(){return r.texImage2D(r.TEXTURE_2D,0,r.RGBA,r.RGBA,r.UNSIGNED_BYTE,n)}),De(r,t,function(){return r.bindTexture(r.TEXTURE_2D,null)})}function vF(r,t,e,n,a){var i=r.createBuffer();De(r,t,function(){return r.bindBuffer(r.PIXEL_PACK_BUFFER,i)});var s=16*e*n;return De(r,t,function(){return r.bufferData(r.PIXEL_PACK_BUFFER,s,r.STREAM_READ)}),De(r,t,function(){return r.readPixels(0,0,n,e,r.RGBA,r.FLOAT,0)}),De(r,t,function(){return r.bindBuffer(r.PIXEL_PACK_BUFFER,null)}),i}function mF(r,t,e){var n=r,a=new Float32Array(e);return n.bindBuffer(n.PIXEL_PACK_BUFFER,t),n.getBufferSubData(n.PIXEL_PACK_BUFFER,0,a),n.bindBuffer(n.PIXEL_PACK_BUFFER,null),a}function gF(r,t,e,n,a){var i=Xd(e,n),s=i[0],l=i[1],c=new Uint8Array(e*n*4);return De(r,t,function(){return r.readPixels(0,0,s,l,a.downloadTextureFormat,r.UNSIGNED_BYTE,c)}),new Float32Array(c.buffer)}function yF(r,t,e,n,a,i,s,l){var c=r,f=new Float32Array(function(d,v){var m=Jc(d,v);return m[0]*m[1]*4}(i,s));return c.bindBuffer(c.PIXEL_PACK_BUFFER,t),c.getBufferSubData(c.PIXEL_PACK_BUFFER,0,f),c.bindBuffer(c.PIXEL_PACK_BUFFER,null),f}function bF(r,t,e,n){var a=new Float32Array(e*n*4);return De(r,t,function(){return r.readPixels(0,0,n,e,r.RGBA,r.FLOAT,a)}),a}var xF=function(){function r(t){this.outputTexture=null,this.program=null,this.disposed=!1,this.vertexAttrsAreBound=!1,this.itemsToPoll=[];var e=le().getNumber("WEBGL_VERSION");t!=null?(this.gl=t,X4(e,t)):this.gl=Ta(e);var n="WEBGL_color_buffer_float";if(le().getNumber("WEBGL_VERSION")===1){if(this.textureFloatExtension=Th(this.gl,this.debug,"OES_texture_float"),Nr(this.gl,"OES_texture_half_float"))this.textureHalfFloatExtension=Th(this.gl,this.debug,"OES_texture_half_float");else if(le().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(n),Nr(this.gl,"EXT_color_buffer_half_float"))this.colorBufferHalfFloatExtension=Th(this.gl,this.debug,"EXT_color_buffer_half_float");else if(le().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(n="EXT_color_buffer_float",Nr(this.gl,n))this.colorBufferFloatExtension=this.gl.getExtension(n);else{if(!Nr(this.gl,"EXT_color_buffer_half_float"))throw new Error("GL context does not support color renderable floats");this.colorBufferHalfFloatExtension=this.gl.getExtension("EXT_color_buffer_half_float")}this.vertexBuffer=iF(this.gl,this.debug),this.indexBuffer=oF(this.gl,this.debug),this.framebuffer=uM(this.gl,this.debug),this.textureConfig=Hy(this.gl,this.textureHalfFloatExtension)}return Object.defineProperty(r.prototype,"debug",{get:function(){return le().getBool("DEBUG")},enumerable:!0,configurable:!0}),r.prototype.dispose=function(){var t=this;if(!this.disposed){this.program!=null&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),this.outputTexture!=null&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");var e=this.gl;De(e,this.debug,function(){return e.finish()}),De(e,this.debug,function(){return e.bindFramebuffer(e.FRAMEBUFFER,null)}),De(e,this.debug,function(){return e.deleteFramebuffer(t.framebuffer)}),De(e,this.debug,function(){return e.bindBuffer(e.ARRAY_BUFFER,null)}),De(e,this.debug,function(){return e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null)}),De(e,this.debug,function(){return e.deleteBuffer(t.indexBuffer)}),this.disposed=!0}},r.prototype.createFloat32MatrixTexture=function(t,e){return this.throwIfDisposed(),sF(this.gl,this.debug,t,e,this.textureConfig)},r.prototype.createFloat16MatrixTexture=function(t,e){return this.throwIfDisposed(),uF(this.gl,this.debug,t,e,this.textureConfig)},r.prototype.createUnsignedBytesMatrixTexture=function(t,e){return this.throwIfDisposed(),lF(this.gl,this.debug,t,e,this.textureConfig)},r.prototype.uploadPixelDataToTexture=function(t,e){this.throwIfDisposed(),pF(this.gl,this.debug,t,e)},r.prototype.uploadDenseMatrixToTexture=function(t,e,n,a){this.throwIfDisposed(),dF(this.gl,this.debug,t,e,n,a,this.textureConfig)},r.prototype.createFloat16PackedMatrixTexture=function(t,e){return this.throwIfDisposed(),fF(this.gl,this.debug,t,e,this.textureConfig)},r.prototype.createPackedMatrixTexture=function(t,e){return this.throwIfDisposed(),cF(this.gl,this.debug,t,e,this.textureConfig)},r.prototype.deleteMatrixTexture=function(t){var e=this;this.throwIfDisposed(),this.outputTexture===t&&(n_(this.gl,this.debug,this.framebuffer),this.outputTexture=null),De(this.gl,this.debug,function(){return e.gl.deleteTexture(t)})},r.prototype.downloadByteEncodedFloatMatrixFromOutputTexture=function(t,e,n){var a=this;return this.downloadMatrixDriver(t,function(){return gF(a.gl,a.debug,e,n,a.textureConfig)})},r.prototype.downloadPackedMatrixFromBuffer=function(t,e,n,a,i,s){return yF(this.gl,t,0,0,0,i,s,this.textureConfig)},r.prototype.downloadFloat32MatrixFromBuffer=function(t,e){return mF(this.gl,t,e)},r.prototype.createBufferFromTexture=function(t,e,n){this.bindTextureToFrameBuffer(t);var a=vF(this.gl,this.debug,e,n,this.textureConfig);return this.unbindTextureToFrameBuffer(),a},r.prototype.createAndWaitForFence=function(){var t=this.createFence(this.gl);return this.pollFence(t)},r.prototype.createFence=function(t){var e,n,a=this;if(le().getBool("WEBGL_FENCE_API_ENABLED")){var i=t,s=i.fenceSync(i.SYNC_GPU_COMMANDS_COMPLETE,0);t.flush(),n=function(){var l=i.clientWaitSync(s,0,0);return l===i.ALREADY_SIGNALED||l===i.CONDITION_SATISFIED},e=s}else le().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(e=this.beginQuery(),this.endQuery(),n=function(){return a.isQueryAvailable(e,le().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}):n=function(){return!0};return{query:e,isFencePassed:n}},r.prototype.downloadMatrixFromPackedTexture=function(t,e,n){var a=this;return this.downloadMatrixDriver(t,function(){return bF(a.gl,a.debug,e,n)})},r.prototype.createProgram=function(t){this.throwIfDisposed();var e=this.gl,n=eM(e,this.debug,t),a=aF(e,this.debug),i=nM(e,this.debug);return De(e,this.debug,function(){return e.attachShader(i,a)}),De(e,this.debug,function(){return e.attachShader(i,n)}),rM(e,this.debug,i),this.debug&&Qm(e,this.debug,i),this.vertexAttrsAreBound||(this.setProgram(i),this.vertexAttrsAreBound=hF(e,this.debug,this.program,this.vertexBuffer)),i},r.prototype.deleteProgram=function(t){var e=this;this.throwIfDisposed(),t===this.program&&(this.program=null),t!=null&&De(this.gl,this.debug,function(){return e.gl.deleteProgram(t)})},r.prototype.setProgram=function(t){var e=this;this.throwIfDisposed(),this.program=t,this.program!=null&&this.debug&&Qm(this.gl,this.debug,this.program),De(this.gl,this.debug,function(){return e.gl.useProgram(t)})},r.prototype.getUniformLocation=function(t,e,n){return n===void 0&&(n=!0),this.throwIfDisposed(),n?cM(this.gl,this.debug,t,e):fM(this.gl,t,e)},r.prototype.getAttributeLocation=function(t,e){var n=this;return this.throwIfDisposed(),De(this.gl,this.debug,function(){return n.gl.getAttribLocation(t,e)})},r.prototype.getUniformLocationNoThrow=function(t,e){return this.throwIfDisposed(),this.gl.getUniformLocation(t,e)},r.prototype.setInputMatrixTexture=function(t,e,n){this.throwIfDisposed(),this.throwIfNoProgram(),hM(this.gl,this.debug,this.program,t,e,n)},r.prototype.setOutputMatrixTexture=function(t,e,n){this.setOutputMatrixTextureDriver(t,n,e)},r.prototype.setOutputPackedMatrixTexture=function(t,e,n){this.throwIfDisposed();var a=Jc(e,n),i=a[0],s=a[1];this.setOutputMatrixTextureDriver(t,i,s)},r.prototype.setOutputMatrixWriteRegion=function(t,e,n,a){this.setOutputMatrixWriteRegionDriver(n,t,a,e)},r.prototype.setOutputPackedMatrixWriteRegion=function(t,e,n,a){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")},r.prototype.debugValidate=function(){this.program!=null&&Qm(this.gl,this.debug,this.program),Ah(this.gl)},r.prototype.executeProgram=function(){this.throwIfDisposed(),this.throwIfNoProgram();var t=this.gl;this.debug&&this.debugValidate(),De(t,this.debug,function(){return t.drawElements(t.TRIANGLES,6,t.UNSIGNED_SHORT,0)})},r.prototype.blockUntilAllProgramsCompleted=function(){var t=this;this.throwIfDisposed(),De(this.gl,this.debug,function(){return t.gl.finish()})},r.prototype.getQueryTimerExtension=function(){return this.disjointQueryTimerExtension==null&&(this.disjointQueryTimerExtension=Th(this.gl,this.debug,le().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension},r.prototype.getQueryTimerExtensionWebGL2=function(){return this.getQueryTimerExtension()},r.prototype.getQueryTimerExtensionWebGL1=function(){return this.getQueryTimerExtension()},r.prototype.beginQuery=function(){if(le().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){var t=this.gl,e=this.getQueryTimerExtensionWebGL2(),n=t.createQuery();return t.beginQuery(e.TIME_ELAPSED_EXT,n),n}var a=this.getQueryTimerExtensionWebGL1(),i=a.createQueryEXT();return a.beginQueryEXT(a.TIME_ELAPSED_EXT,i),i},r.prototype.endQuery=function(){if(le().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")!==2){var t=this.getQueryTimerExtensionWebGL1();t.endQueryEXT(t.TIME_ELAPSED_EXT)}else{var e=this.gl,n=this.getQueryTimerExtensionWebGL2();e.endQuery(n.TIME_ELAPSED_EXT)}},r.prototype.waitForQueryAndGetTime=function(t){return Ce(this,void 0,void 0,function(){var e=this;return Re(this,function(n){switch(n.label){case 0:return[4,$2(function(){return e.disposed||e.isQueryAvailable(t,le().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))})];case 1:return n.sent(),[2,this.getQueryTime(t,le().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))]}})})},r.prototype.getQueryTime=function(t,e){if(e===0)return null;if(e===2){var n=this.gl;return n.getQueryParameter(t,n.QUERY_RESULT)/1e6}var a=this.getQueryTimerExtensionWebGL1();return a.getQueryObjectEXT(t,a.QUERY_RESULT_EXT)/1e6},r.prototype.isQueryAvailable=function(t,e){if(e===0)return!0;if(e===2){var n=this.gl,a=this.getQueryTimerExtensionWebGL2(),i=n.getQueryParameter(t,n.QUERY_RESULT_AVAILABLE);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(a.GPU_DISJOINT_EXT)),i&&!this.disjoint}return i=(a=this.getQueryTimerExtensionWebGL1()).getQueryObjectEXT(t,a.QUERY_RESULT_AVAILABLE_EXT),this.disjoint==null&&(this.disjoint=this.gl.getParameter(a.GPU_DISJOINT_EXT)),i&&!this.disjoint},r.prototype.pollFence=function(t){var e=this;return new Promise(function(n){e.addItemToPoll(function(){return t.isFencePassed()},function(){return n()})})},r.prototype.pollItems=function(){for(var t=function(n){for(var a=0;a<n.length&&n[a]();++a);return a-1}(this.itemsToPoll.map(function(n){return n.isDoneFn})),e=0;e<=t;++e)(0,this.itemsToPoll[e].resolveFn)();this.itemsToPoll=this.itemsToPoll.slice(t+1)},r.prototype.addItemToPoll=function(t,e){var n=this;this.itemsToPoll.push({isDoneFn:t,resolveFn:e}),this.itemsToPoll.length>1||$2(function(){return n.pollItems(),n.itemsToPoll.length===0})},r.prototype.bindTextureToFrameBuffer=function(t){this.throwIfDisposed(),Jm(this.gl,this.debug,t,this.framebuffer),this.debug&&Ah(this.gl)},r.prototype.unbindTextureToFrameBuffer=function(){this.outputTexture!=null?(Jm(this.gl,this.debug,this.outputTexture,this.framebuffer),this.debug&&Ah(this.gl)):n_(this.gl,this.debug,this.framebuffer)},r.prototype.downloadMatrixDriver=function(t,e){this.bindTextureToFrameBuffer(t);var n=e();return this.unbindTextureToFrameBuffer(),n},r.prototype.setOutputMatrixTextureDriver=function(t,e,n){this.throwIfDisposed();var a=this.gl;Jm(a,this.debug,t,this.framebuffer),this.debug&&Ah(a),this.outputTexture=t,De(a,this.debug,function(){return a.viewport(0,0,e,n)}),De(a,this.debug,function(){return a.scissor(0,0,e,n)})},r.prototype.setOutputMatrixWriteRegionDriver=function(t,e,n,a){var i=this;this.throwIfDisposed(),De(this.gl,this.debug,function(){return i.gl.scissor(t,e,n,a)})},r.prototype.throwIfDisposed=function(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")},r.prototype.throwIfNoProgram=function(){if(this.program==null)throw new Error("No GPU program is currently set.")},r}();function v_(r,t){if(r.length!==t.length)throw Error("Binary was compiled with "+r.length+" inputs, but was executed with "+t.length+" inputs");r.forEach(function(e,n){var a=e.logicalShape,i=t[n],s=i.shape;if(!vn(a,s))throw Error("Binary was compiled with different shapes than the current args. Shapes "+a+" and "+s+" must match");if(!e.isUniform||!i.isUniform){var l=e.texShape,c=i.isUniform?null:i.texData.texShape;if(!vn(l,c))throw Error("Binary was compiled with different texture shapes than the current args. Shape "+l+" and "+c+" must match")}})}var wF=function(r,t,e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=r;for(var n=e.filterWidth,a=e.inChannels,i=e.strideWidth,s=e.strideHeight,l=e.padInfo,c=e.outWidth,f=e.dilationWidth,d=e.dilationHeight,v=e.dataFormat,m=l.left,g=l.top,b=a*n,w=On(),_=v==="channelsLast",S=_?0:1,E=_?1:2,C="",R=0;R<=1;R++)for(var T=0;T<=1;T++)C+=`
          blockIndex = rc.y + `+T+`;
          pos = rc.x + `+R+`;

          if(blockIndex < `+r[1]+" && pos < "+r[0]+`) {
            offsetY = int(blockIndex / (`+c+")) * "+s+" - "+g+`;
            d0 = offsetY + `+d+" * (pos / "+b+`);

            if(d0 < `+t[S]+` && d0 >= 0) {

              offsetX = int(mod(float(blockIndex), `+c+".) * "+i+". - "+m+`.);
              d1 = offsetX + `+f+" * (int(mod(float(pos), "+b+".) / "+a+`.));

              if(d1 < `+t[E]+` && d1 >= 0) {

                ch = int(mod(float(pos), `+a+`.));

                if (`+_+`) {
                  innerDims = vec2(d1, ch);
                  result[`+(2*R+T)+`] = getChannel(
                    getA(d0, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                } else {
                  innerDims = vec2(d0, d1);
                  result[`+(2*R+T)+`] = getChannel(
                    getA(ch, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                }
              }
            }
          }
        `;this.userCode=`
      void main() {
        ivec2 rc = getOutputCoords();

        vec4 result = vec4(0);

        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;
        vec2 innerDims;

        `+C+`

        `+w.output+` = result;
      }
    `},_F=function(r,t,e,n,a){this.variableNames=["x"],this.outputShape=[];var i,s=t,l=r[3]-1;this.outputShape=r;var c="float("+e+") + float("+n+") * sum";i=a===.5?"inversesqrt("+c+")":a===1?"1.0/("+c+")":"exp(log("+c+") * float(-"+a+"));",this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];
        int d = coords[3];
        float x = getX(b, r, c, d);
        float sum = 0.0;
        for (int j = -`+s+"; j <= "+s+`; j++) {
          int idx = d + j;
          if (idx >= 0 && idx <=  `+l+`) {
            float z = getX(b, r, c, idx);
            sum += z * z;
          }
        }
        float val = x * `+i+`;
        setOutput(val);
      }
    `},SF=function(r,t,e,n,a){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=r,this.depth=r[3],this.depthRadius=t,this.bias=e,this.alpha=n,this.beta=a,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];

        float result = 0.0;
        for (int d = 0; d < `+this.depth+`; ++d) {
          int depthBegin = int(max(0.0, float(d - `+t+`)));
          int depthEnd = int(min(float(`+this.depth+`),
              float(d + `+t+` + 1)));

          const int MIN_DEPTH_BEGIN = 0;
          const int MAX_DEPTH_END = `+this.depth+`;

          float norm = 0.0;
          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd) {
              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);
            }
            else {
              break;
            }
          }

          norm = float(`+n+") * norm + float("+e+`);

          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd){
              float dyi = -2.0 * float(`+n+`)
                * float(`+a+`)
                * getInputImage(b ,r ,c, k) * getOutputImage(b, r, c, d)
                / norm;
              if (k == d) {
                dyi += pow(norm, -1.0 * `+a+`);
              }
              if (k == coords[3]) {
                dyi *= getDy(b, r, c, d);
                result += dyi;
              }
            }
            else {
              break;
            }
          }
      }
      setOutput(result);
      }
    `},EF=function(r,t,e,n,a){this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;var i,s=t,l=r[3]-1;this.outputShape=r;var c="float("+e+") + float("+n+") * sum";i=a===.5?"inversesqrt("+c+")":a===1?"1.0/("+c+")":"exp(log("+c+") * float(-"+a+"));",this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords.x;
        int r = coords.y;
        int c = coords.z;
        int d = coords.w;

        bool hasNextCol = d < `+this.outputShape[3]+`;
        bool hasNextRow = c < `+this.outputShape[2]+`;

        vec4 sum = vec4(0.);
        vec4 xFragAtOutputCoords = getX(b, r, c, d);

        vec4 xAtOutputCoords = vec4(
          getChannel(xFragAtOutputCoords, vec2(c, d)),
          hasNextCol ?
            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,
          hasNextRow ?
            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,
          (hasNextRow && hasNextCol) ?
            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0
        );

        int firstChannel = d - `+s+`;
        vec2 cache = vec2(0.);
        if(firstChannel >= 0){
          vec4 firstChannelFrag = getX(b, r, c, firstChannel);
          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));
            if(hasNextRow){
              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));
            }
        }

        ivec2 depth = ivec2(d, d + 1);
        for (int j = - `+s+"; j <= "+s+`; j++) {
          ivec2 idx = depth + j;
          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));
          bvec2 belowUpperBound = lessThanEqual(idx, ivec2(`+l+`));

          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;
          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;

          if(depthInRange || depthPlusOneInRange){
            vec4 z = vec4(0.);
            vec4 xFragAtCurrentDepth;
            z.xz = cache.xy;
            if(depthPlusOneInRange && hasNextCol){
              xFragAtCurrentDepth = idx.y != d ?
                getX(b, r, c, idx.y) : xFragAtOutputCoords;
              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));
              if(hasNextRow){
                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));
              }
            }
            cache.xy = z.yw;
            sum += z * z;
          }
        }
        vec4 result = xAtOutputCoords * `+i+`;
        setOutput(result);
      }
    `},CF=function(r){this.variableNames=["dy","maxPos"],this.outputShape=r.inShape;var t=r.strideHeight,e=r.strideWidth,n=r.dilationHeight,a=r.effectiveFilterHeight,i=r.effectiveFilterWidth,s=a-1-r.padInfo.top,l=i-1-r.padInfo.left,c=a*i-1;this.userCode=`
      const ivec2 pads = ivec2(`+s+", "+l+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < `+a+`;
          wR += `+n+`) {
          float dyR = float(dyRCorner + wR) / `+t+`.0;

          if (dyR < 0.0 || dyR >= `+r.outHeight+`.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < `+i+`; wC++) {
            float dyC = float(dyCCorner + wC) / `+e+`.0;

            if (dyC < 0.0 || dyC >= `+r.outWidth+`.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);
            int maxPosValue = `+c+` - int(getMaxPos(b, idyR, idyC, d));

            // Get the current value, check it against the value from the
            // position matrix.
            int curPosValue = wR * `+i+` + wC;
            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

            dotProd += dyValue * mask;
          }
        }
        setOutput(dotProd);
      }
    `},RF=function(r){this.variableNames=["dy","maxPos"],this.outputShape=r.inShape;var t=r.strideDepth,e=r.strideHeight,n=r.strideWidth,a=r.dilationDepth,i=r.dilationHeight,s=r.dilationWidth,l=r.effectiveFilterDepth,c=r.effectiveFilterHeight,f=r.effectiveFilterWidth,d=l-1-r.padInfo.front,v=c-1-r.padInfo.top,m=f-1-r.padInfo.left,g=l*c*f-1;this.userCode=`
      const ivec3 pads = ivec3(`+d+", "+v+", "+m+`);

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < `+l+`;
           wD += `+a+`) {
          float dyD = float(dyDCorner + wD) / `+t+`.0;

          if (dyD < 0.0 || dyD >= `+r.outDepth+`.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < `+c+`;
              wR += `+i+`) {
            float dyR = float(dyRCorner + wR) / `+e+`.0;

            if (dyR < 0.0 || dyR >= `+r.outHeight+`.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < `+f+`;
                wC += `+s+`) {
              float dyC = float(dyCCorner + wC) / `+n+`.0;

              if (dyC < 0.0 || dyC >= `+r.outWidth+`.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);
              int maxPosValue = `+g+` -
                  int(getMaxPos(batch, idyD, idyR, idyC, ch));

              // Get the current value, check it against the value from the
              // position matrix.
              int curPosValue =
                  wD * `+c+" * "+f+` +
                  wR * `+f+` + wC;
              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

              dotProd += dyValue * mask;
            }
          }
        }
        setOutput(dotProd);
      }
    `},ag=function(r,t,e,n,a,i,s){e===void 0&&(e=!1),n===void 0&&(n=!1),a===void 0&&(a=!1),i===void 0&&(i=null),s===void 0&&(s=!1),this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t;var l=e?r[1]:r[2],c=Math.ceil(l/2),f=e?"i * 2, rc.y":"rc.y, i * 2",d=n?"rc.z, i * 2":"i * 2, rc.z",v=e?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],m=n?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"],g="",b="";i&&(g=s?`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          `+i+`
        }`:`vec4 activation(vec4 x) {
          `+i+`
        }`,b="result = activation(result);");var w=a?"result += getBiasAtOutCoords();":"";a&&this.variableNames.push("bias"),s&&this.variableNames.push("preluActivationWeights"),this.userCode=`
      `+g+`

      const float sharedDimension = `+c+`.0;

      vec4 dot2x2ARowBCol(ivec3 rc) {
        vec4 result = vec4(0);
        for (int i = 0; i < `+c+`; i++) {
          vec4 a = getMatrixA(rc.x, `+f+`);
          vec4 b = getMatrixB(rc.x, `+d+`);

          // These swizzled products need to be separately added.
          // See: https://github.com/tensorflow/tfjs/issues/1735
          result += (`+v[0]+" * "+m[0]+`);
          result += (`+v[1]+" * "+m[1]+`);
        }
        return result;
      }

      void main() {
        ivec3 rc = getOutputCoords();
        vec4 result = dot2x2ARowBCol(rc);

        `+w+`

        `+b+`

        setOutput(result);
      }
    `},TF=function(){function r(t,e,n){this.variableNames=["probs"],this.outputShape=[t,n],this.userCode=`
      uniform float seed;

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];

        float r = random(seed);
        float cdf = 0.0;

        for (int i = 0; i < `+(e-1)+`; i++) {
          cdf += getProbs(batch, i);

          if (r < cdf) {
            setOutput(float(i));
            return;
          }
        }

        // If no other event happened, last event happened.
        setOutput(float(`+(e-1)+`));
      }
    `}return r.prototype.getCustomSetupFunc=function(t){var e=this;return function(n,a){e.seedLoc==null&&(e.seedLoc=n.getUniformLocation(a,"seed")),n.gl.uniform1f(e.seedLoc,t)}},r}(),AF=function(r,t,e,n){this.variableNames=["indices"],this.outputShape=[r,t],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int index = round(getIndices(coords.x));
        setOutput(mix(float(`+n+"), float("+e+`),
                      float(index == coords.y)));
      }
    `},DF=function(r){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=r;var t=r.length;if(t===0)this.userCode=`
        void main() {
          setOutput(vec4(getA(), 0., 0., 0.));
        }
      `;else{var e=Yn("rc",t),n=Tt(t),a=function(l,c,f){if(l===1)return"rc > "+c[0];for(var d="",v=l-2;v<l;v++)d+=f[v]+" >= "+c[v],v<l-1&&(d+="||");return d}(t,r,e),i=function(l,c,f,d){if(l===1)return"";var v=d.slice(-2);return`
    int r = `+v[0]+`;
    int c = `+v[1]+`;
    int rp1 = r + 1;
    int cp1 = c + 1;

    bool cEdge = cp1 >= `+c+`;
    bool rEdge = rp1 >= `+f+`;
  `}(t,r[r.length-1],r[r.length-2],e),s=function(l,c){var f=l.length,d=function(v,m){for(var g=[],b=0;b<=1;b++)for(var w=0;w<=1;w++){for(var _=(b===0?"r":"rp1")+", "+(w===0?"c":"cp1"),S=2;S<v;S++)_=m[m.length-1-S]+","+_;g.push(_)}return g}(f,c);return f===1?`getA(rc),
            rc + 1 >= `+l[0]+` ? 0. : getA(rc + 1),
            0, 0`:"getA("+d[0]+`),
          cEdge ? 0. : getA(`+d[1]+`),
          rEdge ? 0. : getA(`+d[2]+`),
          rEdge || cEdge ? 0. : getA(`+d[3]+")"}(r,e);this.userCode=`
        void main() {
          `+n+` rc = getOutputCoords();

          if(`+a+`) {
            setOutput(vec4(0));
          } else {
            `+i+`

            setOutput(vec4(`+s+`));
          }
        }
      `}},kF=function(r,t,e){this.variableNames=["x"],this.outputShape=t.map(function(c,f){return c[0]+r[f]+c[1]});var n=r.length,a=Tt(n),i=t.map(function(c){return c[0]}).join(","),s=t.map(function(c,f){return c[0]+r[f]}).join(","),l=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,n);this.userCode=n!==1?`
      `+a+" start = "+a+"("+i+`);
      `+a+" end = "+a+"("+s+`);

      void main() {
        `+a+` outC = getOutputCoords();
        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {
          setOutput(float(`+e+`));
        } else {
          `+a+` coords = outC - start;
          setOutput(getX(`+l+`));
        }
      }
    `:`
        int start = `+i+`;
        int end = `+s+`;

        void main() {
          int outC = getOutputCoords();
          if (outC < start || outC >= end) {
            setOutput(float(`+e+`));
          } else {
            setOutput(getX(outC - start));
          }
        }
      `},OF=function(r,t,e){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t.map(function(_,S){return _[0]+r[S]+_[1]});for(var n=r.length,a=Tt(n),i=t.map(function(_){return _[0]}).join(","),s=t.map(function(_,S){return _[0]+r[S]}).join(","),l=Yn("rc",n),c=Yn("source",n),f=l[n-1]+" < "+this.outputShape[n-1],d=n===1?"source":"vec2("+c.slice(-2).join()+")",v=[a+" rc = outputLoc;",l[n-1]+` += 1;
       if(`+f+`) {
      `,n===1?"":`}
       rc = outputLoc;
       `+l[n-2]+` += 1;
       if(`+l[n-2]+" < "+this.outputShape[n-2]+") {",n===1?"":"  "+l[n-1]+` += 1;
         if(`+f+") {"],m=n===1?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))",g="",b=0,w=n===1?2:4;b<w;b++)g+=`
        `+v[b]+`
        if (`+m+`) {
          result[`+b+"] = float("+e+`);
        } else {
          `+a+` source = rc - start;
          result[`+b+"] = getChannel(getX("+c.join()+"), "+d+`);
        }
      `;g+=n===1?"} ":"}}",this.userCode=`
      const `+a+" start = "+a+"("+i+`);
      const `+a+" end = "+a+"("+s+`);

      void main() {
        `+a+` outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        `+g+`
        setOutput(result);
      }
    `},ig=function(r,t,e){if(this.variableNames=["x"],t==="avg"&&e)throw new Error("Cannot compute positions for average pool.");var n=r.filterWidth,a=r.strideHeight,i=r.strideWidth,s=r.dilationHeight,l=r.dilationWidth,c=r.effectiveFilterHeight,f=r.effectiveFilterWidth,d=r.padInfo.top,v=r.padInfo.left;this.outputShape=r.outShape;var m=t==="avg",g="0.0";if(m||(g="-1.0 / 1e-20"),e)this.userCode=`
        const ivec2 strides = ivec2(`+a+", "+i+`);
        const ivec2 pads = ivec2(`+d+", "+v+`);

        void main() {
          ivec4 coords = getOutputCoords();
          int batch = coords[0];
          int d = coords[3];

          ivec2 xRCCorner = coords.yz * strides - pads;
          int xRCorner = xRCCorner.x;
          int xCCorner = xRCCorner.y;

          // max/min x(?, ?, d) to get y(yR, yC, d).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;
          float avgValue = 0.0;

          for (int wR = 0; wR < `+c+`;
              wR += `+s+`) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= `+r.inHeight+`) {
              continue;
            }

            for (int wC = 0; wC < `+f+`;
                wC += `+l+`) {
              int xC = xCCorner + wC;

              if (xC < 0 || xC >= `+r.inWidth+`) {
                continue;
              }

              float value = getX(batch, xR, xC, d);

              // If a min / max value has already been found, use it. If not,
              // use the current value.
              float currMinMaxValue = mix(
                  value, minMaxValue, minMaxValueFound);
              if (value >= currMinMaxValue) {
                minMaxValue = value;
                minMaxValueFound = 1.0;
                minMaxPosition = wR * `+f+` + wC;
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;else{var b=t+"("+t+"("+t+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";t==="avg"&&(b="avgValue / count");var w=4*Math.floor(n/4),_=n%4,S=`
      if (`+m+`) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = max(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec2 strides = ivec2(`+a+", "+i+`);
      const ivec2 pads = ivec2(`+d+", "+v+`);
      const float initializationValue = `+g+`;
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xR, int xC, int d) {
        if (xC < 0 || xC >= `+r.inWidth+`) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xR, xC, d);
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d = coords[3];

        ivec2 xRCCorner = coords.yz * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // max/min x(?, ?, d) to get y(yR, yC, d).
        // ? = to be determined
        vec4 minMaxValue = vec4(`+g+`);
        float avgValue = 0.0;
        count = 0.0;

        for (int wR = 0; wR < `+c+`;
            wR += `+s+`) {
          int xR = xRCorner + wR;

          if (xR < 0 || xR >= `+r.inHeight+`) {
            continue;
          }

          for (int wC = 0; wC < `+w+`; wC += 4) {
            int xC = xCCorner + wC * `+l+`;

            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + `+l+`, d),
              getValue(batch, xR, xC + 2 * `+l+`, d),
              getValue(batch, xR, xC + 3 * `+l+`, d)
            );

            `+S+`
          }

          int xC = xCCorner + `+w+`;
          if (`+(_===1)+`) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              initializationValue,
              initializationValue,
              initializationValue
            );

            `+S+`
          } else if (`+(_===2)+`) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + `+l+`, d),
              initializationValue,
              initializationValue
            );

            `+S+`
          } else if (`+(_===3)+`) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + `+l+`, d),
              getValue(batch, xR, xC + 2 * `+l+`, d),
              initializationValue
            );

            `+S+`
          }
        }
        setOutput(`+b+`);
      }
    `}},og=function(r,t,e){if(this.variableNames=["x"],t==="avg"&&e)throw new Error("Cannot compute positions for average pool.");var n=r.filterWidth,a=r.strideDepth,i=r.strideHeight,s=r.strideWidth,l=r.dilationDepth,c=r.dilationHeight,f=r.dilationWidth,d=r.effectiveFilterDepth,v=r.effectiveFilterHeight,m=r.effectiveFilterWidth,g=r.padInfo.front,b=r.padInfo.top,w=r.padInfo.left;this.outputShape=r.outShape;var _=t==="avg",S="0.0";if(_||(S="-1.0 / 1e-20"),e)this.userCode=`
        const ivec3 strides =
            ivec3(`+a+", "+i+", "+s+`);
        const ivec3 pads = ivec3(`+g+", "+b+", "+w+`);

        void main() {
          ivec5 coords = getOutputCoords();
          int batch = coords.x;
          int ch = coords.u;

          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
          int xDCorner = xCorner.x;
          int xRCorner = xCorner.y;
          int xCCorner = xCorner.z;

          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;

          for (int wD = 0; wD < `+d+`;
              wD += `+l+`) {
            int xD = xDCorner + wD;

            if (xD < 0 || xD >= `+r.inDepth+`) {
              continue;
            }

            for (int wR = 0; wR < `+v+`;
                wR += `+c+`) {
              int xR = xRCorner + wR;

              if (xR < 0 || xR >= `+r.inHeight+`) {
                continue;
              }

              for (int wC = 0; wC < `+m+`;
                  wC += `+f+`) {
                int xC = xCCorner + wC;

                if (xC < 0 || xC >= `+r.inWidth+`) {
                  continue;
                }

                float value = getX(batch, xD, xR, xC, ch);

                // If a min / max value has already been found, use it. If not,
                // use the current value.
                float currMinMaxValue = mix(
                    value, minMaxValue, minMaxValueFound);
                if (value >= currMinMaxValue) {
                  minMaxValue = value;
                  minMaxValueFound = 1.0;
                  minMaxPosition =
                      wD * `+v+" * "+m+` +
                      wR * `+m+` + wC;;
                }
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;else{var E=t+"("+t+"("+t+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";t==="avg"&&(E="avgValue / count");var C=4*Math.floor(n/4),R=n%4,T=`
      if (`+_+`) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = max(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec3 strides =
        ivec3(`+a+", "+i+", "+s+`);
      const ivec3 pads = ivec3(`+g+", "+b+", "+w+`);
      const float initializationValue = `+S+`;
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xD, int xR, int xC, int ch) {
        if (xC < 0 || xC >= `+r.inWidth+`) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xD, xR, xC, ch);
      }

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xDCorner = xCorner.x;
        int xRCorner = xCorner.y;
        int xCCorner = xCorner.z;

        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).
        // ? = to be determined
        vec4 minMaxValue = vec4(`+S+`);
        float avgValue = 0.0;
        count = 0.0;

        for (int wD = 0; wD < `+d+`;
            wD += `+l+`) {
          int xD = xDCorner + wD;

          if (xD < 0 || xD >= `+r.inDepth+`) {
            continue;
          }

          for (int wR = 0; wR < `+v+`;
            wR += `+c+`) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= `+r.inHeight+`) {
              continue;
            }

            for (int wC = 0; wC < `+C+`; wC += 4) {
              int xC = xCCorner + wC * `+f+`;

              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + `+f+`, ch),
                getValue(batch, xD, xR, xC + 2 * `+f+`, ch),
                getValue(batch, xD, xR, xC + 3 * `+f+`, ch)
              );

              `+T+`
            }

            int xC = xCCorner + `+C+`;
            if (`+(R===1)+`) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                initializationValue,
                initializationValue,
                initializationValue
              );

              `+T+`
            } else if (`+(R===2)+`) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + `+f+`, ch),
                initializationValue,
                initializationValue
              );

              `+T+`
            } else if (`+(R===3)+`) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + `+f+`, ch),
                getValue(batch, xD, xR, xC + 2 * `+f+`, ch),
                initializationValue
              );

              `+T+`
            }
          }
          setOutput(`+E+`);
        }
      }
    `}},NF=function(r,t){this.variableNames=["x"];var e=r.windowSize,n=r.batchSize,a=r.inSize,i=Math.ceil(a/e);this.outputShape=[n,i];var s="0.0",l="";t==="prod"?s="1.0":t==="min"?(s="1.0 / 1e-20",l="min"):t==="max"&&(s="-1.0 / 1e-20",l="max");var c=t+"("+t+"("+t+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";t==="sum"?c="sumValue":t==="prod"?c="prodValue":t==="all"?c="allValue":t==="any"&&(c="anyValue");var f=4*Math.floor(e/4),d=e%4,v=`
      if (`+(t==="sum")+`) {
        sumValue += dot(values, ones);
      } else if (`+(t==="prod")+`) {
        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);
        prodValue *= tmp[0] * tmp[1];
      } else {
        minMaxValue = `+l+`(values, minMaxValue);
      }
    `,m="vec4";t==="all"?(s="1.0",v=`
        bool reducedAllValue = all(values);
        float floatedReducedAllValue = float(reducedAllValue);
        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);
      `,m="bvec4"):t==="any"&&(s="0.0",v=`
        bool reducedAnyValue = any(values);
        float floatedReducedAnyValue = float(reducedAnyValue);
        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);
      `,m="bvec4");var g="";a%e>0&&(g=`
        if (inIdx < 0 || inIdx >= `+a+`) {
          return initializationValue;
        }
      `),this.userCode=`
      const float initializationValue = `+s+`;
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        `+g+`
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * `+e+`;

        vec4 minMaxValue = vec4(`+s+`);
        float prodValue = 1.0;
        float sumValue = 0.0;
        float allValue = 1.0;
        float anyValue = 0.0;

        for (int i = 0; i < `+f+`; i += 4) {
          int inIdx = inOffset + i;
          `+m+" values = "+m+`(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          `+v+`
        }

        int inIdx = inOffset + `+f+`;
        if (`+(d===1)+`) {
          `+m+" values = "+m+`(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          `+v+`
        } else if (`+(d===2)+`) {
          `+m+" values = "+m+`(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          `+v+`
        } else if (`+(d===3)+`) {
          `+m+" values = "+m+`(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          `+v+`
        }
        setOutput(`+c+`);
      }
    `},MF=function(r,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=r;for(var e="",n=0;n<4;n++){var a="thisRC = rc;";n%2==1&&(a+="thisRC.z += 1;"),n>1&&(a+="thisRC.y += 1;"),e+=`
        `+a+`
        `+(n>0?"if(thisRC.y < rows && thisRC.z < cols){":"")+`
          int flatIndex = getFlatIndex(thisRC);

          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);
          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));

          result[`+n+`] =
            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);
        `+(n>0?"}":"")+`
      `}this.userCode=`
      
    ivec3 inputCoordsFromReshapedOutCoords(int index) {
      `+Vo(["r","c","d"],t)+`
      return ivec3(r, c, d);
    }
  
      `+Qy(r)+`

      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0.);

        ivec3 thisRC;
        int rows = `+r[1]+`;
        int cols = `+r[2]+`;

        `+e+`

        setOutput(result);
      }
    `},IF=function(r,t,e){this.variableNames=["dy"],this.outputShape=[],this.outputShape=t.shape;var n=t.shape,a=n[1],i=n[2],s=r.shape,l=s[1],c=s[2],f=[e&&l>1?a-1:a,e&&c>1?i-1:i],d=[e&&l>1?l-1:l,e&&c>1?c-1:c],v=f[0]/d[0],m=f[1]/d[1],g=1/v,b=1/m,w=2*Math.ceil(g)+2,_=2*Math.ceil(b)+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(`+v+`);
        const float widthScale = float(`+m+`);

        const float invHeightScale = float(`+g+`);
        const float invWidthScale = float(`+b+`);

        const int winHeight = int(`+w+`);
        const int winWidth = int(`+_+`);

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(startRLerp - float(winHeight / 2));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(startCLerp - float(winWidth / 2));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= `+l+`) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= `+c+`) {
              continue;
            }

            float dxR = float(dyR) * heightScale;
            int topDxRIndex = int(floor(dxR));
            int bottomDxRIndex = int(min(ceil(dxR), `+(a-1)+`.0));
            float dxRLerp = dxR - float(topDxRIndex);
            float inverseDxRLerp = 1.0 - dxRLerp;

            float dxC = float(dyC) * widthScale;
            int leftDxCIndex = int(floor(dxC));
            int rightDxCIndex = int(min(ceil(dxC), `+(i-1)+`.0));
            float dxCLerp = dxC - float(leftDxCIndex);
            float inverseDxCLerp = 1.0 - dxCLerp;

            if (r == topDxRIndex && c == leftDxCIndex) {
              // topLeft
              accumulator +=
                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;
            }

            if (r == topDxRIndex && c == rightDxCIndex) {
              // topRight
              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;
            }

            if (r == bottomDxRIndex && c == leftDxCIndex) {
              // bottomLeft
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;
            }

            if (r == bottomDxRIndex && c == rightDxCIndex) {
              // bottomRight
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `},FF=function(r,t,e,n){this.variableNames=["A"],this.outputShape=[];var a=r[0],i=r[1],s=r[2],l=r[3];this.outputShape=[a,t,e,l];var c=[n&&t>1?i-1:i,n&&e>1?s-1:s],f=[n&&t>1?t-1:t,n&&e>1?e-1:e];this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          `+c[0]/f[0]+`,
          `+c[1]/f[1]+`);
      const vec2 inputShapeRC = vec2(`+i+".0, "+s+`.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = vec2(yRC) * effectiveInputOverOutputRatioRC;

        // Compute the four integer indices.
        ivec2 sourceFloorRC = ivec2(sourceFracIndexRC);
        ivec2 sourceCeilRC = ivec2(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);
        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);
        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);
        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);

        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);

        float top = topLeft + (topRight - topLeft) * fracRC.y;
        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;
        float newValue = top + (bottom - top) * fracRC.x;

        setOutput(newValue);
      }
    `},BF=function(r,t,e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];var a=r[0],i=r[1],s=r[2],l=r[3];this.outputShape=[a,t,e,l];var c=[n&&t>1?i-1:i,n&&e>1?s-1:s],f=[n&&t>1?t-1:t,n&&e>1?e-1:e];this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          `+c[0]/f[0]+`,
          `+c[1]/f[1]+`,
          `+c[1]/f[1]+`);
      const vec3 inputShapeRC = vec3(`+i+".0, "+s+`.0,
                                     `+s+`.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = vec3(yRC) * effectiveInputOverOutputRatioRC;

        // Compute the four integer indices.
        ivec3 sourceFloorRC = ivec3(sourceFracIndexRC);
        ivec3 sourceCeilRC = ivec3(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < `+(l-1)+`;
        bool hasNextRow = coords.z < `+(e-1)+`;

        // In parallel, construct four corners for all four components in
        // packed 2x2 cell.
        vec4 topLeft = vec4(
          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 bottomLeft = vec4(
          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 topRight = vec4(
          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec4 bottomRight = vec4(
          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);

        vec4 top = mix(topLeft, topRight, fracRC.yyzz);
        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);
        vec4 newValue = mix(top, bottom, fracRC.x);

        setOutput(newValue);
      }
    `},LF=function(r,t,e){this.variableNames=["dy"],this.outputShape=[],this.outputShape=t.shape;var n=t.shape,a=n[1],i=n[2],s=r.shape,l=s[1],c=s[2],f=[e&&l>1?a-1:a,e&&c>1?i-1:i],d=[e&&l>1?l-1:l,e&&c>1?c-1:c],v=f[0]/d[0],m=f[1]/d[1],g=1/v,b=1/m,w=2*Math.ceil(g)+2,_=2*Math.ceil(b)+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(`+v+`);
        const float widthScale = float(`+m+`);

        const float invHeightScale = float(`+g+`);
        const float invWidthScale = float(`+b+`);

        const int winHeight = int(`+w+`);
        const int winWidth = int(`+_+`);

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(floor(startRLerp - float(winHeight / 2)));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(floor(startCLerp - float(winWidth / 2)));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= `+l+`) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= `+c+`) {
              continue;
            }

            float sourceFracRow =
              float(`+f[0]+`) *
                (float(dyR) / float(`+d[0]+`));

            float sourceFracCol =
                float(`+f[1]+`) *
                  (float(dyC) / float(`+d[1]+`));

            int sourceNearestRow = int(min(
                float(int(`+a+`) - 1),
                `+e+` ? float(round(sourceFracRow)) :
                                  float(floor(sourceFracRow))));

            int sourceNearestCol = int(min(
                float(int(`+i+`) - 1),
                `+e+` ? float(round(sourceFracCol)) :
                                  float(floor(sourceFracCol))));

            if (r == sourceNearestRow && c == sourceNearestCol) {
              accumulator += getDy(b, dyR, dyC, d);
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `},PF=function(r,t,e,n){this.variableNames=["A"],this.outputShape=[];var a=r[0],i=r[1],s=r[2],l=r[3];this.outputShape=[a,t,e,l];var c=[n&&t>1?i-1:i,n&&e>1?s-1:s],f=[n&&t>1?t-1:t,n&&e>1?e-1:e],d=n?"0.5":"0.0";this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          `+c[0]/f[0]+`,
          `+c[1]/f[1]+`);
      const vec2 inputShapeRC = vec2(`+i+".0, "+s+`.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = vec2(yRC) * effectiveInputOverOutputRatioRC;

        // Compute the coordinators of nearest neighbor point.
        ivec2 sourceNearestRC = ivec2(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + `+d+`)));

        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);

        setOutput(newValue);
      }
    `},zF=function(r,t){this.variableNames=["x"];var e=r.length;if(e>4)throw new Error("WebGL backend: Reverse of rank-"+e+" tensor is not yet supported");if(this.outputShape=r,e!==1){var n=r.map(function(i,s){return function(l){return t.indexOf(l)!==-1&&r[l]!==1?r[l]+" - coords["+l+"] - 1":"coords["+l+"]"}(s)}).join(","),a=Tt(e);this.userCode=`
      void main() {
        `+a+` coords = getOutputCoords();
        setOutput(getX(`+n+`));
      }
    `}else this.userCode=`
        void main() {
          int coord = getOutputCoords();
          setOutput(getX(`+r[0]+` - coord - 1));
        }
      `},UF=function(r,t){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;var e=r.length;if(e>4)throw new Error("WebGL backend: Reverse of rank-"+e+" tensor is not yet supported");this.outputShape=r;var n=Yn("rc",e),a=n[e-1]+" + 1 < "+this.outputShape[e-1],i=n[e-2]+" + 1 < "+this.outputShape[e-2],s=Tt(e);function l(c){var f=r.map(function(d,v){return function(m,g){return t.indexOf(m)!==-1&&r[m]!==1?r[m]+" - "+g[m]+" - 1":""+g[m]}(v,c)});return"getChannel(getX("+f.join(",")+"), vec2("+f.slice(-2).join(",")+"))"}this.userCode=e===1?`
        void main(){
          int rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = getChannel(getX(`+r[0]+` - rc - 1),
            `+r[0]+` - rc - 1);
          if(`+a+`){
              result.g = getChannel(getX(`+r[0]+` - (rc  + 1) - 1),
                `+r[0]+` - (rc  + 1) - 1);
          }
          setOutput(result);
        }
      `:`
        void main() {
          `+s+` rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = `+function(c){return l(c)}(n.slice())+`;
          if(`+a+`){
            result.g = `+function(c){return c[e-1]="("+c[e-1]+" + 1)",l(c)}(n.slice())+`;
          }
          if(`+i+`) {
            result.b = `+function(c){return c[e-2]="("+c[e-2]+" + 1)",l(c)}(n.slice())+`;
            if(`+a+`) {
              result.a = `+function(c){return c[e-1]="("+c[e-1]+" + 1)",c[e-2]="("+c[e-2]+" + 1)",l(c)}(n.slice())+`;
            }
          }
          setOutput(result);
        }
    `},m_=function(r,t,e,n,a,i,s){this.variableNames=["updates","indices","defaultValue"],this.outputShape=i;var l=Tt(a.length),c=Tt(i.length),f="";e===1?f="i":e===2&&(f="i, j");var d="getIndices("+f+")",v="";n===1?v="i":n===2&&(v="i, coords[1]");var m="getUpdates("+v+")",g=t>1?"strides[j]":"strides";this.userCode=`
        `+l+" strides = "+l+"("+a+`);

        void main() {
          `+c+` coords = getOutputCoords();
          float sum = 0.0;
          bool found = false;
          for (int i = 0; i < `+r+`; i++) {
            int flattenedIndex = 0;
            for (int j = 0; j < `+t+`; j++) {
              int index = round(`+d+`);
              flattenedIndex += index * `+g+`;
            }
            if (flattenedIndex == coords[0]) {
              sum += `+m+`;
              found = true;
            }
          }
          setOutput(mix(getDefaultValue(), sum, float(found)));
        }
      `},VF=function(r,t){this.variableNames=["x","segmentIds"];var e=r.windowSize,n=r.batchSize,a=r.inSize,i=r.numSegments,s=i*Math.ceil(a/e);this.outputShape=[n,s];var l=4*Math.floor(e/4),c=e%4,f=`
        sumValue += dot(values, segFilter);
    `,d="";a%e>0&&(d=`
        if (inIdx < 0 || inIdx >= `+a+`) {
          return initializationValue;
        }
      `);var v="";a%e>0&&(v=`
        if (inIdx < 0 || inIdx >= `+a+`) {
          return -1.0;
        }
      `),this.userCode=`
      const float initializationValue = 0.0;

      float getValue(int batch, int inIdx) {
        `+d+`
        return getX(batch, inIdx);
      }

      float getSegmentIdAtIndex(int inIdx) {
        `+v+`
        return getSegmentIds(inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = int(floor(float(outIdx) / float(
          `+i+")) * float("+e+`));
        int currentSeg = int(mod(float(outIdx), float(`+i+`)));

        float sumValue = 0.0;

        for (int i = 0; i < `+l+`; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0
          );

          `+f+`
        }

        int inIdx = inOffset + `+l+`;
        if (`+(c===1)+`) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            0,
            0,
            0
          );

          `+f+`
        } else if (`+(c===2)+`) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
              0,
              0
          );

          `+f+`
        } else if (`+(c===3)+`) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            0
          );

          `+f+`
        }
        setOutput(sumValue);
      }
    `},HF=function(r,t,e){var n,a;if(this.variableNames=["c","a","b"],this.outputShape=t,e>4)throw Error("Where for rank "+e+" is not yet supported");if(e===1)a="resRC",n="resRC";else{for(var i=["resRC.x","resRC.y","resRC.z","resRC.w"],s=[],l=[],c=0;c<t.length;c++)l.push(""+i[c]),c<r&&s.push(""+i[c]);n=s.join(),a=l.join()}var f=Tt(e);this.userCode=`
      void main() {
        `+f+` resRC = getOutputCoords();
        float cVal = getC(`+n+`);
        if (cVal >= 1.0) {
          setOutput(getA(`+a+`));
        } else {
          setOutput(getB(`+a+`));
        }
      }
    `},jF=function(){function r(t){this.variableNames=["source"],this.outputShape=t,this.rank=t.length;var e,n=Tt(this.rank),a="uniform int start["+this.rank+"];",i=function(s){if(s===1)return"sourceLoc";if(s<=6)return sg.slice(0,s).map(function(l){return"sourceLoc."+l}).join(",");throw Error("Slicing for rank "+s+" is not yet supported")}(this.rank);e=`
        `+n+` sourceLoc;
        `+n+` coords = getOutputCoords();
        `+t.map(function(s,l){return"sourceLoc."+sg[l]+" = start["+l+"] + coords."+sg[l]+";"}).join(`
`)+`
      `,this.userCode=`
      `+a+`
      void main() {
        `+e+`
        setOutput(getSource(`+i+`));
      }
    `}return r.prototype.getCustomSetupFunc=function(t){var e=this;if(t.length!==this.rank)throw Error("The rank ("+this.rank+") of the program must match the length of start ("+t.length+")");return function(n,a){e.startLoc==null&&(e.startLoc=n.getUniformLocationNoThrow(a,"start"),e.startLoc==null)||n.gl.uniform1iv(e.startLoc,t)}},r}(),sg=["x","y","z","w","u","v"],WF=function(){function r(t){this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.rank=t.length;var e=Tt(this.rank),n=Yn("coords",this.rank),a=Yn("sourceLoc",this.rank),i=this.rank===1?"sourceLoc":"vec2("+a.slice(-2).join()+")",s="getChannel(getSource("+a.join()+"), "+i+")",l=`
      result.x = `+s+`;
      if (++`+n[this.rank-1]+" < "+t[this.rank-1]+`) {
        ++`+a[this.rank-1]+`;
        result.y = `+s+`;
        --`+a[this.rank-1]+`;
      }
    `,c=this.rank===1?"":`
      --`+n[this.rank-1]+`;
      if (++`+n[this.rank-2]+" < "+t[this.rank-2]+`) {
        ++`+a[this.rank-2]+`;
        result.z = `+s+`;
        if (++`+n[this.rank-1]+" < "+t[this.rank-1]+`) {
          ++`+a[this.rank-1]+`;
          result.w = `+s+`;
        }
      }
    `,f=this.rank<=4?`sourceLoc = coords +
            `+e+"("+t.map(function(d,v){return"start["+v+"]"}).join()+");":t.map(function(d,v){return a[v]+" = "+n[v]+" + start["+v+"];"}).join(`
`);this.userCode=`
      uniform int start[`+this.rank+`];
      void main() {
        `+e+` coords = getOutputCoords();
        `+e+` sourceLoc;
        `+f+`
        vec4 result = vec4(0.);
        `+l+`
        `+c+`
        setOutput(result);
      }
    `}return r.prototype.getCustomSetupFunc=function(t){var e=this;if(t.length!==this.rank)throw Error("The rank ("+this.rank+") of the program must match the length of start ("+t.length+")");return function(n,a){e.startLoc==null&&(e.startLoc=n.getUniformLocationNoThrow(a,"start"),e.startLoc==null)||n.gl.uniform1iv(e.startLoc,t)}},r}(),GF=function(r,t,e){this.variableNames=["x"],this.outputShape=e;var n=e.length,a=Tt(e.length),i=Tt(e.length),s="";if(n===1)s="coords * strides + begin";else{var l=0;s=e.map(function(c,f){return l++,e.length===1?"coords * strides["+f+"] + begin["+f+"]":"coords["+(l-1)+"] * strides["+f+"] + begin["+f+"]"}).join(",")}this.userCode=`
      `+a+" begin = "+a+"("+r+`);
      `+a+" strides = "+a+"("+t+`);

      void main() {
        `+i+` coords = getOutputCoords();
        setOutput(getX(`+s+`));
      }
    `},qF=function(){function r(t){this.gpgpu=t,this.numUsedTextures=0,this.numFreeTextures=0,this.freeTextures={},this.logEnabled=!1,this.usedTextures={}}return r.prototype.acquireTexture=function(t,e,n){var a,i=g_(e,n),s=y_(t,i,n);if(s in this.freeTextures||(this.freeTextures[s]=[]),s in this.usedTextures||(this.usedTextures[s]=[]),this.freeTextures[s].length>0){this.numFreeTextures--,this.numUsedTextures++,this.log();var l=this.freeTextures[s].shift();return this.usedTextures[s].push(l),l}return this.numUsedTextures++,this.log(),i===cr.PACKED_2X2_FLOAT32?a=this.gpgpu.createPackedMatrixTexture(t[0],t[1]):i===cr.PACKED_2X2_FLOAT16?a=this.gpgpu.createFloat16PackedMatrixTexture(t[0],t[1]):i===cr.UNPACKED_FLOAT32?a=this.gpgpu.createFloat32MatrixTexture(t[0],t[1]):i===cr.UNPACKED_FLOAT16?a=this.gpgpu.createFloat16MatrixTexture(t[0],t[1]):i===cr.PACKED_4X1_UNSIGNED_BYTE&&(a=this.gpgpu.createUnsignedBytesMatrixTexture(t[0],t[1])),this.usedTextures[s].push(a),a},r.prototype.releaseTexture=function(t,e,n,a){if(this.freeTextures!=null){var i=y_(e,g_(n,a),a);i in this.freeTextures||(this.freeTextures[i]=[]),this.freeTextures[i].push(t),this.numFreeTextures++,this.numUsedTextures--;var s=this.usedTextures[i],l=s.indexOf(t);if(l<0)throw new Error("Cannot release a texture that was never provided by this texture manager");s.splice(l,1),this.log()}},r.prototype.log=function(){if(this.logEnabled){var t=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used",this.numFreeTextures+" / "+this.numUsedTextures,"("+t+")")}},r.prototype.getNumUsedTextures=function(){return this.numUsedTextures},r.prototype.getNumFreeTextures=function(){return this.numFreeTextures},r.prototype.dispose=function(){var t=this;if(this.freeTextures!=null){for(var e in this.freeTextures)this.freeTextures[e].forEach(function(n){t.gpgpu.deleteMatrixTexture(n)});for(var e in this.usedTextures)this.usedTextures[e].forEach(function(a){t.gpgpu.deleteMatrixTexture(a)});this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0}},r}();function g_(r,t){if(r===fr.UPLOAD)return cr.PACKED_2X2_FLOAT32;if(r===fr.RENDER||r==null)return function(e){return le().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?e?cr.PACKED_2X2_FLOAT32:cr.UNPACKED_FLOAT32:e?cr.PACKED_2X2_FLOAT16:cr.UNPACKED_FLOAT16}(t);if(r===fr.DOWNLOAD||r===fr.PIXELS)return cr.PACKED_4X1_UNSIGNED_BYTE;throw new Error("Unknown logical texture type "+r)}function y_(r,t,e){return r[0]+"_"+r[1]+"_"+t+"_"+e}var KF=function(r,t){this.variableNames=["A"];for(var e=new Array(r.length),n=0;n<e.length;n++)e[n]=r[n]*t[n];this.outputShape=e,this.rank=e.length;var a=Tt(this.rank),i=function(s){var l=s.length;if(l>5)throw Error("Tile for rank "+l+" is not yet supported");if(l===1)return"imod(resRC, "+s[0]+")";for(var c=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],f=[],d=0;d<s.length;d++)f.push("imod("+c[d]+", "+s[d]+")");return f.join()}(r);this.userCode=`
      void main() {
        `+a+` resRC = getOutputCoords();
        setOutput(getA(`+i+`));
      }
    `},XF=function(r,t){this.variableNames=["A"];for(var e=new Array(r.length),n=0;n<e.length;n++)e[n]=r[t[n]];this.outputShape=e,this.rank=e.length;var a=Tt(this.rank),i=function(s){var l=s.length;if(l>6)throw Error("Transpose for rank "+l+" is not yet supported");for(var c=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],f=new Array(l),d=0;d<s.length;d++)f[s[d]]=c[d];return f.join()}(t);this.userCode=`
    void main() {
      `+a+` resRC = getOutputCoords();
      setOutput(getA(`+i+`));
    }
    `},$F=function(r,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;for(var e=new Array(r.length),n=0;n<e.length;n++)e[n]=r[t[n]];if(this.outputShape=e,this.rank=e.length,this.rank>6)throw Error("Packed transpose for rank "+this.rank+" is not yet supported.");var a=Tt(this.rank),i=hC("rc",this.rank),s=new Array(this.rank);for(n=0;n<t.length;n++)s[t[n]]=i[n];var l="vec2("+s.slice(-2).join()+")",c="++"+i[this.rank-1]+" < "+e[this.rank-1],f="getChannel(getA("+s.join()+"), "+l+")";this.userCode=`
    void main() {
      `+a+` rc = getOutputCoords();
      vec4 result = vec4(0.);
      result[0] = `+f+`;
      if(`+c+`) {
        result[1] = `+f+`;
      }
      --`+i[this.rank-1]+`;
      if(++`+i[this.rank-2]+" < "+e[this.rank-2]+`) {
        result[2] = `+f+`;
        if(`+c+`) {
          result[3] = `+f+`;
        }
      }
      setOutput(result);
    }
    `},Jy=1.7580993408473768,e0=1.0507009873554805,$e=function(r,t){this.variableNames=["A"],this.outputShape=r,this.userCode=`
      float unaryOperation(float x) {
        `+t+`
      }

      void main() {
        float x = getAAtOutCoords();
        float y = unaryOperation(x);

        setOutput(y);
      }
    `},Jr="if (isnan(x)) return x;",YF="return x;",b_="return abs(x);",gC=Jr+`
  return (x < 0.0) ? 0.0 : x;
`,yC=Jr+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,bC="return (x >= 0.0) ? x : (exp(x) - 1.0);",ZF=`
  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.
  // see: https://arxiv.org/abs/1706.02515
  float scaleAlpha = `+Jy+`;
  float scale = `+e0+`;
  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);
`,x_="return -x;",w_="return ceil(x);",__="return floor(x);",S_="return exp(x);",E_="return exp(x) - 1.0;",QF=Jr+`
  return sin(x);
`,JF=Jr+`
  return cos(x);
`,eB=Jr+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return asin(x);
`,tB=Jr+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return acos(x);
`,nB=Jr+`
  return atan(x);
`,rB=Jr+"return log(x + sqrt(x * x + 1.0));",aB=Jr+`
  if (x < 1.0) return NAN;
  return log(x + sqrt(x * x - 1.0));`,iB=Jr+`
  if ((x < -1.0) || (x > 1.0)) return NAN;
  return (log(1.0 + x) - log(1.0 - x)) / 2.0;`,Nh="return x;",oB="return x;",xC=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,wC=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,_C=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,ic=function(r,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=r,this.userCode=`
      vec4 unaryOperation(vec4 x) {
        `+t+`
      }

      void main() {
        vec4 x = getAAtOutCoords();
        vec4 y = unaryOperation(x);

        setOutput(y);
      }
    `},sB=function(r){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=r;var t=r.length,e=Yn("rc",t),n=Tt(t),a=function(l,c){if(l===1)return"rc";for(var f="",d=0;d<l;d++)f+=c[d],d<l-1&&(f+=",");return f}(t,e),i=e.slice(-2),s=t<=1?"rc":"vec2("+i.join(",")+")";this.userCode=`
      void main() {
        `+n+` rc = getOutputCoords();
        vec4 packedInput = getA(`+a+`);

        setOutput(getChannel(packedInput, `+s+`));
      }
    `},Mh={};function Ih(r,t){if(t===void 0&&(t=!1),r==="linear")return t?oB:YF;if(r==="relu")return t?xC:gC;if(r==="elu")return t?_C:bC;if(r==="relu6")return t?wC:yC;if(r==="prelu")return t?mC:vC;throw new Error("Activation "+r+" has not been implemented for the WebGL backend.")}var uB=600,lB=function(r){function t(e){var n,a=r.call(this)||this;if(a.pendingRead=new WeakMap,a.pendingDisposal=new WeakSet,a.dataRefCount=new WeakMap,a.numBytesInGPU=0,a.uploadWaitMs=0,a.downloadWaitMs=0,a.warnedAboutMemory=!1,a.pendingDeletes=0,a.disposed=!1,!le().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");if(e==null){var i=Ta(le().getNumber("WEBGL_VERSION"));a.binaryCache=((n=le().getNumber("WEBGL_VERSION"))in Mh||(Mh[n]={}),Mh[n]),a.gpgpu=new xF(i),a.canvas=i.canvas,a.gpgpuCreatedLocally=!0}else a.gpgpu=e,a.binaryCache={},a.gpgpuCreatedLocally=!1,a.canvas=e.gl.canvas;return a.textureManager=new qF(a.gpgpu),a.numMBBeforeWarning=le().global.screen==null?1024:le().global.screen.height*le().global.screen.width*window.devicePixelRatio*uB/1024/1024,a.texData=new rC(a,q),a}return Qr(t,r),t.prototype.numDataIds=function(){return this.texData.numDataIds()+(this.cpuBackend?this.cpuBackend.numDataIds():0)-this.pendingDeletes},t.prototype.write=function(e,n,a){if(le().getBool("DEBUG")&&this.checkNumericalProblems(e),a==="complex64"&&e!=null)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");var i={};return this.texData.set(i,{shape:n,dtype:a,values:e,usage:fr.UPLOAD}),i},t.prototype.move=function(e,n,a,i){if(le().getBool("DEBUG")&&this.checkNumericalProblems(n),i==="complex64")throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(e,{shape:a,dtype:i,values:n,usage:fr.UPLOAD})},t.prototype.readSync=function(e){var n=this.texData.get(e),a=n.values,i=n.dtype,s=n.complexTensors,l=n.slice,c=n.shape,f=n.isPacked;if(l!=null){var d=void 0;d=f?new ic(c,Nh):new $e(c,Nh);var v=this.runWebGLProgram(d,[{dataId:e,shape:c,dtype:i}],i),m=this.readSync(v.dataId);return this.disposeData(v.dataId),m}if(a!=null)return this.convertAndCacheOnCPU(e);if(i==="string")return a;var g,b,w=this.activeTimers!=null;return w&&(g=da()),i==="complex64"?b=dy(s.real.dataSync(),s.imag.dataSync()):b=this.getValuesFromTexture(e),w&&(this.downloadWaitMs+=da()-g),this.convertAndCacheOnCPU(e,b)},t.prototype.read=function(e){return Ce(this,void 0,void 0,function(){var n,a,i,s,l,c,f,d,v,m,g,b,w,_,S,E,C,R,T,D,k,M;return Re(this,function(N){switch(N.label){case 0:if(this.pendingRead.has(e))return n=this.pendingRead.get(e),[2,new Promise(function(I){return n.push(I)})];if(a=this.texData.get(e),i=a.values,s=a.shape,l=a.slice,c=a.dtype,f=a.complexTensors,d=a.isPacked,l!=null)return v=void 0,v=d?new ic(s,Nh):new $e(s,Nh),m=this.runWebGLProgram(v,[{dataId:e,shape:s,dtype:c}],c),g=this.read(m.dataId),this.disposeData(m.dataId),[2,g];if(i!=null)return[2,this.convertAndCacheOnCPU(e)];if(!le().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&le().getNumber("WEBGL_VERSION")===2)throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");return b=null,c!=="complex64"&&le().get("WEBGL_BUFFER_SUPPORTED")&&(w=this.decode(e),_=this.texData.get(w.dataId),b=(M=this.gpgpu).createBufferFromTexture.apply(M,[_.texture].concat(dc(s)))),this.pendingRead.set(e,[]),c==="complex64"?[3,2]:[4,this.gpgpu.createAndWaitForFence()];case 1:N.sent(),N.label=2;case 2:return c!=="complex64"?[3,4]:[4,Promise.all([f.real.data(),f.imag.data()])];case 3:return E=N.sent(),C=E[0],R=E[1],S=dy(C,R),[3,5];case 4:b==null?S=this.getValuesFromTexture(e):(T=Te(s),S=this.gpgpu.downloadFloat32MatrixFromBuffer(b,T)),N.label=5;case 5:return w!=null&&this.disposeData(w.dataId),D=this.convertAndCacheOnCPU(e,S),k=this.pendingRead.get(e),this.pendingRead.delete(e),k.forEach(function(I){return I(D)}),this.pendingDisposal.has(e)&&(this.pendingDisposal.delete(e),this.disposeData(e),this.pendingDeletes--),[2,D]}})})},t.prototype.checkNumericalProblems=function(e){if(e!=null)for(var n=0;n<e.length;n++){var a=e[n];if(!Z4(a))throw le().getBool("WEBGL_RENDER_FLOAT32_CAPABLE")?Error("The value "+a+" cannot be represented with your current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'"):Error("The value "+a+" cannot be represented on this device.")}},t.prototype.getValuesFromTexture=function(e){var n,a=this.texData.get(e),i=a.shape,s=a.dtype,l=a.isPacked,c=Te(i);if(le().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){var f=this.decode(e),d=this.texData.get(f.dataId),v=(n=this.gpgpu).downloadMatrixFromPackedTexture.apply(n,[d.texture].concat(dc(i))).subarray(0,c);return this.disposeData(f.dataId),v}var m=le().getBool("WEBGL_PACK")&&l===!0,g=m?eg(i):i,b=m?new YI(g):new $I(g),w=this.runWebGLProgram(b,[{shape:g,dtype:s,dataId:e}],"float32"),_=this.texData.get(w.dataId),S=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(_.texture,_.texShape[0],_.texShape[1]).subarray(0,c);return this.disposeData(w.dataId),S},t.prototype.time=function(e){return Ce(this,void 0,void 0,function(){var n,a,i,s,l,c,f;return Re(this,function(d){switch(d.label){case 0:return n=this.activeTimers,a=[],i=!1,this.programTimersStack==null?(this.programTimersStack=a,i=!0):this.activeTimers.push(a),this.activeTimers=a,e(),s=Gu(this.activeTimers.map(function(v){return v.query})).filter(function(v){return v!=null}),l=Gu(this.activeTimers.map(function(v){return v.name})).filter(function(v){return v!=null}),this.activeTimers=n,i&&(this.programTimersStack=null),c={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null},le().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?[4,Promise.all(s)]:[3,2];case 1:return f=d.sent(),c.kernelMs=O4(f),c.getExtraProfileInfo=function(){return f.map(function(v,m){return{name:l[m],ms:v}}).map(function(v){return v.name+": "+v.ms}).join(", ")},[3,3];case 2:c.kernelMs={error:"WebGL query timers are not supported in this environment."},d.label=3;case 3:return this.uploadWaitMs=0,this.downloadWaitMs=0,[2,c]}})})},t.prototype.memory=function(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU}},t.prototype.startTimer=function(){return le().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:da(),endMs:null}},t.prototype.endTimer=function(e){return le().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),e):(e.endMs=da(),e)},t.prototype.getQueryTime=function(e){return Ce(this,void 0,void 0,function(){var n;return Re(this,function(a){return le().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?[2,this.gpgpu.waitForQueryAndGetTime(e)]:[2,(n=e).endMs-n.startMs]})})},t.prototype.disposeData=function(e){if(!this.pendingDisposal.has(e)){if(this.pendingRead.has(e))return this.pendingDisposal.add(e),void this.pendingDeletes++;if(this.texData.has(e)){this.releaseGPUData(e);var n=this.texData.get(e).complexTensors;n!=null&&(n.real.dispose(),n.imag.dispose()),this.texData.delete(e)}}},t.prototype.releaseGPUData=function(e){var n=this.texData.get(e),a=n.texture,i=n.dtype,s=n.texShape,l=n.usage,c=n.isPacked,f=n.slice,d=f&&f.origDataId||e,v=this.dataRefCount.get(d);v>1?this.dataRefCount.set(d,v-1):(this.dataRefCount.delete(d),a!=null&&(this.numBytesInGPU-=this.computeBytes(s,i),this.textureManager.releaseTexture(a,s,l,c)));var m=this.texData.get(e);m.texture=null,m.texShape=null,m.isPacked=!1,m.slice=null},t.prototype.getTexture=function(e){return this.uploadToGPU(e),this.texData.get(e).texture},t.prototype.getDataInfo=function(e){return this.texData.get(e)},t.prototype.getCPUBackend=function(){return le().getBool("WEBGL_CPU_FORWARD")?(this.cpuBackend==null&&(this.cpuBackend=q.findBackend("cpu")),this.cpuBackend):null},t.prototype.shouldExecuteOnCPU=function(e,n){var a=this;return n===void 0&&(n=128),this.getCPUBackend()!=null&&e.every(function(i){return a.texData.get(i.dataId).texture==null&&i.size<n})},t.prototype.getGPGPUContext=function(){return this.gpgpu},t.prototype.complex=function(e,n){var a=this.makeOutput(e.shape,"complex64");return this.texData.get(a.dataId).complexTensors={real:q.keep(e.clone()),imag:q.keep(n.clone())},a},t.prototype.real=function(e){return this.texData.get(e.dataId).complexTensors.real.clone()},t.prototype.imag=function(e){return this.texData.get(e.dataId).complexTensors.imag.clone()},t.prototype.slice=function(e,n,a){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.slice(e,n,a);if(Te(a)===0)return Sn([],a,e.dtype);var i=this.texData.get(e.dataId).isPacked,s=tC(e.shape,n,a);if(i||!s){var l=le().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new WF(a):new jF(a),c=l.getCustomSetupFunc(n);return this.compileAndRun(l,[e],null,c)}return this.uploadToGPU(e.dataId),this.shallowSlice(e,n,a)},t.prototype.shallowSlice=function(e,n,a){var i=this.texData.get(e.dataId),s=this.makeOutput(a,e.dtype),l=this.texData.get(s.dataId);Object.assign(l,i),l.shape=a,l.dtype=e.dtype;var c=nC(n,e.strides);i.slice&&(c+=i.slice.flatOffset),l.slice={flatOffset:c,origDataId:i.slice&&i.slice.origDataId||e.dataId};var f=this.dataRefCount.get(l.slice.origDataId)||1;return this.dataRefCount.set(l.slice.origDataId,f+1),s},t.prototype.stridedSlice=function(e,n,a,i){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.stridedSlice(e,n,a,i);var s=Ky(n,a,i);if(s.some(function(c){return c===0}))return Sn([],s);var l=new GF(n,i,s);return this.compileAndRun(l,[e])},t.prototype.reverse=function(e,n){var a=le().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new UF(e.shape,n):new zF(e.shape,n);return this.compileAndRun(a,[e])},t.prototype.concat=function(e,n){if(e[0].dtype==="complex64"){var a=e.map(function(g){return Or(g)}),i=e.map(function(g){return va(g)});return wn(this.concat(a,n),this.concat(i,n))}if(this.shouldExecuteOnCPU(e))return this.cpuBackend.concat(e,n);if(e.length===1)return e[0];if(e.length>le().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER")){var s=Math.floor(e.length/2),l=this.concat(e.slice(0,s),n),c=this.concat(e.slice(s),n);return this.concat([l,c],n)}if(le().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&e[0].rank>1){var f=new FI(e.map(function(g){return g.shape}),n);return this.compileAndRun(f,e)}var d=Ku(e.map(function(g){return g.shape}),n),v=e.map(function(g){return g.as2D(-1,Te(g.shape.slice(n)))}),m=new II(v.map(function(g){return g.shape}));return this.compileAndRun(m,v).reshape(d)},t.prototype.neg=function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.neg(e);if(le().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,x_,e.dtype);var n=new $e(e.shape,x_);return this.compileAndRun(n,[e])},t.prototype.batchMatMul=function(e,n,a,i){var s=a?e.shape[2]:e.shape[1],l=i?n.shape[1]:n.shape[2],c=a?e.shape[1]:e.shape[2],f=e.shape[0];if((s===1||l===1)&&c>1e3){a&&(e=e.transpose([0,2,1])),i&&(n=n.transpose([0,2,1]));var d=l===1?e:e.as3D(f,c,1),v=l===1?2:1,m=l===1?n.as3D(f,1,c):n;return this.multiply(d,m).sum(v,!0)}var g=_n(e.dtype,n.dtype),b=new ag(e.shape,[f,s,l],a,i);return this.compileAndRun(b,[e,n],g)},t.prototype.fusedBatchMatMul=function(e){var n=e.a,a=e.b,i=e.transposeA,s=e.transposeB,l=e.bias,c=e.activation,f=e.preluActivationWeights,d=i?n.shape[2]:n.shape[1],v=s?a.shape[1]:a.shape[2],m=n.shape[0],g=_n(n.dtype,a.dtype),b=l!=null,w=f!=null,_=c?Ih(c,!0):null,S=new ag(n.shape,[m,d,v],i,s,b,_,w),E=[n,a];return l&&E.push(l),f&&E.push(f),this.compileAndRun(S,E,g)},t.prototype.multiply=function(e,n){if(e.dtype==="complex64"){var a=this.texData.get(e.dataId),i=this.texData.get(n.dataId),s=new u_(DI,e.shape,n.shape),l=new u_(kI,e.shape,n.shape),c=[this.makeComplexComponentTensorInfo(e,a.complexTensors.real),this.makeComplexComponentTensorInfo(e,a.complexTensors.imag),this.makeComplexComponentTensorInfo(n,i.complexTensors.real),this.makeComplexComponentTensorInfo(n,i.complexTensors.imag)],f=this.compileAndRun(s,c),d=this.compileAndRun(l,c),v=this.complex(f,d);return f.dispose(),d.dispose(),v}if(this.shouldExecuteOnCPU([e,n]))return this.cpuBackend.multiply(e,n);if(le().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,n,l_,e.dtype);var m=new zt(l_,e.shape,n.shape);return this.compileAndRun(m,[e,n],e.dtype)},t.prototype.batchNormalization=function(e,n,a,i,s,l){var c=[e,n,a],f=null;l!=null&&(f=l.shape,c.push(l));var d=null;if(s!=null&&(d=s.shape,c.push(s)),le().getBool("WEBGL_PACK_NORMALIZATION")){var v=new AI(e.shape,n.shape,a.shape,f,d,i);return this.compileAndRun(v,c)}var m=new TI(e.shape,n.shape,a.shape,f,d,i);return this.compileAndRun(m,c)},t.prototype.localResponseNormalization4D=function(e,n,a,i,s){var l=le().getBool("WEBGL_PACK_NORMALIZATION")?new EF(e.shape,n,a,i,s):new _F(e.shape,n,a,i,s);return this.compileAndRun(l,[e])},t.prototype.LRNGrad=function(e,n,a,i,s,l,c){var f=new SF(n.shape,i,s,l,c);return this.compileAndRun(f,[n,a,e])},t.prototype.tile=function(e,n){if(e.dtype==="string"){var a=this.readSync(e.dataId).map(function(s){return yd(s)});return cC(Ge(e.shape,e.dtype,a),n)}var i=new KF(e.shape,n);return this.compileAndRun(i,[e])},t.prototype.pad=function(e,n,a){var i=le().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new OF(e.shape,n,a):new kF(e.shape,n,a);return this.compileAndRun(i,[e])},t.prototype.transpose=function(e,n){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.transpose(e,n);var a=le().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new $F(e.shape,n):new XF(e.shape,n);return this.compileAndRun(a,[e])},t.prototype.gather=function(e,n,a){if(this.shouldExecuteOnCPU([e,n]))return this.cpuBackend.gather(e,n,a);var i=new nF(e.shape,n.size,a);return this.compileAndRun(i,[e,n])},t.prototype.batchToSpaceND=function(e,n,a){L(e.rank<=4,function(){return"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet"});var i=n.reduce(function(v,m){return v*m}),s=Ed(e.shape,n,i),l=Cd(s.length,n.length),c=Rd(e.shape,n,i),f=ZE(a,n.length),d=QE(c,a,n.length);return e.reshape(s).transpose(l).reshape(c).slice(f,d)},t.prototype.spaceToBatchND=function(e,n,a){L(e.rank<=4,function(){return"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet"});var i=n.reduce(function(m,g){return m*g}),s=[[0,0]];s.push.apply(s,a);for(var l=1+n.length;l<e.shape.length;++l)s.push([0,0]);var c=e.pad(s),f=Ed(c.shape,n,i,!1),d=Cd(f.length,n.length,!1),v=Rd(c.shape,n,i,!1);return c.reshape(f).transpose(d).reshape(v)},t.prototype.reduce=function(e,n,a){var i=e.shape[0],s=e.shape[1],l=tg(s),c=new NF({windowSize:l,inSize:s,batchSize:i},n),f=this.compileAndRun(c,[e],a);return f.shape[1]===1?f:this.reduce(f,n,a)},t.prototype.argReduce=function(e,n,a){a===void 0&&(a=null);var i=e.shape[0],s=e.shape[1];a!=null&&(i=a.shape[0],s=a.shape[1]);var l=tg(s),c=new yI({windowSize:l,inSize:s,batchSize:i},n,a==null),f=[e];a!=null&&f.push(a);var d=this.compileAndRun(c,f,"int32");return d.shape[1]===1?d:this.argReduce(e,n,d)},t.prototype.argReducePacked=function(e,n,a){a===void 0&&(a=null);var i=a!=null?a.shape:e.shape,s=tg(i[i.length-1]),l=new EI(i,s,n,a==null),c=a==null?[e]:[e,a],f=this.compileAndRun(l,c,"int32");return f.rank===e.rank?this.argReducePacked(e,n,f):f},t.prototype.sum=function(e,n){lr("sum",n,e.rank);var a=Dn(e.shape,n),i=a[0],s=Te(a[1]),l=e.as2D(-1,s),c=Km(e.dtype);return this.reduce(l,"sum",c).reshape(i)},t.prototype.prod=function(e,n){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.prod(e,n);var a=Dn(e.shape,n),i=a[0],s=Te(a[1]),l=e.as2D(-1,s),c=Km(e.dtype);return this.reduce(l,"prod",c).reshape(i)},t.prototype.unsortedSegmentSum=function(e,n,a){var i=0,s=Aa([i],e.rank),l=e;s!=null&&(l=e.transpose(s),i=Da(1,e.rank)[0]);var c=function(g,b,w){for(var _=[],S=g.length,E=0;E<S;E++)E!==b?_.push(g[E]):_.push(w);return _}(l.shape,i,a),f=Te([l.shape[i]]),d=l.as2D(-1,f),v=Km(e.dtype),m=this.segOpCompute(d,"unsortedSegmentSum",n,v,a).reshape(c);return s!=null&&(m=m.transpose(jy(s))),m},t.prototype.segOpCompute=function(e,n,a,i,s){var l=e.shape[0],c=e.shape[1],f=function(m,g){var b,w=!1;for(m<=eC?(b=m,w=!0):b=ay(m,Math.floor(Math.sqrt(m)));!w;)b>g||b===m?w=!0:b=ay(m,b+1);return b}(c,s),d=new VF({windowSize:f,inSize:c,batchSize:l,numSegments:s}),v=this.compileAndRun(d,[e,a],i);return v.shape[1]===s?v:(a=Sd(0,s).tile([c/f]),this.segOpCompute(v,n,a,i,s))},t.prototype.argMinMaxReduce=function(e,n,a){var i=[n];if(lr("arg"+a.charAt(0).toUpperCase()+a.slice(1),i,e.rank),!le().getBool("WEBGL_PACK_REDUCE")||e.rank<=2){var s=Dn(e.shape,i),l=s[0],c=Te(s[1]),f=e.as2D(-1,c);return this.argReduce(f,a).reshape(l)}return this.argReducePacked(e,a)},t.prototype.argMin=function(e,n){return this.argMinMaxReduce(e,n,"min")},t.prototype.argMax=function(e,n){return this.argMinMaxReduce(e,n,"max")},t.prototype.cumsum=function(e,n,a,i){if(n!==e.rank-1)throw new Error("WebGL cumsum shader expects an inner-most axis="+(e.rank-1)+" but got axis="+n);var s=new WI(e.shape,a,i);return this.compileAndRun(s,[e])},t.prototype.equal=function(e,n){if(le().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,n,`
  return vec4(equal(a, b));
`,"bool");var a=new zt("return float(a == b);",e.shape,n.shape);return this.compileAndRun(a,[e,n],"bool")},t.prototype.notEqual=function(e,n){if(le().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,n,`
  return vec4(notEqual(a, b));
`,"bool");var a=new zt("return float(a != b);",e.shape,n.shape);return this.compileAndRun(a,[e,n],"bool")},t.prototype.less=function(e,n){if(this.shouldExecuteOnCPU([e,n]))return this.cpuBackend.less(e,n);if(le().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,n,`
  return vec4(lessThan(a, b));
`,"bool");var a=new zt("return float(a < b);",e.shape,n.shape);return this.compileAndRun(a,[e,n],"bool")},t.prototype.lessEqual=function(e,n){if(le().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,n,`
  return vec4(lessThanEqual(a, b));
`,"bool");var a=new zt("return float(a <= b);",e.shape,n.shape);return this.compileAndRun(a,[e,n],"bool")},t.prototype.greater=function(e,n){if(this.shouldExecuteOnCPU([e,n]))return this.cpuBackend.greater(e,n);if(le().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,n,`
  return vec4(greaterThan(a, b));
`,"bool");var a=new zt("return float(a > b);",e.shape,n.shape);return this.compileAndRun(a,[e,n],"bool")},t.prototype.greaterEqual=function(e,n){if(le().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,n,`
  return vec4(greaterThanEqual(a, b));
`,"bool");var a=new zt("return float(a >= b);",e.shape,n.shape);return this.compileAndRun(a,[e,n],"bool")},t.prototype.logicalNot=function(e){var n=new $e(e.shape,"return float(!(x >= 1.0));");return this.compileAndRun(n,[e])},t.prototype.logicalAnd=function(e,n){if(le().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,n,`
  return vec4(
    vec4(greaterThanEqual(a, vec4(1.0))) *
    vec4(greaterThanEqual(b, vec4(1.0))));
`,"bool");var a=new zt("return float(a >= 1.0 && b >= 1.0);",e.shape,n.shape);return this.compileAndRun(a,[e,n],"bool")},t.prototype.logicalOr=function(e,n){if(le().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,n,`
  return min(
    vec4(greaterThanEqual(a, vec4(1.0))) +
    vec4(greaterThanEqual(b, vec4(1.0))),
    vec4(1.0));
`,"bool");var a=new zt("return float(a >= 1.0 || b >= 1.0);",e.shape,n.shape);return this.compileAndRun(a,[e,n],"bool")},t.prototype.select=function(e,n,a){var i=new HF(e.rank,n.shape,n.rank);return this.compileAndRun(i,[e,n,a],_n(n.dtype,a.dtype))},t.prototype.where=function(e){wd("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");var n=e.dataSync();return Zy(e.shape,n)},t.prototype.topk=function(e,n,a){return fC(e.dataSync(),e.shape,e.dtype,n)},t.prototype.min=function(e,n){lr("min",n,e.rank);var a=Dn(e.shape,n),i=a[0],s=Te(a[1]),l=e.as2D(-1,s);return this.reduce(l,"min",l.dtype).reshape(i)},t.prototype.minimum=function(e,n){if(this.shouldExecuteOnCPU([e,n]))return this.cpuBackend.minimum(e,n);var a=le().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Ya(`
  vec4 result = vec4(min(a, b));
  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,e.shape,n.shape):new zt(`
  if (isnan(a)) return a;
  if (isnan(b)) return b;

  return min(a, b);
`,e.shape,n.shape);return this.compileAndRun(a,[e,n])},t.prototype.mod=function(e,n){var a=le().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Ya(`
  vec4 result = mod(a, b);
  vec4 isNaN = vec4(equal(b, vec4(0.0)));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,e.shape,n.shape):new zt(`if (b == 0.0) return NAN;
  return mod(a, b);`,e.shape,n.shape);return this.compileAndRun(a,[e,n])},t.prototype.max=function(e,n){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.max(e,n);lr("max",n,e.rank);var a=Dn(e.shape,n),i=a[0],s=Te(a[1]),l=e.as2D(-1,s);return this.reduce(l,"max",l.dtype).reshape(i)},t.prototype.maximum=function(e,n){if(this.shouldExecuteOnCPU([e,n]))return this.cpuBackend.maximum(e,n);var a=le().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Ya(`
  vec4 result = vec4(max(a, b));
  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,e.shape,n.shape):new zt(`
  if (isnan(a)) return a;
  if (isnan(b)) return b;

  return max(a, b);
`,e.shape,n.shape);return this.compileAndRun(a,[e,n])},t.prototype.all=function(e,n){lr("all",n,e.rank);var a=Dn(e.shape,n),i=a[0],s=Te(a[1]),l=e.as2D(-1,s);return this.reduce(l,"all",l.dtype).reshape(i)},t.prototype.any=function(e,n){lr("any",n,e.rank);var a=Dn(e.shape,n),i=a[0],s=Te(a[1]),l=e.as2D(-1,s);return this.reduce(l,"any",l.dtype).reshape(i)},t.prototype.realDivide=function(e,n){if(le().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,n,`
  // vec4 one = vec4(equal(a, b));
  // return one + (vec4(1.0) - one) * a / b;
  vec4 result = a / b;
  if(a.x == b.x) {
    result.x = 1.;
  }
  if(a.y == b.y) {
    result.y = 1.;
  }
  if(a.z == b.z) {
    result.z = 1.;
  }
  if(a.w == b.w) {
    result.w = 1.;
  }

  return result;
`,"float32",!0);var a=new zt(`
if (a == b) {
  return 1.0;
};
return a / b;`,e.shape,n.shape);return this.compileAndRun(a,[e,n],"float32")},t.prototype.floorDiv=function(e,n){if(le().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,n,`
  ivec4 ia = round(a);
  ivec4 ib = round(b);
  bvec4 cond = notEqual(ib, ivec4(0));
  ivec4 result = ivec4(0);
  vec4 s = sign(a) * sign(b);

  // Windows (D3D) wants guaranteed non-zero int division at compile-time.
  if (cond[0]) {
    result[0] = idiv(ia[0], ib[0], s[0]);
  }
  if (cond[1]) {
    result[1] = idiv(ia[1], ib[1], s[1]);
  }
  if (cond[2]) {
    result[2] = idiv(ia[2], ib[2], s[2]);
  }
  if (cond[3]) {
    result[3] = idiv(ia[3], ib[3], s[3]);
  }
  return vec4(result);
`,"int32");var a=new zt(`
  float s = sign(a) * sign(b);
  int ia = round(a);
  int ib = round(b);
  if (ib != 0) {
    // Windows (D3D) wants guaranteed non-zero int division at compile-time.
    return float(idiv(ia, ib, s));
  } else {
    return NAN;
  }
`,e.shape,n.shape);return this.compileAndRun(a,[e,n],"int32")},t.prototype.add=function(e,n){if(e.dtype==="complex64"&&n.dtype==="complex64")return this.complexSeparableBinaryOp(e,n,ng);if(this.shouldExecuteOnCPU([e,n]))return this.cpuBackend.add(e,n);var a=_n(e.dtype,n.dtype);if(le().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,n,ng,a);var i=new zt(ng,e.shape,n.shape);return this.compileAndRun(i,[e,n],a)},t.prototype.packedUnaryOp=function(e,n,a){var i=new ic(e.shape,n);return this.compileAndRun(i,[e],a)},t.prototype.packedBinaryOp=function(e,n,a,i,s){s===void 0&&(s=!1);var l=new Ya(a,e.shape,n.shape,s);return this.compileAndRun(l,[e,n],i)},t.prototype.complexSeparableBinaryOp=function(e,n,a){var i=this,s=this.texData.get(e.dataId),l=this.texData.get(n.dataId),c=[[s.complexTensors.real,l.complexTensors.real],[s.complexTensors.imag,l.complexTensors.imag]].map(function(m){var g=m[0],b=m[1],w=i.makeComplexComponentTensorInfo(e,g),_=i.makeComplexComponentTensorInfo(n,b),S=new zt(a,e.shape,n.shape);return i.compileAndRun(S,[w,_],_n(g.dtype,b.dtype))}),f=c[0],d=c[1],v=this.complex(f,d);return f.dispose(),d.dispose(),v},t.prototype.makeComplexComponentTensorInfo=function(e,n){return{dataId:n.dataId,dtype:n.dtype,shape:e.shape}},t.prototype.addN=function(e){if(e.length===1)return e[0];if(e.length>le().get("WEBGL_MAX_TEXTURES_IN_SHADER")){var n=Math.floor(e.length/2),a=this.addN(e.slice(0,n)),i=this.addN(e.slice(n));return this.addN([a,i])}var s=e.map(function(f){return f.dtype}).reduce(function(f,d){return _n(f,d)}),l=e.map(function(f){return f.shape}),c=le().getBool("WEBGL_PACK")?new gI(e[0].shape,l):new mI(e[0].shape,l);return this.compileAndRun(c,e,s)},t.prototype.subtract=function(e,n){if(e.dtype==="complex64"&&n.dtype==="complex64")return this.complexSeparableBinaryOp(e,n,rg);if(this.shouldExecuteOnCPU([e,n]))return this.cpuBackend.subtract(e,n);var a=_n(e.dtype,n.dtype);if(le().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,n,rg,e.dtype);var i=new zt(rg,e.shape,n.shape);return this.compileAndRun(i,[e,n],a)},t.prototype.pow=function(e,n){var a=le().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Ya(`
  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.
  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));
  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);
  vec4 result = multiplier * pow(abs(a), b);

  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS
  bvec4 isExpZero = equal(b, vec4(0.0));
  result.r = isExpZero.r ? 1.0 : result.r;
  result.g = isExpZero.g ? 1.0 : result.g;
  result.b = isExpZero.b ? 1.0 : result.b;
  result.a = isExpZero.a ? 1.0 : result.a;

  vec4 isNaN = vec4(lessThan(a, vec4(0.0))) * vec4(lessThan(floor(b), b));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,e.shape,n.shape):new zt(`
if(a < 0.0 && floor(b) < b){
  return NAN;
}
if (b == 0.0) {
  return 1.0;
}
return (round(mod(b, 2.0)) != 1) ?
    pow(abs(a), b) : sign(a) * pow(abs(a), b);
`,e.shape,n.shape),i=_n(e.dtype,n.dtype);return this.compileAndRun(a,[e,n],i)},t.prototype.ceil=function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.ceil(e);if(le().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,w_,e.dtype);var n=new $e(e.shape,w_);return this.compileAndRun(n,[e])},t.prototype.floor=function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.floor(e);if(le().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,__,e.dtype);var n=new $e(e.shape,__);return this.compileAndRun(n,[e])},t.prototype.sign=function(e){var n=new $e(e.shape,`
  if (isnan(x)) { return 0.0; }
  return sign(x);
`);return this.compileAndRun(n,[e])},t.prototype.isNaN=function(e){var n=new $e(e.shape,"return float(isnan(x));");return this.compileAndRun(n,[e],"bool")},t.prototype.isInf=function(e){var n=new $e(e.shape,"return float(isinf(x));");return this.compileAndRun(n,[e],"bool")},t.prototype.isFinite=function(e){var n=new $e(e.shape,"return float(!isnan(x) && !isinf(x));");return this.compileAndRun(n,[e],"bool")},t.prototype.round=function(e){var n=new $e(e.shape,`
  // OpenGL ES does not support round function.
  // The algorithm is based on banker's rounding.
  float base = floor(x);
  if ((x - base) < 0.5) {
    return floor(x);
  } else if ((x - base) > 0.5) {
    return ceil(x);
  } else {
    if (mod(base, 2.0) == 0.0) {
      return base;
    } else {
      return base + 1.0;
    }
  }
`);return this.compileAndRun(n,[e])},t.prototype.exp=function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.exp(e);if(le().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,S_,e.dtype);var n=new $e(e.shape,S_);return this.compileAndRun(n,[e])},t.prototype.expm1=function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.expm1(e);if(le().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,E_,e.dtype);var n=new $e(e.shape,E_);return this.compileAndRun(n,[e])},t.prototype.softmax=function(e,n){var a=sn([n],e.shape),i=this.max(e,a),s=Jn(i.shape,a),l=this.subtract(e,i.reshape(s)),c=this.exp(l),f=this.sum(c,a).reshape(s);return this.realDivide(c,f)},t.prototype.log=function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.log(e);if(le().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,`
  vec4 result = log(x);
  vec4 isNaN = vec4(lessThan(x, vec4(0.0)));
  result.r = isNaN.r == 1.0 ? NAN : result.r;
  result.g = isNaN.g == 1.0 ? NAN : result.g;
  result.b = isNaN.b == 1.0 ? NAN : result.b;
  result.a = isNaN.a == 1.0 ? NAN : result.a;

  return result;
`,e.dtype);var n=new $e(e.shape,`if (x < 0.0) return NAN;
  return log(x);`);return this.compileAndRun(n,[e])},t.prototype.log1p=function(e){var n=new $e(e.shape,"return log(1.0 + x);");return this.compileAndRun(n,[e])},t.prototype.sqrt=function(e){var n=new $e(e.shape,"return sqrt(x);");return this.compileAndRun(n,[e])},t.prototype.rsqrt=function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.rsqrt(e);var n=new $e(e.shape,"return inversesqrt(x);");return this.compileAndRun(n,[e])},t.prototype.reciprocal=function(e){var n=new $e(e.shape,"return 1.0 / x;");return this.compileAndRun(n,[e])},t.prototype.relu=function(e){var n;return n=le().getBool("WEBGL_PACK")?new ic(e.shape,xC):new $e(e.shape,gC),this.compileAndRun(n,[e])},t.prototype.relu6=function(e){var n;return n=le().getBool("WEBGL_PACK")?new ic(e.shape,wC):new $e(e.shape,yC),this.compileAndRun(n,[e])},t.prototype.prelu=function(e,n){var a=le().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Ya(mC,e.shape,n.shape):new zt(vC,e.shape,n.shape);return this.compileAndRun(a,[e,n])},t.prototype.elu=function(e){if(le().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,_C,e.dtype);var n=new $e(e.shape,bC);return this.compileAndRun(n,[e])},t.prototype.eluDer=function(e,n){var a=le().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Ya(`
  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));
  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));
`,e.shape,n.shape):new zt("return (b >= 1.0) ? a : a * (b + 1.0);",e.shape,n.shape);return this.compileAndRun(a,[e,n])},t.prototype.selu=function(e){var n=new $e(e.shape,ZF);return this.compileAndRun(n,[e])},t.prototype.int=function(e){var n=new $e(e.shape,"return float(int(x));");return this.compileAndRun(n,[e],"int32")},t.prototype.clip=function(e,n,a){var i,s=(i=le().getBool("WEBGL_PACK_CLIP")?new NI(e.shape):new OI(e.shape)).getCustomSetupFunc(n,a);return this.compileAndRun(i,[e],null,s)},t.prototype.abs=function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.abs(e);if(le().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,b_,e.dtype);var n=new $e(e.shape,b_);return this.compileAndRun(n,[e])},t.prototype.complexAbs=function(e){var n=this.texData.get(e.dataId),a=new MI(e.shape),i=[this.makeComplexComponentTensorInfo(e,n.complexTensors.real),this.makeComplexComponentTensorInfo(e,n.complexTensors.imag)];return this.compileAndRun(a,i)},t.prototype.sigmoid=function(e){var n=new $e(e.shape,"return 1.0 / (1.0 + exp(-1.0 * x));");return this.compileAndRun(n,[e])},t.prototype.softplus=function(e){var n=new $e(e.shape,`
  float epsilon = 1.1920928955078125e-7;
  float threshold = log(epsilon) + 2.0;

  bool too_large = x > -threshold;
  bool too_small = x < threshold;

  float result;
  float exp_x = exp(x);

  if (too_large){
    result = x;
  }
  else if (too_small){
    result = exp_x;
  }
  else{
    result = log(exp_x + 1.0);
  }
  return result;
`);return this.compileAndRun(n,[e])},t.prototype.sin=function(e){var n=new $e(e.shape,QF);return this.compileAndRun(n,[e])},t.prototype.cos=function(e){var n=new $e(e.shape,JF);return this.compileAndRun(n,[e])},t.prototype.tan=function(e){var n=new $e(e.shape,"return tan(x);");return this.compileAndRun(n,[e])},t.prototype.asin=function(e){var n=new $e(e.shape,eB);return this.compileAndRun(n,[e])},t.prototype.acos=function(e){var n=new $e(e.shape,tB);return this.compileAndRun(n,[e])},t.prototype.atan=function(e){var n=new $e(e.shape,nB);return this.compileAndRun(n,[e])},t.prototype.atan2=function(e,n){var a=le().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Ya(`
  vec4 result = atan(a, b);
  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,e.shape,n.shape):new zt(`
  if (isnan(a)) return a;
  if (isnan(b)) return b;

  return atan(a, b);
`,e.shape,n.shape);return this.compileAndRun(a,[e,n])},t.prototype.sinh=function(e){var n=new $e(e.shape,`
  float e2x = exp(x);
  return (e2x - 1.0 / e2x) / 2.0;
`);return this.compileAndRun(n,[e])},t.prototype.cosh=function(e){var n=new $e(e.shape,`
  float e2x = exp(-x);
  return (e2x + 1.0 / e2x) / 2.0;
`);return this.compileAndRun(n,[e])},t.prototype.tanh=function(e){var n=new $e(e.shape,`
  float e2x = exp(-2.0 * abs(x));
  return sign(x) * (1.0 - e2x) / (1.0 + e2x);
`);return this.compileAndRun(n,[e])},t.prototype.asinh=function(e){var n=new $e(e.shape,rB);return this.compileAndRun(n,[e])},t.prototype.acosh=function(e){var n=new $e(e.shape,aB);return this.compileAndRun(n,[e])},t.prototype.atanh=function(e){var n=new $e(e.shape,iB);return this.compileAndRun(n,[e])},t.prototype.erf=function(e){var n=new $e(e.shape,`
  // Error function is calculated approximately with elementary function.
  // See "Handbook of Mathematical Functions with Formulas,
  // Graphs, and Mathematical Tables", Abramowitz and Stegun.
  float p = 0.3275911;
  float a1 = 0.254829592;
  float a2 = -0.284496736;
  float a3 = 1.421413741;
  float a4 = -1.453152027;
  float a5 = 1.061405429;

  float sign = sign(x);
  x = abs(x);
  float t = 1.0 / (1.0 + p * x);
  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));
`);return this.compileAndRun(n,[e])},t.prototype.step=function(e,n){var a=new $e(e.shape,function(i){return i===void 0&&(i=0),Jr+`
    return x > 0.0 ? 1.0 : float(`+i+`);
  `}(n));return this.compileAndRun(a,[e])},t.prototype.conv2dByMatMul=function(e,n,a,i,s,l){var c=e.shape,f=this.texData.get(e.dataId),d=a.inChannels,v=c[0]*c[1]*c[2],m=a.outChannels,g=a.dataFormat==="channelsLast",b=(v===1||m===1)&&d>1e3,w=c[2]%2!=0&&!!f.isPacked;if(b||!le().getBool("WEBGL_LAZILY_UNPACK")||!le().getBool("WEBGL_PACK_BINARY_OPERATIONS")||!w){var _=g?c[0]*c[1]*c[2]:c[0]*c[2]*c[3],S=this.reshape(e,[1,_,a.inChannels]),E=this.reshape(n,[1,a.inChannels,a.outChannels]);return this.reshape(this.fusedBatchMatMul({a:S,b:E,transposeA:!1,transposeB:!1,bias:i,activation:s,preluActivationWeights:l}),a.outShape)}var C=g?c[0]*c[1]*(c[2]+1):c[0]*c[2]*(c[3]+1),R={dataId:e.dataId,shape:[1,C,a.inChannels],dtype:e.dtype},T=f.shape;f.shape=f.shape.slice(),f.shape[f.shape.length-2]++,L(kh(f.shape,R.shape),function(){return"packed reshape "+f.shape+" to "+R.shape+" isn't free"});var D=this.reshape(n,[1,a.inChannels,a.outChannels]),k=this.fusedBatchMatMul({a:R,b:D,transposeA:!1,transposeB:!1,bias:i,activation:s,preluActivationWeights:l}),M=this.texData.get(k.dataId);return L(M.isPacked,function(){return"batchMatMul result is expected to be packed"}),f.shape=T,M.shape=a.outShape,q.makeTensorFromDataId(k.dataId,a.outShape,k.dtype)},t.prototype.conv2dWithIm2Row=function(e,n,a,i,s,l){var c=a.filterWidth,f=a.filterHeight,d=a.inChannels,v=a.outWidth,m=a.outHeight,g=a.dataFormat==="channelsLast",b=c*f*d,w=m*v,_=[b,w],S=e.squeeze([0]),E=n.reshape([1,b,-1]),C=new wF(_,S.shape,a),R=this.compileAndRun(C,[S]).reshape([1,_[0],_[1]]),T=i!=null,D=l!=null,k=s?Ih(s,!0):null,M=new ag(R.shape,[1,w,a.outChannels],!0,!1,T,k,D),N=[R,E];i&&N.push(i),D&&N.push(l);var I=this.compileAndRun(M,N);return g?I.reshape([1,m,v,a.outChannels]):I.reshape([1,a.outChannels,m,v])},t.prototype.fusedConv2d=function(e){var n=e.input,a=e.filter,i=e.convInfo,s=e.bias,l=e.activation,c=e.preluActivationWeights;if(i.filterHeight===1&&i.filterWidth===1&&i.dilationHeight===1&&i.dilationWidth===1&&i.strideHeight===1&&i.strideWidth===1&&(i.padInfo.type==="SAME"||i.padInfo.type==="VALID"))return this.conv2dByMatMul(n,a,i,s,l,c);if(le().getBool("WEBGL_CONV_IM2COL")&&n.shape[0]===1)return this.conv2dWithIm2Row(n,a,i,s,l,c);var f=s!=null,d=c!=null,v=l?Ih(l,!1):null,m=new c_(i,f,v,d),g=[n,a];return s&&g.push(s),c&&g.push(c),this.compileAndRun(m,g)},t.prototype.conv2d=function(e,n,a){if(a.filterHeight===1&&a.filterWidth===1&&a.dilationHeight===1&&a.dilationWidth===1&&a.strideHeight===1&&a.strideWidth===1&&(a.padInfo.type==="SAME"||a.padInfo.type==="VALID"))return this.conv2dByMatMul(e,n,a);if(le().getBool("WEBGL_CONV_IM2COL")&&e.shape[0]===1)return this.conv2dWithIm2Row(e,n,a);var i=new c_(a);return this.compileAndRun(i,[e,n])},t.prototype.conv2dDerInput=function(e,n,a){var i=new LI(a);return this.compileAndRun(i,[e,n])},t.prototype.conv2dDerFilter=function(e,n,a){var i=new BI(a);return this.compileAndRun(i,[e,n])},t.prototype.fusedDepthwiseConv2D=function(e){var n,a=e.input,i=e.filter,s=e.convInfo,l=e.bias,c=e.activation,f=e.preluActivationWeights,d=le().getBool("WEBGL_PACK_DEPTHWISECONV")&&s.strideWidth<=2&&s.outChannels/s.inChannels==1,v=c?Ih(c,d):null,m=[a,i],g=l!=null,b=f!=null;return g&&m.push(l),b&&m.push(f),d?(n=new h_(s,g,v,b),this.compileAndRun(n,m)):(n=new f_(s,g,v,b),this.compileAndRun(n,m))},t.prototype.depthwiseConv2D=function(e,n,a){var i;return le().getBool("WEBGL_PACK_DEPTHWISECONV")&&a.strideWidth<=2&&a.outChannels/a.inChannels==1?(i=new h_(a),this.compileAndRun(i,[e,n])):(i=new f_(a),this.compileAndRun(i,[e,n]))},t.prototype.depthwiseConv2DDerInput=function(e,n,a){var i=new VI(a);return this.compileAndRun(i,[e,n])},t.prototype.depthwiseConv2DDerFilter=function(e,n,a){var i=new UI(a);return this.compileAndRun(i,[e,n])},t.prototype.conv3d=function(e,n,a){var i=new HI(a);return this.compileAndRun(i,[e,n])},t.prototype.conv3dDerInput=function(e,n,a){var i=new zI(a);return this.compileAndRun(i,[e,n])},t.prototype.conv3dDerFilter=function(e,n,a){var i=new PI(a);return this.compileAndRun(i,[e,n])},t.prototype.maxPool=function(e,n){var a=new ig(n,"max",!1);return this.compileAndRun(a,[e])},t.prototype.avgPool=function(e,n){var a=new ig(n,"avg",!1);return this.compileAndRun(a,[e],"float32")},t.prototype.maxPoolBackprop=function(e,n,a,i){var s=new ig(i,"max",!0),l=this.compileAndRun(s,[n]),c=new CF(i),f=this.compileAndRun(c,[e,l],n.dtype);return l.dispose(),f},t.prototype.avgPoolBackprop=function(e,n,a){var i=new CI(a);return this.compileAndRun(i,[e],n.dtype)},t.prototype.cast=function(e,n){return oC(e,n,this)},t.prototype.unstack=function(e,n){for(var a=e.shape[n],i=new Array(e.rank-1),s=0,l=0;l<e.rank;l++)l!==n&&(i[s++]=e.shape[l]);var c=new Array(e.rank).fill(0),f=e.shape.slice();f[n]=1;var d=new Array(a);for(l=0;l<d.length;l++)c[n]=l,d[l]=this.slice(e,c,f).reshape(i);return d},t.prototype.avgPool3d=function(e,n){var a=new og(n,"avg",!1);return this.compileAndRun(a,[e],"float32")},t.prototype.avgPool3dBackprop=function(e,n,a){var i=new RI(a);return this.compileAndRun(i,[e],n.dtype)},t.prototype.maxPool3d=function(e,n){var a=new og(n,"max",!1);return this.compileAndRun(a,[e],"float32")},t.prototype.maxPool3dBackprop=function(e,n,a,i){var s=new og(i,"max",!0),l=this.compileAndRun(s,[n]),c=new RF(i),f=this.compileAndRun(c,[e,l],n.dtype);return l.dispose(),f},t.prototype.reshape=function(e,n){var a=this.texData.get(e.dataId);if(a.isPacked&&!kh(e.shape,n)&&(a.texture===null||!kh(a.shape,n))){var i=this.packedReshape(e,n);return q.makeTensorFromDataId(i.dataId,i.shape,i.dtype)}return hy(e,n)},t.prototype.resizeBilinear=function(e,n,a,i){var s=le().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new BF(e.shape,n,a,i):new FF(e.shape,n,a,i);return this.compileAndRun(s,[e],"float32")},t.prototype.resizeBilinearBackprop=function(e,n,a){var i=new IF(e,n,a);return this.compileAndRun(i,[e])},t.prototype.resizeNearestNeighbor=function(e,n,a,i){var s=new PF(e.shape,n,a,i);return this.compileAndRun(s,[e])},t.prototype.resizeNearestNeighborBackprop=function(e,n,a){var i=new LF(e,n,a);return this.compileAndRun(i,[e])},t.prototype.multinomial=function(e,n,a,i){var s=n?e:li(e),l=s.shape[0],c=s.shape[1],f=new TF(l,c,a),d=f.getCustomSetupFunc(i);return this.compileAndRun(f,[s],"int32",d)},t.prototype.oneHot=function(e,n,a,i){var s=new AF(e.size,n,a,i);return this.compileAndRun(s,[e])},t.prototype.diag=function(e){var n=new XI(e.size);return this.compileAndRun(n,[e])},t.prototype.nonMaxSuppression=function(e,n,a,i,s){return wd("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead"),$y(e.dataSync(),n.dataSync(),a,i,s)},t.prototype.cropAndResize=function(e,n,a,i,s,l){var c=new jI(e.shape,n.shape,i,s,l);return this.compileAndRun(c,[e,n,a],"float32")},t.prototype.depthToSpace=function(e,n,a){L(n>1,function(){return"blockSize should be > 1 for depthToSpace, but was: "+n});var i=e.shape[0],s=a==="NHWC"?e.shape[1]:e.shape[2],l=a==="NHWC"?e.shape[2]:e.shape[3],c=a==="NHWC"?e.shape[3]:e.shape[1],f=s*n,d=l*n,v=c/(n*n),m=new KI(a==="NHWC"?[i,f,d,v]:[i,v,f,d],n,a);return this.compileAndRun(m,[e])},t.prototype.split=function(e,n,a){return lC(e,n,a)},t.prototype.scatterND=function(e,n,a){var i=Td(0,e,a),s=i.sliceRank,l=i.numUpdates,c=i.sliceSize,f=i.strides,d=i.outputSize,v=[d/c,c],m=e.reshape([l,s]),g=n.reshape([l,c]);if(d===0)return hy(Sn([]),a);var b=ye(0),w=new m_(l,s,m.rank,g.rank,f,v);return this.compileAndRun(w,[g,m,b]).reshape(a)},t.prototype.sparseToDense=function(e,n,a,i){var s=Td(0,e,a),l=s.sliceRank,c=s.numUpdates,f=s.strides,d=s.outputSize,v=new m_(c,l,e.rank,n.rank,f,[d,1]);return this.compileAndRun(v,[n,e,i]).reshape(a)},t.prototype.fft=function(e){return this.fftImpl(e,!1)},t.prototype.ifft=function(e){return this.fftImpl(e,!0)},t.prototype.fftImpl=function(e,n){var a=this.texData.get(e.dataId),i=new p_(JI,e.shape,n),s=new p_(eF,e.shape,n),l=[this.makeComplexComponentTensorInfo(e,a.complexTensors.real),this.makeComplexComponentTensorInfo(e,a.complexTensors.imag)],c=this.compileAndRun(i,l),f=this.compileAndRun(s,l),d=this.complex(c,f).as2D(e.shape[0],e.shape[1]);return c.dispose(),f.dispose(),d},t.prototype.gatherND=function(e,n){var a=n.shape,i=a[a.length-1],s=JE(e,n),l=s[0],c=s[1],f=s[2],d=s[3],v=n.reshape([c,i]),m=e.reshape([e.size/f,f]),g=new rF(i,d,[c,f]);return this.compileAndRun(g,[m,v]).reshape(l)},t.prototype.fill=function(e,n,a){if((a=a||Zc(n))==="string"){var i=gd(a,Te(e));return i.fill(n),q.makeTensor(i,e,a,this)}var s=new tF(e,n),l=s.getCustomSetupFunc(n);return this.compileAndRun(s,[],a,l)},t.prototype.onesLike=function(e){if(e.dtype==="string")throw new Error("onesLike is not supported under string dtype");return this.fill(e.shape,1,e.dtype)},t.prototype.zerosLike=function(e){return this.fill(e.shape,e.dtype==="string"?"":0,e.dtype)},t.prototype.linspace=function(e,n,a){return sC(e,n,a)},t.prototype.makeTensorInfo=function(e,n){var a=this.write(null,e,n);return this.texData.get(a).usage=null,{dataId:a,shape:e,dtype:n}},t.prototype.makeOutput=function(e,n){var a=this.makeTensorInfo(e,n).dataId;return q.makeTensorFromDataId(a,e,n,this)},t.prototype.unpackTensor=function(e){var n=new sB(e.shape);return this.runWebGLProgram(n,[e],e.dtype)},t.prototype.packTensor=function(e){var n=new DF(e.shape);return this.runWebGLProgram(n,[e],e.dtype,null,!0)},t.prototype.packedReshape=function(e,n){var a=[bd(e.shape)].concat(xd(e.shape)),i={dtype:e.dtype,shape:a,dataId:e.dataId},s=[bd(n)].concat(xd(n)),l=new MF(s,a),c=this.runWebGLProgram(l,[i],e.dtype,null,!0);return{dataId:c.dataId,shape:n,dtype:c.dtype}},t.prototype.decode=function(e){var n,a=this.texData.get(e),i=a.isPacked,s=a.shape,l=a.dtype,c=eg(s);return n=i?new qI(c):new GI(c),{dtype:l,shape:s,dataId:this.runWebGLProgram(n,[{shape:c,dtype:l,dataId:e}],l,null,!0).dataId}},t.prototype.runWebGLProgram=function(e,n,a,i,s){var l=this;s===void 0&&(s=!1);var c=this.makeTensorInfo(e.outputShape,a),f=this.texData.get(c.dataId);if(e.packedOutput&&(f.isPacked=!0),e.outPackingScheme===Fc.DENSE){var d=dc(e.outputShape);f.texShape=d.map(function(C){return 2*C})}if(e.outTexUsage!=null&&(f.usage=e.outTexUsage),Te(c.shape)===0)return f.values=Mc(c.dtype,0),c;var v=[],m=n.map(function(C){if(C.dtype==="complex64")throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");var R=l.texData.get(C.dataId);if(R.texture==null){if(!e.packedInputs&&Te(C.shape)<=le().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:C.shape,texData:null,isUniform:!0,uniformValues:R.values};e.packedInputs&&(R.isPacked=!0,R.shape=C.shape)}else if(!!R.isPacked!=!!e.packedInputs)C=R.isPacked?l.unpackTensor(C):l.packTensor(C),v.push(C),R=l.texData.get(C.dataId);else if(R.isPacked&&!kh(R.shape,C.shape)){var T=C,D=C.shape;C.shape=R.shape,C=l.packedReshape(C,D),v.push(C),R=l.texData.get(C.dataId),T.shape=D}return l.uploadToGPU(C.dataId),{shape:C.shape,texData:R,isUniform:!1}});this.uploadToGPU(c.dataId);var g,b={shape:c.shape,texData:f,isUniform:!1},w=function(C,R,T){var D="";R.concat(T).forEach(function(N){var I=N.texData!=null&&N.texData.slice!=null&&N.texData.slice.flatOffset>0,z=N.isUniform?"uniform":N.texData.texShape;D+=N.shape+"_"+z+"_"+I});var k=C.userCode,M=C.constructor.name;return M+="_"+D+"_"+k}(e,m,b),_=this.getAndSaveBinary(w,function(){return function(C,R,T,D){var k=R.userCode,M=T.map(function(X,J){var F={logicalShape:X.shape,texShape:X.isUniform?null:X.texData.texShape,isUniform:X.isUniform,isPacked:!X.isUniform&&X.texData.isPacked,flatOffset:null};return X.texData!=null&&X.texData.slice!=null&&X.texData.slice.flatOffset>0&&(F.flatOffset=X.texData.slice.flatOffset),{name:R.variableNames[J],shapeInfo:F}}),N=M.map(function(X){return X.shapeInfo}),I={logicalShape:D.shape,texShape:D.texData.texShape,isUniform:!1,isPacked:D.texData.isPacked,flatOffset:null},z=bI(M,I,k,R.packedInputs),P=C.createProgram(z),ne=null,re=C.getUniformLocation(P,"NAN",!1);le().getNumber("WEBGL_VERSION")===1&&(ne=C.getUniformLocation(P,"INFINITY",!1));for(var ee={},U=0;U<R.variableNames.length;U++){var G=R.variableNames[U];ee[G]=C.getUniformLocation(P,G,!1),ee["offset"+G]=C.getUniformLocation(P,"offset"+G,!1)}return{program:R,source:z,webGLProgram:P,uniformLocations:ee,inShapeInfos:N,outShapeInfo:I,infLoc:ne,nanLoc:re}}(l.gpgpu,e,m,b)}),S=this.activeTimers!=null;if(S&&(g=this.startTimer()),function(C,R,T,D,k){v_(R.inShapeInfos,T),v_([R.outShapeInfo],[D]);var M=D.texData.texture,N=D.texData.texShape;D.texData.isPacked?C.setOutputPackedMatrixTexture(M,N[0],N[1]):C.setOutputMatrixTexture(M,N[0],N[1]),C.setProgram(R.webGLProgram),le().getNumber("WEBGL_VERSION")===1&&R.infLoc!==null&&C.gl.uniform1f(R.infLoc,1/0),R.nanLoc!==null&&C.gl.uniform1f(R.nanLoc,NaN),T.forEach(function(I,z){var P=R.program.variableNames[z],ne=R.uniformLocations[P],re=R.uniformLocations["offset"+P];if(ne!=null)if(I.isUniform)if(Te(I.shape)<2)C.gl.uniform1f(ne,I.uniformValues[0]);else{var ee=I.uniformValues;ee instanceof Float32Array||(ee=new Float32Array(ee)),C.gl.uniform1fv(ne,ee)}else I.texData.slice!=null&&re!=null&&C.gl.uniform1i(re,I.texData.slice.flatOffset),C.setInputMatrixTexture(I.texData.texture,ne,z)}),k!=null&&k(C,R.webGLProgram),C.executeProgram()}(this.gpgpu,_,m,b,i),v.forEach(function(C){return l.disposeData(C.dataId)}),S&&(g=this.endTimer(g),this.activeTimers.push({name:e.constructor.name,query:this.getQueryTime(g)})),!le().getBool("WEBGL_LAZILY_UNPACK")&&f.isPacked&&s===!1){var E=this.unpackTensor(c);return this.disposeData(c.dataId),E}return c},t.prototype.compileAndRun=function(e,n,a,i,s){s===void 0&&(s=!1),a=a||n[0].dtype;var l=this.runWebGLProgram(e,n,a,i,s);return q.makeTensorFromDataId(l.dataId,l.shape,l.dtype)},t.prototype.getAndSaveBinary=function(e,n){return e in this.binaryCache||(this.binaryCache[e]=n()),this.binaryCache[e]},t.prototype.getTextureManager=function(){return this.textureManager},t.prototype.dispose=function(){var e=this;this.disposed||(le().getBool("IS_TEST")||Object.keys(this.binaryCache).forEach(function(n){e.gpgpu.deleteProgram(e.binaryCache[n].webGLProgram),delete e.binaryCache[n]}),this.textureManager.dispose(),this.canvas!=null&&typeof HTMLCanvasElement<"u"&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0)},t.prototype.floatPrecision=function(){var e=this;return this.floatPrecisionValue==null&&(this.floatPrecisionValue=Se(function(){if(!le().get("WEBGL_RENDER_FLOAT32_ENABLED")){var n=le().getBool("DEBUG");le().set("DEBUG",!1);var a=e.abs(ye(1e-8)).dataSync()[0];if(le().set("DEBUG",n),a>0)return 32}return 16})),this.floatPrecisionValue},t.prototype.epsilon=function(){return this.floatPrecision()===32?1e-7:1e-4},t.prototype.uploadToGPU=function(e){var n,a=this.texData.get(e),i=a.shape,s=a.dtype,l=a.values,c=a.texture,f=a.usage,d=a.isPacked;if(c==null){var v,m=this.activeTimers!=null;m&&(v=da());var g=a.texShape;if(g==null&&(g=vM(i,d),a.texShape=g),l!=null){var b=eg(i),w=void 0,_=g[1],S=g[0],E=l instanceof Uint8Array;d?(_=(n=Jc(g[0],g[1]))[0],S=n[1],w=new QI(b,[S,_],E)):w=new ZI(b,[S,_],E);var C=this.makeTensorInfo([S,_],s);this.texData.get(C.dataId).usage=E?fr.PIXELS:fr.UPLOAD,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(C.dataId),_,S,l);var R=this.runWebGLProgram(w,[C],s,null,!0),T=this.texData.get(R.dataId);a.texture=T.texture,a.texShape=T.texShape,a.isPacked=T.isPacked,a.usage=T.usage,this.disposeData(C.dataId),this.texData.delete(R.dataId),a.values=null,m&&(this.uploadWaitMs+=da()-v)}else{var D=this.acquireTexture(g,f,s,d);a.texture=D}}},t.prototype.convertAndCacheOnCPU=function(e,n){var a=this.texData.get(e),i=a.dtype;return this.releaseGPUData(e),n!=null&&(a.values=function(s,l){if(l==="float32"||l==="complex64")return s;if(l==="int32"||l==="bool"){for(var c=l==="int32"?new Int32Array(s.length):new Uint8Array(s.length),f=0;f<c.length;++f)c[f]=Math.round(s[f]);return c}throw new Error("Unknown dtype "+l)}(n,i)),a.values},t.prototype.acquireTexture=function(e,n,a,i){if(this.numBytesInGPU+=this.computeBytes(e,a),!this.warnedAboutMemory&&this.numBytesInGPU>1024*this.numMBBeforeWarning*1024){var s=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn("High memory usage in GPU: "+s+" MB, most likely due to a memory leak")}return this.textureManager.acquireTexture(e,n,i)},t.prototype.computeBytes=function(e,n){return e[0]*e[1]*FE(n)},t}(aC);HE()&&q.registerBackend("webgl",function(){return new lB},2);var cB=j({square_:function(r){var t=B(r,"x","square"),e=[t];return q.runKernelFunc(function(n,a){return a([t]),n.square(t)},{x:t},null,"Square",{},e,[])}}),Lc="SquaredDifference",SC=j({squaredDifference_:function(r,t){var e,n=B(r,"a","squaredDifference"),a=B(t,"b","squaredDifference");e=Bt(n,a),n=e[0],a=e[1],it(n.shape,a.shape);var i={a:n,b:a},s=[n,a];return q.runKernelFunc(function(l,c){var f=l.squaredDifference(n,a);return c([n,a]),f},i,function(l,c){var f=c[0],d=c[1],v=ye(2);return{a:function(){return l.mul(f.sub(d).mul(v))},b:function(){return l.mul(d.sub(f).mul(v))}}},Lc,{},s,[])}}),fB=j({abs_:function(r){var t=B(r,"x","abs");return t.dtype==="complex64"?q.runKernelFunc(function(e){return e.complexAbs(t)},{$x:t}):q.runKernelFunc(function(e,n){var a=e.abs(t);return n([t]),a},{x:t},function(e,n){var a=n[0];return{x:function(){return e.mul(a.toFloat().step(-1))}}},"Abs")}}),hB=j({acos_:function(r){var t=B(r,"x","acos");return q.runKernelFunc(function(e,n){var a=e.acos(t);return n([t]),a},{$x:t},function(e,n){var a=n[0];return{$x:function(){return e.divStrict(ye(1).sub(a.toFloat().square()).sqrt()).neg()}}})}}),dB=j({acosh_:function(r){var t=B(r,"x","acosh");return q.runKernelFunc(function(e,n){var a=e.acosh(t);return n([t]),a},{$x:t},function(e,n){var a=n[0];return{$x:function(){return e.divStrict(a.toFloat().square().sub(1).sqrt())}}})}}),pB=j({asin_:function(r){var t=B(r,"x","asin");return q.runKernelFunc(function(e,n){var a=e.asin(t);return n([t]),a},{$x:t},function(e,n){var a=n[0];return{$x:function(){return e.divStrict(ye(1).sub(a.toFloat().square()).sqrt())}}})}}),vB=j({asinh_:function(r){var t=B(r,"x","asinh");return q.runKernelFunc(function(e,n){var a=e.asinh(t);return n([t]),a},{$x:t},function(e,n){var a=n[0];return{$x:function(){return e.divStrict(ye(1).add(a.toFloat().square()).sqrt())}}})}}),mB=j({atan_:function(r){var t=B(r,"x","atan");return q.runKernelFunc(function(e,n){var a=e.atan(t);return n([t]),a},{$x:t},function(e,n){var a=n[0];return{$x:function(){return e.div(a.toFloat().square().add(1))}}})}}),gB=j({atanh_:function(r){var t=B(r,"x","atanh");return q.runKernelFunc(function(e,n){var a=e.atanh(t);return n([t]),a},{$x:t},function(e,n){var a=n[0];return{$x:function(){return e.div(ye(1).sub(a.toFloat().square()))}}})}}),yB=j({ceil_:function(r){var t=B(r,"x","ceil");return q.runKernelFunc(function(e){return e.ceil(t)},{$x:t},function(e){return{$x:function(){return lt(e)}}})}}),t0=j({clipByValue_:function(r,t,e){var n=B(r,"x","clipByValue");L(t<=e,function(){return"Error in clip: min ("+t+") must be less than or equal to max ("+e+")."});var a=[n],i={min:t,max:e};return q.runKernelFunc(function(s,l){var c=s.clip(n,t,e);return l([n]),c},{x:n},function(s,l){var c=l[0];return{x:function(){return s.where(c.greaterEqual(t).logicalAnd(c.lessEqual(e)),lt(s))}}},"ClipByValue",i,a)}}),bB=j({cos_:function(r){var t=B(r,"x","cos"),e=[t];return q.runKernelFunc(function(n,a){var i=n.cos(t);return a([t]),i},{x:t},function(n,a){var i=a[0];return{x:function(){return i.toFloat().sin().neg().mul(n)}}},"Cos",{},e)}}),xB=j({cosh_:function(r){var t=B(r,"x","cosh");return q.runKernelFunc(function(e,n){var a=e.cosh(t);return n([t]),a},{$x:t},function(e,n){var a=n[0];return{$x:function(){return a.toFloat().sinh().mulStrict(e)}}})}}),wB=j({erf_:function(r){var t=B(r,"x","erf");return L(t.dtype==="int32"||t.dtype==="float32",function(){return"Input dtype must be `int32` or `float32`."}),t.dtype==="int32"&&(t=t.toFloat()),q.runKernelFunc(function(e,n){var a=e.erf(t);return n([t]),a},{$x:t},function(e,n){var a=n[0];return{$x:function(){return e.mul(a.square().neg().exp().mul(2/Math.sqrt(Math.PI)))}}})}}),py=j({exp_:function(r){var t=B(r,"x","exp");return q.runKernelFunc(function(e,n){var a=e.exp(t);return n([a]),a},{x:t},function(e,n){return{x:function(){return e.mulStrict(n[0])}}},"Exp",{},[],[!0])}}),_B=j({expm1_:function(r){var t=B(r,"x","expm1");return q.runKernelFunc(function(e,n){var a=e.expm1(t);return n([t]),a},{$x:t},function(e,n){var a=n[0];return{$x:function(){return e.mul(a.exp())}}})}}),SB=j({floor_:function(r){var t=B(r,"x","floor");return q.runKernelFunc(function(e){return e.floor(t)},{$x:t},function(e){return{$x:function(){return lt(e)}}})}}),EB=j({log_:function(r){var t=B(r,"x","log"),e=[t];return q.runKernelFunc(function(n,a){var i=n.log(t);return a([t]),i},{x:t},function(n,a){var i=a[0];return{x:function(){return n.div(i.toFloat())}}},"Log",{},e)}}),CB=j({log1p_:function(r){var t=B(r,"x","log1p");return q.runKernelFunc(function(e,n){var a=e.log1p(t);return n([t]),a},{$x:t},function(e,n){var a=n[0];return{$x:function(){return e.div(a.add(1))}}})}}),RB=j({logSigmoid_:function(r){var t=B(r,"x","logSigmoid");return q.runKernelFunc(function(e,n){var a=e.softplus(t.neg()).neg();return n([t]),a},{$x:t},function(e,n){var a=n[0];return{$x:function(){return e.mul(a.neg().sigmoid())}}})}}),Od=j({neg_:function(r){var t=B(r,"x","neg"),e=[t];return q.runKernelFunc(function(n){return n.neg(t)},{x:t},function(n){return{x:function(){return n.neg()}}},"Neg",{},e)}}),TB=j({reciprocal_:function(r){var t=B(r,"x","reciprocal");return q.runKernelFunc(function(e,n){var a=e.reciprocal(t);return n([t]),a},{$x:t},function(e,n){var a=n[0];return{$x:function(){return e.div(a.square().neg())}}})}}),AB=j({round_:function(r){var t=B(r,"x","round");return q.runKernelFunc(function(e){return e.round(t)},{$x:t},function(e){return{$x:function(){return lt(e)}}})}}),EC=j({rsqrt_:function(r){var t=B(r,"x","rsqrt"),e=[t];return q.runKernelFunc(function(n,a){var i=n.rsqrt(t);return a([t]),i},{x:t},function(n,a){var i=a[0];return{x:function(){return n.div(i.pow(1.5).mul(2)).neg()}}},"Rsqrt",{},e)}}),CC=j({sigmoid_:function(r){var t=B(r,"x","sigmoid");return q.runKernelFunc(function(e,n){var a=e.sigmoid(t);return n([a]),a},{x:t},function(e,n){var a=n[0];return{x:function(){return e.mul(a.mul(ye(1).sub(a)))}}},"Sigmoid")}}),DB=j({sign_:function(r){var t=B(r,"x","sign");return q.runKernelFunc(function(e){return e.sign(t)},{$x:t},function(e){return{$x:function(){return lt(e)}}})}}),kB=j({isNaN_:function(r){var t=B(r,"x","isNaN");return q.runKernelFunc(function(e){return e.isNaN(t)},{$x:t},function(e){return{$x:function(){return lt(e)}}})}}),OB=j({isInf_:function(r){var t=B(r,"x","isInf");return q.runKernelFunc(function(e){return e.isInf(t)},{$x:t},function(e){return{$x:function(){return lt(e)}}})}}),NB=j({isFinite_:function(r){var t=B(r,"x","isFinite");return q.runKernelFunc(function(e){return e.isFinite(t)},{$x:t},function(e){return{$x:function(){return lt(e)}}})}}),MB=j({sin_:function(r){var t=B(r,"x","sin"),e=[t];return q.runKernelFunc(function(n,a){var i=n.sin(t);return a([t]),i},{x:t},function(n,a){var i=a[0];return{x:function(){return i.toFloat().cos().mul(n)}}},"Sin",{},e)}}),IB=j({sinh_:function(r){var t=B(r,"x","sinh");return q.runKernelFunc(function(e,n){var a=e.sinh(t);return n([t]),a},{$x:t},function(e,n){var a=n[0];return{$x:function(){return a.toFloat().cosh().mulStrict(e)}}})}}),FB=j({softplus_:function(r){var t=B(r,"x","softplus");return q.runKernelFunc(function(e,n){var a=e.softplus(t);return n([t]),a},{$x:t},function(e,n){var a=n[0];return{$x:function(){return e.mul(a.sigmoid())}}})}}),BB=j({sqrt_:function(r){var t=B(r,"x","sqrt");return q.runKernelFunc(function(e,n){var a=e.sqrt(t);return n([t]),a},{$x:t},function(e,n){var a=n[0];return{$x:function(){return e.div(a.toFloat().sqrt().mul(2))}}})}}),LB=j({step_:function(r,t){t===void 0&&(t=0);var e=B(r,"x","step");return q.runKernelFunc(function(n){return n.step(e,t)},{$x:e},function(n){return{$x:function(){return lt(n)}}})}}),PB=j({tan_:function(r){var t=B(r,"x","tan");return q.runKernelFunc(function(e,n){var a=e.tan(t);return n([t]),a},{$x:t},function(e,n){var a=n[0];return{$x:function(){return e.div(a.cos().square())}}})}}),zB=j({tanh_:function(r){var t=B(r,"x","tanh");return q.runKernelFunc(function(e,n){var a=e.tanh(t);return n([a]),a},{x:t},function(e,n){var a=n[0];return{x:function(){return ye(1).sub(a.square()).mulStrict(e)}}},"Tanh",{},null,[!0])}});function RC(r,t,e,n,a,i){var s,l,c=B(r,"x","batchNorm"),f=B(t,"mean","batchNorm"),d=B(e,"variance","batchNorm");return a!=null&&(s=B(a,"scale","batchNorm")),n!=null&&(l=B(n,"offset","batchNorm")),L(c.rank===2,function(){return"Error in batchNorm3D: x must be rank 3 but got rank "+c.rank+"."}),L(f.rank===2||f.rank===1,function(){return"Error in batchNorm2D: mean must be rank 2 or rank 1 but got rank "+f.rank+"."}),L(d.rank===2||d.rank===1,function(){return"Error in batchNorm2D: variance must be rank 2 or rank 1 but got rank "+d.rank+"."}),s!=null&&L(s.rank===2||s.rank===1,function(){return"Error in batchNorm2D: scale must be rank 2 or rank 1 but got rank "+s.rank+"."}),l!=null&&L(l.rank===2||l.rank===1,function(){return"Error in batchNorm2D: offset must be rank 2 or rank 1 but got rank "+l.rank+"."}),tf(c,f,d,l,s,i)}function TC(r,t,e,n,a,i){var s,l,c=B(r,"x","batchNorm"),f=B(t,"mean","batchNorm"),d=B(e,"variance","batchNorm");return a!=null&&(s=B(a,"scale","batchNorm")),n!=null&&(l=B(n,"offset","batchNorm")),L(c.rank===3,function(){return"Error in batchNorm3D: x must be rank 3 but got rank "+c.rank+"."}),L(f.rank===3||f.rank===1,function(){return"Error in batchNorm3D: mean must be rank 3 or rank 1 but got rank "+f.rank+"."}),L(d.rank===3||d.rank===1,function(){return"Error in batchNorm3D: variance must be rank 3 or rank 1 but got rank "+d.rank+"."}),s!=null&&L(s.rank===3||s.rank===1,function(){return"Error in batchNorm3D: scale must be rank 3 or rank 1 but got rank "+s.rank+"."}),l!=null&&L(l.rank===3||l.rank===1,function(){return"Error in batchNorm3D: offset must be rank 3 or rank 1 but got rank "+l.rank+"."}),tf(c,f,d,l,s,i)}function AC(r,t,e,n,a,i){var s,l,c=B(r,"x","batchNorm"),f=B(t,"mean","batchNorm"),d=B(e,"variance","batchNorm");return a!=null&&(s=B(a,"scale","batchNorm")),n!=null&&(l=B(n,"offset","batchNorm")),L(c.rank===4,function(){return"Error in batchNorm4D: x must be rank 4 but got rank "+c.rank+"."}),L(f.rank===4||f.rank===1,function(){return"Error in batchNorm4D: mean must be rank 4 or rank 1 but got rank "+f.rank+"."}),L(d.rank===4||d.rank===1,function(){return"Error in batchNorm4D: variance must be rank 4 or rank 1 but got rank "+d.rank+"."}),s!=null&&L(s.rank===4||s.rank===1,function(){return"Error in batchNorm4D: scale must be rank 4 or rank 1 but got rank "+s.rank+"."}),l!=null&&L(l.rank===4||l.rank===1,function(){return"Error in batchNorm4D: offset must be rank 4 or rank 1 but got rank "+l.rank+"."}),tf(c,f,d,l,s,i)}function tf(r,t,e,n,a,i){i==null&&(i=.001);var s,l,c,f=B(r,"x","batchNorm"),d=B(t,"mean","batchNorm"),v=B(e,"variance","batchNorm");a!=null&&(s=B(a,"scale","batchNorm")),n!=null&&(l=B(n,"offset","batchNorm")),L(d.rank===v.rank,function(){return"Batch normalization gradient requires mean and variance to have equal ranks."}),L(l==null||d.rank===l.rank,function(){return"Batch normalization gradient requires mean and offset to have equal ranks."}),L(s==null||d.rank===s.rank,function(){return"Batch normalization gradient requires mean and scale to have equal ranks."}),c=f.rank===0||f.rank===1?f.as4D(1,1,1,f.size):f.rank===2?f.as4D(1,1,f.shape[0],f.shape[1]):f.rank===3?f.as4D(1,f.shape[0],f.shape[1],f.shape[2]):f;var m=[f,d,v,s];return q.runKernelFunc(function(g,b){var w=g.batchNormalization(c,Fh(d),Fh(v),i,Fh(s),Fh(l));return b([f,d,v,s]),w},{x:f,mean:d,variance:v,scale:s,offset:l},function(g,b){var w=b,_=w[0],S=w[1],E=w[2],C=w[3],R=C??ye(1),T=an(S.shape,c.shape),D=[];if(S.rank===1){for(var k=0;k<c.shape.length-1;++k)D.push(c.shape[k]);D.push(1)}var M=_.sub(S),N=g.mul(R),I=EC(E.add(ye(i))),z=I.mul(I).mul(I).mul(ye(-.5));return{x:function(){return S.rank===1?g.mul(gu(I.as4D(1,1,1,S.shape[0]),D)).mul(R).reshape(_.shape):g.mul(I).mul(R).reshape(_.shape)},mean:function(){var P=I.mul(ye(-1)).mul(N);return S.rank===1&&(P=P.sum(T)),P.reshape(S.shape)},variance:function(){var P=z.mul(M).mul(N);return S.rank===1&&(P=P.sum(T)),P.reshape(S.shape)},scale:function(){var P=M.mul(I),ne=g.mul(P);return S.rank===1&&(ne=ne.sum(T)),ne.reshape(S.shape)},offset:function(){var P=g;return S.rank===1&&(P=P.sum(T)),P.reshape(S.shape)}}},"BatchNormalization",{varianceEpsilon:i},m).reshape(f.shape)}function Fh(r){return r==null?null:r.rank===0?r.as1D():r.rank===1?r:r.rank===2?r.as4D(1,1,r.shape[0],r.shape[1]):r.rank===3?r.as4D(1,r.shape[0],r.shape[1],r.shape[2]):r}function Zd(){jE("tf.batchNormalization() is going away. Use tf.batchNorm() instead, and note the positional argument change of scale, offset, and varianceEpsilon")}var UB=j({batchNormalization2d_:function(r,t,e,n,a,i){return n===void 0&&(n=.001),Zd(),RC(r,t,e,i,a,n)}}),VB=j({batchNormalization3d_:function(r,t,e,n,a,i){return n===void 0&&(n=.001),Zd(),TC(r,t,e,i,a,n)}}),HB=j({batchNormalization4d_:function(r,t,e,n,a,i){return n===void 0&&(n=.001),Zd(),AC(r,t,e,i,a,n)}}),jB=j({batchNormalization_:function(r,t,e,n,a,i){return n===void 0&&(n=.001),Zd(),tf(r,t,e,i,a,n)}}),DC=j({batchNorm_:tf}),WB=j({batchNorm2d_:RC}),GB=j({batchNorm3d_:TC}),qB=j({batchNorm4d_:AC}),Qd=j({logicalAnd_:function(r,t){var e=B(r,"a","logicalAnd","bool"),n=B(t,"b","logicalAnd","bool");return it(e.shape,n.shape),q.runKernelFunc(function(a){return a.logicalAnd(e,n)},{a:e,b:n},null,"LogicalAnd")}}),KB=j({logicalNot_:function(r){var t=B(r,"x","logicalNot","bool");return q.runKernelFunc(function(e){return e.logicalNot(t)},{$x:t})}}),kC=j({logicalOr_:function(r,t){var e=B(r,"a","logicalOr","bool"),n=B(t,"b","logicalOr","bool");return it(e.shape,n.shape),q.runKernelFunc(function(a){return a.logicalOr(e,n)},{$a:e,$b:n})}}),XB=j({logicalXor_:function(r,t){var e=B(r,"a","logicalXor","bool"),n=B(t,"b","logicalXor","bool");return it(e.shape,n.shape),kC(r,t).logicalAnd(Qd(r,t).logicalNot())}}),us=j({where_:function(r,t,e){var n=B(t,"a","where"),a=B(e,"b","where"),i=B(r,"condition","where","bool");return gt(n.shape,a.shape,"Error in where: "),i.rank===1?L(i.shape[0]===n.shape[0],function(){return"The first dimension of `a` must match the size of `condition`."}):gt(i.shape,a.shape,"Error in where: "),q.runKernelFunc(function(s,l){var c=s.select(i,n,a);return l([i]),c},{$condition:i,$a:n,$b:a},function(s,l){var c=l[0];return{$condition:function(){return lt(c).toFloat()},$a:function(){return s.mul(c.cast(s.dtype))},$b:function(){return s.mul(c.logicalNot().cast(s.dtype))}}})}}),OC=function(r){return Ce(this,void 0,void 0,function(){var t,e,n;return Re(this,function(a){switch(a.label){case 0:return[4,(t=B(r,"condition","whereAsync","bool")).data()];case 1:return e=a.sent(),n=Zy(t.shape,e),r!==t&&t.dispose(),[2,n]}})})},nt=j({add_:function(r,t){var e,n=B(r,"a","add"),a=B(t,"b","add");e=Bt(n,a),n=e[0],a=e[1];var i=it(n.shape,a.shape);return q.runKernelFunc(function(s){return s.add(n,a)},{a:n,b:a},function(s){return{a:function(){var l=s,c=an(n.shape,i);return c.length>0&&(l=l.sum(c)),l.reshape(n.shape)},b:function(){var l=s,c=an(a.shape,i);return c.length>0&&(l=l.sum(c)),l.reshape(a.shape)}}},"Add")}}),$B=j({addN_:function(r){L(Array.isArray(r),function(){return"The argument passed to tf.addN() must be a list of tensors"}),L(r.length>=1,function(){return"Must pass at least one tensor to tf.addN(), but got "+r.length});var t=r.map(function(a,i){return B(a,"tensors"+i,"addN")}),e=t[0];t.forEach(function(a){if(a.dtype!==e.dtype)throw new Error("All tensors passed to tf.addN() must have the same dtype")}),t.forEach(function(a){if(!vn(a.shape,e.shape))throw new Error("All tensors passed to tf.addN() must have the same shape")});var n=t;return q.runKernelFunc(function(a){return a.addN(t)},n,function(a){var i={};return t.forEach(function(s,l){i[l]=function(){return a.clone()}}),i},"AddN")}}),YB=j({addStrict_:function(r,t){var e=B(r,"a","addStrict"),n=B(t,"b","addStrict");return gt(e.shape,n.shape,"Error in addStrict: "),e.add(n)}}),ZB=j({atan2_:function(r,t){var e,n=B(r,"a","atan2"),a=B(t,"b","atan2");e=Bt(n,a),n=e[0],a=e[1];var i=it(n.shape,a.shape);return q.runKernelFunc(function(s,l){var c=s.atan2(n,a);return l([n,a]),c},{$a:n,$b:a},function(s,l){var c=l[0],f=l[1];return{$a:function(){var d=nt(c.square(),f.square()),v=s.mul(f.div(d)),m=an(c.shape,i);return m.length>0&&(v=v.sum(m)),v.reshape(c.shape)},$b:function(){var d=nt(c.square(),f.square()),v=Od(s.mul(c.div(d))),m=an(f.shape,i);return m.length>0&&(v=v.sum(m)),v.reshape(f.shape)}}})}}),Wr=j({div_:function(r,t){var e,n=B(r,"a","div"),a=B(t,"b","div");if(e=Bt(n,a),n=e[0],a=e[1],n.dtype==="int32"&&a.dtype==="int32")return NC(n,a);var i=it(n.shape,a.shape);return q.runKernelFunc(function(s,l){var c=s.realDivide(n,a);return l([n,a]),c},{a:n,b:a},function(s,l){var c=l[0],f=l[1];return{a:function(){var d=s.div(f.toFloat()),v=an(c.shape,i);return v.length>0?d.sum(v).reshape(c.shape):d},b:function(){var d=s.mul(c.toFloat()),v=an(f.shape,i);v.length>0&&(d=d.sum(v).reshape(f.shape));var m=f.square();return d.div(m.toFloat()).neg()}}},"Div")}}),QB=j({divNoNan_:function(r,t){var e,n=B(r,"a","div"),a=B(t,"b","div");n=(e=Bt(n,a))[0],a=e[1];var i=Wr(n,a),s=lt(i),l=a.equal(s);return us(l,s,i)}}),JB=j({divStrict_:function(r,t){var e=B(r,"a","div"),n=B(t,"b","div");return gt(e.shape,n.shape,"Error in divideStrict: "),e.div(n)}}),NC=j({floorDiv_:function(r,t){var e,n=B(r,"a","floorDiv"),a=B(t,"b","floorDiv");e=Bt(n,a),n=e[0],a=e[1];var i=it(n.shape,a.shape);return q.runKernelFunc(function(s,l){var c=s.floorDiv(n,a);return l([n,a]),c},{a:n,b:a},function(s,l){var c=l[0],f=l[1];return{a:function(){var d=s.div(f.toFloat()),v=an(c.shape,i);return v.length>0?d.sum(v).reshape(c.shape):d},b:function(){var d=s.mul(c.toFloat()),v=an(f.shape,i);v.length>0&&(d=d.sum(v).reshape(f.shape));var m=f.square();return d.div(m.toFloat()).neg()}}},"FloorDiv")}}),n0=j({maximum_:function(r,t){var e,n=B(r,"a","maximum"),a=B(t,"b","maximum");return e=Bt(n,a),n=e[0],a=e[1],n.dtype==="bool"&&(n=n.toInt(),a=a.toInt()),it(n.shape,a.shape),q.runKernelFunc(function(i,s){var l=i.maximum(n,a);return s([n,a]),l},{a:n,b:a},function(i,s){var l=s[0],c=s[1];return{a:function(){return i.mul(l.greaterEqual(c).toFloat())},b:function(){return i.mul(l.less(c).toFloat())}}},"Maximum")}}),eL=j({maximumStrict_:function(r,t){var e=B(r,"a","maximumStrict"),n=B(t,"b","maximumStrict");return gt(e.shape,n.shape,"Error in maximumStrict: "),e.maximum(n)}}),MC=j({minimum_:function(r,t){var e,n=B(r,"a","minimum"),a=B(t,"b","minimum");return e=Bt(n,a),n=e[0],a=e[1],n.dtype==="bool"&&(n=n.toInt(),a=a.toInt()),it(n.shape,a.shape),q.runKernelFunc(function(i,s){var l=i.minimum(n,a);return s([n,a]),l},{a:n,b:a},function(i,s){var l=s[0],c=s[1];return{a:function(){return i.mul(l.lessEqual(c).toFloat())},b:function(){return i.mul(l.greater(c).toFloat())}}},"Minimum")}}),tL=j({minimumStrict_:function(r,t){var e=B(r,"a","minimumStrict"),n=B(t,"b","minimumStrict");return gt(e.shape,n.shape,"Error in minimumStrict: "),e.minimum(n)}}),nL=j({mod_:function(r,t){var e,n=B(r,"a","mod"),a=B(t,"b","mod");e=Bt(n,a),n=e[0],a=e[1];var i=it(n.shape,a.shape);return q.runKernelFunc(function(s,l){var c=s.mod(n,a);return l([n,a]),c},{$a:n,$b:a},function(s,l){var c=l[0],f=l[1];return{$a:function(){var d=an(c.shape,i);return d.length>0?s.sum(d).reshape(c.shape):s},$b:function(){var d=s.mul(c.div(f).floor().neg()),v=an(f.shape,i);return v.length>0?d.sum(v).reshape(f.shape):d}}})}}),rL=j({modStrict_:function(r,t){var e=B(r,"a","modStrict"),n=B(t,"b","modStrict");return gt(e.shape,n.shape,"Error in modStrict: "),e.mod(n)}}),Mn=j({mul_:function(r,t){var e,n=B(r,"a","mul"),a=B(t,"b","mul");e=Bt(n,a),n=e[0],a=e[1];var i=it(n.shape,a.shape);return q.runKernelFunc(function(s,l){var c=s.multiply(n,a);return l([n,a]),c},{a:n,b:a},function(s,l){var c=l[0],f=l[1];return{a:function(){var d=s.mul(f.toFloat()),v=an(c.shape,i);return v.length>0?d.sum(v).reshape(c.shape):d},b:function(){var d=s.mul(c.toFloat()),v=an(f.shape,i);return v.length>0?d.sum(v).reshape(f.shape):d}}},"Mul")}}),aL=j({mulStrict_:function(r,t){var e=B(r,"a","mul"),n=B(t,"b","mul");return gt(e.shape,n.shape,"Error in multiplyStrict: "),e.mul(n)}}),Nd=j({pow_:function(r,t){var e,n=B(r,"base","pow"),a=B(t,"exp","pow");e=Bt(n,a),n=e[0],a=e[1];var i=it(n.shape,a.shape),s=[n,a];return q.runKernelFunc(function(l,c){var f=l.pow(n,a);return c([n,a,f]),f},{a:n,b:a},function(l,c){var f=c[0],d=c[1],v=c[2];return{a:function(){var m=d.toFloat(),g=l.mul(m.mul(f.pow(m.sub(ye(1))))),b=an(f.shape,i);return b.length>0&&(g=g.sum(b)),g.reshape(f.shape)},b:function(){var m=f.greater(0),g=f.log().where(m,lt(f)),b=l.mul(v.mul(g)),w=an(d.shape,i);return w.length>0&&(b=b.sum(w)),b.reshape(d.shape)}}},"Pow",{},s,[!0])}}),iL=j({powStrict_:function(r,t){return gt(r.shape,t.shape,"Error in powStrict: "),r.pow(t)}}),oL=j({squaredDifferenceStrict_:function(r,t){var e=B(r,"a","squaredDifferenceStrict"),n=B(t,"b","squaredDifferenceStrict");return gt(e.shape,n.shape,"Error in squaredDifferenceStrict: "),e.squaredDifference(n)}}),on=j({sub_:function(r,t){var e,n=B(r,"a","sub"),a=B(t,"b","sub");e=Bt(n,a),n=e[0],a=e[1];var i=it(n.shape,a.shape);return q.runKernelFunc(function(s){return s.subtract(n,a)},{a:n,b:a},function(s){return{a:function(){var l=s,c=an(n.shape,i);return c.length>0&&(l=l.sum(c)),l.reshape(n.shape)},b:function(){var l=s,c=an(a.shape,i);return c.length>0&&(l=l.sum(c)),l.neg().reshape(a.shape)}}},"Sub")}}),sL=j({subStrict_:function(r,t){var e=B(r,"a","subStrict"),n=B(t,"b","subStrict");return gt(e.shape,n.shape,"Error in subStrict: "),e.sub(n)}}),IC=j({equal_:function(r,t){var e,n=B(r,"a","equal"),a=B(t,"b","equal");return e=Bt(n,a),n=e[0],a=e[1],it(n.shape,a.shape),q.runKernelFunc(function(i){return i.equal(n,a)},{$a:n,$b:a})}}),uL=j({equalStrict_:function(r,t){var e=B(r,"a","equalStrict"),n=B(t,"b","equalStrict");return gt(e.shape,n.shape,"Error in equalStrict: "),e.equal(n)}}),lL=j({greater_:function(r,t){var e,n=B(r,"a","greater"),a=B(t,"b","greater");return e=Bt(n,a),n=e[0],a=e[1],it(n.shape,a.shape),q.runKernelFunc(function(i){return i.greater(n,a)},{a:n,b:a},null,"Greater")}}),FC=j({greaterEqual_:function(r,t){var e,n=B(r,"a","greaterEqual"),a=B(t,"b","greaterEqual");return e=Bt(n,a),n=e[0],a=e[1],it(n.shape,a.shape),q.runKernelFunc(function(i,s){var l=i.greaterEqual(n,a);return s([n,a]),l},{a:n,b:a},function(i,s){var l=s[0],c=s[1];return{a:function(){return lt(l)},b:function(){return lt(c)}}},"GreaterEqual")}}),cL=j({greaterEqualStrict_:function(r,t){var e=B(r,"a","greaterEqualStrict"),n=B(t,"b","greaterEqualStrict");return gt(e.shape,n.shape,"Error in greaterEqualStrict: "),e.greaterEqual(n)}}),fL=j({greaterStrict_:function(r,t){var e=B(r,"a","greaterStrict"),n=B(t,"b","greaterStrict");return gt(e.shape,n.shape,"Error in greaterStrict: "),e.greater(n)}}),hL=j({less_:function(r,t){var e,n=B(r,"a","less"),a=B(t,"b","less");return e=Bt(n,a),n=e[0],a=e[1],it(n.shape,a.shape),q.runKernelFunc(function(i){return i.less(n,a)},{a:n,b:a},null,"Less")}}),dL=j({lessEqual_:function(r,t){var e,n=B(r,"a","lessEqual"),a=B(t,"b","lessEqual");return e=Bt(n,a),n=e[0],a=e[1],it(n.shape,a.shape),q.runKernelFunc(function(i,s){var l=i.lessEqual(n,a);return s([n,a]),l},{a:n,b:a},null,"LessEqual")}}),pL=j({lessEqualStrict_:function(r,t){var e=B(r,"a","lessEqualStrict"),n=B(t,"b","lessEqualStrict");return gt(e.shape,n.shape,"Error in lessEqualStrict: "),e.lessEqual(n)}}),vL=j({lessStrict_:function(r,t){var e=B(r,"a","lessStrict"),n=B(t,"b","lessStrict");return gt(e.shape,n.shape,"Error in lessStrict: "),e.less(n)}}),mL=j({notEqual_:function(r,t){var e,n=B(r,"a","notEqual"),a=B(t,"b","notEqual");return e=Bt(n,a),n=e[0],a=e[1],it(n.shape,a.shape),q.runKernelFunc(function(i){return i.notEqual(n,a)},{a:n,b:a},null,"NotEqual")}}),gL=j({notEqualStrict_:function(r,t){var e=B(r,"a","notEqualStrict"),n=B(t,"b","notEqualStrict");return gt(e.shape,n.shape,"Error in notEqualStrict: "),e.notEqual(n)}});function C_(r,t){for(var e=[],n=r;n<t;++n)e.push(n);return e}function R_(r){for(var t=[],e=0;e<r.length;++e)for(var n=0;n<r[e].length;++n)t.push(r[e][n]);return t}var r0=j({gather_:function(r,t,e){e===void 0&&(e=0);var n=B(r,"x","gather"),a=B(t,"indices","gather","int32");e=sn(e,n.shape)[0];var i=function(s,l,c){for(var f=s.shape[c],d=[],v=1,m=1,g=0;g<c;g++)d.push(s.shape[g]),v*=s.shape[g];for(g=0;g<l.rank;g++)d.push(l.shape[g]);for(g=c+1;g<s.rank;g++)d.push(s.shape[g]),m*=s.shape[g];return{batchSize:v,sliceSize:m,dimSize:f,outputShape:d}}(n,a,e);return q.runKernelFunc(function(s,l){var c=s.gather(n,a.flatten(),e);return l([a]),c},{x:n,indices:a},function(s,l){var c=l[0];return{x:function(){var f=n.shape,d=c.size,v=f.slice(0,e),m=v.length,g=f.slice(e,f.length).slice(1),b=g.length,w=C_(0,m),_=C_(m+1,m+1+b),S=R_([v,[d],g]),E=s.reshape(S),C=c.reshape([d]),R=R_([[m],w,_]),T=E.transpose(R),D=BC(T,C,n.shape[e]),k=jy(R);return D=D.transpose(k)},indices:function(){return c}}},"Gather",{axis:e}).reshape(i.outputShape)}}),BC=j({unsortedSegmentSum_:function(r,t,e){var n=B(r,"x","unsortedSegmentSum"),a=B(t,"segmentIds","unsortedSegmentSum","int32");return L(Wt(e),function(){return"numSegments must be of dtype int"}),q.runKernelFunc(function(i,s){var l=i.unsortedSegmentSum(n,a,e);return s([a]),l},{$x:n},function(i,s){var l=s[0];return{$x:function(){return function(c,f){for(var d=n0(f,lt(f)),v=r0(c,d),m=FC(f,ye(0,"int32")),g=v.rank-m.rank,b=0;b<g;++b)m=kr(m,b+1);m=Qd(m,el(v.shape,"bool"));var w=lt(v);return us(m,v,w)}(i,l)}}})}}),yL=function(r,t,e){return Ce(this,void 0,void 0,function(){var n,a,i,s,l,c,f,d,v,m,g,b,w;return Re(this,function(_){switch(_.label){case 0:for(n=B(r,"tensor","boolMask"),a=B(t,"mask","boolMask","bool"),i=e??0,s=a.rank,l=n.shape,L(s>0,function(){return"mask cannot be scalar"}),gt(l.slice(i,i+s),a.shape,"mask's shape must match the first K dimensions of tensor's shape,"),c=1,f=i;f<i+s;f++)c*=l[f];return d=l.slice(0,i).concat([c],l.slice(i+s)),v=n.reshape(d),m=a.reshape([-1]),[4,OC(m)];case 1:return g=_.sent(),b=g.squeeze([1]),w=r0(v,b,i),r!==n&&n.dispose(),t!==a&&a.dispose(),b.dispose(),v.dispose(),m.dispose(),g.dispose(),[2,w]}})})};function LC(r,t,e,n,a,i,s){i===void 0&&(i="NHWC"),L(r.length===t.rank,function(){return"Length of inShape ("+r.length+") and rank of dy ("+t.rank+") must match"});var l=r,c=t,f=!1;t.rank===3&&(f=!0,c=t.as4D(1,t.shape[0],t.shape[1],t.shape[2]),l=[1,r[0],r[1],r[2]]),L(l.length===4,function(){return"Error in conv2dDerInput: inShape must be length 4, but got length "+l.length+"."}),L(c.rank===4,function(){return"Error in conv2dDerInput: dy must be rank 4, but got rank "+c.rank}),L(e.rank===4,function(){return"Error in conv2dDerInput: filter must be rank 4, but got rank "+e.rank});var d=i==="NHWC"?l[3]:l[1],v=i==="NHWC"?c.shape[3]:c.shape[1];L(d===e.shape[2],function(){return"Error in conv2dDerInput: depth of input ("+d+") must match input depth for filter "+e.shape[2]+"."}),L(v===e.shape[3],function(){return"Error in conv2dDerInput: depth of output ("+v+") must match output depth for filter "+e.shape[3]+"."}),s!=null&&L(Wt(a),function(){return"Error in conv2dDerInput: pad must be an integer when using, dimRoundingMode "+s+" but got pad "+a+"."});var m=Xy(i),g=fs(l,e.shape,n,1,a,s,!1,m),b=q.runKernelFunc(function(w,_){var S=w.conv2dDerInput(c,e,g);return _([e,c]),S},{dy4D:c,filter:e},function(w,_){var S=_[0],E=_[1];return{dy4D:function(){return Fr(w,S,n,a,i,1,s)},filter:function(){return a0(w,E,S.shape,n,a,i,s)}}});return f?b.as3D(b.shape[1],b.shape[2],b.shape[3]):b}function ug(r){var t=function(i){return typeof i=="number"?[i,i,i]:i.length===2?[i[0],i[1],1]:i}(r),e=t[0],n=t[1],a=t[2];return e===1&&n===1&&a===1}function PC(r,t,e,n,a){L(r.length===t.rank,function(){return"Length of inShape ("+r.length+") and rank of dy ("+t.rank+") must match"});var i=r,s=t,l=!1;t.rank===4&&(l=!0,s=t.as5D(1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]),i=[1,r[0],r[1],r[2],r[3]]);var c=i[4],f=s.shape[4];L(i.length===5,function(){return"Error in conv3dDerInput: inShape must be length 5, but got length "+i.length+"."}),L(s.rank===5,function(){return"Error in conv3dDerInput: dy must be rank 5, but got rank "+s.rank}),L(e.rank===5,function(){return"Error in conv3dDerInput: filter must be rank 5, but got rank "+e.rank}),L(c===e.shape[3],function(){return"Error in conv3dDerInput: depth of input ("+c+") must match input depth for filter "+e.shape[3]+"."}),L(f===e.shape[4],function(){return"Error in conv3dDerInput: depth of output ("+f+") must match output depth for filter "+e.shape[4]+"."});var d=Dd(i,e.shape,n,1,a),v=q.runKernelFunc(function(m){return m.conv3dDerInput(s,e,d)},{dy5D:s});return l?v.as4D(v.shape[1],v.shape[2],v.shape[3],v.shape[4]):v}var bL=j({conv1d_:function(r,t,e,n,a,i,s){a===void 0&&(a="NWC"),i===void 0&&(i=1);var l=B(r,"x","conv1d"),c=B(t,"filter","conv1d"),f=l,d=!1;l.rank===2&&(d=!0,f=l.as3D(1,l.shape[0],l.shape[1])),L(f.rank===3,function(){return"Error in conv1d: input must be rank 3, but got rank "+f.rank+"."}),L(c.rank===3,function(){return"Error in conv1d: filter must be rank 3, but got rank "+c.rank+"."}),s!=null&&L(Wt(n),function(){return"Error in conv1d: pad must be an integer when using, dimRoundingMode "+s+" but got pad "+n+"."}),L(f.shape[2]===c.shape[1],function(){return"Error in conv1d: depth of input ("+f.shape[2]+") must match input depth for filter "+c.shape[1]+"."}),L(er(e,i),function(){return"Error in conv1D: Either stride or dilation must be 1. Got stride "+e+" and dilation '"+i+"'"}),L(a==="NWC",function(){return"Error in conv1d: got dataFormat of "+a+" but only NWC is currently supported."});var v=c.as4D(1,c.shape[0],c.shape[1],c.shape[2]),m=f.as4D(f.shape[0],1,f.shape[1],f.shape[2]),g=Fr(m,v,[1,e],n,"NHWC",[1,i],s);return d?g.as2D(g.shape[2],g.shape[3]):g.as3D(g.shape[0],g.shape[2],g.shape[3])}}),Fr=j({conv2d_:function(r,t,e,n,a,i,s){a===void 0&&(a="NHWC"),i===void 0&&(i=[1,1]);var l=B(r,"x","conv2d"),c=B(t,"filter","conv2d"),f=l,d=!1;l.rank===3&&(d=!0,f=l.as4D(1,l.shape[0],l.shape[1],l.shape[2])),L(f.rank===4,function(){return"Error in conv2d: input must be rank 4, but got rank "+f.rank+"."}),L(c.rank===4,function(){return"Error in conv2d: filter must be rank 4, but got rank "+c.rank+"."}),s!=null&&L(Wt(n),function(){return"Error in conv2d: pad must be an integer when using, dimRoundingMode "+s+" but got pad "+n+"."});var v=a==="NHWC"?f.shape[3]:f.shape[1];L(v===c.shape[2],function(){return"Error in conv2d: depth of input ("+v+") must match input depth for filter "+c.shape[2]+"."}),L(er(e,i),function(){return"Error in conv2D: Either strides or dilations must be 1. Got strides "+e+" and dilations '"+i+"'"});var m=Xy(a),g=fs(f.shape,c.shape,e,i,n,s,!1,m),b=[c,f],w=q.runKernelFunc(function(_,S){var E=_.conv2d(f,c,g);return S([c,f]),E},{x:f,filter:c},function(_,S){var E=S,C=E[0],R=E[1];return L(Xu(i),function(){return"Error in gradient of conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+i+"'"}),{x:function(){return zC(R.shape,_,C,e,n,a)},filter:function(){return a0(R,_,C.shape,e,n,a)}}},"Conv2D",g,b);return d?w.as3D(w.shape[1],w.shape[2],w.shape[3]):w}}),xL=j({conv3d_:function(r,t,e,n,a,i){a===void 0&&(a="NDHWC"),i===void 0&&(i=[1,1,1]);var s=B(r,"x","conv3d"),l=B(t,"filter","conv3d"),c=s,f=!1;s.rank===4&&(f=!0,c=s.as5D(1,s.shape[0],s.shape[1],s.shape[2],s.shape[3])),L(c.rank===5,function(){return"Error in conv3d: input must be rank 5, but got rank "+c.rank+"."}),L(l.rank===5,function(){return"Error in conv3d: filter must be rank 5, but got rank "+l.rank+"."}),L(c.shape[4]===l.shape[3],function(){return"Error in conv3d: depth of input ("+c.shape[4]+") must match input depth for filter "+l.shape[3]+"."}),L(function(m,g){return ug(m)||ug(g)}(e,i),function(){return"Error in conv3D: Either strides or dilations must be 1. Got strides "+e+" and dilations '"+i+"'"}),L(a==="NDHWC",function(){return"Error in conv3d: got dataFormat of "+a+" but only NDHWC is currently supported."});var d=Dd(c.shape,l.shape,e,i,n),v=q.runKernelFunc(function(m,g){var b=m.conv3d(c,l,d);return g([c,l]),b},{x:c,$filter:l},function(m,g){L(ug(i),function(){return"Error in gradient of conv3D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+i+"'"});var b=g[0],w=g[1];return{x:function(){return PC(b.shape,m,w,e,n)},$filter:function(){return function(_,S,E,C,R){var T=_;_.rank===4&&(T=_.as5D(1,_.shape[0],_.shape[1],_.shape[2],_.shape[3]));var D=S;D.rank===4&&(D=S.as5D(1,S.shape[0],S.shape[1],S.shape[2],S.shape[3])),L(T.rank===5,function(){return"Error in conv3dDerFilter: input must be rank 5, but got shape "+T.shape+"."}),L(D.rank===5,function(){return"Error in conv3dDerFilter: dy must be rank 5, but got shape "+D.shape+"."}),L(E.length===5,function(){return"Error in conv3dDerFilter: filterShape must be length 5, but got "+E+"."}),L(T.shape[4]===E[3],function(){return"Error in conv3dDerFilter: depth of input "+T.shape[4]+") must match input depth in filter ("+E[3]+"."}),L(D.shape[4]===E[4],function(){return"Error in conv3dDerFilter: depth of dy ("+D.shape[4]+") must match output depth for filter ("+E[4]+")."});var k=Dd(T.shape,E,C,1,R);return q.runKernelFunc(function(M){return M.conv3dDerFilter(T,D,k)},{x5D:T,dy5D:D})}(b,m,w.shape,e,n)}}});return f?v.as4D(v.shape[1],v.shape[2],v.shape[3],v.shape[4]):v}}),a0=j({conv2dDerFilter_:function(r,t,e,n,a,i,s){i===void 0&&(i="NHWC");var l=r;r.rank===3&&(l=r.as4D(1,r.shape[0],r.shape[1],r.shape[2]));var c=t;c.rank===3&&(c=t.as4D(1,t.shape[0],t.shape[1],t.shape[2])),L(l.rank===4,function(){return"Error in conv2dDerFilter: input must be rank 4, but got shape "+l.shape+"."}),L(c.rank===4,function(){return"Error in conv2dDerFilter: dy must be rank 4, but got shape "+c.shape+"."}),L(e.length===4,function(){return"Error in conv2dDerFilter: filterShape must be length 4, but got "+e+"."});var f=i==="NHWC"?l.shape[3]:l.shape[1],d=i==="NHWC"?c.shape[3]:c.shape[1];L(f===e[2],function(){return"Error in conv2dDerFilter: depth of input "+f+") must match input depth in filter ("+e[2]+"."}),L(d===e[3],function(){return"Error in conv2dDerFilter: depth of dy ("+d+") must match output depth for filter ("+e[3]+")."}),s!=null&&L(Wt(a),function(){return"Error in conv2dDerFilter: pad must be an integer when using, dimRoundingMode "+s+" but got pad "+a+"."});var v=Xy(i),m=fs(l.shape,e,n,1,a,s,!1,v);return q.runKernelFunc(function(g){return g.conv2dDerFilter(l,c,m)},{x4D:l,dy4D:c})}}),zC=j({conv2dDerInput_:LC}),Jd=j({depthwiseConv2d_:function(r,t,e,n,a,i,s){i===void 0&&(i=[1,1]);var l=B(r,"x","depthwiseConv2d"),c=B(t,"filter","depthwiseConv2d"),f=l,d=!1;l.rank===3&&(d=!0,f=l.as4D(1,l.shape[0],l.shape[1],l.shape[2])),L(f.rank===4,function(){return"Error in depthwiseConv2d: input must be rank 4, but got rank "+f.rank+"."}),L(c.rank===4,function(){return"Error in depthwiseConv2d: filter must be rank 4, but got rank "+c.rank+"."}),L(f.shape[3]===c.shape[2],function(){return"Error in depthwiseConv2d: number of input channels ("+f.shape[3]+") must match the inChannels dimension in filter "+c.shape[2]+"."}),i==null&&(i=[1,1]),L(er(e,i),function(){return"Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides "+e+" and dilations '"+i+"'"}),s!=null&&L(Wt(n),function(){return"Error in depthwiseConv2d: pad must be an integer when using, dimRoundingMode "+s+" but got pad "+n+"."});var v=fs(f.shape,c.shape,e,i,n,s,!0),m=[f,c],g=q.runKernelFunc(function(b,w){var _=b.depthwiseConv2D(f,c,v);return w([f,c]),_},{x:f,filter:c},function(b,w){L(Xu(i),function(){return"Error in gradient of depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '"+i+"'"});var _=w[0],S=w[1];return{x:function(){return UC(_.shape,b,S,v)},filter:function(){return VC(_,b,S.shape,v)}}},"DepthwiseConv2dNative",v,m);return d?g.as3D(g.shape[1],g.shape[2],g.shape[3]):g}}),UC=j({depthwiseConv2dDerInput_:function(r,t,e,n){var a=t,i=!1;t.rank===3&&(i=!0,a=t.as4D(1,t.shape[0],t.shape[1],t.shape[2]));var s=q.runKernelFunc(function(l){return l.depthwiseConv2DDerInput(a,e,n)},{dy4D:a});return i?s.as3D(s.shape[1],s.shape[2],s.shape[3]):s}}),VC=j({depthwiseConv2dDerFilter_:function(r,t,e,n){var a=r;r.rank===3&&(a=r.as4D(1,r.shape[0],r.shape[1],r.shape[2]));var i=t;return i.rank===3&&(i=t.as4D(1,t.shape[0],t.shape[1],t.shape[2])),q.runKernelFunc(function(s){return s.depthwiseConv2DDerFilter(a,i,n)},{x4D:a,dy4D:i})}}),i0=j({separableConv2d_:function(r,t,e,n,a,i,s){i===void 0&&(i=[1,1]),s===void 0&&(s="NHWC");var l=B(r,"x","separableConv2d"),c=B(t,"depthwiseFilter","separableConv2d"),f=B(e,"pointwiseFilter","separableConv2d"),d=l,v=!1;if(l.rank===3&&(v=!0,d=l.as4D(1,l.shape[0],l.shape[1],l.shape[2])),s==="NCHW")throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");L(d.rank===4,function(){return"Error in separableConv2d: input must be rank 4, but got rank "+d.rank+"."}),L(c.rank===4,function(){return"Error in separableConv2d: depthwise filter must be rank 4, but got rank "+c.rank+"."}),L(f.rank===4,function(){return"Error in separableConv2d: pointwise filter must be rank 4, but got rank "+c.rank+"."}),L(f.shape[0]===1,function(){return"Error in separableConv2d: the first dimension of pointwise filter  must be 1, but got "+f.shape[0]+"."}),L(f.shape[1]===1,function(){return"Error in separableConv2d: the second dimension of pointwise filter must be 1, but got "+f.shape[1]+"."});var m=c.shape[2],g=c.shape[3];L(f.shape[2]===m*g,function(){return"Error in separableConv2d: the third dimension of pointwise filter must be "+m*g+", but got "+f.shape[2]+"."});var b=Jd(d,c,n,a,s,i),w=Fr(b,f,1,"valid",s);return v?w.as3D(w.shape[1],w.shape[2],w.shape[3]):w}}),wL=j({conv2dTranspose_:function(r,t,e,n,a,i){return LC(e,B(r,"x","conv2dTranspose"),B(t,"filter","conv2dTranspose"),n,a,"NHWC",i)}}),_L=j({conv3dTranspose_:function(r,t,e,n,a){return PC(e,B(r,"x","conv3dTranspose"),B(t,"filter","conv3dTranspose"),n,a)}}),ep=j({matMul_:function(r,t,e,n){var a;e===void 0&&(e=!1),n===void 0&&(n=!1);var i=B(r,"a","matMul"),s=B(t,"b","matMul");a=Bt(i,s),i=a[0],s=a[1];var l=e?i.shape[i.rank-2]:i.shape[i.rank-1],c=n?s.shape[s.rank-1]:s.shape[s.rank-2],f=e?i.shape[i.rank-1]:i.shape[i.rank-2],d=n?s.shape[s.rank-2]:s.shape[s.rank-1],v=i.shape.slice(0,-2),m=s.shape.slice(0,-2),g=Te(v),b=Te(m);L(i.rank>=2&&s.rank>=2&&i.rank===s.rank,function(){return"Error in matMul: inputs must have the same rank of at least 2, got ranks "+i.rank+" and "+s.rank+"."}),L(vn(v,m),function(){return"Error in matMul: outer dimensions ("+v+") and ("+m+") of Tensors with shapes "+i.shape+" and "+s.shape+" must match."}),L(l===c,function(){return"Error in matMul: inner shapes ("+l+") and ("+c+") of Tensors with shapes "+i.shape+" and "+s.shape+" and transposeA="+e+" and transposeB="+n+" must match."});var w=i.shape.slice(0,-2).concat([f,d]),_=e?i.as3D(g,l,f):i.as3D(g,f,l),S=n?s.as3D(b,d,c):s.as3D(b,c,d),E={transposeA:e,transposeB:n};return q.runKernelFunc(function(C,R){var T=C.batchMatMul(_,S,e,n);return R([_,S]),T},{a:_,b:S},function(C,R){var T=R,D=T[0],k=T[1];return e||n?!e&&n?{a:function(){return C.matMul(k,!1,!1)},b:function(){return C.matMul(D,!0,!1)}}:e&&!n?{a:function(){return k.matMul(C,!1,!0)},b:function(){return D.matMul(C,!1,!1)}}:{a:function(){return k.matMul(C,!0,!0)},b:function(){return C.matMul(D,!0,!0)}}:{a:function(){return C.matMul(k,!1,!0)},b:function(){return D.matMul(C,!0,!1)}}},"BatchMatMul",E).reshape(w)}}),SL=j({dot_:function(r,t){var e=B(r,"t1","dot"),n=B(t,"t2","dot");L(!(e.rank!==1&&e.rank!==2||n.rank!==1&&n.rank!==2),function(){return"Error in dot: inputs must all be rank 1 or 2, but got ranks "+e.rank+" and "+n.rank+"."});var a=e.rank===1?e.size:e.shape[1],i=n.rank===1?n.size:n.shape[0];return L(a===i,function(){return"Error in dot: inner dimensions of inputs must match, but got "+a+" and "+i+"."}),e.rank===1&&n.rank===1?e.as2D(1,-1).matMul(n.as2D(-1,1)).asScalar():e.rank===1&&n.rank===2?e.as2D(1,-1).matMul(n.as2D(n.shape[0],n.shape[1])).as1D():e.rank===2&&n.rank===1?e.matMul(n.as2D(-1,1)).as1D():e.matMul(n.as2D(n.shape[0],n.shape[1]))}}),EL=j({outerProduct_:function(r,t){var e=B(r,"v1","outerProduct"),n=B(t,"v2","outerProduct");return L(e.rank===1&&n.rank===1,function(){return"Error in outerProduct: inputs must be rank 1, but got ranks "+e.rank+" and "+n.rank+"."}),e.as2D(-1,1).matMul(n.as2D(1,-1))}}),nf=j({reverse_:function(r,t){var e=B(r,"x","reverse");if(e.rank===0)return e.clone();var n=sn(t,e.shape);return q.runKernelFunc(function(a){return a.reverse(e,n)},{$x:e},function(a){return{$x:function(){return a.reverse(n)}}}).reshapeAs(e)}}),CL=j({reverse1d_:function(r){var t=B(r,"x","reverse");return L(t.rank===1,function(){return"Error in reverse1D: x must be rank 1 but got rank "+t.rank+"."}),nf(t,0)}}),RL=j({reverse2d_:function(r,t){var e=B(r,"x","reverse");return L(e.rank===2,function(){return"Error in reverse2D: x must be rank 2 but got rank "+e.rank+"."}),nf(e,t)}}),TL=j({reverse3d_:function(r,t){var e=B(r,"x","reverse");return L(e.rank===3,function(){return"Error in reverse3D: x must be rank 3 but got rank "+e.rank+"."}),nf(e,t)}}),AL=j({reverse4d_:function(r,t){var e=B(r,"x","reverse");return L(e.rank===4,function(){return"Error in reverse4D: x must be rank 4 but got rank "+e.rank+"."}),nf(e,t)}});function HC(r,t,e,n,a,i){var s=B(r,"x","maxPool"),l=s,c=!1;s.rank===3&&(c=!0,l=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),L(l.rank===4,function(){return"Error in maxPool: input must be rank 4 but got rank "+l.rank+"."}),L(er(e,n),function(){return"Error in maxPool: Either strides or dilations must be 1. Got strides "+e+" and dilations '"+n+"'"}),i!=null&&L(Wt(a),function(){return"Error in maxPool: pad must be an integer when using, dimRoundingMode "+i+" but got pad "+a+"."});var f=Bc(l.shape,t,e,n,a,i);if(f.filterWidth===1&&f.filterHeight===1&&vn(f.inShape,f.outShape))return s.clone();var d=[l],v=q.runKernelFunc(function(m,g){var b=m.maxPool(l,f);return g([l,b]),b},{x:l},function(m,g){var b=g[0],w=g[1];return{x:function(){return function(_,S,E,C,R,T,D,k){var M=B(_,"dy","maxPoolBackprop"),N=B(S,"input","maxPoolBackprop"),I=B(E,"output","maxPoolBackprop");L(N.rank===M.rank,function(){return"Rank of input ("+N.rank+") does not match rank of dy ("+M.rank+")"}),L(er(R,T),function(){return"Error in maxPoolBackProp: Either strides or dilations must be 1. Got strides "+R+" and dilations '"+T+"'"}),L(M.rank===4,function(){return"Error in maxPoolBackprop: dy must be rank 4 but got rank "+M.rank+"."}),L(N.rank===4,function(){return"Error in maxPoolBackprop: input must be rank 4 but got rank "+N.rank+"."});var z=Bc(N.shape,C,R,T,D,k);return q.runKernelFunc(function(P){return P.maxPoolBackprop(M,N,I,z)},{$dy:M,$input:N})}(m,b,w,t,e,n,a)}}},"MaxPool",f,d);return c?v.as3D(v.shape[1],v.shape[2],v.shape[3]):v}function jC(r,t,e,n,a,i){var s=B(r,"x","avgPool","float32");L(er(e,n),function(){return"Error in avgPool: Either strides or dilations must be 1. Got strides "+e+" and dilations '"+n+"'"});var l=s,c=!1;s.rank===3&&(c=!0,l=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),L(l.rank===4,function(){return"Error in avgPool: x must be rank 4 but got rank "+l.rank+"."}),i!=null&&L(Wt(a),function(){return"Error in avgPool: pad must be an integer when using, dimRoundingMode "+i+" but got pad "+a+"."});var f=Bc(l.shape,t,e,n,a,i);if(f.filterWidth===1&&f.filterHeight===1&&vn(f.inShape,f.outShape))return s.clone();var d=q.runKernelFunc(function(v){return v.avgPool(l,f)},{x:l},function(v){return{x:function(){return function(m,g,b,w,_,S){var E=B(m,"dy","avgPoolBackprop"),C=B(g,"input","avgPoolBackprop");L(C.rank===E.rank,function(){return"Rank of input ("+C.rank+") does not match rank of dy ("+E.rank+")"}),L(er(w,_),function(){return"Error in avgPoolBackprop: Either strides or dilations must be 1. Got strides "+w+" and dilations '"+_+"'"});var R=C,T=E,D=!1;C.rank===3&&(D=!0,R=C.as4D(1,C.shape[0],C.shape[1],C.shape[2]),T=E.as4D(1,E.shape[0],E.shape[1],E.shape[2])),L(T.rank===4,function(){return"Error in avgPoolBackprop: dy must be rank 4 but got rank "+T.rank+"."}),L(R.rank===4,function(){return"Error in avgPoolBackprop: input must be rank 4 but got rank "+R.rank+"."});var k=Bc(R.shape,b,w,_,S),M=q.runKernelFunc(function(N){return N.avgPoolBackprop(T,R,k)},{dy4D:T,input4D:R});return D?M.as3D(M.shape[1],M.shape[2],M.shape[3]):M}(v,l,t,e,n,a)}}},"AvgPool",f);return d=d.cast(s.dtype),c?d.as3D(d.shape[1],d.shape[2],d.shape[3]):d}var hn=j({maxPool_:function(r,t,e,n,a){return HC(r,t,e,1,n,a)}}),rf=j({avgPool_:function(r,t,e,n,a){return jC(r,t,e,1,n,a)}}),DL=j({pool_:function(r,t,e,n,a,i){a==null&&(a=[1,1]),i==null&&(i=1),n===0&&(n="valid");var s=B(r,"x","maxPool"),l=s,c=!1;s.rank===3&&(c=!0,l=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),L(er(i,a),function(){return"Error in pool: Either strides or dilations must be 1. Got strides "+i+" and dilations '"+a+"'"});var f,d=Bc(l.shape,t,i,a,n),v=[d.dilationHeight,d.dilationWidth];f=n==="same"?function(R,T){var D=R.map(function(N,I){return N+(N-1)*(T[I]-1)}).map(function(N){return N-1}),k=D.map(function(N){return Math.floor(N/2)}),M=D.map(function(N,I){return N-k[I]});return D.map(function(N,I){return[k[I],M[I]]})}([d.filterHeight,d.filterWidth],v):[[0,0],[0,0]];var m=v[0]===1&&v[1]===1,g=function(R,T,D){var k=D.map(function(re){return re[0]}),M=D.map(function(re){return re[1]}),N=R.concat(k,M),I=T.map(function(re,ee){return(re-N[ee]%re)%re}),z=M.map(function(re,ee){return re+I[ee]}),P=T.map(function(re,ee){return[k[ee],z[ee]]}),ne=T.map(function(re,ee){return[0,I[ee]]});return[P,ne]}([d.inHeight,d.inWidth],v,f),b=g[0],w=g[1],_=m?n:"valid",S=m?l:$E(l,v,b),E=(e==="avg"?function(){return jC(S,t,i,1,_)}:function(){return HC(S,t,i,1,_)})(),C=m?E:qE(E,v,w);return c?C.as3D(C.shape[1],C.shape[2],C.shape[3]):C}}),kL=j({maxPool3d_:function(r,t,e,n,a,i,s){i===void 0&&(i="NDHWC");var l=B(r,"x","maxPool3d"),c=l,f=!1;l.rank===4&&(f=!0,c=l.as5D(1,l.shape[0],l.shape[1],l.shape[2],l.shape[3])),s==null&&(s=[1,1,1]),L(c.rank===5,function(){return"Error in maxPool3d: x must be rank 5 but got rank "+c.rank+"."}),L(i==="NDHWC",function(){return"Error in maxPool3d: Only NDHWC is currently supported, but got dataFormat of "+i}),L(er(e,s),function(){return"Error in maxPool3d: Either strides or dilations must be 1. Got strides "+e+" and dilations '"+s+"'"}),a!=null&&L(Wt(n),function(){return"Error in maxPool3d: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+n+"."});var d=Ad(c.shape,t,e,s,n,a,i),v=q.runKernelFunc(function(m,g){var b=m.maxPool3d(c,d);return g([c,b]),b},{x:c},function(m,g){var b=g[0],w=g[1];return{x:function(){return function(_,S,E,C,R,T,D,k){var M=B(_,"dy","maxPool3dBackprop"),N=B(S,"input","maxPool3dBackprop"),I=B(E,"output","maxPool3dBackprop"),z=M,P=N,ne=I,re=!1;N.rank===4&&(re=!0,z=M.as5D(1,M.shape[0],M.shape[1],M.shape[2],M.shape[3]),P=N.as5D(1,N.shape[0],N.shape[1],N.shape[2],N.shape[3]),ne=I.as5D(1,I.shape[0],I.shape[1],I.shape[2],I.shape[3])),L(z.rank===5,function(){return"Error in maxPool3dBackprop: dy must be rank 5 but got rank "+z.rank+"."}),L(P.rank===5,function(){return"Error in maxPool3dBackprop: input must be rank 5 but got rank "+P.rank+"."}),L(ne.rank===5,function(){return"Error in maxPool3dBackprop: output must be rank 5 but got rank "+ne.rank+"."}),T==null&&(T=[1,1,1]),L(er(R,T),function(){return"Error in maxPool3dBackprop: Either strides or dilations must be 1. Got strides "+R+" and dilations '"+T+"'"}),k!=null&&L(Wt(D),function(){return"Error in maxPool3dBackprop: pad must be an integer when using, dimRoundingMode "+k+" but got pad "+D+"."});var ee=Ad(P.shape,C,R,T,D,k),U=q.runKernelFunc(function(G){return G.maxPool3dBackprop(z,P,ne,ee)},{dy5D:z,input5D:P});return re?U.as4D(U.shape[1],U.shape[2],U.shape[3],U.shape[4]):U}(m,b,w,t,e,s,n,a)}}});return f?v.as4D(v.shape[1],v.shape[2],v.shape[3],v.shape[4]):v}}),OL=j({avgPool3d_:function(r,t,e,n,a,i,s){i===void 0&&(i="NDHWC");var l=B(r,"x","avgPool3d","float32"),c=l,f=!1;l.rank===4&&(f=!0,c=l.as5D(1,l.shape[0],l.shape[1],l.shape[2],l.shape[3])),s==null&&(s=[1,1,1]),L(c.rank===5,function(){return"Error in avgPool3d: x must be rank 5 but got rank "+c.rank+"."}),L(i==="NDHWC",function(){return"Error in avgPool3d: Only NDHWC is currently supported, but got dataFormat of "+i}),L(er(e,s),function(){return"Error in avgPool3d: Either strides or dilations must be 1. Got strides "+e+" and dilations '"+s+"'"}),a!=null&&L(Wt(n),function(){return"Error in avgPool3d: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+n+"."});var d=Ad(c.shape,t,e,s,n,a,i),v=q.runKernelFunc(function(m){return m.avgPool3d(c,d)},{x:c},function(m){return{x:function(){return function(g,b,w,_,S,E,C){var R=B(g,"dy","avgPool3dBackprop"),T=B(b,"input","avgPool3dBackprop"),D=R,k=T,M=!1;T.rank===4&&(M=!0,D=R.as5D(1,R.shape[0],R.shape[1],R.shape[2],R.shape[3]),k=T.as5D(1,T.shape[0],T.shape[1],T.shape[2],T.shape[3])),L(D.rank===5,function(){return"Error in avgPool3dBackprop: dy must be rank 5 but got rank "+D.rank+"."}),L(k.rank===5,function(){return"Error in avgPool3dBackprop: input must be rank 5 but got rank "+k.rank+"."}),S==null&&(S=[1,1,1]),L(er(_,S),function(){return"Error in avgPool3dBackprop: Either strides or dilations must be 1. Got strides "+_+" and dilations '"+S+"'"}),C!=null&&L(Wt(E),function(){return"Error in maxPool3dBackprop: pad must be an integer when using, dimRoundingMode "+C+" but got pad "+E+"."});var N=Ad(k.shape,w,_,S,E,C),I=q.runKernelFunc(function(z){return z.avgPool3dBackprop(D,k,N)},{dy5D:D,input5D:k});return M?I.as4D(I.shape[1],I.shape[2],I.shape[3],I.shape[4]):I}(m,c,t,e,s,n,a)}}});return v=v.cast(c.dtype),f?v.as4D(v.shape[1],v.shape[2],v.shape[3],v.shape[4]):v}}),Ea=j({slice_:function(r,t,e){var n,a,i=B(r,"x","slice");if(i.rank===0)throw new Error("Slicing scalar is not possible");(n=typeof t=="number"?[t].concat(new Array(i.rank-1).fill(0)):t.length<i.rank?t.concat(new Array(i.rank-t.length).fill(0)):t.slice()).forEach(function(c){L(c!==-1,function(){return"slice() does not support negative begin indexing."})}),a=(a=e==null?new Array(i.rank).fill(-1):typeof e=="number"?[e].concat(new Array(i.rank-1).fill(-1)):e.length<i.rank?e.concat(new Array(i.rank-e.length).fill(-1)):e).map(function(c,f){return c>=0?c:(L(c===-1,function(){return"Negative size values should be exactly -1 but got "+c+" for the slice() size at index "+f+"."}),i.shape[f]-n[f])}),iI(i,n,a);var s=i.shape,l={begin:n,size:a};return q.runKernelFunc(function(c){return c.slice(i,n,a)},{x:i},function(c){for(var f=[],d=0;d<c.rank;d++)f.push([n[d],s[d]-n[d]-a[d]]);return{x:function(){return c.pad(f)}}},"Slice",l)}}),NL=j({slice1d_:function(r,t,e){var n=B(r,"x","slice1d");return L(n.rank===1,function(){return"slice1d expects a rank-1 tensor, but got a rank-"+n.rank+" tensor"}),Ea(n,[t],[e])}}),ML=j({slice2d_:function(r,t,e){var n=B(r,"x","slice2d");return L(n.rank===2,function(){return"slice2d expects a rank-2 tensor, but got a rank-"+n.rank+" tensor"}),Ea(n,t,e)}}),WC=j({slice3d_:function(r,t,e){var n=B(r,"x","slice3d");return L(n.rank===3,function(){return"slice3d expects a rank-3 tensor, but got a rank-"+n.rank+" tensor"}),Ea(n,t,e)}}),IL=j({slice4d_:function(r,t,e){var n=B(r,"x","slice4d");return L(n.rank===4,function(){return"slice4d expects a rank-4 tensor, but got a rank-"+n.rank+" tensor"}),Ea(n,t,e)}});function GC(r,t,e,n,a){return t.rank<e.rank&&(t=t.reshape(Jn(t.shape,n))),r.rank<e.rank&&(r=r.reshape(Jn(r.shape,n))),{x:function(){var i=r.mul(e.equal(t).cast(r.dtype));return a==null?i:i.transpose(a)}}}var FL=j({all_:function(r,t,e){t===void 0&&(t=null),e===void 0&&(e=!1);var n=B(r,"x","all","bool"),a=sn(t,n.shape),i=a,s=Aa(i,n.rank);s!=null&&(n=n.transpose(s),i=Da(i.length,n.rank));var l=q.runKernelFunc(function(f){return f.all(n,i)},{$x:n});if(e){var c=Jn(l.shape,a);return l.reshape(c)}return l}}),BL=j({any_:function(r,t,e){t===void 0&&(t=null),e===void 0&&(e=!1);var n=B(r,"x","any","bool"),a=sn(t,n.shape),i=a,s=Aa(i,n.rank);s!=null&&(n=n.transpose(s),i=Da(i.length,n.rank));var l=q.runKernelFunc(function(f){return f.any(n,i)},{$x:n});if(e){var c=Jn(l.shape,a);return l.reshape(c)}return l}}),LL=j({argMax_:function(r,t){t===void 0&&(t=0);var e=B(r,"x","argMax");t==null&&(t=0);var n=sn(t,e.shape),a=Aa(n,e.rank);a!=null&&(e=e.transpose(a),n=Da(n.length,e.rank));var i={axis:n[0]},s=[e];return q.runKernelFunc(function(l,c){var f=l.argMax(e,n[0]);return c([e]),f},{x:e},function(l,c){var f=c[0];return{x:function(){return lt(f)}}},"ArgMax",i,s)}}),PL=j({argMin_:function(r,t){t===void 0&&(t=0);var e=B(r,"x","argMin");t==null&&(t=0);var n=sn(t,e.shape),a=Aa(n,e.rank);return a!=null&&(e=e.transpose(a),n=Da(n.length,e.rank)),q.runKernelFunc(function(i,s){var l=i.argMin(e,n[0]);return s([e]),l},{$x:e},function(i,s){var l=s[0];return{$x:function(){return lt(l)}}})}}),zL=j({logSumExp_:function(r,t,e){t===void 0&&(t=null),e===void 0&&(e=!1);var n=B(r,"x","logSumExp"),a=sn(t,n.shape),i=n.max(a,!0),s=n.sub(i).exp().sum(a).log(),l=i.reshape(s.shape).add(s);if(e){var c=Jn(l.shape,a);return l.reshape(c)}return l}}),tp=j({max_:function(r,t,e){t===void 0&&(t=null),e===void 0&&(e=!1);var n=B(r,"x","max"),a=n,i=sn(t,n.shape),s=i,l=Aa(s,n.rank);l!=null&&(n=n.transpose(l),s=Da(s.length,n.rank));var c=[n],f=q.runKernelFunc(function(v,m){var g=v.max(n,s);return m([a,g]),g},{x:n},function(v,m){return GC(v,m[1],m[0],i,l)},"Max",{axes:s},c,[!0]);if(e){var d=Jn(f.shape,i);f=f.reshape(d)}return f}}),UL=j({mean_:function(r,t,e){t===void 0&&(t=null),e===void 0&&(e=!1);var n=B(r,"x","mean"),a=sn(t,n.shape),i=Te(Dn(n.shape,a)[1]);return Yd(function(s){var l=ye(i);return{value:(l.dtype===s.dtype?s:s.cast(l.dtype)).div(l).sum(t,e),gradFunc:function(c){var f=s.shape.slice();return a.forEach(function(d){f[d]=1}),c.reshape(f).mul(el(s.shape,"float32")).div(i)}}})(n)}}),VL=j({min_:function(r,t,e){t===void 0&&(t=null),e===void 0&&(e=!1);var n=B(r,"x","min"),a=n,i=sn(t,n.shape),s=i,l=Aa(s,n.rank);l!=null&&(n=n.transpose(l),s=Da(s.length,n.rank));var c=[n],f=q.runKernelFunc(function(v,m){var g=v.min(n,s);return m([a,g]),g},{x:n},function(v,m){return GC(v,m[1],m[0],i,l)},"Min",{axes:s},c,[!0]);if(e){var d=Jn(f.shape,i);f=f.reshape(d)}return f}}),HL=j({moments_:function(r,t,e){t===void 0&&(t=null),e===void 0&&(e=!1);var n=sn(t,(r=B(r,"x","moments")).shape),a=r.mean(n,e),i=a.shape;e||(i=Jn(a.shape,n));var s=r.toFloat().sub(a.reshape(i)).square();return{mean:a,variance:s.mean(n,e)}}}),qC=j({sum_:function(r,t,e){t===void 0&&(t=null),e===void 0&&(e=!1);var n=B(r,"x","sum");n.dtype==="bool"&&(n=n.toInt());var a=sn(t,n.shape);return Yd(function(i){var s=Aa(a,i.rank),l=a,c=i;s!=null&&(c=i.transpose(s),l=Da(l.length,i.rank));var f=function(g){var b=i.shape.slice();return a.forEach(function(w){b[w]=1}),g.reshape(b).mul(el(i.shape,"float32"))},d={axes:l},v=q.runKernelFunc(function(g){return g.sum(c,l)},{x:c},function(g){return{x:function(){return f(g)}}},"Sum",d);if(e){var m=Jn(v.shape,a);v=v.reshape(m)}return{value:v,gradFunc:f}})(n)}}),jL=j({prod_:function(r,t,e){t===void 0&&(t=null),e===void 0&&(e=!1);var n=B(r,"x","prod");n.dtype==="bool"&&(n=n.toInt());var a=sn(t,n.shape),i=Aa(a,n.rank),s=a,l=n;i!=null&&(l=n.transpose(i),s=Da(s.length,n.rank));var c=q.runKernelFunc(function(d){return d.prod(l,s)},{permutedX:l});if(e){var f=Jn(c.shape,a);c=c.reshape(f)}return c}}),KC=j({elu_:function(r){var t=B(r,"x","elu");return q.runKernelFunc(function(e,n){var a=e.elu(t);return n([a]),a},{$x:t},function(e,n){var a=n[0];return{$x:function(){return q.runKernelFunc(function(i){return i.eluDer(e,a)},{dy:e,y:a})}}})}}),WL=j({leakyRelu_:function(r,t){t===void 0&&(t=.2);var e=B(r,"x","leakyRelu");return n0(ye(t).mul(e),e)}}),XC=j({prelu_:function(r,t){var e=B(r,"x","prelu"),n=B(t,"alpha","prelu");return q.runKernelFunc(function(a,i){var s=a.prelu(e,n);return i([e,n]),s},{x:e,alpha:n},function(a,i){var s=i[0],l=i[1],c=s.greater(0);return{x:function(){return us(c,a,a.mul(l))},alpha:function(){var f=us(c,lt(a),a.mul(s)),d=an(l.shape,a.shape);return d.length>0&&(f=f.sum(d)),f.reshape(l.shape)}}},"Prelu")}}),It=j({relu_:function(r){var t=B(r,"x","relu");return t.dtype==="bool"?t.toInt():q.runKernelFunc(function(e,n){var a=e.relu(t);return n([t]),a},{x:t},function(e,n){var a=n[0];return{x:function(){return e.mulStrict(a.step().toFloat())}}},"Relu")}}),$C=j({relu6_:function(r){var t=B(r,"x","relu6");return t.dtype==="bool"?t.toInt():q.runKernelFunc(function(e,n){var a=e.relu6(t);return n([t]),a},{x:t},function(e,n){var a=n[0],i=a.lessEqual(6).mul(a.step());return{x:function(){return e.mulStrict(i.toFloat())}}},"Relu6")}}),GL=j({selu_:function(r){var t=B(r,"x","selu");return q.runKernelFunc(function(e,n){var a=e.selu(t);return n([t]),a},{$x:t},function(e,n){var a=n[0];return{$x:function(){var i=a.greater(ye(0)),s=ye(Jy),l=ye(e0),c=e.mul(l),f=e.mul(s).mul(a.toFloat().exp());return us(i,c,f)}}})}}),po=j({transpose_:function(r,t){var e=B(r,"x","transpose");if(t==null&&(t=e.shape.map(function(a,i){return i}).reverse()),L(e.rank===t.length,function(){return"Error in transpose: rank of input "+e.rank+" must match length of perm "+t+"."}),t.forEach(function(a){L(a>=0&&a<e.rank,function(){return"All entries in 'perm' must be between 0 and "+(e.rank-1)+" but got "+t})}),e.rank<=1)return e.clone();var n={perm:t};return q.runKernelFunc(function(a){return a.transpose(e,t)},{x:e},function(a){var i=jy(t);return{x:function(){return a.transpose(i)}}},"Transpose",n)}}),qL=j({localResponseNormalization_:function(r,t,e,n,a){t===void 0&&(t=5),e===void 0&&(e=1),n===void 0&&(n=1),a===void 0&&(a=.5);var i=B(r,"x","localResponseNormalization");L(i.rank===4||i.rank===3,function(){return`Error in localResponseNormalization: x must be rank 3 or 4 but got
               rank `+i.rank+"."}),L(Wt(t),function(){return"Error in localResponseNormalization: depthRadius must be an integer but got depthRadius "+t+"."});var s=i,l=!1;i.rank===3&&(l=!0,s=i.as4D(1,i.shape[0],i.shape[1],i.shape[2]));var c=q.runKernelFunc(function(f,d){var v=f.localResponseNormalization4D(s,t,e,n,a);return d([s,v]),v},{x4D:s},function(f,d){var v=d[0],m=d[1];return{x4D:function(){return q.runKernelFunc(function(g){return g.LRNGrad(f,v,m,t,e,n,a)},{})}}});return l?c.as3D(c.shape[1],c.shape[2],c.shape[3]):c}}),YC=j({norm_:function(r,t,e,n){t===void 0&&(t="euclidean"),e===void 0&&(e=null),n===void 0&&(n=!1);var a=function l(c,f,d){if(d===void 0&&(d=null),c.rank===0)return c.abs();if(c.rank!==1&&d===null)return l(c.reshape([-1]),f,d);if(c.rank===1||typeof d=="number"||Array.isArray(d)&&d.length===1){if(f===1)return c.abs().sum(d);if(f===1/0)return c.abs().max(d);if(f===-1/0)return c.abs().min(d);if(f==="euclidean"||f===2)return c.abs().pow(ye(2,"int32")).sum(d).sqrt();throw new Error("Error in norm: invalid ord value: "+f)}if(Array.isArray(d)&&d.length===2){if(f===1)return c.abs().sum(d[0]).max(d[1]-1);if(f===1/0)return c.abs().sum(d[1]).max(d[0]);if(f===-1/0)return c.abs().sum(d[1]).min(d[0]);if(f==="fro"||f==="euclidean")return c.square().sum(d).sqrt();throw new Error("Error in norm: invalid ord value: "+f)}throw new Error("Error in norm: invalid axis: "+d)}(r=B(r,"x","norm"),t,e),i=a.shape;if(n){var s=sn(e,r.shape);i=Jn(a.shape,s)}return a.reshape(i)}}),KL=j({basicLSTMCell_:function(r,t,e,n,a,i){var s=B(r,"forgetBias","basicLSTMCell"),l=B(t,"lstmKernel","basicLSTMCell"),c=B(e,"lstmBias","basicLSTMCell"),f=B(n,"data","basicLSTMCell"),d=B(a,"c","basicLSTMCell"),v=B(i,"h","basicLSTMCell"),m=f.concat(v,1).matMul(l).add(c),g=m.shape[0],b=m.shape[1]/4,w=[g,b],_=m.slice([0,0],w),S=m.slice([0,b],w),E=m.slice([0,2*b],w),C=m.slice([0,3*b],w),R=_.sigmoid().mulStrict(S.tanh()).addStrict(d.mulStrict(s.add(E).sigmoid())),T=R.tanh().mulStrict(C.sigmoid());return[R,T]}}),XL=j({multiRNNCell_:function(r,t,e,n){for(var a=B(t,"data","multiRNNCell"),i=_d(e,"c","multiRNNCell"),s=_d(n,"h","multiRNNCell"),l=a,c=[],f=0;f<r.length;f++){var d=r[f](l,i[f],s[f]);c.push(d[0]),c.push(d[1]),l=d[1]}var v=[],m=[];for(f=0;f<c.length;f+=2)v.push(c[f]),m.push(c[f+1]);return[v,m]}}),$L=j({movingAverage_:function(r,t,e,n,a){a===void 0&&(a=!0);var i=B(r,"v","movingAverage"),s=B(t,"x","movingAverage"),l=B(e,"decay","movingAverage");q4(i,s),L(vn(i.shape,s.shape),function(){return"Shape mismatch in v and x"});var c=ye(1),f=c.sub(l),d=s.sub(i).mul(f);if(a){L(n!=null,function(){return"When using zeroDebias: true, step is required."});var v=B(n,"step","movingAverage");d=d.div(c.sub(Nd(l,v)))}return i.add(d)}}),YL=j({stridedSlice_:function(r,t,e,n,a,i,s,l,c){if(a===void 0&&(a=0),i===void 0&&(i=0),s===void 0&&(s=0),l===void 0&&(l=0),c===void 0&&(c=0),n==null&&(n=new Array(t.length)),s!==0)throw new Error("ellipsis mask is not yet supported");var f=B(r,"x","stridedSlice"),d=i_(l),v=f.shape.slice();d.forEach(function(_){t[_]=0,e[_]=1,v.splice(_,0,1)}),f=f.reshape(v);for(var m=0;m<f.rank;m++)t[m]=oI(a,t,n,f.shape,m),e[m]=sI(i,e,n,f.shape,m),n[m]=n[m]||1;var g=i_(c);g.forEach(function(_){e[_]=t[_]+1,n[_]=1});var b=Ky(t,e,n),w=b.filter(function(_,S){return g.indexOf(S)===-1});return n.every(function(_){return _===1})?Ea(f,t,b).reshape(w):q.runKernelFunc(function(_){return _.stridedSlice(f,t,e,n)},{$x:f}).reshape(w)}}),ZL=j({topk_:function(r,t,e){t===void 0&&(t=1),e===void 0&&(e=!0);var n=B(r,"x","topk");if(n.rank===0)throw new Error("topk() expects the input to be of rank 1 or higher");var a=n.shape[n.shape.length-1];if(t>a)throw new Error("'k' passed to topk() must be <= the last dimension ("+a+") but got "+t);var i=q.runKernelFunc(function(s){return s.topk(n,t,e)},{$x:n});return{values:i[0],indices:i[1]}}}),QL=j({scatterND_:function(r,t,e){var n=B(r,"indices","scatterND","int32"),a=B(t,"updates","scatterND");return aI(a,n,e),q.runKernelFunc(function(i){return i.scatterND(n,a,e)},{indices:n,updates:a},null,"ScatterNd",{shape:e})}}),o0=j({fft_:function(r){L(r.dtype==="complex64",function(){return"The dtype for tf.spectral.fft() must be complex64 but got "+r.dtype+"."});var t=r.shape[r.shape.length-1],e=r.size/t,n=r.as2D(e,t);return q.runKernelFunc(function(a){return a.fft(n)},{input:r}).reshape(r.shape)}}),Md=j({ifft_:function(r){L(r.dtype==="complex64",function(){return"The dtype for tf.spectral.ifft() must be complex64 but got "+r.dtype+"."});var t=r.shape[r.shape.length-1],e=r.size/t,n=r.as2D(e,t);return q.runKernelFunc(function(a){return a.ifft(n)},{input:r}).reshape(r.shape)}}),s0=j({rfft_:function(r,t){L(r.dtype==="float32",function(){return"The dtype for rfft() must be real value but got "+r.dtype});var e,n=r.shape[r.shape.length-1],a=r.size/n;if(t!=null&&t<n){var i=r.shape.map(function(S){return 0}),s=r.shape.map(function(S){return S});s[r.shape.length-1]=t,e=r.slice(i,s),n=t}else if(t!=null&&t>n){var l=r.shape.map(function(S){return S});l[r.shape.length-1]=t-n,e=r.concat(Dt(l),r.shape.length-1),n=t}else e=r;var c=e.zerosLike(),f=wn(e,c).as2D(a,n),d=o0(f),v=Math.floor(n/2)+1,m=Or(d),g=va(d),b=m.split([v,n-v],m.shape.length-1),w=g.split([v,n-v],g.shape.length-1),_=e.shape.slice();return _[e.shape.length-1]=v,wn(b[0],w[0]).reshape(_)}}),ZC=j({irfft_:function(r){var t=r.shape[r.shape.length-1],e=r.size/t;if(t<=2){var n=r.as2D(e,t),a=Md(n);return Or(a)}var i=[e,2*(t-1)],s=Or(r).as2D(e,t),l=va(r).as2D(e,t),c=s.slice([0,1],[e,t-2]).reverse(1),f=l.slice([0,1],[e,t-2]).reverse(1).mul(ye(-1)),d=s.concat(c,1),v=l.concat(f,1);return n=wn(d,v).as2D(i[0],i[1]),a=Md(n),Or(a)}}),JL=Object.freeze({fft:o0,ifft:Md,rfft:s0,irfft:ZC}),eP=j({sparseToDense_:function(r,t,e,n){n===void 0&&(n=0);var a=B(r,"sparseIndices","sparseToDense","int32"),i=B(t,"sparseValues","sparseToDense"),s=B(n,"defaultValue","sparseToDense",i.dtype);return function(l,c,f,d){if(l.dtype!=="int32")throw new Error("tf.sparseToDense() expects the indices to be int32 type, but the dtype was "+l.dtype+".");if(l.rank>2)throw new Error("sparseIndices should be a scalar, vector, or matrix, but got shape "+l.shape+".");var v=l.rank>0?l.shape[0]:1,m=l.rank>1?l.shape[1]:1;if(f.length!==m)throw new Error("outputShape has incorrect number of elements:, "+f.length+", should be: "+m+".");var g=c.size;if(c.rank!==0&&(c.rank!==1||g!==v))throw new Error("sparseValues has incorrect shape "+c.shape+", should be [] or ["+v+"]");if(c.dtype!==d.dtype)throw new Error("sparseValues.dtype must match defaultValues.dtype")}(a,i,e,s),q.runKernelFunc(function(l){return l.sparseToDense(a,i,e,s)},{$sparseIndices:a,$sparseValues:i,$defaultValue:s})}}),tP=j({gatherND_:function(r,t){var e=B(t,"indices","gatherND","int32"),n=B(r,"x","gatherND");return q.runKernelFunc(function(a){return a.gatherND(n,e)},{x:n,indices:e},null,"GatherNd")}}),nP=j({diag_:function(r){var t=B(r,"x","diag").flatten(),e=r.shape.concat(r.shape);return q.runKernelFunc(function(n){return n.diag(t)},{$x:t}).reshape(e)}}),rP=j({dropout_:function(r,t,e,n){var a=B(r,"x","dropout");if(L(a.dtype==="float32",function(){return"x has to be a floating point tensor since it's going to be scaled, but got a "+a.dtype+" tensor instead."}),L(t>=0&&t<1,function(){return"rate must be a float in the range [0, 1), but got "+t+"."}),t===0)return r instanceof Mt?a.clone():a;var i=function(c,f){if(f==null)return c.shape.slice();if(vn(c.shape,f))return f;if(c.shape.length===f.length){for(var d=[],v=0;v<c.shape.length;v++)f[v]==null&&c.shape[v]!=null?d.push(c.shape[v]):d.push(f[v]);return d}return f}(a,e),s=1-t,l=XE(i,0,1,"float32",n).add(s).floor().div(s);return a.mul(l)}});function QC(r,t,e){for(var n=1-r%2,a=new Float32Array(r),i=0;i<r;++i){var s=2*Math.PI*i/(r+n-1);a[i]=t-e*Math.cos(s)}return $t(a,"float32")}var u0=j({hannWindow_:function(r){return QC(r,.5,.5)}}),JC=j({hammingWindow_:function(r){return QC(r,.54,.46)}}),l0=j({frame_:function(r,t,e,n,a){n===void 0&&(n=!1),a===void 0&&(a=0);for(var i=0,s=[];i+t<=r.size;)s.push(Ea(r,i,t)),i+=e;if(n)for(;i<r.size;){var l=i+t-r.size,c=nn([Ea(r,i,t-l),wa([l],a)]);s.push(c),i+=e}return s.length===0?io([],[0,t]):nn(s).as2D(s.length,t)}}),eR=j({stft_:function(r,t,e,n,a){var i;a===void 0&&(a=u0),n==null&&(i=t,n=Math.floor(Math.pow(2,Math.ceil(Math.log(i)/Math.log(2)))));for(var s=l0(r,t,e),l=Mn(s,a(t)),c=[],f=0;f<s.shape[0];f++)c.push(s0(l.slice([f,0],[1,t]),n));return nn(c)}}),aP=Object.freeze({hannWindow:u0,hammingWindow:JC,frame:l0,stft:eR}),Nn,iP=function(r,t,e){return e===void 0&&(e=1),Ce(this,void 0,void 0,function(){var n,a,i,s,l,c,f,d,v,m,g,b,w,_;return Re(this,function(S){switch(S.label){case 0:return n=B(r,"predictions","inTopK"),a=B(t,"targets","inTopK"),L(n.rank>1,function(){return"inTopK() expects the predictions to be of rank 2 or higher, but got "+n.rank}),L(n.rank-1===a.rank,function(){return"predictions rank should be 1 larger than targets rank, but got predictions rank "+n.rank+" and targets rank "+a.rank}),gt(n.shape.slice(0,n.shape.length-1),a.shape,"predictions's shape should be align with the targets' shape, except the last dimension."),i=n.shape[n.shape.length-1],L(e>0&&e<=i,function(){return"'k' passed to inTopK() must be > 0 && <= the predictions last dimension ("+i+"), but got "+e}),[4,n.data()];case 1:return s=S.sent(),[4,a.data()];case 2:for(l=S.sent(),c=[s.length/i,i],d=c[1],v=Mc("bool",f=c[0]),m=0;m<f;m++){for(g=m*d,b=s.subarray(g,g+d),w=[],_=0;_<b.length;_++)w.push({value:b[_],index:_});for(w.sort(function(E,C){return C.value-E.value}),v[m]=0,_=0;_<e;_++)if(w[_].index===l[m]){v[m]=1;break}}return r!==n&&n.dispose(),t!==a&&a.dispose(),[2,Sn(v,a.shape,"bool")]}})})};(function(r){r[r.NONE=0]="NONE",r[r.MEAN=1]="MEAN",r[r.SUM=2]="SUM",r[r.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"})(Nn||(Nn={}));var oP=j({absoluteDifference_:function(r,t,e,n){n===void 0&&(n=Nn.SUM_BY_NONZERO_WEIGHTS);var a=B(r,"labels","absoluteDifference"),i=B(t,"predictions","absoluteDifference"),s=null;e!=null&&(s=B(e,"weights","absoluteDifference")),gt(a.shape,i.shape,"Error in absoluteDifference: ");var l=a.sub(i).abs();return ci(l,s,n)}}),ci=j({computeWeightedLoss_:function(r,t,e){e===void 0&&(e=Nn.SUM_BY_NONZERO_WEIGHTS);var n=B(r,"losses","computeWeightedLoss"),a=null;t!=null&&(a=B(t,"weights","computeWeightedLoss"));var i=a==null?n:n.mul(a);if(e===Nn.NONE)return i;if(e===Nn.SUM)return i.sum();if(e===Nn.MEAN){if(a==null)return i.mean();var s=n.size/a.size,l=i.sum().div(a.sum());return s>1?l.div(ye(s)):l}if(e===Nn.SUM_BY_NONZERO_WEIGHTS){if(a==null)return i.sum().div(ye(n.size));var c=a.mul(el(n.shape)).notEqual(ye(0)).sum().toFloat();return i.sum().div(c)}throw Error("Unknown reduction: "+e)}}),sP=j({cosineDistance_:function(r,t,e,n,a){a===void 0&&(a=Nn.SUM_BY_NONZERO_WEIGHTS);var i=B(r,"labels","cosineDistance"),s=B(t,"predictions","cosineDistance"),l=null;n!=null&&(l=B(n,"weights","cosineDistance")),gt(i.shape,s.shape,"Error in cosineDistance: ");var c=ye(1).sub(i.mul(s).sum(e,!0));return ci(c,l,a)}}),uP=j({hingeLoss_:function(r,t,e,n){n===void 0&&(n=Nn.SUM_BY_NONZERO_WEIGHTS);var a=B(r,"labels","hingeLoss"),i=B(t,"predictions","hingeLoss"),s=null;e!=null&&(s=B(e,"weights","hingeLoss")),gt(a.shape,i.shape,"Error in hingeLoss: ");var l=ye(1);a=ye(2).mul(a).sub(l);var c=l.sub(a.mul(i)).relu();return ci(c,s,n)}}),lP=j({huberLoss_:function(r,t,e,n,a){n===void 0&&(n=1),a===void 0&&(a=Nn.SUM_BY_NONZERO_WEIGHTS);var i=B(r,"labels","huberLoss"),s=B(t,"predictions","huberLoss"),l=null;e!=null&&(l=B(e,"weights","huberLoss")),gt(i.shape,s.shape,"Error in huberLoss: ");var c=ye(n),f=s.sub(i).abs(),d=MC(f,c),v=f.sub(d),m=ye(.5).mul(d.square()).add(c.mul(v));return ci(m,l,a)}}),cP=j({logLoss_:function(r,t,e,n,a){n===void 0&&(n=1e-7),a===void 0&&(a=Nn.SUM_BY_NONZERO_WEIGHTS);var i=B(r,"labels","logLoss"),s=B(t,"predictions","logLoss"),l=null;e!=null&&(l=B(e,"weights","logLoss")),gt(i.shape,s.shape,"Error in logLoss: ");var c=ye(1),f=ye(n),d=i.mul(s.add(f).log()).neg().sub(c.sub(i).mul(c.sub(s).add(f).log()));return ci(d,l,a)}}),fP=j({meanSquaredError_:function(r,t,e,n){n===void 0&&(n=Nn.SUM_BY_NONZERO_WEIGHTS);var a=B(r,"labels","meanSquaredError"),i=B(t,"predictions","meanSquaredError"),s=null;e!=null&&(s=B(e,"weights","meanSquaredError")),gt(a.shape,i.shape,"Error in meanSquaredError: ");var l=a.squaredDifference(i);return ci(l,s,n)}}),hP=j({sigmoidCrossEntropy_:function(r,t,e,n,a){n===void 0&&(n=0),a===void 0&&(a=Nn.SUM_BY_NONZERO_WEIGHTS);var i=B(r,"multiClassLabels","sigmoidCrossEntropy"),s=B(t,"logits","sigmoidCrossEntropy"),l=null;if(e!=null&&(l=B(e,"weights","sigmoidCrossEntropy")),gt(i.shape,s.shape,"Error in sigmoidCrossEntropy: "),n>0){var c=ye(n),f=ye(1),d=ye(.5);i=i.mul(f.sub(c)).add(d.mul(c))}var v=function(m,g){var b=B(m,"labels","sigmoidCrossEntropyWithLogits"),w=B(g,"logits","sigmoidCrossEntropyWithLogits");gt(b.shape,w.shape,"Error in sigmoidCrossEntropyWithLogits: ");var _=w.relu(),S=w.mul(b),E=w.abs().neg().exp().log1p();return _.sub(S).add(E)}(i,s);return ci(v,l,a)}}),dP=j({softmaxCrossEntropy_:function(r,t,e,n,a){n===void 0&&(n=0),a===void 0&&(a=Nn.SUM_BY_NONZERO_WEIGHTS);var i=B(r,"onehotLabels","softmaxCrossEntropy"),s=B(t,"logits","softmaxCrossEntropy"),l=null;if(e!=null&&(l=B(e,"weights","softmaxCrossEntropy")),gt(i.shape,s.shape,"Error in softmaxCrossEntropy: "),n>0){var c=ye(n),f=ye(1),d=ye(i.shape[1]);i=i.mul(f.sub(c)).add(c.div(d))}var v=function(m,g,b){if(b===void 0&&(b=-1),b===-1&&(b=g.rank-1),b!==g.rank-1)throw Error("Softmax cross entropy along a non-last dimension is not yet supported. Labels / logits was rank "+g.rank+" and dim was "+b);return Yd(function(w,_,S){var E=_.logSumExp([b],!0),C=_.toFloat().sub(E);return S([w,C]),{value:C.mul(w).neg().sum([b]),gradFunc:function(R,T){var D=T[0],k=T[1],M=Jn(R.shape,[b]);return[R.reshape(M).mul(D.toFloat().sub(k.exp())),R.reshape(M).mul(k.exp().sub(D.toFloat()))]}}})(m,g)}(i,s);return ci(v,l,a)}}),pP=Object.freeze({get Reduction(){return Nn},absoluteDifference:oP,computeWeightedLoss:ci,cosineDistance:sP,hingeLoss:uP,huberLoss:lP,logLoss:cP,meanSquaredError:fP,sigmoidCrossEntropy:hP,softmaxCrossEntropy:dP});function T_(r,t){return t===void 0&&(t=!1),q.tidy(function(){if(r.shape.length!==2)throw new Error("qr2d() requires a 2D Tensor, but got a "+r.shape.length+"D Tensor.");for(var e=r.shape[0],n=r.shape[1],a=KE(e),i=r.clone(),s=io([[1]],[1,1]),l=s.clone(),c=e>=n?n:e,f=function(v){var m,g=i,b=l,w=a;m=q.tidy(function(){var _=i.slice([v,v],[e-v,1]),S=_.norm(),E=i.slice([v,v],[1,1]),C=io([[-1]]).where(E.greater(0),io([[1]])),R=E.sub(C.mul(S)),T=_.div(R);l=T.shape[0]===1?s.clone():s.concat(T.slice([1,0],[T.shape[0]-1,T.shape[1]]),0);var D=C.matMul(R).div(S).neg(),k=i.slice([v,0],[e-v,n]),M=D.mul(l);if(v===0)i=k.sub(M.matMul(l.transpose().matMul(k)));else{var N=k.sub(M.matMul(l.transpose().matMul(k)));i=i.slice([0,0],[v,n]).concat(N,0)}var I=a.slice([0,v],[e,a.shape[1]-v]);if(v===0)a=I.sub(I.matMul(l).matMul(M.transpose()));else{var z=I.sub(I.matMul(l).matMul(M.transpose()));a=a.slice([0,0],[e,v]).concat(z,1)}return[l,i,a]}),l=m[0],i=m[1],a=m[2],Qn([g,b,w])},d=0;d<c;++d)f(d);return!t&&e>n&&(a=a.slice([0,0],[e,n]),i=i.slice([0,0],[n,n])),[a,i]})}var vP=j({bandPart_:function(r,t,e){if(t%1!=0)throw new Error("bandPart(): numLower must be an integer, got "+t+".");if(e%1!=0)throw new Error("bandPart(): numUpper must be an integer, got "+e+".");var n=B(r,"a","bandPart");if(n.rank<2)throw new Error("bandPart(): Rank must be at least 2, got "+n.rank+".");var a=n.shape,i=n.shape.slice(-2),s=i[0],l=i[1];if(!(t<=s))throw new Error("bandPart(): numLower ("+t+") must not be greater than the number of rows ("+s+").");if(!(e<=l))throw new Error("bandPart(): numUpper ("+e+") must not be greater than the number of columns ("+l+").");t<0&&(t=s),e<0&&(e=l);var c=Sd(0,s,1,"int32").reshape([-1,1]),f=Sd(0,l,1,"int32"),d=on(c,f),v=Qd(d.lessEqual(ye(+t,"int32")),d.greaterEqual(ye(-e,"int32"))),m=Dt([s,l],n.dtype);return vr(rn(n.reshape([-1,s,l])).map(function(g){return us(v,g,m)})).reshape(a)}}),mP=j({gramSchmidt_:function(r){var t;if(Array.isArray(r)){t=!1,L(r!=null&&r.length>0,function(){return"Gram-Schmidt process: input must not be null, undefined, or empty"});for(var e=r[0].shape[0],n=function(c){L(r[c].shape[0]===e,function(){return"Gram-Schmidt: Non-unique lengths found in the input vectors: ("+r[c].shape[0]+" vs. "+e+")"})},a=1;a<r.length;++a)n(a)}else t=!0,r=Gy(r,r.shape[0],0).map(function(c){return YE(c,[0])});L(r.length<=r[0].shape[0],function(){return"Gram-Schmidt: Number of vectors ("+r.length+") exceeds number of dimensions ("+r[0].shape[0]+")."});var i=[],s=r,l=function(c){i.push(q.tidy(function(){var f=s[c];if(c>0)for(var d=0;d<c;++d){var v=qC(i[d].mulStrict(f)).mul(i[d]);f=f.sub(v)}return f.div(YC(f,"euclidean"))}))};for(a=0;a<r.length;++a)l(a);return t?vr(i,0):i}}),gP=j({qr_:function(r,t){if(t===void 0&&(t=!1),r.rank<2)throw new Error("qr() requires input tensor to have a rank >= 2, but got rank "+r.rank);if(r.rank===2)return T_(r,t);var e=r.shape.slice(0,r.shape.length-2).reduce(function(s,l){return s*l}),n=rn(r.reshape([e,r.shape[r.shape.length-2],r.shape[r.shape.length-1]]),0),a=[],i=[];return n.forEach(function(s){var l=T_(s,t),c=l[0],f=l[1];a.push(c),i.push(f)}),[vr(a,0).reshape(r.shape),vr(i,0).reshape(r.shape)]}}),yP=Object.freeze({bandPart:vP,gramSchmidt:mP,qr:gP});function np(r,t,e,n,a,i){n==null&&(n=.5),a==null&&(a=Number.NEGATIVE_INFINITY),i==null&&(i=0);var s=r.shape[0];return e=Math.min(e,s),L(0<=n&&n<=1,function(){return"iouThreshold must be in [0, 1], but was '"+n+"'"}),L(r.rank===2,function(){return"boxes must be a 2D tensor, but was of rank '"+r.rank+"'"}),L(r.shape[1]===4,function(){return"boxes must have 4 columns, but 2nd dimension was "+r.shape[1]}),L(t.rank===1,function(){return"scores must be a 1D tensor"}),L(t.shape[0]===s,function(){return"scores has incompatible shape with boxes. Expected "+s+", but was "+t.shape[0]}),L(0<=i&&i<=1,function(){return"softNmsSigma must be in [0, 1], but was '"+i+"'"}),{maxOutputSize:e,iouThreshold:n,scoreThreshold:a,softNmsSigma:i}}var bP=j({resizeBilinear_:function(r,t,e){e===void 0&&(e=!1);var n=B(r,"images","resizeBilinear");L(n.rank===3||n.rank===4,function(){return"Error in resizeBilinear: x must be rank 3 or 4, but got rank "+n.rank+"."}),L(t.length===2,function(){return"Error in resizeBilinear: new shape must 2D, but got shape "+t+"."});var a=n,i=!1;n.rank===3&&(i=!0,a=n.as4D(1,n.shape[0],n.shape[1],n.shape[2]));var s=t[0],l=t[1],c=q.runKernelFunc(function(f,d){return d([a]),f.resizeBilinear(a,s,l,e)},{x:a},function(f,d){return{x:function(){return q.runKernelFunc(function(v){return v.resizeBilinearBackprop(f,d[0],e)},{})}}},"ResizeBilinear",{alignCorners:e,newHeight:s,newWidth:l});return i?c.as3D(c.shape[1],c.shape[2],c.shape[3]):c}}),xP=j({resizeNearestNeighbor_:function(r,t,e){e===void 0&&(e=!1);var n=B(r,"images","resizeNearestNeighbor");L(n.rank===3||n.rank===4,function(){return"Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank "+n.rank+"."}),L(t.length===2,function(){return"Error in resizeNearestNeighbor: new shape must 2D, but got shape "+t+"."}),L(n.dtype==="float32"||n.dtype==="int32",function(){return"`images` must have `int32` or `float32` as dtype"});var a=n,i=!1;n.rank===3&&(i=!0,a=n.as4D(1,n.shape[0],n.shape[1],n.shape[2]));var s=t[0],l=t[1],c=q.runKernelFunc(function(f,d){return d([a]),f.resizeNearestNeighbor(a,s,l,e)},{batchImages:a},function(f,d){return{batchImages:function(){return q.runKernelFunc(function(v){return v.resizeNearestNeighborBackprop(f,d[0],e)},{})}}});return i?c.as3D(c.shape[1],c.shape[2],c.shape[3]):c}}),wP=j({nonMaxSuppression_:function(r,t,e,n,a){n===void 0&&(n=.5),a===void 0&&(a=Number.NEGATIVE_INFINITY);var i=B(r,"boxes","nonMaxSuppression"),s=B(t,"scores","nonMaxSuppression"),l=np(i,s,e,n,a);e=l.maxOutputSize,n=l.iouThreshold,a=l.scoreThreshold;var c={maxOutputSize:e,iouThreshold:n,scoreThreshold:a};return q.runKernelFunc(function(f){return f.nonMaxSuppression(i,s,e,n,a)},{boxes:i,scores:s},null,"NonMaxSuppressionV3",c)}}),_P=function(r,t,e,n,a){return n===void 0&&(n=.5),a===void 0&&(a=Number.NEGATIVE_INFINITY),Ce(this,void 0,void 0,function(){var i,s,l,c,f,d,v;return Re(this,function(m){switch(m.label){case 0:return i=B(r,"boxes","nonMaxSuppressionAsync"),s=B(t,"scores","nonMaxSuppressionAsync"),l=np(i,s,e,n,a),e=l.maxOutputSize,n=l.iouThreshold,a=l.scoreThreshold,[4,Promise.all([i.data(),s.data()])];case 1:return c=m.sent(),f=c[0],d=c[1],v=$y(f,d,e,n,a),i!==r&&i.dispose(),s!==t&&s.dispose(),[2,v]}})})},SP=j({nonMaxSuppressionWithScore_:function(r,t,e,n,a,i){n===void 0&&(n=.5),a===void 0&&(a=Number.NEGATIVE_INFINITY),i===void 0&&(i=0);var s=B(r,"boxes","nonMaxSuppression"),l=B(t,"scores","nonMaxSuppression"),c=np(s,l,e,n,a,i),f={maxOutputSize:e=c.maxOutputSize,iouThreshold:n=c.iouThreshold,scoreThreshold:a=c.scoreThreshold,softNmsSigma:i=c.softNmsSigma},d=q.runKernel("NonMaxSuppressionV5",{boxes:s,scores:l},f);return{selectedIndices:d[0],selectedScores:d[1]}}}),EP=function(r,t,e,n,a,i){return n===void 0&&(n=.5),a===void 0&&(a=Number.NEGATIVE_INFINITY),i===void 0&&(i=0),Ce(this,void 0,void 0,function(){var s,l,c,f,d,v,m;return Re(this,function(g){switch(g.label){case 0:return s=B(r,"boxes","nonMaxSuppressionAsync"),l=B(t,"scores","nonMaxSuppressionAsync"),c=np(s,l,e,n,a,i),e=c.maxOutputSize,n=c.iouThreshold,a=c.scoreThreshold,i=c.softNmsSigma,[4,Promise.all([s.data(),l.data()])];case 1:return f=g.sent(),d=f[0],v=f[1],m=Yy(d,v,e,n,a,i),s!==r&&s.dispose(),l!==t&&l.dispose(),[2,m]}})})},CP=j({cropAndResize_:function(r,t,e,n,a,i){var s=B(r,"image","cropAndResize"),l=B(t,"boxes","cropAndResize","float32"),c=B(e,"boxInd","cropAndResize","int32");a=a||"bilinear",i=i||0;var f=l.shape[0];return L(s.rank===4,function(){return"Error in cropAndResize: image must be rank 4,but got rank "+s.rank+"."}),L(l.rank===2&&l.shape[1]===4,function(){return"Error in cropAndResize: boxes must be have size ["+f+",4] but had shape "+l.shape+"."}),L(c.rank===1&&c.shape[0]===f,function(){return"Error in cropAndResize: boxInd must be have size ["+f+"] but had shape "+l.shape+"."}),L(n.length===2,function(){return"Error in cropAndResize: cropSize must be of length 2, but got length "+n.length+"."}),L(n[0]>=1&&n[1]>=1,function(){return"cropSize must be atleast [1,1], but was "+n}),L(a==="bilinear"||a==="nearest",function(){return"method must be bilinear or nearest, but was "+a}),q.runKernelFunc(function(d,v){return d.cropAndResize(s,l,c,n,a,i)},{images:s,boxes:l,boxInd:c},null,"CropAndResize",{method:a,extrapolationValue:i,cropSize:n})}}),c0=Object.freeze({resizeBilinear:bP,resizeNearestNeighbor:xP,nonMaxSuppression:wP,nonMaxSuppressionAsync:_P,nonMaxSuppressionWithScore:SP,nonMaxSuppressionWithScoreAsync:EP,cropAndResize:CP}),f0=function(r,t){return!(r>0)||t==="linear"},h0=function(r,t,e){if(e==null||e==="linear")return r;if(e==="relu")return r.mul(t.step());throw new Error("Gradient for activation "+e+" has not been implemented yet.")},d0=function(r,t){var e=t,n=an(r.shape,t.shape);return n.length>0&&(e=e.sum(n)),e.reshape(r.shape)},p0=function(r,t,e){if(t==="linear")return r;if(t==="relu")return It(r);if(t==="elu")return KC(r);if(t==="relu6")return $C(r);if(t==="prelu")return XC(r,e);throw new Error("Unknown fused activation "+t+".")},RP=j({fusedMatMul_:function(r){var t,e=r.a,n=r.b,a=r.transposeA,i=a!==void 0&&a,s=r.transposeB,l=s!==void 0&&s,c=r.bias,f=r.activation,d=f===void 0?"linear":f,v=r.preluActivationWeights;if(f0(q.state.gradientDepth,d)===!1){var m=ep(e,n,i,l);return c!=null&&(m=nt(m,c)),p0(m,d,v)}var g=B(e,"a","fused matMul"),b=B(n,"b","fused matMul");t=Bt(g,b),g=t[0],b=t[1];var w=i?g.shape[g.rank-2]:g.shape[g.rank-1],_=l?b.shape[b.rank-1]:b.shape[b.rank-2],S=i?g.shape[g.rank-1]:g.shape[g.rank-2],E=l?b.shape[b.rank-2]:b.shape[b.rank-1],C=g.shape.slice(0,-2),R=b.shape.slice(0,-2),T=Te(C),D=Te(R);L(g.rank>=2&&b.rank>=2&&g.rank===b.rank,function(){return"Error in fused matMul: inputs must have the same rank of at least 2, got ranks "+g.rank+" and "+b.rank+"."}),L(vn(C,R),function(){return"Error in fused matMul: outer dimensions ("+C+") and ("+R+") of Tensors with shapes "+g.shape+" and "+b.shape+" must match."}),L(w===_,function(){return"Error in fused matMul: inner shapes ("+w+") and ("+_+") of Tensors with shapes "+g.shape+" and "+b.shape+" and transposeA="+i+" and transposeB="+l+" must match."});var k,M,N=g.shape.slice(0,-2).concat([S,E]),I=i?g.as3D(T,w,S):g.as3D(T,S,w),z=l?b.as3D(D,E,_):b.as3D(D,_,E);c!=null&&it(N,(k=Bt(k=B(c,"bias","fused matMul"),g)[0]).shape),v!=null&&(M=B(v,"prelu weights","fused matMul"));var P={a:I,b:z};c!=null&&(P.bias=k),v!=null&&(P.preluActivationWeights=M);var ne=[I,z];return q.runKernelFunc(function(re,ee){var U=re.fusedBatchMatMul({a:I,b:z,transposeA:i,transposeB:l,bias:k,activation:d,preluActivationWeights:M});return ee([I,z,U]),U},P,function(re,ee){var U=ee[0],G=ee[1],X=ee[2],J=h0(re,X,d),F={};return c!=null&&(F={bias:function(){return d0(k,J)}}),Object.assign(i||l?!i&&l?{a:function(){return J.matMul(G,!1,!1)},b:function(){return J.matMul(U,!0,!1)}}:i&&!l?{a:function(){return G.matMul(J,!1,!0)},b:function(){return U.matMul(J,!1,!1)}}:{a:function(){return G.matMul(J,!0,!0)},b:function(){return J.matMul(U,!0,!0)}}:{a:function(){return J.matMul(G,!1,!0)},b:function(){return U.matMul(J,!0,!1)}},F)},"_FusedMatMul",{transposeA:i,transposeB:l,activation:d},ne,[!0]).reshape(N)}}),TP=j({fusedConv2d_:function(r){var t=r.x,e=r.filter,n=r.strides,a=r.pad,i=r.dataFormat,s=i===void 0?"NHWC":i,l=r.dilations,c=l===void 0?[1,1]:l,f=r.dimRoundingMode,d=r.bias,v=r.activation,m=v===void 0?"linear":v,g=r.preluActivationWeights;if(m=m||"linear",f0(q.state.gradientDepth,m)===!1){var b=Fr(t,e,n,a,s,c,f);return d!=null&&(b=nt(b,d)),p0(b,m,g)}var w=B(t,"x","conv2d"),_=B(e,"filter","conv2d"),S=w,E=!1;w.rank===3&&(E=!0,S=w.as4D(1,w.shape[0],w.shape[1],w.shape[2])),L(S.rank===4,function(){return"Error in fused conv2d: input must be rank 4, but got rank "+S.rank+"."}),L(_.rank===4,function(){return"Error in fused conv2d: filter must be rank 4, but got rank "+_.rank+"."}),f!=null&&L(Wt(a),function(){return"Error in fused conv2d: pad must be an integer when using, dimRoundingMode "+f+" but got pad "+a+"."}),L(S.shape[3]===_.shape[2],function(){return"Error in conv2d: depth of input ("+S.shape[3]+") must match input depth for filter "+_.shape[2]+"."}),L(er(n,c),function(){return"Error in conv2D: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+c+"'"}),L(s==="NHWC",function(){return"Error in conv2d: got dataFormat of "+s+" but only NHWC is currently supported."});var C,R,T=fs(S.shape,_.shape,n,c,a,f);d!=null&&(C=Bt(C=B(d,"bias","fused conv2d"),w)[0],it(T.outShape,C.shape)),g!=null&&(R=B(g,"prelu weights","fused conv2d"));var D={x:S,filter:_};d!=null&&(D.bias=C),g!=null&&(D.preluActivationWeights=R);var k=[_,S],M=q.runKernelFunc(function(N,I){var z=N.fusedConv2d({input:S,filter:_,convInfo:T,bias:C,activation:m,preluActivationWeights:R});return I([_,S,z]),z},D,function(N,I){var z=I,P=z[0],ne=z[1],re=z[2],ee=h0(N,re,m);L(Xu(c),function(){return"Error in gradient of fused conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+c+"'"});var U={};return d!=null&&(U={bias:function(){return d0(C,ee)}}),Object.assign({x:function(){return zC(ne.shape,ee,P,n,a)},filter:function(){return a0(ne,ee,P.shape,n,a)}},U)},"FusedConv2D",{convInfo:T,activation:m},k,[!0]);return E?M.as3D(M.shape[1],M.shape[2],M.shape[3]):M}}),AP=j({fusedDepthwiseConv2d_:function(r){var t=r.x,e=r.filter,n=r.strides,a=r.pad,i=r.dataFormat,s=i===void 0?"NHWC":i,l=r.dilations,c=l===void 0?[1,1]:l,f=r.dimRoundingMode,d=r.bias,v=r.activation,m=v===void 0?"linear":v,g=r.preluActivationWeights;if(f0(q.state.gradientDepth,m)===!1){var b=Jd(t,e,n,a,s,c,f);return d!=null&&(b=nt(b,d)),p0(b,m,g)}var w=B(t,"x","depthwiseConv2d"),_=B(e,"filter","depthwiseConv2d"),S=w,E=!1;w.rank===3&&(E=!0,S=w.as4D(1,w.shape[0],w.shape[1],w.shape[2])),L(S.rank===4,function(){return"Error in fused depthwiseConv2d: input must be rank 4, but got rank "+S.rank+"."}),L(_.rank===4,function(){return"Error in fused depthwiseConv2d: filter must be rank 4, but got rank "+_.rank+"."}),L(S.shape[3]===_.shape[2],function(){return"Error in fused depthwiseConv2d: number of input channels ("+S.shape[3]+") must match the inChannels dimension in filter "+_.shape[2]+"."}),c==null&&(c=[1,1]),L(er(n,c),function(){return"Error in fused depthwiseConv2d: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+c+"'"}),f!=null&&L(Wt(a),function(){return"Error in fused depthwiseConv2d: pad must be an integer when using dimRoundingMode "+f+" but got pad "+a+"."});var C,R,T=fs(S.shape,_.shape,n,c,a,f,!0);d!=null&&(C=Bt(C=B(d,"bias","fused conv2d"),w)[0],it(T.outShape,C.shape)),g!=null&&(R=B(g,"prelu weights","fused depthwiseConv2d"));var D={x:S,filter:_};d!=null&&(D.bias=C),g!=null&&(D.preluActivationWeights=R);var k=[_,S],M=q.runKernelFunc(function(N,I){var z=N.fusedDepthwiseConv2D({input:S,filter:_,convInfo:T,bias:C,activation:m,preluActivationWeights:R});return I([_,S,z]),z},D,function(N,I){L(Xu(c),function(){return"Error in gradient of fused depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '"+c+"'"});var z=I[0],P=I[1],ne=I[2],re=h0(N,ne,m),ee={};return d!=null&&(ee={bias:function(){return d0(C,re)}}),Object.assign({x:function(){return UC(P.shape,re,z,T)},filter:function(){return VC(P,re,z.shape,T)}},ee)},"FusedDepthwiseConv2D",{convInfo:T,activation:m},k,[!0]);return E?M.as3D(M.shape[1],M.shape[2],M.shape[3]):M}}),DP=Object.freeze({matMul:RP,conv2d:TP,depthwiseConv2d:AP}),kP=Object.freeze({image:c0,linalg:yP,losses:pP,spectral:JL,fused:DP,signal:aP,square:cB,squaredDifference:SC,conv1d:bL,conv2d:Fr,conv3d:xL,depthwiseConv2d:Jd,separableConv2d:i0,conv2dTranspose:wL,conv3dTranspose:_L,op:j,batchNormalization2d:UB,batchNormalization3d:VB,batchNormalization4d:HB,batchNormalization:jB,batchNorm:DC,batchNorm2d:WB,batchNorm3d:GB,batchNorm4d:qB,booleanMaskAsync:yL,complex:wn,real:Or,imag:va,concat:nn,concat1d:DM,concat2d:kM,concat3d:OM,concat4d:NM,split:Gy,matMul:ep,dot:SL,outerProduct:EL,reverse:nf,reverse1d:CL,reverse2d:RL,reverse3d:TL,reverse4d:AL,maxPool:hn,avgPool:rf,pool:DL,maxPool3d:kL,avgPool3d:OL,slice:Ea,slice1d:NL,slice2d:ML,slice3d:WC,slice4d:IL,abs:fB,acos:hB,acosh:dB,asin:pB,asinh:vB,atan:mB,atanh:gB,ceil:yB,clipByValue:t0,cos:bB,cosh:xB,erf:wB,exp:py,expm1:_B,floor:SB,log:EB,log1p:CB,logSigmoid:RB,neg:Od,reciprocal:TB,round:AB,rsqrt:EC,sigmoid:CC,sign:DB,isNaN:kB,isInf:OB,isFinite:NB,sin:MB,sinh:IB,softplus:FB,sqrt:BB,step:LB,tan:PB,tanh:zB,all:FL,any:BL,argMax:LL,argMin:PL,logSumExp:zL,max:tp,mean:UL,min:VL,moments:HL,sum:qC,prod:jL,equal:IC,equalStrict:uL,greater:lL,greaterEqual:FC,greaterEqualStrict:cL,greaterStrict:fL,less:hL,lessEqual:dL,lessEqualStrict:pL,lessStrict:vL,notEqual:mL,notEqualStrict:gL,add:nt,addN:$B,addStrict:YB,atan2:ZB,div:Wr,divNoNan:QB,divStrict:JB,floorDiv:NC,maximum:n0,maximumStrict:eL,minimum:MC,minimumStrict:tL,mod:nL,modStrict:rL,mul:Mn,mulStrict:aL,pow:Nd,powStrict:iL,squaredDifferenceStrict:oL,sub:on,subStrict:sL,elu:KC,leakyRelu:WL,prelu:XC,relu:It,relu6:$C,selu:GL,logicalAnd:Qd,logicalNot:KB,logicalOr:kC,logicalXor:XB,where:us,whereAsync:OC,buffer:Ge,print:VM,batchToSpaceND:qE,broadcastTo:HM,cast:jM,clone:WM,cumsum:GM,depthToSpace:qM,expandDims:kr,eye:KE,multinomial:KM,oneHot:cy,pad:cs,pad1d:XM,pad2d:$M,pad3d:YM,pad4d:ZM,rand:QM,randomNormal:JM,randomGamma:eI,randomUniform:XE,reshape:qr,spaceToBatchND:$E,squeeze:YE,stack:vr,tile:gu,truncatedNormal:tI,unstack:rn,setdiff1dAsync:nI,fill:wa,linspace:AM,ones:el,range:Sd,scalar:ye,tensor:Sn,tensor1d:$t,tensor2d:io,tensor3d:Wy,tensor4d:$n,tensor5d:CM,tensor6d:RM,variable:TM,zeros:Dt,onesLike:GE,zerosLike:lt,transpose:po,softmax:li,logSoftmax:lI,localResponseNormalization:qL,norm:YC,gather:r0,unsortedSegmentSum:BC,basicLSTMCell:KL,multiRNNCell:XL,movingAverage:$L,stridedSlice:YL,topk:ZL,scatterND:QL,fft:o0,ifft:Md,rfft:s0,irfft:ZC,sparseToDense:eP,gatherND:tP,diag:nP,dropout:rP,hannWindow:u0,hammingWindow:JC,frame:l0,stft:eR,inTopKAsync:iP});function de(r,t){Array.isArray(r)||(r=[r]),r.forEach(function(e){e!=null&&L(e.dtype!=="complex64",function(){return t+" does not support complex64 tensors."})})}function lg(r,t,e,n){if(e==="linear")return r.linear(t);if(e==="relu")return r.relu(t);if(e==="elu")return r.elu(t);if(e==="relu6")return r.relu6(t);if(e==="prelu")return r.prelu(t,n);throw new Error("Activation "+e+" has not been implemented for the CPU backend.")}var OP=function(r){function t(){var e=r.call(this)||this;return e.blockSize=48,e.firstUse=!0,e.data=new rC(e,q),e}return Qr(t,r),t.prototype.write=function(e,n,a){this.firstUse&&(this.firstUse=!1,le().get("IS_NODE")&&wd(`
============================
Hi there 👋. Looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, which binds to TensorFlow C++, by running npm i @tensorflow/tfjs-node, or npm i @tensorflow/tfjs-node-gpu if you have CUDA. Then call require('@tensorflow/tfjs-node'); (-gpu suffix for CUDA) at the start of your program. Visit https://github.com/tensorflow/tfjs-node for more details.
============================`));var i={};return this.data.set(i,{values:e,dtype:a}),i},t.prototype.move=function(e,n,a,i){this.data.set(e,{values:n,dtype:i})},t.prototype.numDataIds=function(){return this.data.numDataIds()},t.prototype.read=function(e){return Ce(this,void 0,void 0,function(){return Re(this,function(n){return[2,this.readSync(e)]})})},t.prototype.readSync=function(e){var n=this.data.get(e),a=n.dtype,i=n.complexTensors;return a==="complex64"?dy(this.readSync(i.real.dataId),this.readSync(i.imag.dataId)):this.data.get(e).values},t.prototype.bufferSync=function(e){var n=this.readSync(e.dataId),a=n;if(e.dtype==="string")try{a=n.map(function(i){return yd(i)})}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return Ge(e.shape,e.dtype,a)},t.prototype.makeOutput=function(e,n,a){var i=this.write(e,n,a);return q.makeTensorFromDataId(i,n,a,this)},t.prototype.disposeData=function(e){if(this.data.has(e)){var n=this.data.get(e).complexTensors;n!=null&&(n.real.dispose(),n.imag.dispose()),this.data.delete(e)}},t.prototype.time=function(e){return Ce(this,void 0,void 0,function(){var n;return Re(this,function(a){return n=da(),e(),[2,{kernelMs:da()-n}]})})},t.prototype.memory=function(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}},t.prototype.complex=function(e,n){var a=this.makeOutput(null,e.shape,"complex64");return this.data.get(a.dataId).complexTensors={real:q.keep(e.clone()),imag:q.keep(n.clone())},a},t.prototype.real=function(e){return this.data.get(e.dataId).complexTensors.real.clone()},t.prototype.imag=function(e){return this.data.get(e.dataId).complexTensors.imag.clone()},t.prototype.slice=function(e,n,a){if(de(e,"slice"),tC(e.shape,n,a)){var i=nC(n,e.strides),s=Te(a);return Sn(this.readSync(e.dataId).subarray(i,i+s),a,e.dtype)}for(var l=Ge(a,e.dtype),c=this.bufferSync(e),f=0;f<l.size;++f){var d=l.indexToLoc(f).map(function(v,m){return v+n[m]});l.values[f]=c.get.apply(c,d)}return l.toTensor()},t.prototype.stridedSlice=function(e,n,a,i){de(e,"stridedSlice");var s=Ky(n,a,i);if(s.some(function(g){return g===0}))return Sn([],s);for(var l=Ge(s,e.dtype),c=this.bufferSync(e),f=0;f<l.size;f++){for(var d=l.indexToLoc(f),v=new Array(d.length),m=0;m<v.length;m++)v[m]=d[m]*i[m]+n[m];l.set.apply(l,[c.get.apply(c,v)].concat(d))}return l.toTensor()},t.prototype.diag=function(e){for(var n=this.readSync(e.dataId),a=Ge([e.size,e.size],e.dtype),i=a.values,s=0;s<n.length;s++)i[s*e.size+s]=n[s];return a.toTensor()},t.prototype.unstack=function(e,n){for(var a=e.shape[n],i=new Array(e.rank-1),s=0,l=0;l<e.rank;l++)l!==n&&(i[s++]=e.shape[l]);var c=new Array(e.rank).fill(0),f=e.shape.slice();f[n]=1;var d=new Array(a);for(l=0;l<d.length;l++)c[n]=l,d[l]=this.slice(e,c,f).reshape(i);return d},t.prototype.reverse=function(e,n){de(e,"reverse");for(var a=Ge(e.shape,e.dtype),i=this.bufferSync(e),s=function(c){var f=a.indexToLoc(c),d=f.slice();n.forEach(function(v){return d[v]=e.shape[v]-1-d[v]}),a.set.apply(a,[i.get.apply(i,d)].concat(f))},l=0;l<a.size;l++)s(l);return a.toTensor()},t.prototype.concat=function(e,n){var a=this;if(e[0].dtype==="complex64"){var i=e.map(function(g){return Or(g)}),s=e.map(function(g){return va(g)});return wn(this.concat(i,n),this.concat(s,n))}var l=e.map(function(g){var b=Te(g.shape.slice(n));return g.as2D(-1,b)}),c=Ku(l.map(function(g){return g.shape}),1),f=Ge(c,e[0].dtype).values;if(l[0].shape[0]===1){var d=0;l.forEach(function(g){f.set(a.readSync(g.dataId),d),d+=g.size})}else{var v=0;l.forEach(function(g){for(var b=a.readSync(g.dataId),w=0,_=0;_<g.shape[0];++_)for(var S=_*c[1]+v,E=0;E<g.shape[1];++E)f[S+E]=b[w++];v+=g.shape[1]})}var m=Ku(e.map(function(g){return g.shape}),n);return Sn(f,m,e[0].dtype)},t.prototype.neg=function(e){return de(e,"neg"),this.multiply(ye(-1),e)},t.prototype.add=function(e,n){return e.dtype==="complex64"||n.dtype==="complex64"?this.broadcastedBinaryComplexOp(e.cast("complex64"),n.cast("complex64"),function(a,i,s,l){return{real:a+s,imag:i+l}}):this.broadcastedBinaryOp(e,n,_n(e.dtype,n.dtype),function(a,i){return a+i})},t.prototype.addN=function(e){var n=this;de(e,"addN");for(var a=e.map(function(d){return n.readSync(d.dataId)}),i=Ge(e[0].shape,e[0].dtype),s=i.values,l=0;l<e.length;l++)for(var c=a[l],f=0;f<s.length;f++)s[f]+=c[f];return i.toTensor()},t.prototype.softmax=function(e,n){var a=sn([n],e.shape),i=this.max(e,a),s=Jn(i.shape,a),l=this.subtract(e,i.reshape(s)),c=this.exp(l),f=this.sum(c,a).reshape(s);return this.realDivide(c,f)},t.prototype.subtract=function(e,n){return e.dtype==="complex64"||n.dtype==="complex64"?this.broadcastedBinaryComplexOp(e.cast("complex64"),n.cast("complex64"),function(a,i,s,l){return{real:a-s,imag:i-l}}):this.broadcastedBinaryOp(e,n,_n(e.dtype,n.dtype),function(a,i){return a-i})},t.prototype.pow=function(e,n){return de([e,n],"pow"),this.broadcastedBinaryOp(e,n,e.dtype,function(a,i){return Math.pow(a,i)})},t.prototype.batchMatMul=function(e,n,a,i){de([e,n],"matMul");for(var s=a?e.shape[1]:e.shape[2],l=a?e.shape[2]:e.shape[1],c=i?n.shape[1]:n.shape[2],f=e.shape[0],d=this.readSync(e.dataId),v=this.readSync(n.dataId),m=a?[e.strides[0],1,e.strides[1]]:[e.strides[0],e.strides[1],1],g=m[0],b=m[1],w=m[2],_=i?[1,n.strides[1],n.strides[0]]:[n.strides[1],1,n.strides[0]],S=_[0],E=_[1],C=_[2],R=l*c,T=Ge([f,l,c],e.dtype),D=T.values,k=this.blockSize,M=0;M<f;M++)for(var N=0;N<l;N+=k)for(var I=0;I<c;I+=k)for(var z=0;z<s;z+=k)for(var P=Math.min(N+k,l),ne=Math.min(I+k,c),re=Math.min(z+k,s),ee=N;ee<P;ee++)for(var U=I;U<ne;U++){for(var G=0,X=z;X<re;X++)G+=d[M*g+ee*b+X*w]*v[X*S+U*E+M*C];D[M*R+(ee*c+U)]+=G}return T.toTensor()},t.prototype.fusedBatchMatMul=function(e){var n=e.a,a=e.b,i=e.transposeA,s=e.transposeB,l=e.bias,c=e.activation,f=e.preluActivationWeights,d=this.batchMatMul(n,a,i,s);return l&&(d=this.add(d,l)),c&&(d=lg(this,d,c,f)),d},t.prototype.multiply=function(e,n){return e.dtype==="complex64"||n.dtype==="complex64"?this.broadcastedBinaryComplexOp(e.cast("complex64"),n.cast("complex64"),function(a,i,s,l){return{real:a*s-i*l,imag:a*l+i*s}}):this.broadcastedBinaryOp(e,n,_n(e.dtype,n.dtype),function(a,i){return a*i})},t.prototype.realDivide=function(e,n){return de([e,n],"realDivide"),this.broadcastedBinaryOp(e,n,"float32",function(a,i){return a/i})},t.prototype.floorDiv=function(e,n){return de([e,n],"floorDiv"),this.broadcastedBinaryOp(e,n,"int32",function(a,i){return Math.floor(a/i)})},t.prototype.sum=function(e,n){de(e,"sum"),lr("sum",n,e.rank);for(var a=Dn(e.shape,n),i=a[0],s=a[1],l=Dt(i,_n(e.dtype,"int32")),c=Te(s),f=this.readSync(l.dataId),d=this.readSync(e.dataId),v=0;v<f.length;++v){for(var m=v*c,g=0,b=0;b<c;++b)g+=d[m+b];f[v]=g}return l},t.prototype.prod=function(e,n){de(e,"sum");for(var a=Dn(e.shape,n),i=a[0],s=a[1],l=Dt(i,_n(e.dtype,"int32")),c=Te(s),f=this.readSync(l.dataId),d=this.readSync(e.dataId),v=0;v<f.length;++v){for(var m=v*c,g=1,b=0;b<c;++b)g*=d[m+b];f[v]=g}return l},t.prototype.unsortedSegmentSum=function(e,n,a){de(e,"unsortedSegmentSum");for(var i=[],s=e.rank-n.rank,l=0;l<s;++l)n=n.expandDims(l+1);for(l=0;l<a;++l){var c=ye(l,"int32"),f=IC(c,n).asType("float32").mul(e).sum(0);i.push(f)}return vr(i)},t.prototype.argMin=function(e,n){de(e,"argMin");var a=[n];lr("argMin",a,e.rank);for(var i=Dn(e.shape,a),s=i[0],l=i[1],c=Dt(s,"int32"),f=Te(l),d=this.readSync(c.dataId),v=this.readSync(e.dataId),m=0;m<d.length;++m){for(var g=m*f,b=v[g],w=0,_=0;_<f;++_){var S=v[g+_];S<b&&(b=S,w=_)}d[m]=w}return c},t.prototype.argMax=function(e,n){de(e,"argMax");var a=[n];lr("argMax",a,e.rank);for(var i=Dn(e.shape,a),s=i[0],l=i[1],c=Dt(s,"int32"),f=Te(l),d=this.readSync(c.dataId),v=this.readSync(e.dataId),m=0;m<d.length;++m){for(var g=m*f,b=v[g],w=0,_=0;_<f;++_){var S=v[g+_];S>b&&(b=S,w=_)}d[m]=w}return c},t.prototype.cumsum=function(e,n,a,i){if(de(e,"cumsum"),n!==e.rank-1)throw new Error("backend.cumsum in CPU expects an inner-most axis="+(e.rank-1)+" but got axis="+n);for(var s=_n(e.dtype,"int32"),l=Dt(e.shape,s),c=this.readSync(l.dataId),f=this.readSync(e.dataId),d=e.shape[e.rank-1],v=i?function(_,S){return _+d-S-1}:function(_,S){return _+S},m=0;m<f.length;m+=d)for(var g=0;g<d;g++){var b=v(m,g);if(g===0)c[b]=a?0:f[b];else{var w=v(m,g-1);c[b]=a?f[w]+c[w]:f[b]+c[w]}}return l},t.prototype.equal=function(e,n){return de([e,n],"equal"),this.broadcastedBinaryOp(e,n,"bool",function(a,i){return a===i?1:0})},t.prototype.notEqual=function(e,n){return de([e,n],"notEqual"),this.broadcastedBinaryOp(e,n,"bool",function(a,i){return a!==i?1:0})},t.prototype.less=function(e,n){return de([e,n],"less"),this.broadcastedBinaryOp(e,n,"bool",function(a,i){return a<i?1:0})},t.prototype.lessEqual=function(e,n){return de([e,n],"lessEqual"),this.broadcastedBinaryOp(e,n,"bool",function(a,i){return a<=i?1:0})},t.prototype.greater=function(e,n){return de([e,n],"greater"),this.broadcastedBinaryOp(e,n,"bool",function(a,i){return a>i?1:0})},t.prototype.greaterEqual=function(e,n){return de([e,n],"greaterEqual"),this.broadcastedBinaryOp(e,n,"bool",function(a,i){return a>=i?1:0})},t.prototype.logicalNot=function(e){de(e,"logicalNot");for(var n=this.readSync(e.dataId),a=new Uint8Array(n.length),i=0;i<n.length;++i)a[i]=n[i]?0:1;return this.makeOutput(a,e.shape,"bool")},t.prototype.logicalAnd=function(e,n){return de([e,n],"logicalAnd"),this.broadcastedBinaryOp(e,n,"bool",function(a,i){return a&&i})},t.prototype.logicalOr=function(e,n){return de([e,n],"logicalOr"),this.broadcastedBinaryOp(e,n,"bool",function(a,i){return a||i})},t.prototype.select=function(e,n,a){de([e,n,a],"select");for(var i=this.readSync(e.dataId),s=this.readSync(n.dataId),l=this.readSync(a.dataId),c=Dt(n.shape,_n(n.dtype,a.dtype)),f=this.readSync(c.dataId),d=0,v=e.rank===0||e.rank>1||n.rank===1?1:Te(n.shape.slice(1)),m=0;m<i.length;m++)for(var g=0;g<v;g++)i[m]===1?f[d++]=s[m]:f[d++]=l[m];return c},t.prototype.where=function(e){de([e],"where");var n=this.readSync(e.dataId);return Zy(e.shape,n)},t.prototype.topk=function(e,n,a){return de(e,"topk"),fC(this.readSync(e.dataId),e.shape,e.dtype,n)},t.prototype.min=function(e,n){de(e,"min"),lr("min",n,e.rank);for(var a=Dn(e.shape,n),i=a[0],s=a[1],l=Dt(i,e.dtype),c=Te(s),f=this.readSync(l.dataId),d=this.readSync(e.dataId),v=0;v<f.length;++v){for(var m=v*c,g=d[m],b=0;b<c;++b){var w=d[m+b];w<g&&(g=w)}f[v]=g}return l},t.prototype.minimum=function(e,n){return de([e,n],"minimum"),this.broadcastedBinaryOp(e,n,e.dtype,function(a,i){return Math.min(a,i)})},t.prototype.mod=function(e,n){return de([e,n],"mod"),this.broadcastedBinaryOp(e,n,e.dtype,function(a,i){var s=a%i;return a<0&&i<0||a>=0&&i>=0?s:(s+i)%i})},t.prototype.max=function(e,n){de(e,"max"),lr("max",n,e.rank);for(var a=Dn(e.shape,n),i=a[0],s=a[1],l=Dt(i,e.dtype),c=Te(s),f=this.readSync(l.dataId),d=this.readSync(e.dataId),v=0;v<f.length;++v){for(var m=v*c,g=d[m],b=0;b<c;++b){var w=d[m+b];w>g&&(g=w)}f[v]=g}return l},t.prototype.maximum=function(e,n){return de([e,n],"maximum"),this.broadcastedBinaryOp(e,n,e.dtype,function(a,i){return Math.max(a,i)})},t.prototype.all=function(e,n){de(e,"all"),lr("all",n,e.rank);for(var a=Dn(e.shape,n),i=a[0],s=a[1],l=Dt(i,e.dtype),c=Te(s),f=this.readSync(l.dataId),d=this.readSync(e.dataId),v=0;v<f.length;++v){for(var m=v*c,g=d[m],b=0;b<c;++b){var w=d[m+b];g=g&&w}f[v]=g}return l},t.prototype.any=function(e,n){de(e,"any"),lr("any",n,e.rank);for(var a=Dn(e.shape,n),i=a[0],s=a[1],l=Dt(i,e.dtype),c=Te(s),f=this.readSync(l.dataId),d=this.readSync(e.dataId),v=0;v<f.length;++v){for(var m=v*c,g=d[m],b=0;b<c;++b){var w=d[m+b];g=g||w}f[v]=g}return l},t.prototype.squaredDifference=function(e,n){return de([e,n],"squaredDifference"),this.broadcastedBinaryOp(e,n,e.dtype,function(a,i){var s=a-i;return s*s})},t.prototype.ceil=function(e){de(e,"ceil");for(var n=this.readSync(e.dataId),a=new Float32Array(n.length),i=0;i<n.length;++i)a[i]=Math.ceil(n[i]);return this.makeOutput(a,e.shape,"float32")},t.prototype.floor=function(e){de(e,"floor");for(var n=this.readSync(e.dataId),a=new Float32Array(n.length),i=0;i<n.length;++i)a[i]=Math.floor(n[i]);return this.makeOutput(a,e.shape,"float32")},t.prototype.sign=function(e){de(e,"x");for(var n=this.readSync(e.dataId),a=new Float32Array(n.length),i=0;i<n.length;++i)n[i]<0?a[i]=-1:n[i]>0?a[i]=1:a[i]=0;return this.makeOutput(a,e.shape,"float32")},t.prototype.isNaN=function(e){de(e,"x");for(var n=this.readSync(e.dataId),a=new Uint8Array(n.length),i=0;i<n.length;++i)Number.isNaN(n[i])&&(a[i]=1);return this.makeOutput(a,e.shape,"bool")},t.prototype.isInf=function(e){de(e,"x");for(var n=this.readSync(e.dataId),a=new Uint8Array(n.length),i=0;i<n.length;++i)Math.abs(n[i])===1/0&&(a[i]=1);return this.makeOutput(a,e.shape,"bool")},t.prototype.isFinite=function(e){de(e,"x");for(var n=this.readSync(e.dataId),a=new Uint8Array(n.length),i=0;i<n.length;++i)Number.isFinite(n[i])&&(a[i]=1);return this.makeOutput(a,e.shape,"bool")},t.prototype.round=function(e){de(e,"round");for(var n=this.readSync(e.dataId),a=new Float32Array(n.length),i=0;i<n.length;++i){var s=Math.floor(n[i]);n[i]-s<.5?a[i]=Math.floor(n[i]):n[i]-s>.5?a[i]=Math.ceil(n[i]):a[i]=s%2==0?s:s+1}return this.makeOutput(a,e.shape,"float32")},t.prototype.exp=function(e){de(e,"exp");for(var n=this.readSync(e.dataId),a=new Float32Array(n.length),i=0;i<n.length;++i)a[i]=Math.exp(n[i]);return this.makeOutput(a,e.shape,"float32")},t.prototype.expm1=function(e){de(e,"expm1");for(var n=this.readSync(e.dataId),a=new Float32Array(n.length),i=0;i<n.length;++i)a[i]=Math.expm1(n[i]);return this.makeOutput(a,e.shape,"float32")},t.prototype.log=function(e){de(e,"log");for(var n=this.readSync(e.dataId),a=new Float32Array(n.length),i=0;i<n.length;++i){var s=n[i];a[i]=Math.log(s)}return this.makeOutput(a,e.shape,"float32")},t.prototype.log1p=function(e){de(e,"log1p");for(var n=this.readSync(e.dataId),a=new Float32Array(n.length),i=0;i<n.length;++i){var s=n[i];a[i]=Math.log1p(s)}return this.makeOutput(a,e.shape,"float32")},t.prototype.sqrt=function(e){de(e,"sqrt");for(var n=this.readSync(e.dataId),a=new Float32Array(n.length),i=0;i<n.length;++i){var s=n[i];a[i]=Math.sqrt(s)}return this.makeOutput(a,e.shape,"float32")},t.prototype.rsqrt=function(e){de(e,"rsqrt");for(var n=this.readSync(e.dataId),a=new Float32Array(n.length),i=0;i<n.length;++i){var s=n[i];a[i]=1/Math.sqrt(s)}return this.makeOutput(a,e.shape,"float32")},t.prototype.reciprocal=function(e){de(e,"reciprocal");for(var n=this.readSync(e.dataId),a=new Float32Array(n.length),i=0;i<n.length;++i)a[i]=1/n[i];return this.makeOutput(a,e.shape,"float32")},t.prototype.linear=function(e){return e},t.prototype.relu=function(e){de(e,"relu");for(var n=Dt(e.shape,e.dtype),a=this.readSync(n.dataId),i=this.readSync(e.dataId),s=0;s<i.length;++s)a[s]=Math.max(0,i[s]);return n},t.prototype.relu6=function(e){de(e,"relu");for(var n=Dt(e.shape,e.dtype),a=this.readSync(n.dataId),i=this.readSync(e.dataId),s=0;s<i.length;++s)a[s]=Math.min(Math.max(0,i[s]),6);return n},t.prototype.prelu=function(e,n){return de([e,n],"prelu"),this.broadcastedBinaryOp(e,n,e.dtype,function(a,i){return a<0?i*a:a})},t.prototype.elu=function(e){de(e,"elu");for(var n=new Float32Array(e.size),a=this.readSync(e.dataId),i=0;i<a.length;++i){var s=a[i];n[i]=s>=0?s:Math.exp(s)-1}return this.makeOutput(n,e.shape,"float32")},t.prototype.eluDer=function(e,n){de([e,n],"eluDer");for(var a=new Float32Array(n.size),i=this.readSync(n.dataId),s=this.readSync(e.dataId),l=0;l<i.length;++l){var c=i[l];a[l]=c>=1?s[l]:s[l]*(c+1)}return this.makeOutput(a,n.shape,"float32")},t.prototype.selu=function(e){de(e,"selu");for(var n=Jy,a=e0,i=new Float32Array(e.size),s=this.readSync(e.dataId),l=0;l<s.length;++l){var c=s[l];i[l]=c>=0?a*c:n*(Math.exp(c)-1)}return this.makeOutput(i,e.shape,"float32")},t.prototype.clip=function(e,n,a){de(e,"clip");for(var i=new Float32Array(e.size),s=this.readSync(e.dataId),l=0;l<s.length;++l){var c=s[l];i[l]=c>a?a:c<n?n:c}return this.makeOutput(i,e.shape,"float32")},t.prototype.abs=function(e){for(var n=new Float32Array(e.size),a=this.readSync(e.dataId),i=0;i<a.length;++i)n[i]=Math.abs(a[i]);return this.makeOutput(n,e.shape,"float32")},t.prototype.complexAbs=function(e){for(var n=new Float32Array(e.size),a=this.readSync(e.dataId),i=0;i<e.size;++i){var s=a[2*i],l=a[2*i+1];n[i]=Math.hypot(s,l)}return this.makeOutput(n,e.shape,"float32")},t.prototype.int=function(e){de(e,"int");for(var n=new Int32Array(e.size),a=this.readSync(e.dataId),i=0;i<a.length;++i)n[i]=a[i];return this.makeOutput(n,e.shape,"int32")},t.prototype.sigmoid=function(e){de(e,"sigmoid");for(var n=new Float32Array(e.size),a=this.readSync(e.dataId),i=0;i<a.length;++i)n[i]=1/(1+Math.exp(-a[i]));return this.makeOutput(n,e.shape,"float32")},t.prototype.softplus=function(e){de(e,"softplus");for(var n=Math.log(11920928955078125e-23)+2,a=new Float32Array(e.size),i=this.readSync(e.dataId),s=0;s<i.length;++s){var l=i[s]>-n,c=i[s]<n,f=Math.exp(i[s]),d=void 0;d=c?f:l?i[s]:Math.log(1+f),a[s]=d}return this.makeOutput(a,e.shape,"float32")},t.prototype.sin=function(e){de(e,"sin");for(var n=new Float32Array(e.size),a=this.readSync(e.dataId),i=0;i<a.length;++i)n[i]=Math.sin(a[i]);return this.makeOutput(n,e.shape,"float32")},t.prototype.cos=function(e){de(e,"cos");for(var n=new Float32Array(e.size),a=this.readSync(e.dataId),i=0;i<a.length;++i)n[i]=Math.cos(a[i]);return this.makeOutput(n,e.shape,"float32")},t.prototype.tan=function(e){de(e,"tan");for(var n=new Float32Array(e.size),a=this.readSync(e.dataId),i=0;i<a.length;++i)n[i]=Math.tan(a[i]);return this.makeOutput(n,e.shape,"float32")},t.prototype.asin=function(e){de(e,"asin");for(var n=new Float32Array(e.size),a=this.readSync(e.dataId),i=0;i<a.length;++i)n[i]=Math.asin(a[i]);return this.makeOutput(n,e.shape,"float32")},t.prototype.acos=function(e){de(e,"acos");for(var n=new Float32Array(e.size),a=this.readSync(e.dataId),i=0;i<a.length;++i)n[i]=Math.acos(a[i]);return this.makeOutput(n,e.shape,"float32")},t.prototype.atan=function(e){de(e,"atan");for(var n=new Float32Array(e.size),a=this.readSync(e.dataId),i=0;i<a.length;++i)n[i]=Math.atan(a[i]);return this.makeOutput(n,e.shape,"float32")},t.prototype.atan2=function(e,n){return de([e,n],"atan2"),this.broadcastedBinaryOp(e,n,e.dtype,function(a,i){return Math.atan2(a,i)})},t.prototype.sinh=function(e){de(e,"sinh");for(var n=new Float32Array(e.size),a=this.readSync(e.dataId),i=0;i<a.length;++i)n[i]=Math.sinh(a[i]);return this.makeOutput(n,e.shape,"float32")},t.prototype.cosh=function(e){de(e,"cosh");for(var n=new Float32Array(e.size),a=this.readSync(e.dataId),i=0;i<a.length;++i)n[i]=Math.cosh(a[i]);return this.makeOutput(n,e.shape,"float32")},t.prototype.tanh=function(e){de(e,"tanh");for(var n=new Float32Array(e.size),a=this.readSync(e.dataId),i=0;i<a.length;++i)n[i]=N4(a[i]);return this.makeOutput(n,e.shape,"float32")},t.prototype.asinh=function(e){de(e,"asinh");for(var n=new Float32Array(e.size),a=this.readSync(e.dataId),i=0;i<a.length;++i)n[i]=Math.asinh(a[i]);return this.makeOutput(n,e.shape,"float32")},t.prototype.acosh=function(e){de(e,"acosh");for(var n=new Float32Array(e.size),a=this.readSync(e.dataId),i=0;i<a.length;++i)n[i]=Math.acosh(a[i]);return this.makeOutput(n,e.shape,"float32")},t.prototype.atanh=function(e){de(e,"atanh");for(var n=new Float32Array(e.size),a=this.readSync(e.dataId),i=0;i<a.length;++i)n[i]=Math.atanh(a[i]);return this.makeOutput(n,e.shape,"float32")},t.prototype.erf=function(e){de(e,"erf");for(var n=new Float32Array(e.size),a=this.readSync(e.dataId),i=0;i<a.length;++i){var s=Math.sign(a[i]),l=Math.abs(a[i]),c=1/(1+.3275911*l);n[i]=s*(1-((((1.061405429*c-1.453152027)*c+1.421413741)*c-.284496736)*c+.254829592)*c*Math.exp(-l*l))}return this.makeOutput(n,e.shape,"float32")},t.prototype.step=function(e,n){n===void 0&&(n=0),de(e,"step");for(var a=new Float32Array(e.size),i=this.readSync(e.dataId),s=0;s<i.length;++s){var l=i[s];isNaN(l)?a[s]=NaN:a[s]=l>0?1:n}return this.makeOutput(a,e.shape,"float32")},t.prototype.fusedConv2d=function(e){var n=e.input,a=e.filter,i=e.convInfo,s=e.bias,l=e.activation,c=e.preluActivationWeights,f=this.conv2d(n,a,i);return s&&(f=this.add(f,s)),l&&(f=lg(this,f,l,c)),f},t.prototype.conv2d=function(e,n,a){de([e,n],"conv2d");for(var i=a.filterHeight,s=a.filterWidth,l=a.dilationHeight,c=a.dilationWidth,f=a.padInfo.left,d=a.padInfo.top,v=a.dataFormat==="channelsLast",m=Ge(a.outShape,e.dtype),g=e.strides[0],b=v?e.strides[1]:e.strides[2],w=v?e.strides[2]:1,_=v?1:e.strides[1],S=m.strides[0],E=v?m.strides[1]:m.strides[2],C=v?m.strides[2]:1,R=v?1:m.strides[1],T=this.readSync(e.dataId),D=this.readSync(n.dataId),k=m.values,M=0;M<a.batchSize;++M)for(var N=M*g,I=M*S,z=0;z<a.outHeight;++z)for(var P=I+z*E,ne=z*a.strideHeight-d,re=0;re<i;re++){var ee=ne+re*l;if(!(ee<0||ee>=a.inHeight))for(var U=re*n.strides[0],G=N+ee*b,X=0;X<a.outWidth;++X)for(var J=P+X*C,F=X*a.strideWidth-f,K=0;K<s;K++){var oe=F+K*c;if(!(oe<0||oe>=a.inWidth))for(var ue=G+oe*w,pe=U+K*n.strides[1],ge=0;ge<a.inChannels;++ge){for(var me=T[ue+ge*_],Ne=0;Ne<a.outChannels;++Ne)k[J+Ne*R]+=me*D[pe+Ne];pe+=a.outChannels}}}return m.toTensor()},t.prototype.conv3d=function(e,n,a){for(var i=a.filterDepth,s=a.filterHeight,l=a.filterWidth,c=a.dilationDepth,f=a.dilationHeight,d=a.dilationWidth,v=a.padInfo.front,m=a.padInfo.left,g=a.padInfo.top,b=Ge(a.outShape,e.dtype),w=this.readSync(e.dataId),_=this.readSync(n.dataId),S=b.values,E=0;E<a.batchSize;++E)for(var C=E*e.strides[0],R=E*b.strides[0],T=0;T<a.outDepth;++T)for(var D=R+T*b.strides[1],k=T*a.strideDepth-v,M=0;M<i;M++){var N=k+M*c;if(!(N<0||N>=a.inDepth))for(var I=M*n.strides[0],z=C+N*e.strides[1],P=0;P<a.outHeight;++P)for(var ne=D+P*b.strides[2],re=P*a.strideHeight-g,ee=0;ee<s;ee++){var U=re+ee*f;if(!(U<0||U>=a.inHeight))for(var G=I+ee*n.strides[1],X=z+U*e.strides[2],J=0;J<a.outWidth;++J)for(var F=ne+J*a.outChannels,K=J*a.strideWidth-m,oe=0;oe<l;oe++){var ue=K+oe*d;if(!(ue<0||ue>=a.inWidth))for(var pe=G+oe*n.strides[2],ge=X+ue*a.inChannels,me=pe,Ne=0;Ne<a.inChannels;++Ne){for(var xe=w[ge+Ne],Ie=0;Ie<a.outChannels;++Ie)S[F+Ie]+=xe*_[me+Ie];me+=a.outChannels}}}}return b.toTensor()},t.prototype.conv2dDerInput=function(e,n,a){de([e,n],"conv2dDerInput");for(var i=Ge(a.inShape,"float32"),s=i.values,l=this.readSync(e.dataId),c=this.readSync(n.dataId),f=n.strides,d=f[0],v=f[1],m=f[2],g=a.batchSize,b=a.filterHeight,w=a.filterWidth,_=a.inChannels,S=a.inHeight,E=a.inWidth,C=a.outChannels,R=a.outHeight,T=a.outWidth,D=a.strideHeight,k=a.strideWidth,M=a.dataFormat,N=b-1-a.padInfo.top,I=w-1-a.padInfo.left,z=M==="channelsLast",P=i.strides[0],ne=z?i.strides[1]:i.strides[2],re=z?i.strides[2]:1,ee=z?1:i.strides[1],U=e.strides[0],G=z?e.strides[1]:e.strides[2],X=z?e.strides[2]:1,J=z?1:e.strides[1],F=0;F<g;++F)for(var K=0;K<_;++K)for(var oe=0;oe<S;++oe)for(var ue=oe-N,pe=Math.max(0,Math.ceil(ue/D)),ge=Math.min(R,(b+ue)/D),me=0;me<E;++me){for(var Ne=me-I,xe=Math.max(0,Math.ceil(Ne/k)),Ie=Math.min(T,(w+Ne)/k),ct=0,Pe=pe;Pe<ge;++Pe)for(var qe=Pe*D-ue,Je=xe;Je<Ie;++Je)for(var dt=U*F+G*Pe+X*Je,Et=d*(b-1-qe)+v*(w-1-(Je*k-Ne))+m*K,xt=0;xt<C;++xt)ct+=l[dt+J*xt]*c[Et+xt];s[P*F+ne*oe+re*me+ee*K]=ct}return i.toTensor()},t.prototype.conv3dDerInput=function(e,n,a){for(var i=Ge(a.inShape,"float32"),s=i.values,l=i.strides,c=l[0],f=l[1],d=l[2],v=l[3],m=this.readSync(e.dataId),g=e.strides,b=g[0],w=g[1],_=g[2],S=g[3],E=this.readSync(n.dataId),C=n.strides,R=C[0],T=C[1],D=C[2],k=C[3],M=a.batchSize,N=a.filterDepth,I=a.filterHeight,z=a.filterWidth,P=a.inChannels,ne=a.inDepth,re=a.inHeight,ee=a.inWidth,U=a.outChannels,G=a.outDepth,X=a.outHeight,J=a.outWidth,F=a.strideDepth,K=a.strideHeight,oe=a.strideWidth,ue=N-1-a.padInfo.front,pe=I-1-a.padInfo.top,ge=z-1-a.padInfo.left,me=0;me<M;++me)for(var Ne=0;Ne<P;++Ne)for(var xe=0;xe<ne;++xe)for(var Ie=xe-ue,ct=Math.max(0,Math.ceil(Ie/F)),Pe=Math.min(G,(N+Ie)/F),qe=0;qe<re;++qe)for(var Je=qe-pe,dt=Math.max(0,Math.ceil(Je/K)),Et=Math.min(X,(I+Je)/K),xt=0;xt<ee;++xt){for(var Vt=xt-ge,gr=Math.max(0,Math.ceil(Vt/oe)),En=Math.min(J,(z+Vt)/oe),ka=0,Vn=ct;Vn<Pe;++Vn)for(var ea=Vn*F-Ie,yr=dt;yr<Et;++yr)for(var pi=yr*K-Je,Br=gr;Br<En;++Br)for(var Oa=b*me+w*Vn+_*yr+S*Br,Gt=R*(N-1-ea)+T*(I-1-pi)+D*(z-1-(Br*oe-Vt))+k*Ne,Yt=0;Yt<U;++Yt)ka+=m[Oa+Yt]*E[Gt+Yt];s[c*me+f*xe+d*qe+v*xt+Ne]=ka}return i.toTensor()},t.prototype.conv2dDerFilter=function(e,n,a){de([e,n],"conv2dDerFilter");for(var i=a.strideHeight,s=a.strideWidth,l=a.filterHeight,c=a.filterWidth,f=a.dataFormat==="channelsLast",d=Ge(a.filterShape,"float32"),v=a.padInfo.left,m=a.padInfo.top,g=this.bufferSync(e),b=this.bufferSync(n),w=0;w<l;++w)for(var _=Math.max(0,Math.ceil((m-w)/i)),S=Math.min(a.outHeight,(a.inHeight+m-w)/i),E=0;E<c;++E)for(var C=Math.max(0,Math.ceil((v-E)/s)),R=Math.min(a.outWidth,(a.inWidth+v-E)/s),T=0;T<a.inChannels;++T)for(var D=0;D<a.outChannels;++D){for(var k=0,M=0;M<a.batchSize;++M)for(var N=_;N<S;++N)for(var I=w+N*i-m,z=C;z<R;++z){var P=E+z*s-v;k+=f?g.get(M,I,P,T)*b.get(M,N,z,D):g.get(M,T,I,P)*b.get(M,D,N,z)}d.set(k,w,E,T,D)}return d.toTensor()},t.prototype.conv3dDerFilter=function(e,n,a){for(var i=a.strideDepth,s=a.strideHeight,l=a.strideWidth,c=a.filterDepth,f=a.filterHeight,d=a.filterWidth,v=Ge(a.filterShape,"float32"),m=v.values,g=v.strides,b=g[0],w=g[1],_=g[2],S=g[3],E=this.readSync(n.dataId),C=n.strides,R=C[0],T=C[1],D=C[2],k=C[3],M=this.readSync(e.dataId),N=e.strides,I=N[0],z=N[1],P=N[2],ne=N[3],re=a.padInfo.front,ee=a.padInfo.left,U=a.padInfo.top,G=0;G<c;++G)for(var X=Math.max(0,Math.ceil((re-G)/i)),J=Math.min(a.outDepth,(a.inDepth+re-G)/i),F=G*b,K=0;K<f;++K)for(var oe=Math.max(0,Math.ceil((U-K)/s)),ue=Math.min(a.outHeight,(a.inHeight+U-K)/s),pe=K*w+F,ge=0;ge<d;++ge)for(var me=Math.max(0,Math.ceil((ee-ge)/l)),Ne=Math.min(a.outWidth,(a.inWidth+ee-ge)/l),xe=ge*_+pe,Ie=0;Ie<a.inChannels;++Ie)for(var ct=Ie*S+xe,Pe=0;Pe<a.outChannels;++Pe){for(var qe=0,Je=0;Je<a.batchSize;++Je)for(var dt=Je*I,Et=Je*R,xt=X;xt<J;++xt)for(var Vt=(G+xt*i-re)*z+dt,gr=xt*T+Et,En=oe;En<ue;++En)for(var ka=(K+En*s-U)*P+Vt,Vn=En*D+gr,ea=me;ea<Ne;++ea){var yr=ea*k+Vn;qe+=M[(ge+ea*l-ee)*ne+ka+Ie]*E[yr+Pe]}m[ct+Pe]=qe}return v.toTensor()},t.prototype.fusedDepthwiseConv2D=function(e){var n=e.input,a=e.filter,i=e.convInfo,s=e.bias,l=e.activation,c=e.preluActivationWeights,f=this.depthwiseConv2D(n,a,i);return s&&(f=this.add(f,s)),l&&(f=lg(this,f,l,c)),f},t.prototype.depthwiseConv2D=function(e,n,a){de([e,n],"depthwiseConv2D");for(var i=a.filterHeight,s=a.filterWidth,l=a.dilationHeight,c=a.dilationWidth,f=a.padInfo.left,d=a.padInfo.top,v=a.outChannels/a.inChannels,m=Ge(a.outShape,e.dtype),g=this.readSync(e.dataId),b=this.readSync(n.dataId),w=m.values,_=0;_<a.batchSize;++_)for(var S=_*e.strides[0],E=_*m.strides[0],C=0;C<a.outHeight;++C)for(var R=E+C*m.strides[1],T=C*a.strideHeight-f,D=0;D<i;++D){var k=T+D*l;if(!(k<0||k>=a.inHeight))for(var M=D*n.strides[0],N=S+k*e.strides[1],I=0;I<a.outWidth;++I)for(var z=R+I*m.strides[2],P=I*a.strideWidth-d,ne=0;ne<s;++ne){var re=P+ne*c;if(!(re<0||re>=a.inWidth))for(var ee=M+ne*n.strides[1],U=N+re*a.inChannels,G=z,X=ee,J=0;J<a.inChannels;++J){for(var F=g[U+J],K=0;K<v;++K)w[G+K]+=F*b[X+K];G+=v,X+=v}}}return m.toTensor()},t.prototype.depthwiseConv2DDerInput=function(e,n,a){de([e,n],"depthwiseConv2DDerInput");for(var i=Ge(a.inShape,"float32"),s=i.values,l=i.strides,c=l[0],f=l[1],d=l[2],v=this.readSync(e.dataId),m=e.strides,g=m[0],b=m[1],w=m[2],_=this.readSync(n.dataId),S=n.strides,E=S[0],C=S[1],R=S[2],T=a.batchSize,D=a.filterHeight,k=a.filterWidth,M=a.inChannels,N=a.inHeight,I=a.inWidth,z=a.outChannels,P=a.outHeight,ne=a.outWidth,re=a.strideHeight,ee=a.strideWidth,U=D-1-a.padInfo.top,G=k-1-a.padInfo.left,X=z/M,J=0;J<T;++J)for(var F=0;F<M;++F)for(var K=0;K<N;++K)for(var oe=K-U,ue=Math.max(0,Math.ceil(oe/re)),pe=Math.min(P,(D+oe)/re),ge=0;ge<I;++ge){for(var me=ge-G,Ne=Math.max(0,Math.ceil(me/ee)),xe=Math.min(ne,(k+me)/ee),Ie=0,ct=ue;ct<pe;++ct)for(var Pe=ct*re-oe,qe=Ne;qe<xe;++qe)for(var Je=g*J+b*ct+w*qe,dt=E*(D-1-Pe)+C*(k-1-(qe*ee-me))+R*F,Et=0;Et<X;++Et)Ie+=v[Je+(F*X+Et)]*_[dt+Et];s[c*J+f*K+d*ge+F]=Ie}return i.toTensor()},t.prototype.depthwiseConv2DDerFilter=function(e,n,a){de([e,n],"depthwiseConv2DDerFilter");for(var i=a.strideHeight,s=a.strideWidth,l=a.filterHeight,c=a.filterWidth,f=Ge(a.filterShape,"float32"),d=a.padInfo.left,v=a.padInfo.top,m=a.outChannels/a.inChannels,g=this.bufferSync(e),b=this.bufferSync(n),w=0;w<l;++w)for(var _=Math.max(0,Math.ceil((v-w)/i)),S=Math.min(a.outHeight,(a.inHeight+v-w)/i),E=0;E<c;++E)for(var C=Math.max(0,Math.ceil((d-E)/s)),R=Math.min(a.outWidth,(a.inWidth+d-E)/s),T=0;T<a.outChannels;++T){for(var D=Math.trunc(T/m),k=T%m,M=0,N=0;N<a.batchSize;++N)for(var I=_;I<S;++I)for(var z=w+I*i-v,P=C;P<R;++P){var ne=E+P*s-d;M+=g.get(N,z,ne,D)*b.get(N,I,P,T)}f.set(M,w,E,D,k)}return f.toTensor()},t.prototype.tile=function(e,n){return de(e,"tile"),cC(this.bufferSync(e),n)},t.prototype.pad=function(e,n,a){de(e,"pad");var i=n.map(function(m,g){return m[0]+e.shape[g]+m[1]}),s=n.map(function(m){return m[0]}),l=this.bufferSync(e),c=Ge(i,e.dtype);a!==0&&c.values.fill(a);for(var f=0;f<e.size;f++){var d=l.indexToLoc(f),v=d.map(function(m,g){return m+s[g]});c.set.apply(c,[l.get.apply(l,d)].concat(v))}return c.toTensor()},t.prototype.transpose=function(e,n){de(e,"transpose");for(var a=new Array(e.rank),i=0;i<a.length;i++)a[i]=e.shape[n[i]];var s=this.readSync(e.dataId),l=Ge(a,e.dtype),c=this.bufferSync(e);for(i=0;i<e.size;++i){for(var f=c.indexToLoc(i),d=new Array(f.length),v=0;v<d.length;v++)d[v]=f[n[v]];var m=l.locToIndex(d);l.values[m]=s[i]}return l.toTensor()},t.prototype.gather=function(e,n,a){de([e,n],"gather");var i=e.shape.slice(),s=this.readSync(n.dataId);i[a]=s.length;for(var l=Ge(i,e.dtype),c=this.bufferSync(e),f=0;f<l.size;++f){var d=l.indexToLoc(f),v=d.slice();v[a]=s[d[a]];var m=c.locToIndex(v);l.values[f]=c.values[m]}return l.toTensor()},t.prototype.batchToSpaceND=function(e,n,a){de([e],"batchToSpaceND");var i=n.reduce(function(v,m){return v*m}),s=Ed(e.shape,n,i),l=Cd(s.length,n.length),c=Rd(e.shape,n,i),f=ZE(a,n.length),d=QE(c,a,n.length);return e.reshape(s).transpose(l).reshape(c).slice(f,d)},t.prototype.spaceToBatchND=function(e,n,a){de([e],"spaceToBatchND");var i=n.reduce(function(m,g){return m*g}),s=[[0,0]];s.push.apply(s,a);for(var l=1+n.length;l<e.shape.length;++l)s.push([0,0]);var c=e.pad(s),f=Ed(c.shape,n,i,!1),d=Cd(f.length,n.length,!1),v=Rd(c.shape,n,i,!1);return c.reshape(f).transpose(d).reshape(v)},t.prototype.pool=function(e,n,a){de(e,"pool");for(var i=n.strideHeight,s=n.strideWidth,l=n.dilationHeight,c=n.dilationWidth,f=n.effectiveFilterHeight,d=n.effectiveFilterWidth,v=n.padInfo.top,m=n.padInfo.left,g=a==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,b=this.readSync(e.dataId),w=Ge(n.outShape,e.dtype),_=w.values,S=n.outShape[1]*n.outShape[2]*n.outShape[3],E=n.outShape[2]*n.outShape[3],C=n.outShape[3],R=0;R<n.batchSize;++R)for(var T=R*S,D=R*e.strides[0],k=0;k<n.inChannels;++k)for(var M=0;M<n.outHeight;++M)for(var N=M*i-v,I=Math.max(0,N),z=Math.min(n.inHeight,f+N),P=T+M*E,ne=0;ne<n.outWidth;++ne){for(var re=ne*s-m,ee=Math.max(0,re),U=Math.min(n.inWidth,d+re),G=g,X=0,J=0,F=I;F<z;F+=l){for(var K=D+F*e.strides[1],oe=ee;oe<U;oe+=c){var ue=b[K+oe*e.strides[2]+k];a==="max"&&ue>G?G=ue:a==="avg"&&(X+=ue,J++)}if(isNaN(G))break}_[P+ne*C+k]=a==="avg"?X/J:G}return w.toTensor()},t.prototype.maxPool=function(e,n){return this.pool(e,n,"max")},t.prototype.maxPoolPositions=function(e,n){for(var a=Ge(n.outShape,"int32"),i=n.strideHeight,s=n.strideWidth,l=n.dilationHeight,c=n.dilationWidth,f=n.effectiveFilterHeight,d=n.effectiveFilterWidth,v=n.padInfo.top,m=n.padInfo.left,g=this.bufferSync(e),b=0;b<n.batchSize;++b)for(var w=0;w<n.inChannels;++w)for(var _=0;_<n.outHeight;++_){for(var S=_*i-v,E=S;E<0;)E+=l;for(var C=Math.min(n.inHeight,f+S),R=0;R<n.outWidth;++R){for(var T=R*s-m,D=T;D<0;)D+=c;for(var k=Math.min(n.inWidth,d+T),M=Number.NEGATIVE_INFINITY,N=-1,I=E;I<C;I+=l)for(var z=I-S,P=D;P<k;P+=c){var ne=P-T,re=g.get(b,I,P,w);re>M&&(M=re,N=z*d+ne)}a.set(N,b,_,R,w)}}return a.toTensor()},t.prototype.maxPoolBackprop=function(e,n,a,i){de([n,a],"maxPoolBackprop");for(var s=this.maxPoolPositions(n,i),l=i.strideHeight,c=i.strideWidth,f=i.dilationHeight,d=i.dilationWidth,v=i.effectiveFilterHeight,m=i.effectiveFilterWidth,g=m-1-i.padInfo.left,b=v-1-i.padInfo.top,w=Ge(n.shape,"float32"),_=this.bufferSync(s),S=this.bufferSync(e),E=0;E<i.batchSize;++E)for(var C=0;C<i.inChannels;++C)for(var R=0;R<i.inHeight;++R)for(var T=0;T<i.inWidth;++T){for(var D=R-b,k=T-g,M=0,N=0;N<v;N+=f){var I=(D+N)/l;if(!(I<0||I>=i.outHeight||Math.floor(I)!==I))for(var z=0;z<m;z+=d){var P=(k+z)/c;if(!(P<0||P>=i.outWidth||Math.floor(P)!==P)){var ne=v*m-1-_.get(E,I,P,C)===N*m+z?1:0;ne!==0&&(M+=S.get(E,I,P,C)*ne)}}}w.set(M,E,R,T,C)}return w.toTensor()},t.prototype.avgPoolBackprop=function(e,n,a){de([e,n],"avgPoolBackprop");for(var i=a.strideHeight,s=a.strideWidth,l=a.filterHeight,c=a.filterWidth,f=a.dilationHeight,d=a.dilationWidth,v=a.effectiveFilterHeight,m=a.effectiveFilterWidth,g=m-1-a.padInfo.left,b=v-1-a.padInfo.top,w=Ge(n.shape,"float32"),_=1/(l*c),S=this.bufferSync(e),E=0;E<a.batchSize;++E)for(var C=0;C<a.inChannels;++C)for(var R=0;R<a.inHeight;++R)for(var T=0;T<a.inWidth;++T){for(var D=R-b,k=T-g,M=0,N=0;N<v;N+=f){var I=(D+N)/i;if(!(I<0||I>=a.outHeight||Math.floor(I)!==I))for(var z=0;z<m;z+=d){var P=(k+z)/s;P<0||P>=a.outWidth||Math.floor(P)!==P||(M+=S.get(E,I,P,C))}}w.set(M*_,E,R,T,C)}return w.toTensor()},t.prototype.pool3d=function(e,n,a){de(e,"pool3d");for(var i=n.strideDepth,s=n.strideHeight,l=n.strideWidth,c=n.dilationDepth,f=n.dilationHeight,d=n.dilationWidth,v=n.effectiveFilterDepth,m=n.effectiveFilterHeight,g=n.effectiveFilterWidth,b=n.padInfo.front,w=n.padInfo.top,_=n.padInfo.left,S=a==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,E=this.readSync(e.dataId),C=Ge(n.outShape,e.dtype),R=C.values,T=n.outShape[1]*n.outShape[2]*n.outShape[3]*n.outShape[4],D=n.outShape[2]*n.outShape[3]*n.outShape[4],k=n.outShape[3]*n.outShape[4],M=n.outShape[4],N=0;N<n.batchSize;++N)for(var I=N*T,z=N*e.strides[0],P=0;P<n.inChannels;++P)for(var ne=0;ne<n.outDepth;++ne){for(var re=ne*i-b,ee=re;ee<0;)ee+=c;for(var U=Math.min(n.inDepth,v+re),G=I+ne*D,X=0;X<n.outHeight;++X){for(var J=X*s-w,F=J;F<0;)F+=f;for(var K=Math.min(n.inHeight,m+J),oe=G+X*k,ue=0;ue<n.outWidth;++ue){for(var pe=ue*l-_,ge=pe;ge<0;)ge+=d;for(var me=Math.min(n.inWidth,g+pe),Ne=oe+ue*M,xe=S,Ie=0,ct=0,Pe=ee;Pe<U;Pe+=c){for(var qe=z+Pe*e.strides[1],Je=F;Je<K;Je+=f){for(var dt=qe+Je*e.strides[2],Et=ge;Et<me;Et+=d){var xt=E[dt+Et*e.strides[3]+P];if(a==="max"&&xt>xe?xe=xt:a==="avg"&&(Ie+=xt,ct++),isNaN(xe))break}if(isNaN(xe))break}if(isNaN(xe))break}R[Ne+P]=a==="avg"?Ie/ct:xe}}}return C.toTensor()},t.prototype.avgPool3d=function(e,n){return de(e,"avgPool3d"),this.pool3d(e,n,"avg").toFloat()},t.prototype.avgPool3dBackprop=function(e,n,a){de([e,n],"avgPool3dBackprop");for(var i=a.strideDepth,s=a.strideHeight,l=a.strideWidth,c=a.filterDepth,f=a.filterHeight,d=a.filterWidth,v=a.dilationDepth,m=a.dilationHeight,g=a.dilationWidth,b=a.effectiveFilterDepth,w=a.effectiveFilterHeight,_=a.effectiveFilterWidth,S=b-1-a.padInfo.front,E=_-1-a.padInfo.left,C=w-1-a.padInfo.top,R=Ge(n.shape,"float32"),T=1/(c*f*d),D=this.bufferSync(e),k=0;k<a.batchSize;++k)for(var M=0;M<a.inChannels;++M)for(var N=0;N<a.inDepth;++N)for(var I=0;I<a.inHeight;++I)for(var z=0;z<a.inWidth;++z){for(var P=N-S,ne=I-C,re=z-E,ee=0,U=0;U<b;U+=v){var G=(P+U)/i;if(!(G<0||G>=a.outDepth||Math.floor(G)!==G))for(var X=0;X<w;X+=m){var J=(ne+X)/s;if(!(J<0||J>=a.outHeight||Math.floor(J)!==J))for(var F=0;F<_;F+=g){var K=(re+F)/l;K<0||K>=a.outWidth||Math.floor(K)!==K||(ee+=D.get(k,G,J,K,M))}}}R.set(ee*T,k,N,I,z,M)}return R.toTensor()},t.prototype.maxPool3d=function(e,n){return de(e,"maxPool3d"),this.pool3d(e,n,"max").toFloat()},t.prototype.maxPool3dPositions=function(e,n){for(var a=Ge(n.outShape,"int32"),i=n.strideDepth,s=n.strideHeight,l=n.strideWidth,c=n.dilationDepth,f=n.dilationHeight,d=n.dilationWidth,v=n.effectiveFilterDepth,m=n.effectiveFilterHeight,g=n.effectiveFilterWidth,b=n.padInfo.front,w=n.padInfo.top,_=n.padInfo.left,S=this.bufferSync(e),E=0;E<n.batchSize;++E)for(var C=0;C<n.inChannels;++C)for(var R=0;R<n.outDepth;++R){for(var T=R*i-b,D=T;D<0;)D+=c;for(var k=Math.min(n.inDepth,v+T),M=0;M<n.outHeight;++M){for(var N=M*s-w,I=N;I<0;)I+=f;for(var z=Math.min(n.inHeight,m+N),P=0;P<n.outWidth;++P){for(var ne=P*l-_,re=ne;re<0;)re+=d;for(var ee=Math.min(n.inWidth,g+ne),U=Number.NEGATIVE_INFINITY,G=-1,X=D;X<k;X+=c)for(var J=X-T,F=I;F<z;F+=f)for(var K=F-N,oe=re;oe<ee;oe+=d){var ue=oe-ne,pe=S.get(E,X,F,oe,C);pe>=U&&(U=pe,G=J*m*g+K*m+ue)}a.set(G,E,R,M,P,C)}}}return a.toTensor()},t.prototype.maxPool3dBackprop=function(e,n,a,i){de([n,a],"maxPool3dBackprop");for(var s=this.maxPool3dPositions(n,i),l=i.strideDepth,c=i.strideHeight,f=i.strideWidth,d=i.dilationDepth,v=i.dilationHeight,m=i.dilationWidth,g=i.effectiveFilterDepth,b=i.effectiveFilterHeight,w=i.effectiveFilterWidth,_=g-1-i.padInfo.front,S=w-1-i.padInfo.left,E=b-1-i.padInfo.top,C=Ge(n.shape,"float32"),R=this.bufferSync(s),T=this.bufferSync(e),D=0;D<i.batchSize;++D)for(var k=0;k<i.inChannels;++k)for(var M=0;M<i.inDepth;++M)for(var N=0;N<i.inHeight;++N)for(var I=0;I<i.inWidth;++I){for(var z=M-_,P=N-E,ne=I-S,re=0,ee=0;ee<g;ee+=d){var U=(z+ee)/l;if(!(U<0||U>=i.outDepth||Math.floor(U)!==U))for(var G=0;G<b;G+=v){var X=(P+G)/c;if(!(X<0||X>=i.outHeight||Math.floor(X)!==X))for(var J=0;J<w;J+=m){var F=(ne+J)/f;if(!(F<0||F>=i.outWidth||Math.floor(F)!==F)){var K=g*b*w-1-R.get(D,U,X,F,k)===ee*b*w+G*w+J?1:0;K!==0&&(re+=T.get(D,U,X,F,k)*K)}}}}C.set(re,D,M,N,I,k)}return C.toTensor()},t.prototype.cast=function(e,n){return oC(e,n,this)},t.prototype.reshape=function(e,n){return hy(e,n)},t.prototype.avgPool=function(e,n){return de(e,"avgPool"),this.pool(e,n,"avg").toFloat()},t.prototype.resizeBilinear=function(e,n,a,i){de(e,"resizeBilinear");for(var s=e.shape,l=s[0],c=s[1],f=s[2],d=s[3],v=this.readSync(e.dataId),m=new Float32Array(Te([l,n,a,d])),g=[i&&n>1?c-1:c,i&&a>1?f-1:f],b=[i&&n>1?n-1:n,i&&a>1?a-1:a],w=0,_=g[0]/b[0],S=g[1]/b[1],E=0;E<l;E++)for(var C=0;C<n;C++)for(var R=_*C,T=Math.floor(R),D=R-T,k=Math.min(c-1,Math.ceil(R)),M=E*e.strides[0]+T*e.strides[1],N=E*e.strides[0]+k*e.strides[1],I=0;I<a;I++)for(var z=S*I,P=Math.floor(z),ne=z-P,re=Math.min(f-1,Math.ceil(z)),ee=M+P*e.strides[2],U=N+P*e.strides[2],G=M+re*e.strides[2],X=N+re*e.strides[2],J=0;J<d;J++){var F=v[ee+J],K=v[U+J],oe=F+(v[G+J]-F)*ne,ue=oe+(K+(v[X+J]-K)*ne-oe)*D;m[w++]=ue}return Sn(m,[l,n,a,d])},t.prototype.resizeBilinearBackprop=function(e,n,a){de([e,n],"resizeBilinearBackprop");for(var i=n.shape,s=i[0],l=i[1],c=i[2],f=i[3],d=e.shape,v=d[1],m=d[2],g=new Float32Array(s*l*c*f),b=[a&&v>1?l-1:l,a&&m>1?c-1:c],w=[a&&v>1?v-1:v,a&&m>1?m-1:m],_=b[0]/w[0],S=b[1]/w[1],E=this.readSync(e.dataId),C=0,R=0;R<s;R++)for(var T=R*n.strides[0],D=0;D<v;D++)for(var k=D*_,M=Math.floor(k),N=Math.min(Math.ceil(k),l-1),I=T+M*n.strides[1],z=T+N*n.strides[1],P=k-M,ne=1-P,re=0;re<m;re++)for(var ee=re*S,U=Math.floor(ee),G=Math.min(Math.ceil(ee),c-1),X=ee-U,J=1-X,F=I+U*n.strides[2],K=I+G*n.strides[2],oe=z+U*n.strides[2],ue=z+G*n.strides[2],pe=ne*J,ge=ne*X,me=P*J,Ne=P*X,xe=0;xe<f;xe++){var Ie=E[C++];g[F+xe]+=Ie*pe,g[K+xe]+=Ie*ge,g[oe+xe]+=Ie*me,g[ue+xe]+=Ie*Ne}return $n(g,[s,c,l,f],n.dtype)},t.prototype.resizeNearestNeighbor=function(e,n,a,i){de(e,"resizeNearestNeighbor");for(var s=e.shape,l=s[0],c=s[1],f=s[2],d=s[3],v=this.readSync(e.dataId),m=new Float32Array(l*n*a*d),g=[i&&n>1?c-1:c,i&&a>1?f-1:f],b=[i&&n>1?n-1:n,i&&a>1?a-1:a],w=g[0]/b[0],_=g[1]/b[1],S=0,E=0;E<l;E++)for(var C=E*e.strides[0],R=0;R<n;R++)for(var T=w*R,D=C+Math.min(c-1,i?Math.round(T):Math.floor(T))*e.strides[1],k=0;k<a;k++)for(var M=_*k,N=D+Math.min(f-1,i?Math.round(M):Math.floor(M))*e.strides[2],I=0;I<d;I++){var z=v[N+I];m[S++]=z}return Sn(m,[l,n,a,d],e.dtype)},t.prototype.resizeNearestNeighborBackprop=function(e,n,a){de([e,n],"resizeNearestNeighborBackprop");for(var i=n.shape,s=i[0],l=i[1],c=i[2],f=i[3],d=e.shape,v=d[1],m=d[2],g=new Float32Array(s*l*c*f),b=this.readSync(e.dataId),w=[a&&v>1?l-1:l,a&&m>1?c-1:c],_=[a&&v>1?v-1:v,a&&m>1?m-1:m],S=w[0]/_[0],E=w[1]/_[1],C=1/S,R=1/E,T=2*Math.ceil(C)+2,D=2*Math.ceil(R)+2,k=0;k<s;k++)for(var M=k*n.strides[0],N=0;N<l;N++)for(var I=M+N*n.strides[1],z=Math.floor(N*C),P=Math.floor(z-T/2),ne=0;ne<c;ne++)for(var re=I+ne*n.strides[2],ee=Math.floor(ne*R),U=Math.floor(ee-D/2),G=0;G<f;G++){for(var X=0,J=0;J<T;J++){var F=J+P;if(!(F<0||F>=v)){var K=M+F*e.strides[1],oe=F*S;if(N===Math.min(l-1,a?Math.round(oe):Math.floor(oe)))for(var ue=0;ue<D;ue++){var pe=ue+U;if(!(pe<0||pe>=m)){var ge=K+pe*e.strides[2],me=pe*E;ne===Math.min(c-1,a?Math.round(me):Math.floor(me))&&(X+=b[ge+G])}}}}g[re+G]=X}return $n(g,n.shape,n.dtype)},t.prototype.batchNormalization=function(e,n,a,i,s,l){de([e,n,a,s,l],"batchNorm");for(var c=this.readSync(e.dataId),f=this.readSync(n.dataId),d=this.readSync(a.dataId),v=s?this.readSync(s.dataId):new Float32Array([1]),m=l?this.readSync(l.dataId):new Float32Array([0]),g=new Float32Array(c.length),b=m.length,w=v.length,_=d.length,S=f.length,E=0,C=0,R=0,T=0,D=0;D<c.length;++D)g[D]=m[E++]+(c[D]-f[C++])*v[R++]/Math.sqrt(d[T++]+i),E>=b&&(E=0),C>=S&&(C=0),R>=w&&(R=0),T>=_&&(T=0);return $n(g,e.shape)},t.prototype.localResponseNormalization4D=function(e,n,a,i,s){de(e,"localResponseNormalization4D");var l=e.shape[3],c=l-1,f=this.readSync(e.dataId),d=e.size,v=new Float32Array(d);function m(_){for(var S=_%l,E=_-S+Math.max(0,S-n),C=_-S+Math.min(S+n,c),R=0;E<=C;E++){var T=f[E];R+=T*T}return R}for(var g=0;g<d;g++){var b=m(g),w=f[g]*Math.pow(a+i*b,-s);v[g]=w}return $n(v,e.shape)},t.prototype.LRNGrad=function(e,n,a,i,s,l,c){de(e,"LRNGrad");for(var f=e.shape[3],d=this.readSync(e.dataId),v=this.readSync(n.dataId),m=this.readSync(a.dataId),g=new Float32Array(e.size),b=e.size,w=0;w<b;w++){for(var _=w%f,S=w-_+Math.max(0,_-i),E=w-_+Math.min(f,_+i+1),C=0,R=S;R<E;R++)C+=Math.pow(v[R],2);for(C=l*C+s,R=S;R<E;R++){var T=-2*l*c*v[R]*m[w]/C;w===R&&(T+=Math.pow(C,-c)),T*=d[w],g[R]+=T}}return $n(g,e.shape)},t.prototype.multinomial=function(e,n,a,i){de(e,"multinomial");for(var s=n?e:li(e),l=s.shape[0],c=s.shape[1],f=Dt([l,a],"int32"),d=this.readSync(f.dataId),v=this.readSync(s.dataId),m=0;m<l;++m){var g=m*c,b=new Float32Array(c-1);b[0]=v[g];for(var w=1;w<b.length;++w)b[w]=b[w-1]+v[g+w];for(var _=$d(i.toString()),S=m*a,E=0;E<a;++E){var C=_();d[S+E]=b.length;for(var R=0;R<b.length;R++)if(C<b[R]){d[S+E]=R;break}}}return f},t.prototype.oneHot=function(e,n,a,i){de(e,"oneHot");var s=new Float32Array(e.size*n);s.fill(i);for(var l=this.readSync(e.dataId),c=0;c<e.size;++c)l[c]>=0&&l[c]<n&&(s[c*n+l[c]]=a);return io(s,[e.size,n],"int32")},t.prototype.nonMaxSuppression=function(e,n,a,i,s){return de(e,"nonMaxSuppression"),$y(this.readSync(e.dataId),this.readSync(n.dataId),a,i,s)},t.prototype.fft=function(e){return this.fftBatch(e,!1)},t.prototype.ifft=function(e){return this.fftBatch(e,!0)},t.prototype.fftBatch=function(e,n){for(var a=e.shape[0],i=e.shape[1],s=Ge(e.shape,"float32"),l=Ge(e.shape,"float32"),c=Or(e).as2D(a,i),f=va(e).as2D(a,i),d=0;d<a;d++)for(var v=c.slice([d,0],[1,i]),m=f.slice([d,0],[1,i]),g=wn(v,m),b=this.readSync(this.fftImpl(g,n).dataId),w=0;w<i;w++){var _=o_(b,w);s.values[d*i+w]=_.real,l.values[d*i+w]=_.imag}return wn(s.toTensor(),l.toTensor()).as2D(a,i)},t.prototype.fftImpl=function(e,n){var a=e.as1D(),i=a.size;if(this.isExponentOf2(i)){var s=this.fftRadix2(a,i,n).as2D(e.shape[0],e.shape[1]);return n&&(s=wn(Or(s).div(ye(i)),va(s).div(ye(i)))),s}var l=this.readSync(e.dataId),c=function(f){for(var d=new Float32Array(f.length/2),v=new Float32Array(f.length/2),m=0;m<f.length;m+=2)d[m/2]=f[m],v[m/2]=f[m+1];return{real:d,imag:v}}(this.fourierTransformByMatmul(l,i,n));return wn(c.real,c.imag).as2D(e.shape[0],e.shape[1])},t.prototype.isExponentOf2=function(e){return(e&e-1)==0},t.prototype.fftRadix2=function(e,n,a){if(n===1)return e;var i=this.readSync(e.dataId),s=n/2,l=function(S){for(var E=Math.ceil(S.length/4),C=new Float32Array(E),R=new Float32Array(E),T=0;T<S.length;T+=4)C[Math.floor(T/4)]=S[T],R[Math.floor(T/4)]=S[T+1];return{real:C,imag:R}}(i),c=wn(l.real,l.imag).as1D(),f=function(S){for(var E=Math.floor(S.length/4),C=new Float32Array(E),R=new Float32Array(E),T=2;T<S.length;T+=4)C[Math.floor(T/4)]=S[T],R[Math.floor(T/4)]=S[T+1];return{real:C,imag:R}}(i),d=wn(f.real,f.imag).as1D();c=this.fftRadix2(c,s,a),d=this.fftRadix2(d,s,a);var v=function(S,E){for(var C=new Float32Array(S/2),R=new Float32Array(S/2),T=0;T<Math.ceil(S/2);T++){var D=(E?2:-2)*Math.PI*(T/S);C[T]=Math.cos(D),R[T]=Math.sin(D)}return{real:C,imag:R}}(n,a),m=wn(v.real,v.imag).mul(d),g=c.add(m),b=c.sub(m),w=Or(g).concat(Or(b)),_=va(g).concat(va(b));return wn(w,_).as1D()},t.prototype.fourierTransformByMatmul=function(e,n,a){for(var i=new Float32Array(2*n),s=0;s<n;s++){for(var l=0,c=0,f=0;f<n;f++){var d=fI(s*f,n,a),v=o_(e,f);l+=v.real*d.real-v.imag*d.imag,c+=v.real*d.imag+v.imag*d.real}a&&(l/=n,c/=n),cI(i,l,c,s)}return i},t.prototype.depthToSpace=function(e,n,a){L(a==="NHWC",function(){return"Only NHWC dataFormat supported on CPU for depthToSpace. Got "+a}),L(n>1,function(){return"blockSize should be > 1 for depthToSpace, but was: "+n});for(var i=e.shape[0],s=e.shape[1],l=e.shape[2],c=e.shape[3],f=s*n,d=l*n,v=c/(n*n),m=this.readSync(e.dataId),g=new Float32Array(i*f*d*v),b=0,w=0;w<i;++w)for(var _=0;_<f;++_)for(var S=Math.floor(_/n),E=_%n,C=0;C<d;++C)for(var R=Math.floor(C/n),T=(E*n+C%n)*v,D=0;D<v;++D){var k=D+T+c*(R+l*(S+s*w));g[b++]=m[k]}return $n(g,[i,f,d,v])},t.prototype.broadcastedBinaryOp=function(e,n,a,i){var s=it(e.shape,n.shape),l=Ge(s,a),c=this.readSync(e.dataId),f=this.readSync(n.dataId),d=to(e.shape,s),v=to(n.shape,s),m=l.values;if(d.length+v.length===0)for(var g=0;g<m.length;++g)m[g]=i(c[g%c.length],f[g%f.length]);else{var b=this.bufferSync(e),w=this.bufferSync(n),_=function(S){var E=l.indexToLoc(S),C=E.slice(-e.rank);d.forEach(function(k){return C[k]=0});var R=b.locToIndex(C),T=E.slice(-n.rank);v.forEach(function(k){return T[k]=0});var D=w.locToIndex(T);m[S]=i(c[R],f[D])};for(g=0;g<m.length;++g)_(g)}return l.toTensor()},t.prototype.broadcastedBinaryComplexOp=function(e,n,a){var i=it(e.shape,n.shape),s=Ge(i,"float32"),l=Ge(i,"float32"),c=this.readSync(e.dataId),f=this.readSync(n.dataId),d=to(e.shape,i),v=to(n.shape,i),m=s.values,g=l.values;if(d.length+v.length===0)for(var b=0;b<m.length;b++){var w=b%c.length,_=b%f.length,S=a(c[2*w],c[2*w+1],f[2*_],f[2*_+1]);m[b]=S.real,g[b]=S.imag}else{var E=this.bufferSync(this.data.get(e.dataId).complexTensors.real),C=this.bufferSync(this.data.get(n.dataId).complexTensors.real),R=function(T){var D=s.indexToLoc(T),k=D.slice(-e.rank);d.forEach(function(P){return k[P]=0});var M=E.locToIndex(k),N=D.slice(-n.rank);v.forEach(function(P){return N[P]=0});var I=C.locToIndex(N),z=a(c[2*M],c[2*M+1],f[2*I],f[2*I+1]);m[T]=z.real,g[T]=z.imag};for(b=0;b<m.length;b++)R(b)}return this.complex(s.toTensor(),l.toTensor())},t.prototype.split=function(e,n,a){return lC(e,n,a)},t.prototype.dispose=function(){},t.prototype.floatPrecision=function(){return 32},t.prototype.epsilon=function(){return 1e-7},t.prototype.cropAndResize=function(e,n,a,i,s,l){for(var c=e.shape,f=c[0],d=c[1],v=c[2],m=c[3],g=n.shape[0],b=i[0],w=i[1],_=Ge([g,b,w,m],"float32"),S=this.readSync(n.dataId),E=this.readSync(a.dataId),C=this.readSync(e.dataId),R=e.strides,T=_.strides,D=0;D<g;D++){var k=4*D,M=S[k],N=S[k+1],I=S[k+2],z=S[k+3],P=E[D];if(!(P>=f))for(var ne=b>1?(I-M)*(d-1)/(b-1):0,re=w>1?(z-N)*(v-1)/(w-1):0,ee=0;ee<b;ee++){var U=b>1?M*(d-1)+ee*ne:.5*(M+I)*(d-1);if(U<0||U>d-1)for(var G=0;G<w;G++)for(var X=0;X<m;X++){var J=X+G*T[2]+ee*T[1]+D*T[0];_.values[J]=l}else if(s==="bilinear"){var F=Math.floor(U),K=Math.ceil(U),oe=U-F;for(G=0;G<w;G++)if((Pe=w>1?N*(v-1)+G*re:.5*(N+z)*(v-1))<0||Pe>v-1)for(X=0;X<m;X++)J=X+G*T[2]+ee*T[1]+D*T[0],_.values[J]=l;else{var ue=Math.floor(Pe),pe=Math.ceil(Pe),ge=Pe-ue;for(X=0;X<m;X++){var me=C[J=X+ue*R[2]+F*R[1]+P*R[0]],Ne=C[J=X+pe*R[2]+F*R[1]+P*R[0]],xe=C[J=X+ue*R[2]+K*R[1]+P*R[0]],Ie=me+(Ne-me)*ge,ct=xe+(C[J=X+pe*R[2]+K*R[1]+P*R[0]]-xe)*ge;J=X+G*T[2]+ee*T[1]+D*T[0],_.values[J]=Ie+(ct-Ie)*oe}}}else for(G=0;G<w;++G){var Pe;if((Pe=w>1?N*(v-1)+G*re:.5*(N+z)*(v-1))<0||Pe>v-1)for(X=0;X<m;X++)J=X+G*T[2]+ee*T[1]+D*T[0],_.values[J]=l;else{var qe=Math.round(Pe),Je=Math.round(U);for(X=0;X<m;X++){var dt=X+qe*R[2]+Je*R[1]+P*R[0],Et=X+G*T[2]+ee*T[1]+D*T[0];_.values[Et]=C[dt]}}}}}return _.toTensor()},t.prototype.sparseToDense=function(e,n,a,i){var s=Td(0,e,a),l=s.sliceRank,c=s.numUpdates,f=s.sliceSize,d=s.strides,v=s.outputSize;return this.scatter(e,n,a,v,f,c,l,d,i,!1)},t.prototype.gatherND=function(e,n){var a=n.shape,i=a[a.length-1],s=JE(e,n),l=s[0],c=s[1],f=s[2],d=s[3];if(c===0)return Sn([],l,e.dtype);for(var v=new Ic([c,f],e.dtype),m=this.readSync(n.dataId),g=this.readSync(e.dataId),b=0;b<c;b++){for(var w=[],_=0,S=0;S<i;S++){var E=m[b*i+S];_+=E*d[S],w.push(E)}if(_<0||_>=e.size/f)throw new Error("Invalid indices: "+w+" does not index into "+e.shape);for(var C=0;C<f;C++)v.values[b*f+C]=g[_*f+C]}return v.toTensor().reshape(l)},t.prototype.scatterND=function(e,n,a){var i=Td(0,e,a),s=i.sliceRank,l=i.numUpdates,c=i.sliceSize,f=i.strides,d=i.outputSize,v=ye(0);return this.scatter(e,n,a,d,c,l,s,f,v,!0)},t.prototype.fill=function(e,n,a){var i=gd(a=a||Zc(n),Te(e));return i.fill(n),q.makeTensor(i,e,a,this)},t.prototype.onesLike=function(e){if(e.dtype==="string")throw new Error("onesLike is not supported for string tensors");return this.fill(e.shape,1,e.dtype)},t.prototype.zerosLike=function(e){var n=gd(e.dtype,Te(e.shape));return this.makeOutput(n,e.shape,e.dtype)},t.prototype.linspace=function(e,n,a){return sC(e,n,a)},t.prototype.scatter=function(e,n,a,i,s,l,c,f,d,v){var m=[i/s,s],g=this.readSync(e.dataId),b=this.readSync(n.dataId);if(i===0)return Sn([],a,n.dtype);var w=new Ic(m,n.dtype);w.values.fill(this.readSync(d.dataId)[0]);for(var _=0;_<l;_++){for(var S=[],E=0,C=0;C<c;C++){var R=g[_*c+C];S.push(R),E+=R*f[C]}if(E<0||E>=i/s)throw new Error("Invalid indices: "+S+" does not index into "+a);for(var T=0;T<s;T++)v?w.values[E*s+T]+=b[_*s+T]:w.values[E*s+T]=n.rank===0?b[0]:b[_*s+T]}return w.toTensor().reshape(a)},t}(aC);q.registerBackend("cpu",function(){return new OP},1);for(var cg=0,A_=[{kernelName:"NonMaxSuppressionV5",backendName:"cpu",kernelFunc:function(r){var t=r.inputs,e=r.backend,n=r.attrs,a=t,i=a.boxes,s=a.scores,l=n,c=l.maxOutputSize,f=l.iouThreshold,d=l.scoreThreshold,v=l.softNmsSigma,m=e;de(i,"NonMaxSuppressionWithScore");var g=Yy(m.data.get(i.dataId).values,m.data.get(s.dataId).values,c,f,d,v);return[g.selectedIndices,g.selectedScores]}},{kernelName:"Square",backendName:"cpu",kernelFunc:function(r){var t=r.inputs,e=r.backend,n=t.x,a=e;de(n,"square");for(var i=a.data.get(n.dataId).values,s=new Float32Array(i.length),l=0;l<i.length;++l){var c=i[l];s[l]=c*c}return{dataId:a.write(s,n.shape,n.dtype),shape:n.shape,dtype:n.dtype}}},{kernelName:Lc,backendName:"cpu",kernelFunc:function(r){var t=r.inputs,e=r.backend,n=t,a=n.a,i=n.b,s=e;de([a,i],Lc);var l=s.data.get(a.dataId).values,c=s.data.get(i.dataId).values,f=function(m,g,b,w,_,S){var E=it(m,g),C=E.length,R=xa(E),T=Mc(_,Te(E)),D=m.length,k=g.length,M=xa(m),N=xa(g),I=to(m,E),z=to(g,E);if(I.length+z.length===0)for(var P=0;P<T.length;++P)T[P]=S(b[P%b.length],w[P%w.length]);else{var ne=function(re){var ee=V4(re,C,R),U=ee.slice(-D);I.forEach(function(F){return U[F]=0});var G=Z2(U,D,M),X=ee.slice(-k);z.forEach(function(F){return X[F]=0});var J=Z2(X,k,N);T[re]=S(b[G],w[J])};for(P=0;P<T.length;++P)ne(P)}return[T,E]}(a.shape,i.shape,l,c,a.dtype,function(m,g){var b=m-g;return b*b}),d=f[0],v=f[1];return{dataId:s.write(d,v,a.dtype),shape:v,dtype:a.dtype}}}];cg<A_.length;cg++)NE(A_[cg]);var ru,NP=function(r){this.variableNames=["A"];var t=On(),e=r[0],n=r[1];this.outputShape=r,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(`+n+".0, "+e+`.0);

        vec4 values = `+t.texture2D+`(A, uv);
        float value;
        if (depth == 0) {
          value = values.r;
        } else if (depth == 1) {
          value = values.g;
        } else if (depth == 2) {
          value = values.b;
        } else if (depth == 3) {
          value = values.a;
        }

        setOutput(floor(value * 255.0 + 0.5));
      }
    `},MP=function(r){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;var t=On(),e=r[0],n=r[1];this.outputShape=r,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];

        vec4 result = vec4(0.);

        for(int row=0; row<=1; row++) {
          for(int col=0; col<=1; col++) {
            texC = coords[1] + row;
            depth = coords[2] + col;

            vec2 uv = (vec2(texC, texR) + halfCR) /
                       vec2(`+n+".0, "+e+`.0);
            vec4 values = `+t.texture2D+`(A, uv);
            float value;
            if (depth == 0) {
              value = values.r;
            } else if (depth == 1) {
              value = values.g;
            } else if (depth == 2) {
              value = values.b;
            } else if (depth == 3) {
              value = values.a;
            }

            result[row * 2 + col] = floor(value * 255.0 + 0.5);
          }
        }

        `+t.output+` = result;
      }
    `};for(var fg=0,D_=[{kernelName:"FromPixels",backendName:"webgl",kernelFunc:function(r){var t=r.inputs,e=r.backend,n=r.attrs,a=t.pixels,i=n.numChannels,s=typeof HTMLVideoElement<"u"&&a instanceof HTMLVideoElement,l=typeof HTMLImageElement<"u"&&a instanceof HTMLImageElement,c=s?[a.videoWidth,a.videoHeight]:[a.width,a.height],f=c[0],d=c[1],v=[d,f],m=[d,f,i];(l||s)&&(ru==null&&(ru=document.createElement("canvas").getContext("2d")),ru.canvas.width=f,ru.canvas.height=d,ru.drawImage(a,0,0,f,d),a=ru.canvas);var g=e.makeTensorInfo(v,"int32");e.texData.get(g.dataId).usage=fr.PIXELS,e.gpgpu.uploadPixelDataToTexture(e.getTexture(g.dataId),a);var b=le().getBool("WEBGL_PACK")?new MP(m):new NP(m),w=e.runWebGLProgram(b,[g],"int32");return e.disposeData(g.dataId),w}},{kernelName:"NonMaxSuppressionV5",backendName:"webgl",kernelFunc:function(r){var t=r.inputs,e=r.backend,n=r.attrs;wd("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");var a=t,i=a.boxes,s=a.scores,l=n,c=l.maxOutputSize,f=l.iouThreshold,d=l.scoreThreshold,v=l.softNmsSigma,m=e,g=Yy(m.readSync(i.dataId),m.readSync(s.dataId),c,f,d,v);return[g.selectedIndices,g.selectedScores]}},{kernelName:"Square",backendName:"webgl",kernelFunc:function(r){var t=r.inputs,e=r.backend,n=t.x,a=e,i=new $e(n.shape,"return x * x;");return a.runWebGLProgram(i,[n],n.dtype)}},{kernelName:Lc,backendName:"webgl",kernelFunc:function(r){var t=r.inputs,e=r.backend,n=t,a=n.a,i=n.b,s=e,l=le().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Ya("return (a - b) * (a - b);",a.shape,i.shape):new zt("return (a - b) * (a - b);",a.shape,i.shape);return s.compileAndRun(l,[a,i])}}];fg<D_.length;fg++)NE(D_[fg]);for(var hg=0,k_=[{kernelName:"Square",gradFunc:function(r,t){var e=t[0];return{x:function(){return r.mul(e.toFloat().mul(2))}}}},{kernelName:Lc,gradFunc:function(r,t){var e=t[0],n=t[1],a=ye(2);return{a:function(){return Mn(r,Mn(a,on(e,n)))},b:function(){return Mn(r,Mn(a,on(n,e)))}}}}];hg<k_.length;hg++)k4(k_[hg]);var IP=function(){function r(){}return r.prototype.fetch=function(t,e){return fetch(t,e)},r.prototype.now=function(){return performance.now()},r.prototype.encode=function(t,e){if(e!=="utf-8"&&e!=="utf8")throw new Error("Browser's encoder only supports utf-8, but got "+e);return this.textEncoder==null&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(t)},r.prototype.decode=function(t,e){return new TextDecoder(e).decode(t)},r}();le().get("IS_BROWSER")&&le().setPlatform("browser",new IP);var dg,FP=function(){return require("node-fetch")},BP=function(){function r(){this.util=require("util"),this.textEncoder=new this.util.TextEncoder}return r.prototype.fetch=function(t,e){return le().global.fetch!=null?le().global.fetch(t,e):(dg==null&&(dg=FP()),dg(t,e))},r.prototype.now=function(){var t=process.hrtime();return 1e3*t[0]+t[1]/1e6},r.prototype.encode=function(t,e){if(e!=="utf-8"&&e!=="utf8")throw new Error("Node built-in encoder only supports utf-8, but got "+e);return this.textEncoder.encode(t)},r.prototype.decode=function(t,e){return t.length===0?"":new this.util.TextDecoder(e).decode(t)},r}();le().get("IS_NODE")&&le().setPlatform("node",new BP);var vy={float32:4,int32:4,uint16:2,uint8:1,bool:1},Id=4;function tR(r,t){for(var e={},n=0,a=function(l){var c=l.name,f=l.dtype,d=l.shape,v=Te(d),m=void 0;if("quantization"in l){var g=l.quantization;if(g.dtype!=="uint8"&&g.dtype!=="uint16")throw new Error("Weight "+l.name+" has unknown quantization dtype "+g.dtype+". Supported quantization dtypes are: 'uint8' and 'uint16'.");var b=vy[g.dtype],w=r.slice(n,n+v*b),_=g.dtype==="uint8"?new Uint8Array(w):new Uint16Array(w);if(f==="float32")m=Float32Array.from(_,function(D){return D*g.scale+g.min});else{if(f!=="int32")throw new Error("Unsupported dtype in weight '"+c+"': "+f);m=Int32Array.from(_,function(D){return Math.round(D*g.scale+g.min)})}n+=v*b}else if(f==="string"){var S=Te(l.shape);m=[];for(var E=0;E<S;E++){var C=new Uint32Array(r.slice(n,n+Id))[0];n+=Id;var R=new Uint8Array(r.slice(n,n+C));m.push(R),n+=C}}else{var T=vy[f];if(w=r.slice(n,n+v*T),f==="float32")m=new Float32Array(w);else if(f==="int32")m=new Int32Array(w);else{if(f!=="bool")throw new Error("Unsupported dtype in weight '"+c+"': "+f);m=new Uint8Array(w)}n+=v*T}e[c]=Sn(m,d,f)},i=0,s=t;i<s.length;i++)a(s[i]);return e}function LP(r){if(r===null)throw new Error("Invalid input value: "+JSON.stringify(r));var t=0,e=[];r.forEach(function(i){if(t+=i.byteLength,e.push(i.byteLength===i.buffer.byteLength?i:new i.constructor(i)),!(i instanceof Float32Array||i instanceof Int32Array||i instanceof Uint8Array))throw new Error("Unsupported TypedArray subtype: "+i.constructor.name)});var n=new Uint8Array(t),a=0;return e.forEach(function(i){n.set(new Uint8Array(i.buffer),a),a+=i.byteLength}),n.buffer}var my=typeof Buffer<"u"&&(typeof Blob>"u"||typeof atob>"u"||typeof btoa>"u");function O_(r){return my?Buffer.byteLength(r):new Blob([r]).size}function v0(r){var t=0;r.forEach(function(a){t+=a.byteLength});var e=new Uint8Array(t),n=0;return r.forEach(function(a){e.set(new Uint8Array(a),n),n+=a.byteLength}),e.buffer}function N_(r){for(r=r.trim();r.endsWith("/");)r=r.slice(0,r.length-1);var t=r.split("/");return t[t.length-1]}function af(r){if(r.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:r.modelTopology==null?0:O_(JSON.stringify(r.modelTopology)),weightSpecsBytes:r.weightSpecs==null?0:O_(JSON.stringify(r.weightSpecs)),weightDataBytes:r.weightData==null?0:r.weightData.byteLength}}var hr=function(){function r(){this.saveRouters=[],this.loadRouters=[]}return r.getInstance=function(){return r.instance==null&&(r.instance=new r),r.instance},r.registerSaveRouter=function(t){r.getInstance().saveRouters.push(t)},r.registerLoadRouter=function(t){r.getInstance().loadRouters.push(t)},r.getSaveHandlers=function(t){return r.getHandlers(t,"save")},r.getLoadHandlers=function(t,e){return r.getHandlers(t,"load",e)},r.getHandlers=function(t,e,n){var a=[];return(e==="load"?r.getInstance().loadRouters:r.getInstance().saveRouters).forEach(function(i){var s=i(t,n);s!==null&&a.push(s)}),a},r}(),bu="://",oo=function(){function r(){this.managers={}}return r.getInstance=function(){return r.instance==null&&(r.instance=new r),r.instance},r.registerManager=function(t,e){L(t!=null,function(){return"scheme must not be undefined or null."}),t.endsWith(bu)&&(t=t.slice(0,t.indexOf(bu))),L(t.length>0,function(){return"scheme must not be an empty string."});var n=r.getInstance();L(n.managers[t]==null,function(){return"A model store manager is already registered for scheme '"+t+"'."}),n.managers[t]=e},r.getManager=function(t){var e=this.getInstance().managers[t];if(e==null)throw new Error("Cannot find model manager for scheme '"+t+"'");return e},r.getSchemes=function(){return Object.keys(this.getInstance().managers)},r}();function $h(r){if(r.indexOf(bu)===-1)throw new Error("The url string provided does not contain a scheme. Supported schemes are: "+oo.getSchemes().join(","));return{scheme:r.split(bu)[0],path:r.split(bu)[1]}}function M_(r,t,e){return e===void 0&&(e=!1),Ce(this,void 0,void 0,function(){var n,a,i,s,l,c,f,d,v;return Re(this,function(m){switch(m.label){case 0:return L(r!==t,function(){return"Old path and new path are the same: '"+r+"'"}),L((n=hr.getLoadHandlers(r)).length>0,function(){return"Copying failed because no load handler is found for source URL "+r+"."}),L(n.length<2,function(){return"Copying failed because more than one ("+n.length+") load handlers for source URL "+r+"."}),a=n[0],L((i=hr.getSaveHandlers(t)).length>0,function(){return"Copying failed because no save handler is found for destination URL "+t+"."}),L(i.length<2,function(){return"Copying failed because more than one ("+n.length+") save handlers for destination URL "+t+"."}),s=i[0],l=$h(r).scheme,c=$h(r).path,f=l===$h(r).scheme,[4,a.load()];case 1:return d=m.sent(),e&&f?[4,oo.getManager(l).removeModel(c)]:[3,3];case 2:m.sent(),m.label=3;case 3:return[4,s.save(d)];case 4:return v=m.sent(),!e||f?[3,6]:[4,oo.getManager(l).removeModel(c)];case 5:m.sent(),m.label=6;case 6:return[2,v.modelArtifactsInfo]}})})}var Ho="models_store",no="model_info_store";function nR(){if(!le().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");var r=window||self,t=r.indexedDB||r.mozIndexedDB||r.webkitIndexedDB||r.msIndexedDB||r.shimIndexedDB;if(t==null)throw new Error("The current browser does not appear to support IndexedDB.");return t}function gy(r){var t=r.result;t.createObjectStore(Ho,{keyPath:"modelPath"}),t.createObjectStore(no,{keyPath:"modelPath"})}var xu=function(){function r(t){if(this.indexedDB=nR(),t==null||!t)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=t}return r.prototype.save=function(t){return Ce(this,void 0,void 0,function(){return Re(this,function(e){if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return[2,this.databaseAction(this.modelPath,t)]})})},r.prototype.load=function(){return Ce(this,void 0,void 0,function(){return Re(this,function(t){return[2,this.databaseAction(this.modelPath)]})})},r.prototype.databaseAction=function(t,e){var n=this;return new Promise(function(a,i){var s=n.indexedDB.open("tensorflowjs",1);s.onupgradeneeded=function(){return gy(s)},s.onsuccess=function(){var l=s.result;if(e==null){var c=l.transaction(Ho,"readonly"),f=c.objectStore(Ho).get(n.modelPath);f.onsuccess=function(){if(f.result==null)return l.close(),i(new Error("Cannot find model with path '"+n.modelPath+"' in IndexedDB."));a(f.result.modelArtifacts)},f.onerror=function(w){return l.close(),i(f.error)},c.oncomplete=function(){return l.close()}}else{var d,v=af(e),m=l.transaction(no,"readwrite"),g=m.objectStore(no),b=g.put({modelPath:n.modelPath,modelArtifactsInfo:v});b.onsuccess=function(){var w=(d=l.transaction(Ho,"readwrite")).objectStore(Ho).put({modelPath:n.modelPath,modelArtifacts:e,modelArtifactsInfo:v});w.onsuccess=function(){return a({modelArtifactsInfo:v})},w.onerror=function(_){var S=(g=m.objectStore(no)).delete(n.modelPath);S.onsuccess=function(){return l.close(),i(w.error)},S.onerror=function(E){return l.close(),i(w.error)}}},b.onerror=function(w){return l.close(),i(b.error)},m.oncomplete=function(){d==null?l.close():d.oncomplete=function(){return l.close()}}}},s.onerror=function(l){return i(s.error)}})},r.URL_SCHEME="indexeddb://",r}(),I_=function(r){return le().getBool("IS_BROWSER")&&!Array.isArray(r)&&r.startsWith(xu.URL_SCHEME)?(t=r.slice(xu.URL_SCHEME.length),new xu(t)):null;var t};hr.registerSaveRouter(I_),hr.registerLoadRouter(I_);var PP=function(){function r(){this.indexedDB=nR()}return r.prototype.listModels=function(){return Ce(this,void 0,void 0,function(){var t=this;return Re(this,function(e){return[2,new Promise(function(n,a){var i=t.indexedDB.open("tensorflowjs",1);i.onupgradeneeded=function(){return gy(i)},i.onsuccess=function(){var s=i.result,l=s.transaction(no,"readonly"),c=l.objectStore(no).getAll();c.onsuccess=function(){for(var f={},d=0,v=c.result;d<v.length;d++){var m=v[d];f[m.modelPath]=m.modelArtifactsInfo}n(f)},c.onerror=function(f){return s.close(),a(c.error)},l.oncomplete=function(){return s.close()}},i.onerror=function(s){return a(i.error)}})]})})},r.prototype.removeModel=function(t){return Ce(this,void 0,void 0,function(){var e=this;return Re(this,function(n){var a;return t=(a=t).startsWith(xu.URL_SCHEME)?a.slice(xu.URL_SCHEME.length):a,[2,new Promise(function(i,s){var l=e.indexedDB.open("tensorflowjs",1);l.onupgradeneeded=function(){return gy(l)},l.onsuccess=function(){var c,f=l.result,d=f.transaction(no,"readwrite"),v=d.objectStore(no),m=v.get(t);m.onsuccess=function(){if(m.result==null)return f.close(),s(new Error("Cannot find model with path '"+t+"' in IndexedDB."));var g=v.delete(t),b=function(){var w=(c=f.transaction(Ho,"readwrite")).objectStore(Ho).delete(t);w.onsuccess=function(){return i(m.result.modelArtifactsInfo)},w.onerror=function(_){return s(m.error)}};g.onsuccess=b,g.onerror=function(w){return b(),f.close(),s(m.error)}},m.onerror=function(g){return f.close(),s(m.error)},d.oncomplete=function(){c==null?f.close():c.oncomplete=function(){return f.close()}}},l.onerror=function(c){return s(l.error)}})]})})},r}();if(le().getBool("IS_BROWSER"))try{oo.registerManager(xu.URL_SCHEME,new PP)}catch{}var ti="/",fu="tensorflowjs_models",rR="info",zP="model_topology",UP="weight_specs",VP="weight_data",HP="model_metadata";function aR(r){return{info:[fu,r,rR].join(ti),topology:[fu,r,zP].join(ti),weightSpecs:[fu,r,UP].join(ti),weightData:[fu,r,VP].join(ti),modelMetadata:[fu,r,HP].join(ti)}}function jP(r){var t=r.split(ti);if(t.length<3)throw new Error("Invalid key format: "+r);return t.slice(1,t.length-1).join(ti)}var wu=function(){function r(t){if(!le().getBool("IS_BROWSER")||typeof window>"u"||window.localStorage===void 0)throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,t==null||!t)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=t,this.keys=aR(this.modelPath)}return r.prototype.save=function(t){return Ce(this,void 0,void 0,function(){var e,n,a;return Re(this,function(i){if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");e=JSON.stringify(t.modelTopology),n=JSON.stringify(t.weightSpecs),a=af(t);try{return this.LS.setItem(this.keys.info,JSON.stringify(a)),this.LS.setItem(this.keys.topology,e),this.LS.setItem(this.keys.weightSpecs,n),this.LS.setItem(this.keys.weightData,function(s){if(my)return Buffer.from(s).toString("base64");for(var l=new Uint8Array(s),c="",f=0,d=l.length;f<d;f++)c+=String.fromCharCode(l[f]);return btoa(c)}(t.weightData)),this.LS.setItem(this.keys.modelMetadata,JSON.stringify({format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,userDefinedMetadata:t.userDefinedMetadata})),[2,{modelArtifactsInfo:a}]}catch{throw this.LS.removeItem(this.keys.info),this.LS.removeItem(this.keys.topology),this.LS.removeItem(this.keys.weightSpecs),this.LS.removeItem(this.keys.weightData),this.LS.removeItem(this.keys.modelMetadata),new Error("Failed to save model '"+this.modelPath+"' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes="+a.modelTopologyBytes+", weightSpecsBytes="+a.weightSpecsBytes+", weightDataBytes="+a.weightDataBytes+".")}return[2]})})},r.prototype.load=function(){return Ce(this,void 0,void 0,function(){var t,e,n,a,i,s,l;return Re(this,function(c){if((t=JSON.parse(this.LS.getItem(this.keys.info)))==null)throw new Error("In local storage, there is no model with name '"+this.modelPath+"'");if(t.modelTopologyType!=="JSON")throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");if(e={},(n=JSON.parse(this.LS.getItem(this.keys.topology)))==null)throw new Error("In local storage, the topology of model '"+this.modelPath+"' is missing.");if(e.modelTopology=n,(a=JSON.parse(this.LS.getItem(this.keys.weightSpecs)))==null)throw new Error("In local storage, the weight specs of model '"+this.modelPath+"' are missing.");if(e.weightSpecs=a,(i=this.LS.getItem(this.keys.modelMetadata))!=null&&(s=JSON.parse(i),e.format=s.format,e.generatedBy=s.generatedBy,e.convertedBy=s.convertedBy,e.userDefinedMetadata=s.userDefinedMetadata),(l=this.LS.getItem(this.keys.weightData))==null)throw new Error("In local storage, the binary weight values of model '"+this.modelPath+"' are missing.");return e.weightData=function(f){if(my){var d=Buffer.from(f,"base64");return d.buffer.slice(d.byteOffset,d.byteOffset+d.byteLength)}for(var v=atob(f),m=new Uint8Array(v.length),g=0;g<v.length;++g)m.set([v.charCodeAt(g)],g);return m.buffer}(l),[2,e]})})},r.URL_SCHEME="localstorage://",r}(),F_=function(r){return le().getBool("IS_BROWSER")&&!Array.isArray(r)&&r.startsWith(wu.URL_SCHEME)?(t=r.slice(wu.URL_SCHEME.length),new wu(t)):null;var t};hr.registerSaveRouter(F_),hr.registerLoadRouter(F_);var WP=function(){function r(){L(le().getBool("IS_BROWSER"),function(){return"Current environment is not a web browser"}),L(typeof window>"u"||window.localStorage!==void 0,function(){return"Current browser does not appear to support localStorage"}),this.LS=window.localStorage}return r.prototype.listModels=function(){return Ce(this,void 0,void 0,function(){var t,e,n,a,i,s;return Re(this,function(l){for(t={},e=fu+ti,n=ti+rR,a=0;a<this.LS.length;++a)(i=this.LS.key(a)).startsWith(e)&&i.endsWith(n)&&(s=jP(i),t[s]=JSON.parse(this.LS.getItem(i)));return[2,t]})})},r.prototype.removeModel=function(t){return Ce(this,void 0,void 0,function(){var e,n;return Re(this,function(a){var i;if(t=(i=t).startsWith(wu.URL_SCHEME)?i.slice(wu.URL_SCHEME.length):i,e=aR(t),this.LS.getItem(e.info)==null)throw new Error("Cannot find model at path '"+t+"'");return n=JSON.parse(this.LS.getItem(e.info)),this.LS.removeItem(e.info),this.LS.removeItem(e.topology),this.LS.removeItem(e.weightSpecs),this.LS.removeItem(e.weightData),[2,n]})})},r}();if(le().getBool("IS_BROWSER"))try{oo.registerManager(wu.URL_SCHEME,new WP)}catch{}var GP="model",qP=".json",KP=".weights.bin";function B_(r){return new Promise(function(t){return setTimeout(t)}).then(r)}var pg=function(){function r(t){if(!le().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");t.startsWith(r.URL_SCHEME)&&(t=t.slice(r.URL_SCHEME.length)),t!=null&&t.length!==0||(t=GP),this.modelTopologyFileName=t+qP,this.weightDataFileName=t+KP}return r.prototype.save=function(t){return Ce(this,void 0,void 0,function(){var e,n,a,i,s,l;return Re(this,function(c){switch(c.label){case 0:if(typeof document>"u")throw new Error("Browser downloads are not supported in this environment since `document` is not present");if(e=window.URL.createObjectURL(new Blob([t.weightData],{type:"application/octet-stream"})),!(t.modelTopology instanceof ArrayBuffer))return[3,1];throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");case 1:return n=[{paths:["./"+this.weightDataFileName],weights:t.weightSpecs}],a={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,weightsManifest:n},i=window.URL.createObjectURL(new Blob([JSON.stringify(a)],{type:"application/json"})),(s=this.jsonAnchor==null?document.createElement("a"):this.jsonAnchor).download=this.modelTopologyFileName,s.href=i,[4,B_(function(){return s.dispatchEvent(new MouseEvent("click"))})];case 2:return c.sent(),t.weightData==null?[3,4]:((l=this.weightDataAnchor==null?document.createElement("a"):this.weightDataAnchor).download=this.weightDataFileName,l.href=e,[4,B_(function(){return l.dispatchEvent(new MouseEvent("click"))})]);case 3:c.sent(),c.label=4;case 4:return[2,{modelArtifactsInfo:af(t)}]}})})},r.URL_SCHEME="downloads://",r}(),XP=function(){function r(t){if(t==null||t.length<1)throw new Error("When calling browserFiles, at least 1 file is required, but received "+t);this.files=t}return r.prototype.load=function(){return Ce(this,void 0,void 0,function(){var t,e,n=this;return Re(this,function(a){return t=this.files[0],e=this.files.slice(1),[2,new Promise(function(i,s){var l=new FileReader;l.onload=function(c){var f=JSON.parse(c.target.result),d=f.modelTopology;if(d!=null){e.length===0&&i({modelTopology:d});var v=f.weightsManifest;if(v!=null){var m;try{m=n.checkManifestAndWeightFiles(v,e)}catch(_){return void s(_)}var g=[],b=[],w=[];v.forEach(function(_){_.paths.forEach(function(S){b.push(S),w.push(null)}),g.push.apply(g,_.weights)}),v.forEach(function(_){_.paths.forEach(function(S){var E=new FileReader;E.onload=function(C){var R=C.target.result,T=b.indexOf(S);w[T]=R,w.indexOf(null)===-1&&i({modelTopology:d,weightSpecs:g,weightData:v0(w),format:f.format,generatedBy:f.generatedBy,convertedBy:f.convertedBy,userDefinedMetadata:f.userDefinedMetadata})},E.onerror=function(C){return s("Failed to weights data from file of path '"+S+"'.")},E.readAsArrayBuffer(m[S])})})}else s(new Error("weightManifest field is missing from file "+t.name))}else s(new Error("modelTopology field is missing from file "+t.name))},l.onerror=function(c){return s("Failed to read model topology and weights manifest JSON from file '"+t.name+"'. BrowserFiles supports loading Keras-style tf.Model artifacts only.")},l.readAsText(t)})]})})},r.prototype.checkManifestAndWeightFiles=function(t,e){for(var n=[],a=e.map(function(c){return N_(c.name)}),i={},s=0,l=t;s<l.length;s++)l[s].paths.forEach(function(c){var f=N_(c);if(n.indexOf(f)!==-1)throw new Error("Duplicate file basename found in weights manifest: '"+f+"'");if(n.push(f),a.indexOf(f)===-1)throw new Error("Weight file with basename '"+f+"' is not provided.");i[c]=e[a.indexOf(f)]});if(n.length!==e.length)throw new Error("Mismatch in the number of files in weights manifest ("+n.length+") and the number of weight files provided ("+e.length+").");return i},r}();function L_(r,t,e,n){(function(i){L(i!=null&&Array.isArray(i)&&i.length>0,function(){return"promises must be a none empty array"})})(r),function(i,s){L(i>=0&&i<=1,function(){return"Progress fraction must be in range [0, 1], but got startFraction "+i}),L(s>=0&&s<=1,function(){return"Progress fraction must be in range [0, 1], but got endFraction "+s}),L(s>=i,function(){return"startFraction must be no more than endFraction, but got startFraction "+i+" and endFraction "+s})}(e=e??0,n=n??1);var a=0;return Promise.all(r.map(function(i){return i.then(function(s){var l=e+ ++a/r.length*(n-e);return t(l),s}),i}))}function iR(r,t){return Ce(this,void 0,void 0,function(){var e,n,a,i,s,l,c,f,d;return Re(this,function(v){switch(v.label){case 0:return t==null&&(t={}),e=t.fetchFunc==null?le().platform.fetch:t.fetchFunc,n=r.map(function(m){return e(m,t.requestInit,{isBinary:!0})}),a=0,i=.5,t.onProgress!=null?[3,2]:[4,Promise.all(n)];case 1:return s=v.sent(),[3,4];case 2:return[4,L_(n,t.onProgress,a,i)];case 3:s=v.sent(),v.label=4;case 4:return l=s.map(function(m){return m.arrayBuffer()}),c=.5,f=1,t.onProgress!=null?[3,6]:[4,Promise.all(l)];case 5:return d=v.sent(),[3,8];case 6:return[4,L_(l,t.onProgress,c,f)];case 7:d=v.sent(),v.label=8;case 8:return[2,d]}})})}function P_(r){var t=this;return function(e,n,a){return n===void 0&&(n=""),Ce(t,void 0,void 0,function(){var i,s,l,c,f,d,v,m,g,b;return Re(this,function(w){switch(w.label){case 0:if(i=e.map(function(){return!1}),s={},l=a!=null?a.map(function(){return!1}):[],c=[],e.forEach(function(_,S){var E=0;_.weights.forEach(function(C){var R="quantization"in C?C.quantization.dtype:C.dtype,T=vy[R]*Te(C.shape),D=function(){i[S]=!0,s[S]==null&&(s[S]=[]),s[S].push({manifestEntry:C,groupOffset:E,sizeBytes:T})};a!=null?a.forEach(function(k,M){k===C.name&&(D(),l[M]=!0)}):D(),c.push(C.name),E+=T})}),!l.every(function(_){return _}))throw f=a.filter(function(_,S){return!l[S]}),new Error("Could not find weights in manifest with names: "+f.join(", ")+`. 
Manifest JSON has weights with names: `+c.join(", ")+".");return d=i.reduce(function(_,S,E){return S&&_.push(E),_},[]),v=[],d.forEach(function(_){e[_].paths.forEach(function(S){var E=n+(n.endsWith("/")?"":"/")+S;v.push(E)})}),[4,r(v)];case 1:return m=w.sent(),g={},b=0,d.forEach(function(_){for(var S=e[_].paths.length,E=0,C=0;C<S;C++)E+=m[b+C].byteLength;for(var R=new ArrayBuffer(E),T=new Uint8Array(R),D=0,k=0;k<S;k++){var M=new Uint8Array(m[b+k]);T.set(M,D),D+=M.byteLength}s[_].forEach(function(N){var I=tR(R.slice(N.groupOffset,N.groupOffset+N.sizeBytes),[N.manifestEntry]);for(var z in I)g[z]=I[z]}),b+=S}),[2,g]}})})}}hr.registerSaveRouter(function(r){return le().getBool("IS_BROWSER")&&!Array.isArray(r)&&r.startsWith(pg.URL_SCHEME)?function(t){return t===void 0&&(t="model"),new pg(t)}(r.slice(pg.URL_SCHEME.length)):null});var oR=function(){function r(t,e){if(this.DEFAULT_METHOD="POST",e==null&&(e={}),this.weightPathPrefix=e.weightPathPrefix,this.onProgress=e.onProgress,e.fetchFunc!=null?(L(typeof e.fetchFunc=="function",function(){return"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"}),this.fetch=e.fetchFunc):this.fetch=le().platform.fetch,L(t!=null&&t.length>0,function(){return"URL path for http must not be null, undefined or empty."}),Array.isArray(t)&&L(t.length===2,function(){return"URL paths for http must have a length of 2, (actual length is "+t.length+")."}),this.path=t,e.requestInit!=null&&e.requestInit.body!=null)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=e.requestInit||{}}return r.prototype.save=function(t){return Ce(this,void 0,void 0,function(){var e,n,a,i;return Re(this,function(s){switch(s.label){case 0:if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");return(e=Object.assign({method:this.DEFAULT_METHOD},this.requestInit)).body=new FormData,n=[{paths:["./model.weights.bin"],weights:t.weightSpecs}],a={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,userDefinedMetadata:t.userDefinedMetadata,weightsManifest:n},e.body.append("model.json",new Blob([JSON.stringify(a)],{type:"application/json"}),"model.json"),t.weightData!=null&&e.body.append("model.weights.bin",new Blob([t.weightData],{type:"application/octet-stream"}),"model.weights.bin"),[4,this.fetch(this.path,e)];case 1:if((i=s.sent()).ok)return[2,{modelArtifactsInfo:af(t),responses:[i]}];throw new Error("BrowserHTTPRequest.save() failed due to HTTP response status "+i.status+".")}})})},r.prototype.load=function(){return Ce(this,void 0,void 0,function(){var t,e,n,a,i,s,l,c,f,d,v,m;return Re(this,function(g){switch(g.label){case 0:return[4,this.fetch(this.path,this.requestInit)];case 1:if(!(t=g.sent()).ok)throw new Error("Request to "+this.path+" failed with status code "+t.status+". Please verify this URL points to the model JSON of the model to load.");g.label=2;case 2:return g.trys.push([2,4,,5]),[4,t.json()];case 3:return e=g.sent(),[3,5];case 4:throw g.sent(),n="Failed to parse model JSON of response from "+this.path+".",this.path.endsWith(".pb")?n+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":n+=" Please make sure the server is serving valid JSON for this request.",new Error(n);case 5:if(a=e.modelTopology,i=e.weightsManifest,s=e.generatedBy,l=e.convertedBy,c=e.format,f=e.userDefinedMetadata,a==null&&i==null)throw new Error("The JSON from HTTP path "+this.path+" contains neither model topology or manifest for weights.");return i==null?[3,7]:[4,this.loadWeights(i)];case 6:m=g.sent(),d=m[0],v=m[1],g.label=7;case 7:return[2,{modelTopology:a,weightSpecs:d,weightData:v,userDefinedMetadata:f,generatedBy:s,convertedBy:l,format:c}]}})})},r.prototype.loadWeights=function(t){return Ce(this,void 0,void 0,function(){var e,n,a,i,s,l,c,f,d,v,m;return Re(this,function(g){switch(g.label){case 0:for(e=Array.isArray(this.path)?this.path[1]:this.path,n=function(b){var w=b.lastIndexOf("/"),_=b.lastIndexOf("?"),S=b.substring(0,w),E=_>w?b.substring(_):"";return[S+"/",E]}(e),a=n[0],i=n[1],s=this.weightPathPrefix||a,l=[],c=0,f=t;c<f.length;c++)d=f[c],l.push.apply(l,d.weights);return v=[],t.forEach(function(b){b.paths.forEach(function(w){v.push(s+w+i)})}),[4,iR(v,{requestInit:this.requestInit,fetchFunc:this.fetch,onProgress:this.onProgress})];case 1:return m=g.sent(),[2,[l,v0(m)]]}})})},r.URL_SCHEME_REGEX=/^https?:\/\//,r}();function yy(r){return r.match(oR.URL_SCHEME_REGEX)!=null}var z_=function(r,t){return typeof fetch>"u"?null:(Array.isArray(r)?r.every(function(e){return yy(e)}):yy(r))?by(r,{onProgress:t}):null};function by(r,t){return new oR(r,t)}hr.registerSaveRouter(z_),hr.registerLoadRouter(z_);var vg=function(){function r(t){this.modelArtifacts=t}return r.prototype.load=function(){return Ce(this,void 0,void 0,function(){return Re(this,function(t){return[2,this.modelArtifacts]})})},r}(),$P=function(){function r(t){this.saveHandler=t}return r.prototype.save=function(t){return Ce(this,void 0,void 0,function(){return Re(this,function(e){return[2,this.saveHandler(t)]})})},r}(),sR=Object.freeze({browserFiles:function(r){return new XP(r)},browserHTTPRequest:function(r,t){return by(r,t)},concatenateArrayBuffers:v0,decodeWeights:tR,encodeWeights:function(r,t){return Ce(this,void 0,void 0,function(){var e,n,a,i,s,l=this;return Re(this,function(c){switch(c.label){case 0:for(e=[],n=[],a=Array.isArray(r)?r.map(function(f){return f.name}):Object.keys(r),i=function(f){var d=a[f],v=Array.isArray(r)?r[f].tensor:r[d];if(v.dtype!=="float32"&&v.dtype!=="int32"&&v.dtype!=="bool"&&v.dtype!=="string")throw new Error("Unsupported dtype in weight '"+d+"': "+v.dtype);var m={name:d,shape:v.shape,dtype:v.dtype};if(v.dtype==="string"){var g=new Promise(function(b){return Ce(l,void 0,void 0,function(){var w,_,S,E,C,R,T;return Re(this,function(D){switch(D.label){case 0:return[4,v.bytes()];case 1:for(w=D.sent(),_=w.reduce(function(k,M){return k+M.length},0)+Id*w.length,S=new Uint8Array(_),E=0,C=0;C<w.length;C++)R=w[C],T=new Uint8Array(new Uint32Array([R.length]).buffer),S.set(T,E),E+=Id,S.set(R,E),E+=R.length;return b(S),[2]}})})});n.push(g)}else n.push(v.data());t!=null&&(m.group=t),e.push(m)},s=0;s<a.length;++s)i(s);return[4,Promise.all(n)];case 1:return[2,{data:LP(c.sent()),specs:e}]}})})},fromMemory:function(r,t,e,n){return arguments.length===1?r.modelTopology!=null||r.weightSpecs!=null?new vg(r):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new vg({modelTopology:r})):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new vg({modelTopology:r,weightSpecs:t,weightData:e,trainingConfig:n}))},getLoadHandlers:function(r,t){return hr.getLoadHandlers(r,t)},getModelArtifactsInfoForJSON:af,getSaveHandlers:function(r){return hr.getSaveHandlers(r)},http:by,isHTTPScheme:yy,loadWeights:function(r,t,e,n){return t===void 0&&(t=""),Ce(this,void 0,void 0,function(){return Re(this,function(a){return[2,P_(function(i){return iR(i,{requestInit:n})})(r,t,e)]})})},registerLoadRouter:function(r){return hr.registerLoadRouter(r)},registerSaveRouter:function(r){return hr.registerSaveRouter(r)},weightsLoaderFactory:P_,withSaveHandler:function(r){return new $P(r)},copyModel:function(r,t){return Ce(this,void 0,void 0,function(){return Re(this,function(e){return[2,M_(r,t,!1)]})})},listModels:function(){return Ce(this,void 0,void 0,function(){var r,t,e,n,a,i,s;return Re(this,function(l){switch(l.label){case 0:r=oo.getSchemes(),t={},e=0,n=r,l.label=1;case 1:return e<n.length?(a=n[e],[4,oo.getManager(a).listModels()]):[3,4];case 2:for(s in i=l.sent())t[a+bu+s]=i[s];l.label=3;case 3:return e++,[3,1];case 4:return[2,t]}})})},moveModel:function(r,t){return Ce(this,void 0,void 0,function(){return Re(this,function(e){return[2,M_(r,t,!0)]})})},removeModel:function(r){return Ce(this,void 0,void 0,function(){var t;return Re(this,function(e){return t=$h(r),[2,oo.getManager(t.scheme).removeModel(t.path)]})})}}),au;j({confusionMatrix_:function(r,t,e){var n=B(r,"labels","confusionMatrix"),a=B(t,"predictions","confusionMatrix");L(e==null||e>0&&Number.isInteger(e),function(){return"If provided, numClasses must be a positive integer, but got "+e}),L(n.rank===1,function(){return"Expected the rank of labels to be 1, but got "+n.rank}),L(a.rank===1,function(){return"Expected the rank of predictions to be 1, but got "+a.rank}),L(n.shape[0]===a.shape[0],function(){return"Mismatch in the number of examples: "+n.shape[0]+" vs. "+a.shape[0]+". Labels and predictions should have the same number of elements."}),L(e>0&&Number.isInteger(e),function(){return"numClasses is required to be a positive integer, but got "+e});var i=cy(n.asType("int32"),e),s=cy(a.asType("int32"),e);return i.transpose().matMul(s).asType("int32")}});var YP=j({fromPixels_:function(r,t){if(t===void 0&&(t=3),t>4)throw new Error("Cannot construct Tensor with more than 4 channels from pixels.");if(r==null)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");var e=!1,n=!1,a=!1,i=!1,s=!1;if(r.data instanceof Uint8Array)e=!0;else if(typeof ImageData<"u"&&r instanceof ImageData)n=!0;else if(typeof HTMLVideoElement<"u"&&r instanceof HTMLVideoElement)a=!0;else if(typeof HTMLImageElement<"u"&&r instanceof HTMLImageElement)i=!0;else{if(r.getContext==null)throw new Error("pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData in browser, or OffscreenCanvas, ImageData in webworker or {data: Uint32Array, width: number, height: number}, but was "+r.constructor.name);s=!0}if(a&&a&&r.readyState<2)throw new Error("The video element has not loaded data yet. Please wait for `loadeddata` event on the <video> element.");if(OE("FromPixels",q.backendName)!=null)return q.runKernel("FromPixels",{pixels:r},{numChannels:t});var l,c,f=a?[r.videoWidth,r.videoHeight]:[r.width,r.height],d=f[0],v=f[1];if(s?l=r.getContext("2d").getImageData(0,0,d,v).data:n||e?l=r.data:(i||a)&&(au==null&&(au=document.createElement("canvas").getContext("2d")),au.canvas.width=d,au.canvas.height=v,au.drawImage(r,0,0,d,v),l=au.getImageData(0,0,d,v).data),t===4)c=new Int32Array(l);else{var m=d*v;c=new Int32Array(m*t);for(var g=0;g<m;g++)for(var b=0;b<t;++b)c[g*t+b]=l[4*g+b]}return Wy(c,[v,d,t],"int32")}}),m0=Object.freeze({toPixels:function(r,t){return Ce(this,void 0,void 0,function(){var e,n,a,i,s,l,c,f,d,v,m,g,b,w,_,S,E,C,R,T,D,k,M;return Re(this,function(N){switch(N.label){case 0:if(e=B(r,"img","toPixels"),r instanceof Mt||(e=e.toInt()),e.rank!==2&&e.rank!==3)throw new Error("toPixels only supports rank 2 or 3 tensors, got rank "+e.rank+".");if(n=e.shape.slice(0,2),a=n[0],i=n[1],(s=e.rank===2?1:e.shape[2])>4||s===2)throw new Error("toPixels only supports depth of size 1, 3 or 4 but got "+s);return[4,e.data()];case 1:return l=N.sent(),c=e.min(),f=e.max(),[4,Promise.all([c.data(),f.data()])];case 2:if(d=N.sent(),v=d[0],m=d[1],g=v[0],b=m[0],c.dispose(),f.dispose(),e.dtype==="float32"){if(g<0||b>1)throw new Error("Tensor values for a float32 Tensor must be in the range [0 - 1] but got range ["+g+" - "+b+"].")}else{if(e.dtype!=="int32")throw new Error("Unsupported type for toPixels: "+e.dtype+". Please use float32 or int32 tensors.");if(g<0||b>255)throw new Error("Tensor values for a int32 Tensor must be in the range [0 - 255] but got range ["+g+" - "+b+"].")}for(w=e.dtype==="float32"?255:1,_=new Uint8ClampedArray(i*a*4),S=0;S<a*i;++S)E=void 0,C=void 0,R=void 0,T=void 0,s===1?(E=l[S]*w,C=l[S]*w,R=l[S]*w,T=255):s===3?(E=l[3*S]*w,C=l[3*S+1]*w,R=l[3*S+2]*w,T=255):s===4&&(E=l[4*S]*w,C=l[4*S+1]*w,R=l[4*S+2]*w,T=l[4*S+3]*w),_[(D=4*S)+0]=Math.round(E),_[D+1]=Math.round(C),_[D+2]=Math.round(R),_[D+3]=Math.round(T);return t!=null&&(t.width=i,t.height=a,k=t.getContext("2d"),M=new ImageData(_,i,a),k.putImageData(M,0,0)),e!==r&&e.dispose(),[2,_]}})})},fromPixels:YP}),ZP=function(){function r(){}return r.prototype.getClassName=function(){return this.constructor.className},r.fromConfig=function(t,e){return new t(e)},r}(),QP=function(){function r(){this.classNameMap={}}return r.getMap=function(){return r.instance==null&&(r.instance=new r),r.instance},r.register=function(t){r.getMap().classNameMap[t.className]=[t,t.fromConfig]},r}();function hs(r){L(r.className!=null,function(){return"Class being registered does not have the static className property defined."}),L(typeof r.className=="string",function(){return"className is required to be a string, but got type "+typeof r.className}),L(r.className.length>0,function(){return"Class being registered has an empty-string as its className, which is disallowed."}),QP.register(r)}var ds=function(r){function t(){return r!==null&&r.apply(this,arguments)||this}return Qr(t,r),t.prototype.minimize=function(e,n,a){n===void 0&&(n=!1);var i=this.computeGradients(e,a),s=i.value,l=i.grads;if(a!=null){var c=a.map(function(f){return{name:f.name,tensor:l[f.name]}});this.applyGradients(c)}else this.applyGradients(l);return Qn(l),n?s:(s.dispose(),null)},Object.defineProperty(t.prototype,"iterations",{get:function(){return this.iterations_==null&&(this.iterations_=0),this.iterations_},enumerable:!0,configurable:!0}),t.prototype.incrementIterations=function(){this.iterations_=this.iterations+1},t.prototype.computeGradients=function(e,n){return uI(e,n)},t.prototype.dispose=function(){this.iterations_!=null&&Qn(this.iterations_)},t.prototype.saveIterations=function(){return Ce(this,void 0,void 0,function(){return Re(this,function(e){return this.iterations_==null&&(this.iterations_=0),[2,{name:"iter",tensor:ye(this.iterations_,"int32")}]})})},t.prototype.getWeights=function(){return Ce(this,void 0,void 0,function(){return Re(this,function(e){throw new Error("getWeights() is not implemented for this optimizer yet.")})})},t.prototype.setWeights=function(e){return Ce(this,void 0,void 0,function(){return Re(this,function(n){throw new Error("setWeights() is not implemented for this optimizer class "+this.getClassName())})})},t.prototype.extractIterations=function(e){return Ce(this,void 0,void 0,function(){var n;return Re(this,function(a){switch(a.label){case 0:return n=this,[4,e[0].tensor.data()];case 1:return n.iterations_=a.sent()[0],[2,e.slice(1)]}})})},t}(ZP);Object.defineProperty(ds,Symbol.hasInstance,{value:function(r){return r.minimize!=null&&r.computeGradients!=null&&r.applyGradients!=null}});var JP=function(r){function t(e,n,a){a===void 0&&(a=null);var i=r.call(this)||this;return i.learningRate=e,i.rho=n,i.epsilon=a,i.accumulatedGrads=[],i.accumulatedUpdates=[],a==null&&(i.epsilon=q.backend.epsilon()),i}return Qr(t,r),t.prototype.applyGradients=function(e){var n=this;(Array.isArray(e)?e.map(function(a){return a.name}):Object.keys(e)).forEach(function(a,i){var s=q.registeredVariables[a];n.accumulatedGrads[i]==null&&(n.accumulatedGrads[i]={originalName:a+"/accum_grad",variable:Se(function(){return lt(s).variable(!1)})}),n.accumulatedUpdates[i]==null&&(n.accumulatedUpdates[i]={originalName:a+"/accum_var",variable:Se(function(){return lt(s).variable(!1)})});var l=Array.isArray(e)?e[i].tensor:e[a];if(l!=null){var c=n.accumulatedGrads[i].variable,f=n.accumulatedUpdates[i].variable;Se(function(){var d=c.mul(n.rho).add(l.square().mul(1-n.rho)),v=f.add(n.epsilon).sqrt().div(c.add(n.epsilon).sqrt()).mul(l),m=f.mul(n.rho).add(v.square().mul(1-n.rho));c.assign(d),f.assign(m);var g=v.mul(-n.learningRate).add(s);s.assign(g)})}}),this.incrementIterations()},t.prototype.dispose=function(){this.accumulatedUpdates!=null&&(Qn(this.accumulatedGrads.map(function(e){return e.variable})),Qn(this.accumulatedUpdates.map(function(e){return e.variable})))},t.prototype.getWeights=function(){return Ce(this,void 0,void 0,function(){var e;return Re(this,function(n){switch(n.label){case 0:return e=this.accumulatedGrads.concat(this.accumulatedUpdates),[4,this.saveIterations()];case 1:return[2,[n.sent()].concat(e.map(function(a){return{name:a.originalName,tensor:a.variable}}))]}})})},t.prototype.setWeights=function(e){return Ce(this,void 0,void 0,function(){var n;return Re(this,function(a){switch(a.label){case 0:return[4,this.extractIterations(e)];case 1:return e=a.sent(),n=e.length/2,this.accumulatedGrads=e.slice(0,n).map(function(i){return{originalName:i.name,variable:i.tensor.variable(!1)}}),this.accumulatedUpdates=e.slice(n,2*n).map(function(i){return{originalName:i.name,variable:i.tensor.variable(!1)}}),[2]}})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}},t.fromConfig=function(e,n){return new e(n.learningRate,n.rho,n.epsilon)},t.className="Adadelta",t}(ds);hs(JP);var ez=function(r){function t(e,n){n===void 0&&(n=.1);var a=r.call(this)||this;return a.learningRate=e,a.initialAccumulatorValue=n,a.accumulatedGrads=[],a}return Qr(t,r),t.prototype.applyGradients=function(e){var n=this;(Array.isArray(e)?e.map(function(a){return a.name}):Object.keys(e)).forEach(function(a,i){var s=q.registeredVariables[a];n.accumulatedGrads[i]==null&&(n.accumulatedGrads[i]={originalName:a+"/accumulator",variable:Se(function(){return wa(s.shape,n.initialAccumulatorValue).variable(!1)})});var l=Array.isArray(e)?e[i].tensor:e[a];if(l!=null){var c=n.accumulatedGrads[i].variable;Se(function(){var f=c.add(l.square());c.assign(f);var d=l.div(f.add(q.backend.epsilon()).sqrt()).mul(-n.learningRate).add(s);s.assign(d)})}}),this.incrementIterations()},t.prototype.dispose=function(){this.accumulatedGrads!=null&&Qn(this.accumulatedGrads.map(function(e){return e.variable}))},t.prototype.getWeights=function(){return Ce(this,void 0,void 0,function(){return Re(this,function(e){switch(e.label){case 0:return[4,this.saveIterations()];case 1:return[2,[e.sent()].concat(this.accumulatedGrads.map(function(n){return{name:n.originalName,tensor:n.variable}}))]}})})},t.prototype.setWeights=function(e){return Ce(this,void 0,void 0,function(){return Re(this,function(n){switch(n.label){case 0:return[4,this.extractIterations(e)];case 1:return e=n.sent(),this.accumulatedGrads=e.map(function(a){return{originalName:a.name,variable:a.tensor.variable(!1)}}),[2]}})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}},t.fromConfig=function(e,n){return new e(n.learningRate,n.initialAccumulatorValue)},t.className="Adagrad",t}(ds);hs(ez);var tz=function(r){function t(e,n,a,i){i===void 0&&(i=null);var s=r.call(this)||this;return s.learningRate=e,s.beta1=n,s.beta2=a,s.epsilon=i,s.accumulatedFirstMoment=[],s.accumulatedSecondMoment=[],Se(function(){s.accBeta1=ye(n).variable(),s.accBeta2=ye(a).variable()}),i==null&&(s.epsilon=q.backend.epsilon()),s}return Qr(t,r),t.prototype.applyGradients=function(e){var n=this,a=Array.isArray(e)?e.map(function(i){return i.name}):Object.keys(e);Se(function(){var i=on(1,n.accBeta1),s=on(1,n.accBeta2);a.forEach(function(l,c){var f=q.registeredVariables[l];n.accumulatedFirstMoment[c]==null&&(n.accumulatedFirstMoment[c]={originalName:l+"/m",variable:Se(function(){return lt(f).variable(!1)})}),n.accumulatedSecondMoment[c]==null&&(n.accumulatedSecondMoment[c]={originalName:l+"/v",variable:Se(function(){return lt(f).variable(!1)})});var d=Array.isArray(e)?e[c].tensor:e[l];if(d!=null){var v=n.accumulatedFirstMoment[c].variable,m=n.accumulatedSecondMoment[c].variable,g=v.mul(n.beta1).add(d.mul(1-n.beta1)),b=m.mul(n.beta2).add(d.square().mul(1-n.beta2)),w=g.div(i),_=b.div(s);v.assign(g),m.assign(b);var S=w.div(_.sqrt().add(n.epsilon)).mul(-n.learningRate).add(f);f.assign(S)}}),n.accBeta1.assign(n.accBeta1.mul(n.beta1)),n.accBeta2.assign(n.accBeta2.mul(n.beta2))}),this.incrementIterations()},t.prototype.dispose=function(){this.accBeta1.dispose(),this.accBeta2.dispose(),this.accumulatedFirstMoment!=null&&Qn(this.accumulatedFirstMoment.map(function(e){return e.variable})),this.accumulatedSecondMoment!=null&&Qn(this.accumulatedSecondMoment.map(function(e){return e.variable}))},t.prototype.getWeights=function(){return Ce(this,void 0,void 0,function(){var e;return Re(this,function(n){switch(n.label){case 0:return e=this.accumulatedFirstMoment.concat(this.accumulatedSecondMoment),[4,this.saveIterations()];case 1:return[2,[n.sent()].concat(e.map(function(a){return{name:a.originalName,tensor:a.variable}}))]}})})},t.prototype.setWeights=function(e){return Ce(this,void 0,void 0,function(){var n,a=this;return Re(this,function(i){switch(i.label){case 0:return[4,this.extractIterations(e)];case 1:return e=i.sent(),Se(function(){a.accBeta1.assign(Nd(a.beta1,a.iterations_+1)),a.accBeta2.assign(Nd(a.beta2,a.iterations_+1))}),n=e.length/2,this.accumulatedFirstMoment=e.slice(0,n).map(function(s){return{originalName:s.name,variable:s.tensor.variable(!1)}}),this.accumulatedSecondMoment=e.slice(n,2*n).map(function(s){return{originalName:s.name,variable:s.tensor.variable(!1)}}),[2]}})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}},t.fromConfig=function(e,n){return new e(n.learningRate,n.beta1,n.beta2,n.epsilon)},t.className="Adam",t}(ds);hs(tz);var nz=function(r){function t(e,n,a,i,s){i===void 0&&(i=null),s===void 0&&(s=0);var l=r.call(this)||this;return l.learningRate=e,l.beta1=n,l.beta2=a,l.epsilon=i,l.decay=s,l.accumulatedFirstMoment=[],l.accumulatedWeightedInfNorm=[],Se(function(){l.iteration=ye(0).variable(),l.accBeta1=ye(n).variable()}),i==null&&(l.epsilon=q.backend.epsilon()),l}return Qr(t,r),t.prototype.applyGradients=function(e){var n=this,a=Array.isArray(e)?e.map(function(i){return i.name}):Object.keys(e);Se(function(){var i=on(1,n.accBeta1),s=Wr(-n.learningRate,n.iteration.mul(n.decay).add(1));a.forEach(function(l,c){var f=q.registeredVariables[l];n.accumulatedFirstMoment[c]==null&&(n.accumulatedFirstMoment[c]={originalName:l+"/m",variable:lt(f).variable(!1)}),n.accumulatedWeightedInfNorm[c]==null&&(n.accumulatedWeightedInfNorm[c]={originalName:l+"/v",variable:lt(f).variable(!1)});var d=Array.isArray(e)?e[c].tensor:e[l];if(d!=null){var v=n.accumulatedFirstMoment[c].variable,m=n.accumulatedWeightedInfNorm[c].variable,g=v.mul(n.beta1).add(d.mul(1-n.beta1)),b=m.mul(n.beta2),w=d.abs(),_=b.maximum(w);v.assign(g),m.assign(_);var S=s.div(i).mul(g.div(_.add(n.epsilon))).add(f);f.assign(S)}}),n.iteration.assign(n.iteration.add(1)),n.accBeta1.assign(n.accBeta1.mul(n.beta1))}),this.incrementIterations()},t.prototype.dispose=function(){this.accBeta1.dispose(),this.iteration.dispose(),this.accumulatedFirstMoment!=null&&Qn(this.accumulatedFirstMoment.map(function(e){return e.variable})),this.accumulatedWeightedInfNorm!=null&&Qn(this.accumulatedWeightedInfNorm.map(function(e){return e.variable}))},t.prototype.getWeights=function(){return Ce(this,void 0,void 0,function(){return Re(this,function(e){throw new Error("getWeights() is not implemented for Adamax yet.")})})},t.prototype.setWeights=function(e){return Ce(this,void 0,void 0,function(){return Re(this,function(n){throw new Error("setWeights() is not implemented for Adamax yet.")})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}},t.fromConfig=function(e,n){return new e(n.learningRate,n.beta1,n.beta2,n.epsilon,n.decay)},t.className="Adamax",t}(ds);hs(nz);var uR=function(r){function t(e){var n=r.call(this)||this;return n.learningRate=e,n.setLearningRate(e),n}return Qr(t,r),t.prototype.applyGradients=function(e){var n=this;(Array.isArray(e)?e.map(function(a){return a.name}):Object.keys(e)).forEach(function(a,i){var s=Array.isArray(e)?e[i].tensor:e[a];if(s!=null){var l=q.registeredVariables[a];Se(function(){var c=n.c.mul(s).add(l);l.assign(c)})}}),this.incrementIterations()},t.prototype.setLearningRate=function(e){this.learningRate=e,this.c!=null&&this.c.dispose(),this.c=_M(ye(-e))},t.prototype.dispose=function(){this.c.dispose()},t.prototype.getWeights=function(){return Ce(this,void 0,void 0,function(){return Re(this,function(e){switch(e.label){case 0:return[4,this.saveIterations()];case 1:return[2,[e.sent()]]}})})},t.prototype.setWeights=function(e){return Ce(this,void 0,void 0,function(){return Re(this,function(n){switch(n.label){case 0:return[4,this.extractIterations(e)];case 1:if((e=n.sent()).length!==0)throw new Error("SGD optimizer does not have settable weights.");return[2]}})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate}},t.fromConfig=function(e,n){return new e(n.learningRate)},t.className="SGD",t}(ds);hs(uR);var rz=function(r){function t(e,n,a){a===void 0&&(a=!1);var i=r.call(this,e)||this;return i.learningRate=e,i.momentum=n,i.useNesterov=a,i.accumulations=[],i.m=ye(i.momentum),i}return Qr(t,r),t.prototype.applyGradients=function(e){var n=this;(Array.isArray(e)?e.map(function(a){return a.name}):Object.keys(e)).forEach(function(a,i){var s=q.registeredVariables[a];n.accumulations[i]==null&&(n.accumulations[i]={originalName:a+"/momentum",variable:Se(function(){return lt(s).variable(!1)})});var l=n.accumulations[i].variable,c=Array.isArray(e)?e[i].tensor:e[a];c!=null&&Se(function(){var f,d=n.m.mul(l).add(c);f=n.useNesterov?n.c.mul(c.add(d.mul(n.m))).add(s):n.c.mul(d).add(s),l.assign(d),s.assign(f)})}),this.incrementIterations()},t.prototype.dispose=function(){this.m.dispose(),this.accumulations!=null&&Qn(this.accumulations.map(function(e){return e.variable}))},t.prototype.setMomentum=function(e){this.momentum=e},t.prototype.getWeights=function(){return Ce(this,void 0,void 0,function(){return Re(this,function(e){switch(e.label){case 0:return[4,this.saveIterations()];case 1:return[2,[e.sent()].concat(this.accumulations.map(function(n){return{name:n.originalName,tensor:n.variable}}))]}})})},t.prototype.setWeights=function(e){return Ce(this,void 0,void 0,function(){return Re(this,function(n){switch(n.label){case 0:return[4,this.extractIterations(e)];case 1:return e=n.sent(),this.accumulations=e.map(function(a){return{originalName:a.name,variable:a.tensor.variable(!1)}}),[2]}})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}},t.fromConfig=function(e,n){return new e(n.learningRate,n.momentum,n.useNesterov)},t.className="Momentum",t}(uR);hs(rz);var az=function(r){function t(e,n,a,i,s){n===void 0&&(n=.9),a===void 0&&(a=0),i===void 0&&(i=null),s===void 0&&(s=!1);var l=r.call(this)||this;if(l.learningRate=e,l.decay=n,l.momentum=a,l.epsilon=i,l.accumulatedMeanSquares=[],l.accumulatedMoments=[],l.accumulatedMeanGrads=[],l.centered=s,i==null&&(l.epsilon=q.backend.epsilon()),e==null)throw new Error("learningRate for RMSPropOptimizer must be defined.");return l}return Qr(t,r),t.prototype.applyGradients=function(e){var n=this;(Array.isArray(e)?e.map(function(a){return a.name}):Object.keys(e)).forEach(function(a,i){var s=q.registeredVariables[a];n.accumulatedMeanSquares[i]==null&&(n.accumulatedMeanSquares[i]={originalName:a+"/rms",variable:Se(function(){return lt(s).variable(!1)})}),n.accumulatedMoments[i]==null&&(n.accumulatedMoments[i]={originalName:a+"/momentum",variable:Se(function(){return lt(s).variable(!1)})}),n.accumulatedMeanGrads[i]==null&&n.centered&&(n.accumulatedMeanGrads[i]={originalName:a+"/mg",variable:Se(function(){return lt(s).variable(!1)})});var l=Array.isArray(e)?e[i].tensor:e[a];if(l!=null){var c=n.accumulatedMeanSquares[i].variable,f=n.accumulatedMoments[i].variable;Se(function(){var d=c.mul(n.decay).add(l.square().mul(1-n.decay));if(n.centered){var v=n.accumulatedMeanGrads[i].variable,m=v.mul(n.decay).add(l.mul(1-n.decay)),g=f.mul(n.momentum).add(l.mul(n.learningRate).div(d.sub(m.square().add(n.epsilon)).sqrt()));c.assign(d),v.assign(m),f.assign(g);var b=s.sub(g);s.assign(b)}else{var w=c.mul(n.decay).add(l.square().mul(1-n.decay));g=f.mul(n.momentum).add(l.mul(n.learningRate).div(w.add(n.epsilon).sqrt())),c.assign(w),f.assign(g),b=s.sub(g),s.assign(b)}})}}),this.incrementIterations()},t.prototype.dispose=function(){this.accumulatedMeanSquares!=null&&Qn(this.accumulatedMeanSquares.map(function(e){return e.variable})),this.accumulatedMeanGrads!=null&&this.centered&&Qn(this.accumulatedMeanGrads.map(function(e){return e.variable})),this.accumulatedMoments!=null&&Qn(this.accumulatedMoments.map(function(e){return e.variable}))},t.prototype.getWeights=function(){return Ce(this,void 0,void 0,function(){var e;return Re(this,function(n){switch(n.label){case 0:return e=this.accumulatedMeanSquares.concat(this.accumulatedMoments),this.centered&&e.push.apply(e,this.accumulatedMeanGrads),[4,this.saveIterations()];case 1:return[2,[n.sent()].concat(e.map(function(a){return{name:a.originalName,tensor:a.variable}}))]}})})},t.prototype.setWeights=function(e){return Ce(this,void 0,void 0,function(){var n;return Re(this,function(a){switch(a.label){case 0:return[4,this.extractIterations(e)];case 1:return e=a.sent(),n=this.centered?e.length/3:e.length/2,this.accumulatedMeanSquares=e.slice(0,n).map(function(i){return{originalName:i.name,variable:i.tensor.variable(!1)}}),this.accumulatedMoments=e.slice(n,2*n).map(function(i){return{originalName:i.name,variable:i.tensor.variable(!1)}}),this.centered&&(this.accumulatedMeanGrads=e.slice(2*n,3*n).map(function(i){return{originalName:i.name,variable:i.tensor.variable(!1)}})),[2]}})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}},t.fromConfig=function(e,n){return new e(n.learningRate,n.decay,n.momentum,n.epsilon,n.centered)},t.className="RMSProp",t}(ds);hs(az);Mt.prototype.squaredDifference=function(r){return SC(this,r)},se=kP;/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var xy=function(r,t){return xy=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var a in n)n.hasOwnProperty(a)&&(e[a]=n[a])},xy(r,t)};function We(r,t){xy(r,t);function e(){this.constructor=r}r.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}var kn=function(){return kn=Object.assign||function(t){for(var e,n=1,a=arguments.length;n<a;n++){e=arguments[n];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}return t},kn.apply(this,arguments)};function ke(r,t,e,n){function a(i){return i instanceof e?i:new e(function(s){s(i)})}return new(e||(e=Promise))(function(i,s){function l(d){try{f(n.next(d))}catch(v){s(v)}}function c(d){try{f(n.throw(d))}catch(v){s(v)}}function f(d){d.done?i(d.value):a(d.value).then(l,c)}f((n=n.apply(r,[])).next())})}function Oe(r,t){var e={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,a,i,s;return s={next:l(0),throw:l(1),return:l(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function l(f){return function(d){return c([f,d])}}function c(f){if(n)throw new TypeError("Generator is already executing.");for(;e;)try{if(n=1,a&&(i=f[0]&2?a.return:f[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,f[1])).done)return i;switch(a=0,i&&(f=[f[0]&2,i.value]),f[0]){case 0:case 1:i=f;break;case 4:return e.label++,{value:f[1],done:!1};case 5:e.label++,a=f[1],f=[0];continue;case 7:f=e.ops.pop(),e.trys.pop();continue;default:if(i=e.trys,!(i=i.length>0&&i[i.length-1])&&(f[0]===6||f[0]===2)){e=0;continue}if(f[0]===3&&(!i||f[1]>i[0]&&f[1]<i[3])){e.label=f[1];break}if(f[0]===6&&e.label<i[1]){e.label=i[1],i=f;break}if(i&&e.label<i[2]){e.label=i[2],e.ops.push(f);break}i[2]&&e.ops.pop(),e.trys.pop();continue}f=t.call(r,e)}catch(d){f=[6,d],a=0}finally{n=i=0}if(f[0]&5)throw f[1];return{value:f[0]?f[1]:void 0,done:!0}}}function vc(){for(var r=0,t=0,e=arguments.length;t<e;t++)r+=arguments[t].length;for(var n=Array(r),a=0,t=0;t<e;t++)for(var i=arguments[t],s=0,l=i.length;s<l;s++,a++)n[a]=i[s];return n}var es=function(){function r(t,e){if(!ts(t)||!ts(e))throw new Error("Dimensions.constructor - expected width and height to be valid numbers, instead have "+JSON.stringify({width:t,height:e}));this._width=t,this._height=e}return Object.defineProperty(r.prototype,"width",{get:function(){return this._width},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"height",{get:function(){return this._height},enumerable:!0,configurable:!0}),r.prototype.reverse=function(){return new r(1/this.width,1/this.height)},r}();function rp(r,t){return r instanceof Mt&&r.shape.length===t}function iz(r){return rp(r,2)}function ap(r){return rp(r,3)}function so(r){return rp(r,4)}function oz(r){return r%1!==0}function U_(r){return r%2===0}function g0(r,t){t===void 0&&(t=2);var e=Math.pow(10,t);return Math.floor(r*e)/e}function V_(r){return r&&r.width&&r.height}function sz(r,t){var e=r.width,n=r.height,a=t/Math.max(n,e);return new es(Math.round(e*a),Math.round(n*a))}function y0(r){return r.reduce(function(t,e){return t.add(e)},new ht(0,0)).div(new ht(r.length,r.length))}function Pc(r,t,e){return Array(r).fill(0).map(function(n,a){return t+a*e})}function ts(r){return!!r&&r!==1/0&&r!==-1/0&&!isNaN(r)||r===0}function H_(r){return ts(r)&&0<=r&&r<=1}var ht=function(){function r(t,e){this._x=t,this._y=e}return Object.defineProperty(r.prototype,"x",{get:function(){return this._x},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"y",{get:function(){return this._y},enumerable:!0,configurable:!0}),r.prototype.add=function(t){return new r(this.x+t.x,this.y+t.y)},r.prototype.sub=function(t){return new r(this.x-t.x,this.y-t.y)},r.prototype.mul=function(t){return new r(this.x*t.x,this.y*t.y)},r.prototype.div=function(t){return new r(this.x/t.x,this.y/t.y)},r.prototype.abs=function(){return new r(Math.abs(this.x),Math.abs(this.y))},r.prototype.magnitude=function(){return Math.sqrt(Math.pow(this.x,2)+Math.pow(this.y,2))},r.prototype.floor=function(){return new r(Math.floor(this.x),Math.floor(this.y))},r}(),Ca=function(){function r(t,e){e===void 0&&(e=!0);var n=t||{},a=[n.left,n.top,n.right,n.bottom].every(ts),i=[n.x,n.y,n.width,n.height].every(ts);if(!i&&!a)throw new Error("Box.constructor - expected box to be IBoundingBox | IRect, instead have "+JSON.stringify(n));var s=i?[n.x,n.y,n.width,n.height]:[n.left,n.top,n.right-n.left,n.bottom-n.top],l=s[0],c=s[1],f=s[2],d=s[3];r.assertIsValidBox({x:l,y:c,width:f,height:d},"Box.constructor",e),this._x=l,this._y=c,this._width=f,this._height=d}return r.isRect=function(t){return!!t&&[t.x,t.y,t.width,t.height].every(ts)},r.assertIsValidBox=function(t,e,n){if(n===void 0&&(n=!1),!r.isRect(t))throw new Error(e+" - invalid box: "+JSON.stringify(t)+", expected object with properties x, y, width, height");if(!n&&(t.width<0||t.height<0))throw new Error(e+" - width ("+t.width+") and height ("+t.height+") must be positive numbers")},Object.defineProperty(r.prototype,"x",{get:function(){return this._x},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"y",{get:function(){return this._y},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"width",{get:function(){return this._width},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"height",{get:function(){return this._height},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"left",{get:function(){return this.x},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"top",{get:function(){return this.y},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"right",{get:function(){return this.x+this.width},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"bottom",{get:function(){return this.y+this.height},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"area",{get:function(){return this.width*this.height},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"topLeft",{get:function(){return new ht(this.left,this.top)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"topRight",{get:function(){return new ht(this.right,this.top)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"bottomLeft",{get:function(){return new ht(this.left,this.bottom)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"bottomRight",{get:function(){return new ht(this.right,this.bottom)},enumerable:!0,configurable:!0}),r.prototype.round=function(){var t=[this.x,this.y,this.width,this.height].map(function(s){return Math.round(s)}),e=t[0],n=t[1],a=t[2],i=t[3];return new r({x:e,y:n,width:a,height:i})},r.prototype.floor=function(){var t=[this.x,this.y,this.width,this.height].map(function(s){return Math.floor(s)}),e=t[0],n=t[1],a=t[2],i=t[3];return new r({x:e,y:n,width:a,height:i})},r.prototype.toSquare=function(){var t=this,e=t.x,n=t.y,a=t.width,i=t.height,s=Math.abs(a-i);return a<i&&(e-=s/2,a+=s),i<a&&(n-=s/2,i+=s),new r({x:e,y:n,width:a,height:i})},r.prototype.rescale=function(t){var e=V_(t)?t.width:t,n=V_(t)?t.height:t;return new r({x:this.x*e,y:this.y*n,width:this.width*e,height:this.height*n})},r.prototype.pad=function(t,e){var n=[this.x-t/2,this.y-e/2,this.width+t,this.height+e],a=n[0],i=n[1],s=n[2],l=n[3];return new r({x:a,y:i,width:s,height:l})},r.prototype.clipAtImageBorders=function(t,e){var n=this,a=n.x,i=n.y,s=n.right,l=n.bottom,c=Math.max(a,0),f=Math.max(i,0),d=s-c,v=l-f,m=Math.min(d,t-c),g=Math.min(v,e-f);return new r({x:c,y:f,width:m,height:g}).floor()},r.prototype.shift=function(t,e){var n=this,a=n.width,i=n.height,s=this.x+t,l=this.y+e;return new r({x:s,y:l,width:a,height:i})},r.prototype.padAtBorders=function(t,e){var n=this.width+1,a=this.height+1,i=1,s=1,l=n,c=a,f=this.left,d=this.top,v=this.right,m=this.bottom;return v>e&&(l=-v+e+n,v=e),m>t&&(c=-m+t+a,m=t),f<1&&(c=2-f,f=1),d<1&&(c=2-d,d=1),{dy:s,edy:c,dx:i,edx:l,y:d,ey:m,x:f,ex:v,w:n,h:a}},r.prototype.calibrate=function(t){return new r({left:this.left+t.left*this.width,top:this.top+t.top*this.height,right:this.right+t.right*this.width,bottom:this.bottom+t.bottom*this.height}).toSquare().round()},r}(),ip=function(r){We(t,r);function t(e,n,a,i,s){return s===void 0&&(s=!1),r.call(this,{left:e,top:n,right:a,bottom:i},s)||this}return t}(Ca),lR=function(){function r(t,e,n,a,i){this._imageDims=new es(i.width,i.height),this._score=t,this._classScore=e,this._className=n,this._box=new Ca(a).rescale(this._imageDims)}return Object.defineProperty(r.prototype,"score",{get:function(){return this._score},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"classScore",{get:function(){return this._classScore},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"className",{get:function(){return this._className},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"box",{get:function(){return this._box},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"imageDims",{get:function(){return this._imageDims},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"imageWidth",{get:function(){return this.imageDims.width},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"imageHeight",{get:function(){return this.imageDims.height},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"relativeBox",{get:function(){return new Ca(this._box).rescale(this.imageDims.reverse())},enumerable:!0,configurable:!0}),r.prototype.forSize=function(t,e){return new r(this.score,this.classScore,this.className,this.relativeBox,{width:t,height:e})},r}(),mr=function(r){We(t,r);function t(e,n,a){return r.call(this,e,e,"",n,a)||this}return t.prototype.forSize=function(e,n){var a=r.prototype.forSize.call(this,e,n),i=a.score,s=a.relativeBox,l=a.imageDims;return new t(i,s,l)},t}(lR);function uz(r,t,e){e===void 0&&(e=!0);var n=Math.max(0,Math.min(r.right,t.right)-Math.max(r.left,t.left)),a=Math.max(0,Math.min(r.bottom,t.bottom)-Math.max(r.top,t.top)),i=n*a;return e?i/(r.area+t.area-i):i/Math.min(r.area,t.area)}function lz(r){var t=r.map(function(l){return l.x}),e=r.map(function(l){return l.y}),n=t.reduce(function(l,c){return c<l?c:l},1/0),a=e.reduce(function(l,c){return c<l?c:l},1/0),i=t.reduce(function(l,c){return l<c?c:l},0),s=e.reduce(function(l,c){return l<c?c:l},0);return new ip(n,a,i,s)}function zc(r,t,e,n){n===void 0&&(n=!0);for(var a=t.map(function(l,c){return{score:l,boxIndex:c}}).sort(function(l,c){return l.score-c.score}).map(function(l){return l.boxIndex}),i=[],s=function(){var l=a.pop();i.push(l);for(var c=a,f=[],d=0;d<c.length;d++){var v=c[d],m=r[l],g=r[v];f.push(uz(m,g,n))}a=a.filter(function(b,w){return f[w]<=e})};a.length>0;)s();return i}function of(r,t){return Se(function(){var e=t[0],n=t[1],a=t[2],i=wa(vc(r.shape.slice(0,3),[1]),e),s=wa(vc(r.shape.slice(0,3),[1]),n),l=wa(vc(r.shape.slice(0,3),[1]),a),c=nn([i,s,l],3);return on(r,c)})}function cz(r,t){return t===void 0&&(t=!1),Se(function(){var e=r.shape.slice(1),n=e[0],a=e[1];if(n===a)return r;var i=Math.abs(n-a),s=Math.round(i*(t?.5:1)),l=n>a?2:1,c=function(g){var b=r.shape.slice();return b[l]=g,wa(b,0)},f=c(s),d=i-f.shape[l],v=t&&d?c(d):null,m=[v,r,f].filter(function(g){return!!g}).map(function(g){return g.toFloat()});return nn(m,l)})}function mg(r){return 1/(1+Math.exp(-r))}var b0=function(r){We(t,r);function t(e,n,a,i,s){return s===void 0&&(s=!1),r.call(this,{x:e,y:n,width:a,height:i},s)||this}return t}(Ca),fz=.5,hz=.43,dz=.45,Uc=function(){function r(t,e,n){n===void 0&&(n=new ht(0,0));var a=e.width,i=e.height;this._imgDims=new es(a,i),this._shift=n,this._positions=t.map(function(s){return s.mul(new ht(a,i)).add(n)})}return Object.defineProperty(r.prototype,"shift",{get:function(){return new ht(this._shift.x,this._shift.y)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"imageWidth",{get:function(){return this._imgDims.width},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"imageHeight",{get:function(){return this._imgDims.height},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"positions",{get:function(){return this._positions},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"relativePositions",{get:function(){var t=this;return this._positions.map(function(e){return e.sub(t._shift).div(new ht(t.imageWidth,t.imageHeight))})},enumerable:!0,configurable:!0}),r.prototype.forSize=function(t,e){return new this.constructor(this.relativePositions,{width:t,height:e})},r.prototype.shiftBy=function(t,e){return new this.constructor(this.relativePositions,this._imgDims,new ht(t,e))},r.prototype.shiftByPoint=function(t){return this.shiftBy(t.x,t.y)},r.prototype.align=function(t,e){if(e===void 0&&(e={}),t){var n=t instanceof mr?t.box.floor():new Ca(t);return this.shiftBy(n.x,n.y).align(null,e)}var a=Object.assign({},{useDlibAlignment:!1,minBoxPadding:.2},e),i=a.useDlibAlignment,s=a.minBoxPadding;return i?this.alignDlib():this.alignMinBbox(s)},r.prototype.alignDlib=function(){var t=this.getRefPointsForAlignment(),e=t[0],n=t[1],a=t[2],i=function(v){return a.sub(v).magnitude()},s=(i(e)+i(n))/2,l=Math.floor(s/dz),c=y0(t),f=Math.floor(Math.max(0,c.x-fz*l)),d=Math.floor(Math.max(0,c.y-hz*l));return new b0(f,d,Math.min(l,this.imageWidth+f),Math.min(l,this.imageHeight+d))},r.prototype.alignMinBbox=function(t){var e=lz(this.positions);return e.pad(e.width*t,e.height*t)},r.prototype.getRefPointsForAlignment=function(){throw new Error("getRefPointsForAlignment not implemented by base class")},r}(),pz=function(r){We(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.prototype.getRefPointsForAlignment=function(){var e=this.positions;return[e[0],e[1],y0([e[3],e[4]])]},t}(Uc),vz=function(r){We(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.prototype.getJawOutline=function(){return this.positions.slice(0,17)},t.prototype.getLeftEyeBrow=function(){return this.positions.slice(17,22)},t.prototype.getRightEyeBrow=function(){return this.positions.slice(22,27)},t.prototype.getNose=function(){return this.positions.slice(27,36)},t.prototype.getLeftEye=function(){return this.positions.slice(36,42)},t.prototype.getRightEye=function(){return this.positions.slice(42,48)},t.prototype.getMouth=function(){return this.positions.slice(48,68)},t.prototype.getRefPointsForAlignment=function(){return[this.getLeftEye(),this.getRightEye(),this.getMouth()].map(y0)},t}(Uc),j_=function(){function r(t,e){this._label=t,this._distance=e}return Object.defineProperty(r.prototype,"label",{get:function(){return this._label},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"distance",{get:function(){return this._distance},enumerable:!0,configurable:!0}),r.prototype.toString=function(t){return t===void 0&&(t=!0),""+this.label+(t?" ("+g0(this.distance)+")":"")},r}(),W_=function(r){We(t,r);function t(e,n){var a=r.call(this,e)||this;return a._label=n,a}return t.assertIsValidLabeledBox=function(e,n){if(Ca.assertIsValidBox(e,n),!ts(e.label))throw new Error(n+" - expected property label ("+e.label+") to be a number")},Object.defineProperty(t.prototype,"label",{get:function(){return this._label},enumerable:!0,configurable:!0}),t}(Ca),Bh=function(){function r(t,e){if(typeof t!="string")throw new Error("LabeledFaceDescriptors - constructor expected label to be a string");if(!Array.isArray(e)||e.some(function(n){return!(n instanceof Float32Array)}))throw new Error("LabeledFaceDescriptors - constructor expected descriptors to be an array of Float32Array");this._label=t,this._descriptors=e}return Object.defineProperty(r.prototype,"label",{get:function(){return this._label},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"descriptors",{get:function(){return this._descriptors},enumerable:!0,configurable:!0}),r.prototype.toJSON=function(){return{label:this.label,descriptors:this.descriptors.map(function(t){return Array.from(t)})}},r.fromJSON=function(t){var e=t.descriptors.map(function(n){return new Float32Array(n)});return new r(t.label,e)},r}();(function(r){We(t,r);function t(e,n,a,i){var s=r.call(this,e,n)||this;return s._score=a,s._classScore=i,s}return t.assertIsValidPredictedBox=function(e,n){if(W_.assertIsValidLabeledBox(e,n),!H_(e.score)||!H_(e.classScore))throw new Error(n+" - expected properties score ("+e.score+") and ("+e.classScore+") to be a number between [0, 1]")},Object.defineProperty(t.prototype,"score",{get:function(){return this._score},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"classScore",{get:function(){return this._classScore},enumerable:!0,configurable:!0}),t})(W_);function Vc(r){return r.detection instanceof mr}function Hc(r,t){var e={detection:t};return Object.assign({},r,e)}function cR(){var r=window.fetch||function(){throw new Error("fetch - missing fetch implementation for browser environment")},t=function(){throw new Error("readFile - filesystem not available for browser environment")};return{Canvas:HTMLCanvasElement,CanvasRenderingContext2D,Image:HTMLImageElement,ImageData,Video:HTMLVideoElement,createCanvasElement:function(){return document.createElement("canvas")},createImageElement:function(){return document.createElement("img")},fetch:r,readFile:t}}function fR(r){var t="";if(!r)try{r=require("fs")}catch(n){t=n.toString()}var e=r?function(n){return new Promise(function(a,i){r.readFile(n,function(s,l){return s?i(s):a(l)})})}:function(){throw new Error("readFile - failed to require fs in nodejs environment with error: "+t)};return{readFile:e}}function hR(){var r=global.Canvas||global.HTMLCanvasElement,t=global.Image||global.HTMLImageElement,e=function(){if(r)return new r;throw new Error("createCanvasElement - missing Canvas implementation for nodejs environment")},n=function(){if(t)return new t;throw new Error("createImageElement - missing Image implementation for nodejs environment")},a=global.fetch||function(){throw new Error("fetch - missing fetch implementation for nodejs environment")},i=fR();return kn({Canvas:r||function(){function s(){}return s}(),CanvasRenderingContext2D:global.CanvasRenderingContext2D||function(){function s(){}return s}(),Image:t||function(){function s(){}return s}(),ImageData:global.ImageData||function(){function s(){}return s}(),Video:global.HTMLVideoElement||function(){function s(){}return s}(),createCanvasElement:e,createImageElement:n,fetch:a},i)}function dR(){return typeof window=="object"&&typeof document<"u"&&typeof HTMLImageElement<"u"&&typeof HTMLCanvasElement<"u"&&typeof HTMLVideoElement<"u"&&typeof ImageData<"u"&&typeof CanvasRenderingContext2D<"u"}function pR(){return typeof global=="object"&&typeof require=="function"&&typeof module<"u"&&typeof process<"u"&&!!process.version}var en;function mz(){if(!en)throw new Error("getEnv - environment is not defined, check isNodejs() and isBrowser()");return en}function wy(r){en=r}function x0(){dR()&&wy(cR()),pR()&&wy(hR())}function gz(r){if(en||x0(),!en)throw new Error("monkeyPatch - environment is not defined, check isNodejs() and isBrowser()");var t=r.Canvas,e=t===void 0?en.Canvas:t,n=r.Image,a=n===void 0?en.Image:n;en.Canvas=e,en.Image=a,en.createCanvasElement=r.createCanvasElement||function(){return new e},en.createImageElement=r.createImageElement||function(){return new a},en.ImageData=r.ImageData||en.ImageData,en.Video=r.Video||en.Video,en.fetch=r.fetch||en.fetch,en.readFile=r.readFile||en.readFile}var Fn={getEnv:mz,setEnv:wy,initialize:x0,createBrowserEnv:cR,createFileSystem:fR,createNodejsEnv:hR,monkeyPatch:gz,isBrowser:dR,isNodejs:pR};x0();function w0(r){return!Fn.isNodejs()&&typeof r=="string"?document.getElementById(r):r}function oi(r){var t=Fn.getEnv(),e=t.Canvas,n=t.CanvasRenderingContext2D;if(r instanceof n)return r;var a=w0(r);if(!(a instanceof e))throw new Error("resolveContext2d - expected canvas to be of instance of Canvas");var i=a.getContext("2d");if(!i)throw new Error("resolveContext2d - canvas 2d context is null");return i}var ro;(function(r){r.TOP_LEFT="TOP_LEFT",r.TOP_RIGHT="TOP_RIGHT",r.BOTTOM_LEFT="BOTTOM_LEFT",r.BOTTOM_RIGHT="BOTTOM_RIGHT"})(ro||(ro={}));var vR=function(){function r(t){t===void 0&&(t={});var e=t.anchorPosition,n=t.backgroundColor,a=t.fontColor,i=t.fontSize,s=t.fontStyle,l=t.padding;this.anchorPosition=e||ro.TOP_LEFT,this.backgroundColor=n||"rgba(0, 0, 0, 0.5)",this.fontColor=a||"rgba(255, 255, 255, 1)",this.fontSize=i||14,this.fontStyle=s||"Georgia",this.padding=l||4}return r}(),mR=function(){function r(t,e,n){n===void 0&&(n={}),this.text=typeof t=="string"?[t]:t instanceof r?t.text:t,this.anchor=e,this.options=new vR(n)}return r.prototype.measureWidth=function(t){var e=this.options.padding;return this.text.map(function(n){return t.measureText(n).width}).reduce(function(n,a){return n<a?a:n},0)+2*e},r.prototype.measureHeight=function(){var t=this.options,e=t.fontSize,n=t.padding;return this.text.length*e+2*n},r.prototype.getUpperLeft=function(t,e){var n=this.options.anchorPosition,a=n===ro.BOTTOM_RIGHT||n===ro.TOP_RIGHT,i=n===ro.BOTTOM_LEFT||n===ro.BOTTOM_RIGHT,s=this.measureWidth(t),l=this.measureHeight(),c=a?this.anchor.x-s:this.anchor.x,f=i?this.anchor.y-l:this.anchor.y;if(e){var d=e.width,v=e.height,m=Math.max(Math.min(c,d-s),0),g=Math.max(Math.min(f,v-l),0);return{x:m,y:g}}return{x:c,y:f}},r.prototype.draw=function(t){var e=w0(t),n=oi(e),a=this.options,i=a.backgroundColor,s=a.fontColor,l=a.fontSize,c=a.fontStyle,f=a.padding;n.font=l+"px "+c;var d=this.measureWidth(n),v=this.measureHeight();n.fillStyle=i;var m=this.getUpperLeft(n,e);n.fillRect(m.x,m.y,d,v),n.fillStyle=s,this.text.forEach(function(g,b){var w=f+m.x,_=f+m.y+(b+1)*l;n.fillText(g,w,_)})},r}(),yz=function(){function r(t){t===void 0&&(t={});var e=t.boxColor,n=t.lineWidth,a=t.label,i=t.drawLabelOptions;this.boxColor=e||"rgba(0, 0, 255, 1)",this.lineWidth=n||2,this.label=a;var s={anchorPosition:ro.BOTTOM_LEFT,backgroundColor:this.boxColor};this.drawLabelOptions=new vR(Object.assign({},s,i))}return r}(),bz=function(){function r(t,e){e===void 0&&(e={}),this.box=new Ca(t),this.options=new yz(e)}return r.prototype.draw=function(t){var e=oi(t),n=this.options,a=n.boxColor,i=n.lineWidth,s=this.box,l=s.x,c=s.y,f=s.width,d=s.height;e.strokeStyle=a,e.lineWidth=i,e.strokeRect(l,c,f,d);var v=this.options.label;v&&new mR([v],{x:l-i/2,y:c},this.options.drawLabelOptions).draw(t)},r}();function x6(r,t){var e=Array.isArray(t)?t:[t];e.forEach(function(n){var a=n instanceof mr?n.score:Vc(n)?n.detection.score:void 0,i=n instanceof mr?n.box:Vc(n)?n.detection.box:new Ca(n),s=a?""+g0(a):void 0;new bz(i,{label:s}).draw(r)})}function gR(r){var t=Fn.getEnv(),e=t.Image,n=t.Video;return r instanceof e&&r.complete||r instanceof n&&r.readyState>=3}function xz(r){return new Promise(function(t,e){if(r instanceof Fn.getEnv().Canvas||gR(r))return t();function n(i){i.currentTarget&&(i.currentTarget.removeEventListener("load",n),i.currentTarget.removeEventListener("error",a),t(i))}function a(i){i.currentTarget&&(i.currentTarget.removeEventListener("load",n),i.currentTarget.removeEventListener("error",a),e(i))}r.addEventListener("load",n),r.addEventListener("error",a)})}function _0(r){var t=Fn.getEnv(),e=t.Image,n=t.Video;return r instanceof e?new es(r.naturalWidth,r.naturalHeight):r instanceof n?new es(r.videoWidth,r.videoHeight):new es(r.width,r.height)}function op(r){var t=r.width,e=r.height,n=Fn.getEnv().createCanvasElement,a=n();return a.width=t,a.height=e,a}function S0(r,t){var e=Fn.getEnv().ImageData;if(!(r instanceof e)&&!gR(r))throw new Error("createCanvasFromMedia - media has not finished loading yet");var n=_0(r),a=n.width,i=n.height,s=op({width:a,height:i});return r instanceof e?oi(s).putImageData(r,0,0):oi(s).drawImage(r,0,0,a,i),s}function wz(r,t){return ke(this,void 0,void 0,function(){var e,n,a,i,s,l;return Oe(this,function(c){switch(c.label){case 0:return e=Fn.getEnv().createCanvasElement(),n=r.shape.slice(so(r)?1:0),a=n[0],i=n[1],s=n[2],l=Se(function(){return r.as3D(a,i,s).toInt()}),[4,m0.toPixels(l,e)];case 1:return c.sent(),l.dispose(),[2,e]}})})}function G_(r){var t=Fn.getEnv(),e=t.Image,n=t.Canvas,a=t.Video;return r instanceof e||r instanceof n||r instanceof a}function _z(r,t,e){e===void 0&&(e=!1);var n=Fn.getEnv(),a=n.Image,i=n.Canvas;if(!(r instanceof a||r instanceof i))throw new Error("imageToSquare - expected arg0 to be HTMLImageElement | HTMLCanvasElement");var s=_0(r),l=t/Math.max(s.height,s.width),c=l*s.width,f=l*s.height,d=op({width:t,height:t}),v=r instanceof i?r:S0(r),m=Math.abs(c-f)/2,g=e&&c<f?m:0,b=e&&f<c?m:0;return oi(d).drawImage(v,g,b,c,f),d}var Fd=function(){function r(t,e){var n=this;if(e===void 0&&(e=!1),this._imageTensors=[],this._canvases=[],this._treatAsBatchInput=!1,this._inputDimensions=[],!Array.isArray(t))throw new Error("NetInput.constructor - expected inputs to be an Array of TResolvedNetInput or to be instanceof tf.Tensor4D, instead have "+t);this._treatAsBatchInput=e,this._batchSize=t.length,t.forEach(function(a,i){if(ap(a)){n._imageTensors[i]=a,n._inputDimensions[i]=a.shape;return}if(so(a)){var s=a.shape[0];if(s!==1)throw new Error("NetInput - tf.Tensor4D with batchSize "+s+" passed, but not supported in input array");n._imageTensors[i]=a,n._inputDimensions[i]=a.shape.slice(1);return}var l=a instanceof Fn.getEnv().Canvas?a:S0(a);n._canvases[i]=l,n._inputDimensions[i]=[l.height,l.width,3]})}return Object.defineProperty(r.prototype,"imageTensors",{get:function(){return this._imageTensors},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"canvases",{get:function(){return this._canvases},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"isBatchInput",{get:function(){return this.batchSize>1||this._treatAsBatchInput},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"batchSize",{get:function(){return this._batchSize},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"inputDimensions",{get:function(){return this._inputDimensions},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"inputSize",{get:function(){return this._inputSize},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"reshapedInputDimensions",{get:function(){var t=this;return Pc(this.batchSize,0,1).map(function(e,n){return t.getReshapedInputDimensions(n)})},enumerable:!0,configurable:!0}),r.prototype.getInput=function(t){return this.canvases[t]||this.imageTensors[t]},r.prototype.getInputDimensions=function(t){return this._inputDimensions[t]},r.prototype.getInputHeight=function(t){return this._inputDimensions[t][0]},r.prototype.getInputWidth=function(t){return this._inputDimensions[t][1]},r.prototype.getReshapedInputDimensions=function(t){if(typeof this.inputSize!="number")throw new Error("getReshapedInputDimensions - inputSize not set, toBatchTensor has not been called yet");var e=this.getInputWidth(t),n=this.getInputHeight(t);return sz({width:e,height:n},this.inputSize)},r.prototype.toBatchTensor=function(t,e){var n=this;return e===void 0&&(e=!0),this._inputSize=t,Se(function(){var a=Pc(n.batchSize,0,1).map(function(s){var l=n.getInput(s);if(l instanceof Mt){var c=so(l)?l:l.expandDims();return c=cz(c,e),(c.shape[1]!==t||c.shape[2]!==t)&&(c=c0.resizeBilinear(c,[t,t])),c.as3D(t,t,3)}if(l instanceof Fn.getEnv().Canvas)return m0.fromPixels(_z(l,t,e));throw new Error("toBatchTensor - at batchIdx "+s+", expected input to be instanceof tf.Tensor or instanceof HTMLCanvasElement, instead have "+l)}),i=vr(a.map(function(s){return s.toFloat()})).as4D(n.batchSize,t,t,3);return i})},r}();function mn(r){return ke(this,void 0,void 0,function(){var t,e,n;return Oe(this,function(a){switch(a.label){case 0:if(r instanceof Fd)return[2,r];if(t=Array.isArray(r)?r:[r],!t.length)throw new Error("toNetInput - empty array passed as input");return e=function(i){return Array.isArray(r)?" at input index "+i+":":""},n=t.map(w0),n.forEach(function(i,s){if(!G_(i)&&!ap(i)&&!so(i))throw typeof t[s]=="string"?new Error("toNetInput -"+e(s)+" string passed, but could not resolve HTMLElement for element id "+t[s]):new Error("toNetInput -"+e(s)+" expected media to be of type HTMLImageElement | HTMLVideoElement | HTMLCanvasElement | tf.Tensor3D, or to be an element id");if(so(i)){var l=i.shape[0];if(l!==1)throw new Error("toNetInput -"+e(s)+" tf.Tensor4D with batchSize "+l+" passed, but not supported in input array")}}),[4,Promise.all(n.map(function(i){return G_(i)&&xz(i)}))];case 1:return a.sent(),[2,new Fd(n,Array.isArray(r))]}})})}function E0(r,t){return ke(this,void 0,void 0,function(){var e,n,a,i,s,l,c;return Oe(this,function(f){switch(f.label){case 0:return e=Fn.getEnv().Canvas,n=r,r instanceof e?[3,5]:[4,mn(r)];case 1:if(a=f.sent(),a.batchSize>1)throw new Error("extractFaces - batchSize > 1 not supported");return i=a.getInput(0),i instanceof e?(s=i,[3,4]):[3,2];case 2:return[4,wz(i)];case 3:s=f.sent(),f.label=4;case 4:n=s,f.label=5;case 5:return l=oi(n),c=t.map(function(d){return d instanceof mr?d.forSize(n.width,n.height).box.floor():d}).map(function(d){return d.clipAtImageBorders(n.width,n.height)}),[2,c.map(function(d){var v=d.x,m=d.y,g=d.width,b=d.height,w=op({width:g,height:b});return oi(w).putImageData(l.getImageData(v,m,g,b),0,0),w})]}})})}function C0(r,t){return ke(this,void 0,void 0,function(){return Oe(this,function(e){if(!ap(r)&&!so(r))throw new Error("extractFaceTensors - expected image tensor to be 3D or 4D");if(so(r)&&r.shape[0]>1)throw new Error("extractFaceTensors - batchSize > 1 not supported");return[2,Se(function(){var n=r.shape.slice(so(r)?1:0),a=n[0],i=n[1],s=n[2],l=t.map(function(f){return f instanceof mr?f.forSize(i,a).box:f}).map(function(f){return f.clipAtImageBorders(i,a)}),c=l.map(function(f){var d=f.x,v=f.y,m=f.width,g=f.height;return WC(r.as3D(a,i,s),[v,d,0],[g,m,s])});return c})]})})}function Sz(r,t){return ke(this,void 0,void 0,function(){var e,n;return Oe(this,function(a){switch(a.label){case 0:return e=Fn.getEnv().fetch,[4,e(r,t)];case 1:if(n=a.sent(),!(n.status<400))throw new Error("failed to fetch: ("+n.status+") "+n.statusText+", from url: "+n.url);return[2,n]}})})}function Ez(r){return ke(this,void 0,void 0,function(){return Oe(this,function(t){switch(t.label){case 0:return[4,Sz(r)];case 1:return[2,t.sent().json()]}})})}function yR(r,t){var e=t+"-weights_manifest.json";if(!r)return{modelBaseUri:"",manifestUri:e};if(r==="/")return{modelBaseUri:"/",manifestUri:"/"+e};var n=r.startsWith("http://")?"http://":r.startsWith("https://")?"https://":"";r=r.replace(n,"");var a=r.split("/").filter(function(l){return l}),i=r.endsWith(".json")?a[a.length-1]:e,s=n+(r.endsWith(".json")?a.slice(0,a.length-1):a).join("/");return s=r.startsWith("/")?"/"+s:s,{modelBaseUri:s,manifestUri:s==="/"?"/"+i:s+"/"+i}}function Cz(r,t){return ke(this,void 0,void 0,function(){var e,n,a,i;return Oe(this,function(s){switch(s.label){case 0:return e=yR(r,t),n=e.manifestUri,a=e.modelBaseUri,[4,Ez(n)];case 1:return i=s.sent(),[2,sR.loadWeights(i,a)]}})})}function w6(r,t,e){e===void 0&&(e=!1);var n=e?_0(t):t,a=n.width,i=n.height;return r.width=a,r.height=i,{width:a,height:i}}var fi=function(){function r(t){this._name=t,this._params=void 0,this._paramMappings=[]}return Object.defineProperty(r.prototype,"params",{get:function(){return this._params},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"paramMappings",{get:function(){return this._paramMappings},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"isLoaded",{get:function(){return!!this.params},enumerable:!0,configurable:!0}),r.prototype.getParamFromPath=function(t){var e=this.traversePropertyPath(t),n=e.obj,a=e.objProp;return n[a]},r.prototype.reassignParamFromPath=function(t,e){var n=this.traversePropertyPath(t),a=n.obj,i=n.objProp;a[i].dispose(),a[i]=e},r.prototype.getParamList=function(){var t=this;return this._paramMappings.map(function(e){var n=e.paramPath;return{path:n,tensor:t.getParamFromPath(n)}})},r.prototype.getTrainableParams=function(){return this.getParamList().filter(function(t){return t.tensor instanceof qu})},r.prototype.getFrozenParams=function(){return this.getParamList().filter(function(t){return!(t.tensor instanceof qu)})},r.prototype.variable=function(){var t=this;this.getFrozenParams().forEach(function(e){var n=e.path,a=e.tensor;t.reassignParamFromPath(n,a.variable())})},r.prototype.freeze=function(){var t=this;this.getTrainableParams().forEach(function(e){var n=e.path,a=e.tensor,i=Sn(a.dataSync());a.dispose(),t.reassignParamFromPath(n,i)})},r.prototype.dispose=function(t){t===void 0&&(t=!0),this.getParamList().forEach(function(e){if(t&&e.tensor.isDisposed)throw new Error("param tensor has already been disposed for path "+e.path);e.tensor.dispose()}),this._params=void 0},r.prototype.serializeParams=function(){return new Float32Array(this.getParamList().map(function(t){var e=t.tensor;return Array.from(e.dataSync())}).reduce(function(t,e){return t.concat(e)}))},r.prototype.load=function(t){return ke(this,void 0,void 0,function(){return Oe(this,function(e){switch(e.label){case 0:return t instanceof Float32Array?(this.extractWeights(t),[2]):[4,this.loadFromUri(t)];case 1:return e.sent(),[2]}})})},r.prototype.loadFromUri=function(t){return ke(this,void 0,void 0,function(){var e;return Oe(this,function(n){switch(n.label){case 0:if(t&&typeof t!="string")throw new Error(this._name+".loadFromUri - expected model uri");return[4,Cz(t,this.getDefaultModelName())];case 1:return e=n.sent(),this.loadFromWeightMap(e),[2]}})})},r.prototype.loadFromDisk=function(t){return ke(this,void 0,void 0,function(){var e,n,a,i,s,l,c,f,d,v;return Oe(this,function(m){switch(m.label){case 0:if(t&&typeof t!="string")throw new Error(this._name+".loadFromDisk - expected model file path");return e=Fn.getEnv().readFile,n=yR(t,this.getDefaultModelName()),a=n.manifestUri,i=n.modelBaseUri,s=function(g){return Promise.all(g.map(function(b){return e(b).then(function(w){return w.buffer})}))},l=sR.weightsLoaderFactory(s),d=(f=JSON).parse,[4,e(a)];case 1:return c=d.apply(f,[m.sent().toString()]),[4,l(c,i)];case 2:return v=m.sent(),this.loadFromWeightMap(v),[2]}})})},r.prototype.loadFromWeightMap=function(t){var e=this.extractParamsFromWeigthMap(t),n=e.paramMappings,a=e.params;this._paramMappings=n,this._params=a},r.prototype.extractWeights=function(t){var e=this.extractParams(t),n=e.paramMappings,a=e.params;this._paramMappings=n,this._params=a},r.prototype.traversePropertyPath=function(t){if(!this.params)throw new Error("traversePropertyPath - model has no loaded params");var e=t.split("/").reduce(function(i,s){if(!i.nextObj.hasOwnProperty(s))throw new Error("traversePropertyPath - object does not have property "+s+", for path "+t);return{obj:i.nextObj,objProp:s,nextObj:i.nextObj[s]}},{nextObj:this.params}),n=e.obj,a=e.objProp;if(!n||!a||!(n[a]instanceof Mt))throw new Error("traversePropertyPath - parameter is not a tensor, for path "+t);return{obj:n,objProp:a}},r}();function dr(r,t,e){return Se(function(){var n=i0(r,t.depthwise_filter,t.pointwise_filter,e,"same");return n=nt(n,t.bias),n})}function gg(r,t,e){return e===void 0&&(e=!1),Se(function(){var n=It(e?nt(Fr(r,t.conv0.filters,[2,2],"same"),t.conv0.bias):dr(r,t.conv0,[2,2])),a=dr(n,t.conv1,[1,1]),i=It(nt(n,a)),s=dr(i,t.conv2,[1,1]);return It(nt(n,nt(a,s)))})}function Lh(r,t,e,n){return e===void 0&&(e=!1),n===void 0&&(n=!0),Se(function(){var a=It(e?nt(Fr(r,t.conv0.filters,n?[2,2]:[1,1],"same"),t.conv0.bias):dr(r,t.conv0,n?[2,2]:[1,1])),i=dr(a,t.conv1,[1,1]),s=It(nt(a,i)),l=dr(s,t.conv2,[1,1]),c=It(nt(a,nt(i,l))),f=dr(c,t.conv3,[1,1]);return It(nt(a,nt(i,nt(l,f))))})}function $r(r,t,e,n){return e===void 0&&(e="same"),n===void 0&&(n=!1),Se(function(){var a=nt(Fr(r,t.filters,[1,1],e),t.bias);return n?It(a):a})}function hi(r,t){Object.keys(r).forEach(function(e){t.some(function(n){return n.originalPath===e})||r[e].dispose()})}function sp(r,t){return function(e,n,a,i){var s=$n(r(e*n*a*a),[a,a,e,n]),l=$t(r(n));return t.push({paramPath:i+"/filters"},{paramPath:i+"/bias"}),{filters:s,bias:l}}}function R0(r,t){return function(e,n,a){var i=io(r(e*n),[e,n]),s=$t(r(n));return t.push({paramPath:a+"/weights"},{paramPath:a+"/bias"}),{weights:i,bias:s}}}var bR=function(){function r(t,e,n){this.depthwise_filter=t,this.pointwise_filter=e,this.bias=n}return r}();function T0(r,t){return function(e,n,a){var i=$n(r(9*e),[3,3,e,1]),s=$n(r(e*n),[1,1,e,n]),l=$t(r(n));return t.push({paramPath:a+"/depthwise_filter"},{paramPath:a+"/pointwise_filter"},{paramPath:a+"/bias"}),new bR(i,s,l)}}function A0(r){return function(t){var e=r(t+"/depthwise_filter",4),n=r(t+"/pointwise_filter",4),a=r(t+"/bias",1);return new bR(e,n,a)}}function yo(r,t){return function(e,n,a){var i=r[e];if(!rp(i,n))throw new Error("expected weightMap["+e+"] to be a Tensor"+n+"D, instead have "+i);return t.push({originalPath:e,paramPath:a||e}),i}}function di(r){var t=r;function e(a){var i=t.slice(0,a);return t=t.slice(a),i}function n(){return t}return{extractWeights:e,getRemainingWeights:n}}function xR(r,t){var e=sp(r,t),n=T0(r,t);function a(s,l,c,f){f===void 0&&(f=!1);var d=f?e(s,l,3,c+"/conv0"):n(s,l,c+"/conv0"),v=n(l,l,c+"/conv1"),m=n(l,l,c+"/conv2");return{conv0:d,conv1:v,conv2:m}}function i(s,l,c,f){f===void 0&&(f=!1);var d=a(s,l,c,f),v=d.conv0,m=d.conv1,g=d.conv2,b=n(l,l,c+"/conv3");return{conv0:v,conv1:m,conv2:g,conv3:b}}return{extractDenseBlock3Params:a,extractDenseBlock4Params:i}}function Rz(r){var t=[],e=di(r),n=e.extractWeights,a=e.getRemainingWeights,i=xR(n,t).extractDenseBlock4Params,s=i(3,32,"dense0",!0),l=i(32,64,"dense1"),c=i(64,128,"dense2"),f=i(128,256,"dense3");if(a().length!==0)throw new Error("weights remaing after extract: "+a().length);return{paramMappings:t,params:{dense0:s,dense1:l,dense2:c,dense3:f}}}function wR(r){return function(t){var e=r(t+"/filters",4),n=r(t+"/bias",1);return{filters:e,bias:n}}}function _R(r,t){var e=yo(r,t),n=wR(e),a=A0(e);function i(l,c){c===void 0&&(c=!1);var f=c?n(l+"/conv0"):a(l+"/conv0"),d=a(l+"/conv1"),v=a(l+"/conv2");return{conv0:f,conv1:d,conv2:v}}function s(l,c){c===void 0&&(c=!1);var f=c?n(l+"/conv0"):a(l+"/conv0"),d=a(l+"/conv1"),v=a(l+"/conv2"),m=a(l+"/conv3");return{conv0:f,conv1:d,conv2:v,conv3:m}}return{extractDenseBlock3Params:i,extractDenseBlock4Params:s}}function Tz(r){var t=[],e=_R(r,t).extractDenseBlock4Params,n={dense0:e("dense0",!0),dense1:e("dense1"),dense2:e("dense2"),dense3:e("dense3")};return hi(r,t),{params:n,paramMappings:t}}var SR=function(r){We(t,r);function t(){return r.call(this,"FaceFeatureExtractor")||this}return t.prototype.forwardInput=function(e){var n=this.params;if(!n)throw new Error("FaceFeatureExtractor - load model before inference");return Se(function(){var a=e.toBatchTensor(112,!0),i=[122.782,117.001,104.298],s=of(a,i).div(ye(255)),l=Lh(s,n.dense0,!0);return l=Lh(l,n.dense1),l=Lh(l,n.dense2),l=Lh(l,n.dense3),l=rf(l,[7,7],[2,2],"valid"),l})},t.prototype.forward=function(e){return ke(this,void 0,void 0,function(){var n;return Oe(this,function(a){switch(a.label){case 0:return n=this.forwardInput,[4,mn(e)];case 1:return[2,n.apply(this,[a.sent()])]}})})},t.prototype.getDefaultModelName=function(){return"face_feature_extractor_model"},t.prototype.extractParamsFromWeigthMap=function(e){return Tz(e)},t.prototype.extractParams=function(e){return Rz(e)},t}(fi);function ga(r,t){return Se(function(){return nt(ep(r,t.weights),t.bias)})}function Az(r,t,e){var n=[],a=di(r),i=a.extractWeights,s=a.getRemainingWeights,l=R0(i,n),c=l(t,e,"fc");if(s().length!==0)throw new Error("weights remaing after extract: "+s().length);return{paramMappings:n,params:{fc:c}}}function Dz(r){var t=[],e=yo(r,t);function n(i){var s=e(i+"/weights",2),l=e(i+"/bias",1);return{weights:s,bias:l}}var a={fc:n("fc")};return hi(r,t),{params:a,paramMappings:t}}function ER(r){var t={},e={};return Object.keys(r).forEach(function(n){var a=n.startsWith("fc")?e:t;a[n]=r[n]}),{featureExtractorMap:t,classifierMap:e}}var CR=function(r){We(t,r);function t(e,n){var a=r.call(this,e)||this;return a._faceFeatureExtractor=n,a}return Object.defineProperty(t.prototype,"faceFeatureExtractor",{get:function(){return this._faceFeatureExtractor},enumerable:!0,configurable:!0}),t.prototype.runNet=function(e){var n=this,a=this.params;if(!a)throw new Error(this._name+" - load model before inference");return Se(function(){var i=e instanceof Fd?n.faceFeatureExtractor.forwardInput(e):e;return ga(i.as2D(i.shape[0],-1),a.fc)})},t.prototype.dispose=function(e){e===void 0&&(e=!0),this.faceFeatureExtractor.dispose(e),r.prototype.dispose.call(this,e)},t.prototype.loadClassifierParams=function(e){var n=this.extractClassifierParams(e),a=n.params,i=n.paramMappings;this._params=a,this._paramMappings=i},t.prototype.extractClassifierParams=function(e){return Az(e,this.getClassifierChannelsIn(),this.getClassifierChannelsOut())},t.prototype.extractParamsFromWeigthMap=function(e){var n=ER(e),a=n.featureExtractorMap,i=n.classifierMap;return this.faceFeatureExtractor.loadFromWeightMap(a),Dz(i)},t.prototype.extractParams=function(e){var n=this.getClassifierChannelsIn(),a=this.getClassifierChannelsOut(),i=a*n+a,s=e.slice(0,e.length-i),l=e.slice(e.length-i);return this.faceFeatureExtractor.extractWeights(s),this.extractClassifierParams(l)},t}(fi),q_=["neutral","happy","sad","angry","fearful","disgusted","surprised"],D0=function(){function r(t){var e=this;if(t.length!==7)throw new Error("FaceExpressions.constructor - expected probabilities.length to be 7, have: "+t.length);q_.forEach(function(n,a){e[n]=t[a]})}return r.prototype.asSortedArray=function(){var t=this;return q_.map(function(e){return{expression:e,probability:t[e]}}).sort(function(e,n){return n.probability-e.probability})},r}(),kz=function(r){We(t,r);function t(e){return e===void 0&&(e=new SR),r.call(this,"FaceExpressionNet",e)||this}return t.prototype.forwardInput=function(e){var n=this;return Se(function(){return li(n.runNet(e))})},t.prototype.forward=function(e){return ke(this,void 0,void 0,function(){var n;return Oe(this,function(a){switch(a.label){case 0:return n=this.forwardInput,[4,mn(e)];case 1:return[2,n.apply(this,[a.sent()])]}})})},t.prototype.predictExpressions=function(e){return ke(this,void 0,void 0,function(){var n,a,i,s,l=this;return Oe(this,function(c){switch(c.label){case 0:return[4,mn(e)];case 1:return n=c.sent(),[4,this.forwardInput(n)];case 2:return a=c.sent(),[4,Promise.all(rn(a).map(function(f){return ke(l,void 0,void 0,function(){var d;return Oe(this,function(v){switch(v.label){case 0:return[4,f.data()];case 1:return d=v.sent(),f.dispose(),[2,d]}})})}))];case 3:return i=c.sent(),a.dispose(),s=i.map(function(f){return new D0(f)}),[2,n.isBatchInput?s:s[0]]}})})},t.prototype.getDefaultModelName=function(){return"face_expression_model"},t.prototype.getClassifierChannelsIn=function(){return 256},t.prototype.getClassifierChannelsOut=function(){return 7},t}(CR);function Oz(r){return r.expressions instanceof D0}function RR(r,t){var e={expressions:t};return Object.assign({},r,e)}function _6(r,t,e,n){e===void 0&&(e=.1);var a=Array.isArray(t)?t:[t];a.forEach(function(i){var s=i instanceof D0?i:Oz(i)?i.expressions:void 0;if(!s)throw new Error("drawFaceExpressions - expected faceExpressions to be FaceExpressions | WithFaceExpressions<{}> or array thereof");var l=s.asSortedArray(),c=l.filter(function(v){return v.probability>e}),f=Vc(i)?i.detection.box.bottomLeft:new ht(0,0),d=new mR(c.map(function(v){return v.expression+" ("+g0(v.probability)+")"}),f);d.draw(r)})}function TR(r){return Vc(r)&&r.landmarks instanceof Uc&&r.unshiftedLandmarks instanceof Uc&&r.alignedRect instanceof mr}function up(r,t){var e=r.detection.box,n=t.shiftBy(e.x,e.y),a=n.align(),i=r.detection.imageDims,s=new mr(r.detection.score,a.rescale(i.reverse()),i),l={landmarks:n,unshiftedLandmarks:t,alignedRect:s};return Object.assign({},r,l)}function Nz(r,t){var e=sp(r,t),n=T0(r,t);function a(s,l,c){var f=n(s,l,c+"/separable_conv0"),d=n(l,l,c+"/separable_conv1"),v=e(s,l,1,c+"/expansion_conv");return{separable_conv0:f,separable_conv1:d,expansion_conv:v}}function i(s,l){var c=n(s,s,l+"/separable_conv0"),f=n(s,s,l+"/separable_conv1"),d=n(s,s,l+"/separable_conv2");return{separable_conv0:c,separable_conv1:f,separable_conv2:d}}return{extractConvParams:e,extractSeparableConvParams:n,extractReductionBlockParams:a,extractMainBlockParams:i}}function Mz(r,t){var e=[],n=di(r),a=n.extractWeights,i=n.getRemainingWeights,s=Nz(a,e),l=s.extractConvParams,c=s.extractSeparableConvParams,f=s.extractReductionBlockParams,d=s.extractMainBlockParams,v=l(3,32,3,"entry_flow/conv_in"),m=f(32,64,"entry_flow/reduction_block_0"),g=f(64,128,"entry_flow/reduction_block_1"),b={conv_in:v,reduction_block_0:m,reduction_block_1:g},w={};Pc(t,0,1).forEach(function(C){w["main_block_"+C]=d(128,"middle_flow/main_block_"+C)});var _=f(128,256,"exit_flow/reduction_block"),S=c(256,512,"exit_flow/separable_conv"),E={reduction_block:_,separable_conv:S};if(i().length!==0)throw new Error("weights remaing after extract: "+i().length);return{paramMappings:e,params:{entry_flow:b,middle_flow:w,exit_flow:E}}}function Iz(r,t){var e=yo(r,t),n=wR(e),a=A0(e);function i(l){var c=a(l+"/separable_conv0"),f=a(l+"/separable_conv1"),d=n(l+"/expansion_conv");return{separable_conv0:c,separable_conv1:f,expansion_conv:d}}function s(l){var c=a(l+"/separable_conv0"),f=a(l+"/separable_conv1"),d=a(l+"/separable_conv2");return{separable_conv0:c,separable_conv1:f,separable_conv2:d}}return{extractConvParams:n,extractSeparableConvParams:a,extractReductionBlockParams:i,extractMainBlockParams:s}}function Fz(r,t){var e=[],n=Iz(r,e),a=n.extractConvParams,i=n.extractSeparableConvParams,s=n.extractReductionBlockParams,l=n.extractMainBlockParams,c=a("entry_flow/conv_in"),f=s("entry_flow/reduction_block_0"),d=s("entry_flow/reduction_block_1"),v={conv_in:c,reduction_block_0:f,reduction_block_1:d},m={};Pc(t,0,1).forEach(function(_){m["main_block_"+_]=l("middle_flow/main_block_"+_)});var g=s("exit_flow/reduction_block"),b=i("exit_flow/separable_conv"),w={reduction_block:g,separable_conv:b};return hi(r,e),{params:{entry_flow:v,middle_flow:m,exit_flow:w},paramMappings:e}}function AR(r,t,e){return nt(Fr(r,t.filters,e,"same"),t.bias)}function yg(r,t,e){e===void 0&&(e=!0);var n=e?It(r):r;return n=dr(n,t.separable_conv0,[1,1]),n=dr(It(n),t.separable_conv1,[1,1]),n=hn(n,[3,3],[2,2],"same"),n=nt(n,AR(r,t.expansion_conv,[2,2])),n}function Bz(r,t){var e=dr(It(r),t.separable_conv0,[1,1]);return e=dr(It(e),t.separable_conv1,[1,1]),e=dr(It(e),t.separable_conv2,[1,1]),e=nt(e,r),e}var Lz=function(r){We(t,r);function t(e){var n=r.call(this,"TinyXception")||this;return n._numMainBlocks=e,n}return t.prototype.forwardInput=function(e){var n=this,a=this.params;if(!a)throw new Error("TinyXception - load model before inference");return Se(function(){var i=e.toBatchTensor(112,!0),s=[122.782,117.001,104.298],l=of(i,s).div(ye(256)),c=It(AR(l,a.entry_flow.conv_in,[2,2]));return c=yg(c,a.entry_flow.reduction_block_0,!1),c=yg(c,a.entry_flow.reduction_block_1),Pc(n._numMainBlocks,0,1).forEach(function(f){c=Bz(c,a.middle_flow["main_block_"+f])}),c=yg(c,a.exit_flow.reduction_block),c=It(dr(c,a.exit_flow.separable_conv,[1,1])),c})},t.prototype.forward=function(e){return ke(this,void 0,void 0,function(){var n;return Oe(this,function(a){switch(a.label){case 0:return n=this.forwardInput,[4,mn(e)];case 1:return[2,n.apply(this,[a.sent()])]}})})},t.prototype.getDefaultModelName=function(){return"tiny_xception_model"},t.prototype.extractParamsFromWeigthMap=function(e){return Fz(e,this._numMainBlocks)},t.prototype.extractParams=function(e){return Mz(e,this._numMainBlocks)},t}(fi);function Pz(r){var t=[],e=di(r),n=e.extractWeights,a=e.getRemainingWeights,i=R0(n,t),s=i(512,1,"fc/age"),l=i(512,2,"fc/gender");if(a().length!==0)throw new Error("weights remaing after extract: "+a().length);return{paramMappings:t,params:{fc:{age:s,gender:l}}}}function zz(r){var t=[],e=yo(r,t);function n(i){var s=e(i+"/weights",2),l=e(i+"/bias",1);return{weights:s,bias:l}}var a={fc:{age:n("fc/age"),gender:n("fc/gender")}};return hi(r,t),{params:a,paramMappings:t}}var Bd;(function(r){r.FEMALE="female",r.MALE="male"})(Bd||(Bd={}));var Uz=function(r){We(t,r);function t(e){e===void 0&&(e=new Lz(2));var n=r.call(this,"AgeGenderNet")||this;return n._faceFeatureExtractor=e,n}return Object.defineProperty(t.prototype,"faceFeatureExtractor",{get:function(){return this._faceFeatureExtractor},enumerable:!0,configurable:!0}),t.prototype.runNet=function(e){var n=this,a=this.params;if(!a)throw new Error(this._name+" - load model before inference");return Se(function(){var i=e instanceof Fd?n.faceFeatureExtractor.forwardInput(e):e,s=rf(i,[7,7],[2,2],"valid").as2D(i.shape[0],-1),l=ga(s,a.fc.age).as1D(),c=ga(s,a.fc.gender);return{age:l,gender:c}})},t.prototype.forwardInput=function(e){var n=this;return Se(function(){var a=n.runNet(e),i=a.age,s=a.gender;return{age:i,gender:li(s)}})},t.prototype.forward=function(e){return ke(this,void 0,void 0,function(){var n;return Oe(this,function(a){switch(a.label){case 0:return n=this.forwardInput,[4,mn(e)];case 1:return[2,n.apply(this,[a.sent()])]}})})},t.prototype.predictAgeAndGender=function(e){return ke(this,void 0,void 0,function(){var n,a,i,s,l,c,f=this;return Oe(this,function(d){switch(d.label){case 0:return[4,mn(e)];case 1:return n=d.sent(),[4,this.forwardInput(n)];case 2:return a=d.sent(),i=rn(a.age),s=rn(a.gender),l=i.map(function(v,m){return{ageTensor:v,genderTensor:s[m]}}),[4,Promise.all(l.map(function(v){var m=v.ageTensor,g=v.genderTensor;return ke(f,void 0,void 0,function(){var b,w,_,S,E;return Oe(this,function(C){switch(C.label){case 0:return[4,m.data()];case 1:return b=C.sent()[0],[4,g.data()];case 2:return w=C.sent()[0],_=w>.5,S=_?Bd.MALE:Bd.FEMALE,E=_?w:1-w,m.dispose(),g.dispose(),[2,{age:b,gender:S,genderProbability:E}]}})})}))];case 3:return c=d.sent(),a.age.dispose(),a.gender.dispose(),[2,n.isBatchInput?c:c[0]]}})})},t.prototype.getDefaultModelName=function(){return"age_gender_model"},t.prototype.dispose=function(e){e===void 0&&(e=!0),this.faceFeatureExtractor.dispose(e),r.prototype.dispose.call(this,e)},t.prototype.loadClassifierParams=function(e){var n=this.extractClassifierParams(e),a=n.params,i=n.paramMappings;this._params=a,this._paramMappings=i},t.prototype.extractClassifierParams=function(e){return Pz(e)},t.prototype.extractParamsFromWeigthMap=function(e){var n=ER(e),a=n.featureExtractorMap,i=n.classifierMap;return this.faceFeatureExtractor.loadFromWeightMap(a),zz(i)},t.prototype.extractParams=function(e){var n=1539,a=e.slice(0,e.length-n),i=e.slice(e.length-n);return this.faceFeatureExtractor.extractWeights(a),this.extractClassifierParams(i)},t}(fi),DR=function(r){We(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.prototype.postProcess=function(e,n,a){var i=a.map(function(l){var c=l.width,f=l.height,d=n/Math.max(f,c);return{width:c*d,height:f*d}}),s=i.length;return Se(function(){var l=function(m,g){return vr([wa([68],m),wa([68],g)],1).as2D(1,136).as1D()},c=function(m,g){var b=i[m],w=b.width,_=b.height;return g(w,_)?Math.abs(w-_)/2:0},f=function(m){return c(m,function(g,b){return g<b})},d=function(m){return c(m,function(g,b){return b<g})},v=e.mul(wa([s,136],n)).sub(vr(Array.from(Array(s),function(m,g){return l(f(g),d(g))}))).div(vr(Array.from(Array(s),function(m,g){return l(i[g].width,i[g].height)})));return v})},t.prototype.forwardInput=function(e){var n=this;return Se(function(){var a=n.runNet(e);return n.postProcess(a,e.inputSize,e.inputDimensions.map(function(i){var s=i[0],l=i[1];return{height:s,width:l}}))})},t.prototype.forward=function(e){return ke(this,void 0,void 0,function(){var n;return Oe(this,function(a){switch(a.label){case 0:return n=this.forwardInput,[4,mn(e)];case 1:return[2,n.apply(this,[a.sent()])]}})})},t.prototype.detectLandmarks=function(e){return ke(this,void 0,void 0,function(){var n,a,i,s=this;return Oe(this,function(l){switch(l.label){case 0:return[4,mn(e)];case 1:return n=l.sent(),a=Se(function(){return rn(s.forwardInput(n))}),[4,Promise.all(a.map(function(c,f){return ke(s,void 0,void 0,function(){var d,v,m,g,b;return Oe(this,function(w){switch(w.label){case 0:return m=(v=Array).from,[4,c.data()];case 1:return d=m.apply(v,[w.sent()]),g=d.filter(function(_,S){return U_(S)}),b=d.filter(function(_,S){return!U_(S)}),[2,new vz(Array(68).fill(0).map(function(_,S){return new ht(g[S],b[S])}),{height:n.getInputHeight(f),width:n.getInputWidth(f)})]}})})}))];case 2:return i=l.sent(),a.forEach(function(c){return c.dispose()}),[2,n.isBatchInput?i:i[0]]}})})},t.prototype.getClassifierChannelsOut=function(){return 136},t}(CR),kR=function(r){We(t,r);function t(e){return e===void 0&&(e=new SR),r.call(this,"FaceLandmark68Net",e)||this}return t.prototype.getDefaultModelName=function(){return"face_landmark_68_model"},t.prototype.getClassifierChannelsIn=function(){return 256},t}(DR);function Vz(r){var t=[],e=_R(r,t).extractDenseBlock3Params,n={dense0:e("dense0",!0),dense1:e("dense1"),dense2:e("dense2")};return hi(r,t),{params:n,paramMappings:t}}function Hz(r){var t=[],e=di(r),n=e.extractWeights,a=e.getRemainingWeights,i=xR(n,t).extractDenseBlock3Params,s=i(3,32,"dense0",!0),l=i(32,64,"dense1"),c=i(64,128,"dense2");if(a().length!==0)throw new Error("weights remaing after extract: "+a().length);return{paramMappings:t,params:{dense0:s,dense1:l,dense2:c}}}var jz=function(r){We(t,r);function t(){return r.call(this,"TinyFaceFeatureExtractor")||this}return t.prototype.forwardInput=function(e){var n=this.params;if(!n)throw new Error("TinyFaceFeatureExtractor - load model before inference");return Se(function(){var a=e.toBatchTensor(112,!0),i=[122.782,117.001,104.298],s=of(a,i).div(ye(255)),l=gg(s,n.dense0,!0);return l=gg(l,n.dense1),l=gg(l,n.dense2),l=rf(l,[14,14],[2,2],"valid"),l})},t.prototype.forward=function(e){return ke(this,void 0,void 0,function(){var n;return Oe(this,function(a){switch(a.label){case 0:return n=this.forwardInput,[4,mn(e)];case 1:return[2,n.apply(this,[a.sent()])]}})})},t.prototype.getDefaultModelName=function(){return"face_feature_extractor_tiny_model"},t.prototype.extractParamsFromWeigthMap=function(e){return Vz(e)},t.prototype.extractParams=function(e){return Hz(e)},t}(fi),Wz=function(r){We(t,r);function t(e){return e===void 0&&(e=new jz),r.call(this,"FaceLandmark68TinyNet",e)||this}return t.prototype.getDefaultModelName=function(){return"face_landmark_68_tiny_model"},t.prototype.getClassifierChannelsIn=function(){return 128},t}(DR);(function(r){We(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t})(kR);function Gz(r,t){return nt(Mn(r,t.weights),t.biases)}function k0(r,t,e,n,a){a===void 0&&(a="same");var i=t.conv,s=i.filters,l=i.bias,c=Fr(r,s,e,a);return c=nt(c,l),c=Gz(c,t.scale),n?It(c):c}function qz(r,t){return k0(r,t,[1,1],!0)}function OR(r,t){return k0(r,t,[1,1],!1)}function NR(r,t){return k0(r,t,[2,2],!0,"valid")}function Kz(r,t){function e(l,c,f){var d=r(l),v=d.length/(c*f*f);if(oz(v))throw new Error("depth has to be an integer: "+v+", weights.length: "+d.length+", numFilters: "+c+", filterSize: "+f);return Se(function(){return po($n(d,[c,v,f,f]),[2,3,1,0])})}function n(l,c,f,d){var v=e(l,c,f),m=$t(r(c));return t.push({paramPath:d+"/filters"},{paramPath:d+"/bias"}),{filters:v,bias:m}}function a(l,c){var f=$t(r(l)),d=$t(r(l));return t.push({paramPath:c+"/weights"},{paramPath:c+"/biases"}),{weights:f,biases:d}}function i(l,c,f,d){var v=n(l,c,f,d+"/conv"),m=a(c,d+"/scale");return{conv:v,scale:m}}function s(l,c,f,d,v){v===void 0&&(v=!1);var m=i((v?.5:1)*l,c,f,d+"/conv1"),g=i(l,c,f,d+"/conv2");return{conv1:m,conv2:g}}return{extractConvLayerParams:i,extractResidualLayerParams:s}}function Xz(r){var t=di(r),e=t.extractWeights,n=t.getRemainingWeights,a=[],i=Kz(e,a),s=i.extractConvLayerParams,l=i.extractResidualLayerParams,c=s(4704,32,7,"conv32_down"),f=l(9216,32,3,"conv32_1"),d=l(9216,32,3,"conv32_2"),v=l(9216,32,3,"conv32_3"),m=l(36864,64,3,"conv64_down",!0),g=l(36864,64,3,"conv64_1"),b=l(36864,64,3,"conv64_2"),w=l(36864,64,3,"conv64_3"),_=l(147456,128,3,"conv128_down",!0),S=l(147456,128,3,"conv128_1"),E=l(147456,128,3,"conv128_2"),C=l(589824,256,3,"conv256_down",!0),R=l(589824,256,3,"conv256_1"),T=l(589824,256,3,"conv256_2"),D=l(589824,256,3,"conv256_down_out"),k=Se(function(){return po(io(e(256*128),[128,256]),[1,0])});if(a.push({paramPath:"fc"}),n().length!==0)throw new Error("weights remaing after extract: "+n().length);var M={conv32_down:c,conv32_1:f,conv32_2:d,conv32_3:v,conv64_down:m,conv64_1:g,conv64_2:b,conv64_3:w,conv128_down:_,conv128_1:S,conv128_2:E,conv256_down:C,conv256_1:R,conv256_2:T,conv256_down_out:D,fc:k};return{params:M,paramMappings:a}}function $z(r,t){var e=yo(r,t);function n(s){var l=e(s+"/scale/weights",1),c=e(s+"/scale/biases",1);return{weights:l,biases:c}}function a(s){var l=e(s+"/conv/filters",4),c=e(s+"/conv/bias",1),f=n(s);return{conv:{filters:l,bias:c},scale:f}}function i(s){return{conv1:a(s+"/conv1"),conv2:a(s+"/conv2")}}return{extractConvLayerParams:a,extractResidualLayerParams:i}}function Yz(r){var t=[],e=$z(r,t),n=e.extractConvLayerParams,a=e.extractResidualLayerParams,i=n("conv32_down"),s=a("conv32_1"),l=a("conv32_2"),c=a("conv32_3"),f=a("conv64_down"),d=a("conv64_1"),v=a("conv64_2"),m=a("conv64_3"),g=a("conv128_down"),b=a("conv128_1"),w=a("conv128_2"),_=a("conv256_down"),S=a("conv256_1"),E=a("conv256_2"),C=a("conv256_down_out"),R=r.fc;if(t.push({originalPath:"fc",paramPath:"fc"}),!iz(R))throw new Error("expected weightMap[fc] to be a Tensor2D, instead have "+R);var T={conv32_down:i,conv32_1:s,conv32_2:l,conv32_3:c,conv64_down:f,conv64_1:d,conv64_2:v,conv64_3:m,conv128_down:g,conv128_1:b,conv128_2:w,conv256_down:_,conv256_1:S,conv256_2:E,conv256_down_out:C,fc:R};return hi(r,t),{params:T,paramMappings:t}}function sa(r,t){var e=qz(r,t.conv1);return e=OR(e,t.conv2),e=nt(e,r),e=It(e),e}function Ph(r,t){var e=NR(r,t.conv1);e=OR(e,t.conv2);var n=rf(r,2,2,"valid"),a=Dt(n.shape),i=n.shape[3]!==e.shape[3],s=n.shape[1]!==e.shape[1]||n.shape[2]!==e.shape[2];if(s){var l=vc(e.shape);l[1]=1;var c=Dt(l);e=nn([e,c],1);var f=vc(e.shape);f[2]=1;var d=Dt(f);e=nn([e,d],2)}return n=i?nn([n,a],3):n,e=nt(n,e),e=It(e),e}var Zz=function(r){We(t,r);function t(){return r.call(this,"FaceRecognitionNet")||this}return t.prototype.forwardInput=function(e){var n=this.params;if(!n)throw new Error("FaceRecognitionNet - load model before inference");return Se(function(){var a=e.toBatchTensor(150,!0).toFloat(),i=[122.782,117.001,104.298],s=of(a,i).div(ye(256)),l=NR(s,n.conv32_down);l=hn(l,3,2,"valid"),l=sa(l,n.conv32_1),l=sa(l,n.conv32_2),l=sa(l,n.conv32_3),l=Ph(l,n.conv64_down),l=sa(l,n.conv64_1),l=sa(l,n.conv64_2),l=sa(l,n.conv64_3),l=Ph(l,n.conv128_down),l=sa(l,n.conv128_1),l=sa(l,n.conv128_2),l=Ph(l,n.conv256_down),l=sa(l,n.conv256_1),l=sa(l,n.conv256_2),l=Ph(l,n.conv256_down_out);var c=l.mean([1,2]),f=ep(c,n.fc);return f})},t.prototype.forward=function(e){return ke(this,void 0,void 0,function(){var n;return Oe(this,function(a){switch(a.label){case 0:return n=this.forwardInput,[4,mn(e)];case 1:return[2,n.apply(this,[a.sent()])]}})})},t.prototype.computeFaceDescriptor=function(e){return ke(this,void 0,void 0,function(){var n,a,i,s=this;return Oe(this,function(l){switch(l.label){case 0:return[4,mn(e)];case 1:return n=l.sent(),a=Se(function(){return rn(s.forwardInput(n))}),[4,Promise.all(a.map(function(c){return c.data()}))];case 2:return i=l.sent(),a.forEach(function(c){return c.dispose()}),[2,n.isBatchInput?i:i[0]]}})})},t.prototype.getDefaultModelName=function(){return"face_recognition_model"},t.prototype.extractParamsFromWeigthMap=function(e){return Yz(e)},t.prototype.extractParams=function(e){return Xz(e)},t}(fi);function MR(r,t){var e={descriptor:t};return Object.assign({},r,e)}function IR(r,t){var e={age:t};return Object.assign({},r,e)}function FR(r,t,e){var n={gender:t,genderProbability:e};return Object.assign({},r,n)}var BR=function(){function r(t){var e=t===void 0?{}:t,n=e.minFaceSize,a=e.scaleFactor,i=e.maxNumScales,s=e.scoreThresholds,l=e.scaleSteps;if(this._name="MtcnnOptions",this._minFaceSize=n||20,this._scaleFactor=a||.709,this._maxNumScales=i||10,this._scoreThresholds=s||[.6,.7,.7],this._scaleSteps=l,typeof this._minFaceSize!="number"||this._minFaceSize<0)throw new Error(this._name+" - expected minFaceSize to be a number > 0");if(typeof this._scaleFactor!="number"||this._scaleFactor<=0||this._scaleFactor>=1)throw new Error(this._name+" - expected scaleFactor to be a number between 0 and 1");if(typeof this._maxNumScales!="number"||this._maxNumScales<0)throw new Error(this._name+" - expected maxNumScales to be a number > 0");if(!Array.isArray(this._scoreThresholds)||this._scoreThresholds.length!==3||this._scoreThresholds.some(function(c){return typeof c!="number"}))throw new Error(this._name+" - expected scoreThresholds to be an array of numbers of length 3");if(this._scaleSteps&&(!Array.isArray(this._scaleSteps)||this._scaleSteps.some(function(c){return typeof c!="number"})))throw new Error(this._name+" - expected scaleSteps to be an array of numbers")}return Object.defineProperty(r.prototype,"minFaceSize",{get:function(){return this._minFaceSize},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"scaleFactor",{get:function(){return this._scaleFactor},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"maxNumScales",{get:function(){return this._maxNumScales},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"scoreThresholds",{get:function(){return this._scoreThresholds},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"scaleSteps",{get:function(){return this._scaleSteps},enumerable:!0,configurable:!0}),r}();function Qz(r,t){function e(c,f){var d=$n(r(9*c),[3,3,c,1]),v=$t(r(c)),m=$t(r(c)),g=$t(r(c)),b=$t(r(c));return t.push({paramPath:f+"/filters"},{paramPath:f+"/batch_norm_scale"},{paramPath:f+"/batch_norm_offset"},{paramPath:f+"/batch_norm_mean"},{paramPath:f+"/batch_norm_variance"}),{filters:d,batch_norm_scale:v,batch_norm_offset:m,batch_norm_mean:g,batch_norm_variance:b}}function n(c,f,d,v,m){var g=$n(r(c*f*d*d),[d,d,c,f]),b=$t(r(f));return t.push({paramPath:v+"/filters"},{paramPath:v+"/"+(m?"batch_norm_offset":"bias")}),{filters:g,bias:b}}function a(c,f,d,v){var m=n(c,f,d,v,!0),g=m.filters,b=m.bias;return{filters:g,batch_norm_offset:b}}function i(c,f,d){var v=e(c,d+"/depthwise_conv"),m=a(c,f,1,d+"/pointwise_conv");return{depthwise_conv:v,pointwise_conv:m}}function s(){var c=a(3,32,3,"mobilenetv1/conv_0"),f=i(32,64,"mobilenetv1/conv_1"),d=i(64,128,"mobilenetv1/conv_2"),v=i(128,128,"mobilenetv1/conv_3"),m=i(128,256,"mobilenetv1/conv_4"),g=i(256,256,"mobilenetv1/conv_5"),b=i(256,512,"mobilenetv1/conv_6"),w=i(512,512,"mobilenetv1/conv_7"),_=i(512,512,"mobilenetv1/conv_8"),S=i(512,512,"mobilenetv1/conv_9"),E=i(512,512,"mobilenetv1/conv_10"),C=i(512,512,"mobilenetv1/conv_11"),R=i(512,1024,"mobilenetv1/conv_12"),T=i(1024,1024,"mobilenetv1/conv_13");return{conv_0:c,conv_1:f,conv_2:d,conv_3:v,conv_4:m,conv_5:g,conv_6:b,conv_7:w,conv_8:_,conv_9:S,conv_10:E,conv_11:C,conv_12:R,conv_13:T}}function l(){var c=a(1024,256,1,"prediction_layer/conv_0"),f=a(256,512,3,"prediction_layer/conv_1"),d=a(512,128,1,"prediction_layer/conv_2"),v=a(128,256,3,"prediction_layer/conv_3"),m=a(256,128,1,"prediction_layer/conv_4"),g=a(128,256,3,"prediction_layer/conv_5"),b=a(256,64,1,"prediction_layer/conv_6"),w=a(64,128,3,"prediction_layer/conv_7"),_=n(512,12,1,"prediction_layer/box_predictor_0/box_encoding_predictor"),S=n(512,9,1,"prediction_layer/box_predictor_0/class_predictor"),E=n(1024,24,1,"prediction_layer/box_predictor_1/box_encoding_predictor"),C=n(1024,18,1,"prediction_layer/box_predictor_1/class_predictor"),R=n(512,24,1,"prediction_layer/box_predictor_2/box_encoding_predictor"),T=n(512,18,1,"prediction_layer/box_predictor_2/class_predictor"),D=n(256,24,1,"prediction_layer/box_predictor_3/box_encoding_predictor"),k=n(256,18,1,"prediction_layer/box_predictor_3/class_predictor"),M=n(256,24,1,"prediction_layer/box_predictor_4/box_encoding_predictor"),N=n(256,18,1,"prediction_layer/box_predictor_4/class_predictor"),I=n(128,24,1,"prediction_layer/box_predictor_5/box_encoding_predictor"),z=n(128,18,1,"prediction_layer/box_predictor_5/class_predictor"),P={box_encoding_predictor:_,class_predictor:S},ne={box_encoding_predictor:E,class_predictor:C},re={box_encoding_predictor:R,class_predictor:T},ee={box_encoding_predictor:D,class_predictor:k},U={box_encoding_predictor:M,class_predictor:N},G={box_encoding_predictor:I,class_predictor:z};return{conv_0:c,conv_1:f,conv_2:d,conv_3:v,conv_4:m,conv_5:g,conv_6:b,conv_7:w,box_predictor_0:P,box_predictor_1:ne,box_predictor_2:re,box_predictor_3:ee,box_predictor_4:U,box_predictor_5:G}}return{extractMobilenetV1Params:s,extractPredictionLayerParams:l}}function Jz(r){var t=[],e=di(r),n=e.extractWeights,a=e.getRemainingWeights,i=Qz(n,t),s=i.extractMobilenetV1Params,l=i.extractPredictionLayerParams,c=s(),f=l(),d=Wy(n(5118*4),[1,5118,4]),v={extra_dim:d};if(t.push({paramPath:"output_layer/extra_dim"}),a().length!==0)throw new Error("weights remaing after extract: "+a().length);return{params:{mobilenetv1:c,prediction_layer:f,output_layer:v},paramMappings:t}}function eU(r,t){var e=yo(r,t);function n(f,d,v){var m=e(f+"/Conv2d_"+d+"_pointwise/weights",4,v+"/filters"),g=e(f+"/Conv2d_"+d+"_pointwise/convolution_bn_offset",1,v+"/batch_norm_offset");return{filters:m,batch_norm_offset:g}}function a(f){var d="mobilenetv1/conv_"+f,v="MobilenetV1/Conv2d_"+f+"_depthwise",m=d+"/depthwise_conv",g=d+"/pointwise_conv",b=e(v+"/depthwise_weights",4,m+"/filters"),w=e(v+"/BatchNorm/gamma",1,m+"/batch_norm_scale"),_=e(v+"/BatchNorm/beta",1,m+"/batch_norm_offset"),S=e(v+"/BatchNorm/moving_mean",1,m+"/batch_norm_mean"),E=e(v+"/BatchNorm/moving_variance",1,m+"/batch_norm_variance");return{depthwise_conv:{filters:b,batch_norm_scale:w,batch_norm_offset:_,batch_norm_mean:S,batch_norm_variance:E},pointwise_conv:n("MobilenetV1",f,g)}}function i(){return{conv_0:n("MobilenetV1",0,"mobilenetv1/conv_0"),conv_1:a(1),conv_2:a(2),conv_3:a(3),conv_4:a(4),conv_5:a(5),conv_6:a(6),conv_7:a(7),conv_8:a(8),conv_9:a(9),conv_10:a(10),conv_11:a(11),conv_12:a(12),conv_13:a(13)}}function s(f,d){var v=e(f+"/weights",4,d+"/filters"),m=e(f+"/biases",1,d+"/bias");return{filters:v,bias:m}}function l(f){var d=s("Prediction/BoxPredictor_"+f+"/BoxEncodingPredictor","prediction_layer/box_predictor_"+f+"/box_encoding_predictor"),v=s("Prediction/BoxPredictor_"+f+"/ClassPredictor","prediction_layer/box_predictor_"+f+"/class_predictor");return{box_encoding_predictor:d,class_predictor:v}}function c(){return{conv_0:n("Prediction",0,"prediction_layer/conv_0"),conv_1:n("Prediction",1,"prediction_layer/conv_1"),conv_2:n("Prediction",2,"prediction_layer/conv_2"),conv_3:n("Prediction",3,"prediction_layer/conv_3"),conv_4:n("Prediction",4,"prediction_layer/conv_4"),conv_5:n("Prediction",5,"prediction_layer/conv_5"),conv_6:n("Prediction",6,"prediction_layer/conv_6"),conv_7:n("Prediction",7,"prediction_layer/conv_7"),box_predictor_0:l(0),box_predictor_1:l(1),box_predictor_2:l(2),box_predictor_3:l(3),box_predictor_4:l(4),box_predictor_5:l(5)}}return{extractMobilenetV1Params:i,extractPredictionLayerParams:c}}function tU(r){var t=[],e=eU(r,t),n=e.extractMobilenetV1Params,a=e.extractPredictionLayerParams,i=r["Output/extra_dim"];if(t.push({originalPath:"Output/extra_dim",paramPath:"output_layer/extra_dim"}),!ap(i))throw new Error("expected weightMap['Output/extra_dim'] to be a Tensor3D, instead have "+i);var s={mobilenetv1:n(),prediction_layer:a(),output_layer:{extra_dim:i}};return hi(r,t),{params:s,paramMappings:t}}function ua(r,t,e){return Se(function(){var n=Fr(r,t.filters,e,"same");return n=nt(n,t.batch_norm_offset),t0(n,0,6)})}var nU=.0010000000474974513;function rU(r,t,e){return Se(function(){var n=Jd(r,t.filters,e,"same");return n=DC(n,t.batch_norm_mean,t.batch_norm_variance,t.batch_norm_offset,t.batch_norm_scale,nU),t0(n,0,6)})}function aU(r){return[2,4,6,12].some(function(t){return t===r})?[2,2]:[1,1]}function iU(r,t){return Se(function(){var e=null,n=ua(r,t.conv_0,[2,2]),a=[t.conv_1,t.conv_2,t.conv_3,t.conv_4,t.conv_5,t.conv_6,t.conv_7,t.conv_8,t.conv_9,t.conv_10,t.conv_11,t.conv_12,t.conv_13];if(a.forEach(function(i,s){var l=s+1,c=aU(l);n=rU(n,i.depthwise_conv,c),n=ua(n,i.pointwise_conv,[1,1]),l===11&&(e=n)}),e===null)throw new Error("mobileNetV1 - output of conv layer 11 is null");return{out:n,conv11:e}})}function oU(r,t,e,n,a){var i=r.shape[0],s=Math.min(e,i),l=t.map(function(d,v){return{score:d,boxIndex:v}}).filter(function(d){return d.score>a}).sort(function(d,v){return v.score-d.score}),c=function(d){return d<=n?1:0},f=[];return l.forEach(function(d){if(!(f.length>=s)){for(var v=d.score,m=f.length-1;m>=0;--m){var g=sU(r,d.boxIndex,f[m]);if(g!==0&&(d.score*=c(g),d.score<=a))break}v===d.score&&f.push(d.boxIndex)}}),f}function sU(r,t,e){var n=r.arraySync(),a=Math.min(n[t][0],n[t][2]),i=Math.min(n[t][1],n[t][3]),s=Math.max(n[t][0],n[t][2]),l=Math.max(n[t][1],n[t][3]),c=Math.min(n[e][0],n[e][2]),f=Math.min(n[e][1],n[e][3]),d=Math.max(n[e][0],n[e][2]),v=Math.max(n[e][1],n[e][3]),m=(s-a)*(l-i),g=(d-c)*(v-f);if(m<=0||g<=0)return 0;var b=Math.max(a,c),w=Math.max(i,f),_=Math.min(s,d),S=Math.min(l,v),E=Math.max(_-b,0)*Math.max(S-w,0);return E/(m+g-E)}function uU(r){var t=rn(po(r,[1,0])),e=[on(t[2],t[0]),on(t[3],t[1])],n=[nt(t[0],Wr(e[0],ye(2))),nt(t[1],Wr(e[1],ye(2)))];return{sizes:e,centers:n}}function lU(r,t){var e=uU(r),n=e.sizes,a=e.centers,i=rn(po(t,[1,0])),s=Wr(Mn(py(Wr(i[2],ye(5))),n[0]),ye(2)),l=nt(Mn(Wr(i[0],ye(10)),n[0]),a[0]),c=Wr(Mn(py(Wr(i[3],ye(5))),n[1]),ye(2)),f=nt(Mn(Wr(i[1],ye(10)),n[1]),a[1]);return po(vr([on(l,s),on(f,c),nt(l,s),nt(f,c)]),[1,0])}function cU(r,t,e){return Se(function(){var n=r.shape[0],a=lU(qr(gu(e.extra_dim,[n,1,1]),[-1,4]),qr(r,[-1,4]));a=qr(a,[n,a.shape[0]/n,4]);var i=CC(Ea(t,[0,0,1],[-1,-1,-1])),s=Ea(i,[0,0,0],[-1,-1,1]);s=qr(s,[n,s.shape[1]]);var l=rn(a),c=rn(s);return{boxes:l,scores:c}})}function iu(r,t){return Se(function(){var e=r.shape[0],n=qr($r(r,t.box_encoding_predictor),[e,-1,1,4]),a=qr($r(r,t.class_predictor),[e,-1,3]);return{boxPredictionEncoding:n,classPrediction:a}})}function fU(r,t,e){return Se(function(){var n=ua(r,e.conv_0,[1,1]),a=ua(n,e.conv_1,[2,2]),i=ua(a,e.conv_2,[1,1]),s=ua(i,e.conv_3,[2,2]),l=ua(s,e.conv_4,[1,1]),c=ua(l,e.conv_5,[2,2]),f=ua(c,e.conv_6,[1,1]),d=ua(f,e.conv_7,[2,2]),v=iu(t,e.box_predictor_0),m=iu(r,e.box_predictor_1),g=iu(a,e.box_predictor_2),b=iu(s,e.box_predictor_3),w=iu(c,e.box_predictor_4),_=iu(d,e.box_predictor_5),S=nn([v.boxPredictionEncoding,m.boxPredictionEncoding,g.boxPredictionEncoding,b.boxPredictionEncoding,w.boxPredictionEncoding,_.boxPredictionEncoding],1),E=nn([v.classPrediction,m.classPrediction,g.classPrediction,b.classPrediction,w.classPrediction,_.classPrediction],1);return{boxPredictions:S,classPredictions:E}})}var lp=function(){function r(t){var e=t===void 0?{}:t,n=e.minConfidence,a=e.maxResults;if(this._name="SsdMobilenetv1Options",this._minConfidence=n||.5,this._maxResults=a||100,typeof this._minConfidence!="number"||this._minConfidence<=0||this._minConfidence>=1)throw new Error(this._name+" - expected minConfidence to be a number between 0 and 1");if(typeof this._maxResults!="number")throw new Error(this._name+" - expected maxResults to be a number")}return Object.defineProperty(r.prototype,"minConfidence",{get:function(){return this._minConfidence},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"maxResults",{get:function(){return this._maxResults},enumerable:!0,configurable:!0}),r}(),LR=function(r){We(t,r);function t(){return r.call(this,"SsdMobilenetv1")||this}return t.prototype.forwardInput=function(e){var n=this.params;if(!n)throw new Error("SsdMobilenetv1 - load model before inference");return Se(function(){var a=e.toBatchTensor(512,!1).toFloat(),i=on(Mn(a,ye(.007843137718737125)),ye(1)),s=iU(i,n.mobilenetv1),l=fU(s.out,s.conv11,n.prediction_layer),c=l.boxPredictions,f=l.classPredictions;return cU(c,f,n.output_layer)})},t.prototype.forward=function(e){return ke(this,void 0,void 0,function(){var n;return Oe(this,function(a){switch(a.label){case 0:return n=this.forwardInput,[4,mn(e)];case 1:return[2,n.apply(this,[a.sent()])]}})})},t.prototype.locateFaces=function(e,n){return n===void 0&&(n={}),ke(this,void 0,void 0,function(){var a,i,s,l,c,f,d,v,m,g,b,w,_,S,E,C,R,T,D,k,M;return Oe(this,function(N){switch(N.label){case 0:return a=new lp(n),i=a.maxResults,s=a.minConfidence,[4,mn(e)];case 1:for(l=N.sent(),c=this.forwardInput(l),f=c.boxes,d=c.scores,v=f[0],m=d[0],g=1;g<f.length;g++)f[g].dispose(),d[g].dispose();return _=(w=Array).from,[4,m.data()];case 2:return b=_.apply(w,[N.sent()]),S=.5,E=oU(v,b,i,S,s),C=l.getReshapedInputDimensions(0),R=l.inputSize,T=R/C.width,D=R/C.height,k=v.arraySync(),M=E.map(function(I){var z=[Math.max(0,k[I][0]),Math.min(1,k[I][2])].map(function(G){return G*D}),P=z[0],ne=z[1],re=[Math.max(0,k[I][1]),Math.min(1,k[I][3])].map(function(G){return G*T}),ee=re[0],U=re[1];return new mr(b[I],new b0(ee,P,U-ee,ne-P),{height:l.getInputHeight(0),width:l.getInputWidth(0)})}),v.dispose(),m.dispose(),[2,M]}})})},t.prototype.getDefaultModelName=function(){return"ssd_mobilenetv1_model"},t.prototype.extractParamsFromWeigthMap=function(e){return tU(e)},t.prototype.extractParams=function(e){return Jz(e)},t}(fi);(function(r){We(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t})(LR);var hU=.4,dU=[new ht(.738768,.874946),new ht(2.42204,2.65704),new ht(4.30971,7.04493),new ht(10.246,4.59428),new ht(12.6868,11.8741)],pU=[new ht(1.603231,2.094468),new ht(6.041143,7.080126),new ht(2.882459,3.518061),new ht(4.266906,5.178857),new ht(9.041765,10.66308)],vU=[117.001,114.697,97.404],mU="tiny_yolov2_model",gU="tiny_yolov2_separable_conv_model",zh=function(r){return typeof r=="number"};function yU(r){if(!r)throw new Error("invalid config: "+r);if(typeof r.withSeparableConvs!="boolean")throw new Error("config.withSeparableConvs has to be a boolean, have: "+r.withSeparableConvs);if(!zh(r.iouThreshold)||r.iouThreshold<0||r.iouThreshold>1)throw new Error("config.iouThreshold has to be a number between [0, 1], have: "+r.iouThreshold);if(!Array.isArray(r.classes)||!r.classes.length||!r.classes.every(function(t){return typeof t=="string"}))throw new Error("config.classes has to be an array class names: string[], have: "+JSON.stringify(r.classes));if(!Array.isArray(r.anchors)||!r.anchors.length||!r.anchors.map(function(t){return t||{}}).every(function(t){return zh(t.x)&&zh(t.y)}))throw new Error("config.anchors has to be an array of { x: number, y: number }, have: "+JSON.stringify(r.anchors));if(r.meanRgb&&(!Array.isArray(r.meanRgb)||r.meanRgb.length!==3||!r.meanRgb.every(zh)))throw new Error("config.meanRgb has to be an array of shape [number, number, number], have: "+JSON.stringify(r.meanRgb))}function O0(r){return Se(function(){var t=Mn(r,ye(.10000000149011612));return nt(It(on(r,t)),t)})}function Ui(r,t){return Se(function(){var e=cs(r,[[0,0],[1,1],[1,1],[0,0]]);return e=Fr(e,t.conv.filters,[1,1],"valid"),e=on(e,t.bn.sub),e=Mn(e,t.bn.truediv),e=nt(e,t.conv.bias),O0(e)})}function Vi(r,t){return Se(function(){var e=cs(r,[[0,0],[1,1],[1,1],[0,0]]);return e=i0(e,t.depthwise_filter,t.pointwise_filter,[1,1],"valid"),e=nt(e,t.bias),O0(e)})}function bU(r,t){var e=sp(r,t);function n(s,l){var c=$t(r(s)),f=$t(r(s));return t.push({paramPath:l+"/sub"},{paramPath:l+"/truediv"}),{sub:c,truediv:f}}function a(s,l,c){var f=e(s,l,3,c+"/conv"),d=n(l,c+"/bn");return{conv:f,bn:d}}var i=T0(r,t);return{extractConvParams:e,extractConvWithBatchNormParams:a,extractSeparableConvParams:i}}function xU(r,t,e,n){var a=di(r),i=a.extractWeights,s=a.getRemainingWeights,l=[],c=bU(i,l),f=c.extractConvParams,d=c.extractConvWithBatchNormParams,v=c.extractSeparableConvParams,m;if(t.withSeparableConvs){var g=n[0],b=n[1],w=n[2],_=n[3],S=n[4],E=n[5],C=n[6],R=n[7],T=n[8],D=t.isFirstLayerConv2d?f(g,b,3,"conv0"):v(g,b,"conv0"),k=v(b,w,"conv1"),M=v(w,_,"conv2"),N=v(_,S,"conv3"),I=v(S,E,"conv4"),z=v(E,C,"conv5"),P=R?v(C,R,"conv6"):void 0,ne=T?v(R,T,"conv7"):void 0,re=f(T||R||C,5*e,1,"conv8");m={conv0:D,conv1:k,conv2:M,conv3:N,conv4:I,conv5:z,conv6:P,conv7:ne,conv8:re}}else{var g=n[0],b=n[1],w=n[2],_=n[3],S=n[4],E=n[5],C=n[6],R=n[7],T=n[8],D=d(g,b,"conv0"),k=d(b,w,"conv1"),M=d(w,_,"conv2"),N=d(_,S,"conv3"),I=d(S,E,"conv4"),z=d(E,C,"conv5"),P=d(C,R,"conv6"),ne=d(R,T,"conv7"),re=f(T,5*e,1,"conv8");m={conv0:D,conv1:k,conv2:M,conv3:N,conv4:I,conv5:z,conv6:P,conv7:ne,conv8:re}}if(s().length!==0)throw new Error("weights remaing after extract: "+s().length);return{params:m,paramMappings:l}}function wU(r,t){var e=yo(r,t);function n(l){var c=e(l+"/sub",1),f=e(l+"/truediv",1);return{sub:c,truediv:f}}function a(l){var c=e(l+"/filters",4),f=e(l+"/bias",1);return{filters:c,bias:f}}function i(l){var c=a(l+"/conv"),f=n(l+"/bn");return{conv:c,bn:f}}var s=A0(e);return{extractConvParams:a,extractConvWithBatchNormParams:i,extractSeparableConvParams:s}}function _U(r,t){var e=[],n=wU(r,e),a=n.extractConvParams,i=n.extractConvWithBatchNormParams,s=n.extractSeparableConvParams,l;if(t.withSeparableConvs){var c=t.filterSizes&&t.filterSizes.length||9;l={conv0:t.isFirstLayerConv2d?a("conv0"):s("conv0"),conv1:s("conv1"),conv2:s("conv2"),conv3:s("conv3"),conv4:s("conv4"),conv5:s("conv5"),conv6:c>7?s("conv6"):void 0,conv7:c>8?s("conv7"):void 0,conv8:a("conv8")}}else l={conv0:i("conv0"),conv1:i("conv1"),conv2:i("conv2"),conv3:i("conv3"),conv4:i("conv4"),conv5:i("conv5"),conv6:i("conv6"),conv7:i("conv7"),conv8:a("conv8")};return hi(r,e),{params:l,paramMappings:e}}var K_;(function(r){r[r.XS=224]="XS",r[r.SM=320]="SM",r[r.MD=416]="MD",r[r.LG=608]="LG"})(K_||(K_={}));var N0=function(){function r(t){var e=t===void 0?{}:t,n=e.inputSize,a=e.scoreThreshold;if(this._name="TinyYolov2Options",this._inputSize=n||416,this._scoreThreshold=a||.5,typeof this._inputSize!="number"||this._inputSize%32!==0)throw new Error(this._name+" - expected inputSize to be a number divisible by 32");if(typeof this._scoreThreshold!="number"||this._scoreThreshold<=0||this._scoreThreshold>=1)throw new Error(this._name+" - expected scoreThreshold to be a number between 0 and 1")}return Object.defineProperty(r.prototype,"inputSize",{get:function(){return this._inputSize},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"scoreThreshold",{get:function(){return this._scoreThreshold},enumerable:!0,configurable:!0}),r}(),PR=function(r){We(t,r);function t(e){var n=r.call(this,"TinyYolov2")||this;return yU(e),n._config=e,n}return Object.defineProperty(t.prototype,"config",{get:function(){return this._config},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"withClassScores",{get:function(){return this.config.withClassScores||this.config.classes.length>1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"boxEncodingSize",{get:function(){return 5+(this.withClassScores?this.config.classes.length:0)},enumerable:!0,configurable:!0}),t.prototype.runTinyYolov2=function(e,n){var a=Ui(e,n.conv0);return a=hn(a,[2,2],[2,2],"same"),a=Ui(a,n.conv1),a=hn(a,[2,2],[2,2],"same"),a=Ui(a,n.conv2),a=hn(a,[2,2],[2,2],"same"),a=Ui(a,n.conv3),a=hn(a,[2,2],[2,2],"same"),a=Ui(a,n.conv4),a=hn(a,[2,2],[2,2],"same"),a=Ui(a,n.conv5),a=hn(a,[2,2],[1,1],"same"),a=Ui(a,n.conv6),a=Ui(a,n.conv7),$r(a,n.conv8,"valid",!1)},t.prototype.runMobilenet=function(e,n){var a=this.config.isFirstLayerConv2d?O0($r(e,n.conv0,"valid",!1)):Vi(e,n.conv0);return a=hn(a,[2,2],[2,2],"same"),a=Vi(a,n.conv1),a=hn(a,[2,2],[2,2],"same"),a=Vi(a,n.conv2),a=hn(a,[2,2],[2,2],"same"),a=Vi(a,n.conv3),a=hn(a,[2,2],[2,2],"same"),a=Vi(a,n.conv4),a=hn(a,[2,2],[2,2],"same"),a=Vi(a,n.conv5),a=hn(a,[2,2],[1,1],"same"),a=n.conv6?Vi(a,n.conv6):a,a=n.conv7?Vi(a,n.conv7):a,$r(a,n.conv8,"valid",!1)},t.prototype.forwardInput=function(e,n){var a=this,i=this.params;if(!i)throw new Error("TinyYolov2 - load model before inference");return Se(function(){var s=e.toBatchTensor(n,!1).toFloat();return s=a.config.meanRgb?of(s,a.config.meanRgb):s,s=s.div(ye(256)),a.config.withSeparableConvs?a.runMobilenet(s,i):a.runTinyYolov2(s,i)})},t.prototype.forward=function(e,n){return ke(this,void 0,void 0,function(){var a;return Oe(this,function(i){switch(i.label){case 0:return a=this.forwardInput,[4,mn(e)];case 1:return[4,a.apply(this,[i.sent(),n])];case 2:return[2,i.sent()]}})})},t.prototype.detect=function(e,n){return n===void 0&&(n={}),ke(this,void 0,void 0,function(){var a,i,s,l,c,f,d,v,m,g,b,w,_,S,E=this;return Oe(this,function(C){switch(C.label){case 0:return a=new N0(n),i=a.inputSize,s=a.scoreThreshold,[4,mn(e)];case 1:return l=C.sent(),[4,this.forwardInput(l,i)];case 2:return c=C.sent(),f=Se(function(){return rn(c)[0].expandDims()}),d={width:l.getInputWidth(0),height:l.getInputHeight(0)},[4,this.extractBoxes(f,l.getReshapedInputDimensions(0),s)];case 3:return v=C.sent(),c.dispose(),f.dispose(),m=v.map(function(R){return R.box}),g=v.map(function(R){return R.score}),b=v.map(function(R){return R.classScore}),w=v.map(function(R){return E.config.classes[R.label]}),_=zc(m.map(function(R){return R.rescale(i)}),g,this.config.iouThreshold,!0),S=_.map(function(R){return new lR(g[R],b[R],w[R],m[R],d)}),[2,S]}})})},t.prototype.getDefaultModelName=function(){return""},t.prototype.extractParamsFromWeigthMap=function(e){return _U(e,this.config)},t.prototype.extractParams=function(e){var n=this.config.filterSizes||t.DEFAULT_FILTER_SIZES,a=n?n.length:void 0;if(a!==7&&a!==8&&a!==9)throw new Error("TinyYolov2 - expected 7 | 8 | 9 convolutional filters, but found "+a+" filterSizes in config");return xU(e,this.config,this.boxEncodingSize,n)},t.prototype.extractBoxes=function(e,n,a){return ke(this,void 0,void 0,function(){var i,s,l,c,f,d,v,m,g,b,w,_,S,E,C,R,T,D,k,M,N,I,z,P,ne,re,ee,U,G,X=this;return Oe(this,function(J){switch(J.label){case 0:return i=n.width,s=n.height,l=Math.max(i,s),c=l/i,f=l/s,d=e.shape[1],v=this.config.anchors.length,m=Se(function(){var F=e.reshape([d,d,v,X.boxEncodingSize]),K=F.slice([0,0,0,0],[d,d,v,4]),oe=F.slice([0,0,0,4],[d,d,v,1]),ue=X.withClassScores?li(F.slice([0,0,0,5],[d,d,v,X.config.classes.length]),3):ye(0);return[K,oe,ue]}),g=m[0],b=m[1],w=m[2],_=[],[4,b.array()];case 1:return S=J.sent(),[4,g.array()];case 2:E=J.sent(),C=0,J.label=3;case 3:if(!(C<d))return[3,12];R=0,J.label=4;case 4:if(!(R<d))return[3,11];T=0,J.label=5;case 5:return T<v?(D=mg(S[C][R][T][0]),!a||D>a?(k=(R+mg(E[C][R][T][0]))/d*c,M=(C+mg(E[C][R][T][1]))/d*f,N=Math.exp(E[C][R][T][2])*this.config.anchors[T].x/d*c,I=Math.exp(E[C][R][T][3])*this.config.anchors[T].y/d*f,z=k-N/2,P=M-I/2,ne={row:C,col:R,anchor:T},this.withClassScores?[4,this.extractPredictedClass(w,ne)]:[3,7]):[3,9]):[3,10];case 6:return G=J.sent(),[3,8];case 7:G={classScore:1,label:0},J.label=8;case 8:re=G,ee=re.classScore,U=re.label,_.push(kn({box:new ip(z,P,z+N,P+I),score:D,classScore:D*ee,label:U},ne)),J.label=9;case 9:return T++,[3,5];case 10:return R++,[3,4];case 11:return C++,[3,3];case 12:return g.dispose(),b.dispose(),w.dispose(),[2,_]}})})},t.prototype.extractPredictedClass=function(e,n){return ke(this,void 0,void 0,function(){var a,i,s,l;return Oe(this,function(c){switch(c.label){case 0:return a=n.row,i=n.col,s=n.anchor,[4,e.array()];case 1:return l=c.sent(),[2,Array(this.config.classes.length).fill(0).map(function(f,d){return l[a][i][s][d]}).map(function(f,d){return{classScore:f,label:d}}).reduce(function(f,d){return f.classScore>d.classScore?f:d})]}})})},t.DEFAULT_FILTER_SIZES=[3,16,32,64,128,256,512,1024,1024],t}(fi),SU=function(r){We(t,r);function t(e){e===void 0&&(e=!0);var n=this,a=Object.assign({},{withSeparableConvs:e,iouThreshold:hU,classes:["face"]},e?{anchors:pU,meanRgb:vU}:{anchors:dU,withClassScores:!0});return n=r.call(this,a)||this,n}return Object.defineProperty(t.prototype,"withSeparableConvs",{get:function(){return this.config.withSeparableConvs},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"anchors",{get:function(){return this.config.anchors},enumerable:!0,configurable:!0}),t.prototype.locateFaces=function(e,n){return ke(this,void 0,void 0,function(){var a;return Oe(this,function(i){switch(i.label){case 0:return[4,this.detect(e,n)];case 1:return a=i.sent(),[2,a.map(function(s){return new mr(s.score,s.relativeBox,{width:s.imageWidth,height:s.imageHeight})})]}})})},t.prototype.getDefaultModelName=function(){return this.withSeparableConvs?gU:mU},t.prototype.extractParamsFromWeigthMap=function(e){return r.prototype.extractParamsFromWeigthMap.call(this,e)},t}(PR),EU=function(r){We(t,r);function t(){var e=r!==null&&r.apply(this,arguments)||this;return e._name="TinyFaceDetectorOptions",e}return t}(N0),sf=function(){function r(){}return r.prototype.then=function(t){return ke(this,void 0,void 0,function(){var e;return Oe(this,function(n){switch(n.label){case 0:return e=t,[4,this.run()];case 1:return[2,e.apply(void 0,[n.sent()])]}})})},r.prototype.run=function(){return ke(this,void 0,void 0,function(){return Oe(this,function(t){throw new Error("ComposableTask - run is not implemented")})})},r}();function cp(r,t,e,n,a){return a===void 0&&(a=function(i){var s=i.alignedRect;return s}),ke(this,void 0,void 0,function(){var i,s,l,c,f;return Oe(this,function(d){switch(d.label){case 0:return i=r.map(function(v){return TR(v)?a(v):v.detection}),l=n,l?[3,5]:t instanceof Mt?[4,C0(t,i)]:[3,2];case 1:return c=d.sent(),[3,4];case 2:return[4,E0(t,i)];case 3:c=d.sent(),d.label=4;case 4:l=c,d.label=5;case 5:return s=l,[4,e(s)];case 6:return f=d.sent(),s.forEach(function(v){return v instanceof Mt&&v.dispose()}),[2,f]}})})}function M0(r,t,e,n,a){return ke(this,void 0,void 0,function(){var i=this;return Oe(this,function(s){return[2,cp([r],t,function(l){return ke(i,void 0,void 0,function(){return Oe(this,function(c){return[2,e(l[0])]})})},n,a)]})})}function CU(r){return Se(function(){return vr(rn(r,3).reverse(),3)})}var Uh=2,Ld=12;function RU(r,t){var e=sp(r,t),n=R0(r,t);function a(f,d){var v=$t(r(f));return t.push({paramPath:d}),v}function i(f,d,v){v===void 0&&(v=!1);var m=e(f[0],f[1],3,d+"/conv1"),g=a(f[1],d+"/prelu1_alpha"),b=e(f[1],f[2],3,d+"/conv2"),w=a(f[2],d+"/prelu2_alpha"),_=e(f[2],f[3],v?2:3,d+"/conv3"),S=a(f[3],d+"/prelu3_alpha");return{conv1:m,prelu1_alpha:g,conv2:b,prelu2_alpha:w,conv3:_,prelu3_alpha:S}}function s(){var f=i([3,10,16,32],"pnet"),d=e(32,2,1,"pnet/conv4_1"),v=e(32,4,1,"pnet/conv4_2");return kn(kn({},f),{conv4_1:d,conv4_2:v})}function l(){var f=i([3,28,48,64],"rnet",!0),d=n(576,128,"rnet/fc1"),v=a(128,"rnet/prelu4_alpha"),m=n(128,2,"rnet/fc2_1"),g=n(128,4,"rnet/fc2_2");return kn(kn({},f),{fc1:d,prelu4_alpha:v,fc2_1:m,fc2_2:g})}function c(){var f=i([3,32,64,64],"onet"),d=e(64,128,2,"onet/conv4"),v=a(128,"onet/prelu4_alpha"),m=n(1152,256,"onet/fc1"),g=a(256,"onet/prelu5_alpha"),b=n(256,2,"onet/fc2_1"),w=n(256,4,"onet/fc2_2"),_=n(256,10,"onet/fc2_3");return kn(kn({},f),{conv4:d,prelu4_alpha:v,fc1:m,prelu5_alpha:g,fc2_1:b,fc2_2:w,fc2_3:_})}return{extractPNetParams:s,extractRNetParams:l,extractONetParams:c}}function TU(r){var t=di(r),e=t.extractWeights,n=t.getRemainingWeights,a=[],i=RU(e,a),s=i.extractPNetParams,l=i.extractRNetParams,c=i.extractONetParams,f=s(),d=l(),v=c();if(n().length!==0)throw new Error("weights remaing after extract: "+n().length);return{params:{pnet:f,rnet:d,onet:v},paramMappings:a}}function AU(r,t){var e=yo(r,t);function n(d){var v=e(d+"/weights",4,d+"/filters"),m=e(d+"/bias",1);return{filters:v,bias:m}}function a(d){var v=e(d+"/weights",2),m=e(d+"/bias",1);return{weights:v,bias:m}}function i(d){return e(d,1)}function s(d){var v=n(d+"/conv1"),m=i(d+"/prelu1_alpha"),g=n(d+"/conv2"),b=i(d+"/prelu2_alpha"),w=n(d+"/conv3"),_=i(d+"/prelu3_alpha");return{conv1:v,prelu1_alpha:m,conv2:g,prelu2_alpha:b,conv3:w,prelu3_alpha:_}}function l(){var d=s("pnet"),v=n("pnet/conv4_1"),m=n("pnet/conv4_2");return kn(kn({},d),{conv4_1:v,conv4_2:m})}function c(){var d=s("rnet"),v=a("rnet/fc1"),m=i("rnet/prelu4_alpha"),g=a("rnet/fc2_1"),b=a("rnet/fc2_2");return kn(kn({},d),{fc1:v,prelu4_alpha:m,fc2_1:g,fc2_2:b})}function f(){var d=s("onet"),v=n("onet/conv4"),m=i("onet/prelu4_alpha"),g=a("onet/fc1"),b=i("onet/prelu5_alpha"),w=a("onet/fc2_1"),_=a("onet/fc2_2"),S=a("onet/fc2_3");return kn(kn({},d),{conv4:v,prelu4_alpha:m,fc1:g,prelu5_alpha:b,fc2_1:w,fc2_2:_,fc2_3:S})}return{extractPNetParams:l,extractRNetParams:c,extractONetParams:f}}function DU(r){var t=[],e=AU(r,t),n=e.extractPNetParams,a=e.extractRNetParams,i=e.extractONetParams,s=n(),l=a(),c=i();return hi(r,t),{params:{pnet:s,rnet:l,onet:c},paramMappings:t}}function _y(r,t){var e=t[0],n=t[1];return{height:Math.floor(e*r),width:Math.floor(n*r)}}function kU(r,t,e){for(var n=e[0],a=e[1],i=Ld/r,s=[],l=Math.min(n,a)*i,c=0;l>=12;)s.push(i*Math.pow(t,c)),l=l*t,c+=1;return s}var I0=function(r){We(t,r);function t(e,n,a,i){return r.call(this,{left:e,top:n,right:a,bottom:i},!0)||this}return t}(Ca);function zR(r){return Se(function(){return Mn(on(r,ye(127.5)),ye(.0078125))})}function _u(r,t){return Se(function(){return nt(It(r),Mn(t,Od(It(Od(r)))))})}function F0(r,t,e){return e===void 0&&(e=!1),Se(function(){var n=$r(r,t.conv1,"valid");return n=_u(n,t.prelu1_alpha),n=hn(n,e?[2,2]:[3,3],[2,2],"same"),n=$r(n,t.conv2,"valid"),n=_u(n,t.prelu2_alpha),n=e?n:hn(n,[3,3],[2,2],"valid"),n=$r(n,t.conv3,"valid"),n=_u(n,t.prelu3_alpha),n})}function OU(r,t){return Se(function(){var e=F0(r,t,!0),n=$r(e,t.conv4_1,"valid"),a=kr(tp(n,3),3),i=li(on(n,a),3),s=$r(e,t.conv4_2,"valid");return{prob:i,regions:s}})}function NU(r,t){return Se(function(){var e=_y(t,r.shape.slice(1)),n=e.height,a=e.width,i=c0.resizeBilinear(r,[n,a]),s=zR(i);return po(s,[0,2,1,3])})}function MU(r,t,e,n){for(var a=[],i=r.arraySync(),s=0;s<r.shape[0];s++)for(var l=0;l<r.shape[1];l++)i[s][l]>=n&&a.push(new ht(l,s));var c=a.map(function(f){var d=new ip(Math.round((f.y*Uh+1)/e),Math.round((f.x*Uh+1)/e),Math.round((f.y*Uh+Ld)/e),Math.round((f.x*Uh+Ld)/e)),v=i[f.y][f.x],m=t.arraySync(),g=new I0(m[f.y][f.x][0],m[f.y][f.x][1],m[f.y][f.x][2],m[f.y][f.x][3]);return{cell:d,score:v,region:g}});return c}function IU(r,t,e,n,a){a.stage1=[];var i=t.map(function(m){return Se(function(){var g={scale:m},b=NU(r,m),w=Date.now(),_=OU(b,n),S=_.prob,E=_.regions;g.pnet=Date.now()-w;var C=rn(rn(S,3)[1])[0],R=rn(E)[0];return{scoresTensor:C,regionsTensor:R,scale:m,statsForScale:g}})}),s=i.map(function(m){var g=m.scoresTensor,b=m.regionsTensor,w=m.scale,_=m.statsForScale,S=MU(g,b,w,e);if(g.dispose(),b.dispose(),!S.length)return a.stage1.push(_),[];var E=Date.now(),C=zc(S.map(function(R){return R.cell}),S.map(function(R){return R.score}),.5);return _.nms=Date.now()-E,_.numBoxes=C.length,a.stage1.push(_),C.map(function(R){return S[R]})}),l=s.reduce(function(m,g){return m.concat(g)},[]),c=[],f=[];if(l.length>0){var d=Date.now(),v=zc(l.map(function(m){return m.cell}),l.map(function(m){return m.score}),.7);a.stage1_nms=Date.now()-d,f=v.map(function(m){return l[m].score}),c=v.map(function(m){return l[m]}).map(function(m){var g=m.cell,b=m.region;return new ip(g.left+b.left*g.width,g.top+b.top*g.height,g.right+b.right*g.width,g.bottom+b.bottom*g.height).toSquare().round()})}return{boxes:c,scores:f}}function UR(r,t,e){var n=e.width,a=e.height;return ke(this,void 0,void 0,function(){var i,s,l,c=this;return Oe(this,function(f){switch(f.label){case 0:return i=oi(r),[4,Promise.all(t.map(function(d){return ke(c,void 0,void 0,function(){var v,m,g,b,w,_,S,E;return Oe(this,function(C){return v=d.padAtBorders(r.height,r.width),m=v.y,g=v.ey,b=v.x,w=v.ex,_=b-1,S=m-1,E=i.getImageData(_,S,w-_,g-S),[2,Fn.isNodejs()?S0(E):createImageBitmap(E)]})})}))];case 1:return s=f.sent(),l=[],s.forEach(function(d){var v=op({width:n,height:a}),m=oi(v);m.drawImage(d,0,0,n,a);for(var g=m.getImageData(0,0,n,a).data,b=[],w=0;w<g.length;w+=4)b.push(g[w+2]),b.push(g[w+1]),b.push(g[w]);l.push(b)}),[2,l.map(function(d){var v=Se(function(){var m=po($n(d,[1,n,a,3]),[0,2,1,3]).toFloat();return zR(m)});return v})]}})})}function FU(r,t){return Se(function(){var e=F0(r,t),n=qr(e,[e.shape[0],t.fc1.weights.shape[0]]),a=ga(n,t.fc1),i=_u(a,t.prelu4_alpha),s=ga(i,t.fc2_1),l=kr(tp(s,1),1),c=li(on(s,l),1),f=ga(i,t.fc2_2),d=rn(c,1)[1];return{scores:d,regions:f}})}function BU(r,t,e,n,a){return ke(this,void 0,void 0,function(){var i,s,l,c,f,d,v,m,g,b,w,_,S,E;return Oe(this,function(C){switch(C.label){case 0:return i=Date.now(),[4,UR(r,t,{width:24,height:24})];case 1:return s=C.sent(),a.stage2_extractImagePatches=Date.now()-i,i=Date.now(),l=s.map(function(R){var T=FU(R,n);return R.dispose(),T}),a.stage2_rnet=Date.now()-i,c=l.length>1?nn(l.map(function(R){return R.scores})):l[0].scores,v=(d=Array).from,[4,c.data()];case 2:return f=v.apply(d,[C.sent()]),c.dispose(),m=f.map(function(R,T){return{score:R,idx:T}}).filter(function(R){return R.score>e}).map(function(R){var T=R.idx;return T}),g=m.map(function(R){return t[R]}),b=m.map(function(R){return f[R]}),w=[],_=[],g.length>0&&(i=Date.now(),S=zc(g,b,.7),a.stage2_nms=Date.now()-i,E=S.map(function(R){var T=l[m[R]].regions.arraySync();return new I0(T[0][0],T[0][1],T[0][2],T[0][3])}),_=S.map(function(R){return b[R]}),w=S.map(function(R,T){return g[R].calibrate(E[T])})),l.forEach(function(R){R.regions.dispose(),R.scores.dispose()}),[2,{boxes:w,scores:_}]}})})}function LU(r,t){return Se(function(){var e=F0(r,t);e=hn(e,[2,2],[2,2],"same"),e=$r(e,t.conv4,"valid"),e=_u(e,t.prelu4_alpha);var n=qr(e,[e.shape[0],t.fc1.weights.shape[0]]),a=ga(n,t.fc1),i=_u(a,t.prelu5_alpha),s=ga(i,t.fc2_1),l=kr(tp(s,1),1),c=li(on(s,l),1),f=ga(i,t.fc2_2),d=ga(i,t.fc2_3),v=rn(c,1)[1];return{scores:v,regions:f,points:d}})}function PU(r,t,e,n,a){return ke(this,void 0,void 0,function(){var i,s,l,c,f,d,v,m,g,b,w,_,S,E,C;return Oe(this,function(R){switch(R.label){case 0:return i=Date.now(),[4,UR(r,t,{width:48,height:48})];case 1:return s=R.sent(),a.stage3_extractImagePatches=Date.now()-i,i=Date.now(),l=s.map(function(T){var D=LU(T,n);return T.dispose(),D}),a.stage3_onet=Date.now()-i,c=l.length>1?nn(l.map(function(T){return T.scores})):l[0].scores,v=(d=Array).from,[4,c.data()];case 2:return f=v.apply(d,[R.sent()]),c.dispose(),m=f.map(function(T,D){return{score:T,idx:D}}).filter(function(T){return T.score>e}).map(function(T){var D=T.idx;return D}),g=m.map(function(T){var D=l[T].regions.arraySync();return new I0(D[0][0],D[0][1],D[0][2],D[0][3])}),b=m.map(function(T,D){return t[T].calibrate(g[D])}),w=m.map(function(T){return f[T]}),_=[],S=[],E=[],b.length>0&&(i=Date.now(),C=zc(b,w,.7,!1),a.stage3_nms=Date.now()-i,_=C.map(function(T){return b[T]}),S=C.map(function(T){return w[T]}),E=C.map(function(T,D){return Array(5).fill(0).map(function(k,M){var N=l[T].points.arraySync();return new ht(N[0][M]*(_[D].width+1)+_[D].left,N[0][M+5]*(_[D].height+1)+_[D].top)})})),l.forEach(function(T){T.regions.dispose(),T.scores.dispose(),T.points.dispose()}),[2,{boxes:_,scores:S,points:E}]}})})}var zU=function(r){We(t,r);function t(){return r.call(this,"Mtcnn")||this}return t.prototype.load=function(e){return ke(this,void 0,void 0,function(){return Oe(this,function(n){return console.warn("mtcnn is deprecated and will be removed soon"),[2,r.prototype.load.call(this,e)]})})},t.prototype.loadFromDisk=function(e){return ke(this,void 0,void 0,function(){return Oe(this,function(n){return console.warn("mtcnn is deprecated and will be removed soon"),[2,r.prototype.loadFromDisk.call(this,e)]})})},t.prototype.forwardInput=function(e,n){return n===void 0&&(n={}),ke(this,void 0,void 0,function(){var a,i,s,l,c,f,d,v,m,g,b,w,_,S,E,C,R,T,D,k,M;return Oe(this,function(N){switch(N.label){case 0:if(a=this.params,!a)throw new Error("Mtcnn - load model before inference");if(i=e.canvases[0],!i)throw new Error("Mtcnn - inputCanvas is not defined, note that passing tensors into Mtcnn.forwardInput is not supported yet.");return s={},l=Date.now(),c=Se(function(){return CU(kr(m0.fromPixels(i)).toFloat())}),f=function(I){return c.dispose(),s.total=Date.now()-l,I},d=c.shape.slice(1),v=d[0],m=d[1],g=new BR(n),b=g.minFaceSize,w=g.scaleFactor,_=g.maxNumScales,S=g.scoreThresholds,E=g.scaleSteps,C=(E||kU(b,w,[v,m])).filter(function(I){var z=_y(I,[v,m]);return Math.min(z.width,z.height)>Ld}).slice(0,_),s.scales=C,s.pyramid=C.map(function(I){return _y(I,[v,m])}),R=Date.now(),[4,IU(c,C,S[0],a.pnet,s)];case 1:return T=N.sent(),s.total_stage1=Date.now()-R,T.boxes.length?(s.stage2_numInputBoxes=T.boxes.length,R=Date.now(),[4,BU(i,T.boxes,S[1],a.rnet,s)]):[2,f({results:[],stats:s})];case 2:return D=N.sent(),s.total_stage2=Date.now()-R,D.boxes.length?(s.stage3_numInputBoxes=D.boxes.length,R=Date.now(),[4,PU(i,D.boxes,S[2],a.onet,s)]):[2,f({results:[],stats:s})];case 3:return k=N.sent(),s.total_stage3=Date.now()-R,M=k.boxes.map(function(I,z){return up(Hc({},new mr(k.scores[z],new b0(I.left/m,I.top/v,I.width/m,I.height/v),{height:v,width:m})),new pz(k.points[z].map(function(P){return P.sub(new ht(I.left,I.top)).div(new ht(I.width,I.height))}),{width:I.width,height:I.height}))}),[2,f({results:M,stats:s})]}})})},t.prototype.forward=function(e,n){return n===void 0&&(n={}),ke(this,void 0,void 0,function(){var a;return Oe(this,function(i){switch(i.label){case 0:return a=this.forwardInput,[4,mn(e)];case 1:return[4,a.apply(this,[i.sent(),n])];case 2:return[2,i.sent().results]}})})},t.prototype.forwardWithStats=function(e,n){return n===void 0&&(n={}),ke(this,void 0,void 0,function(){var a;return Oe(this,function(i){switch(i.label){case 0:return a=this.forwardInput,[4,mn(e)];case 1:return[2,a.apply(this,[i.sent(),n])]}})})},t.prototype.getDefaultModelName=function(){return"mtcnn_model"},t.prototype.extractParamsFromWeigthMap=function(e){return DU(e)},t.prototype.extractParams=function(e){return TU(e)},t}(fi),UU=.4,VU=[new ht(1.603231,2.094468),new ht(6.041143,7.080126),new ht(2.882459,3.518061),new ht(4.266906,5.178857),new ht(9.041765,10.66308)],HU=[117.001,114.697,97.404],jU=function(r){We(t,r);function t(){var e=this,n={withSeparableConvs:!0,iouThreshold:UU,classes:["face"],anchors:VU,meanRgb:HU,isFirstLayerConv2d:!0,filterSizes:[3,16,32,64,128,256,512]};return e=r.call(this,n)||this,e}return Object.defineProperty(t.prototype,"anchors",{get:function(){return this.config.anchors},enumerable:!0,configurable:!0}),t.prototype.locateFaces=function(e,n){return ke(this,void 0,void 0,function(){var a;return Oe(this,function(i){switch(i.label){case 0:return[4,this.detect(e,n)];case 1:return a=i.sent(),[2,a.map(function(s){return new mr(s.score,s.relativeBox,{width:s.imageWidth,height:s.imageHeight})})]}})})},t.prototype.getDefaultModelName=function(){return"tiny_face_detector_model"},t.prototype.extractParamsFromWeigthMap=function(e){return r.prototype.extractParamsFromWeigthMap.call(this,e)},t}(PR),Mr={ssdMobilenetv1:new LR,tinyFaceDetector:new jU,tinyYolov2:new SU,mtcnn:new zU,faceLandmark68Net:new kR,faceLandmark68TinyNet:new Wz,faceRecognitionNet:new Zz,faceExpressionNet:new kz,ageGenderNet:new Uz},VR=function(r){We(t,r);function t(e,n,a){var i=r.call(this)||this;return i.parentTask=e,i.input=n,i.extractedFaces=a,i}return t}(sf),B0=function(r){We(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.prototype.run=function(){return ke(this,void 0,void 0,function(){var e,n,a=this;return Oe(this,function(i){switch(i.label){case 0:return[4,this.parentTask];case 1:return e=i.sent(),[4,cp(e,this.input,function(s){return ke(a,void 0,void 0,function(){return Oe(this,function(l){switch(l.label){case 0:return[4,Promise.all(s.map(function(c){return Mr.faceExpressionNet.predictExpressions(c)}))];case 1:return[2,l.sent()]}})})},this.extractedFaces)];case 2:return n=i.sent(),[2,e.map(function(s,l){return RR(s,n[l])})]}})})},t.prototype.withAgeAndGender=function(){return new U0(this,this.input)},t}(VR),L0=function(r){We(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.prototype.run=function(){return ke(this,void 0,void 0,function(){var e,n;return Oe(this,function(a){switch(a.label){case 0:return[4,this.parentTask];case 1:return e=a.sent(),e?[4,M0(e,this.input,function(i){return Mr.faceExpressionNet.predictExpressions(i)},this.extractedFaces)]:[2];case 2:return n=a.sent(),[2,RR(e,n)]}})})},t.prototype.withAgeAndGender=function(){return new V0(this,this.input)},t}(VR),P0=function(r){We(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.prototype.withAgeAndGender=function(){return new H0(this,this.input)},t.prototype.withFaceDescriptors=function(){return new W0(this,this.input)},t}(B0),z0=function(r){We(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.prototype.withAgeAndGender=function(){return new j0(this,this.input)},t.prototype.withFaceDescriptor=function(){return new G0(this,this.input)},t}(L0),HR=function(r){We(t,r);function t(e,n,a){var i=r.call(this)||this;return i.parentTask=e,i.input=n,i.extractedFaces=a,i}return t}(sf),U0=function(r){We(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.prototype.run=function(){return ke(this,void 0,void 0,function(){var e,n,a=this;return Oe(this,function(i){switch(i.label){case 0:return[4,this.parentTask];case 1:return e=i.sent(),[4,cp(e,this.input,function(s){return ke(a,void 0,void 0,function(){return Oe(this,function(l){switch(l.label){case 0:return[4,Promise.all(s.map(function(c){return Mr.ageGenderNet.predictAgeAndGender(c)}))];case 1:return[2,l.sent()]}})})},this.extractedFaces)];case 2:return n=i.sent(),[2,e.map(function(s,l){var c=n[l],f=c.age,d=c.gender,v=c.genderProbability;return IR(FR(s,d,v),f)})]}})})},t.prototype.withFaceExpressions=function(){return new B0(this,this.input)},t}(HR),V0=function(r){We(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.prototype.run=function(){return ke(this,void 0,void 0,function(){var e,n,a,i,s;return Oe(this,function(l){switch(l.label){case 0:return[4,this.parentTask];case 1:return e=l.sent(),e?[4,M0(e,this.input,function(c){return Mr.ageGenderNet.predictAgeAndGender(c)},this.extractedFaces)]:[2];case 2:return n=l.sent(),a=n.age,i=n.gender,s=n.genderProbability,[2,IR(FR(e,i,s),a)]}})})},t.prototype.withFaceExpressions=function(){return new L0(this,this.input)},t}(HR),H0=function(r){We(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.prototype.withFaceExpressions=function(){return new P0(this,this.input)},t.prototype.withFaceDescriptors=function(){return new W0(this,this.input)},t}(U0),j0=function(r){We(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.prototype.withFaceExpressions=function(){return new z0(this,this.input)},t.prototype.withFaceDescriptor=function(){return new G0(this,this.input)},t}(V0),jR=function(r){We(t,r);function t(e,n){var a=r.call(this)||this;return a.parentTask=e,a.input=n,a}return t}(sf),W0=function(r){We(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.prototype.run=function(){return ke(this,void 0,void 0,function(){var e,n;return Oe(this,function(a){switch(a.label){case 0:return[4,this.parentTask];case 1:return e=a.sent(),[4,cp(e,this.input,function(i){return Promise.all(i.map(function(s){return Mr.faceRecognitionNet.computeFaceDescriptor(s)}))},null,function(i){return i.landmarks.align(null,{useDlibAlignment:!0})})];case 2:return n=a.sent(),[2,n.map(function(i,s){return MR(e[s],i)})]}})})},t.prototype.withFaceExpressions=function(){return new P0(this,this.input)},t.prototype.withAgeAndGender=function(){return new H0(this,this.input)},t}(jR),G0=function(r){We(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.prototype.run=function(){return ke(this,void 0,void 0,function(){var e,n;return Oe(this,function(a){switch(a.label){case 0:return[4,this.parentTask];case 1:return e=a.sent(),e?[4,M0(e,this.input,function(i){return Mr.faceRecognitionNet.computeFaceDescriptor(i)},null,function(i){return i.landmarks.align(null,{useDlibAlignment:!0})})]:[2];case 2:return n=a.sent(),[2,MR(e,n)]}})})},t.prototype.withFaceExpressions=function(){return new z0(this,this.input)},t.prototype.withAgeAndGender=function(){return new j0(this,this.input)},t}(jR),WR=function(r){We(t,r);function t(e,n,a){var i=r.call(this)||this;return i.parentTask=e,i.input=n,i.useTinyLandmarkNet=a,i}return Object.defineProperty(t.prototype,"landmarkNet",{get:function(){return this.useTinyLandmarkNet?Mr.faceLandmark68TinyNet:Mr.faceLandmark68Net},enumerable:!0,configurable:!0}),t}(sf),WU=function(r){We(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.prototype.run=function(){return ke(this,void 0,void 0,function(){var e,n,a,i,s,l=this;return Oe(this,function(c){switch(c.label){case 0:return[4,this.parentTask];case 1:return e=c.sent(),n=e.map(function(f){return f.detection}),this.input instanceof Mt?[4,C0(this.input,n)]:[3,3];case 2:return i=c.sent(),[3,5];case 3:return[4,E0(this.input,n)];case 4:i=c.sent(),c.label=5;case 5:return a=i,[4,Promise.all(a.map(function(f){return l.landmarkNet.detectLandmarks(f)}))];case 6:return s=c.sent(),a.forEach(function(f){return f instanceof Mt&&f.dispose()}),[2,e.map(function(f,d){return up(f,s[d])})]}})})},t.prototype.withFaceExpressions=function(){return new P0(this,this.input)},t.prototype.withAgeAndGender=function(){return new H0(this,this.input)},t.prototype.withFaceDescriptors=function(){return new W0(this,this.input)},t}(WR),GU=function(r){We(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.prototype.run=function(){return ke(this,void 0,void 0,function(){var e,n,a,i,s;return Oe(this,function(l){switch(l.label){case 0:return[4,this.parentTask];case 1:return e=l.sent(),e?(n=e.detection,this.input instanceof Mt?[4,C0(this.input,[n])]:[3,3]):[2];case 2:return i=l.sent(),[3,5];case 3:return[4,E0(this.input,[n])];case 4:i=l.sent(),l.label=5;case 5:return a=i,[4,this.landmarkNet.detectLandmarks(a[0])];case 6:return s=l.sent(),a.forEach(function(c){return c instanceof Mt&&c.dispose()}),[2,up(e,s)]}})})},t.prototype.withFaceExpressions=function(){return new z0(this,this.input)},t.prototype.withAgeAndGender=function(){return new j0(this,this.input)},t.prototype.withFaceDescriptor=function(){return new G0(this,this.input)},t}(WR),GR=function(r){We(t,r);function t(e,n){n===void 0&&(n=new lp);var a=r.call(this)||this;return a.input=e,a.options=n,a}return t}(sf),qR=function(r){We(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.prototype.run=function(){return ke(this,void 0,void 0,function(){var e,n,a,i;return Oe(this,function(s){switch(s.label){case 0:return e=this,n=e.input,a=e.options,a instanceof BR?[4,Mr.mtcnn.forward(n,a)]:[3,2];case 1:return[2,s.sent().map(function(l){return l.detection})];case 2:if(i=a instanceof EU?function(l){return Mr.tinyFaceDetector.locateFaces(l,a)}:a instanceof lp?function(l){return Mr.ssdMobilenetv1.locateFaces(l,a)}:a instanceof N0?function(l){return Mr.tinyYolov2.locateFaces(l,a)}:null,!i)throw new Error("detectFaces - expected options to be instance of TinyFaceDetectorOptions | SsdMobilenetv1Options | MtcnnOptions | TinyYolov2Options");return[2,i(n)]}})})},t.prototype.runAndExtendWithFaceDetections=function(){var e=this;return new Promise(function(n){return ke(e,void 0,void 0,function(){var a;return Oe(this,function(i){switch(i.label){case 0:return[4,this.run()];case 1:return a=i.sent(),[2,n(a.map(function(s){return Hc({},s)}))]}})})})},t.prototype.withFaceLandmarks=function(e){return e===void 0&&(e=!1),new WU(this.runAndExtendWithFaceDetections(),this.input,e)},t.prototype.withFaceExpressions=function(){return new B0(this.runAndExtendWithFaceDetections(),this.input)},t.prototype.withAgeAndGender=function(){return new U0(this.runAndExtendWithFaceDetections(),this.input)},t}(GR);(function(r){We(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.prototype.run=function(){return ke(this,void 0,void 0,function(){var e,n;return Oe(this,function(a){switch(a.label){case 0:return[4,new qR(this.input,this.options)];case 1:return e=a.sent(),n=e[0],e.forEach(function(i){i.score>n.score&&(n=i)}),[2,n]}})})},t.prototype.runAndExtendWithFaceDetection=function(){var e=this;return new Promise(function(n){return ke(e,void 0,void 0,function(){var a;return Oe(this,function(i){switch(i.label){case 0:return[4,this.run()];case 1:return a=i.sent(),[2,n(a?Hc({},a):void 0)]}})})})},t.prototype.withFaceLandmarks=function(e){return e===void 0&&(e=!1),new GU(this.runAndExtendWithFaceDetection(),this.input,e)},t.prototype.withFaceExpressions=function(){return new L0(this.runAndExtendWithFaceDetection(),this.input)},t.prototype.withAgeAndGender=function(){return new V0(this.runAndExtendWithFaceDetection(),this.input)},t})(GR);function S6(r,t){return t===void 0&&(t=new lp),new qR(r,t)}function qU(r,t){if(r.length!==t.length)throw new Error("euclideanDistance: arr1.length !== arr2.length");var e=Array.from(r),n=Array.from(t);return Math.sqrt(e.map(function(a,i){return a-n[i]}).reduce(function(a,i){return a+Math.pow(i,2)},0))}(function(){function r(t,e){e===void 0&&(e=.6),this._distanceThreshold=e;var n=Array.isArray(t)?t:[t];if(!n.length)throw new Error("FaceRecognizer.constructor - expected atleast one input");var a=1,i=function(){return"person "+a++};this._labeledDescriptors=n.map(function(s){if(s instanceof Bh)return s;if(s instanceof Float32Array)return new Bh(i(),[s]);if(s.descriptor&&s.descriptor instanceof Float32Array)return new Bh(i(),[s.descriptor]);throw new Error("FaceRecognizer.constructor - expected inputs to be of type LabeledFaceDescriptors | WithFaceDescriptor<any> | Float32Array | Array<LabeledFaceDescriptors | WithFaceDescriptor<any> | Float32Array>")})}return Object.defineProperty(r.prototype,"labeledDescriptors",{get:function(){return this._labeledDescriptors},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"distanceThreshold",{get:function(){return this._distanceThreshold},enumerable:!0,configurable:!0}),r.prototype.computeMeanDistance=function(t,e){return e.map(function(n){return qU(n,t)}).reduce(function(n,a){return n+a},0)/(e.length||1)},r.prototype.matchDescriptor=function(t){var e=this;return this.labeledDescriptors.map(function(n){var a=n.descriptors,i=n.label;return new j_(i,e.computeMeanDistance(t,a))}).reduce(function(n,a){return n.distance<a.distance?n:a})},r.prototype.findBestMatch=function(t){var e=this.matchDescriptor(t);return e.distance<this.distanceThreshold?e:new j_("unknown",e.distance)},r.prototype.toJSON=function(){return{distanceThreshold:this.distanceThreshold,labeledDescriptors:this.labeledDescriptors.map(function(t){return t.toJSON()})}},r.fromJSON=function(t){var e=t.labeledDescriptors.map(function(n){return Bh.fromJSON(n)});return new r(e,t.distanceThreshold)},r})();function KU(r,t){var e=new es(t.width,t.height),n=e.width,a=e.height;if(n<=0||a<=0)throw new Error("resizeResults - invalid dimensions: "+JSON.stringify({width:n,height:a}));if(Array.isArray(r))return r.map(function(l){return KU(l,{width:n,height:a})});if(TR(r)){var i=r.detection.forSize(n,a),s=r.unshiftedLandmarks.forSize(i.box.width,i.box.height);return up(Hc(r,i),s)}return Vc(r)?Hc(r,r.detection.forSize(n,a)):r instanceof Uc||r instanceof mr?r.forSize(n,a):r}var oc={},X_;function XU(){if(X_)return oc;X_=1,Object.defineProperty(oc,"__esModule",{value:!0}),oc.styleq=void 0;var r=new WeakMap,t="$$css";function e(a){var i,s,l;return a!=null&&(i=a.disableCache===!0,s=a.disableMix===!0,l=a.transform),function(){for(var f=[],d="",v=null,m="",g=i?null:r,b=new Array(arguments.length),w=0;w<arguments.length;w++)b[w]=arguments[w];for(;b.length>0;){var _=b.pop();if(!(_==null||_===!1)){if(Array.isArray(_)){for(var S=0;S<_.length;S++)b.push(_[S]);continue}var E=l!=null?l(_):_;if(E.$$css!=null){var C="";if(g!=null&&g.has(E)){var R=g.get(E);R!=null&&(C=R[0],m=R[2],f.push.apply(f,R[1]),g=R[3])}else{var T=[];for(var D in E){var k=E[D];if(D===t){var M=E[D];M!==!0&&(m=m?M+"; "+m:M);continue}typeof k=="string"||k===null?f.includes(D)||(f.push(D),g!=null&&T.push(D),typeof k=="string"&&(C+=C?" "+k:k)):console.error("styleq: ".concat(D," typeof ").concat(String(k),' is not "string" or "null".'))}if(g!=null){var N=new WeakMap;g.set(E,[C,T,m,N]),g=N}}C&&(d=d?C+" "+d:C)}else if(s)v==null&&(v={}),v=Object.assign({},E,v);else{var I=null;for(var z in E){var P=E[z];P!==void 0&&(f.includes(z)||(P!=null&&(v==null&&(v={}),I==null&&(I={}),I[z]=P),f.push(z),g=null))}I!=null&&(v=Object.assign(I,v))}}}var ne=[d,v,m];return ne}}var n=oc.styleq=e();return n.factory=e,oc}var $U=XU();function E6(){for(var r=arguments.length,t=new Array(r),e=0;e<r;e++)t[e]=arguments[e];const[n,a,i]=$U.styleq(t),s={};return n!=null&&n!==""&&(s.className=n),a!=null&&Object.keys(a).length>0&&(s.style=a),i!=null&&i!==""&&(s["data-style-src"]=i),s}export{Zn as A,E6 as B,a6 as C,c6 as D,r6 as E,iO as F,o6 as G,d6 as H,m6 as I,QU as J,u6 as Q,mE as R,EU as T,v6 as a,p6 as b,g6 as c,vk as d,g3 as e,t6 as f,i6 as g,h6 as h,Un as i,uD as j,f6 as k,ky as l,n6 as m,JU as n,e6 as o,y6 as p,s6 as q,Z as r,Mr as s,w6 as t,US as u,S6 as v,KU as w,x6 as x,_6 as y,b6 as z};
