var uw=r=>{throw TypeError(r)};var Zv=(r,t,e)=>t.has(r)||uw("Cannot "+e);var H=(r,t,e)=>(Zv(r,t,"read from private field"),e?e.call(r):t.get(r)),Fe=(r,t,e)=>t.has(r)?uw("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(r):t.set(r,e),we=(r,t,e,n)=>(Zv(r,t,"write to private field"),n?n.call(r,e):t.set(r,e),e),$e=(r,t,e)=>(Zv(r,t,"access private method"),e);var Yf=(r,t,e,n)=>({set _(a){we(r,t,a,e)},get _(){return H(r,t,n)}});import{g as q_}from"./index-C8-fqYjH.js";var Jv={exports:{}},zl={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var lw;function UT(){if(lw)return zl;lw=1;var r=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function e(n,a,i){var s=null;if(i!==void 0&&(s=""+i),a.key!==void 0&&(s=""+a.key),"key"in a){i={};for(var l in a)l!=="key"&&(i[l]=a[l])}else i=a;return a=i.ref,{$$typeof:r,type:n,key:s,ref:a!==void 0?a:null,props:i}}return zl.Fragment=t,zl.jsx=e,zl.jsxs=e,zl}var cw;function VT(){return cw||(cw=1,Jv.exports=UT()),Jv.exports}var HT=VT(),em={exports:{}},Ul={},tm={exports:{}},nm={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var fw;function jT(){return fw||(fw=1,function(r){function t(P,W){var X=P.length;P.push(W);e:for(;0<X;){var re=X-1>>>1,F=P[re];if(0<a(F,W))P[re]=W,P[X]=F,X=re;else break e}}function e(P){return P.length===0?null:P[0]}function n(P){if(P.length===0)return null;var W=P[0],X=P.pop();if(X!==W){P[0]=X;e:for(var re=0,F=P.length,q=F>>>1;re<q;){var oe=2*(re+1)-1,se=P[oe],pe=oe+1,ge=P[pe];if(0>a(se,X))pe<F&&0>a(ge,se)?(P[re]=ge,P[pe]=X,re=pe):(P[re]=se,P[oe]=X,re=oe);else if(pe<F&&0>a(ge,X))P[re]=ge,P[pe]=X,re=pe;else break e}}return W}function a(P,W){var X=P.sortIndex-W.sortIndex;return X!==0?X:P.id-W.id}if(r.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var i=performance;r.unstable_now=function(){return i.now()}}else{var s=Date,l=s.now();r.unstable_now=function(){return s.now()-l}}var c=[],f=[],d=1,v=null,m=3,g=!1,b=!1,w=!1,_=!1,S=typeof setTimeout=="function"?setTimeout:null,E=typeof clearTimeout=="function"?clearTimeout:null,C=typeof setImmediate<"u"?setImmediate:null;function R(P){for(var W=e(f);W!==null;){if(W.callback===null)n(f);else if(W.startTime<=P)n(f),W.sortIndex=W.expirationTime,t(c,W);else break;W=e(f)}}function A(P){if(w=!1,R(P),!b)if(e(c)!==null)b=!0,D||(D=!0,z());else{var W=e(f);W!==null&&ne(A,W.startTime-P)}}var D=!1,k=-1,I=5,O=-1;function M(){return _?!0:!(r.unstable_now()-O<I)}function V(){if(_=!1,D){var P=r.unstable_now();O=P;var W=!0;try{e:{b=!1,w&&(w=!1,E(k),k=-1),g=!0;var X=m;try{t:{for(R(P),v=e(c);v!==null&&!(v.expirationTime>P&&M());){var re=v.callback;if(typeof re=="function"){v.callback=null,m=v.priorityLevel;var F=re(v.expirationTime<=P);if(P=r.unstable_now(),typeof F=="function"){v.callback=F,R(P),W=!0;break t}v===e(c)&&n(c),R(P)}else n(c);v=e(c)}if(v!==null)W=!0;else{var q=e(f);q!==null&&ne(A,q.startTime-P),W=!1}}break e}finally{v=null,m=X,g=!1}W=void 0}}finally{W?z():D=!1}}}var z;if(typeof C=="function")z=function(){C(V)};else if(typeof MessageChannel<"u"){var J=new MessageChannel,te=J.port2;J.port1.onmessage=V,z=function(){te.postMessage(null)}}else z=function(){S(V,0)};function ne(P,W){k=S(function(){P(r.unstable_now())},W)}r.unstable_IdlePriority=5,r.unstable_ImmediatePriority=1,r.unstable_LowPriority=4,r.unstable_NormalPriority=3,r.unstable_Profiling=null,r.unstable_UserBlockingPriority=2,r.unstable_cancelCallback=function(P){P.callback=null},r.unstable_forceFrameRate=function(P){0>P||125<P?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):I=0<P?Math.floor(1e3/P):5},r.unstable_getCurrentPriorityLevel=function(){return m},r.unstable_next=function(P){switch(m){case 1:case 2:case 3:var W=3;break;default:W=m}var X=m;m=W;try{return P()}finally{m=X}},r.unstable_requestPaint=function(){_=!0},r.unstable_runWithPriority=function(P,W){switch(P){case 1:case 2:case 3:case 4:case 5:break;default:P=3}var X=m;m=P;try{return W()}finally{m=X}},r.unstable_scheduleCallback=function(P,W,X){var re=r.unstable_now();switch(typeof X=="object"&&X!==null?(X=X.delay,X=typeof X=="number"&&0<X?re+X:re):X=re,P){case 1:var F=-1;break;case 2:F=250;break;case 5:F=1073741823;break;case 4:F=1e4;break;default:F=5e3}return F=X+F,P={id:d++,callback:W,priorityLevel:P,startTime:X,expirationTime:F,sortIndex:-1},X>re?(P.sortIndex=X,t(f,P),e(c)===null&&P===e(f)&&(w?(E(k),k=-1):w=!0,ne(A,X-re))):(P.sortIndex=F,t(c,P),b||g||(b=!0,D||(D=!0,z()))),P},r.unstable_shouldYield=M,r.unstable_wrapCallback=function(P){var W=m;return function(){var X=m;m=W;try{return P.apply(this,arguments)}finally{m=X}}}}(nm)),nm}var hw;function WT(){return hw||(hw=1,tm.exports=jT()),tm.exports}var rm={exports:{}},Ke={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var dw;function GT(){if(dw)return Ke;dw=1;var r=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),e=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),i=Symbol.for("react.consumer"),s=Symbol.for("react.context"),l=Symbol.for("react.forward_ref"),c=Symbol.for("react.suspense"),f=Symbol.for("react.memo"),d=Symbol.for("react.lazy"),v=Symbol.iterator;function m(F){return F===null||typeof F!="object"?null:(F=v&&F[v]||F["@@iterator"],typeof F=="function"?F:null)}var g={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},b=Object.assign,w={};function _(F,q,oe){this.props=F,this.context=q,this.refs=w,this.updater=oe||g}_.prototype.isReactComponent={},_.prototype.setState=function(F,q){if(typeof F!="object"&&typeof F!="function"&&F!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,F,q,"setState")},_.prototype.forceUpdate=function(F){this.updater.enqueueForceUpdate(this,F,"forceUpdate")};function S(){}S.prototype=_.prototype;function E(F,q,oe){this.props=F,this.context=q,this.refs=w,this.updater=oe||g}var C=E.prototype=new S;C.constructor=E,b(C,_.prototype),C.isPureReactComponent=!0;var R=Array.isArray,A={H:null,A:null,T:null,S:null,V:null},D=Object.prototype.hasOwnProperty;function k(F,q,oe,se,pe,ge){return oe=ge.ref,{$$typeof:r,type:F,key:q,ref:oe!==void 0?oe:null,props:ge}}function I(F,q){return k(F.type,q,void 0,void 0,void 0,F.props)}function O(F){return typeof F=="object"&&F!==null&&F.$$typeof===r}function M(F){var q={"=":"=0",":":"=2"};return"$"+F.replace(/[=:]/g,function(oe){return q[oe]})}var V=/\/+/g;function z(F,q){return typeof F=="object"&&F!==null&&F.key!=null?M(""+F.key):q.toString(36)}function J(){}function te(F){switch(F.status){case"fulfilled":return F.value;case"rejected":throw F.reason;default:switch(typeof F.status=="string"?F.then(J,J):(F.status="pending",F.then(function(q){F.status==="pending"&&(F.status="fulfilled",F.value=q)},function(q){F.status==="pending"&&(F.status="rejected",F.reason=q)})),F.status){case"fulfilled":return F.value;case"rejected":throw F.reason}}throw F}function ne(F,q,oe,se,pe){var ge=typeof F;(ge==="undefined"||ge==="boolean")&&(F=null);var ve=!1;if(F===null)ve=!0;else switch(ge){case"bigint":case"string":case"number":ve=!0;break;case"object":switch(F.$$typeof){case r:case t:ve=!0;break;case d:return ve=F._init,ne(ve(F._payload),q,oe,se,pe)}}if(ve)return pe=pe(F),ve=se===""?"."+z(F,0):se,R(pe)?(oe="",ve!=null&&(oe=ve.replace(V,"$&/")+"/"),ne(pe,q,oe,"",function(Ie){return Ie})):pe!=null&&(O(pe)&&(pe=I(pe,oe+(pe.key==null||F&&F.key===pe.key?"":(""+pe.key).replace(V,"$&/")+"/")+ve)),q.push(pe)),1;ve=0;var Ne=se===""?".":se+":";if(R(F))for(var be=0;be<F.length;be++)se=F[be],ge=Ne+z(se,be),ve+=ne(se,q,oe,ge,pe);else if(be=m(F),typeof be=="function")for(F=be.call(F),be=0;!(se=F.next()).done;)se=se.value,ge=Ne+z(se,be++),ve+=ne(se,q,oe,ge,pe);else if(ge==="object"){if(typeof F.then=="function")return ne(te(F),q,oe,se,pe);throw q=String(F),Error("Objects are not valid as a React child (found: "+(q==="[object Object]"?"object with keys {"+Object.keys(F).join(", ")+"}":q)+"). If you meant to render a collection of children, use an array instead.")}return ve}function P(F,q,oe){if(F==null)return F;var se=[],pe=0;return ne(F,se,"","",function(ge){return q.call(oe,ge,pe++)}),se}function W(F){if(F._status===-1){var q=F._result;q=q(),q.then(function(oe){(F._status===0||F._status===-1)&&(F._status=1,F._result=oe)},function(oe){(F._status===0||F._status===-1)&&(F._status=2,F._result=oe)}),F._status===-1&&(F._status=0,F._result=q)}if(F._status===1)return F._result.default;throw F._result}var X=typeof reportError=="function"?reportError:function(F){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var q=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof F=="object"&&F!==null&&typeof F.message=="string"?String(F.message):String(F),error:F});if(!window.dispatchEvent(q))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",F);return}console.error(F)};function re(){}return Ke.Children={map:P,forEach:function(F,q,oe){P(F,function(){q.apply(this,arguments)},oe)},count:function(F){var q=0;return P(F,function(){q++}),q},toArray:function(F){return P(F,function(q){return q})||[]},only:function(F){if(!O(F))throw Error("React.Children.only expected to receive a single React element child.");return F}},Ke.Component=_,Ke.Fragment=e,Ke.Profiler=a,Ke.PureComponent=E,Ke.StrictMode=n,Ke.Suspense=c,Ke.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=A,Ke.__COMPILER_RUNTIME={__proto__:null,c:function(F){return A.H.useMemoCache(F)}},Ke.cache=function(F){return function(){return F.apply(null,arguments)}},Ke.cloneElement=function(F,q,oe){if(F==null)throw Error("The argument must be a React element, but you passed "+F+".");var se=b({},F.props),pe=F.key,ge=void 0;if(q!=null)for(ve in q.ref!==void 0&&(ge=void 0),q.key!==void 0&&(pe=""+q.key),q)!D.call(q,ve)||ve==="key"||ve==="__self"||ve==="__source"||ve==="ref"&&q.ref===void 0||(se[ve]=q[ve]);var ve=arguments.length-2;if(ve===1)se.children=oe;else if(1<ve){for(var Ne=Array(ve),be=0;be<ve;be++)Ne[be]=arguments[be+2];se.children=Ne}return k(F.type,pe,void 0,void 0,ge,se)},Ke.createContext=function(F){return F={$$typeof:s,_currentValue:F,_currentValue2:F,_threadCount:0,Provider:null,Consumer:null},F.Provider=F,F.Consumer={$$typeof:i,_context:F},F},Ke.createElement=function(F,q,oe){var se,pe={},ge=null;if(q!=null)for(se in q.key!==void 0&&(ge=""+q.key),q)D.call(q,se)&&se!=="key"&&se!=="__self"&&se!=="__source"&&(pe[se]=q[se]);var ve=arguments.length-2;if(ve===1)pe.children=oe;else if(1<ve){for(var Ne=Array(ve),be=0;be<ve;be++)Ne[be]=arguments[be+2];pe.children=Ne}if(F&&F.defaultProps)for(se in ve=F.defaultProps,ve)pe[se]===void 0&&(pe[se]=ve[se]);return k(F,ge,void 0,void 0,null,pe)},Ke.createRef=function(){return{current:null}},Ke.forwardRef=function(F){return{$$typeof:l,render:F}},Ke.isValidElement=O,Ke.lazy=function(F){return{$$typeof:d,_payload:{_status:-1,_result:F},_init:W}},Ke.memo=function(F,q){return{$$typeof:f,type:F,compare:q===void 0?null:q}},Ke.startTransition=function(F){var q=A.T,oe={};A.T=oe;try{var se=F(),pe=A.S;pe!==null&&pe(oe,se),typeof se=="object"&&se!==null&&typeof se.then=="function"&&se.then(re,X)}catch(ge){X(ge)}finally{A.T=q}},Ke.unstable_useCacheRefresh=function(){return A.H.useCacheRefresh()},Ke.use=function(F){return A.H.use(F)},Ke.useActionState=function(F,q,oe){return A.H.useActionState(F,q,oe)},Ke.useCallback=function(F,q){return A.H.useCallback(F,q)},Ke.useContext=function(F){return A.H.useContext(F)},Ke.useDebugValue=function(){},Ke.useDeferredValue=function(F,q){return A.H.useDeferredValue(F,q)},Ke.useEffect=function(F,q,oe){var se=A.H;if(typeof oe=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return se.useEffect(F,q)},Ke.useId=function(){return A.H.useId()},Ke.useImperativeHandle=function(F,q,oe){return A.H.useImperativeHandle(F,q,oe)},Ke.useInsertionEffect=function(F,q){return A.H.useInsertionEffect(F,q)},Ke.useLayoutEffect=function(F,q){return A.H.useLayoutEffect(F,q)},Ke.useMemo=function(F,q){return A.H.useMemo(F,q)},Ke.useOptimistic=function(F,q){return A.H.useOptimistic(F,q)},Ke.useReducer=function(F,q,oe){return A.H.useReducer(F,q,oe)},Ke.useRef=function(F){return A.H.useRef(F)},Ke.useState=function(F){return A.H.useState(F)},Ke.useSyncExternalStore=function(F,q,oe){return A.H.useSyncExternalStore(F,q,oe)},Ke.useTransition=function(){return A.H.useTransition()},Ke.version="19.1.0",Ke}var pw;function Yg(){return pw||(pw=1,rm.exports=GT()),rm.exports}var am={exports:{}},An={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var vw;function qT(){if(vw)return An;vw=1;var r=Yg();function t(c){var f="https://react.dev/errors/"+c;if(1<arguments.length){f+="?args[]="+encodeURIComponent(arguments[1]);for(var d=2;d<arguments.length;d++)f+="&args[]="+encodeURIComponent(arguments[d])}return"Minified React error #"+c+"; visit "+f+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function e(){}var n={d:{f:e,r:function(){throw Error(t(522))},D:e,C:e,L:e,m:e,X:e,S:e,M:e},p:0,findDOMNode:null},a=Symbol.for("react.portal");function i(c,f,d){var v=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:a,key:v==null?null:""+v,children:c,containerInfo:f,implementation:d}}var s=r.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function l(c,f){if(c==="font")return"";if(typeof f=="string")return f==="use-credentials"?f:""}return An.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=n,An.createPortal=function(c,f){var d=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!f||f.nodeType!==1&&f.nodeType!==9&&f.nodeType!==11)throw Error(t(299));return i(c,f,null,d)},An.flushSync=function(c){var f=s.T,d=n.p;try{if(s.T=null,n.p=2,c)return c()}finally{s.T=f,n.p=d,n.d.f()}},An.preconnect=function(c,f){typeof c=="string"&&(f?(f=f.crossOrigin,f=typeof f=="string"?f==="use-credentials"?f:"":void 0):f=null,n.d.C(c,f))},An.prefetchDNS=function(c){typeof c=="string"&&n.d.D(c)},An.preinit=function(c,f){if(typeof c=="string"&&f&&typeof f.as=="string"){var d=f.as,v=l(d,f.crossOrigin),m=typeof f.integrity=="string"?f.integrity:void 0,g=typeof f.fetchPriority=="string"?f.fetchPriority:void 0;d==="style"?n.d.S(c,typeof f.precedence=="string"?f.precedence:void 0,{crossOrigin:v,integrity:m,fetchPriority:g}):d==="script"&&n.d.X(c,{crossOrigin:v,integrity:m,fetchPriority:g,nonce:typeof f.nonce=="string"?f.nonce:void 0})}},An.preinitModule=function(c,f){if(typeof c=="string")if(typeof f=="object"&&f!==null){if(f.as==null||f.as==="script"){var d=l(f.as,f.crossOrigin);n.d.M(c,{crossOrigin:d,integrity:typeof f.integrity=="string"?f.integrity:void 0,nonce:typeof f.nonce=="string"?f.nonce:void 0})}}else f==null&&n.d.M(c)},An.preload=function(c,f){if(typeof c=="string"&&typeof f=="object"&&f!==null&&typeof f.as=="string"){var d=f.as,v=l(d,f.crossOrigin);n.d.L(c,d,{crossOrigin:v,integrity:typeof f.integrity=="string"?f.integrity:void 0,nonce:typeof f.nonce=="string"?f.nonce:void 0,type:typeof f.type=="string"?f.type:void 0,fetchPriority:typeof f.fetchPriority=="string"?f.fetchPriority:void 0,referrerPolicy:typeof f.referrerPolicy=="string"?f.referrerPolicy:void 0,imageSrcSet:typeof f.imageSrcSet=="string"?f.imageSrcSet:void 0,imageSizes:typeof f.imageSizes=="string"?f.imageSizes:void 0,media:typeof f.media=="string"?f.media:void 0})}},An.preloadModule=function(c,f){if(typeof c=="string")if(f){var d=l(f.as,f.crossOrigin);n.d.m(c,{as:typeof f.as=="string"&&f.as!=="script"?f.as:void 0,crossOrigin:d,integrity:typeof f.integrity=="string"?f.integrity:void 0})}else n.d.m(c)},An.requestFormReset=function(c){n.d.r(c)},An.unstable_batchedUpdates=function(c,f){return c(f)},An.useFormState=function(c,f,d){return s.H.useFormState(c,f,d)},An.useFormStatus=function(){return s.H.useHostTransitionStatus()},An.version="19.1.0",An}var mw;function KT(){if(mw)return am.exports;mw=1;function r(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(r)}catch(t){console.error(t)}}return r(),am.exports=qT(),am.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var gw;function XT(){if(gw)return Ul;gw=1;var r=WT(),t=Yg(),e=KT();function n(o){var u="https://react.dev/errors/"+o;if(1<arguments.length){u+="?args[]="+encodeURIComponent(arguments[1]);for(var h=2;h<arguments.length;h++)u+="&args[]="+encodeURIComponent(arguments[h])}return"Minified React error #"+o+"; visit "+u+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(o){return!(!o||o.nodeType!==1&&o.nodeType!==9&&o.nodeType!==11)}function i(o){var u=o,h=o;if(o.alternate)for(;u.return;)u=u.return;else{o=u;do u=o,(u.flags&4098)!==0&&(h=u.return),o=u.return;while(o)}return u.tag===3?h:null}function s(o){if(o.tag===13){var u=o.memoizedState;if(u===null&&(o=o.alternate,o!==null&&(u=o.memoizedState)),u!==null)return u.dehydrated}return null}function l(o){if(i(o)!==o)throw Error(n(188))}function c(o){var u=o.alternate;if(!u){if(u=i(o),u===null)throw Error(n(188));return u!==o?null:o}for(var h=o,p=u;;){var y=h.return;if(y===null)break;var x=y.alternate;if(x===null){if(p=y.return,p!==null){h=p;continue}break}if(y.child===x.child){for(x=y.child;x;){if(x===h)return l(y),o;if(x===p)return l(y),u;x=x.sibling}throw Error(n(188))}if(h.return!==p.return)h=y,p=x;else{for(var T=!1,N=y.child;N;){if(N===h){T=!0,h=y,p=x;break}if(N===p){T=!0,p=y,h=x;break}N=N.sibling}if(!T){for(N=x.child;N;){if(N===h){T=!0,h=x,p=y;break}if(N===p){T=!0,p=x,h=y;break}N=N.sibling}if(!T)throw Error(n(189))}}if(h.alternate!==p)throw Error(n(190))}if(h.tag!==3)throw Error(n(188));return h.stateNode.current===h?o:u}function f(o){var u=o.tag;if(u===5||u===26||u===27||u===6)return o;for(o=o.child;o!==null;){if(u=f(o),u!==null)return u;o=o.sibling}return null}var d=Object.assign,v=Symbol.for("react.element"),m=Symbol.for("react.transitional.element"),g=Symbol.for("react.portal"),b=Symbol.for("react.fragment"),w=Symbol.for("react.strict_mode"),_=Symbol.for("react.profiler"),S=Symbol.for("react.provider"),E=Symbol.for("react.consumer"),C=Symbol.for("react.context"),R=Symbol.for("react.forward_ref"),A=Symbol.for("react.suspense"),D=Symbol.for("react.suspense_list"),k=Symbol.for("react.memo"),I=Symbol.for("react.lazy"),O=Symbol.for("react.activity"),M=Symbol.for("react.memo_cache_sentinel"),V=Symbol.iterator;function z(o){return o===null||typeof o!="object"?null:(o=V&&o[V]||o["@@iterator"],typeof o=="function"?o:null)}var J=Symbol.for("react.client.reference");function te(o){if(o==null)return null;if(typeof o=="function")return o.$$typeof===J?null:o.displayName||o.name||null;if(typeof o=="string")return o;switch(o){case b:return"Fragment";case _:return"Profiler";case w:return"StrictMode";case A:return"Suspense";case D:return"SuspenseList";case O:return"Activity"}if(typeof o=="object")switch(o.$$typeof){case g:return"Portal";case C:return(o.displayName||"Context")+".Provider";case E:return(o._context.displayName||"Context")+".Consumer";case R:var u=o.render;return o=o.displayName,o||(o=u.displayName||u.name||"",o=o!==""?"ForwardRef("+o+")":"ForwardRef"),o;case k:return u=o.displayName||null,u!==null?u:te(o.type)||"Memo";case I:u=o._payload,o=o._init;try{return te(o(u))}catch{}}return null}var ne=Array.isArray,P=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,W=e.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,X={pending:!1,data:null,method:null,action:null},re=[],F=-1;function q(o){return{current:o}}function oe(o){0>F||(o.current=re[F],re[F]=null,F--)}function se(o,u){F++,re[F]=o.current,o.current=u}var pe=q(null),ge=q(null),ve=q(null),Ne=q(null);function be(o,u){switch(se(ve,u),se(ge,o),se(pe,null),u.nodeType){case 9:case 11:o=(o=u.documentElement)&&(o=o.namespaceURI)?Bx(o):0;break;default:if(o=u.tagName,u=u.namespaceURI)u=Bx(u),o=Lx(u,o);else switch(o){case"svg":o=1;break;case"math":o=2;break;default:o=0}}oe(pe),se(pe,o)}function Ie(){oe(pe),oe(ge),oe(ve)}function lt(o){o.memoizedState!==null&&se(Ne,o);var u=pe.current,h=Lx(u,o.type);u!==h&&(se(ge,o),se(pe,h))}function Pe(o){ge.current===o&&(oe(pe),oe(ge)),Ne.current===o&&(oe(Ne),Il._currentValue=X)}var qe=Object.prototype.hasOwnProperty,Qe=r.unstable_scheduleCallback,dt=r.unstable_cancelCallback,Et=r.unstable_shouldYield,xt=r.unstable_requestPaint,Ut=r.unstable_now,mr=r.unstable_getCurrentPriorityLevel,En=r.unstable_ImmediatePriority,Ea=r.unstable_UserBlockingPriority,Un=r.unstable_NormalPriority,Yr=r.unstable_LowPriority,gr=r.unstable_IdlePriority,oi=r.log,Fr=r.unstable_setDisableYieldValue,Ca=null,Wt=null;function $t(o){if(typeof oi=="function"&&Fr(o),Wt&&typeof Wt.setStrictMode=="function")try{Wt.setStrictMode(Ca,o)}catch{}}var gn=Math.clz32?Math.clz32:Ud,Pd=Math.log,zd=Math.LN2;function Ud(o){return o>>>=0,o===0?32:31-(Pd(o)/zd|0)|0}var si=256,ui=4194304;function Br(o){var u=o&42;if(u!==0)return u;switch(o&-o){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return o&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return o}}function Pc(o,u,h){var p=o.pendingLanes;if(p===0)return 0;var y=0,x=o.suspendedLanes,T=o.pingedLanes;o=o.warmLanes;var N=p&134217727;return N!==0?(p=N&~x,p!==0?y=Br(p):(T&=N,T!==0?y=Br(T):h||(h=N&~o,h!==0&&(y=Br(h))))):(N=p&~x,N!==0?y=Br(N):T!==0?y=Br(T):h||(h=p&~o,h!==0&&(y=Br(h)))),y===0?0:u!==0&&u!==y&&(u&x)===0&&(x=y&-y,h=u&-u,x>=h||x===32&&(h&4194048)!==0)?u:y}function ju(o,u){return(o.pendingLanes&~(o.suspendedLanes&~o.pingedLanes)&u)===0}function AR(o,u){switch(o){case 1:case 2:case 4:case 8:case 64:return u+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return u+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function b0(){var o=si;return si<<=1,(si&4194048)===0&&(si=256),o}function x0(){var o=ui;return ui<<=1,(ui&62914560)===0&&(ui=4194304),o}function Vd(o){for(var u=[],h=0;31>h;h++)u.push(o);return u}function Wu(o,u){o.pendingLanes|=u,u!==268435456&&(o.suspendedLanes=0,o.pingedLanes=0,o.warmLanes=0)}function TR(o,u,h,p,y,x){var T=o.pendingLanes;o.pendingLanes=h,o.suspendedLanes=0,o.pingedLanes=0,o.warmLanes=0,o.expiredLanes&=h,o.entangledLanes&=h,o.errorRecoveryDisabledLanes&=h,o.shellSuspendCounter=0;var N=o.entanglements,U=o.expirationTimes,Z=o.hiddenUpdates;for(h=T&~h;0<h;){var ce=31-gn(h),he=1<<ce;N[ce]=0,U[ce]=-1;var ee=Z[ce];if(ee!==null)for(Z[ce]=null,ce=0;ce<ee.length;ce++){var ae=ee[ce];ae!==null&&(ae.lane&=-536870913)}h&=~he}p!==0&&w0(o,p,0),x!==0&&y===0&&o.tag!==0&&(o.suspendedLanes|=x&~(T&~u))}function w0(o,u,h){o.pendingLanes|=u,o.suspendedLanes&=~u;var p=31-gn(u);o.entangledLanes|=u,o.entanglements[p]=o.entanglements[p]|1073741824|h&4194090}function _0(o,u){var h=o.entangledLanes|=u;for(o=o.entanglements;h;){var p=31-gn(h),y=1<<p;y&u|o[p]&u&&(o[p]|=u),h&=~y}}function Hd(o){switch(o){case 2:o=1;break;case 8:o=4;break;case 32:o=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:o=128;break;case 268435456:o=134217728;break;default:o=0}return o}function jd(o){return o&=-o,2<o?8<o?(o&134217727)!==0?32:268435456:8:2}function S0(){var o=W.p;return o!==0?o:(o=window.event,o===void 0?32:nw(o.type))}function DR(o,u){var h=W.p;try{return W.p=o,u()}finally{W.p=h}}var li=Math.random().toString(36).slice(2),Cn="__reactFiber$"+li,Vn="__reactProps$"+li,as="__reactContainer$"+li,Wd="__reactEvents$"+li,kR="__reactListeners$"+li,OR="__reactHandles$"+li,E0="__reactResources$"+li,Gu="__reactMarker$"+li;function Gd(o){delete o[Cn],delete o[Vn],delete o[Wd],delete o[kR],delete o[OR]}function is(o){var u=o[Cn];if(u)return u;for(var h=o.parentNode;h;){if(u=h[as]||h[Cn]){if(h=u.alternate,u.child!==null||h!==null&&h.child!==null)for(o=Vx(o);o!==null;){if(h=o[Cn])return h;o=Vx(o)}return u}o=h,h=o.parentNode}return null}function os(o){if(o=o[Cn]||o[as]){var u=o.tag;if(u===5||u===6||u===13||u===26||u===27||u===3)return o}return null}function qu(o){var u=o.tag;if(u===5||u===26||u===27||u===6)return o.stateNode;throw Error(n(33))}function ss(o){var u=o[E0];return u||(u=o[E0]={hoistableStyles:new Map,hoistableScripts:new Map}),u}function un(o){o[Gu]=!0}var C0=new Set,R0={};function fo(o,u){us(o,u),us(o+"Capture",u)}function us(o,u){for(R0[o]=u,o=0;o<u.length;o++)C0.add(u[o])}var NR=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),A0={},T0={};function MR(o){return qe.call(T0,o)?!0:qe.call(A0,o)?!1:NR.test(o)?T0[o]=!0:(A0[o]=!0,!1)}function zc(o,u,h){if(MR(u))if(h===null)o.removeAttribute(u);else{switch(typeof h){case"undefined":case"function":case"symbol":o.removeAttribute(u);return;case"boolean":var p=u.toLowerCase().slice(0,5);if(p!=="data-"&&p!=="aria-"){o.removeAttribute(u);return}}o.setAttribute(u,""+h)}}function Uc(o,u,h){if(h===null)o.removeAttribute(u);else{switch(typeof h){case"undefined":case"function":case"symbol":case"boolean":o.removeAttribute(u);return}o.setAttribute(u,""+h)}}function Ra(o,u,h,p){if(p===null)o.removeAttribute(h);else{switch(typeof p){case"undefined":case"function":case"symbol":case"boolean":o.removeAttribute(h);return}o.setAttributeNS(u,h,""+p)}}var qd,D0;function ls(o){if(qd===void 0)try{throw Error()}catch(h){var u=h.stack.trim().match(/\n( *(at )?)/);qd=u&&u[1]||"",D0=-1<h.stack.indexOf(`
    at`)?" (<anonymous>)":-1<h.stack.indexOf("@")?"@unknown:0:0":""}return`
`+qd+o+D0}var Kd=!1;function Xd(o,u){if(!o||Kd)return"";Kd=!0;var h=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var p={DetermineComponentFrameRoot:function(){try{if(u){var he=function(){throw Error()};if(Object.defineProperty(he.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(he,[])}catch(ae){var ee=ae}Reflect.construct(o,[],he)}else{try{he.call()}catch(ae){ee=ae}o.call(he.prototype)}}else{try{throw Error()}catch(ae){ee=ae}(he=o())&&typeof he.catch=="function"&&he.catch(function(){})}}catch(ae){if(ae&&ee&&typeof ae.stack=="string")return[ae.stack,ee.stack]}return[null,null]}};p.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var y=Object.getOwnPropertyDescriptor(p.DetermineComponentFrameRoot,"name");y&&y.configurable&&Object.defineProperty(p.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var x=p.DetermineComponentFrameRoot(),T=x[0],N=x[1];if(T&&N){var U=T.split(`
`),Z=N.split(`
`);for(y=p=0;p<U.length&&!U[p].includes("DetermineComponentFrameRoot");)p++;for(;y<Z.length&&!Z[y].includes("DetermineComponentFrameRoot");)y++;if(p===U.length||y===Z.length)for(p=U.length-1,y=Z.length-1;1<=p&&0<=y&&U[p]!==Z[y];)y--;for(;1<=p&&0<=y;p--,y--)if(U[p]!==Z[y]){if(p!==1||y!==1)do if(p--,y--,0>y||U[p]!==Z[y]){var ce=`
`+U[p].replace(" at new "," at ");return o.displayName&&ce.includes("<anonymous>")&&(ce=ce.replace("<anonymous>",o.displayName)),ce}while(1<=p&&0<=y);break}}}finally{Kd=!1,Error.prepareStackTrace=h}return(h=o?o.displayName||o.name:"")?ls(h):""}function IR(o){switch(o.tag){case 26:case 27:case 5:return ls(o.type);case 16:return ls("Lazy");case 13:return ls("Suspense");case 19:return ls("SuspenseList");case 0:case 15:return Xd(o.type,!1);case 11:return Xd(o.type.render,!1);case 1:return Xd(o.type,!0);case 31:return ls("Activity");default:return""}}function k0(o){try{var u="";do u+=IR(o),o=o.return;while(o);return u}catch(h){return`
Error generating stack: `+h.message+`
`+h.stack}}function yr(o){switch(typeof o){case"bigint":case"boolean":case"number":case"string":case"undefined":return o;case"object":return o;default:return""}}function O0(o){var u=o.type;return(o=o.nodeName)&&o.toLowerCase()==="input"&&(u==="checkbox"||u==="radio")}function FR(o){var u=O0(o)?"checked":"value",h=Object.getOwnPropertyDescriptor(o.constructor.prototype,u),p=""+o[u];if(!o.hasOwnProperty(u)&&typeof h<"u"&&typeof h.get=="function"&&typeof h.set=="function"){var y=h.get,x=h.set;return Object.defineProperty(o,u,{configurable:!0,get:function(){return y.call(this)},set:function(T){p=""+T,x.call(this,T)}}),Object.defineProperty(o,u,{enumerable:h.enumerable}),{getValue:function(){return p},setValue:function(T){p=""+T},stopTracking:function(){o._valueTracker=null,delete o[u]}}}}function Vc(o){o._valueTracker||(o._valueTracker=FR(o))}function N0(o){if(!o)return!1;var u=o._valueTracker;if(!u)return!0;var h=u.getValue(),p="";return o&&(p=O0(o)?o.checked?"true":"false":o.value),o=p,o!==h?(u.setValue(o),!0):!1}function Hc(o){if(o=o||(typeof document<"u"?document:void 0),typeof o>"u")return null;try{return o.activeElement||o.body}catch{return o.body}}var BR=/[\n"\\]/g;function br(o){return o.replace(BR,function(u){return"\\"+u.charCodeAt(0).toString(16)+" "})}function $d(o,u,h,p,y,x,T,N){o.name="",T!=null&&typeof T!="function"&&typeof T!="symbol"&&typeof T!="boolean"?o.type=T:o.removeAttribute("type"),u!=null?T==="number"?(u===0&&o.value===""||o.value!=u)&&(o.value=""+yr(u)):o.value!==""+yr(u)&&(o.value=""+yr(u)):T!=="submit"&&T!=="reset"||o.removeAttribute("value"),u!=null?Yd(o,T,yr(u)):h!=null?Yd(o,T,yr(h)):p!=null&&o.removeAttribute("value"),y==null&&x!=null&&(o.defaultChecked=!!x),y!=null&&(o.checked=y&&typeof y!="function"&&typeof y!="symbol"),N!=null&&typeof N!="function"&&typeof N!="symbol"&&typeof N!="boolean"?o.name=""+yr(N):o.removeAttribute("name")}function M0(o,u,h,p,y,x,T,N){if(x!=null&&typeof x!="function"&&typeof x!="symbol"&&typeof x!="boolean"&&(o.type=x),u!=null||h!=null){if(!(x!=="submit"&&x!=="reset"||u!=null))return;h=h!=null?""+yr(h):"",u=u!=null?""+yr(u):h,N||u===o.value||(o.value=u),o.defaultValue=u}p=p??y,p=typeof p!="function"&&typeof p!="symbol"&&!!p,o.checked=N?o.checked:!!p,o.defaultChecked=!!p,T!=null&&typeof T!="function"&&typeof T!="symbol"&&typeof T!="boolean"&&(o.name=T)}function Yd(o,u,h){u==="number"&&Hc(o.ownerDocument)===o||o.defaultValue===""+h||(o.defaultValue=""+h)}function cs(o,u,h,p){if(o=o.options,u){u={};for(var y=0;y<h.length;y++)u["$"+h[y]]=!0;for(h=0;h<o.length;h++)y=u.hasOwnProperty("$"+o[h].value),o[h].selected!==y&&(o[h].selected=y),y&&p&&(o[h].defaultSelected=!0)}else{for(h=""+yr(h),u=null,y=0;y<o.length;y++){if(o[y].value===h){o[y].selected=!0,p&&(o[y].defaultSelected=!0);return}u!==null||o[y].disabled||(u=o[y])}u!==null&&(u.selected=!0)}}function I0(o,u,h){if(u!=null&&(u=""+yr(u),u!==o.value&&(o.value=u),h==null)){o.defaultValue!==u&&(o.defaultValue=u);return}o.defaultValue=h!=null?""+yr(h):""}function F0(o,u,h,p){if(u==null){if(p!=null){if(h!=null)throw Error(n(92));if(ne(p)){if(1<p.length)throw Error(n(93));p=p[0]}h=p}h==null&&(h=""),u=h}h=yr(u),o.defaultValue=h,p=o.textContent,p===h&&p!==""&&p!==null&&(o.value=p)}function fs(o,u){if(u){var h=o.firstChild;if(h&&h===o.lastChild&&h.nodeType===3){h.nodeValue=u;return}}o.textContent=u}var LR=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function B0(o,u,h){var p=u.indexOf("--")===0;h==null||typeof h=="boolean"||h===""?p?o.setProperty(u,""):u==="float"?o.cssFloat="":o[u]="":p?o.setProperty(u,h):typeof h!="number"||h===0||LR.has(u)?u==="float"?o.cssFloat=h:o[u]=(""+h).trim():o[u]=h+"px"}function L0(o,u,h){if(u!=null&&typeof u!="object")throw Error(n(62));if(o=o.style,h!=null){for(var p in h)!h.hasOwnProperty(p)||u!=null&&u.hasOwnProperty(p)||(p.indexOf("--")===0?o.setProperty(p,""):p==="float"?o.cssFloat="":o[p]="");for(var y in u)p=u[y],u.hasOwnProperty(y)&&h[y]!==p&&B0(o,y,p)}else for(var x in u)u.hasOwnProperty(x)&&B0(o,x,u[x])}function Qd(o){if(o.indexOf("-")===-1)return!1;switch(o){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var PR=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),zR=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function jc(o){return zR.test(""+o)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":o}var Zd=null;function Jd(o){return o=o.target||o.srcElement||window,o.correspondingUseElement&&(o=o.correspondingUseElement),o.nodeType===3?o.parentNode:o}var hs=null,ds=null;function P0(o){var u=os(o);if(u&&(o=u.stateNode)){var h=o[Vn]||null;e:switch(o=u.stateNode,u.type){case"input":if($d(o,h.value,h.defaultValue,h.defaultValue,h.checked,h.defaultChecked,h.type,h.name),u=h.name,h.type==="radio"&&u!=null){for(h=o;h.parentNode;)h=h.parentNode;for(h=h.querySelectorAll('input[name="'+br(""+u)+'"][type="radio"]'),u=0;u<h.length;u++){var p=h[u];if(p!==o&&p.form===o.form){var y=p[Vn]||null;if(!y)throw Error(n(90));$d(p,y.value,y.defaultValue,y.defaultValue,y.checked,y.defaultChecked,y.type,y.name)}}for(u=0;u<h.length;u++)p=h[u],p.form===o.form&&N0(p)}break e;case"textarea":I0(o,h.value,h.defaultValue);break e;case"select":u=h.value,u!=null&&cs(o,!!h.multiple,u,!1)}}}var ep=!1;function z0(o,u,h){if(ep)return o(u,h);ep=!0;try{var p=o(u);return p}finally{if(ep=!1,(hs!==null||ds!==null)&&(Df(),hs&&(u=hs,o=ds,ds=hs=null,P0(u),o)))for(u=0;u<o.length;u++)P0(o[u])}}function Ku(o,u){var h=o.stateNode;if(h===null)return null;var p=h[Vn]||null;if(p===null)return null;h=p[u];e:switch(u){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(p=!p.disabled)||(o=o.type,p=!(o==="button"||o==="input"||o==="select"||o==="textarea")),o=!p;break e;default:o=!1}if(o)return null;if(h&&typeof h!="function")throw Error(n(231,u,typeof h));return h}var Aa=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),tp=!1;if(Aa)try{var Xu={};Object.defineProperty(Xu,"passive",{get:function(){tp=!0}}),window.addEventListener("test",Xu,Xu),window.removeEventListener("test",Xu,Xu)}catch{tp=!1}var ci=null,np=null,Wc=null;function U0(){if(Wc)return Wc;var o,u=np,h=u.length,p,y="value"in ci?ci.value:ci.textContent,x=y.length;for(o=0;o<h&&u[o]===y[o];o++);var T=h-o;for(p=1;p<=T&&u[h-p]===y[x-p];p++);return Wc=y.slice(o,1<p?1-p:void 0)}function Gc(o){var u=o.keyCode;return"charCode"in o?(o=o.charCode,o===0&&u===13&&(o=13)):o=u,o===10&&(o=13),32<=o||o===13?o:0}function qc(){return!0}function V0(){return!1}function Hn(o){function u(h,p,y,x,T){this._reactName=h,this._targetInst=y,this.type=p,this.nativeEvent=x,this.target=T,this.currentTarget=null;for(var N in o)o.hasOwnProperty(N)&&(h=o[N],this[N]=h?h(x):x[N]);return this.isDefaultPrevented=(x.defaultPrevented!=null?x.defaultPrevented:x.returnValue===!1)?qc:V0,this.isPropagationStopped=V0,this}return d(u.prototype,{preventDefault:function(){this.defaultPrevented=!0;var h=this.nativeEvent;h&&(h.preventDefault?h.preventDefault():typeof h.returnValue!="unknown"&&(h.returnValue=!1),this.isDefaultPrevented=qc)},stopPropagation:function(){var h=this.nativeEvent;h&&(h.stopPropagation?h.stopPropagation():typeof h.cancelBubble!="unknown"&&(h.cancelBubble=!0),this.isPropagationStopped=qc)},persist:function(){},isPersistent:qc}),u}var ho={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(o){return o.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Kc=Hn(ho),$u=d({},ho,{view:0,detail:0}),UR=Hn($u),rp,ap,Yu,Xc=d({},$u,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:op,button:0,buttons:0,relatedTarget:function(o){return o.relatedTarget===void 0?o.fromElement===o.srcElement?o.toElement:o.fromElement:o.relatedTarget},movementX:function(o){return"movementX"in o?o.movementX:(o!==Yu&&(Yu&&o.type==="mousemove"?(rp=o.screenX-Yu.screenX,ap=o.screenY-Yu.screenY):ap=rp=0,Yu=o),rp)},movementY:function(o){return"movementY"in o?o.movementY:ap}}),H0=Hn(Xc),VR=d({},Xc,{dataTransfer:0}),HR=Hn(VR),jR=d({},$u,{relatedTarget:0}),ip=Hn(jR),WR=d({},ho,{animationName:0,elapsedTime:0,pseudoElement:0}),GR=Hn(WR),qR=d({},ho,{clipboardData:function(o){return"clipboardData"in o?o.clipboardData:window.clipboardData}}),KR=Hn(qR),XR=d({},ho,{data:0}),j0=Hn(XR),$R={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},YR={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},QR={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function ZR(o){var u=this.nativeEvent;return u.getModifierState?u.getModifierState(o):(o=QR[o])?!!u[o]:!1}function op(){return ZR}var JR=d({},$u,{key:function(o){if(o.key){var u=$R[o.key]||o.key;if(u!=="Unidentified")return u}return o.type==="keypress"?(o=Gc(o),o===13?"Enter":String.fromCharCode(o)):o.type==="keydown"||o.type==="keyup"?YR[o.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:op,charCode:function(o){return o.type==="keypress"?Gc(o):0},keyCode:function(o){return o.type==="keydown"||o.type==="keyup"?o.keyCode:0},which:function(o){return o.type==="keypress"?Gc(o):o.type==="keydown"||o.type==="keyup"?o.keyCode:0}}),eA=Hn(JR),tA=d({},Xc,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),W0=Hn(tA),nA=d({},$u,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:op}),rA=Hn(nA),aA=d({},ho,{propertyName:0,elapsedTime:0,pseudoElement:0}),iA=Hn(aA),oA=d({},Xc,{deltaX:function(o){return"deltaX"in o?o.deltaX:"wheelDeltaX"in o?-o.wheelDeltaX:0},deltaY:function(o){return"deltaY"in o?o.deltaY:"wheelDeltaY"in o?-o.wheelDeltaY:"wheelDelta"in o?-o.wheelDelta:0},deltaZ:0,deltaMode:0}),sA=Hn(oA),uA=d({},ho,{newState:0,oldState:0}),lA=Hn(uA),cA=[9,13,27,32],sp=Aa&&"CompositionEvent"in window,Qu=null;Aa&&"documentMode"in document&&(Qu=document.documentMode);var fA=Aa&&"TextEvent"in window&&!Qu,G0=Aa&&(!sp||Qu&&8<Qu&&11>=Qu),q0=" ",K0=!1;function X0(o,u){switch(o){case"keyup":return cA.indexOf(u.keyCode)!==-1;case"keydown":return u.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function $0(o){return o=o.detail,typeof o=="object"&&"data"in o?o.data:null}var ps=!1;function hA(o,u){switch(o){case"compositionend":return $0(u);case"keypress":return u.which!==32?null:(K0=!0,q0);case"textInput":return o=u.data,o===q0&&K0?null:o;default:return null}}function dA(o,u){if(ps)return o==="compositionend"||!sp&&X0(o,u)?(o=U0(),Wc=np=ci=null,ps=!1,o):null;switch(o){case"paste":return null;case"keypress":if(!(u.ctrlKey||u.altKey||u.metaKey)||u.ctrlKey&&u.altKey){if(u.char&&1<u.char.length)return u.char;if(u.which)return String.fromCharCode(u.which)}return null;case"compositionend":return G0&&u.locale!=="ko"?null:u.data;default:return null}}var pA={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Y0(o){var u=o&&o.nodeName&&o.nodeName.toLowerCase();return u==="input"?!!pA[o.type]:u==="textarea"}function Q0(o,u,h,p){hs?ds?ds.push(p):ds=[p]:hs=p,u=Ff(u,"onChange"),0<u.length&&(h=new Kc("onChange","change",null,h,p),o.push({event:h,listeners:u}))}var Zu=null,Ju=null;function vA(o){Ox(o,0)}function $c(o){var u=qu(o);if(N0(u))return o}function Z0(o,u){if(o==="change")return u}var J0=!1;if(Aa){var up;if(Aa){var lp="oninput"in document;if(!lp){var eb=document.createElement("div");eb.setAttribute("oninput","return;"),lp=typeof eb.oninput=="function"}up=lp}else up=!1;J0=up&&(!document.documentMode||9<document.documentMode)}function tb(){Zu&&(Zu.detachEvent("onpropertychange",nb),Ju=Zu=null)}function nb(o){if(o.propertyName==="value"&&$c(Ju)){var u=[];Q0(u,Ju,o,Jd(o)),z0(vA,u)}}function mA(o,u,h){o==="focusin"?(tb(),Zu=u,Ju=h,Zu.attachEvent("onpropertychange",nb)):o==="focusout"&&tb()}function gA(o){if(o==="selectionchange"||o==="keyup"||o==="keydown")return $c(Ju)}function yA(o,u){if(o==="click")return $c(u)}function bA(o,u){if(o==="input"||o==="change")return $c(u)}function xA(o,u){return o===u&&(o!==0||1/o===1/u)||o!==o&&u!==u}var er=typeof Object.is=="function"?Object.is:xA;function el(o,u){if(er(o,u))return!0;if(typeof o!="object"||o===null||typeof u!="object"||u===null)return!1;var h=Object.keys(o),p=Object.keys(u);if(h.length!==p.length)return!1;for(p=0;p<h.length;p++){var y=h[p];if(!qe.call(u,y)||!er(o[y],u[y]))return!1}return!0}function rb(o){for(;o&&o.firstChild;)o=o.firstChild;return o}function ab(o,u){var h=rb(o);o=0;for(var p;h;){if(h.nodeType===3){if(p=o+h.textContent.length,o<=u&&p>=u)return{node:h,offset:u-o};o=p}e:{for(;h;){if(h.nextSibling){h=h.nextSibling;break e}h=h.parentNode}h=void 0}h=rb(h)}}function ib(o,u){return o&&u?o===u?!0:o&&o.nodeType===3?!1:u&&u.nodeType===3?ib(o,u.parentNode):"contains"in o?o.contains(u):o.compareDocumentPosition?!!(o.compareDocumentPosition(u)&16):!1:!1}function ob(o){o=o!=null&&o.ownerDocument!=null&&o.ownerDocument.defaultView!=null?o.ownerDocument.defaultView:window;for(var u=Hc(o.document);u instanceof o.HTMLIFrameElement;){try{var h=typeof u.contentWindow.location.href=="string"}catch{h=!1}if(h)o=u.contentWindow;else break;u=Hc(o.document)}return u}function cp(o){var u=o&&o.nodeName&&o.nodeName.toLowerCase();return u&&(u==="input"&&(o.type==="text"||o.type==="search"||o.type==="tel"||o.type==="url"||o.type==="password")||u==="textarea"||o.contentEditable==="true")}var wA=Aa&&"documentMode"in document&&11>=document.documentMode,vs=null,fp=null,tl=null,hp=!1;function sb(o,u,h){var p=h.window===h?h.document:h.nodeType===9?h:h.ownerDocument;hp||vs==null||vs!==Hc(p)||(p=vs,"selectionStart"in p&&cp(p)?p={start:p.selectionStart,end:p.selectionEnd}:(p=(p.ownerDocument&&p.ownerDocument.defaultView||window).getSelection(),p={anchorNode:p.anchorNode,anchorOffset:p.anchorOffset,focusNode:p.focusNode,focusOffset:p.focusOffset}),tl&&el(tl,p)||(tl=p,p=Ff(fp,"onSelect"),0<p.length&&(u=new Kc("onSelect","select",null,u,h),o.push({event:u,listeners:p}),u.target=vs)))}function po(o,u){var h={};return h[o.toLowerCase()]=u.toLowerCase(),h["Webkit"+o]="webkit"+u,h["Moz"+o]="moz"+u,h}var ms={animationend:po("Animation","AnimationEnd"),animationiteration:po("Animation","AnimationIteration"),animationstart:po("Animation","AnimationStart"),transitionrun:po("Transition","TransitionRun"),transitionstart:po("Transition","TransitionStart"),transitioncancel:po("Transition","TransitionCancel"),transitionend:po("Transition","TransitionEnd")},dp={},ub={};Aa&&(ub=document.createElement("div").style,"AnimationEvent"in window||(delete ms.animationend.animation,delete ms.animationiteration.animation,delete ms.animationstart.animation),"TransitionEvent"in window||delete ms.transitionend.transition);function vo(o){if(dp[o])return dp[o];if(!ms[o])return o;var u=ms[o],h;for(h in u)if(u.hasOwnProperty(h)&&h in ub)return dp[o]=u[h];return o}var lb=vo("animationend"),cb=vo("animationiteration"),fb=vo("animationstart"),_A=vo("transitionrun"),SA=vo("transitionstart"),EA=vo("transitioncancel"),hb=vo("transitionend"),db=new Map,pp="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");pp.push("scrollEnd");function Lr(o,u){db.set(o,u),fo(u,[o])}var pb=new WeakMap;function xr(o,u){if(typeof o=="object"&&o!==null){var h=pb.get(o);return h!==void 0?h:(u={value:o,source:u,stack:k0(u)},pb.set(o,u),u)}return{value:o,source:u,stack:k0(u)}}var wr=[],gs=0,vp=0;function Yc(){for(var o=gs,u=vp=gs=0;u<o;){var h=wr[u];wr[u++]=null;var p=wr[u];wr[u++]=null;var y=wr[u];wr[u++]=null;var x=wr[u];if(wr[u++]=null,p!==null&&y!==null){var T=p.pending;T===null?y.next=y:(y.next=T.next,T.next=y),p.pending=y}x!==0&&vb(h,y,x)}}function Qc(o,u,h,p){wr[gs++]=o,wr[gs++]=u,wr[gs++]=h,wr[gs++]=p,vp|=p,o.lanes|=p,o=o.alternate,o!==null&&(o.lanes|=p)}function mp(o,u,h,p){return Qc(o,u,h,p),Zc(o)}function ys(o,u){return Qc(o,null,null,u),Zc(o)}function vb(o,u,h){o.lanes|=h;var p=o.alternate;p!==null&&(p.lanes|=h);for(var y=!1,x=o.return;x!==null;)x.childLanes|=h,p=x.alternate,p!==null&&(p.childLanes|=h),x.tag===22&&(o=x.stateNode,o===null||o._visibility&1||(y=!0)),o=x,x=x.return;return o.tag===3?(x=o.stateNode,y&&u!==null&&(y=31-gn(h),o=x.hiddenUpdates,p=o[y],p===null?o[y]=[u]:p.push(u),u.lane=h|536870912),x):null}function Zc(o){if(50<Rl)throw Rl=0,_v=null,Error(n(185));for(var u=o.return;u!==null;)o=u,u=o.return;return o.tag===3?o.stateNode:null}var bs={};function CA(o,u,h,p){this.tag=o,this.key=h,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=u,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=p,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function tr(o,u,h,p){return new CA(o,u,h,p)}function gp(o){return o=o.prototype,!(!o||!o.isReactComponent)}function Ta(o,u){var h=o.alternate;return h===null?(h=tr(o.tag,u,o.key,o.mode),h.elementType=o.elementType,h.type=o.type,h.stateNode=o.stateNode,h.alternate=o,o.alternate=h):(h.pendingProps=u,h.type=o.type,h.flags=0,h.subtreeFlags=0,h.deletions=null),h.flags=o.flags&65011712,h.childLanes=o.childLanes,h.lanes=o.lanes,h.child=o.child,h.memoizedProps=o.memoizedProps,h.memoizedState=o.memoizedState,h.updateQueue=o.updateQueue,u=o.dependencies,h.dependencies=u===null?null:{lanes:u.lanes,firstContext:u.firstContext},h.sibling=o.sibling,h.index=o.index,h.ref=o.ref,h.refCleanup=o.refCleanup,h}function mb(o,u){o.flags&=65011714;var h=o.alternate;return h===null?(o.childLanes=0,o.lanes=u,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=h.childLanes,o.lanes=h.lanes,o.child=h.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=h.memoizedProps,o.memoizedState=h.memoizedState,o.updateQueue=h.updateQueue,o.type=h.type,u=h.dependencies,o.dependencies=u===null?null:{lanes:u.lanes,firstContext:u.firstContext}),o}function Jc(o,u,h,p,y,x){var T=0;if(p=o,typeof o=="function")gp(o)&&(T=1);else if(typeof o=="string")T=AT(o,h,pe.current)?26:o==="html"||o==="head"||o==="body"?27:5;else e:switch(o){case O:return o=tr(31,h,u,y),o.elementType=O,o.lanes=x,o;case b:return mo(h.children,y,x,u);case w:T=8,y|=24;break;case _:return o=tr(12,h,u,y|2),o.elementType=_,o.lanes=x,o;case A:return o=tr(13,h,u,y),o.elementType=A,o.lanes=x,o;case D:return o=tr(19,h,u,y),o.elementType=D,o.lanes=x,o;default:if(typeof o=="object"&&o!==null)switch(o.$$typeof){case S:case C:T=10;break e;case E:T=9;break e;case R:T=11;break e;case k:T=14;break e;case I:T=16,p=null;break e}T=29,h=Error(n(130,o===null?"null":typeof o,"")),p=null}return u=tr(T,h,u,y),u.elementType=o,u.type=p,u.lanes=x,u}function mo(o,u,h,p){return o=tr(7,o,p,u),o.lanes=h,o}function yp(o,u,h){return o=tr(6,o,null,u),o.lanes=h,o}function bp(o,u,h){return u=tr(4,o.children!==null?o.children:[],o.key,u),u.lanes=h,u.stateNode={containerInfo:o.containerInfo,pendingChildren:null,implementation:o.implementation},u}var xs=[],ws=0,ef=null,tf=0,_r=[],Sr=0,go=null,Da=1,ka="";function yo(o,u){xs[ws++]=tf,xs[ws++]=ef,ef=o,tf=u}function gb(o,u,h){_r[Sr++]=Da,_r[Sr++]=ka,_r[Sr++]=go,go=o;var p=Da;o=ka;var y=32-gn(p)-1;p&=~(1<<y),h+=1;var x=32-gn(u)+y;if(30<x){var T=y-y%5;x=(p&(1<<T)-1).toString(32),p>>=T,y-=T,Da=1<<32-gn(u)+y|h<<y|p,ka=x+o}else Da=1<<x|h<<y|p,ka=o}function xp(o){o.return!==null&&(yo(o,1),gb(o,1,0))}function wp(o){for(;o===ef;)ef=xs[--ws],xs[ws]=null,tf=xs[--ws],xs[ws]=null;for(;o===go;)go=_r[--Sr],_r[Sr]=null,ka=_r[--Sr],_r[Sr]=null,Da=_r[--Sr],_r[Sr]=null}var Fn=null,Bt=null,pt=!1,bo=null,Qr=!1,_p=Error(n(519));function xo(o){var u=Error(n(418,""));throw al(xr(u,o)),_p}function yb(o){var u=o.stateNode,h=o.type,p=o.memoizedProps;switch(u[Cn]=o,u[Vn]=p,h){case"dialog":rt("cancel",u),rt("close",u);break;case"iframe":case"object":case"embed":rt("load",u);break;case"video":case"audio":for(h=0;h<Tl.length;h++)rt(Tl[h],u);break;case"source":rt("error",u);break;case"img":case"image":case"link":rt("error",u),rt("load",u);break;case"details":rt("toggle",u);break;case"input":rt("invalid",u),M0(u,p.value,p.defaultValue,p.checked,p.defaultChecked,p.type,p.name,!0),Vc(u);break;case"select":rt("invalid",u);break;case"textarea":rt("invalid",u),F0(u,p.value,p.defaultValue,p.children),Vc(u)}h=p.children,typeof h!="string"&&typeof h!="number"&&typeof h!="bigint"||u.textContent===""+h||p.suppressHydrationWarning===!0||Fx(u.textContent,h)?(p.popover!=null&&(rt("beforetoggle",u),rt("toggle",u)),p.onScroll!=null&&rt("scroll",u),p.onScrollEnd!=null&&rt("scrollend",u),p.onClick!=null&&(u.onclick=Bf),u=!0):u=!1,u||xo(o)}function bb(o){for(Fn=o.return;Fn;)switch(Fn.tag){case 5:case 13:Qr=!1;return;case 27:case 3:Qr=!0;return;default:Fn=Fn.return}}function nl(o){if(o!==Fn)return!1;if(!pt)return bb(o),pt=!0,!1;var u=o.tag,h;if((h=u!==3&&u!==27)&&((h=u===5)&&(h=o.type,h=!(h!=="form"&&h!=="button")||Pv(o.type,o.memoizedProps)),h=!h),h&&Bt&&xo(o),bb(o),u===13){if(o=o.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(n(317));e:{for(o=o.nextSibling,u=0;o;){if(o.nodeType===8)if(h=o.data,h==="/$"){if(u===0){Bt=zr(o.nextSibling);break e}u--}else h!=="$"&&h!=="$!"&&h!=="$?"||u++;o=o.nextSibling}Bt=null}}else u===27?(u=Bt,Ri(o.type)?(o=Hv,Hv=null,Bt=o):Bt=u):Bt=Fn?zr(o.stateNode.nextSibling):null;return!0}function rl(){Bt=Fn=null,pt=!1}function xb(){var o=bo;return o!==null&&(Gn===null?Gn=o:Gn.push.apply(Gn,o),bo=null),o}function al(o){bo===null?bo=[o]:bo.push(o)}var Sp=q(null),wo=null,Oa=null;function fi(o,u,h){se(Sp,u._currentValue),u._currentValue=h}function Na(o){o._currentValue=Sp.current,oe(Sp)}function Ep(o,u,h){for(;o!==null;){var p=o.alternate;if((o.childLanes&u)!==u?(o.childLanes|=u,p!==null&&(p.childLanes|=u)):p!==null&&(p.childLanes&u)!==u&&(p.childLanes|=u),o===h)break;o=o.return}}function Cp(o,u,h,p){var y=o.child;for(y!==null&&(y.return=o);y!==null;){var x=y.dependencies;if(x!==null){var T=y.child;x=x.firstContext;e:for(;x!==null;){var N=x;x=y;for(var U=0;U<u.length;U++)if(N.context===u[U]){x.lanes|=h,N=x.alternate,N!==null&&(N.lanes|=h),Ep(x.return,h,o),p||(T=null);break e}x=N.next}}else if(y.tag===18){if(T=y.return,T===null)throw Error(n(341));T.lanes|=h,x=T.alternate,x!==null&&(x.lanes|=h),Ep(T,h,o),T=null}else T=y.child;if(T!==null)T.return=y;else for(T=y;T!==null;){if(T===o){T=null;break}if(y=T.sibling,y!==null){y.return=T.return,T=y;break}T=T.return}y=T}}function il(o,u,h,p){o=null;for(var y=u,x=!1;y!==null;){if(!x){if((y.flags&524288)!==0)x=!0;else if((y.flags&262144)!==0)break}if(y.tag===10){var T=y.alternate;if(T===null)throw Error(n(387));if(T=T.memoizedProps,T!==null){var N=y.type;er(y.pendingProps.value,T.value)||(o!==null?o.push(N):o=[N])}}else if(y===Ne.current){if(T=y.alternate,T===null)throw Error(n(387));T.memoizedState.memoizedState!==y.memoizedState.memoizedState&&(o!==null?o.push(Il):o=[Il])}y=y.return}o!==null&&Cp(u,o,h,p),u.flags|=262144}function nf(o){for(o=o.firstContext;o!==null;){if(!er(o.context._currentValue,o.memoizedValue))return!0;o=o.next}return!1}function _o(o){wo=o,Oa=null,o=o.dependencies,o!==null&&(o.firstContext=null)}function Rn(o){return wb(wo,o)}function rf(o,u){return wo===null&&_o(o),wb(o,u)}function wb(o,u){var h=u._currentValue;if(u={context:u,memoizedValue:h,next:null},Oa===null){if(o===null)throw Error(n(308));Oa=u,o.dependencies={lanes:0,firstContext:u},o.flags|=524288}else Oa=Oa.next=u;return h}var RA=typeof AbortController<"u"?AbortController:function(){var o=[],u=this.signal={aborted:!1,addEventListener:function(h,p){o.push(p)}};this.abort=function(){u.aborted=!0,o.forEach(function(h){return h()})}},AA=r.unstable_scheduleCallback,TA=r.unstable_NormalPriority,Yt={$$typeof:C,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Rp(){return{controller:new RA,data:new Map,refCount:0}}function ol(o){o.refCount--,o.refCount===0&&AA(TA,function(){o.controller.abort()})}var sl=null,Ap=0,_s=0,Ss=null;function DA(o,u){if(sl===null){var h=sl=[];Ap=0,_s=Dv(),Ss={status:"pending",value:void 0,then:function(p){h.push(p)}}}return Ap++,u.then(_b,_b),u}function _b(){if(--Ap===0&&sl!==null){Ss!==null&&(Ss.status="fulfilled");var o=sl;sl=null,_s=0,Ss=null;for(var u=0;u<o.length;u++)(0,o[u])()}}function kA(o,u){var h=[],p={status:"pending",value:null,reason:null,then:function(y){h.push(y)}};return o.then(function(){p.status="fulfilled",p.value=u;for(var y=0;y<h.length;y++)(0,h[y])(u)},function(y){for(p.status="rejected",p.reason=y,y=0;y<h.length;y++)(0,h[y])(void 0)}),p}var Sb=P.S;P.S=function(o,u){typeof u=="object"&&u!==null&&typeof u.then=="function"&&DA(o,u),Sb!==null&&Sb(o,u)};var So=q(null);function Tp(){var o=So.current;return o!==null?o:Rt.pooledCache}function af(o,u){u===null?se(So,So.current):se(So,u.pool)}function Eb(){var o=Tp();return o===null?null:{parent:Yt._currentValue,pool:o}}var ul=Error(n(460)),Cb=Error(n(474)),of=Error(n(542)),Dp={then:function(){}};function Rb(o){return o=o.status,o==="fulfilled"||o==="rejected"}function sf(){}function Ab(o,u,h){switch(h=o[h],h===void 0?o.push(u):h!==u&&(u.then(sf,sf),u=h),u.status){case"fulfilled":return u.value;case"rejected":throw o=u.reason,Db(o),o;default:if(typeof u.status=="string")u.then(sf,sf);else{if(o=Rt,o!==null&&100<o.shellSuspendCounter)throw Error(n(482));o=u,o.status="pending",o.then(function(p){if(u.status==="pending"){var y=u;y.status="fulfilled",y.value=p}},function(p){if(u.status==="pending"){var y=u;y.status="rejected",y.reason=p}})}switch(u.status){case"fulfilled":return u.value;case"rejected":throw o=u.reason,Db(o),o}throw ll=u,ul}}var ll=null;function Tb(){if(ll===null)throw Error(n(459));var o=ll;return ll=null,o}function Db(o){if(o===ul||o===of)throw Error(n(483))}var hi=!1;function kp(o){o.updateQueue={baseState:o.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Op(o,u){o=o.updateQueue,u.updateQueue===o&&(u.updateQueue={baseState:o.baseState,firstBaseUpdate:o.firstBaseUpdate,lastBaseUpdate:o.lastBaseUpdate,shared:o.shared,callbacks:null})}function di(o){return{lane:o,tag:0,payload:null,callback:null,next:null}}function pi(o,u,h){var p=o.updateQueue;if(p===null)return null;if(p=p.shared,(yt&2)!==0){var y=p.pending;return y===null?u.next=u:(u.next=y.next,y.next=u),p.pending=u,u=Zc(o),vb(o,null,h),u}return Qc(o,p,u,h),Zc(o)}function cl(o,u,h){if(u=u.updateQueue,u!==null&&(u=u.shared,(h&4194048)!==0)){var p=u.lanes;p&=o.pendingLanes,h|=p,u.lanes=h,_0(o,h)}}function Np(o,u){var h=o.updateQueue,p=o.alternate;if(p!==null&&(p=p.updateQueue,h===p)){var y=null,x=null;if(h=h.firstBaseUpdate,h!==null){do{var T={lane:h.lane,tag:h.tag,payload:h.payload,callback:null,next:null};x===null?y=x=T:x=x.next=T,h=h.next}while(h!==null);x===null?y=x=u:x=x.next=u}else y=x=u;h={baseState:p.baseState,firstBaseUpdate:y,lastBaseUpdate:x,shared:p.shared,callbacks:p.callbacks},o.updateQueue=h;return}o=h.lastBaseUpdate,o===null?h.firstBaseUpdate=u:o.next=u,h.lastBaseUpdate=u}var Mp=!1;function fl(){if(Mp){var o=Ss;if(o!==null)throw o}}function hl(o,u,h,p){Mp=!1;var y=o.updateQueue;hi=!1;var x=y.firstBaseUpdate,T=y.lastBaseUpdate,N=y.shared.pending;if(N!==null){y.shared.pending=null;var U=N,Z=U.next;U.next=null,T===null?x=Z:T.next=Z,T=U;var ce=o.alternate;ce!==null&&(ce=ce.updateQueue,N=ce.lastBaseUpdate,N!==T&&(N===null?ce.firstBaseUpdate=Z:N.next=Z,ce.lastBaseUpdate=U))}if(x!==null){var he=y.baseState;T=0,ce=Z=U=null,N=x;do{var ee=N.lane&-536870913,ae=ee!==N.lane;if(ae?(ot&ee)===ee:(p&ee)===ee){ee!==0&&ee===_s&&(Mp=!0),ce!==null&&(ce=ce.next={lane:0,tag:N.tag,payload:N.payload,callback:null,next:null});e:{var ze=o,Be=N;ee=u;var St=h;switch(Be.tag){case 1:if(ze=Be.payload,typeof ze=="function"){he=ze.call(St,he,ee);break e}he=ze;break e;case 3:ze.flags=ze.flags&-65537|128;case 0:if(ze=Be.payload,ee=typeof ze=="function"?ze.call(St,he,ee):ze,ee==null)break e;he=d({},he,ee);break e;case 2:hi=!0}}ee=N.callback,ee!==null&&(o.flags|=64,ae&&(o.flags|=8192),ae=y.callbacks,ae===null?y.callbacks=[ee]:ae.push(ee))}else ae={lane:ee,tag:N.tag,payload:N.payload,callback:N.callback,next:null},ce===null?(Z=ce=ae,U=he):ce=ce.next=ae,T|=ee;if(N=N.next,N===null){if(N=y.shared.pending,N===null)break;ae=N,N=ae.next,ae.next=null,y.lastBaseUpdate=ae,y.shared.pending=null}}while(!0);ce===null&&(U=he),y.baseState=U,y.firstBaseUpdate=Z,y.lastBaseUpdate=ce,x===null&&(y.shared.lanes=0),_i|=T,o.lanes=T,o.memoizedState=he}}function kb(o,u){if(typeof o!="function")throw Error(n(191,o));o.call(u)}function Ob(o,u){var h=o.callbacks;if(h!==null)for(o.callbacks=null,o=0;o<h.length;o++)kb(h[o],u)}var Es=q(null),uf=q(0);function Nb(o,u){o=za,se(uf,o),se(Es,u),za=o|u.baseLanes}function Ip(){se(uf,za),se(Es,Es.current)}function Fp(){za=uf.current,oe(Es),oe(uf)}var vi=0,Ze=null,wt=null,Gt=null,lf=!1,Cs=!1,Eo=!1,cf=0,dl=0,Rs=null,OA=0;function Vt(){throw Error(n(321))}function Bp(o,u){if(u===null)return!1;for(var h=0;h<u.length&&h<o.length;h++)if(!er(o[h],u[h]))return!1;return!0}function Lp(o,u,h,p,y,x){return vi=x,Ze=u,u.memoizedState=null,u.updateQueue=null,u.lanes=0,P.H=o===null||o.memoizedState===null?v1:m1,Eo=!1,x=h(p,y),Eo=!1,Cs&&(x=Ib(u,h,p,y)),Mb(o),x}function Mb(o){P.H=mf;var u=wt!==null&&wt.next!==null;if(vi=0,Gt=wt=Ze=null,lf=!1,dl=0,Rs=null,u)throw Error(n(300));o===null||ln||(o=o.dependencies,o!==null&&nf(o)&&(ln=!0))}function Ib(o,u,h,p){Ze=o;var y=0;do{if(Cs&&(Rs=null),dl=0,Cs=!1,25<=y)throw Error(n(301));if(y+=1,Gt=wt=null,o.updateQueue!=null){var x=o.updateQueue;x.lastEffect=null,x.events=null,x.stores=null,x.memoCache!=null&&(x.memoCache.index=0)}P.H=PA,x=u(h,p)}while(Cs);return x}function NA(){var o=P.H,u=o.useState()[0];return u=typeof u.then=="function"?pl(u):u,o=o.useState()[0],(wt!==null?wt.memoizedState:null)!==o&&(Ze.flags|=1024),u}function Pp(){var o=cf!==0;return cf=0,o}function zp(o,u,h){u.updateQueue=o.updateQueue,u.flags&=-2053,o.lanes&=~h}function Up(o){if(lf){for(o=o.memoizedState;o!==null;){var u=o.queue;u!==null&&(u.pending=null),o=o.next}lf=!1}vi=0,Gt=wt=Ze=null,Cs=!1,dl=cf=0,Rs=null}function jn(){var o={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Gt===null?Ze.memoizedState=Gt=o:Gt=Gt.next=o,Gt}function qt(){if(wt===null){var o=Ze.alternate;o=o!==null?o.memoizedState:null}else o=wt.next;var u=Gt===null?Ze.memoizedState:Gt.next;if(u!==null)Gt=u,wt=o;else{if(o===null)throw Ze.alternate===null?Error(n(467)):Error(n(310));wt=o,o={memoizedState:wt.memoizedState,baseState:wt.baseState,baseQueue:wt.baseQueue,queue:wt.queue,next:null},Gt===null?Ze.memoizedState=Gt=o:Gt=Gt.next=o}return Gt}function Vp(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function pl(o){var u=dl;return dl+=1,Rs===null&&(Rs=[]),o=Ab(Rs,o,u),u=Ze,(Gt===null?u.memoizedState:Gt.next)===null&&(u=u.alternate,P.H=u===null||u.memoizedState===null?v1:m1),o}function ff(o){if(o!==null&&typeof o=="object"){if(typeof o.then=="function")return pl(o);if(o.$$typeof===C)return Rn(o)}throw Error(n(438,String(o)))}function Hp(o){var u=null,h=Ze.updateQueue;if(h!==null&&(u=h.memoCache),u==null){var p=Ze.alternate;p!==null&&(p=p.updateQueue,p!==null&&(p=p.memoCache,p!=null&&(u={data:p.data.map(function(y){return y.slice()}),index:0})))}if(u==null&&(u={data:[],index:0}),h===null&&(h=Vp(),Ze.updateQueue=h),h.memoCache=u,h=u.data[u.index],h===void 0)for(h=u.data[u.index]=Array(o),p=0;p<o;p++)h[p]=M;return u.index++,h}function Ma(o,u){return typeof u=="function"?u(o):u}function hf(o){var u=qt();return jp(u,wt,o)}function jp(o,u,h){var p=o.queue;if(p===null)throw Error(n(311));p.lastRenderedReducer=h;var y=o.baseQueue,x=p.pending;if(x!==null){if(y!==null){var T=y.next;y.next=x.next,x.next=T}u.baseQueue=y=x,p.pending=null}if(x=o.baseState,y===null)o.memoizedState=x;else{u=y.next;var N=T=null,U=null,Z=u,ce=!1;do{var he=Z.lane&-536870913;if(he!==Z.lane?(ot&he)===he:(vi&he)===he){var ee=Z.revertLane;if(ee===0)U!==null&&(U=U.next={lane:0,revertLane:0,action:Z.action,hasEagerState:Z.hasEagerState,eagerState:Z.eagerState,next:null}),he===_s&&(ce=!0);else if((vi&ee)===ee){Z=Z.next,ee===_s&&(ce=!0);continue}else he={lane:0,revertLane:Z.revertLane,action:Z.action,hasEagerState:Z.hasEagerState,eagerState:Z.eagerState,next:null},U===null?(N=U=he,T=x):U=U.next=he,Ze.lanes|=ee,_i|=ee;he=Z.action,Eo&&h(x,he),x=Z.hasEagerState?Z.eagerState:h(x,he)}else ee={lane:he,revertLane:Z.revertLane,action:Z.action,hasEagerState:Z.hasEagerState,eagerState:Z.eagerState,next:null},U===null?(N=U=ee,T=x):U=U.next=ee,Ze.lanes|=he,_i|=he;Z=Z.next}while(Z!==null&&Z!==u);if(U===null?T=x:U.next=N,!er(x,o.memoizedState)&&(ln=!0,ce&&(h=Ss,h!==null)))throw h;o.memoizedState=x,o.baseState=T,o.baseQueue=U,p.lastRenderedState=x}return y===null&&(p.lanes=0),[o.memoizedState,p.dispatch]}function Wp(o){var u=qt(),h=u.queue;if(h===null)throw Error(n(311));h.lastRenderedReducer=o;var p=h.dispatch,y=h.pending,x=u.memoizedState;if(y!==null){h.pending=null;var T=y=y.next;do x=o(x,T.action),T=T.next;while(T!==y);er(x,u.memoizedState)||(ln=!0),u.memoizedState=x,u.baseQueue===null&&(u.baseState=x),h.lastRenderedState=x}return[x,p]}function Fb(o,u,h){var p=Ze,y=qt(),x=pt;if(x){if(h===void 0)throw Error(n(407));h=h()}else h=u();var T=!er((wt||y).memoizedState,h);T&&(y.memoizedState=h,ln=!0),y=y.queue;var N=Pb.bind(null,p,y,o);if(vl(2048,8,N,[o]),y.getSnapshot!==u||T||Gt!==null&&Gt.memoizedState.tag&1){if(p.flags|=2048,As(9,df(),Lb.bind(null,p,y,h,u),null),Rt===null)throw Error(n(349));x||(vi&124)!==0||Bb(p,u,h)}return h}function Bb(o,u,h){o.flags|=16384,o={getSnapshot:u,value:h},u=Ze.updateQueue,u===null?(u=Vp(),Ze.updateQueue=u,u.stores=[o]):(h=u.stores,h===null?u.stores=[o]:h.push(o))}function Lb(o,u,h,p){u.value=h,u.getSnapshot=p,zb(u)&&Ub(o)}function Pb(o,u,h){return h(function(){zb(u)&&Ub(o)})}function zb(o){var u=o.getSnapshot;o=o.value;try{var h=u();return!er(o,h)}catch{return!0}}function Ub(o){var u=ys(o,2);u!==null&&or(u,o,2)}function Gp(o){var u=jn();if(typeof o=="function"){var h=o;if(o=h(),Eo){$t(!0);try{h()}finally{$t(!1)}}}return u.memoizedState=u.baseState=o,u.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ma,lastRenderedState:o},u}function Vb(o,u,h,p){return o.baseState=h,jp(o,wt,typeof p=="function"?p:Ma)}function MA(o,u,h,p,y){if(vf(o))throw Error(n(485));if(o=u.action,o!==null){var x={payload:y,action:o,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(T){x.listeners.push(T)}};P.T!==null?h(!0):x.isTransition=!1,p(x),h=u.pending,h===null?(x.next=u.pending=x,Hb(u,x)):(x.next=h.next,u.pending=h.next=x)}}function Hb(o,u){var h=u.action,p=u.payload,y=o.state;if(u.isTransition){var x=P.T,T={};P.T=T;try{var N=h(y,p),U=P.S;U!==null&&U(T,N),jb(o,u,N)}catch(Z){qp(o,u,Z)}finally{P.T=x}}else try{x=h(y,p),jb(o,u,x)}catch(Z){qp(o,u,Z)}}function jb(o,u,h){h!==null&&typeof h=="object"&&typeof h.then=="function"?h.then(function(p){Wb(o,u,p)},function(p){return qp(o,u,p)}):Wb(o,u,h)}function Wb(o,u,h){u.status="fulfilled",u.value=h,Gb(u),o.state=h,u=o.pending,u!==null&&(h=u.next,h===u?o.pending=null:(h=h.next,u.next=h,Hb(o,h)))}function qp(o,u,h){var p=o.pending;if(o.pending=null,p!==null){p=p.next;do u.status="rejected",u.reason=h,Gb(u),u=u.next;while(u!==p)}o.action=null}function Gb(o){o=o.listeners;for(var u=0;u<o.length;u++)(0,o[u])()}function qb(o,u){return u}function Kb(o,u){if(pt){var h=Rt.formState;if(h!==null){e:{var p=Ze;if(pt){if(Bt){t:{for(var y=Bt,x=Qr;y.nodeType!==8;){if(!x){y=null;break t}if(y=zr(y.nextSibling),y===null){y=null;break t}}x=y.data,y=x==="F!"||x==="F"?y:null}if(y){Bt=zr(y.nextSibling),p=y.data==="F!";break e}}xo(p)}p=!1}p&&(u=h[0])}}return h=jn(),h.memoizedState=h.baseState=u,p={pending:null,lanes:0,dispatch:null,lastRenderedReducer:qb,lastRenderedState:u},h.queue=p,h=h1.bind(null,Ze,p),p.dispatch=h,p=Gp(!1),x=Qp.bind(null,Ze,!1,p.queue),p=jn(),y={state:u,dispatch:null,action:o,pending:null},p.queue=y,h=MA.bind(null,Ze,y,x,h),y.dispatch=h,p.memoizedState=o,[u,h,!1]}function Xb(o){var u=qt();return $b(u,wt,o)}function $b(o,u,h){if(u=jp(o,u,qb)[0],o=hf(Ma)[0],typeof u=="object"&&u!==null&&typeof u.then=="function")try{var p=pl(u)}catch(T){throw T===ul?of:T}else p=u;u=qt();var y=u.queue,x=y.dispatch;return h!==u.memoizedState&&(Ze.flags|=2048,As(9,df(),IA.bind(null,y,h),null)),[p,x,o]}function IA(o,u){o.action=u}function Yb(o){var u=qt(),h=wt;if(h!==null)return $b(u,h,o);qt(),u=u.memoizedState,h=qt();var p=h.queue.dispatch;return h.memoizedState=o,[u,p,!1]}function As(o,u,h,p){return o={tag:o,create:h,deps:p,inst:u,next:null},u=Ze.updateQueue,u===null&&(u=Vp(),Ze.updateQueue=u),h=u.lastEffect,h===null?u.lastEffect=o.next=o:(p=h.next,h.next=o,o.next=p,u.lastEffect=o),o}function df(){return{destroy:void 0,resource:void 0}}function Qb(){return qt().memoizedState}function pf(o,u,h,p){var y=jn();p=p===void 0?null:p,Ze.flags|=o,y.memoizedState=As(1|u,df(),h,p)}function vl(o,u,h,p){var y=qt();p=p===void 0?null:p;var x=y.memoizedState.inst;wt!==null&&p!==null&&Bp(p,wt.memoizedState.deps)?y.memoizedState=As(u,x,h,p):(Ze.flags|=o,y.memoizedState=As(1|u,x,h,p))}function Zb(o,u){pf(8390656,8,o,u)}function Jb(o,u){vl(2048,8,o,u)}function e1(o,u){return vl(4,2,o,u)}function t1(o,u){return vl(4,4,o,u)}function n1(o,u){if(typeof u=="function"){o=o();var h=u(o);return function(){typeof h=="function"?h():u(null)}}if(u!=null)return o=o(),u.current=o,function(){u.current=null}}function r1(o,u,h){h=h!=null?h.concat([o]):null,vl(4,4,n1.bind(null,u,o),h)}function Kp(){}function a1(o,u){var h=qt();u=u===void 0?null:u;var p=h.memoizedState;return u!==null&&Bp(u,p[1])?p[0]:(h.memoizedState=[o,u],o)}function i1(o,u){var h=qt();u=u===void 0?null:u;var p=h.memoizedState;if(u!==null&&Bp(u,p[1]))return p[0];if(p=o(),Eo){$t(!0);try{o()}finally{$t(!1)}}return h.memoizedState=[p,u],p}function Xp(o,u,h){return h===void 0||(vi&1073741824)!==0?o.memoizedState=u:(o.memoizedState=h,o=ux(),Ze.lanes|=o,_i|=o,h)}function o1(o,u,h,p){return er(h,u)?h:Es.current!==null?(o=Xp(o,h,p),er(o,u)||(ln=!0),o):(vi&42)===0?(ln=!0,o.memoizedState=h):(o=ux(),Ze.lanes|=o,_i|=o,u)}function s1(o,u,h,p,y){var x=W.p;W.p=x!==0&&8>x?x:8;var T=P.T,N={};P.T=N,Qp(o,!1,u,h);try{var U=y(),Z=P.S;if(Z!==null&&Z(N,U),U!==null&&typeof U=="object"&&typeof U.then=="function"){var ce=kA(U,p);ml(o,u,ce,ir(o))}else ml(o,u,p,ir(o))}catch(he){ml(o,u,{then:function(){},status:"rejected",reason:he},ir())}finally{W.p=x,P.T=T}}function FA(){}function $p(o,u,h,p){if(o.tag!==5)throw Error(n(476));var y=u1(o).queue;s1(o,y,u,X,h===null?FA:function(){return l1(o),h(p)})}function u1(o){var u=o.memoizedState;if(u!==null)return u;u={memoizedState:X,baseState:X,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ma,lastRenderedState:X},next:null};var h={};return u.next={memoizedState:h,baseState:h,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ma,lastRenderedState:h},next:null},o.memoizedState=u,o=o.alternate,o!==null&&(o.memoizedState=u),u}function l1(o){var u=u1(o).next.queue;ml(o,u,{},ir())}function Yp(){return Rn(Il)}function c1(){return qt().memoizedState}function f1(){return qt().memoizedState}function BA(o){for(var u=o.return;u!==null;){switch(u.tag){case 24:case 3:var h=ir();o=di(h);var p=pi(u,o,h);p!==null&&(or(p,u,h),cl(p,u,h)),u={cache:Rp()},o.payload=u;return}u=u.return}}function LA(o,u,h){var p=ir();h={lane:p,revertLane:0,action:h,hasEagerState:!1,eagerState:null,next:null},vf(o)?d1(u,h):(h=mp(o,u,h,p),h!==null&&(or(h,o,p),p1(h,u,p)))}function h1(o,u,h){var p=ir();ml(o,u,h,p)}function ml(o,u,h,p){var y={lane:p,revertLane:0,action:h,hasEagerState:!1,eagerState:null,next:null};if(vf(o))d1(u,y);else{var x=o.alternate;if(o.lanes===0&&(x===null||x.lanes===0)&&(x=u.lastRenderedReducer,x!==null))try{var T=u.lastRenderedState,N=x(T,h);if(y.hasEagerState=!0,y.eagerState=N,er(N,T))return Qc(o,u,y,0),Rt===null&&Yc(),!1}catch{}finally{}if(h=mp(o,u,y,p),h!==null)return or(h,o,p),p1(h,u,p),!0}return!1}function Qp(o,u,h,p){if(p={lane:2,revertLane:Dv(),action:p,hasEagerState:!1,eagerState:null,next:null},vf(o)){if(u)throw Error(n(479))}else u=mp(o,h,p,2),u!==null&&or(u,o,2)}function vf(o){var u=o.alternate;return o===Ze||u!==null&&u===Ze}function d1(o,u){Cs=lf=!0;var h=o.pending;h===null?u.next=u:(u.next=h.next,h.next=u),o.pending=u}function p1(o,u,h){if((h&4194048)!==0){var p=u.lanes;p&=o.pendingLanes,h|=p,u.lanes=h,_0(o,h)}}var mf={readContext:Rn,use:ff,useCallback:Vt,useContext:Vt,useEffect:Vt,useImperativeHandle:Vt,useLayoutEffect:Vt,useInsertionEffect:Vt,useMemo:Vt,useReducer:Vt,useRef:Vt,useState:Vt,useDebugValue:Vt,useDeferredValue:Vt,useTransition:Vt,useSyncExternalStore:Vt,useId:Vt,useHostTransitionStatus:Vt,useFormState:Vt,useActionState:Vt,useOptimistic:Vt,useMemoCache:Vt,useCacheRefresh:Vt},v1={readContext:Rn,use:ff,useCallback:function(o,u){return jn().memoizedState=[o,u===void 0?null:u],o},useContext:Rn,useEffect:Zb,useImperativeHandle:function(o,u,h){h=h!=null?h.concat([o]):null,pf(4194308,4,n1.bind(null,u,o),h)},useLayoutEffect:function(o,u){return pf(4194308,4,o,u)},useInsertionEffect:function(o,u){pf(4,2,o,u)},useMemo:function(o,u){var h=jn();u=u===void 0?null:u;var p=o();if(Eo){$t(!0);try{o()}finally{$t(!1)}}return h.memoizedState=[p,u],p},useReducer:function(o,u,h){var p=jn();if(h!==void 0){var y=h(u);if(Eo){$t(!0);try{h(u)}finally{$t(!1)}}}else y=u;return p.memoizedState=p.baseState=y,o={pending:null,lanes:0,dispatch:null,lastRenderedReducer:o,lastRenderedState:y},p.queue=o,o=o.dispatch=LA.bind(null,Ze,o),[p.memoizedState,o]},useRef:function(o){var u=jn();return o={current:o},u.memoizedState=o},useState:function(o){o=Gp(o);var u=o.queue,h=h1.bind(null,Ze,u);return u.dispatch=h,[o.memoizedState,h]},useDebugValue:Kp,useDeferredValue:function(o,u){var h=jn();return Xp(h,o,u)},useTransition:function(){var o=Gp(!1);return o=s1.bind(null,Ze,o.queue,!0,!1),jn().memoizedState=o,[!1,o]},useSyncExternalStore:function(o,u,h){var p=Ze,y=jn();if(pt){if(h===void 0)throw Error(n(407));h=h()}else{if(h=u(),Rt===null)throw Error(n(349));(ot&124)!==0||Bb(p,u,h)}y.memoizedState=h;var x={value:h,getSnapshot:u};return y.queue=x,Zb(Pb.bind(null,p,x,o),[o]),p.flags|=2048,As(9,df(),Lb.bind(null,p,x,h,u),null),h},useId:function(){var o=jn(),u=Rt.identifierPrefix;if(pt){var h=ka,p=Da;h=(p&~(1<<32-gn(p)-1)).toString(32)+h,u="«"+u+"R"+h,h=cf++,0<h&&(u+="H"+h.toString(32)),u+="»"}else h=OA++,u="«"+u+"r"+h.toString(32)+"»";return o.memoizedState=u},useHostTransitionStatus:Yp,useFormState:Kb,useActionState:Kb,useOptimistic:function(o){var u=jn();u.memoizedState=u.baseState=o;var h={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return u.queue=h,u=Qp.bind(null,Ze,!0,h),h.dispatch=u,[o,u]},useMemoCache:Hp,useCacheRefresh:function(){return jn().memoizedState=BA.bind(null,Ze)}},m1={readContext:Rn,use:ff,useCallback:a1,useContext:Rn,useEffect:Jb,useImperativeHandle:r1,useInsertionEffect:e1,useLayoutEffect:t1,useMemo:i1,useReducer:hf,useRef:Qb,useState:function(){return hf(Ma)},useDebugValue:Kp,useDeferredValue:function(o,u){var h=qt();return o1(h,wt.memoizedState,o,u)},useTransition:function(){var o=hf(Ma)[0],u=qt().memoizedState;return[typeof o=="boolean"?o:pl(o),u]},useSyncExternalStore:Fb,useId:c1,useHostTransitionStatus:Yp,useFormState:Xb,useActionState:Xb,useOptimistic:function(o,u){var h=qt();return Vb(h,wt,o,u)},useMemoCache:Hp,useCacheRefresh:f1},PA={readContext:Rn,use:ff,useCallback:a1,useContext:Rn,useEffect:Jb,useImperativeHandle:r1,useInsertionEffect:e1,useLayoutEffect:t1,useMemo:i1,useReducer:Wp,useRef:Qb,useState:function(){return Wp(Ma)},useDebugValue:Kp,useDeferredValue:function(o,u){var h=qt();return wt===null?Xp(h,o,u):o1(h,wt.memoizedState,o,u)},useTransition:function(){var o=Wp(Ma)[0],u=qt().memoizedState;return[typeof o=="boolean"?o:pl(o),u]},useSyncExternalStore:Fb,useId:c1,useHostTransitionStatus:Yp,useFormState:Yb,useActionState:Yb,useOptimistic:function(o,u){var h=qt();return wt!==null?Vb(h,wt,o,u):(h.baseState=o,[o,h.queue.dispatch])},useMemoCache:Hp,useCacheRefresh:f1},Ts=null,gl=0;function gf(o){var u=gl;return gl+=1,Ts===null&&(Ts=[]),Ab(Ts,o,u)}function yl(o,u){u=u.props.ref,o.ref=u!==void 0?u:null}function yf(o,u){throw u.$$typeof===v?Error(n(525)):(o=Object.prototype.toString.call(u),Error(n(31,o==="[object Object]"?"object with keys {"+Object.keys(u).join(", ")+"}":o)))}function g1(o){var u=o._init;return u(o._payload)}function y1(o){function u($,G){if(o){var Y=$.deletions;Y===null?($.deletions=[G],$.flags|=16):Y.push(G)}}function h($,G){if(!o)return null;for(;G!==null;)u($,G),G=G.sibling;return null}function p($){for(var G=new Map;$!==null;)$.key!==null?G.set($.key,$):G.set($.index,$),$=$.sibling;return G}function y($,G){return $=Ta($,G),$.index=0,$.sibling=null,$}function x($,G,Y){return $.index=Y,o?(Y=$.alternate,Y!==null?(Y=Y.index,Y<G?($.flags|=67108866,G):Y):($.flags|=67108866,G)):($.flags|=1048576,G)}function T($){return o&&$.alternate===null&&($.flags|=67108866),$}function N($,G,Y,fe){return G===null||G.tag!==6?(G=yp(Y,$.mode,fe),G.return=$,G):(G=y(G,Y),G.return=$,G)}function U($,G,Y,fe){var Se=Y.type;return Se===b?ce($,G,Y.props.children,fe,Y.key):G!==null&&(G.elementType===Se||typeof Se=="object"&&Se!==null&&Se.$$typeof===I&&g1(Se)===G.type)?(G=y(G,Y.props),yl(G,Y),G.return=$,G):(G=Jc(Y.type,Y.key,Y.props,null,$.mode,fe),yl(G,Y),G.return=$,G)}function Z($,G,Y,fe){return G===null||G.tag!==4||G.stateNode.containerInfo!==Y.containerInfo||G.stateNode.implementation!==Y.implementation?(G=bp(Y,$.mode,fe),G.return=$,G):(G=y(G,Y.children||[]),G.return=$,G)}function ce($,G,Y,fe,Se){return G===null||G.tag!==7?(G=mo(Y,$.mode,fe,Se),G.return=$,G):(G=y(G,Y),G.return=$,G)}function he($,G,Y){if(typeof G=="string"&&G!==""||typeof G=="number"||typeof G=="bigint")return G=yp(""+G,$.mode,Y),G.return=$,G;if(typeof G=="object"&&G!==null){switch(G.$$typeof){case m:return Y=Jc(G.type,G.key,G.props,null,$.mode,Y),yl(Y,G),Y.return=$,Y;case g:return G=bp(G,$.mode,Y),G.return=$,G;case I:var fe=G._init;return G=fe(G._payload),he($,G,Y)}if(ne(G)||z(G))return G=mo(G,$.mode,Y,null),G.return=$,G;if(typeof G.then=="function")return he($,gf(G),Y);if(G.$$typeof===C)return he($,rf($,G),Y);yf($,G)}return null}function ee($,G,Y,fe){var Se=G!==null?G.key:null;if(typeof Y=="string"&&Y!==""||typeof Y=="number"||typeof Y=="bigint")return Se!==null?null:N($,G,""+Y,fe);if(typeof Y=="object"&&Y!==null){switch(Y.$$typeof){case m:return Y.key===Se?U($,G,Y,fe):null;case g:return Y.key===Se?Z($,G,Y,fe):null;case I:return Se=Y._init,Y=Se(Y._payload),ee($,G,Y,fe)}if(ne(Y)||z(Y))return Se!==null?null:ce($,G,Y,fe,null);if(typeof Y.then=="function")return ee($,G,gf(Y),fe);if(Y.$$typeof===C)return ee($,G,rf($,Y),fe);yf($,Y)}return null}function ae($,G,Y,fe,Se){if(typeof fe=="string"&&fe!==""||typeof fe=="number"||typeof fe=="bigint")return $=$.get(Y)||null,N(G,$,""+fe,Se);if(typeof fe=="object"&&fe!==null){switch(fe.$$typeof){case m:return $=$.get(fe.key===null?Y:fe.key)||null,U(G,$,fe,Se);case g:return $=$.get(fe.key===null?Y:fe.key)||null,Z(G,$,fe,Se);case I:var Je=fe._init;return fe=Je(fe._payload),ae($,G,Y,fe,Se)}if(ne(fe)||z(fe))return $=$.get(Y)||null,ce(G,$,fe,Se,null);if(typeof fe.then=="function")return ae($,G,Y,gf(fe),Se);if(fe.$$typeof===C)return ae($,G,Y,rf(G,fe),Se);yf(G,fe)}return null}function ze($,G,Y,fe){for(var Se=null,Je=null,Me=G,Le=G=0,fn=null;Me!==null&&Le<Y.length;Le++){Me.index>Le?(fn=Me,Me=null):fn=Me.sibling;var ct=ee($,Me,Y[Le],fe);if(ct===null){Me===null&&(Me=fn);break}o&&Me&&ct.alternate===null&&u($,Me),G=x(ct,G,Le),Je===null?Se=ct:Je.sibling=ct,Je=ct,Me=fn}if(Le===Y.length)return h($,Me),pt&&yo($,Le),Se;if(Me===null){for(;Le<Y.length;Le++)Me=he($,Y[Le],fe),Me!==null&&(G=x(Me,G,Le),Je===null?Se=Me:Je.sibling=Me,Je=Me);return pt&&yo($,Le),Se}for(Me=p(Me);Le<Y.length;Le++)fn=ae(Me,$,Le,Y[Le],fe),fn!==null&&(o&&fn.alternate!==null&&Me.delete(fn.key===null?Le:fn.key),G=x(fn,G,Le),Je===null?Se=fn:Je.sibling=fn,Je=fn);return o&&Me.forEach(function(Oi){return u($,Oi)}),pt&&yo($,Le),Se}function Be($,G,Y,fe){if(Y==null)throw Error(n(151));for(var Se=null,Je=null,Me=G,Le=G=0,fn=null,ct=Y.next();Me!==null&&!ct.done;Le++,ct=Y.next()){Me.index>Le?(fn=Me,Me=null):fn=Me.sibling;var Oi=ee($,Me,ct.value,fe);if(Oi===null){Me===null&&(Me=fn);break}o&&Me&&Oi.alternate===null&&u($,Me),G=x(Oi,G,Le),Je===null?Se=Oi:Je.sibling=Oi,Je=Oi,Me=fn}if(ct.done)return h($,Me),pt&&yo($,Le),Se;if(Me===null){for(;!ct.done;Le++,ct=Y.next())ct=he($,ct.value,fe),ct!==null&&(G=x(ct,G,Le),Je===null?Se=ct:Je.sibling=ct,Je=ct);return pt&&yo($,Le),Se}for(Me=p(Me);!ct.done;Le++,ct=Y.next())ct=ae(Me,$,Le,ct.value,fe),ct!==null&&(o&&ct.alternate!==null&&Me.delete(ct.key===null?Le:ct.key),G=x(ct,G,Le),Je===null?Se=ct:Je.sibling=ct,Je=ct);return o&&Me.forEach(function(zT){return u($,zT)}),pt&&yo($,Le),Se}function St($,G,Y,fe){if(typeof Y=="object"&&Y!==null&&Y.type===b&&Y.key===null&&(Y=Y.props.children),typeof Y=="object"&&Y!==null){switch(Y.$$typeof){case m:e:{for(var Se=Y.key;G!==null;){if(G.key===Se){if(Se=Y.type,Se===b){if(G.tag===7){h($,G.sibling),fe=y(G,Y.props.children),fe.return=$,$=fe;break e}}else if(G.elementType===Se||typeof Se=="object"&&Se!==null&&Se.$$typeof===I&&g1(Se)===G.type){h($,G.sibling),fe=y(G,Y.props),yl(fe,Y),fe.return=$,$=fe;break e}h($,G);break}else u($,G);G=G.sibling}Y.type===b?(fe=mo(Y.props.children,$.mode,fe,Y.key),fe.return=$,$=fe):(fe=Jc(Y.type,Y.key,Y.props,null,$.mode,fe),yl(fe,Y),fe.return=$,$=fe)}return T($);case g:e:{for(Se=Y.key;G!==null;){if(G.key===Se)if(G.tag===4&&G.stateNode.containerInfo===Y.containerInfo&&G.stateNode.implementation===Y.implementation){h($,G.sibling),fe=y(G,Y.children||[]),fe.return=$,$=fe;break e}else{h($,G);break}else u($,G);G=G.sibling}fe=bp(Y,$.mode,fe),fe.return=$,$=fe}return T($);case I:return Se=Y._init,Y=Se(Y._payload),St($,G,Y,fe)}if(ne(Y))return ze($,G,Y,fe);if(z(Y)){if(Se=z(Y),typeof Se!="function")throw Error(n(150));return Y=Se.call(Y),Be($,G,Y,fe)}if(typeof Y.then=="function")return St($,G,gf(Y),fe);if(Y.$$typeof===C)return St($,G,rf($,Y),fe);yf($,Y)}return typeof Y=="string"&&Y!==""||typeof Y=="number"||typeof Y=="bigint"?(Y=""+Y,G!==null&&G.tag===6?(h($,G.sibling),fe=y(G,Y),fe.return=$,$=fe):(h($,G),fe=yp(Y,$.mode,fe),fe.return=$,$=fe),T($)):h($,G)}return function($,G,Y,fe){try{gl=0;var Se=St($,G,Y,fe);return Ts=null,Se}catch(Me){if(Me===ul||Me===of)throw Me;var Je=tr(29,Me,null,$.mode);return Je.lanes=fe,Je.return=$,Je}finally{}}}var Ds=y1(!0),b1=y1(!1),Er=q(null),Zr=null;function mi(o){var u=o.alternate;se(Qt,Qt.current&1),se(Er,o),Zr===null&&(u===null||Es.current!==null||u.memoizedState!==null)&&(Zr=o)}function x1(o){if(o.tag===22){if(se(Qt,Qt.current),se(Er,o),Zr===null){var u=o.alternate;u!==null&&u.memoizedState!==null&&(Zr=o)}}else gi()}function gi(){se(Qt,Qt.current),se(Er,Er.current)}function Ia(o){oe(Er),Zr===o&&(Zr=null),oe(Qt)}var Qt=q(0);function bf(o){for(var u=o;u!==null;){if(u.tag===13){var h=u.memoizedState;if(h!==null&&(h=h.dehydrated,h===null||h.data==="$?"||Vv(h)))return u}else if(u.tag===19&&u.memoizedProps.revealOrder!==void 0){if((u.flags&128)!==0)return u}else if(u.child!==null){u.child.return=u,u=u.child;continue}if(u===o)break;for(;u.sibling===null;){if(u.return===null||u.return===o)return null;u=u.return}u.sibling.return=u.return,u=u.sibling}return null}function Zp(o,u,h,p){u=o.memoizedState,h=h(p,u),h=h==null?u:d({},u,h),o.memoizedState=h,o.lanes===0&&(o.updateQueue.baseState=h)}var Jp={enqueueSetState:function(o,u,h){o=o._reactInternals;var p=ir(),y=di(p);y.payload=u,h!=null&&(y.callback=h),u=pi(o,y,p),u!==null&&(or(u,o,p),cl(u,o,p))},enqueueReplaceState:function(o,u,h){o=o._reactInternals;var p=ir(),y=di(p);y.tag=1,y.payload=u,h!=null&&(y.callback=h),u=pi(o,y,p),u!==null&&(or(u,o,p),cl(u,o,p))},enqueueForceUpdate:function(o,u){o=o._reactInternals;var h=ir(),p=di(h);p.tag=2,u!=null&&(p.callback=u),u=pi(o,p,h),u!==null&&(or(u,o,h),cl(u,o,h))}};function w1(o,u,h,p,y,x,T){return o=o.stateNode,typeof o.shouldComponentUpdate=="function"?o.shouldComponentUpdate(p,x,T):u.prototype&&u.prototype.isPureReactComponent?!el(h,p)||!el(y,x):!0}function _1(o,u,h,p){o=u.state,typeof u.componentWillReceiveProps=="function"&&u.componentWillReceiveProps(h,p),typeof u.UNSAFE_componentWillReceiveProps=="function"&&u.UNSAFE_componentWillReceiveProps(h,p),u.state!==o&&Jp.enqueueReplaceState(u,u.state,null)}function Co(o,u){var h=u;if("ref"in u){h={};for(var p in u)p!=="ref"&&(h[p]=u[p])}if(o=o.defaultProps){h===u&&(h=d({},h));for(var y in o)h[y]===void 0&&(h[y]=o[y])}return h}var xf=typeof reportError=="function"?reportError:function(o){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var u=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof o=="object"&&o!==null&&typeof o.message=="string"?String(o.message):String(o),error:o});if(!window.dispatchEvent(u))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",o);return}console.error(o)};function S1(o){xf(o)}function E1(o){console.error(o)}function C1(o){xf(o)}function wf(o,u){try{var h=o.onUncaughtError;h(u.value,{componentStack:u.stack})}catch(p){setTimeout(function(){throw p})}}function R1(o,u,h){try{var p=o.onCaughtError;p(h.value,{componentStack:h.stack,errorBoundary:u.tag===1?u.stateNode:null})}catch(y){setTimeout(function(){throw y})}}function ev(o,u,h){return h=di(h),h.tag=3,h.payload={element:null},h.callback=function(){wf(o,u)},h}function A1(o){return o=di(o),o.tag=3,o}function T1(o,u,h,p){var y=h.type.getDerivedStateFromError;if(typeof y=="function"){var x=p.value;o.payload=function(){return y(x)},o.callback=function(){R1(u,h,p)}}var T=h.stateNode;T!==null&&typeof T.componentDidCatch=="function"&&(o.callback=function(){R1(u,h,p),typeof y!="function"&&(Si===null?Si=new Set([this]):Si.add(this));var N=p.stack;this.componentDidCatch(p.value,{componentStack:N!==null?N:""})})}function zA(o,u,h,p,y){if(h.flags|=32768,p!==null&&typeof p=="object"&&typeof p.then=="function"){if(u=h.alternate,u!==null&&il(u,h,y,!0),h=Er.current,h!==null){switch(h.tag){case 13:return Zr===null?Ev():h.alternate===null&&Lt===0&&(Lt=3),h.flags&=-257,h.flags|=65536,h.lanes=y,p===Dp?h.flags|=16384:(u=h.updateQueue,u===null?h.updateQueue=new Set([p]):u.add(p),Rv(o,p,y)),!1;case 22:return h.flags|=65536,p===Dp?h.flags|=16384:(u=h.updateQueue,u===null?(u={transitions:null,markerInstances:null,retryQueue:new Set([p])},h.updateQueue=u):(h=u.retryQueue,h===null?u.retryQueue=new Set([p]):h.add(p)),Rv(o,p,y)),!1}throw Error(n(435,h.tag))}return Rv(o,p,y),Ev(),!1}if(pt)return u=Er.current,u!==null?((u.flags&65536)===0&&(u.flags|=256),u.flags|=65536,u.lanes=y,p!==_p&&(o=Error(n(422),{cause:p}),al(xr(o,h)))):(p!==_p&&(u=Error(n(423),{cause:p}),al(xr(u,h))),o=o.current.alternate,o.flags|=65536,y&=-y,o.lanes|=y,p=xr(p,h),y=ev(o.stateNode,p,y),Np(o,y),Lt!==4&&(Lt=2)),!1;var x=Error(n(520),{cause:p});if(x=xr(x,h),Cl===null?Cl=[x]:Cl.push(x),Lt!==4&&(Lt=2),u===null)return!0;p=xr(p,h),h=u;do{switch(h.tag){case 3:return h.flags|=65536,o=y&-y,h.lanes|=o,o=ev(h.stateNode,p,o),Np(h,o),!1;case 1:if(u=h.type,x=h.stateNode,(h.flags&128)===0&&(typeof u.getDerivedStateFromError=="function"||x!==null&&typeof x.componentDidCatch=="function"&&(Si===null||!Si.has(x))))return h.flags|=65536,y&=-y,h.lanes|=y,y=A1(y),T1(y,o,h,p),Np(h,y),!1}h=h.return}while(h!==null);return!1}var D1=Error(n(461)),ln=!1;function yn(o,u,h,p){u.child=o===null?b1(u,null,h,p):Ds(u,o.child,h,p)}function k1(o,u,h,p,y){h=h.render;var x=u.ref;if("ref"in p){var T={};for(var N in p)N!=="ref"&&(T[N]=p[N])}else T=p;return _o(u),p=Lp(o,u,h,T,x,y),N=Pp(),o!==null&&!ln?(zp(o,u,y),Fa(o,u,y)):(pt&&N&&xp(u),u.flags|=1,yn(o,u,p,y),u.child)}function O1(o,u,h,p,y){if(o===null){var x=h.type;return typeof x=="function"&&!gp(x)&&x.defaultProps===void 0&&h.compare===null?(u.tag=15,u.type=x,N1(o,u,x,p,y)):(o=Jc(h.type,null,p,u,u.mode,y),o.ref=u.ref,o.return=u,u.child=o)}if(x=o.child,!uv(o,y)){var T=x.memoizedProps;if(h=h.compare,h=h!==null?h:el,h(T,p)&&o.ref===u.ref)return Fa(o,u,y)}return u.flags|=1,o=Ta(x,p),o.ref=u.ref,o.return=u,u.child=o}function N1(o,u,h,p,y){if(o!==null){var x=o.memoizedProps;if(el(x,p)&&o.ref===u.ref)if(ln=!1,u.pendingProps=p=x,uv(o,y))(o.flags&131072)!==0&&(ln=!0);else return u.lanes=o.lanes,Fa(o,u,y)}return tv(o,u,h,p,y)}function M1(o,u,h){var p=u.pendingProps,y=p.children,x=o!==null?o.memoizedState:null;if(p.mode==="hidden"){if((u.flags&128)!==0){if(p=x!==null?x.baseLanes|h:h,o!==null){for(y=u.child=o.child,x=0;y!==null;)x=x|y.lanes|y.childLanes,y=y.sibling;u.childLanes=x&~p}else u.childLanes=0,u.child=null;return I1(o,u,p,h)}if((h&536870912)!==0)u.memoizedState={baseLanes:0,cachePool:null},o!==null&&af(u,x!==null?x.cachePool:null),x!==null?Nb(u,x):Ip(),x1(u);else return u.lanes=u.childLanes=536870912,I1(o,u,x!==null?x.baseLanes|h:h,h)}else x!==null?(af(u,x.cachePool),Nb(u,x),gi(),u.memoizedState=null):(o!==null&&af(u,null),Ip(),gi());return yn(o,u,y,h),u.child}function I1(o,u,h,p){var y=Tp();return y=y===null?null:{parent:Yt._currentValue,pool:y},u.memoizedState={baseLanes:h,cachePool:y},o!==null&&af(u,null),Ip(),x1(u),o!==null&&il(o,u,p,!0),null}function _f(o,u){var h=u.ref;if(h===null)o!==null&&o.ref!==null&&(u.flags|=4194816);else{if(typeof h!="function"&&typeof h!="object")throw Error(n(284));(o===null||o.ref!==h)&&(u.flags|=4194816)}}function tv(o,u,h,p,y){return _o(u),h=Lp(o,u,h,p,void 0,y),p=Pp(),o!==null&&!ln?(zp(o,u,y),Fa(o,u,y)):(pt&&p&&xp(u),u.flags|=1,yn(o,u,h,y),u.child)}function F1(o,u,h,p,y,x){return _o(u),u.updateQueue=null,h=Ib(u,p,h,y),Mb(o),p=Pp(),o!==null&&!ln?(zp(o,u,x),Fa(o,u,x)):(pt&&p&&xp(u),u.flags|=1,yn(o,u,h,x),u.child)}function B1(o,u,h,p,y){if(_o(u),u.stateNode===null){var x=bs,T=h.contextType;typeof T=="object"&&T!==null&&(x=Rn(T)),x=new h(p,x),u.memoizedState=x.state!==null&&x.state!==void 0?x.state:null,x.updater=Jp,u.stateNode=x,x._reactInternals=u,x=u.stateNode,x.props=p,x.state=u.memoizedState,x.refs={},kp(u),T=h.contextType,x.context=typeof T=="object"&&T!==null?Rn(T):bs,x.state=u.memoizedState,T=h.getDerivedStateFromProps,typeof T=="function"&&(Zp(u,h,T,p),x.state=u.memoizedState),typeof h.getDerivedStateFromProps=="function"||typeof x.getSnapshotBeforeUpdate=="function"||typeof x.UNSAFE_componentWillMount!="function"&&typeof x.componentWillMount!="function"||(T=x.state,typeof x.componentWillMount=="function"&&x.componentWillMount(),typeof x.UNSAFE_componentWillMount=="function"&&x.UNSAFE_componentWillMount(),T!==x.state&&Jp.enqueueReplaceState(x,x.state,null),hl(u,p,x,y),fl(),x.state=u.memoizedState),typeof x.componentDidMount=="function"&&(u.flags|=4194308),p=!0}else if(o===null){x=u.stateNode;var N=u.memoizedProps,U=Co(h,N);x.props=U;var Z=x.context,ce=h.contextType;T=bs,typeof ce=="object"&&ce!==null&&(T=Rn(ce));var he=h.getDerivedStateFromProps;ce=typeof he=="function"||typeof x.getSnapshotBeforeUpdate=="function",N=u.pendingProps!==N,ce||typeof x.UNSAFE_componentWillReceiveProps!="function"&&typeof x.componentWillReceiveProps!="function"||(N||Z!==T)&&_1(u,x,p,T),hi=!1;var ee=u.memoizedState;x.state=ee,hl(u,p,x,y),fl(),Z=u.memoizedState,N||ee!==Z||hi?(typeof he=="function"&&(Zp(u,h,he,p),Z=u.memoizedState),(U=hi||w1(u,h,U,p,ee,Z,T))?(ce||typeof x.UNSAFE_componentWillMount!="function"&&typeof x.componentWillMount!="function"||(typeof x.componentWillMount=="function"&&x.componentWillMount(),typeof x.UNSAFE_componentWillMount=="function"&&x.UNSAFE_componentWillMount()),typeof x.componentDidMount=="function"&&(u.flags|=4194308)):(typeof x.componentDidMount=="function"&&(u.flags|=4194308),u.memoizedProps=p,u.memoizedState=Z),x.props=p,x.state=Z,x.context=T,p=U):(typeof x.componentDidMount=="function"&&(u.flags|=4194308),p=!1)}else{x=u.stateNode,Op(o,u),T=u.memoizedProps,ce=Co(h,T),x.props=ce,he=u.pendingProps,ee=x.context,Z=h.contextType,U=bs,typeof Z=="object"&&Z!==null&&(U=Rn(Z)),N=h.getDerivedStateFromProps,(Z=typeof N=="function"||typeof x.getSnapshotBeforeUpdate=="function")||typeof x.UNSAFE_componentWillReceiveProps!="function"&&typeof x.componentWillReceiveProps!="function"||(T!==he||ee!==U)&&_1(u,x,p,U),hi=!1,ee=u.memoizedState,x.state=ee,hl(u,p,x,y),fl();var ae=u.memoizedState;T!==he||ee!==ae||hi||o!==null&&o.dependencies!==null&&nf(o.dependencies)?(typeof N=="function"&&(Zp(u,h,N,p),ae=u.memoizedState),(ce=hi||w1(u,h,ce,p,ee,ae,U)||o!==null&&o.dependencies!==null&&nf(o.dependencies))?(Z||typeof x.UNSAFE_componentWillUpdate!="function"&&typeof x.componentWillUpdate!="function"||(typeof x.componentWillUpdate=="function"&&x.componentWillUpdate(p,ae,U),typeof x.UNSAFE_componentWillUpdate=="function"&&x.UNSAFE_componentWillUpdate(p,ae,U)),typeof x.componentDidUpdate=="function"&&(u.flags|=4),typeof x.getSnapshotBeforeUpdate=="function"&&(u.flags|=1024)):(typeof x.componentDidUpdate!="function"||T===o.memoizedProps&&ee===o.memoizedState||(u.flags|=4),typeof x.getSnapshotBeforeUpdate!="function"||T===o.memoizedProps&&ee===o.memoizedState||(u.flags|=1024),u.memoizedProps=p,u.memoizedState=ae),x.props=p,x.state=ae,x.context=U,p=ce):(typeof x.componentDidUpdate!="function"||T===o.memoizedProps&&ee===o.memoizedState||(u.flags|=4),typeof x.getSnapshotBeforeUpdate!="function"||T===o.memoizedProps&&ee===o.memoizedState||(u.flags|=1024),p=!1)}return x=p,_f(o,u),p=(u.flags&128)!==0,x||p?(x=u.stateNode,h=p&&typeof h.getDerivedStateFromError!="function"?null:x.render(),u.flags|=1,o!==null&&p?(u.child=Ds(u,o.child,null,y),u.child=Ds(u,null,h,y)):yn(o,u,h,y),u.memoizedState=x.state,o=u.child):o=Fa(o,u,y),o}function L1(o,u,h,p){return rl(),u.flags|=256,yn(o,u,h,p),u.child}var nv={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function rv(o){return{baseLanes:o,cachePool:Eb()}}function av(o,u,h){return o=o!==null?o.childLanes&~h:0,u&&(o|=Cr),o}function P1(o,u,h){var p=u.pendingProps,y=!1,x=(u.flags&128)!==0,T;if((T=x)||(T=o!==null&&o.memoizedState===null?!1:(Qt.current&2)!==0),T&&(y=!0,u.flags&=-129),T=(u.flags&32)!==0,u.flags&=-33,o===null){if(pt){if(y?mi(u):gi(),pt){var N=Bt,U;if(U=N){e:{for(U=N,N=Qr;U.nodeType!==8;){if(!N){N=null;break e}if(U=zr(U.nextSibling),U===null){N=null;break e}}N=U}N!==null?(u.memoizedState={dehydrated:N,treeContext:go!==null?{id:Da,overflow:ka}:null,retryLane:536870912,hydrationErrors:null},U=tr(18,null,null,0),U.stateNode=N,U.return=u,u.child=U,Fn=u,Bt=null,U=!0):U=!1}U||xo(u)}if(N=u.memoizedState,N!==null&&(N=N.dehydrated,N!==null))return Vv(N)?u.lanes=32:u.lanes=536870912,null;Ia(u)}return N=p.children,p=p.fallback,y?(gi(),y=u.mode,N=Sf({mode:"hidden",children:N},y),p=mo(p,y,h,null),N.return=u,p.return=u,N.sibling=p,u.child=N,y=u.child,y.memoizedState=rv(h),y.childLanes=av(o,T,h),u.memoizedState=nv,p):(mi(u),iv(u,N))}if(U=o.memoizedState,U!==null&&(N=U.dehydrated,N!==null)){if(x)u.flags&256?(mi(u),u.flags&=-257,u=ov(o,u,h)):u.memoizedState!==null?(gi(),u.child=o.child,u.flags|=128,u=null):(gi(),y=p.fallback,N=u.mode,p=Sf({mode:"visible",children:p.children},N),y=mo(y,N,h,null),y.flags|=2,p.return=u,y.return=u,p.sibling=y,u.child=p,Ds(u,o.child,null,h),p=u.child,p.memoizedState=rv(h),p.childLanes=av(o,T,h),u.memoizedState=nv,u=y);else if(mi(u),Vv(N)){if(T=N.nextSibling&&N.nextSibling.dataset,T)var Z=T.dgst;T=Z,p=Error(n(419)),p.stack="",p.digest=T,al({value:p,source:null,stack:null}),u=ov(o,u,h)}else if(ln||il(o,u,h,!1),T=(h&o.childLanes)!==0,ln||T){if(T=Rt,T!==null&&(p=h&-h,p=(p&42)!==0?1:Hd(p),p=(p&(T.suspendedLanes|h))!==0?0:p,p!==0&&p!==U.retryLane))throw U.retryLane=p,ys(o,p),or(T,o,p),D1;N.data==="$?"||Ev(),u=ov(o,u,h)}else N.data==="$?"?(u.flags|=192,u.child=o.child,u=null):(o=U.treeContext,Bt=zr(N.nextSibling),Fn=u,pt=!0,bo=null,Qr=!1,o!==null&&(_r[Sr++]=Da,_r[Sr++]=ka,_r[Sr++]=go,Da=o.id,ka=o.overflow,go=u),u=iv(u,p.children),u.flags|=4096);return u}return y?(gi(),y=p.fallback,N=u.mode,U=o.child,Z=U.sibling,p=Ta(U,{mode:"hidden",children:p.children}),p.subtreeFlags=U.subtreeFlags&65011712,Z!==null?y=Ta(Z,y):(y=mo(y,N,h,null),y.flags|=2),y.return=u,p.return=u,p.sibling=y,u.child=p,p=y,y=u.child,N=o.child.memoizedState,N===null?N=rv(h):(U=N.cachePool,U!==null?(Z=Yt._currentValue,U=U.parent!==Z?{parent:Z,pool:Z}:U):U=Eb(),N={baseLanes:N.baseLanes|h,cachePool:U}),y.memoizedState=N,y.childLanes=av(o,T,h),u.memoizedState=nv,p):(mi(u),h=o.child,o=h.sibling,h=Ta(h,{mode:"visible",children:p.children}),h.return=u,h.sibling=null,o!==null&&(T=u.deletions,T===null?(u.deletions=[o],u.flags|=16):T.push(o)),u.child=h,u.memoizedState=null,h)}function iv(o,u){return u=Sf({mode:"visible",children:u},o.mode),u.return=o,o.child=u}function Sf(o,u){return o=tr(22,o,null,u),o.lanes=0,o.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},o}function ov(o,u,h){return Ds(u,o.child,null,h),o=iv(u,u.pendingProps.children),o.flags|=2,u.memoizedState=null,o}function z1(o,u,h){o.lanes|=u;var p=o.alternate;p!==null&&(p.lanes|=u),Ep(o.return,u,h)}function sv(o,u,h,p,y){var x=o.memoizedState;x===null?o.memoizedState={isBackwards:u,rendering:null,renderingStartTime:0,last:p,tail:h,tailMode:y}:(x.isBackwards=u,x.rendering=null,x.renderingStartTime=0,x.last=p,x.tail=h,x.tailMode=y)}function U1(o,u,h){var p=u.pendingProps,y=p.revealOrder,x=p.tail;if(yn(o,u,p.children,h),p=Qt.current,(p&2)!==0)p=p&1|2,u.flags|=128;else{if(o!==null&&(o.flags&128)!==0)e:for(o=u.child;o!==null;){if(o.tag===13)o.memoizedState!==null&&z1(o,h,u);else if(o.tag===19)z1(o,h,u);else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===u)break e;for(;o.sibling===null;){if(o.return===null||o.return===u)break e;o=o.return}o.sibling.return=o.return,o=o.sibling}p&=1}switch(se(Qt,p),y){case"forwards":for(h=u.child,y=null;h!==null;)o=h.alternate,o!==null&&bf(o)===null&&(y=h),h=h.sibling;h=y,h===null?(y=u.child,u.child=null):(y=h.sibling,h.sibling=null),sv(u,!1,y,h,x);break;case"backwards":for(h=null,y=u.child,u.child=null;y!==null;){if(o=y.alternate,o!==null&&bf(o)===null){u.child=y;break}o=y.sibling,y.sibling=h,h=y,y=o}sv(u,!0,h,null,x);break;case"together":sv(u,!1,null,null,void 0);break;default:u.memoizedState=null}return u.child}function Fa(o,u,h){if(o!==null&&(u.dependencies=o.dependencies),_i|=u.lanes,(h&u.childLanes)===0)if(o!==null){if(il(o,u,h,!1),(h&u.childLanes)===0)return null}else return null;if(o!==null&&u.child!==o.child)throw Error(n(153));if(u.child!==null){for(o=u.child,h=Ta(o,o.pendingProps),u.child=h,h.return=u;o.sibling!==null;)o=o.sibling,h=h.sibling=Ta(o,o.pendingProps),h.return=u;h.sibling=null}return u.child}function uv(o,u){return(o.lanes&u)!==0?!0:(o=o.dependencies,!!(o!==null&&nf(o)))}function UA(o,u,h){switch(u.tag){case 3:be(u,u.stateNode.containerInfo),fi(u,Yt,o.memoizedState.cache),rl();break;case 27:case 5:lt(u);break;case 4:be(u,u.stateNode.containerInfo);break;case 10:fi(u,u.type,u.memoizedProps.value);break;case 13:var p=u.memoizedState;if(p!==null)return p.dehydrated!==null?(mi(u),u.flags|=128,null):(h&u.child.childLanes)!==0?P1(o,u,h):(mi(u),o=Fa(o,u,h),o!==null?o.sibling:null);mi(u);break;case 19:var y=(o.flags&128)!==0;if(p=(h&u.childLanes)!==0,p||(il(o,u,h,!1),p=(h&u.childLanes)!==0),y){if(p)return U1(o,u,h);u.flags|=128}if(y=u.memoizedState,y!==null&&(y.rendering=null,y.tail=null,y.lastEffect=null),se(Qt,Qt.current),p)break;return null;case 22:case 23:return u.lanes=0,M1(o,u,h);case 24:fi(u,Yt,o.memoizedState.cache)}return Fa(o,u,h)}function V1(o,u,h){if(o!==null)if(o.memoizedProps!==u.pendingProps)ln=!0;else{if(!uv(o,h)&&(u.flags&128)===0)return ln=!1,UA(o,u,h);ln=(o.flags&131072)!==0}else ln=!1,pt&&(u.flags&1048576)!==0&&gb(u,tf,u.index);switch(u.lanes=0,u.tag){case 16:e:{o=u.pendingProps;var p=u.elementType,y=p._init;if(p=y(p._payload),u.type=p,typeof p=="function")gp(p)?(o=Co(p,o),u.tag=1,u=B1(null,u,p,o,h)):(u.tag=0,u=tv(null,u,p,o,h));else{if(p!=null){if(y=p.$$typeof,y===R){u.tag=11,u=k1(null,u,p,o,h);break e}else if(y===k){u.tag=14,u=O1(null,u,p,o,h);break e}}throw u=te(p)||p,Error(n(306,u,""))}}return u;case 0:return tv(o,u,u.type,u.pendingProps,h);case 1:return p=u.type,y=Co(p,u.pendingProps),B1(o,u,p,y,h);case 3:e:{if(be(u,u.stateNode.containerInfo),o===null)throw Error(n(387));p=u.pendingProps;var x=u.memoizedState;y=x.element,Op(o,u),hl(u,p,null,h);var T=u.memoizedState;if(p=T.cache,fi(u,Yt,p),p!==x.cache&&Cp(u,[Yt],h,!0),fl(),p=T.element,x.isDehydrated)if(x={element:p,isDehydrated:!1,cache:T.cache},u.updateQueue.baseState=x,u.memoizedState=x,u.flags&256){u=L1(o,u,p,h);break e}else if(p!==y){y=xr(Error(n(424)),u),al(y),u=L1(o,u,p,h);break e}else{switch(o=u.stateNode.containerInfo,o.nodeType){case 9:o=o.body;break;default:o=o.nodeName==="HTML"?o.ownerDocument.body:o}for(Bt=zr(o.firstChild),Fn=u,pt=!0,bo=null,Qr=!0,h=b1(u,null,p,h),u.child=h;h;)h.flags=h.flags&-3|4096,h=h.sibling}else{if(rl(),p===y){u=Fa(o,u,h);break e}yn(o,u,p,h)}u=u.child}return u;case 26:return _f(o,u),o===null?(h=Gx(u.type,null,u.pendingProps,null))?u.memoizedState=h:pt||(h=u.type,o=u.pendingProps,p=Lf(ve.current).createElement(h),p[Cn]=u,p[Vn]=o,xn(p,h,o),un(p),u.stateNode=p):u.memoizedState=Gx(u.type,o.memoizedProps,u.pendingProps,o.memoizedState),null;case 27:return lt(u),o===null&&pt&&(p=u.stateNode=Hx(u.type,u.pendingProps,ve.current),Fn=u,Qr=!0,y=Bt,Ri(u.type)?(Hv=y,Bt=zr(p.firstChild)):Bt=y),yn(o,u,u.pendingProps.children,h),_f(o,u),o===null&&(u.flags|=4194304),u.child;case 5:return o===null&&pt&&((y=p=Bt)&&(p=pT(p,u.type,u.pendingProps,Qr),p!==null?(u.stateNode=p,Fn=u,Bt=zr(p.firstChild),Qr=!1,y=!0):y=!1),y||xo(u)),lt(u),y=u.type,x=u.pendingProps,T=o!==null?o.memoizedProps:null,p=x.children,Pv(y,x)?p=null:T!==null&&Pv(y,T)&&(u.flags|=32),u.memoizedState!==null&&(y=Lp(o,u,NA,null,null,h),Il._currentValue=y),_f(o,u),yn(o,u,p,h),u.child;case 6:return o===null&&pt&&((o=h=Bt)&&(h=vT(h,u.pendingProps,Qr),h!==null?(u.stateNode=h,Fn=u,Bt=null,o=!0):o=!1),o||xo(u)),null;case 13:return P1(o,u,h);case 4:return be(u,u.stateNode.containerInfo),p=u.pendingProps,o===null?u.child=Ds(u,null,p,h):yn(o,u,p,h),u.child;case 11:return k1(o,u,u.type,u.pendingProps,h);case 7:return yn(o,u,u.pendingProps,h),u.child;case 8:return yn(o,u,u.pendingProps.children,h),u.child;case 12:return yn(o,u,u.pendingProps.children,h),u.child;case 10:return p=u.pendingProps,fi(u,u.type,p.value),yn(o,u,p.children,h),u.child;case 9:return y=u.type._context,p=u.pendingProps.children,_o(u),y=Rn(y),p=p(y),u.flags|=1,yn(o,u,p,h),u.child;case 14:return O1(o,u,u.type,u.pendingProps,h);case 15:return N1(o,u,u.type,u.pendingProps,h);case 19:return U1(o,u,h);case 31:return p=u.pendingProps,h=u.mode,p={mode:p.mode,children:p.children},o===null?(h=Sf(p,h),h.ref=u.ref,u.child=h,h.return=u,u=h):(h=Ta(o.child,p),h.ref=u.ref,u.child=h,h.return=u,u=h),u;case 22:return M1(o,u,h);case 24:return _o(u),p=Rn(Yt),o===null?(y=Tp(),y===null&&(y=Rt,x=Rp(),y.pooledCache=x,x.refCount++,x!==null&&(y.pooledCacheLanes|=h),y=x),u.memoizedState={parent:p,cache:y},kp(u),fi(u,Yt,y)):((o.lanes&h)!==0&&(Op(o,u),hl(u,null,null,h),fl()),y=o.memoizedState,x=u.memoizedState,y.parent!==p?(y={parent:p,cache:p},u.memoizedState=y,u.lanes===0&&(u.memoizedState=u.updateQueue.baseState=y),fi(u,Yt,p)):(p=x.cache,fi(u,Yt,p),p!==y.cache&&Cp(u,[Yt],h,!0))),yn(o,u,u.pendingProps.children,h),u.child;case 29:throw u.pendingProps}throw Error(n(156,u.tag))}function Ba(o){o.flags|=4}function H1(o,u){if(u.type!=="stylesheet"||(u.state.loading&4)!==0)o.flags&=-16777217;else if(o.flags|=16777216,!Yx(u)){if(u=Er.current,u!==null&&((ot&4194048)===ot?Zr!==null:(ot&62914560)!==ot&&(ot&536870912)===0||u!==Zr))throw ll=Dp,Cb;o.flags|=8192}}function Ef(o,u){u!==null&&(o.flags|=4),o.flags&16384&&(u=o.tag!==22?x0():536870912,o.lanes|=u,Ms|=u)}function bl(o,u){if(!pt)switch(o.tailMode){case"hidden":u=o.tail;for(var h=null;u!==null;)u.alternate!==null&&(h=u),u=u.sibling;h===null?o.tail=null:h.sibling=null;break;case"collapsed":h=o.tail;for(var p=null;h!==null;)h.alternate!==null&&(p=h),h=h.sibling;p===null?u||o.tail===null?o.tail=null:o.tail.sibling=null:p.sibling=null}}function Ot(o){var u=o.alternate!==null&&o.alternate.child===o.child,h=0,p=0;if(u)for(var y=o.child;y!==null;)h|=y.lanes|y.childLanes,p|=y.subtreeFlags&65011712,p|=y.flags&65011712,y.return=o,y=y.sibling;else for(y=o.child;y!==null;)h|=y.lanes|y.childLanes,p|=y.subtreeFlags,p|=y.flags,y.return=o,y=y.sibling;return o.subtreeFlags|=p,o.childLanes=h,u}function VA(o,u,h){var p=u.pendingProps;switch(wp(u),u.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ot(u),null;case 1:return Ot(u),null;case 3:return h=u.stateNode,p=null,o!==null&&(p=o.memoizedState.cache),u.memoizedState.cache!==p&&(u.flags|=2048),Na(Yt),Ie(),h.pendingContext&&(h.context=h.pendingContext,h.pendingContext=null),(o===null||o.child===null)&&(nl(u)?Ba(u):o===null||o.memoizedState.isDehydrated&&(u.flags&256)===0||(u.flags|=1024,xb())),Ot(u),null;case 26:return h=u.memoizedState,o===null?(Ba(u),h!==null?(Ot(u),H1(u,h)):(Ot(u),u.flags&=-16777217)):h?h!==o.memoizedState?(Ba(u),Ot(u),H1(u,h)):(Ot(u),u.flags&=-16777217):(o.memoizedProps!==p&&Ba(u),Ot(u),u.flags&=-16777217),null;case 27:Pe(u),h=ve.current;var y=u.type;if(o!==null&&u.stateNode!=null)o.memoizedProps!==p&&Ba(u);else{if(!p){if(u.stateNode===null)throw Error(n(166));return Ot(u),null}o=pe.current,nl(u)?yb(u):(o=Hx(y,p,h),u.stateNode=o,Ba(u))}return Ot(u),null;case 5:if(Pe(u),h=u.type,o!==null&&u.stateNode!=null)o.memoizedProps!==p&&Ba(u);else{if(!p){if(u.stateNode===null)throw Error(n(166));return Ot(u),null}if(o=pe.current,nl(u))yb(u);else{switch(y=Lf(ve.current),o){case 1:o=y.createElementNS("http://www.w3.org/2000/svg",h);break;case 2:o=y.createElementNS("http://www.w3.org/1998/Math/MathML",h);break;default:switch(h){case"svg":o=y.createElementNS("http://www.w3.org/2000/svg",h);break;case"math":o=y.createElementNS("http://www.w3.org/1998/Math/MathML",h);break;case"script":o=y.createElement("div"),o.innerHTML="<script><\/script>",o=o.removeChild(o.firstChild);break;case"select":o=typeof p.is=="string"?y.createElement("select",{is:p.is}):y.createElement("select"),p.multiple?o.multiple=!0:p.size&&(o.size=p.size);break;default:o=typeof p.is=="string"?y.createElement(h,{is:p.is}):y.createElement(h)}}o[Cn]=u,o[Vn]=p;e:for(y=u.child;y!==null;){if(y.tag===5||y.tag===6)o.appendChild(y.stateNode);else if(y.tag!==4&&y.tag!==27&&y.child!==null){y.child.return=y,y=y.child;continue}if(y===u)break e;for(;y.sibling===null;){if(y.return===null||y.return===u)break e;y=y.return}y.sibling.return=y.return,y=y.sibling}u.stateNode=o;e:switch(xn(o,h,p),h){case"button":case"input":case"select":case"textarea":o=!!p.autoFocus;break e;case"img":o=!0;break e;default:o=!1}o&&Ba(u)}}return Ot(u),u.flags&=-16777217,null;case 6:if(o&&u.stateNode!=null)o.memoizedProps!==p&&Ba(u);else{if(typeof p!="string"&&u.stateNode===null)throw Error(n(166));if(o=ve.current,nl(u)){if(o=u.stateNode,h=u.memoizedProps,p=null,y=Fn,y!==null)switch(y.tag){case 27:case 5:p=y.memoizedProps}o[Cn]=u,o=!!(o.nodeValue===h||p!==null&&p.suppressHydrationWarning===!0||Fx(o.nodeValue,h)),o||xo(u)}else o=Lf(o).createTextNode(p),o[Cn]=u,u.stateNode=o}return Ot(u),null;case 13:if(p=u.memoizedState,o===null||o.memoizedState!==null&&o.memoizedState.dehydrated!==null){if(y=nl(u),p!==null&&p.dehydrated!==null){if(o===null){if(!y)throw Error(n(318));if(y=u.memoizedState,y=y!==null?y.dehydrated:null,!y)throw Error(n(317));y[Cn]=u}else rl(),(u.flags&128)===0&&(u.memoizedState=null),u.flags|=4;Ot(u),y=!1}else y=xb(),o!==null&&o.memoizedState!==null&&(o.memoizedState.hydrationErrors=y),y=!0;if(!y)return u.flags&256?(Ia(u),u):(Ia(u),null)}if(Ia(u),(u.flags&128)!==0)return u.lanes=h,u;if(h=p!==null,o=o!==null&&o.memoizedState!==null,h){p=u.child,y=null,p.alternate!==null&&p.alternate.memoizedState!==null&&p.alternate.memoizedState.cachePool!==null&&(y=p.alternate.memoizedState.cachePool.pool);var x=null;p.memoizedState!==null&&p.memoizedState.cachePool!==null&&(x=p.memoizedState.cachePool.pool),x!==y&&(p.flags|=2048)}return h!==o&&h&&(u.child.flags|=8192),Ef(u,u.updateQueue),Ot(u),null;case 4:return Ie(),o===null&&Mv(u.stateNode.containerInfo),Ot(u),null;case 10:return Na(u.type),Ot(u),null;case 19:if(oe(Qt),y=u.memoizedState,y===null)return Ot(u),null;if(p=(u.flags&128)!==0,x=y.rendering,x===null)if(p)bl(y,!1);else{if(Lt!==0||o!==null&&(o.flags&128)!==0)for(o=u.child;o!==null;){if(x=bf(o),x!==null){for(u.flags|=128,bl(y,!1),o=x.updateQueue,u.updateQueue=o,Ef(u,o),u.subtreeFlags=0,o=h,h=u.child;h!==null;)mb(h,o),h=h.sibling;return se(Qt,Qt.current&1|2),u.child}o=o.sibling}y.tail!==null&&Ut()>Af&&(u.flags|=128,p=!0,bl(y,!1),u.lanes=4194304)}else{if(!p)if(o=bf(x),o!==null){if(u.flags|=128,p=!0,o=o.updateQueue,u.updateQueue=o,Ef(u,o),bl(y,!0),y.tail===null&&y.tailMode==="hidden"&&!x.alternate&&!pt)return Ot(u),null}else 2*Ut()-y.renderingStartTime>Af&&h!==536870912&&(u.flags|=128,p=!0,bl(y,!1),u.lanes=4194304);y.isBackwards?(x.sibling=u.child,u.child=x):(o=y.last,o!==null?o.sibling=x:u.child=x,y.last=x)}return y.tail!==null?(u=y.tail,y.rendering=u,y.tail=u.sibling,y.renderingStartTime=Ut(),u.sibling=null,o=Qt.current,se(Qt,p?o&1|2:o&1),u):(Ot(u),null);case 22:case 23:return Ia(u),Fp(),p=u.memoizedState!==null,o!==null?o.memoizedState!==null!==p&&(u.flags|=8192):p&&(u.flags|=8192),p?(h&536870912)!==0&&(u.flags&128)===0&&(Ot(u),u.subtreeFlags&6&&(u.flags|=8192)):Ot(u),h=u.updateQueue,h!==null&&Ef(u,h.retryQueue),h=null,o!==null&&o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(h=o.memoizedState.cachePool.pool),p=null,u.memoizedState!==null&&u.memoizedState.cachePool!==null&&(p=u.memoizedState.cachePool.pool),p!==h&&(u.flags|=2048),o!==null&&oe(So),null;case 24:return h=null,o!==null&&(h=o.memoizedState.cache),u.memoizedState.cache!==h&&(u.flags|=2048),Na(Yt),Ot(u),null;case 25:return null;case 30:return null}throw Error(n(156,u.tag))}function HA(o,u){switch(wp(u),u.tag){case 1:return o=u.flags,o&65536?(u.flags=o&-65537|128,u):null;case 3:return Na(Yt),Ie(),o=u.flags,(o&65536)!==0&&(o&128)===0?(u.flags=o&-65537|128,u):null;case 26:case 27:case 5:return Pe(u),null;case 13:if(Ia(u),o=u.memoizedState,o!==null&&o.dehydrated!==null){if(u.alternate===null)throw Error(n(340));rl()}return o=u.flags,o&65536?(u.flags=o&-65537|128,u):null;case 19:return oe(Qt),null;case 4:return Ie(),null;case 10:return Na(u.type),null;case 22:case 23:return Ia(u),Fp(),o!==null&&oe(So),o=u.flags,o&65536?(u.flags=o&-65537|128,u):null;case 24:return Na(Yt),null;case 25:return null;default:return null}}function j1(o,u){switch(wp(u),u.tag){case 3:Na(Yt),Ie();break;case 26:case 27:case 5:Pe(u);break;case 4:Ie();break;case 13:Ia(u);break;case 19:oe(Qt);break;case 10:Na(u.type);break;case 22:case 23:Ia(u),Fp(),o!==null&&oe(So);break;case 24:Na(Yt)}}function xl(o,u){try{var h=u.updateQueue,p=h!==null?h.lastEffect:null;if(p!==null){var y=p.next;h=y;do{if((h.tag&o)===o){p=void 0;var x=h.create,T=h.inst;p=x(),T.destroy=p}h=h.next}while(h!==y)}}catch(N){Ct(u,u.return,N)}}function yi(o,u,h){try{var p=u.updateQueue,y=p!==null?p.lastEffect:null;if(y!==null){var x=y.next;p=x;do{if((p.tag&o)===o){var T=p.inst,N=T.destroy;if(N!==void 0){T.destroy=void 0,y=u;var U=h,Z=N;try{Z()}catch(ce){Ct(y,U,ce)}}}p=p.next}while(p!==x)}}catch(ce){Ct(u,u.return,ce)}}function W1(o){var u=o.updateQueue;if(u!==null){var h=o.stateNode;try{Ob(u,h)}catch(p){Ct(o,o.return,p)}}}function G1(o,u,h){h.props=Co(o.type,o.memoizedProps),h.state=o.memoizedState;try{h.componentWillUnmount()}catch(p){Ct(o,u,p)}}function wl(o,u){try{var h=o.ref;if(h!==null){switch(o.tag){case 26:case 27:case 5:var p=o.stateNode;break;case 30:p=o.stateNode;break;default:p=o.stateNode}typeof h=="function"?o.refCleanup=h(p):h.current=p}}catch(y){Ct(o,u,y)}}function Jr(o,u){var h=o.ref,p=o.refCleanup;if(h!==null)if(typeof p=="function")try{p()}catch(y){Ct(o,u,y)}finally{o.refCleanup=null,o=o.alternate,o!=null&&(o.refCleanup=null)}else if(typeof h=="function")try{h(null)}catch(y){Ct(o,u,y)}else h.current=null}function q1(o){var u=o.type,h=o.memoizedProps,p=o.stateNode;try{e:switch(u){case"button":case"input":case"select":case"textarea":h.autoFocus&&p.focus();break e;case"img":h.src?p.src=h.src:h.srcSet&&(p.srcset=h.srcSet)}}catch(y){Ct(o,o.return,y)}}function lv(o,u,h){try{var p=o.stateNode;lT(p,o.type,h,u),p[Vn]=u}catch(y){Ct(o,o.return,y)}}function K1(o){return o.tag===5||o.tag===3||o.tag===26||o.tag===27&&Ri(o.type)||o.tag===4}function cv(o){e:for(;;){for(;o.sibling===null;){if(o.return===null||K1(o.return))return null;o=o.return}for(o.sibling.return=o.return,o=o.sibling;o.tag!==5&&o.tag!==6&&o.tag!==18;){if(o.tag===27&&Ri(o.type)||o.flags&2||o.child===null||o.tag===4)continue e;o.child.return=o,o=o.child}if(!(o.flags&2))return o.stateNode}}function fv(o,u,h){var p=o.tag;if(p===5||p===6)o=o.stateNode,u?(h.nodeType===9?h.body:h.nodeName==="HTML"?h.ownerDocument.body:h).insertBefore(o,u):(u=h.nodeType===9?h.body:h.nodeName==="HTML"?h.ownerDocument.body:h,u.appendChild(o),h=h._reactRootContainer,h!=null||u.onclick!==null||(u.onclick=Bf));else if(p!==4&&(p===27&&Ri(o.type)&&(h=o.stateNode,u=null),o=o.child,o!==null))for(fv(o,u,h),o=o.sibling;o!==null;)fv(o,u,h),o=o.sibling}function Cf(o,u,h){var p=o.tag;if(p===5||p===6)o=o.stateNode,u?h.insertBefore(o,u):h.appendChild(o);else if(p!==4&&(p===27&&Ri(o.type)&&(h=o.stateNode),o=o.child,o!==null))for(Cf(o,u,h),o=o.sibling;o!==null;)Cf(o,u,h),o=o.sibling}function X1(o){var u=o.stateNode,h=o.memoizedProps;try{for(var p=o.type,y=u.attributes;y.length;)u.removeAttributeNode(y[0]);xn(u,p,h),u[Cn]=o,u[Vn]=h}catch(x){Ct(o,o.return,x)}}var La=!1,Ht=!1,hv=!1,$1=typeof WeakSet=="function"?WeakSet:Set,cn=null;function jA(o,u){if(o=o.containerInfo,Bv=jf,o=ob(o),cp(o)){if("selectionStart"in o)var h={start:o.selectionStart,end:o.selectionEnd};else e:{h=(h=o.ownerDocument)&&h.defaultView||window;var p=h.getSelection&&h.getSelection();if(p&&p.rangeCount!==0){h=p.anchorNode;var y=p.anchorOffset,x=p.focusNode;p=p.focusOffset;try{h.nodeType,x.nodeType}catch{h=null;break e}var T=0,N=-1,U=-1,Z=0,ce=0,he=o,ee=null;t:for(;;){for(var ae;he!==h||y!==0&&he.nodeType!==3||(N=T+y),he!==x||p!==0&&he.nodeType!==3||(U=T+p),he.nodeType===3&&(T+=he.nodeValue.length),(ae=he.firstChild)!==null;)ee=he,he=ae;for(;;){if(he===o)break t;if(ee===h&&++Z===y&&(N=T),ee===x&&++ce===p&&(U=T),(ae=he.nextSibling)!==null)break;he=ee,ee=he.parentNode}he=ae}h=N===-1||U===-1?null:{start:N,end:U}}else h=null}h=h||{start:0,end:0}}else h=null;for(Lv={focusedElem:o,selectionRange:h},jf=!1,cn=u;cn!==null;)if(u=cn,o=u.child,(u.subtreeFlags&1024)!==0&&o!==null)o.return=u,cn=o;else for(;cn!==null;){switch(u=cn,x=u.alternate,o=u.flags,u.tag){case 0:break;case 11:case 15:break;case 1:if((o&1024)!==0&&x!==null){o=void 0,h=u,y=x.memoizedProps,x=x.memoizedState,p=h.stateNode;try{var ze=Co(h.type,y,h.elementType===h.type);o=p.getSnapshotBeforeUpdate(ze,x),p.__reactInternalSnapshotBeforeUpdate=o}catch(Be){Ct(h,h.return,Be)}}break;case 3:if((o&1024)!==0){if(o=u.stateNode.containerInfo,h=o.nodeType,h===9)Uv(o);else if(h===1)switch(o.nodeName){case"HEAD":case"HTML":case"BODY":Uv(o);break;default:o.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((o&1024)!==0)throw Error(n(163))}if(o=u.sibling,o!==null){o.return=u.return,cn=o;break}cn=u.return}}function Y1(o,u,h){var p=h.flags;switch(h.tag){case 0:case 11:case 15:bi(o,h),p&4&&xl(5,h);break;case 1:if(bi(o,h),p&4)if(o=h.stateNode,u===null)try{o.componentDidMount()}catch(T){Ct(h,h.return,T)}else{var y=Co(h.type,u.memoizedProps);u=u.memoizedState;try{o.componentDidUpdate(y,u,o.__reactInternalSnapshotBeforeUpdate)}catch(T){Ct(h,h.return,T)}}p&64&&W1(h),p&512&&wl(h,h.return);break;case 3:if(bi(o,h),p&64&&(o=h.updateQueue,o!==null)){if(u=null,h.child!==null)switch(h.child.tag){case 27:case 5:u=h.child.stateNode;break;case 1:u=h.child.stateNode}try{Ob(o,u)}catch(T){Ct(h,h.return,T)}}break;case 27:u===null&&p&4&&X1(h);case 26:case 5:bi(o,h),u===null&&p&4&&q1(h),p&512&&wl(h,h.return);break;case 12:bi(o,h);break;case 13:bi(o,h),p&4&&J1(o,h),p&64&&(o=h.memoizedState,o!==null&&(o=o.dehydrated,o!==null&&(h=ZA.bind(null,h),mT(o,h))));break;case 22:if(p=h.memoizedState!==null||La,!p){u=u!==null&&u.memoizedState!==null||Ht,y=La;var x=Ht;La=p,(Ht=u)&&!x?xi(o,h,(h.subtreeFlags&8772)!==0):bi(o,h),La=y,Ht=x}break;case 30:break;default:bi(o,h)}}function Q1(o){var u=o.alternate;u!==null&&(o.alternate=null,Q1(u)),o.child=null,o.deletions=null,o.sibling=null,o.tag===5&&(u=o.stateNode,u!==null&&Gd(u)),o.stateNode=null,o.return=null,o.dependencies=null,o.memoizedProps=null,o.memoizedState=null,o.pendingProps=null,o.stateNode=null,o.updateQueue=null}var kt=null,Wn=!1;function Pa(o,u,h){for(h=h.child;h!==null;)Z1(o,u,h),h=h.sibling}function Z1(o,u,h){if(Wt&&typeof Wt.onCommitFiberUnmount=="function")try{Wt.onCommitFiberUnmount(Ca,h)}catch{}switch(h.tag){case 26:Ht||Jr(h,u),Pa(o,u,h),h.memoizedState?h.memoizedState.count--:h.stateNode&&(h=h.stateNode,h.parentNode.removeChild(h));break;case 27:Ht||Jr(h,u);var p=kt,y=Wn;Ri(h.type)&&(kt=h.stateNode,Wn=!1),Pa(o,u,h),kl(h.stateNode),kt=p,Wn=y;break;case 5:Ht||Jr(h,u);case 6:if(p=kt,y=Wn,kt=null,Pa(o,u,h),kt=p,Wn=y,kt!==null)if(Wn)try{(kt.nodeType===9?kt.body:kt.nodeName==="HTML"?kt.ownerDocument.body:kt).removeChild(h.stateNode)}catch(x){Ct(h,u,x)}else try{kt.removeChild(h.stateNode)}catch(x){Ct(h,u,x)}break;case 18:kt!==null&&(Wn?(o=kt,Ux(o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o,h.stateNode),Pl(o)):Ux(kt,h.stateNode));break;case 4:p=kt,y=Wn,kt=h.stateNode.containerInfo,Wn=!0,Pa(o,u,h),kt=p,Wn=y;break;case 0:case 11:case 14:case 15:Ht||yi(2,h,u),Ht||yi(4,h,u),Pa(o,u,h);break;case 1:Ht||(Jr(h,u),p=h.stateNode,typeof p.componentWillUnmount=="function"&&G1(h,u,p)),Pa(o,u,h);break;case 21:Pa(o,u,h);break;case 22:Ht=(p=Ht)||h.memoizedState!==null,Pa(o,u,h),Ht=p;break;default:Pa(o,u,h)}}function J1(o,u){if(u.memoizedState===null&&(o=u.alternate,o!==null&&(o=o.memoizedState,o!==null&&(o=o.dehydrated,o!==null))))try{Pl(o)}catch(h){Ct(u,u.return,h)}}function WA(o){switch(o.tag){case 13:case 19:var u=o.stateNode;return u===null&&(u=o.stateNode=new $1),u;case 22:return o=o.stateNode,u=o._retryCache,u===null&&(u=o._retryCache=new $1),u;default:throw Error(n(435,o.tag))}}function dv(o,u){var h=WA(o);u.forEach(function(p){var y=JA.bind(null,o,p);h.has(p)||(h.add(p),p.then(y,y))})}function nr(o,u){var h=u.deletions;if(h!==null)for(var p=0;p<h.length;p++){var y=h[p],x=o,T=u,N=T;e:for(;N!==null;){switch(N.tag){case 27:if(Ri(N.type)){kt=N.stateNode,Wn=!1;break e}break;case 5:kt=N.stateNode,Wn=!1;break e;case 3:case 4:kt=N.stateNode.containerInfo,Wn=!0;break e}N=N.return}if(kt===null)throw Error(n(160));Z1(x,T,y),kt=null,Wn=!1,x=y.alternate,x!==null&&(x.return=null),y.return=null}if(u.subtreeFlags&13878)for(u=u.child;u!==null;)ex(u,o),u=u.sibling}var Pr=null;function ex(o,u){var h=o.alternate,p=o.flags;switch(o.tag){case 0:case 11:case 14:case 15:nr(u,o),rr(o),p&4&&(yi(3,o,o.return),xl(3,o),yi(5,o,o.return));break;case 1:nr(u,o),rr(o),p&512&&(Ht||h===null||Jr(h,h.return)),p&64&&La&&(o=o.updateQueue,o!==null&&(p=o.callbacks,p!==null&&(h=o.shared.hiddenCallbacks,o.shared.hiddenCallbacks=h===null?p:h.concat(p))));break;case 26:var y=Pr;if(nr(u,o),rr(o),p&512&&(Ht||h===null||Jr(h,h.return)),p&4){var x=h!==null?h.memoizedState:null;if(p=o.memoizedState,h===null)if(p===null)if(o.stateNode===null){e:{p=o.type,h=o.memoizedProps,y=y.ownerDocument||y;t:switch(p){case"title":x=y.getElementsByTagName("title")[0],(!x||x[Gu]||x[Cn]||x.namespaceURI==="http://www.w3.org/2000/svg"||x.hasAttribute("itemprop"))&&(x=y.createElement(p),y.head.insertBefore(x,y.querySelector("head > title"))),xn(x,p,h),x[Cn]=o,un(x),p=x;break e;case"link":var T=Xx("link","href",y).get(p+(h.href||""));if(T){for(var N=0;N<T.length;N++)if(x=T[N],x.getAttribute("href")===(h.href==null||h.href===""?null:h.href)&&x.getAttribute("rel")===(h.rel==null?null:h.rel)&&x.getAttribute("title")===(h.title==null?null:h.title)&&x.getAttribute("crossorigin")===(h.crossOrigin==null?null:h.crossOrigin)){T.splice(N,1);break t}}x=y.createElement(p),xn(x,p,h),y.head.appendChild(x);break;case"meta":if(T=Xx("meta","content",y).get(p+(h.content||""))){for(N=0;N<T.length;N++)if(x=T[N],x.getAttribute("content")===(h.content==null?null:""+h.content)&&x.getAttribute("name")===(h.name==null?null:h.name)&&x.getAttribute("property")===(h.property==null?null:h.property)&&x.getAttribute("http-equiv")===(h.httpEquiv==null?null:h.httpEquiv)&&x.getAttribute("charset")===(h.charSet==null?null:h.charSet)){T.splice(N,1);break t}}x=y.createElement(p),xn(x,p,h),y.head.appendChild(x);break;default:throw Error(n(468,p))}x[Cn]=o,un(x),p=x}o.stateNode=p}else $x(y,o.type,o.stateNode);else o.stateNode=Kx(y,p,o.memoizedProps);else x!==p?(x===null?h.stateNode!==null&&(h=h.stateNode,h.parentNode.removeChild(h)):x.count--,p===null?$x(y,o.type,o.stateNode):Kx(y,p,o.memoizedProps)):p===null&&o.stateNode!==null&&lv(o,o.memoizedProps,h.memoizedProps)}break;case 27:nr(u,o),rr(o),p&512&&(Ht||h===null||Jr(h,h.return)),h!==null&&p&4&&lv(o,o.memoizedProps,h.memoizedProps);break;case 5:if(nr(u,o),rr(o),p&512&&(Ht||h===null||Jr(h,h.return)),o.flags&32){y=o.stateNode;try{fs(y,"")}catch(ae){Ct(o,o.return,ae)}}p&4&&o.stateNode!=null&&(y=o.memoizedProps,lv(o,y,h!==null?h.memoizedProps:y)),p&1024&&(hv=!0);break;case 6:if(nr(u,o),rr(o),p&4){if(o.stateNode===null)throw Error(n(162));p=o.memoizedProps,h=o.stateNode;try{h.nodeValue=p}catch(ae){Ct(o,o.return,ae)}}break;case 3:if(Uf=null,y=Pr,Pr=Pf(u.containerInfo),nr(u,o),Pr=y,rr(o),p&4&&h!==null&&h.memoizedState.isDehydrated)try{Pl(u.containerInfo)}catch(ae){Ct(o,o.return,ae)}hv&&(hv=!1,tx(o));break;case 4:p=Pr,Pr=Pf(o.stateNode.containerInfo),nr(u,o),rr(o),Pr=p;break;case 12:nr(u,o),rr(o);break;case 13:nr(u,o),rr(o),o.child.flags&8192&&o.memoizedState!==null!=(h!==null&&h.memoizedState!==null)&&(bv=Ut()),p&4&&(p=o.updateQueue,p!==null&&(o.updateQueue=null,dv(o,p)));break;case 22:y=o.memoizedState!==null;var U=h!==null&&h.memoizedState!==null,Z=La,ce=Ht;if(La=Z||y,Ht=ce||U,nr(u,o),Ht=ce,La=Z,rr(o),p&8192)e:for(u=o.stateNode,u._visibility=y?u._visibility&-2:u._visibility|1,y&&(h===null||U||La||Ht||Ro(o)),h=null,u=o;;){if(u.tag===5||u.tag===26){if(h===null){U=h=u;try{if(x=U.stateNode,y)T=x.style,typeof T.setProperty=="function"?T.setProperty("display","none","important"):T.display="none";else{N=U.stateNode;var he=U.memoizedProps.style,ee=he!=null&&he.hasOwnProperty("display")?he.display:null;N.style.display=ee==null||typeof ee=="boolean"?"":(""+ee).trim()}}catch(ae){Ct(U,U.return,ae)}}}else if(u.tag===6){if(h===null){U=u;try{U.stateNode.nodeValue=y?"":U.memoizedProps}catch(ae){Ct(U,U.return,ae)}}}else if((u.tag!==22&&u.tag!==23||u.memoizedState===null||u===o)&&u.child!==null){u.child.return=u,u=u.child;continue}if(u===o)break e;for(;u.sibling===null;){if(u.return===null||u.return===o)break e;h===u&&(h=null),u=u.return}h===u&&(h=null),u.sibling.return=u.return,u=u.sibling}p&4&&(p=o.updateQueue,p!==null&&(h=p.retryQueue,h!==null&&(p.retryQueue=null,dv(o,h))));break;case 19:nr(u,o),rr(o),p&4&&(p=o.updateQueue,p!==null&&(o.updateQueue=null,dv(o,p)));break;case 30:break;case 21:break;default:nr(u,o),rr(o)}}function rr(o){var u=o.flags;if(u&2){try{for(var h,p=o.return;p!==null;){if(K1(p)){h=p;break}p=p.return}if(h==null)throw Error(n(160));switch(h.tag){case 27:var y=h.stateNode,x=cv(o);Cf(o,x,y);break;case 5:var T=h.stateNode;h.flags&32&&(fs(T,""),h.flags&=-33);var N=cv(o);Cf(o,N,T);break;case 3:case 4:var U=h.stateNode.containerInfo,Z=cv(o);fv(o,Z,U);break;default:throw Error(n(161))}}catch(ce){Ct(o,o.return,ce)}o.flags&=-3}u&4096&&(o.flags&=-4097)}function tx(o){if(o.subtreeFlags&1024)for(o=o.child;o!==null;){var u=o;tx(u),u.tag===5&&u.flags&1024&&u.stateNode.reset(),o=o.sibling}}function bi(o,u){if(u.subtreeFlags&8772)for(u=u.child;u!==null;)Y1(o,u.alternate,u),u=u.sibling}function Ro(o){for(o=o.child;o!==null;){var u=o;switch(u.tag){case 0:case 11:case 14:case 15:yi(4,u,u.return),Ro(u);break;case 1:Jr(u,u.return);var h=u.stateNode;typeof h.componentWillUnmount=="function"&&G1(u,u.return,h),Ro(u);break;case 27:kl(u.stateNode);case 26:case 5:Jr(u,u.return),Ro(u);break;case 22:u.memoizedState===null&&Ro(u);break;case 30:Ro(u);break;default:Ro(u)}o=o.sibling}}function xi(o,u,h){for(h=h&&(u.subtreeFlags&8772)!==0,u=u.child;u!==null;){var p=u.alternate,y=o,x=u,T=x.flags;switch(x.tag){case 0:case 11:case 15:xi(y,x,h),xl(4,x);break;case 1:if(xi(y,x,h),p=x,y=p.stateNode,typeof y.componentDidMount=="function")try{y.componentDidMount()}catch(Z){Ct(p,p.return,Z)}if(p=x,y=p.updateQueue,y!==null){var N=p.stateNode;try{var U=y.shared.hiddenCallbacks;if(U!==null)for(y.shared.hiddenCallbacks=null,y=0;y<U.length;y++)kb(U[y],N)}catch(Z){Ct(p,p.return,Z)}}h&&T&64&&W1(x),wl(x,x.return);break;case 27:X1(x);case 26:case 5:xi(y,x,h),h&&p===null&&T&4&&q1(x),wl(x,x.return);break;case 12:xi(y,x,h);break;case 13:xi(y,x,h),h&&T&4&&J1(y,x);break;case 22:x.memoizedState===null&&xi(y,x,h),wl(x,x.return);break;case 30:break;default:xi(y,x,h)}u=u.sibling}}function pv(o,u){var h=null;o!==null&&o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(h=o.memoizedState.cachePool.pool),o=null,u.memoizedState!==null&&u.memoizedState.cachePool!==null&&(o=u.memoizedState.cachePool.pool),o!==h&&(o!=null&&o.refCount++,h!=null&&ol(h))}function vv(o,u){o=null,u.alternate!==null&&(o=u.alternate.memoizedState.cache),u=u.memoizedState.cache,u!==o&&(u.refCount++,o!=null&&ol(o))}function ea(o,u,h,p){if(u.subtreeFlags&10256)for(u=u.child;u!==null;)nx(o,u,h,p),u=u.sibling}function nx(o,u,h,p){var y=u.flags;switch(u.tag){case 0:case 11:case 15:ea(o,u,h,p),y&2048&&xl(9,u);break;case 1:ea(o,u,h,p);break;case 3:ea(o,u,h,p),y&2048&&(o=null,u.alternate!==null&&(o=u.alternate.memoizedState.cache),u=u.memoizedState.cache,u!==o&&(u.refCount++,o!=null&&ol(o)));break;case 12:if(y&2048){ea(o,u,h,p),o=u.stateNode;try{var x=u.memoizedProps,T=x.id,N=x.onPostCommit;typeof N=="function"&&N(T,u.alternate===null?"mount":"update",o.passiveEffectDuration,-0)}catch(U){Ct(u,u.return,U)}}else ea(o,u,h,p);break;case 13:ea(o,u,h,p);break;case 23:break;case 22:x=u.stateNode,T=u.alternate,u.memoizedState!==null?x._visibility&2?ea(o,u,h,p):_l(o,u):x._visibility&2?ea(o,u,h,p):(x._visibility|=2,ks(o,u,h,p,(u.subtreeFlags&10256)!==0)),y&2048&&pv(T,u);break;case 24:ea(o,u,h,p),y&2048&&vv(u.alternate,u);break;default:ea(o,u,h,p)}}function ks(o,u,h,p,y){for(y=y&&(u.subtreeFlags&10256)!==0,u=u.child;u!==null;){var x=o,T=u,N=h,U=p,Z=T.flags;switch(T.tag){case 0:case 11:case 15:ks(x,T,N,U,y),xl(8,T);break;case 23:break;case 22:var ce=T.stateNode;T.memoizedState!==null?ce._visibility&2?ks(x,T,N,U,y):_l(x,T):(ce._visibility|=2,ks(x,T,N,U,y)),y&&Z&2048&&pv(T.alternate,T);break;case 24:ks(x,T,N,U,y),y&&Z&2048&&vv(T.alternate,T);break;default:ks(x,T,N,U,y)}u=u.sibling}}function _l(o,u){if(u.subtreeFlags&10256)for(u=u.child;u!==null;){var h=o,p=u,y=p.flags;switch(p.tag){case 22:_l(h,p),y&2048&&pv(p.alternate,p);break;case 24:_l(h,p),y&2048&&vv(p.alternate,p);break;default:_l(h,p)}u=u.sibling}}var Sl=8192;function Os(o){if(o.subtreeFlags&Sl)for(o=o.child;o!==null;)rx(o),o=o.sibling}function rx(o){switch(o.tag){case 26:Os(o),o.flags&Sl&&o.memoizedState!==null&&DT(Pr,o.memoizedState,o.memoizedProps);break;case 5:Os(o);break;case 3:case 4:var u=Pr;Pr=Pf(o.stateNode.containerInfo),Os(o),Pr=u;break;case 22:o.memoizedState===null&&(u=o.alternate,u!==null&&u.memoizedState!==null?(u=Sl,Sl=16777216,Os(o),Sl=u):Os(o));break;default:Os(o)}}function ax(o){var u=o.alternate;if(u!==null&&(o=u.child,o!==null)){u.child=null;do u=o.sibling,o.sibling=null,o=u;while(o!==null)}}function El(o){var u=o.deletions;if((o.flags&16)!==0){if(u!==null)for(var h=0;h<u.length;h++){var p=u[h];cn=p,ox(p,o)}ax(o)}if(o.subtreeFlags&10256)for(o=o.child;o!==null;)ix(o),o=o.sibling}function ix(o){switch(o.tag){case 0:case 11:case 15:El(o),o.flags&2048&&yi(9,o,o.return);break;case 3:El(o);break;case 12:El(o);break;case 22:var u=o.stateNode;o.memoizedState!==null&&u._visibility&2&&(o.return===null||o.return.tag!==13)?(u._visibility&=-3,Rf(o)):El(o);break;default:El(o)}}function Rf(o){var u=o.deletions;if((o.flags&16)!==0){if(u!==null)for(var h=0;h<u.length;h++){var p=u[h];cn=p,ox(p,o)}ax(o)}for(o=o.child;o!==null;){switch(u=o,u.tag){case 0:case 11:case 15:yi(8,u,u.return),Rf(u);break;case 22:h=u.stateNode,h._visibility&2&&(h._visibility&=-3,Rf(u));break;default:Rf(u)}o=o.sibling}}function ox(o,u){for(;cn!==null;){var h=cn;switch(h.tag){case 0:case 11:case 15:yi(8,h,u);break;case 23:case 22:if(h.memoizedState!==null&&h.memoizedState.cachePool!==null){var p=h.memoizedState.cachePool.pool;p!=null&&p.refCount++}break;case 24:ol(h.memoizedState.cache)}if(p=h.child,p!==null)p.return=h,cn=p;else e:for(h=o;cn!==null;){p=cn;var y=p.sibling,x=p.return;if(Q1(p),p===h){cn=null;break e}if(y!==null){y.return=x,cn=y;break e}cn=x}}}var GA={getCacheForType:function(o){var u=Rn(Yt),h=u.data.get(o);return h===void 0&&(h=o(),u.data.set(o,h)),h}},qA=typeof WeakMap=="function"?WeakMap:Map,yt=0,Rt=null,nt=null,ot=0,bt=0,ar=null,wi=!1,Ns=!1,mv=!1,za=0,Lt=0,_i=0,Ao=0,gv=0,Cr=0,Ms=0,Cl=null,Gn=null,yv=!1,bv=0,Af=1/0,Tf=null,Si=null,bn=0,Ei=null,Is=null,Fs=0,xv=0,wv=null,sx=null,Rl=0,_v=null;function ir(){if((yt&2)!==0&&ot!==0)return ot&-ot;if(P.T!==null){var o=_s;return o!==0?o:Dv()}return S0()}function ux(){Cr===0&&(Cr=(ot&536870912)===0||pt?b0():536870912);var o=Er.current;return o!==null&&(o.flags|=32),Cr}function or(o,u,h){(o===Rt&&(bt===2||bt===9)||o.cancelPendingCommit!==null)&&(Bs(o,0),Ci(o,ot,Cr,!1)),Wu(o,h),((yt&2)===0||o!==Rt)&&(o===Rt&&((yt&2)===0&&(Ao|=h),Lt===4&&Ci(o,ot,Cr,!1)),ta(o))}function lx(o,u,h){if((yt&6)!==0)throw Error(n(327));var p=!h&&(u&124)===0&&(u&o.expiredLanes)===0||ju(o,u),y=p?$A(o,u):Cv(o,u,!0),x=p;do{if(y===0){Ns&&!p&&Ci(o,u,0,!1);break}else{if(h=o.current.alternate,x&&!KA(h)){y=Cv(o,u,!1),x=!1;continue}if(y===2){if(x=u,o.errorRecoveryDisabledLanes&x)var T=0;else T=o.pendingLanes&-536870913,T=T!==0?T:T&536870912?536870912:0;if(T!==0){u=T;e:{var N=o;y=Cl;var U=N.current.memoizedState.isDehydrated;if(U&&(Bs(N,T).flags|=256),T=Cv(N,T,!1),T!==2){if(mv&&!U){N.errorRecoveryDisabledLanes|=x,Ao|=x,y=4;break e}x=Gn,Gn=y,x!==null&&(Gn===null?Gn=x:Gn.push.apply(Gn,x))}y=T}if(x=!1,y!==2)continue}}if(y===1){Bs(o,0),Ci(o,u,0,!0);break}e:{switch(p=o,x=y,x){case 0:case 1:throw Error(n(345));case 4:if((u&4194048)!==u)break;case 6:Ci(p,u,Cr,!wi);break e;case 2:Gn=null;break;case 3:case 5:break;default:throw Error(n(329))}if((u&62914560)===u&&(y=bv+300-Ut(),10<y)){if(Ci(p,u,Cr,!wi),Pc(p,0,!0)!==0)break e;p.timeoutHandle=Px(cx.bind(null,p,h,Gn,Tf,yv,u,Cr,Ao,Ms,wi,x,2,-0,0),y);break e}cx(p,h,Gn,Tf,yv,u,Cr,Ao,Ms,wi,x,0,-0,0)}}break}while(!0);ta(o)}function cx(o,u,h,p,y,x,T,N,U,Z,ce,he,ee,ae){if(o.timeoutHandle=-1,he=u.subtreeFlags,(he&8192||(he&16785408)===16785408)&&(Ml={stylesheets:null,count:0,unsuspend:TT},rx(u),he=kT(),he!==null)){o.cancelPendingCommit=he(gx.bind(null,o,u,x,h,p,y,T,N,U,ce,1,ee,ae)),Ci(o,x,T,!Z);return}gx(o,u,x,h,p,y,T,N,U)}function KA(o){for(var u=o;;){var h=u.tag;if((h===0||h===11||h===15)&&u.flags&16384&&(h=u.updateQueue,h!==null&&(h=h.stores,h!==null)))for(var p=0;p<h.length;p++){var y=h[p],x=y.getSnapshot;y=y.value;try{if(!er(x(),y))return!1}catch{return!1}}if(h=u.child,u.subtreeFlags&16384&&h!==null)h.return=u,u=h;else{if(u===o)break;for(;u.sibling===null;){if(u.return===null||u.return===o)return!0;u=u.return}u.sibling.return=u.return,u=u.sibling}}return!0}function Ci(o,u,h,p){u&=~gv,u&=~Ao,o.suspendedLanes|=u,o.pingedLanes&=~u,p&&(o.warmLanes|=u),p=o.expirationTimes;for(var y=u;0<y;){var x=31-gn(y),T=1<<x;p[x]=-1,y&=~T}h!==0&&w0(o,h,u)}function Df(){return(yt&6)===0?(Al(0),!1):!0}function Sv(){if(nt!==null){if(bt===0)var o=nt.return;else o=nt,Oa=wo=null,Up(o),Ts=null,gl=0,o=nt;for(;o!==null;)j1(o.alternate,o),o=o.return;nt=null}}function Bs(o,u){var h=o.timeoutHandle;h!==-1&&(o.timeoutHandle=-1,fT(h)),h=o.cancelPendingCommit,h!==null&&(o.cancelPendingCommit=null,h()),Sv(),Rt=o,nt=h=Ta(o.current,null),ot=u,bt=0,ar=null,wi=!1,Ns=ju(o,u),mv=!1,Ms=Cr=gv=Ao=_i=Lt=0,Gn=Cl=null,yv=!1,(u&8)!==0&&(u|=u&32);var p=o.entangledLanes;if(p!==0)for(o=o.entanglements,p&=u;0<p;){var y=31-gn(p),x=1<<y;u|=o[y],p&=~x}return za=u,Yc(),h}function fx(o,u){Ze=null,P.H=mf,u===ul||u===of?(u=Tb(),bt=3):u===Cb?(u=Tb(),bt=4):bt=u===D1?8:u!==null&&typeof u=="object"&&typeof u.then=="function"?6:1,ar=u,nt===null&&(Lt=1,wf(o,xr(u,o.current)))}function hx(){var o=P.H;return P.H=mf,o===null?mf:o}function dx(){var o=P.A;return P.A=GA,o}function Ev(){Lt=4,wi||(ot&4194048)!==ot&&Er.current!==null||(Ns=!0),(_i&134217727)===0&&(Ao&134217727)===0||Rt===null||Ci(Rt,ot,Cr,!1)}function Cv(o,u,h){var p=yt;yt|=2;var y=hx(),x=dx();(Rt!==o||ot!==u)&&(Tf=null,Bs(o,u)),u=!1;var T=Lt;e:do try{if(bt!==0&&nt!==null){var N=nt,U=ar;switch(bt){case 8:Sv(),T=6;break e;case 3:case 2:case 9:case 6:Er.current===null&&(u=!0);var Z=bt;if(bt=0,ar=null,Ls(o,N,U,Z),h&&Ns){T=0;break e}break;default:Z=bt,bt=0,ar=null,Ls(o,N,U,Z)}}XA(),T=Lt;break}catch(ce){fx(o,ce)}while(!0);return u&&o.shellSuspendCounter++,Oa=wo=null,yt=p,P.H=y,P.A=x,nt===null&&(Rt=null,ot=0,Yc()),T}function XA(){for(;nt!==null;)px(nt)}function $A(o,u){var h=yt;yt|=2;var p=hx(),y=dx();Rt!==o||ot!==u?(Tf=null,Af=Ut()+500,Bs(o,u)):Ns=ju(o,u);e:do try{if(bt!==0&&nt!==null){u=nt;var x=ar;t:switch(bt){case 1:bt=0,ar=null,Ls(o,u,x,1);break;case 2:case 9:if(Rb(x)){bt=0,ar=null,vx(u);break}u=function(){bt!==2&&bt!==9||Rt!==o||(bt=7),ta(o)},x.then(u,u);break e;case 3:bt=7;break e;case 4:bt=5;break e;case 7:Rb(x)?(bt=0,ar=null,vx(u)):(bt=0,ar=null,Ls(o,u,x,7));break;case 5:var T=null;switch(nt.tag){case 26:T=nt.memoizedState;case 5:case 27:var N=nt;if(!T||Yx(T)){bt=0,ar=null;var U=N.sibling;if(U!==null)nt=U;else{var Z=N.return;Z!==null?(nt=Z,kf(Z)):nt=null}break t}}bt=0,ar=null,Ls(o,u,x,5);break;case 6:bt=0,ar=null,Ls(o,u,x,6);break;case 8:Sv(),Lt=6;break e;default:throw Error(n(462))}}YA();break}catch(ce){fx(o,ce)}while(!0);return Oa=wo=null,P.H=p,P.A=y,yt=h,nt!==null?0:(Rt=null,ot=0,Yc(),Lt)}function YA(){for(;nt!==null&&!Et();)px(nt)}function px(o){var u=V1(o.alternate,o,za);o.memoizedProps=o.pendingProps,u===null?kf(o):nt=u}function vx(o){var u=o,h=u.alternate;switch(u.tag){case 15:case 0:u=F1(h,u,u.pendingProps,u.type,void 0,ot);break;case 11:u=F1(h,u,u.pendingProps,u.type.render,u.ref,ot);break;case 5:Up(u);default:j1(h,u),u=nt=mb(u,za),u=V1(h,u,za)}o.memoizedProps=o.pendingProps,u===null?kf(o):nt=u}function Ls(o,u,h,p){Oa=wo=null,Up(u),Ts=null,gl=0;var y=u.return;try{if(zA(o,y,u,h,ot)){Lt=1,wf(o,xr(h,o.current)),nt=null;return}}catch(x){if(y!==null)throw nt=y,x;Lt=1,wf(o,xr(h,o.current)),nt=null;return}u.flags&32768?(pt||p===1?o=!0:Ns||(ot&536870912)!==0?o=!1:(wi=o=!0,(p===2||p===9||p===3||p===6)&&(p=Er.current,p!==null&&p.tag===13&&(p.flags|=16384))),mx(u,o)):kf(u)}function kf(o){var u=o;do{if((u.flags&32768)!==0){mx(u,wi);return}o=u.return;var h=VA(u.alternate,u,za);if(h!==null){nt=h;return}if(u=u.sibling,u!==null){nt=u;return}nt=u=o}while(u!==null);Lt===0&&(Lt=5)}function mx(o,u){do{var h=HA(o.alternate,o);if(h!==null){h.flags&=32767,nt=h;return}if(h=o.return,h!==null&&(h.flags|=32768,h.subtreeFlags=0,h.deletions=null),!u&&(o=o.sibling,o!==null)){nt=o;return}nt=o=h}while(o!==null);Lt=6,nt=null}function gx(o,u,h,p,y,x,T,N,U){o.cancelPendingCommit=null;do Of();while(bn!==0);if((yt&6)!==0)throw Error(n(327));if(u!==null){if(u===o.current)throw Error(n(177));if(x=u.lanes|u.childLanes,x|=vp,TR(o,h,x,T,N,U),o===Rt&&(nt=Rt=null,ot=0),Is=u,Ei=o,Fs=h,xv=x,wv=y,sx=p,(u.subtreeFlags&10256)!==0||(u.flags&10256)!==0?(o.callbackNode=null,o.callbackPriority=0,eT(Un,function(){return _x(),null})):(o.callbackNode=null,o.callbackPriority=0),p=(u.flags&13878)!==0,(u.subtreeFlags&13878)!==0||p){p=P.T,P.T=null,y=W.p,W.p=2,T=yt,yt|=4;try{jA(o,u,h)}finally{yt=T,W.p=y,P.T=p}}bn=1,yx(),bx(),xx()}}function yx(){if(bn===1){bn=0;var o=Ei,u=Is,h=(u.flags&13878)!==0;if((u.subtreeFlags&13878)!==0||h){h=P.T,P.T=null;var p=W.p;W.p=2;var y=yt;yt|=4;try{ex(u,o);var x=Lv,T=ob(o.containerInfo),N=x.focusedElem,U=x.selectionRange;if(T!==N&&N&&N.ownerDocument&&ib(N.ownerDocument.documentElement,N)){if(U!==null&&cp(N)){var Z=U.start,ce=U.end;if(ce===void 0&&(ce=Z),"selectionStart"in N)N.selectionStart=Z,N.selectionEnd=Math.min(ce,N.value.length);else{var he=N.ownerDocument||document,ee=he&&he.defaultView||window;if(ee.getSelection){var ae=ee.getSelection(),ze=N.textContent.length,Be=Math.min(U.start,ze),St=U.end===void 0?Be:Math.min(U.end,ze);!ae.extend&&Be>St&&(T=St,St=Be,Be=T);var $=ab(N,Be),G=ab(N,St);if($&&G&&(ae.rangeCount!==1||ae.anchorNode!==$.node||ae.anchorOffset!==$.offset||ae.focusNode!==G.node||ae.focusOffset!==G.offset)){var Y=he.createRange();Y.setStart($.node,$.offset),ae.removeAllRanges(),Be>St?(ae.addRange(Y),ae.extend(G.node,G.offset)):(Y.setEnd(G.node,G.offset),ae.addRange(Y))}}}}for(he=[],ae=N;ae=ae.parentNode;)ae.nodeType===1&&he.push({element:ae,left:ae.scrollLeft,top:ae.scrollTop});for(typeof N.focus=="function"&&N.focus(),N=0;N<he.length;N++){var fe=he[N];fe.element.scrollLeft=fe.left,fe.element.scrollTop=fe.top}}jf=!!Bv,Lv=Bv=null}finally{yt=y,W.p=p,P.T=h}}o.current=u,bn=2}}function bx(){if(bn===2){bn=0;var o=Ei,u=Is,h=(u.flags&8772)!==0;if((u.subtreeFlags&8772)!==0||h){h=P.T,P.T=null;var p=W.p;W.p=2;var y=yt;yt|=4;try{Y1(o,u.alternate,u)}finally{yt=y,W.p=p,P.T=h}}bn=3}}function xx(){if(bn===4||bn===3){bn=0,xt();var o=Ei,u=Is,h=Fs,p=sx;(u.subtreeFlags&10256)!==0||(u.flags&10256)!==0?bn=5:(bn=0,Is=Ei=null,wx(o,o.pendingLanes));var y=o.pendingLanes;if(y===0&&(Si=null),jd(h),u=u.stateNode,Wt&&typeof Wt.onCommitFiberRoot=="function")try{Wt.onCommitFiberRoot(Ca,u,void 0,(u.current.flags&128)===128)}catch{}if(p!==null){u=P.T,y=W.p,W.p=2,P.T=null;try{for(var x=o.onRecoverableError,T=0;T<p.length;T++){var N=p[T];x(N.value,{componentStack:N.stack})}}finally{P.T=u,W.p=y}}(Fs&3)!==0&&Of(),ta(o),y=o.pendingLanes,(h&4194090)!==0&&(y&42)!==0?o===_v?Rl++:(Rl=0,_v=o):Rl=0,Al(0)}}function wx(o,u){(o.pooledCacheLanes&=u)===0&&(u=o.pooledCache,u!=null&&(o.pooledCache=null,ol(u)))}function Of(o){return yx(),bx(),xx(),_x()}function _x(){if(bn!==5)return!1;var o=Ei,u=xv;xv=0;var h=jd(Fs),p=P.T,y=W.p;try{W.p=32>h?32:h,P.T=null,h=wv,wv=null;var x=Ei,T=Fs;if(bn=0,Is=Ei=null,Fs=0,(yt&6)!==0)throw Error(n(331));var N=yt;if(yt|=4,ix(x.current),nx(x,x.current,T,h),yt=N,Al(0,!1),Wt&&typeof Wt.onPostCommitFiberRoot=="function")try{Wt.onPostCommitFiberRoot(Ca,x)}catch{}return!0}finally{W.p=y,P.T=p,wx(o,u)}}function Sx(o,u,h){u=xr(h,u),u=ev(o.stateNode,u,2),o=pi(o,u,2),o!==null&&(Wu(o,2),ta(o))}function Ct(o,u,h){if(o.tag===3)Sx(o,o,h);else for(;u!==null;){if(u.tag===3){Sx(u,o,h);break}else if(u.tag===1){var p=u.stateNode;if(typeof u.type.getDerivedStateFromError=="function"||typeof p.componentDidCatch=="function"&&(Si===null||!Si.has(p))){o=xr(h,o),h=A1(2),p=pi(u,h,2),p!==null&&(T1(h,p,u,o),Wu(p,2),ta(p));break}}u=u.return}}function Rv(o,u,h){var p=o.pingCache;if(p===null){p=o.pingCache=new qA;var y=new Set;p.set(u,y)}else y=p.get(u),y===void 0&&(y=new Set,p.set(u,y));y.has(h)||(mv=!0,y.add(h),o=QA.bind(null,o,u,h),u.then(o,o))}function QA(o,u,h){var p=o.pingCache;p!==null&&p.delete(u),o.pingedLanes|=o.suspendedLanes&h,o.warmLanes&=~h,Rt===o&&(ot&h)===h&&(Lt===4||Lt===3&&(ot&62914560)===ot&&300>Ut()-bv?(yt&2)===0&&Bs(o,0):gv|=h,Ms===ot&&(Ms=0)),ta(o)}function Ex(o,u){u===0&&(u=x0()),o=ys(o,u),o!==null&&(Wu(o,u),ta(o))}function ZA(o){var u=o.memoizedState,h=0;u!==null&&(h=u.retryLane),Ex(o,h)}function JA(o,u){var h=0;switch(o.tag){case 13:var p=o.stateNode,y=o.memoizedState;y!==null&&(h=y.retryLane);break;case 19:p=o.stateNode;break;case 22:p=o.stateNode._retryCache;break;default:throw Error(n(314))}p!==null&&p.delete(u),Ex(o,h)}function eT(o,u){return Qe(o,u)}var Nf=null,Ps=null,Av=!1,Mf=!1,Tv=!1,To=0;function ta(o){o!==Ps&&o.next===null&&(Ps===null?Nf=Ps=o:Ps=Ps.next=o),Mf=!0,Av||(Av=!0,nT())}function Al(o,u){if(!Tv&&Mf){Tv=!0;do for(var h=!1,p=Nf;p!==null;){if(o!==0){var y=p.pendingLanes;if(y===0)var x=0;else{var T=p.suspendedLanes,N=p.pingedLanes;x=(1<<31-gn(42|o)+1)-1,x&=y&~(T&~N),x=x&201326741?x&201326741|1:x?x|2:0}x!==0&&(h=!0,Tx(p,x))}else x=ot,x=Pc(p,p===Rt?x:0,p.cancelPendingCommit!==null||p.timeoutHandle!==-1),(x&3)===0||ju(p,x)||(h=!0,Tx(p,x));p=p.next}while(h);Tv=!1}}function tT(){Cx()}function Cx(){Mf=Av=!1;var o=0;To!==0&&(cT()&&(o=To),To=0);for(var u=Ut(),h=null,p=Nf;p!==null;){var y=p.next,x=Rx(p,u);x===0?(p.next=null,h===null?Nf=y:h.next=y,y===null&&(Ps=h)):(h=p,(o!==0||(x&3)!==0)&&(Mf=!0)),p=y}Al(o)}function Rx(o,u){for(var h=o.suspendedLanes,p=o.pingedLanes,y=o.expirationTimes,x=o.pendingLanes&-62914561;0<x;){var T=31-gn(x),N=1<<T,U=y[T];U===-1?((N&h)===0||(N&p)!==0)&&(y[T]=AR(N,u)):U<=u&&(o.expiredLanes|=N),x&=~N}if(u=Rt,h=ot,h=Pc(o,o===u?h:0,o.cancelPendingCommit!==null||o.timeoutHandle!==-1),p=o.callbackNode,h===0||o===u&&(bt===2||bt===9)||o.cancelPendingCommit!==null)return p!==null&&p!==null&&dt(p),o.callbackNode=null,o.callbackPriority=0;if((h&3)===0||ju(o,h)){if(u=h&-h,u===o.callbackPriority)return u;switch(p!==null&&dt(p),jd(h)){case 2:case 8:h=Ea;break;case 32:h=Un;break;case 268435456:h=gr;break;default:h=Un}return p=Ax.bind(null,o),h=Qe(h,p),o.callbackPriority=u,o.callbackNode=h,u}return p!==null&&p!==null&&dt(p),o.callbackPriority=2,o.callbackNode=null,2}function Ax(o,u){if(bn!==0&&bn!==5)return o.callbackNode=null,o.callbackPriority=0,null;var h=o.callbackNode;if(Of()&&o.callbackNode!==h)return null;var p=ot;return p=Pc(o,o===Rt?p:0,o.cancelPendingCommit!==null||o.timeoutHandle!==-1),p===0?null:(lx(o,p,u),Rx(o,Ut()),o.callbackNode!=null&&o.callbackNode===h?Ax.bind(null,o):null)}function Tx(o,u){if(Of())return null;lx(o,u,!0)}function nT(){hT(function(){(yt&6)!==0?Qe(En,tT):Cx()})}function Dv(){return To===0&&(To=b0()),To}function Dx(o){return o==null||typeof o=="symbol"||typeof o=="boolean"?null:typeof o=="function"?o:jc(""+o)}function kx(o,u){var h=u.ownerDocument.createElement("input");return h.name=u.name,h.value=u.value,o.id&&h.setAttribute("form",o.id),u.parentNode.insertBefore(h,u),o=new FormData(o),h.parentNode.removeChild(h),o}function rT(o,u,h,p,y){if(u==="submit"&&h&&h.stateNode===y){var x=Dx((y[Vn]||null).action),T=p.submitter;T&&(u=(u=T[Vn]||null)?Dx(u.formAction):T.getAttribute("formAction"),u!==null&&(x=u,T=null));var N=new Kc("action","action",null,p,y);o.push({event:N,listeners:[{instance:null,listener:function(){if(p.defaultPrevented){if(To!==0){var U=T?kx(y,T):new FormData(y);$p(h,{pending:!0,data:U,method:y.method,action:x},null,U)}}else typeof x=="function"&&(N.preventDefault(),U=T?kx(y,T):new FormData(y),$p(h,{pending:!0,data:U,method:y.method,action:x},x,U))},currentTarget:y}]})}}for(var kv=0;kv<pp.length;kv++){var Ov=pp[kv],aT=Ov.toLowerCase(),iT=Ov[0].toUpperCase()+Ov.slice(1);Lr(aT,"on"+iT)}Lr(lb,"onAnimationEnd"),Lr(cb,"onAnimationIteration"),Lr(fb,"onAnimationStart"),Lr("dblclick","onDoubleClick"),Lr("focusin","onFocus"),Lr("focusout","onBlur"),Lr(_A,"onTransitionRun"),Lr(SA,"onTransitionStart"),Lr(EA,"onTransitionCancel"),Lr(hb,"onTransitionEnd"),us("onMouseEnter",["mouseout","mouseover"]),us("onMouseLeave",["mouseout","mouseover"]),us("onPointerEnter",["pointerout","pointerover"]),us("onPointerLeave",["pointerout","pointerover"]),fo("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),fo("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),fo("onBeforeInput",["compositionend","keypress","textInput","paste"]),fo("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),fo("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),fo("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Tl="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),oT=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Tl));function Ox(o,u){u=(u&4)!==0;for(var h=0;h<o.length;h++){var p=o[h],y=p.event;p=p.listeners;e:{var x=void 0;if(u)for(var T=p.length-1;0<=T;T--){var N=p[T],U=N.instance,Z=N.currentTarget;if(N=N.listener,U!==x&&y.isPropagationStopped())break e;x=N,y.currentTarget=Z;try{x(y)}catch(ce){xf(ce)}y.currentTarget=null,x=U}else for(T=0;T<p.length;T++){if(N=p[T],U=N.instance,Z=N.currentTarget,N=N.listener,U!==x&&y.isPropagationStopped())break e;x=N,y.currentTarget=Z;try{x(y)}catch(ce){xf(ce)}y.currentTarget=null,x=U}}}}function rt(o,u){var h=u[Wd];h===void 0&&(h=u[Wd]=new Set);var p=o+"__bubble";h.has(p)||(Nx(u,o,2,!1),h.add(p))}function Nv(o,u,h){var p=0;u&&(p|=4),Nx(h,o,p,u)}var If="_reactListening"+Math.random().toString(36).slice(2);function Mv(o){if(!o[If]){o[If]=!0,C0.forEach(function(h){h!=="selectionchange"&&(oT.has(h)||Nv(h,!1,o),Nv(h,!0,o))});var u=o.nodeType===9?o:o.ownerDocument;u===null||u[If]||(u[If]=!0,Nv("selectionchange",!1,u))}}function Nx(o,u,h,p){switch(nw(u)){case 2:var y=MT;break;case 8:y=IT;break;default:y=Kv}h=y.bind(null,u,h,o),y=void 0,!tp||u!=="touchstart"&&u!=="touchmove"&&u!=="wheel"||(y=!0),p?y!==void 0?o.addEventListener(u,h,{capture:!0,passive:y}):o.addEventListener(u,h,!0):y!==void 0?o.addEventListener(u,h,{passive:y}):o.addEventListener(u,h,!1)}function Iv(o,u,h,p,y){var x=p;if((u&1)===0&&(u&2)===0&&p!==null)e:for(;;){if(p===null)return;var T=p.tag;if(T===3||T===4){var N=p.stateNode.containerInfo;if(N===y)break;if(T===4)for(T=p.return;T!==null;){var U=T.tag;if((U===3||U===4)&&T.stateNode.containerInfo===y)return;T=T.return}for(;N!==null;){if(T=is(N),T===null)return;if(U=T.tag,U===5||U===6||U===26||U===27){p=x=T;continue e}N=N.parentNode}}p=p.return}z0(function(){var Z=x,ce=Jd(h),he=[];e:{var ee=db.get(o);if(ee!==void 0){var ae=Kc,ze=o;switch(o){case"keypress":if(Gc(h)===0)break e;case"keydown":case"keyup":ae=eA;break;case"focusin":ze="focus",ae=ip;break;case"focusout":ze="blur",ae=ip;break;case"beforeblur":case"afterblur":ae=ip;break;case"click":if(h.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ae=H0;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ae=HR;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ae=rA;break;case lb:case cb:case fb:ae=GR;break;case hb:ae=iA;break;case"scroll":case"scrollend":ae=UR;break;case"wheel":ae=sA;break;case"copy":case"cut":case"paste":ae=KR;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ae=W0;break;case"toggle":case"beforetoggle":ae=lA}var Be=(u&4)!==0,St=!Be&&(o==="scroll"||o==="scrollend"),$=Be?ee!==null?ee+"Capture":null:ee;Be=[];for(var G=Z,Y;G!==null;){var fe=G;if(Y=fe.stateNode,fe=fe.tag,fe!==5&&fe!==26&&fe!==27||Y===null||$===null||(fe=Ku(G,$),fe!=null&&Be.push(Dl(G,fe,Y))),St)break;G=G.return}0<Be.length&&(ee=new ae(ee,ze,null,h,ce),he.push({event:ee,listeners:Be}))}}if((u&7)===0){e:{if(ee=o==="mouseover"||o==="pointerover",ae=o==="mouseout"||o==="pointerout",ee&&h!==Zd&&(ze=h.relatedTarget||h.fromElement)&&(is(ze)||ze[as]))break e;if((ae||ee)&&(ee=ce.window===ce?ce:(ee=ce.ownerDocument)?ee.defaultView||ee.parentWindow:window,ae?(ze=h.relatedTarget||h.toElement,ae=Z,ze=ze?is(ze):null,ze!==null&&(St=i(ze),Be=ze.tag,ze!==St||Be!==5&&Be!==27&&Be!==6)&&(ze=null)):(ae=null,ze=Z),ae!==ze)){if(Be=H0,fe="onMouseLeave",$="onMouseEnter",G="mouse",(o==="pointerout"||o==="pointerover")&&(Be=W0,fe="onPointerLeave",$="onPointerEnter",G="pointer"),St=ae==null?ee:qu(ae),Y=ze==null?ee:qu(ze),ee=new Be(fe,G+"leave",ae,h,ce),ee.target=St,ee.relatedTarget=Y,fe=null,is(ce)===Z&&(Be=new Be($,G+"enter",ze,h,ce),Be.target=Y,Be.relatedTarget=St,fe=Be),St=fe,ae&&ze)t:{for(Be=ae,$=ze,G=0,Y=Be;Y;Y=zs(Y))G++;for(Y=0,fe=$;fe;fe=zs(fe))Y++;for(;0<G-Y;)Be=zs(Be),G--;for(;0<Y-G;)$=zs($),Y--;for(;G--;){if(Be===$||$!==null&&Be===$.alternate)break t;Be=zs(Be),$=zs($)}Be=null}else Be=null;ae!==null&&Mx(he,ee,ae,Be,!1),ze!==null&&St!==null&&Mx(he,St,ze,Be,!0)}}e:{if(ee=Z?qu(Z):window,ae=ee.nodeName&&ee.nodeName.toLowerCase(),ae==="select"||ae==="input"&&ee.type==="file")var Se=Z0;else if(Y0(ee))if(J0)Se=bA;else{Se=gA;var Je=mA}else ae=ee.nodeName,!ae||ae.toLowerCase()!=="input"||ee.type!=="checkbox"&&ee.type!=="radio"?Z&&Qd(Z.elementType)&&(Se=Z0):Se=yA;if(Se&&(Se=Se(o,Z))){Q0(he,Se,h,ce);break e}Je&&Je(o,ee,Z),o==="focusout"&&Z&&ee.type==="number"&&Z.memoizedProps.value!=null&&Yd(ee,"number",ee.value)}switch(Je=Z?qu(Z):window,o){case"focusin":(Y0(Je)||Je.contentEditable==="true")&&(vs=Je,fp=Z,tl=null);break;case"focusout":tl=fp=vs=null;break;case"mousedown":hp=!0;break;case"contextmenu":case"mouseup":case"dragend":hp=!1,sb(he,h,ce);break;case"selectionchange":if(wA)break;case"keydown":case"keyup":sb(he,h,ce)}var Me;if(sp)e:{switch(o){case"compositionstart":var Le="onCompositionStart";break e;case"compositionend":Le="onCompositionEnd";break e;case"compositionupdate":Le="onCompositionUpdate";break e}Le=void 0}else ps?X0(o,h)&&(Le="onCompositionEnd"):o==="keydown"&&h.keyCode===229&&(Le="onCompositionStart");Le&&(G0&&h.locale!=="ko"&&(ps||Le!=="onCompositionStart"?Le==="onCompositionEnd"&&ps&&(Me=U0()):(ci=ce,np="value"in ci?ci.value:ci.textContent,ps=!0)),Je=Ff(Z,Le),0<Je.length&&(Le=new j0(Le,o,null,h,ce),he.push({event:Le,listeners:Je}),Me?Le.data=Me:(Me=$0(h),Me!==null&&(Le.data=Me)))),(Me=fA?hA(o,h):dA(o,h))&&(Le=Ff(Z,"onBeforeInput"),0<Le.length&&(Je=new j0("onBeforeInput","beforeinput",null,h,ce),he.push({event:Je,listeners:Le}),Je.data=Me)),rT(he,o,Z,h,ce)}Ox(he,u)})}function Dl(o,u,h){return{instance:o,listener:u,currentTarget:h}}function Ff(o,u){for(var h=u+"Capture",p=[];o!==null;){var y=o,x=y.stateNode;if(y=y.tag,y!==5&&y!==26&&y!==27||x===null||(y=Ku(o,h),y!=null&&p.unshift(Dl(o,y,x)),y=Ku(o,u),y!=null&&p.push(Dl(o,y,x))),o.tag===3)return p;o=o.return}return[]}function zs(o){if(o===null)return null;do o=o.return;while(o&&o.tag!==5&&o.tag!==27);return o||null}function Mx(o,u,h,p,y){for(var x=u._reactName,T=[];h!==null&&h!==p;){var N=h,U=N.alternate,Z=N.stateNode;if(N=N.tag,U!==null&&U===p)break;N!==5&&N!==26&&N!==27||Z===null||(U=Z,y?(Z=Ku(h,x),Z!=null&&T.unshift(Dl(h,Z,U))):y||(Z=Ku(h,x),Z!=null&&T.push(Dl(h,Z,U)))),h=h.return}T.length!==0&&o.push({event:u,listeners:T})}var sT=/\r\n?/g,uT=/\u0000|\uFFFD/g;function Ix(o){return(typeof o=="string"?o:""+o).replace(sT,`
`).replace(uT,"")}function Fx(o,u){return u=Ix(u),Ix(o)===u}function Bf(){}function _t(o,u,h,p,y,x){switch(h){case"children":typeof p=="string"?u==="body"||u==="textarea"&&p===""||fs(o,p):(typeof p=="number"||typeof p=="bigint")&&u!=="body"&&fs(o,""+p);break;case"className":Uc(o,"class",p);break;case"tabIndex":Uc(o,"tabindex",p);break;case"dir":case"role":case"viewBox":case"width":case"height":Uc(o,h,p);break;case"style":L0(o,p,x);break;case"data":if(u!=="object"){Uc(o,"data",p);break}case"src":case"href":if(p===""&&(u!=="a"||h!=="href")){o.removeAttribute(h);break}if(p==null||typeof p=="function"||typeof p=="symbol"||typeof p=="boolean"){o.removeAttribute(h);break}p=jc(""+p),o.setAttribute(h,p);break;case"action":case"formAction":if(typeof p=="function"){o.setAttribute(h,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof x=="function"&&(h==="formAction"?(u!=="input"&&_t(o,u,"name",y.name,y,null),_t(o,u,"formEncType",y.formEncType,y,null),_t(o,u,"formMethod",y.formMethod,y,null),_t(o,u,"formTarget",y.formTarget,y,null)):(_t(o,u,"encType",y.encType,y,null),_t(o,u,"method",y.method,y,null),_t(o,u,"target",y.target,y,null)));if(p==null||typeof p=="symbol"||typeof p=="boolean"){o.removeAttribute(h);break}p=jc(""+p),o.setAttribute(h,p);break;case"onClick":p!=null&&(o.onclick=Bf);break;case"onScroll":p!=null&&rt("scroll",o);break;case"onScrollEnd":p!=null&&rt("scrollend",o);break;case"dangerouslySetInnerHTML":if(p!=null){if(typeof p!="object"||!("__html"in p))throw Error(n(61));if(h=p.__html,h!=null){if(y.children!=null)throw Error(n(60));o.innerHTML=h}}break;case"multiple":o.multiple=p&&typeof p!="function"&&typeof p!="symbol";break;case"muted":o.muted=p&&typeof p!="function"&&typeof p!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(p==null||typeof p=="function"||typeof p=="boolean"||typeof p=="symbol"){o.removeAttribute("xlink:href");break}h=jc(""+p),o.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",h);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":p!=null&&typeof p!="function"&&typeof p!="symbol"?o.setAttribute(h,""+p):o.removeAttribute(h);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":p&&typeof p!="function"&&typeof p!="symbol"?o.setAttribute(h,""):o.removeAttribute(h);break;case"capture":case"download":p===!0?o.setAttribute(h,""):p!==!1&&p!=null&&typeof p!="function"&&typeof p!="symbol"?o.setAttribute(h,p):o.removeAttribute(h);break;case"cols":case"rows":case"size":case"span":p!=null&&typeof p!="function"&&typeof p!="symbol"&&!isNaN(p)&&1<=p?o.setAttribute(h,p):o.removeAttribute(h);break;case"rowSpan":case"start":p==null||typeof p=="function"||typeof p=="symbol"||isNaN(p)?o.removeAttribute(h):o.setAttribute(h,p);break;case"popover":rt("beforetoggle",o),rt("toggle",o),zc(o,"popover",p);break;case"xlinkActuate":Ra(o,"http://www.w3.org/1999/xlink","xlink:actuate",p);break;case"xlinkArcrole":Ra(o,"http://www.w3.org/1999/xlink","xlink:arcrole",p);break;case"xlinkRole":Ra(o,"http://www.w3.org/1999/xlink","xlink:role",p);break;case"xlinkShow":Ra(o,"http://www.w3.org/1999/xlink","xlink:show",p);break;case"xlinkTitle":Ra(o,"http://www.w3.org/1999/xlink","xlink:title",p);break;case"xlinkType":Ra(o,"http://www.w3.org/1999/xlink","xlink:type",p);break;case"xmlBase":Ra(o,"http://www.w3.org/XML/1998/namespace","xml:base",p);break;case"xmlLang":Ra(o,"http://www.w3.org/XML/1998/namespace","xml:lang",p);break;case"xmlSpace":Ra(o,"http://www.w3.org/XML/1998/namespace","xml:space",p);break;case"is":zc(o,"is",p);break;case"innerText":case"textContent":break;default:(!(2<h.length)||h[0]!=="o"&&h[0]!=="O"||h[1]!=="n"&&h[1]!=="N")&&(h=PR.get(h)||h,zc(o,h,p))}}function Fv(o,u,h,p,y,x){switch(h){case"style":L0(o,p,x);break;case"dangerouslySetInnerHTML":if(p!=null){if(typeof p!="object"||!("__html"in p))throw Error(n(61));if(h=p.__html,h!=null){if(y.children!=null)throw Error(n(60));o.innerHTML=h}}break;case"children":typeof p=="string"?fs(o,p):(typeof p=="number"||typeof p=="bigint")&&fs(o,""+p);break;case"onScroll":p!=null&&rt("scroll",o);break;case"onScrollEnd":p!=null&&rt("scrollend",o);break;case"onClick":p!=null&&(o.onclick=Bf);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!R0.hasOwnProperty(h))e:{if(h[0]==="o"&&h[1]==="n"&&(y=h.endsWith("Capture"),u=h.slice(2,y?h.length-7:void 0),x=o[Vn]||null,x=x!=null?x[h]:null,typeof x=="function"&&o.removeEventListener(u,x,y),typeof p=="function")){typeof x!="function"&&x!==null&&(h in o?o[h]=null:o.hasAttribute(h)&&o.removeAttribute(h)),o.addEventListener(u,p,y);break e}h in o?o[h]=p:p===!0?o.setAttribute(h,""):zc(o,h,p)}}}function xn(o,u,h){switch(u){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":rt("error",o),rt("load",o);var p=!1,y=!1,x;for(x in h)if(h.hasOwnProperty(x)){var T=h[x];if(T!=null)switch(x){case"src":p=!0;break;case"srcSet":y=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(n(137,u));default:_t(o,u,x,T,h,null)}}y&&_t(o,u,"srcSet",h.srcSet,h,null),p&&_t(o,u,"src",h.src,h,null);return;case"input":rt("invalid",o);var N=x=T=y=null,U=null,Z=null;for(p in h)if(h.hasOwnProperty(p)){var ce=h[p];if(ce!=null)switch(p){case"name":y=ce;break;case"type":T=ce;break;case"checked":U=ce;break;case"defaultChecked":Z=ce;break;case"value":x=ce;break;case"defaultValue":N=ce;break;case"children":case"dangerouslySetInnerHTML":if(ce!=null)throw Error(n(137,u));break;default:_t(o,u,p,ce,h,null)}}M0(o,x,N,U,Z,T,y,!1),Vc(o);return;case"select":rt("invalid",o),p=T=x=null;for(y in h)if(h.hasOwnProperty(y)&&(N=h[y],N!=null))switch(y){case"value":x=N;break;case"defaultValue":T=N;break;case"multiple":p=N;default:_t(o,u,y,N,h,null)}u=x,h=T,o.multiple=!!p,u!=null?cs(o,!!p,u,!1):h!=null&&cs(o,!!p,h,!0);return;case"textarea":rt("invalid",o),x=y=p=null;for(T in h)if(h.hasOwnProperty(T)&&(N=h[T],N!=null))switch(T){case"value":p=N;break;case"defaultValue":y=N;break;case"children":x=N;break;case"dangerouslySetInnerHTML":if(N!=null)throw Error(n(91));break;default:_t(o,u,T,N,h,null)}F0(o,p,y,x),Vc(o);return;case"option":for(U in h)if(h.hasOwnProperty(U)&&(p=h[U],p!=null))switch(U){case"selected":o.selected=p&&typeof p!="function"&&typeof p!="symbol";break;default:_t(o,u,U,p,h,null)}return;case"dialog":rt("beforetoggle",o),rt("toggle",o),rt("cancel",o),rt("close",o);break;case"iframe":case"object":rt("load",o);break;case"video":case"audio":for(p=0;p<Tl.length;p++)rt(Tl[p],o);break;case"image":rt("error",o),rt("load",o);break;case"details":rt("toggle",o);break;case"embed":case"source":case"link":rt("error",o),rt("load",o);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(Z in h)if(h.hasOwnProperty(Z)&&(p=h[Z],p!=null))switch(Z){case"children":case"dangerouslySetInnerHTML":throw Error(n(137,u));default:_t(o,u,Z,p,h,null)}return;default:if(Qd(u)){for(ce in h)h.hasOwnProperty(ce)&&(p=h[ce],p!==void 0&&Fv(o,u,ce,p,h,void 0));return}}for(N in h)h.hasOwnProperty(N)&&(p=h[N],p!=null&&_t(o,u,N,p,h,null))}function lT(o,u,h,p){switch(u){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var y=null,x=null,T=null,N=null,U=null,Z=null,ce=null;for(ae in h){var he=h[ae];if(h.hasOwnProperty(ae)&&he!=null)switch(ae){case"checked":break;case"value":break;case"defaultValue":U=he;default:p.hasOwnProperty(ae)||_t(o,u,ae,null,p,he)}}for(var ee in p){var ae=p[ee];if(he=h[ee],p.hasOwnProperty(ee)&&(ae!=null||he!=null))switch(ee){case"type":x=ae;break;case"name":y=ae;break;case"checked":Z=ae;break;case"defaultChecked":ce=ae;break;case"value":T=ae;break;case"defaultValue":N=ae;break;case"children":case"dangerouslySetInnerHTML":if(ae!=null)throw Error(n(137,u));break;default:ae!==he&&_t(o,u,ee,ae,p,he)}}$d(o,T,N,U,Z,ce,x,y);return;case"select":ae=T=N=ee=null;for(x in h)if(U=h[x],h.hasOwnProperty(x)&&U!=null)switch(x){case"value":break;case"multiple":ae=U;default:p.hasOwnProperty(x)||_t(o,u,x,null,p,U)}for(y in p)if(x=p[y],U=h[y],p.hasOwnProperty(y)&&(x!=null||U!=null))switch(y){case"value":ee=x;break;case"defaultValue":N=x;break;case"multiple":T=x;default:x!==U&&_t(o,u,y,x,p,U)}u=N,h=T,p=ae,ee!=null?cs(o,!!h,ee,!1):!!p!=!!h&&(u!=null?cs(o,!!h,u,!0):cs(o,!!h,h?[]:"",!1));return;case"textarea":ae=ee=null;for(N in h)if(y=h[N],h.hasOwnProperty(N)&&y!=null&&!p.hasOwnProperty(N))switch(N){case"value":break;case"children":break;default:_t(o,u,N,null,p,y)}for(T in p)if(y=p[T],x=h[T],p.hasOwnProperty(T)&&(y!=null||x!=null))switch(T){case"value":ee=y;break;case"defaultValue":ae=y;break;case"children":break;case"dangerouslySetInnerHTML":if(y!=null)throw Error(n(91));break;default:y!==x&&_t(o,u,T,y,p,x)}I0(o,ee,ae);return;case"option":for(var ze in h)if(ee=h[ze],h.hasOwnProperty(ze)&&ee!=null&&!p.hasOwnProperty(ze))switch(ze){case"selected":o.selected=!1;break;default:_t(o,u,ze,null,p,ee)}for(U in p)if(ee=p[U],ae=h[U],p.hasOwnProperty(U)&&ee!==ae&&(ee!=null||ae!=null))switch(U){case"selected":o.selected=ee&&typeof ee!="function"&&typeof ee!="symbol";break;default:_t(o,u,U,ee,p,ae)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Be in h)ee=h[Be],h.hasOwnProperty(Be)&&ee!=null&&!p.hasOwnProperty(Be)&&_t(o,u,Be,null,p,ee);for(Z in p)if(ee=p[Z],ae=h[Z],p.hasOwnProperty(Z)&&ee!==ae&&(ee!=null||ae!=null))switch(Z){case"children":case"dangerouslySetInnerHTML":if(ee!=null)throw Error(n(137,u));break;default:_t(o,u,Z,ee,p,ae)}return;default:if(Qd(u)){for(var St in h)ee=h[St],h.hasOwnProperty(St)&&ee!==void 0&&!p.hasOwnProperty(St)&&Fv(o,u,St,void 0,p,ee);for(ce in p)ee=p[ce],ae=h[ce],!p.hasOwnProperty(ce)||ee===ae||ee===void 0&&ae===void 0||Fv(o,u,ce,ee,p,ae);return}}for(var $ in h)ee=h[$],h.hasOwnProperty($)&&ee!=null&&!p.hasOwnProperty($)&&_t(o,u,$,null,p,ee);for(he in p)ee=p[he],ae=h[he],!p.hasOwnProperty(he)||ee===ae||ee==null&&ae==null||_t(o,u,he,ee,p,ae)}var Bv=null,Lv=null;function Lf(o){return o.nodeType===9?o:o.ownerDocument}function Bx(o){switch(o){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Lx(o,u){if(o===0)switch(u){case"svg":return 1;case"math":return 2;default:return 0}return o===1&&u==="foreignObject"?0:o}function Pv(o,u){return o==="textarea"||o==="noscript"||typeof u.children=="string"||typeof u.children=="number"||typeof u.children=="bigint"||typeof u.dangerouslySetInnerHTML=="object"&&u.dangerouslySetInnerHTML!==null&&u.dangerouslySetInnerHTML.__html!=null}var zv=null;function cT(){var o=window.event;return o&&o.type==="popstate"?o===zv?!1:(zv=o,!0):(zv=null,!1)}var Px=typeof setTimeout=="function"?setTimeout:void 0,fT=typeof clearTimeout=="function"?clearTimeout:void 0,zx=typeof Promise=="function"?Promise:void 0,hT=typeof queueMicrotask=="function"?queueMicrotask:typeof zx<"u"?function(o){return zx.resolve(null).then(o).catch(dT)}:Px;function dT(o){setTimeout(function(){throw o})}function Ri(o){return o==="head"}function Ux(o,u){var h=u,p=0,y=0;do{var x=h.nextSibling;if(o.removeChild(h),x&&x.nodeType===8)if(h=x.data,h==="/$"){if(0<p&&8>p){h=p;var T=o.ownerDocument;if(h&1&&kl(T.documentElement),h&2&&kl(T.body),h&4)for(h=T.head,kl(h),T=h.firstChild;T;){var N=T.nextSibling,U=T.nodeName;T[Gu]||U==="SCRIPT"||U==="STYLE"||U==="LINK"&&T.rel.toLowerCase()==="stylesheet"||h.removeChild(T),T=N}}if(y===0){o.removeChild(x),Pl(u);return}y--}else h==="$"||h==="$?"||h==="$!"?y++:p=h.charCodeAt(0)-48;else p=0;h=x}while(h);Pl(u)}function Uv(o){var u=o.firstChild;for(u&&u.nodeType===10&&(u=u.nextSibling);u;){var h=u;switch(u=u.nextSibling,h.nodeName){case"HTML":case"HEAD":case"BODY":Uv(h),Gd(h);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(h.rel.toLowerCase()==="stylesheet")continue}o.removeChild(h)}}function pT(o,u,h,p){for(;o.nodeType===1;){var y=h;if(o.nodeName.toLowerCase()!==u.toLowerCase()){if(!p&&(o.nodeName!=="INPUT"||o.type!=="hidden"))break}else if(p){if(!o[Gu])switch(u){case"meta":if(!o.hasAttribute("itemprop"))break;return o;case"link":if(x=o.getAttribute("rel"),x==="stylesheet"&&o.hasAttribute("data-precedence"))break;if(x!==y.rel||o.getAttribute("href")!==(y.href==null||y.href===""?null:y.href)||o.getAttribute("crossorigin")!==(y.crossOrigin==null?null:y.crossOrigin)||o.getAttribute("title")!==(y.title==null?null:y.title))break;return o;case"style":if(o.hasAttribute("data-precedence"))break;return o;case"script":if(x=o.getAttribute("src"),(x!==(y.src==null?null:y.src)||o.getAttribute("type")!==(y.type==null?null:y.type)||o.getAttribute("crossorigin")!==(y.crossOrigin==null?null:y.crossOrigin))&&x&&o.hasAttribute("async")&&!o.hasAttribute("itemprop"))break;return o;default:return o}}else if(u==="input"&&o.type==="hidden"){var x=y.name==null?null:""+y.name;if(y.type==="hidden"&&o.getAttribute("name")===x)return o}else return o;if(o=zr(o.nextSibling),o===null)break}return null}function vT(o,u,h){if(u==="")return null;for(;o.nodeType!==3;)if((o.nodeType!==1||o.nodeName!=="INPUT"||o.type!=="hidden")&&!h||(o=zr(o.nextSibling),o===null))return null;return o}function Vv(o){return o.data==="$!"||o.data==="$?"&&o.ownerDocument.readyState==="complete"}function mT(o,u){var h=o.ownerDocument;if(o.data!=="$?"||h.readyState==="complete")u();else{var p=function(){u(),h.removeEventListener("DOMContentLoaded",p)};h.addEventListener("DOMContentLoaded",p),o._reactRetry=p}}function zr(o){for(;o!=null;o=o.nextSibling){var u=o.nodeType;if(u===1||u===3)break;if(u===8){if(u=o.data,u==="$"||u==="$!"||u==="$?"||u==="F!"||u==="F")break;if(u==="/$")return null}}return o}var Hv=null;function Vx(o){o=o.previousSibling;for(var u=0;o;){if(o.nodeType===8){var h=o.data;if(h==="$"||h==="$!"||h==="$?"){if(u===0)return o;u--}else h==="/$"&&u++}o=o.previousSibling}return null}function Hx(o,u,h){switch(u=Lf(h),o){case"html":if(o=u.documentElement,!o)throw Error(n(452));return o;case"head":if(o=u.head,!o)throw Error(n(453));return o;case"body":if(o=u.body,!o)throw Error(n(454));return o;default:throw Error(n(451))}}function kl(o){for(var u=o.attributes;u.length;)o.removeAttributeNode(u[0]);Gd(o)}var Rr=new Map,jx=new Set;function Pf(o){return typeof o.getRootNode=="function"?o.getRootNode():o.nodeType===9?o:o.ownerDocument}var Ua=W.d;W.d={f:gT,r:yT,D:bT,C:xT,L:wT,m:_T,X:ET,S:ST,M:CT};function gT(){var o=Ua.f(),u=Df();return o||u}function yT(o){var u=os(o);u!==null&&u.tag===5&&u.type==="form"?l1(u):Ua.r(o)}var Us=typeof document>"u"?null:document;function Wx(o,u,h){var p=Us;if(p&&typeof u=="string"&&u){var y=br(u);y='link[rel="'+o+'"][href="'+y+'"]',typeof h=="string"&&(y+='[crossorigin="'+h+'"]'),jx.has(y)||(jx.add(y),o={rel:o,crossOrigin:h,href:u},p.querySelector(y)===null&&(u=p.createElement("link"),xn(u,"link",o),un(u),p.head.appendChild(u)))}}function bT(o){Ua.D(o),Wx("dns-prefetch",o,null)}function xT(o,u){Ua.C(o,u),Wx("preconnect",o,u)}function wT(o,u,h){Ua.L(o,u,h);var p=Us;if(p&&o&&u){var y='link[rel="preload"][as="'+br(u)+'"]';u==="image"&&h&&h.imageSrcSet?(y+='[imagesrcset="'+br(h.imageSrcSet)+'"]',typeof h.imageSizes=="string"&&(y+='[imagesizes="'+br(h.imageSizes)+'"]')):y+='[href="'+br(o)+'"]';var x=y;switch(u){case"style":x=Vs(o);break;case"script":x=Hs(o)}Rr.has(x)||(o=d({rel:"preload",href:u==="image"&&h&&h.imageSrcSet?void 0:o,as:u},h),Rr.set(x,o),p.querySelector(y)!==null||u==="style"&&p.querySelector(Ol(x))||u==="script"&&p.querySelector(Nl(x))||(u=p.createElement("link"),xn(u,"link",o),un(u),p.head.appendChild(u)))}}function _T(o,u){Ua.m(o,u);var h=Us;if(h&&o){var p=u&&typeof u.as=="string"?u.as:"script",y='link[rel="modulepreload"][as="'+br(p)+'"][href="'+br(o)+'"]',x=y;switch(p){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":x=Hs(o)}if(!Rr.has(x)&&(o=d({rel:"modulepreload",href:o},u),Rr.set(x,o),h.querySelector(y)===null)){switch(p){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(h.querySelector(Nl(x)))return}p=h.createElement("link"),xn(p,"link",o),un(p),h.head.appendChild(p)}}}function ST(o,u,h){Ua.S(o,u,h);var p=Us;if(p&&o){var y=ss(p).hoistableStyles,x=Vs(o);u=u||"default";var T=y.get(x);if(!T){var N={loading:0,preload:null};if(T=p.querySelector(Ol(x)))N.loading=5;else{o=d({rel:"stylesheet",href:o,"data-precedence":u},h),(h=Rr.get(x))&&jv(o,h);var U=T=p.createElement("link");un(U),xn(U,"link",o),U._p=new Promise(function(Z,ce){U.onload=Z,U.onerror=ce}),U.addEventListener("load",function(){N.loading|=1}),U.addEventListener("error",function(){N.loading|=2}),N.loading|=4,zf(T,u,p)}T={type:"stylesheet",instance:T,count:1,state:N},y.set(x,T)}}}function ET(o,u){Ua.X(o,u);var h=Us;if(h&&o){var p=ss(h).hoistableScripts,y=Hs(o),x=p.get(y);x||(x=h.querySelector(Nl(y)),x||(o=d({src:o,async:!0},u),(u=Rr.get(y))&&Wv(o,u),x=h.createElement("script"),un(x),xn(x,"link",o),h.head.appendChild(x)),x={type:"script",instance:x,count:1,state:null},p.set(y,x))}}function CT(o,u){Ua.M(o,u);var h=Us;if(h&&o){var p=ss(h).hoistableScripts,y=Hs(o),x=p.get(y);x||(x=h.querySelector(Nl(y)),x||(o=d({src:o,async:!0,type:"module"},u),(u=Rr.get(y))&&Wv(o,u),x=h.createElement("script"),un(x),xn(x,"link",o),h.head.appendChild(x)),x={type:"script",instance:x,count:1,state:null},p.set(y,x))}}function Gx(o,u,h,p){var y=(y=ve.current)?Pf(y):null;if(!y)throw Error(n(446));switch(o){case"meta":case"title":return null;case"style":return typeof h.precedence=="string"&&typeof h.href=="string"?(u=Vs(h.href),h=ss(y).hoistableStyles,p=h.get(u),p||(p={type:"style",instance:null,count:0,state:null},h.set(u,p)),p):{type:"void",instance:null,count:0,state:null};case"link":if(h.rel==="stylesheet"&&typeof h.href=="string"&&typeof h.precedence=="string"){o=Vs(h.href);var x=ss(y).hoistableStyles,T=x.get(o);if(T||(y=y.ownerDocument||y,T={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},x.set(o,T),(x=y.querySelector(Ol(o)))&&!x._p&&(T.instance=x,T.state.loading=5),Rr.has(o)||(h={rel:"preload",as:"style",href:h.href,crossOrigin:h.crossOrigin,integrity:h.integrity,media:h.media,hrefLang:h.hrefLang,referrerPolicy:h.referrerPolicy},Rr.set(o,h),x||RT(y,o,h,T.state))),u&&p===null)throw Error(n(528,""));return T}if(u&&p!==null)throw Error(n(529,""));return null;case"script":return u=h.async,h=h.src,typeof h=="string"&&u&&typeof u!="function"&&typeof u!="symbol"?(u=Hs(h),h=ss(y).hoistableScripts,p=h.get(u),p||(p={type:"script",instance:null,count:0,state:null},h.set(u,p)),p):{type:"void",instance:null,count:0,state:null};default:throw Error(n(444,o))}}function Vs(o){return'href="'+br(o)+'"'}function Ol(o){return'link[rel="stylesheet"]['+o+"]"}function qx(o){return d({},o,{"data-precedence":o.precedence,precedence:null})}function RT(o,u,h,p){o.querySelector('link[rel="preload"][as="style"]['+u+"]")?p.loading=1:(u=o.createElement("link"),p.preload=u,u.addEventListener("load",function(){return p.loading|=1}),u.addEventListener("error",function(){return p.loading|=2}),xn(u,"link",h),un(u),o.head.appendChild(u))}function Hs(o){return'[src="'+br(o)+'"]'}function Nl(o){return"script[async]"+o}function Kx(o,u,h){if(u.count++,u.instance===null)switch(u.type){case"style":var p=o.querySelector('style[data-href~="'+br(h.href)+'"]');if(p)return u.instance=p,un(p),p;var y=d({},h,{"data-href":h.href,"data-precedence":h.precedence,href:null,precedence:null});return p=(o.ownerDocument||o).createElement("style"),un(p),xn(p,"style",y),zf(p,h.precedence,o),u.instance=p;case"stylesheet":y=Vs(h.href);var x=o.querySelector(Ol(y));if(x)return u.state.loading|=4,u.instance=x,un(x),x;p=qx(h),(y=Rr.get(y))&&jv(p,y),x=(o.ownerDocument||o).createElement("link"),un(x);var T=x;return T._p=new Promise(function(N,U){T.onload=N,T.onerror=U}),xn(x,"link",p),u.state.loading|=4,zf(x,h.precedence,o),u.instance=x;case"script":return x=Hs(h.src),(y=o.querySelector(Nl(x)))?(u.instance=y,un(y),y):(p=h,(y=Rr.get(x))&&(p=d({},h),Wv(p,y)),o=o.ownerDocument||o,y=o.createElement("script"),un(y),xn(y,"link",p),o.head.appendChild(y),u.instance=y);case"void":return null;default:throw Error(n(443,u.type))}else u.type==="stylesheet"&&(u.state.loading&4)===0&&(p=u.instance,u.state.loading|=4,zf(p,h.precedence,o));return u.instance}function zf(o,u,h){for(var p=h.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),y=p.length?p[p.length-1]:null,x=y,T=0;T<p.length;T++){var N=p[T];if(N.dataset.precedence===u)x=N;else if(x!==y)break}x?x.parentNode.insertBefore(o,x.nextSibling):(u=h.nodeType===9?h.head:h,u.insertBefore(o,u.firstChild))}function jv(o,u){o.crossOrigin==null&&(o.crossOrigin=u.crossOrigin),o.referrerPolicy==null&&(o.referrerPolicy=u.referrerPolicy),o.title==null&&(o.title=u.title)}function Wv(o,u){o.crossOrigin==null&&(o.crossOrigin=u.crossOrigin),o.referrerPolicy==null&&(o.referrerPolicy=u.referrerPolicy),o.integrity==null&&(o.integrity=u.integrity)}var Uf=null;function Xx(o,u,h){if(Uf===null){var p=new Map,y=Uf=new Map;y.set(h,p)}else y=Uf,p=y.get(h),p||(p=new Map,y.set(h,p));if(p.has(o))return p;for(p.set(o,null),h=h.getElementsByTagName(o),y=0;y<h.length;y++){var x=h[y];if(!(x[Gu]||x[Cn]||o==="link"&&x.getAttribute("rel")==="stylesheet")&&x.namespaceURI!=="http://www.w3.org/2000/svg"){var T=x.getAttribute(u)||"";T=o+T;var N=p.get(T);N?N.push(x):p.set(T,[x])}}return p}function $x(o,u,h){o=o.ownerDocument||o,o.head.insertBefore(h,u==="title"?o.querySelector("head > title"):null)}function AT(o,u,h){if(h===1||u.itemProp!=null)return!1;switch(o){case"meta":case"title":return!0;case"style":if(typeof u.precedence!="string"||typeof u.href!="string"||u.href==="")break;return!0;case"link":if(typeof u.rel!="string"||typeof u.href!="string"||u.href===""||u.onLoad||u.onError)break;switch(u.rel){case"stylesheet":return o=u.disabled,typeof u.precedence=="string"&&o==null;default:return!0}case"script":if(u.async&&typeof u.async!="function"&&typeof u.async!="symbol"&&!u.onLoad&&!u.onError&&u.src&&typeof u.src=="string")return!0}return!1}function Yx(o){return!(o.type==="stylesheet"&&(o.state.loading&3)===0)}var Ml=null;function TT(){}function DT(o,u,h){if(Ml===null)throw Error(n(475));var p=Ml;if(u.type==="stylesheet"&&(typeof h.media!="string"||matchMedia(h.media).matches!==!1)&&(u.state.loading&4)===0){if(u.instance===null){var y=Vs(h.href),x=o.querySelector(Ol(y));if(x){o=x._p,o!==null&&typeof o=="object"&&typeof o.then=="function"&&(p.count++,p=Vf.bind(p),o.then(p,p)),u.state.loading|=4,u.instance=x,un(x);return}x=o.ownerDocument||o,h=qx(h),(y=Rr.get(y))&&jv(h,y),x=x.createElement("link"),un(x);var T=x;T._p=new Promise(function(N,U){T.onload=N,T.onerror=U}),xn(x,"link",h),u.instance=x}p.stylesheets===null&&(p.stylesheets=new Map),p.stylesheets.set(u,o),(o=u.state.preload)&&(u.state.loading&3)===0&&(p.count++,u=Vf.bind(p),o.addEventListener("load",u),o.addEventListener("error",u))}}function kT(){if(Ml===null)throw Error(n(475));var o=Ml;return o.stylesheets&&o.count===0&&Gv(o,o.stylesheets),0<o.count?function(u){var h=setTimeout(function(){if(o.stylesheets&&Gv(o,o.stylesheets),o.unsuspend){var p=o.unsuspend;o.unsuspend=null,p()}},6e4);return o.unsuspend=u,function(){o.unsuspend=null,clearTimeout(h)}}:null}function Vf(){if(this.count--,this.count===0){if(this.stylesheets)Gv(this,this.stylesheets);else if(this.unsuspend){var o=this.unsuspend;this.unsuspend=null,o()}}}var Hf=null;function Gv(o,u){o.stylesheets=null,o.unsuspend!==null&&(o.count++,Hf=new Map,u.forEach(OT,o),Hf=null,Vf.call(o))}function OT(o,u){if(!(u.state.loading&4)){var h=Hf.get(o);if(h)var p=h.get(null);else{h=new Map,Hf.set(o,h);for(var y=o.querySelectorAll("link[data-precedence],style[data-precedence]"),x=0;x<y.length;x++){var T=y[x];(T.nodeName==="LINK"||T.getAttribute("media")!=="not all")&&(h.set(T.dataset.precedence,T),p=T)}p&&h.set(null,p)}y=u.instance,T=y.getAttribute("data-precedence"),x=h.get(T)||p,x===p&&h.set(null,y),h.set(T,y),this.count++,p=Vf.bind(this),y.addEventListener("load",p),y.addEventListener("error",p),x?x.parentNode.insertBefore(y,x.nextSibling):(o=o.nodeType===9?o.head:o,o.insertBefore(y,o.firstChild)),u.state.loading|=4}}var Il={$$typeof:C,Provider:null,Consumer:null,_currentValue:X,_currentValue2:X,_threadCount:0};function NT(o,u,h,p,y,x,T,N){this.tag=1,this.containerInfo=o,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Vd(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Vd(0),this.hiddenUpdates=Vd(null),this.identifierPrefix=p,this.onUncaughtError=y,this.onCaughtError=x,this.onRecoverableError=T,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=N,this.incompleteTransitions=new Map}function Qx(o,u,h,p,y,x,T,N,U,Z,ce,he){return o=new NT(o,u,h,T,N,U,Z,he),u=1,x===!0&&(u|=24),x=tr(3,null,null,u),o.current=x,x.stateNode=o,u=Rp(),u.refCount++,o.pooledCache=u,u.refCount++,x.memoizedState={element:p,isDehydrated:h,cache:u},kp(x),o}function Zx(o){return o?(o=bs,o):bs}function Jx(o,u,h,p,y,x){y=Zx(y),p.context===null?p.context=y:p.pendingContext=y,p=di(u),p.payload={element:h},x=x===void 0?null:x,x!==null&&(p.callback=x),h=pi(o,p,u),h!==null&&(or(h,o,u),cl(h,o,u))}function ew(o,u){if(o=o.memoizedState,o!==null&&o.dehydrated!==null){var h=o.retryLane;o.retryLane=h!==0&&h<u?h:u}}function qv(o,u){ew(o,u),(o=o.alternate)&&ew(o,u)}function tw(o){if(o.tag===13){var u=ys(o,67108864);u!==null&&or(u,o,67108864),qv(o,67108864)}}var jf=!0;function MT(o,u,h,p){var y=P.T;P.T=null;var x=W.p;try{W.p=2,Kv(o,u,h,p)}finally{W.p=x,P.T=y}}function IT(o,u,h,p){var y=P.T;P.T=null;var x=W.p;try{W.p=8,Kv(o,u,h,p)}finally{W.p=x,P.T=y}}function Kv(o,u,h,p){if(jf){var y=Xv(p);if(y===null)Iv(o,u,p,Wf,h),rw(o,p);else if(BT(y,o,u,h,p))p.stopPropagation();else if(rw(o,p),u&4&&-1<FT.indexOf(o)){for(;y!==null;){var x=os(y);if(x!==null)switch(x.tag){case 3:if(x=x.stateNode,x.current.memoizedState.isDehydrated){var T=Br(x.pendingLanes);if(T!==0){var N=x;for(N.pendingLanes|=2,N.entangledLanes|=2;T;){var U=1<<31-gn(T);N.entanglements[1]|=U,T&=~U}ta(x),(yt&6)===0&&(Af=Ut()+500,Al(0))}}break;case 13:N=ys(x,2),N!==null&&or(N,x,2),Df(),qv(x,2)}if(x=Xv(p),x===null&&Iv(o,u,p,Wf,h),x===y)break;y=x}y!==null&&p.stopPropagation()}else Iv(o,u,p,null,h)}}function Xv(o){return o=Jd(o),$v(o)}var Wf=null;function $v(o){if(Wf=null,o=is(o),o!==null){var u=i(o);if(u===null)o=null;else{var h=u.tag;if(h===13){if(o=s(u),o!==null)return o;o=null}else if(h===3){if(u.stateNode.current.memoizedState.isDehydrated)return u.tag===3?u.stateNode.containerInfo:null;o=null}else u!==o&&(o=null)}}return Wf=o,null}function nw(o){switch(o){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(mr()){case En:return 2;case Ea:return 8;case Un:case Yr:return 32;case gr:return 268435456;default:return 32}default:return 32}}var Yv=!1,Ai=null,Ti=null,Di=null,Fl=new Map,Bl=new Map,ki=[],FT="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function rw(o,u){switch(o){case"focusin":case"focusout":Ai=null;break;case"dragenter":case"dragleave":Ti=null;break;case"mouseover":case"mouseout":Di=null;break;case"pointerover":case"pointerout":Fl.delete(u.pointerId);break;case"gotpointercapture":case"lostpointercapture":Bl.delete(u.pointerId)}}function Ll(o,u,h,p,y,x){return o===null||o.nativeEvent!==x?(o={blockedOn:u,domEventName:h,eventSystemFlags:p,nativeEvent:x,targetContainers:[y]},u!==null&&(u=os(u),u!==null&&tw(u)),o):(o.eventSystemFlags|=p,u=o.targetContainers,y!==null&&u.indexOf(y)===-1&&u.push(y),o)}function BT(o,u,h,p,y){switch(u){case"focusin":return Ai=Ll(Ai,o,u,h,p,y),!0;case"dragenter":return Ti=Ll(Ti,o,u,h,p,y),!0;case"mouseover":return Di=Ll(Di,o,u,h,p,y),!0;case"pointerover":var x=y.pointerId;return Fl.set(x,Ll(Fl.get(x)||null,o,u,h,p,y)),!0;case"gotpointercapture":return x=y.pointerId,Bl.set(x,Ll(Bl.get(x)||null,o,u,h,p,y)),!0}return!1}function aw(o){var u=is(o.target);if(u!==null){var h=i(u);if(h!==null){if(u=h.tag,u===13){if(u=s(h),u!==null){o.blockedOn=u,DR(o.priority,function(){if(h.tag===13){var p=ir();p=Hd(p);var y=ys(h,p);y!==null&&or(y,h,p),qv(h,p)}});return}}else if(u===3&&h.stateNode.current.memoizedState.isDehydrated){o.blockedOn=h.tag===3?h.stateNode.containerInfo:null;return}}}o.blockedOn=null}function Gf(o){if(o.blockedOn!==null)return!1;for(var u=o.targetContainers;0<u.length;){var h=Xv(o.nativeEvent);if(h===null){h=o.nativeEvent;var p=new h.constructor(h.type,h);Zd=p,h.target.dispatchEvent(p),Zd=null}else return u=os(h),u!==null&&tw(u),o.blockedOn=h,!1;u.shift()}return!0}function iw(o,u,h){Gf(o)&&h.delete(u)}function LT(){Yv=!1,Ai!==null&&Gf(Ai)&&(Ai=null),Ti!==null&&Gf(Ti)&&(Ti=null),Di!==null&&Gf(Di)&&(Di=null),Fl.forEach(iw),Bl.forEach(iw)}function qf(o,u){o.blockedOn===u&&(o.blockedOn=null,Yv||(Yv=!0,r.unstable_scheduleCallback(r.unstable_NormalPriority,LT)))}var Kf=null;function ow(o){Kf!==o&&(Kf=o,r.unstable_scheduleCallback(r.unstable_NormalPriority,function(){Kf===o&&(Kf=null);for(var u=0;u<o.length;u+=3){var h=o[u],p=o[u+1],y=o[u+2];if(typeof p!="function"){if($v(p||h)===null)continue;break}var x=os(h);x!==null&&(o.splice(u,3),u-=3,$p(x,{pending:!0,data:y,method:h.method,action:p},p,y))}}))}function Pl(o){function u(U){return qf(U,o)}Ai!==null&&qf(Ai,o),Ti!==null&&qf(Ti,o),Di!==null&&qf(Di,o),Fl.forEach(u),Bl.forEach(u);for(var h=0;h<ki.length;h++){var p=ki[h];p.blockedOn===o&&(p.blockedOn=null)}for(;0<ki.length&&(h=ki[0],h.blockedOn===null);)aw(h),h.blockedOn===null&&ki.shift();if(h=(o.ownerDocument||o).$$reactFormReplay,h!=null)for(p=0;p<h.length;p+=3){var y=h[p],x=h[p+1],T=y[Vn]||null;if(typeof x=="function")T||ow(h);else if(T){var N=null;if(x&&x.hasAttribute("formAction")){if(y=x,T=x[Vn]||null)N=T.formAction;else if($v(y)!==null)continue}else N=T.action;typeof N=="function"?h[p+1]=N:(h.splice(p,3),p-=3),ow(h)}}}function Qv(o){this._internalRoot=o}Xf.prototype.render=Qv.prototype.render=function(o){var u=this._internalRoot;if(u===null)throw Error(n(409));var h=u.current,p=ir();Jx(h,p,o,u,null,null)},Xf.prototype.unmount=Qv.prototype.unmount=function(){var o=this._internalRoot;if(o!==null){this._internalRoot=null;var u=o.containerInfo;Jx(o.current,2,null,o,null,null),Df(),u[as]=null}};function Xf(o){this._internalRoot=o}Xf.prototype.unstable_scheduleHydration=function(o){if(o){var u=S0();o={blockedOn:null,target:o,priority:u};for(var h=0;h<ki.length&&u!==0&&u<ki[h].priority;h++);ki.splice(h,0,o),h===0&&aw(o)}};var sw=t.version;if(sw!=="19.1.0")throw Error(n(527,sw,"19.1.0"));W.findDOMNode=function(o){var u=o._reactInternals;if(u===void 0)throw typeof o.render=="function"?Error(n(188)):(o=Object.keys(o).join(","),Error(n(268,o)));return o=c(u),o=o!==null?f(o):null,o=o===null?null:o.stateNode,o};var PT={bundleType:0,version:"19.1.0",rendererPackageName:"react-dom",currentDispatcherRef:P,reconcilerVersion:"19.1.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var $f=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!$f.isDisabled&&$f.supportsFiber)try{Ca=$f.inject(PT),Wt=$f}catch{}}return Ul.createRoot=function(o,u){if(!a(o))throw Error(n(299));var h=!1,p="",y=S1,x=E1,T=C1,N=null;return u!=null&&(u.unstable_strictMode===!0&&(h=!0),u.identifierPrefix!==void 0&&(p=u.identifierPrefix),u.onUncaughtError!==void 0&&(y=u.onUncaughtError),u.onCaughtError!==void 0&&(x=u.onCaughtError),u.onRecoverableError!==void 0&&(T=u.onRecoverableError),u.unstable_transitionCallbacks!==void 0&&(N=u.unstable_transitionCallbacks)),u=Qx(o,1,!1,null,null,h,p,y,x,T,N,null),o[as]=u.current,Mv(o),new Qv(u)},Ul.hydrateRoot=function(o,u,h){if(!a(o))throw Error(n(299));var p=!1,y="",x=S1,T=E1,N=C1,U=null,Z=null;return h!=null&&(h.unstable_strictMode===!0&&(p=!0),h.identifierPrefix!==void 0&&(y=h.identifierPrefix),h.onUncaughtError!==void 0&&(x=h.onUncaughtError),h.onCaughtError!==void 0&&(T=h.onCaughtError),h.onRecoverableError!==void 0&&(N=h.onRecoverableError),h.unstable_transitionCallbacks!==void 0&&(U=h.unstable_transitionCallbacks),h.formState!==void 0&&(Z=h.formState)),u=Qx(o,1,!0,u,h??null,p,y,x,T,N,U,Z),u.context=Zx(null),h=u.current,p=ir(),p=Hd(p),y=di(p),y.callback=null,pi(h,y,p),h=p,u.current.lanes=h,Wu(u,h),ta(u),o[as]=u.current,Mv(o),new Xf(u)},Ul.version="19.1.0",Ul}var yw;function $T(){if(yw)return em.exports;yw=1;function r(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(r)}catch(t){console.error(t)}}return r(),em.exports=XT(),em.exports}var YT=$T();const Zz=q_(YT);var Q=Yg();const Yn=q_(Q);var pn=function(){return pn=Object.assign||function(t){for(var e,n=1,a=arguments.length;n<a;n++){e=arguments[n];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}return t},pn.apply(this,arguments)};function Su(r,t,e){if(e||arguments.length===2)for(var n=0,a=t.length,i;n<a;n++)(i||!(n in t))&&(i||(i=Array.prototype.slice.call(t,0,n)),i[n]=t[n]);return r.concat(i||Array.prototype.slice.call(t))}var Tt="-ms-",Zl="-moz-",vt="-webkit-",K_="comm",hd="rule",Qg="decl",QT="@import",X_="@keyframes",ZT="@layer",$_=Math.abs,Zg=String.fromCharCode,qm=Object.assign;function JT(r,t){return dn(r,0)^45?(((t<<2^dn(r,0))<<2^dn(r,1))<<2^dn(r,2))<<2^dn(r,3):0}function Y_(r){return r.trim()}function Wa(r,t){return(r=t.exec(r))?r[0]:r}function Ye(r,t,e){return r.replace(t,e)}function yh(r,t,e){return r.indexOf(t,e)}function dn(r,t){return r.charCodeAt(t)|0}function Eu(r,t,e){return r.slice(t,e)}function ua(r){return r.length}function Q_(r){return r.length}function $l(r,t){return t.push(r),r}function eD(r,t){return r.map(t).join("")}function bw(r,t){return r.filter(function(e){return!Wa(e,t)})}var dd=1,Cu=1,Z_=0,Nr=0,Kt=0,Lu="";function pd(r,t,e,n,a,i,s,l){return{value:r,root:t,parent:e,type:n,props:a,children:i,line:dd,column:Cu,length:s,return:"",siblings:l}}function Ii(r,t){return qm(pd("",null,null,"",null,null,0,r.siblings),r,{length:-r.length},t)}function js(r){for(;r.root;)r=Ii(r.root,{children:[r]});$l(r,r.siblings)}function tD(){return Kt}function nD(){return Kt=Nr>0?dn(Lu,--Nr):0,Cu--,Kt===10&&(Cu=1,dd--),Kt}function Gr(){return Kt=Nr<Z_?dn(Lu,Nr++):0,Cu++,Kt===10&&(Cu=1,dd++),Kt}function Wo(){return dn(Lu,Nr)}function bh(){return Nr}function vd(r,t){return Eu(Lu,r,t)}function Km(r){switch(r){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function rD(r){return dd=Cu=1,Z_=ua(Lu=r),Nr=0,[]}function aD(r){return Lu="",r}function im(r){return Y_(vd(Nr-1,Xm(r===91?r+2:r===40?r+1:r)))}function iD(r){for(;(Kt=Wo())&&Kt<33;)Gr();return Km(r)>2||Km(Kt)>3?"":" "}function oD(r,t){for(;--t&&Gr()&&!(Kt<48||Kt>102||Kt>57&&Kt<65||Kt>70&&Kt<97););return vd(r,bh()+(t<6&&Wo()==32&&Gr()==32))}function Xm(r){for(;Gr();)switch(Kt){case r:return Nr;case 34:case 39:r!==34&&r!==39&&Xm(Kt);break;case 40:r===41&&Xm(r);break;case 92:Gr();break}return Nr}function sD(r,t){for(;Gr()&&r+Kt!==57;)if(r+Kt===84&&Wo()===47)break;return"/*"+vd(t,Nr-1)+"*"+Zg(r===47?r:Gr())}function uD(r){for(;!Km(Wo());)Gr();return vd(r,Nr)}function lD(r){return aD(xh("",null,null,null,[""],r=rD(r),0,[0],r))}function xh(r,t,e,n,a,i,s,l,c){for(var f=0,d=0,v=s,m=0,g=0,b=0,w=1,_=1,S=1,E=0,C="",R=a,A=i,D=n,k=C;_;)switch(b=E,E=Gr()){case 40:if(b!=108&&dn(k,v-1)==58){yh(k+=Ye(im(E),"&","&\f"),"&\f",$_(f?l[f-1]:0))!=-1&&(S=-1);break}case 34:case 39:case 91:k+=im(E);break;case 9:case 10:case 13:case 32:k+=iD(b);break;case 92:k+=oD(bh()-1,7);continue;case 47:switch(Wo()){case 42:case 47:$l(cD(sD(Gr(),bh()),t,e,c),c);break;default:k+="/"}break;case 123*w:l[f++]=ua(k)*S;case 125*w:case 59:case 0:switch(E){case 0:case 125:_=0;case 59+d:S==-1&&(k=Ye(k,/\f/g,"")),g>0&&ua(k)-v&&$l(g>32?ww(k+";",n,e,v-1,c):ww(Ye(k," ","")+";",n,e,v-2,c),c);break;case 59:k+=";";default:if($l(D=xw(k,t,e,f,d,a,l,C,R=[],A=[],v,i),i),E===123)if(d===0)xh(k,t,D,D,R,i,v,l,A);else switch(m===99&&dn(k,3)===110?100:m){case 100:case 108:case 109:case 115:xh(r,D,D,n&&$l(xw(r,D,D,0,0,a,l,C,a,R=[],v,A),A),a,A,v,l,n?R:A);break;default:xh(k,D,D,D,[""],A,0,l,A)}}f=d=g=0,w=S=1,C=k="",v=s;break;case 58:v=1+ua(k),g=b;default:if(w<1){if(E==123)--w;else if(E==125&&w++==0&&nD()==125)continue}switch(k+=Zg(E),E*w){case 38:S=d>0?1:(k+="\f",-1);break;case 44:l[f++]=(ua(k)-1)*S,S=1;break;case 64:Wo()===45&&(k+=im(Gr())),m=Wo(),d=v=ua(C=k+=uD(bh())),E++;break;case 45:b===45&&ua(k)==2&&(w=0)}}return i}function xw(r,t,e,n,a,i,s,l,c,f,d,v){for(var m=a-1,g=a===0?i:[""],b=Q_(g),w=0,_=0,S=0;w<n;++w)for(var E=0,C=Eu(r,m+1,m=$_(_=s[w])),R=r;E<b;++E)(R=Y_(_>0?g[E]+" "+C:Ye(C,/&\f/g,g[E])))&&(c[S++]=R);return pd(r,t,e,a===0?hd:l,c,f,d,v)}function cD(r,t,e,n){return pd(r,t,e,K_,Zg(tD()),Eu(r,2,-2),0,n)}function ww(r,t,e,n,a){return pd(r,t,e,Qg,Eu(r,0,n),Eu(r,n+1,-1),n,a)}function J_(r,t,e){switch(JT(r,t)){case 5103:return vt+"print-"+r+r;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return vt+r+r;case 4789:return Zl+r+r;case 5349:case 4246:case 4810:case 6968:case 2756:return vt+r+Zl+r+Tt+r+r;case 5936:switch(dn(r,t+11)){case 114:return vt+r+Tt+Ye(r,/[svh]\w+-[tblr]{2}/,"tb")+r;case 108:return vt+r+Tt+Ye(r,/[svh]\w+-[tblr]{2}/,"tb-rl")+r;case 45:return vt+r+Tt+Ye(r,/[svh]\w+-[tblr]{2}/,"lr")+r}case 6828:case 4268:case 2903:return vt+r+Tt+r+r;case 6165:return vt+r+Tt+"flex-"+r+r;case 5187:return vt+r+Ye(r,/(\w+).+(:[^]+)/,vt+"box-$1$2"+Tt+"flex-$1$2")+r;case 5443:return vt+r+Tt+"flex-item-"+Ye(r,/flex-|-self/g,"")+(Wa(r,/flex-|baseline/)?"":Tt+"grid-row-"+Ye(r,/flex-|-self/g,""))+r;case 4675:return vt+r+Tt+"flex-line-pack"+Ye(r,/align-content|flex-|-self/g,"")+r;case 5548:return vt+r+Tt+Ye(r,"shrink","negative")+r;case 5292:return vt+r+Tt+Ye(r,"basis","preferred-size")+r;case 6060:return vt+"box-"+Ye(r,"-grow","")+vt+r+Tt+Ye(r,"grow","positive")+r;case 4554:return vt+Ye(r,/([^-])(transform)/g,"$1"+vt+"$2")+r;case 6187:return Ye(Ye(Ye(r,/(zoom-|grab)/,vt+"$1"),/(image-set)/,vt+"$1"),r,"")+r;case 5495:case 3959:return Ye(r,/(image-set\([^]*)/,vt+"$1$`$1");case 4968:return Ye(Ye(r,/(.+:)(flex-)?(.*)/,vt+"box-pack:$3"+Tt+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+vt+r+r;case 4200:if(!Wa(r,/flex-|baseline/))return Tt+"grid-column-align"+Eu(r,t)+r;break;case 2592:case 3360:return Tt+Ye(r,"template-","")+r;case 4384:case 3616:return e&&e.some(function(n,a){return t=a,Wa(n.props,/grid-\w+-end/)})?~yh(r+(e=e[t].value),"span",0)?r:Tt+Ye(r,"-start","")+r+Tt+"grid-row-span:"+(~yh(e,"span",0)?Wa(e,/\d+/):+Wa(e,/\d+/)-+Wa(r,/\d+/))+";":Tt+Ye(r,"-start","")+r;case 4896:case 4128:return e&&e.some(function(n){return Wa(n.props,/grid-\w+-start/)})?r:Tt+Ye(Ye(r,"-end","-span"),"span ","")+r;case 4095:case 3583:case 4068:case 2532:return Ye(r,/(.+)-inline(.+)/,vt+"$1$2")+r;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(ua(r)-1-t>6)switch(dn(r,t+1)){case 109:if(dn(r,t+4)!==45)break;case 102:return Ye(r,/(.+:)(.+)-([^]+)/,"$1"+vt+"$2-$3$1"+Zl+(dn(r,t+3)==108?"$3":"$2-$3"))+r;case 115:return~yh(r,"stretch",0)?J_(Ye(r,"stretch","fill-available"),t,e)+r:r}break;case 5152:case 5920:return Ye(r,/(.+?):(\d+)(\s*\/\s*(span)?\s*(\d+))?(.*)/,function(n,a,i,s,l,c,f){return Tt+a+":"+i+f+(s?Tt+a+"-span:"+(l?c:+c-+i)+f:"")+r});case 4949:if(dn(r,t+6)===121)return Ye(r,":",":"+vt)+r;break;case 6444:switch(dn(r,dn(r,14)===45?18:11)){case 120:return Ye(r,/(.+:)([^;\s!]+)(;|(\s+)?!.+)?/,"$1"+vt+(dn(r,14)===45?"inline-":"")+"box$3$1"+vt+"$2$3$1"+Tt+"$2box$3")+r;case 100:return Ye(r,":",":"+Tt)+r}break;case 5719:case 2647:case 2135:case 3927:case 2391:return Ye(r,"scroll-","scroll-snap-")+r}return r}function Ah(r,t){for(var e="",n=0;n<r.length;n++)e+=t(r[n],n,r,t)||"";return e}function fD(r,t,e,n){switch(r.type){case ZT:if(r.children.length)break;case QT:case Qg:return r.return=r.return||r.value;case K_:return"";case X_:return r.return=r.value+"{"+Ah(r.children,n)+"}";case hd:if(!ua(r.value=r.props.join(",")))return""}return ua(e=Ah(r.children,n))?r.return=r.value+"{"+e+"}":""}function hD(r){var t=Q_(r);return function(e,n,a,i){for(var s="",l=0;l<t;l++)s+=r[l](e,n,a,i)||"";return s}}function dD(r){return function(t){t.root||(t=t.return)&&r(t)}}function pD(r,t,e,n){if(r.length>-1&&!r.return)switch(r.type){case Qg:r.return=J_(r.value,r.length,e);return;case X_:return Ah([Ii(r,{value:Ye(r.value,"@","@"+vt)})],n);case hd:if(r.length)return eD(e=r.props,function(a){switch(Wa(a,n=/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":js(Ii(r,{props:[Ye(a,/:(read-\w+)/,":"+Zl+"$1")]})),js(Ii(r,{props:[a]})),qm(r,{props:bw(e,n)});break;case"::placeholder":js(Ii(r,{props:[Ye(a,/:(plac\w+)/,":"+vt+"input-$1")]})),js(Ii(r,{props:[Ye(a,/:(plac\w+)/,":"+Zl+"$1")]})),js(Ii(r,{props:[Ye(a,/:(plac\w+)/,Tt+"input-$1")]})),js(Ii(r,{props:[a]})),qm(r,{props:bw(e,n)});break}return""})}}var vD={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},sr={},Ru=typeof process<"u"&&sr!==void 0&&(sr.REACT_APP_SC_ATTR||sr.SC_ATTR)||"data-styled",eS="active",tS="data-styled-version",md="6.1.19",Jg=`/*!sc*/
`,Th=typeof window<"u"&&typeof document<"u",mD=!!(typeof SC_DISABLE_SPEEDY=="boolean"?SC_DISABLE_SPEEDY:typeof process<"u"&&sr!==void 0&&sr.REACT_APP_SC_DISABLE_SPEEDY!==void 0&&sr.REACT_APP_SC_DISABLE_SPEEDY!==""?sr.REACT_APP_SC_DISABLE_SPEEDY!=="false"&&sr.REACT_APP_SC_DISABLE_SPEEDY:typeof process<"u"&&sr!==void 0&&sr.SC_DISABLE_SPEEDY!==void 0&&sr.SC_DISABLE_SPEEDY!==""&&sr.SC_DISABLE_SPEEDY!=="false"&&sr.SC_DISABLE_SPEEDY),gD={},gd=Object.freeze([]),Au=Object.freeze({});function nS(r,t,e){return e===void 0&&(e=Au),r.theme!==e.theme&&r.theme||t||e.theme}var rS=new Set(["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","tr","track","u","ul","use","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","marker","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"]),yD=/[!"#$%&'()*+,./:;<=>?@[\\\]^`{|}~-]+/g,bD=/(^-|-$)/g;function _w(r){return r.replace(yD,"-").replace(bD,"")}var xD=/(a)(d)/gi,Qf=52,Sw=function(r){return String.fromCharCode(r+(r>25?39:97))};function $m(r){var t,e="";for(t=Math.abs(r);t>Qf;t=t/Qf|0)e=Sw(t%Qf)+e;return(Sw(t%Qf)+e).replace(xD,"$1-$2")}var om,aS=5381,tu=function(r,t){for(var e=t.length;e;)r=33*r^t.charCodeAt(--e);return r},iS=function(r){return tu(aS,r)};function ey(r){return $m(iS(r)>>>0)}function wD(r){return r.displayName||r.name||"Component"}function sm(r){return typeof r=="string"&&!0}var oS=typeof Symbol=="function"&&Symbol.for,sS=oS?Symbol.for("react.memo"):60115,_D=oS?Symbol.for("react.forward_ref"):60112,SD={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},ED={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},uS={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},CD=((om={})[_D]={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},om[sS]=uS,om);function Ew(r){return("type"in(t=r)&&t.type.$$typeof)===sS?uS:"$$typeof"in r?CD[r.$$typeof]:SD;var t}var RD=Object.defineProperty,AD=Object.getOwnPropertyNames,Cw=Object.getOwnPropertySymbols,TD=Object.getOwnPropertyDescriptor,DD=Object.getPrototypeOf,Rw=Object.prototype;function lS(r,t,e){if(typeof t!="string"){if(Rw){var n=DD(t);n&&n!==Rw&&lS(r,n,e)}var a=AD(t);Cw&&(a=a.concat(Cw(t)));for(var i=Ew(r),s=Ew(t),l=0;l<a.length;++l){var c=a[l];if(!(c in ED||e&&e[c]||s&&c in s||i&&c in i)){var f=TD(t,c);try{RD(r,c,f)}catch{}}}}return r}function Xo(r){return typeof r=="function"}function ty(r){return typeof r=="object"&&"styledComponentId"in r}function Mo(r,t){return r&&t?"".concat(r," ").concat(t):r||t||""}function Dh(r,t){if(r.length===0)return"";for(var e=r[0],n=1;n<r.length;n++)e+=r[n];return e}function rc(r){return r!==null&&typeof r=="object"&&r.constructor.name===Object.name&&!("props"in r&&r.$$typeof)}function Ym(r,t,e){if(e===void 0&&(e=!1),!e&&!rc(r)&&!Array.isArray(r))return t;if(Array.isArray(t))for(var n=0;n<t.length;n++)r[n]=Ym(r[n],t[n]);else if(rc(t))for(var n in t)r[n]=Ym(r[n],t[n]);return r}function ny(r,t){Object.defineProperty(r,"toString",{value:t})}function ro(r){for(var t=[],e=1;e<arguments.length;e++)t[e-1]=arguments[e];return new Error("An error occurred. See https://github.com/styled-components/styled-components/blob/main/packages/styled-components/src/utils/errors.md#".concat(r," for more information.").concat(t.length>0?" Args: ".concat(t.join(", ")):""))}var kD=function(){function r(t){this.groupSizes=new Uint32Array(512),this.length=512,this.tag=t}return r.prototype.indexOfGroup=function(t){for(var e=0,n=0;n<t;n++)e+=this.groupSizes[n];return e},r.prototype.insertRules=function(t,e){if(t>=this.groupSizes.length){for(var n=this.groupSizes,a=n.length,i=a;t>=i;)if((i<<=1)<0)throw ro(16,"".concat(t));this.groupSizes=new Uint32Array(i),this.groupSizes.set(n),this.length=i;for(var s=a;s<i;s++)this.groupSizes[s]=0}for(var l=this.indexOfGroup(t+1),c=(s=0,e.length);s<c;s++)this.tag.insertRule(l,e[s])&&(this.groupSizes[t]++,l++)},r.prototype.clearGroup=function(t){if(t<this.length){var e=this.groupSizes[t],n=this.indexOfGroup(t),a=n+e;this.groupSizes[t]=0;for(var i=n;i<a;i++)this.tag.deleteRule(n)}},r.prototype.getGroup=function(t){var e="";if(t>=this.length||this.groupSizes[t]===0)return e;for(var n=this.groupSizes[t],a=this.indexOfGroup(t),i=a+n,s=a;s<i;s++)e+="".concat(this.tag.getRule(s)).concat(Jg);return e},r}(),wh=new Map,kh=new Map,_h=1,Zf=function(r){if(wh.has(r))return wh.get(r);for(;kh.has(_h);)_h++;var t=_h++;return wh.set(r,t),kh.set(t,r),t},OD=function(r,t){_h=t+1,wh.set(r,t),kh.set(t,r)},ND="style[".concat(Ru,"][").concat(tS,'="').concat(md,'"]'),MD=new RegExp("^".concat(Ru,'\\.g(\\d+)\\[id="([\\w\\d-]+)"\\].*?"([^"]*)')),ID=function(r,t,e){for(var n,a=e.split(","),i=0,s=a.length;i<s;i++)(n=a[i])&&r.registerName(t,n)},FD=function(r,t){for(var e,n=((e=t.textContent)!==null&&e!==void 0?e:"").split(Jg),a=[],i=0,s=n.length;i<s;i++){var l=n[i].trim();if(l){var c=l.match(MD);if(c){var f=0|parseInt(c[1],10),d=c[2];f!==0&&(OD(d,f),ID(r,d,c[3]),r.getTag().insertRules(f,a)),a.length=0}else a.push(l)}}},Aw=function(r){for(var t=document.querySelectorAll(ND),e=0,n=t.length;e<n;e++){var a=t[e];a&&a.getAttribute(Ru)!==eS&&(FD(r,a),a.parentNode&&a.parentNode.removeChild(a))}};function BD(){return typeof __webpack_nonce__<"u"?__webpack_nonce__:null}var cS=function(r){var t=document.head,e=r||t,n=document.createElement("style"),a=function(l){var c=Array.from(l.querySelectorAll("style[".concat(Ru,"]")));return c[c.length-1]}(e),i=a!==void 0?a.nextSibling:null;n.setAttribute(Ru,eS),n.setAttribute(tS,md);var s=BD();return s&&n.setAttribute("nonce",s),e.insertBefore(n,i),n},LD=function(){function r(t){this.element=cS(t),this.element.appendChild(document.createTextNode("")),this.sheet=function(e){if(e.sheet)return e.sheet;for(var n=document.styleSheets,a=0,i=n.length;a<i;a++){var s=n[a];if(s.ownerNode===e)return s}throw ro(17)}(this.element),this.length=0}return r.prototype.insertRule=function(t,e){try{return this.sheet.insertRule(e,t),this.length++,!0}catch{return!1}},r.prototype.deleteRule=function(t){this.sheet.deleteRule(t),this.length--},r.prototype.getRule=function(t){var e=this.sheet.cssRules[t];return e&&e.cssText?e.cssText:""},r}(),PD=function(){function r(t){this.element=cS(t),this.nodes=this.element.childNodes,this.length=0}return r.prototype.insertRule=function(t,e){if(t<=this.length&&t>=0){var n=document.createTextNode(e);return this.element.insertBefore(n,this.nodes[t]||null),this.length++,!0}return!1},r.prototype.deleteRule=function(t){this.element.removeChild(this.nodes[t]),this.length--},r.prototype.getRule=function(t){return t<this.length?this.nodes[t].textContent:""},r}(),zD=function(){function r(t){this.rules=[],this.length=0}return r.prototype.insertRule=function(t,e){return t<=this.length&&(this.rules.splice(t,0,e),this.length++,!0)},r.prototype.deleteRule=function(t){this.rules.splice(t,1),this.length--},r.prototype.getRule=function(t){return t<this.length?this.rules[t]:""},r}(),Tw=Th,UD={isServer:!Th,useCSSOMInjection:!mD},Oh=function(){function r(t,e,n){t===void 0&&(t=Au),e===void 0&&(e={});var a=this;this.options=pn(pn({},UD),t),this.gs=e,this.names=new Map(n),this.server=!!t.isServer,!this.server&&Th&&Tw&&(Tw=!1,Aw(this)),ny(this,function(){return function(i){for(var s=i.getTag(),l=s.length,c="",f=function(v){var m=function(S){return kh.get(S)}(v);if(m===void 0)return"continue";var g=i.names.get(m),b=s.getGroup(v);if(g===void 0||!g.size||b.length===0)return"continue";var w="".concat(Ru,".g").concat(v,'[id="').concat(m,'"]'),_="";g!==void 0&&g.forEach(function(S){S.length>0&&(_+="".concat(S,","))}),c+="".concat(b).concat(w,'{content:"').concat(_,'"}').concat(Jg)},d=0;d<l;d++)f(d);return c}(a)})}return r.registerId=function(t){return Zf(t)},r.prototype.rehydrate=function(){!this.server&&Th&&Aw(this)},r.prototype.reconstructWithOptions=function(t,e){return e===void 0&&(e=!0),new r(pn(pn({},this.options),t),this.gs,e&&this.names||void 0)},r.prototype.allocateGSInstance=function(t){return this.gs[t]=(this.gs[t]||0)+1},r.prototype.getTag=function(){return this.tag||(this.tag=(t=function(e){var n=e.useCSSOMInjection,a=e.target;return e.isServer?new zD(a):n?new LD(a):new PD(a)}(this.options),new kD(t)));var t},r.prototype.hasNameForId=function(t,e){return this.names.has(t)&&this.names.get(t).has(e)},r.prototype.registerName=function(t,e){if(Zf(t),this.names.has(t))this.names.get(t).add(e);else{var n=new Set;n.add(e),this.names.set(t,n)}},r.prototype.insertRules=function(t,e,n){this.registerName(t,e),this.getTag().insertRules(Zf(t),n)},r.prototype.clearNames=function(t){this.names.has(t)&&this.names.get(t).clear()},r.prototype.clearRules=function(t){this.getTag().clearGroup(Zf(t)),this.clearNames(t)},r.prototype.clearTag=function(){this.tag=void 0},r}(),VD=/&/g,HD=/^\s*\/\/.*$/gm;function fS(r,t){return r.map(function(e){return e.type==="rule"&&(e.value="".concat(t," ").concat(e.value),e.value=e.value.replaceAll(",",",".concat(t," ")),e.props=e.props.map(function(n){return"".concat(t," ").concat(n)})),Array.isArray(e.children)&&e.type!=="@keyframes"&&(e.children=fS(e.children,t)),e})}function jD(r){var t,e,n,a=Au,i=a.options,s=i===void 0?Au:i,l=a.plugins,c=l===void 0?gd:l,f=function(m,g,b){return b.startsWith(e)&&b.endsWith(e)&&b.replaceAll(e,"").length>0?".".concat(t):m},d=c.slice();d.push(function(m){m.type===hd&&m.value.includes("&")&&(m.props[0]=m.props[0].replace(VD,e).replace(n,f))}),s.prefix&&d.push(pD),d.push(fD);var v=function(m,g,b,w){g===void 0&&(g=""),b===void 0&&(b=""),w===void 0&&(w="&"),t=w,e=g,n=new RegExp("\\".concat(e,"\\b"),"g");var _=m.replace(HD,""),S=lD(b||g?"".concat(b," ").concat(g," { ").concat(_," }"):_);s.namespace&&(S=fS(S,s.namespace));var E=[];return Ah(S,hD(d.concat(dD(function(C){return E.push(C)})))),E};return v.hash=c.length?c.reduce(function(m,g){return g.name||ro(15),tu(m,g.name)},aS).toString():"",v}var WD=new Oh,Qm=jD(),hS=Yn.createContext({shouldForwardProp:void 0,styleSheet:WD,stylis:Qm});hS.Consumer;Yn.createContext(void 0);function Zm(){return Q.useContext(hS)}var dS=function(){function r(t,e){var n=this;this.inject=function(a,i){i===void 0&&(i=Qm);var s=n.name+i.hash;a.hasNameForId(n.id,s)||a.insertRules(n.id,s,i(n.rules,s,"@keyframes"))},this.name=t,this.id="sc-keyframes-".concat(t),this.rules=e,ny(this,function(){throw ro(12,String(n.name))})}return r.prototype.getName=function(t){return t===void 0&&(t=Qm),this.name+t.hash},r}(),GD=function(r){return r>="A"&&r<="Z"};function Dw(r){for(var t="",e=0;e<r.length;e++){var n=r[e];if(e===1&&n==="-"&&r[0]==="-")return r;GD(n)?t+="-"+n.toLowerCase():t+=n}return t.startsWith("ms-")?"-"+t:t}var pS=function(r){return r==null||r===!1||r===""},vS=function(r){var t,e,n=[];for(var a in r){var i=r[a];r.hasOwnProperty(a)&&!pS(i)&&(Array.isArray(i)&&i.isCss||Xo(i)?n.push("".concat(Dw(a),":"),i,";"):rc(i)?n.push.apply(n,Su(Su(["".concat(a," {")],vS(i),!1),["}"],!1)):n.push("".concat(Dw(a),": ").concat((t=a,(e=i)==null||typeof e=="boolean"||e===""?"":typeof e!="number"||e===0||t in vD||t.startsWith("--")?String(e).trim():"".concat(e,"px")),";")))}return n};function Zi(r,t,e,n){if(pS(r))return[];if(ty(r))return[".".concat(r.styledComponentId)];if(Xo(r)){if(!Xo(i=r)||i.prototype&&i.prototype.isReactComponent||!t)return[r];var a=r(t);return Zi(a,t,e,n)}var i;return r instanceof dS?e?(r.inject(e,n),[r.getName(n)]):[r]:rc(r)?vS(r):Array.isArray(r)?Array.prototype.concat.apply(gd,r.map(function(s){return Zi(s,t,e,n)})):[r.toString()]}function mS(r){for(var t=0;t<r.length;t+=1){var e=r[t];if(Xo(e)&&!ty(e))return!1}return!0}var qD=iS(md),KD=function(){function r(t,e,n){this.rules=t,this.staticRulesId="",this.isStatic=(n===void 0||n.isStatic)&&mS(t),this.componentId=e,this.baseHash=tu(qD,e),this.baseStyle=n,Oh.registerId(e)}return r.prototype.generateAndInjectStyles=function(t,e,n){var a=this.baseStyle?this.baseStyle.generateAndInjectStyles(t,e,n):"";if(this.isStatic&&!n.hash)if(this.staticRulesId&&e.hasNameForId(this.componentId,this.staticRulesId))a=Mo(a,this.staticRulesId);else{var i=Dh(Zi(this.rules,t,e,n)),s=$m(tu(this.baseHash,i)>>>0);if(!e.hasNameForId(this.componentId,s)){var l=n(i,".".concat(s),void 0,this.componentId);e.insertRules(this.componentId,s,l)}a=Mo(a,s),this.staticRulesId=s}else{for(var c=tu(this.baseHash,n.hash),f="",d=0;d<this.rules.length;d++){var v=this.rules[d];if(typeof v=="string")f+=v;else if(v){var m=Dh(Zi(v,t,e,n));c=tu(c,m+d),f+=m}}if(f){var g=$m(c>>>0);e.hasNameForId(this.componentId,g)||e.insertRules(this.componentId,g,n(f,".".concat(g),void 0,this.componentId)),a=Mo(a,g)}}return a},r}(),Tu=Yn.createContext(void 0);Tu.Consumer;function Jz(){var r=Q.useContext(Tu);if(!r)throw ro(18);return r}function eU(r){var t=Yn.useContext(Tu),e=Q.useMemo(function(){return function(n,a){if(!n)throw ro(14);if(Xo(n)){var i=n(a);return i}if(Array.isArray(n)||typeof n!="object")throw ro(8);return a?pn(pn({},a),n):n}(r.theme,t)},[r.theme,t]);return r.children?Yn.createElement(Tu.Provider,{value:e},r.children):null}var um={};function XD(r,t,e){var n=ty(r),a=r,i=!sm(r),s=t.attrs,l=s===void 0?gd:s,c=t.componentId,f=c===void 0?function(R,A){var D=typeof R!="string"?"sc":_w(R);um[D]=(um[D]||0)+1;var k="".concat(D,"-").concat(ey(md+D+um[D]));return A?"".concat(A,"-").concat(k):k}(t.displayName,t.parentComponentId):c,d=t.displayName,v=d===void 0?function(R){return sm(R)?"styled.".concat(R):"Styled(".concat(wD(R),")")}(r):d,m=t.displayName&&t.componentId?"".concat(_w(t.displayName),"-").concat(t.componentId):t.componentId||f,g=n&&a.attrs?a.attrs.concat(l).filter(Boolean):l,b=t.shouldForwardProp;if(n&&a.shouldForwardProp){var w=a.shouldForwardProp;if(t.shouldForwardProp){var _=t.shouldForwardProp;b=function(R,A){return w(R,A)&&_(R,A)}}else b=w}var S=new KD(e,m,n?a.componentStyle:void 0);function E(R,A){return function(D,k,I){var O=D.attrs,M=D.componentStyle,V=D.defaultProps,z=D.foldedComponentIds,J=D.styledComponentId,te=D.target,ne=Yn.useContext(Tu),P=Zm(),W=D.shouldForwardProp||P.shouldForwardProp,X=nS(k,ne,V)||Au,re=function(ge,ve,Ne){for(var be,Ie=pn(pn({},ve),{className:void 0,theme:Ne}),lt=0;lt<ge.length;lt+=1){var Pe=Xo(be=ge[lt])?be(Ie):be;for(var qe in Pe)Ie[qe]=qe==="className"?Mo(Ie[qe],Pe[qe]):qe==="style"?pn(pn({},Ie[qe]),Pe[qe]):Pe[qe]}return ve.className&&(Ie.className=Mo(Ie.className,ve.className)),Ie}(O,k,X),F=re.as||te,q={};for(var oe in re)re[oe]===void 0||oe[0]==="$"||oe==="as"||oe==="theme"&&re.theme===X||(oe==="forwardedAs"?q.as=re.forwardedAs:W&&!W(oe,F)||(q[oe]=re[oe]));var se=function(ge,ve){var Ne=Zm(),be=ge.generateAndInjectStyles(ve,Ne.styleSheet,Ne.stylis);return be}(M,re),pe=Mo(z,J);return se&&(pe+=" "+se),re.className&&(pe+=" "+re.className),q[sm(F)&&!rS.has(F)?"class":"className"]=pe,I&&(q.ref=I),Q.createElement(F,q)}(C,R,A)}E.displayName=v;var C=Yn.forwardRef(E);return C.attrs=g,C.componentStyle=S,C.displayName=v,C.shouldForwardProp=b,C.foldedComponentIds=n?Mo(a.foldedComponentIds,a.styledComponentId):"",C.styledComponentId=m,C.target=n?a.target:r,Object.defineProperty(C,"defaultProps",{get:function(){return this._foldedDefaultProps},set:function(R){this._foldedDefaultProps=n?function(A){for(var D=[],k=1;k<arguments.length;k++)D[k-1]=arguments[k];for(var I=0,O=D;I<O.length;I++)Ym(A,O[I],!0);return A}({},a.defaultProps,R):R}}),ny(C,function(){return".".concat(C.styledComponentId)}),i&&lS(C,r,{attrs:!0,componentStyle:!0,displayName:!0,foldedComponentIds:!0,shouldForwardProp:!0,styledComponentId:!0,target:!0}),C}function kw(r,t){for(var e=[r[0]],n=0,a=t.length;n<a;n+=1)e.push(t[n],r[n+1]);return e}var Ow=function(r){return Object.assign(r,{isCss:!0})};function ry(r){for(var t=[],e=1;e<arguments.length;e++)t[e-1]=arguments[e];if(Xo(r)||rc(r))return Ow(Zi(kw(gd,Su([r],t,!0))));var n=r;return t.length===0&&n.length===1&&typeof n[0]=="string"?Zi(n):Ow(Zi(kw(n,t)))}function Jm(r,t,e){if(e===void 0&&(e=Au),!t)throw ro(1,t);var n=function(a){for(var i=[],s=1;s<arguments.length;s++)i[s-1]=arguments[s];return r(t,e,ry.apply(void 0,Su([a],i,!1)))};return n.attrs=function(a){return Jm(r,t,pn(pn({},e),{attrs:Array.prototype.concat(e.attrs,a).filter(Boolean)}))},n.withConfig=function(a){return Jm(r,t,pn(pn({},e),a))},n}var gS=function(r){return Jm(XD,r)},$D=gS;rS.forEach(function(r){$D[r]=gS(r)});var YD=function(){function r(t,e){this.rules=t,this.componentId=e,this.isStatic=mS(t),Oh.registerId(this.componentId+1)}return r.prototype.createStyles=function(t,e,n,a){var i=a(Dh(Zi(this.rules,e,n,a)),""),s=this.componentId+t;n.insertRules(s,s,i)},r.prototype.removeStyles=function(t,e){e.clearRules(this.componentId+t)},r.prototype.renderStyles=function(t,e,n,a){t>2&&Oh.registerId(this.componentId+t),this.removeStyles(t,n),this.createStyles(t,e,n,a)},r}();function tU(r){for(var t=[],e=1;e<arguments.length;e++)t[e-1]=arguments[e];var n=ry.apply(void 0,Su([r],t,!1)),a="sc-global-".concat(ey(JSON.stringify(n))),i=new YD(n,a),s=function(c){var f=Zm(),d=Yn.useContext(Tu),v=Yn.useRef(f.styleSheet.allocateGSInstance(a)).current;return f.styleSheet.server&&l(v,c,f.styleSheet,d,f.stylis),Yn.useLayoutEffect(function(){if(!f.styleSheet.server)return l(v,c,f.styleSheet,d,f.stylis),function(){return i.removeStyles(v,f.styleSheet)}},[v,c,f.styleSheet,d,f.stylis]),null};function l(c,f,d,v,m){if(i.isStatic)i.renderStyles(c,gD,d,m);else{var g=pn(pn({},f),{theme:nS(f,v,s.defaultProps)});i.renderStyles(c,g,d,m)}}return Yn.memo(s)}function nU(r){for(var t=[],e=1;e<arguments.length;e++)t[e-1]=arguments[e];var n=Dh(ry.apply(void 0,Su([r],t,!1))),a=ey(n);return new dS(a,n)}var Vl={},Nw;function QD(){if(Nw)return Vl;Nw=1,Object.defineProperty(Vl,"__esModule",{value:!0}),Vl.parse=s,Vl.serialize=f;const r=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,t=/^[\u0021-\u003A\u003C-\u007E]*$/,e=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,n=/^[\u0020-\u003A\u003D-\u007E]*$/,a=Object.prototype.toString,i=(()=>{const m=function(){};return m.prototype=Object.create(null),m})();function s(m,g){const b=new i,w=m.length;if(w<2)return b;const _=(g==null?void 0:g.decode)||d;let S=0;do{const E=m.indexOf("=",S);if(E===-1)break;const C=m.indexOf(";",S),R=C===-1?w:C;if(E>R){S=m.lastIndexOf(";",E-1)+1;continue}const A=l(m,S,E),D=c(m,E,A),k=m.slice(A,D);if(b[k]===void 0){let I=l(m,E+1,R),O=c(m,R,I);const M=_(m.slice(I,O));b[k]=M}S=R+1}while(S<w);return b}function l(m,g,b){do{const w=m.charCodeAt(g);if(w!==32&&w!==9)return g}while(++g<b);return b}function c(m,g,b){for(;g>b;){const w=m.charCodeAt(--g);if(w!==32&&w!==9)return g+1}return b}function f(m,g,b){const w=(b==null?void 0:b.encode)||encodeURIComponent;if(!r.test(m))throw new TypeError(`argument name is invalid: ${m}`);const _=w(g);if(!t.test(_))throw new TypeError(`argument val is invalid: ${g}`);let S=m+"="+_;if(!b)return S;if(b.maxAge!==void 0){if(!Number.isInteger(b.maxAge))throw new TypeError(`option maxAge is invalid: ${b.maxAge}`);S+="; Max-Age="+b.maxAge}if(b.domain){if(!e.test(b.domain))throw new TypeError(`option domain is invalid: ${b.domain}`);S+="; Domain="+b.domain}if(b.path){if(!n.test(b.path))throw new TypeError(`option path is invalid: ${b.path}`);S+="; Path="+b.path}if(b.expires){if(!v(b.expires)||!Number.isFinite(b.expires.valueOf()))throw new TypeError(`option expires is invalid: ${b.expires}`);S+="; Expires="+b.expires.toUTCString()}if(b.httpOnly&&(S+="; HttpOnly"),b.secure&&(S+="; Secure"),b.partitioned&&(S+="; Partitioned"),b.priority)switch(typeof b.priority=="string"?b.priority.toLowerCase():void 0){case"low":S+="; Priority=Low";break;case"medium":S+="; Priority=Medium";break;case"high":S+="; Priority=High";break;default:throw new TypeError(`option priority is invalid: ${b.priority}`)}if(b.sameSite)switch(typeof b.sameSite=="string"?b.sameSite.toLowerCase():b.sameSite){case!0:case"strict":S+="; SameSite=Strict";break;case"lax":S+="; SameSite=Lax";break;case"none":S+="; SameSite=None";break;default:throw new TypeError(`option sameSite is invalid: ${b.sameSite}`)}return S}function d(m){if(m.indexOf("%")===-1)return m;try{return decodeURIComponent(m)}catch{return m}}function v(m){return a.call(m)==="[object Date]"}return Vl}QD();var Mw="popstate";function ZD(r={}){function t(n,a){let{pathname:i,search:s,hash:l}=n.location;return eg("",{pathname:i,search:s,hash:l},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function e(n,a){return typeof a=="string"?a:ac(a)}return ek(t,e,null,r)}function It(r,t){if(r===!1||r===null||typeof r>"u")throw new Error(t)}function Kr(r,t){if(!r){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function JD(){return Math.random().toString(36).substring(2,10)}function Iw(r,t){return{usr:r.state,key:r.key,idx:t}}function eg(r,t,e=null,n){return{pathname:typeof r=="string"?r:r.pathname,search:"",hash:"",...typeof t=="string"?Pu(t):t,state:e,key:t&&t.key||n||JD()}}function ac({pathname:r="/",search:t="",hash:e=""}){return t&&t!=="?"&&(r+=t.charAt(0)==="?"?t:"?"+t),e&&e!=="#"&&(r+=e.charAt(0)==="#"?e:"#"+e),r}function Pu(r){let t={};if(r){let e=r.indexOf("#");e>=0&&(t.hash=r.substring(e),r=r.substring(0,e));let n=r.indexOf("?");n>=0&&(t.search=r.substring(n),r=r.substring(0,n)),r&&(t.pathname=r)}return t}function ek(r,t,e,n={}){let{window:a=document.defaultView,v5Compat:i=!1}=n,s=a.history,l="POP",c=null,f=d();f==null&&(f=0,s.replaceState({...s.state,idx:f},""));function d(){return(s.state||{idx:null}).idx}function v(){l="POP";let _=d(),S=_==null?null:_-f;f=_,c&&c({action:l,location:w.location,delta:S})}function m(_,S){l="PUSH";let E=eg(w.location,_,S);f=d()+1;let C=Iw(E,f),R=w.createHref(E);try{s.pushState(C,"",R)}catch(A){if(A instanceof DOMException&&A.name==="DataCloneError")throw A;a.location.assign(R)}i&&c&&c({action:l,location:w.location,delta:1})}function g(_,S){l="REPLACE";let E=eg(w.location,_,S);f=d();let C=Iw(E,f),R=w.createHref(E);s.replaceState(C,"",R),i&&c&&c({action:l,location:w.location,delta:0})}function b(_){return tk(_)}let w={get action(){return l},get location(){return r(a,s)},listen(_){if(c)throw new Error("A history only accepts one active listener");return a.addEventListener(Mw,v),c=_,()=>{a.removeEventListener(Mw,v),c=null}},createHref(_){return t(a,_)},createURL:b,encodeLocation(_){let S=b(_);return{pathname:S.pathname,search:S.search,hash:S.hash}},push:m,replace:g,go(_){return s.go(_)}};return w}function tk(r,t=!1){let e="http://localhost";typeof window<"u"&&(e=window.location.origin!=="null"?window.location.origin:window.location.href),It(e,"No window.location.(origin|href) available to create URL");let n=typeof r=="string"?r:ac(r);return n=n.replace(/ $/,"%20"),!t&&n.startsWith("//")&&(n=e+n),new URL(n,e)}function yS(r,t,e="/"){return nk(r,t,e,!1)}function nk(r,t,e,n){let a=typeof t=="string"?Pu(t):t,i=Ya(a.pathname||"/",e);if(i==null)return null;let s=bS(r);rk(s);let l=null;for(let c=0;l==null&&c<s.length;++c){let f=pk(i);l=hk(s[c],f,n)}return l}function bS(r,t=[],e=[],n=""){let a=(i,s,l)=>{let c={relativePath:l===void 0?i.path||"":l,caseSensitive:i.caseSensitive===!0,childrenIndex:s,route:i};c.relativePath.startsWith("/")&&(It(c.relativePath.startsWith(n),`Absolute route path "${c.relativePath}" nested under path "${n}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),c.relativePath=c.relativePath.slice(n.length));let f=Xa([n,c.relativePath]),d=e.concat(c);i.children&&i.children.length>0&&(It(i.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${f}".`),bS(i.children,t,d,f)),!(i.path==null&&!i.index)&&t.push({path:f,score:ck(f,i.index),routesMeta:d})};return r.forEach((i,s)=>{var l;if(i.path===""||!((l=i.path)!=null&&l.includes("?")))a(i,s);else for(let c of xS(i.path))a(i,s,c)}),t}function xS(r){let t=r.split("/");if(t.length===0)return[];let[e,...n]=t,a=e.endsWith("?"),i=e.replace(/\?$/,"");if(n.length===0)return a?[i,""]:[i];let s=xS(n.join("/")),l=[];return l.push(...s.map(c=>c===""?i:[i,c].join("/"))),a&&l.push(...s),l.map(c=>r.startsWith("/")&&c===""?"/":c)}function rk(r){r.sort((t,e)=>t.score!==e.score?e.score-t.score:fk(t.routesMeta.map(n=>n.childrenIndex),e.routesMeta.map(n=>n.childrenIndex)))}var ak=/^:[\w-]+$/,ik=3,ok=2,sk=1,uk=10,lk=-2,Fw=r=>r==="*";function ck(r,t){let e=r.split("/"),n=e.length;return e.some(Fw)&&(n+=lk),t&&(n+=ok),e.filter(a=>!Fw(a)).reduce((a,i)=>a+(ak.test(i)?ik:i===""?sk:uk),n)}function fk(r,t){return r.length===t.length&&r.slice(0,-1).every((n,a)=>n===t[a])?r[r.length-1]-t[t.length-1]:0}function hk(r,t,e=!1){let{routesMeta:n}=r,a={},i="/",s=[];for(let l=0;l<n.length;++l){let c=n[l],f=l===n.length-1,d=i==="/"?t:t.slice(i.length)||"/",v=Nh({path:c.relativePath,caseSensitive:c.caseSensitive,end:f},d),m=c.route;if(!v&&f&&e&&!n[n.length-1].route.index&&(v=Nh({path:c.relativePath,caseSensitive:c.caseSensitive,end:!1},d)),!v)return null;Object.assign(a,v.params),s.push({params:a,pathname:Xa([i,v.pathname]),pathnameBase:yk(Xa([i,v.pathnameBase])),route:m}),v.pathnameBase!=="/"&&(i=Xa([i,v.pathnameBase]))}return s}function Nh(r,t){typeof r=="string"&&(r={path:r,caseSensitive:!1,end:!0});let[e,n]=dk(r.path,r.caseSensitive,r.end),a=t.match(e);if(!a)return null;let i=a[0],s=i.replace(/(.)\/+$/,"$1"),l=a.slice(1);return{params:n.reduce((f,{paramName:d,isOptional:v},m)=>{if(d==="*"){let b=l[m]||"";s=i.slice(0,i.length-b.length).replace(/(.)\/+$/,"$1")}const g=l[m];return v&&!g?f[d]=void 0:f[d]=(g||"").replace(/%2F/g,"/"),f},{}),pathname:i,pathnameBase:s,pattern:r}}function dk(r,t=!1,e=!0){Kr(r==="*"||!r.endsWith("*")||r.endsWith("/*"),`Route path "${r}" will be treated as if it were "${r.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${r.replace(/\*$/,"/*")}".`);let n=[],a="^"+r.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(s,l,c)=>(n.push({paramName:l,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)"));return r.endsWith("*")?(n.push({paramName:"*"}),a+=r==="*"||r==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):e?a+="\\/*$":r!==""&&r!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,t?void 0:"i"),n]}function pk(r){try{return r.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return Kr(!1,`The URL path "${r}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${t}).`),r}}function Ya(r,t){if(t==="/")return r;if(!r.toLowerCase().startsWith(t.toLowerCase()))return null;let e=t.endsWith("/")?t.length-1:t.length,n=r.charAt(e);return n&&n!=="/"?null:r.slice(e)||"/"}function vk(r,t="/"){let{pathname:e,search:n="",hash:a=""}=typeof r=="string"?Pu(r):r;return{pathname:e?e.startsWith("/")?e:mk(e,t):t,search:bk(n),hash:xk(a)}}function mk(r,t){let e=t.replace(/\/+$/,"").split("/");return r.split("/").forEach(a=>{a===".."?e.length>1&&e.pop():a!=="."&&e.push(a)}),e.length>1?e.join("/"):"/"}function lm(r,t,e,n){return`Cannot include a '${r}' character in a manually specified \`to.${t}\` field [${JSON.stringify(n)}].  Please separate it out to the \`to.${e}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function gk(r){return r.filter((t,e)=>e===0||t.route.path&&t.route.path.length>0)}function wS(r){let t=gk(r);return t.map((e,n)=>n===t.length-1?e.pathname:e.pathnameBase)}function _S(r,t,e,n=!1){let a;typeof r=="string"?a=Pu(r):(a={...r},It(!a.pathname||!a.pathname.includes("?"),lm("?","pathname","search",a)),It(!a.pathname||!a.pathname.includes("#"),lm("#","pathname","hash",a)),It(!a.search||!a.search.includes("#"),lm("#","search","hash",a)));let i=r===""||a.pathname==="",s=i?"/":a.pathname,l;if(s==null)l=e;else{let v=t.length-1;if(!n&&s.startsWith("..")){let m=s.split("/");for(;m[0]==="..";)m.shift(),v-=1;a.pathname=m.join("/")}l=v>=0?t[v]:"/"}let c=vk(a,l),f=s&&s!=="/"&&s.endsWith("/"),d=(i||s===".")&&e.endsWith("/");return!c.pathname.endsWith("/")&&(f||d)&&(c.pathname+="/"),c}var Xa=r=>r.join("/").replace(/\/\/+/g,"/"),yk=r=>r.replace(/\/+$/,"").replace(/^\/*/,"/"),bk=r=>!r||r==="?"?"":r.startsWith("?")?r:"?"+r,xk=r=>!r||r==="#"?"":r.startsWith("#")?r:"#"+r;function wk(r){return r!=null&&typeof r.status=="number"&&typeof r.statusText=="string"&&typeof r.internal=="boolean"&&"data"in r}var SS=["POST","PUT","PATCH","DELETE"];new Set(SS);var _k=["GET",...SS];new Set(_k);var zu=Q.createContext(null);zu.displayName="DataRouter";var yd=Q.createContext(null);yd.displayName="DataRouterState";var ES=Q.createContext({isTransitioning:!1});ES.displayName="ViewTransition";var Sk=Q.createContext(new Map);Sk.displayName="Fetchers";var Ek=Q.createContext(null);Ek.displayName="Await";var xa=Q.createContext(null);xa.displayName="Navigation";var Cc=Q.createContext(null);Cc.displayName="Location";var Ja=Q.createContext({outlet:null,matches:[],isDataRoute:!1});Ja.displayName="Route";var ay=Q.createContext(null);ay.displayName="RouteError";function Ck(r,{relative:t}={}){It(Rc(),"useHref() may be used only in the context of a <Router> component.");let{basename:e,navigator:n}=Q.useContext(xa),{hash:a,pathname:i,search:s}=Ac(r,{relative:t}),l=i;return e!=="/"&&(l=i==="/"?e:Xa([e,i])),n.createHref({pathname:l,search:s,hash:a})}function Rc(){return Q.useContext(Cc)!=null}function so(){return It(Rc(),"useLocation() may be used only in the context of a <Router> component."),Q.useContext(Cc).location}var CS="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function RS(r){Q.useContext(xa).static||Q.useLayoutEffect(r)}function AS(){let{isDataRoute:r}=Q.useContext(Ja);return r?Pk():Rk()}function Rk(){It(Rc(),"useNavigate() may be used only in the context of a <Router> component.");let r=Q.useContext(zu),{basename:t,navigator:e}=Q.useContext(xa),{matches:n}=Q.useContext(Ja),{pathname:a}=so(),i=JSON.stringify(wS(n)),s=Q.useRef(!1);return RS(()=>{s.current=!0}),Q.useCallback((c,f={})=>{if(Kr(s.current,CS),!s.current)return;if(typeof c=="number"){e.go(c);return}let d=_S(c,JSON.parse(i),a,f.relative==="path");r==null&&t!=="/"&&(d.pathname=d.pathname==="/"?t:Xa([t,d.pathname])),(f.replace?e.replace:e.push)(d,f.state,f)},[t,e,i,a,r])}Q.createContext(null);function Ac(r,{relative:t}={}){let{matches:e}=Q.useContext(Ja),{pathname:n}=so(),a=JSON.stringify(wS(e));return Q.useMemo(()=>_S(r,JSON.parse(a),n,t==="path"),[r,a,n,t])}function Ak(r,t){return TS(r,t)}function TS(r,t,e,n){var S;It(Rc(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:a}=Q.useContext(xa),{matches:i}=Q.useContext(Ja),s=i[i.length-1],l=s?s.params:{},c=s?s.pathname:"/",f=s?s.pathnameBase:"/",d=s&&s.route;{let E=d&&d.path||"";DS(c,!d||E.endsWith("*")||E.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${c}" (under <Route path="${E}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${E}"> to <Route path="${E==="/"?"*":`${E}/*`}">.`)}let v=so(),m;if(t){let E=typeof t=="string"?Pu(t):t;It(f==="/"||((S=E.pathname)==null?void 0:S.startsWith(f)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${f}" but pathname "${E.pathname}" was given in the \`location\` prop.`),m=E}else m=v;let g=m.pathname||"/",b=g;if(f!=="/"){let E=f.replace(/^\//,"").split("/");b="/"+g.replace(/^\//,"").split("/").slice(E.length).join("/")}let w=yS(r,{pathname:b});Kr(d||w!=null,`No routes matched location "${m.pathname}${m.search}${m.hash}" `),Kr(w==null||w[w.length-1].route.element!==void 0||w[w.length-1].route.Component!==void 0||w[w.length-1].route.lazy!==void 0,`Matched leaf route at location "${m.pathname}${m.search}${m.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let _=Nk(w&&w.map(E=>Object.assign({},E,{params:Object.assign({},l,E.params),pathname:Xa([f,a.encodeLocation?a.encodeLocation(E.pathname).pathname:E.pathname]),pathnameBase:E.pathnameBase==="/"?f:Xa([f,a.encodeLocation?a.encodeLocation(E.pathnameBase).pathname:E.pathnameBase])})),i,e,n);return t&&_?Q.createElement(Cc.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...m},navigationType:"POP"}},_):_}function Tk(){let r=Lk(),t=wk(r)?`${r.status} ${r.statusText}`:r instanceof Error?r.message:JSON.stringify(r),e=r instanceof Error?r.stack:null,n="rgba(200,200,200, 0.5)",a={padding:"0.5rem",backgroundColor:n},i={padding:"2px 4px",backgroundColor:n},s=null;return console.error("Error handled by React Router default ErrorBoundary:",r),s=Q.createElement(Q.Fragment,null,Q.createElement("p",null,"💿 Hey developer 👋"),Q.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",Q.createElement("code",{style:i},"ErrorBoundary")," or"," ",Q.createElement("code",{style:i},"errorElement")," prop on your route.")),Q.createElement(Q.Fragment,null,Q.createElement("h2",null,"Unexpected Application Error!"),Q.createElement("h3",{style:{fontStyle:"italic"}},t),e?Q.createElement("pre",{style:a},e):null,s)}var Dk=Q.createElement(Tk,null),kk=class extends Q.Component{constructor(r){super(r),this.state={location:r.location,revalidation:r.revalidation,error:r.error}}static getDerivedStateFromError(r){return{error:r}}static getDerivedStateFromProps(r,t){return t.location!==r.location||t.revalidation!=="idle"&&r.revalidation==="idle"?{error:r.error,location:r.location,revalidation:r.revalidation}:{error:r.error!==void 0?r.error:t.error,location:t.location,revalidation:r.revalidation||t.revalidation}}componentDidCatch(r,t){console.error("React Router caught the following error during render",r,t)}render(){return this.state.error!==void 0?Q.createElement(Ja.Provider,{value:this.props.routeContext},Q.createElement(ay.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function Ok({routeContext:r,match:t,children:e}){let n=Q.useContext(zu);return n&&n.static&&n.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(n.staticContext._deepestRenderedBoundaryId=t.route.id),Q.createElement(Ja.Provider,{value:r},e)}function Nk(r,t=[],e=null,n=null){if(r==null){if(!e)return null;if(e.errors)r=e.matches;else if(t.length===0&&!e.initialized&&e.matches.length>0)r=e.matches;else return null}let a=r,i=e==null?void 0:e.errors;if(i!=null){let c=a.findIndex(f=>f.route.id&&(i==null?void 0:i[f.route.id])!==void 0);It(c>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(i).join(",")}`),a=a.slice(0,Math.min(a.length,c+1))}let s=!1,l=-1;if(e)for(let c=0;c<a.length;c++){let f=a[c];if((f.route.HydrateFallback||f.route.hydrateFallbackElement)&&(l=c),f.route.id){let{loaderData:d,errors:v}=e,m=f.route.loader&&!d.hasOwnProperty(f.route.id)&&(!v||v[f.route.id]===void 0);if(f.route.lazy||m){s=!0,l>=0?a=a.slice(0,l+1):a=[a[0]];break}}}return a.reduceRight((c,f,d)=>{let v,m=!1,g=null,b=null;e&&(v=i&&f.route.id?i[f.route.id]:void 0,g=f.route.errorElement||Dk,s&&(l<0&&d===0?(DS("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),m=!0,b=null):l===d&&(m=!0,b=f.route.hydrateFallbackElement||null)));let w=t.concat(a.slice(0,d+1)),_=()=>{let S;return v?S=g:m?S=b:f.route.Component?S=Q.createElement(f.route.Component,null):f.route.element?S=f.route.element:S=c,Q.createElement(Ok,{match:f,routeContext:{outlet:c,matches:w,isDataRoute:e!=null},children:S})};return e&&(f.route.ErrorBoundary||f.route.errorElement||d===0)?Q.createElement(kk,{location:e.location,revalidation:e.revalidation,component:g,error:v,children:_(),routeContext:{outlet:null,matches:w,isDataRoute:!0}}):_()},null)}function iy(r){return`${r} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function Mk(r){let t=Q.useContext(zu);return It(t,iy(r)),t}function Ik(r){let t=Q.useContext(yd);return It(t,iy(r)),t}function Fk(r){let t=Q.useContext(Ja);return It(t,iy(r)),t}function oy(r){let t=Fk(r),e=t.matches[t.matches.length-1];return It(e.route.id,`${r} can only be used on routes that contain a unique "id"`),e.route.id}function Bk(){return oy("useRouteId")}function Lk(){var n;let r=Q.useContext(ay),t=Ik("useRouteError"),e=oy("useRouteError");return r!==void 0?r:(n=t.errors)==null?void 0:n[e]}function Pk(){let{router:r}=Mk("useNavigate"),t=oy("useNavigate"),e=Q.useRef(!1);return RS(()=>{e.current=!0}),Q.useCallback(async(a,i={})=>{Kr(e.current,CS),e.current&&(typeof a=="number"?r.navigate(a):await r.navigate(a,{fromRouteId:t,...i}))},[r,t])}var Bw={};function DS(r,t,e){!t&&!Bw[r]&&(Bw[r]=!0,Kr(!1,e))}Q.memo(zk);function zk({routes:r,future:t,state:e}){return TS(r,void 0,e,t)}function Uk(r){It(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function Vk({basename:r="/",children:t=null,location:e,navigationType:n="POP",navigator:a,static:i=!1}){It(!Rc(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let s=r.replace(/^\/*/,"/"),l=Q.useMemo(()=>({basename:s,navigator:a,static:i,future:{}}),[s,a,i]);typeof e=="string"&&(e=Pu(e));let{pathname:c="/",search:f="",hash:d="",state:v=null,key:m="default"}=e,g=Q.useMemo(()=>{let b=Ya(c,s);return b==null?null:{location:{pathname:b,search:f,hash:d,state:v,key:m},navigationType:n}},[s,c,f,d,v,m,n]);return Kr(g!=null,`<Router basename="${s}"> is not able to match the URL "${c}${f}${d}" because it does not start with the basename, so the <Router> won't render anything.`),g==null?null:Q.createElement(xa.Provider,{value:l},Q.createElement(Cc.Provider,{children:t,value:g}))}function rU({children:r,location:t}){return Ak(tg(r),t)}function tg(r,t=[]){let e=[];return Q.Children.forEach(r,(n,a)=>{if(!Q.isValidElement(n))return;let i=[...t,a];if(n.type===Q.Fragment){e.push.apply(e,tg(n.props.children,i));return}It(n.type===Uk,`[${typeof n.type=="string"?n.type:n.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),It(!n.props.index||!n.props.children,"An index route cannot have child routes.");let s={id:n.props.id||i.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,hydrateFallbackElement:n.props.hydrateFallbackElement,HydrateFallback:n.props.HydrateFallback,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.hasErrorBoundary===!0||n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(s.children=tg(n.props.children,i)),e.push(s)}),e}var Sh="get",Eh="application/x-www-form-urlencoded";function bd(r){return r!=null&&typeof r.tagName=="string"}function Hk(r){return bd(r)&&r.tagName.toLowerCase()==="button"}function jk(r){return bd(r)&&r.tagName.toLowerCase()==="form"}function Wk(r){return bd(r)&&r.tagName.toLowerCase()==="input"}function Gk(r){return!!(r.metaKey||r.altKey||r.ctrlKey||r.shiftKey)}function qk(r,t){return r.button===0&&(!t||t==="_self")&&!Gk(r)}function ng(r=""){return new URLSearchParams(typeof r=="string"||Array.isArray(r)||r instanceof URLSearchParams?r:Object.keys(r).reduce((t,e)=>{let n=r[e];return t.concat(Array.isArray(n)?n.map(a=>[e,a]):[[e,n]])},[]))}function Kk(r,t){let e=ng(r);return t&&t.forEach((n,a)=>{e.has(a)||t.getAll(a).forEach(i=>{e.append(a,i)})}),e}var Jf=null;function Xk(){if(Jf===null)try{new FormData(document.createElement("form"),0),Jf=!1}catch{Jf=!0}return Jf}var $k=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function cm(r){return r!=null&&!$k.has(r)?(Kr(!1,`"${r}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Eh}"`),null):r}function Yk(r,t){let e,n,a,i,s;if(jk(r)){let l=r.getAttribute("action");n=l?Ya(l,t):null,e=r.getAttribute("method")||Sh,a=cm(r.getAttribute("enctype"))||Eh,i=new FormData(r)}else if(Hk(r)||Wk(r)&&(r.type==="submit"||r.type==="image")){let l=r.form;if(l==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let c=r.getAttribute("formaction")||l.getAttribute("action");if(n=c?Ya(c,t):null,e=r.getAttribute("formmethod")||l.getAttribute("method")||Sh,a=cm(r.getAttribute("formenctype"))||cm(l.getAttribute("enctype"))||Eh,i=new FormData(l,r),!Xk()){let{name:f,type:d,value:v}=r;if(d==="image"){let m=f?`${f}.`:"";i.append(`${m}x`,"0"),i.append(`${m}y`,"0")}else f&&i.append(f,v)}}else{if(bd(r))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');e=Sh,n=null,a=Eh,s=r}return i&&a==="text/plain"&&(s=i,i=void 0),{action:n,method:e.toLowerCase(),encType:a,formData:i,body:s}}function sy(r,t){if(r===!1||r===null||typeof r>"u")throw new Error(t)}async function Qk(r,t){if(r.id in t)return t[r.id];try{let e=await import(r.module);return t[r.id]=e,e}catch(e){return console.error(`Error loading route module \`${r.module}\`, reloading page...`),console.error(e),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function Zk(r){return r==null?!1:r.href==null?r.rel==="preload"&&typeof r.imageSrcSet=="string"&&typeof r.imageSizes=="string":typeof r.rel=="string"&&typeof r.href=="string"}async function Jk(r,t,e){let n=await Promise.all(r.map(async a=>{let i=t.routes[a.route.id];if(i){let s=await Qk(i,e);return s.links?s.links():[]}return[]}));return rO(n.flat(1).filter(Zk).filter(a=>a.rel==="stylesheet"||a.rel==="preload").map(a=>a.rel==="stylesheet"?{...a,rel:"prefetch",as:"style"}:{...a,rel:"prefetch"}))}function Lw(r,t,e,n,a,i){let s=(c,f)=>e[f]?c.route.id!==e[f].route.id:!0,l=(c,f)=>{var d;return e[f].pathname!==c.pathname||((d=e[f].route.path)==null?void 0:d.endsWith("*"))&&e[f].params["*"]!==c.params["*"]};return i==="assets"?t.filter((c,f)=>s(c,f)||l(c,f)):i==="data"?t.filter((c,f)=>{var v;let d=n.routes[c.route.id];if(!d||!d.hasLoader)return!1;if(s(c,f)||l(c,f))return!0;if(c.route.shouldRevalidate){let m=c.route.shouldRevalidate({currentUrl:new URL(a.pathname+a.search+a.hash,window.origin),currentParams:((v=e[0])==null?void 0:v.params)||{},nextUrl:new URL(r,window.origin),nextParams:c.params,defaultShouldRevalidate:!0});if(typeof m=="boolean")return m}return!0}):[]}function eO(r,t,{includeHydrateFallback:e}={}){return tO(r.map(n=>{let a=t.routes[n.route.id];if(!a)return[];let i=[a.module];return a.clientActionModule&&(i=i.concat(a.clientActionModule)),a.clientLoaderModule&&(i=i.concat(a.clientLoaderModule)),e&&a.hydrateFallbackModule&&(i=i.concat(a.hydrateFallbackModule)),a.imports&&(i=i.concat(a.imports)),i}).flat(1))}function tO(r){return[...new Set(r)]}function nO(r){let t={},e=Object.keys(r).sort();for(let n of e)t[n]=r[n];return t}function rO(r,t){let e=new Set;return new Set(t),r.reduce((n,a)=>{let i=JSON.stringify(nO(a));return e.has(i)||(e.add(i),n.push({key:i,link:a})),n},[])}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var aO=new Set([100,101,204,205]);function iO(r,t){let e=typeof r=="string"?new URL(r,typeof window>"u"?"server://singlefetch/":window.location.origin):r;return e.pathname==="/"?e.pathname="_root.data":t&&Ya(e.pathname,t)==="/"?e.pathname=`${t.replace(/\/$/,"")}/_root.data`:e.pathname=`${e.pathname.replace(/\/$/,"")}.data`,e}function kS(){let r=Q.useContext(zu);return sy(r,"You must render this element inside a <DataRouterContext.Provider> element"),r}function oO(){let r=Q.useContext(yd);return sy(r,"You must render this element inside a <DataRouterStateContext.Provider> element"),r}var uy=Q.createContext(void 0);uy.displayName="FrameworkContext";function OS(){let r=Q.useContext(uy);return sy(r,"You must render this element inside a <HydratedRouter> element"),r}function sO(r,t){let e=Q.useContext(uy),[n,a]=Q.useState(!1),[i,s]=Q.useState(!1),{onFocus:l,onBlur:c,onMouseEnter:f,onMouseLeave:d,onTouchStart:v}=t,m=Q.useRef(null);Q.useEffect(()=>{if(r==="render"&&s(!0),r==="viewport"){let w=S=>{S.forEach(E=>{s(E.isIntersecting)})},_=new IntersectionObserver(w,{threshold:.5});return m.current&&_.observe(m.current),()=>{_.disconnect()}}},[r]),Q.useEffect(()=>{if(n){let w=setTimeout(()=>{s(!0)},100);return()=>{clearTimeout(w)}}},[n]);let g=()=>{a(!0)},b=()=>{a(!1),s(!1)};return e?r!=="intent"?[i,m,{}]:[i,m,{onFocus:Hl(l,g),onBlur:Hl(c,b),onMouseEnter:Hl(f,g),onMouseLeave:Hl(d,b),onTouchStart:Hl(v,g)}]:[!1,m,{}]}function Hl(r,t){return e=>{r&&r(e),e.defaultPrevented||t(e)}}function uO({page:r,...t}){let{router:e}=kS(),n=Q.useMemo(()=>yS(e.routes,r,e.basename),[e.routes,r,e.basename]);return n?Q.createElement(cO,{page:r,matches:n,...t}):null}function lO(r){let{manifest:t,routeModules:e}=OS(),[n,a]=Q.useState([]);return Q.useEffect(()=>{let i=!1;return Jk(r,t,e).then(s=>{i||a(s)}),()=>{i=!0}},[r,t,e]),n}function cO({page:r,matches:t,...e}){let n=so(),{manifest:a,routeModules:i}=OS(),{basename:s}=kS(),{loaderData:l,matches:c}=oO(),f=Q.useMemo(()=>Lw(r,t,c,a,n,"data"),[r,t,c,a,n]),d=Q.useMemo(()=>Lw(r,t,c,a,n,"assets"),[r,t,c,a,n]),v=Q.useMemo(()=>{if(r===n.pathname+n.search+n.hash)return[];let b=new Set,w=!1;if(t.forEach(S=>{var C;let E=a.routes[S.route.id];!E||!E.hasLoader||(!f.some(R=>R.route.id===S.route.id)&&S.route.id in l&&((C=i[S.route.id])!=null&&C.shouldRevalidate)||E.hasClientLoader?w=!0:b.add(S.route.id))}),b.size===0)return[];let _=iO(r,s);return w&&b.size>0&&_.searchParams.set("_routes",t.filter(S=>b.has(S.route.id)).map(S=>S.route.id).join(",")),[_.pathname+_.search]},[s,l,n,a,f,t,r,i]),m=Q.useMemo(()=>eO(d,a),[d,a]),g=lO(d);return Q.createElement(Q.Fragment,null,v.map(b=>Q.createElement("link",{key:b,rel:"prefetch",as:"fetch",href:b,...e})),m.map(b=>Q.createElement("link",{key:b,rel:"modulepreload",href:b,...e})),g.map(({key:b,link:w})=>Q.createElement("link",{key:b,...w})))}function fO(...r){return t=>{r.forEach(e=>{typeof e=="function"?e(t):e!=null&&(e.current=t)})}}var NS=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{NS&&(window.__reactRouterVersion="7.6.2")}catch{}function aU({basename:r,children:t,window:e}){let n=Q.useRef();n.current==null&&(n.current=ZD({window:e,v5Compat:!0}));let a=n.current,[i,s]=Q.useState({action:a.action,location:a.location}),l=Q.useCallback(c=>{Q.startTransition(()=>s(c))},[s]);return Q.useLayoutEffect(()=>a.listen(l),[a,l]),Q.createElement(Vk,{basename:r,children:t,location:i.location,navigationType:i.action,navigator:a})}var MS=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,IS=Q.forwardRef(function({onClick:t,discover:e="render",prefetch:n="none",relative:a,reloadDocument:i,replace:s,state:l,target:c,to:f,preventScrollReset:d,viewTransition:v,...m},g){let{basename:b}=Q.useContext(xa),w=typeof f=="string"&&MS.test(f),_,S=!1;if(typeof f=="string"&&w&&(_=f,NS))try{let O=new URL(window.location.href),M=f.startsWith("//")?new URL(O.protocol+f):new URL(f),V=Ya(M.pathname,b);M.origin===O.origin&&V!=null?f=V+M.search+M.hash:S=!0}catch{Kr(!1,`<Link to="${f}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let E=Ck(f,{relative:a}),[C,R,A]=sO(n,m),D=vO(f,{replace:s,state:l,target:c,preventScrollReset:d,relative:a,viewTransition:v});function k(O){t&&t(O),O.defaultPrevented||D(O)}let I=Q.createElement("a",{...m,...A,href:_||E,onClick:S||i?t:k,ref:fO(g,R),target:c,"data-discover":!w&&e==="render"?"true":void 0});return C&&!w?Q.createElement(Q.Fragment,null,I,Q.createElement(uO,{page:E})):I});IS.displayName="Link";var hO=Q.forwardRef(function({"aria-current":t="page",caseSensitive:e=!1,className:n="",end:a=!1,style:i,to:s,viewTransition:l,children:c,...f},d){let v=Ac(s,{relative:f.relative}),m=so(),g=Q.useContext(yd),{navigator:b,basename:w}=Q.useContext(xa),_=g!=null&&xO(v)&&l===!0,S=b.encodeLocation?b.encodeLocation(v).pathname:v.pathname,E=m.pathname,C=g&&g.navigation&&g.navigation.location?g.navigation.location.pathname:null;e||(E=E.toLowerCase(),C=C?C.toLowerCase():null,S=S.toLowerCase()),C&&w&&(C=Ya(C,w)||C);const R=S!=="/"&&S.endsWith("/")?S.length-1:S.length;let A=E===S||!a&&E.startsWith(S)&&E.charAt(R)==="/",D=C!=null&&(C===S||!a&&C.startsWith(S)&&C.charAt(S.length)==="/"),k={isActive:A,isPending:D,isTransitioning:_},I=A?t:void 0,O;typeof n=="function"?O=n(k):O=[n,A?"active":null,D?"pending":null,_?"transitioning":null].filter(Boolean).join(" ");let M=typeof i=="function"?i(k):i;return Q.createElement(IS,{...f,"aria-current":I,className:O,ref:d,style:M,to:s,viewTransition:l},typeof c=="function"?c(k):c)});hO.displayName="NavLink";var dO=Q.forwardRef(({discover:r="render",fetcherKey:t,navigate:e,reloadDocument:n,replace:a,state:i,method:s=Sh,action:l,onSubmit:c,relative:f,preventScrollReset:d,viewTransition:v,...m},g)=>{let b=yO(),w=bO(l,{relative:f}),_=s.toLowerCase()==="get"?"get":"post",S=typeof l=="string"&&MS.test(l),E=C=>{if(c&&c(C),C.defaultPrevented)return;C.preventDefault();let R=C.nativeEvent.submitter,A=(R==null?void 0:R.getAttribute("formmethod"))||s;b(R||C.currentTarget,{fetcherKey:t,method:A,navigate:e,replace:a,state:i,relative:f,preventScrollReset:d,viewTransition:v})};return Q.createElement("form",{ref:g,method:_,action:w,onSubmit:n?c:E,...m,"data-discover":!S&&r==="render"?"true":void 0})});dO.displayName="Form";function pO(r){return`${r} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function FS(r){let t=Q.useContext(zu);return It(t,pO(r)),t}function vO(r,{target:t,replace:e,state:n,preventScrollReset:a,relative:i,viewTransition:s}={}){let l=AS(),c=so(),f=Ac(r,{relative:i});return Q.useCallback(d=>{if(qk(d,t)){d.preventDefault();let v=e!==void 0?e:ac(c)===ac(f);l(r,{replace:v,state:n,preventScrollReset:a,relative:i,viewTransition:s})}},[c,l,f,e,n,t,r,a,i,s])}function iU(r){Kr(typeof URLSearchParams<"u","You cannot use the `useSearchParams` hook in a browser that does not support the URLSearchParams API. If you need to support Internet Explorer 11, we recommend you load a polyfill such as https://github.com/ungap/url-search-params.");let t=Q.useRef(ng(r)),e=Q.useRef(!1),n=so(),a=Q.useMemo(()=>Kk(n.search,e.current?null:t.current),[n.search]),i=AS(),s=Q.useCallback((l,c)=>{const f=ng(typeof l=="function"?l(a):l);e.current=!0,i("?"+f,c)},[i,a]);return[a,s]}var mO=0,gO=()=>`__${String(++mO)}__`;function yO(){let{router:r}=FS("useSubmit"),{basename:t}=Q.useContext(xa),e=Bk();return Q.useCallback(async(n,a={})=>{let{action:i,method:s,encType:l,formData:c,body:f}=Yk(n,t);if(a.navigate===!1){let d=a.fetcherKey||gO();await r.fetch(d,e,a.action||i,{preventScrollReset:a.preventScrollReset,formData:c,body:f,formMethod:a.method||s,formEncType:a.encType||l,flushSync:a.flushSync})}else await r.navigate(a.action||i,{preventScrollReset:a.preventScrollReset,formData:c,body:f,formMethod:a.method||s,formEncType:a.encType||l,replace:a.replace,state:a.state,fromRouteId:e,flushSync:a.flushSync,viewTransition:a.viewTransition})},[r,t,e])}function bO(r,{relative:t}={}){let{basename:e}=Q.useContext(xa),n=Q.useContext(Ja);It(n,"useFormAction must be used inside a RouteContext");let[a]=n.matches.slice(-1),i={...Ac(r||".",{relative:t})},s=so();if(r==null){i.search=s.search;let l=new URLSearchParams(i.search),c=l.getAll("index");if(c.some(d=>d==="")){l.delete("index"),c.filter(v=>v).forEach(v=>l.append("index",v));let d=l.toString();i.search=d?`?${d}`:""}}return(!r||r===".")&&a.route.index&&(i.search=i.search?i.search.replace(/^\?/,"?index&"):"?index"),e!=="/"&&(i.pathname=i.pathname==="/"?e:Xa([e,i.pathname])),ac(i)}function xO(r,t={}){let e=Q.useContext(ES);It(e!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:n}=FS("useViewTransitionState"),a=Ac(r,{relative:t.relative});if(!e.isTransitioning)return!1;let i=Ya(e.currentLocation.pathname,n)||e.currentLocation.pathname,s=Ya(e.nextLocation.pathname,n)||e.nextLocation.pathname;return Nh(a.pathname,s)!=null||Nh(a.pathname,i)!=null}[...aO];function wO(r={}){const{nonce:t,onScriptLoadSuccess:e,onScriptLoadError:n}=r,[a,i]=Q.useState(!1),s=Q.useRef(e);s.current=e;const l=Q.useRef(n);return l.current=n,Q.useEffect(()=>{const c=document.createElement("script");return c.src="https://accounts.google.com/gsi/client",c.async=!0,c.defer=!0,c.nonce=t,c.onload=()=>{var f;i(!0),(f=s.current)===null||f===void 0||f.call(s)},c.onerror=()=>{var f;i(!1),(f=l.current)===null||f===void 0||f.call(l)},document.body.appendChild(c),()=>{document.body.removeChild(c)}},[t]),a}const BS=Q.createContext(null);function oU({clientId:r,nonce:t,onScriptLoadSuccess:e,onScriptLoadError:n,children:a}){const i=wO({nonce:t,onScriptLoadSuccess:e,onScriptLoadError:n}),s=Q.useMemo(()=>({clientId:r,scriptLoadedSuccessfully:i}),[r,i]);return Yn.createElement(BS.Provider,{value:s},a)}function _O(){const r=Q.useContext(BS);if(!r)throw new Error("Google OAuth components must be used within GoogleOAuthProvider");return r}function sU({flow:r="implicit",scope:t="",onSuccess:e,onError:n,onNonOAuthError:a,overrideScope:i,state:s,...l}){const{clientId:c,scriptLoadedSuccessfully:f}=_O(),d=Q.useRef(),v=Q.useRef(e);v.current=e;const m=Q.useRef(n);m.current=n;const g=Q.useRef(a);g.current=a,Q.useEffect(()=>{var _,S;if(!f)return;const E=r==="implicit"?"initTokenClient":"initCodeClient",C=(S=(_=window==null?void 0:window.google)===null||_===void 0?void 0:_.accounts)===null||S===void 0?void 0:S.oauth2[E]({client_id:c,scope:i?t:`openid profile email ${t}`,callback:R=>{var A,D;if(R.error)return(A=m.current)===null||A===void 0?void 0:A.call(m,R);(D=v.current)===null||D===void 0||D.call(v,R)},error_callback:R=>{var A;(A=g.current)===null||A===void 0||A.call(g,R)},state:s,...l});d.current=C},[c,f,r,t,s]);const b=Q.useCallback(_=>{var S;return(S=d.current)===null||S===void 0?void 0:S.requestAccessToken(_)},[]),w=Q.useCallback(()=>{var _;return(_=d.current)===null||_===void 0?void 0:_.requestCode()},[]);return r==="implicit"?b:w}var Uu=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(r){return this.listeners.add(r),this.onSubscribe(),()=>{this.listeners.delete(r),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},$o=typeof window>"u"||"Deno"in globalThis;function Pn(){}function SO(r,t){return typeof r=="function"?r(t):r}function rg(r){return typeof r=="number"&&r>=0&&r!==1/0}function LS(r,t){return Math.max(r+(t||0)-Date.now(),0)}function nu(r,t){return typeof r=="function"?r(t):r}function Hr(r,t){return typeof r=="function"?r(t):r}function Pw(r,t){const{type:e="all",exact:n,fetchStatus:a,predicate:i,queryKey:s,stale:l}=r;if(s){if(n){if(t.queryHash!==ly(s,t.options))return!1}else if(!ic(t.queryKey,s))return!1}if(e!=="all"){const c=t.isActive();if(e==="active"&&!c||e==="inactive"&&c)return!1}return!(typeof l=="boolean"&&t.isStale()!==l||a&&a!==t.state.fetchStatus||i&&!i(t))}function zw(r,t){const{exact:e,status:n,predicate:a,mutationKey:i}=r;if(i){if(!t.options.mutationKey)return!1;if(e){if(Yo(t.options.mutationKey)!==Yo(i))return!1}else if(!ic(t.options.mutationKey,i))return!1}return!(n&&t.state.status!==n||a&&!a(t))}function ly(r,t){return((t==null?void 0:t.queryKeyHashFn)||Yo)(r)}function Yo(r){return JSON.stringify(r,(t,e)=>ag(e)?Object.keys(e).sort().reduce((n,a)=>(n[a]=e[a],n),{}):e)}function ic(r,t){return r===t?!0:typeof r!=typeof t?!1:r&&t&&typeof r=="object"&&typeof t=="object"?Object.keys(t).every(e=>ic(r[e],t[e])):!1}function PS(r,t){if(r===t)return r;const e=Uw(r)&&Uw(t);if(e||ag(r)&&ag(t)){const n=e?r:Object.keys(r),a=n.length,i=e?t:Object.keys(t),s=i.length,l=e?[]:{};let c=0;for(let f=0;f<s;f++){const d=e?f:i[f];(!e&&n.includes(d)||e)&&r[d]===void 0&&t[d]===void 0?(l[d]=void 0,c++):(l[d]=PS(r[d],t[d]),l[d]===r[d]&&r[d]!==void 0&&c++)}return a===s&&c===a?r:l}return t}function Mh(r,t){if(!t||Object.keys(r).length!==Object.keys(t).length)return!1;for(const e in r)if(r[e]!==t[e])return!1;return!0}function Uw(r){return Array.isArray(r)&&r.length===Object.keys(r).length}function ag(r){if(!Vw(r))return!1;const t=r.constructor;if(t===void 0)return!0;const e=t.prototype;return!(!Vw(e)||!e.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(r)!==Object.prototype)}function Vw(r){return Object.prototype.toString.call(r)==="[object Object]"}function EO(r){return new Promise(t=>{setTimeout(t,r)})}function ig(r,t,e){return typeof e.structuralSharing=="function"?e.structuralSharing(r,t):e.structuralSharing!==!1?PS(r,t):t}function CO(r,t,e=0){const n=[...r,t];return e&&n.length>e?n.slice(1):n}function RO(r,t,e=0){const n=[t,...r];return e&&n.length>e?n.slice(0,-1):n}var cy=Symbol();function zS(r,t){return!r.queryFn&&(t!=null&&t.initialPromise)?()=>t.initialPromise:!r.queryFn||r.queryFn===cy?()=>Promise.reject(new Error(`Missing queryFn: '${r.queryHash}'`)):r.queryFn}function US(r,t){return typeof r=="function"?r(...t):!!r}var Bo,Pi,cu,B_,AO=(B_=class extends Uu{constructor(){super();Fe(this,Bo);Fe(this,Pi);Fe(this,cu);we(this,cu,t=>{if(!$o&&window.addEventListener){const e=()=>t();return window.addEventListener("visibilitychange",e,!1),()=>{window.removeEventListener("visibilitychange",e)}}})}onSubscribe(){H(this,Pi)||this.setEventListener(H(this,cu))}onUnsubscribe(){var t;this.hasListeners()||((t=H(this,Pi))==null||t.call(this),we(this,Pi,void 0))}setEventListener(t){var e;we(this,cu,t),(e=H(this,Pi))==null||e.call(this),we(this,Pi,t(n=>{typeof n=="boolean"?this.setFocused(n):this.onFocus()}))}setFocused(t){H(this,Bo)!==t&&(we(this,Bo,t),this.onFocus())}onFocus(){const t=this.isFocused();this.listeners.forEach(e=>{e(t)})}isFocused(){var t;return typeof H(this,Bo)=="boolean"?H(this,Bo):((t=globalThis.document)==null?void 0:t.visibilityState)!=="hidden"}},Bo=new WeakMap,Pi=new WeakMap,cu=new WeakMap,B_),fy=new AO,fu,zi,hu,L_,TO=(L_=class extends Uu{constructor(){super();Fe(this,fu,!0);Fe(this,zi);Fe(this,hu);we(this,hu,t=>{if(!$o&&window.addEventListener){const e=()=>t(!0),n=()=>t(!1);return window.addEventListener("online",e,!1),window.addEventListener("offline",n,!1),()=>{window.removeEventListener("online",e),window.removeEventListener("offline",n)}}})}onSubscribe(){H(this,zi)||this.setEventListener(H(this,hu))}onUnsubscribe(){var t;this.hasListeners()||((t=H(this,zi))==null||t.call(this),we(this,zi,void 0))}setEventListener(t){var e;we(this,hu,t),(e=H(this,zi))==null||e.call(this),we(this,zi,t(this.setOnline.bind(this)))}setOnline(t){H(this,fu)!==t&&(we(this,fu,t),this.listeners.forEach(n=>{n(t)}))}isOnline(){return H(this,fu)}},fu=new WeakMap,zi=new WeakMap,hu=new WeakMap,L_),Ih=new TO;function og(){let r,t;const e=new Promise((a,i)=>{r=a,t=i});e.status="pending",e.catch(()=>{});function n(a){Object.assign(e,a),delete e.resolve,delete e.reject}return e.resolve=a=>{n({status:"fulfilled",value:a}),r(a)},e.reject=a=>{n({status:"rejected",reason:a}),t(a)},e}function DO(r){return Math.min(1e3*2**r,3e4)}function VS(r){return(r??"online")==="online"?Ih.isOnline():!0}var HS=class extends Error{constructor(r){super("CancelledError"),this.revert=r==null?void 0:r.revert,this.silent=r==null?void 0:r.silent}};function fm(r){return r instanceof HS}function jS(r){let t=!1,e=0,n=!1,a;const i=og(),s=w=>{var _;n||(m(new HS(w)),(_=r.abort)==null||_.call(r))},l=()=>{t=!0},c=()=>{t=!1},f=()=>fy.isFocused()&&(r.networkMode==="always"||Ih.isOnline())&&r.canRun(),d=()=>VS(r.networkMode)&&r.canRun(),v=w=>{var _;n||(n=!0,(_=r.onSuccess)==null||_.call(r,w),a==null||a(),i.resolve(w))},m=w=>{var _;n||(n=!0,(_=r.onError)==null||_.call(r,w),a==null||a(),i.reject(w))},g=()=>new Promise(w=>{var _;a=S=>{(n||f())&&w(S)},(_=r.onPause)==null||_.call(r)}).then(()=>{var w;a=void 0,n||(w=r.onContinue)==null||w.call(r)}),b=()=>{if(n)return;let w;const _=e===0?r.initialPromise:void 0;try{w=_??r.fn()}catch(S){w=Promise.reject(S)}Promise.resolve(w).then(v).catch(S=>{var D;if(n)return;const E=r.retry??($o?0:3),C=r.retryDelay??DO,R=typeof C=="function"?C(e,S):C,A=E===!0||typeof E=="number"&&e<E||typeof E=="function"&&E(e,S);if(t||!A){m(S);return}e++,(D=r.onFail)==null||D.call(r,e,S),EO(R).then(()=>f()?void 0:g()).then(()=>{t?m(S):b()})})};return{promise:i,cancel:s,continue:()=>(a==null||a(),i),cancelRetry:l,continueRetry:c,canStart:d,start:()=>(d()?b():g().then(b),i)}}var kO=r=>setTimeout(r,0);function OO(){let r=[],t=0,e=l=>{l()},n=l=>{l()},a=kO;const i=l=>{t?r.push(l):a(()=>{e(l)})},s=()=>{const l=r;r=[],l.length&&a(()=>{n(()=>{l.forEach(c=>{e(c)})})})};return{batch:l=>{let c;t++;try{c=l()}finally{t--,t||s()}return c},batchCalls:l=>(...c)=>{i(()=>{l(...c)})},schedule:i,setNotifyFunction:l=>{e=l},setBatchNotifyFunction:l=>{n=l},setScheduler:l=>{a=l}}}var tn=OO(),Lo,P_,WS=(P_=class{constructor(){Fe(this,Lo)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),rg(this.gcTime)&&we(this,Lo,setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(r){this.gcTime=Math.max(this.gcTime||0,r??($o?1/0:5*60*1e3))}clearGcTimeout(){H(this,Lo)&&(clearTimeout(H(this,Lo)),we(this,Lo,void 0))}},Lo=new WeakMap,P_),du,pu,Ar,Po,Tn,wc,zo,Ur,Ha,z_,NO=(z_=class extends WS{constructor(t){super();Fe(this,Ur);Fe(this,du);Fe(this,pu);Fe(this,Ar);Fe(this,Po);Fe(this,Tn);Fe(this,wc);Fe(this,zo);we(this,zo,!1),we(this,wc,t.defaultOptions),this.setOptions(t.options),this.observers=[],we(this,Po,t.client),we(this,Ar,H(this,Po).getQueryCache()),this.queryKey=t.queryKey,this.queryHash=t.queryHash,we(this,du,MO(this.options)),this.state=t.state??H(this,du),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var t;return(t=H(this,Tn))==null?void 0:t.promise}setOptions(t){this.options={...H(this,wc),...t},this.updateGcTime(this.options.gcTime)}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&H(this,Ar).remove(this)}setData(t,e){const n=ig(this.state.data,t,this.options);return $e(this,Ur,Ha).call(this,{data:n,type:"success",dataUpdatedAt:e==null?void 0:e.updatedAt,manual:e==null?void 0:e.manual}),n}setState(t,e){$e(this,Ur,Ha).call(this,{type:"setState",state:t,setStateOptions:e})}cancel(t){var n,a;const e=(n=H(this,Tn))==null?void 0:n.promise;return(a=H(this,Tn))==null||a.cancel(t),e?e.then(Pn).catch(Pn):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(H(this,du))}isActive(){return this.observers.some(t=>Hr(t.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===cy||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStale(){return this.state.isInvalidated?!0:this.getObserversCount()>0?this.observers.some(t=>t.getCurrentResult().isStale):this.state.data===void 0}isStaleByTime(t=0){return this.state.isInvalidated||this.state.data===void 0||!LS(this.state.dataUpdatedAt,t)}onFocus(){var e;const t=this.observers.find(n=>n.shouldFetchOnWindowFocus());t==null||t.refetch({cancelRefetch:!1}),(e=H(this,Tn))==null||e.continue()}onOnline(){var e;const t=this.observers.find(n=>n.shouldFetchOnReconnect());t==null||t.refetch({cancelRefetch:!1}),(e=H(this,Tn))==null||e.continue()}addObserver(t){this.observers.includes(t)||(this.observers.push(t),this.clearGcTimeout(),H(this,Ar).notify({type:"observerAdded",query:this,observer:t}))}removeObserver(t){this.observers.includes(t)&&(this.observers=this.observers.filter(e=>e!==t),this.observers.length||(H(this,Tn)&&(H(this,zo)?H(this,Tn).cancel({revert:!0}):H(this,Tn).cancelRetry()),this.scheduleGc()),H(this,Ar).notify({type:"observerRemoved",query:this,observer:t}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||$e(this,Ur,Ha).call(this,{type:"invalidate"})}fetch(t,e){var c,f,d;if(this.state.fetchStatus!=="idle"){if(this.state.data!==void 0&&(e!=null&&e.cancelRefetch))this.cancel({silent:!0});else if(H(this,Tn))return H(this,Tn).continueRetry(),H(this,Tn).promise}if(t&&this.setOptions(t),!this.options.queryFn){const v=this.observers.find(m=>m.options.queryFn);v&&this.setOptions(v.options)}const n=new AbortController,a=v=>{Object.defineProperty(v,"signal",{enumerable:!0,get:()=>(we(this,zo,!0),n.signal)})},i=()=>{const v=zS(this.options,e),m={client:H(this,Po),queryKey:this.queryKey,meta:this.meta};return a(m),we(this,zo,!1),this.options.persister?this.options.persister(v,m,this):v(m)},s={fetchOptions:e,options:this.options,queryKey:this.queryKey,client:H(this,Po),state:this.state,fetchFn:i};a(s),(c=this.options.behavior)==null||c.onFetch(s,this),we(this,pu,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((f=s.fetchOptions)==null?void 0:f.meta))&&$e(this,Ur,Ha).call(this,{type:"fetch",meta:(d=s.fetchOptions)==null?void 0:d.meta});const l=v=>{var m,g,b,w;fm(v)&&v.silent||$e(this,Ur,Ha).call(this,{type:"error",error:v}),fm(v)||((g=(m=H(this,Ar).config).onError)==null||g.call(m,v,this),(w=(b=H(this,Ar).config).onSettled)==null||w.call(b,this.state.data,v,this)),this.scheduleGc()};return we(this,Tn,jS({initialPromise:e==null?void 0:e.initialPromise,fn:s.fetchFn,abort:n.abort.bind(n),onSuccess:v=>{var m,g,b,w;if(v===void 0){l(new Error(`${this.queryHash} data is undefined`));return}try{this.setData(v)}catch(_){l(_);return}(g=(m=H(this,Ar).config).onSuccess)==null||g.call(m,v,this),(w=(b=H(this,Ar).config).onSettled)==null||w.call(b,v,this.state.error,this),this.scheduleGc()},onError:l,onFail:(v,m)=>{$e(this,Ur,Ha).call(this,{type:"failed",failureCount:v,error:m})},onPause:()=>{$e(this,Ur,Ha).call(this,{type:"pause"})},onContinue:()=>{$e(this,Ur,Ha).call(this,{type:"continue"})},retry:s.options.retry,retryDelay:s.options.retryDelay,networkMode:s.options.networkMode,canRun:()=>!0})),H(this,Tn).start()}},du=new WeakMap,pu=new WeakMap,Ar=new WeakMap,Po=new WeakMap,Tn=new WeakMap,wc=new WeakMap,zo=new WeakMap,Ur=new WeakSet,Ha=function(t){const e=n=>{switch(t.type){case"failed":return{...n,fetchFailureCount:t.failureCount,fetchFailureReason:t.error};case"pause":return{...n,fetchStatus:"paused"};case"continue":return{...n,fetchStatus:"fetching"};case"fetch":return{...n,...GS(n.data,this.options),fetchMeta:t.meta??null};case"success":return{...n,data:t.data,dataUpdateCount:n.dataUpdateCount+1,dataUpdatedAt:t.dataUpdatedAt??Date.now(),error:null,isInvalidated:!1,status:"success",...!t.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};case"error":const a=t.error;return fm(a)&&a.revert&&H(this,pu)?{...H(this,pu),fetchStatus:"idle"}:{...n,error:a,errorUpdateCount:n.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:n.fetchFailureCount+1,fetchFailureReason:a,fetchStatus:"idle",status:"error"};case"invalidate":return{...n,isInvalidated:!0};case"setState":return{...n,...t.state}}};this.state=e(this.state),tn.batch(()=>{this.observers.forEach(n=>{n.onQueryUpdate()}),H(this,Ar).notify({query:this,type:"updated",action:t})})},z_);function GS(r,t){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:VS(t.networkMode)?"fetching":"paused",...r===void 0&&{error:null,status:"pending"}}}function MO(r){const t=typeof r.initialData=="function"?r.initialData():r.initialData,e=t!==void 0,n=e?typeof r.initialDataUpdatedAt=="function"?r.initialDataUpdatedAt():r.initialDataUpdatedAt:0;return{data:t,dataUpdateCount:0,dataUpdatedAt:e?n??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:e?"success":"pending",fetchStatus:"idle"}}var ia,U_,IO=(U_=class extends Uu{constructor(t={}){super();Fe(this,ia);this.config=t,we(this,ia,new Map)}build(t,e,n){const a=e.queryKey,i=e.queryHash??ly(a,e);let s=this.get(i);return s||(s=new NO({client:t,queryKey:a,queryHash:i,options:t.defaultQueryOptions(e),state:n,defaultOptions:t.getQueryDefaults(a)}),this.add(s)),s}add(t){H(this,ia).has(t.queryHash)||(H(this,ia).set(t.queryHash,t),this.notify({type:"added",query:t}))}remove(t){const e=H(this,ia).get(t.queryHash);e&&(t.destroy(),e===t&&H(this,ia).delete(t.queryHash),this.notify({type:"removed",query:t}))}clear(){tn.batch(()=>{this.getAll().forEach(t=>{this.remove(t)})})}get(t){return H(this,ia).get(t)}getAll(){return[...H(this,ia).values()]}find(t){const e={exact:!0,...t};return this.getAll().find(n=>Pw(e,n))}findAll(t={}){const e=this.getAll();return Object.keys(t).length>0?e.filter(n=>Pw(t,n)):e}notify(t){tn.batch(()=>{this.listeners.forEach(e=>{e(t)})})}onFocus(){tn.batch(()=>{this.getAll().forEach(t=>{t.onFocus()})})}onOnline(){tn.batch(()=>{this.getAll().forEach(t=>{t.onOnline()})})}},ia=new WeakMap,U_),oa,Bn,Uo,sa,Fi,V_,FO=(V_=class extends WS{constructor(t){super();Fe(this,sa);Fe(this,oa);Fe(this,Bn);Fe(this,Uo);this.mutationId=t.mutationId,we(this,Bn,t.mutationCache),we(this,oa,[]),this.state=t.state||qS(),this.setOptions(t.options),this.scheduleGc()}setOptions(t){this.options=t,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(t){H(this,oa).includes(t)||(H(this,oa).push(t),this.clearGcTimeout(),H(this,Bn).notify({type:"observerAdded",mutation:this,observer:t}))}removeObserver(t){we(this,oa,H(this,oa).filter(e=>e!==t)),this.scheduleGc(),H(this,Bn).notify({type:"observerRemoved",mutation:this,observer:t})}optionalRemove(){H(this,oa).length||(this.state.status==="pending"?this.scheduleGc():H(this,Bn).remove(this))}continue(){var t;return((t=H(this,Uo))==null?void 0:t.continue())??this.execute(this.state.variables)}async execute(t){var i,s,l,c,f,d,v,m,g,b,w,_,S,E,C,R,A,D,k,I;const e=()=>{$e(this,sa,Fi).call(this,{type:"continue"})};we(this,Uo,jS({fn:()=>this.options.mutationFn?this.options.mutationFn(t):Promise.reject(new Error("No mutationFn found")),onFail:(O,M)=>{$e(this,sa,Fi).call(this,{type:"failed",failureCount:O,error:M})},onPause:()=>{$e(this,sa,Fi).call(this,{type:"pause"})},onContinue:e,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>H(this,Bn).canRun(this)}));const n=this.state.status==="pending",a=!H(this,Uo).canStart();try{if(n)e();else{$e(this,sa,Fi).call(this,{type:"pending",variables:t,isPaused:a}),await((s=(i=H(this,Bn).config).onMutate)==null?void 0:s.call(i,t,this));const M=await((c=(l=this.options).onMutate)==null?void 0:c.call(l,t));M!==this.state.context&&$e(this,sa,Fi).call(this,{type:"pending",context:M,variables:t,isPaused:a})}const O=await H(this,Uo).start();return await((d=(f=H(this,Bn).config).onSuccess)==null?void 0:d.call(f,O,t,this.state.context,this)),await((m=(v=this.options).onSuccess)==null?void 0:m.call(v,O,t,this.state.context)),await((b=(g=H(this,Bn).config).onSettled)==null?void 0:b.call(g,O,null,this.state.variables,this.state.context,this)),await((_=(w=this.options).onSettled)==null?void 0:_.call(w,O,null,t,this.state.context)),$e(this,sa,Fi).call(this,{type:"success",data:O}),O}catch(O){try{throw await((E=(S=H(this,Bn).config).onError)==null?void 0:E.call(S,O,t,this.state.context,this)),await((R=(C=this.options).onError)==null?void 0:R.call(C,O,t,this.state.context)),await((D=(A=H(this,Bn).config).onSettled)==null?void 0:D.call(A,void 0,O,this.state.variables,this.state.context,this)),await((I=(k=this.options).onSettled)==null?void 0:I.call(k,void 0,O,t,this.state.context)),O}finally{$e(this,sa,Fi).call(this,{type:"error",error:O})}}finally{H(this,Bn).runNext(this)}}},oa=new WeakMap,Bn=new WeakMap,Uo=new WeakMap,sa=new WeakSet,Fi=function(t){const e=n=>{switch(t.type){case"failed":return{...n,failureCount:t.failureCount,failureReason:t.error};case"pause":return{...n,isPaused:!0};case"continue":return{...n,isPaused:!1};case"pending":return{...n,context:t.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:t.isPaused,status:"pending",variables:t.variables,submittedAt:Date.now()};case"success":return{...n,data:t.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...n,data:void 0,error:t.error,failureCount:n.failureCount+1,failureReason:t.error,isPaused:!1,status:"error"}}};this.state=e(this.state),tn.batch(()=>{H(this,oa).forEach(n=>{n.onMutationUpdate(t)}),H(this,Bn).notify({mutation:this,type:"updated",action:t})})},V_);function qS(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var Ga,Vr,_c,H_,BO=(H_=class extends Uu{constructor(t={}){super();Fe(this,Ga);Fe(this,Vr);Fe(this,_c);this.config=t,we(this,Ga,new Set),we(this,Vr,new Map),we(this,_c,0)}build(t,e,n){const a=new FO({mutationCache:this,mutationId:++Yf(this,_c)._,options:t.defaultMutationOptions(e),state:n});return this.add(a),a}add(t){H(this,Ga).add(t);const e=eh(t);if(typeof e=="string"){const n=H(this,Vr).get(e);n?n.push(t):H(this,Vr).set(e,[t])}this.notify({type:"added",mutation:t})}remove(t){if(H(this,Ga).delete(t)){const e=eh(t);if(typeof e=="string"){const n=H(this,Vr).get(e);if(n)if(n.length>1){const a=n.indexOf(t);a!==-1&&n.splice(a,1)}else n[0]===t&&H(this,Vr).delete(e)}}this.notify({type:"removed",mutation:t})}canRun(t){const e=eh(t);if(typeof e=="string"){const n=H(this,Vr).get(e),a=n==null?void 0:n.find(i=>i.state.status==="pending");return!a||a===t}else return!0}runNext(t){var n;const e=eh(t);if(typeof e=="string"){const a=(n=H(this,Vr).get(e))==null?void 0:n.find(i=>i!==t&&i.state.isPaused);return(a==null?void 0:a.continue())??Promise.resolve()}else return Promise.resolve()}clear(){tn.batch(()=>{H(this,Ga).forEach(t=>{this.notify({type:"removed",mutation:t})}),H(this,Ga).clear(),H(this,Vr).clear()})}getAll(){return Array.from(H(this,Ga))}find(t){const e={exact:!0,...t};return this.getAll().find(n=>zw(e,n))}findAll(t={}){return this.getAll().filter(e=>zw(t,e))}notify(t){tn.batch(()=>{this.listeners.forEach(e=>{e(t)})})}resumePausedMutations(){const t=this.getAll().filter(e=>e.state.isPaused);return tn.batch(()=>Promise.all(t.map(e=>e.continue().catch(Pn))))}},Ga=new WeakMap,Vr=new WeakMap,_c=new WeakMap,H_);function eh(r){var t;return(t=r.options.scope)==null?void 0:t.id}function Hw(r){return{onFetch:(t,e)=>{var d,v,m,g,b;const n=t.options,a=(m=(v=(d=t.fetchOptions)==null?void 0:d.meta)==null?void 0:v.fetchMore)==null?void 0:m.direction,i=((g=t.state.data)==null?void 0:g.pages)||[],s=((b=t.state.data)==null?void 0:b.pageParams)||[];let l={pages:[],pageParams:[]},c=0;const f=async()=>{let w=!1;const _=C=>{Object.defineProperty(C,"signal",{enumerable:!0,get:()=>(t.signal.aborted?w=!0:t.signal.addEventListener("abort",()=>{w=!0}),t.signal)})},S=zS(t.options,t.fetchOptions),E=async(C,R,A)=>{if(w)return Promise.reject();if(R==null&&C.pages.length)return Promise.resolve(C);const D={client:t.client,queryKey:t.queryKey,pageParam:R,direction:A?"backward":"forward",meta:t.options.meta};_(D);const k=await S(D),{maxPages:I}=t.options,O=A?RO:CO;return{pages:O(C.pages,k,I),pageParams:O(C.pageParams,R,I)}};if(a&&i.length){const C=a==="backward",R=C?LO:jw,A={pages:i,pageParams:s},D=R(n,A);l=await E(A,D,C)}else{const C=r??i.length;do{const R=c===0?s[0]??n.initialPageParam:jw(n,l);if(c>0&&R==null)break;l=await E(l,R),c++}while(c<C)}return l};t.options.persister?t.fetchFn=()=>{var w,_;return(_=(w=t.options).persister)==null?void 0:_.call(w,f,{client:t.client,queryKey:t.queryKey,meta:t.options.meta,signal:t.signal},e)}:t.fetchFn=f}}}function jw(r,{pages:t,pageParams:e}){const n=t.length-1;return t.length>0?r.getNextPageParam(t[n],t,e[n],e):void 0}function LO(r,{pages:t,pageParams:e}){var n;return t.length>0?(n=r.getPreviousPageParam)==null?void 0:n.call(r,t[0],t,e[0],e):void 0}var zt,Ui,Vi,vu,mu,Hi,gu,yu,j_,uU=(j_=class{constructor(r={}){Fe(this,zt);Fe(this,Ui);Fe(this,Vi);Fe(this,vu);Fe(this,mu);Fe(this,Hi);Fe(this,gu);Fe(this,yu);we(this,zt,r.queryCache||new IO),we(this,Ui,r.mutationCache||new BO),we(this,Vi,r.defaultOptions||{}),we(this,vu,new Map),we(this,mu,new Map),we(this,Hi,0)}mount(){Yf(this,Hi)._++,H(this,Hi)===1&&(we(this,gu,fy.subscribe(async r=>{r&&(await this.resumePausedMutations(),H(this,zt).onFocus())})),we(this,yu,Ih.subscribe(async r=>{r&&(await this.resumePausedMutations(),H(this,zt).onOnline())})))}unmount(){var r,t;Yf(this,Hi)._--,H(this,Hi)===0&&((r=H(this,gu))==null||r.call(this),we(this,gu,void 0),(t=H(this,yu))==null||t.call(this),we(this,yu,void 0))}isFetching(r){return H(this,zt).findAll({...r,fetchStatus:"fetching"}).length}isMutating(r){return H(this,Ui).findAll({...r,status:"pending"}).length}getQueryData(r){var e;const t=this.defaultQueryOptions({queryKey:r});return(e=H(this,zt).get(t.queryHash))==null?void 0:e.state.data}ensureQueryData(r){const t=this.defaultQueryOptions(r),e=H(this,zt).build(this,t),n=e.state.data;return n===void 0?this.fetchQuery(r):(r.revalidateIfStale&&e.isStaleByTime(nu(t.staleTime,e))&&this.prefetchQuery(t),Promise.resolve(n))}getQueriesData(r){return H(this,zt).findAll(r).map(({queryKey:t,state:e})=>{const n=e.data;return[t,n]})}setQueryData(r,t,e){const n=this.defaultQueryOptions({queryKey:r}),a=H(this,zt).get(n.queryHash),i=a==null?void 0:a.state.data,s=SO(t,i);if(s!==void 0)return H(this,zt).build(this,n).setData(s,{...e,manual:!0})}setQueriesData(r,t,e){return tn.batch(()=>H(this,zt).findAll(r).map(({queryKey:n})=>[n,this.setQueryData(n,t,e)]))}getQueryState(r){var e;const t=this.defaultQueryOptions({queryKey:r});return(e=H(this,zt).get(t.queryHash))==null?void 0:e.state}removeQueries(r){const t=H(this,zt);tn.batch(()=>{t.findAll(r).forEach(e=>{t.remove(e)})})}resetQueries(r,t){const e=H(this,zt);return tn.batch(()=>(e.findAll(r).forEach(n=>{n.reset()}),this.refetchQueries({type:"active",...r},t)))}cancelQueries(r,t={}){const e={revert:!0,...t},n=tn.batch(()=>H(this,zt).findAll(r).map(a=>a.cancel(e)));return Promise.all(n).then(Pn).catch(Pn)}invalidateQueries(r,t={}){return tn.batch(()=>(H(this,zt).findAll(r).forEach(e=>{e.invalidate()}),(r==null?void 0:r.refetchType)==="none"?Promise.resolve():this.refetchQueries({...r,type:(r==null?void 0:r.refetchType)??(r==null?void 0:r.type)??"active"},t)))}refetchQueries(r,t={}){const e={...t,cancelRefetch:t.cancelRefetch??!0},n=tn.batch(()=>H(this,zt).findAll(r).filter(a=>!a.isDisabled()).map(a=>{let i=a.fetch(void 0,e);return e.throwOnError||(i=i.catch(Pn)),a.state.fetchStatus==="paused"?Promise.resolve():i}));return Promise.all(n).then(Pn)}fetchQuery(r){const t=this.defaultQueryOptions(r);t.retry===void 0&&(t.retry=!1);const e=H(this,zt).build(this,t);return e.isStaleByTime(nu(t.staleTime,e))?e.fetch(t):Promise.resolve(e.state.data)}prefetchQuery(r){return this.fetchQuery(r).then(Pn).catch(Pn)}fetchInfiniteQuery(r){return r.behavior=Hw(r.pages),this.fetchQuery(r)}prefetchInfiniteQuery(r){return this.fetchInfiniteQuery(r).then(Pn).catch(Pn)}ensureInfiniteQueryData(r){return r.behavior=Hw(r.pages),this.ensureQueryData(r)}resumePausedMutations(){return Ih.isOnline()?H(this,Ui).resumePausedMutations():Promise.resolve()}getQueryCache(){return H(this,zt)}getMutationCache(){return H(this,Ui)}getDefaultOptions(){return H(this,Vi)}setDefaultOptions(r){we(this,Vi,r)}setQueryDefaults(r,t){H(this,vu).set(Yo(r),{queryKey:r,defaultOptions:t})}getQueryDefaults(r){const t=[...H(this,vu).values()],e={};return t.forEach(n=>{ic(r,n.queryKey)&&Object.assign(e,n.defaultOptions)}),e}setMutationDefaults(r,t){H(this,mu).set(Yo(r),{mutationKey:r,defaultOptions:t})}getMutationDefaults(r){const t=[...H(this,mu).values()],e={};return t.forEach(n=>{ic(r,n.mutationKey)&&Object.assign(e,n.defaultOptions)}),e}defaultQueryOptions(r){if(r._defaulted)return r;const t={...H(this,Vi).queries,...this.getQueryDefaults(r.queryKey),...r,_defaulted:!0};return t.queryHash||(t.queryHash=ly(t.queryKey,t)),t.refetchOnReconnect===void 0&&(t.refetchOnReconnect=t.networkMode!=="always"),t.throwOnError===void 0&&(t.throwOnError=!!t.suspense),!t.networkMode&&t.persister&&(t.networkMode="offlineFirst"),t.queryFn===cy&&(t.enabled=!1),t}defaultMutationOptions(r){return r!=null&&r._defaulted?r:{...H(this,Vi).mutations,...(r==null?void 0:r.mutationKey)&&this.getMutationDefaults(r.mutationKey),...r,_defaulted:!0}}clear(){H(this,zt).clear(),H(this,Ui).clear()}},zt=new WeakMap,Ui=new WeakMap,Vi=new WeakMap,vu=new WeakMap,mu=new WeakMap,Hi=new WeakMap,gu=new WeakMap,yu=new WeakMap,j_),qn,it,Sc,Ln,Vo,bu,ji,Wi,Ec,xu,wu,Ho,jo,Gi,_u,mt,Yl,sg,ug,lg,cg,fg,hg,dg,KS,W_,PO=(W_=class extends Uu{constructor(t,e){super();Fe(this,mt);Fe(this,qn);Fe(this,it);Fe(this,Sc);Fe(this,Ln);Fe(this,Vo);Fe(this,bu);Fe(this,ji);Fe(this,Wi);Fe(this,Ec);Fe(this,xu);Fe(this,wu);Fe(this,Ho);Fe(this,jo);Fe(this,Gi);Fe(this,_u,new Set);this.options=e,we(this,qn,t),we(this,Wi,null),we(this,ji,og()),this.options.experimental_prefetchInRender||H(this,ji).reject(new Error("experimental_prefetchInRender feature flag is not enabled")),this.bindMethods(),this.setOptions(e)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(H(this,it).addObserver(this),Ww(H(this,it),this.options)?$e(this,mt,Yl).call(this):this.updateResult(),$e(this,mt,cg).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return pg(H(this,it),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return pg(H(this,it),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,$e(this,mt,fg).call(this),$e(this,mt,hg).call(this),H(this,it).removeObserver(this)}setOptions(t){const e=this.options,n=H(this,it);if(this.options=H(this,qn).defaultQueryOptions(t),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof Hr(this.options.enabled,H(this,it))!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");$e(this,mt,dg).call(this),H(this,it).setOptions(this.options),e._defaulted&&!Mh(this.options,e)&&H(this,qn).getQueryCache().notify({type:"observerOptionsUpdated",query:H(this,it),observer:this});const a=this.hasListeners();a&&Gw(H(this,it),n,this.options,e)&&$e(this,mt,Yl).call(this),this.updateResult(),a&&(H(this,it)!==n||Hr(this.options.enabled,H(this,it))!==Hr(e.enabled,H(this,it))||nu(this.options.staleTime,H(this,it))!==nu(e.staleTime,H(this,it)))&&$e(this,mt,sg).call(this);const i=$e(this,mt,ug).call(this);a&&(H(this,it)!==n||Hr(this.options.enabled,H(this,it))!==Hr(e.enabled,H(this,it))||i!==H(this,Gi))&&$e(this,mt,lg).call(this,i)}getOptimisticResult(t){const e=H(this,qn).getQueryCache().build(H(this,qn),t),n=this.createResult(e,t);return UO(this,n)&&(we(this,Ln,n),we(this,bu,this.options),we(this,Vo,H(this,it).state)),n}getCurrentResult(){return H(this,Ln)}trackResult(t,e){return new Proxy(t,{get:(n,a)=>(this.trackProp(a),e==null||e(a),Reflect.get(n,a))})}trackProp(t){H(this,_u).add(t)}getCurrentQuery(){return H(this,it)}refetch({...t}={}){return this.fetch({...t})}fetchOptimistic(t){const e=H(this,qn).defaultQueryOptions(t),n=H(this,qn).getQueryCache().build(H(this,qn),e);return n.fetch().then(()=>this.createResult(n,e))}fetch(t){return $e(this,mt,Yl).call(this,{...t,cancelRefetch:t.cancelRefetch??!0}).then(()=>(this.updateResult(),H(this,Ln)))}createResult(t,e){var O;const n=H(this,it),a=this.options,i=H(this,Ln),s=H(this,Vo),l=H(this,bu),f=t!==n?t.state:H(this,Sc),{state:d}=t;let v={...d},m=!1,g;if(e._optimisticResults){const M=this.hasListeners(),V=!M&&Ww(t,e),z=M&&Gw(t,n,e,a);(V||z)&&(v={...v,...GS(d.data,t.options)}),e._optimisticResults==="isRestoring"&&(v.fetchStatus="idle")}let{error:b,errorUpdatedAt:w,status:_}=v;g=v.data;let S=!1;if(e.placeholderData!==void 0&&g===void 0&&_==="pending"){let M;i!=null&&i.isPlaceholderData&&e.placeholderData===(l==null?void 0:l.placeholderData)?(M=i.data,S=!0):M=typeof e.placeholderData=="function"?e.placeholderData((O=H(this,wu))==null?void 0:O.state.data,H(this,wu)):e.placeholderData,M!==void 0&&(_="success",g=ig(i==null?void 0:i.data,M,e),m=!0)}if(e.select&&g!==void 0&&!S)if(i&&g===(s==null?void 0:s.data)&&e.select===H(this,Ec))g=H(this,xu);else try{we(this,Ec,e.select),g=e.select(g),g=ig(i==null?void 0:i.data,g,e),we(this,xu,g),we(this,Wi,null)}catch(M){we(this,Wi,M)}H(this,Wi)&&(b=H(this,Wi),g=H(this,xu),w=Date.now(),_="error");const E=v.fetchStatus==="fetching",C=_==="pending",R=_==="error",A=C&&E,D=g!==void 0,I={status:_,fetchStatus:v.fetchStatus,isPending:C,isSuccess:_==="success",isError:R,isInitialLoading:A,isLoading:A,data:g,dataUpdatedAt:v.dataUpdatedAt,error:b,errorUpdatedAt:w,failureCount:v.fetchFailureCount,failureReason:v.fetchFailureReason,errorUpdateCount:v.errorUpdateCount,isFetched:v.dataUpdateCount>0||v.errorUpdateCount>0,isFetchedAfterMount:v.dataUpdateCount>f.dataUpdateCount||v.errorUpdateCount>f.errorUpdateCount,isFetching:E,isRefetching:E&&!C,isLoadingError:R&&!D,isPaused:v.fetchStatus==="paused",isPlaceholderData:m,isRefetchError:R&&D,isStale:hy(t,e),refetch:this.refetch,promise:H(this,ji)};if(this.options.experimental_prefetchInRender){const M=J=>{I.status==="error"?J.reject(I.error):I.data!==void 0&&J.resolve(I.data)},V=()=>{const J=we(this,ji,I.promise=og());M(J)},z=H(this,ji);switch(z.status){case"pending":t.queryHash===n.queryHash&&M(z);break;case"fulfilled":(I.status==="error"||I.data!==z.value)&&V();break;case"rejected":(I.status!=="error"||I.error!==z.reason)&&V();break}}return I}updateResult(){const t=H(this,Ln),e=this.createResult(H(this,it),this.options);if(we(this,Vo,H(this,it).state),we(this,bu,this.options),H(this,Vo).data!==void 0&&we(this,wu,H(this,it)),Mh(e,t))return;we(this,Ln,e);const n=()=>{if(!t)return!0;const{notifyOnChangeProps:a}=this.options,i=typeof a=="function"?a():a;if(i==="all"||!i&&!H(this,_u).size)return!0;const s=new Set(i??H(this,_u));return this.options.throwOnError&&s.add("error"),Object.keys(H(this,Ln)).some(l=>{const c=l;return H(this,Ln)[c]!==t[c]&&s.has(c)})};$e(this,mt,KS).call(this,{listeners:n()})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&$e(this,mt,cg).call(this)}},qn=new WeakMap,it=new WeakMap,Sc=new WeakMap,Ln=new WeakMap,Vo=new WeakMap,bu=new WeakMap,ji=new WeakMap,Wi=new WeakMap,Ec=new WeakMap,xu=new WeakMap,wu=new WeakMap,Ho=new WeakMap,jo=new WeakMap,Gi=new WeakMap,_u=new WeakMap,mt=new WeakSet,Yl=function(t){$e(this,mt,dg).call(this);let e=H(this,it).fetch(this.options,t);return t!=null&&t.throwOnError||(e=e.catch(Pn)),e},sg=function(){$e(this,mt,fg).call(this);const t=nu(this.options.staleTime,H(this,it));if($o||H(this,Ln).isStale||!rg(t))return;const n=LS(H(this,Ln).dataUpdatedAt,t)+1;we(this,Ho,setTimeout(()=>{H(this,Ln).isStale||this.updateResult()},n))},ug=function(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(H(this,it)):this.options.refetchInterval)??!1},lg=function(t){$e(this,mt,hg).call(this),we(this,Gi,t),!($o||Hr(this.options.enabled,H(this,it))===!1||!rg(H(this,Gi))||H(this,Gi)===0)&&we(this,jo,setInterval(()=>{(this.options.refetchIntervalInBackground||fy.isFocused())&&$e(this,mt,Yl).call(this)},H(this,Gi)))},cg=function(){$e(this,mt,sg).call(this),$e(this,mt,lg).call(this,$e(this,mt,ug).call(this))},fg=function(){H(this,Ho)&&(clearTimeout(H(this,Ho)),we(this,Ho,void 0))},hg=function(){H(this,jo)&&(clearInterval(H(this,jo)),we(this,jo,void 0))},dg=function(){const t=H(this,qn).getQueryCache().build(H(this,qn),this.options);if(t===H(this,it))return;const e=H(this,it);we(this,it,t),we(this,Sc,t.state),this.hasListeners()&&(e==null||e.removeObserver(this),t.addObserver(this))},KS=function(t){tn.batch(()=>{t.listeners&&this.listeners.forEach(e=>{e(H(this,Ln))}),H(this,qn).getQueryCache().notify({query:H(this,it),type:"observerResultsUpdated"})})},W_);function zO(r,t){return Hr(t.enabled,r)!==!1&&r.state.data===void 0&&!(r.state.status==="error"&&t.retryOnMount===!1)}function Ww(r,t){return zO(r,t)||r.state.data!==void 0&&pg(r,t,t.refetchOnMount)}function pg(r,t,e){if(Hr(t.enabled,r)!==!1){const n=typeof e=="function"?e(r):e;return n==="always"||n!==!1&&hy(r,t)}return!1}function Gw(r,t,e,n){return(r!==t||Hr(n.enabled,r)===!1)&&(!e.suspense||r.state.status!=="error")&&hy(r,e)}function hy(r,t){return Hr(t.enabled,r)!==!1&&r.isStaleByTime(nu(t.staleTime,r))}function UO(r,t){return!Mh(r.getCurrentResult(),t)}var qi,Ki,Kn,qa,$a,Ch,vg,G_,VO=(G_=class extends Uu{constructor(e,n){super();Fe(this,$a);Fe(this,qi);Fe(this,Ki);Fe(this,Kn);Fe(this,qa);we(this,qi,e),this.setOptions(n),this.bindMethods(),$e(this,$a,Ch).call(this)}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(e){var a;const n=this.options;this.options=H(this,qi).defaultMutationOptions(e),Mh(this.options,n)||H(this,qi).getMutationCache().notify({type:"observerOptionsUpdated",mutation:H(this,Kn),observer:this}),n!=null&&n.mutationKey&&this.options.mutationKey&&Yo(n.mutationKey)!==Yo(this.options.mutationKey)?this.reset():((a=H(this,Kn))==null?void 0:a.state.status)==="pending"&&H(this,Kn).setOptions(this.options)}onUnsubscribe(){var e;this.hasListeners()||(e=H(this,Kn))==null||e.removeObserver(this)}onMutationUpdate(e){$e(this,$a,Ch).call(this),$e(this,$a,vg).call(this,e)}getCurrentResult(){return H(this,Ki)}reset(){var e;(e=H(this,Kn))==null||e.removeObserver(this),we(this,Kn,void 0),$e(this,$a,Ch).call(this),$e(this,$a,vg).call(this)}mutate(e,n){var a;return we(this,qa,n),(a=H(this,Kn))==null||a.removeObserver(this),we(this,Kn,H(this,qi).getMutationCache().build(H(this,qi),this.options)),H(this,Kn).addObserver(this),H(this,Kn).execute(e)}},qi=new WeakMap,Ki=new WeakMap,Kn=new WeakMap,qa=new WeakMap,$a=new WeakSet,Ch=function(){var n;const e=((n=H(this,Kn))==null?void 0:n.state)??qS();we(this,Ki,{...e,isPending:e.status==="pending",isSuccess:e.status==="success",isError:e.status==="error",isIdle:e.status==="idle",mutate:this.mutate,reset:this.reset})},vg=function(e){tn.batch(()=>{var n,a,i,s,l,c,f,d;if(H(this,qa)&&this.hasListeners()){const v=H(this,Ki).variables,m=H(this,Ki).context;(e==null?void 0:e.type)==="success"?((a=(n=H(this,qa)).onSuccess)==null||a.call(n,e.data,v,m),(s=(i=H(this,qa)).onSettled)==null||s.call(i,e.data,null,v,m)):(e==null?void 0:e.type)==="error"&&((c=(l=H(this,qa)).onError)==null||c.call(l,e.error,v,m),(d=(f=H(this,qa)).onSettled)==null||d.call(f,void 0,e.error,v,m))}this.listeners.forEach(v=>{v(H(this,Ki))})})},G_),XS=Q.createContext(void 0),$S=r=>{const t=Q.useContext(XS);if(!t)throw new Error("No QueryClient set, use QueryClientProvider to set one");return t},cU=({client:r,children:t})=>(Q.useEffect(()=>(r.mount(),()=>{r.unmount()}),[r]),HT.jsx(XS.Provider,{value:r,children:t})),YS=Q.createContext(!1),HO=()=>Q.useContext(YS);YS.Provider;function jO(){let r=!1;return{clearReset:()=>{r=!1},reset:()=>{r=!0},isReset:()=>r}}var WO=Q.createContext(jO()),GO=()=>Q.useContext(WO),qO=(r,t)=>{(r.suspense||r.throwOnError||r.experimental_prefetchInRender)&&(t.isReset()||(r.retryOnMount=!1))},KO=r=>{Q.useEffect(()=>{r.clearReset()},[r])},XO=({result:r,errorResetBoundary:t,throwOnError:e,query:n,suspense:a})=>r.isError&&!t.isReset()&&!r.isFetching&&n&&(a&&r.data===void 0||US(e,[r.error,n])),$O=r=>{const t=r.staleTime;r.suspense&&(r.staleTime=typeof t=="function"?(...e)=>Math.max(t(...e),1e3):Math.max(t??1e3,1e3),typeof r.gcTime=="number"&&(r.gcTime=Math.max(r.gcTime,1e3)))},YO=(r,t)=>r.isLoading&&r.isFetching&&!t,QO=(r,t)=>(r==null?void 0:r.suspense)&&t.isPending,qw=(r,t,e)=>t.fetchOptimistic(r).catch(()=>{e.clearReset()});function ZO(r,t,e){var v,m,g,b,w;const n=$S(),a=HO(),i=GO(),s=n.defaultQueryOptions(r);(m=(v=n.getDefaultOptions().queries)==null?void 0:v._experimental_beforeQuery)==null||m.call(v,s),s._optimisticResults=a?"isRestoring":"optimistic",$O(s),qO(s,i),KO(i);const l=!n.getQueryCache().get(s.queryHash),[c]=Q.useState(()=>new t(n,s)),f=c.getOptimisticResult(s),d=!a&&r.subscribed!==!1;if(Q.useSyncExternalStore(Q.useCallback(_=>{const S=d?c.subscribe(tn.batchCalls(_)):Pn;return c.updateResult(),S},[c,d]),()=>c.getCurrentResult(),()=>c.getCurrentResult()),Q.useEffect(()=>{c.setOptions(s)},[s,c]),QO(s,f))throw qw(s,c,i);if(XO({result:f,errorResetBoundary:i,throwOnError:s.throwOnError,query:n.getQueryCache().get(s.queryHash),suspense:s.suspense}))throw f.error;if((b=(g=n.getDefaultOptions().queries)==null?void 0:g._experimental_afterQuery)==null||b.call(g,s,f),s.experimental_prefetchInRender&&!$o&&YO(f,a)){const _=l?qw(s,c,i):(w=n.getQueryCache().get(s.queryHash))==null?void 0:w.promise;_==null||_.catch(Pn).finally(()=>{c.updateResult()})}return s.notifyOnChangeProps?f:c.trackResult(f)}function fU(r,t){return ZO(r,PO)}function hU(r,t){const e=$S(),[n]=Q.useState(()=>new VO(e,r));Q.useEffect(()=>{n.setOptions(r)},[n,r]);const a=Q.useSyncExternalStore(Q.useCallback(s=>n.subscribe(tn.batchCalls(s)),[n]),()=>n.getCurrentResult(),()=>n.getCurrentResult()),i=Q.useCallback((s,l)=>{n.mutate(s,l).catch(Pn)},[n]);if(a.error&&US(n.options.throwOnError,[a.error]))throw a.error;return{...a,mutate:i,mutateAsync:a.mutate}}var dU=function(){return null};const JO=(r,t,e,n)=>{var i,s,l,c;const a=[e,{code:t,...n||{}}];if((s=(i=r==null?void 0:r.services)==null?void 0:i.logger)!=null&&s.forward)return r.services.logger.forward(a,"warn","react-i18next::",!0);Go(a[0])&&(a[0]=`react-i18next:: ${a[0]}`),(c=(l=r==null?void 0:r.services)==null?void 0:l.logger)!=null&&c.warn?r.services.logger.warn(...a):console!=null&&console.warn&&console.warn(...a)},Kw={},mg=(r,t,e,n)=>{Go(e)&&Kw[e]||(Go(e)&&(Kw[e]=new Date),JO(r,t,e,n))},QS=(r,t)=>()=>{if(r.isInitialized)t();else{const e=()=>{setTimeout(()=>{r.off("initialized",e)},0),t()};r.on("initialized",e)}},gg=(r,t,e)=>{r.loadNamespaces(t,QS(r,e))},Xw=(r,t,e,n)=>{if(Go(e)&&(e=[e]),r.options.preload&&r.options.preload.indexOf(t)>-1)return gg(r,e,n);e.forEach(a=>{r.options.ns.indexOf(a)<0&&r.options.ns.push(a)}),r.loadLanguages(t,QS(r,n))},eN=(r,t,e={})=>!t.languages||!t.languages.length?(mg(t,"NO_LANGUAGES","i18n.languages were undefined or empty",{languages:t.languages}),!0):t.hasLoadedNamespace(r,{lng:e.lng,precheck:(n,a)=>{var i;if(((i=e.bindI18n)==null?void 0:i.indexOf("languageChanging"))>-1&&n.services.backendConnector.backend&&n.isLanguageChangingTo&&!a(n.isLanguageChangingTo,r))return!1}}),Go=r=>typeof r=="string",tN=r=>typeof r=="object"&&r!==null,nN=/&(?:amp|#38|lt|#60|gt|#62|apos|#39|quot|#34|nbsp|#160|copy|#169|reg|#174|hellip|#8230|#x2F|#47);/g,rN={"&amp;":"&","&#38;":"&","&lt;":"<","&#60;":"<","&gt;":">","&#62;":">","&apos;":"'","&#39;":"'","&quot;":'"',"&#34;":'"',"&nbsp;":" ","&#160;":" ","&copy;":"©","&#169;":"©","&reg;":"®","&#174;":"®","&hellip;":"…","&#8230;":"…","&#x2F;":"/","&#47;":"/"},aN=r=>rN[r],iN=r=>r.replace(nN,aN);let yg={bindI18n:"languageChanged",bindI18nStore:"",transEmptyNodeValue:"",transSupportBasicHtmlNodes:!0,transWrapTextNodes:"",transKeepBasicHtmlNodesFor:["br","strong","i","p"],useSuspense:!0,unescape:iN};const oN=(r={})=>{yg={...yg,...r}},sN=()=>yg;let ZS;const uN=r=>{ZS=r},lN=()=>ZS,pU={type:"3rdParty",init(r){oN(r.options.react),uN(r)}},JS=Q.createContext();class cN{constructor(){this.usedNamespaces={}}addUsedNamespaces(t){t.forEach(e=>{this.usedNamespaces[e]||(this.usedNamespaces[e]=!0)})}getUsedNamespaces(){return Object.keys(this.usedNamespaces)}}const fN=(r,t)=>{const e=Q.useRef();return Q.useEffect(()=>{e.current=r},[r,t]),e.current},eE=(r,t,e,n)=>r.getFixedT(t,e,n),hN=(r,t,e,n)=>Q.useCallback(eE(r,t,e,n),[r,t,e,n]),vU=(r,t={})=>{var R,A,D,k;const{i18n:e}=t,{i18n:n,defaultNS:a}=Q.useContext(JS)||{},i=e||n||lN();if(i&&!i.reportNamespaces&&(i.reportNamespaces=new cN),!i){mg(i,"NO_I18NEXT_INSTANCE","useTranslation: You will need to pass in an i18next instance by using initReactI18next");const I=(M,V)=>Go(V)?V:tN(V)&&Go(V.defaultValue)?V.defaultValue:Array.isArray(M)?M[M.length-1]:M,O=[I,{},!1];return O.t=I,O.i18n={},O.ready=!1,O}(R=i.options.react)!=null&&R.wait&&mg(i,"DEPRECATED_OPTION","useTranslation: It seems you are still using the old wait option, you may migrate to the new useSuspense behaviour.");const s={...sN(),...i.options.react,...t},{useSuspense:l,keyPrefix:c}=s;let f=a||((A=i.options)==null?void 0:A.defaultNS);f=Go(f)?[f]:f||["translation"],(k=(D=i.reportNamespaces).addUsedNamespaces)==null||k.call(D,f);const d=(i.isInitialized||i.initializedStoreOnce)&&f.every(I=>eN(I,i,s)),v=hN(i,t.lng||null,s.nsMode==="fallback"?f:f[0],c),m=()=>v,g=()=>eE(i,t.lng||null,s.nsMode==="fallback"?f:f[0],c),[b,w]=Q.useState(m);let _=f.join();t.lng&&(_=`${t.lng}${_}`);const S=fN(_),E=Q.useRef(!0);Q.useEffect(()=>{const{bindI18n:I,bindI18nStore:O}=s;E.current=!0,!d&&!l&&(t.lng?Xw(i,t.lng,f,()=>{E.current&&w(g)}):gg(i,f,()=>{E.current&&w(g)})),d&&S&&S!==_&&E.current&&w(g);const M=()=>{E.current&&w(g)};return I&&(i==null||i.on(I,M)),O&&(i==null||i.store.on(O,M)),()=>{E.current=!1,i&&(I==null||I.split(" ").forEach(V=>i.off(V,M))),O&&i&&O.split(" ").forEach(V=>i.store.off(V,M))}},[i,_]),Q.useEffect(()=>{E.current&&d&&w(m)},[i,c,d]);const C=[b,i,d];if(C.t=b,C.i18n=i,C.ready=d,d||!d&&!l)return C;throw new Promise(I=>{t.lng?Xw(i,t.lng,f,()=>I()):gg(i,f,()=>I())})};function mU({i18n:r,defaultNS:t,children:e}){const n=Q.useMemo(()=>({i18n:r,defaultNS:t}),[r,t]);return Q.createElement(JS.Provider,{value:n},e)}function dN(r,t){if(r==null)return{};var e={};for(var n in r)if({}.hasOwnProperty.call(r,n)){if(t.indexOf(n)!==-1)continue;e[n]=r[n]}return e}function Fh(){return Fh=Object.assign?Object.assign.bind():function(r){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var n in e)({}).hasOwnProperty.call(e,n)&&(r[n]=e[n])}return r},Fh.apply(null,arguments)}function bg(r,t){return bg=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,n){return e.__proto__=n,e},bg(r,t)}function pN(r,t){r.prototype=Object.create(t.prototype),r.prototype.constructor=r,bg(r,t)}function hm(r,t,e){if(e||arguments.length===2)for(var n=0,a=t.length,i;n<a;n++)(i||!(n in t))&&(i||(i=Array.prototype.slice.call(t,0,n)),i[n]=t[n]);return r.concat(i||Array.prototype.slice.call(t))}var th={};/*!
 * content-type
 * Copyright(c) 2015 Douglas Christopher Wilson
 * MIT Licensed
 */var $w;function vN(){if($w)return th;$w=1;var r=/; *([!#$%&'*+.^_`|~0-9A-Za-z-]+) *= *("(?:[\u000b\u0020\u0021\u0023-\u005b\u005d-\u007e\u0080-\u00ff]|\\[\u000b\u0020-\u00ff])*"|[!#$%&'*+.^_`|~0-9A-Za-z-]+) */g,t=/^[\u000b\u0020-\u007e\u0080-\u00ff]+$/,e=/^[!#$%&'*+.^_`|~0-9A-Za-z-]+$/,n=/\\([\u000b\u0020-\u00ff])/g,a=/([\\"])/g,i=/^[!#$%&'*+.^_`|~0-9A-Za-z-]+\/[!#$%&'*+.^_`|~0-9A-Za-z-]+$/;th.format=s,th.parse=l;function s(v){if(!v||typeof v!="object")throw new TypeError("argument obj is required");var m=v.parameters,g=v.type;if(!g||!i.test(g))throw new TypeError("invalid type");var b=g;if(m&&typeof m=="object")for(var w,_=Object.keys(m).sort(),S=0;S<_.length;S++){if(w=_[S],!e.test(w))throw new TypeError("invalid parameter name");b+="; "+w+"="+f(m[w])}return b}function l(v){if(!v)throw new TypeError("argument string is required");var m=typeof v=="object"?c(v):v;if(typeof m!="string")throw new TypeError("argument string is required to be a string");var g=m.indexOf(";"),b=g!==-1?m.slice(0,g).trim():m.trim();if(!i.test(b))throw new TypeError("invalid media type");var w=new d(b.toLowerCase());if(g!==-1){var _,S,E;for(r.lastIndex=g;S=r.exec(m);){if(S.index!==g)throw new TypeError("invalid parameter format");g+=S[0].length,_=S[1].toLowerCase(),E=S[2],E.charCodeAt(0)===34&&(E=E.slice(1,-1),E.indexOf("\\")!==-1&&(E=E.replace(n,"$1"))),w.parameters[_]=E}if(g!==m.length)throw new TypeError("invalid parameter format")}return w}function c(v){var m;if(typeof v.getHeader=="function"?m=v.getHeader("content-type"):typeof v.headers=="object"&&(m=v.headers&&v.headers["content-type"]),typeof m!="string")throw new TypeError("content-type header is missing from object");return m}function f(v){var m=String(v);if(e.test(m))return m;if(m.length>0&&!t.test(m))throw new TypeError("invalid parameter value");return'"'+m.replace(a,"\\$1")+'"'}function d(v){this.parameters=Object.create(null),this.type=v}return th}var mN=vN(),$s=new Map,tE=function(t){return t.cloneNode(!0)},Yw=function(){return window.location.protocol==="file:"},nE=function(t,e,n){var a=new XMLHttpRequest;a.onreadystatechange=function(){try{if(!/\.svg/i.test(t)&&a.readyState===2){var i=a.getResponseHeader("Content-Type");if(!i)throw new Error("Content type not found");var s=mN.parse(i).type;if(!(s==="image/svg+xml"||s==="text/plain"))throw new Error("Invalid content type: ".concat(s))}if(a.readyState===4){if(a.status===404||a.responseXML===null)throw new Error(Yw()?"Note: SVG injection ajax calls do not work locally without adjusting security settings in your browser. Or consider using a local webserver.":"Unable to load SVG file: "+t);if(a.status===200||Yw()&&a.status===0)n(null,a);else throw new Error("There was a problem injecting the SVG: "+a.status+" "+a.statusText)}}catch(l){if(a.abort(),l instanceof Error)n(l,a);else throw l}},a.open("GET",t),a.withCredentials=e,a.overrideMimeType&&a.overrideMimeType("text/xml"),a.send()},Li={},Qw=function(t,e){Li[t]=Li[t]||[],Li[t].push(e)},gN=function(t){for(var e=function(s,l){setTimeout(function(){if(Array.isArray(Li[t])){var c=$s.get(t),f=Li[t][s];c instanceof SVGSVGElement&&f(null,tE(c)),c instanceof Error&&f(c),s===Li[t].length-1&&delete Li[t]}},0)},n=0,a=Li[t].length;n<a;n++)e(n)},yN=function(t,e,n){if($s.has(t)){var a=$s.get(t);if(a===void 0){Qw(t,n);return}if(a instanceof SVGSVGElement){n(null,tE(a));return}}$s.set(t,void 0),Qw(t,n),nE(t,e,function(i,s){var l;i?$s.set(t,i):((l=s.responseXML)===null||l===void 0?void 0:l.documentElement)instanceof SVGSVGElement&&$s.set(t,s.responseXML.documentElement),gN(t)})},bN=function(t,e,n){nE(t,e,function(a,i){var s;a?n(a):((s=i.responseXML)===null||s===void 0?void 0:s.documentElement)instanceof SVGSVGElement&&n(null,i.responseXML.documentElement)})},xN=0,wN=function(){return++xN},na=[],Zw={},_N="http://www.w3.org/2000/svg",dm="http://www.w3.org/1999/xlink",Jw=function(t,e,n,a,i,s,l){var c=t.getAttribute("data-src")||t.getAttribute("src");if(!c){l(new Error("Invalid data-src or src attribute"));return}if(na.indexOf(t)!==-1){na.splice(na.indexOf(t),1),t=null;return}na.push(t),t.setAttribute("src","");var f=a?yN:bN;f(c,i,function(d,v){if(!v){na.splice(na.indexOf(t),1),t=null,l(d);return}var m=t.getAttribute("id");m&&v.setAttribute("id",m);var g=t.getAttribute("title");g&&v.setAttribute("title",g);var b=t.getAttribute("width");b&&v.setAttribute("width",b);var w=t.getAttribute("height");w&&v.setAttribute("height",w);var _=Array.from(new Set(hm(hm(hm([],(v.getAttribute("class")||"").split(" "),!0),["injected-svg"],!1),(t.getAttribute("class")||"").split(" "),!0))).join(" ").trim();v.setAttribute("class",_);var S=t.getAttribute("style");S&&v.setAttribute("style",S),v.setAttribute("data-src",c);var E=[].filter.call(t.attributes,function(X){return/^data-\w[\w-]*$/.test(X.name)});if(Array.prototype.forEach.call(E,function(X){X.name&&X.value&&v.setAttribute(X.name,X.value)}),n){var C={clipPath:["clip-path"],"color-profile":["color-profile"],cursor:["cursor"],filter:["filter"],linearGradient:["fill","stroke"],marker:["marker","marker-start","marker-mid","marker-end"],mask:["mask"],path:[],pattern:["fill","stroke"],radialGradient:["fill","stroke"]},R,A,D,k,I;Object.keys(C).forEach(function(X){R=X,D=C[X],A=v.querySelectorAll(R+"[id]");for(var re=function(se,pe){k=A[se].id,I=k+"-"+wN();var ge;Array.prototype.forEach.call(D,function(Qe){ge=v.querySelectorAll("["+Qe+'*="'+k+'"]');for(var dt=0,Et=ge.length;dt<Et;dt++){var xt=ge[dt].getAttribute(Qe);xt&&!xt.match(new RegExp('url\\("?#'+k+'"?\\)'))||ge[dt].setAttribute(Qe,"url(#"+I+")")}});for(var ve=v.querySelectorAll("[*|href]"),Ne=[],be=0,Ie=ve.length;be<Ie;be++){var lt=ve[be].getAttributeNS(dm,"href");lt&&lt.toString()==="#"+A[se].id&&Ne.push(ve[be])}for(var Pe=0,qe=Ne.length;Pe<qe;Pe++)Ne[Pe].setAttributeNS(dm,"href","#"+I);A[se].id=I},F=0,q=A.length;F<q;F++)re(F)})}v.removeAttribute("xmlns:a");for(var O=v.querySelectorAll("script"),M=[],V,z,J=0,te=O.length;J<te;J++)z=O[J].getAttribute("type"),(!z||z==="application/ecmascript"||z==="application/javascript"||z==="text/javascript")&&(V=O[J].innerText||O[J].textContent,V&&M.push(V),v.removeChild(O[J]));if(M.length>0&&(e==="always"||e==="once"&&!Zw[c])){for(var ne=0,P=M.length;ne<P;ne++)new Function(M[ne])(window);Zw[c]=!0}var W=v.querySelectorAll("style");if(Array.prototype.forEach.call(W,function(X){X.textContent+=""}),v.setAttribute("xmlns",_N),v.setAttribute("xmlns:xlink",dm),s(v),!t.parentNode){na.splice(na.indexOf(t),1),t=null,l(new Error("Parent node is null"));return}t.parentNode.replaceChild(v,t),na.splice(na.indexOf(t),1),t=null,l(null,v)})},SN=function(t,e){var n=e===void 0?{}:e,a=n.afterAll,i=a===void 0?function(){}:a,s=n.afterEach,l=s===void 0?function(){}:s,c=n.beforeEach,f=c===void 0?function(){}:c,d=n.cacheRequests,v=d===void 0?!0:d,m=n.evalScripts,g=m===void 0?"never":m,b=n.httpRequestWithCredentials,w=b===void 0?!1:b,_=n.renumerateIRIElements,S=_===void 0?!0:_;if(t&&"length"in t)for(var E=0,C=0,R=t.length;C<R;C++)Jw(t[C],g,S,v,w,f,function(A,D){l(A,D),t&&"length"in t&&t.length===++E&&i(E)});else t?Jw(t,g,S,v,w,f,function(A,D){l(A,D),i(1),t=null}):i(0)},pm={exports:{}},vm,e2;function EN(){if(e2)return vm;e2=1;var r="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return vm=r,vm}var mm,t2;function CN(){if(t2)return mm;t2=1;var r=EN();function t(){}function e(){}return e.resetWarningCache=t,mm=function(){function n(s,l,c,f,d,v){if(v!==r){var m=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw m.name="Invariant Violation",m}}n.isRequired=n;function a(){return n}var i={array:n,bigint:n,bool:n,func:n,number:n,object:n,string:n,symbol:n,any:n,arrayOf:a,element:n,elementType:n,instanceOf:a,node:n,objectOf:a,oneOf:a,oneOfType:a,shape:a,exact:a,checkPropTypes:e,resetWarningCache:t};return i.PropTypes=i,i},mm}var n2;function RN(){return n2||(n2=1,pm.exports=CN()()),pm.exports}var Zt=RN(),AN=function(t){var e=(t==null?void 0:t.ownerDocument)||document;return e.defaultView||window},TN=function(t,e){for(var n in t)if(!(n in e))return!0;for(var a in e)if(t[a]!==e[a])return!0;return!1},DN=["afterInjection","beforeInjection","desc","evalScripts","fallback","httpRequestWithCredentials","loading","renumerateIRIElements","src","title","useRequestCache","wrapper"],nh="http://www.w3.org/2000/svg",r2="http://www.w3.org/1999/xlink",rE=function(r){function t(){for(var n,a=arguments.length,i=new Array(a),s=0;s<a;s++)i[s]=arguments[s];return n=r.call.apply(r,[this].concat(i))||this,n.initialState={hasError:!1,isLoading:!0},n.state=n.initialState,n._isMounted=!1,n.reactWrapper=void 0,n.nonReactWrapper=void 0,n.refCallback=function(l){n.reactWrapper=l},n}pN(t,r);var e=t.prototype;return e.renderSVG=function(){var a=this;if(this.reactWrapper instanceof AN(this.reactWrapper).Node){var i=this.props,s=i.desc,l=i.evalScripts,c=i.httpRequestWithCredentials,f=i.renumerateIRIElements,d=i.src,v=i.title,m=i.useRequestCache,g=this.props.onError,b=this.props.beforeInjection,w=this.props.afterInjection,_=this.props.wrapper,S,E;_==="svg"?(S=document.createElementNS(nh,_),S.setAttribute("xmlns",nh),S.setAttribute("xmlns:xlink",r2),E=document.createElementNS(nh,_)):(S=document.createElement(_),E=document.createElement(_)),S.appendChild(E),E.dataset.src=d,this.nonReactWrapper=this.reactWrapper.appendChild(S);var C=function(k){if(a.removeSVG(),!a._isMounted){g(k);return}a.setState(function(){return{hasError:!0,isLoading:!1}},function(){g(k)})},R=function(k,I){if(k){C(k);return}a._isMounted&&a.setState(function(){return{isLoading:!1}},function(){try{w(I)}catch(O){C(O)}})},A=function(k){if(k.setAttribute("role","img"),s){var I=k.querySelector(":scope > desc");I&&k.removeChild(I);var O=document.createElement("desc");O.innerHTML=s,k.prepend(O)}if(v){var M=k.querySelector(":scope > title");M&&k.removeChild(M);var V=document.createElement("title");V.innerHTML=v,k.prepend(V)}try{b(k)}catch(z){C(z)}};SN(E,{afterEach:R,beforeEach:A,cacheRequests:m,evalScripts:l,httpRequestWithCredentials:c,renumerateIRIElements:f})}},e.removeSVG=function(){var a;(a=this.nonReactWrapper)!=null&&a.parentNode&&(this.nonReactWrapper.parentNode.removeChild(this.nonReactWrapper),this.nonReactWrapper=null)},e.componentDidMount=function(){this._isMounted=!0,this.renderSVG()},e.componentDidUpdate=function(a){var i=this;TN(Fh({},a),this.props)&&this.setState(function(){return i.initialState},function(){i.removeSVG(),i.renderSVG()})},e.componentWillUnmount=function(){this._isMounted=!1,this.removeSVG()},e.render=function(){var a=this.props;a.afterInjection,a.beforeInjection,a.desc,a.evalScripts;var i=a.fallback;a.httpRequestWithCredentials;var s=a.loading;a.renumerateIRIElements,a.src,a.title,a.useRequestCache;var l=a.wrapper,c=dN(a,DN),f=l;return Q.createElement(f,Fh({},c,{ref:this.refCallback},l==="svg"?{xmlns:nh,xmlnsXlink:r2}:{}),this.state.isLoading&&s&&Q.createElement(s,null),this.state.hasError&&i&&Q.createElement(i,null))},t}(Q.Component);rE.defaultProps={afterInjection:function(){},beforeInjection:function(){},desc:"",evalScripts:"never",fallback:null,httpRequestWithCredentials:!1,loading:null,onError:function(){},renumerateIRIElements:!0,title:"",useRequestCache:!0,wrapper:"div"};rE.propTypes={afterInjection:Zt.func,beforeInjection:Zt.func,desc:Zt.string,evalScripts:Zt.oneOf(["always","once","never"]),fallback:Zt.oneOfType([Zt.func,Zt.object,Zt.string]),httpRequestWithCredentials:Zt.bool,loading:Zt.oneOfType([Zt.func,Zt.object,Zt.string]),onError:Zt.func,renumerateIRIElements:Zt.bool,src:Zt.string.isRequired,title:Zt.string,useRequestCache:Zt.bool,wrapper:Zt.oneOf(["div","span","svg"])};const Ve=r=>typeof r=="string",jl=()=>{let r,t;const e=new Promise((n,a)=>{r=n,t=a});return e.resolve=r,e.reject=t,e},a2=r=>r==null?"":""+r,kN=(r,t,e)=>{r.forEach(n=>{t[n]&&(e[n]=t[n])})},ON=/###/g,i2=r=>r&&r.indexOf("###")>-1?r.replace(ON,"."):r,o2=r=>!r||Ve(r),Jl=(r,t,e)=>{const n=Ve(t)?t.split("."):t;let a=0;for(;a<n.length-1;){if(o2(r))return{};const i=i2(n[a]);!r[i]&&e&&(r[i]=new e),Object.prototype.hasOwnProperty.call(r,i)?r=r[i]:r={},++a}return o2(r)?{}:{obj:r,k:i2(n[a])}},s2=(r,t,e)=>{const{obj:n,k:a}=Jl(r,t,Object);if(n!==void 0||t.length===1){n[a]=e;return}let i=t[t.length-1],s=t.slice(0,t.length-1),l=Jl(r,s,Object);for(;l.obj===void 0&&s.length;)i=`${s[s.length-1]}.${i}`,s=s.slice(0,s.length-1),l=Jl(r,s,Object),l!=null&&l.obj&&typeof l.obj[`${l.k}.${i}`]<"u"&&(l.obj=void 0);l.obj[`${l.k}.${i}`]=e},NN=(r,t,e,n)=>{const{obj:a,k:i}=Jl(r,t,Object);a[i]=a[i]||[],a[i].push(e)},Bh=(r,t)=>{const{obj:e,k:n}=Jl(r,t);if(e&&Object.prototype.hasOwnProperty.call(e,n))return e[n]},MN=(r,t,e)=>{const n=Bh(r,e);return n!==void 0?n:Bh(t,e)},aE=(r,t,e)=>{for(const n in t)n!=="__proto__"&&n!=="constructor"&&(n in r?Ve(r[n])||r[n]instanceof String||Ve(t[n])||t[n]instanceof String?e&&(r[n]=t[n]):aE(r[n],t[n],e):r[n]=t[n]);return r},Ws=r=>r.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&");var IN={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};const FN=r=>Ve(r)?r.replace(/[&<>"'\/]/g,t=>IN[t]):r;class BN{constructor(t){this.capacity=t,this.regExpMap=new Map,this.regExpQueue=[]}getRegExp(t){const e=this.regExpMap.get(t);if(e!==void 0)return e;const n=new RegExp(t);return this.regExpQueue.length===this.capacity&&this.regExpMap.delete(this.regExpQueue.shift()),this.regExpMap.set(t,n),this.regExpQueue.push(t),n}}const LN=[" ",",","?","!",";"],PN=new BN(20),zN=(r,t,e)=>{t=t||"",e=e||"";const n=LN.filter(s=>t.indexOf(s)<0&&e.indexOf(s)<0);if(n.length===0)return!0;const a=PN.getRegExp(`(${n.map(s=>s==="?"?"\\?":s).join("|")})`);let i=!a.test(r);if(!i){const s=r.indexOf(e);s>0&&!a.test(r.substring(0,s))&&(i=!0)}return i},xg=(r,t,e=".")=>{if(!r)return;if(r[t])return Object.prototype.hasOwnProperty.call(r,t)?r[t]:void 0;const n=t.split(e);let a=r;for(let i=0;i<n.length;){if(!a||typeof a!="object")return;let s,l="";for(let c=i;c<n.length;++c)if(c!==i&&(l+=e),l+=n[c],s=a[l],s!==void 0){if(["string","number","boolean"].indexOf(typeof s)>-1&&c<n.length-1)continue;i+=c-i+1;break}a=s}return a},oc=r=>r==null?void 0:r.replace("_","-"),UN={type:"logger",log(r){this.output("log",r)},warn(r){this.output("warn",r)},error(r){this.output("error",r)},output(r,t){var e,n;(n=(e=console==null?void 0:console[r])==null?void 0:e.apply)==null||n.call(e,console,t)}};class Lh{constructor(t,e={}){this.init(t,e)}init(t,e={}){this.prefix=e.prefix||"i18next:",this.logger=t||UN,this.options=e,this.debug=e.debug}log(...t){return this.forward(t,"log","",!0)}warn(...t){return this.forward(t,"warn","",!0)}error(...t){return this.forward(t,"error","")}deprecate(...t){return this.forward(t,"warn","WARNING DEPRECATED: ",!0)}forward(t,e,n,a){return a&&!this.debug?null:(Ve(t[0])&&(t[0]=`${n}${this.prefix} ${t[0]}`),this.logger[e](t))}create(t){return new Lh(this.logger,{prefix:`${this.prefix}:${t}:`,...this.options})}clone(t){return t=t||this.options,t.prefix=t.prefix||this.prefix,new Lh(this.logger,t)}}var ha=new Lh;class xd{constructor(){this.observers={}}on(t,e){return t.split(" ").forEach(n=>{this.observers[n]||(this.observers[n]=new Map);const a=this.observers[n].get(e)||0;this.observers[n].set(e,a+1)}),this}off(t,e){if(this.observers[t]){if(!e){delete this.observers[t];return}this.observers[t].delete(e)}}emit(t,...e){this.observers[t]&&Array.from(this.observers[t].entries()).forEach(([a,i])=>{for(let s=0;s<i;s++)a(...e)}),this.observers["*"]&&Array.from(this.observers["*"].entries()).forEach(([a,i])=>{for(let s=0;s<i;s++)a.apply(a,[t,...e])})}}class u2 extends xd{constructor(t,e={ns:["translation"],defaultNS:"translation"}){super(),this.data=t||{},this.options=e,this.options.keySeparator===void 0&&(this.options.keySeparator="."),this.options.ignoreJSONStructure===void 0&&(this.options.ignoreJSONStructure=!0)}addNamespaces(t){this.options.ns.indexOf(t)<0&&this.options.ns.push(t)}removeNamespaces(t){const e=this.options.ns.indexOf(t);e>-1&&this.options.ns.splice(e,1)}getResource(t,e,n,a={}){var f,d;const i=a.keySeparator!==void 0?a.keySeparator:this.options.keySeparator,s=a.ignoreJSONStructure!==void 0?a.ignoreJSONStructure:this.options.ignoreJSONStructure;let l;t.indexOf(".")>-1?l=t.split("."):(l=[t,e],n&&(Array.isArray(n)?l.push(...n):Ve(n)&&i?l.push(...n.split(i)):l.push(n)));const c=Bh(this.data,l);return!c&&!e&&!n&&t.indexOf(".")>-1&&(t=l[0],e=l[1],n=l.slice(2).join(".")),c||!s||!Ve(n)?c:xg((d=(f=this.data)==null?void 0:f[t])==null?void 0:d[e],n,i)}addResource(t,e,n,a,i={silent:!1}){const s=i.keySeparator!==void 0?i.keySeparator:this.options.keySeparator;let l=[t,e];n&&(l=l.concat(s?n.split(s):n)),t.indexOf(".")>-1&&(l=t.split("."),a=e,e=l[1]),this.addNamespaces(e),s2(this.data,l,a),i.silent||this.emit("added",t,e,n,a)}addResources(t,e,n,a={silent:!1}){for(const i in n)(Ve(n[i])||Array.isArray(n[i]))&&this.addResource(t,e,i,n[i],{silent:!0});a.silent||this.emit("added",t,e,n)}addResourceBundle(t,e,n,a,i,s={silent:!1,skipCopy:!1}){let l=[t,e];t.indexOf(".")>-1&&(l=t.split("."),a=n,n=e,e=l[1]),this.addNamespaces(e);let c=Bh(this.data,l)||{};s.skipCopy||(n=JSON.parse(JSON.stringify(n))),a?aE(c,n,i):c={...c,...n},s2(this.data,l,c),s.silent||this.emit("added",t,e,n)}removeResourceBundle(t,e){this.hasResourceBundle(t,e)&&delete this.data[t][e],this.removeNamespaces(e),this.emit("removed",t,e)}hasResourceBundle(t,e){return this.getResource(t,e)!==void 0}getResourceBundle(t,e){return e||(e=this.options.defaultNS),this.getResource(t,e)}getDataByLanguage(t){return this.data[t]}hasLanguageSomeTranslations(t){const e=this.getDataByLanguage(t);return!!(e&&Object.keys(e)||[]).find(a=>e[a]&&Object.keys(e[a]).length>0)}toJSON(){return this.data}}var iE={processors:{},addPostProcessor(r){this.processors[r.name]=r},handle(r,t,e,n,a){return r.forEach(i=>{var s;t=((s=this.processors[i])==null?void 0:s.process(t,e,n,a))??t}),t}};const l2={},c2=r=>!Ve(r)&&typeof r!="boolean"&&typeof r!="number";class Ph extends xd{constructor(t,e={}){super(),kN(["resourceStore","languageUtils","pluralResolver","interpolator","backendConnector","i18nFormat","utils"],t,this),this.options=e,this.options.keySeparator===void 0&&(this.options.keySeparator="."),this.logger=ha.create("translator")}changeLanguage(t){t&&(this.language=t)}exists(t,e={interpolation:{}}){const n={...e};if(t==null)return!1;const a=this.resolve(t,n);return(a==null?void 0:a.res)!==void 0}extractFromKey(t,e){let n=e.nsSeparator!==void 0?e.nsSeparator:this.options.nsSeparator;n===void 0&&(n=":");const a=e.keySeparator!==void 0?e.keySeparator:this.options.keySeparator;let i=e.ns||this.options.defaultNS||[];const s=n&&t.indexOf(n)>-1,l=!this.options.userDefinedKeySeparator&&!e.keySeparator&&!this.options.userDefinedNsSeparator&&!e.nsSeparator&&!zN(t,n,a);if(s&&!l){const c=t.match(this.interpolator.nestingRegexp);if(c&&c.length>0)return{key:t,namespaces:Ve(i)?[i]:i};const f=t.split(n);(n!==a||n===a&&this.options.ns.indexOf(f[0])>-1)&&(i=f.shift()),t=f.join(a)}return{key:t,namespaces:Ve(i)?[i]:i}}translate(t,e,n){let a=typeof e=="object"?{...e}:e;if(typeof a!="object"&&this.options.overloadTranslationOptionHandler&&(a=this.options.overloadTranslationOptionHandler(arguments)),typeof options=="object"&&(a={...a}),a||(a={}),t==null)return"";Array.isArray(t)||(t=[String(t)]);const i=a.returnDetails!==void 0?a.returnDetails:this.options.returnDetails,s=a.keySeparator!==void 0?a.keySeparator:this.options.keySeparator,{key:l,namespaces:c}=this.extractFromKey(t[t.length-1],a),f=c[c.length-1];let d=a.nsSeparator!==void 0?a.nsSeparator:this.options.nsSeparator;d===void 0&&(d=":");const v=a.lng||this.language,m=a.appendNamespaceToCIMode||this.options.appendNamespaceToCIMode;if((v==null?void 0:v.toLowerCase())==="cimode")return m?i?{res:`${f}${d}${l}`,usedKey:l,exactUsedKey:l,usedLng:v,usedNS:f,usedParams:this.getUsedParamsDetails(a)}:`${f}${d}${l}`:i?{res:l,usedKey:l,exactUsedKey:l,usedLng:v,usedNS:f,usedParams:this.getUsedParamsDetails(a)}:l;const g=this.resolve(t,a);let b=g==null?void 0:g.res;const w=(g==null?void 0:g.usedKey)||l,_=(g==null?void 0:g.exactUsedKey)||l,S=["[object Number]","[object Function]","[object RegExp]"],E=a.joinArrays!==void 0?a.joinArrays:this.options.joinArrays,C=!this.i18nFormat||this.i18nFormat.handleAsObject,R=a.count!==void 0&&!Ve(a.count),A=Ph.hasDefaultValue(a),D=R?this.pluralResolver.getSuffix(v,a.count,a):"",k=a.ordinal&&R?this.pluralResolver.getSuffix(v,a.count,{ordinal:!1}):"",I=R&&!a.ordinal&&a.count===0,O=I&&a[`defaultValue${this.options.pluralSeparator}zero`]||a[`defaultValue${D}`]||a[`defaultValue${k}`]||a.defaultValue;let M=b;C&&!b&&A&&(M=O);const V=c2(M),z=Object.prototype.toString.apply(M);if(C&&M&&V&&S.indexOf(z)<0&&!(Ve(E)&&Array.isArray(M))){if(!a.returnObjects&&!this.options.returnObjects){this.options.returnedObjectHandler||this.logger.warn("accessing an object - but returnObjects options is not enabled!");const J=this.options.returnedObjectHandler?this.options.returnedObjectHandler(w,M,{...a,ns:c}):`key '${l} (${this.language})' returned an object instead of string.`;return i?(g.res=J,g.usedParams=this.getUsedParamsDetails(a),g):J}if(s){const J=Array.isArray(M),te=J?[]:{},ne=J?_:w;for(const P in M)if(Object.prototype.hasOwnProperty.call(M,P)){const W=`${ne}${s}${P}`;A&&!b?te[P]=this.translate(W,{...a,defaultValue:c2(O)?O[P]:void 0,joinArrays:!1,ns:c}):te[P]=this.translate(W,{...a,joinArrays:!1,ns:c}),te[P]===W&&(te[P]=M[P])}b=te}}else if(C&&Ve(E)&&Array.isArray(b))b=b.join(E),b&&(b=this.extendTranslation(b,t,a,n));else{let J=!1,te=!1;!this.isValidLookup(b)&&A&&(J=!0,b=O),this.isValidLookup(b)||(te=!0,b=l);const P=(a.missingKeyNoValueFallbackToKey||this.options.missingKeyNoValueFallbackToKey)&&te?void 0:b,W=A&&O!==b&&this.options.updateMissing;if(te||J||W){if(this.logger.log(W?"updateKey":"missingKey",v,f,l,W?O:b),s){const q=this.resolve(l,{...a,keySeparator:!1});q&&q.res&&this.logger.warn("Seems the loaded translations were in flat JSON format instead of nested. Either set keySeparator: false on init or make sure your translations are published in nested format.")}let X=[];const re=this.languageUtils.getFallbackCodes(this.options.fallbackLng,a.lng||this.language);if(this.options.saveMissingTo==="fallback"&&re&&re[0])for(let q=0;q<re.length;q++)X.push(re[q]);else this.options.saveMissingTo==="all"?X=this.languageUtils.toResolveHierarchy(a.lng||this.language):X.push(a.lng||this.language);const F=(q,oe,se)=>{var ge;const pe=A&&se!==b?se:P;this.options.missingKeyHandler?this.options.missingKeyHandler(q,f,oe,pe,W,a):(ge=this.backendConnector)!=null&&ge.saveMissing&&this.backendConnector.saveMissing(q,f,oe,pe,W,a),this.emit("missingKey",q,f,oe,b)};this.options.saveMissing&&(this.options.saveMissingPlurals&&R?X.forEach(q=>{const oe=this.pluralResolver.getSuffixes(q,a);I&&a[`defaultValue${this.options.pluralSeparator}zero`]&&oe.indexOf(`${this.options.pluralSeparator}zero`)<0&&oe.push(`${this.options.pluralSeparator}zero`),oe.forEach(se=>{F([q],l+se,a[`defaultValue${se}`]||O)})}):F(X,l,O))}b=this.extendTranslation(b,t,a,g,n),te&&b===l&&this.options.appendNamespaceToMissingKey&&(b=`${f}${d}${l}`),(te||J)&&this.options.parseMissingKeyHandler&&(b=this.options.parseMissingKeyHandler(this.options.appendNamespaceToMissingKey?`${f}${d}${l}`:l,J?b:void 0,a))}return i?(g.res=b,g.usedParams=this.getUsedParamsDetails(a),g):b}extendTranslation(t,e,n,a,i){var c,f;if((c=this.i18nFormat)!=null&&c.parse)t=this.i18nFormat.parse(t,{...this.options.interpolation.defaultVariables,...n},n.lng||this.language||a.usedLng,a.usedNS,a.usedKey,{resolved:a});else if(!n.skipInterpolation){n.interpolation&&this.interpolator.init({...n,interpolation:{...this.options.interpolation,...n.interpolation}});const d=Ve(t)&&(((f=n==null?void 0:n.interpolation)==null?void 0:f.skipOnVariables)!==void 0?n.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables);let v;if(d){const g=t.match(this.interpolator.nestingRegexp);v=g&&g.length}let m=n.replace&&!Ve(n.replace)?n.replace:n;if(this.options.interpolation.defaultVariables&&(m={...this.options.interpolation.defaultVariables,...m}),t=this.interpolator.interpolate(t,m,n.lng||this.language||a.usedLng,n),d){const g=t.match(this.interpolator.nestingRegexp),b=g&&g.length;v<b&&(n.nest=!1)}!n.lng&&a&&a.res&&(n.lng=this.language||a.usedLng),n.nest!==!1&&(t=this.interpolator.nest(t,(...g)=>(i==null?void 0:i[0])===g[0]&&!n.context?(this.logger.warn(`It seems you are nesting recursively key: ${g[0]} in key: ${e[0]}`),null):this.translate(...g,e),n)),n.interpolation&&this.interpolator.reset()}const s=n.postProcess||this.options.postProcess,l=Ve(s)?[s]:s;return t!=null&&(l!=null&&l.length)&&n.applyPostProcessor!==!1&&(t=iE.handle(l,t,e,this.options&&this.options.postProcessPassResolved?{i18nResolved:{...a,usedParams:this.getUsedParamsDetails(n)},...n}:n,this)),t}resolve(t,e={}){let n,a,i,s,l;return Ve(t)&&(t=[t]),t.forEach(c=>{if(this.isValidLookup(n))return;const f=this.extractFromKey(c,e),d=f.key;a=d;let v=f.namespaces;this.options.fallbackNS&&(v=v.concat(this.options.fallbackNS));const m=e.count!==void 0&&!Ve(e.count),g=m&&!e.ordinal&&e.count===0,b=e.context!==void 0&&(Ve(e.context)||typeof e.context=="number")&&e.context!=="",w=e.lngs?e.lngs:this.languageUtils.toResolveHierarchy(e.lng||this.language,e.fallbackLng);v.forEach(_=>{var S,E;this.isValidLookup(n)||(l=_,!l2[`${w[0]}-${_}`]&&((S=this.utils)!=null&&S.hasLoadedNamespace)&&!((E=this.utils)!=null&&E.hasLoadedNamespace(l))&&(l2[`${w[0]}-${_}`]=!0,this.logger.warn(`key "${a}" for languages "${w.join(", ")}" won't get resolved as namespace "${l}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!")),w.forEach(C=>{var D;if(this.isValidLookup(n))return;s=C;const R=[d];if((D=this.i18nFormat)!=null&&D.addLookupKeys)this.i18nFormat.addLookupKeys(R,d,C,_,e);else{let k;m&&(k=this.pluralResolver.getSuffix(C,e.count,e));const I=`${this.options.pluralSeparator}zero`,O=`${this.options.pluralSeparator}ordinal${this.options.pluralSeparator}`;if(m&&(R.push(d+k),e.ordinal&&k.indexOf(O)===0&&R.push(d+k.replace(O,this.options.pluralSeparator)),g&&R.push(d+I)),b){const M=`${d}${this.options.contextSeparator}${e.context}`;R.push(M),m&&(R.push(M+k),e.ordinal&&k.indexOf(O)===0&&R.push(M+k.replace(O,this.options.pluralSeparator)),g&&R.push(M+I))}}let A;for(;A=R.pop();)this.isValidLookup(n)||(i=A,n=this.getResource(C,_,A,e))}))})}),{res:n,usedKey:a,exactUsedKey:i,usedLng:s,usedNS:l}}isValidLookup(t){return t!==void 0&&!(!this.options.returnNull&&t===null)&&!(!this.options.returnEmptyString&&t==="")}getResource(t,e,n,a={}){var i;return(i=this.i18nFormat)!=null&&i.getResource?this.i18nFormat.getResource(t,e,n,a):this.resourceStore.getResource(t,e,n,a)}getUsedParamsDetails(t={}){const e=["defaultValue","ordinal","context","replace","lng","lngs","fallbackLng","ns","keySeparator","nsSeparator","returnObjects","returnDetails","joinArrays","postProcess","interpolation"],n=t.replace&&!Ve(t.replace);let a=n?t.replace:t;if(n&&typeof t.count<"u"&&(a.count=t.count),this.options.interpolation.defaultVariables&&(a={...this.options.interpolation.defaultVariables,...a}),!n){a={...a};for(const i of e)delete a[i]}return a}static hasDefaultValue(t){const e="defaultValue";for(const n in t)if(Object.prototype.hasOwnProperty.call(t,n)&&e===n.substring(0,e.length)&&t[n]!==void 0)return!0;return!1}}class f2{constructor(t){this.options=t,this.supportedLngs=this.options.supportedLngs||!1,this.logger=ha.create("languageUtils")}getScriptPartFromCode(t){if(t=oc(t),!t||t.indexOf("-")<0)return null;const e=t.split("-");return e.length===2||(e.pop(),e[e.length-1].toLowerCase()==="x")?null:this.formatLanguageCode(e.join("-"))}getLanguagePartFromCode(t){if(t=oc(t),!t||t.indexOf("-")<0)return t;const e=t.split("-");return this.formatLanguageCode(e[0])}formatLanguageCode(t){if(Ve(t)&&t.indexOf("-")>-1){let e;try{e=Intl.getCanonicalLocales(t)[0]}catch{}return e&&this.options.lowerCaseLng&&(e=e.toLowerCase()),e||(this.options.lowerCaseLng?t.toLowerCase():t)}return this.options.cleanCode||this.options.lowerCaseLng?t.toLowerCase():t}isSupportedCode(t){return(this.options.load==="languageOnly"||this.options.nonExplicitSupportedLngs)&&(t=this.getLanguagePartFromCode(t)),!this.supportedLngs||!this.supportedLngs.length||this.supportedLngs.indexOf(t)>-1}getBestMatchFromCodes(t){if(!t)return null;let e;return t.forEach(n=>{if(e)return;const a=this.formatLanguageCode(n);(!this.options.supportedLngs||this.isSupportedCode(a))&&(e=a)}),!e&&this.options.supportedLngs&&t.forEach(n=>{if(e)return;const a=this.getScriptPartFromCode(n);if(this.isSupportedCode(a))return e=a;const i=this.getLanguagePartFromCode(n);if(this.isSupportedCode(i))return e=i;e=this.options.supportedLngs.find(s=>{if(s===i)return s;if(!(s.indexOf("-")<0&&i.indexOf("-")<0)&&(s.indexOf("-")>0&&i.indexOf("-")<0&&s.substring(0,s.indexOf("-"))===i||s.indexOf(i)===0&&i.length>1))return s})}),e||(e=this.getFallbackCodes(this.options.fallbackLng)[0]),e}getFallbackCodes(t,e){if(!t)return[];if(typeof t=="function"&&(t=t(e)),Ve(t)&&(t=[t]),Array.isArray(t))return t;if(!e)return t.default||[];let n=t[e];return n||(n=t[this.getScriptPartFromCode(e)]),n||(n=t[this.formatLanguageCode(e)]),n||(n=t[this.getLanguagePartFromCode(e)]),n||(n=t.default),n||[]}toResolveHierarchy(t,e){const n=this.getFallbackCodes((e===!1?[]:e)||this.options.fallbackLng||[],t),a=[],i=s=>{s&&(this.isSupportedCode(s)?a.push(s):this.logger.warn(`rejecting language code not found in supportedLngs: ${s}`))};return Ve(t)&&(t.indexOf("-")>-1||t.indexOf("_")>-1)?(this.options.load!=="languageOnly"&&i(this.formatLanguageCode(t)),this.options.load!=="languageOnly"&&this.options.load!=="currentOnly"&&i(this.getScriptPartFromCode(t)),this.options.load!=="currentOnly"&&i(this.getLanguagePartFromCode(t))):Ve(t)&&i(this.formatLanguageCode(t)),n.forEach(s=>{a.indexOf(s)<0&&i(this.formatLanguageCode(s))}),a}}const h2={zero:0,one:1,two:2,few:3,many:4,other:5},d2={select:r=>r===1?"one":"other",resolvedOptions:()=>({pluralCategories:["one","other"]})};class VN{constructor(t,e={}){this.languageUtils=t,this.options=e,this.logger=ha.create("pluralResolver"),this.pluralRulesCache={}}addRule(t,e){this.rules[t]=e}clearCache(){this.pluralRulesCache={}}getRule(t,e={}){const n=oc(t==="dev"?"en":t),a=e.ordinal?"ordinal":"cardinal",i=JSON.stringify({cleanedCode:n,type:a});if(i in this.pluralRulesCache)return this.pluralRulesCache[i];let s;try{s=new Intl.PluralRules(n,{type:a})}catch{if(!Intl)return this.logger.error("No Intl support, please use an Intl polyfill!"),d2;if(!t.match(/-|_/))return d2;const c=this.languageUtils.getLanguagePartFromCode(t);s=this.getRule(c,e)}return this.pluralRulesCache[i]=s,s}needsPlural(t,e={}){let n=this.getRule(t,e);return n||(n=this.getRule("dev",e)),(n==null?void 0:n.resolvedOptions().pluralCategories.length)>1}getPluralFormsOfKey(t,e,n={}){return this.getSuffixes(t,n).map(a=>`${e}${a}`)}getSuffixes(t,e={}){let n=this.getRule(t,e);return n||(n=this.getRule("dev",e)),n?n.resolvedOptions().pluralCategories.sort((a,i)=>h2[a]-h2[i]).map(a=>`${this.options.prepend}${e.ordinal?`ordinal${this.options.prepend}`:""}${a}`):[]}getSuffix(t,e,n={}){const a=this.getRule(t,n);return a?`${this.options.prepend}${n.ordinal?`ordinal${this.options.prepend}`:""}${a.select(e)}`:(this.logger.warn(`no plural rule found for: ${t}`),this.getSuffix("dev",e,n))}}const p2=(r,t,e,n=".",a=!0)=>{let i=MN(r,t,e);return!i&&a&&Ve(e)&&(i=xg(r,e,n),i===void 0&&(i=xg(t,e,n))),i},gm=r=>r.replace(/\$/g,"$$$$");class HN{constructor(t={}){var e;this.logger=ha.create("interpolator"),this.options=t,this.format=((e=t==null?void 0:t.interpolation)==null?void 0:e.format)||(n=>n),this.init(t)}init(t={}){t.interpolation||(t.interpolation={escapeValue:!0});const{escape:e,escapeValue:n,useRawValueToEscape:a,prefix:i,prefixEscaped:s,suffix:l,suffixEscaped:c,formatSeparator:f,unescapeSuffix:d,unescapePrefix:v,nestingPrefix:m,nestingPrefixEscaped:g,nestingSuffix:b,nestingSuffixEscaped:w,nestingOptionsSeparator:_,maxReplaces:S,alwaysFormat:E}=t.interpolation;this.escape=e!==void 0?e:FN,this.escapeValue=n!==void 0?n:!0,this.useRawValueToEscape=a!==void 0?a:!1,this.prefix=i?Ws(i):s||"{{",this.suffix=l?Ws(l):c||"}}",this.formatSeparator=f||",",this.unescapePrefix=d?"":v||"-",this.unescapeSuffix=this.unescapePrefix?"":d||"",this.nestingPrefix=m?Ws(m):g||Ws("$t("),this.nestingSuffix=b?Ws(b):w||Ws(")"),this.nestingOptionsSeparator=_||",",this.maxReplaces=S||1e3,this.alwaysFormat=E!==void 0?E:!1,this.resetRegExp()}reset(){this.options&&this.init(this.options)}resetRegExp(){const t=(e,n)=>(e==null?void 0:e.source)===n?(e.lastIndex=0,e):new RegExp(n,"g");this.regexp=t(this.regexp,`${this.prefix}(.+?)${this.suffix}`),this.regexpUnescape=t(this.regexpUnescape,`${this.prefix}${this.unescapePrefix}(.+?)${this.unescapeSuffix}${this.suffix}`),this.nestingRegexp=t(this.nestingRegexp,`${this.nestingPrefix}(.+?)${this.nestingSuffix}`)}interpolate(t,e,n,a){var g;let i,s,l;const c=this.options&&this.options.interpolation&&this.options.interpolation.defaultVariables||{},f=b=>{if(b.indexOf(this.formatSeparator)<0){const E=p2(e,c,b,this.options.keySeparator,this.options.ignoreJSONStructure);return this.alwaysFormat?this.format(E,void 0,n,{...a,...e,interpolationkey:b}):E}const w=b.split(this.formatSeparator),_=w.shift().trim(),S=w.join(this.formatSeparator).trim();return this.format(p2(e,c,_,this.options.keySeparator,this.options.ignoreJSONStructure),S,n,{...a,...e,interpolationkey:_})};this.resetRegExp();const d=(a==null?void 0:a.missingInterpolationHandler)||this.options.missingInterpolationHandler,v=((g=a==null?void 0:a.interpolation)==null?void 0:g.skipOnVariables)!==void 0?a.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables;return[{regex:this.regexpUnescape,safeValue:b=>gm(b)},{regex:this.regexp,safeValue:b=>this.escapeValue?gm(this.escape(b)):gm(b)}].forEach(b=>{for(l=0;i=b.regex.exec(t);){const w=i[1].trim();if(s=f(w),s===void 0)if(typeof d=="function"){const S=d(t,i,a);s=Ve(S)?S:""}else if(a&&Object.prototype.hasOwnProperty.call(a,w))s="";else if(v){s=i[0];continue}else this.logger.warn(`missed to pass in variable ${w} for interpolating ${t}`),s="";else!Ve(s)&&!this.useRawValueToEscape&&(s=a2(s));const _=b.safeValue(s);if(t=t.replace(i[0],_),v?(b.regex.lastIndex+=s.length,b.regex.lastIndex-=i[0].length):b.regex.lastIndex=0,l++,l>=this.maxReplaces)break}}),t}nest(t,e,n={}){let a,i,s;const l=(c,f)=>{const d=this.nestingOptionsSeparator;if(c.indexOf(d)<0)return c;const v=c.split(new RegExp(`${d}[ ]*{`));let m=`{${v[1]}`;c=v[0],m=this.interpolate(m,s);const g=m.match(/'/g),b=m.match(/"/g);(((g==null?void 0:g.length)??0)%2===0&&!b||b.length%2!==0)&&(m=m.replace(/'/g,'"'));try{s=JSON.parse(m),f&&(s={...f,...s})}catch(w){return this.logger.warn(`failed parsing options string in nesting for key ${c}`,w),`${c}${d}${m}`}return s.defaultValue&&s.defaultValue.indexOf(this.prefix)>-1&&delete s.defaultValue,c};for(;a=this.nestingRegexp.exec(t);){let c=[];s={...n},s=s.replace&&!Ve(s.replace)?s.replace:s,s.applyPostProcessor=!1,delete s.defaultValue;let f=!1;if(a[0].indexOf(this.formatSeparator)!==-1&&!/{.*}/.test(a[1])){const d=a[1].split(this.formatSeparator).map(v=>v.trim());a[1]=d.shift(),c=d,f=!0}if(i=e(l.call(this,a[1].trim(),s),s),i&&a[0]===t&&!Ve(i))return i;Ve(i)||(i=a2(i)),i||(this.logger.warn(`missed to resolve ${a[1]} for nesting ${t}`),i=""),f&&(i=c.reduce((d,v)=>this.format(d,v,n.lng,{...n,interpolationkey:a[1].trim()}),i.trim())),t=t.replace(a[0],i),this.regexp.lastIndex=0}return t}}const jN=r=>{let t=r.toLowerCase().trim();const e={};if(r.indexOf("(")>-1){const n=r.split("(");t=n[0].toLowerCase().trim();const a=n[1].substring(0,n[1].length-1);t==="currency"&&a.indexOf(":")<0?e.currency||(e.currency=a.trim()):t==="relativetime"&&a.indexOf(":")<0?e.range||(e.range=a.trim()):a.split(";").forEach(s=>{if(s){const[l,...c]=s.split(":"),f=c.join(":").trim().replace(/^'+|'+$/g,""),d=l.trim();e[d]||(e[d]=f),f==="false"&&(e[d]=!1),f==="true"&&(e[d]=!0),isNaN(f)||(e[d]=parseInt(f,10))}})}return{formatName:t,formatOptions:e}},v2=r=>{const t={};return(e,n,a)=>{let i=a;a&&a.interpolationkey&&a.formatParams&&a.formatParams[a.interpolationkey]&&a[a.interpolationkey]&&(i={...i,[a.interpolationkey]:void 0});const s=n+JSON.stringify(i);let l=t[s];return l||(l=r(oc(n),a),t[s]=l),l(e)}},WN=r=>(t,e,n)=>r(oc(e),n)(t);class GN{constructor(t={}){this.logger=ha.create("formatter"),this.options=t,this.init(t)}init(t,e={interpolation:{}}){this.formatSeparator=e.interpolation.formatSeparator||",";const n=e.cacheInBuiltFormats?v2:WN;this.formats={number:n((a,i)=>{const s=new Intl.NumberFormat(a,{...i});return l=>s.format(l)}),currency:n((a,i)=>{const s=new Intl.NumberFormat(a,{...i,style:"currency"});return l=>s.format(l)}),datetime:n((a,i)=>{const s=new Intl.DateTimeFormat(a,{...i});return l=>s.format(l)}),relativetime:n((a,i)=>{const s=new Intl.RelativeTimeFormat(a,{...i});return l=>s.format(l,i.range||"day")}),list:n((a,i)=>{const s=new Intl.ListFormat(a,{...i});return l=>s.format(l)})}}add(t,e){this.formats[t.toLowerCase().trim()]=e}addCached(t,e){this.formats[t.toLowerCase().trim()]=v2(e)}format(t,e,n,a={}){const i=e.split(this.formatSeparator);if(i.length>1&&i[0].indexOf("(")>1&&i[0].indexOf(")")<0&&i.find(l=>l.indexOf(")")>-1)){const l=i.findIndex(c=>c.indexOf(")")>-1);i[0]=[i[0],...i.splice(1,l)].join(this.formatSeparator)}return i.reduce((l,c)=>{var v;const{formatName:f,formatOptions:d}=jN(c);if(this.formats[f]){let m=l;try{const g=((v=a==null?void 0:a.formatParams)==null?void 0:v[a.interpolationkey])||{},b=g.locale||g.lng||a.locale||a.lng||n;m=this.formats[f](l,b,{...d,...a,...g})}catch(g){this.logger.warn(g)}return m}else this.logger.warn(`there was no format function for ${f}`);return l},t)}}const qN=(r,t)=>{r.pending[t]!==void 0&&(delete r.pending[t],r.pendingCount--)};class KN extends xd{constructor(t,e,n,a={}){var i,s;super(),this.backend=t,this.store=e,this.services=n,this.languageUtils=n.languageUtils,this.options=a,this.logger=ha.create("backendConnector"),this.waitingReads=[],this.maxParallelReads=a.maxParallelReads||10,this.readingCalls=0,this.maxRetries=a.maxRetries>=0?a.maxRetries:5,this.retryTimeout=a.retryTimeout>=1?a.retryTimeout:350,this.state={},this.queue=[],(s=(i=this.backend)==null?void 0:i.init)==null||s.call(i,n,a.backend,a)}queueLoad(t,e,n,a){const i={},s={},l={},c={};return t.forEach(f=>{let d=!0;e.forEach(v=>{const m=`${f}|${v}`;!n.reload&&this.store.hasResourceBundle(f,v)?this.state[m]=2:this.state[m]<0||(this.state[m]===1?s[m]===void 0&&(s[m]=!0):(this.state[m]=1,d=!1,s[m]===void 0&&(s[m]=!0),i[m]===void 0&&(i[m]=!0),c[v]===void 0&&(c[v]=!0)))}),d||(l[f]=!0)}),(Object.keys(i).length||Object.keys(s).length)&&this.queue.push({pending:s,pendingCount:Object.keys(s).length,loaded:{},errors:[],callback:a}),{toLoad:Object.keys(i),pending:Object.keys(s),toLoadLanguages:Object.keys(l),toLoadNamespaces:Object.keys(c)}}loaded(t,e,n){const a=t.split("|"),i=a[0],s=a[1];e&&this.emit("failedLoading",i,s,e),!e&&n&&this.store.addResourceBundle(i,s,n,void 0,void 0,{skipCopy:!0}),this.state[t]=e?-1:2,e&&n&&(this.state[t]=0);const l={};this.queue.forEach(c=>{NN(c.loaded,[i],s),qN(c,t),e&&c.errors.push(e),c.pendingCount===0&&!c.done&&(Object.keys(c.loaded).forEach(f=>{l[f]||(l[f]={});const d=c.loaded[f];d.length&&d.forEach(v=>{l[f][v]===void 0&&(l[f][v]=!0)})}),c.done=!0,c.errors.length?c.callback(c.errors):c.callback())}),this.emit("loaded",l),this.queue=this.queue.filter(c=>!c.done)}read(t,e,n,a=0,i=this.retryTimeout,s){if(!t.length)return s(null,{});if(this.readingCalls>=this.maxParallelReads){this.waitingReads.push({lng:t,ns:e,fcName:n,tried:a,wait:i,callback:s});return}this.readingCalls++;const l=(f,d)=>{if(this.readingCalls--,this.waitingReads.length>0){const v=this.waitingReads.shift();this.read(v.lng,v.ns,v.fcName,v.tried,v.wait,v.callback)}if(f&&d&&a<this.maxRetries){setTimeout(()=>{this.read.call(this,t,e,n,a+1,i*2,s)},i);return}s(f,d)},c=this.backend[n].bind(this.backend);if(c.length===2){try{const f=c(t,e);f&&typeof f.then=="function"?f.then(d=>l(null,d)).catch(l):l(null,f)}catch(f){l(f)}return}return c(t,e,l)}prepareLoading(t,e,n={},a){if(!this.backend)return this.logger.warn("No backend was added via i18next.use. Will not load resources."),a&&a();Ve(t)&&(t=this.languageUtils.toResolveHierarchy(t)),Ve(e)&&(e=[e]);const i=this.queueLoad(t,e,n,a);if(!i.toLoad.length)return i.pending.length||a(),null;i.toLoad.forEach(s=>{this.loadOne(s)})}load(t,e,n){this.prepareLoading(t,e,{},n)}reload(t,e,n){this.prepareLoading(t,e,{reload:!0},n)}loadOne(t,e=""){const n=t.split("|"),a=n[0],i=n[1];this.read(a,i,"read",void 0,void 0,(s,l)=>{s&&this.logger.warn(`${e}loading namespace ${i} for language ${a} failed`,s),!s&&l&&this.logger.log(`${e}loaded namespace ${i} for language ${a}`,l),this.loaded(t,s,l)})}saveMissing(t,e,n,a,i,s={},l=()=>{}){var c,f,d,v,m;if((f=(c=this.services)==null?void 0:c.utils)!=null&&f.hasLoadedNamespace&&!((v=(d=this.services)==null?void 0:d.utils)!=null&&v.hasLoadedNamespace(e))){this.logger.warn(`did not save key "${n}" as the namespace "${e}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!");return}if(!(n==null||n==="")){if((m=this.backend)!=null&&m.create){const g={...s,isUpdate:i},b=this.backend.create.bind(this.backend);if(b.length<6)try{let w;b.length===5?w=b(t,e,n,a,g):w=b(t,e,n,a),w&&typeof w.then=="function"?w.then(_=>l(null,_)).catch(l):l(null,w)}catch(w){l(w)}else b(t,e,n,a,l,g)}!t||!t[0]||this.store.addResource(t[0],e,n,a)}}}const m2=()=>({debug:!1,initAsync:!0,ns:["translation"],defaultNS:["translation"],fallbackLng:["dev"],fallbackNS:!1,supportedLngs:!1,nonExplicitSupportedLngs:!1,load:"all",preload:!1,simplifyPluralSuffix:!0,keySeparator:".",nsSeparator:":",pluralSeparator:"_",contextSeparator:"_",partialBundledLanguages:!1,saveMissing:!1,updateMissing:!1,saveMissingTo:"fallback",saveMissingPlurals:!0,missingKeyHandler:!1,missingInterpolationHandler:!1,postProcess:!1,postProcessPassResolved:!1,returnNull:!1,returnEmptyString:!0,returnObjects:!1,joinArrays:!1,returnedObjectHandler:!1,parseMissingKeyHandler:!1,appendNamespaceToMissingKey:!1,appendNamespaceToCIMode:!1,overloadTranslationOptionHandler:r=>{let t={};if(typeof r[1]=="object"&&(t=r[1]),Ve(r[1])&&(t.defaultValue=r[1]),Ve(r[2])&&(t.tDescription=r[2]),typeof r[2]=="object"||typeof r[3]=="object"){const e=r[3]||r[2];Object.keys(e).forEach(n=>{t[n]=e[n]})}return t},interpolation:{escapeValue:!0,format:r=>r,prefix:"{{",suffix:"}}",formatSeparator:",",unescapePrefix:"-",nestingPrefix:"$t(",nestingSuffix:")",nestingOptionsSeparator:",",maxReplaces:1e3,skipOnVariables:!0},cacheInBuiltFormats:!0}),g2=r=>{var t,e;return Ve(r.ns)&&(r.ns=[r.ns]),Ve(r.fallbackLng)&&(r.fallbackLng=[r.fallbackLng]),Ve(r.fallbackNS)&&(r.fallbackNS=[r.fallbackNS]),((e=(t=r.supportedLngs)==null?void 0:t.indexOf)==null?void 0:e.call(t,"cimode"))<0&&(r.supportedLngs=r.supportedLngs.concat(["cimode"])),typeof r.initImmediate=="boolean"&&(r.initAsync=r.initImmediate),r},rh=()=>{},XN=r=>{Object.getOwnPropertyNames(Object.getPrototypeOf(r)).forEach(e=>{typeof r[e]=="function"&&(r[e]=r[e].bind(r))})};class sc extends xd{constructor(t={},e){if(super(),this.options=g2(t),this.services={},this.logger=ha,this.modules={external:[]},XN(this),e&&!this.isInitialized&&!t.isClone){if(!this.options.initAsync)return this.init(t,e),this;setTimeout(()=>{this.init(t,e)},0)}}init(t={},e){this.isInitializing=!0,typeof t=="function"&&(e=t,t={}),t.defaultNS==null&&t.ns&&(Ve(t.ns)?t.defaultNS=t.ns:t.ns.indexOf("translation")<0&&(t.defaultNS=t.ns[0]));const n=m2();this.options={...n,...this.options,...g2(t)},this.options.interpolation={...n.interpolation,...this.options.interpolation},t.keySeparator!==void 0&&(this.options.userDefinedKeySeparator=t.keySeparator),t.nsSeparator!==void 0&&(this.options.userDefinedNsSeparator=t.nsSeparator);const a=f=>f?typeof f=="function"?new f:f:null;if(!this.options.isClone){this.modules.logger?ha.init(a(this.modules.logger),this.options):ha.init(null,this.options);let f;this.modules.formatter?f=this.modules.formatter:f=GN;const d=new f2(this.options);this.store=new u2(this.options.resources,this.options);const v=this.services;v.logger=ha,v.resourceStore=this.store,v.languageUtils=d,v.pluralResolver=new VN(d,{prepend:this.options.pluralSeparator,simplifyPluralSuffix:this.options.simplifyPluralSuffix}),f&&(!this.options.interpolation.format||this.options.interpolation.format===n.interpolation.format)&&(v.formatter=a(f),v.formatter.init(v,this.options),this.options.interpolation.format=v.formatter.format.bind(v.formatter)),v.interpolator=new HN(this.options),v.utils={hasLoadedNamespace:this.hasLoadedNamespace.bind(this)},v.backendConnector=new KN(a(this.modules.backend),v.resourceStore,v,this.options),v.backendConnector.on("*",(m,...g)=>{this.emit(m,...g)}),this.modules.languageDetector&&(v.languageDetector=a(this.modules.languageDetector),v.languageDetector.init&&v.languageDetector.init(v,this.options.detection,this.options)),this.modules.i18nFormat&&(v.i18nFormat=a(this.modules.i18nFormat),v.i18nFormat.init&&v.i18nFormat.init(this)),this.translator=new Ph(this.services,this.options),this.translator.on("*",(m,...g)=>{this.emit(m,...g)}),this.modules.external.forEach(m=>{m.init&&m.init(this)})}if(this.format=this.options.interpolation.format,e||(e=rh),this.options.fallbackLng&&!this.services.languageDetector&&!this.options.lng){const f=this.services.languageUtils.getFallbackCodes(this.options.fallbackLng);f.length>0&&f[0]!=="dev"&&(this.options.lng=f[0])}!this.services.languageDetector&&!this.options.lng&&this.logger.warn("init: no languageDetector is used and no lng is defined"),["getResource","hasResourceBundle","getResourceBundle","getDataByLanguage"].forEach(f=>{this[f]=(...d)=>this.store[f](...d)}),["addResource","addResources","addResourceBundle","removeResourceBundle"].forEach(f=>{this[f]=(...d)=>(this.store[f](...d),this)});const l=jl(),c=()=>{const f=(d,v)=>{this.isInitializing=!1,this.isInitialized&&!this.initializedStoreOnce&&this.logger.warn("init: i18next is already initialized. You should call init just once!"),this.isInitialized=!0,this.options.isClone||this.logger.log("initialized",this.options),this.emit("initialized",this.options),l.resolve(v),e(d,v)};if(this.languages&&!this.isInitialized)return f(null,this.t.bind(this));this.changeLanguage(this.options.lng,f)};return this.options.resources||!this.options.initAsync?c():setTimeout(c,0),l}loadResources(t,e=rh){var i,s;let n=e;const a=Ve(t)?t:this.language;if(typeof t=="function"&&(n=t),!this.options.resources||this.options.partialBundledLanguages){if((a==null?void 0:a.toLowerCase())==="cimode"&&(!this.options.preload||this.options.preload.length===0))return n();const l=[],c=f=>{if(!f||f==="cimode")return;this.services.languageUtils.toResolveHierarchy(f).forEach(v=>{v!=="cimode"&&l.indexOf(v)<0&&l.push(v)})};a?c(a):this.services.languageUtils.getFallbackCodes(this.options.fallbackLng).forEach(d=>c(d)),(s=(i=this.options.preload)==null?void 0:i.forEach)==null||s.call(i,f=>c(f)),this.services.backendConnector.load(l,this.options.ns,f=>{!f&&!this.resolvedLanguage&&this.language&&this.setResolvedLanguage(this.language),n(f)})}else n(null)}reloadResources(t,e,n){const a=jl();return typeof t=="function"&&(n=t,t=void 0),typeof e=="function"&&(n=e,e=void 0),t||(t=this.languages),e||(e=this.options.ns),n||(n=rh),this.services.backendConnector.reload(t,e,i=>{a.resolve(),n(i)}),a}use(t){if(!t)throw new Error("You are passing an undefined module! Please check the object you are passing to i18next.use()");if(!t.type)throw new Error("You are passing a wrong module! Please check the object you are passing to i18next.use()");return t.type==="backend"&&(this.modules.backend=t),(t.type==="logger"||t.log&&t.warn&&t.error)&&(this.modules.logger=t),t.type==="languageDetector"&&(this.modules.languageDetector=t),t.type==="i18nFormat"&&(this.modules.i18nFormat=t),t.type==="postProcessor"&&iE.addPostProcessor(t),t.type==="formatter"&&(this.modules.formatter=t),t.type==="3rdParty"&&this.modules.external.push(t),this}setResolvedLanguage(t){if(!(!t||!this.languages)&&!(["cimode","dev"].indexOf(t)>-1)){for(let e=0;e<this.languages.length;e++){const n=this.languages[e];if(!(["cimode","dev"].indexOf(n)>-1)&&this.store.hasLanguageSomeTranslations(n)){this.resolvedLanguage=n;break}}!this.resolvedLanguage&&this.languages.indexOf(t)<0&&this.store.hasLanguageSomeTranslations(t)&&(this.resolvedLanguage=t,this.languages.unshift(t))}}changeLanguage(t,e){this.isLanguageChangingTo=t;const n=jl();this.emit("languageChanging",t);const a=l=>{this.language=l,this.languages=this.services.languageUtils.toResolveHierarchy(l),this.resolvedLanguage=void 0,this.setResolvedLanguage(l)},i=(l,c)=>{c?this.isLanguageChangingTo===t&&(a(c),this.translator.changeLanguage(c),this.isLanguageChangingTo=void 0,this.emit("languageChanged",c),this.logger.log("languageChanged",c)):this.isLanguageChangingTo=void 0,n.resolve((...f)=>this.t(...f)),e&&e(l,(...f)=>this.t(...f))},s=l=>{var d,v;!t&&!l&&this.services.languageDetector&&(l=[]);const c=Ve(l)?l:l&&l[0],f=this.store.hasLanguageSomeTranslations(c)?c:this.services.languageUtils.getBestMatchFromCodes(Ve(l)?[l]:l);f&&(this.language||a(f),this.translator.language||this.translator.changeLanguage(f),(v=(d=this.services.languageDetector)==null?void 0:d.cacheUserLanguage)==null||v.call(d,f)),this.loadResources(f,m=>{i(m,f)})};return!t&&this.services.languageDetector&&!this.services.languageDetector.async?s(this.services.languageDetector.detect()):!t&&this.services.languageDetector&&this.services.languageDetector.async?this.services.languageDetector.detect.length===0?this.services.languageDetector.detect().then(s):this.services.languageDetector.detect(s):s(t),n}getFixedT(t,e,n){const a=(i,s,...l)=>{let c;typeof s!="object"?c=this.options.overloadTranslationOptionHandler([i,s].concat(l)):c={...s},c.lng=c.lng||a.lng,c.lngs=c.lngs||a.lngs,c.ns=c.ns||a.ns,c.keyPrefix!==""&&(c.keyPrefix=c.keyPrefix||n||a.keyPrefix);const f=this.options.keySeparator||".";let d;return c.keyPrefix&&Array.isArray(i)?d=i.map(v=>`${c.keyPrefix}${f}${v}`):d=c.keyPrefix?`${c.keyPrefix}${f}${i}`:i,this.t(d,c)};return Ve(t)?a.lng=t:a.lngs=t,a.ns=e,a.keyPrefix=n,a}t(...t){var e;return(e=this.translator)==null?void 0:e.translate(...t)}exists(...t){var e;return(e=this.translator)==null?void 0:e.exists(...t)}setDefaultNamespace(t){this.options.defaultNS=t}hasLoadedNamespace(t,e={}){if(!this.isInitialized)return this.logger.warn("hasLoadedNamespace: i18next was not initialized",this.languages),!1;if(!this.languages||!this.languages.length)return this.logger.warn("hasLoadedNamespace: i18n.languages were undefined or empty",this.languages),!1;const n=e.lng||this.resolvedLanguage||this.languages[0],a=this.options?this.options.fallbackLng:!1,i=this.languages[this.languages.length-1];if(n.toLowerCase()==="cimode")return!0;const s=(l,c)=>{const f=this.services.backendConnector.state[`${l}|${c}`];return f===-1||f===0||f===2};if(e.precheck){const l=e.precheck(this,s);if(l!==void 0)return l}return!!(this.hasResourceBundle(n,t)||!this.services.backendConnector.backend||this.options.resources&&!this.options.partialBundledLanguages||s(n,t)&&(!a||s(i,t)))}loadNamespaces(t,e){const n=jl();return this.options.ns?(Ve(t)&&(t=[t]),t.forEach(a=>{this.options.ns.indexOf(a)<0&&this.options.ns.push(a)}),this.loadResources(a=>{n.resolve(),e&&e(a)}),n):(e&&e(),Promise.resolve())}loadLanguages(t,e){const n=jl();Ve(t)&&(t=[t]);const a=this.options.preload||[],i=t.filter(s=>a.indexOf(s)<0&&this.services.languageUtils.isSupportedCode(s));return i.length?(this.options.preload=a.concat(i),this.loadResources(s=>{n.resolve(),e&&e(s)}),n):(e&&e(),Promise.resolve())}dir(t){var a,i;if(t||(t=this.resolvedLanguage||(((a=this.languages)==null?void 0:a.length)>0?this.languages[0]:this.language)),!t)return"rtl";const e=["ar","shu","sqr","ssh","xaa","yhd","yud","aao","abh","abv","acm","acq","acw","acx","acy","adf","ads","aeb","aec","afb","ajp","apc","apd","arb","arq","ars","ary","arz","auz","avl","ayh","ayl","ayn","ayp","bbz","pga","he","iw","ps","pbt","pbu","pst","prp","prd","ug","ur","ydd","yds","yih","ji","yi","hbo","men","xmn","fa","jpr","peo","pes","prs","dv","sam","ckb"],n=((i=this.services)==null?void 0:i.languageUtils)||new f2(m2());return e.indexOf(n.getLanguagePartFromCode(t))>-1||t.toLowerCase().indexOf("-arab")>1?"rtl":"ltr"}static createInstance(t={},e){return new sc(t,e)}cloneInstance(t={},e=rh){const n=t.forkResourceStore;n&&delete t.forkResourceStore;const a={...this.options,...t,isClone:!0},i=new sc(a);if((t.debug!==void 0||t.prefix!==void 0)&&(i.logger=i.logger.clone(t)),["store","services","language"].forEach(l=>{i[l]=this[l]}),i.services={...this.services},i.services.utils={hasLoadedNamespace:i.hasLoadedNamespace.bind(i)},n){const l=Object.keys(this.store.data).reduce((c,f)=>(c[f]={...this.store.data[f]},c[f]=Object.keys(c[f]).reduce((d,v)=>(d[v]={...c[f][v]},d),c[f]),c),{});i.store=new u2(l,a),i.services.resourceStore=i.store}return i.translator=new Ph(i.services,a),i.translator.on("*",(l,...c)=>{i.emit(l,...c)}),i.init(a,e),i.translator.options=a,i.translator.backendConnector.services.utils={hasLoadedNamespace:i.hasLoadedNamespace.bind(i)},i}toJSON(){return{options:this.options,store:this.store,language:this.language,languages:this.languages,resolvedLanguage:this.resolvedLanguage}}}const zn=sc.createInstance();zn.createInstance=sc.createInstance;zn.createInstance;zn.dir;zn.init;zn.loadResources;zn.reloadResources;zn.use;zn.changeLanguage;zn.getFixedT;zn.t;zn.exists;zn.setDefaultNamespace;zn.hasLoadedNamespace;zn.loadNamespaces;zn.loadLanguages;const y2=r=>{let t;const e=new Set,n=(f,d)=>{const v=typeof f=="function"?f(t):f;if(!Object.is(v,t)){const m=t;t=d??(typeof v!="object"||v===null)?v:Object.assign({},t,v),e.forEach(g=>g(t,m))}},a=()=>t,l={setState:n,getState:a,getInitialState:()=>c,subscribe:f=>(e.add(f),()=>e.delete(f))},c=t=r(n,a,l);return l},$N=r=>r?y2(r):y2,YN=r=>r;function QN(r,t=YN){const e=Yn.useSyncExternalStore(r.subscribe,()=>t(r.getState()),()=>t(r.getInitialState()));return Yn.useDebugValue(e),e}const ZN=r=>{const t=$N(r),e=n=>QN(t,n);return Object.assign(e,t),e},gU=r=>ZN;function JN(r,t){let e;try{e=r()}catch{return}return{getItem:a=>{var i;const s=c=>c===null?null:JSON.parse(c,void 0),l=(i=e.getItem(a))!=null?i:null;return l instanceof Promise?l.then(s):s(l)},setItem:(a,i)=>e.setItem(a,JSON.stringify(i,void 0)),removeItem:a=>e.removeItem(a)}}const wg=r=>t=>{try{const e=r(t);return e instanceof Promise?e:{then(n){return wg(n)(e)},catch(n){return this}}}catch(e){return{then(n){return this},catch(n){return wg(n)(e)}}}},e3=(r,t)=>(e,n,a)=>{let i={storage:JN(()=>localStorage),partialize:w=>w,version:0,merge:(w,_)=>({..._,...w}),...t},s=!1;const l=new Set,c=new Set;let f=i.storage;if(!f)return r((...w)=>{console.warn(`[zustand persist middleware] Unable to update item '${i.name}', the given storage is currently unavailable.`),e(...w)},n,a);const d=()=>{const w=i.partialize({...n()});return f.setItem(i.name,{state:w,version:i.version})},v=a.setState;a.setState=(w,_)=>{v(w,_),d()};const m=r((...w)=>{e(...w),d()},n,a);a.getInitialState=()=>m;let g;const b=()=>{var w,_;if(!f)return;s=!1,l.forEach(E=>{var C;return E((C=n())!=null?C:m)});const S=((_=i.onRehydrateStorage)==null?void 0:_.call(i,(w=n())!=null?w:m))||void 0;return wg(f.getItem.bind(f))(i.name).then(E=>{if(E)if(typeof E.version=="number"&&E.version!==i.version){if(i.migrate){const C=i.migrate(E.state,E.version);return C instanceof Promise?C.then(R=>[!0,R]):[!0,C]}console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,E.state];return[!1,void 0]}).then(E=>{var C;const[R,A]=E;if(g=i.merge(A,(C=n())!=null?C:m),e(g,!0),R)return d()}).then(()=>{S==null||S(g,void 0),g=n(),s=!0,c.forEach(E=>E(g))}).catch(E=>{S==null||S(void 0,E)})};return a.persist={setOptions:w=>{i={...i,...w},w.storage&&(f=w.storage)},clearStorage:()=>{f==null||f.removeItem(i.name)},getOptions:()=>i,rehydrate:()=>b(),hasHydrated:()=>s,onHydrate:w=>(l.add(w),()=>{l.delete(w)}),onFinishHydration:w=>(c.add(w),()=>{c.delete(w)})},i.skipHydration||b(),g||m},yU=e3;var ft;(function(r){r.assertEqual=a=>{};function t(a){}r.assertIs=t;function e(a){throw new Error}r.assertNever=e,r.arrayToEnum=a=>{const i={};for(const s of a)i[s]=s;return i},r.getValidEnumValues=a=>{const i=r.objectKeys(a).filter(l=>typeof a[a[l]]!="number"),s={};for(const l of i)s[l]=a[l];return r.objectValues(s)},r.objectValues=a=>r.objectKeys(a).map(function(i){return a[i]}),r.objectKeys=typeof Object.keys=="function"?a=>Object.keys(a):a=>{const i=[];for(const s in a)Object.prototype.hasOwnProperty.call(a,s)&&i.push(s);return i},r.find=(a,i)=>{for(const s of a)if(i(s))return s},r.isInteger=typeof Number.isInteger=="function"?a=>Number.isInteger(a):a=>typeof a=="number"&&Number.isFinite(a)&&Math.floor(a)===a;function n(a,i=" | "){return a.map(s=>typeof s=="string"?`'${s}'`:s).join(i)}r.joinValues=n,r.jsonStringifyReplacer=(a,i)=>typeof i=="bigint"?i.toString():i})(ft||(ft={}));var b2;(function(r){r.mergeShapes=(t,e)=>({...t,...e})})(b2||(b2={}));const Re=ft.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),Bi=r=>{switch(typeof r){case"undefined":return Re.undefined;case"string":return Re.string;case"number":return Number.isNaN(r)?Re.nan:Re.number;case"boolean":return Re.boolean;case"function":return Re.function;case"bigint":return Re.bigint;case"symbol":return Re.symbol;case"object":return Array.isArray(r)?Re.array:r===null?Re.null:r.then&&typeof r.then=="function"&&r.catch&&typeof r.catch=="function"?Re.promise:typeof Map<"u"&&r instanceof Map?Re.map:typeof Set<"u"&&r instanceof Set?Re.set:typeof Date<"u"&&r instanceof Date?Re.date:Re.object;default:return Re.unknown}},me=ft.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]);class Qa extends Error{get errors(){return this.issues}constructor(t){super(),this.issues=[],this.addIssue=n=>{this.issues=[...this.issues,n]},this.addIssues=(n=[])=>{this.issues=[...this.issues,...n]};const e=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,e):this.__proto__=e,this.name="ZodError",this.issues=t}format(t){const e=t||function(i){return i.message},n={_errors:[]},a=i=>{for(const s of i.issues)if(s.code==="invalid_union")s.unionErrors.map(a);else if(s.code==="invalid_return_type")a(s.returnTypeError);else if(s.code==="invalid_arguments")a(s.argumentsError);else if(s.path.length===0)n._errors.push(e(s));else{let l=n,c=0;for(;c<s.path.length;){const f=s.path[c];c===s.path.length-1?(l[f]=l[f]||{_errors:[]},l[f]._errors.push(e(s))):l[f]=l[f]||{_errors:[]},l=l[f],c++}}};return a(this),n}static assert(t){if(!(t instanceof Qa))throw new Error(`Not a ZodError: ${t}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,ft.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(t=e=>e.message){const e={},n=[];for(const a of this.issues)a.path.length>0?(e[a.path[0]]=e[a.path[0]]||[],e[a.path[0]].push(t(a))):n.push(t(a));return{formErrors:n,fieldErrors:e}}get formErrors(){return this.flatten()}}Qa.create=r=>new Qa(r);const _g=(r,t)=>{let e;switch(r.code){case me.invalid_type:r.received===Re.undefined?e="Required":e=`Expected ${r.expected}, received ${r.received}`;break;case me.invalid_literal:e=`Invalid literal value, expected ${JSON.stringify(r.expected,ft.jsonStringifyReplacer)}`;break;case me.unrecognized_keys:e=`Unrecognized key(s) in object: ${ft.joinValues(r.keys,", ")}`;break;case me.invalid_union:e="Invalid input";break;case me.invalid_union_discriminator:e=`Invalid discriminator value. Expected ${ft.joinValues(r.options)}`;break;case me.invalid_enum_value:e=`Invalid enum value. Expected ${ft.joinValues(r.options)}, received '${r.received}'`;break;case me.invalid_arguments:e="Invalid function arguments";break;case me.invalid_return_type:e="Invalid function return type";break;case me.invalid_date:e="Invalid date";break;case me.invalid_string:typeof r.validation=="object"?"includes"in r.validation?(e=`Invalid input: must include "${r.validation.includes}"`,typeof r.validation.position=="number"&&(e=`${e} at one or more positions greater than or equal to ${r.validation.position}`)):"startsWith"in r.validation?e=`Invalid input: must start with "${r.validation.startsWith}"`:"endsWith"in r.validation?e=`Invalid input: must end with "${r.validation.endsWith}"`:ft.assertNever(r.validation):r.validation!=="regex"?e=`Invalid ${r.validation}`:e="Invalid";break;case me.too_small:r.type==="array"?e=`Array must contain ${r.exact?"exactly":r.inclusive?"at least":"more than"} ${r.minimum} element(s)`:r.type==="string"?e=`String must contain ${r.exact?"exactly":r.inclusive?"at least":"over"} ${r.minimum} character(s)`:r.type==="number"?e=`Number must be ${r.exact?"exactly equal to ":r.inclusive?"greater than or equal to ":"greater than "}${r.minimum}`:r.type==="date"?e=`Date must be ${r.exact?"exactly equal to ":r.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(r.minimum))}`:e="Invalid input";break;case me.too_big:r.type==="array"?e=`Array must contain ${r.exact?"exactly":r.inclusive?"at most":"less than"} ${r.maximum} element(s)`:r.type==="string"?e=`String must contain ${r.exact?"exactly":r.inclusive?"at most":"under"} ${r.maximum} character(s)`:r.type==="number"?e=`Number must be ${r.exact?"exactly":r.inclusive?"less than or equal to":"less than"} ${r.maximum}`:r.type==="bigint"?e=`BigInt must be ${r.exact?"exactly":r.inclusive?"less than or equal to":"less than"} ${r.maximum}`:r.type==="date"?e=`Date must be ${r.exact?"exactly":r.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(r.maximum))}`:e="Invalid input";break;case me.custom:e="Invalid input";break;case me.invalid_intersection_types:e="Intersection results could not be merged";break;case me.not_multiple_of:e=`Number must be a multiple of ${r.multipleOf}`;break;case me.not_finite:e="Number must be finite";break;default:e=t.defaultError,ft.assertNever(r)}return{message:e}};let t3=_g;function n3(){return t3}const r3=r=>{const{data:t,path:e,errorMaps:n,issueData:a}=r,i=[...e,...a.path||[]],s={...a,path:i};if(a.message!==void 0)return{...a,path:i,message:a.message};let l="";const c=n.filter(f=>!!f).slice().reverse();for(const f of c)l=f(s,{data:t,defaultError:l}).message;return{...a,path:i,message:l}};function xe(r,t){const e=n3(),n=r3({issueData:t,data:r.data,path:r.path,errorMaps:[r.common.contextualErrorMap,r.schemaErrorMap,e,e===_g?void 0:_g].filter(a=>!!a)});r.common.issues.push(n)}class pr{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(t,e){const n=[];for(const a of e){if(a.status==="aborted")return We;a.status==="dirty"&&t.dirty(),n.push(a.value)}return{status:t.value,value:n}}static async mergeObjectAsync(t,e){const n=[];for(const a of e){const i=await a.key,s=await a.value;n.push({key:i,value:s})}return pr.mergeObjectSync(t,n)}static mergeObjectSync(t,e){const n={};for(const a of e){const{key:i,value:s}=a;if(i.status==="aborted"||s.status==="aborted")return We;i.status==="dirty"&&t.dirty(),s.status==="dirty"&&t.dirty(),i.value!=="__proto__"&&(typeof s.value<"u"||a.alwaysSet)&&(n[i.value]=s.value)}return{status:t.value,value:n}}}const We=Object.freeze({status:"aborted"}),Ql=r=>({status:"dirty",value:r}),Mr=r=>({status:"valid",value:r}),x2=r=>r.status==="aborted",w2=r=>r.status==="dirty",Du=r=>r.status==="valid",zh=r=>typeof Promise<"u"&&r instanceof Promise;var Te;(function(r){r.errToObj=t=>typeof t=="string"?{message:t}:t||{},r.toString=t=>typeof t=="string"?t:t==null?void 0:t.message})(Te||(Te={}));class ao{constructor(t,e,n,a){this._cachedPath=[],this.parent=t,this.data=e,this._path=n,this._key=a}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const _2=(r,t)=>{if(Du(t))return{success:!0,data:t.value};if(!r.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const e=new Qa(r.common.issues);return this._error=e,this._error}}};function tt(r){if(!r)return{};const{errorMap:t,invalid_type_error:e,required_error:n,description:a}=r;if(t&&(e||n))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return t?{errorMap:t,description:a}:{errorMap:(s,l)=>{const{message:c}=r;return s.code==="invalid_enum_value"?{message:c??l.defaultError}:typeof l.data>"u"?{message:c??n??l.defaultError}:s.code!=="invalid_type"?{message:l.defaultError}:{message:c??e??l.defaultError}},description:a}}class ut{get description(){return this._def.description}_getType(t){return Bi(t.data)}_getOrReturnCtx(t,e){return e||{common:t.parent.common,data:t.data,parsedType:Bi(t.data),schemaErrorMap:this._def.errorMap,path:t.path,parent:t.parent}}_processInputParams(t){return{status:new pr,ctx:{common:t.parent.common,data:t.data,parsedType:Bi(t.data),schemaErrorMap:this._def.errorMap,path:t.path,parent:t.parent}}}_parseSync(t){const e=this._parse(t);if(zh(e))throw new Error("Synchronous parse encountered promise.");return e}_parseAsync(t){const e=this._parse(t);return Promise.resolve(e)}parse(t,e){const n=this.safeParse(t,e);if(n.success)return n.data;throw n.error}safeParse(t,e){const n={common:{issues:[],async:(e==null?void 0:e.async)??!1,contextualErrorMap:e==null?void 0:e.errorMap},path:(e==null?void 0:e.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:Bi(t)},a=this._parseSync({data:t,path:n.path,parent:n});return _2(n,a)}"~validate"(t){var n,a;const e={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:Bi(t)};if(!this["~standard"].async)try{const i=this._parseSync({data:t,path:[],parent:e});return Du(i)?{value:i.value}:{issues:e.common.issues}}catch(i){(a=(n=i==null?void 0:i.message)==null?void 0:n.toLowerCase())!=null&&a.includes("encountered")&&(this["~standard"].async=!0),e.common={issues:[],async:!0}}return this._parseAsync({data:t,path:[],parent:e}).then(i=>Du(i)?{value:i.value}:{issues:e.common.issues})}async parseAsync(t,e){const n=await this.safeParseAsync(t,e);if(n.success)return n.data;throw n.error}async safeParseAsync(t,e){const n={common:{issues:[],contextualErrorMap:e==null?void 0:e.errorMap,async:!0},path:(e==null?void 0:e.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:Bi(t)},a=this._parse({data:t,path:n.path,parent:n}),i=await(zh(a)?a:Promise.resolve(a));return _2(n,i)}refine(t,e){const n=a=>typeof e=="string"||typeof e>"u"?{message:e}:typeof e=="function"?e(a):e;return this._refinement((a,i)=>{const s=t(a),l=()=>i.addIssue({code:me.custom,...n(a)});return typeof Promise<"u"&&s instanceof Promise?s.then(c=>c?!0:(l(),!1)):s?!0:(l(),!1)})}refinement(t,e){return this._refinement((n,a)=>t(n)?!0:(a.addIssue(typeof e=="function"?e(n,a):e),!1))}_refinement(t){return new Ou({schema:this,typeName:Ge.ZodEffects,effect:{type:"refinement",refinement:t}})}superRefine(t){return this._refinement(t)}constructor(t){this.spa=this.safeParseAsync,this._def=t,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:e=>this["~validate"](e)}}optional(){return Ji.create(this,this._def)}nullable(){return Nu.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return pa.create(this)}promise(){return jh.create(this,this._def)}or(t){return Vh.create([this,t],this._def)}and(t){return Hh.create(this,t,this._def)}transform(t){return new Ou({...tt(this._def),schema:this,typeName:Ge.ZodEffects,effect:{type:"transform",transform:t}})}default(t){const e=typeof t=="function"?t:()=>t;return new Eg({...tt(this._def),innerType:this,defaultValue:e,typeName:Ge.ZodDefault})}brand(){return new R3({typeName:Ge.ZodBranded,type:this,...tt(this._def)})}catch(t){const e=typeof t=="function"?t:()=>t;return new Cg({...tt(this._def),innerType:this,catchValue:e,typeName:Ge.ZodCatch})}describe(t){const e=this.constructor;return new e({...this._def,description:t})}pipe(t){return dy.create(this,t)}readonly(){return Rg.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const a3=/^c[^\s-]{8,}$/i,i3=/^[0-9a-z]+$/,o3=/^[0-9A-HJKMNP-TV-Z]{26}$/i,s3=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,u3=/^[a-z0-9_-]{21}$/i,l3=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,c3=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,f3=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,h3="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let ym;const d3=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,p3=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,v3=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,m3=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,g3=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,y3=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,oE="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",b3=new RegExp(`^${oE}$`);function sE(r){let t="[0-5]\\d";r.precision?t=`${t}\\.\\d{${r.precision}}`:r.precision==null&&(t=`${t}(\\.\\d+)?`);const e=r.precision?"+":"?";return`([01]\\d|2[0-3]):[0-5]\\d(:${t})${e}`}function x3(r){return new RegExp(`^${sE(r)}$`)}function w3(r){let t=`${oE}T${sE(r)}`;const e=[];return e.push(r.local?"Z?":"Z"),r.offset&&e.push("([+-]\\d{2}:?\\d{2})"),t=`${t}(${e.join("|")})`,new RegExp(`^${t}$`)}function _3(r,t){return!!((t==="v4"||!t)&&d3.test(r)||(t==="v6"||!t)&&v3.test(r))}function S3(r,t){if(!l3.test(r))return!1;try{const[e]=r.split("."),n=e.replace(/-/g,"+").replace(/_/g,"/").padEnd(e.length+(4-e.length%4)%4,"="),a=JSON.parse(atob(n));return!(typeof a!="object"||a===null||"typ"in a&&(a==null?void 0:a.typ)!=="JWT"||!a.alg||t&&a.alg!==t)}catch{return!1}}function E3(r,t){return!!((t==="v4"||!t)&&p3.test(r)||(t==="v6"||!t)&&m3.test(r))}class Xi extends ut{_parse(t){if(this._def.coerce&&(t.data=String(t.data)),this._getType(t)!==Re.string){const i=this._getOrReturnCtx(t);return xe(i,{code:me.invalid_type,expected:Re.string,received:i.parsedType}),We}const n=new pr;let a;for(const i of this._def.checks)if(i.kind==="min")t.data.length<i.value&&(a=this._getOrReturnCtx(t,a),xe(a,{code:me.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),n.dirty());else if(i.kind==="max")t.data.length>i.value&&(a=this._getOrReturnCtx(t,a),xe(a,{code:me.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),n.dirty());else if(i.kind==="length"){const s=t.data.length>i.value,l=t.data.length<i.value;(s||l)&&(a=this._getOrReturnCtx(t,a),s?xe(a,{code:me.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}):l&&xe(a,{code:me.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}),n.dirty())}else if(i.kind==="email")f3.test(t.data)||(a=this._getOrReturnCtx(t,a),xe(a,{validation:"email",code:me.invalid_string,message:i.message}),n.dirty());else if(i.kind==="emoji")ym||(ym=new RegExp(h3,"u")),ym.test(t.data)||(a=this._getOrReturnCtx(t,a),xe(a,{validation:"emoji",code:me.invalid_string,message:i.message}),n.dirty());else if(i.kind==="uuid")s3.test(t.data)||(a=this._getOrReturnCtx(t,a),xe(a,{validation:"uuid",code:me.invalid_string,message:i.message}),n.dirty());else if(i.kind==="nanoid")u3.test(t.data)||(a=this._getOrReturnCtx(t,a),xe(a,{validation:"nanoid",code:me.invalid_string,message:i.message}),n.dirty());else if(i.kind==="cuid")a3.test(t.data)||(a=this._getOrReturnCtx(t,a),xe(a,{validation:"cuid",code:me.invalid_string,message:i.message}),n.dirty());else if(i.kind==="cuid2")i3.test(t.data)||(a=this._getOrReturnCtx(t,a),xe(a,{validation:"cuid2",code:me.invalid_string,message:i.message}),n.dirty());else if(i.kind==="ulid")o3.test(t.data)||(a=this._getOrReturnCtx(t,a),xe(a,{validation:"ulid",code:me.invalid_string,message:i.message}),n.dirty());else if(i.kind==="url")try{new URL(t.data)}catch{a=this._getOrReturnCtx(t,a),xe(a,{validation:"url",code:me.invalid_string,message:i.message}),n.dirty()}else i.kind==="regex"?(i.regex.lastIndex=0,i.regex.test(t.data)||(a=this._getOrReturnCtx(t,a),xe(a,{validation:"regex",code:me.invalid_string,message:i.message}),n.dirty())):i.kind==="trim"?t.data=t.data.trim():i.kind==="includes"?t.data.includes(i.value,i.position)||(a=this._getOrReturnCtx(t,a),xe(a,{code:me.invalid_string,validation:{includes:i.value,position:i.position},message:i.message}),n.dirty()):i.kind==="toLowerCase"?t.data=t.data.toLowerCase():i.kind==="toUpperCase"?t.data=t.data.toUpperCase():i.kind==="startsWith"?t.data.startsWith(i.value)||(a=this._getOrReturnCtx(t,a),xe(a,{code:me.invalid_string,validation:{startsWith:i.value},message:i.message}),n.dirty()):i.kind==="endsWith"?t.data.endsWith(i.value)||(a=this._getOrReturnCtx(t,a),xe(a,{code:me.invalid_string,validation:{endsWith:i.value},message:i.message}),n.dirty()):i.kind==="datetime"?w3(i).test(t.data)||(a=this._getOrReturnCtx(t,a),xe(a,{code:me.invalid_string,validation:"datetime",message:i.message}),n.dirty()):i.kind==="date"?b3.test(t.data)||(a=this._getOrReturnCtx(t,a),xe(a,{code:me.invalid_string,validation:"date",message:i.message}),n.dirty()):i.kind==="time"?x3(i).test(t.data)||(a=this._getOrReturnCtx(t,a),xe(a,{code:me.invalid_string,validation:"time",message:i.message}),n.dirty()):i.kind==="duration"?c3.test(t.data)||(a=this._getOrReturnCtx(t,a),xe(a,{validation:"duration",code:me.invalid_string,message:i.message}),n.dirty()):i.kind==="ip"?_3(t.data,i.version)||(a=this._getOrReturnCtx(t,a),xe(a,{validation:"ip",code:me.invalid_string,message:i.message}),n.dirty()):i.kind==="jwt"?S3(t.data,i.alg)||(a=this._getOrReturnCtx(t,a),xe(a,{validation:"jwt",code:me.invalid_string,message:i.message}),n.dirty()):i.kind==="cidr"?E3(t.data,i.version)||(a=this._getOrReturnCtx(t,a),xe(a,{validation:"cidr",code:me.invalid_string,message:i.message}),n.dirty()):i.kind==="base64"?g3.test(t.data)||(a=this._getOrReturnCtx(t,a),xe(a,{validation:"base64",code:me.invalid_string,message:i.message}),n.dirty()):i.kind==="base64url"?y3.test(t.data)||(a=this._getOrReturnCtx(t,a),xe(a,{validation:"base64url",code:me.invalid_string,message:i.message}),n.dirty()):ft.assertNever(i);return{status:n.value,value:t.data}}_regex(t,e,n){return this.refinement(a=>t.test(a),{validation:e,code:me.invalid_string,...Te.errToObj(n)})}_addCheck(t){return new Xi({...this._def,checks:[...this._def.checks,t]})}email(t){return this._addCheck({kind:"email",...Te.errToObj(t)})}url(t){return this._addCheck({kind:"url",...Te.errToObj(t)})}emoji(t){return this._addCheck({kind:"emoji",...Te.errToObj(t)})}uuid(t){return this._addCheck({kind:"uuid",...Te.errToObj(t)})}nanoid(t){return this._addCheck({kind:"nanoid",...Te.errToObj(t)})}cuid(t){return this._addCheck({kind:"cuid",...Te.errToObj(t)})}cuid2(t){return this._addCheck({kind:"cuid2",...Te.errToObj(t)})}ulid(t){return this._addCheck({kind:"ulid",...Te.errToObj(t)})}base64(t){return this._addCheck({kind:"base64",...Te.errToObj(t)})}base64url(t){return this._addCheck({kind:"base64url",...Te.errToObj(t)})}jwt(t){return this._addCheck({kind:"jwt",...Te.errToObj(t)})}ip(t){return this._addCheck({kind:"ip",...Te.errToObj(t)})}cidr(t){return this._addCheck({kind:"cidr",...Te.errToObj(t)})}datetime(t){return typeof t=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:t}):this._addCheck({kind:"datetime",precision:typeof(t==null?void 0:t.precision)>"u"?null:t==null?void 0:t.precision,offset:(t==null?void 0:t.offset)??!1,local:(t==null?void 0:t.local)??!1,...Te.errToObj(t==null?void 0:t.message)})}date(t){return this._addCheck({kind:"date",message:t})}time(t){return typeof t=="string"?this._addCheck({kind:"time",precision:null,message:t}):this._addCheck({kind:"time",precision:typeof(t==null?void 0:t.precision)>"u"?null:t==null?void 0:t.precision,...Te.errToObj(t==null?void 0:t.message)})}duration(t){return this._addCheck({kind:"duration",...Te.errToObj(t)})}regex(t,e){return this._addCheck({kind:"regex",regex:t,...Te.errToObj(e)})}includes(t,e){return this._addCheck({kind:"includes",value:t,position:e==null?void 0:e.position,...Te.errToObj(e==null?void 0:e.message)})}startsWith(t,e){return this._addCheck({kind:"startsWith",value:t,...Te.errToObj(e)})}endsWith(t,e){return this._addCheck({kind:"endsWith",value:t,...Te.errToObj(e)})}min(t,e){return this._addCheck({kind:"min",value:t,...Te.errToObj(e)})}max(t,e){return this._addCheck({kind:"max",value:t,...Te.errToObj(e)})}length(t,e){return this._addCheck({kind:"length",value:t,...Te.errToObj(e)})}nonempty(t){return this.min(1,Te.errToObj(t))}trim(){return new Xi({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new Xi({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new Xi({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(t=>t.kind==="datetime")}get isDate(){return!!this._def.checks.find(t=>t.kind==="date")}get isTime(){return!!this._def.checks.find(t=>t.kind==="time")}get isDuration(){return!!this._def.checks.find(t=>t.kind==="duration")}get isEmail(){return!!this._def.checks.find(t=>t.kind==="email")}get isURL(){return!!this._def.checks.find(t=>t.kind==="url")}get isEmoji(){return!!this._def.checks.find(t=>t.kind==="emoji")}get isUUID(){return!!this._def.checks.find(t=>t.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(t=>t.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(t=>t.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(t=>t.kind==="cuid2")}get isULID(){return!!this._def.checks.find(t=>t.kind==="ulid")}get isIP(){return!!this._def.checks.find(t=>t.kind==="ip")}get isCIDR(){return!!this._def.checks.find(t=>t.kind==="cidr")}get isBase64(){return!!this._def.checks.find(t=>t.kind==="base64")}get isBase64url(){return!!this._def.checks.find(t=>t.kind==="base64url")}get minLength(){let t=null;for(const e of this._def.checks)e.kind==="min"&&(t===null||e.value>t)&&(t=e.value);return t}get maxLength(){let t=null;for(const e of this._def.checks)e.kind==="max"&&(t===null||e.value<t)&&(t=e.value);return t}}Xi.create=r=>new Xi({checks:[],typeName:Ge.ZodString,coerce:(r==null?void 0:r.coerce)??!1,...tt(r)});function C3(r,t){const e=(r.toString().split(".")[1]||"").length,n=(t.toString().split(".")[1]||"").length,a=e>n?e:n,i=Number.parseInt(r.toFixed(a).replace(".","")),s=Number.parseInt(t.toFixed(a).replace(".",""));return i%s/10**a}class uc extends ut{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(t){if(this._def.coerce&&(t.data=Number(t.data)),this._getType(t)!==Re.number){const i=this._getOrReturnCtx(t);return xe(i,{code:me.invalid_type,expected:Re.number,received:i.parsedType}),We}let n;const a=new pr;for(const i of this._def.checks)i.kind==="int"?ft.isInteger(t.data)||(n=this._getOrReturnCtx(t,n),xe(n,{code:me.invalid_type,expected:"integer",received:"float",message:i.message}),a.dirty()):i.kind==="min"?(i.inclusive?t.data<i.value:t.data<=i.value)&&(n=this._getOrReturnCtx(t,n),xe(n,{code:me.too_small,minimum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),a.dirty()):i.kind==="max"?(i.inclusive?t.data>i.value:t.data>=i.value)&&(n=this._getOrReturnCtx(t,n),xe(n,{code:me.too_big,maximum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),a.dirty()):i.kind==="multipleOf"?C3(t.data,i.value)!==0&&(n=this._getOrReturnCtx(t,n),xe(n,{code:me.not_multiple_of,multipleOf:i.value,message:i.message}),a.dirty()):i.kind==="finite"?Number.isFinite(t.data)||(n=this._getOrReturnCtx(t,n),xe(n,{code:me.not_finite,message:i.message}),a.dirty()):ft.assertNever(i);return{status:a.value,value:t.data}}gte(t,e){return this.setLimit("min",t,!0,Te.toString(e))}gt(t,e){return this.setLimit("min",t,!1,Te.toString(e))}lte(t,e){return this.setLimit("max",t,!0,Te.toString(e))}lt(t,e){return this.setLimit("max",t,!1,Te.toString(e))}setLimit(t,e,n,a){return new uc({...this._def,checks:[...this._def.checks,{kind:t,value:e,inclusive:n,message:Te.toString(a)}]})}_addCheck(t){return new uc({...this._def,checks:[...this._def.checks,t]})}int(t){return this._addCheck({kind:"int",message:Te.toString(t)})}positive(t){return this._addCheck({kind:"min",value:0,inclusive:!1,message:Te.toString(t)})}negative(t){return this._addCheck({kind:"max",value:0,inclusive:!1,message:Te.toString(t)})}nonpositive(t){return this._addCheck({kind:"max",value:0,inclusive:!0,message:Te.toString(t)})}nonnegative(t){return this._addCheck({kind:"min",value:0,inclusive:!0,message:Te.toString(t)})}multipleOf(t,e){return this._addCheck({kind:"multipleOf",value:t,message:Te.toString(e)})}finite(t){return this._addCheck({kind:"finite",message:Te.toString(t)})}safe(t){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:Te.toString(t)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:Te.toString(t)})}get minValue(){let t=null;for(const e of this._def.checks)e.kind==="min"&&(t===null||e.value>t)&&(t=e.value);return t}get maxValue(){let t=null;for(const e of this._def.checks)e.kind==="max"&&(t===null||e.value<t)&&(t=e.value);return t}get isInt(){return!!this._def.checks.find(t=>t.kind==="int"||t.kind==="multipleOf"&&ft.isInteger(t.value))}get isFinite(){let t=null,e=null;for(const n of this._def.checks){if(n.kind==="finite"||n.kind==="int"||n.kind==="multipleOf")return!0;n.kind==="min"?(e===null||n.value>e)&&(e=n.value):n.kind==="max"&&(t===null||n.value<t)&&(t=n.value)}return Number.isFinite(e)&&Number.isFinite(t)}}uc.create=r=>new uc({checks:[],typeName:Ge.ZodNumber,coerce:(r==null?void 0:r.coerce)||!1,...tt(r)});class lc extends ut{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(t){if(this._def.coerce)try{t.data=BigInt(t.data)}catch{return this._getInvalidInput(t)}if(this._getType(t)!==Re.bigint)return this._getInvalidInput(t);let n;const a=new pr;for(const i of this._def.checks)i.kind==="min"?(i.inclusive?t.data<i.value:t.data<=i.value)&&(n=this._getOrReturnCtx(t,n),xe(n,{code:me.too_small,type:"bigint",minimum:i.value,inclusive:i.inclusive,message:i.message}),a.dirty()):i.kind==="max"?(i.inclusive?t.data>i.value:t.data>=i.value)&&(n=this._getOrReturnCtx(t,n),xe(n,{code:me.too_big,type:"bigint",maximum:i.value,inclusive:i.inclusive,message:i.message}),a.dirty()):i.kind==="multipleOf"?t.data%i.value!==BigInt(0)&&(n=this._getOrReturnCtx(t,n),xe(n,{code:me.not_multiple_of,multipleOf:i.value,message:i.message}),a.dirty()):ft.assertNever(i);return{status:a.value,value:t.data}}_getInvalidInput(t){const e=this._getOrReturnCtx(t);return xe(e,{code:me.invalid_type,expected:Re.bigint,received:e.parsedType}),We}gte(t,e){return this.setLimit("min",t,!0,Te.toString(e))}gt(t,e){return this.setLimit("min",t,!1,Te.toString(e))}lte(t,e){return this.setLimit("max",t,!0,Te.toString(e))}lt(t,e){return this.setLimit("max",t,!1,Te.toString(e))}setLimit(t,e,n,a){return new lc({...this._def,checks:[...this._def.checks,{kind:t,value:e,inclusive:n,message:Te.toString(a)}]})}_addCheck(t){return new lc({...this._def,checks:[...this._def.checks,t]})}positive(t){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:Te.toString(t)})}negative(t){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:Te.toString(t)})}nonpositive(t){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:Te.toString(t)})}nonnegative(t){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:Te.toString(t)})}multipleOf(t,e){return this._addCheck({kind:"multipleOf",value:t,message:Te.toString(e)})}get minValue(){let t=null;for(const e of this._def.checks)e.kind==="min"&&(t===null||e.value>t)&&(t=e.value);return t}get maxValue(){let t=null;for(const e of this._def.checks)e.kind==="max"&&(t===null||e.value<t)&&(t=e.value);return t}}lc.create=r=>new lc({checks:[],typeName:Ge.ZodBigInt,coerce:(r==null?void 0:r.coerce)??!1,...tt(r)});class S2 extends ut{_parse(t){if(this._def.coerce&&(t.data=!!t.data),this._getType(t)!==Re.boolean){const n=this._getOrReturnCtx(t);return xe(n,{code:me.invalid_type,expected:Re.boolean,received:n.parsedType}),We}return Mr(t.data)}}S2.create=r=>new S2({typeName:Ge.ZodBoolean,coerce:(r==null?void 0:r.coerce)||!1,...tt(r)});class Uh extends ut{_parse(t){if(this._def.coerce&&(t.data=new Date(t.data)),this._getType(t)!==Re.date){const i=this._getOrReturnCtx(t);return xe(i,{code:me.invalid_type,expected:Re.date,received:i.parsedType}),We}if(Number.isNaN(t.data.getTime())){const i=this._getOrReturnCtx(t);return xe(i,{code:me.invalid_date}),We}const n=new pr;let a;for(const i of this._def.checks)i.kind==="min"?t.data.getTime()<i.value&&(a=this._getOrReturnCtx(t,a),xe(a,{code:me.too_small,message:i.message,inclusive:!0,exact:!1,minimum:i.value,type:"date"}),n.dirty()):i.kind==="max"?t.data.getTime()>i.value&&(a=this._getOrReturnCtx(t,a),xe(a,{code:me.too_big,message:i.message,inclusive:!0,exact:!1,maximum:i.value,type:"date"}),n.dirty()):ft.assertNever(i);return{status:n.value,value:new Date(t.data.getTime())}}_addCheck(t){return new Uh({...this._def,checks:[...this._def.checks,t]})}min(t,e){return this._addCheck({kind:"min",value:t.getTime(),message:Te.toString(e)})}max(t,e){return this._addCheck({kind:"max",value:t.getTime(),message:Te.toString(e)})}get minDate(){let t=null;for(const e of this._def.checks)e.kind==="min"&&(t===null||e.value>t)&&(t=e.value);return t!=null?new Date(t):null}get maxDate(){let t=null;for(const e of this._def.checks)e.kind==="max"&&(t===null||e.value<t)&&(t=e.value);return t!=null?new Date(t):null}}Uh.create=r=>new Uh({checks:[],coerce:(r==null?void 0:r.coerce)||!1,typeName:Ge.ZodDate,...tt(r)});class E2 extends ut{_parse(t){if(this._getType(t)!==Re.symbol){const n=this._getOrReturnCtx(t);return xe(n,{code:me.invalid_type,expected:Re.symbol,received:n.parsedType}),We}return Mr(t.data)}}E2.create=r=>new E2({typeName:Ge.ZodSymbol,...tt(r)});class C2 extends ut{_parse(t){if(this._getType(t)!==Re.undefined){const n=this._getOrReturnCtx(t);return xe(n,{code:me.invalid_type,expected:Re.undefined,received:n.parsedType}),We}return Mr(t.data)}}C2.create=r=>new C2({typeName:Ge.ZodUndefined,...tt(r)});class R2 extends ut{_parse(t){if(this._getType(t)!==Re.null){const n=this._getOrReturnCtx(t);return xe(n,{code:me.invalid_type,expected:Re.null,received:n.parsedType}),We}return Mr(t.data)}}R2.create=r=>new R2({typeName:Ge.ZodNull,...tt(r)});class A2 extends ut{constructor(){super(...arguments),this._any=!0}_parse(t){return Mr(t.data)}}A2.create=r=>new A2({typeName:Ge.ZodAny,...tt(r)});class T2 extends ut{constructor(){super(...arguments),this._unknown=!0}_parse(t){return Mr(t.data)}}T2.create=r=>new T2({typeName:Ge.ZodUnknown,...tt(r)});class io extends ut{_parse(t){const e=this._getOrReturnCtx(t);return xe(e,{code:me.invalid_type,expected:Re.never,received:e.parsedType}),We}}io.create=r=>new io({typeName:Ge.ZodNever,...tt(r)});class D2 extends ut{_parse(t){if(this._getType(t)!==Re.undefined){const n=this._getOrReturnCtx(t);return xe(n,{code:me.invalid_type,expected:Re.void,received:n.parsedType}),We}return Mr(t.data)}}D2.create=r=>new D2({typeName:Ge.ZodVoid,...tt(r)});class pa extends ut{_parse(t){const{ctx:e,status:n}=this._processInputParams(t),a=this._def;if(e.parsedType!==Re.array)return xe(e,{code:me.invalid_type,expected:Re.array,received:e.parsedType}),We;if(a.exactLength!==null){const s=e.data.length>a.exactLength.value,l=e.data.length<a.exactLength.value;(s||l)&&(xe(e,{code:s?me.too_big:me.too_small,minimum:l?a.exactLength.value:void 0,maximum:s?a.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:a.exactLength.message}),n.dirty())}if(a.minLength!==null&&e.data.length<a.minLength.value&&(xe(e,{code:me.too_small,minimum:a.minLength.value,type:"array",inclusive:!0,exact:!1,message:a.minLength.message}),n.dirty()),a.maxLength!==null&&e.data.length>a.maxLength.value&&(xe(e,{code:me.too_big,maximum:a.maxLength.value,type:"array",inclusive:!0,exact:!1,message:a.maxLength.message}),n.dirty()),e.common.async)return Promise.all([...e.data].map((s,l)=>a.type._parseAsync(new ao(e,s,e.path,l)))).then(s=>pr.mergeArray(n,s));const i=[...e.data].map((s,l)=>a.type._parseSync(new ao(e,s,e.path,l)));return pr.mergeArray(n,i)}get element(){return this._def.type}min(t,e){return new pa({...this._def,minLength:{value:t,message:Te.toString(e)}})}max(t,e){return new pa({...this._def,maxLength:{value:t,message:Te.toString(e)}})}length(t,e){return new pa({...this._def,exactLength:{value:t,message:Te.toString(e)}})}nonempty(t){return this.min(1,t)}}pa.create=(r,t)=>new pa({type:r,minLength:null,maxLength:null,exactLength:null,typeName:Ge.ZodArray,...tt(t)});function Ys(r){if(r instanceof en){const t={};for(const e in r.shape){const n=r.shape[e];t[e]=Ji.create(Ys(n))}return new en({...r._def,shape:()=>t})}else return r instanceof pa?new pa({...r._def,type:Ys(r.element)}):r instanceof Ji?Ji.create(Ys(r.unwrap())):r instanceof Nu?Nu.create(Ys(r.unwrap())):r instanceof Qo?Qo.create(r.items.map(t=>Ys(t))):r}class en extends ut{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const t=this._def.shape(),e=ft.objectKeys(t);return this._cached={shape:t,keys:e},this._cached}_parse(t){if(this._getType(t)!==Re.object){const f=this._getOrReturnCtx(t);return xe(f,{code:me.invalid_type,expected:Re.object,received:f.parsedType}),We}const{status:n,ctx:a}=this._processInputParams(t),{shape:i,keys:s}=this._getCached(),l=[];if(!(this._def.catchall instanceof io&&this._def.unknownKeys==="strip"))for(const f in a.data)s.includes(f)||l.push(f);const c=[];for(const f of s){const d=i[f],v=a.data[f];c.push({key:{status:"valid",value:f},value:d._parse(new ao(a,v,a.path,f)),alwaysSet:f in a.data})}if(this._def.catchall instanceof io){const f=this._def.unknownKeys;if(f==="passthrough")for(const d of l)c.push({key:{status:"valid",value:d},value:{status:"valid",value:a.data[d]}});else if(f==="strict")l.length>0&&(xe(a,{code:me.unrecognized_keys,keys:l}),n.dirty());else if(f!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const f=this._def.catchall;for(const d of l){const v=a.data[d];c.push({key:{status:"valid",value:d},value:f._parse(new ao(a,v,a.path,d)),alwaysSet:d in a.data})}}return a.common.async?Promise.resolve().then(async()=>{const f=[];for(const d of c){const v=await d.key,m=await d.value;f.push({key:v,value:m,alwaysSet:d.alwaysSet})}return f}).then(f=>pr.mergeObjectSync(n,f)):pr.mergeObjectSync(n,c)}get shape(){return this._def.shape()}strict(t){return Te.errToObj,new en({...this._def,unknownKeys:"strict",...t!==void 0?{errorMap:(e,n)=>{var i,s;const a=((s=(i=this._def).errorMap)==null?void 0:s.call(i,e,n).message)??n.defaultError;return e.code==="unrecognized_keys"?{message:Te.errToObj(t).message??a}:{message:a}}}:{}})}strip(){return new en({...this._def,unknownKeys:"strip"})}passthrough(){return new en({...this._def,unknownKeys:"passthrough"})}extend(t){return new en({...this._def,shape:()=>({...this._def.shape(),...t})})}merge(t){return new en({unknownKeys:t._def.unknownKeys,catchall:t._def.catchall,shape:()=>({...this._def.shape(),...t._def.shape()}),typeName:Ge.ZodObject})}setKey(t,e){return this.augment({[t]:e})}catchall(t){return new en({...this._def,catchall:t})}pick(t){const e={};for(const n of ft.objectKeys(t))t[n]&&this.shape[n]&&(e[n]=this.shape[n]);return new en({...this._def,shape:()=>e})}omit(t){const e={};for(const n of ft.objectKeys(this.shape))t[n]||(e[n]=this.shape[n]);return new en({...this._def,shape:()=>e})}deepPartial(){return Ys(this)}partial(t){const e={};for(const n of ft.objectKeys(this.shape)){const a=this.shape[n];t&&!t[n]?e[n]=a:e[n]=a.optional()}return new en({...this._def,shape:()=>e})}required(t){const e={};for(const n of ft.objectKeys(this.shape))if(t&&!t[n])e[n]=this.shape[n];else{let i=this.shape[n];for(;i instanceof Ji;)i=i._def.innerType;e[n]=i}return new en({...this._def,shape:()=>e})}keyof(){return uE(ft.objectKeys(this.shape))}}en.create=(r,t)=>new en({shape:()=>r,unknownKeys:"strip",catchall:io.create(),typeName:Ge.ZodObject,...tt(t)});en.strictCreate=(r,t)=>new en({shape:()=>r,unknownKeys:"strict",catchall:io.create(),typeName:Ge.ZodObject,...tt(t)});en.lazycreate=(r,t)=>new en({shape:r,unknownKeys:"strip",catchall:io.create(),typeName:Ge.ZodObject,...tt(t)});class Vh extends ut{_parse(t){const{ctx:e}=this._processInputParams(t),n=this._def.options;function a(i){for(const l of i)if(l.result.status==="valid")return l.result;for(const l of i)if(l.result.status==="dirty")return e.common.issues.push(...l.ctx.common.issues),l.result;const s=i.map(l=>new Qa(l.ctx.common.issues));return xe(e,{code:me.invalid_union,unionErrors:s}),We}if(e.common.async)return Promise.all(n.map(async i=>{const s={...e,common:{...e.common,issues:[]},parent:null};return{result:await i._parseAsync({data:e.data,path:e.path,parent:s}),ctx:s}})).then(a);{let i;const s=[];for(const c of n){const f={...e,common:{...e.common,issues:[]},parent:null},d=c._parseSync({data:e.data,path:e.path,parent:f});if(d.status==="valid")return d;d.status==="dirty"&&!i&&(i={result:d,ctx:f}),f.common.issues.length&&s.push(f.common.issues)}if(i)return e.common.issues.push(...i.ctx.common.issues),i.result;const l=s.map(c=>new Qa(c));return xe(e,{code:me.invalid_union,unionErrors:l}),We}}get options(){return this._def.options}}Vh.create=(r,t)=>new Vh({options:r,typeName:Ge.ZodUnion,...tt(t)});function Sg(r,t){const e=Bi(r),n=Bi(t);if(r===t)return{valid:!0,data:r};if(e===Re.object&&n===Re.object){const a=ft.objectKeys(t),i=ft.objectKeys(r).filter(l=>a.indexOf(l)!==-1),s={...r,...t};for(const l of i){const c=Sg(r[l],t[l]);if(!c.valid)return{valid:!1};s[l]=c.data}return{valid:!0,data:s}}else if(e===Re.array&&n===Re.array){if(r.length!==t.length)return{valid:!1};const a=[];for(let i=0;i<r.length;i++){const s=r[i],l=t[i],c=Sg(s,l);if(!c.valid)return{valid:!1};a.push(c.data)}return{valid:!0,data:a}}else return e===Re.date&&n===Re.date&&+r==+t?{valid:!0,data:r}:{valid:!1}}class Hh extends ut{_parse(t){const{status:e,ctx:n}=this._processInputParams(t),a=(i,s)=>{if(x2(i)||x2(s))return We;const l=Sg(i.value,s.value);return l.valid?((w2(i)||w2(s))&&e.dirty(),{status:e.value,value:l.data}):(xe(n,{code:me.invalid_intersection_types}),We)};return n.common.async?Promise.all([this._def.left._parseAsync({data:n.data,path:n.path,parent:n}),this._def.right._parseAsync({data:n.data,path:n.path,parent:n})]).then(([i,s])=>a(i,s)):a(this._def.left._parseSync({data:n.data,path:n.path,parent:n}),this._def.right._parseSync({data:n.data,path:n.path,parent:n}))}}Hh.create=(r,t,e)=>new Hh({left:r,right:t,typeName:Ge.ZodIntersection,...tt(e)});class Qo extends ut{_parse(t){const{status:e,ctx:n}=this._processInputParams(t);if(n.parsedType!==Re.array)return xe(n,{code:me.invalid_type,expected:Re.array,received:n.parsedType}),We;if(n.data.length<this._def.items.length)return xe(n,{code:me.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),We;!this._def.rest&&n.data.length>this._def.items.length&&(xe(n,{code:me.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),e.dirty());const i=[...n.data].map((s,l)=>{const c=this._def.items[l]||this._def.rest;return c?c._parse(new ao(n,s,n.path,l)):null}).filter(s=>!!s);return n.common.async?Promise.all(i).then(s=>pr.mergeArray(e,s)):pr.mergeArray(e,i)}get items(){return this._def.items}rest(t){return new Qo({...this._def,rest:t})}}Qo.create=(r,t)=>{if(!Array.isArray(r))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new Qo({items:r,typeName:Ge.ZodTuple,rest:null,...tt(t)})};class k2 extends ut{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(t){const{status:e,ctx:n}=this._processInputParams(t);if(n.parsedType!==Re.map)return xe(n,{code:me.invalid_type,expected:Re.map,received:n.parsedType}),We;const a=this._def.keyType,i=this._def.valueType,s=[...n.data.entries()].map(([l,c],f)=>({key:a._parse(new ao(n,l,n.path,[f,"key"])),value:i._parse(new ao(n,c,n.path,[f,"value"]))}));if(n.common.async){const l=new Map;return Promise.resolve().then(async()=>{for(const c of s){const f=await c.key,d=await c.value;if(f.status==="aborted"||d.status==="aborted")return We;(f.status==="dirty"||d.status==="dirty")&&e.dirty(),l.set(f.value,d.value)}return{status:e.value,value:l}})}else{const l=new Map;for(const c of s){const f=c.key,d=c.value;if(f.status==="aborted"||d.status==="aborted")return We;(f.status==="dirty"||d.status==="dirty")&&e.dirty(),l.set(f.value,d.value)}return{status:e.value,value:l}}}}k2.create=(r,t,e)=>new k2({valueType:t,keyType:r,typeName:Ge.ZodMap,...tt(e)});class cc extends ut{_parse(t){const{status:e,ctx:n}=this._processInputParams(t);if(n.parsedType!==Re.set)return xe(n,{code:me.invalid_type,expected:Re.set,received:n.parsedType}),We;const a=this._def;a.minSize!==null&&n.data.size<a.minSize.value&&(xe(n,{code:me.too_small,minimum:a.minSize.value,type:"set",inclusive:!0,exact:!1,message:a.minSize.message}),e.dirty()),a.maxSize!==null&&n.data.size>a.maxSize.value&&(xe(n,{code:me.too_big,maximum:a.maxSize.value,type:"set",inclusive:!0,exact:!1,message:a.maxSize.message}),e.dirty());const i=this._def.valueType;function s(c){const f=new Set;for(const d of c){if(d.status==="aborted")return We;d.status==="dirty"&&e.dirty(),f.add(d.value)}return{status:e.value,value:f}}const l=[...n.data.values()].map((c,f)=>i._parse(new ao(n,c,n.path,f)));return n.common.async?Promise.all(l).then(c=>s(c)):s(l)}min(t,e){return new cc({...this._def,minSize:{value:t,message:Te.toString(e)}})}max(t,e){return new cc({...this._def,maxSize:{value:t,message:Te.toString(e)}})}size(t,e){return this.min(t,e).max(t,e)}nonempty(t){return this.min(1,t)}}cc.create=(r,t)=>new cc({valueType:r,minSize:null,maxSize:null,typeName:Ge.ZodSet,...tt(t)});class O2 extends ut{get schema(){return this._def.getter()}_parse(t){const{ctx:e}=this._processInputParams(t);return this._def.getter()._parse({data:e.data,path:e.path,parent:e})}}O2.create=(r,t)=>new O2({getter:r,typeName:Ge.ZodLazy,...tt(t)});class N2 extends ut{_parse(t){if(t.data!==this._def.value){const e=this._getOrReturnCtx(t);return xe(e,{received:e.data,code:me.invalid_literal,expected:this._def.value}),We}return{status:"valid",value:t.data}}get value(){return this._def.value}}N2.create=(r,t)=>new N2({value:r,typeName:Ge.ZodLiteral,...tt(t)});function uE(r,t){return new ku({values:r,typeName:Ge.ZodEnum,...tt(t)})}class ku extends ut{_parse(t){if(typeof t.data!="string"){const e=this._getOrReturnCtx(t),n=this._def.values;return xe(e,{expected:ft.joinValues(n),received:e.parsedType,code:me.invalid_type}),We}if(this._cache||(this._cache=new Set(this._def.values)),!this._cache.has(t.data)){const e=this._getOrReturnCtx(t),n=this._def.values;return xe(e,{received:e.data,code:me.invalid_enum_value,options:n}),We}return Mr(t.data)}get options(){return this._def.values}get enum(){const t={};for(const e of this._def.values)t[e]=e;return t}get Values(){const t={};for(const e of this._def.values)t[e]=e;return t}get Enum(){const t={};for(const e of this._def.values)t[e]=e;return t}extract(t,e=this._def){return ku.create(t,{...this._def,...e})}exclude(t,e=this._def){return ku.create(this.options.filter(n=>!t.includes(n)),{...this._def,...e})}}ku.create=uE;class M2 extends ut{_parse(t){const e=ft.getValidEnumValues(this._def.values),n=this._getOrReturnCtx(t);if(n.parsedType!==Re.string&&n.parsedType!==Re.number){const a=ft.objectValues(e);return xe(n,{expected:ft.joinValues(a),received:n.parsedType,code:me.invalid_type}),We}if(this._cache||(this._cache=new Set(ft.getValidEnumValues(this._def.values))),!this._cache.has(t.data)){const a=ft.objectValues(e);return xe(n,{received:n.data,code:me.invalid_enum_value,options:a}),We}return Mr(t.data)}get enum(){return this._def.values}}M2.create=(r,t)=>new M2({values:r,typeName:Ge.ZodNativeEnum,...tt(t)});class jh extends ut{unwrap(){return this._def.type}_parse(t){const{ctx:e}=this._processInputParams(t);if(e.parsedType!==Re.promise&&e.common.async===!1)return xe(e,{code:me.invalid_type,expected:Re.promise,received:e.parsedType}),We;const n=e.parsedType===Re.promise?e.data:Promise.resolve(e.data);return Mr(n.then(a=>this._def.type.parseAsync(a,{path:e.path,errorMap:e.common.contextualErrorMap})))}}jh.create=(r,t)=>new jh({type:r,typeName:Ge.ZodPromise,...tt(t)});class Ou extends ut{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===Ge.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(t){const{status:e,ctx:n}=this._processInputParams(t),a=this._def.effect||null,i={addIssue:s=>{xe(n,s),s.fatal?e.abort():e.dirty()},get path(){return n.path}};if(i.addIssue=i.addIssue.bind(i),a.type==="preprocess"){const s=a.transform(n.data,i);if(n.common.async)return Promise.resolve(s).then(async l=>{if(e.value==="aborted")return We;const c=await this._def.schema._parseAsync({data:l,path:n.path,parent:n});return c.status==="aborted"?We:c.status==="dirty"||e.value==="dirty"?Ql(c.value):c});{if(e.value==="aborted")return We;const l=this._def.schema._parseSync({data:s,path:n.path,parent:n});return l.status==="aborted"?We:l.status==="dirty"||e.value==="dirty"?Ql(l.value):l}}if(a.type==="refinement"){const s=l=>{const c=a.refinement(l,i);if(n.common.async)return Promise.resolve(c);if(c instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return l};if(n.common.async===!1){const l=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});return l.status==="aborted"?We:(l.status==="dirty"&&e.dirty(),s(l.value),{status:e.value,value:l.value})}else return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(l=>l.status==="aborted"?We:(l.status==="dirty"&&e.dirty(),s(l.value).then(()=>({status:e.value,value:l.value}))))}if(a.type==="transform")if(n.common.async===!1){const s=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});if(!Du(s))return We;const l=a.transform(s.value,i);if(l instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:e.value,value:l}}else return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(s=>Du(s)?Promise.resolve(a.transform(s.value,i)).then(l=>({status:e.value,value:l})):We);ft.assertNever(a)}}Ou.create=(r,t,e)=>new Ou({schema:r,typeName:Ge.ZodEffects,effect:t,...tt(e)});Ou.createWithPreprocess=(r,t,e)=>new Ou({schema:t,effect:{type:"preprocess",transform:r},typeName:Ge.ZodEffects,...tt(e)});class Ji extends ut{_parse(t){return this._getType(t)===Re.undefined?Mr(void 0):this._def.innerType._parse(t)}unwrap(){return this._def.innerType}}Ji.create=(r,t)=>new Ji({innerType:r,typeName:Ge.ZodOptional,...tt(t)});class Nu extends ut{_parse(t){return this._getType(t)===Re.null?Mr(null):this._def.innerType._parse(t)}unwrap(){return this._def.innerType}}Nu.create=(r,t)=>new Nu({innerType:r,typeName:Ge.ZodNullable,...tt(t)});class Eg extends ut{_parse(t){const{ctx:e}=this._processInputParams(t);let n=e.data;return e.parsedType===Re.undefined&&(n=this._def.defaultValue()),this._def.innerType._parse({data:n,path:e.path,parent:e})}removeDefault(){return this._def.innerType}}Eg.create=(r,t)=>new Eg({innerType:r,typeName:Ge.ZodDefault,defaultValue:typeof t.default=="function"?t.default:()=>t.default,...tt(t)});class Cg extends ut{_parse(t){const{ctx:e}=this._processInputParams(t),n={...e,common:{...e.common,issues:[]}},a=this._def.innerType._parse({data:n.data,path:n.path,parent:{...n}});return zh(a)?a.then(i=>({status:"valid",value:i.status==="valid"?i.value:this._def.catchValue({get error(){return new Qa(n.common.issues)},input:n.data})})):{status:"valid",value:a.status==="valid"?a.value:this._def.catchValue({get error(){return new Qa(n.common.issues)},input:n.data})}}removeCatch(){return this._def.innerType}}Cg.create=(r,t)=>new Cg({innerType:r,typeName:Ge.ZodCatch,catchValue:typeof t.catch=="function"?t.catch:()=>t.catch,...tt(t)});class I2 extends ut{_parse(t){if(this._getType(t)!==Re.nan){const n=this._getOrReturnCtx(t);return xe(n,{code:me.invalid_type,expected:Re.nan,received:n.parsedType}),We}return{status:"valid",value:t.data}}}I2.create=r=>new I2({typeName:Ge.ZodNaN,...tt(r)});class R3 extends ut{_parse(t){const{ctx:e}=this._processInputParams(t),n=e.data;return this._def.type._parse({data:n,path:e.path,parent:e})}unwrap(){return this._def.type}}class dy extends ut{_parse(t){const{status:e,ctx:n}=this._processInputParams(t);if(n.common.async)return(async()=>{const i=await this._def.in._parseAsync({data:n.data,path:n.path,parent:n});return i.status==="aborted"?We:i.status==="dirty"?(e.dirty(),Ql(i.value)):this._def.out._parseAsync({data:i.value,path:n.path,parent:n})})();{const a=this._def.in._parseSync({data:n.data,path:n.path,parent:n});return a.status==="aborted"?We:a.status==="dirty"?(e.dirty(),{status:"dirty",value:a.value}):this._def.out._parseSync({data:a.value,path:n.path,parent:n})}}static create(t,e){return new dy({in:t,out:e,typeName:Ge.ZodPipeline})}}class Rg extends ut{_parse(t){const e=this._def.innerType._parse(t),n=a=>(Du(a)&&(a.value=Object.freeze(a.value)),a);return zh(e)?e.then(a=>n(a)):n(e)}unwrap(){return this._def.innerType}}Rg.create=(r,t)=>new Rg({innerType:r,typeName:Ge.ZodReadonly,...tt(t)});var Ge;(function(r){r.ZodString="ZodString",r.ZodNumber="ZodNumber",r.ZodNaN="ZodNaN",r.ZodBigInt="ZodBigInt",r.ZodBoolean="ZodBoolean",r.ZodDate="ZodDate",r.ZodSymbol="ZodSymbol",r.ZodUndefined="ZodUndefined",r.ZodNull="ZodNull",r.ZodAny="ZodAny",r.ZodUnknown="ZodUnknown",r.ZodNever="ZodNever",r.ZodVoid="ZodVoid",r.ZodArray="ZodArray",r.ZodObject="ZodObject",r.ZodUnion="ZodUnion",r.ZodDiscriminatedUnion="ZodDiscriminatedUnion",r.ZodIntersection="ZodIntersection",r.ZodTuple="ZodTuple",r.ZodRecord="ZodRecord",r.ZodMap="ZodMap",r.ZodSet="ZodSet",r.ZodFunction="ZodFunction",r.ZodLazy="ZodLazy",r.ZodLiteral="ZodLiteral",r.ZodEnum="ZodEnum",r.ZodEffects="ZodEffects",r.ZodNativeEnum="ZodNativeEnum",r.ZodOptional="ZodOptional",r.ZodNullable="ZodNullable",r.ZodDefault="ZodDefault",r.ZodCatch="ZodCatch",r.ZodPromise="ZodPromise",r.ZodBranded="ZodBranded",r.ZodPipeline="ZodPipeline",r.ZodReadonly="ZodReadonly"})(Ge||(Ge={}));const bU=Xi.create;io.create;pa.create;Vh.create;Hh.create;Qo.create;ku.create;jh.create;Ji.create;Nu.create;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var lE=function(r,t){return(lE=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var a in n)n.hasOwnProperty(a)&&(e[a]=n[a])})(r,t)};function Xr(r,t){function e(){this.constructor=r}lE(r,t),r.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}function Ee(r,t,e,n){return new(e||(e=Promise))(function(a,i){function s(f){try{c(n.next(f))}catch(d){i(d)}}function l(f){try{c(n.throw(f))}catch(d){i(d)}}function c(f){f.done?a(f.value):new e(function(d){d(f.value)}).then(s,l)}c((n=n.apply(r,[])).next())})}function Ce(r,t){var e,n,a,i,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},typeof Symbol=="function"&&(i[Symbol.iterator]=function(){return this}),i;function l(c){return function(f){return function(d){if(e)throw new TypeError("Generator is already executing.");for(;s;)try{if(e=1,n&&(a=2&d[0]?n.return:d[0]?n.throw||((a=n.return)&&a.call(n),0):n.next)&&!(a=a.call(n,d[1])).done)return a;switch(n=0,a&&(d=[2&d[0],a.value]),d[0]){case 0:case 1:a=d;break;case 4:return s.label++,{value:d[1],done:!1};case 5:s.label++,n=d[1],d=[0];continue;case 7:d=s.ops.pop(),s.trys.pop();continue;default:if(!(a=(a=s.trys).length>0&&a[a.length-1])&&(d[0]===6||d[0]===2)){s=0;continue}if(d[0]===3&&(!a||d[1]>a[0]&&d[1]<a[3])){s.label=d[1];break}if(d[0]===6&&s.label<a[1]){s.label=a[1],a=d;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(d);break}a[2]&&s.ops.pop(),s.trys.pop();continue}d=t.call(r,s)}catch(v){d=[6,v],n=0}finally{e=a=0}if(5&d[0])throw d[1];return{value:d[0]?d[1]:void 0,done:!0}}([c,f])}}}var A3=function(){function r(t){this.global=t,this.flags={},this.flagRegistry={},this.urlFlags={},this.populateURLFlags()}return r.prototype.setPlatform=function(t,e){this.platform!=null&&console.warn("Platform "+this.platformName+" has already been set. Overwriting the platform with "+e+"."),this.platformName=t,this.platform=e},r.prototype.registerFlag=function(t,e,n){if(this.flagRegistry[t]={evaluationFn:e,setHook:n},this.urlFlags[t]!=null){var a=this.urlFlags[t];console.warn("Setting feature override from URL "+t+": "+a+"."),this.set(t,a)}},r.prototype.get=function(t){return t in this.flags?this.flags[t]:(this.flags[t]=this.evaluateFlag(t),this.flags[t])},r.prototype.getNumber=function(t){return this.get(t)},r.prototype.getBool=function(t){return this.get(t)},r.prototype.getFlags=function(){return this.flags},Object.defineProperty(r.prototype,"features",{get:function(){return this.flags},enumerable:!0,configurable:!0}),r.prototype.set=function(t,e){if(this.flagRegistry[t]==null)throw new Error("Cannot set flag "+t+" as it has not been registered.");this.flags[t]=e,this.flagRegistry[t].setHook!=null&&this.flagRegistry[t].setHook(e)},r.prototype.evaluateFlag=function(t){if(this.flagRegistry[t]==null)throw new Error("Cannot evaluate flag '"+t+"': no evaluation function found.");return this.flagRegistry[t].evaluationFn()},r.prototype.setFlags=function(t){this.flags=Object.assign({},t)},r.prototype.reset=function(){this.flags={},this.urlFlags={},this.populateURLFlags()},r.prototype.populateURLFlags=function(){var t=this;if(this.global!==void 0&&this.global.location!==void 0&&this.global.location.search!==void 0){var e,n,a=(e=this.global.location.search,n={},e.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,function(i){for(var s=[],l=1;l<arguments.length;l++)s[l-1]=arguments[l];return T3(n,s[0],s[1]),s.join("=")}),n);"tfjsflags"in a&&a.tfjsflags.split(",").forEach(function(i){var s=i.split(":"),l=s[0],c=s[1];t.urlFlags[l]=function(f,d){if((d=d.toLowerCase())==="true"||d==="false")return d==="true";if(""+ +d===d)return+d;throw new Error("Could not parse value flag value "+d+" for flag "+f+".")}(l,c)})}},r}();function T3(r,t,e){r[decodeURIComponent(t)]=decodeURIComponent(e||"")}function le(){return cE}var cE=null,Wh=new Map,Ag=new Map;function fE(r,t){var e=dE(r,t);return Wh.get(e)}function D3(r){return Ag.get(r)}function F2(r){for(var t=Wh.entries(),e=[];;){var n=t.next(),a=n.done,i=n.value;if(a)break;var s=i[0],l=i[1];s.split("_")[0]===r&&e.push(l)}return e}function hE(r){var t=r.kernelName,e=r.backendName,n=dE(t,e);if(Wh.has(n))throw new Error("The kernel '"+t+"' for backend '"+e+"' is already registered");Wh.set(n,r)}function k3(r){var t=r.kernelName;Ag.has(t)&&console.warn("Overriding the gradient for '"+t+"'"),Ag.set(t,r)}function dE(r,t){return t+"_"+r}function Tg(r,t,e){return Math.max(r,Math.min(t,e))}function pE(r){return r%2==0?r:r+1}function O3(r){for(var t=0,e=0;e<r.length;e++)t+=r[e];return t}function L(r,t){if(!r)throw new Error(typeof t=="string"?t:t())}function gt(r,t,e){e===void 0&&(e=""),L(vn(r,t),function(){return e+" Shapes "+r+" and "+t+" must match"})}function Vu(r){L(r!=null,function(){return"The input to the tensor constructor must be a non-null value."})}function Mu(r,t,e){if(t===void 0&&(t=[]),e===void 0&&(e=!1),t==null&&(t=[]),Array.isArray(r)||va(r)&&!e)for(var n=0;n<r.length;++n)Mu(r[n],t,e);else t.push(r);return t}function Ae(r){if(r.length===0)return 1;for(var t=r[0],e=1;e<r.length;e++)t*=r[e];return t}function vn(r,t){if(r===t)return!0;if(r==null||t==null||r.length!==t.length)return!1;for(var e=0;e<r.length;e++)if(r[e]!==t[e])return!1;return!0}function jt(r){return r%1==0}function N3(r){if(Math.tanh!=null)return Math.tanh(r);if(r===1/0)return 1;if(r===-1/0)return-1;var t=Math.exp(2*r);return(t-1)/(t+1)}function Dg(r){var t=Math.ceil(Math.sqrt(r));return[t,Math.ceil(r/t)]}function ru(r,t){return t<=r.length?r:r+" ".repeat(t-r.length)}function B2(r,t,e){return t===void 0&&(t=function(n){return 0}),new Promise(function(n,a){var i=0,s=function(){if(r())n();else{i++;var l=t(i);e!=null&&i>=e?a():setTimeout(s,l)}};s()})}function M3(r,t){for(var e=1,n=-1,a=0;a<r.length;++a)if(r[a]>=0)e*=r[a];else if(r[a]===-1){if(n!==-1)throw Error("Shapes can only have 1 implicit size. Found -1 at dim "+n+" and dim "+a);n=a}else if(r[a]<0)throw Error("Shapes can not be < 0. Found "+r[a]+" at dim "+a);if(n===-1){if(t>0&&t!==e)throw Error("Size("+t+") must match the product of shape "+r);return r}if(e===0)throw Error("Cannot infer the missing size in ["+r+"] when there are 0 elements");if(t%e!=0)throw Error("The implicit shape can't be a fractional number. Got "+t+" / "+e);var i=r.slice();return i[n]=t/e,i}function sn(r,t){var e=t.length;return L((r=r==null?t.map(function(n,a){return a}):[].concat(r)).every(function(n){return n>=-e&&n<e}),function(){return"All values in axis param must be in range [-"+e+", "+e+") but got axis "+r}),L(r.every(function(n){return jt(n)}),function(){return"All values in axis param must be integers but got axis "+r}),r.map(function(n){return n<0?e+n:n})}function No(r,t){for(var e=[],n=[],a=t!=null&&Array.isArray(t)&&t.length===0,i=t==null||a?null:sn(t,r).sort(),s=0,l=0;l<r.length;++l){if(i!=null){if(i[s]===l&&r[l]!==1)throw new Error("Can't squeeze axis "+l+" since its dim '"+r[l]+"' is not 1");(i[s]==null||i[s]>l)&&r[l]===1&&(e.push(r[l]),n.push(l)),i[s]<=l&&s++}r[l]!==1&&(e.push(r[l]),n.push(l))}return{newShape:e,keptDims:n}}function fc(r,t){var e=null;if(r==null||r==="float32")e=new Float32Array(t);else if(r==="int32")e=new Int32Array(t);else{if(r!=="bool")throw new Error("Unknown data type "+r);e=new Uint8Array(t)}return e}function Gh(r,t){var e=null;if(r==null||r==="float32")e=new Float32Array(t);else if(r==="int32")e=new Int32Array(t);else if(r==="bool")e=new Uint8Array(t);else{if(r!=="string")throw new Error("Unknown data type "+r);e=new Array(t)}return e}function I3(r,t){for(var e=0;e<r.length;e++){var n=r[e];if(isNaN(n)||!isFinite(n))throw Error("A tensor of type "+t+" being uploaded contains "+n+".")}}function F3(r){return r==="bool"||r==="complex64"||r==="float32"||r==="int32"||r==="string"}function B3(r,t){return t!=="complex64"&&(t!=="float32"||r==="complex64")&&(t!=="int32"||r==="float32"||r==="complex64")&&(t!=="bool"||r!=="bool")}function va(r){return r instanceof Float32Array||r instanceof Int32Array||r instanceof Uint8Array}function vE(r){if(r==="float32"||r==="int32")return 4;if(r==="complex64")return 8;if(r==="bool")return 1;throw new Error("Unknown dtype "+r)}function L3(r){if(r==null)return 0;var t=0;return r.forEach(function(e){return t+=e.length}),t}function py(r){return typeof r=="string"||r instanceof String}function P3(r){return typeof r=="boolean"}function z3(r){return typeof r=="number"}function Tc(r){return Array.isArray(r)?Tc(r[0]):r instanceof Float32Array?"float32":r instanceof Int32Array||r instanceof Uint8Array?"int32":z3(r)?"float32":py(r)?"string":P3(r)?"bool":"float32"}function kg(r){return!!(r&&r.constructor&&r.call&&r.apply)}function Og(r,t){for(var e=t;e<r;++e)if(r%e==0)return e;return r}function ma(r){var t=r.length;if(t<2)return[];var e=new Array(t-1);e[t-2]=r[t-1];for(var n=t-3;n>=0;--n)e[n]=e[n+1]*r[n+1];return e}function mE(r,t,e){if(t==="string")throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(r)&&(r=Mu(r)),e&&I3(r,t),function(i,s){return i instanceof Float32Array&&s==="float32"||i instanceof Int32Array&&s==="int32"||i instanceof Uint8Array&&s==="bool"}(r,t))return r;if(t==null||t==="float32"||t==="complex64")return new Float32Array(r);if(t==="int32")return new Int32Array(r);if(t==="bool"){for(var n=new Uint8Array(r.length),a=0;a<n.length;++a)Math.round(r[a])!==0&&(n[a]=1);return n}throw new Error("Unknown data type "+t)}function L2(r,t){if(r.length===0)return t[0];var e=r.reduce(function(n,a){return n*a});if(e===0)return[];if(e!==t.length)throw new Error("["+r+"] does not match the input size.");return function n(a,i,s){var l=new Array;if(i.length===1)for(var c=i[0],f=0;f<c;f++)l[f]=s[a+f];else{c=i[0];var d=i.slice(1),v=d.reduce(function(m,g){return m*g});for(f=0;f<c;f++)l[f]=n(a+f*v,d,s)}return l}(0,r,t)}function gE(r,t){for(var e=Dc(r,t),n=0;n<e.length;n++)e[n]=1;return e}function Dc(r,t){if(t==null||t==="float32"||t==="complex64")return new Float32Array(r);if(t==="int32")return new Int32Array(r);if(t==="bool")return new Uint8Array(r);throw new Error("Unknown data type "+t)}function la(){return le().platform.now()}function yE(r){r.forEach(function(t){L(Number.isInteger(t)&&t>=0,function(){return"Tensor must have a shape comprised of positive integers but got shape ["+r+"]."})})}function U3(r,t){return t===void 0&&(t="utf-8"),t=t||"utf-8",le().platform.encode(r,t)}function qh(r,t){return t===void 0&&(t="utf-8"),t=t||"utf-8",le().platform.decode(r,t)}function P2(r,t,e){if(t===0)return 0;if(t===1)return r[0];for(var n=r[r.length-1],a=0;a<r.length-1;++a)n+=e[a]*r[a];return n}function V3(r,t,e){if(t===0)return[];if(t===1)return[r];for(var n=new Array(t),a=0;a<n.length-1;++a)n[a]=Math.floor(r/e[a]),r-=n[a]*e[a];return n[n.length-1]=r,n}var H3=function(){function r(t,e){this.backendTimer=t,this.logger=e,e==null&&(this.logger=new j3)}return r.prototype.profileKernel=function(t,e,n){var a,i=this,s=this.backendTimer.time(function(){a=n()});return a.forEach(function(l){l.data().then(function(c){(function(f,d,v){if(d!=="float32")return!1;for(var m=0;m<f.length;m++){var g=f[m];if(isNaN(g)||!isFinite(g))return console.warn("Found "+g+" in the result of '"+v+"'"),!0}})(c,l.dtype,t),s.then(function(f){var d="";f.getExtraProfileInfo!=null&&(d=f.getExtraProfileInfo()),i.logger.logKernelProfile(t,l,c,f.kernelMs,e,d)})})}),a},r}(),j3=function(){function r(){}return r.prototype.logKernelProfile=function(t,e,n,a,i,s){var l=typeof a=="number"?ru(a+"ms",9):a.error,c=ru(t,25),f=e.rank,d=e.size,v=ru(e.shape.toString(),14),m="";for(var g in i){var b=i[g].shape||e.shape,w=b.length;m+=g+": "+w+"D "+(w>0?b:"")+" "}console.log("%c"+c+"	%c"+l+"	%c"+f+"D "+v+"	%c"+d+"	%c"+m+"	%c"+s,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")},r}(),z2=20,Wl=3,bm=7;function W3(r,t,e,n){var a=ma(t),i=function(f,d,v,m){var g=Ae(d),b=m[m.length-1],w=new Array(b).fill(0),_=d.length,S=v==="complex64"?ql(f):f;if(_>1)for(var E=0;E<g/b;E++)for(var C=E*b,R=0;R<b;R++)w[R]=Math.max(w[R],Gl(S[C+R],0,v).length);return w}(r,t,e,a),s=t.length,l=function f(d,v,m,g,b,w){w===void 0&&(w=!0);var _=m==="complex64"?2:1,S=v[0],E=v.length;if(E===0)return m==="complex64"?[Gl(ql(d)[0],0,m)]:m==="bool"?[bE(d[0])]:[d[0].toString()];if(E===1){if(S>z2){var C=Wl*_,R=Array.from(d.slice(0,C)),A=Array.from(d.slice((S-Wl)*_,S*_));return m==="complex64"&&(R=ql(R),A=ql(A)),["["+R.map(function(ne,P){return Gl(ne,b[P],m)}).join(", ")+", ..., "+A.map(function(ne,P){return Gl(ne,b[S-Wl+P],m)}).join(", ")+"]"]}return["["+(m==="complex64"?ql(d):Array.from(d)).map(function(ne,P){return Gl(ne,b[P],m)}).join(", ")+"]"]}var D=v.slice(1),k=g.slice(1),I=g[0]*_,O=[];if(S>z2){for(var M=0;M<Wl;M++){var V=(z=M*I)+I;O.push.apply(O,f(d.slice(z,V),D,m,k,b,!1))}for(O.push("..."),M=S-Wl;M<S;M++)V=(z=M*I)+I,O.push.apply(O,f(d.slice(z,V),D,m,k,b,M===S-1))}else for(M=0;M<S;M++){var z;V=(z=M*I)+I,O.push.apply(O,f(d.slice(z,V),D,m,k,b,M===S-1))}var J=E===2?",":"";for(O[0]="["+O[0]+J,M=1;M<O.length-1;M++)O[M]=" "+O[M]+J;var te=`,
`;for(M=2;M<E;M++)te+=`
`;return O[O.length-1]=" "+O[O.length-1]+"]"+(w?"":te),O}(r,t,e,a,i),c=["Tensor"];return n&&(c.push("  dtype: "+e),c.push("  rank: "+s),c.push("  shape: ["+t+"]"),c.push("  values:")),c.push(l.map(function(f){return"    "+f}).join(`
`)),c.join(`
`)}function Gl(r,t,e){return ru(Array.isArray(r)?parseFloat(r[0].toFixed(bm))+" + "+parseFloat(r[1].toFixed(bm))+"j":py(r)?"'"+r+"'":e==="bool"?bE(r):parseFloat(r.toFixed(bm)).toString(),t)}function bE(r){return r===0?"false":"true"}function ql(r){for(var t=[],e=0;e<r.length;e+=2)t.push([r[e],r[e+1]]);return t}var hc=function(){function r(t,e,n){var a=this;if(this.dtype=e,this.shape=t.slice(),this.size=Ae(t),n!=null){var i=n.length;L(i===this.size,function(){return"Length of values '"+i+"' does not match the size inferred by the shape '"+a.size+"'."})}if(e==="complex64")throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=n||Gh(e,this.size),this.strides=ma(t)}return r.prototype.set=function(t){for(var e=this,n=[],a=1;a<arguments.length;a++)n[a-1]=arguments[a];n.length===0&&(n=[0]),L(n.length===this.rank,function(){return"The number of provided coordinates ("+n.length+") must match the rank ("+e.rank+")"});var i=this.locToIndex(n);this.values[i]=t},r.prototype.get=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];t.length===0&&(t=[0]);for(var n=0,a=0,i=t;a<i.length;a++){var s=i[a];if(s<0||s>=this.shape[n]){var l="Requested out of range element at "+t+".   Buffer shape="+this.shape;throw new Error(l)}n++}for(var c=t[t.length-1],f=0;f<t.length-1;++f)c+=this.strides[f]*t[f];return this.values[c]},r.prototype.locToIndex=function(t){if(this.rank===0)return 0;if(this.rank===1)return t[0];for(var e=t[t.length-1],n=0;n<t.length-1;++n)e+=this.strides[n]*t[n];return e},r.prototype.indexToLoc=function(t){if(this.rank===0)return[];if(this.rank===1)return[t];for(var e=new Array(this.shape.length),n=0;n<e.length-1;++n)e[n]=Math.floor(t/this.strides[n]),t-=e[n]*this.strides[n];return e[e.length-1]=t,e},Object.defineProperty(r.prototype,"rank",{get:function(){return this.shape.length},enumerable:!0,configurable:!0}),r.prototype.toTensor=function(){return ca().makeTensor(this.values,this.shape,this.dtype)},r}(),ca=null,ue=null,xE=null,Nt=function(){function r(t,e,n,a){this.kept=!1,this.isDisposedInternal=!1,this.shape=t.slice(),this.dtype=e||"float32",this.size=Ae(t),this.strides=ma(t),this.dataId=n,this.id=a,this.rankType=this.rank<5?this.rank.toString():"higher"}return r.prototype.flatten=function(){return this.throwIfDisposed(),this.as1D()},r.prototype.asScalar=function(){return this.throwIfDisposed(),L(this.size===1,function(){return"The array must have only 1 element."}),this.reshape([])},r.prototype.as1D=function(){return this.throwIfDisposed(),this.reshape([this.size])},r.prototype.as2D=function(t,e){return this.throwIfDisposed(),this.reshape([t,e])},r.prototype.as3D=function(t,e,n){return this.throwIfDisposed(),this.reshape([t,e,n])},r.prototype.as4D=function(t,e,n,a){return this.throwIfDisposed(),this.reshape([t,e,n,a])},r.prototype.as5D=function(t,e,n,a,i){return this.throwIfDisposed(),this.reshape([t,e,n,a,i])},r.prototype.asType=function(t){return this.throwIfDisposed(),ue.cast(this,t)},Object.defineProperty(r.prototype,"rank",{get:function(){return this.shape.length},enumerable:!0,configurable:!0}),r.prototype.buffer=function(){return Ee(this,void 0,void 0,function(){var t;return Ce(this,function(e){switch(e.label){case 0:return[4,this.data()];case 1:return t=e.sent(),[2,ue.buffer(this.shape,this.dtype,t)]}})})},r.prototype.bufferSync=function(){return ue.buffer(this.shape,this.dtype,this.dataSync())},r.prototype.array=function(){return Ee(this,void 0,void 0,function(){var t;return Ce(this,function(e){switch(e.label){case 0:return[4,this.data()];case 1:return t=e.sent(),[2,L2(this.shape,t)]}})})},r.prototype.arraySync=function(){return L2(this.shape,this.dataSync())},r.prototype.data=function(){return Ee(this,void 0,void 0,function(){var t,e;return Ce(this,function(n){switch(n.label){case 0:return this.throwIfDisposed(),t=ca().read(this.dataId),this.dtype!=="string"?[3,2]:[4,t];case 1:e=n.sent();try{return[2,e.map(function(a){return qh(a)})]}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}n.label=2;case 2:return[2,t]}})})},r.prototype.dataSync=function(){this.throwIfDisposed();var t=ca().readSync(this.dataId);if(this.dtype==="string")try{return t.map(function(e){return qh(e)})}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return t},r.prototype.bytes=function(){return Ee(this,void 0,void 0,function(){var t;return Ce(this,function(e){switch(e.label){case 0:return this.throwIfDisposed(),[4,ca().read(this.dataId)];case 1:return t=e.sent(),this.dtype==="string"?[2,t]:[2,new Uint8Array(t.buffer)]}})})},r.prototype.dispose=function(){this.isDisposed||(ca().disposeTensor(this),this.isDisposedInternal=!0)},Object.defineProperty(r.prototype,"isDisposed",{get:function(){return this.isDisposedInternal},enumerable:!0,configurable:!0}),r.prototype.throwIfDisposed=function(){if(this.isDisposed)throw new Error("Tensor is disposed.")},r.prototype.toFloat=function(){return this.asType("float32")},r.prototype.toInt=function(){return this.asType("int32")},r.prototype.toBool=function(){return this.asType("bool")},r.prototype.print=function(t){return t===void 0&&(t=!1),ue.print(this,t)},r.prototype.reshape=function(t){return this.throwIfDisposed(),ue.reshape(this,t)},r.prototype.reshapeAs=function(t){return this.throwIfDisposed(),this.reshape(t.shape)},r.prototype.expandDims=function(t){return t===void 0&&(t=0),ue.expandDims(this,t)},r.prototype.cumsum=function(t,e,n){return t===void 0&&(t=0),e===void 0&&(e=!1),n===void 0&&(n=!1),ue.cumsum(this,t,e,n)},r.prototype.squeeze=function(t){return this.throwIfDisposed(),ue.squeeze(this,t)},r.prototype.clone=function(){return this.throwIfDisposed(),ue.clone(this)},r.prototype.oneHot=function(t,e,n){return this.throwIfDisposed(),ue.oneHot(this,t,e,n)},r.prototype.toString=function(t){return t===void 0&&(t=!1),W3(this.dataSync(),this.shape,this.dtype,t)},r.prototype.tile=function(t){return this.throwIfDisposed(),ue.tile(this,t)},r.prototype.gather=function(t,e){return e===void 0&&(e=0),this.throwIfDisposed(),ue.gather(this,t,e)},r.prototype.matMul=function(t,e,n){return e===void 0&&(e=!1),n===void 0&&(n=!1),this.throwIfDisposed(),ue.matMul(this,t,e,n)},r.prototype.dot=function(t){return this.throwIfDisposed(),ue.dot(this,t)},r.prototype.norm=function(t,e,n){return t===void 0&&(t="euclidean"),e===void 0&&(e=null),n===void 0&&(n=!1),this.throwIfDisposed(),ue.norm(this,t,e,n)},r.prototype.slice=function(t,e){return this.throwIfDisposed(),ue.slice(this,t,e)},r.prototype.reverse=function(t){return this.throwIfDisposed(),ue.reverse(this,t)},r.prototype.concat=function(t,e){return e===void 0&&(e=0),this.throwIfDisposed(),t instanceof r&&(t=[t]),ue.concat([this].concat(t),e)},r.prototype.split=function(t,e){return e===void 0&&(e=0),this.throwIfDisposed(),ue.split(this,t,e)},r.prototype.stack=function(t,e){return e===void 0&&(e=0),ue.stack([this,t],e)},r.prototype.unstack=function(t){return t===void 0&&(t=0),ue.unstack(this,t)},r.prototype.pad=function(t,e){return e===void 0&&(e=0),ue.pad(this,t,e)},r.prototype.batchNormalization=function(t,e,n,a,i){return n===void 0&&(n=.001),xE("tf.batchNormalization() is going away. Use tf.batchNorm() instead, and note the positional argument change of scale, offset, and varianceEpsilon"),this.batchNorm(t,e,i,a,n)},r.prototype.batchNorm=function(t,e,n,a,i){return i===void 0&&(i=.001),this.throwIfDisposed(),ue.batchNorm(this,t,e,n,a,i)},r.prototype.all=function(t,e){return t===void 0&&(t=null),e===void 0&&(e=!1),this.throwIfDisposed(),ue.all(this,t,e)},r.prototype.any=function(t,e){return t===void 0&&(t=null),e===void 0&&(e=!1),this.throwIfDisposed(),ue.any(this,t,e)},r.prototype.logSumExp=function(t,e){return t===void 0&&(t=null),e===void 0&&(e=!1),this.throwIfDisposed(),ue.logSumExp(this,t,e)},r.prototype.sum=function(t,e){return t===void 0&&(t=null),e===void 0&&(e=!1),this.throwIfDisposed(),ue.sum(this,t,e)},r.prototype.prod=function(t,e){return t===void 0&&(t=null),e===void 0&&(e=!1),this.throwIfDisposed(),ue.prod(this,t,e)},r.prototype.mean=function(t,e){return t===void 0&&(t=null),e===void 0&&(e=!1),this.throwIfDisposed(),ue.mean(this,t,e)},r.prototype.min=function(t,e){return t===void 0&&(t=null),e===void 0&&(e=!1),this.throwIfDisposed(),ue.min(this,t,e)},r.prototype.max=function(t,e){return t===void 0&&(t=null),e===void 0&&(e=!1),this.throwIfDisposed(),ue.max(this,t,e)},r.prototype.argMin=function(t){return t===void 0&&(t=null),this.throwIfDisposed(),ue.argMin(this,t)},r.prototype.argMax=function(t){return t===void 0&&(t=null),this.throwIfDisposed(),ue.argMax(this,t)},r.prototype.cast=function(t){return this.throwIfDisposed(),ue.cast(this,t)},r.prototype.add=function(t){return this.throwIfDisposed(),ue.add(this,t)},r.prototype.addStrict=function(t){return this.throwIfDisposed(),ue.addStrict(this,t)},r.prototype.atan2=function(t){return this.throwIfDisposed(),ue.atan2(this,t)},r.prototype.sub=function(t){return this.throwIfDisposed(),ue.sub(this,t)},r.prototype.subStrict=function(t){return this.throwIfDisposed(),ue.subStrict(this,t)},r.prototype.pow=function(t){return this.throwIfDisposed(),ue.pow(this,t)},r.prototype.powStrict=function(t){return this.throwIfDisposed(),ue.powStrict(this,t)},r.prototype.mul=function(t){return this.throwIfDisposed(),ue.mul(this,t)},r.prototype.mulStrict=function(t){return this.throwIfDisposed(),ue.mulStrict(this,t)},r.prototype.div=function(t){return this.throwIfDisposed(),ue.div(this,t)},r.prototype.divNoNan=function(t){return this.throwIfDisposed(),ue.divNoNan(this,t)},r.prototype.floorDiv=function(t){return this.throwIfDisposed(),ue.floorDiv(this,t)},r.prototype.divStrict=function(t){return this.throwIfDisposed(),ue.divStrict(this,t)},r.prototype.minimum=function(t){return this.throwIfDisposed(),ue.minimum(this,t)},r.prototype.minimumStrict=function(t){return this.throwIfDisposed(),ue.minimumStrict(this,t)},r.prototype.maximum=function(t){return this.throwIfDisposed(),ue.maximum(this,t)},r.prototype.maximumStrict=function(t){return this.throwIfDisposed(),ue.maximumStrict(this,t)},r.prototype.mod=function(t){return this.throwIfDisposed(),ue.mod(this,t)},r.prototype.modStrict=function(t){return this.throwIfDisposed(),ue.modStrict(this,t)},r.prototype.squaredDifferenceStrict=function(t){return this.throwIfDisposed(),ue.squaredDifferenceStrict(this,t)},r.prototype.transpose=function(t){return this.throwIfDisposed(),ue.transpose(this,t)},r.prototype.notEqual=function(t){return this.throwIfDisposed(),ue.notEqual(this,t)},r.prototype.notEqualStrict=function(t){return this.throwIfDisposed(),ue.notEqualStrict(this,t)},r.prototype.less=function(t){return this.throwIfDisposed(),ue.less(this,t)},r.prototype.lessStrict=function(t){return this.throwIfDisposed(),ue.lessStrict(this,t)},r.prototype.equal=function(t){return this.throwIfDisposed(),ue.equal(this,t)},r.prototype.equalStrict=function(t){return this.throwIfDisposed(),ue.equalStrict(this,t)},r.prototype.lessEqual=function(t){return this.throwIfDisposed(),ue.lessEqual(this,t)},r.prototype.lessEqualStrict=function(t){return this.throwIfDisposed(),ue.lessEqualStrict(this,t)},r.prototype.greater=function(t){return this.throwIfDisposed(),ue.greater(this,t)},r.prototype.greaterStrict=function(t){return this.throwIfDisposed(),ue.greaterStrict(this,t)},r.prototype.greaterEqual=function(t){return this.throwIfDisposed(),ue.greaterEqual(this,t)},r.prototype.greaterEqualStrict=function(t){return this.throwIfDisposed(),ue.greaterEqualStrict(this,t)},r.prototype.logicalAnd=function(t){return this.throwIfDisposed(),ue.logicalAnd(this,t)},r.prototype.logicalOr=function(t){return this.throwIfDisposed(),ue.logicalOr(this,t)},r.prototype.logicalNot=function(){return this.throwIfDisposed(),ue.logicalNot(this)},r.prototype.logicalXor=function(t){return this.throwIfDisposed(),ue.logicalXor(this,t)},r.prototype.where=function(t,e){return this.throwIfDisposed(),ue.where(t,this,e)},r.prototype.neg=function(){return this.throwIfDisposed(),ue.neg(this)},r.prototype.ceil=function(){return this.throwIfDisposed(),ue.ceil(this)},r.prototype.floor=function(){return this.throwIfDisposed(),ue.floor(this)},r.prototype.sign=function(){return this.throwIfDisposed(),ue.sign(this)},r.prototype.isNaN=function(){return this.throwIfDisposed(),ue.isNaN(this)},r.prototype.isInf=function(){return this.throwIfDisposed(),ue.isInf(this)},r.prototype.isFinite=function(){return this.throwIfDisposed(),ue.isFinite(this)},r.prototype.exp=function(){return this.throwIfDisposed(),ue.exp(this)},r.prototype.expm1=function(){return this.throwIfDisposed(),ue.expm1(this)},r.prototype.log=function(){return this.throwIfDisposed(),ue.log(this)},r.prototype.log1p=function(){return this.throwIfDisposed(),ue.log1p(this)},r.prototype.sqrt=function(){return this.throwIfDisposed(),ue.sqrt(this)},r.prototype.rsqrt=function(){return this.throwIfDisposed(),ue.rsqrt(this)},r.prototype.square=function(){return this.throwIfDisposed(),ue.square(this)},r.prototype.reciprocal=function(){return this.throwIfDisposed(),ue.reciprocal(this)},r.prototype.abs=function(){return this.throwIfDisposed(),ue.abs(this)},r.prototype.clipByValue=function(t,e){return this.throwIfDisposed(),ue.clipByValue(this,t,e)},r.prototype.relu=function(){return this.throwIfDisposed(),ue.relu(this)},r.prototype.relu6=function(){return this.throwIfDisposed(),ue.relu6(this)},r.prototype.elu=function(){return this.throwIfDisposed(),ue.elu(this)},r.prototype.selu=function(){return this.throwIfDisposed(),ue.selu(this)},r.prototype.leakyRelu=function(t){return t===void 0&&(t=.2),this.throwIfDisposed(),ue.leakyRelu(this,t)},r.prototype.prelu=function(t){return this.throwIfDisposed(),ue.prelu(this,t)},r.prototype.sigmoid=function(){return this.throwIfDisposed(),ue.sigmoid(this)},r.prototype.logSigmoid=function(){return this.throwIfDisposed(),ue.logSigmoid(this)},r.prototype.softplus=function(){return this.throwIfDisposed(),ue.softplus(this)},r.prototype.zerosLike=function(){return this.throwIfDisposed(),ue.zerosLike(this)},r.prototype.onesLike=function(){return this.throwIfDisposed(),ue.onesLike(this)},r.prototype.sin=function(){return this.throwIfDisposed(),ue.sin(this)},r.prototype.cos=function(){return this.throwIfDisposed(),ue.cos(this)},r.prototype.tan=function(){return this.throwIfDisposed(),ue.tan(this)},r.prototype.asin=function(){return this.throwIfDisposed(),ue.asin(this)},r.prototype.acos=function(){return this.throwIfDisposed(),ue.acos(this)},r.prototype.atan=function(){return this.throwIfDisposed(),ue.atan(this)},r.prototype.sinh=function(){return this.throwIfDisposed(),ue.sinh(this)},r.prototype.cosh=function(){return this.throwIfDisposed(),ue.cosh(this)},r.prototype.tanh=function(){return this.throwIfDisposed(),ue.tanh(this)},r.prototype.asinh=function(){return this.throwIfDisposed(),ue.asinh(this)},r.prototype.acosh=function(){return this.throwIfDisposed(),ue.acosh(this)},r.prototype.atanh=function(){return this.throwIfDisposed(),ue.atanh(this)},r.prototype.erf=function(){return this.throwIfDisposed(),ue.erf(this)},r.prototype.round=function(){return this.throwIfDisposed(),ue.round(this)},r.prototype.step=function(t){return t===void 0&&(t=0),this.throwIfDisposed(),ue.step(this,t)},r.prototype.softmax=function(t){return t===void 0&&(t=-1),this.throwIfDisposed(),ue.softmax(this,t)},r.prototype.logSoftmax=function(t){return t===void 0&&(t=-1),this.throwIfDisposed(),ue.logSoftmax(this,t)},r.prototype.resizeBilinear=function(t,e){return e===void 0&&(e=!1),this.throwIfDisposed(),ue.image.resizeBilinear(this,t,e)},r.prototype.resizeNearestNeighbor=function(t,e){return e===void 0&&(e=!1),this.throwIfDisposed(),ue.image.resizeNearestNeighbor(this,t,e)},r.prototype.conv1d=function(t,e,n,a,i,s){return a===void 0&&(a="NWC"),i===void 0&&(i=1),this.throwIfDisposed(),ue.conv1d(this,t,e,n,a,i,s)},r.prototype.conv2d=function(t,e,n,a,i,s){return a===void 0&&(a="NHWC"),i===void 0&&(i=[1,1]),this.throwIfDisposed(),ue.conv2d(this,t,e,n,a,i,s)},r.prototype.conv2dTranspose=function(t,e,n,a,i){return this.throwIfDisposed(),ue.conv2dTranspose(this,t,e,n,a,i)},r.prototype.depthwiseConv2D=function(t,e,n,a,i,s){return a===void 0&&(a="NHWC"),i===void 0&&(i=[1,1]),this.throwIfDisposed(),ue.depthwiseConv2d(this,t,e,n,a,i,s)},r.prototype.separableConv2d=function(t,e,n,a,i,s){return i===void 0&&(i=[1,1]),s===void 0&&(s="NHWC"),this.throwIfDisposed(),ue.separableConv2d(this,t,e,n,a,i,s)},r.prototype.avgPool=function(t,e,n,a){return this.throwIfDisposed(),ue.avgPool(this,t,e,n,a)},r.prototype.maxPool=function(t,e,n,a){return this.throwIfDisposed(),ue.maxPool(this,t,e,n,a)},r.prototype.localResponseNormalization=function(t,e,n,a){return t===void 0&&(t=5),e===void 0&&(e=1),n===void 0&&(n=1),a===void 0&&(a=.5),ue.localResponseNormalization(this,t,e,n,a)},r.prototype.pool=function(t,e,n,a,i){return this.throwIfDisposed(),ue.pool(this,t,e,n,a,i)},r.prototype.variable=function(t,e,n){return t===void 0&&(t=!0),this.throwIfDisposed(),ca().makeVariable(this,t,e,n)},r.prototype.unsortedSegmentSum=function(t,e){return this.throwIfDisposed(),ue.unsortedSegmentSum(this,t,e)},r.prototype.batchToSpaceND=function(t,e){return this.throwIfDisposed(),ue.batchToSpaceND(this,t,e)},r.prototype.spaceToBatchND=function(t,e){return this.throwIfDisposed(),ue.spaceToBatchND(this,t,e)},r.prototype.topk=function(t,e){return t===void 0&&(t=1),e===void 0&&(e=!0),this.throwIfDisposed(),ue.topk(this,t,e)},r.prototype.stridedSlice=function(t,e,n,a,i,s,l,c){return a===void 0&&(a=0),i===void 0&&(i=0),s===void 0&&(s=0),l===void 0&&(l=0),c===void 0&&(c=0),this.throwIfDisposed(),ue.stridedSlice(this,t,e,n,a,i,s,l,c)},r.prototype.depthToSpace=function(t,e){return this.throwIfDisposed(),ue.depthToSpace(this,t,e)},r.prototype.fft=function(){return this.throwIfDisposed(),ue.spectral.fft(this)},r.prototype.ifft=function(){return this.throwIfDisposed(),ue.spectral.ifft(this)},r.prototype.rfft=function(){return this.throwIfDisposed(),ue.spectral.rfft(this)},r.prototype.irfft=function(){return this.throwIfDisposed(),ue.spectral.irfft(this)},r}();Object.defineProperty(Nt,Symbol.hasInstance,{value:function(r){return!!r&&r.dataId!=null&&r.shape!=null&&r.dtype!=null}});var U2,Ng,Mg,Ig,Fg,Iu=function(r){function t(e,n,a,i){var s=r.call(this,e.shape,e.dtype,e.dataId,i)||this;return s.trainable=n,s.name=a,s}return Xr(t,r),t.prototype.assign=function(e){if(e.dtype!==this.dtype)throw new Error("dtype of the new value ("+e.dtype+") and previous value ("+this.dtype+") must match");if(!vn(e.shape,this.shape))throw new Error("shape of the new value ("+e.shape+") and previous value ("+this.shape+") must match");ca().disposeTensor(this),this.dataId=e.dataId,ca().incRef(this,null)},t.prototype.dispose=function(){ca().disposeVariable(this),this.isDisposedInternal=!0},t}(Nt);Object.defineProperty(Iu,Symbol.hasInstance,{value:function(r){return r instanceof Nt&&r.assign!=null&&r.assign instanceof Function}}),function(r){r.R0="R0",r.R1="R1",r.R2="R2",r.R3="R3",r.R4="R4",r.R5="R5",r.R6="R6"}(U2||(U2={})),function(r){r.float32="float32",r.int32="int32",r.bool="int32",r.complex64="complex64"}(Ng||(Ng={})),function(r){r.float32="float32",r.int32="int32",r.bool="bool",r.complex64="complex64"}(Mg||(Mg={})),function(r){r.float32="float32",r.int32="float32",r.bool="float32",r.complex64="complex64"}(Ig||(Ig={})),function(r){r.float32="complex64",r.int32="complex64",r.bool="complex64",r.complex64="complex64"}(Fg||(Fg={}));var G3={float32:Ig,int32:Ng,bool:Mg,complex64:Fg};function _n(r,t){if(r==="string"||t==="string"){if(r==="string"&&t==="string")return"string";throw new Error("Can not upcast "+r+" with "+t)}return G3[r][t]}function xm(r){return _n(r,"int32")}function Ft(r,t){if(r.dtype===t.dtype)return[r,t];var e=_n(r.dtype,t.dtype);return[r.cast(e),t.cast(e)]}function q3(r,t){L(r.dtype===t.dtype,function(){return"The dtypes of the first("+r.dtype+") and second("+t.dtype+") input must match"})}function wE(r){var t=[];return function e(n,a,i){if(n!=null){if(n instanceof Nt)return void a.push(n);if(s=n,!(!Array.isArray(s)&&typeof s!="object")){var s,l=n;for(var c in l){var f=l[c];i.has(f)||(i.add(f),e(f,a,i))}}}}(r,t,new Set),t}var wm,V2=function(){function r(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null}}return r.prototype.dispose=function(){for(var t in this.registeredVariables)this.registeredVariables[t].dispose()},r}(),K3=function(){function r(t){this.ENV=t,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new V2}return r.prototype.ready=function(){return Ee(this,void 0,void 0,function(){var t,e,n;return Ce(this,function(a){switch(a.label){case 0:if(this.pendingBackendInit!=null)return[2,this.pendingBackendInit.then(function(){})];if(this.backendInstance!=null)return[2];t=this.getSortedBackends(),e=0,a.label=1;case 1:return e<t.length?(n=t[e],[4,this.initializeBackend(n).success]):[3,5];case 2:return a.sent()?[4,this.setBackend(n)]:[3,4];case 3:return a.sent(),[2];case 4:return e++,[3,1];case 5:throw new Error("Could not initialize any backends, all backend initializations failed.")}})})},Object.defineProperty(r.prototype,"backend",{get:function(){if(this.pendingBackendInit!=null)throw new Error("Backend '"+this.backendName+"' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods");if(this.backendInstance==null){var t=this.initializeBackendsAndReturnBest(),e=t.name;if(t.asyncInit)throw new Error("The highest priority backend '"+e+"' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods");this.setBackend(e)}return this.backendInstance},enumerable:!0,configurable:!0}),r.prototype.backendNames=function(){return Object.keys(this.registryFactory)},r.prototype.findBackend=function(t){return!(t in this.registry)&&(!(t in this.registryFactory)||this.initializeBackend(t).asyncInit)?null:this.registry[t]},r.prototype.findBackendFactory=function(t){return t in this.registryFactory?this.registryFactory[t].factory:null},r.prototype.registerBackend=function(t,e,n){return n===void 0&&(n=1),t in this.registryFactory?(console.warn(t+" backend was already registered. Reusing existing backend factory."),!1):(this.registryFactory[t]={factory:e,priority:n},!0)},r.prototype.setBackend=function(t){return Ee(this,void 0,void 0,function(){var e,n,a;return Ce(this,function(i){switch(i.label){case 0:if(this.registryFactory[t]==null)throw new Error("Backend name '"+t+"' not found in registry");return this.backendName=t,this.registry[t]!=null?[3,4]:(this.backendInstance=null,e=this.initializeBackend(t),n=e.success,e.asyncInit?[4,n]:[3,2]);case 1:return a=i.sent(),[3,3];case 2:a=n,i.label=3;case 3:if(!a)return[2,!1];i.label=4;case 4:return this.backendInstance=this.registry[t],this.setupRegisteredKernels(),this.profiler=new H3(this.backendInstance),[2,!0]}})})},r.prototype.setupRegisteredKernels=function(){var t=this;F2(this.backendName).forEach(function(e){e.setupFunc!=null&&e.setupFunc(t.backendInstance)})},r.prototype.disposeRegisteredKernels=function(t){var e=this;F2(t).forEach(function(n){n.disposeFunc!=null&&n.disposeFunc(e.registry[t])})},r.prototype.initializeBackend=function(t){var e=this,n=this.registryFactory[t];if(n==null)throw new Error("Cannot initialize backend "+t+", no registration found.");try{var a=n.factory();if(Promise.resolve(a)===a){var i=++this.pendingBackendInitId,s=a.then(function(l){return!(i<e.pendingBackendInitId)&&(e.registry[t]=l,e.pendingBackendInit=null,!0)}).catch(function(l){return!(i<e.pendingBackendInitId)&&(e.pendingBackendInit=null,console.warn("Initialization of backend "+t+" failed"),console.warn(l.stack||l.message),!1)});return this.pendingBackendInit=s,{success:s,asyncInit:!0}}return this.registry[t]=a,{success:!0,asyncInit:!1}}catch(l){return console.warn("Initialization of backend "+t+" failed"),console.warn(l.stack||l.message),{success:!1,asyncInit:!1}}},r.prototype.removeBackend=function(t){if(!(t in this.registryFactory))throw new Error(t+" backend not found in registry");this.backendName===t&&this.pendingBackendInit!=null&&this.pendingBackendInitId++,t in this.registry&&(this.disposeRegisteredKernels(t),this.registry[t].dispose(),delete this.registry[t]),delete this.registryFactory[t],this.backendName===t&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)},r.prototype.getSortedBackends=function(){var t=this;if(Object.keys(this.registryFactory).length===0)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort(function(e,n){return t.registryFactory[n].priority-t.registryFactory[e].priority})},r.prototype.initializeBackendsAndReturnBest=function(){for(var t=this.getSortedBackends(),e=0;e<t.length;e++){var n=t[e],a=this.initializeBackend(n),i=a.success,s=a.asyncInit;if(s||i)return{name:n,asyncInit:s}}throw new Error("Could not initialize any backends, all backend initializations failed.")},r.prototype.moveData=function(t,e){var n=this.state.tensorInfo.get(e),a=n.backend,i=this.readSync(e);a.disposeData(e),n.backend=t,t.move(e,i,n.shape,n.dtype),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++},r.prototype.tidy=function(t,e){var n,a=this,i=null;if(e==null){if(typeof t!="function")throw new Error("Please provide a function to tidy()");e=t}else{if(typeof t!="string"&&!(t instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if(typeof e!="function")throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");i=t}return this.scopedRun(function(){return a.startScope(i)},function(){return a.endScope(n)},function(){return(n=e())instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),n})},r.prototype.scopedRun=function(t,e,n){t();try{var a=n();return e(),a}catch(i){throw e(),i}},r.prototype.nextTensorId=function(){return r.nextTensorId++},r.prototype.nextVariableId=function(){return r.nextVariableId++},r.prototype.clone=function(t){var e=this.makeTensorFromDataId(t.dataId,t.shape,t.dtype),n={x:t};return this.addTapeNode(this.state.activeScope.name,n,[e],function(a){return{x:function(){return a.toFloat()}}},[]),e},r.prototype.runKernel=function(t,e,n,a,i){return this.runKernelFunc(null,e,null,t,n,a,i)},r.prototype.shouldCheckForMemLeaks=function(){return this.ENV.getBool("IS_TEST")},r.prototype.checkKernelForMemLeak=function(t,e,n){var a=this.backend.numDataIds(),i=0;n.forEach(function(c){i+=c.dtype==="complex64"?3:1});var s=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],l=a-e-i-s;if(l>0)throw new Error("Backend '"+this.backendName+"' has an internal memory leak ("+l+" data ids) after running '"+t+"'")},r.prototype.runKernelFunc=function(t,e,n,a,i,s,l){var c,f=this;s===void 0&&(s=[]),l===void 0&&(l=[]);var d=[],v=this.isTapeOn();a==null&&(a=this.state.activeScope!=null?this.state.activeScope.name:"");var m,g=function(E){v&&(d=E.map(function(C){return f.keep(f.clone(C))}))},b=this.state.numBytes,w=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0);var _,S=fE(a,this.backendName);return m=S!=null?function(){var E=f.backend.numDataIds();_=S.kernelFunc({inputs:e,attrs:i,backend:f.backend});var C=Array.isArray(_)?_:[_];f.shouldCheckForMemLeaks()&&f.checkKernelForMemLeak(a,E,C);var R=C.map(function(D){var k=D.dataId,I=D.shape,O=D.dtype;return f.makeTensorFromDataId(k,I,O)}),A=R.filter(function(D,k){return l[k]});return g((s||[]).slice().concat(A)),R}:function(){var E=f.backend.numDataIds();_=f.tidy(function(){return t(f.backend,g)});var C=Array.isArray(_)?_:[_];return f.shouldCheckForMemLeaks()&&f.checkKernelForMemLeak(a,E,C),C},this.scopedRun(function(){return f.state.kernelDepth++},function(){return f.state.kernelDepth--},function(){c=f.ENV.getBool("DEBUG")?f.profiler.profileKernel(a,e,function(){return m()}):m()}),v&&this.addTapeNode(a,e,c,n,d),this.state.profiling&&this.state.activeProfile.kernels.push({name:a,bytesAdded:this.state.numBytes-b,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-w,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(e).map(function(E){return e[E].shape}),outputShapes:c.map(function(E){return E.shape})}),Array.isArray(_)?c:c[0]},r.prototype.makeTensor=function(t,e,n,a){if(t==null)throw new Error("Values passed to engine.makeTensor() are null");n=n||"float32",a=a||this.backend;var i=t;n==="string"&&py(t[0])&&(i=t.map(function(d){return U3(d)}));var s=a.write(i,e,n),l=new Nt(e,n,s,this.nextTensorId());if(this.incRef(l,a),n==="string"){var c=this.state.tensorInfo.get(s),f=L3(i);this.state.numBytes+=f-c.bytes,c.bytes=f}return l},r.prototype.makeTensorFromDataId=function(t,e,n,a){var i=new Nt(e,n=n||"float32",t,this.nextTensorId());return this.incRef(i,a),i},r.prototype.makeVariable=function(t,e,n,a){e===void 0&&(e=!0),n=n||this.nextVariableId().toString(),a!=null&&a!==t.dtype&&(t=t.asType(a));var i=new Iu(t,e,n,this.nextTensorId());if(this.state.registeredVariables[i.name]!=null)throw new Error("Variable with name "+i.name+" was already registered");return this.state.registeredVariables[i.name]=i,this.incRef(i,this.backend),i},r.prototype.incRef=function(t,e){var n=this.state.tensorInfo.has(t.dataId)?this.state.tensorInfo.get(t.dataId).refCount:0;if(this.state.numTensors++,t.dtype==="string"&&this.state.numStringTensors++,n===0){this.state.numDataBuffers++;var a=0;t.dtype!=="complex64"&&t.dtype!=="string"&&(a=t.size*vE(t.dtype)),this.state.tensorInfo.set(t.dataId,{backend:e||this.backend,dtype:t.dtype,shape:t.shape,bytes:a,refCount:0}),this.state.numBytes+=a}this.state.tensorInfo.get(t.dataId).refCount++,t instanceof Iu||this.track(t)},r.prototype.disposeTensor=function(t){if(this.state.tensorInfo.has(t.dataId)){this.state.numTensors--,t.dtype==="string"&&this.state.numStringTensors--;var e=this.state.tensorInfo.get(t.dataId);e.refCount<=1?(t.dtype!=="complex64"&&(this.state.numBytes-=e.bytes),this.state.numDataBuffers--,e.backend.disposeData(t.dataId),this.state.tensorInfo.delete(t.dataId)):this.state.tensorInfo.get(t.dataId).refCount--}},r.prototype.disposeVariables=function(){for(var t in this.state.registeredVariables){var e=this.state.registeredVariables[t];this.disposeVariable(e)}},r.prototype.disposeVariable=function(t){this.disposeTensor(t),this.state.registeredVariables[t.name]!=null&&delete this.state.registeredVariables[t.name]},r.prototype.memory=function(){var t=this.backend.memory();return t.numTensors=this.state.numTensors,t.numDataBuffers=this.state.numDataBuffers,t.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(t.unreliable=!0,t.reasons==null&&(t.reasons=[]),t.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),t},r.prototype.profile=function(t){return Ee(this,void 0,void 0,function(){var e,n;return Ce(this,function(a){return this.state.profiling=!0,e=this.state.numBytes,n=this.state.numTensors,this.state.activeProfile.kernels=[],this.state.activeProfile.result=t(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max.apply(Math,this.state.activeProfile.kernels.map(function(i){return i.totalBytesSnapshot})),this.state.activeProfile.newBytes=this.state.numBytes-e,this.state.activeProfile.newTensors=this.state.numTensors-n,[2,this.state.activeProfile]})})},r.prototype.isTapeOn=function(){return this.state.gradientDepth>0&&this.state.kernelDepth===0},r.prototype.addTapeNode=function(t,e,n,a,i){var s=this,l={id:this.state.nextTapeNodeId++,kernelName:t,inputs:e,outputs:n,saved:i},c=D3(t);c!=null&&(a=c.gradFunc),a!=null&&(l.gradient=function(f){return f=f.map(function(d,v){if(d==null){var m=n[v],g=Dc(m.size,m.dtype);return s.makeTensor(g,m.shape,m.dtype)}return d}),a(f.length>1?f:f[0],i)}),this.state.activeTape.push(l)},r.prototype.keep=function(t){return t.kept=!0,t},r.prototype.startTape=function(){this.state.gradientDepth===0&&(this.state.activeTape=[]),this.state.gradientDepth++},r.prototype.endTape=function(){this.state.gradientDepth--},r.prototype.startScope=function(t){var e={track:[],name:"unnamed scope",id:this.state.nextScopeId++};t&&(e.name=t),this.state.scopeStack.push(e),this.state.activeScope=e},r.prototype.endScope=function(t){for(var e=this,n=wE(t),a=new Set(n.map(function(c){return c.id})),i=0;i<this.state.activeScope.track.length;i++){var s=this.state.activeScope.track[i];s.kept||a.has(s.id)||s.dispose()}var l=this.state.scopeStack.pop();this.state.activeScope=this.state.scopeStack.length===0?null:this.state.scopeStack[this.state.scopeStack.length-1],n.forEach(function(c){c.kept||c.scopeId!==l.id||e.track(c)})},r.prototype.gradients=function(t,e,n,a){var i=this;if(a===void 0&&(a=!1),L(e.length>0,function(){return"gradients() received an empty list of xs."}),n!=null&&n.dtype!=="float32")throw new Error("dy must have 'float32' dtype, but has '"+n.dtype+"'");var s=this.scopedRun(function(){return i.startTape()},function(){return i.endTape()},function(){return i.tidy("forward",t)});L(s instanceof Nt,function(){return"The result y returned by f() must be a tensor."});var l=function(c,f,d){for(var v={},m={},g=0;g<f.length;g++)v[f[g].id]=!0;for(g=0;g<c.length;g++){var b=(D=c[g]).inputs;for(var w in b){for(var _=b[w],S=!1,E=0;E<f.length;E++)if(v[_.id]){D.outputs.forEach(function(M){return v[M.id]=!0}),S=!0,m[D.id]=!0;break}if(S)break}}var C={};C[d.id]=!0;var R={};for(g=c.length-1;g>=0;g--)for(b=(D=c[g]).inputs,E=0;E<D.outputs.length;E++)if(C[D.outputs[E].id]){for(var w in b)C[b[w].id]=!0,R[D.id]=!0;break}var A=[];for(g=0;g<c.length;g++){var D;if(m[(D=c[g]).id]&&R[D.id]){var k={};for(var w in D.inputs){var I=D.inputs[w];v[I.id]&&(k[w]=I)}var O=Object.assign({},D);O.inputs=k,O.outputs=D.outputs,A.push(O)}}return A}(this.state.activeTape,e,s);if(!a&&l.length===0&&e.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",function(){var c,f,d={};d[s.id]=n??(c=s.shape,f=gE(Ae(c),"float32"),K.makeTensor(f,c,"float32")),function(m,g,b){for(var w=function(S){var E=g[S],C=[];if(E.outputs.forEach(function(k){var I=m[k.id];I!=null?C.push(I):C.push(null)}),E.gradient==null)throw new Error("Cannot compute gradient: gradient function not found for "+E.kernelName+".");var R=E.gradient(C),A=function(k){if(!(k in R))throw new Error("Cannot backprop through input "+k+". Available gradients found: "+Object.keys(R)+".");var I=b(function(){return R[k]()});if(I.dtype!=="float32")throw new Error("Error in gradient for op "+E.kernelName+". The gradient of input "+k+" must have 'float32' dtype, but has '"+I.dtype+"'");var O=E.inputs[k];if(!vn(I.shape,O.shape))throw new Error("Error in gradient for op "+E.kernelName+". The gradient of input '"+k+"' has shape '"+I.shape+"', which does not match the shape of the input '"+O.shape+"'");if(m[O.id]==null)m[O.id]=I;else{var M=m[O.id];m[O.id]=M.add(I),M.dispose()}};for(var D in E.inputs)A(D)},_=g.length-1;_>=0;_--)w(_)}(d,l,function(m){return i.tidy(m)});var v=e.map(function(m){return d[m.id]});return i.state.gradientDepth===0&&(i.state.activeTape.forEach(function(m){for(var g=0,b=m.saved;g<b.length;g++)b[g].dispose()}),i.state.activeTape=null),{value:s,grads:v}})},r.prototype.customGrad=function(t){var e=this;return L(kg(t),function(){return"The f passed in customGrad(f) must be a function."}),function(){for(var n,a=[],i=0;i<arguments.length;i++)a[i]=arguments[i];L(a.every(function(l){return l instanceof Nt}),function(){return"The args passed in customGrad(f)(x1, x2,...) must all be tensors"});var s={};return a.forEach(function(l,c){s[c]=l}),e.runKernelFunc(function(l,c){return L((n=t.apply(void 0,a.concat([c]))).value instanceof Nt,function(){return"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"}),L(kg(n.gradFunc),function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."}),n.value},s,function(l,c){var f=n.gradFunc(l,c),d=Array.isArray(f)?f:[f];L(d.length===a.length,function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."}),L(d.every(function(m){return m instanceof Nt}),function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors."});var v={};return d.forEach(function(m,g){v[g]=function(){return m}}),v})}},r.prototype.readSync=function(t){return this.state.tensorInfo.get(t).backend.readSync(t)},r.prototype.read=function(t){return this.state.tensorInfo.get(t).backend.read(t)},r.prototype.time=function(t){return Ee(this,void 0,void 0,function(){var e,n;return Ce(this,function(a){switch(a.label){case 0:return e=la(),[4,this.backend.time(t)];case 1:return(n=a.sent()).wallMs=la()-e,[2,n]}})})},r.prototype.track=function(t){return this.state.activeScope!=null&&(t.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(t)),t},Object.defineProperty(r.prototype,"registeredVariables",{get:function(){return this.state.registeredVariables},enumerable:!0,configurable:!0}),r.prototype.reset=function(){for(var t in this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new V2,this.registry)this.disposeRegisteredKernels(t),this.registry[t].dispose(),delete this.registry[t];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null},r.nextTensorId=0,r.nextVariableId=0,r}(),K=function(){var r=function(){if(wm==null){var e=void 0;if(typeof window<"u")e=window;else if(typeof global<"u")e=global;else if(typeof process<"u")e=process;else{if(typeof self>"u")throw new Error("Could not find a global object");e=self}wm=e}return wm}();if(r._tfengine==null){var t=new A3(r);r._tfengine=new K3(t)}return function(e){cE=e}(r._tfengine.ENV),ca=function(){return r._tfengine},r._tfengine}();function _E(){return typeof window<"u"&&window.document!=null||typeof WorkerGlobalScope<"u"}var Va=le();Va.registerFlag("DEBUG",function(){return!1},function(r){r&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")}),Va.registerFlag("IS_BROWSER",function(){return _E()}),Va.registerFlag("IS_NODE",function(){return typeof process<"u"&&process.versions!==void 0&&process.versions.node!==void 0}),Va.registerFlag("IS_CHROME",function(){return typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)}),Va.registerFlag("PROD",function(){return!1}),Va.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",function(){return Va.getBool("DEBUG")}),Va.registerFlag("DEPRECATION_WARNINGS_ENABLED",function(){return!0}),Va.registerFlag("IS_TEST",function(){return!1});var dc,cr,lr,ko={},_m={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function X3(r,t){ko[r]=t}function wa(r){r in ko||(ko[r]=function(e){if(e!==1&&e!==2)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");var n=function(a){if(typeof OffscreenCanvas<"u"&&a===2)return new OffscreenCanvas(300,150);if(typeof document<"u")return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}(e);return n.addEventListener("webglcontextlost",function(a){a.preventDefault(),delete ko[e]},!1),e===1?n.getContext("webgl",_m)||n.getContext("experimental-webgl",_m):n.getContext("webgl2",_m)}(r));var t=ko[r];return t.isContextLost()?(delete ko[r],wa(r)):(t.disable(t.DEPTH_TEST),t.disable(t.STENCIL_TEST),t.disable(t.BLEND),t.disable(t.DITHER),t.disable(t.POLYGON_OFFSET_FILL),t.disable(t.SAMPLE_COVERAGE),t.enable(t.SCISSOR_TEST),t.enable(t.CULL_FACE),t.cullFace(t.BACK),ko[r])}function wd(r,t){return[t,r]}function ec(r){var t=Ae(r);return Dg(Math.ceil(t/4))}function kc(r,t){return[Math.max(1,Math.ceil(t/2)),Math.max(1,Math.ceil(r/2))]}function vy(r,t){var e,n,a,i,s,l,c,f,d,v=r;return le().getNumber("WEBGL_VERSION")===2?(e=v.R32F,n=v.R16F,a=v.RGBA16F,i=v.RGBA32F,s=v.RED,l=4,c=1,f=v.HALF_FLOAT,d=v.FLOAT):(e=r.RGBA,n=r.RGBA,a=r.RGBA,i=v.RGBA,s=r.RGBA,l=4,c=4,f=t!=null?t.HALF_FLOAT_OES:null,d=r.FLOAT),{internalFormatFloat:e,internalFormatHalfFloat:n,internalFormatPackedHalfFloat:a,internalFormatPackedFloat:i,textureFormatFloat:s,downloadTextureFormat:r.RGBA,downloadUnpackNumChannels:l,defaultNumChannels:c,textureTypeHalfFloat:f,textureTypeFloat:d}}function De(r,t,e){var n=e();return t&&function(a){var i=a.getError();if(i!==a.NO_ERROR)throw new Error("WebGL Error: "+Z3(a,i))}(r),n}(function(r){r[r.DENSE=0]="DENSE",r[r.SHARED_BATCH=1]="SHARED_BATCH"})(dc||(dc={})),function(r){r[r.RENDER=0]="RENDER",r[r.UPLOAD=1]="UPLOAD",r[r.PIXELS=2]="PIXELS",r[r.DOWNLOAD=3]="DOWNLOAD"}(cr||(cr={})),function(r){r[r.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",r[r.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",r[r.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",r[r.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",r[r.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"}(lr||(lr={}));var $3=596e-10,Y3=65504;function Q3(r){return!!(le().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||r===0||$3<Math.abs(r)&&Math.abs(r)<Y3)}function Z3(r,t){switch(t){case r.NO_ERROR:return"NO_ERROR";case r.INVALID_ENUM:return"INVALID_ENUM";case r.INVALID_VALUE:return"INVALID_VALUE";case r.INVALID_OPERATION:return"INVALID_OPERATION";case r.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case r.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case r.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return"Unknown error code "+t}}function ah(r,t,e){return ei(r,t,function(){return r.getExtension(e)},'Extension "'+e+'" not supported on this browser.')}function J3(r,t,e){var n=ei(r,t,function(){return r.createShader(r.VERTEX_SHADER)},"Unable to create vertex WebGLShader.");if(De(r,t,function(){return r.shaderSource(n,e)}),De(r,t,function(){return r.compileShader(n)}),r.getShaderParameter(n,r.COMPILE_STATUS)===!1)throw console.log(r.getShaderInfoLog(n)),new Error("Failed to compile vertex shader.");return n}function e4(r,t,e){var n=ei(r,t,function(){return r.createShader(r.FRAGMENT_SHADER)},"Unable to create fragment WebGLShader.");if(De(r,t,function(){return r.shaderSource(n,e)}),De(r,t,function(){return r.compileShader(n)}),r.getShaderParameter(n,r.COMPILE_STATUS)===!1)throw function(a,i){var s=t4.exec(i);if(s==null)return console.log("Couldn't parse line number in error: "+i),void console.log(a);for(var l=+s[1],c=a.split(`
`),f=c.length.toString().length+2,d=c.map(function(_,S){return ru((S+1).toString(),f)+_}),v=0,m=0;m<d.length;m++)v=Math.max(d[m].length,v);var g=d.slice(0,l-1),b=d.slice(l-1,l),w=d.slice(l);console.log(g.join(`
`)),console.log(i.split(`
`)[0]),console.log("%c "+ru(b[0],v),"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(w.join(`
`))}(e,r.getShaderInfoLog(n)),new Error("Failed to compile fragment shader.");return n}var Sm,Em,t4=/ERROR: [0-9]+:([0-9]+):/g;function n4(r,t){return ei(r,t,function(){return r.createProgram()},"Unable to create WebGLProgram.")}function r4(r,t,e){if(De(r,t,function(){return r.linkProgram(e)}),r.getProgramParameter(e,r.LINK_STATUS)===!1)throw console.log(r.getProgramInfoLog(e)),new Error("Failed to link vertex and fragment shaders.")}function Cm(r,t,e){if(De(r,t,function(){return r.validateProgram(e)}),r.getProgramParameter(e,r.VALIDATE_STATUS)===!1)throw console.log(r.getProgramInfoLog(e)),new Error("Shader program validation failed.")}function a4(r,t,e){var n=ei(r,t,function(){return r.createBuffer()},"Unable to create WebGLBuffer");return De(r,t,function(){return r.bindBuffer(r.ARRAY_BUFFER,n)}),De(r,t,function(){return r.bufferData(r.ARRAY_BUFFER,e,r.STATIC_DRAW)}),n}function i4(r,t,e){var n=ei(r,t,function(){return r.createBuffer()},"Unable to create WebGLBuffer");return De(r,t,function(){return r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,n)}),De(r,t,function(){return r.bufferData(r.ELEMENT_ARRAY_BUFFER,e,r.STATIC_DRAW)}),n}function o4(r,t){return ei(r,t,function(){return r.createTexture()},"Unable to create WebGLTexture.")}function s4(r,t){var e=le().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(r<=0||t<=0){var n="["+r+"x"+t+"]";throw new Error("Requested texture size "+n+" is invalid.")}if(r>e||t>e)throw n="["+r+"x"+t+"]",new Error("Requested texture size "+n+" greater than WebGL maximum on this browser / GPU "+("["+e+"x"+e+"]")+".")}function u4(r,t){return ei(r,t,function(){return r.createFramebuffer()},"Unable to create WebGLFramebuffer.")}function H2(r,t,e,n,a,i,s,l){var c=r.getAttribLocation(e,n);return c!==-1&&(De(r,t,function(){return r.bindBuffer(r.ARRAY_BUFFER,a)}),De(r,t,function(){return r.vertexAttribPointer(c,i,r.FLOAT,!1,s,l)}),De(r,t,function(){return r.enableVertexAttribArray(c)}),!0)}function l4(r,t,e,n){p4(r,n),De(r,t,function(){return r.activeTexture(r.TEXTURE0+n)}),De(r,t,function(){return r.bindTexture(r.TEXTURE_2D,e)})}function c4(r,t,e,n){return ei(r,t,function(){return r.getUniformLocation(e,n)},'uniform "'+n+'" not present in program.')}function f4(r,t,e){return r.getUniformLocation(t,e)}function h4(r,t,e,n,a,i){De(r,t,function(){return l4(r,t,n,i)}),De(r,t,function(){return r.uniform1i(a,i)})}function Rm(r,t,e,n){De(r,t,function(){return r.bindFramebuffer(r.FRAMEBUFFER,n)}),De(r,t,function(){return r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,e,0)})}function j2(r,t,e){De(r,t,function(){return r.bindFramebuffer(r.FRAMEBUFFER,e)}),De(r,t,function(){return r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,null,0)})}function ih(r){var t=r.checkFramebufferStatus(r.FRAMEBUFFER);if(t!==r.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+d4(r,t))}function d4(r,t){switch(t){case r.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case r.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case r.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case r.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return"unknown error "+t}}function ei(r,t,e,n){var a=De(r,t,function(){return e()});if(a==null)throw new Error(n);return a}function p4(r,t){var e=r.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,n=t+r.TEXTURE0;if(n<r.TEXTURE0||n>e)throw new Error("textureUnit must be in "+("[gl.TEXTURE0, gl.TEXTURE"+e+"]")+".")}function Kh(r,t){return t===void 0&&(t=2),Ae(r.slice(0,r.length-t))}function Xh(r){if(r.length===0)throw Error("Cannot get rows and columns of an empty shape array.");return[r.length>1?r[r.length-2]:1,r[r.length-1]]}function Am(r){var t=[1,1,1];return r.length===0||r.length===1&&r[0]===1||(t=[Kh(r)].concat(Xh(r))),t}function v4(r,t){var e;t===void 0&&(t=!1);var n=le().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(t&&(n*=2,(r=r.map(function(f,d){return d>=r.length-2?pE(r[d]):r[d]})).length===1&&(r=[2,r[0]])),r.length!==2){var a=No(r);r=a.newShape}var i=Ae(r);if(r.length<=1&&i<=n)return[1,i];if(r.length===2&&r[0]<=n&&r[1]<=n)return r;if(r.length===3&&r[0]*r[1]<=n&&r[2]<=n)return[r[0]*r[1],r[2]];if(r.length===3&&r[0]<=n&&r[1]*r[2]<=n)return[r[0],r[1]*r[2]];if(r.length===4&&r[0]*r[1]*r[2]<=n&&r[3]<=n)return[r[0]*r[1]*r[2],r[3]];if(r.length===4&&r[0]<=n&&r[1]*r[2]*r[3]<=n)return[r[0],r[1]*r[2]*r[3]];if(t){var s=Kh(r),l=2,c=2;return r.length&&(l=(e=Xh(r))[0],c=e[1]),Dg(i=s*(l/2)*(c/2)).map(function(f){return 2*f})}return Dg(i)}function oh(r){return r%2==0}function sh(r,t){if(vn(r=r.slice(-2),t=t.slice(-2))||!r.length||!t.length||r[0]===0||r[1]===0||t[0]===0||t[1]===0)return!0;if(r.length!==t.length){var e=r.slice(-1)[0],n=t.slice(-1)[0];if(e===n||oh(e)&&oh(n)&&(r[0]===1||t[0]===1))return!0}return r[1]===t[1]&&oh(r[0])&&oh(t[0])}function m4(r){if(Sm==null){var t=wa(r);Sm=t.getParameter(t.MAX_TEXTURE_SIZE)}return Sm}function g4(r){if(Em==null){var t=wa(r);Em=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,Em)}function y4(r){if(r===0)return 0;var t=wa(r);return kr(t,"EXT_disjoint_timer_query_webgl2")&&r===2?2:kr(t,"EXT_disjoint_timer_query")?1:0}function kr(r,t){return r.getExtension(t)!=null}function W2(r){try{if(wa(r)!=null)return!0}catch{return!1}return!1}function b4(r){if(r===0)return!1;var t=wa(r);if(r===1){if(!kr(t,"OES_texture_float"))return!1}else if(!kr(t,"EXT_color_buffer_float"))return!1;return Bg(t)}function x4(r){if(r===0)return!1;var t=wa(r);if(r!==1){if(kr(t,"EXT_color_buffer_float"))return Bg(t);if(kr(t,"EXT_color_buffer_half_float")){var e=t.getExtension("EXT_color_buffer_half_float");return function(n,a){var i=vy(n,a),s=n.createTexture();n.bindTexture(n.TEXTURE_2D,s),n.texImage2D(n.TEXTURE_2D,0,i.internalFormatHalfFloat,1,1,0,i.textureFormatFloat,i.textureTypeHalfFloat,null);var l=n.createFramebuffer();n.bindFramebuffer(n.FRAMEBUFFER,l),n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,s,0);var c=n.checkFramebufferStatus(n.FRAMEBUFFER)===n.FRAMEBUFFER_COMPLETE;return n.bindTexture(n.TEXTURE_2D,null),n.bindFramebuffer(n.FRAMEBUFFER,null),n.deleteTexture(s),n.deleteFramebuffer(l),c}(t,e)}return!1}return!!kr(t,"OES_texture_float")&&!!kr(t,"WEBGL_color_buffer_float")&&Bg(t)}function Bg(r){var t=vy(r),e=r.createTexture();r.bindTexture(r.TEXTURE_2D,e),r.texImage2D(r.TEXTURE_2D,0,t.internalFormatFloat,1,1,0,t.textureFormatFloat,t.textureTypeFloat,null);var n=r.createFramebuffer();r.bindFramebuffer(r.FRAMEBUFFER,n),r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,e,0);var a=r.checkFramebufferStatus(r.FRAMEBUFFER)===r.FRAMEBUFFER_COMPLETE;return r.bindTexture(r.TEXTURE_2D,null),r.bindFramebuffer(r.FRAMEBUFFER,null),r.deleteTexture(e),r.deleteFramebuffer(n),a}function w4(r){return r===2&&wa(r).fenceSync!=null}var Ue=le();function SE(r){le().getBool("DEPRECATION_WARNINGS_ENABLED")&&console.warn(r+" You can disable deprecation warnings with tf.disableDeprecationWarnings().")}function _e(r,t){return K.tidy(r,t)}function Qn(r){wE(r).forEach(function(t){return t.dispose()})}function _4(r){return K.keep(r)}function $h(){for(var r=[],t=0;t<arguments.length;t++)r[t]=arguments[t];le().getBool("IS_TEST")||console.warn.apply(console,r)}function uo(r,t){var e=r;if(va(r))return t==="string"?[]:[r.length];if(!Array.isArray(r))return[];for(var n=[];Array.isArray(e)||va(e)&&t!=="string";)n.push(e.length),e=e[0];return Array.isArray(r)&&le().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&function a(i,s,l){if(l=l||[],!Array.isArray(i)&&!va(i))return void L(s.length===0,function(){return"Element arr["+l.join("][")+"] is a primitive, but should be an array/TypedArray of "+s[0]+" elements"});L(s.length>0,function(){return"Element arr["+l.join("][")+"] should be a primitive, but is an array of "+i.length+" elements"}),L(i.length===s[0],function(){return"Element arr["+l.join("][")+"] should have "+s[0]+" elements, but has "+i.length+" elements"});for(var c=s.slice(1),f=0;f<i.length;++f)a(i[f],c,l.concat(f))}(r,n,[]),n}function G2(r,t,e,n){if(r!=null&&(r!=="numeric"&&r!==t||r==="numeric"&&t==="string"))throw new Error("Argument '"+e+"' passed to '"+n+"' must be "+r+" tensor, but got "+t+" tensor")}function B(r,t,e,n){if(n===void 0&&(n="numeric"),r instanceof Nt)return G2(n,r.dtype,t,e),r;var a=Tc(r);if(a!=="string"&&["bool","int32","float32"].indexOf(n)>=0&&(a=n),G2(n,a,t,e),r==null||!va(r)&&!Array.isArray(r)&&typeof r!="number"&&typeof r!="boolean"&&typeof r!="string"){var i=r==null?"null":r.constructor.name;throw new Error("Argument '"+t+"' passed to '"+e+"' must be a Tensor or TensorLike, but got '"+i+"'")}var s=uo(r,a);va(r)||Array.isArray(r)||(r=[r]);var l=a!=="string"?mE(r,a,le().getBool("DEBUG")):Mu(r,[],!0);return K.makeTensor(l,s,a)}function Yh(r,t,e,n){if(n===void 0&&(n="numeric"),!Array.isArray(r))throw new Error("Argument "+t+" passed to "+e+" must be a `Tensor[]` or `TensorLike[]`");return r.map(function(a,i){return B(a,t+"["+i+"]",e)},n)}function EE(r,t){for(var e=0;e<r.length;++e)if(r[r.length-e-1]!==t-1-e)return!1;return!0}function S4(r,t,e){for(var n=r.length+t.length,a=[],i=0,s=0,l=0;l<n;l++)e.indexOf(l)===-1?a.push(r[i++]):a.push(t[s++]);return a}function Dn(r,t){for(var e=[],n=r.length,a=0;a<n;a++)t.indexOf(a)===-1&&e.push(r[a]);return[e,t.map(function(i){return r[i]})]}function Zn(r,t){return S4(r,t.map(function(e){return 1}),t)}function ur(r,t,e){L(EE(t,e),function(){return r+" supports only inner-most axes for now. Got axes "+t+" and rank-"+e+" input."})}function _a(r,t){if(EE(r,t))return null;for(var e=[],n=0;n<t;++n)r.indexOf(n)===-1&&e.push(n);return r.forEach(function(a){return e.push(a)}),e}function my(r){return r.map(function(t,e){return[e,t]}).sort(function(t,e){return t[1]-e[1]}).map(function(t){return t[0]})}function Sa(r,t){for(var e=[],n=t-r;n<t;++n)e.push(n);return e}function E4(r,t){var e=r[0].length;r.forEach(function(a,i){L(a.length===e,function(){return"Error in concat"+e+"D: rank of tensors["+i+"] must be the same as the rank of the rest ("+e+")"})}),L(t>=0&&t<e,function(){return"Error in concat"+e+"D: axis must be between 0 and "+(e-1)+"."});var n=r[0];r.forEach(function(a,i){for(var s=0;s<e;s++)L(s===t||a[s]===n[s],function(){return"Error in concat"+e+"D: Shape of tensors["+i+"] ("+a+") does not match the shape of the rest ("+n+") along the non-concatenated axis "+i+"."})})}function Fu(r,t){for(var e=r[0].slice(),n=1;n<r.length;n++)e[t]+=r[n][t];return e}function j(r){var t=Object.keys(r);if(t.length!==1)throw new Error("Please provide an object with a single key (operation name) mapping to a function. Got an object with "+t.length+" keys.");var e=t[0],n=r[e];e.endsWith("_")&&(e=e.substring(0,e.length-1));var a=function(){for(var i=[],s=0;s<arguments.length;s++)i[s]=arguments[s];K.startScope(e);try{var l=n.apply(void 0,i);return l instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),K.endScope(l),l}catch(c){throw K.endScope(null),c}};return Object.defineProperty(a,"name",{value:e,configurable:!0}),a}Ue.registerFlag("HAS_WEBGL",function(){return Ue.getNumber("WEBGL_VERSION")>0}),Ue.registerFlag("WEBGL_VERSION",function(){return W2(2)?2:W2(1)?1:0}),Ue.registerFlag("WEBGL_BUFFER_SUPPORTED",function(){return Ue.get("WEBGL_VERSION")===2}),Ue.registerFlag("WEBGL_CPU_FORWARD",function(){return!0}),Ue.registerFlag("WEBGL_FORCE_F16_TEXTURES",function(){return!1}),Ue.registerFlag("WEBGL_PACK",function(){return Ue.getBool("HAS_WEBGL")}),Ue.registerFlag("WEBGL_PACK_NORMALIZATION",function(){return Ue.getBool("WEBGL_PACK")}),Ue.registerFlag("WEBGL_PACK_CLIP",function(){return Ue.getBool("WEBGL_PACK")}),Ue.registerFlag("WEBGL_PACK_DEPTHWISECONV",function(){return!1}),Ue.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",function(){return Ue.getBool("WEBGL_PACK")}),Ue.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",function(){return Ue.getBool("WEBGL_PACK")}),Ue.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",function(){return Ue.getBool("WEBGL_PACK")}),Ue.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",function(){return Ue.getBool("WEBGL_PACK")}),Ue.registerFlag("WEBGL_PACK_REDUCE",function(){return Ue.getBool("WEBGL_PACK")}),Ue.registerFlag("WEBGL_LAZILY_UNPACK",function(){return Ue.getBool("WEBGL_PACK")}),Ue.registerFlag("WEBGL_CONV_IM2COL",function(){return Ue.getBool("WEBGL_PACK")}),Ue.registerFlag("WEBGL_MAX_TEXTURE_SIZE",function(){return m4(Ue.getNumber("WEBGL_VERSION"))}),Ue.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",function(){return g4(Ue.getNumber("WEBGL_VERSION"))}),Ue.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",function(){var r=Ue.getNumber("WEBGL_VERSION");return r===0?0:y4(r)}),Ue.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",function(){return Ue.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&(r=navigator.userAgent||navigator.vendor||window.opera,!(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(r)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(r.substr(0,4))));var r}),Ue.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",function(){return b4(Ue.getNumber("WEBGL_VERSION"))}),Ue.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",function(){return!Ue.getBool("WEBGL_FORCE_F16_TEXTURES")&&Ue.getBool("WEBGL_RENDER_FLOAT32_CAPABLE")}),Ue.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",function(){return x4(Ue.getNumber("WEBGL_VERSION"))}),Ue.registerFlag("WEBGL_FENCE_API_ENABLED",function(){return w4(Ue.getNumber("WEBGL_VERSION"))}),Ue.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",function(){return Ue.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0}),xE=SE;var wn=j({complex_:function(r,t){var e=B(r,"real","complex"),n=B(t,"imag","complex");return gt(e.shape,n.shape,"real and imag shapes, "+e.shape+" and "+n.shape+", must match in call to tf.complex()."),K.runKernelFunc(function(a){return a.complex(e,n)},{$real:e,$imag:n})}}),Dr=j({real_:function(r){var t=B(r,"input","real");return K.runKernelFunc(function(e){return e.real(t)},{$input:t})}}),fa=j({imag_:function(r){var t=B(r,"input","imag");return K.runKernelFunc(function(e){return e.imag(t)},{$input:t})}});function Sn(r,t,e){return lo(r,t,uo(r,e),e)}function lo(r,t,e,n){if(n==null&&(n=Tc(r)),n==="complex64")throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(!va(r)&&!Array.isArray(r)&&typeof r!="number"&&typeof r!="boolean"&&typeof r!="string")throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(t!=null){yE(t);var a=Ae(t),i=Ae(e);L(a===i,function(){return"Based on the provided shape, ["+t+"], the tensor should have "+a+" values but has "+i});for(var s=0;s<e.length;++s){var l=e[s],c=s!==e.length-1||l!==Ae(t.slice(s));L(e[s]===t[s]||!c,function(){return"Error creating a new Tensor. Inferred shape ("+e+") does not match the provided shape ("+t+"). "})}}return va(r)||Array.isArray(r)||(r=[r]),t=t||e,r=n!=="string"?mE(r,n,le().getBool("DEBUG")):Mu(r,[],!0),K.makeTensor(r,t,n)}function ye(r,t){if((va(r)&&t!=="string"||Array.isArray(r))&&t!=="complex64")throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if(t==="string"&&va(r)&&!(r instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return lo(r,[],[],t)}function Xt(r,t){Vu(r);var e=uo(r,t);if(e.length!==1)throw new Error("tensor1d() requires values to be a flat/TypedArray");return lo(r,null,e,t)}function eo(r,t,e){if(Vu(r),t!=null&&t.length!==2)throw new Error("tensor2d() requires shape to have two numbers");var n=uo(r,e);if(n.length!==2&&n.length!==1)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(n.length===1&&t==null)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return lo(r,t,n,e)}function gy(r,t,e){if(Vu(r),t!=null&&t.length!==3)throw new Error("tensor3d() requires shape to have three numbers");var n=uo(r,e);if(n.length!==3&&n.length!==1)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(n.length===1&&t==null)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return lo(r,t,n,e)}function Xn(r,t,e){if(Vu(r),t!=null&&t.length!==4)throw new Error("tensor4d() requires shape to have four numbers");var n=uo(r,e);if(n.length!==4&&n.length!==1)throw new Error("tensor4d() requires values to be number[][][][] or flat/TypedArray");if(n.length===1&&t==null)throw new Error("tensor4d() requires shape to be provided when `values` are a flat array");return lo(r,t,n,e)}function C4(r,t,e){if(Vu(r),t!=null&&t.length!==5)throw new Error("tensor5d() requires shape to have five numbers");var n=uo(r,e);if(n.length!==5&&n.length!==1)throw new Error("tensor5d() requires values to be number[][][][][] or flat/TypedArray");if(n.length===1&&t==null)throw new Error("tensor5d() requires shape to be provided when `values` are a flat array");return lo(r,t,n,e)}function R4(r,t,e){if(Vu(r),t!=null&&t.length!==6)throw new Error("tensor6d() requires shape to have six numbers");var n=uo(r,e);if(n.length!==6&&n.length!==1)throw new Error("tensor6d() requires values to be number[][][][][][] or flat/TypedArray");if(n.length===1&&t==null)throw new Error("tensor6d() requires shape to be provided when `values` are a flat array");return lo(r,t=t||n,n,e)}function A4(r,t,e,n){return t===void 0&&(t=!0),K.makeVariable(r,t,e,n)}function Hu(r,t){if(t===void 0&&(t="float32"),t==="complex64"){var e=Hu(r,"float32"),n=Dt(r,"float32");return wn(e,n)}var a=gE(Ae(r),t);return K.makeTensor(a,r,t)}function Dt(r,t){if(t===void 0&&(t="float32"),t==="complex64"){var e=Dt(r,"float32"),n=Dt(r,"float32");return wn(e,n)}var a=Dc(Ae(r),t);return K.makeTensor(a,r,t)}function ga(r,t,e){return K.runKernelFunc(function(n){return n.fill(r,t,e)},{})}function T4(r,t,e){if(e<=0)throw new Error("The number of values should be positive.");return K.runKernelFunc(function(n){return n.linspace(r,t,e)},{})}function Qh(r,t,e,n){if(e===void 0&&(e=1),n===void 0&&(n="float32"),e===0)throw new Error("Cannot have a step of zero");if(r===t||r<t&&e<0||t<r&&e>1)return Dt([0],n);var a=Dc(Math.abs(Math.ceil((t-r)/e)),n);t<r&&e===1&&(e=-1),a[0]=r;for(var i=1;i<a.length;i++)a[i]=a[i-1]+e;return Xt(a,n)}var CE=j({onesLike_:function(r){var t=B(r,"x","onesLike");if(t.dtype==="complex64"){var e=CE(Dr(t)),n=st(fa(t));return wn(e,n)}return K.runKernelFunc(function(a){return a.onesLike(t)},{$x:t},function(a,i){return{$x:function(){return st(a)}}})}}),st=j({zerosLike_:function(r){var t=B(r,"x","zerosLike");return K.runKernelFunc(function(e){return e.zerosLike(t)},{$x:t},function(e,n){return{$x:function(){return st(e)}}})}}),nn=j({concat_:function(r,t){t===void 0&&(t=0),L(r.length>=1,function(){return"Pass at least one tensor to concat"});var e=Yh(r,"tensors","concat");e[0].dtype==="complex64"&&e.forEach(function(l){if(l.dtype!=="complex64")throw new Error(`Cannot concatenate complex64 tensors with a tensor
          with dtype `+l.dtype+". ")}),t=sn(t,e[0].shape)[0];var n=Fu(e.map(function(l){return l.shape}),t);if(Ae(n)===0)return Sn([],n);if((e=e.filter(function(l){return l.size>0})).length===1)return e[0];var a=e.map(function(l){return l.shape});E4(a,t);var i=e,s={axis:t};return K.runKernelFunc(function(l){return l.concat(e,t)},i,function(l){var c=a.map(function(f){return f[t]});return yy(l,c,t).map(function(f){return function(){return f}})},"Concat",s)}}),D4=j({concat1d_:function(r){return nn(r,0)}}),k4=j({concat2d_:function(r,t){return nn(r,t)}}),O4=j({concat3d_:function(r,t){return nn(r,t)}}),N4=j({concat4d_:function(r,t){return nn(r,t)}}),yy=j({split_:function(r,t,e){e===void 0&&(e=0);var n,a=B(r,"x","split");return e=sn(e,a.shape)[0],typeof t=="number"?(L(a.shape[e]%t==0,function(){return"Number of splits must evenly divide the axis."}),n=new Array(t).fill(a.shape[e]/t)):(L(a.shape[e]===t.reduce(function(i,s){return i+s}),function(){return"The sum of sizes must match the size of the axis dimension."}),n=t),K.runKernelFunc(function(i){return i.split(a,n,e)},{$x:a},function(i){return{$x:function(){return nn(i,e)}}})}});function Jo(r,t){return r(t={exports:{}},t.exports),t.exports}var M4=Jo(function(r){(function(t,e,n){function a(l){var c,f=this,d=(c=4022871197,function(v){v=v.toString();for(var m=0;m<v.length;m++){var g=.02519603282416938*(c+=v.charCodeAt(m));g-=c=g>>>0,c=(g*=c)>>>0,c+=4294967296*(g-=c)}return 23283064365386963e-26*(c>>>0)});f.next=function(){var v=2091639*f.s0+23283064365386963e-26*f.c;return f.s0=f.s1,f.s1=f.s2,f.s2=v-(f.c=0|v)},f.c=1,f.s0=d(" "),f.s1=d(" "),f.s2=d(" "),f.s0-=d(l),f.s0<0&&(f.s0+=1),f.s1-=d(l),f.s1<0&&(f.s1+=1),f.s2-=d(l),f.s2<0&&(f.s2+=1),d=null}function i(l,c){return c.c=l.c,c.s0=l.s0,c.s1=l.s1,c.s2=l.s2,c}function s(l,c){var f=new a(l),d=c&&c.state,v=f.next;return v.int32=function(){return 4294967296*f.next()|0},v.double=function(){return v()+11102230246251565e-32*(2097152*v()|0)},v.quick=v,d&&(typeof d=="object"&&i(d,f),v.state=function(){return i(f,{})}),v}e&&e.exports?e.exports=s:this.alea=s})(0,r)}),I4=Jo(function(r){(function(t,e,n){function a(l){var c=this,f="";c.x=0,c.y=0,c.z=0,c.w=0,c.next=function(){var v=c.x^c.x<<11;return c.x=c.y,c.y=c.z,c.z=c.w,c.w^=c.w>>>19^v^v>>>8},l===(0|l)?c.x=l:f+=l;for(var d=0;d<f.length+64;d++)c.x^=0|f.charCodeAt(d),c.next()}function i(l,c){return c.x=l.x,c.y=l.y,c.z=l.z,c.w=l.w,c}function s(l,c){var f=new a(l),d=c&&c.state,v=function(){return(f.next()>>>0)/4294967296};return v.double=function(){do var m=((f.next()>>>11)+(f.next()>>>0)/4294967296)/2097152;while(m===0);return m},v.int32=f.next,v.quick=v,d&&(typeof d=="object"&&i(d,f),v.state=function(){return i(f,{})}),v}e&&e.exports?e.exports=s:this.xor128=s})(0,r)}),F4=Jo(function(r){(function(t,e,n){function a(l){var c=this,f="";c.next=function(){var v=c.x^c.x>>>2;return c.x=c.y,c.y=c.z,c.z=c.w,c.w=c.v,(c.d=c.d+362437|0)+(c.v=c.v^c.v<<4^v^v<<1)|0},c.x=0,c.y=0,c.z=0,c.w=0,c.v=0,l===(0|l)?c.x=l:f+=l;for(var d=0;d<f.length+64;d++)c.x^=0|f.charCodeAt(d),d==f.length&&(c.d=c.x<<10^c.x>>>4),c.next()}function i(l,c){return c.x=l.x,c.y=l.y,c.z=l.z,c.w=l.w,c.v=l.v,c.d=l.d,c}function s(l,c){var f=new a(l),d=c&&c.state,v=function(){return(f.next()>>>0)/4294967296};return v.double=function(){do var m=((f.next()>>>11)+(f.next()>>>0)/4294967296)/2097152;while(m===0);return m},v.int32=f.next,v.quick=v,d&&(typeof d=="object"&&i(d,f),v.state=function(){return i(f,{})}),v}e&&e.exports?e.exports=s:this.xorwow=s})(0,r)}),B4=Jo(function(r){(function(t,e,n){function a(l){var c=this;c.next=function(){var f,d,v=c.x,m=c.i;return f=v[m],d=(f^=f>>>7)^f<<24,d^=(f=v[m+1&7])^f>>>10,d^=(f=v[m+3&7])^f>>>3,d^=(f=v[m+4&7])^f<<7,f=v[m+7&7],d^=(f^=f<<13)^f<<9,v[m]=d,c.i=m+1&7,d},function(f,d){var v,m=[];if(d===(0|d))m[0]=d;else for(d=""+d,v=0;v<d.length;++v)m[7&v]=m[7&v]<<15^d.charCodeAt(v)+m[v+1&7]<<13;for(;m.length<8;)m.push(0);for(v=0;v<8&&m[v]===0;++v);for(v==8?m[7]=-1:m[v],f.x=m,f.i=0,v=256;v>0;--v)f.next()}(c,l)}function i(l,c){return c.x=l.x.slice(),c.i=l.i,c}function s(l,c){l==null&&(l=+new Date);var f=new a(l),d=c&&c.state,v=function(){return(f.next()>>>0)/4294967296};return v.double=function(){do var m=((f.next()>>>11)+(f.next()>>>0)/4294967296)/2097152;while(m===0);return m},v.int32=f.next,v.quick=v,d&&(d.x&&i(d,f),v.state=function(){return i(f,{})}),v}e&&e.exports?e.exports=s:this.xorshift7=s})(0,r)}),L4=Jo(function(r){(function(t,e,n){function a(l){var c=this;c.next=function(){var f,d,v=c.w,m=c.X,g=c.i;return c.w=v=v+1640531527|0,d=m[g+34&127],f=m[g=g+1&127],d^=d<<13,f^=f<<17,d^=d>>>15,f^=f>>>12,d=m[g]=d^f,c.i=g,d+(v^v>>>16)|0},function(f,d){var v,m,g,b,w,_=[],S=128;for(d===(0|d)?(m=d,d=null):(d+="\0",m=0,S=Math.max(S,d.length)),g=0,b=-32;b<S;++b)d&&(m^=d.charCodeAt((b+32)%d.length)),b===0&&(w=m),m^=m<<10,m^=m>>>15,m^=m<<4,m^=m>>>13,b>=0&&(w=w+1640531527|0,g=(v=_[127&b]^=m+w)==0?g+1:0);for(g>=128&&(_[127&(d&&d.length||0)]=-1),g=127,b=512;b>0;--b)m=_[g+34&127],v=_[g=g+1&127],m^=m<<13,v^=v<<17,m^=m>>>15,v^=v>>>12,_[g]=m^v;f.w=w,f.X=_,f.i=g}(c,l)}function i(l,c){return c.i=l.i,c.w=l.w,c.X=l.X.slice(),c}function s(l,c){l==null&&(l=+new Date);var f=new a(l),d=c&&c.state,v=function(){return(f.next()>>>0)/4294967296};return v.double=function(){do var m=((f.next()>>>11)+(f.next()>>>0)/4294967296)/2097152;while(m===0);return m},v.int32=f.next,v.quick=v,d&&(d.X&&i(d,f),v.state=function(){return i(f,{})}),v}e&&e.exports?e.exports=s:this.xor4096=s})(0,r)}),P4=Jo(function(r){(function(t,e,n){function a(l){var c=this,f="";c.next=function(){var v=c.b,m=c.c,g=c.d,b=c.a;return v=v<<25^v>>>7^m,m=m-g|0,g=g<<24^g>>>8^b,b=b-v|0,c.b=v=v<<20^v>>>12^m,c.c=m=m-g|0,c.d=g<<16^m>>>16^b,c.a=b-v|0},c.a=0,c.b=0,c.c=-1640531527,c.d=1367130551,l===Math.floor(l)?(c.a=l/4294967296|0,c.b=0|l):f+=l;for(var d=0;d<f.length+20;d++)c.b^=0|f.charCodeAt(d),c.next()}function i(l,c){return c.a=l.a,c.b=l.b,c.c=l.c,c.d=l.d,c}function s(l,c){var f=new a(l),d=c&&c.state,v=function(){return(f.next()>>>0)/4294967296};return v.double=function(){do var m=((f.next()>>>11)+(f.next()>>>0)/4294967296)/2097152;while(m===0);return m},v.int32=f.next,v.quick=v,d&&(typeof d=="object"&&i(d,f),v.state=function(){return i(f,{})}),v}e&&e.exports?e.exports=s:this.tychei=s})(0,r)}),Oo=Jo(function(r){(function(t,e){var n,a=this,i=256,s=6,l="random",c=e.pow(i,s),f=e.pow(2,52),d=2*f,v=i-1;function m(S,E,C){var R=[],A=w(function I(O,M){var V,z=[],J=typeof O;if(M&&J=="object")for(V in O)try{z.push(I(O[V],M-1))}catch{}return z.length?z:J=="string"?O:O+"\0"}((E=E==1?{entropy:!0}:E||{}).entropy?[S,_(t)]:S??function(){try{var I;return n&&(I=n.randomBytes)?I=I(i):(I=new Uint8Array(i),(a.crypto||a.msCrypto).getRandomValues(I)),_(I)}catch{var O=a.navigator,M=O&&O.plugins;return[+new Date,a,M,a.screen,_(t)]}}(),3),R),D=new g(R),k=function(){for(var I=D.g(s),O=c,M=0;I<f;)I=(I+M)*i,O*=i,M=D.g(1);for(;I>=d;)I/=2,O/=2,M>>>=1;return(I+M)/O};return k.int32=function(){return 0|D.g(4)},k.quick=function(){return D.g(4)/4294967296},k.double=k,w(_(D.S),t),(E.pass||C||function(I,O,M,V){return V&&(V.S&&b(V,D),I.state=function(){return b(D,{})}),M?(e[l]=I,O):I})(k,A,"global"in E?E.global:this==e,E.state)}function g(S){var E,C=S.length,R=this,A=0,D=R.i=R.j=0,k=R.S=[];for(C||(S=[C++]);A<i;)k[A]=A++;for(A=0;A<i;A++)k[A]=k[D=v&D+S[A%C]+(E=k[A])],k[D]=E;(R.g=function(I){for(var O,M=0,V=R.i,z=R.j,J=R.S;I--;)O=J[V=v&V+1],M=M*i+J[v&(J[V]=J[z=v&z+O])+(J[z]=O)];return R.i=V,R.j=z,M})(i)}function b(S,E){return E.i=S.i,E.j=S.j,E.S=S.S.slice(),E}function w(S,E){for(var C,R=S+"",A=0;A<R.length;)E[v&A]=v&(C^=19*E[v&A])+R.charCodeAt(A++);return _(E)}function _(S){return String.fromCharCode.apply(0,S)}if(e["seed"+l]=m,w(e.random(),t),r.exports){r.exports=m;try{n=require("crypto")}catch{}}})([],Math)});Oo.alea=M4,Oo.xor128=I4,Oo.xorwow=F4,Oo.xorshift7=B4,Oo.xor4096=L4,Oo.tychei=P4;var _d=Oo.alea,by=function(){function r(t,e,n,a,i){this.mean=t,this.stdDev=e,this.dtype=n,this.nextVal=NaN,this.truncated=a,this.truncated&&(this.upper=this.mean+2*this.stdDev,this.lower=this.mean-2*this.stdDev);var s=i||Math.random();this.random=_d(s.toString())}return r.prototype.nextValue=function(){if(!isNaN(this.nextVal)){var t=this.nextVal;return this.nextVal=NaN,t}for(var e,n,a=!1;!a;){var i=void 0,s=void 0,l=void 0;do l=(i=2*this.random()-1)*i+(s=2*this.random()-1)*s;while(l>=1||l===0);var c=Math.sqrt(-2*Math.log(l)/l);e=this.mean+this.stdDev*i*c,n=this.mean+this.stdDev*s*c,this.truncated&&!this.isValidTruncated(e)||(a=!0)}return this.truncated&&!this.isValidTruncated(n)||(this.nextVal=this.convertValue(n)),this.convertValue(e)},r.prototype.convertValue=function(t){return this.dtype==null||this.dtype==="float32"?t:Math.round(t)},r.prototype.isValidTruncated=function(t){return t<=this.upper&&t>=this.lower},r}(),z4=function(){function r(t,e,n,a){this.alpha=t,this.beta=1/e,this.dtype=n;var i=a||Math.random();this.randu=_d(i.toString()),this.randn=new by(0,1,n,!1,this.randu()),this.d=t<1?t+2/3:t-1/3,this.c=1/Math.sqrt(9*this.d)}return r.prototype.nextValue=function(){for(var t,e,n,a,i,s;;){do a=this.randn.nextValue(),s=1+this.c*a;while(s<=0);if(s*=s*s,e=1-.331*(t=a*a)*t,n=.5*t+this.d*(1-s+Math.log(s)),(i=this.randu())<e||Math.log(i)<n)break}return s=1/this.beta*this.d*s,this.alpha<1&&(s*=Math.pow(this.randu(),1/this.alpha)),this.convertValue(s)},r.prototype.convertValue=function(t){return this.dtype==="float32"?t:Math.round(t)},r}(),U4=function(){function r(t,e,n,a){var i=this;if(t===void 0&&(t=0),e===void 0&&(e=1),this.canReturnFloat=function(){return i.dtype==null||i.dtype==="float32"},this.min=t,this.range=e-t,this.dtype=n,a==null&&(a=Math.random()),typeof a=="number"&&(a=a.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error("The difference between "+t+" - "+e+" <= 1 and dtype is not float");this.random=_d(a)}return r.prototype.convertValue=function(t){return this.canReturnFloat()?t:Math.round(t)},r.prototype.nextValue=function(){return this.convertValue(this.min+this.range*this.random())},r}();function je(r,t,e){return t===void 0&&(t="float32"),t=t||"float32",yE(r),new hc(r,t,e)}function V4(r,t){t===void 0&&(t=!1),console.log(r.toString(t))}var RE=j({batchToSpaceND_:function(r,t,e){var n=B(r,"x","batchToSpaceND"),a=t.reduce(function(i,s){return i*s});return L(n.rank>=1+t.length,function(){return"input rank is "+n.rank+" but should be > than blockShape.length "+t.length}),L(e.length===t.length,function(){return"crops.length is "+e.length+" but should be equal to blockShape.length  "+t.length}),L(n.shape[0]%a==0,function(){return"input tensor batch is "+n.shape[0]+" but is not divisible by the product of the elements of blockShape "+t.join(" * ")+" === "+a}),K.runKernelFunc(function(i){return i.batchToSpaceND(n,t,e)},{$x:n},function(i){return{$x:function(){return i.spaceToBatchND(t,e)}}})}}),H4=j({broadcastTo_:function(r,t){var e=B(r,"broadcastTo","x"),n=e.shape;if(t.some(function(c){return!(c>0)||c%1!=0}))throw new Error("broadcastTo(): Invalid broadcast shape ["+t+"].");if(t.length<e.rank)throw new Error("broadcastTo(): shape.length="+t.length+" < input.rank="+e.rank+".");if(t.length>e.rank){for(var a=e.shape.slice();a.length<t.length;)a.unshift(1);e=e.reshape(a)}for(var i=Array.from(t),s=t.length-1;s>=0;s--)if(e.shape[s]===t[s])i[s]=1;else if(e.shape[s]!==1)throw new Error("broadcastTo(): ["+n+"] cannot be broadcast to ["+t+"].");var l=i.map(function(c,f){return c>1?f:-1}).filter(function(c){return c>=0});return l.length===0?e.clone():K.runKernelFunc(function(c){return c.tile(e,i)},{input:e},function(c){return{input:function(){return c.sum(l,!0)}}})}}),j4=j({cast_:function(r,t){var e=B(r,"x","cast");if(!F3(t))throw new Error("Failed to cast to unknown dtype "+t);if(t==="string"&&e.dtype!=="string"||t!=="string"&&e.dtype==="string")throw new Error("Only strings can be casted to strings");var n={dtype:t};return K.runKernelFunc(function(a){return a.cast(e,t)},{x:e},function(a){return{x:function(){return a.clone()}}},"Cast",n)}}),W4=j({clone_:function(r){var t=B(r,"x","clone",null);return K.runKernelFunc(function(){return K.makeTensorFromDataId(t.dataId,t.shape,t.dtype)},{$x:t},function(e){return{$x:function(){return e.toFloat()}}})}}),G4=j({cumsum_:function(r,t,e,n){t===void 0&&(t=0),e===void 0&&(e=!1),n===void 0&&(n=!1);var a=B(r,"x","cumsum"),i=_a([t|=0],a.rank),s=a;i!=null&&(s=a.transpose(i));var l=Sa(1,a.rank)[0],c=K.runKernelFunc(function(f){return f.cumsum(s,l,e,n)},{permutedX:s},function(f){return{permutedX:function(){return f.cumsum(t,e,!n)}}});return i!=null&&(c=c.transpose(i)),c}}),q4=j({depthToSpace_:function(r,t,e){e===void 0&&(e="NHWC");var n=B(r,"x","depthToSpace"),a=e==="NHWC"?n.shape[1]:n.shape[2],i=e==="NHWC"?n.shape[2]:n.shape[3],s=e==="NHWC"?n.shape[3]:n.shape[1];return L(a*t>=0,function(){return`Negative dimension size caused by overflow when multiplying
      `+a+" and "+t+`  for depthToSpace with input shape
      `+n.shape}),L(i*t>=0,function(){return`Negative dimension size caused by overflow when multiplying
      `+i+" and "+t+` for depthToSpace with input shape
          `+n.shape}),L(s%(t*t)==0,function(){return"Dimension size must be evenly divisible by "+t*t+" but is "+s+" for depthToSpace with input shape "+n.shape}),K.runKernelFunc(function(l){return l.depthToSpace(n,t,e)},{$x:n})}}),Tr=j({expandDims_:function(r,t){t===void 0&&(t=0);var e=B(r,"x","expandDims",null);L(t<=e.rank,function(){return"Axis must be <= rank of the tensor"});var n=e.shape.slice();return t<0&&(L(-(e.rank+1)<=t,function(){return"Axis must be in the interval ["+-(e.rank+1)+", "+e.rank+"]"}),t=e.rank+t+1),n.splice(t,0,1),Wr(e,n)}}),AE=j({eye_:function(r,t,e,n){n===void 0&&(n="float32"),t==null&&(t=r);for(var a=je([r,t],n),i=r<=t?r:t,s=0;s<i;++s)a.set(1,s,s);var l=a.toTensor().as2D(r,t);if(e==null)return l;if(e.length===1)return au(Tr(l,0),[e[0],1,1]);if(e.length===2)return au(Tr(Tr(l,0),0),[e[0],e[1],1,1]);if(e.length===3)return au(Tr(Tr(Tr(l,0),0),0),[e[0],e[1],e[2],1,1]);throw new Error("eye() currently supports only 1D and 2D batchShapes, but received "+e.length+"D.")}}),K4=j({multinomial_:function(r,t,e,n){n===void 0&&(n=!1);var a=B(r,"logits","multinomial"),i=a.size,s=a.rank;if(i<2)throw new Error("Error in multinomial: you need at least 2 outcomes, but got "+i+".");if(s>2)throw new Error("Rank of probabilities must be 1 or 2, but is "+s);e=e||Math.random();var l=s===1?a.as2D(1,-1):a,c=K.runKernelFunc(function(f){return f.multinomial(l,n,t,e)},{logits2D:l});return s===1?c.as1D():c}}),Lg=j({oneHot_:function(r,t,e,n){if(e===void 0&&(e=1),n===void 0&&(n=0),t<2)throw new Error("Error in oneHot: depth must be >=2, but it is "+t);var a=B(r,"indices","oneHot","int32"),i=a.shape.concat([t]);return a=a.flatten(),K.runKernelFunc(function(s){return s.oneHot(a,t,e,n)},{$indices:a},function(s){return{$indices:function(){return Dt(a.shape,"float32")}}}).reshape(i)}}),es=j({pad_:function(r,t,e){e===void 0&&(e=0);var n=B(r,"x","pad");if(n.rank===0)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");var a={paddings:t,constantValue:e};return K.runKernelFunc(function(i){return i.pad(n,t,e)},{x:n},function(i){var s=t.map(function(l){return l[0]});return{x:function(){return i.slice(s,n.shape)}}},"PadV2",a)}}),X4=j({pad1d_:function(r,t,e){return e===void 0&&(e=0),L(t.length===2,function(){return"Invalid number of paddings. Must be length of 2."}),es(r,[t],e)}}),$4=j({pad2d_:function(r,t,e){return e===void 0&&(e=0),L(t.length===2&&t[0].length===2&&t[1].length===2,function(){return"Invalid number of paddings. Must be length of 2 each."}),es(r,t,e)}}),Y4=j({pad3d_:function(r,t,e){return e===void 0&&(e=0),L(t.length===3&&t[0].length===2&&t[1].length===2&&t[2].length===2,function(){return"Invalid number of paddings. Must be length of 2 each."}),es(r,t,e)}}),Q4=j({pad4d_:function(r,t,e){return e===void 0&&(e=0),L(t.length===4&&t[0].length===2&&t[1].length===2&&t[2].length===2&&t[3].length===2,function(){return"Invalid number of paddings. Must be length of 2 each."}),es(r,t,e)}}),Z4=j({rand_:function(r,t,e){var n=Ae(r),a=null;if(e==null||e==="float32")a=new Float32Array(n);else if(e==="int32")a=new Int32Array(n);else{if(e!=="bool")throw new Error("Unknown data type "+e);a=new Uint8Array(n)}for(var i=0;i<n;i++)a[i]=t();return K.makeTensor(a,r,e)}}),J4=j({randomNormal_:function(r,t,e,n,a){if(t===void 0&&(t=0),e===void 0&&(e=1),n!=null&&n==="bool")throw new Error("Unsupported data type "+n);for(var i=new by(t,e,n,!1,a),s=je(r,n),l=0;l<s.values.length;l++)s.values[l]=i.nextValue();return s.toTensor()}}),eM=j({randomGamma_:function(r,t,e,n,a){if(e===void 0&&(e=1),n===void 0&&(n="float32"),e==null&&(e=1),n==null&&(n="float32"),n!=="float32"&&n!=="int32")throw new Error("Unsupported data type "+n);for(var i=new z4(t,e,n,a),s=je(r,n),l=0;l<s.values.length;l++)s.values[l]=i.nextValue();return s.toTensor()}}),TE=j({randomUniform_:function(r,t,e,n,a){t===void 0&&(t=0),e===void 0&&(e=1),n===void 0&&(n="float32");for(var i=je(r,n),s=new U4(t,e,null,a),l=0;l<i.values.length;l++)i.values[l]=s.nextValue();return i.toTensor()}}),Wr=j({reshape_:function(r,t){var e=B(r,"x","reshape",null);t=M3(t,e.size),L(e.size===Ae(t),function(){return"new shape and old shape must have the same number of elements."});var n={shape:t};return K.runKernelFunc(function(a){return a.reshape(e,t)},{x:e},function(a){return{x:function(){return a.reshape(e.shape)}}},"Reshape",n)}}),DE=j({spaceToBatchND_:function(r,t,e){var n=B(r,"x","spaceToBatchND");return L(n.rank>=1+t.length,function(){return"input rank "+n.rank+" should be > than [blockShape] "+t.length}),L(e.length===t.length,function(){return"paddings.shape[0] "+e.length+" must be equal to [blockShape] "+t.length}),L(n.shape.reduce(function(a,i,s){return s>0&&s<=t.length?a&&(i+e[s-1][0]+e[s-1][1])%t[s-1]==0:a},!0),function(){return"input spatial dimensions "+n.shape.slice(1)+" with paddings "+e.toString()+" must be divisible by blockShapes "+t.toString()}),K.runKernelFunc(function(a){return a.spaceToBatchND(n,t,e)},{$x:n},function(a){return{$x:function(){return a.batchToSpaceND(t,e)}}})}}),kE=j({squeeze_:function(r,t){var e=B(r,"x","squeeze");return Wr(e,No(e.shape,t).newShape)}}),dr=j({stack_:function(r,t){t===void 0&&(t=0);var e=Yh(r,"tensors","stack");if(L(e.length>=1,function(){return"Pass at least one tensor to tf.stack"}),e.length===1)return e[0].expandDims(t);var n=e[0].rank,a=e[0].shape,i=e[0].dtype;L(t<=n,function(){return"Axis must be <= rank of the tensor"}),e.forEach(function(l){gt(a,l.shape,"All tensors passed to stack must have matching shapes")}),e.forEach(function(l){L(i===l.dtype,function(){return"All tensors passed to stack must have matching dtypes"})});var s=e.map(function(l){return l.expandDims(t)});return nn(s,t)}}),au=j({tile_:function(r,t){var e=B(r,"x","tile",null);L(e.rank===t.length,function(){return"Error in transpose: rank of input "+e.rank+" must match length of reps "+t+"."});var n=[e],a={reps:t};return K.runKernelFunc(function(i,s){var l=i.tile(e,t);return s([e]),l},{x:e},function(i,s){var l=s[0];return{x:function(){var c=st(l);if(l.rank===1)for(var f=0;f<t[0];++f)c=c.add(i.slice([f*l.shape[0]],[l.shape[0]]));else if(l.rank===2)for(f=0;f<t[0];++f)for(var d=0;d<t[1];++d)c=c.add(i.slice([f*l.shape[0],d*l.shape[1]],[l.shape[0],l.shape[1]]));else if(l.rank===3)for(f=0;f<t[0];++f)for(d=0;d<t[1];++d)for(var v=0;v<t[2];++v)c=c.add(i.slice([f*l.shape[0],d*l.shape[1],v*l.shape[2]],[l.shape[0],l.shape[1],l.shape[2]]));else{if(l.rank!==4)throw new Error("Gradient for tile operation is not implemented for rank-"+l.rank+" tensors yet.");for(f=0;f<t[0];++f)for(d=0;d<t[1];++d)for(v=0;v<t[2];++v)for(var m=0;m<t[3];++m)c=c.add(i.slice([f*l.shape[0],d*l.shape[1],v*l.shape[2],m*l.shape[3]],[l.shape[0],l.shape[1],l.shape[2],l.shape[3]]))}return c}}},"Tile",a,n)}}),tM=j({truncatedNormal_:function(r,t,e,n,a){if(t===void 0&&(t=0),e===void 0&&(e=1),n!=null&&n==="bool")throw new Error("Unsupported data type "+n);for(var i=new by(t,e,n,!0,a),s=je(r,n),l=0;l<s.values.length;l++)s.values[l]=i.nextValue();return s.toTensor()}}),rn=j({unstack_:function(r,t){t===void 0&&(t=0),t=t||0;var e=B(r,"x","unstack");L(t>=-e.shape.length&&t<e.shape.length,function(){return"Axis = "+t+" is not in [-"+e.shape.length+", "+e.shape.length+")"}),t<0&&(t+=e.shape.length);var n={axis:t};return K.runKernelFunc(function(a){return a.unstack(e,t)},{x:e},function(a){return{x:function(){return dr(a,t)}}},"Unpack",n)}}),nM=function(r,t){return Ee(this,void 0,void 0,function(){var e,n,a,i,s,l,c,f,d,v;return Ce(this,function(m){switch(m.label){case 0:return e=B(r,"x","setdiff1d"),n=B(t,"y","setdiff1d"),L(e.dtype===n.dtype,function(){return"x and y should have the same dtype, but got x ("+e.dtype+") and y ("+n.dtype+")."}),L(e.rank===1,function(){return"x should be 1D tensor, but got x ("+e.shape+")."}),L(n.rank===1,function(){return"y should be 1D tensor, but got y ("+n.shape+")."}),[4,e.data()];case 1:return a=m.sent(),[4,n.data()];case 2:for(i=m.sent(),s=new Set(i),l=0,d=0;d<a.length;d++)s.has(a[d])||l++;for(c=new hc([l],e.dtype),f=new hc([l],"int32"),d=0,v=0;d<a.length;d++)s.has(a[d])||(c.values[v]=a[d],f.values[v]=d,v++);return[2,[c.toTensor(),f.toTensor()]]}})})};function Zh(r,t,e,n){n===void 0&&(n=!0);var a=[];if(n)(a=a.concat(t.slice(0))).push(r[0]/e),a=a.concat(r.slice(1));else{a=a.concat(r[0]);for(var i=t.length,s=0;s<i;++s)a=a.concat([r[s+1]/t[s],t[s]]);a=a.concat(r.slice(i+1))}return a}function Jh(r,t,e){e===void 0&&(e=!0);var n=[];if(e){n.push(t);for(var a=t+1;a<r;++a)a<=2*t?(n.push(a),n.push(a-(t+1))):n.push(a)}else{var i=[],s=[];for(a=1;a<r;++a)a>=2*t+1||a%2==1?s.push(a):i.push(a);n.push.apply(n,i),n.push(0),n.push.apply(n,s)}return n}function ed(r,t,e,n){n===void 0&&(n=!0);var a=[];n?a.push(r[0]/e):a.push(r[0]*e);for(var i=1;i<r.length;++i)i<=t.length?n?a.push(t[i-1]*r[i]):a.push(r[i]/t[i-1]):a.push(r[i]);return a}function OE(r,t){for(var e=[0],n=0;n<t;++n)e.push(r[n][0]);return e}function NE(r,t,e){for(var n=r.slice(0,1),a=0;a<e;++a)n.push(r[a+1]-t[a][0]-t[a][1]);return n}function ME(r,t){if(r.rank<1)throw new Error("tf.gatherND() expects the input to be rank 1 or higher, but the rank was "+r.rank+".");if(t.rank<1)throw new Error("tf.gatherND() expects the indices to be rank 1 or higher, but the rank was "+t.rank+".");if(t.dtype!=="int32")throw new Error("tf.gatherND() expects the indices to be int32 type, but the dtype was "+t.dtype+".");if(t.shape[t.rank-1]>r.rank)throw new Error("index innermost dimension length must be <= tensor rank; saw: "+t.shape[t.rank-1]+" vs. "+r.rank);if(r.size===0)throw new Error("Requested more than 0 entries, but input is empty. Input shape: "+r.shape+".");for(var e=t.shape,n=e[e.length-1],a=1,i=0;i<e.length-1;++i)a*=e[i];var s=r.shape,l=e.slice();l.pop();var c=1;for(i=n;i<r.rank;++i)c*=s[i],l.push(s[i]);var f=ma(r.shape).map(function(d){return d/c}).concat([1]).slice(0,n);return[l,a,c,f]}var IE=30;function Tm(r){return r<=IE?r:Og(r,Math.floor(Math.sqrt(r)))}function rM(r,t,e){var n=t.rank>1?t.shape[t.rank-1]:1,a=t.rank>1?t.rank-1:1,i="Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: "+e.shape+", indices.shape: "+t.shape+", shape: "+r+", sliceDim: "+n+", and batchDim: "+a+".";if(e.rank<a)throw new Error(i+" update.rank < "+a+". ");if(r.length<n+(e.rank-a))throw new Error(i+" Output shape length < "+(n+(e.rank-a)));if(e.rank!==a+r.length-n)throw new Error(i+" update.rank != "+(a+r.length-n));for(var s=0;s<a;++s)if(e.shape[s]!==t.shape[s])throw new Error(i+" updates.shape["+s+"] ("+e.shape[s]+") != indices.shape["+s+"] ("+t.shape[s]+").");for(s=0;s<e.rank-a;++s)if(e.shape[s+a]!==r[s+n])throw new Error(i+" updates.shape["+(s+a)+"] ("+e.shape[s+a]+") != shape["+(s+a)+"] ("+r[s+a]+")")}function aM(r,t,e){if(t.rank<1)throw new Error("tf.scatterND() expects the indices to be rank 1 or higher, but the rank was "+t.rank+".");if(r.rank<1)throw new Error("tf.scatterND() expects the updates to be rank 1 or higher, but the rank was "+r.rank+".");if(t.dtype!=="int32")throw new Error("The dtype of 'indices' should be int32, but got dtype: "+t.dtype);if(e.length<1)throw new Error("Output rank must be greater or equal to 1, but got shape: "+e);if(e.length===0){if(t.size===0)throw new Error("Indices specified for empty output. indices shape: "+t.shape);if(r.size===0)throw new Error("Updates specified for empty output. updates shape: "+r.shape)}rM(e,t,r)}function td(r,t,e){for(var n=t.shape.length,a=n>1?t.shape[n-1]:1,i=e.length,s=1,l=a;l<i;++l)s*=e[l];var c=a<1?1:a;return{sliceRank:a,numUpdates:Ae(t.shape)/c,sliceSize:s,strides:ma(e.slice(0,a)).concat([1]),outputSize:Ae(e)}}function iM(r,t,e){L(r.rank===t.length,function(){return"Error in slice"+r.rank+"D: Length of begin "+t+" must match the rank of the array ("+r.rank+")."}),L(r.rank===e.length,function(){return"Error in slice"+r.rank+"D: Length of size "+e+" must match the rank of the array ("+r.rank+")."});for(var n=function(i){L(t[i]+e[i]<=r.shape[i],function(){return"Error in slice"+r.rank+"D: begin["+i+"] + size["+i+"] ("+(t[i]+e[i])+") would overflow input.shape["+i+"] ("+r.shape[i]+")"})},a=0;a<r.rank;++a)n(a)}function q2(r){for(var t=[],e=0;r>0;)1&r&&t.push(e),r/=2,e++;return t}function xy(r,t,e){for(var n=[],a=0;a<r.length;a++)n[a]=Math.ceil((t[a]-r[a])/e[a]);return n}function oM(r,t,e,n,a){var i=t[a],s=e[a]||1;(r&1<<a||i==null)&&(i=s>0?Number.MIN_SAFE_INTEGER:Number.MAX_SAFE_INTEGER);var l=n[a];return i<0&&(i+=l),i=Tg(0,i,l-1)}function sM(r,t,e,n,a){var i=t[a],s=e[a]||1;(r&1<<a||i==null)&&(i=s>0?Number.MAX_SAFE_INTEGER:Number.MIN_SAFE_INTEGER);var l=n[a];return i<0&&(i+=l),i=s>0?Tg(0,i,l):Tg(-1,i,l-1)}function FE(r,t,e){for(var n=e.length,a=0;a<e.length;a++)if(e[a]>1){n=a;break}for(a=n+1;a<e.length;a++)if(t[a]>0||e[a]!==r[a])return!1;return!0}function BE(r,t){for(var e=r.length>0?r[r.length-1]:1,n=0;n<r.length-1;n++)e+=r[n]*t[n];return e}function uM(r,t){L(kg(r),function(){return"The f passed in variableGrads(f) must be a function"}),L(t==null||Array.isArray(t)&&t.every(function(d){return d instanceof Iu}),function(){return"The varList passed in variableGrads(f, varList) must be an array of variables"});var e=t!=null;if(!e)for(var n in t=[],K.registeredVariables)t.push(K.registeredVariables[n]);var a=e?t.filter(function(d){return!d.trainable}):null,i=t.length;L((t=t.filter(function(d){return d.trainable})).length>0,function(){return"variableGrads() expects at least one of the input variables to be trainable, but none of the "+i+" variables is trainable."});var s=K.gradients(r,t,null,!0),l=s.value,c=s.grads;L(c.some(function(d){return d!=null}),function(){return"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."}),L(l.rank===0,function(){return"The f passed in variableGrads(f) must return a scalar, but it returned a rank-"+l.rank+" tensor"});var f={};return t.forEach(function(d,v){c[v]!=null&&(f[d.name]=c[v])}),a!=null&&a.forEach(function(d){return f[d.name]=null}),{value:l,grads:f}}function Sd(r){return K.customGrad(r)}var ti=j({softmax_:function(r,t){t===void 0&&(t=-1);var e=B(r,"logits","softmax","float32");if(t===-1&&(t=e.rank-1),t!==e.rank-1)throw Error("Softmax along a non-last dimension is not yet supported. Logits was rank "+e.rank+" and dim was "+t);return K.runKernelFunc(function(n,a){var i=n.softmax(e,t);return a([i]),i},{logits:e},function(n,a){var i=a[0],s=n.mul(i);return{logits:function(){return s.sub(s.sum([t],!0).mul(i))}}},"Softmax",{dim:t},[],[!0])}}),lM=j({logSoftmax_:function(r,t){t===void 0&&(t=-1);var e=B(r,"logits","logSoftmax");if(t===-1&&(t=e.rank-1),t!==e.rank-1)throw Error("Log Softmax along a non-last dimension is not yet supported. Logits was rank "+e.rank+" and axis was "+t);return Sd(function(n,a){var i=n.max(t,!0),s=n.sub(i),l=s.toFloat().sub(s.exp().sum(t,!0).log());return a([l]),{value:l,gradFunc:function(c,f){var d=f[0].exp();return c.sub(c.sum(t,!0).mul(d))}}})(e)}}),LE=function(){function r(t,e){this.backend=t,this.dataMover=e,this.data=new WeakMap,this.dataIdsCount=0}return r.prototype.get=function(t){return this.data.has(t)||this.dataMover.moveData(this.backend,t),this.data.get(t)},r.prototype.set=function(t,e){this.dataIdsCount++,this.data.set(t,e)},r.prototype.has=function(t){return this.data.has(t)},r.prototype.delete=function(t){return this.dataIdsCount--,this.data.delete(t)},r.prototype.numDataIds=function(){return this.dataIdsCount},r}(),PE=function(){function r(){}return r.prototype.time=function(t){return ie("time")},r.prototype.read=function(t){return ie("read")},r.prototype.readSync=function(t){return ie("readSync")},r.prototype.numDataIds=function(){return ie("numDataIds")},r.prototype.disposeData=function(t){return ie("disposeData")},r.prototype.write=function(t,e,n){return ie("write")},r.prototype.move=function(t,e,n,a){return ie("move")},r.prototype.memory=function(){return ie("memory")},r.prototype.floatPrecision=function(){return ie("floatPrecision")},r.prototype.epsilon=function(){return this.floatPrecision()===32?1e-7:1e-4},r.prototype.batchMatMul=function(t,e,n,a){return ie("batchMatMul")},r.prototype.fusedBatchMatMul=function(t){return t.a,t.b,t.transposeA,t.transposeB,t.bias,t.activation,t.preluActivationWeights,ie("fusedBatchMatMul")},r.prototype.slice=function(t,e,n){return ie("slice")},r.prototype.stridedSlice=function(t,e,n,a){return ie("stridedSlice")},r.prototype.unstack=function(t,e){return ie("unstack")},r.prototype.reverse=function(t,e){return ie("reverse")},r.prototype.concat=function(t,e){return ie("concat")},r.prototype.neg=function(t){return ie("neg")},r.prototype.add=function(t,e){return ie("add")},r.prototype.addN=function(t){return ie("addN")},r.prototype.subtract=function(t,e){return ie("subtract")},r.prototype.multiply=function(t,e){return ie("multiply")},r.prototype.realDivide=function(t,e){return ie("realDivide")},r.prototype.floorDiv=function(t,e){return ie("floorDiv")},r.prototype.sum=function(t,e){return ie("sum")},r.prototype.prod=function(t,e){return ie("prod")},r.prototype.unsortedSegmentSum=function(t,e,n){return ie("unsortedSegmentSum")},r.prototype.argMin=function(t,e){return ie("argMin")},r.prototype.argMax=function(t,e){return ie("argMax")},r.prototype.equal=function(t,e){return ie("equal")},r.prototype.notEqual=function(t,e){return ie("notEqual")},r.prototype.less=function(t,e){return ie("less")},r.prototype.lessEqual=function(t,e){return ie("lessEqual")},r.prototype.greater=function(t,e){return ie("greater")},r.prototype.greaterEqual=function(t,e){return ie("greaterEqual")},r.prototype.logicalNot=function(t){return ie("logicalNot")},r.prototype.logicalAnd=function(t,e){return ie("logicalAnd")},r.prototype.logicalOr=function(t,e){return ie("logicalOr")},r.prototype.where=function(t){return ie("where")},r.prototype.select=function(t,e,n){return ie("select")},r.prototype.topk=function(t,e,n){return ie("topk")},r.prototype.min=function(t,e){return ie("min")},r.prototype.minimum=function(t,e){return ie("minimum")},r.prototype.mod=function(t,e){return ie("mod")},r.prototype.max=function(t,e){return ie("max")},r.prototype.maximum=function(t,e){return ie("maximum")},r.prototype.all=function(t,e){return ie("all")},r.prototype.any=function(t,e){return ie("any")},r.prototype.squaredDifference=function(t,e){return ie("squaredDifference")},r.prototype.ceil=function(t){return ie("ceil")},r.prototype.floor=function(t){return ie("floor")},r.prototype.round=function(t){return ie("round")},r.prototype.sign=function(t){return ie("sign")},r.prototype.isNaN=function(t){return ie("isNaN")},r.prototype.isInf=function(t){return ie("isInf")},r.prototype.isFinite=function(t){return ie("isFinite")},r.prototype.pow=function(t,e){return ie("pow")},r.prototype.exp=function(t){return ie("exp")},r.prototype.expm1=function(t){return ie("expm1")},r.prototype.softmax=function(t,e){return ie("softmax")},r.prototype.log=function(t){return ie("log")},r.prototype.log1p=function(t){return ie("log1p")},r.prototype.sqrt=function(t){return ie("sqrt")},r.prototype.rsqrt=function(t){return ie("rsqrt")},r.prototype.square=function(t){return ie("square")},r.prototype.reciprocal=function(t){return ie("reciprocal")},r.prototype.relu=function(t){return ie("relu")},r.prototype.relu6=function(t){return ie("relu6")},r.prototype.prelu=function(t,e){return ie("prelu")},r.prototype.elu=function(t){return ie("elu")},r.prototype.eluDer=function(t,e){return ie("eluDer")},r.prototype.selu=function(t){return ie("selu")},r.prototype.int=function(t){return ie("int")},r.prototype.clip=function(t,e,n){return ie("clip")},r.prototype.abs=function(t){return ie("abs")},r.prototype.complexAbs=function(t){return ie("complexAbs")},r.prototype.sigmoid=function(t){return ie("sigmoid")},r.prototype.softplus=function(t){return ie("softplus")},r.prototype.sin=function(t){return ie("sin")},r.prototype.cos=function(t){return ie("cos")},r.prototype.tan=function(t){return ie("tan")},r.prototype.asin=function(t){return ie("asin")},r.prototype.acos=function(t){return ie("acos")},r.prototype.atan=function(t){return ie("atan")},r.prototype.atan2=function(t,e){return ie("atan2")},r.prototype.sinh=function(t){return ie("sinh")},r.prototype.cosh=function(t){return ie("cosh")},r.prototype.tanh=function(t){return ie("tanh")},r.prototype.asinh=function(t){return ie("asinh")},r.prototype.acosh=function(t){return ie("acosh")},r.prototype.atanh=function(t){return ie("atanh")},r.prototype.erf=function(t){return ie("erf")},r.prototype.step=function(t,e){return ie("step")},r.prototype.fusedConv2d=function(t){return t.input,t.filter,t.convInfo,t.bias,t.activation,t.preluActivationWeights,ie("fusedConv2d")},r.prototype.conv2d=function(t,e,n){return ie("conv2d")},r.prototype.conv2dDerInput=function(t,e,n){return ie("conv2dDerInput")},r.prototype.conv2dDerFilter=function(t,e,n){return ie("conv2dDerFilter")},r.prototype.fusedDepthwiseConv2D=function(t){return t.input,t.filter,t.convInfo,t.bias,t.activation,t.preluActivationWeights,ie("fusedDepthwiseConv2D")},r.prototype.depthwiseConv2D=function(t,e,n){return ie("depthwiseConv2D")},r.prototype.depthwiseConv2DDerInput=function(t,e,n){return ie("depthwiseConv2DDerInput")},r.prototype.depthwiseConv2DDerFilter=function(t,e,n){return ie("depthwiseConv2DDerFilter")},r.prototype.conv3d=function(t,e,n){return ie("conv3d")},r.prototype.conv3dDerInput=function(t,e,n){return ie("conv3dDerInput")},r.prototype.conv3dDerFilter=function(t,e,n){return ie("conv3dDerFilter")},r.prototype.maxPool=function(t,e){return ie("maxPool")},r.prototype.maxPoolBackprop=function(t,e,n,a){return ie("maxPoolBackprop")},r.prototype.avgPool=function(t,e){return ie("avgPool")},r.prototype.avgPoolBackprop=function(t,e,n){return ie("avgPoolBackprop")},r.prototype.avgPool3d=function(t,e){return ie("avgPool3d")},r.prototype.avgPool3dBackprop=function(t,e,n){return ie("avgPool3dBackprop")},r.prototype.maxPool3d=function(t,e){return ie("maxPool3d")},r.prototype.maxPool3dBackprop=function(t,e,n,a){return ie("maxPool3dBackprop")},r.prototype.reshape=function(t,e){return ie("reshape")},r.prototype.cast=function(t,e){return ie("cast")},r.prototype.tile=function(t,e){return ie("tile")},r.prototype.pad=function(t,e,n){return ie("pad")},r.prototype.transpose=function(t,e){return ie("transpose")},r.prototype.gather=function(t,e,n){return ie("gather")},r.prototype.gatherND=function(t,e){return ie("gatherND")},r.prototype.scatterND=function(t,e,n){return ie("scatterND")},r.prototype.batchToSpaceND=function(t,e,n){return ie("batchToSpaceND")},r.prototype.spaceToBatchND=function(t,e,n){return ie("spaceToBatchND")},r.prototype.resizeBilinear=function(t,e,n,a){return ie("resizeBilinear")},r.prototype.resizeBilinearBackprop=function(t,e,n){return ie("resizeBilinearBackprop")},r.prototype.resizeNearestNeighbor=function(t,e,n,a){return ie("resizeNearestNeighbor")},r.prototype.resizeNearestNeighborBackprop=function(t,e,n){return ie("resizeNearestNeighborBackprop")},r.prototype.batchNormalization=function(t,e,n,a,i,s){return ie("batchNormalization")},r.prototype.localResponseNormalization4D=function(t,e,n,a,i){return ie("localResponseNormalization4D")},r.prototype.LRNGrad=function(t,e,n,a,i,s,l){return ie("LRNGrad")},r.prototype.multinomial=function(t,e,n,a){return ie("multinomial")},r.prototype.oneHot=function(t,e,n,a){return ie("oneHot")},r.prototype.cumsum=function(t,e,n,a){return ie("cumsum")},r.prototype.nonMaxSuppression=function(t,e,n,a,i){return ie("nonMaxSuppression")},r.prototype.fft=function(t){return ie("fft")},r.prototype.ifft=function(t){return ie("ifft")},r.prototype.complex=function(t,e){return ie("complex")},r.prototype.real=function(t){return ie("real")},r.prototype.imag=function(t){return ie("imag")},r.prototype.cropAndResize=function(t,e,n,a,i,s){return ie("cropAndResize")},r.prototype.depthToSpace=function(t,e,n){return ie("depthToSpace")},r.prototype.split=function(t,e,n){return ie("split")},r.prototype.sparseToDense=function(t,e,n,a){return ie("sparseToDense")},r.prototype.diag=function(t){return ie("diag")},r.prototype.fill=function(t,e,n){return ie("fill")},r.prototype.onesLike=function(t){return ie("onesLike")},r.prototype.zerosLike=function(t){return ie("zerosLike")},r.prototype.linspace=function(t,e,n){return ie("linspace")},r.prototype.dispose=function(){return ie("dispose")},r}();function ie(r){throw new Error("'"+r+"' not yet implemented or not found in the registry. Did you forget to import the kernel?")}function $i(r,t){for(var e=r.length,n=[],a=0;a<e;a++){var i=e-1-a,s=r[i]||1;(t[t.length-1-a]||1)>1&&s===1&&n.unshift(i)}return n}function an(r,t){for(var e=[],n=0;n<t.length;n++){var a=r[r.length-n-1],i=t.length-n-1,s=t[i];(a==null||a===1&&s>1)&&e.unshift(i)}return e}function at(r,t){for(var e=[],n=Math.max(r.length,t.length),a=0;a<n;a++){var i=r[r.length-a-1];i==null&&(i=1);var s=t[t.length-a-1];if(s==null&&(s=1),i===1)e.unshift(s);else if(s===1)e.unshift(i);else{if(i!==s)throw Error("Operands could not be broadcast together with shapes "+r+" and "+t+".");e.unshift(i)}}return e}function pc(r,t,e,n,a,i,s){s===void 0&&(s="channelsLast");var l,c=ad(t),f=c[0],d=c[1];if(s==="channelsLast")l=[f,d,r[3],r[3]];else{if(s!=="channelsFirst")throw new Error("Unknown dataFormat "+s);l=[f,d,r[1],r[1]]}return ts(r,l,e,n,a,i,!1,s)}function nd(r,t,e,n,a,i,s){s===void 0&&(s="NDHWC");var l,c,f=Pg(t),d=f[0],v=f[1],m=f[2];if(s==="NDHWC")c="channelsLast",l=[d,v,m,r[4],r[4]];else{if(s!=="NCDHW")throw new Error("Unknown dataFormat "+s);c="channelsFirst",l=[d,v,m,r[1],r[1]]}return rd(r,l,e,n,a,!1,c,i)}function ts(r,t,e,n,a,i,s,l){s===void 0&&(s=!1),l===void 0&&(l="channelsLast");var c=[-1,-1,-1,-1],f=c[0],d=c[1],v=c[2],m=c[3];if(l==="channelsLast")f=r[0],d=r[1],v=r[2],m=r[3];else{if(l!=="channelsFirst")throw new Error("Unknown dataFormat "+l);f=r[0],m=r[1],d=r[2],v=r[3]}var g,b=t[0],w=t[1],_=t[3],S=ad(e),E=S[0],C=S[1],R=ad(n),A=R[0],D=R[1],k=iu(b,A),I=iu(w,D),O=function(te,ne,P,W,X,re,F,q){var oe,se,pe;if(typeof te=="number"){oe={top:te,bottom:te,left:te,right:te,type:te===0?"VALID":"NUMBER"};var ge=function(Pe,qe,Qe,dt,Et){dt==null&&(dt=zE(Pe,qe,Qe));var xt=Pe[0],Ut=Pe[1],mr=tc((xt-qe+2*dt)/Qe+1,Et);L(jt(mr),function(){return"The output # of rows ("+mr+") must be an integer. Change the stride and/or zero pad parameters"});var En=tc((Ut-qe+2*dt)/Qe+1,Et);return L(jt(En),function(){return"The output # of columns ("+En+") must be an integer. Change the stride and/or zero pad parameters"}),[mr,En]}([ne,P],re,W,te,q);se=ge[0],pe=ge[1]}else if(te==="same"){se=Math.ceil(ne/W),pe=Math.ceil(P/X);var ve=Math.max(0,(se-1)*W+re-ne),Ne=Math.max(0,(pe-1)*X+F-P),be=Math.floor(ve/2),Ie=ve-be,lt=Math.floor(Ne/2);oe={top:be,bottom:Ie,left:lt,right:Ne-lt,type:"SAME"}}else{if(te!=="valid")throw Error("Unknown padding parameter: "+te);oe={top:0,bottom:0,left:0,right:0,type:"VALID"},se=Math.ceil((ne-re+1)/W),pe=Math.ceil((P-F+1)/X)}return{padInfo:oe,outHeight:se,outWidth:pe}}(a,d,v,E,C,k,I,i),M=O.padInfo,V=O.outHeight,z=O.outWidth,J=s?_*m:_;return l==="channelsFirst"?g=[f,J,V,z]:l==="channelsLast"&&(g=[f,V,z,J]),{batchSize:f,dataFormat:l,inHeight:d,inWidth:v,inChannels:m,outHeight:V,outWidth:z,outChannels:J,padInfo:M,strideHeight:E,strideWidth:C,filterHeight:b,filterWidth:w,effectiveFilterHeight:k,effectiveFilterWidth:I,dilationHeight:A,dilationWidth:D,inShape:r,outShape:g,filterShape:t}}function rd(r,t,e,n,a,i,s,l){i===void 0&&(i=!1),s===void 0&&(s="channelsLast");var c=[-1,-1,-1,-1,-1],f=c[0],d=c[1],v=c[2],m=c[3],g=c[4];if(s==="channelsLast")f=r[0],d=r[1],v=r[2],m=r[3],g=r[4];else{if(s!=="channelsFirst")throw new Error("Unknown dataFormat "+s);f=r[0],g=r[1],d=r[2],v=r[3],m=r[4]}var b,w=t[0],_=t[1],S=t[2],E=t[4],C=Pg(e),R=C[0],A=C[1],D=C[2],k=Pg(n),I=k[0],O=k[1],M=k[2],V=iu(w,I),z=iu(_,O),J=iu(S,M),te=function(F,q,oe,se,pe,ge,ve,Ne,be,Ie,lt){var Pe,qe,Qe,dt;if(typeof F=="number"){Pe={top:F,bottom:F,left:F,right:F,front:F,back:F,type:F===0?"VALID":"NUMBER"};var Et=function(oi,Fr,Ca,Wt,$t,gn){$t==null&&($t=zE(oi,Fr,Wt));var Pd=oi[0],zd=oi[1],Ud=oi[2],si=tc((Pd-Fr+2*$t)/Wt+1,gn);L(jt(si),function(){return"The output # of depths ("+si+") must be an integer. Change the stride and/or zero pad parameters"});var ui=tc((zd-Fr+2*$t)/Wt+1,gn);L(jt(ui),function(){return"The output # of rows ("+ui+") must be an integer. Change the stride and/or zero pad parameters"});var Br=tc((Ud-Fr+2*$t)/Wt+1,gn);return L(jt(Br),function(){return"The output # of columns ("+Br+") must be an integer. Change the stride and/or zero pad parameters"}),[si,ui,Br,Ca]}([q,oe,se,1],Ne,1,pe,F,lt);qe=Et[0],Qe=Et[1],dt=Et[2]}else if(F==="same"){qe=Math.ceil(q/pe),Qe=Math.ceil(oe/ge),dt=Math.ceil(se/ve);var xt=(qe-1)*pe+Ne-q,Ut=(Qe-1)*ge+be-oe,mr=(dt-1)*ve+Ie-se,En=Math.floor(xt/2),Ea=xt-En,Un=Math.floor(Ut/2),Yr=Ut-Un,gr=Math.floor(mr/2);Pe={top:Un,bottom:Yr,left:gr,right:mr-gr,front:En,back:Ea,type:"SAME"}}else{if(F!=="valid")throw Error("Unknown padding parameter: "+F);Pe={top:0,bottom:0,left:0,right:0,front:0,back:0,type:"VALID"},qe=Math.ceil((q-Ne+1)/pe),Qe=Math.ceil((oe-be+1)/ge),dt=Math.ceil((se-Ie+1)/ve)}return{padInfo:Pe,outDepth:qe,outHeight:Qe,outWidth:dt}}(a,d,v,m,R,A,D,V,z,J,l),ne=te.padInfo,P=te.outDepth,W=te.outHeight,X=te.outWidth,re=i?E*g:E;return s==="channelsFirst"?b=[f,re,P,W,X]:s==="channelsLast"&&(b=[f,P,W,X,re]),{batchSize:f,dataFormat:s,inDepth:d,inHeight:v,inWidth:m,inChannels:g,outDepth:P,outHeight:W,outWidth:X,outChannels:re,padInfo:ne,strideDepth:R,strideHeight:A,strideWidth:D,filterDepth:w,filterHeight:_,filterWidth:S,effectiveFilterDepth:V,effectiveFilterHeight:z,effectiveFilterWidth:J,dilationDepth:I,dilationHeight:O,dilationWidth:M,inShape:r,outShape:b,filterShape:t}}function zE(r,t,e,n){n===void 0&&(n=1);var a=iu(t,n);return Math.floor((r[0]*(e-1)-e+a)/2)}function ad(r){return typeof r=="number"?[r,r,r]:r.length===2?[r[0],r[1],1]:r}function Pg(r){return typeof r=="number"?[r,r,r]:r}function iu(r,t){return t<=1?r:r+(r-1)*(t-1)}function tc(r,t){if(!t)return r;switch(t){case"round":return Math.round(r);case"ceil":return Math.ceil(r);case"floor":return Math.floor(r);default:throw new Error("Unknown roundingMode "+t)}}function Bu(r){var t=ad(r),e=t[0],n=t[1],a=t[2];return e===1&&n===1&&a===1}function Jn(r,t){return Bu(r)||Bu(t)}function wy(r){if(r==="NHWC")return"channelsLast";if(r==="NCHW")return"channelsFirst";throw new Error("Unknown dataFormat "+r)}function UE(r,t,e){if(t==="complex64"){if(r.dtype==="complex64")return r.clone();var n=Dt(r.shape),a=r.toFloat(),i=e.complex(a,n);return n.dispose(),a.dispose(),i}if(!B3(r.dtype,t))return K.makeTensorFromDataId(r.dataId,r.shape,t);if(r.dtype==="complex64"){var s=e.real(r);return i=s.cast(t),s.dispose(),i}if(t==="int32")return e.int(r);if(t==="bool"){var l=ye(0,r.dtype);return i=e.notEqual(r,l),l.dispose(),i}throw new Error("Error in Cast: failed to cast "+r.dtype+" to "+t)}function zg(r,t){return K.makeTensorFromDataId(r.dataId,t,r.dtype)}function VE(r,t,e){var n=(t-r)/(e-1),a=Dc(e,"float32");a[0]=r;for(var i=1;i<a.length;i++)a[i]=a[i-1]+n;return Xt(a,"float32")}function Ug(r,t){if(r.length!==t.length)throw new Error("Cannot merge real and imag arrays of different lengths. real:"+r.length+", imag: "+t.length+".");for(var e=new Float32Array(2*r.length),n=0;n<e.length;n+=2)e[n]=r[n/2],e[n+1]=t[n/2];return e}function K2(r,t){return{real:r[2*t],imag:r[2*t+1]}}function cM(r,t,e,n){r[2*n]=t,r[2*n+1]=e}function fM(r,t,e){var n=(e?2:-2)*Math.PI*(r/t);return{real:Math.cos(n),imag:Math.sin(n)}}function hM(r,t,e){var n=function(i,s,l){return function(c,f,d){for(var v=0,m=c.length,g=0,b=!1;v<m;){var w=d(f,c[g=v+(m-v>>>1)]);w>0?v=g+1:(m=g,b=!w)}return b?v:-v-1}(i,s,l||dM)}(r,t,e),a=n<0?-(n+1):n;r.splice(a,0,t)}function dM(r,t){return r>t?1:r<t?-1:0}function _y(r,t,e,n,a){return HE(r,t,e,n,a,0).selectedIndices}function Sy(r,t,e,n,a,i){var s=HE(r,t,e,n,a,i);return s.numValidOutputs.dispose(),{selectedIndices:s.selectedIndices,selectedScores:s.selectedScores}}function HE(r,t,e,n,a,i,s,l){l===void 0&&(l=!1);for(var c=Array.from(t).map(function(R,A){return{score:R,boxIndex:A,suppressBeginIndex:0}}).filter(function(R){return R.score>a}).sort(X2),f=i>0?-.5/i:0,d=[],v=[];d.length<e&&c.length>0;){var m=c.pop(),g=m.score,b=m.boxIndex,w=m.suppressBeginIndex;if(g<a)break;for(var _=!1,S=d.length-1;S>=w;--S){var E=pM(r,b,d[S]);if(E>=n){_=!0;break}if(m.score=m.score*vM(n,f,E),m.score<=a)break}m.suppressBeginIndex=d.length,_||(m.score===g?(d.push(b),v.push(m.score)):m.score>a&&hM(c,m,X2))}var C=d.length;return l&&(d.fill(0,C),v.fill(0,C)),{selectedIndices:Xt(d,"int32"),selectedScores:Xt(v,"float32"),numValidOutputs:ye(C,"int32")}}function pM(r,t,e){var n=r.subarray(4*t,4*t+4),a=r.subarray(4*e,4*e+4),i=Math.min(n[0],n[2]),s=Math.min(n[1],n[3]),l=Math.max(n[0],n[2]),c=Math.max(n[1],n[3]),f=Math.min(a[0],a[2]),d=Math.min(a[1],a[3]),v=Math.max(a[0],a[2]),m=Math.max(a[1],a[3]),g=(l-i)*(c-s),b=(v-f)*(m-d);if(g<=0||b<=0)return 0;var w=Math.max(i,f),_=Math.max(s,d),S=Math.min(l,v),E=Math.min(c,m),C=Math.max(S-w,0)*Math.max(E-_,0);return C/(g+b-C)}function vM(r,t,e){var n=Math.exp(t*e*e);return e<=r?n:0}function X2(r,t){return r.score-t.score||r.score===t.score&&t.boxIndex-r.boxIndex}function jE(r,t,e){var n=new Array(r.rank).fill(0),a=r.shape.slice();return t.map(function(i){a[e]=i;var s=r.slice(n,a);return n[e]+=i,s})}function WE(r,t){for(var e=new Array(r.rank),n=0;n<e.length;n++)e[n]=r.shape[n]*t[n];var a=je(e,r.dtype);for(n=0;n<a.values.length;++n){for(var i=a.indexToLoc(n),s=new Array(r.rank),l=0;l<s.length;l++)s[l]=i[l]%r.shape[l];var c=r.locToIndex(s);a.values[n]=r.values[c]}return a.toTensor()}function GE(r,t,e,n,a){for(var i=t[t.length-1],s=[r.length/i,i],l=s[0],c=s[1],f=fc(e,l*n),d=fc("int32",l*n),v=0;v<l;v++){for(var m=v*c,g=r.subarray(m,m+c),b=[],w=0;w<g.length;w++)b.push({value:g[w],index:w});b.sort(function(R,A){return A.value-R.value});var _=v*n,S=f.subarray(_,_+n),E=d.subarray(_,_+n);for(w=0;w<n;w++)S[w]=b[w].value,E[w]=b[w].index}var C=t.slice();return C[C.length-1]=n,[Sn(f,C,e),Sn(d,C,"int32")]}function Ey(r,t){for(var e=[],n=0;n<t.length;n++)t[n]&&e.push(n);var a=je(r,"int32"),i=je([e.length,r.length],"int32");for(n=0;n<e.length;n++){var s=a.indexToLoc(e[n]),l=n*r.length;i.values.set(s,l)}return i.toTensor()}var mM=function(r,t){this.outputShape=[],this.outputShape=r,this.variableNames=t.map(function(a,i){return"T"+i});var e=[];this.variableNames.forEach(function(a){e.push("float v"+a+" = get"+a+"AtOutCoords();")});var n=this.variableNames.map(function(a){return"v"+a}).join(" + ");this.userCode=`
      void main() {
        `+e.join(`
        `)+`

        float result = `+n+`;
        setOutput(result);
      }
    `},gM=function(r,t){this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=r,this.variableNames=t.map(function(a,i){return"T"+i});var e=[];this.variableNames.forEach(function(a){e.push("vec4 v"+a+" = get"+a+"AtOutCoords();")});var n=this.variableNames.map(function(a){return"v"+a}).join(" + ");this.userCode=`
      void main() {
        `+e.join(`
        `)+`

        vec4 result = `+n+`;
        setOutput(result);
      }
    `},yM=function(r,t,e){this.variableNames=["A"];var n=r.windowSize,a=r.batchSize,i=r.inSize,s=Math.ceil(i/n);e||this.variableNames.push("bestIndicesA"),this.outputShape=[a,s];var l=t==="max"?">":"<",c=e?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));";this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * `+n+`;

        int bestIndex = inOffset;
        float bestValue = getA(batch, bestIndex);

        for (int i = 0; i < `+n+`; i++) {
          int inIdx = `+c+`;
          float candidate = getA(batch, inIdx);
          if (candidate `+l+` bestValue) {
            bestValue = candidate;
            bestIndex = inIdx;
          }
        }
        setOutput(float(bestIndex));
      }
    `};function qE(r,t){return["x","y","z","w","u","v"].slice(0,t).map(function(e){return r+"."+e})}function $n(r,t){return t===1?[r]:qE(r,t)}function On(){var r,t,e,n,a,i,s,l,c,f;return le().getNumber("WEBGL_VERSION")===2?(r="#version 300 es",t="in",e="out",n="in",a="texture",i="outputColor",s="out vec4 outputColor;",l=`
      bool isnan_custom(float val) {
        return (val > 0.0 || val < 0.0) ? false : val != 0.0;
      }

      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan_custom(val.x),
          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));
      }

      #define isnan(value) isnan_custom(value)
    `,c="",f=`
      #define round(value) newRound(value)
      int newRound(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 newRound(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `):(r="",t="attribute",e="varying",n="varying",a="texture2D",i="gl_FragColor",s="",l=`
      #define isnan(value) isnan_custom(value)
      bool isnan_custom(float val) {
        return (val > 0. || val < 1. || val == 0.) ? false : true;
      }
      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));
      }
    `,c=`
      uniform float INFINITY;

      bool isinf(float val) {
        return abs(val) == INFINITY;
      }
      bvec4 isinf(vec4 val) {
        return equal(abs(val), vec4(INFINITY));
      }
    `,f=`
      int round(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 round(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `),{version:r,attribute:t,varyingVs:e,varyingFs:n,texture2D:a,output:i,defineOutput:s,defineSpecialNaN:l,defineSpecialInf:c,defineRound:f}}function Io(r,t,e){e===void 0&&(e="index");var n=ma(t);return n.map(function(a,i){return"int "+r[i]+" = "+e+" / "+a+"; "+(i===n.length-1?"int "+r[i+1]+" = "+e+" - "+r[i]+" * "+a:"index -= "+r[i]+" * "+a)+";"}).join("")}function Cy(r){var t=ma(r).map(function(e){return e.toString()});return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * `+t[0]+" + coords.y * "+t[1]+` + coords.z;
  }
`}var KE=`
  const float FLOAT_MAX = 1.70141184e38;
  const float FLOAT_MIN = 1.17549435e-38;

  lowp vec4 encode_float(highp float v) {
    if (isnan(v)) {
      return vec4(255, 255, 255, 255);
    }

    highp float av = abs(v);

    if(av < FLOAT_MIN) {
      return vec4(0.0, 0.0, 0.0, 0.0);
    } else if(v > FLOAT_MAX) {
      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;
    } else if(v < -FLOAT_MAX) {
      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;
    }

    highp vec4 c = vec4(0,0,0,0);

    highp float e = floor(log2(av));
    highp float m = exp2(fract(log2(av))) - 1.0;

    c[2] = floor(128.0 * m);
    m -= c[2] / 128.0;
    c[1] = floor(32768.0 * m);
    m -= c[1] / 32768.0;
    c[0] = floor(8388608.0 * m);

    highp float ebias = e + 127.0;
    c[3] = floor(ebias / 2.0);
    ebias -= c[3] * 2.0;
    c[2] += floor(ebias) * 128.0;

    c[3] += 128.0 * step(0.0, -v);

    return c / 255.0;
  }
`;function bM(r,t,e,n){var a=[];r.forEach(function(g){var b=Ae(g.shapeInfo.logicalShape);g.shapeInfo.isUniform?a.push("uniform float "+g.name+(b>1?"["+b+"]":"")+";"):(a.push("uniform sampler2D "+g.name+";"),a.push("uniform int offset"+g.name+";"))});var i,s,l=a.join(`
`),c=r.map(function(g){return function(b,w,_){_===void 0&&(_=!1);var S="";S+=_?XE(b):Qs(b);var E=b.shapeInfo.logicalShape,C=w.logicalShape;return E.length<=C.length&&(S+=_?function(R,A){var D,k=R.name,I=k.charAt(0).toUpperCase()+k.slice(1),O="get"+I+"AtOutCoords",M=R.shapeInfo.logicalShape.length,V=A.logicalShape.length,z=$i(R.shapeInfo.logicalShape,A.logicalShape),J=At(V),te=V-M,ne=["x","y","z","w","u","v"];D=M===0?"":V<2&&z.length>=1?"coords = 0;":z.map(function(oe){return"coords."+ne[oe+te]+" = 0;"}).join(`
`);var P="";P=V<2&&M>0?"coords":R.shapeInfo.logicalShape.map(function(oe,se){return"coords."+ne[se+te]}).join(", ");var W="return outputValue;",X=Ae(R.shapeInfo.logicalShape)===1,re=Ae(A.logicalShape)===1;if(M!==1||X||re){if(X&&!re)W=V===1?`
        return vec4(outputValue.x, outputValue.x, 0., 0.);
      `:`
        return vec4(outputValue.x);
      `;else if(z.length){var F=M-2,q=M-1;z.indexOf(F)>-1&&z.indexOf(q)>-1?W="return vec4(outputValue.x);":z.indexOf(F)>-1?W="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":z.indexOf(q)>-1&&(W="return vec4(outputValue.xx, outputValue.zz);")}}else W=`
      return vec4(outputValue.xy, outputValue.xy);
    `;return`
    vec4 `+O+`() {
      `+J+` coords = getOutputCoords();
      `+D+`
      vec4 outputValue = get`+I+"("+P+`);
      `+W+`
    }
  `}(b,w):function(R,A){var D=R.name,k=D.charAt(0).toUpperCase()+D.slice(1),I="get"+k+"AtOutCoords",O=A.texShape,M=R.shapeInfo.texShape,V=R.shapeInfo.logicalShape.length,z=A.logicalShape.length;if(!R.shapeInfo.isUniform&&V===z&&R.shapeInfo.flatOffset==null&&vn(M,O))return`
      float `+I+`() {
        return sampleTexture(`+D+`, resultUV);
      }
    `;var J,te=At(z),ne=$i(R.shapeInfo.logicalShape,A.logicalShape),P=z-V,W=["x","y","z","w","u","v"];J=V===0?"":z<2&&ne.length>=1?"coords = 0;":ne.map(function(re){return"coords."+W[re+P]+" = 0;"}).join(`
`);var X="";return X=z<2&&V>0?"coords":R.shapeInfo.logicalShape.map(function(re,F){return"coords."+W[F+P]}).join(", "),`
    float `+I+`() {
      `+te+` coords = getOutputCoords();
      `+J+`
      return get`+k+"("+X+`);
    }
  `}(b,w)),S}(g,t,n)}).join(`
`),f=t.texShape,d=On(),v=function(g){return`
    float sampleTexture(sampler2D textureSampler, vec2 uv) {
      return `+g.texture2D+`(textureSampler, uv).r;
    }
  `}(d),m=function(g){return g.version+`
    precision highp float;
    precision highp int;
    precision highp sampler2D;
    `+g.varyingFs+` vec2 resultUV;
    `+g.defineOutput+`
    const vec2 halfCR = vec2(0.5, 0.5);

    struct ivec5
    {
      int x;
      int y;
      int z;
      int w;
      int u;
    };

    struct ivec6
    {
      int x;
      int y;
      int z;
      int w;
      int u;
      int v;
    };

    uniform float NAN;
    `+g.defineSpecialNaN+`
    `+g.defineSpecialInf+`
    `+g.defineRound+`

    int imod(int x, int y) {
      return x - y * (x / y);
    }

    int idiv(int a, int b, float sign) {
      int res = a / b;
      int mod = imod(a, b);
      if (sign < 0. && mod != 0) {
        res -= 1;
      }
      return res;
    }

    //Based on the work of Dave Hoskins
    //https://www.shadertoy.com/view/4djSRW
    #define HASHSCALE1 443.8975
    float random(float seed){
      vec2 p = resultUV * seed;
      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);
      p3 += dot(p3, p3.yzx + 19.19);
      return fract((p3.x + p3.y) * p3.z);
    }

    `+xM+`
    `+wM+`
    `+_M+`
  `}(d);return t.isPacked?(i=function(g,b){switch(g.length){case 0:return`
    int getOutputCoords() {
      return 0;
    }
  `;case 1:return function(R,A){var D=[Math.ceil(A[0]/2),Math.ceil(A[1]/2)];return D[0]===1?`
      int getOutputCoords() {
        return 2 * int(resultUV.x * `+D[1]+`.0);
      }
    `:D[1]===1?`
      int getOutputCoords() {
        return 2 * int(resultUV.y * `+D[0]+`.0);
      }
    `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+D[0]+", "+D[1]+`));
      return 2 * (resTexRC.x * `+D[1]+` + resTexRC.y);
    }
  `}(0,b);case 2:return function(R,A){var D=[Math.ceil(A[0]/2),Math.ceil(A[1]/2)];if(vn(R,A))return`
      ivec2 getOutputCoords() {
        return 2 * ivec2(resultUV.yx * vec2(`+D[0]+", "+D[1]+`));
      }
    `;var k=Math.ceil(R[1]/2);return`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+D[0]+", "+D[1]+`));

      int index = resTexRC.x * `+D[1]+` + resTexRC.y;
      int r = 2 * (index / `+k+`);
      int c = imod(index, `+k+`) * 2;

      return ivec2(r, c);
    }
  `}(g,b);case 3:return w=g,_=b,S=[Math.ceil(_[0]/2),Math.ceil(_[1]/2)],E=Math.ceil(w[2]/2),C=E*Math.ceil(w[1]/2),`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+S[0]+", "+S[1]+`));
      int index = resTexRC.x * `+S[1]+` + resTexRC.y;

      int b = index / `+C+`;
      index -= b * `+C+`;

      int r = 2 * (index / `+E+`);
      int c = imod(index, `+E+`) * 2;

      return ivec3(b, r, c);
    }
  `;default:return function(R,A){for(var D=[Math.ceil(A[0]/2),Math.ceil(A[1]/2)],k=Math.ceil(R[R.length-1]/2),I=k*Math.ceil(R[R.length-2]/2),O=I,M="",V="b, r, c",z=2;z<R.length-1;z++)O*=R[R.length-z-1],M=`
      int b`+z+" = index / "+O+`;
      index -= b`+z+" * "+O+`;
    `+M,V="b"+z+", "+V;return`
    ivec`+R.length+` getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+D[0]+", "+D[1]+`));
      int index = resTexRC.x * `+D[1]+` + resTexRC.y;

      `+M+`

      int b = index / `+I+`;
      index -= b * `+I+`;

      int r = 2 * (index / `+k+`);
      int c = imod(index, `+k+`) * 2;

      return ivec`+R.length+"("+V+`);
    }
  `}(g,b)}var w,_,S,E,C}(t.logicalShape,f),s=function(g){return`
    void setOutput(vec4 val) {
      `+g.output+` = val;
    }
  `}(d)):(i=function(g,b){switch(g.length){case 0:return`
    int getOutputCoords() {
      return 0;
    }
  `;case 1:return function(S,E){return E[0]===1?`
      int getOutputCoords() {
        return int(resultUV.x * `+E[1]+`.0);
      }
    `:E[1]===1?`
      int getOutputCoords() {
        return int(resultUV.y * `+E[0]+`.0);
      }
    `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+E[0]+", "+E[1]+`));
      return resTexRC.x * `+E[1]+` + resTexRC.y;
    }
  `}(0,b);case 2:return function(S,E){return vn(S,E)?`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(`+E[0]+", "+E[1]+`));
      }
    `:S[1]===1?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(`+E[0]+", "+E[1]+`));
        int index = resTexRC.x * `+E[1]+` + resTexRC.y;
        return ivec2(index, 0);
      }
    `:S[0]===1?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(`+E[0]+", "+E[1]+`));
        int index = resTexRC.x * `+E[1]+` + resTexRC.y;
        return ivec2(0, index);
      }
    `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+E[0]+", "+E[1]+`));
      int index = resTexRC.x * `+E[1]+` + resTexRC.y;
      int r = index / `+S[1]+`;
      int c = index - r * `+S[1]+`;
      return ivec2(r, c);
    }
  `}(g,b);case 3:return w=b,_=Io(["r","c","d"],g),`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+w[0]+", "+w[1]+`));
      int index = resTexRC.x * `+w[1]+` + resTexRC.y;
      `+_+`
      return ivec3(r, c, d);
    }
  `;case 4:return function(S,E){var C=Io(["r","c","d","d2"],S);return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(`+E[0]+", "+E[1]+`));
      int index = resTexRC.x * `+E[1]+` + resTexRC.y;
      `+C+`
      return ivec4(r, c, d, d2);
    }
  `}(g,b);case 5:return function(S,E){var C=Io(["r","c","d","d2","d3"],S);return`
    ivec5 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx * vec2(`+E[0]+`,
                             `+E[1]+`));

      int index = resTexRC.x * `+E[1]+` + resTexRC.y;

      `+C+`

      ivec5 outShape = ivec5(r, c, d, d2, d3);
      return outShape;
    }
  `}(g,b);case 6:return function(S,E){var C=Io(["r","c","d","d2","d3","d4"],S);return`
    ivec6 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(`+E[0]+", "+E[1]+`));
      int index = resTexRC.x * `+E[1]+` + resTexRC.y;

      `+C+`

      ivec6 result = ivec6(r, c, d, d2, d3, d4);
      return result;
    }
  `}(g,b);default:throw new Error(g.length+"-D output sampling is not yet supported")}var w,_}(t.logicalShape,f),s=function(g){return`
    void setOutput(float val) {
      `+g.output+` = vec4(val, 0, 0, 0);
    }
  `}(d)),n&&(m+=SM),[m,v,s,l,i,c,e].join(`
`)}function Qs(r){var t=r.shapeInfo.logicalShape;switch(t.length){case 0:return function(e){var n=e.name,a="get"+n.charAt(0).toUpperCase()+n.slice(1);if(e.shapeInfo.isUniform)return"float "+a+"() {return "+n+";}";var i=e.shapeInfo.texShape,s=i[0],l=i[1];if(s===1&&l===1)return`
      float `+a+`() {
        return sampleTexture(`+n+`, halfCR);
      }
    `;var c=e.shapeInfo.texShape,f=c[0],d=c[1],v=Do(n);return`
    float `+a+`() {
      vec2 uv = uvFromFlat(`+f+", "+d+", "+v+`);
      return sampleTexture(`+n+`, uv);
    }
  `}(r);case 1:return function(e){var n=e.name,a="get"+n.charAt(0).toUpperCase()+n.slice(1);if(e.shapeInfo.isUniform)return`
      float `+a+`(int index) {
        `+Gs(e)+`
      }
    `;var i=e.shapeInfo.texShape,s=i[0],l=i[1];if(l===1&&s===1)return`
      float `+a+`(int index) {
        return sampleTexture(`+n+`, halfCR);
      }
    `;var c=Do(n);return l===1?`
      float `+a+`(int index) {
        vec2 uv = vec2(0.5, (float(index + `+c+") + 0.5) / "+s+`.0);
        return sampleTexture(`+n+`, uv);
      }
    `:s===1?`
      float `+a+`(int index) {
        vec2 uv = vec2((float(index + `+c+") + 0.5) / "+l+`.0, 0.5);
        return sampleTexture(`+n+`, uv);
      }
    `:`
    float `+a+`(int index) {
      vec2 uv = uvFromFlat(`+s+", "+l+", index + "+c+`);
      return sampleTexture(`+n+`, uv);
    }
  `}(r);case 2:return function(e){var n=e.shapeInfo.logicalShape,a=e.name,i="get"+a.charAt(0).toUpperCase()+a.slice(1),s=e.shapeInfo.texShape;if(s!=null&&vn(n,s)){var l=s[0],c=s[1];return`
    float `+i+`(int row, int col) {
      vec2 uv = (vec2(col, row) + halfCR) / vec2(`+c+".0, "+l+`.0);
      return sampleTexture(`+a+`, uv);
    }
  `}var f=No(n),d=f.newShape,v=f.keptDims,m=d;if(m.length<n.length){var g=Zs(e,m);return`
      `+Qs(g)+`
      float `+i+`(int row, int col) {
        return `+i+"("+Js(["row","col"],v)+`);
      }
    `}if(e.shapeInfo.isUniform)return`
      float `+i+`(int row, int col) {
        int index = round(dot(vec2(row, col), vec2(`+n[1]+`, 1)));
        `+Gs(e)+`
      }
    `;var b=s[0],w=s[1],_=Do(a);return w===1?`
    float `+i+`(int row, int col) {
      float index = dot(vec3(row, col, `+_+"), vec3("+n[1]+`, 1, 1));
      vec2 uv = vec2(0.5, (index + 0.5) / `+b+`.0);
      return sampleTexture(`+a+`, uv);
    }
  `:b===1?`
    float `+i+`(int row, int col) {
      float index = dot(vec3(row, col, `+_+"), vec3("+n[1]+`, 1, 1));
      vec2 uv = vec2((index + 0.5) / `+w+`.0, 0.5);
      return sampleTexture(`+a+`, uv);
    }
  `:`
  float `+i+`(int row, int col) {
    // Explicitly use integer operations as dot() only works on floats.
    int index = row * `+n[1]+" + col + "+_+`;
    vec2 uv = uvFromFlat(`+b+", "+w+`, index);
    return sampleTexture(`+a+`, uv);
  }
`}(r);case 3:return function(e){var n=e.shapeInfo.logicalShape,a=e.name,i="get"+a.charAt(0).toUpperCase()+a.slice(1),s=n[1]*n[2],l=n[2],c=No(n),f=c.newShape,d=c.keptDims,v=f;if(v.length<n.length){var m=Zs(e,v);return`
        `+Qs(m)+`
        float `+i+`(int row, int col, int depth) {
          return `+i+"("+Js(["row","col","depth"],d)+`);
        }
      `}if(e.shapeInfo.isUniform)return`
      float `+i+`(int row, int col, int depth) {
        int index = round(dot(vec3(row, col, depth),
                          vec3(`+s+", "+l+`, 1)));
        `+Gs(e)+`
      }
    `;var g=e.shapeInfo.texShape,b=g[0],w=g[1],_=e.shapeInfo.flatOffset;if(w===s&&_==null)return`
        float `+i+`(int row, int col, int depth) {
          float texR = float(row);
          float texC = dot(vec2(col, depth), vec2(`+l+`, 1));
          vec2 uv = (vec2(texC, texR) + halfCR) /
                     vec2(`+w+".0, "+b+`.0);
          return sampleTexture(`+a+`, uv);
        }
      `;if(w===l&&_==null)return`
    float `+i+`(int row, int col, int depth) {
      float texR = dot(vec2(row, col), vec2(`+n[1]+`, 1));
      float texC = float(depth);
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(`+w+".0, "+b+`.0);
      return sampleTexture(`+a+`, uv);
    }
  `;var S=Do(a);return`
      float `+i+`(int row, int col, int depth) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * `+s+" + col * "+l+" + depth + "+S+`;
        vec2 uv = uvFromFlat(`+b+", "+w+`, index);
        return sampleTexture(`+a+`, uv);
      }
  `}(r);case 4:return function(e){var n=e.shapeInfo.logicalShape,a=e.name,i="get"+a.charAt(0).toUpperCase()+a.slice(1),s=n[3],l=n[2]*s,c=n[1]*l,f=No(n),d=f.newShape,v=f.keptDims;if(d.length<n.length){var m=Zs(e,d);return`
      `+Qs(m)+`
      float `+i+`(int row, int col, int depth, int depth2) {
        return `+i+"("+Js(["row","col","depth","depth2"],v)+`);
      }
    `}if(e.shapeInfo.isUniform)return`
      float `+i+`(int row, int col, int depth, int depth2) {
        int index = round(dot(vec4(row, col, depth, depth2),
                          vec4(`+c+", "+l+", "+s+`, 1)));
        `+Gs(e)+`
      }
    `;var g=e.shapeInfo.flatOffset,b=e.shapeInfo.texShape,w=b[0],_=b[1];if(_===c&&g==null)return`
      float `+i+`(int row, int col, int depth, int depth2) {
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(`+l+", "+s+`, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(`+_+".0, "+w+`.0);
        return sampleTexture(`+a+`, uv);
      }
    `;if(_===s&&g==null)return`
      float `+i+`(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(`+n[1]*n[2]+", "+n[2]+`, 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(`+_+".0, "+w+`.0);
        return sampleTexture(`+a+`, uv);
      }
    `;var S=Do(a);return`
    float `+i+`(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * `+c+" + col * "+l+` +
          depth * `+s+` + depth2;
      vec2 uv = uvFromFlat(`+w+", "+_+", index + "+S+`);
      return sampleTexture(`+a+`, uv);
    }
  `}(r);case 5:return function(e){var n=e.shapeInfo.logicalShape,a=e.name,i="get"+a.charAt(0).toUpperCase()+a.slice(1),s=n[4],l=n[3]*s,c=n[2]*l,f=n[1]*c,d=No(n),v=d.newShape,m=d.keptDims;if(v.length<n.length){var g=Zs(e,v);return`
      `+Qs(g)+`
      float `+i+`(int row, int col, int depth, int depth2, int depth3) {
        return `+i+"("+Js(["row","col","depth","depth2","depth3"],m)+`);
      }
    `}if(e.shapeInfo.isUniform)return`
      float `+i+`(int row, int col, int depth, int depth2, int depth3) {
        float index = dot(
          vec4(row, col, depth, depth2),
          vec4(`+f+", "+c+", "+l+", "+s+`)) +
          depth3;
        `+Gs(e)+`
      }
    `;var b=e.shapeInfo.flatOffset,w=e.shapeInfo.texShape,_=w[0],S=w[1];if(S===f&&b==null)return`
      float `+i+`(int row, int col, int depth, int depth2, int depth3) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
                         vec4(`+c+", "+l+", "+s+`, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(`+S+".0, "+_+`.0);
        return sampleTexture(`+a+`, uv);
      }
    `;if(S===s&&b==null)return`
      float `+i+`(int row, int col, int depth, int depth2, int depth3) {
        float texR = dot(
          vec4(row, col, depth, depth2),
          vec4(`+n[1]*n[2]*n[3]+`,
               `+n[2]*n[3]+", "+n[3]+`, 1));
        int texC = depth3;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(`+S+".0, "+_+`.0);
        return sampleTexture(`+a+`, uv);
      }
    `;var E=Do(a);return`
    float `+i+`(int row, int col, int depth, int depth2, int depth3) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * `+f+" + col * "+c+" + depth * "+l+` +
          depth2 * `+s+" + depth3 + "+E+`;
      vec2 uv = uvFromFlat(`+_+", "+S+`, index);
      return sampleTexture(`+a+`, uv);
    }
  `}(r);case 6:return function(e){var n=e.shapeInfo.logicalShape,a=e.name,i="get"+a.charAt(0).toUpperCase()+a.slice(1),s=No(n),l=s.newShape,c=s.keptDims;if(l.length<n.length){var f=Zs(e,l);return`
      `+Qs(f)+`
      float `+i+`(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        return `+i+"("+Js(["row","col","depth","depth2","depth3","depth4"],c)+`);
      }
    `}var d=n[5],v=n[4]*d,m=n[3]*v,g=n[2]*m,b=n[1]*g;if(e.shapeInfo.isUniform)return`
      float `+i+`(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
        int index = round(dot(
          vec4(row, col, depth, depth2),
          vec4(`+b+", "+g+", "+m+", "+v+`)) +
          dot(
            vec2(depth3, depth4),
            vec2(`+d+`, 1)));
        `+Gs(e)+`
      }
    `;var w=e.shapeInfo.flatOffset,_=e.shapeInfo.texShape,S=_[0],E=_[1];if(E===b&&w==null)return`
      float `+i+`(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
          vec4(`+g+", "+m+", "+v+", "+d+`)) +
               float(depth4);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(`+E+".0, "+S+`.0);
        return sampleTexture(`+a+`, uv);
      }
    `;if(E===d&&w==null)return`
      float `+i+`(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        float texR = dot(vec4(row, col, depth, depth2),
          vec4(`+n[1]*n[2]*n[3]*n[4]+`,
               `+n[2]*n[3]*n[4]+`,
               `+n[3]*n[4]+`,
               `+n[4]+`)) + float(depth3);
        int texC = depth4;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(`+E+".0, "+S+`.0);
        return sampleTexture(`+a+`, uv);
      }
    `;var C=Do(a);return`
    float `+i+`(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * `+b+" + col * "+g+" + depth * "+m+` +
          depth2 * `+v+" + depth3 * "+d+" + depth4 + "+C+`;
      vec2 uv = uvFromFlat(`+S+", "+E+`, index);
      return sampleTexture(`+a+`, uv);
    }
  `}(r);default:throw new Error(t.length+"-D input sampling is not yet supported")}}function XE(r){var t,e,n;switch(r.shapeInfo.logicalShape.length){case 0:return t=r.name,e="get"+t.charAt(0).toUpperCase()+t.slice(1),n=On(),`
    vec4 `+e+`() {
      return `+n.texture2D+"("+t+`, halfCR);
    }
  `;case 1:return function(a){var i=a.name,s="get"+i.charAt(0).toUpperCase()+i.slice(1),l=a.shapeInfo.texShape,c=[Math.ceil(l[0]/2),Math.ceil(l[1]/2)],f=On();return`
    vec4 `+s+`(int index) {
      vec2 uv = packedUVfrom1D(
        `+c[0]+", "+c[1]+`, index);
      return `+f.texture2D+"("+i+`, uv);
    }
  `}(r);case 2:return function(a){var i=a.shapeInfo.logicalShape,s=a.name,l="get"+s.charAt(0).toUpperCase()+s.slice(1),c=a.shapeInfo.texShape,f=c[0],d=c[1],v=On();if(c!=null&&vn(i,c))return`
      vec4 `+l+`(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(`+d+".0, "+f+`.0);

        return `+v.texture2D+"("+s+`, uv);
      }
    `;var m=[Math.ceil(c[0]/2),Math.ceil(c[1]/2)],g=Math.ceil(i[1]/2);return`
    vec4 `+l+`(int row, int col) {
      vec2 uv = packedUVfrom2D(`+g+", "+m[0]+", "+m[1]+`, row, col);
      return `+v.texture2D+"("+s+`, uv);
    }
  `}(r);case 3:return function(a){var i=a.shapeInfo.logicalShape,s=a.name,l="get"+s.charAt(0).toUpperCase()+s.slice(1),c=a.shapeInfo.texShape,f=[Math.ceil(c[0]/2),Math.ceil(c[1]/2)];if(i[0]===1){var d=i.slice(1),v=Zs(a,d);return`
        `+XE(v)+`
        vec4 `+l+`(int b, int row, int col) {
          return `+l+"("+Js(["b","row","col"],[1,2])+`);
        }
      `}var m=f[0],g=f[1],b=Math.ceil(i[2]/2),w=b*Math.ceil(i[1]/2),_=On();return`
    vec4 `+l+`(int b, int row, int col) {
      vec2 uv = packedUVfrom3D(
        `+m+", "+g+", "+w+", "+b+`, b, row, col);
      return `+_.texture2D+"("+s+`, uv);
    }
  `}(r);default:return function(a){for(var i=a.shapeInfo.logicalShape,s=i.length,l=a.name,c="get"+l.charAt(0).toUpperCase()+l.slice(1),f=a.shapeInfo.texShape,d=[Math.ceil(f[0]/2),Math.ceil(f[1]/2)],v=d[0],m=d[1],g=Math.ceil(i[s-1]/2),b=g*Math.ceil(i[s-2]/2),w="int b, int row, int col",_="b * "+b+" + (row / 2) * "+g+" + (col / 2)",S=2;S<s-1;S++)w="int b"+S+", "+w,b*=i[s-S-1],_="b"+S+" * "+b+" + "+_;var E=On();return`
    vec4 `+c+"("+w+`) {
      int index = `+_+`;
      int texR = index / `+m+`;
      int texC = index - texR * `+m+`;
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(`+m+", "+v+`);
      return `+E.texture2D+"("+l+`, uv);
    }
  `}(r)}}var xM=`
vec2 uvFromFlat(int texNumR, int texNumC, int index) {
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
vec2 packedUVfrom1D(int texNumR, int texNumC, int index) {
  int texelIndex = index / 2;
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,wM=`
vec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,
  int texNumC, int row, int col) {
  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,_M=`
vec2 packedUVfrom3D(int texNumR, int texNumC,
    int texelsInBatch, int texelsInLogicalRow, int b,
    int row, int col) {
  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,SM=`
  float getChannel(vec4 frag, vec2 innerDims) {
    vec2 modCoord = mod(innerDims, 2.);
    return modCoord.x == 0. ?
      (modCoord.y == 0. ? frag.r : frag.g) :
      (modCoord.y == 0. ? frag.b : frag.a);
  }
  float getChannel(vec4 frag, int dim) {
    float modCoord = mod(float(dim), 2.);
    return modCoord == 0. ? frag.r : frag.g;
  }
`;function Do(r){return"offset"+r}function Gs(r){var t=r.name,e=Ae(r.shapeInfo.logicalShape);return e<2?"return "+t+";":`
    for (int i = 0; i < `+e+`; i++) {
      if (i == index) {
        return `+t+`[i];
      }
    }
  `}function At(r){if(r<=1)return"int";if(r===2)return"ivec2";if(r===3)return"ivec3";if(r===4)return"ivec4";if(r===5)return"ivec5";if(r===6)return"ivec6";throw Error("GPU for rank "+r+" is not yet supported")}function Zs(r,t){var e=JSON.parse(JSON.stringify(r));return e.shapeInfo.logicalShape=t,e}function Js(r,t){return t.map(function(e){return r[e]}).join(", ")}var EM=function(r,t,e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,L(r.length>2,function(){return"Packed arg"+(e.charAt(0).toUpperCase()+e.slice(1))+" supports only inputs with rank above 2."});var a=r[r.length-1],i=Math.ceil(a/t);this.outputShape=r.slice(0,-1),i>1&&this.outputShape.push(i),n||this.variableNames.push("bestIndicesA");var s,l,c=this.outputShape,f=c.length,d=At(f),v=$n("coords",f);if(i===1){var m=At(l=f+1);s=`
        `+m+" sourceLocR = "+m+"("+v.join()+`, 0);
        ++`+v[f-1]+`;
        `+m+" sourceLocG = "+m+"("+v.join()+`, 0);
        ++`+v[f-2]+`;
        `+m+" sourceLocA = "+m+"("+v.join()+`, 0);
        --`+v[f-1]+`;
        `+m+" sourceLocB = "+m+"("+v.join()+`, 0);
        --`+v[f-2]+";"}else l=f,s=`
        `+d+` sourceLocR = coords;
        ++`+v[f-1]+`;
        `+d+` sourceLocG = coords;
        ++`+v[f-2]+`;
        `+d+` sourceLocA = coords;
        --`+v[f-1]+`;
        `+d+` sourceLocB = coords;
        --`+v[f-2]+";";var g=["x","y","z","w","u","v"].slice(0,l),b="."+g[l-1],w=g.map(function(I){return"int "+I}),_=$n("sourceLocR",l-1).concat("inIdx.r"),S=$n("sourceLocG",l-1).concat("inIdx.g"),E=$n("sourceLocB",l-1).concat("inIdx.b"),C=$n("sourceLocA",l-1).concat("inIdx.a"),R=e==="max"?"greaterThan":"lessThan",A=n?"":`
          inIdx = round(vec4(getBestIndicesAChannel(`+_.join()+`),
                             getBestIndicesAChannel(`+S.join()+`),
                             getBestIndicesAChannel(`+E.join()+`),
                             getBestIndicesAChannel(`+C.join()+")));",D=`vec4(
            getAChannel(`+_.join()+`),
            hasNextCol ? getAChannel(`+S.join()+`) : 0.,
            hasNextRow ? getAChannel(`+E.join()+`) : 0.,
            hasNextRow && hasNextCol ? getAChannel(`+C.join()+") : 0.)",k=n?"":`
      float getBestIndicesAChannel(`+w.join()+`) {
        return getChannel(getBestIndicesA(`+g.join()+`),
                                          vec2(`+g.slice(-2).join()+`));
      }`;this.userCode=`
      float getAChannel(`+w.join()+`) {
        return getChannel(getA(`+g.join()+`),
                               vec2(`+g.slice(-2).join()+`));
      }
      `+k+`
      void main() {
        `+d+` coords = getOutputCoords();
        bool hasNextCol = `+v[f-1]+" < "+(c[f-1]-1)+`;
        bool hasNextRow = `+v[f-2]+" < "+(c[f-2]-1)+`;
        `+s+`
        ivec4 srcIdx = ivec4(sourceLocR`+b+", sourceLocG"+b+`,
          sourceLocB`+b+", sourceLocA"+b+") * "+t+`;
        ivec4 inIdx = srcIdx;
        vec4 bestIndex = vec4(inIdx);
        vec4 bestValue = `+D+`;

        for (int i = 0; i < `+t+`; i++) {
          inIdx = srcIdx;
          `+A+`
          vec4 candidate = `+D+`;
          bvec4 nan = isnan(candidate);
          bvec4 replace = bvec4(
            vec4(`+R+`(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));

          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,
                           replace.y  ? candidate.y : bestValue.y,
                           replace.z  ? candidate.z : bestValue.z,
                           replace.w  ? candidate.w : bestValue.w);
          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));
          srcIdx++;
        }
        setOutput(bestIndex);
      }
    `},CM=function(r){this.variableNames=["dy"],this.outputShape=r.inShape;var t=r.filterHeight,e=r.filterWidth,n=r.strideHeight,a=r.strideWidth,i=r.dilationHeight,s=r.dilationWidth,l=r.effectiveFilterHeight,c=r.effectiveFilterWidth,f=l-1-r.padInfo.top,d=c-1-r.padInfo.left,v=1/(t*e);this.userCode=`
      const ivec2 pads = ivec2(`+f+", "+d+`);
      const float avgMultiplier = float(`+v+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < `+l+`;
            wR += `+i+`) {
          float dyR = float(dyRCorner + wR) / `+n+`.0;

          if (dyR < 0.0 || dyR >= `+r.outHeight+`.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < `+c+`;
            wC+= `+s+`) {
            float dyC = float(dyCCorner + wC) / `+a+`.0;

            if (dyC < 0.0 || dyC >= `+r.outWidth+`.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);

            dotProd += dyValue * avgMultiplier;
          }
        }
        setOutput(dotProd);
      }
    `},RM=function(r){this.variableNames=["dy"],this.outputShape=r.inShape;var t=r.filterDepth,e=r.filterHeight,n=r.filterWidth,a=r.strideDepth,i=r.strideHeight,s=r.strideWidth,l=r.dilationDepth,c=r.dilationHeight,f=r.dilationWidth,d=r.effectiveFilterDepth,v=r.effectiveFilterHeight,m=r.effectiveFilterWidth,g=d-1-r.padInfo.front,b=v-1-r.padInfo.top,w=m-1-r.padInfo.left,_=1/(t*e*n);this.userCode=`
      const ivec3 pads = ivec3(`+g+", "+b+", "+w+`);
      const float avgMultiplier = float(`+_+`);

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < `+d+`;
            wD += `+l+`) {
          float dyD = float(dyDCorner + wD) / `+a+`.0;

          if (dyD < 0.0 || dyD >= `+r.outDepth+`.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < `+v+`;
              wR += `+c+`) {
            float dyR = float(dyRCorner + wR) / `+i+`.0;

            if (dyR < 0.0 || dyR >= `+r.outHeight+`.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < `+m+`;
                wC += `+f+`) {
              float dyC = float(dyCCorner + wC) / `+s+`.0;

              if (dyC < 0.0 || dyC >= `+r.outWidth+`.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);

              dotProd += dyValue * avgMultiplier;
            }
          }
        }
        setOutput(dotProd);
      }
    `},AM=function(r,t,e,n,a,i){this.outputShape=[],this.variableNames=["x","mean","variance"],at(r,t),at(r,e);var s="0.0";n!=null&&(at(r,n),this.variableNames.push("offset"),s="getOffsetAtOutCoords()");var l="1.0";a!=null&&(at(r,a),this.variableNames.push("scale"),l="getScaleAtOutCoords()"),this.outputShape=r,this.userCode=`
      void main() {
        float x = getXAtOutCoords();
        float mean = getMeanAtOutCoords();
        float variance = getVarianceAtOutCoords();
        float offset = `+s+`;
        float scale = `+l+`;
        float inv = scale * inversesqrt(variance + float(`+i+`));
        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));
      }
    `},TM=function(r,t,e,n,a,i){this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],at(r,t),at(r,e);var s="vec4(0.0)";n!=null&&(at(r,n),this.variableNames.push("offset"),s="getOffsetAtOutCoords()");var l="vec4(1.0)";a!=null&&(at(r,a),this.variableNames.push("scale"),l="getScaleAtOutCoords()"),this.outputShape=r,this.userCode=`
      void main() {
        vec4 offset = `+s+`;
        vec4 scale = `+l+`;

        vec4 x = getXAtOutCoords();
        vec4 mean = getMeanAtOutCoords();
        vec4 variance = getVarianceAtOutCoords();

        vec4 inv = scale * inversesqrt(variance + vec4(`+i+`));

        setOutput((x - mean) * inv + offset);
      }
    `},DM="return areal * breal - aimag * bimag;",kM="return areal * bimag + aimag * breal;",$2=function(r,t,e){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=at(t,e),this.userCode=`
      float binaryOpComplex(
          float areal, float aimag, float breal, float bimag) {
        `+r+`
      }

      void main() {
        float areal = getARealAtOutCoords();
        float aimag = getAImagAtOutCoords();
        float breal = getBRealAtOutCoords();
        float bimag = getBImagAtOutCoords();
        setOutput(binaryOpComplex(areal, aimag, breal, bimag));
      }
    `},Dm="return a + b;",km="return a - b;",Y2="return a * b;",$E="return (a < 0.) ? b * a : a;",Pt=function(r,t,e){this.variableNames=["A","B"],this.outputShape=at(t,e),this.userCode=`
      float binaryOperation(float a, float b) {
        `+r+`
      }

      void main() {
        float a = getAAtOutCoords();
        float b = getBAtOutCoords();
        setOutput(binaryOperation(a, b));
      }
    `},YE=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`,ja=function(r,t,e,n){n===void 0&&(n=!1),this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=at(t,e);var a=this.outputShape.length,i="";if(n)if(a===0||Ae(this.outputShape)===1)i=`
          result.y = 0.;
          result.z = 0.;
          result.w = 0.;
        `;else if(i=`
          `+At(a)+` coords = getOutputCoords();
        `,a===1)i+=`
            result.y = (coords + 1) >= `+this.outputShape[0]+` ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `;else{var s=$n("coords",a);i+=`
            bool nextRowOutOfBounds =
              (`+s[a-2]+" + 1) >= "+this.outputShape[a-2]+`;
            bool nextColOutOfBounds =
              (`+s[a-1]+" + 1) >= "+this.outputShape[a-1]+`;
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `}this.userCode=`
      vec4 binaryOperation(vec4 a, vec4 b) {
        `+r+`
      }

      void main() {
        vec4 a = getAAtOutCoords();
        vec4 b = getBAtOutCoords();

        vec4 result = binaryOperation(a, b);
        `+i+`

        setOutput(result);
      }
    `},OM=function(){function r(t){this.variableNames=["A"],this.outputShape=t,this.userCode=`
      uniform float minVal;
      uniform float maxVal;

      void main() {
        float value = getAAtOutCoords();
        if (isnan(value)) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, minVal, maxVal));
      }
    `}return r.prototype.getCustomSetupFunc=function(t,e){var n=this;return function(a,i){n.minLoc==null&&(n.minLoc=a.getUniformLocationNoThrow(i,"minVal"),n.maxLoc=a.getUniformLocationNoThrow(i,"maxVal")),a.gl.uniform1f(n.minLoc,t),a.gl.uniform1f(n.maxLoc,e)}},r}(),NM=function(){function r(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.userCode=`
      uniform float minVal;
      uniform float maxVal;

      void main() {
        vec4 value = getAAtOutCoords();

        if (any(isnan(value))) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));
      }
    `}return r.prototype.getCustomSetupFunc=function(t,e){var n=this;return function(a,i){n.minLoc==null&&(n.minLoc=a.getUniformLocationNoThrow(i,"minVal"),n.maxLoc=a.getUniformLocationNoThrow(i,"maxVal")),a.gl.uniform1f(n.minLoc,t),a.gl.uniform1f(n.maxLoc,e)}},r}(),MM=function(r){this.variableNames=["real","imag"],this.outputShape=r,this.userCode=`
      void main() {
        float re = abs(getRealAtOutCoords());
        float im = abs(getImagAtOutCoords());
        float mx = max(re, im);

        // sadly the length function in glsl is not underflow-safe
        // (at least not on Intel GPUs). So the safe solution is
        // to ensure underflow-safety in all cases.
        setOutput(
          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))
        );
      }
    `},IM=function(r){this.outputShape=[],this.outputShape=Fu(r,1),this.variableNames=r.map(function(l,c){return"T"+c});var t=new Array(r.length-1);t[0]=r[0][1];for(var e=1;e<t.length;e++)t[e]=t[e-1]+r[e][1];var n=["if (yC < "+t[0]+") setOutput(getT0(yR, yC));"];for(e=1;e<t.length;e++){var a=t[e-1];n.push("else if (yC < "+t[e]+") setOutput(getT"+e+"(yR, yC-"+a+"));")}var i=t.length,s=t[t.length-1];n.push("else setOutput(getT"+i+"(yR, yC-"+s+"));"),this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int yR = coords.x;
        int yC = coords.y;

        `+n.join(`
        `)+`
      }
    `},FM=function(r,t){this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=Fu(r,t);var e=this.outputShape,n=e.length,a=At(n),i=$n("coords",n),s=["x","y","z","w","u","v"].slice(0,n);this.variableNames=r.map(function(_,S){return"T"+S});var l=new Array(r.length-1);l[0]=r[0][t];for(var c=1;c<l.length;c++)l[c]=l[c-1]+r[c][t];var f=s[t],d=s.slice(-2),v=s.join(),m="if ("+f+" < "+l[0]+`) {
        return getChannel(
            getT0(`+v+"), vec2("+d.join()+`));
        }`;for(c=1;c<l.length;c++){var g=l[c-1];m+=`
        if (`+f+" < "+l[c]+"  && "+f+" >= "+l[c-1]+`) {
          return getChannel(
            getT`+c+"("+uh(s,f,g)+`),
            vec2(`+uh(d,f,g)+`));
        }`}var b=l.length,w=l[l.length-1];m+=`
        return getChannel(
          getT`+b+"("+uh(s,f,w)+`),
          vec2(`+uh(d,f,w)+"));",this.userCode=`
      float getValue(`+s.map(function(_){return"int "+_})+`) {
        `+m+`
      }

      void main() {
        `+a+` coords = getOutputCoords();
        vec4 result = vec4(getValue(`+i+`), 0., 0., 0.);

        `+i[n-1]+" = "+i[n-1]+` + 1;
        if (`+i[n-1]+" < "+e[n-1]+`) {
          result.g = getValue(`+i+`);
        }

        `+i[n-2]+" = "+i[n-2]+` + 1;
        if (`+i[n-2]+" < "+e[n-2]+`) {
          result.a = getValue(`+i+`);
        }

        `+i[n-1]+" = "+i[n-1]+` - 1;
        if (`+i[n-2]+" < "+e[n-2]+` &&
            `+i[n-1]+" < "+e[n-1]+`) {
          result.b = getValue(`+i+`);
        }
        setOutput(result);
      }
    `};function uh(r,t,e){var n=r.indexOf(t);return r.map(function(a,i){return i===n?a+" - "+e:a}).join()}var BM=function(r){this.variableNames=["x","dy"],this.outputShape=r.filterShape;var t=r.strideHeight,e=r.strideWidth,n=r.padInfo.top,a=r.padInfo.left,i=r.dataFormat==="channelsLast";this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int d2 = coords.w;

        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int b = 0; b < `+r.batchSize+`; b++) {
          for (int yR = 0; yR < `+r.outHeight+`; yR++) {
            int xR = wR + yR * `+t+" - "+n+`;

            if (xR < 0 || xR >= `+r.inHeight+`) {
              continue;
            }

            for (int yC = 0; yC < `+r.outWidth+`; yC++) {
              int xC = wC + yC * `+e+" - "+a+`;

              if (xC < 0 || xC >= `+r.inWidth+`) {
                continue;
              }

              if (`+i+`) {
                float dyValue = getDy(b, yR, yC, d2);
                float xValue = getX(b, xR, xC, d1);
                dotProd += (xValue * dyValue);
              } else {
                float dyValue = getDy(b, d2, yR, yC);
                float xValue = getX(b, d1, xR, xC);
                dotProd += (xValue * dyValue);
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `},LM=function(r){this.variableNames=["dy","W"],this.outputShape=r.inShape;var t=r.filterHeight,e=r.filterWidth,n=r.strideHeight,a=r.strideWidth,i=r.dataFormat==="channelsLast",s=t-1-r.padInfo.top,l=e-1-r.padInfo.left,c=i?1:2,f=i?2:3,d=i?3:1;this.userCode=`
      const ivec2 pads = ivec2(`+s+", "+l+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[`+d+`];

        ivec2 dyCorner = ivec2(coords[`+c+"], coords["+f+`]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < `+t+`; wR++) {
          float dyR = float(dyRCorner + wR) / `+n+`.0;

          if (dyR < 0.0 || dyR >= `+r.outHeight+`.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = `+t+` - 1 - wR;

          for (int wC = 0; wC < `+e+`; wC++) {
            float dyC = float(dyCCorner + wC) / `+a+`.0;

            if (dyC < 0.0 || dyC >= `+r.outWidth+`.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = `+e+` - 1 - wC;

            for (int d2 = 0; d2 < `+r.outChannels+`; d2++) {

              if (`+i+`) {
                float xValue = getDy(batch, idyR, idyC, d2);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              } else {
                float xValue = getDy(batch, d2, idyR, idyC);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `},PM=function(r){this.variableNames=["x","dy"],this.outputShape=r.filterShape;var t=r.strideDepth,e=r.strideHeight,n=r.strideWidth,a=r.padInfo.front,i=r.padInfo.top,s=r.padInfo.left;this.userCode=`
      void main() {
        ivec5 coords = getOutputCoords();
        int wF = coords.x;
        int wR = coords.y;
        int wC = coords.z;
        int d1 = coords.w;
        int d2 = coords.u;

        float dotProd = 0.0;

        for (int b = 0; b < `+r.batchSize+`; b++) {
          for (int yF = 0; yF < `+r.outDepth+`; yF++) {
            int xF = wF + yF * `+t+" - "+a+`;

            if (xF < 0 || xF >= `+r.inDepth+`) {
              continue;
            }

            for (int yR = 0; yR < `+r.outHeight+`; yR++) {
              int xR = wR + yR * `+e+" - "+i+`;

              if (xR < 0 || xR >= `+r.inHeight+`) {
                continue;
              }

              for (int yC = 0; yC < `+r.outWidth+`; yC++) {
                int xC = wC + yC * `+n+" - "+s+`;

                if (xC < 0 || xC >= `+r.inWidth+`) {
                  continue;
                }

                float dyValue = getDy(b, yF, yR, yC, d2);
                float xValue = getX(b, xF, xR, xC, d1);
                dotProd += (xValue * dyValue);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `},zM=function(r){this.variableNames=["dy","W"],this.outputShape=r.inShape;var t=r.filterDepth,e=r.filterHeight,n=r.filterWidth,a=r.strideDepth,i=r.strideHeight,s=r.strideWidth,l=t-1-r.padInfo.front,c=e-1-r.padInfo.top,f=n-1-r.padInfo.left;this.userCode=`
      const ivec3 pads = ivec3(`+l+", "+c+", "+f+`);

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.u;


        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyFCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        float dotProd = 0.0;
        for (int wF = 0; wF < `+t+`; wF++) {
          float dyF = float(dyFCorner + wF) / `+a+`.0;

          if (dyF < 0.0 || dyF >= `+r.outDepth+`.0 || fract(dyF) > 0.0) {
            continue;
          }
          int idyF = int(dyF);

          int wFPerm = `+t+` - 1 - wF;

          for (int wR = 0; wR < `+e+`; wR++) {
            float dyR = float(dyRCorner + wR) / `+i+`.0;

            if (dyR < 0.0 || dyR >= `+r.outHeight+`.0 ||
              fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            int wRPerm = `+e+` - 1 - wR;

            for (int wC = 0; wC < `+n+`; wC++) {
              float dyC = float(dyCCorner + wC) / `+s+`.0;

              if (dyC < 0.0 || dyC >= `+r.outWidth+`.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              int wCPerm = `+n+` - 1 - wC;

              for (int d2 = 0; d2 < `+r.outChannels+`; d2++) {
                float xValue = getDy(batch, idyF, idyR, idyC, d2);
                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `},UM=function(r){this.variableNames=["x","dy"],this.outputShape=r.filterShape;var t=r.strideHeight,e=r.strideWidth,n=r.padInfo.top,a=r.padInfo.left,i=r.outChannels/r.inChannels;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int dm = coords.w;
        int d2 = d1 * `+i+` + dm;

        float dotProd = 0.0;

        // TO DO: Vec4 over the batch size
        for (int b = 0; b < `+r.batchSize+`; b++) {
          for (int yR = 0; yR < `+r.outHeight+`; yR++) {
            int xR = wR + yR * `+t+" - "+n+`;

            if (xR < 0 || xR >= `+r.inHeight+`) {
              continue;
            }

            for (int yC = 0; yC < `+r.outWidth+`; yC++) {
              int xC = wC + yC * `+e+" - "+a+`;

              if (xC < 0 || xC >= `+r.inWidth+`) {
                continue;
              }

              float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);
            }
          }
        }
        setOutput(dotProd);
      }
    `},VM=function(r){this.variableNames=["dy","W"],this.outputShape=r.inShape;var t=r.filterHeight,e=r.filterWidth,n=r.strideHeight,a=r.strideWidth,i=t-1-r.padInfo.top,s=e-1-r.padInfo.left,l=r.outChannels/r.inChannels;this.userCode=`
      const ivec2 pads = ivec2(`+i+", "+s+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];
        ivec2 dyCorner = coords.yz - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        float dotProd = 0.0;

        for (int wR = 0; wR < `+t+`; wR++) {
          float dyR = float(dyRCorner + wR) / `+n+`.0;

          if (dyR < 0.0 || dyR >= `+r.outHeight+`.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = `+t+` - 1 - wR;

          for (int wC = 0; wC < `+e+`; wC++) {
            float dyC = float(dyCCorner + wC) / `+a+`.0;

            if (dyC < 0.0 || dyC >= `+r.outWidth+`.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = `+e+` - 1 - wC;

            // TO DO: Vec4 over the channelMul
            for (int dm = 0; dm < `+l+`; dm++) {
              int d2 = d1 * `+l+` + dm;
              float xValue = getDy(batch, idyR, idyC, d2);
              float wValue = getW(wRPerm, wCPerm, d1, dm);
              dotProd += xValue * wValue;
            }
          }
        }
        setOutput(dotProd);
      }
    `},Q2=function(r,t,e,n){t===void 0&&(t=!1),e===void 0&&(e=null),n===void 0&&(n=!1),this.variableNames=["x","W"],this.outputShape=r.outShape;var a=r.padInfo.top,i=r.padInfo.left,s=r.strideHeight,l=r.strideWidth,c=r.dilationHeight,f=r.dilationWidth,d=r.filterHeight,v=r.filterWidth,m=4*Math.floor(r.inChannels/4),g=r.inChannels%4,b=r.dataFormat==="channelsLast",w=b?1:2,_=b?2:3,S=b?3:1,E="",C="";e&&(E=n?`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          `+e+`
        }`:`
          float activation(float x) {
            `+e+`
          }
        `,C="result = activation(result);");var R=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),n&&this.variableNames.push("preluActivationWeights"),this.userCode=`
      `+E+`

      const ivec2 strides = ivec2(`+s+", "+l+`);
      const ivec2 pads = ivec2(`+a+", "+i+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d2 = coords[`+S+`];

        ivec2 xRCCorner =
            ivec2(coords[`+w+"], coords["+_+`]) * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < `+d+`; wR++) {
          int xR = xRCorner + wR * `+c+`;

          if (xR < 0 || xR >= `+r.inHeight+`) {
            continue;
          }

          for (int wC = 0; wC < `+v+`; wC++) {
            int xC = xCCorner + wC * `+f+`;

            if (xC < 0 || xC >= `+r.inWidth+`) {
              continue;
            }

            for (int d1 = 0; d1 < `+m+`; d1 += 4) {
              vec4 wValues = vec4(
                getW(wR, wC, d1, d2),
                getW(wR, wC, d1 + 1, d2),
                getW(wR, wC, d1 + 2, d2),
                getW(wR, wC, d1 + 3, d2)
              );

              if (`+b+`) {
                vec4 xValues = vec4(
                  getX(batch, xR, xC, d1),
                  getX(batch, xR, xC, d1 + 1),
                  getX(batch, xR, xC, d1 + 2),
                  getX(batch, xR, xC, d1 + 3)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec4 xValues = vec4(
                  getX(batch, d1, xR, xC),
                  getX(batch, d1 + 1, xR, xC),
                  getX(batch, d1 + 2, xR, xC),
                  getX(batch, d1 + 3, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }
            }

            if (`+(g===1)+`) {

              if (`+b+`) {
                dotProd +=
                    getX(batch, xR, xC, `+m+`) *
                    getW(wR, wC, `+m+`, d2);
              } else {
                dotProd +=
                    getX(batch, `+m+`, xR, xC) *
                    getW(wR, wC, `+m+`, d2);
              }

            } else if (`+(g===2)+`) {
              vec2 wValues = vec2(
                getW(wR, wC, `+m+`, d2),
                getW(wR, wC, `+m+` + 1, d2)
              );

              if (`+b+`) {
                vec2 xValues = vec2(
                  getX(batch, xR, xC, `+m+`),
                  getX(batch, xR, xC, `+m+` + 1)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec2 xValues = vec2(
                  getX(batch, `+m+`, xR, xC),
                  getX(batch, `+m+` + 1, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            } else if (`+(g===3)+`) {
              vec3 wValues = vec3(
                getW(wR, wC, `+m+`, d2),
                getW(wR, wC, `+m+` + 1, d2),
                getW(wR, wC, `+m+` + 2, d2)
              );

              if (`+b+`) {
                vec3 xValues = vec3(
                  getX(batch, xR, xC, `+m+`),
                  getX(batch, xR, xC, `+m+` + 1),
                  getX(batch, xR, xC, `+m+` + 2)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec3 xValues = vec3(
                  getX(batch, `+m+`, xR, xC),
                  getX(batch, `+m+` + 1, xR, xC),
                  getX(batch, `+m+` + 2, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            }
          }
        }

        float result = dotProd;
        `+R+`
        `+C+`
        setOutput(result);
      }
    `},HM=function(r){this.variableNames=["x","W"],this.outputShape=r.outShape;var t=r.padInfo.front,e=r.padInfo.top,n=r.padInfo.left,a=r.strideDepth,i=r.strideHeight,s=r.strideWidth,l=r.dilationDepth,c=r.dilationHeight,f=r.dilationWidth,d=r.filterDepth,v=r.filterHeight,m=r.filterWidth,g=4*Math.floor(r.inChannels/4),b=r.inChannels%4;this.userCode=`
      const ivec3 strides = ivec3(`+a+", "+i+", "+s+`);
      const ivec3 pads = ivec3(`+t+", "+e+", "+n+`);

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d2 = coords.u;

        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xFCorner = xFRCCorner.x;
        int xRCorner = xFRCCorner.y;
        int xCCorner = xFRCCorner.z;

        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get
        // y(yF, yR, yC, d2). ? = to be determined. : = across all
        // values in that axis.
        float dotProd = 0.0;
        for (int wF = 0; wF < `+d+`; wF++) {
          int xF = xFCorner + wF * `+l+`;

          if (xF < 0 || xF >= `+r.inDepth+`) {
            continue;
          }

          for (int wR = 0; wR < `+v+`; wR++) {
            int xR = xRCorner + wR * `+c+`;

            if (xR < 0 || xR >= `+r.inHeight+`) {
              continue;
            }

            for (int wC = 0; wC < `+m+`; wC++) {
              int xC = xCCorner + wC * `+f+`;

              if (xC < 0 || xC >= `+r.inWidth+`) {
                continue;
              }

              for (int d1 = 0; d1 < `+g+`; d1 += 4) {
                vec4 xValues = vec4(
                  getX(batch, xF, xR, xC, d1),
                  getX(batch, xF, xR, xC, d1 + 1),
                  getX(batch, xF, xR, xC, d1 + 2),
                  getX(batch, xF, xR, xC, d1 + 3)
                );
                vec4 wValues = vec4(
                  getW(wF, wR, wC, d1, d2),
                  getW(wF, wR, wC, d1 + 1, d2),
                  getW(wF, wR, wC, d1 + 2, d2),
                  getW(wF, wR, wC, d1 + 3, d2)
                );

                dotProd += dot(xValues, wValues);
              }

              if (`+(b===1)+`) {
                dotProd +=
                  getX(batch, xF, xR, xC, `+g+`) *
                  getW(wF, wR, wC, `+g+`, d2);
              } else if (`+(b===2)+`) {
                vec2 xValues = vec2(
                  getX(batch, xF, xR, xC, `+g+`),
                  getX(batch, xF, xR, xC, `+g+` + 1)
                );
                vec2 wValues = vec2(
                  getW(wF, wR, wC, `+g+`, d2),
                  getW(wF, wR, wC, `+g+` + 1, d2)
                );
                dotProd += dot(xValues, wValues);
              } else if (`+(b===3)+`) {
                vec3 xValues = vec3(
                  getX(batch, xF, xR, xC, `+g+`),
                  getX(batch, xF, xR, xC, `+g+` + 1),
                  getX(batch, xF, xR, xC, `+g+` + 2)
                );
                vec3 wValues = vec3(
                  getW(wF, wR, wC, `+g+`, d2),
                  getW(wF, wR, wC, `+g+` + 1, d2),
                  getW(wF, wR, wC, `+g+` + 2, d2)
                );
                dotProd += dot(xValues, wValues);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `},Z2=function(r,t,e,n){t===void 0&&(t=!1),e===void 0&&(e=null),n===void 0&&(n=!1),this.variableNames=["x","W"],this.outputShape=r.outShape;var a=r.inHeight,i=r.inWidth,s=r.padInfo.top,l=r.padInfo.left,c=r.strideHeight,f=r.strideWidth,d=r.dilationHeight,v=r.dilationWidth,m=r.filterHeight,g=r.filterWidth,b=r.outChannels/r.inChannels,w="",_="";e&&(w=n?`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          `+e+`
        }`:`
          float activation(float x) {
            `+e+`
          }
        `,_="result = activation(result);");var S=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),n&&this.variableNames.push("preluActivationWeights"),this.userCode=`
      `+w+`

      const ivec2 strides = ivec2(`+c+", "+f+`);
      const ivec2 pads = ivec2(`+s+", "+l+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / `+b+`;
        int q = d2 - d1 * `+b+`;

        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.
        for (int wR = 0; wR < `+m+`; wR++) {
          int xR = xRCorner + wR * `+d+`;

          if (xR < 0 || xR >= `+a+`) {
            continue;
          }

          for (int wC = 0; wC < `+g+`; wC++) {
            int xC = xCCorner + wC * `+v+`;

            if (xC < 0 || xC >= `+i+`) {
              continue;
            }

            float xVal = getX(batch, xR, xC, d1);
            float wVal = getW(wR, wC, d1, q);
            dotProd += xVal * wVal;
          }
        }

        float result = dotProd;
        `+S+`
        `+_+`
        setOutput(result);
      }
    `},J2=function(r,t,e,n){t===void 0&&(t=!1),e===void 0&&(e=null),n===void 0&&(n=!1),this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=r.outShape;for(var a=r.inHeight,i=r.inWidth,s=r.padInfo.top,l=r.padInfo.left,c=r.strideHeight,f=r.strideWidth,d=r.dilationHeight,v=r.dilationWidth,m=r.filterHeight,g=r.filterWidth,b=g,w="int xR; int xC; int xCOffset;",_=0;_<m;_++)for(var S=0;S<g;S++)w+=`
          vec4 xTexelR`+_+"C"+2*S+` = vec4(0.);
          vec4 wR`+_+"C"+S+` = vec4(0.);
          vec4 xR`+_+"C"+S+" = vec4(0.);";for(_=0;_<m;_++)for(var E=0;E<b;E++){if(w+=`
          xR = xRCorner + `+_*d+`;
          xC = xCCorner + `+(S=2*E)*v+`;
        `,f===1){if(S<g&&(w+=l%2==1?`
                xCOffset = xC + 1;
                if(xR >= 0 && xR < `+a+" && xCOffset >= 0 && xCOffset < "+i+`) {
                  xTexelR`+_+"C"+S+` = getX(batch, xR, xCOffset, d1);

                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if(xCOffset + 1 >= `+i+`) {
                    xTexelR`+_+"C"+S+`.zw = vec2(0.);
                  }
                } else {
                  xTexelR`+_+"C"+S+` = vec4(0.);
                }

                xCOffset = xC + 1 - 2;
                if(xR >= 0 && xR < `+a+" && xCOffset >= 0 && xCOffset < "+i+`) {
                  vec4 previous = getX(batch, xR, xCOffset, d1);

                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if(xCOffset + 1 >= `+i+`) {
                    previous.zw = vec2(0.);
                  }

                  xR`+_+"C"+S+" = vec4(previous.zw, xTexelR"+_+"C"+S+`.xy);
                } else {
                  xR`+_+"C"+S+" = vec4(0, 0, xTexelR"+_+"C"+S+`.xy);
                }
              `:`
                if(xR >= 0 && xR < `+a+" && xC >= 0 && xC < "+i+`) {
                  xTexelR`+_+"C"+S+` = getX(batch, xR, xC, d1);
                } else {
                  xTexelR`+_+"C"+S+` = vec4(0.);
                }

                xR`+_+"C"+S+" = xTexelR"+_+"C"+S+`;
              `,S+1<g)){var C=l%2==0?pE(v):v;v%2==0&&l%2==1||v%2!=0&&l%2!=1?(w+=`
                  xCOffset = xC + `+l%2+" + "+C+`;

                  if(xR >= 0 && xR < `+a+` &&
                    xCOffset >= 0 && xCOffset < `+i+`) {
                    xTexelR`+_+"C"+(S+2)+` = getX(batch, xR, xCOffset, d1);
                  }
                `,v>1&&(w+=`
                    xCOffset -= 2;
                    if(xR >= 0 && xR < `+a+` &&
                      xCOffset >= 0 && xCOffset < `+i+`) {
                      xTexelR`+_+"C"+S+` = getX(batch, xR, xCOffset, d1);
                    } else {
                      xTexelR`+_+"C"+S+` = vec4(0.);
                    }
                  `),w+=`
                  xR`+_+"C"+(S+1)+` = vec4(
                    xTexelR`+_+"C"+S+".zw, xTexelR"+_+"C"+(S+2)+`.xy);
                `):w+=`
                  xCOffset = xC + `+C+`;

                  if(xR >= 0 && xR < `+a+` &&
                    xCOffset >= 0 && xCOffset < `+i+`) {
                    xTexelR`+_+"C"+(S+2)+` = getX(batch, xR, xCOffset, d1);
                  }

                  xR`+_+"C"+(S+1)+" = xTexelR"+_+"C"+(S+2)+`;
                `}}else S<g&&(w+=`
              if(xR >= 0 && xR < `+a+`) {
            `,l%2==1?(w+=`
                xCOffset = xC + 1 - `+f+`;
                if(xCOffset >= 0 && xCOffset < `+i+`) {
                  xTexelR`+_+"C"+S+` = getX(batch, xR, xCOffset, d1);
                } else {
                  xTexelR`+_+"C"+S+` = vec4(0.);
                }

                if(xC + 1 >= 0 && xC + 1 < `+i+`) {
                  xTexelR`+_+"C"+(S+2)+` = getX(batch, xR, xC + 1, d1);
                } else {
                  xTexelR`+_+"C"+(S+2)+` = vec4(0.);
                }

                xR`+_+"C"+S+` = vec4(
                  xTexelR`+_+"C"+S+".zw, xTexelR"+_+"C"+(S+2)+`.zw);
              `,S+1<g&&(w+=`
                  vec4 final = vec4(0.);
                  xCOffset = xC + 1 + `+f+`;
                  if(xCOffset >= 0 && xCOffset < `+i+`) {
                    final = getX(batch, xR, xCOffset, d1);
                  }
                  xR`+_+"C"+(S+1)+" = vec4(xTexelR"+_+"C"+(S+2)+`.xy, final.xy);
                `)):(w+=`
                if(xC >= 0 && xC < `+i+`) {
                  xTexelR`+_+"C"+S+` = getX(batch, xR, xC, d1);
                } else {
                  xTexelR`+_+"C"+S+` = vec4(0.);
                }

                xCOffset = xC + `+f+`;
                if(xCOffset >= 0 && xCOffset < `+i+`) {
                  xTexelR`+_+"C"+(S+2)+` = getX(batch, xR, xCOffset, d1);
                } else {
                  xTexelR`+_+"C"+(S+2)+` = vec4(0.);
                }

                xR`+_+"C"+S+` = vec4(
                  xTexelR`+_+"C"+S+".xy, xTexelR"+_+"C"+(S+2)+`.xy);
              `,S+1<g&&(w+=`
                  xR`+_+"C"+(S+1)+` = vec4(
                    xTexelR`+_+"C"+S+".zw, xTexelR"+_+"C"+(S+2)+`.zw);
                `)),w+="}");S<g&&(w+=`
            vec4 wTexelR`+_+"C"+S+" = getW("+_+", "+S+`, d1, q);
            wR`+_+"C"+S+" = vec4(wTexelR"+_+"C"+S+".xz, wTexelR"+_+"C"+S+`.xz);
          `,S+1<g&&(w+=`
              vec4 wTexelR`+_+"C"+(S+1)+" = getW("+_+", "+(S+1)+`, d1, q);
              wR`+_+"C"+(S+1)+` =
                vec4(wTexelR`+_+"C"+(S+1)+".xz, wTexelR"+_+"C"+(S+1)+".xz);"))}for(_=0;_<m;_++)for(S=0;S<g;S++)w+="dotProd += xR"+_+"C"+S+" * wR"+_+"C"+S+";";var R="",A="";e&&(R=n?`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          `+e+`
        }`:`vec4 activation(vec4 x) {
          `+e+`
        }`,A="result = activation(result);");var D=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),n&&this.variableNames.push("preluActivationWeights"),this.userCode=`
      `+R+`

      const ivec2 strides = ivec2(`+c+", "+f+`);
      const ivec2 pads = ivec2(`+s+", "+l+`);

      void main() {

        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2;
        int q = 0;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        vec4 dotProd = vec4(0.);

        `+w+`

        vec4 result = dotProd;
        `+D+`
        `+A+`
        setOutput(result);
      }
    `},jM=function(r,t,e,n,a){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];var i=r[0],s=r[1],l=r[2],c=r[3],f=t[0],d=e[0],v=e[1];this.outputShape=[f,d,v,c];var m=n==="bilinear"?1:0,g=[s-1+".0",l-1+".0"],b=g[0],w=g[1],_=d>1?[""+(s-1)/(d-1),"(y2-y1) * height_ratio","y1*"+b+" + float(y)*(height_scale)"]:["0.0","0.0","0.5 * (y1+y2) * "+b],S=_[0],E=_[1],C=_[2],R=v>1?[""+(l-1)/(v-1),"(x2-x1) * width_ratio","x1*"+w+" + float(x)*(width_scale)"]:["0.0","0.0","0.5 * (x1+x2) * "+w],A=R[0],D=R[1],k=R[2];this.userCode=`
      const float height_ratio = float(`+S+`);
      const float width_ratio = float(`+A+`);
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int y = coords[1];
        int x = coords[2];
        int d = coords[3];

        // get box vals
        float y1 = getBoxes(b,0);
        float x1 = getBoxes(b,1);
        float y2 = getBoxes(b,2);
        float x2 = getBoxes(b,3);

        // get image in batch index
        int bInd = round(getBoxInd(b));
        if(bInd < 0 || bInd >= `+i+`) {
          return;
        }

        float height_scale = `+E+`;
        float width_scale = `+D+`;

        float in_y = `+C+`;
        if( in_y < 0.0 || in_y > `+b+` ) {
          setOutput(float(`+a+`));
          return;
        }
        float in_x = `+k+`;
        if( in_x < 0.0 || in_x > `+w+` ) {
          setOutput(float(`+a+`));
          return;
        }

        vec2 sourceFracIndexCR = vec2(in_x,in_y);
        if(`+m+` == 1) {
          // Compute the four integer indices.
          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);
          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));

          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);
          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);
          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);
          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);

          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);

          float top = topLeft + (topRight - topLeft) * fracCR.x;
          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;
          float newValue = top + (bottom - top) * fracCR.y;
          setOutput(newValue);
        } else {
          // Compute the coordinators of nearest neighbor point.
          ivec2 sourceNearestCR = ivec2(floor(
            sourceFracIndexCR + vec2(0.5,0.5)));
          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);
          setOutput(newValue);
        }
      }
    `},WM=function(r,t,e){this.variableNames=["x"],this.outputShape=r;var n=r.length,a=r[r.length-1],i=e?"<":">";this.userCode=`
      int getIndex(int i) {
        `+(e?"return "+a+" -i - 1;":"return i;")+`
      }

      void main() {
        `+At(n)+` coords = getOutputCoords();
        int end = `+e_(n,"coords")+`;
        float val = 0.0;
        for (int i = `+a+` - 1; i >= 0; i -= 1) {
          int idx = getIndex(i);
          if (idx `+i+` end) {
            continue;
          }
          if (idx == end && `+t+`) {
            continue;
          }
          `+e_(n,"coords")+` = idx;
          val += getX(`+function(s,l){if(s===1)return""+l;if(s===2)return l+".x, "+l+".y";if(s===3)return l+".x, "+l+".y, "+l+".z";if(s===4)return l+".x, "+l+".y, "+l+".z, "+l+".w";throw Error("Cumulative sum for rank "+s+" is not yet supported")}(n,"coords")+`);
        }
        setOutput(val);
      }
    `};function e_(r,t){if(r===1)return""+t;if(r===2)return t+".y";if(r===3)return t+".z";if(r===4)return t+".w";throw Error("Cumulative sum for rank "+r+" is not yet supported")}var GM=function(r){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=dc.DENSE;var t=ec(r),e=On();this.outputShape=r,this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        `+Io(["r","c","d"],r)+`
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx *
          vec2(`+t[0]+", "+t[1]+`));
        int index = 4 * (resTexRC.x * `+t[1]+` + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getA(rc.x, rc.y, rc.z);
        }

        `+e.output+` = result;
      }
    `},qM=function(r){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=dc.DENSE;var t=ec(r),e=On();this.outputShape=r,this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        `+Io(["r","c","d"],r)+`
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx *
          vec2(`+t[0]+", "+t[1]+`));
        int index = 4 * (resTexRC.x * `+t[1]+` + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));
        }

        `+e.output+` = result;
      }
    `},KM=function(){function r(t,e,n){this.variableNames=["x"],this.outputShape=[],this.outputShape=t,this.blockSize=e,this.dataFormat=n,this.userCode=`
    void main() {
      ivec4 coords = getOutputCoords();
      int b = coords[0];
      int h = `+this.getHeightCoordString()+`;
      int w = `+this.getWidthCoordString()+`;
      int d = `+this.getDepthCoordString()+`;

      int in_h = h / `+e+`;
      int offset_h = imod(h, `+e+`);
      int in_w = w / `+e+`;
      int offset_w = imod(w, `+e+`);
      int offset_d = (offset_h * `+e+` + offset_w) *
        `+this.getOutputDepthSize()+`;
      int in_d = d + offset_d;

      float result = `+this.getInputSamplingString()+`;
      setOutput(result);
    }
  `}return r.prototype.getHeightCoordString=function(){return this.dataFormat==="NHWC"?"coords[1]":"coords[2]"},r.prototype.getWidthCoordString=function(){return this.dataFormat==="NHWC"?"coords[2]":"coords[3]"},r.prototype.getDepthCoordString=function(){return this.dataFormat==="NHWC"?"coords[3]":"coords[1]"},r.prototype.getOutputDepthSize=function(){return this.dataFormat==="NHWC"?this.outputShape[3]:this.outputShape[1]},r.prototype.getInputSamplingString=function(){return this.dataFormat==="NHWC"?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"},r}(),XM=function(r){this.variableNames=["X"],this.outputShape=[r,r],this.userCode=`
      void main() {
          ivec2 coords = getOutputCoords();
          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;
          setOutput(val);
      }
    `},$M=function(r){this.variableNames=["A"],this.outTexUsage=cr.DOWNLOAD;var t=On();this.outputShape=r,this.userCode=`
      `+KE+`

      void main() {
        float x = getAAtOutCoords();
        `+t.output+` = encode_float(x);
      }
    `},YM=function(r){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=cr.DOWNLOAD;var t=On();this.outputShape=r,this.userCode=`
      `+KE+`

      void main() {
        ivec3 coords = getOutputCoords();
        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));
        `+t.output+` = encode_float(x);
      }
    `},QM=function(r,t,e){e===void 0&&(e=!1),this.variableNames=["A"];var n=On(),a=t[0],i=t[1];this.outputShape=r;var s="result";e&&(s="floor(result * 255. + 0.5)"),this.userCode=`
      `+Cy(r)+`

      void main() {
        ivec3 coords = getOutputCoords();

        int flatIndex = getFlatIndex(coords);
        int offset = imod(flatIndex, 4);

        flatIndex = idiv(flatIndex, 4, 1.);
        
        int r = flatIndex / `+i+`;
        int c = imod(flatIndex, `+i+`);
        vec2 uv = (vec2(c, r) + halfCR) / vec2(`+i+".0, "+a+`.0);
        vec4 values = `+n.texture2D+`(A, uv);

        float result;

        if(offset == 0) {
          result = values[0];
        } else if(offset == 1) {
          result = values[1];
        } else if(offset == 2) {
          result = values[2];
        } else {
          result = values[3];
        }

        `+n.output+" = vec4("+s+`, 0., 0., 0.);
      }
    `},ZM=function(r,t,e){e===void 0&&(e=!1),this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;var n=On(),a=t[0],i=t[1];this.outputShape=r;var s="",l="result";e&&(l="floor(result * 255. + 0.5)");for(var c=0;c<=1;c++)for(var f=0;f<=1;f++){var d=2*c+f;s+=`
          localCoords = coords;
          if(localCoords[2] + `+f+" < "+r[2]+`) {
            localCoords[2] += `+f+`;
            if(localCoords[1] + `+c+" < "+r[1]+`) {
              localCoords[1] += `+c+`;

              flatIndex = getFlatIndex(localCoords);
              offset = imod(flatIndex, 4);

              flatIndex = idiv(flatIndex, 4, 1.);

              r = flatIndex / `+i+`;
              c = imod(flatIndex, `+i+`);
              uv = (vec2(c, r) + halfCR) / vec2(`+i+".0, "+a+`.0);
              values = `+n.texture2D+`(A, uv);

              if(offset == 0) {
                result[`+d+`] = values[0];
              } else if(offset == 1) {
                result[`+d+`] = values[1];
              } else if(offset == 2) {
                result[`+d+`] = values[2];
              } else {
                result[`+d+`] = values[3];
              }
            }
          }
        `}this.userCode=`
      `+Cy(r)+`

      void main() {
        ivec3 coords = getOutputCoords();

        vec4 result = vec4(0.);
        int flatIndex, r, c, offset;
        ivec3 localCoords;
        vec2 uv;
        vec4 values;

        `+s+`

        `+n.output+" = "+l+`;
      }
    `},JM="return real * expR - imag * expI;",eI="return real * expI + imag * expR;",t_=function(r,t,e){this.variableNames=["real","imag"];var n=t[1];this.outputShape=t;var a=e?"2.0 * "+Math.PI:"-2.0 * "+Math.PI,i=e?n+".0":"1.0";this.userCode=`
      const float exponentMultiplier = `+a+`;

      float unaryOpComplex(float real, float expR, float imag, float expI) {
        `+r+`
      }

      float mulMatDFT(int batch, int index) {
        float indexRatio = float(index) / float(`+n+`);
        float exponentMultiplierTimesIndexRatio =
            exponentMultiplier * indexRatio;

        float result = 0.0;

        for (int i = 0; i < `+n+`; i++) {
          // x = (-2|2 * PI / N) * index * i;
          float x = exponentMultiplierTimesIndexRatio * float(i);
          float expR = cos(x);
          float expI = sin(x);
          float real = getReal(batch, i);
          float imag = getImag(batch, i);

          result +=
              unaryOpComplex(real, expR, imag, expI) / `+i+`;
        }

        return result;
      }

      void main() {
        ivec2 coords = getOutputCoords();
        setOutput(mulMatDFT(coords[0], coords[1]));
      }
    `},tI=function(){function r(t,e){this.outputShape=[],this.variableNames=["x"],this.outputShape=t,this.userCode=`
      uniform float value;
      void main() {
        // Input can be obtained from uniform value.
        setOutput(value);
      }
    `}return r.prototype.getCustomSetupFunc=function(t){var e=this;return function(n,a){e.valueLoc==null&&(e.valueLoc=n.getUniformLocationNoThrow(a,"value")),n.gl.uniform1f(e.valueLoc,t)}},r}(),nI=function(r,t,e){this.variableNames=["A","indices"];var n=r.slice();n[e]=t,this.outputShape=n,this.rank=n.length;var a=At(this.rank),i=function(s,l){var c=s.length;if(c>4)throw Error("Gather for rank "+c+" is not yet supported");if(c===1)return"int(getIndices(resRC))";for(var f=["resRC.x","resRC.y","resRC.z","resRC.w"],d=[],v=0;v<s.length;v++)v===l?d.push("int(getIndices("+f[v]+"))"):d.push(""+f[v]);return d.join()}(r,e);this.userCode=`
      void main() {
        `+a+` resRC = getOutputCoords();
        setOutput(getA(`+i+`));
      }
    `},rI=function(r,t,e){this.sliceDim=r,this.strides=t,this.variableNames=["x","indices"],this.outputShape=e;var n=At(t.length),a=At(e.length),i=this.sliceDim>1?"strides[j]":"strides";this.userCode=`
        `+n+" strides = "+n+"("+this.strides+`);
         void main() {
          `+a+` coords = getOutputCoords();
          int flattenIndex = 0;
          for (int j = 0; j < `+this.sliceDim+`; j++) {
            int index = round(getIndices(coords[0], j));
            flattenIndex += index * `+i+`;
          }
          setOutput(getX(flattenIndex, coords[1]));
        }
      `};function aI(r,t){var e=On();return J3(r,t,e.version+`
    precision highp float;
    `+e.attribute+` vec3 clipSpacePos;
    `+e.attribute+` vec2 uv;
    `+e.varyingVs+` vec2 resultUV;

    void main() {
      gl_Position = vec4(clipSpacePos, 1);
      resultUV = uv;
    }`)}function iI(r,t){return a4(r,t,new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]))}function oI(r,t){return i4(r,t,new Uint16Array([0,1,2,2,1,3]))}function Oc(r,t,e,n,a,i,s){s4(e,n);var l=o4(r,t),c=r.TEXTURE_2D;return De(r,t,function(){return r.bindTexture(c,l)}),De(r,t,function(){return r.texParameteri(c,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE)}),De(r,t,function(){return r.texParameteri(c,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE)}),De(r,t,function(){return r.texParameteri(c,r.TEXTURE_MIN_FILTER,r.NEAREST)}),De(r,t,function(){return r.texParameteri(c,r.TEXTURE_MAG_FILTER,r.NEAREST)}),De(r,t,function(){return r.texImage2D(c,0,a,e,n,0,i,s,null)}),De(r,t,function(){return r.bindTexture(r.TEXTURE_2D,null)}),l}function sI(r,t,e,n,a){var i=wd(e,n);return Oc(r,t,i[0],i[1],a.internalFormatFloat,a.textureFormatFloat,r.FLOAT)}function uI(r,t,e,n,a){var i=wd(e,n);return Oc(r,t,i[0],i[1],a.internalFormatHalfFloat,a.textureFormatFloat,a.textureTypeHalfFloat)}function lI(r,t,e,n,a){var i=wd(e,n);return Oc(r,t,i[0],i[1],r.RGBA,r.RGBA,r.UNSIGNED_BYTE)}function cI(r,t,e,n,a){var i=kc(e,n);return Oc(r,t,i[0],i[1],a.internalFormatPackedFloat,r.RGBA,r.FLOAT)}function fI(r,t,e,n,a){var i=kc(e,n);return Oc(r,t,i[0],i[1],a.internalFormatPackedHalfFloat,r.RGBA,a.textureTypeHalfFloat)}function hI(r,t,e,n){return De(r,t,function(){return r.bindBuffer(r.ARRAY_BUFFER,n)}),H2(r,t,e,"clipSpacePos",n,3,20,0)&&H2(r,t,e,"uv",n,2,20,12)}function dI(r,t,e,n,a,i,s){var l,c,f;De(r,t,function(){return r.bindTexture(r.TEXTURE_2D,e)}),i instanceof Uint8Array?(l=new Uint8Array(n*a*4),c=r.UNSIGNED_BYTE,f=r.RGBA):(l=new Float32Array(n*a*4),c=r.FLOAT,f=s.internalFormatPackedFloat),l.set(i),De(r,t,function(){return r.texImage2D(r.TEXTURE_2D,0,f,n,a,0,r.RGBA,c,l)}),De(r,t,function(){return r.bindTexture(r.TEXTURE_2D,null)})}function pI(r,t,e,n){De(r,t,function(){return r.bindTexture(r.TEXTURE_2D,e)}),n.data instanceof Uint8Array?De(r,t,function(){return r.texImage2D(r.TEXTURE_2D,0,r.RGBA,n.width,n.height,0,r.RGBA,r.UNSIGNED_BYTE,n.data)}):De(r,t,function(){return r.texImage2D(r.TEXTURE_2D,0,r.RGBA,r.RGBA,r.UNSIGNED_BYTE,n)}),De(r,t,function(){return r.bindTexture(r.TEXTURE_2D,null)})}function vI(r,t,e,n,a){var i=r.createBuffer();De(r,t,function(){return r.bindBuffer(r.PIXEL_PACK_BUFFER,i)});var s=16*e*n;return De(r,t,function(){return r.bufferData(r.PIXEL_PACK_BUFFER,s,r.STREAM_READ)}),De(r,t,function(){return r.readPixels(0,0,n,e,r.RGBA,r.FLOAT,0)}),De(r,t,function(){return r.bindBuffer(r.PIXEL_PACK_BUFFER,null)}),i}function mI(r,t,e){var n=r,a=new Float32Array(e);return n.bindBuffer(n.PIXEL_PACK_BUFFER,t),n.getBufferSubData(n.PIXEL_PACK_BUFFER,0,a),n.bindBuffer(n.PIXEL_PACK_BUFFER,null),a}function gI(r,t,e,n,a){var i=wd(e,n),s=i[0],l=i[1],c=new Uint8Array(e*n*4);return De(r,t,function(){return r.readPixels(0,0,s,l,a.downloadTextureFormat,r.UNSIGNED_BYTE,c)}),new Float32Array(c.buffer)}function yI(r,t,e,n,a,i,s,l){var c=r,f=new Float32Array(function(d,v){var m=kc(d,v);return m[0]*m[1]*4}(i,s));return c.bindBuffer(c.PIXEL_PACK_BUFFER,t),c.getBufferSubData(c.PIXEL_PACK_BUFFER,0,f),c.bindBuffer(c.PIXEL_PACK_BUFFER,null),f}function bI(r,t,e,n){var a=new Float32Array(e*n*4);return De(r,t,function(){return r.readPixels(0,0,n,e,r.RGBA,r.FLOAT,a)}),a}var xI=function(){function r(t){this.outputTexture=null,this.program=null,this.disposed=!1,this.vertexAttrsAreBound=!1,this.itemsToPoll=[];var e=le().getNumber("WEBGL_VERSION");t!=null?(this.gl=t,X3(e,t)):this.gl=wa(e);var n="WEBGL_color_buffer_float";if(le().getNumber("WEBGL_VERSION")===1){if(this.textureFloatExtension=ah(this.gl,this.debug,"OES_texture_float"),kr(this.gl,"OES_texture_half_float"))this.textureHalfFloatExtension=ah(this.gl,this.debug,"OES_texture_half_float");else if(le().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(n),kr(this.gl,"EXT_color_buffer_half_float"))this.colorBufferHalfFloatExtension=ah(this.gl,this.debug,"EXT_color_buffer_half_float");else if(le().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(n="EXT_color_buffer_float",kr(this.gl,n))this.colorBufferFloatExtension=this.gl.getExtension(n);else{if(!kr(this.gl,"EXT_color_buffer_half_float"))throw new Error("GL context does not support color renderable floats");this.colorBufferHalfFloatExtension=this.gl.getExtension("EXT_color_buffer_half_float")}this.vertexBuffer=iI(this.gl,this.debug),this.indexBuffer=oI(this.gl,this.debug),this.framebuffer=u4(this.gl,this.debug),this.textureConfig=vy(this.gl,this.textureHalfFloatExtension)}return Object.defineProperty(r.prototype,"debug",{get:function(){return le().getBool("DEBUG")},enumerable:!0,configurable:!0}),r.prototype.dispose=function(){var t=this;if(!this.disposed){this.program!=null&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),this.outputTexture!=null&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");var e=this.gl;De(e,this.debug,function(){return e.finish()}),De(e,this.debug,function(){return e.bindFramebuffer(e.FRAMEBUFFER,null)}),De(e,this.debug,function(){return e.deleteFramebuffer(t.framebuffer)}),De(e,this.debug,function(){return e.bindBuffer(e.ARRAY_BUFFER,null)}),De(e,this.debug,function(){return e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null)}),De(e,this.debug,function(){return e.deleteBuffer(t.indexBuffer)}),this.disposed=!0}},r.prototype.createFloat32MatrixTexture=function(t,e){return this.throwIfDisposed(),sI(this.gl,this.debug,t,e,this.textureConfig)},r.prototype.createFloat16MatrixTexture=function(t,e){return this.throwIfDisposed(),uI(this.gl,this.debug,t,e,this.textureConfig)},r.prototype.createUnsignedBytesMatrixTexture=function(t,e){return this.throwIfDisposed(),lI(this.gl,this.debug,t,e,this.textureConfig)},r.prototype.uploadPixelDataToTexture=function(t,e){this.throwIfDisposed(),pI(this.gl,this.debug,t,e)},r.prototype.uploadDenseMatrixToTexture=function(t,e,n,a){this.throwIfDisposed(),dI(this.gl,this.debug,t,e,n,a,this.textureConfig)},r.prototype.createFloat16PackedMatrixTexture=function(t,e){return this.throwIfDisposed(),fI(this.gl,this.debug,t,e,this.textureConfig)},r.prototype.createPackedMatrixTexture=function(t,e){return this.throwIfDisposed(),cI(this.gl,this.debug,t,e,this.textureConfig)},r.prototype.deleteMatrixTexture=function(t){var e=this;this.throwIfDisposed(),this.outputTexture===t&&(j2(this.gl,this.debug,this.framebuffer),this.outputTexture=null),De(this.gl,this.debug,function(){return e.gl.deleteTexture(t)})},r.prototype.downloadByteEncodedFloatMatrixFromOutputTexture=function(t,e,n){var a=this;return this.downloadMatrixDriver(t,function(){return gI(a.gl,a.debug,e,n,a.textureConfig)})},r.prototype.downloadPackedMatrixFromBuffer=function(t,e,n,a,i,s){return yI(this.gl,t,0,0,0,i,s,this.textureConfig)},r.prototype.downloadFloat32MatrixFromBuffer=function(t,e){return mI(this.gl,t,e)},r.prototype.createBufferFromTexture=function(t,e,n){this.bindTextureToFrameBuffer(t);var a=vI(this.gl,this.debug,e,n,this.textureConfig);return this.unbindTextureToFrameBuffer(),a},r.prototype.createAndWaitForFence=function(){var t=this.createFence(this.gl);return this.pollFence(t)},r.prototype.createFence=function(t){var e,n,a=this;if(le().getBool("WEBGL_FENCE_API_ENABLED")){var i=t,s=i.fenceSync(i.SYNC_GPU_COMMANDS_COMPLETE,0);t.flush(),n=function(){var l=i.clientWaitSync(s,0,0);return l===i.ALREADY_SIGNALED||l===i.CONDITION_SATISFIED},e=s}else le().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(e=this.beginQuery(),this.endQuery(),n=function(){return a.isQueryAvailable(e,le().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}):n=function(){return!0};return{query:e,isFencePassed:n}},r.prototype.downloadMatrixFromPackedTexture=function(t,e,n){var a=this;return this.downloadMatrixDriver(t,function(){return bI(a.gl,a.debug,e,n)})},r.prototype.createProgram=function(t){this.throwIfDisposed();var e=this.gl,n=e4(e,this.debug,t),a=aI(e,this.debug),i=n4(e,this.debug);return De(e,this.debug,function(){return e.attachShader(i,a)}),De(e,this.debug,function(){return e.attachShader(i,n)}),r4(e,this.debug,i),this.debug&&Cm(e,this.debug,i),this.vertexAttrsAreBound||(this.setProgram(i),this.vertexAttrsAreBound=hI(e,this.debug,this.program,this.vertexBuffer)),i},r.prototype.deleteProgram=function(t){var e=this;this.throwIfDisposed(),t===this.program&&(this.program=null),t!=null&&De(this.gl,this.debug,function(){return e.gl.deleteProgram(t)})},r.prototype.setProgram=function(t){var e=this;this.throwIfDisposed(),this.program=t,this.program!=null&&this.debug&&Cm(this.gl,this.debug,this.program),De(this.gl,this.debug,function(){return e.gl.useProgram(t)})},r.prototype.getUniformLocation=function(t,e,n){return n===void 0&&(n=!0),this.throwIfDisposed(),n?c4(this.gl,this.debug,t,e):f4(this.gl,t,e)},r.prototype.getAttributeLocation=function(t,e){var n=this;return this.throwIfDisposed(),De(this.gl,this.debug,function(){return n.gl.getAttribLocation(t,e)})},r.prototype.getUniformLocationNoThrow=function(t,e){return this.throwIfDisposed(),this.gl.getUniformLocation(t,e)},r.prototype.setInputMatrixTexture=function(t,e,n){this.throwIfDisposed(),this.throwIfNoProgram(),h4(this.gl,this.debug,this.program,t,e,n)},r.prototype.setOutputMatrixTexture=function(t,e,n){this.setOutputMatrixTextureDriver(t,n,e)},r.prototype.setOutputPackedMatrixTexture=function(t,e,n){this.throwIfDisposed();var a=kc(e,n),i=a[0],s=a[1];this.setOutputMatrixTextureDriver(t,i,s)},r.prototype.setOutputMatrixWriteRegion=function(t,e,n,a){this.setOutputMatrixWriteRegionDriver(n,t,a,e)},r.prototype.setOutputPackedMatrixWriteRegion=function(t,e,n,a){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")},r.prototype.debugValidate=function(){this.program!=null&&Cm(this.gl,this.debug,this.program),ih(this.gl)},r.prototype.executeProgram=function(){this.throwIfDisposed(),this.throwIfNoProgram();var t=this.gl;this.debug&&this.debugValidate(),De(t,this.debug,function(){return t.drawElements(t.TRIANGLES,6,t.UNSIGNED_SHORT,0)})},r.prototype.blockUntilAllProgramsCompleted=function(){var t=this;this.throwIfDisposed(),De(this.gl,this.debug,function(){return t.gl.finish()})},r.prototype.getQueryTimerExtension=function(){return this.disjointQueryTimerExtension==null&&(this.disjointQueryTimerExtension=ah(this.gl,this.debug,le().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension},r.prototype.getQueryTimerExtensionWebGL2=function(){return this.getQueryTimerExtension()},r.prototype.getQueryTimerExtensionWebGL1=function(){return this.getQueryTimerExtension()},r.prototype.beginQuery=function(){if(le().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){var t=this.gl,e=this.getQueryTimerExtensionWebGL2(),n=t.createQuery();return t.beginQuery(e.TIME_ELAPSED_EXT,n),n}var a=this.getQueryTimerExtensionWebGL1(),i=a.createQueryEXT();return a.beginQueryEXT(a.TIME_ELAPSED_EXT,i),i},r.prototype.endQuery=function(){if(le().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")!==2){var t=this.getQueryTimerExtensionWebGL1();t.endQueryEXT(t.TIME_ELAPSED_EXT)}else{var e=this.gl,n=this.getQueryTimerExtensionWebGL2();e.endQuery(n.TIME_ELAPSED_EXT)}},r.prototype.waitForQueryAndGetTime=function(t){return Ee(this,void 0,void 0,function(){var e=this;return Ce(this,function(n){switch(n.label){case 0:return[4,B2(function(){return e.disposed||e.isQueryAvailable(t,le().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))})];case 1:return n.sent(),[2,this.getQueryTime(t,le().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))]}})})},r.prototype.getQueryTime=function(t,e){if(e===0)return null;if(e===2){var n=this.gl;return n.getQueryParameter(t,n.QUERY_RESULT)/1e6}var a=this.getQueryTimerExtensionWebGL1();return a.getQueryObjectEXT(t,a.QUERY_RESULT_EXT)/1e6},r.prototype.isQueryAvailable=function(t,e){if(e===0)return!0;if(e===2){var n=this.gl,a=this.getQueryTimerExtensionWebGL2(),i=n.getQueryParameter(t,n.QUERY_RESULT_AVAILABLE);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(a.GPU_DISJOINT_EXT)),i&&!this.disjoint}return i=(a=this.getQueryTimerExtensionWebGL1()).getQueryObjectEXT(t,a.QUERY_RESULT_AVAILABLE_EXT),this.disjoint==null&&(this.disjoint=this.gl.getParameter(a.GPU_DISJOINT_EXT)),i&&!this.disjoint},r.prototype.pollFence=function(t){var e=this;return new Promise(function(n){e.addItemToPoll(function(){return t.isFencePassed()},function(){return n()})})},r.prototype.pollItems=function(){for(var t=function(n){for(var a=0;a<n.length&&n[a]();++a);return a-1}(this.itemsToPoll.map(function(n){return n.isDoneFn})),e=0;e<=t;++e)(0,this.itemsToPoll[e].resolveFn)();this.itemsToPoll=this.itemsToPoll.slice(t+1)},r.prototype.addItemToPoll=function(t,e){var n=this;this.itemsToPoll.push({isDoneFn:t,resolveFn:e}),this.itemsToPoll.length>1||B2(function(){return n.pollItems(),n.itemsToPoll.length===0})},r.prototype.bindTextureToFrameBuffer=function(t){this.throwIfDisposed(),Rm(this.gl,this.debug,t,this.framebuffer),this.debug&&ih(this.gl)},r.prototype.unbindTextureToFrameBuffer=function(){this.outputTexture!=null?(Rm(this.gl,this.debug,this.outputTexture,this.framebuffer),this.debug&&ih(this.gl)):j2(this.gl,this.debug,this.framebuffer)},r.prototype.downloadMatrixDriver=function(t,e){this.bindTextureToFrameBuffer(t);var n=e();return this.unbindTextureToFrameBuffer(),n},r.prototype.setOutputMatrixTextureDriver=function(t,e,n){this.throwIfDisposed();var a=this.gl;Rm(a,this.debug,t,this.framebuffer),this.debug&&ih(a),this.outputTexture=t,De(a,this.debug,function(){return a.viewport(0,0,e,n)}),De(a,this.debug,function(){return a.scissor(0,0,e,n)})},r.prototype.setOutputMatrixWriteRegionDriver=function(t,e,n,a){var i=this;this.throwIfDisposed(),De(this.gl,this.debug,function(){return i.gl.scissor(t,e,n,a)})},r.prototype.throwIfDisposed=function(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")},r.prototype.throwIfNoProgram=function(){if(this.program==null)throw new Error("No GPU program is currently set.")},r}();function n_(r,t){if(r.length!==t.length)throw Error("Binary was compiled with "+r.length+" inputs, but was executed with "+t.length+" inputs");r.forEach(function(e,n){var a=e.logicalShape,i=t[n],s=i.shape;if(!vn(a,s))throw Error("Binary was compiled with different shapes than the current args. Shapes "+a+" and "+s+" must match");if(!e.isUniform||!i.isUniform){var l=e.texShape,c=i.isUniform?null:i.texData.texShape;if(!vn(l,c))throw Error("Binary was compiled with different texture shapes than the current args. Shape "+l+" and "+c+" must match")}})}var wI=function(r,t,e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=r;for(var n=e.filterWidth,a=e.inChannels,i=e.strideWidth,s=e.strideHeight,l=e.padInfo,c=e.outWidth,f=e.dilationWidth,d=e.dilationHeight,v=e.dataFormat,m=l.left,g=l.top,b=a*n,w=On(),_=v==="channelsLast",S=_?0:1,E=_?1:2,C="",R=0;R<=1;R++)for(var A=0;A<=1;A++)C+=`
          blockIndex = rc.y + `+A+`;
          pos = rc.x + `+R+`;

          if(blockIndex < `+r[1]+" && pos < "+r[0]+`) {
            offsetY = int(blockIndex / (`+c+")) * "+s+" - "+g+`;
            d0 = offsetY + `+d+" * (pos / "+b+`);

            if(d0 < `+t[S]+` && d0 >= 0) {

              offsetX = int(mod(float(blockIndex), `+c+".) * "+i+". - "+m+`.);
              d1 = offsetX + `+f+" * (int(mod(float(pos), "+b+".) / "+a+`.));

              if(d1 < `+t[E]+` && d1 >= 0) {

                ch = int(mod(float(pos), `+a+`.));

                if (`+_+`) {
                  innerDims = vec2(d1, ch);
                  result[`+(2*R+A)+`] = getChannel(
                    getA(d0, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                } else {
                  innerDims = vec2(d0, d1);
                  result[`+(2*R+A)+`] = getChannel(
                    getA(ch, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                }
              }
            }
          }
        `;this.userCode=`
      void main() {
        ivec2 rc = getOutputCoords();

        vec4 result = vec4(0);

        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;
        vec2 innerDims;

        `+C+`

        `+w.output+` = result;
      }
    `},_I=function(r,t,e,n,a){this.variableNames=["x"],this.outputShape=[];var i,s=t,l=r[3]-1;this.outputShape=r;var c="float("+e+") + float("+n+") * sum";i=a===.5?"inversesqrt("+c+")":a===1?"1.0/("+c+")":"exp(log("+c+") * float(-"+a+"));",this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];
        int d = coords[3];
        float x = getX(b, r, c, d);
        float sum = 0.0;
        for (int j = -`+s+"; j <= "+s+`; j++) {
          int idx = d + j;
          if (idx >= 0 && idx <=  `+l+`) {
            float z = getX(b, r, c, idx);
            sum += z * z;
          }
        }
        float val = x * `+i+`;
        setOutput(val);
      }
    `},SI=function(r,t,e,n,a){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=r,this.depth=r[3],this.depthRadius=t,this.bias=e,this.alpha=n,this.beta=a,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];

        float result = 0.0;
        for (int d = 0; d < `+this.depth+`; ++d) {
          int depthBegin = int(max(0.0, float(d - `+t+`)));
          int depthEnd = int(min(float(`+this.depth+`),
              float(d + `+t+` + 1)));

          const int MIN_DEPTH_BEGIN = 0;
          const int MAX_DEPTH_END = `+this.depth+`;

          float norm = 0.0;
          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd) {
              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);
            }
            else {
              break;
            }
          }

          norm = float(`+n+") * norm + float("+e+`);

          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd){
              float dyi = -2.0 * float(`+n+`)
                * float(`+a+`)
                * getInputImage(b ,r ,c, k) * getOutputImage(b, r, c, d)
                / norm;
              if (k == d) {
                dyi += pow(norm, -1.0 * `+a+`);
              }
              if (k == coords[3]) {
                dyi *= getDy(b, r, c, d);
                result += dyi;
              }
            }
            else {
              break;
            }
          }
      }
      setOutput(result);
      }
    `},EI=function(r,t,e,n,a){this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;var i,s=t,l=r[3]-1;this.outputShape=r;var c="float("+e+") + float("+n+") * sum";i=a===.5?"inversesqrt("+c+")":a===1?"1.0/("+c+")":"exp(log("+c+") * float(-"+a+"));",this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords.x;
        int r = coords.y;
        int c = coords.z;
        int d = coords.w;

        bool hasNextCol = d < `+this.outputShape[3]+`;
        bool hasNextRow = c < `+this.outputShape[2]+`;

        vec4 sum = vec4(0.);
        vec4 xFragAtOutputCoords = getX(b, r, c, d);

        vec4 xAtOutputCoords = vec4(
          getChannel(xFragAtOutputCoords, vec2(c, d)),
          hasNextCol ?
            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,
          hasNextRow ?
            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,
          (hasNextRow && hasNextCol) ?
            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0
        );

        int firstChannel = d - `+s+`;
        vec2 cache = vec2(0.);
        if(firstChannel >= 0){
          vec4 firstChannelFrag = getX(b, r, c, firstChannel);
          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));
            if(hasNextRow){
              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));
            }
        }

        ivec2 depth = ivec2(d, d + 1);
        for (int j = - `+s+"; j <= "+s+`; j++) {
          ivec2 idx = depth + j;
          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));
          bvec2 belowUpperBound = lessThanEqual(idx, ivec2(`+l+`));

          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;
          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;

          if(depthInRange || depthPlusOneInRange){
            vec4 z = vec4(0.);
            vec4 xFragAtCurrentDepth;
            z.xz = cache.xy;
            if(depthPlusOneInRange && hasNextCol){
              xFragAtCurrentDepth = idx.y != d ?
                getX(b, r, c, idx.y) : xFragAtOutputCoords;
              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));
              if(hasNextRow){
                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));
              }
            }
            cache.xy = z.yw;
            sum += z * z;
          }
        }
        vec4 result = xAtOutputCoords * `+i+`;
        setOutput(result);
      }
    `},CI=function(r){this.variableNames=["dy","maxPos"],this.outputShape=r.inShape;var t=r.strideHeight,e=r.strideWidth,n=r.dilationHeight,a=r.effectiveFilterHeight,i=r.effectiveFilterWidth,s=a-1-r.padInfo.top,l=i-1-r.padInfo.left,c=a*i-1;this.userCode=`
      const ivec2 pads = ivec2(`+s+", "+l+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < `+a+`;
          wR += `+n+`) {
          float dyR = float(dyRCorner + wR) / `+t+`.0;

          if (dyR < 0.0 || dyR >= `+r.outHeight+`.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < `+i+`; wC++) {
            float dyC = float(dyCCorner + wC) / `+e+`.0;

            if (dyC < 0.0 || dyC >= `+r.outWidth+`.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);
            int maxPosValue = `+c+` - int(getMaxPos(b, idyR, idyC, d));

            // Get the current value, check it against the value from the
            // position matrix.
            int curPosValue = wR * `+i+` + wC;
            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

            dotProd += dyValue * mask;
          }
        }
        setOutput(dotProd);
      }
    `},RI=function(r){this.variableNames=["dy","maxPos"],this.outputShape=r.inShape;var t=r.strideDepth,e=r.strideHeight,n=r.strideWidth,a=r.dilationDepth,i=r.dilationHeight,s=r.dilationWidth,l=r.effectiveFilterDepth,c=r.effectiveFilterHeight,f=r.effectiveFilterWidth,d=l-1-r.padInfo.front,v=c-1-r.padInfo.top,m=f-1-r.padInfo.left,g=l*c*f-1;this.userCode=`
      const ivec3 pads = ivec3(`+d+", "+v+", "+m+`);

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < `+l+`;
           wD += `+a+`) {
          float dyD = float(dyDCorner + wD) / `+t+`.0;

          if (dyD < 0.0 || dyD >= `+r.outDepth+`.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < `+c+`;
              wR += `+i+`) {
            float dyR = float(dyRCorner + wR) / `+e+`.0;

            if (dyR < 0.0 || dyR >= `+r.outHeight+`.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < `+f+`;
                wC += `+s+`) {
              float dyC = float(dyCCorner + wC) / `+n+`.0;

              if (dyC < 0.0 || dyC >= `+r.outWidth+`.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);
              int maxPosValue = `+g+` -
                  int(getMaxPos(batch, idyD, idyR, idyC, ch));

              // Get the current value, check it against the value from the
              // position matrix.
              int curPosValue =
                  wD * `+c+" * "+f+` +
                  wR * `+f+` + wC;
              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

              dotProd += dyValue * mask;
            }
          }
        }
        setOutput(dotProd);
      }
    `},Om=function(r,t,e,n,a,i,s){e===void 0&&(e=!1),n===void 0&&(n=!1),a===void 0&&(a=!1),i===void 0&&(i=null),s===void 0&&(s=!1),this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t;var l=e?r[1]:r[2],c=Math.ceil(l/2),f=e?"i * 2, rc.y":"rc.y, i * 2",d=n?"rc.z, i * 2":"i * 2, rc.z",v=e?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],m=n?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"],g="",b="";i&&(g=s?`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          `+i+`
        }`:`vec4 activation(vec4 x) {
          `+i+`
        }`,b="result = activation(result);");var w=a?"result += getBiasAtOutCoords();":"";a&&this.variableNames.push("bias"),s&&this.variableNames.push("preluActivationWeights"),this.userCode=`
      `+g+`

      const float sharedDimension = `+c+`.0;

      vec4 dot2x2ARowBCol(ivec3 rc) {
        vec4 result = vec4(0);
        for (int i = 0; i < `+c+`; i++) {
          vec4 a = getMatrixA(rc.x, `+f+`);
          vec4 b = getMatrixB(rc.x, `+d+`);

          // These swizzled products need to be separately added.
          // See: https://github.com/tensorflow/tfjs/issues/1735
          result += (`+v[0]+" * "+m[0]+`);
          result += (`+v[1]+" * "+m[1]+`);
        }
        return result;
      }

      void main() {
        ivec3 rc = getOutputCoords();
        vec4 result = dot2x2ARowBCol(rc);

        `+w+`

        `+b+`

        setOutput(result);
      }
    `},AI=function(){function r(t,e,n){this.variableNames=["probs"],this.outputShape=[t,n],this.userCode=`
      uniform float seed;

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];

        float r = random(seed);
        float cdf = 0.0;

        for (int i = 0; i < `+(e-1)+`; i++) {
          cdf += getProbs(batch, i);

          if (r < cdf) {
            setOutput(float(i));
            return;
          }
        }

        // If no other event happened, last event happened.
        setOutput(float(`+(e-1)+`));
      }
    `}return r.prototype.getCustomSetupFunc=function(t){var e=this;return function(n,a){e.seedLoc==null&&(e.seedLoc=n.getUniformLocation(a,"seed")),n.gl.uniform1f(e.seedLoc,t)}},r}(),TI=function(r,t,e,n){this.variableNames=["indices"],this.outputShape=[r,t],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int index = round(getIndices(coords.x));
        setOutput(mix(float(`+n+"), float("+e+`),
                      float(index == coords.y)));
      }
    `},DI=function(r){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=r;var t=r.length;if(t===0)this.userCode=`
        void main() {
          setOutput(vec4(getA(), 0., 0., 0.));
        }
      `;else{var e=$n("rc",t),n=At(t),a=function(l,c,f){if(l===1)return"rc > "+c[0];for(var d="",v=l-2;v<l;v++)d+=f[v]+" >= "+c[v],v<l-1&&(d+="||");return d}(t,r,e),i=function(l,c,f,d){if(l===1)return"";var v=d.slice(-2);return`
    int r = `+v[0]+`;
    int c = `+v[1]+`;
    int rp1 = r + 1;
    int cp1 = c + 1;

    bool cEdge = cp1 >= `+c+`;
    bool rEdge = rp1 >= `+f+`;
  `}(t,r[r.length-1],r[r.length-2],e),s=function(l,c){var f=l.length,d=function(v,m){for(var g=[],b=0;b<=1;b++)for(var w=0;w<=1;w++){for(var _=(b===0?"r":"rp1")+", "+(w===0?"c":"cp1"),S=2;S<v;S++)_=m[m.length-1-S]+","+_;g.push(_)}return g}(f,c);return f===1?`getA(rc),
            rc + 1 >= `+l[0]+` ? 0. : getA(rc + 1),
            0, 0`:"getA("+d[0]+`),
          cEdge ? 0. : getA(`+d[1]+`),
          rEdge ? 0. : getA(`+d[2]+`),
          rEdge || cEdge ? 0. : getA(`+d[3]+")"}(r,e);this.userCode=`
        void main() {
          `+n+` rc = getOutputCoords();

          if(`+a+`) {
            setOutput(vec4(0));
          } else {
            `+i+`

            setOutput(vec4(`+s+`));
          }
        }
      `}},kI=function(r,t,e){this.variableNames=["x"],this.outputShape=t.map(function(c,f){return c[0]+r[f]+c[1]});var n=r.length,a=At(n),i=t.map(function(c){return c[0]}).join(","),s=t.map(function(c,f){return c[0]+r[f]}).join(","),l=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,n);this.userCode=n!==1?`
      `+a+" start = "+a+"("+i+`);
      `+a+" end = "+a+"("+s+`);

      void main() {
        `+a+` outC = getOutputCoords();
        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {
          setOutput(float(`+e+`));
        } else {
          `+a+` coords = outC - start;
          setOutput(getX(`+l+`));
        }
      }
    `:`
        int start = `+i+`;
        int end = `+s+`;

        void main() {
          int outC = getOutputCoords();
          if (outC < start || outC >= end) {
            setOutput(float(`+e+`));
          } else {
            setOutput(getX(outC - start));
          }
        }
      `},OI=function(r,t,e){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t.map(function(_,S){return _[0]+r[S]+_[1]});for(var n=r.length,a=At(n),i=t.map(function(_){return _[0]}).join(","),s=t.map(function(_,S){return _[0]+r[S]}).join(","),l=$n("rc",n),c=$n("source",n),f=l[n-1]+" < "+this.outputShape[n-1],d=n===1?"source":"vec2("+c.slice(-2).join()+")",v=[a+" rc = outputLoc;",l[n-1]+` += 1;
       if(`+f+`) {
      `,n===1?"":`}
       rc = outputLoc;
       `+l[n-2]+` += 1;
       if(`+l[n-2]+" < "+this.outputShape[n-2]+") {",n===1?"":"  "+l[n-1]+` += 1;
         if(`+f+") {"],m=n===1?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))",g="",b=0,w=n===1?2:4;b<w;b++)g+=`
        `+v[b]+`
        if (`+m+`) {
          result[`+b+"] = float("+e+`);
        } else {
          `+a+` source = rc - start;
          result[`+b+"] = getChannel(getX("+c.join()+"), "+d+`);
        }
      `;g+=n===1?"} ":"}}",this.userCode=`
      const `+a+" start = "+a+"("+i+`);
      const `+a+" end = "+a+"("+s+`);

      void main() {
        `+a+` outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        `+g+`
        setOutput(result);
      }
    `},Nm=function(r,t,e){if(this.variableNames=["x"],t==="avg"&&e)throw new Error("Cannot compute positions for average pool.");var n=r.filterWidth,a=r.strideHeight,i=r.strideWidth,s=r.dilationHeight,l=r.dilationWidth,c=r.effectiveFilterHeight,f=r.effectiveFilterWidth,d=r.padInfo.top,v=r.padInfo.left;this.outputShape=r.outShape;var m=t==="avg",g="0.0";if(m||(g="-1.0 / 1e-20"),e)this.userCode=`
        const ivec2 strides = ivec2(`+a+", "+i+`);
        const ivec2 pads = ivec2(`+d+", "+v+`);

        void main() {
          ivec4 coords = getOutputCoords();
          int batch = coords[0];
          int d = coords[3];

          ivec2 xRCCorner = coords.yz * strides - pads;
          int xRCorner = xRCCorner.x;
          int xCCorner = xRCCorner.y;

          // max/min x(?, ?, d) to get y(yR, yC, d).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;
          float avgValue = 0.0;

          for (int wR = 0; wR < `+c+`;
              wR += `+s+`) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= `+r.inHeight+`) {
              continue;
            }

            for (int wC = 0; wC < `+f+`;
                wC += `+l+`) {
              int xC = xCCorner + wC;

              if (xC < 0 || xC >= `+r.inWidth+`) {
                continue;
              }

              float value = getX(batch, xR, xC, d);

              // If a min / max value has already been found, use it. If not,
              // use the current value.
              float currMinMaxValue = mix(
                  value, minMaxValue, minMaxValueFound);
              if (value >= currMinMaxValue) {
                minMaxValue = value;
                minMaxValueFound = 1.0;
                minMaxPosition = wR * `+f+` + wC;
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;else{var b=t+"("+t+"("+t+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";t==="avg"&&(b="avgValue / count");var w=4*Math.floor(n/4),_=n%4,S=`
      if (`+m+`) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = max(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec2 strides = ivec2(`+a+", "+i+`);
      const ivec2 pads = ivec2(`+d+", "+v+`);
      const float initializationValue = `+g+`;
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xR, int xC, int d) {
        if (xC < 0 || xC >= `+r.inWidth+`) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xR, xC, d);
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d = coords[3];

        ivec2 xRCCorner = coords.yz * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // max/min x(?, ?, d) to get y(yR, yC, d).
        // ? = to be determined
        vec4 minMaxValue = vec4(`+g+`);
        float avgValue = 0.0;
        count = 0.0;

        for (int wR = 0; wR < `+c+`;
            wR += `+s+`) {
          int xR = xRCorner + wR;

          if (xR < 0 || xR >= `+r.inHeight+`) {
            continue;
          }

          for (int wC = 0; wC < `+w+`; wC += 4) {
            int xC = xCCorner + wC * `+l+`;

            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + `+l+`, d),
              getValue(batch, xR, xC + 2 * `+l+`, d),
              getValue(batch, xR, xC + 3 * `+l+`, d)
            );

            `+S+`
          }

          int xC = xCCorner + `+w+`;
          if (`+(_===1)+`) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              initializationValue,
              initializationValue,
              initializationValue
            );

            `+S+`
          } else if (`+(_===2)+`) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + `+l+`, d),
              initializationValue,
              initializationValue
            );

            `+S+`
          } else if (`+(_===3)+`) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + `+l+`, d),
              getValue(batch, xR, xC + 2 * `+l+`, d),
              initializationValue
            );

            `+S+`
          }
        }
        setOutput(`+b+`);
      }
    `}},Mm=function(r,t,e){if(this.variableNames=["x"],t==="avg"&&e)throw new Error("Cannot compute positions for average pool.");var n=r.filterWidth,a=r.strideDepth,i=r.strideHeight,s=r.strideWidth,l=r.dilationDepth,c=r.dilationHeight,f=r.dilationWidth,d=r.effectiveFilterDepth,v=r.effectiveFilterHeight,m=r.effectiveFilterWidth,g=r.padInfo.front,b=r.padInfo.top,w=r.padInfo.left;this.outputShape=r.outShape;var _=t==="avg",S="0.0";if(_||(S="-1.0 / 1e-20"),e)this.userCode=`
        const ivec3 strides =
            ivec3(`+a+", "+i+", "+s+`);
        const ivec3 pads = ivec3(`+g+", "+b+", "+w+`);

        void main() {
          ivec5 coords = getOutputCoords();
          int batch = coords.x;
          int ch = coords.u;

          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
          int xDCorner = xCorner.x;
          int xRCorner = xCorner.y;
          int xCCorner = xCorner.z;

          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;

          for (int wD = 0; wD < `+d+`;
              wD += `+l+`) {
            int xD = xDCorner + wD;

            if (xD < 0 || xD >= `+r.inDepth+`) {
              continue;
            }

            for (int wR = 0; wR < `+v+`;
                wR += `+c+`) {
              int xR = xRCorner + wR;

              if (xR < 0 || xR >= `+r.inHeight+`) {
                continue;
              }

              for (int wC = 0; wC < `+m+`;
                  wC += `+f+`) {
                int xC = xCCorner + wC;

                if (xC < 0 || xC >= `+r.inWidth+`) {
                  continue;
                }

                float value = getX(batch, xD, xR, xC, ch);

                // If a min / max value has already been found, use it. If not,
                // use the current value.
                float currMinMaxValue = mix(
                    value, minMaxValue, minMaxValueFound);
                if (value >= currMinMaxValue) {
                  minMaxValue = value;
                  minMaxValueFound = 1.0;
                  minMaxPosition =
                      wD * `+v+" * "+m+` +
                      wR * `+m+` + wC;;
                }
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;else{var E=t+"("+t+"("+t+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";t==="avg"&&(E="avgValue / count");var C=4*Math.floor(n/4),R=n%4,A=`
      if (`+_+`) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = max(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec3 strides =
        ivec3(`+a+", "+i+", "+s+`);
      const ivec3 pads = ivec3(`+g+", "+b+", "+w+`);
      const float initializationValue = `+S+`;
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xD, int xR, int xC, int ch) {
        if (xC < 0 || xC >= `+r.inWidth+`) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xD, xR, xC, ch);
      }

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xDCorner = xCorner.x;
        int xRCorner = xCorner.y;
        int xCCorner = xCorner.z;

        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).
        // ? = to be determined
        vec4 minMaxValue = vec4(`+S+`);
        float avgValue = 0.0;
        count = 0.0;

        for (int wD = 0; wD < `+d+`;
            wD += `+l+`) {
          int xD = xDCorner + wD;

          if (xD < 0 || xD >= `+r.inDepth+`) {
            continue;
          }

          for (int wR = 0; wR < `+v+`;
            wR += `+c+`) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= `+r.inHeight+`) {
              continue;
            }

            for (int wC = 0; wC < `+C+`; wC += 4) {
              int xC = xCCorner + wC * `+f+`;

              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + `+f+`, ch),
                getValue(batch, xD, xR, xC + 2 * `+f+`, ch),
                getValue(batch, xD, xR, xC + 3 * `+f+`, ch)
              );

              `+A+`
            }

            int xC = xCCorner + `+C+`;
            if (`+(R===1)+`) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                initializationValue,
                initializationValue,
                initializationValue
              );

              `+A+`
            } else if (`+(R===2)+`) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + `+f+`, ch),
                initializationValue,
                initializationValue
              );

              `+A+`
            } else if (`+(R===3)+`) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + `+f+`, ch),
                getValue(batch, xD, xR, xC + 2 * `+f+`, ch),
                initializationValue
              );

              `+A+`
            }
          }
          setOutput(`+E+`);
        }
      }
    `}},NI=function(r,t){this.variableNames=["x"];var e=r.windowSize,n=r.batchSize,a=r.inSize,i=Math.ceil(a/e);this.outputShape=[n,i];var s="0.0",l="";t==="prod"?s="1.0":t==="min"?(s="1.0 / 1e-20",l="min"):t==="max"&&(s="-1.0 / 1e-20",l="max");var c=t+"("+t+"("+t+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";t==="sum"?c="sumValue":t==="prod"?c="prodValue":t==="all"?c="allValue":t==="any"&&(c="anyValue");var f=4*Math.floor(e/4),d=e%4,v=`
      if (`+(t==="sum")+`) {
        sumValue += dot(values, ones);
      } else if (`+(t==="prod")+`) {
        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);
        prodValue *= tmp[0] * tmp[1];
      } else {
        minMaxValue = `+l+`(values, minMaxValue);
      }
    `,m="vec4";t==="all"?(s="1.0",v=`
        bool reducedAllValue = all(values);
        float floatedReducedAllValue = float(reducedAllValue);
        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);
      `,m="bvec4"):t==="any"&&(s="0.0",v=`
        bool reducedAnyValue = any(values);
        float floatedReducedAnyValue = float(reducedAnyValue);
        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);
      `,m="bvec4");var g="";a%e>0&&(g=`
        if (inIdx < 0 || inIdx >= `+a+`) {
          return initializationValue;
        }
      `),this.userCode=`
      const float initializationValue = `+s+`;
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        `+g+`
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * `+e+`;

        vec4 minMaxValue = vec4(`+s+`);
        float prodValue = 1.0;
        float sumValue = 0.0;
        float allValue = 1.0;
        float anyValue = 0.0;

        for (int i = 0; i < `+f+`; i += 4) {
          int inIdx = inOffset + i;
          `+m+" values = "+m+`(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          `+v+`
        }

        int inIdx = inOffset + `+f+`;
        if (`+(d===1)+`) {
          `+m+" values = "+m+`(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          `+v+`
        } else if (`+(d===2)+`) {
          `+m+" values = "+m+`(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          `+v+`
        } else if (`+(d===3)+`) {
          `+m+" values = "+m+`(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          `+v+`
        }
        setOutput(`+c+`);
      }
    `},MI=function(r,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=r;for(var e="",n=0;n<4;n++){var a="thisRC = rc;";n%2==1&&(a+="thisRC.z += 1;"),n>1&&(a+="thisRC.y += 1;"),e+=`
        `+a+`
        `+(n>0?"if(thisRC.y < rows && thisRC.z < cols){":"")+`
          int flatIndex = getFlatIndex(thisRC);

          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);
          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));

          result[`+n+`] =
            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);
        `+(n>0?"}":"")+`
      `}this.userCode=`
      
    ivec3 inputCoordsFromReshapedOutCoords(int index) {
      `+Io(["r","c","d"],t)+`
      return ivec3(r, c, d);
    }
  
      `+Cy(r)+`

      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0.);

        ivec3 thisRC;
        int rows = `+r[1]+`;
        int cols = `+r[2]+`;

        `+e+`

        setOutput(result);
      }
    `},II=function(r,t,e){this.variableNames=["dy"],this.outputShape=[],this.outputShape=t.shape;var n=t.shape,a=n[1],i=n[2],s=r.shape,l=s[1],c=s[2],f=[e&&l>1?a-1:a,e&&c>1?i-1:i],d=[e&&l>1?l-1:l,e&&c>1?c-1:c],v=f[0]/d[0],m=f[1]/d[1],g=1/v,b=1/m,w=2*Math.ceil(g)+2,_=2*Math.ceil(b)+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(`+v+`);
        const float widthScale = float(`+m+`);

        const float invHeightScale = float(`+g+`);
        const float invWidthScale = float(`+b+`);

        const int winHeight = int(`+w+`);
        const int winWidth = int(`+_+`);

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(startRLerp - float(winHeight / 2));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(startCLerp - float(winWidth / 2));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= `+l+`) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= `+c+`) {
              continue;
            }

            float dxR = float(dyR) * heightScale;
            int topDxRIndex = int(floor(dxR));
            int bottomDxRIndex = int(min(ceil(dxR), `+(a-1)+`.0));
            float dxRLerp = dxR - float(topDxRIndex);
            float inverseDxRLerp = 1.0 - dxRLerp;

            float dxC = float(dyC) * widthScale;
            int leftDxCIndex = int(floor(dxC));
            int rightDxCIndex = int(min(ceil(dxC), `+(i-1)+`.0));
            float dxCLerp = dxC - float(leftDxCIndex);
            float inverseDxCLerp = 1.0 - dxCLerp;

            if (r == topDxRIndex && c == leftDxCIndex) {
              // topLeft
              accumulator +=
                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;
            }

            if (r == topDxRIndex && c == rightDxCIndex) {
              // topRight
              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;
            }

            if (r == bottomDxRIndex && c == leftDxCIndex) {
              // bottomLeft
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;
            }

            if (r == bottomDxRIndex && c == rightDxCIndex) {
              // bottomRight
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `},FI=function(r,t,e,n){this.variableNames=["A"],this.outputShape=[];var a=r[0],i=r[1],s=r[2],l=r[3];this.outputShape=[a,t,e,l];var c=[n&&t>1?i-1:i,n&&e>1?s-1:s],f=[n&&t>1?t-1:t,n&&e>1?e-1:e];this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          `+c[0]/f[0]+`,
          `+c[1]/f[1]+`);
      const vec2 inputShapeRC = vec2(`+i+".0, "+s+`.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = vec2(yRC) * effectiveInputOverOutputRatioRC;

        // Compute the four integer indices.
        ivec2 sourceFloorRC = ivec2(sourceFracIndexRC);
        ivec2 sourceCeilRC = ivec2(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);
        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);
        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);
        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);

        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);

        float top = topLeft + (topRight - topLeft) * fracRC.y;
        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;
        float newValue = top + (bottom - top) * fracRC.x;

        setOutput(newValue);
      }
    `},BI=function(r,t,e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];var a=r[0],i=r[1],s=r[2],l=r[3];this.outputShape=[a,t,e,l];var c=[n&&t>1?i-1:i,n&&e>1?s-1:s],f=[n&&t>1?t-1:t,n&&e>1?e-1:e];this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          `+c[0]/f[0]+`,
          `+c[1]/f[1]+`,
          `+c[1]/f[1]+`);
      const vec3 inputShapeRC = vec3(`+i+".0, "+s+`.0,
                                     `+s+`.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = vec3(yRC) * effectiveInputOverOutputRatioRC;

        // Compute the four integer indices.
        ivec3 sourceFloorRC = ivec3(sourceFracIndexRC);
        ivec3 sourceCeilRC = ivec3(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < `+(l-1)+`;
        bool hasNextRow = coords.z < `+(e-1)+`;

        // In parallel, construct four corners for all four components in
        // packed 2x2 cell.
        vec4 topLeft = vec4(
          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 bottomLeft = vec4(
          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 topRight = vec4(
          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec4 bottomRight = vec4(
          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);

        vec4 top = mix(topLeft, topRight, fracRC.yyzz);
        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);
        vec4 newValue = mix(top, bottom, fracRC.x);

        setOutput(newValue);
      }
    `},LI=function(r,t,e){this.variableNames=["dy"],this.outputShape=[],this.outputShape=t.shape;var n=t.shape,a=n[1],i=n[2],s=r.shape,l=s[1],c=s[2],f=[e&&l>1?a-1:a,e&&c>1?i-1:i],d=[e&&l>1?l-1:l,e&&c>1?c-1:c],v=f[0]/d[0],m=f[1]/d[1],g=1/v,b=1/m,w=2*Math.ceil(g)+2,_=2*Math.ceil(b)+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(`+v+`);
        const float widthScale = float(`+m+`);

        const float invHeightScale = float(`+g+`);
        const float invWidthScale = float(`+b+`);

        const int winHeight = int(`+w+`);
        const int winWidth = int(`+_+`);

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(floor(startRLerp - float(winHeight / 2)));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(floor(startCLerp - float(winWidth / 2)));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= `+l+`) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= `+c+`) {
              continue;
            }

            float sourceFracRow =
              float(`+f[0]+`) *
                (float(dyR) / float(`+d[0]+`));

            float sourceFracCol =
                float(`+f[1]+`) *
                  (float(dyC) / float(`+d[1]+`));

            int sourceNearestRow = int(min(
                float(int(`+a+`) - 1),
                `+e+` ? float(round(sourceFracRow)) :
                                  float(floor(sourceFracRow))));

            int sourceNearestCol = int(min(
                float(int(`+i+`) - 1),
                `+e+` ? float(round(sourceFracCol)) :
                                  float(floor(sourceFracCol))));

            if (r == sourceNearestRow && c == sourceNearestCol) {
              accumulator += getDy(b, dyR, dyC, d);
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `},PI=function(r,t,e,n){this.variableNames=["A"],this.outputShape=[];var a=r[0],i=r[1],s=r[2],l=r[3];this.outputShape=[a,t,e,l];var c=[n&&t>1?i-1:i,n&&e>1?s-1:s],f=[n&&t>1?t-1:t,n&&e>1?e-1:e],d=n?"0.5":"0.0";this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          `+c[0]/f[0]+`,
          `+c[1]/f[1]+`);
      const vec2 inputShapeRC = vec2(`+i+".0, "+s+`.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = vec2(yRC) * effectiveInputOverOutputRatioRC;

        // Compute the coordinators of nearest neighbor point.
        ivec2 sourceNearestRC = ivec2(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + `+d+`)));

        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);

        setOutput(newValue);
      }
    `},zI=function(r,t){this.variableNames=["x"];var e=r.length;if(e>4)throw new Error("WebGL backend: Reverse of rank-"+e+" tensor is not yet supported");if(this.outputShape=r,e!==1){var n=r.map(function(i,s){return function(l){return t.indexOf(l)!==-1&&r[l]!==1?r[l]+" - coords["+l+"] - 1":"coords["+l+"]"}(s)}).join(","),a=At(e);this.userCode=`
      void main() {
        `+a+` coords = getOutputCoords();
        setOutput(getX(`+n+`));
      }
    `}else this.userCode=`
        void main() {
          int coord = getOutputCoords();
          setOutput(getX(`+r[0]+` - coord - 1));
        }
      `},UI=function(r,t){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;var e=r.length;if(e>4)throw new Error("WebGL backend: Reverse of rank-"+e+" tensor is not yet supported");this.outputShape=r;var n=$n("rc",e),a=n[e-1]+" + 1 < "+this.outputShape[e-1],i=n[e-2]+" + 1 < "+this.outputShape[e-2],s=At(e);function l(c){var f=r.map(function(d,v){return function(m,g){return t.indexOf(m)!==-1&&r[m]!==1?r[m]+" - "+g[m]+" - 1":""+g[m]}(v,c)});return"getChannel(getX("+f.join(",")+"), vec2("+f.slice(-2).join(",")+"))"}this.userCode=e===1?`
        void main(){
          int rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = getChannel(getX(`+r[0]+` - rc - 1),
            `+r[0]+` - rc - 1);
          if(`+a+`){
              result.g = getChannel(getX(`+r[0]+` - (rc  + 1) - 1),
                `+r[0]+` - (rc  + 1) - 1);
          }
          setOutput(result);
        }
      `:`
        void main() {
          `+s+` rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = `+function(c){return l(c)}(n.slice())+`;
          if(`+a+`){
            result.g = `+function(c){return c[e-1]="("+c[e-1]+" + 1)",l(c)}(n.slice())+`;
          }
          if(`+i+`) {
            result.b = `+function(c){return c[e-2]="("+c[e-2]+" + 1)",l(c)}(n.slice())+`;
            if(`+a+`) {
              result.a = `+function(c){return c[e-1]="("+c[e-1]+" + 1)",c[e-2]="("+c[e-2]+" + 1)",l(c)}(n.slice())+`;
            }
          }
          setOutput(result);
        }
    `},r_=function(r,t,e,n,a,i,s){this.variableNames=["updates","indices","defaultValue"],this.outputShape=i;var l=At(a.length),c=At(i.length),f="";e===1?f="i":e===2&&(f="i, j");var d="getIndices("+f+")",v="";n===1?v="i":n===2&&(v="i, coords[1]");var m="getUpdates("+v+")",g=t>1?"strides[j]":"strides";this.userCode=`
        `+l+" strides = "+l+"("+a+`);

        void main() {
          `+c+` coords = getOutputCoords();
          float sum = 0.0;
          bool found = false;
          for (int i = 0; i < `+r+`; i++) {
            int flattenedIndex = 0;
            for (int j = 0; j < `+t+`; j++) {
              int index = round(`+d+`);
              flattenedIndex += index * `+g+`;
            }
            if (flattenedIndex == coords[0]) {
              sum += `+m+`;
              found = true;
            }
          }
          setOutput(mix(getDefaultValue(), sum, float(found)));
        }
      `},VI=function(r,t){this.variableNames=["x","segmentIds"];var e=r.windowSize,n=r.batchSize,a=r.inSize,i=r.numSegments,s=i*Math.ceil(a/e);this.outputShape=[n,s];var l=4*Math.floor(e/4),c=e%4,f=`
        sumValue += dot(values, segFilter);
    `,d="";a%e>0&&(d=`
        if (inIdx < 0 || inIdx >= `+a+`) {
          return initializationValue;
        }
      `);var v="";a%e>0&&(v=`
        if (inIdx < 0 || inIdx >= `+a+`) {
          return -1.0;
        }
      `),this.userCode=`
      const float initializationValue = 0.0;

      float getValue(int batch, int inIdx) {
        `+d+`
        return getX(batch, inIdx);
      }

      float getSegmentIdAtIndex(int inIdx) {
        `+v+`
        return getSegmentIds(inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = int(floor(float(outIdx) / float(
          `+i+")) * float("+e+`));
        int currentSeg = int(mod(float(outIdx), float(`+i+`)));

        float sumValue = 0.0;

        for (int i = 0; i < `+l+`; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0
          );

          `+f+`
        }

        int inIdx = inOffset + `+l+`;
        if (`+(c===1)+`) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            0,
            0,
            0
          );

          `+f+`
        } else if (`+(c===2)+`) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
              0,
              0
          );

          `+f+`
        } else if (`+(c===3)+`) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            0
          );

          `+f+`
        }
        setOutput(sumValue);
      }
    `},HI=function(r,t,e){var n,a;if(this.variableNames=["c","a","b"],this.outputShape=t,e>4)throw Error("Where for rank "+e+" is not yet supported");if(e===1)a="resRC",n="resRC";else{for(var i=["resRC.x","resRC.y","resRC.z","resRC.w"],s=[],l=[],c=0;c<t.length;c++)l.push(""+i[c]),c<r&&s.push(""+i[c]);n=s.join(),a=l.join()}var f=At(e);this.userCode=`
      void main() {
        `+f+` resRC = getOutputCoords();
        float cVal = getC(`+n+`);
        if (cVal >= 1.0) {
          setOutput(getA(`+a+`));
        } else {
          setOutput(getB(`+a+`));
        }
      }
    `},jI=function(){function r(t){this.variableNames=["source"],this.outputShape=t,this.rank=t.length;var e,n=At(this.rank),a="uniform int start["+this.rank+"];",i=function(s){if(s===1)return"sourceLoc";if(s<=6)return Im.slice(0,s).map(function(l){return"sourceLoc."+l}).join(",");throw Error("Slicing for rank "+s+" is not yet supported")}(this.rank);e=`
        `+n+` sourceLoc;
        `+n+` coords = getOutputCoords();
        `+t.map(function(s,l){return"sourceLoc."+Im[l]+" = start["+l+"] + coords."+Im[l]+";"}).join(`
`)+`
      `,this.userCode=`
      `+a+`
      void main() {
        `+e+`
        setOutput(getSource(`+i+`));
      }
    `}return r.prototype.getCustomSetupFunc=function(t){var e=this;if(t.length!==this.rank)throw Error("The rank ("+this.rank+") of the program must match the length of start ("+t.length+")");return function(n,a){e.startLoc==null&&(e.startLoc=n.getUniformLocationNoThrow(a,"start"),e.startLoc==null)||n.gl.uniform1iv(e.startLoc,t)}},r}(),Im=["x","y","z","w","u","v"],WI=function(){function r(t){this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.rank=t.length;var e=At(this.rank),n=$n("coords",this.rank),a=$n("sourceLoc",this.rank),i=this.rank===1?"sourceLoc":"vec2("+a.slice(-2).join()+")",s="getChannel(getSource("+a.join()+"), "+i+")",l=`
      result.x = `+s+`;
      if (++`+n[this.rank-1]+" < "+t[this.rank-1]+`) {
        ++`+a[this.rank-1]+`;
        result.y = `+s+`;
        --`+a[this.rank-1]+`;
      }
    `,c=this.rank===1?"":`
      --`+n[this.rank-1]+`;
      if (++`+n[this.rank-2]+" < "+t[this.rank-2]+`) {
        ++`+a[this.rank-2]+`;
        result.z = `+s+`;
        if (++`+n[this.rank-1]+" < "+t[this.rank-1]+`) {
          ++`+a[this.rank-1]+`;
          result.w = `+s+`;
        }
      }
    `,f=this.rank<=4?`sourceLoc = coords +
            `+e+"("+t.map(function(d,v){return"start["+v+"]"}).join()+");":t.map(function(d,v){return a[v]+" = "+n[v]+" + start["+v+"];"}).join(`
`);this.userCode=`
      uniform int start[`+this.rank+`];
      void main() {
        `+e+` coords = getOutputCoords();
        `+e+` sourceLoc;
        `+f+`
        vec4 result = vec4(0.);
        `+l+`
        `+c+`
        setOutput(result);
      }
    `}return r.prototype.getCustomSetupFunc=function(t){var e=this;if(t.length!==this.rank)throw Error("The rank ("+this.rank+") of the program must match the length of start ("+t.length+")");return function(n,a){e.startLoc==null&&(e.startLoc=n.getUniformLocationNoThrow(a,"start"),e.startLoc==null)||n.gl.uniform1iv(e.startLoc,t)}},r}(),GI=function(r,t,e){this.variableNames=["x"],this.outputShape=e;var n=e.length,a=At(e.length),i=At(e.length),s="";if(n===1)s="coords * strides + begin";else{var l=0;s=e.map(function(c,f){return l++,e.length===1?"coords * strides["+f+"] + begin["+f+"]":"coords["+(l-1)+"] * strides["+f+"] + begin["+f+"]"}).join(",")}this.userCode=`
      `+a+" begin = "+a+"("+r+`);
      `+a+" strides = "+a+"("+t+`);

      void main() {
        `+i+` coords = getOutputCoords();
        setOutput(getX(`+s+`));
      }
    `},qI=function(){function r(t){this.gpgpu=t,this.numUsedTextures=0,this.numFreeTextures=0,this.freeTextures={},this.logEnabled=!1,this.usedTextures={}}return r.prototype.acquireTexture=function(t,e,n){var a,i=a_(e,n),s=i_(t,i,n);if(s in this.freeTextures||(this.freeTextures[s]=[]),s in this.usedTextures||(this.usedTextures[s]=[]),this.freeTextures[s].length>0){this.numFreeTextures--,this.numUsedTextures++,this.log();var l=this.freeTextures[s].shift();return this.usedTextures[s].push(l),l}return this.numUsedTextures++,this.log(),i===lr.PACKED_2X2_FLOAT32?a=this.gpgpu.createPackedMatrixTexture(t[0],t[1]):i===lr.PACKED_2X2_FLOAT16?a=this.gpgpu.createFloat16PackedMatrixTexture(t[0],t[1]):i===lr.UNPACKED_FLOAT32?a=this.gpgpu.createFloat32MatrixTexture(t[0],t[1]):i===lr.UNPACKED_FLOAT16?a=this.gpgpu.createFloat16MatrixTexture(t[0],t[1]):i===lr.PACKED_4X1_UNSIGNED_BYTE&&(a=this.gpgpu.createUnsignedBytesMatrixTexture(t[0],t[1])),this.usedTextures[s].push(a),a},r.prototype.releaseTexture=function(t,e,n,a){if(this.freeTextures!=null){var i=i_(e,a_(n,a),a);i in this.freeTextures||(this.freeTextures[i]=[]),this.freeTextures[i].push(t),this.numFreeTextures++,this.numUsedTextures--;var s=this.usedTextures[i],l=s.indexOf(t);if(l<0)throw new Error("Cannot release a texture that was never provided by this texture manager");s.splice(l,1),this.log()}},r.prototype.log=function(){if(this.logEnabled){var t=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used",this.numFreeTextures+" / "+this.numUsedTextures,"("+t+")")}},r.prototype.getNumUsedTextures=function(){return this.numUsedTextures},r.prototype.getNumFreeTextures=function(){return this.numFreeTextures},r.prototype.dispose=function(){var t=this;if(this.freeTextures!=null){for(var e in this.freeTextures)this.freeTextures[e].forEach(function(n){t.gpgpu.deleteMatrixTexture(n)});for(var e in this.usedTextures)this.usedTextures[e].forEach(function(a){t.gpgpu.deleteMatrixTexture(a)});this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0}},r}();function a_(r,t){if(r===cr.UPLOAD)return lr.PACKED_2X2_FLOAT32;if(r===cr.RENDER||r==null)return function(e){return le().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?e?lr.PACKED_2X2_FLOAT32:lr.UNPACKED_FLOAT32:e?lr.PACKED_2X2_FLOAT16:lr.UNPACKED_FLOAT16}(t);if(r===cr.DOWNLOAD||r===cr.PIXELS)return lr.PACKED_4X1_UNSIGNED_BYTE;throw new Error("Unknown logical texture type "+r)}function i_(r,t,e){return r[0]+"_"+r[1]+"_"+t+"_"+e}var KI=function(r,t){this.variableNames=["A"];for(var e=new Array(r.length),n=0;n<e.length;n++)e[n]=r[n]*t[n];this.outputShape=e,this.rank=e.length;var a=At(this.rank),i=function(s){var l=s.length;if(l>5)throw Error("Tile for rank "+l+" is not yet supported");if(l===1)return"imod(resRC, "+s[0]+")";for(var c=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],f=[],d=0;d<s.length;d++)f.push("imod("+c[d]+", "+s[d]+")");return f.join()}(r);this.userCode=`
      void main() {
        `+a+` resRC = getOutputCoords();
        setOutput(getA(`+i+`));
      }
    `},XI=function(r,t){this.variableNames=["A"];for(var e=new Array(r.length),n=0;n<e.length;n++)e[n]=r[t[n]];this.outputShape=e,this.rank=e.length;var a=At(this.rank),i=function(s){var l=s.length;if(l>6)throw Error("Transpose for rank "+l+" is not yet supported");for(var c=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],f=new Array(l),d=0;d<s.length;d++)f[s[d]]=c[d];return f.join()}(t);this.userCode=`
    void main() {
      `+a+` resRC = getOutputCoords();
      setOutput(getA(`+i+`));
    }
    `},$I=function(r,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;for(var e=new Array(r.length),n=0;n<e.length;n++)e[n]=r[t[n]];if(this.outputShape=e,this.rank=e.length,this.rank>6)throw Error("Packed transpose for rank "+this.rank+" is not yet supported.");var a=At(this.rank),i=qE("rc",this.rank),s=new Array(this.rank);for(n=0;n<t.length;n++)s[t[n]]=i[n];var l="vec2("+s.slice(-2).join()+")",c="++"+i[this.rank-1]+" < "+e[this.rank-1],f="getChannel(getA("+s.join()+"), "+l+")";this.userCode=`
    void main() {
      `+a+` rc = getOutputCoords();
      vec4 result = vec4(0.);
      result[0] = `+f+`;
      if(`+c+`) {
        result[1] = `+f+`;
      }
      --`+i[this.rank-1]+`;
      if(++`+i[this.rank-2]+" < "+e[this.rank-2]+`) {
        result[2] = `+f+`;
        if(`+c+`) {
          result[3] = `+f+`;
        }
      }
      setOutput(result);
    }
    `},Ry=1.7580993408473768,Ay=1.0507009873554805,Xe=function(r,t){this.variableNames=["A"],this.outputShape=r,this.userCode=`
      float unaryOperation(float x) {
        `+t+`
      }

      void main() {
        float x = getAAtOutCoords();
        float y = unaryOperation(x);

        setOutput(y);
      }
    `},$r="if (isnan(x)) return x;",YI="return x;",o_="return abs(x);",QE=$r+`
  return (x < 0.0) ? 0.0 : x;
`,ZE=$r+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,JE="return (x >= 0.0) ? x : (exp(x) - 1.0);",QI=`
  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.
  // see: https://arxiv.org/abs/1706.02515
  float scaleAlpha = `+Ry+`;
  float scale = `+Ay+`;
  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);
`,s_="return -x;",u_="return ceil(x);",l_="return floor(x);",c_="return exp(x);",f_="return exp(x) - 1.0;",ZI=$r+`
  return sin(x);
`,JI=$r+`
  return cos(x);
`,eF=$r+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return asin(x);
`,tF=$r+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return acos(x);
`,nF=$r+`
  return atan(x);
`,rF=$r+"return log(x + sqrt(x * x + 1.0));",aF=$r+`
  if (x < 1.0) return NAN;
  return log(x + sqrt(x * x - 1.0));`,iF=$r+`
  if ((x < -1.0) || (x > 1.0)) return NAN;
  return (log(1.0 + x) - log(1.0 - x)) / 2.0;`,lh="return x;",oF="return x;",eC=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,tC=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,nC=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,Kl=function(r,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=r,this.userCode=`
      vec4 unaryOperation(vec4 x) {
        `+t+`
      }

      void main() {
        vec4 x = getAAtOutCoords();
        vec4 y = unaryOperation(x);

        setOutput(y);
      }
    `},sF=function(r){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=r;var t=r.length,e=$n("rc",t),n=At(t),a=function(l,c){if(l===1)return"rc";for(var f="",d=0;d<l;d++)f+=c[d],d<l-1&&(f+=",");return f}(t,e),i=e.slice(-2),s=t<=1?"rc":"vec2("+i.join(",")+")";this.userCode=`
      void main() {
        `+n+` rc = getOutputCoords();
        vec4 packedInput = getA(`+a+`);

        setOutput(getChannel(packedInput, `+s+`));
      }
    `},ch={};function fh(r,t){if(t===void 0&&(t=!1),r==="linear")return t?oF:YI;if(r==="relu")return t?eC:QE;if(r==="elu")return t?nC:JE;if(r==="relu6")return t?tC:ZE;if(r==="prelu")return t?YE:$E;throw new Error("Activation "+r+" has not been implemented for the WebGL backend.")}var uF=600,lF=function(r){function t(e){var n,a=r.call(this)||this;if(a.pendingRead=new WeakMap,a.pendingDisposal=new WeakSet,a.dataRefCount=new WeakMap,a.numBytesInGPU=0,a.uploadWaitMs=0,a.downloadWaitMs=0,a.warnedAboutMemory=!1,a.pendingDeletes=0,a.disposed=!1,!le().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");if(e==null){var i=wa(le().getNumber("WEBGL_VERSION"));a.binaryCache=((n=le().getNumber("WEBGL_VERSION"))in ch||(ch[n]={}),ch[n]),a.gpgpu=new xI(i),a.canvas=i.canvas,a.gpgpuCreatedLocally=!0}else a.gpgpu=e,a.binaryCache={},a.gpgpuCreatedLocally=!1,a.canvas=e.gl.canvas;return a.textureManager=new qI(a.gpgpu),a.numMBBeforeWarning=le().global.screen==null?1024:le().global.screen.height*le().global.screen.width*window.devicePixelRatio*uF/1024/1024,a.texData=new LE(a,K),a}return Xr(t,r),t.prototype.numDataIds=function(){return this.texData.numDataIds()+(this.cpuBackend?this.cpuBackend.numDataIds():0)-this.pendingDeletes},t.prototype.write=function(e,n,a){if(le().getBool("DEBUG")&&this.checkNumericalProblems(e),a==="complex64"&&e!=null)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");var i={};return this.texData.set(i,{shape:n,dtype:a,values:e,usage:cr.UPLOAD}),i},t.prototype.move=function(e,n,a,i){if(le().getBool("DEBUG")&&this.checkNumericalProblems(n),i==="complex64")throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(e,{shape:a,dtype:i,values:n,usage:cr.UPLOAD})},t.prototype.readSync=function(e){var n=this.texData.get(e),a=n.values,i=n.dtype,s=n.complexTensors,l=n.slice,c=n.shape,f=n.isPacked;if(l!=null){var d=void 0;d=f?new Kl(c,lh):new Xe(c,lh);var v=this.runWebGLProgram(d,[{dataId:e,shape:c,dtype:i}],i),m=this.readSync(v.dataId);return this.disposeData(v.dataId),m}if(a!=null)return this.convertAndCacheOnCPU(e);if(i==="string")return a;var g,b,w=this.activeTimers!=null;return w&&(g=la()),i==="complex64"?b=Ug(s.real.dataSync(),s.imag.dataSync()):b=this.getValuesFromTexture(e),w&&(this.downloadWaitMs+=la()-g),this.convertAndCacheOnCPU(e,b)},t.prototype.read=function(e){return Ee(this,void 0,void 0,function(){var n,a,i,s,l,c,f,d,v,m,g,b,w,_,S,E,C,R,A,D,k,I;return Ce(this,function(O){switch(O.label){case 0:if(this.pendingRead.has(e))return n=this.pendingRead.get(e),[2,new Promise(function(M){return n.push(M)})];if(a=this.texData.get(e),i=a.values,s=a.shape,l=a.slice,c=a.dtype,f=a.complexTensors,d=a.isPacked,l!=null)return v=void 0,v=d?new Kl(s,lh):new Xe(s,lh),m=this.runWebGLProgram(v,[{dataId:e,shape:s,dtype:c}],c),g=this.read(m.dataId),this.disposeData(m.dataId),[2,g];if(i!=null)return[2,this.convertAndCacheOnCPU(e)];if(!le().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&le().getNumber("WEBGL_VERSION")===2)throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");return b=null,c!=="complex64"&&le().get("WEBGL_BUFFER_SUPPORTED")&&(w=this.decode(e),_=this.texData.get(w.dataId),b=(I=this.gpgpu).createBufferFromTexture.apply(I,[_.texture].concat(ec(s)))),this.pendingRead.set(e,[]),c==="complex64"?[3,2]:[4,this.gpgpu.createAndWaitForFence()];case 1:O.sent(),O.label=2;case 2:return c!=="complex64"?[3,4]:[4,Promise.all([f.real.data(),f.imag.data()])];case 3:return E=O.sent(),C=E[0],R=E[1],S=Ug(C,R),[3,5];case 4:b==null?S=this.getValuesFromTexture(e):(A=Ae(s),S=this.gpgpu.downloadFloat32MatrixFromBuffer(b,A)),O.label=5;case 5:return w!=null&&this.disposeData(w.dataId),D=this.convertAndCacheOnCPU(e,S),k=this.pendingRead.get(e),this.pendingRead.delete(e),k.forEach(function(M){return M(D)}),this.pendingDisposal.has(e)&&(this.pendingDisposal.delete(e),this.disposeData(e),this.pendingDeletes--),[2,D]}})})},t.prototype.checkNumericalProblems=function(e){if(e!=null)for(var n=0;n<e.length;n++){var a=e[n];if(!Q3(a))throw le().getBool("WEBGL_RENDER_FLOAT32_CAPABLE")?Error("The value "+a+" cannot be represented with your current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'"):Error("The value "+a+" cannot be represented on this device.")}},t.prototype.getValuesFromTexture=function(e){var n,a=this.texData.get(e),i=a.shape,s=a.dtype,l=a.isPacked,c=Ae(i);if(le().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){var f=this.decode(e),d=this.texData.get(f.dataId),v=(n=this.gpgpu).downloadMatrixFromPackedTexture.apply(n,[d.texture].concat(ec(i))).subarray(0,c);return this.disposeData(f.dataId),v}var m=le().getBool("WEBGL_PACK")&&l===!0,g=m?Am(i):i,b=m?new YM(g):new $M(g),w=this.runWebGLProgram(b,[{shape:g,dtype:s,dataId:e}],"float32"),_=this.texData.get(w.dataId),S=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(_.texture,_.texShape[0],_.texShape[1]).subarray(0,c);return this.disposeData(w.dataId),S},t.prototype.time=function(e){return Ee(this,void 0,void 0,function(){var n,a,i,s,l,c,f;return Ce(this,function(d){switch(d.label){case 0:return n=this.activeTimers,a=[],i=!1,this.programTimersStack==null?(this.programTimersStack=a,i=!0):this.activeTimers.push(a),this.activeTimers=a,e(),s=Mu(this.activeTimers.map(function(v){return v.query})).filter(function(v){return v!=null}),l=Mu(this.activeTimers.map(function(v){return v.name})).filter(function(v){return v!=null}),this.activeTimers=n,i&&(this.programTimersStack=null),c={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null},le().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?[4,Promise.all(s)]:[3,2];case 1:return f=d.sent(),c.kernelMs=O3(f),c.getExtraProfileInfo=function(){return f.map(function(v,m){return{name:l[m],ms:v}}).map(function(v){return v.name+": "+v.ms}).join(", ")},[3,3];case 2:c.kernelMs={error:"WebGL query timers are not supported in this environment."},d.label=3;case 3:return this.uploadWaitMs=0,this.downloadWaitMs=0,[2,c]}})})},t.prototype.memory=function(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU}},t.prototype.startTimer=function(){return le().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:la(),endMs:null}},t.prototype.endTimer=function(e){return le().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),e):(e.endMs=la(),e)},t.prototype.getQueryTime=function(e){return Ee(this,void 0,void 0,function(){var n;return Ce(this,function(a){return le().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?[2,this.gpgpu.waitForQueryAndGetTime(e)]:[2,(n=e).endMs-n.startMs]})})},t.prototype.disposeData=function(e){if(!this.pendingDisposal.has(e)){if(this.pendingRead.has(e))return this.pendingDisposal.add(e),void this.pendingDeletes++;if(this.texData.has(e)){this.releaseGPUData(e);var n=this.texData.get(e).complexTensors;n!=null&&(n.real.dispose(),n.imag.dispose()),this.texData.delete(e)}}},t.prototype.releaseGPUData=function(e){var n=this.texData.get(e),a=n.texture,i=n.dtype,s=n.texShape,l=n.usage,c=n.isPacked,f=n.slice,d=f&&f.origDataId||e,v=this.dataRefCount.get(d);v>1?this.dataRefCount.set(d,v-1):(this.dataRefCount.delete(d),a!=null&&(this.numBytesInGPU-=this.computeBytes(s,i),this.textureManager.releaseTexture(a,s,l,c)));var m=this.texData.get(e);m.texture=null,m.texShape=null,m.isPacked=!1,m.slice=null},t.prototype.getTexture=function(e){return this.uploadToGPU(e),this.texData.get(e).texture},t.prototype.getDataInfo=function(e){return this.texData.get(e)},t.prototype.getCPUBackend=function(){return le().getBool("WEBGL_CPU_FORWARD")?(this.cpuBackend==null&&(this.cpuBackend=K.findBackend("cpu")),this.cpuBackend):null},t.prototype.shouldExecuteOnCPU=function(e,n){var a=this;return n===void 0&&(n=128),this.getCPUBackend()!=null&&e.every(function(i){return a.texData.get(i.dataId).texture==null&&i.size<n})},t.prototype.getGPGPUContext=function(){return this.gpgpu},t.prototype.complex=function(e,n){var a=this.makeOutput(e.shape,"complex64");return this.texData.get(a.dataId).complexTensors={real:K.keep(e.clone()),imag:K.keep(n.clone())},a},t.prototype.real=function(e){return this.texData.get(e.dataId).complexTensors.real.clone()},t.prototype.imag=function(e){return this.texData.get(e.dataId).complexTensors.imag.clone()},t.prototype.slice=function(e,n,a){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.slice(e,n,a);if(Ae(a)===0)return Sn([],a,e.dtype);var i=this.texData.get(e.dataId).isPacked,s=FE(e.shape,n,a);if(i||!s){var l=le().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new WI(a):new jI(a),c=l.getCustomSetupFunc(n);return this.compileAndRun(l,[e],null,c)}return this.uploadToGPU(e.dataId),this.shallowSlice(e,n,a)},t.prototype.shallowSlice=function(e,n,a){var i=this.texData.get(e.dataId),s=this.makeOutput(a,e.dtype),l=this.texData.get(s.dataId);Object.assign(l,i),l.shape=a,l.dtype=e.dtype;var c=BE(n,e.strides);i.slice&&(c+=i.slice.flatOffset),l.slice={flatOffset:c,origDataId:i.slice&&i.slice.origDataId||e.dataId};var f=this.dataRefCount.get(l.slice.origDataId)||1;return this.dataRefCount.set(l.slice.origDataId,f+1),s},t.prototype.stridedSlice=function(e,n,a,i){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.stridedSlice(e,n,a,i);var s=xy(n,a,i);if(s.some(function(c){return c===0}))return Sn([],s);var l=new GI(n,i,s);return this.compileAndRun(l,[e])},t.prototype.reverse=function(e,n){var a=le().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new UI(e.shape,n):new zI(e.shape,n);return this.compileAndRun(a,[e])},t.prototype.concat=function(e,n){if(e[0].dtype==="complex64"){var a=e.map(function(g){return Dr(g)}),i=e.map(function(g){return fa(g)});return wn(this.concat(a,n),this.concat(i,n))}if(this.shouldExecuteOnCPU(e))return this.cpuBackend.concat(e,n);if(e.length===1)return e[0];if(e.length>le().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER")){var s=Math.floor(e.length/2),l=this.concat(e.slice(0,s),n),c=this.concat(e.slice(s),n);return this.concat([l,c],n)}if(le().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&e[0].rank>1){var f=new FM(e.map(function(g){return g.shape}),n);return this.compileAndRun(f,e)}var d=Fu(e.map(function(g){return g.shape}),n),v=e.map(function(g){return g.as2D(-1,Ae(g.shape.slice(n)))}),m=new IM(v.map(function(g){return g.shape}));return this.compileAndRun(m,v).reshape(d)},t.prototype.neg=function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.neg(e);if(le().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,s_,e.dtype);var n=new Xe(e.shape,s_);return this.compileAndRun(n,[e])},t.prototype.batchMatMul=function(e,n,a,i){var s=a?e.shape[2]:e.shape[1],l=i?n.shape[1]:n.shape[2],c=a?e.shape[1]:e.shape[2],f=e.shape[0];if((s===1||l===1)&&c>1e3){a&&(e=e.transpose([0,2,1])),i&&(n=n.transpose([0,2,1]));var d=l===1?e:e.as3D(f,c,1),v=l===1?2:1,m=l===1?n.as3D(f,1,c):n;return this.multiply(d,m).sum(v,!0)}var g=_n(e.dtype,n.dtype),b=new Om(e.shape,[f,s,l],a,i);return this.compileAndRun(b,[e,n],g)},t.prototype.fusedBatchMatMul=function(e){var n=e.a,a=e.b,i=e.transposeA,s=e.transposeB,l=e.bias,c=e.activation,f=e.preluActivationWeights,d=i?n.shape[2]:n.shape[1],v=s?a.shape[1]:a.shape[2],m=n.shape[0],g=_n(n.dtype,a.dtype),b=l!=null,w=f!=null,_=c?fh(c,!0):null,S=new Om(n.shape,[m,d,v],i,s,b,_,w),E=[n,a];return l&&E.push(l),f&&E.push(f),this.compileAndRun(S,E,g)},t.prototype.multiply=function(e,n){if(e.dtype==="complex64"){var a=this.texData.get(e.dataId),i=this.texData.get(n.dataId),s=new $2(DM,e.shape,n.shape),l=new $2(kM,e.shape,n.shape),c=[this.makeComplexComponentTensorInfo(e,a.complexTensors.real),this.makeComplexComponentTensorInfo(e,a.complexTensors.imag),this.makeComplexComponentTensorInfo(n,i.complexTensors.real),this.makeComplexComponentTensorInfo(n,i.complexTensors.imag)],f=this.compileAndRun(s,c),d=this.compileAndRun(l,c),v=this.complex(f,d);return f.dispose(),d.dispose(),v}if(this.shouldExecuteOnCPU([e,n]))return this.cpuBackend.multiply(e,n);if(le().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,n,Y2,e.dtype);var m=new Pt(Y2,e.shape,n.shape);return this.compileAndRun(m,[e,n],e.dtype)},t.prototype.batchNormalization=function(e,n,a,i,s,l){var c=[e,n,a],f=null;l!=null&&(f=l.shape,c.push(l));var d=null;if(s!=null&&(d=s.shape,c.push(s)),le().getBool("WEBGL_PACK_NORMALIZATION")){var v=new TM(e.shape,n.shape,a.shape,f,d,i);return this.compileAndRun(v,c)}var m=new AM(e.shape,n.shape,a.shape,f,d,i);return this.compileAndRun(m,c)},t.prototype.localResponseNormalization4D=function(e,n,a,i,s){var l=le().getBool("WEBGL_PACK_NORMALIZATION")?new EI(e.shape,n,a,i,s):new _I(e.shape,n,a,i,s);return this.compileAndRun(l,[e])},t.prototype.LRNGrad=function(e,n,a,i,s,l,c){var f=new SI(n.shape,i,s,l,c);return this.compileAndRun(f,[n,a,e])},t.prototype.tile=function(e,n){if(e.dtype==="string"){var a=this.readSync(e.dataId).map(function(s){return qh(s)});return WE(je(e.shape,e.dtype,a),n)}var i=new KI(e.shape,n);return this.compileAndRun(i,[e])},t.prototype.pad=function(e,n,a){var i=le().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new OI(e.shape,n,a):new kI(e.shape,n,a);return this.compileAndRun(i,[e])},t.prototype.transpose=function(e,n){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.transpose(e,n);var a=le().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new $I(e.shape,n):new XI(e.shape,n);return this.compileAndRun(a,[e])},t.prototype.gather=function(e,n,a){if(this.shouldExecuteOnCPU([e,n]))return this.cpuBackend.gather(e,n,a);var i=new nI(e.shape,n.size,a);return this.compileAndRun(i,[e,n])},t.prototype.batchToSpaceND=function(e,n,a){L(e.rank<=4,function(){return"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet"});var i=n.reduce(function(v,m){return v*m}),s=Zh(e.shape,n,i),l=Jh(s.length,n.length),c=ed(e.shape,n,i),f=OE(a,n.length),d=NE(c,a,n.length);return e.reshape(s).transpose(l).reshape(c).slice(f,d)},t.prototype.spaceToBatchND=function(e,n,a){L(e.rank<=4,function(){return"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet"});var i=n.reduce(function(m,g){return m*g}),s=[[0,0]];s.push.apply(s,a);for(var l=1+n.length;l<e.shape.length;++l)s.push([0,0]);var c=e.pad(s),f=Zh(c.shape,n,i,!1),d=Jh(f.length,n.length,!1),v=ed(c.shape,n,i,!1);return c.reshape(f).transpose(d).reshape(v)},t.prototype.reduce=function(e,n,a){var i=e.shape[0],s=e.shape[1],l=Tm(s),c=new NI({windowSize:l,inSize:s,batchSize:i},n),f=this.compileAndRun(c,[e],a);return f.shape[1]===1?f:this.reduce(f,n,a)},t.prototype.argReduce=function(e,n,a){a===void 0&&(a=null);var i=e.shape[0],s=e.shape[1];a!=null&&(i=a.shape[0],s=a.shape[1]);var l=Tm(s),c=new yM({windowSize:l,inSize:s,batchSize:i},n,a==null),f=[e];a!=null&&f.push(a);var d=this.compileAndRun(c,f,"int32");return d.shape[1]===1?d:this.argReduce(e,n,d)},t.prototype.argReducePacked=function(e,n,a){a===void 0&&(a=null);var i=a!=null?a.shape:e.shape,s=Tm(i[i.length-1]),l=new EM(i,s,n,a==null),c=a==null?[e]:[e,a],f=this.compileAndRun(l,c,"int32");return f.rank===e.rank?this.argReducePacked(e,n,f):f},t.prototype.sum=function(e,n){ur("sum",n,e.rank);var a=Dn(e.shape,n),i=a[0],s=Ae(a[1]),l=e.as2D(-1,s),c=xm(e.dtype);return this.reduce(l,"sum",c).reshape(i)},t.prototype.prod=function(e,n){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.prod(e,n);var a=Dn(e.shape,n),i=a[0],s=Ae(a[1]),l=e.as2D(-1,s),c=xm(e.dtype);return this.reduce(l,"prod",c).reshape(i)},t.prototype.unsortedSegmentSum=function(e,n,a){var i=0,s=_a([i],e.rank),l=e;s!=null&&(l=e.transpose(s),i=Sa(1,e.rank)[0]);var c=function(g,b,w){for(var _=[],S=g.length,E=0;E<S;E++)E!==b?_.push(g[E]):_.push(w);return _}(l.shape,i,a),f=Ae([l.shape[i]]),d=l.as2D(-1,f),v=xm(e.dtype),m=this.segOpCompute(d,"unsortedSegmentSum",n,v,a).reshape(c);return s!=null&&(m=m.transpose(my(s))),m},t.prototype.segOpCompute=function(e,n,a,i,s){var l=e.shape[0],c=e.shape[1],f=function(m,g){var b,w=!1;for(m<=IE?(b=m,w=!0):b=Og(m,Math.floor(Math.sqrt(m)));!w;)b>g||b===m?w=!0:b=Og(m,b+1);return b}(c,s),d=new VI({windowSize:f,inSize:c,batchSize:l,numSegments:s}),v=this.compileAndRun(d,[e,a],i);return v.shape[1]===s?v:(a=Qh(0,s).tile([c/f]),this.segOpCompute(v,n,a,i,s))},t.prototype.argMinMaxReduce=function(e,n,a){var i=[n];if(ur("arg"+a.charAt(0).toUpperCase()+a.slice(1),i,e.rank),!le().getBool("WEBGL_PACK_REDUCE")||e.rank<=2){var s=Dn(e.shape,i),l=s[0],c=Ae(s[1]),f=e.as2D(-1,c);return this.argReduce(f,a).reshape(l)}return this.argReducePacked(e,a)},t.prototype.argMin=function(e,n){return this.argMinMaxReduce(e,n,"min")},t.prototype.argMax=function(e,n){return this.argMinMaxReduce(e,n,"max")},t.prototype.cumsum=function(e,n,a,i){if(n!==e.rank-1)throw new Error("WebGL cumsum shader expects an inner-most axis="+(e.rank-1)+" but got axis="+n);var s=new WM(e.shape,a,i);return this.compileAndRun(s,[e])},t.prototype.equal=function(e,n){if(le().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,n,`
  return vec4(equal(a, b));
`,"bool");var a=new Pt("return float(a == b);",e.shape,n.shape);return this.compileAndRun(a,[e,n],"bool")},t.prototype.notEqual=function(e,n){if(le().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,n,`
  return vec4(notEqual(a, b));
`,"bool");var a=new Pt("return float(a != b);",e.shape,n.shape);return this.compileAndRun(a,[e,n],"bool")},t.prototype.less=function(e,n){if(this.shouldExecuteOnCPU([e,n]))return this.cpuBackend.less(e,n);if(le().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,n,`
  return vec4(lessThan(a, b));
`,"bool");var a=new Pt("return float(a < b);",e.shape,n.shape);return this.compileAndRun(a,[e,n],"bool")},t.prototype.lessEqual=function(e,n){if(le().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,n,`
  return vec4(lessThanEqual(a, b));
`,"bool");var a=new Pt("return float(a <= b);",e.shape,n.shape);return this.compileAndRun(a,[e,n],"bool")},t.prototype.greater=function(e,n){if(this.shouldExecuteOnCPU([e,n]))return this.cpuBackend.greater(e,n);if(le().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,n,`
  return vec4(greaterThan(a, b));
`,"bool");var a=new Pt("return float(a > b);",e.shape,n.shape);return this.compileAndRun(a,[e,n],"bool")},t.prototype.greaterEqual=function(e,n){if(le().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,n,`
  return vec4(greaterThanEqual(a, b));
`,"bool");var a=new Pt("return float(a >= b);",e.shape,n.shape);return this.compileAndRun(a,[e,n],"bool")},t.prototype.logicalNot=function(e){var n=new Xe(e.shape,"return float(!(x >= 1.0));");return this.compileAndRun(n,[e])},t.prototype.logicalAnd=function(e,n){if(le().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,n,`
  return vec4(
    vec4(greaterThanEqual(a, vec4(1.0))) *
    vec4(greaterThanEqual(b, vec4(1.0))));
`,"bool");var a=new Pt("return float(a >= 1.0 && b >= 1.0);",e.shape,n.shape);return this.compileAndRun(a,[e,n],"bool")},t.prototype.logicalOr=function(e,n){if(le().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,n,`
  return min(
    vec4(greaterThanEqual(a, vec4(1.0))) +
    vec4(greaterThanEqual(b, vec4(1.0))),
    vec4(1.0));
`,"bool");var a=new Pt("return float(a >= 1.0 || b >= 1.0);",e.shape,n.shape);return this.compileAndRun(a,[e,n],"bool")},t.prototype.select=function(e,n,a){var i=new HI(e.rank,n.shape,n.rank);return this.compileAndRun(i,[e,n,a],_n(n.dtype,a.dtype))},t.prototype.where=function(e){$h("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");var n=e.dataSync();return Ey(e.shape,n)},t.prototype.topk=function(e,n,a){return GE(e.dataSync(),e.shape,e.dtype,n)},t.prototype.min=function(e,n){ur("min",n,e.rank);var a=Dn(e.shape,n),i=a[0],s=Ae(a[1]),l=e.as2D(-1,s);return this.reduce(l,"min",l.dtype).reshape(i)},t.prototype.minimum=function(e,n){if(this.shouldExecuteOnCPU([e,n]))return this.cpuBackend.minimum(e,n);var a=le().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new ja(`
  vec4 result = vec4(min(a, b));
  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,e.shape,n.shape):new Pt(`
  if (isnan(a)) return a;
  if (isnan(b)) return b;

  return min(a, b);
`,e.shape,n.shape);return this.compileAndRun(a,[e,n])},t.prototype.mod=function(e,n){var a=le().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new ja(`
  vec4 result = mod(a, b);
  vec4 isNaN = vec4(equal(b, vec4(0.0)));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,e.shape,n.shape):new Pt(`if (b == 0.0) return NAN;
  return mod(a, b);`,e.shape,n.shape);return this.compileAndRun(a,[e,n])},t.prototype.max=function(e,n){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.max(e,n);ur("max",n,e.rank);var a=Dn(e.shape,n),i=a[0],s=Ae(a[1]),l=e.as2D(-1,s);return this.reduce(l,"max",l.dtype).reshape(i)},t.prototype.maximum=function(e,n){if(this.shouldExecuteOnCPU([e,n]))return this.cpuBackend.maximum(e,n);var a=le().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new ja(`
  vec4 result = vec4(max(a, b));
  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,e.shape,n.shape):new Pt(`
  if (isnan(a)) return a;
  if (isnan(b)) return b;

  return max(a, b);
`,e.shape,n.shape);return this.compileAndRun(a,[e,n])},t.prototype.all=function(e,n){ur("all",n,e.rank);var a=Dn(e.shape,n),i=a[0],s=Ae(a[1]),l=e.as2D(-1,s);return this.reduce(l,"all",l.dtype).reshape(i)},t.prototype.any=function(e,n){ur("any",n,e.rank);var a=Dn(e.shape,n),i=a[0],s=Ae(a[1]),l=e.as2D(-1,s);return this.reduce(l,"any",l.dtype).reshape(i)},t.prototype.realDivide=function(e,n){if(le().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,n,`
  // vec4 one = vec4(equal(a, b));
  // return one + (vec4(1.0) - one) * a / b;
  vec4 result = a / b;
  if(a.x == b.x) {
    result.x = 1.;
  }
  if(a.y == b.y) {
    result.y = 1.;
  }
  if(a.z == b.z) {
    result.z = 1.;
  }
  if(a.w == b.w) {
    result.w = 1.;
  }

  return result;
`,"float32",!0);var a=new Pt(`
if (a == b) {
  return 1.0;
};
return a / b;`,e.shape,n.shape);return this.compileAndRun(a,[e,n],"float32")},t.prototype.floorDiv=function(e,n){if(le().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,n,`
  ivec4 ia = round(a);
  ivec4 ib = round(b);
  bvec4 cond = notEqual(ib, ivec4(0));
  ivec4 result = ivec4(0);
  vec4 s = sign(a) * sign(b);

  // Windows (D3D) wants guaranteed non-zero int division at compile-time.
  if (cond[0]) {
    result[0] = idiv(ia[0], ib[0], s[0]);
  }
  if (cond[1]) {
    result[1] = idiv(ia[1], ib[1], s[1]);
  }
  if (cond[2]) {
    result[2] = idiv(ia[2], ib[2], s[2]);
  }
  if (cond[3]) {
    result[3] = idiv(ia[3], ib[3], s[3]);
  }
  return vec4(result);
`,"int32");var a=new Pt(`
  float s = sign(a) * sign(b);
  int ia = round(a);
  int ib = round(b);
  if (ib != 0) {
    // Windows (D3D) wants guaranteed non-zero int division at compile-time.
    return float(idiv(ia, ib, s));
  } else {
    return NAN;
  }
`,e.shape,n.shape);return this.compileAndRun(a,[e,n],"int32")},t.prototype.add=function(e,n){if(e.dtype==="complex64"&&n.dtype==="complex64")return this.complexSeparableBinaryOp(e,n,Dm);if(this.shouldExecuteOnCPU([e,n]))return this.cpuBackend.add(e,n);var a=_n(e.dtype,n.dtype);if(le().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,n,Dm,a);var i=new Pt(Dm,e.shape,n.shape);return this.compileAndRun(i,[e,n],a)},t.prototype.packedUnaryOp=function(e,n,a){var i=new Kl(e.shape,n);return this.compileAndRun(i,[e],a)},t.prototype.packedBinaryOp=function(e,n,a,i,s){s===void 0&&(s=!1);var l=new ja(a,e.shape,n.shape,s);return this.compileAndRun(l,[e,n],i)},t.prototype.complexSeparableBinaryOp=function(e,n,a){var i=this,s=this.texData.get(e.dataId),l=this.texData.get(n.dataId),c=[[s.complexTensors.real,l.complexTensors.real],[s.complexTensors.imag,l.complexTensors.imag]].map(function(m){var g=m[0],b=m[1],w=i.makeComplexComponentTensorInfo(e,g),_=i.makeComplexComponentTensorInfo(n,b),S=new Pt(a,e.shape,n.shape);return i.compileAndRun(S,[w,_],_n(g.dtype,b.dtype))}),f=c[0],d=c[1],v=this.complex(f,d);return f.dispose(),d.dispose(),v},t.prototype.makeComplexComponentTensorInfo=function(e,n){return{dataId:n.dataId,dtype:n.dtype,shape:e.shape}},t.prototype.addN=function(e){if(e.length===1)return e[0];if(e.length>le().get("WEBGL_MAX_TEXTURES_IN_SHADER")){var n=Math.floor(e.length/2),a=this.addN(e.slice(0,n)),i=this.addN(e.slice(n));return this.addN([a,i])}var s=e.map(function(f){return f.dtype}).reduce(function(f,d){return _n(f,d)}),l=e.map(function(f){return f.shape}),c=le().getBool("WEBGL_PACK")?new gM(e[0].shape,l):new mM(e[0].shape,l);return this.compileAndRun(c,e,s)},t.prototype.subtract=function(e,n){if(e.dtype==="complex64"&&n.dtype==="complex64")return this.complexSeparableBinaryOp(e,n,km);if(this.shouldExecuteOnCPU([e,n]))return this.cpuBackend.subtract(e,n);var a=_n(e.dtype,n.dtype);if(le().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,n,km,e.dtype);var i=new Pt(km,e.shape,n.shape);return this.compileAndRun(i,[e,n],a)},t.prototype.pow=function(e,n){var a=le().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new ja(`
  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.
  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));
  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);
  vec4 result = multiplier * pow(abs(a), b);

  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS
  bvec4 isExpZero = equal(b, vec4(0.0));
  result.r = isExpZero.r ? 1.0 : result.r;
  result.g = isExpZero.g ? 1.0 : result.g;
  result.b = isExpZero.b ? 1.0 : result.b;
  result.a = isExpZero.a ? 1.0 : result.a;

  vec4 isNaN = vec4(lessThan(a, vec4(0.0))) * vec4(lessThan(floor(b), b));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,e.shape,n.shape):new Pt(`
if(a < 0.0 && floor(b) < b){
  return NAN;
}
if (b == 0.0) {
  return 1.0;
}
return (round(mod(b, 2.0)) != 1) ?
    pow(abs(a), b) : sign(a) * pow(abs(a), b);
`,e.shape,n.shape),i=_n(e.dtype,n.dtype);return this.compileAndRun(a,[e,n],i)},t.prototype.ceil=function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.ceil(e);if(le().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,u_,e.dtype);var n=new Xe(e.shape,u_);return this.compileAndRun(n,[e])},t.prototype.floor=function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.floor(e);if(le().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,l_,e.dtype);var n=new Xe(e.shape,l_);return this.compileAndRun(n,[e])},t.prototype.sign=function(e){var n=new Xe(e.shape,`
  if (isnan(x)) { return 0.0; }
  return sign(x);
`);return this.compileAndRun(n,[e])},t.prototype.isNaN=function(e){var n=new Xe(e.shape,"return float(isnan(x));");return this.compileAndRun(n,[e],"bool")},t.prototype.isInf=function(e){var n=new Xe(e.shape,"return float(isinf(x));");return this.compileAndRun(n,[e],"bool")},t.prototype.isFinite=function(e){var n=new Xe(e.shape,"return float(!isnan(x) && !isinf(x));");return this.compileAndRun(n,[e],"bool")},t.prototype.round=function(e){var n=new Xe(e.shape,`
  // OpenGL ES does not support round function.
  // The algorithm is based on banker's rounding.
  float base = floor(x);
  if ((x - base) < 0.5) {
    return floor(x);
  } else if ((x - base) > 0.5) {
    return ceil(x);
  } else {
    if (mod(base, 2.0) == 0.0) {
      return base;
    } else {
      return base + 1.0;
    }
  }
`);return this.compileAndRun(n,[e])},t.prototype.exp=function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.exp(e);if(le().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,c_,e.dtype);var n=new Xe(e.shape,c_);return this.compileAndRun(n,[e])},t.prototype.expm1=function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.expm1(e);if(le().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,f_,e.dtype);var n=new Xe(e.shape,f_);return this.compileAndRun(n,[e])},t.prototype.softmax=function(e,n){var a=sn([n],e.shape),i=this.max(e,a),s=Zn(i.shape,a),l=this.subtract(e,i.reshape(s)),c=this.exp(l),f=this.sum(c,a).reshape(s);return this.realDivide(c,f)},t.prototype.log=function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.log(e);if(le().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,`
  vec4 result = log(x);
  vec4 isNaN = vec4(lessThan(x, vec4(0.0)));
  result.r = isNaN.r == 1.0 ? NAN : result.r;
  result.g = isNaN.g == 1.0 ? NAN : result.g;
  result.b = isNaN.b == 1.0 ? NAN : result.b;
  result.a = isNaN.a == 1.0 ? NAN : result.a;

  return result;
`,e.dtype);var n=new Xe(e.shape,`if (x < 0.0) return NAN;
  return log(x);`);return this.compileAndRun(n,[e])},t.prototype.log1p=function(e){var n=new Xe(e.shape,"return log(1.0 + x);");return this.compileAndRun(n,[e])},t.prototype.sqrt=function(e){var n=new Xe(e.shape,"return sqrt(x);");return this.compileAndRun(n,[e])},t.prototype.rsqrt=function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.rsqrt(e);var n=new Xe(e.shape,"return inversesqrt(x);");return this.compileAndRun(n,[e])},t.prototype.reciprocal=function(e){var n=new Xe(e.shape,"return 1.0 / x;");return this.compileAndRun(n,[e])},t.prototype.relu=function(e){var n;return n=le().getBool("WEBGL_PACK")?new Kl(e.shape,eC):new Xe(e.shape,QE),this.compileAndRun(n,[e])},t.prototype.relu6=function(e){var n;return n=le().getBool("WEBGL_PACK")?new Kl(e.shape,tC):new Xe(e.shape,ZE),this.compileAndRun(n,[e])},t.prototype.prelu=function(e,n){var a=le().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new ja(YE,e.shape,n.shape):new Pt($E,e.shape,n.shape);return this.compileAndRun(a,[e,n])},t.prototype.elu=function(e){if(le().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,nC,e.dtype);var n=new Xe(e.shape,JE);return this.compileAndRun(n,[e])},t.prototype.eluDer=function(e,n){var a=le().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new ja(`
  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));
  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));
`,e.shape,n.shape):new Pt("return (b >= 1.0) ? a : a * (b + 1.0);",e.shape,n.shape);return this.compileAndRun(a,[e,n])},t.prototype.selu=function(e){var n=new Xe(e.shape,QI);return this.compileAndRun(n,[e])},t.prototype.int=function(e){var n=new Xe(e.shape,"return float(int(x));");return this.compileAndRun(n,[e],"int32")},t.prototype.clip=function(e,n,a){var i,s=(i=le().getBool("WEBGL_PACK_CLIP")?new NM(e.shape):new OM(e.shape)).getCustomSetupFunc(n,a);return this.compileAndRun(i,[e],null,s)},t.prototype.abs=function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.abs(e);if(le().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,o_,e.dtype);var n=new Xe(e.shape,o_);return this.compileAndRun(n,[e])},t.prototype.complexAbs=function(e){var n=this.texData.get(e.dataId),a=new MM(e.shape),i=[this.makeComplexComponentTensorInfo(e,n.complexTensors.real),this.makeComplexComponentTensorInfo(e,n.complexTensors.imag)];return this.compileAndRun(a,i)},t.prototype.sigmoid=function(e){var n=new Xe(e.shape,"return 1.0 / (1.0 + exp(-1.0 * x));");return this.compileAndRun(n,[e])},t.prototype.softplus=function(e){var n=new Xe(e.shape,`
  float epsilon = 1.1920928955078125e-7;
  float threshold = log(epsilon) + 2.0;

  bool too_large = x > -threshold;
  bool too_small = x < threshold;

  float result;
  float exp_x = exp(x);

  if (too_large){
    result = x;
  }
  else if (too_small){
    result = exp_x;
  }
  else{
    result = log(exp_x + 1.0);
  }
  return result;
`);return this.compileAndRun(n,[e])},t.prototype.sin=function(e){var n=new Xe(e.shape,ZI);return this.compileAndRun(n,[e])},t.prototype.cos=function(e){var n=new Xe(e.shape,JI);return this.compileAndRun(n,[e])},t.prototype.tan=function(e){var n=new Xe(e.shape,"return tan(x);");return this.compileAndRun(n,[e])},t.prototype.asin=function(e){var n=new Xe(e.shape,eF);return this.compileAndRun(n,[e])},t.prototype.acos=function(e){var n=new Xe(e.shape,tF);return this.compileAndRun(n,[e])},t.prototype.atan=function(e){var n=new Xe(e.shape,nF);return this.compileAndRun(n,[e])},t.prototype.atan2=function(e,n){var a=le().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new ja(`
  vec4 result = atan(a, b);
  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,e.shape,n.shape):new Pt(`
  if (isnan(a)) return a;
  if (isnan(b)) return b;

  return atan(a, b);
`,e.shape,n.shape);return this.compileAndRun(a,[e,n])},t.prototype.sinh=function(e){var n=new Xe(e.shape,`
  float e2x = exp(x);
  return (e2x - 1.0 / e2x) / 2.0;
`);return this.compileAndRun(n,[e])},t.prototype.cosh=function(e){var n=new Xe(e.shape,`
  float e2x = exp(-x);
  return (e2x + 1.0 / e2x) / 2.0;
`);return this.compileAndRun(n,[e])},t.prototype.tanh=function(e){var n=new Xe(e.shape,`
  float e2x = exp(-2.0 * abs(x));
  return sign(x) * (1.0 - e2x) / (1.0 + e2x);
`);return this.compileAndRun(n,[e])},t.prototype.asinh=function(e){var n=new Xe(e.shape,rF);return this.compileAndRun(n,[e])},t.prototype.acosh=function(e){var n=new Xe(e.shape,aF);return this.compileAndRun(n,[e])},t.prototype.atanh=function(e){var n=new Xe(e.shape,iF);return this.compileAndRun(n,[e])},t.prototype.erf=function(e){var n=new Xe(e.shape,`
  // Error function is calculated approximately with elementary function.
  // See "Handbook of Mathematical Functions with Formulas,
  // Graphs, and Mathematical Tables", Abramowitz and Stegun.
  float p = 0.3275911;
  float a1 = 0.254829592;
  float a2 = -0.284496736;
  float a3 = 1.421413741;
  float a4 = -1.453152027;
  float a5 = 1.061405429;

  float sign = sign(x);
  x = abs(x);
  float t = 1.0 / (1.0 + p * x);
  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));
`);return this.compileAndRun(n,[e])},t.prototype.step=function(e,n){var a=new Xe(e.shape,function(i){return i===void 0&&(i=0),$r+`
    return x > 0.0 ? 1.0 : float(`+i+`);
  `}(n));return this.compileAndRun(a,[e])},t.prototype.conv2dByMatMul=function(e,n,a,i,s,l){var c=e.shape,f=this.texData.get(e.dataId),d=a.inChannels,v=c[0]*c[1]*c[2],m=a.outChannels,g=a.dataFormat==="channelsLast",b=(v===1||m===1)&&d>1e3,w=c[2]%2!=0&&!!f.isPacked;if(b||!le().getBool("WEBGL_LAZILY_UNPACK")||!le().getBool("WEBGL_PACK_BINARY_OPERATIONS")||!w){var _=g?c[0]*c[1]*c[2]:c[0]*c[2]*c[3],S=this.reshape(e,[1,_,a.inChannels]),E=this.reshape(n,[1,a.inChannels,a.outChannels]);return this.reshape(this.fusedBatchMatMul({a:S,b:E,transposeA:!1,transposeB:!1,bias:i,activation:s,preluActivationWeights:l}),a.outShape)}var C=g?c[0]*c[1]*(c[2]+1):c[0]*c[2]*(c[3]+1),R={dataId:e.dataId,shape:[1,C,a.inChannels],dtype:e.dtype},A=f.shape;f.shape=f.shape.slice(),f.shape[f.shape.length-2]++,L(sh(f.shape,R.shape),function(){return"packed reshape "+f.shape+" to "+R.shape+" isn't free"});var D=this.reshape(n,[1,a.inChannels,a.outChannels]),k=this.fusedBatchMatMul({a:R,b:D,transposeA:!1,transposeB:!1,bias:i,activation:s,preluActivationWeights:l}),I=this.texData.get(k.dataId);return L(I.isPacked,function(){return"batchMatMul result is expected to be packed"}),f.shape=A,I.shape=a.outShape,K.makeTensorFromDataId(k.dataId,a.outShape,k.dtype)},t.prototype.conv2dWithIm2Row=function(e,n,a,i,s,l){var c=a.filterWidth,f=a.filterHeight,d=a.inChannels,v=a.outWidth,m=a.outHeight,g=a.dataFormat==="channelsLast",b=c*f*d,w=m*v,_=[b,w],S=e.squeeze([0]),E=n.reshape([1,b,-1]),C=new wI(_,S.shape,a),R=this.compileAndRun(C,[S]).reshape([1,_[0],_[1]]),A=i!=null,D=l!=null,k=s?fh(s,!0):null,I=new Om(R.shape,[1,w,a.outChannels],!0,!1,A,k,D),O=[R,E];i&&O.push(i),D&&O.push(l);var M=this.compileAndRun(I,O);return g?M.reshape([1,m,v,a.outChannels]):M.reshape([1,a.outChannels,m,v])},t.prototype.fusedConv2d=function(e){var n=e.input,a=e.filter,i=e.convInfo,s=e.bias,l=e.activation,c=e.preluActivationWeights;if(i.filterHeight===1&&i.filterWidth===1&&i.dilationHeight===1&&i.dilationWidth===1&&i.strideHeight===1&&i.strideWidth===1&&(i.padInfo.type==="SAME"||i.padInfo.type==="VALID"))return this.conv2dByMatMul(n,a,i,s,l,c);if(le().getBool("WEBGL_CONV_IM2COL")&&n.shape[0]===1)return this.conv2dWithIm2Row(n,a,i,s,l,c);var f=s!=null,d=c!=null,v=l?fh(l,!1):null,m=new Q2(i,f,v,d),g=[n,a];return s&&g.push(s),c&&g.push(c),this.compileAndRun(m,g)},t.prototype.conv2d=function(e,n,a){if(a.filterHeight===1&&a.filterWidth===1&&a.dilationHeight===1&&a.dilationWidth===1&&a.strideHeight===1&&a.strideWidth===1&&(a.padInfo.type==="SAME"||a.padInfo.type==="VALID"))return this.conv2dByMatMul(e,n,a);if(le().getBool("WEBGL_CONV_IM2COL")&&e.shape[0]===1)return this.conv2dWithIm2Row(e,n,a);var i=new Q2(a);return this.compileAndRun(i,[e,n])},t.prototype.conv2dDerInput=function(e,n,a){var i=new LM(a);return this.compileAndRun(i,[e,n])},t.prototype.conv2dDerFilter=function(e,n,a){var i=new BM(a);return this.compileAndRun(i,[e,n])},t.prototype.fusedDepthwiseConv2D=function(e){var n,a=e.input,i=e.filter,s=e.convInfo,l=e.bias,c=e.activation,f=e.preluActivationWeights,d=le().getBool("WEBGL_PACK_DEPTHWISECONV")&&s.strideWidth<=2&&s.outChannels/s.inChannels==1,v=c?fh(c,d):null,m=[a,i],g=l!=null,b=f!=null;return g&&m.push(l),b&&m.push(f),d?(n=new J2(s,g,v,b),this.compileAndRun(n,m)):(n=new Z2(s,g,v,b),this.compileAndRun(n,m))},t.prototype.depthwiseConv2D=function(e,n,a){var i;return le().getBool("WEBGL_PACK_DEPTHWISECONV")&&a.strideWidth<=2&&a.outChannels/a.inChannels==1?(i=new J2(a),this.compileAndRun(i,[e,n])):(i=new Z2(a),this.compileAndRun(i,[e,n]))},t.prototype.depthwiseConv2DDerInput=function(e,n,a){var i=new VM(a);return this.compileAndRun(i,[e,n])},t.prototype.depthwiseConv2DDerFilter=function(e,n,a){var i=new UM(a);return this.compileAndRun(i,[e,n])},t.prototype.conv3d=function(e,n,a){var i=new HM(a);return this.compileAndRun(i,[e,n])},t.prototype.conv3dDerInput=function(e,n,a){var i=new zM(a);return this.compileAndRun(i,[e,n])},t.prototype.conv3dDerFilter=function(e,n,a){var i=new PM(a);return this.compileAndRun(i,[e,n])},t.prototype.maxPool=function(e,n){var a=new Nm(n,"max",!1);return this.compileAndRun(a,[e])},t.prototype.avgPool=function(e,n){var a=new Nm(n,"avg",!1);return this.compileAndRun(a,[e],"float32")},t.prototype.maxPoolBackprop=function(e,n,a,i){var s=new Nm(i,"max",!0),l=this.compileAndRun(s,[n]),c=new CI(i),f=this.compileAndRun(c,[e,l],n.dtype);return l.dispose(),f},t.prototype.avgPoolBackprop=function(e,n,a){var i=new CM(a);return this.compileAndRun(i,[e],n.dtype)},t.prototype.cast=function(e,n){return UE(e,n,this)},t.prototype.unstack=function(e,n){for(var a=e.shape[n],i=new Array(e.rank-1),s=0,l=0;l<e.rank;l++)l!==n&&(i[s++]=e.shape[l]);var c=new Array(e.rank).fill(0),f=e.shape.slice();f[n]=1;var d=new Array(a);for(l=0;l<d.length;l++)c[n]=l,d[l]=this.slice(e,c,f).reshape(i);return d},t.prototype.avgPool3d=function(e,n){var a=new Mm(n,"avg",!1);return this.compileAndRun(a,[e],"float32")},t.prototype.avgPool3dBackprop=function(e,n,a){var i=new RM(a);return this.compileAndRun(i,[e],n.dtype)},t.prototype.maxPool3d=function(e,n){var a=new Mm(n,"max",!1);return this.compileAndRun(a,[e],"float32")},t.prototype.maxPool3dBackprop=function(e,n,a,i){var s=new Mm(i,"max",!0),l=this.compileAndRun(s,[n]),c=new RI(i),f=this.compileAndRun(c,[e,l],n.dtype);return l.dispose(),f},t.prototype.reshape=function(e,n){var a=this.texData.get(e.dataId);if(a.isPacked&&!sh(e.shape,n)&&(a.texture===null||!sh(a.shape,n))){var i=this.packedReshape(e,n);return K.makeTensorFromDataId(i.dataId,i.shape,i.dtype)}return zg(e,n)},t.prototype.resizeBilinear=function(e,n,a,i){var s=le().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new BI(e.shape,n,a,i):new FI(e.shape,n,a,i);return this.compileAndRun(s,[e],"float32")},t.prototype.resizeBilinearBackprop=function(e,n,a){var i=new II(e,n,a);return this.compileAndRun(i,[e])},t.prototype.resizeNearestNeighbor=function(e,n,a,i){var s=new PI(e.shape,n,a,i);return this.compileAndRun(s,[e])},t.prototype.resizeNearestNeighborBackprop=function(e,n,a){var i=new LI(e,n,a);return this.compileAndRun(i,[e])},t.prototype.multinomial=function(e,n,a,i){var s=n?e:ti(e),l=s.shape[0],c=s.shape[1],f=new AI(l,c,a),d=f.getCustomSetupFunc(i);return this.compileAndRun(f,[s],"int32",d)},t.prototype.oneHot=function(e,n,a,i){var s=new TI(e.size,n,a,i);return this.compileAndRun(s,[e])},t.prototype.diag=function(e){var n=new XM(e.size);return this.compileAndRun(n,[e])},t.prototype.nonMaxSuppression=function(e,n,a,i,s){return $h("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead"),_y(e.dataSync(),n.dataSync(),a,i,s)},t.prototype.cropAndResize=function(e,n,a,i,s,l){var c=new jM(e.shape,n.shape,i,s,l);return this.compileAndRun(c,[e,n,a],"float32")},t.prototype.depthToSpace=function(e,n,a){L(n>1,function(){return"blockSize should be > 1 for depthToSpace, but was: "+n});var i=e.shape[0],s=a==="NHWC"?e.shape[1]:e.shape[2],l=a==="NHWC"?e.shape[2]:e.shape[3],c=a==="NHWC"?e.shape[3]:e.shape[1],f=s*n,d=l*n,v=c/(n*n),m=new KM(a==="NHWC"?[i,f,d,v]:[i,v,f,d],n,a);return this.compileAndRun(m,[e])},t.prototype.split=function(e,n,a){return jE(e,n,a)},t.prototype.scatterND=function(e,n,a){var i=td(0,e,a),s=i.sliceRank,l=i.numUpdates,c=i.sliceSize,f=i.strides,d=i.outputSize,v=[d/c,c],m=e.reshape([l,s]),g=n.reshape([l,c]);if(d===0)return zg(Sn([]),a);var b=ye(0),w=new r_(l,s,m.rank,g.rank,f,v);return this.compileAndRun(w,[g,m,b]).reshape(a)},t.prototype.sparseToDense=function(e,n,a,i){var s=td(0,e,a),l=s.sliceRank,c=s.numUpdates,f=s.strides,d=s.outputSize,v=new r_(c,l,e.rank,n.rank,f,[d,1]);return this.compileAndRun(v,[n,e,i]).reshape(a)},t.prototype.fft=function(e){return this.fftImpl(e,!1)},t.prototype.ifft=function(e){return this.fftImpl(e,!0)},t.prototype.fftImpl=function(e,n){var a=this.texData.get(e.dataId),i=new t_(JM,e.shape,n),s=new t_(eI,e.shape,n),l=[this.makeComplexComponentTensorInfo(e,a.complexTensors.real),this.makeComplexComponentTensorInfo(e,a.complexTensors.imag)],c=this.compileAndRun(i,l),f=this.compileAndRun(s,l),d=this.complex(c,f).as2D(e.shape[0],e.shape[1]);return c.dispose(),f.dispose(),d},t.prototype.gatherND=function(e,n){var a=n.shape,i=a[a.length-1],s=ME(e,n),l=s[0],c=s[1],f=s[2],d=s[3],v=n.reshape([c,i]),m=e.reshape([e.size/f,f]),g=new rI(i,d,[c,f]);return this.compileAndRun(g,[m,v]).reshape(l)},t.prototype.fill=function(e,n,a){if((a=a||Tc(n))==="string"){var i=Gh(a,Ae(e));return i.fill(n),K.makeTensor(i,e,a,this)}var s=new tI(e,n),l=s.getCustomSetupFunc(n);return this.compileAndRun(s,[],a,l)},t.prototype.onesLike=function(e){if(e.dtype==="string")throw new Error("onesLike is not supported under string dtype");return this.fill(e.shape,1,e.dtype)},t.prototype.zerosLike=function(e){return this.fill(e.shape,e.dtype==="string"?"":0,e.dtype)},t.prototype.linspace=function(e,n,a){return VE(e,n,a)},t.prototype.makeTensorInfo=function(e,n){var a=this.write(null,e,n);return this.texData.get(a).usage=null,{dataId:a,shape:e,dtype:n}},t.prototype.makeOutput=function(e,n){var a=this.makeTensorInfo(e,n).dataId;return K.makeTensorFromDataId(a,e,n,this)},t.prototype.unpackTensor=function(e){var n=new sF(e.shape);return this.runWebGLProgram(n,[e],e.dtype)},t.prototype.packTensor=function(e){var n=new DI(e.shape);return this.runWebGLProgram(n,[e],e.dtype,null,!0)},t.prototype.packedReshape=function(e,n){var a=[Kh(e.shape)].concat(Xh(e.shape)),i={dtype:e.dtype,shape:a,dataId:e.dataId},s=[Kh(n)].concat(Xh(n)),l=new MI(s,a),c=this.runWebGLProgram(l,[i],e.dtype,null,!0);return{dataId:c.dataId,shape:n,dtype:c.dtype}},t.prototype.decode=function(e){var n,a=this.texData.get(e),i=a.isPacked,s=a.shape,l=a.dtype,c=Am(s);return n=i?new qM(c):new GM(c),{dtype:l,shape:s,dataId:this.runWebGLProgram(n,[{shape:c,dtype:l,dataId:e}],l,null,!0).dataId}},t.prototype.runWebGLProgram=function(e,n,a,i,s){var l=this;s===void 0&&(s=!1);var c=this.makeTensorInfo(e.outputShape,a),f=this.texData.get(c.dataId);if(e.packedOutput&&(f.isPacked=!0),e.outPackingScheme===dc.DENSE){var d=ec(e.outputShape);f.texShape=d.map(function(C){return 2*C})}if(e.outTexUsage!=null&&(f.usage=e.outTexUsage),Ae(c.shape)===0)return f.values=fc(c.dtype,0),c;var v=[],m=n.map(function(C){if(C.dtype==="complex64")throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");var R=l.texData.get(C.dataId);if(R.texture==null){if(!e.packedInputs&&Ae(C.shape)<=le().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:C.shape,texData:null,isUniform:!0,uniformValues:R.values};e.packedInputs&&(R.isPacked=!0,R.shape=C.shape)}else if(!!R.isPacked!=!!e.packedInputs)C=R.isPacked?l.unpackTensor(C):l.packTensor(C),v.push(C),R=l.texData.get(C.dataId);else if(R.isPacked&&!sh(R.shape,C.shape)){var A=C,D=C.shape;C.shape=R.shape,C=l.packedReshape(C,D),v.push(C),R=l.texData.get(C.dataId),A.shape=D}return l.uploadToGPU(C.dataId),{shape:C.shape,texData:R,isUniform:!1}});this.uploadToGPU(c.dataId);var g,b={shape:c.shape,texData:f,isUniform:!1},w=function(C,R,A){var D="";R.concat(A).forEach(function(O){var M=O.texData!=null&&O.texData.slice!=null&&O.texData.slice.flatOffset>0,V=O.isUniform?"uniform":O.texData.texShape;D+=O.shape+"_"+V+"_"+M});var k=C.userCode,I=C.constructor.name;return I+="_"+D+"_"+k}(e,m,b),_=this.getAndSaveBinary(w,function(){return function(C,R,A,D){var k=R.userCode,I=A.map(function(X,re){var F={logicalShape:X.shape,texShape:X.isUniform?null:X.texData.texShape,isUniform:X.isUniform,isPacked:!X.isUniform&&X.texData.isPacked,flatOffset:null};return X.texData!=null&&X.texData.slice!=null&&X.texData.slice.flatOffset>0&&(F.flatOffset=X.texData.slice.flatOffset),{name:R.variableNames[re],shapeInfo:F}}),O=I.map(function(X){return X.shapeInfo}),M={logicalShape:D.shape,texShape:D.texData.texShape,isUniform:!1,isPacked:D.texData.isPacked,flatOffset:null},V=bM(I,M,k,R.packedInputs),z=C.createProgram(V),J=null,te=C.getUniformLocation(z,"NAN",!1);le().getNumber("WEBGL_VERSION")===1&&(J=C.getUniformLocation(z,"INFINITY",!1));for(var ne={},P=0;P<R.variableNames.length;P++){var W=R.variableNames[P];ne[W]=C.getUniformLocation(z,W,!1),ne["offset"+W]=C.getUniformLocation(z,"offset"+W,!1)}return{program:R,source:V,webGLProgram:z,uniformLocations:ne,inShapeInfos:O,outShapeInfo:M,infLoc:J,nanLoc:te}}(l.gpgpu,e,m,b)}),S=this.activeTimers!=null;if(S&&(g=this.startTimer()),function(C,R,A,D,k){n_(R.inShapeInfos,A),n_([R.outShapeInfo],[D]);var I=D.texData.texture,O=D.texData.texShape;D.texData.isPacked?C.setOutputPackedMatrixTexture(I,O[0],O[1]):C.setOutputMatrixTexture(I,O[0],O[1]),C.setProgram(R.webGLProgram),le().getNumber("WEBGL_VERSION")===1&&R.infLoc!==null&&C.gl.uniform1f(R.infLoc,1/0),R.nanLoc!==null&&C.gl.uniform1f(R.nanLoc,NaN),A.forEach(function(M,V){var z=R.program.variableNames[V],J=R.uniformLocations[z],te=R.uniformLocations["offset"+z];if(J!=null)if(M.isUniform)if(Ae(M.shape)<2)C.gl.uniform1f(J,M.uniformValues[0]);else{var ne=M.uniformValues;ne instanceof Float32Array||(ne=new Float32Array(ne)),C.gl.uniform1fv(J,ne)}else M.texData.slice!=null&&te!=null&&C.gl.uniform1i(te,M.texData.slice.flatOffset),C.setInputMatrixTexture(M.texData.texture,J,V)}),k!=null&&k(C,R.webGLProgram),C.executeProgram()}(this.gpgpu,_,m,b,i),v.forEach(function(C){return l.disposeData(C.dataId)}),S&&(g=this.endTimer(g),this.activeTimers.push({name:e.constructor.name,query:this.getQueryTime(g)})),!le().getBool("WEBGL_LAZILY_UNPACK")&&f.isPacked&&s===!1){var E=this.unpackTensor(c);return this.disposeData(c.dataId),E}return c},t.prototype.compileAndRun=function(e,n,a,i,s){s===void 0&&(s=!1),a=a||n[0].dtype;var l=this.runWebGLProgram(e,n,a,i,s);return K.makeTensorFromDataId(l.dataId,l.shape,l.dtype)},t.prototype.getAndSaveBinary=function(e,n){return e in this.binaryCache||(this.binaryCache[e]=n()),this.binaryCache[e]},t.prototype.getTextureManager=function(){return this.textureManager},t.prototype.dispose=function(){var e=this;this.disposed||(le().getBool("IS_TEST")||Object.keys(this.binaryCache).forEach(function(n){e.gpgpu.deleteProgram(e.binaryCache[n].webGLProgram),delete e.binaryCache[n]}),this.textureManager.dispose(),this.canvas!=null&&typeof HTMLCanvasElement<"u"&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0)},t.prototype.floatPrecision=function(){var e=this;return this.floatPrecisionValue==null&&(this.floatPrecisionValue=_e(function(){if(!le().get("WEBGL_RENDER_FLOAT32_ENABLED")){var n=le().getBool("DEBUG");le().set("DEBUG",!1);var a=e.abs(ye(1e-8)).dataSync()[0];if(le().set("DEBUG",n),a>0)return 32}return 16})),this.floatPrecisionValue},t.prototype.epsilon=function(){return this.floatPrecision()===32?1e-7:1e-4},t.prototype.uploadToGPU=function(e){var n,a=this.texData.get(e),i=a.shape,s=a.dtype,l=a.values,c=a.texture,f=a.usage,d=a.isPacked;if(c==null){var v,m=this.activeTimers!=null;m&&(v=la());var g=a.texShape;if(g==null&&(g=v4(i,d),a.texShape=g),l!=null){var b=Am(i),w=void 0,_=g[1],S=g[0],E=l instanceof Uint8Array;d?(_=(n=kc(g[0],g[1]))[0],S=n[1],w=new ZM(b,[S,_],E)):w=new QM(b,[S,_],E);var C=this.makeTensorInfo([S,_],s);this.texData.get(C.dataId).usage=E?cr.PIXELS:cr.UPLOAD,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(C.dataId),_,S,l);var R=this.runWebGLProgram(w,[C],s,null,!0),A=this.texData.get(R.dataId);a.texture=A.texture,a.texShape=A.texShape,a.isPacked=A.isPacked,a.usage=A.usage,this.disposeData(C.dataId),this.texData.delete(R.dataId),a.values=null,m&&(this.uploadWaitMs+=la()-v)}else{var D=this.acquireTexture(g,f,s,d);a.texture=D}}},t.prototype.convertAndCacheOnCPU=function(e,n){var a=this.texData.get(e),i=a.dtype;return this.releaseGPUData(e),n!=null&&(a.values=function(s,l){if(l==="float32"||l==="complex64")return s;if(l==="int32"||l==="bool"){for(var c=l==="int32"?new Int32Array(s.length):new Uint8Array(s.length),f=0;f<c.length;++f)c[f]=Math.round(s[f]);return c}throw new Error("Unknown dtype "+l)}(n,i)),a.values},t.prototype.acquireTexture=function(e,n,a,i){if(this.numBytesInGPU+=this.computeBytes(e,a),!this.warnedAboutMemory&&this.numBytesInGPU>1024*this.numMBBeforeWarning*1024){var s=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn("High memory usage in GPU: "+s+" MB, most likely due to a memory leak")}return this.textureManager.acquireTexture(e,n,i)},t.prototype.computeBytes=function(e,n){return e[0]*e[1]*vE(n)},t}(PE);_E()&&K.registerBackend("webgl",function(){return new lF},2);var cF=j({square_:function(r){var t=B(r,"x","square"),e=[t];return K.runKernelFunc(function(n,a){return a([t]),n.square(t)},{x:t},null,"Square",{},e,[])}}),vc="SquaredDifference",rC=j({squaredDifference_:function(r,t){var e,n=B(r,"a","squaredDifference"),a=B(t,"b","squaredDifference");e=Ft(n,a),n=e[0],a=e[1],at(n.shape,a.shape);var i={a:n,b:a},s=[n,a];return K.runKernelFunc(function(l,c){var f=l.squaredDifference(n,a);return c([n,a]),f},i,function(l,c){var f=c[0],d=c[1],v=ye(2);return{a:function(){return l.mul(f.sub(d).mul(v))},b:function(){return l.mul(d.sub(f).mul(v))}}},vc,{},s,[])}}),fF=j({abs_:function(r){var t=B(r,"x","abs");return t.dtype==="complex64"?K.runKernelFunc(function(e){return e.complexAbs(t)},{$x:t}):K.runKernelFunc(function(e,n){var a=e.abs(t);return n([t]),a},{x:t},function(e,n){var a=n[0];return{x:function(){return e.mul(a.toFloat().step(-1))}}},"Abs")}}),hF=j({acos_:function(r){var t=B(r,"x","acos");return K.runKernelFunc(function(e,n){var a=e.acos(t);return n([t]),a},{$x:t},function(e,n){var a=n[0];return{$x:function(){return e.divStrict(ye(1).sub(a.toFloat().square()).sqrt()).neg()}}})}}),dF=j({acosh_:function(r){var t=B(r,"x","acosh");return K.runKernelFunc(function(e,n){var a=e.acosh(t);return n([t]),a},{$x:t},function(e,n){var a=n[0];return{$x:function(){return e.divStrict(a.toFloat().square().sub(1).sqrt())}}})}}),pF=j({asin_:function(r){var t=B(r,"x","asin");return K.runKernelFunc(function(e,n){var a=e.asin(t);return n([t]),a},{$x:t},function(e,n){var a=n[0];return{$x:function(){return e.divStrict(ye(1).sub(a.toFloat().square()).sqrt())}}})}}),vF=j({asinh_:function(r){var t=B(r,"x","asinh");return K.runKernelFunc(function(e,n){var a=e.asinh(t);return n([t]),a},{$x:t},function(e,n){var a=n[0];return{$x:function(){return e.divStrict(ye(1).add(a.toFloat().square()).sqrt())}}})}}),mF=j({atan_:function(r){var t=B(r,"x","atan");return K.runKernelFunc(function(e,n){var a=e.atan(t);return n([t]),a},{$x:t},function(e,n){var a=n[0];return{$x:function(){return e.div(a.toFloat().square().add(1))}}})}}),gF=j({atanh_:function(r){var t=B(r,"x","atanh");return K.runKernelFunc(function(e,n){var a=e.atanh(t);return n([t]),a},{$x:t},function(e,n){var a=n[0];return{$x:function(){return e.div(ye(1).sub(a.toFloat().square()))}}})}}),yF=j({ceil_:function(r){var t=B(r,"x","ceil");return K.runKernelFunc(function(e){return e.ceil(t)},{$x:t},function(e){return{$x:function(){return st(e)}}})}}),Ty=j({clipByValue_:function(r,t,e){var n=B(r,"x","clipByValue");L(t<=e,function(){return"Error in clip: min ("+t+") must be less than or equal to max ("+e+")."});var a=[n],i={min:t,max:e};return K.runKernelFunc(function(s,l){var c=s.clip(n,t,e);return l([n]),c},{x:n},function(s,l){var c=l[0];return{x:function(){return s.where(c.greaterEqual(t).logicalAnd(c.lessEqual(e)),st(s))}}},"ClipByValue",i,a)}}),bF=j({cos_:function(r){var t=B(r,"x","cos"),e=[t];return K.runKernelFunc(function(n,a){var i=n.cos(t);return a([t]),i},{x:t},function(n,a){var i=a[0];return{x:function(){return i.toFloat().sin().neg().mul(n)}}},"Cos",{},e)}}),xF=j({cosh_:function(r){var t=B(r,"x","cosh");return K.runKernelFunc(function(e,n){var a=e.cosh(t);return n([t]),a},{$x:t},function(e,n){var a=n[0];return{$x:function(){return a.toFloat().sinh().mulStrict(e)}}})}}),wF=j({erf_:function(r){var t=B(r,"x","erf");return L(t.dtype==="int32"||t.dtype==="float32",function(){return"Input dtype must be `int32` or `float32`."}),t.dtype==="int32"&&(t=t.toFloat()),K.runKernelFunc(function(e,n){var a=e.erf(t);return n([t]),a},{$x:t},function(e,n){var a=n[0];return{$x:function(){return e.mul(a.square().neg().exp().mul(2/Math.sqrt(Math.PI)))}}})}}),Vg=j({exp_:function(r){var t=B(r,"x","exp");return K.runKernelFunc(function(e,n){var a=e.exp(t);return n([a]),a},{x:t},function(e,n){return{x:function(){return e.mulStrict(n[0])}}},"Exp",{},[],[!0])}}),_F=j({expm1_:function(r){var t=B(r,"x","expm1");return K.runKernelFunc(function(e,n){var a=e.expm1(t);return n([t]),a},{$x:t},function(e,n){var a=n[0];return{$x:function(){return e.mul(a.exp())}}})}}),SF=j({floor_:function(r){var t=B(r,"x","floor");return K.runKernelFunc(function(e){return e.floor(t)},{$x:t},function(e){return{$x:function(){return st(e)}}})}}),EF=j({log_:function(r){var t=B(r,"x","log"),e=[t];return K.runKernelFunc(function(n,a){var i=n.log(t);return a([t]),i},{x:t},function(n,a){var i=a[0];return{x:function(){return n.div(i.toFloat())}}},"Log",{},e)}}),CF=j({log1p_:function(r){var t=B(r,"x","log1p");return K.runKernelFunc(function(e,n){var a=e.log1p(t);return n([t]),a},{$x:t},function(e,n){var a=n[0];return{$x:function(){return e.div(a.add(1))}}})}}),RF=j({logSigmoid_:function(r){var t=B(r,"x","logSigmoid");return K.runKernelFunc(function(e,n){var a=e.softplus(t.neg()).neg();return n([t]),a},{$x:t},function(e,n){var a=n[0];return{$x:function(){return e.mul(a.neg().sigmoid())}}})}}),id=j({neg_:function(r){var t=B(r,"x","neg"),e=[t];return K.runKernelFunc(function(n){return n.neg(t)},{x:t},function(n){return{x:function(){return n.neg()}}},"Neg",{},e)}}),AF=j({reciprocal_:function(r){var t=B(r,"x","reciprocal");return K.runKernelFunc(function(e,n){var a=e.reciprocal(t);return n([t]),a},{$x:t},function(e,n){var a=n[0];return{$x:function(){return e.div(a.square().neg())}}})}}),TF=j({round_:function(r){var t=B(r,"x","round");return K.runKernelFunc(function(e){return e.round(t)},{$x:t},function(e){return{$x:function(){return st(e)}}})}}),aC=j({rsqrt_:function(r){var t=B(r,"x","rsqrt"),e=[t];return K.runKernelFunc(function(n,a){var i=n.rsqrt(t);return a([t]),i},{x:t},function(n,a){var i=a[0];return{x:function(){return n.div(i.pow(1.5).mul(2)).neg()}}},"Rsqrt",{},e)}}),iC=j({sigmoid_:function(r){var t=B(r,"x","sigmoid");return K.runKernelFunc(function(e,n){var a=e.sigmoid(t);return n([a]),a},{x:t},function(e,n){var a=n[0];return{x:function(){return e.mul(a.mul(ye(1).sub(a)))}}},"Sigmoid")}}),DF=j({sign_:function(r){var t=B(r,"x","sign");return K.runKernelFunc(function(e){return e.sign(t)},{$x:t},function(e){return{$x:function(){return st(e)}}})}}),kF=j({isNaN_:function(r){var t=B(r,"x","isNaN");return K.runKernelFunc(function(e){return e.isNaN(t)},{$x:t},function(e){return{$x:function(){return st(e)}}})}}),OF=j({isInf_:function(r){var t=B(r,"x","isInf");return K.runKernelFunc(function(e){return e.isInf(t)},{$x:t},function(e){return{$x:function(){return st(e)}}})}}),NF=j({isFinite_:function(r){var t=B(r,"x","isFinite");return K.runKernelFunc(function(e){return e.isFinite(t)},{$x:t},function(e){return{$x:function(){return st(e)}}})}}),MF=j({sin_:function(r){var t=B(r,"x","sin"),e=[t];return K.runKernelFunc(function(n,a){var i=n.sin(t);return a([t]),i},{x:t},function(n,a){var i=a[0];return{x:function(){return i.toFloat().cos().mul(n)}}},"Sin",{},e)}}),IF=j({sinh_:function(r){var t=B(r,"x","sinh");return K.runKernelFunc(function(e,n){var a=e.sinh(t);return n([t]),a},{$x:t},function(e,n){var a=n[0];return{$x:function(){return a.toFloat().cosh().mulStrict(e)}}})}}),FF=j({softplus_:function(r){var t=B(r,"x","softplus");return K.runKernelFunc(function(e,n){var a=e.softplus(t);return n([t]),a},{$x:t},function(e,n){var a=n[0];return{$x:function(){return e.mul(a.sigmoid())}}})}}),BF=j({sqrt_:function(r){var t=B(r,"x","sqrt");return K.runKernelFunc(function(e,n){var a=e.sqrt(t);return n([t]),a},{$x:t},function(e,n){var a=n[0];return{$x:function(){return e.div(a.toFloat().sqrt().mul(2))}}})}}),LF=j({step_:function(r,t){t===void 0&&(t=0);var e=B(r,"x","step");return K.runKernelFunc(function(n){return n.step(e,t)},{$x:e},function(n){return{$x:function(){return st(n)}}})}}),PF=j({tan_:function(r){var t=B(r,"x","tan");return K.runKernelFunc(function(e,n){var a=e.tan(t);return n([t]),a},{$x:t},function(e,n){var a=n[0];return{$x:function(){return e.div(a.cos().square())}}})}}),zF=j({tanh_:function(r){var t=B(r,"x","tanh");return K.runKernelFunc(function(e,n){var a=e.tanh(t);return n([a]),a},{x:t},function(e,n){var a=n[0];return{x:function(){return ye(1).sub(a.square()).mulStrict(e)}}},"Tanh",{},null,[!0])}});function oC(r,t,e,n,a,i){var s,l,c=B(r,"x","batchNorm"),f=B(t,"mean","batchNorm"),d=B(e,"variance","batchNorm");return a!=null&&(s=B(a,"scale","batchNorm")),n!=null&&(l=B(n,"offset","batchNorm")),L(c.rank===2,function(){return"Error in batchNorm3D: x must be rank 3 but got rank "+c.rank+"."}),L(f.rank===2||f.rank===1,function(){return"Error in batchNorm2D: mean must be rank 2 or rank 1 but got rank "+f.rank+"."}),L(d.rank===2||d.rank===1,function(){return"Error in batchNorm2D: variance must be rank 2 or rank 1 but got rank "+d.rank+"."}),s!=null&&L(s.rank===2||s.rank===1,function(){return"Error in batchNorm2D: scale must be rank 2 or rank 1 but got rank "+s.rank+"."}),l!=null&&L(l.rank===2||l.rank===1,function(){return"Error in batchNorm2D: offset must be rank 2 or rank 1 but got rank "+l.rank+"."}),Nc(c,f,d,l,s,i)}function sC(r,t,e,n,a,i){var s,l,c=B(r,"x","batchNorm"),f=B(t,"mean","batchNorm"),d=B(e,"variance","batchNorm");return a!=null&&(s=B(a,"scale","batchNorm")),n!=null&&(l=B(n,"offset","batchNorm")),L(c.rank===3,function(){return"Error in batchNorm3D: x must be rank 3 but got rank "+c.rank+"."}),L(f.rank===3||f.rank===1,function(){return"Error in batchNorm3D: mean must be rank 3 or rank 1 but got rank "+f.rank+"."}),L(d.rank===3||d.rank===1,function(){return"Error in batchNorm3D: variance must be rank 3 or rank 1 but got rank "+d.rank+"."}),s!=null&&L(s.rank===3||s.rank===1,function(){return"Error in batchNorm3D: scale must be rank 3 or rank 1 but got rank "+s.rank+"."}),l!=null&&L(l.rank===3||l.rank===1,function(){return"Error in batchNorm3D: offset must be rank 3 or rank 1 but got rank "+l.rank+"."}),Nc(c,f,d,l,s,i)}function uC(r,t,e,n,a,i){var s,l,c=B(r,"x","batchNorm"),f=B(t,"mean","batchNorm"),d=B(e,"variance","batchNorm");return a!=null&&(s=B(a,"scale","batchNorm")),n!=null&&(l=B(n,"offset","batchNorm")),L(c.rank===4,function(){return"Error in batchNorm4D: x must be rank 4 but got rank "+c.rank+"."}),L(f.rank===4||f.rank===1,function(){return"Error in batchNorm4D: mean must be rank 4 or rank 1 but got rank "+f.rank+"."}),L(d.rank===4||d.rank===1,function(){return"Error in batchNorm4D: variance must be rank 4 or rank 1 but got rank "+d.rank+"."}),s!=null&&L(s.rank===4||s.rank===1,function(){return"Error in batchNorm4D: scale must be rank 4 or rank 1 but got rank "+s.rank+"."}),l!=null&&L(l.rank===4||l.rank===1,function(){return"Error in batchNorm4D: offset must be rank 4 or rank 1 but got rank "+l.rank+"."}),Nc(c,f,d,l,s,i)}function Nc(r,t,e,n,a,i){i==null&&(i=.001);var s,l,c,f=B(r,"x","batchNorm"),d=B(t,"mean","batchNorm"),v=B(e,"variance","batchNorm");a!=null&&(s=B(a,"scale","batchNorm")),n!=null&&(l=B(n,"offset","batchNorm")),L(d.rank===v.rank,function(){return"Batch normalization gradient requires mean and variance to have equal ranks."}),L(l==null||d.rank===l.rank,function(){return"Batch normalization gradient requires mean and offset to have equal ranks."}),L(s==null||d.rank===s.rank,function(){return"Batch normalization gradient requires mean and scale to have equal ranks."}),c=f.rank===0||f.rank===1?f.as4D(1,1,1,f.size):f.rank===2?f.as4D(1,1,f.shape[0],f.shape[1]):f.rank===3?f.as4D(1,f.shape[0],f.shape[1],f.shape[2]):f;var m=[f,d,v,s];return K.runKernelFunc(function(g,b){var w=g.batchNormalization(c,hh(d),hh(v),i,hh(s),hh(l));return b([f,d,v,s]),w},{x:f,mean:d,variance:v,scale:s,offset:l},function(g,b){var w=b,_=w[0],S=w[1],E=w[2],C=w[3],R=C??ye(1),A=an(S.shape,c.shape),D=[];if(S.rank===1){for(var k=0;k<c.shape.length-1;++k)D.push(c.shape[k]);D.push(1)}var I=_.sub(S),O=g.mul(R),M=aC(E.add(ye(i))),V=M.mul(M).mul(M).mul(ye(-.5));return{x:function(){return S.rank===1?g.mul(au(M.as4D(1,1,1,S.shape[0]),D)).mul(R).reshape(_.shape):g.mul(M).mul(R).reshape(_.shape)},mean:function(){var z=M.mul(ye(-1)).mul(O);return S.rank===1&&(z=z.sum(A)),z.reshape(S.shape)},variance:function(){var z=V.mul(I).mul(O);return S.rank===1&&(z=z.sum(A)),z.reshape(S.shape)},scale:function(){var z=I.mul(M),J=g.mul(z);return S.rank===1&&(J=J.sum(A)),J.reshape(S.shape)},offset:function(){var z=g;return S.rank===1&&(z=z.sum(A)),z.reshape(S.shape)}}},"BatchNormalization",{varianceEpsilon:i},m).reshape(f.shape)}function hh(r){return r==null?null:r.rank===0?r.as1D():r.rank===1?r:r.rank===2?r.as4D(1,1,r.shape[0],r.shape[1]):r.rank===3?r.as4D(1,r.shape[0],r.shape[1],r.shape[2]):r}function Ed(){SE("tf.batchNormalization() is going away. Use tf.batchNorm() instead, and note the positional argument change of scale, offset, and varianceEpsilon")}var UF=j({batchNormalization2d_:function(r,t,e,n,a,i){return n===void 0&&(n=.001),Ed(),oC(r,t,e,i,a,n)}}),VF=j({batchNormalization3d_:function(r,t,e,n,a,i){return n===void 0&&(n=.001),Ed(),sC(r,t,e,i,a,n)}}),HF=j({batchNormalization4d_:function(r,t,e,n,a,i){return n===void 0&&(n=.001),Ed(),uC(r,t,e,i,a,n)}}),jF=j({batchNormalization_:function(r,t,e,n,a,i){return n===void 0&&(n=.001),Ed(),Nc(r,t,e,i,a,n)}}),lC=j({batchNorm_:Nc}),WF=j({batchNorm2d_:oC}),GF=j({batchNorm3d_:sC}),qF=j({batchNorm4d_:uC}),Cd=j({logicalAnd_:function(r,t){var e=B(r,"a","logicalAnd","bool"),n=B(t,"b","logicalAnd","bool");return at(e.shape,n.shape),K.runKernelFunc(function(a){return a.logicalAnd(e,n)},{a:e,b:n},null,"LogicalAnd")}}),KF=j({logicalNot_:function(r){var t=B(r,"x","logicalNot","bool");return K.runKernelFunc(function(e){return e.logicalNot(t)},{$x:t})}}),cC=j({logicalOr_:function(r,t){var e=B(r,"a","logicalOr","bool"),n=B(t,"b","logicalOr","bool");return at(e.shape,n.shape),K.runKernelFunc(function(a){return a.logicalOr(e,n)},{$a:e,$b:n})}}),XF=j({logicalXor_:function(r,t){var e=B(r,"a","logicalXor","bool"),n=B(t,"b","logicalXor","bool");return at(e.shape,n.shape),cC(r,t).logicalAnd(Cd(r,t).logicalNot())}}),Zo=j({where_:function(r,t,e){var n=B(t,"a","where"),a=B(e,"b","where"),i=B(r,"condition","where","bool");return gt(n.shape,a.shape,"Error in where: "),i.rank===1?L(i.shape[0]===n.shape[0],function(){return"The first dimension of `a` must match the size of `condition`."}):gt(i.shape,a.shape,"Error in where: "),K.runKernelFunc(function(s,l){var c=s.select(i,n,a);return l([i]),c},{$condition:i,$a:n,$b:a},function(s,l){var c=l[0];return{$condition:function(){return st(c).toFloat()},$a:function(){return s.mul(c.cast(s.dtype))},$b:function(){return s.mul(c.logicalNot().cast(s.dtype))}}})}}),fC=function(r){return Ee(this,void 0,void 0,function(){var t,e,n;return Ce(this,function(a){switch(a.label){case 0:return[4,(t=B(r,"condition","whereAsync","bool")).data()];case 1:return e=a.sent(),n=Ey(t.shape,e),r!==t&&t.dispose(),[2,n]}})})},et=j({add_:function(r,t){var e,n=B(r,"a","add"),a=B(t,"b","add");e=Ft(n,a),n=e[0],a=e[1];var i=at(n.shape,a.shape);return K.runKernelFunc(function(s){return s.add(n,a)},{a:n,b:a},function(s){return{a:function(){var l=s,c=an(n.shape,i);return c.length>0&&(l=l.sum(c)),l.reshape(n.shape)},b:function(){var l=s,c=an(a.shape,i);return c.length>0&&(l=l.sum(c)),l.reshape(a.shape)}}},"Add")}}),$F=j({addN_:function(r){L(Array.isArray(r),function(){return"The argument passed to tf.addN() must be a list of tensors"}),L(r.length>=1,function(){return"Must pass at least one tensor to tf.addN(), but got "+r.length});var t=r.map(function(a,i){return B(a,"tensors"+i,"addN")}),e=t[0];t.forEach(function(a){if(a.dtype!==e.dtype)throw new Error("All tensors passed to tf.addN() must have the same dtype")}),t.forEach(function(a){if(!vn(a.shape,e.shape))throw new Error("All tensors passed to tf.addN() must have the same shape")});var n=t;return K.runKernelFunc(function(a){return a.addN(t)},n,function(a){var i={};return t.forEach(function(s,l){i[l]=function(){return a.clone()}}),i},"AddN")}}),YF=j({addStrict_:function(r,t){var e=B(r,"a","addStrict"),n=B(t,"b","addStrict");return gt(e.shape,n.shape,"Error in addStrict: "),e.add(n)}}),QF=j({atan2_:function(r,t){var e,n=B(r,"a","atan2"),a=B(t,"b","atan2");e=Ft(n,a),n=e[0],a=e[1];var i=at(n.shape,a.shape);return K.runKernelFunc(function(s,l){var c=s.atan2(n,a);return l([n,a]),c},{$a:n,$b:a},function(s,l){var c=l[0],f=l[1];return{$a:function(){var d=et(c.square(),f.square()),v=s.mul(f.div(d)),m=an(c.shape,i);return m.length>0&&(v=v.sum(m)),v.reshape(c.shape)},$b:function(){var d=et(c.square(),f.square()),v=id(s.mul(c.div(d))),m=an(f.shape,i);return m.length>0&&(v=v.sum(m)),v.reshape(f.shape)}}})}}),jr=j({div_:function(r,t){var e,n=B(r,"a","div"),a=B(t,"b","div");if(e=Ft(n,a),n=e[0],a=e[1],n.dtype==="int32"&&a.dtype==="int32")return hC(n,a);var i=at(n.shape,a.shape);return K.runKernelFunc(function(s,l){var c=s.realDivide(n,a);return l([n,a]),c},{a:n,b:a},function(s,l){var c=l[0],f=l[1];return{a:function(){var d=s.div(f.toFloat()),v=an(c.shape,i);return v.length>0?d.sum(v).reshape(c.shape):d},b:function(){var d=s.mul(c.toFloat()),v=an(f.shape,i);v.length>0&&(d=d.sum(v).reshape(f.shape));var m=f.square();return d.div(m.toFloat()).neg()}}},"Div")}}),ZF=j({divNoNan_:function(r,t){var e,n=B(r,"a","div"),a=B(t,"b","div");n=(e=Ft(n,a))[0],a=e[1];var i=jr(n,a),s=st(i),l=a.equal(s);return Zo(l,s,i)}}),JF=j({divStrict_:function(r,t){var e=B(r,"a","div"),n=B(t,"b","div");return gt(e.shape,n.shape,"Error in divideStrict: "),e.div(n)}}),hC=j({floorDiv_:function(r,t){var e,n=B(r,"a","floorDiv"),a=B(t,"b","floorDiv");e=Ft(n,a),n=e[0],a=e[1];var i=at(n.shape,a.shape);return K.runKernelFunc(function(s,l){var c=s.floorDiv(n,a);return l([n,a]),c},{a:n,b:a},function(s,l){var c=l[0],f=l[1];return{a:function(){var d=s.div(f.toFloat()),v=an(c.shape,i);return v.length>0?d.sum(v).reshape(c.shape):d},b:function(){var d=s.mul(c.toFloat()),v=an(f.shape,i);v.length>0&&(d=d.sum(v).reshape(f.shape));var m=f.square();return d.div(m.toFloat()).neg()}}},"FloorDiv")}}),Dy=j({maximum_:function(r,t){var e,n=B(r,"a","maximum"),a=B(t,"b","maximum");return e=Ft(n,a),n=e[0],a=e[1],n.dtype==="bool"&&(n=n.toInt(),a=a.toInt()),at(n.shape,a.shape),K.runKernelFunc(function(i,s){var l=i.maximum(n,a);return s([n,a]),l},{a:n,b:a},function(i,s){var l=s[0],c=s[1];return{a:function(){return i.mul(l.greaterEqual(c).toFloat())},b:function(){return i.mul(l.less(c).toFloat())}}},"Maximum")}}),eB=j({maximumStrict_:function(r,t){var e=B(r,"a","maximumStrict"),n=B(t,"b","maximumStrict");return gt(e.shape,n.shape,"Error in maximumStrict: "),e.maximum(n)}}),dC=j({minimum_:function(r,t){var e,n=B(r,"a","minimum"),a=B(t,"b","minimum");return e=Ft(n,a),n=e[0],a=e[1],n.dtype==="bool"&&(n=n.toInt(),a=a.toInt()),at(n.shape,a.shape),K.runKernelFunc(function(i,s){var l=i.minimum(n,a);return s([n,a]),l},{a:n,b:a},function(i,s){var l=s[0],c=s[1];return{a:function(){return i.mul(l.lessEqual(c).toFloat())},b:function(){return i.mul(l.greater(c).toFloat())}}},"Minimum")}}),tB=j({minimumStrict_:function(r,t){var e=B(r,"a","minimumStrict"),n=B(t,"b","minimumStrict");return gt(e.shape,n.shape,"Error in minimumStrict: "),e.minimum(n)}}),nB=j({mod_:function(r,t){var e,n=B(r,"a","mod"),a=B(t,"b","mod");e=Ft(n,a),n=e[0],a=e[1];var i=at(n.shape,a.shape);return K.runKernelFunc(function(s,l){var c=s.mod(n,a);return l([n,a]),c},{$a:n,$b:a},function(s,l){var c=l[0],f=l[1];return{$a:function(){var d=an(c.shape,i);return d.length>0?s.sum(d).reshape(c.shape):s},$b:function(){var d=s.mul(c.div(f).floor().neg()),v=an(f.shape,i);return v.length>0?d.sum(v).reshape(f.shape):d}}})}}),rB=j({modStrict_:function(r,t){var e=B(r,"a","modStrict"),n=B(t,"b","modStrict");return gt(e.shape,n.shape,"Error in modStrict: "),e.mod(n)}}),Mn=j({mul_:function(r,t){var e,n=B(r,"a","mul"),a=B(t,"b","mul");e=Ft(n,a),n=e[0],a=e[1];var i=at(n.shape,a.shape);return K.runKernelFunc(function(s,l){var c=s.multiply(n,a);return l([n,a]),c},{a:n,b:a},function(s,l){var c=l[0],f=l[1];return{a:function(){var d=s.mul(f.toFloat()),v=an(c.shape,i);return v.length>0?d.sum(v).reshape(c.shape):d},b:function(){var d=s.mul(c.toFloat()),v=an(f.shape,i);return v.length>0?d.sum(v).reshape(f.shape):d}}},"Mul")}}),aB=j({mulStrict_:function(r,t){var e=B(r,"a","mul"),n=B(t,"b","mul");return gt(e.shape,n.shape,"Error in multiplyStrict: "),e.mul(n)}}),od=j({pow_:function(r,t){var e,n=B(r,"base","pow"),a=B(t,"exp","pow");e=Ft(n,a),n=e[0],a=e[1];var i=at(n.shape,a.shape),s=[n,a];return K.runKernelFunc(function(l,c){var f=l.pow(n,a);return c([n,a,f]),f},{a:n,b:a},function(l,c){var f=c[0],d=c[1],v=c[2];return{a:function(){var m=d.toFloat(),g=l.mul(m.mul(f.pow(m.sub(ye(1))))),b=an(f.shape,i);return b.length>0&&(g=g.sum(b)),g.reshape(f.shape)},b:function(){var m=f.greater(0),g=f.log().where(m,st(f)),b=l.mul(v.mul(g)),w=an(d.shape,i);return w.length>0&&(b=b.sum(w)),b.reshape(d.shape)}}},"Pow",{},s,[!0])}}),iB=j({powStrict_:function(r,t){return gt(r.shape,t.shape,"Error in powStrict: "),r.pow(t)}}),oB=j({squaredDifferenceStrict_:function(r,t){var e=B(r,"a","squaredDifferenceStrict"),n=B(t,"b","squaredDifferenceStrict");return gt(e.shape,n.shape,"Error in squaredDifferenceStrict: "),e.squaredDifference(n)}}),on=j({sub_:function(r,t){var e,n=B(r,"a","sub"),a=B(t,"b","sub");e=Ft(n,a),n=e[0],a=e[1];var i=at(n.shape,a.shape);return K.runKernelFunc(function(s){return s.subtract(n,a)},{a:n,b:a},function(s){return{a:function(){var l=s,c=an(n.shape,i);return c.length>0&&(l=l.sum(c)),l.reshape(n.shape)},b:function(){var l=s,c=an(a.shape,i);return c.length>0&&(l=l.sum(c)),l.neg().reshape(a.shape)}}},"Sub")}}),sB=j({subStrict_:function(r,t){var e=B(r,"a","subStrict"),n=B(t,"b","subStrict");return gt(e.shape,n.shape,"Error in subStrict: "),e.sub(n)}}),pC=j({equal_:function(r,t){var e,n=B(r,"a","equal"),a=B(t,"b","equal");return e=Ft(n,a),n=e[0],a=e[1],at(n.shape,a.shape),K.runKernelFunc(function(i){return i.equal(n,a)},{$a:n,$b:a})}}),uB=j({equalStrict_:function(r,t){var e=B(r,"a","equalStrict"),n=B(t,"b","equalStrict");return gt(e.shape,n.shape,"Error in equalStrict: "),e.equal(n)}}),lB=j({greater_:function(r,t){var e,n=B(r,"a","greater"),a=B(t,"b","greater");return e=Ft(n,a),n=e[0],a=e[1],at(n.shape,a.shape),K.runKernelFunc(function(i){return i.greater(n,a)},{a:n,b:a},null,"Greater")}}),vC=j({greaterEqual_:function(r,t){var e,n=B(r,"a","greaterEqual"),a=B(t,"b","greaterEqual");return e=Ft(n,a),n=e[0],a=e[1],at(n.shape,a.shape),K.runKernelFunc(function(i,s){var l=i.greaterEqual(n,a);return s([n,a]),l},{a:n,b:a},function(i,s){var l=s[0],c=s[1];return{a:function(){return st(l)},b:function(){return st(c)}}},"GreaterEqual")}}),cB=j({greaterEqualStrict_:function(r,t){var e=B(r,"a","greaterEqualStrict"),n=B(t,"b","greaterEqualStrict");return gt(e.shape,n.shape,"Error in greaterEqualStrict: "),e.greaterEqual(n)}}),fB=j({greaterStrict_:function(r,t){var e=B(r,"a","greaterStrict"),n=B(t,"b","greaterStrict");return gt(e.shape,n.shape,"Error in greaterStrict: "),e.greater(n)}}),hB=j({less_:function(r,t){var e,n=B(r,"a","less"),a=B(t,"b","less");return e=Ft(n,a),n=e[0],a=e[1],at(n.shape,a.shape),K.runKernelFunc(function(i){return i.less(n,a)},{a:n,b:a},null,"Less")}}),dB=j({lessEqual_:function(r,t){var e,n=B(r,"a","lessEqual"),a=B(t,"b","lessEqual");return e=Ft(n,a),n=e[0],a=e[1],at(n.shape,a.shape),K.runKernelFunc(function(i,s){var l=i.lessEqual(n,a);return s([n,a]),l},{a:n,b:a},null,"LessEqual")}}),pB=j({lessEqualStrict_:function(r,t){var e=B(r,"a","lessEqualStrict"),n=B(t,"b","lessEqualStrict");return gt(e.shape,n.shape,"Error in lessEqualStrict: "),e.lessEqual(n)}}),vB=j({lessStrict_:function(r,t){var e=B(r,"a","lessStrict"),n=B(t,"b","lessStrict");return gt(e.shape,n.shape,"Error in lessStrict: "),e.less(n)}}),mB=j({notEqual_:function(r,t){var e,n=B(r,"a","notEqual"),a=B(t,"b","notEqual");return e=Ft(n,a),n=e[0],a=e[1],at(n.shape,a.shape),K.runKernelFunc(function(i){return i.notEqual(n,a)},{a:n,b:a},null,"NotEqual")}}),gB=j({notEqualStrict_:function(r,t){var e=B(r,"a","notEqualStrict"),n=B(t,"b","notEqualStrict");return gt(e.shape,n.shape,"Error in notEqualStrict: "),e.notEqual(n)}});function h_(r,t){for(var e=[],n=r;n<t;++n)e.push(n);return e}function d_(r){for(var t=[],e=0;e<r.length;++e)for(var n=0;n<r[e].length;++n)t.push(r[e][n]);return t}var ky=j({gather_:function(r,t,e){e===void 0&&(e=0);var n=B(r,"x","gather"),a=B(t,"indices","gather","int32");e=sn(e,n.shape)[0];var i=function(s,l,c){for(var f=s.shape[c],d=[],v=1,m=1,g=0;g<c;g++)d.push(s.shape[g]),v*=s.shape[g];for(g=0;g<l.rank;g++)d.push(l.shape[g]);for(g=c+1;g<s.rank;g++)d.push(s.shape[g]),m*=s.shape[g];return{batchSize:v,sliceSize:m,dimSize:f,outputShape:d}}(n,a,e);return K.runKernelFunc(function(s,l){var c=s.gather(n,a.flatten(),e);return l([a]),c},{x:n,indices:a},function(s,l){var c=l[0];return{x:function(){var f=n.shape,d=c.size,v=f.slice(0,e),m=v.length,g=f.slice(e,f.length).slice(1),b=g.length,w=h_(0,m),_=h_(m+1,m+1+b),S=d_([v,[d],g]),E=s.reshape(S),C=c.reshape([d]),R=d_([[m],w,_]),A=E.transpose(R),D=mC(A,C,n.shape[e]),k=my(R);return D=D.transpose(k)},indices:function(){return c}}},"Gather",{axis:e}).reshape(i.outputShape)}}),mC=j({unsortedSegmentSum_:function(r,t,e){var n=B(r,"x","unsortedSegmentSum"),a=B(t,"segmentIds","unsortedSegmentSum","int32");return L(jt(e),function(){return"numSegments must be of dtype int"}),K.runKernelFunc(function(i,s){var l=i.unsortedSegmentSum(n,a,e);return s([a]),l},{$x:n},function(i,s){var l=s[0];return{$x:function(){return function(c,f){for(var d=Dy(f,st(f)),v=ky(c,d),m=vC(f,ye(0,"int32")),g=v.rank-m.rank,b=0;b<g;++b)m=Tr(m,b+1);m=Cd(m,Hu(v.shape,"bool"));var w=st(v);return Zo(m,v,w)}(i,l)}}})}}),yB=function(r,t,e){return Ee(this,void 0,void 0,function(){var n,a,i,s,l,c,f,d,v,m,g,b,w;return Ce(this,function(_){switch(_.label){case 0:for(n=B(r,"tensor","boolMask"),a=B(t,"mask","boolMask","bool"),i=e??0,s=a.rank,l=n.shape,L(s>0,function(){return"mask cannot be scalar"}),gt(l.slice(i,i+s),a.shape,"mask's shape must match the first K dimensions of tensor's shape,"),c=1,f=i;f<i+s;f++)c*=l[f];return d=l.slice(0,i).concat([c],l.slice(i+s)),v=n.reshape(d),m=a.reshape([-1]),[4,fC(m)];case 1:return g=_.sent(),b=g.squeeze([1]),w=ky(v,b,i),r!==n&&n.dispose(),t!==a&&a.dispose(),b.dispose(),v.dispose(),m.dispose(),g.dispose(),[2,w]}})})};function gC(r,t,e,n,a,i,s){i===void 0&&(i="NHWC"),L(r.length===t.rank,function(){return"Length of inShape ("+r.length+") and rank of dy ("+t.rank+") must match"});var l=r,c=t,f=!1;t.rank===3&&(f=!0,c=t.as4D(1,t.shape[0],t.shape[1],t.shape[2]),l=[1,r[0],r[1],r[2]]),L(l.length===4,function(){return"Error in conv2dDerInput: inShape must be length 4, but got length "+l.length+"."}),L(c.rank===4,function(){return"Error in conv2dDerInput: dy must be rank 4, but got rank "+c.rank}),L(e.rank===4,function(){return"Error in conv2dDerInput: filter must be rank 4, but got rank "+e.rank});var d=i==="NHWC"?l[3]:l[1],v=i==="NHWC"?c.shape[3]:c.shape[1];L(d===e.shape[2],function(){return"Error in conv2dDerInput: depth of input ("+d+") must match input depth for filter "+e.shape[2]+"."}),L(v===e.shape[3],function(){return"Error in conv2dDerInput: depth of output ("+v+") must match output depth for filter "+e.shape[3]+"."}),s!=null&&L(jt(a),function(){return"Error in conv2dDerInput: pad must be an integer when using, dimRoundingMode "+s+" but got pad "+a+"."});var m=wy(i),g=ts(l,e.shape,n,1,a,s,!1,m),b=K.runKernelFunc(function(w,_){var S=w.conv2dDerInput(c,e,g);return _([e,c]),S},{dy4D:c,filter:e},function(w,_){var S=_[0],E=_[1];return{dy4D:function(){return Ir(w,S,n,a,i,1,s)},filter:function(){return Oy(w,E,S.shape,n,a,i,s)}}});return f?b.as3D(b.shape[1],b.shape[2],b.shape[3]):b}function Fm(r){var t=function(i){return typeof i=="number"?[i,i,i]:i.length===2?[i[0],i[1],1]:i}(r),e=t[0],n=t[1],a=t[2];return e===1&&n===1&&a===1}function yC(r,t,e,n,a){L(r.length===t.rank,function(){return"Length of inShape ("+r.length+") and rank of dy ("+t.rank+") must match"});var i=r,s=t,l=!1;t.rank===4&&(l=!0,s=t.as5D(1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]),i=[1,r[0],r[1],r[2],r[3]]);var c=i[4],f=s.shape[4];L(i.length===5,function(){return"Error in conv3dDerInput: inShape must be length 5, but got length "+i.length+"."}),L(s.rank===5,function(){return"Error in conv3dDerInput: dy must be rank 5, but got rank "+s.rank}),L(e.rank===5,function(){return"Error in conv3dDerInput: filter must be rank 5, but got rank "+e.rank}),L(c===e.shape[3],function(){return"Error in conv3dDerInput: depth of input ("+c+") must match input depth for filter "+e.shape[3]+"."}),L(f===e.shape[4],function(){return"Error in conv3dDerInput: depth of output ("+f+") must match output depth for filter "+e.shape[4]+"."});var d=rd(i,e.shape,n,1,a),v=K.runKernelFunc(function(m){return m.conv3dDerInput(s,e,d)},{dy5D:s});return l?v.as4D(v.shape[1],v.shape[2],v.shape[3],v.shape[4]):v}var bB=j({conv1d_:function(r,t,e,n,a,i,s){a===void 0&&(a="NWC"),i===void 0&&(i=1);var l=B(r,"x","conv1d"),c=B(t,"filter","conv1d"),f=l,d=!1;l.rank===2&&(d=!0,f=l.as3D(1,l.shape[0],l.shape[1])),L(f.rank===3,function(){return"Error in conv1d: input must be rank 3, but got rank "+f.rank+"."}),L(c.rank===3,function(){return"Error in conv1d: filter must be rank 3, but got rank "+c.rank+"."}),s!=null&&L(jt(n),function(){return"Error in conv1d: pad must be an integer when using, dimRoundingMode "+s+" but got pad "+n+"."}),L(f.shape[2]===c.shape[1],function(){return"Error in conv1d: depth of input ("+f.shape[2]+") must match input depth for filter "+c.shape[1]+"."}),L(Jn(e,i),function(){return"Error in conv1D: Either stride or dilation must be 1. Got stride "+e+" and dilation '"+i+"'"}),L(a==="NWC",function(){return"Error in conv1d: got dataFormat of "+a+" but only NWC is currently supported."});var v=c.as4D(1,c.shape[0],c.shape[1],c.shape[2]),m=f.as4D(f.shape[0],1,f.shape[1],f.shape[2]),g=Ir(m,v,[1,e],n,"NHWC",[1,i],s);return d?g.as2D(g.shape[2],g.shape[3]):g.as3D(g.shape[0],g.shape[2],g.shape[3])}}),Ir=j({conv2d_:function(r,t,e,n,a,i,s){a===void 0&&(a="NHWC"),i===void 0&&(i=[1,1]);var l=B(r,"x","conv2d"),c=B(t,"filter","conv2d"),f=l,d=!1;l.rank===3&&(d=!0,f=l.as4D(1,l.shape[0],l.shape[1],l.shape[2])),L(f.rank===4,function(){return"Error in conv2d: input must be rank 4, but got rank "+f.rank+"."}),L(c.rank===4,function(){return"Error in conv2d: filter must be rank 4, but got rank "+c.rank+"."}),s!=null&&L(jt(n),function(){return"Error in conv2d: pad must be an integer when using, dimRoundingMode "+s+" but got pad "+n+"."});var v=a==="NHWC"?f.shape[3]:f.shape[1];L(v===c.shape[2],function(){return"Error in conv2d: depth of input ("+v+") must match input depth for filter "+c.shape[2]+"."}),L(Jn(e,i),function(){return"Error in conv2D: Either strides or dilations must be 1. Got strides "+e+" and dilations '"+i+"'"});var m=wy(a),g=ts(f.shape,c.shape,e,i,n,s,!1,m),b=[c,f],w=K.runKernelFunc(function(_,S){var E=_.conv2d(f,c,g);return S([c,f]),E},{x:f,filter:c},function(_,S){var E=S,C=E[0],R=E[1];return L(Bu(i),function(){return"Error in gradient of conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+i+"'"}),{x:function(){return bC(R.shape,_,C,e,n,a)},filter:function(){return Oy(R,_,C.shape,e,n,a)}}},"Conv2D",g,b);return d?w.as3D(w.shape[1],w.shape[2],w.shape[3]):w}}),xB=j({conv3d_:function(r,t,e,n,a,i){a===void 0&&(a="NDHWC"),i===void 0&&(i=[1,1,1]);var s=B(r,"x","conv3d"),l=B(t,"filter","conv3d"),c=s,f=!1;s.rank===4&&(f=!0,c=s.as5D(1,s.shape[0],s.shape[1],s.shape[2],s.shape[3])),L(c.rank===5,function(){return"Error in conv3d: input must be rank 5, but got rank "+c.rank+"."}),L(l.rank===5,function(){return"Error in conv3d: filter must be rank 5, but got rank "+l.rank+"."}),L(c.shape[4]===l.shape[3],function(){return"Error in conv3d: depth of input ("+c.shape[4]+") must match input depth for filter "+l.shape[3]+"."}),L(function(m,g){return Fm(m)||Fm(g)}(e,i),function(){return"Error in conv3D: Either strides or dilations must be 1. Got strides "+e+" and dilations '"+i+"'"}),L(a==="NDHWC",function(){return"Error in conv3d: got dataFormat of "+a+" but only NDHWC is currently supported."});var d=rd(c.shape,l.shape,e,i,n),v=K.runKernelFunc(function(m,g){var b=m.conv3d(c,l,d);return g([c,l]),b},{x:c,$filter:l},function(m,g){L(Fm(i),function(){return"Error in gradient of conv3D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+i+"'"});var b=g[0],w=g[1];return{x:function(){return yC(b.shape,m,w,e,n)},$filter:function(){return function(_,S,E,C,R){var A=_;_.rank===4&&(A=_.as5D(1,_.shape[0],_.shape[1],_.shape[2],_.shape[3]));var D=S;D.rank===4&&(D=S.as5D(1,S.shape[0],S.shape[1],S.shape[2],S.shape[3])),L(A.rank===5,function(){return"Error in conv3dDerFilter: input must be rank 5, but got shape "+A.shape+"."}),L(D.rank===5,function(){return"Error in conv3dDerFilter: dy must be rank 5, but got shape "+D.shape+"."}),L(E.length===5,function(){return"Error in conv3dDerFilter: filterShape must be length 5, but got "+E+"."}),L(A.shape[4]===E[3],function(){return"Error in conv3dDerFilter: depth of input "+A.shape[4]+") must match input depth in filter ("+E[3]+"."}),L(D.shape[4]===E[4],function(){return"Error in conv3dDerFilter: depth of dy ("+D.shape[4]+") must match output depth for filter ("+E[4]+")."});var k=rd(A.shape,E,C,1,R);return K.runKernelFunc(function(I){return I.conv3dDerFilter(A,D,k)},{x5D:A,dy5D:D})}(b,m,w.shape,e,n)}}});return f?v.as4D(v.shape[1],v.shape[2],v.shape[3],v.shape[4]):v}}),Oy=j({conv2dDerFilter_:function(r,t,e,n,a,i,s){i===void 0&&(i="NHWC");var l=r;r.rank===3&&(l=r.as4D(1,r.shape[0],r.shape[1],r.shape[2]));var c=t;c.rank===3&&(c=t.as4D(1,t.shape[0],t.shape[1],t.shape[2])),L(l.rank===4,function(){return"Error in conv2dDerFilter: input must be rank 4, but got shape "+l.shape+"."}),L(c.rank===4,function(){return"Error in conv2dDerFilter: dy must be rank 4, but got shape "+c.shape+"."}),L(e.length===4,function(){return"Error in conv2dDerFilter: filterShape must be length 4, but got "+e+"."});var f=i==="NHWC"?l.shape[3]:l.shape[1],d=i==="NHWC"?c.shape[3]:c.shape[1];L(f===e[2],function(){return"Error in conv2dDerFilter: depth of input "+f+") must match input depth in filter ("+e[2]+"."}),L(d===e[3],function(){return"Error in conv2dDerFilter: depth of dy ("+d+") must match output depth for filter ("+e[3]+")."}),s!=null&&L(jt(a),function(){return"Error in conv2dDerFilter: pad must be an integer when using, dimRoundingMode "+s+" but got pad "+a+"."});var v=wy(i),m=ts(l.shape,e,n,1,a,s,!1,v);return K.runKernelFunc(function(g){return g.conv2dDerFilter(l,c,m)},{x4D:l,dy4D:c})}}),bC=j({conv2dDerInput_:gC}),Rd=j({depthwiseConv2d_:function(r,t,e,n,a,i,s){i===void 0&&(i=[1,1]);var l=B(r,"x","depthwiseConv2d"),c=B(t,"filter","depthwiseConv2d"),f=l,d=!1;l.rank===3&&(d=!0,f=l.as4D(1,l.shape[0],l.shape[1],l.shape[2])),L(f.rank===4,function(){return"Error in depthwiseConv2d: input must be rank 4, but got rank "+f.rank+"."}),L(c.rank===4,function(){return"Error in depthwiseConv2d: filter must be rank 4, but got rank "+c.rank+"."}),L(f.shape[3]===c.shape[2],function(){return"Error in depthwiseConv2d: number of input channels ("+f.shape[3]+") must match the inChannels dimension in filter "+c.shape[2]+"."}),i==null&&(i=[1,1]),L(Jn(e,i),function(){return"Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides "+e+" and dilations '"+i+"'"}),s!=null&&L(jt(n),function(){return"Error in depthwiseConv2d: pad must be an integer when using, dimRoundingMode "+s+" but got pad "+n+"."});var v=ts(f.shape,c.shape,e,i,n,s,!0),m=[f,c],g=K.runKernelFunc(function(b,w){var _=b.depthwiseConv2D(f,c,v);return w([f,c]),_},{x:f,filter:c},function(b,w){L(Bu(i),function(){return"Error in gradient of depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '"+i+"'"});var _=w[0],S=w[1];return{x:function(){return xC(_.shape,b,S,v)},filter:function(){return wC(_,b,S.shape,v)}}},"DepthwiseConv2dNative",v,m);return d?g.as3D(g.shape[1],g.shape[2],g.shape[3]):g}}),xC=j({depthwiseConv2dDerInput_:function(r,t,e,n){var a=t,i=!1;t.rank===3&&(i=!0,a=t.as4D(1,t.shape[0],t.shape[1],t.shape[2]));var s=K.runKernelFunc(function(l){return l.depthwiseConv2DDerInput(a,e,n)},{dy4D:a});return i?s.as3D(s.shape[1],s.shape[2],s.shape[3]):s}}),wC=j({depthwiseConv2dDerFilter_:function(r,t,e,n){var a=r;r.rank===3&&(a=r.as4D(1,r.shape[0],r.shape[1],r.shape[2]));var i=t;return i.rank===3&&(i=t.as4D(1,t.shape[0],t.shape[1],t.shape[2])),K.runKernelFunc(function(s){return s.depthwiseConv2DDerFilter(a,i,n)},{x4D:a,dy4D:i})}}),Ny=j({separableConv2d_:function(r,t,e,n,a,i,s){i===void 0&&(i=[1,1]),s===void 0&&(s="NHWC");var l=B(r,"x","separableConv2d"),c=B(t,"depthwiseFilter","separableConv2d"),f=B(e,"pointwiseFilter","separableConv2d"),d=l,v=!1;if(l.rank===3&&(v=!0,d=l.as4D(1,l.shape[0],l.shape[1],l.shape[2])),s==="NCHW")throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");L(d.rank===4,function(){return"Error in separableConv2d: input must be rank 4, but got rank "+d.rank+"."}),L(c.rank===4,function(){return"Error in separableConv2d: depthwise filter must be rank 4, but got rank "+c.rank+"."}),L(f.rank===4,function(){return"Error in separableConv2d: pointwise filter must be rank 4, but got rank "+c.rank+"."}),L(f.shape[0]===1,function(){return"Error in separableConv2d: the first dimension of pointwise filter  must be 1, but got "+f.shape[0]+"."}),L(f.shape[1]===1,function(){return"Error in separableConv2d: the second dimension of pointwise filter must be 1, but got "+f.shape[1]+"."});var m=c.shape[2],g=c.shape[3];L(f.shape[2]===m*g,function(){return"Error in separableConv2d: the third dimension of pointwise filter must be "+m*g+", but got "+f.shape[2]+"."});var b=Rd(d,c,n,a,s,i),w=Ir(b,f,1,"valid",s);return v?w.as3D(w.shape[1],w.shape[2],w.shape[3]):w}}),wB=j({conv2dTranspose_:function(r,t,e,n,a,i){return gC(e,B(r,"x","conv2dTranspose"),B(t,"filter","conv2dTranspose"),n,a,"NHWC",i)}}),_B=j({conv3dTranspose_:function(r,t,e,n,a){return yC(e,B(r,"x","conv3dTranspose"),B(t,"filter","conv3dTranspose"),n,a)}}),Ad=j({matMul_:function(r,t,e,n){var a;e===void 0&&(e=!1),n===void 0&&(n=!1);var i=B(r,"a","matMul"),s=B(t,"b","matMul");a=Ft(i,s),i=a[0],s=a[1];var l=e?i.shape[i.rank-2]:i.shape[i.rank-1],c=n?s.shape[s.rank-1]:s.shape[s.rank-2],f=e?i.shape[i.rank-1]:i.shape[i.rank-2],d=n?s.shape[s.rank-2]:s.shape[s.rank-1],v=i.shape.slice(0,-2),m=s.shape.slice(0,-2),g=Ae(v),b=Ae(m);L(i.rank>=2&&s.rank>=2&&i.rank===s.rank,function(){return"Error in matMul: inputs must have the same rank of at least 2, got ranks "+i.rank+" and "+s.rank+"."}),L(vn(v,m),function(){return"Error in matMul: outer dimensions ("+v+") and ("+m+") of Tensors with shapes "+i.shape+" and "+s.shape+" must match."}),L(l===c,function(){return"Error in matMul: inner shapes ("+l+") and ("+c+") of Tensors with shapes "+i.shape+" and "+s.shape+" and transposeA="+e+" and transposeB="+n+" must match."});var w=i.shape.slice(0,-2).concat([f,d]),_=e?i.as3D(g,l,f):i.as3D(g,f,l),S=n?s.as3D(b,d,c):s.as3D(b,c,d),E={transposeA:e,transposeB:n};return K.runKernelFunc(function(C,R){var A=C.batchMatMul(_,S,e,n);return R([_,S]),A},{a:_,b:S},function(C,R){var A=R,D=A[0],k=A[1];return e||n?!e&&n?{a:function(){return C.matMul(k,!1,!1)},b:function(){return C.matMul(D,!0,!1)}}:e&&!n?{a:function(){return k.matMul(C,!1,!0)},b:function(){return D.matMul(C,!1,!1)}}:{a:function(){return k.matMul(C,!0,!0)},b:function(){return C.matMul(D,!0,!0)}}:{a:function(){return C.matMul(k,!1,!0)},b:function(){return D.matMul(C,!0,!1)}}},"BatchMatMul",E).reshape(w)}}),SB=j({dot_:function(r,t){var e=B(r,"t1","dot"),n=B(t,"t2","dot");L(!(e.rank!==1&&e.rank!==2||n.rank!==1&&n.rank!==2),function(){return"Error in dot: inputs must all be rank 1 or 2, but got ranks "+e.rank+" and "+n.rank+"."});var a=e.rank===1?e.size:e.shape[1],i=n.rank===1?n.size:n.shape[0];return L(a===i,function(){return"Error in dot: inner dimensions of inputs must match, but got "+a+" and "+i+"."}),e.rank===1&&n.rank===1?e.as2D(1,-1).matMul(n.as2D(-1,1)).asScalar():e.rank===1&&n.rank===2?e.as2D(1,-1).matMul(n.as2D(n.shape[0],n.shape[1])).as1D():e.rank===2&&n.rank===1?e.matMul(n.as2D(-1,1)).as1D():e.matMul(n.as2D(n.shape[0],n.shape[1]))}}),EB=j({outerProduct_:function(r,t){var e=B(r,"v1","outerProduct"),n=B(t,"v2","outerProduct");return L(e.rank===1&&n.rank===1,function(){return"Error in outerProduct: inputs must be rank 1, but got ranks "+e.rank+" and "+n.rank+"."}),e.as2D(-1,1).matMul(n.as2D(1,-1))}}),Mc=j({reverse_:function(r,t){var e=B(r,"x","reverse");if(e.rank===0)return e.clone();var n=sn(t,e.shape);return K.runKernelFunc(function(a){return a.reverse(e,n)},{$x:e},function(a){return{$x:function(){return a.reverse(n)}}}).reshapeAs(e)}}),CB=j({reverse1d_:function(r){var t=B(r,"x","reverse");return L(t.rank===1,function(){return"Error in reverse1D: x must be rank 1 but got rank "+t.rank+"."}),Mc(t,0)}}),RB=j({reverse2d_:function(r,t){var e=B(r,"x","reverse");return L(e.rank===2,function(){return"Error in reverse2D: x must be rank 2 but got rank "+e.rank+"."}),Mc(e,t)}}),AB=j({reverse3d_:function(r,t){var e=B(r,"x","reverse");return L(e.rank===3,function(){return"Error in reverse3D: x must be rank 3 but got rank "+e.rank+"."}),Mc(e,t)}}),TB=j({reverse4d_:function(r,t){var e=B(r,"x","reverse");return L(e.rank===4,function(){return"Error in reverse4D: x must be rank 4 but got rank "+e.rank+"."}),Mc(e,t)}});function _C(r,t,e,n,a,i){var s=B(r,"x","maxPool"),l=s,c=!1;s.rank===3&&(c=!0,l=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),L(l.rank===4,function(){return"Error in maxPool: input must be rank 4 but got rank "+l.rank+"."}),L(Jn(e,n),function(){return"Error in maxPool: Either strides or dilations must be 1. Got strides "+e+" and dilations '"+n+"'"}),i!=null&&L(jt(a),function(){return"Error in maxPool: pad must be an integer when using, dimRoundingMode "+i+" but got pad "+a+"."});var f=pc(l.shape,t,e,n,a,i);if(f.filterWidth===1&&f.filterHeight===1&&vn(f.inShape,f.outShape))return s.clone();var d=[l],v=K.runKernelFunc(function(m,g){var b=m.maxPool(l,f);return g([l,b]),b},{x:l},function(m,g){var b=g[0],w=g[1];return{x:function(){return function(_,S,E,C,R,A,D,k){var I=B(_,"dy","maxPoolBackprop"),O=B(S,"input","maxPoolBackprop"),M=B(E,"output","maxPoolBackprop");L(O.rank===I.rank,function(){return"Rank of input ("+O.rank+") does not match rank of dy ("+I.rank+")"}),L(Jn(R,A),function(){return"Error in maxPoolBackProp: Either strides or dilations must be 1. Got strides "+R+" and dilations '"+A+"'"}),L(I.rank===4,function(){return"Error in maxPoolBackprop: dy must be rank 4 but got rank "+I.rank+"."}),L(O.rank===4,function(){return"Error in maxPoolBackprop: input must be rank 4 but got rank "+O.rank+"."});var V=pc(O.shape,C,R,A,D,k);return K.runKernelFunc(function(z){return z.maxPoolBackprop(I,O,M,V)},{$dy:I,$input:O})}(m,b,w,t,e,n,a)}}},"MaxPool",f,d);return c?v.as3D(v.shape[1],v.shape[2],v.shape[3]):v}function SC(r,t,e,n,a,i){var s=B(r,"x","avgPool","float32");L(Jn(e,n),function(){return"Error in avgPool: Either strides or dilations must be 1. Got strides "+e+" and dilations '"+n+"'"});var l=s,c=!1;s.rank===3&&(c=!0,l=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),L(l.rank===4,function(){return"Error in avgPool: x must be rank 4 but got rank "+l.rank+"."}),i!=null&&L(jt(a),function(){return"Error in avgPool: pad must be an integer when using, dimRoundingMode "+i+" but got pad "+a+"."});var f=pc(l.shape,t,e,n,a,i);if(f.filterWidth===1&&f.filterHeight===1&&vn(f.inShape,f.outShape))return s.clone();var d=K.runKernelFunc(function(v){return v.avgPool(l,f)},{x:l},function(v){return{x:function(){return function(m,g,b,w,_,S){var E=B(m,"dy","avgPoolBackprop"),C=B(g,"input","avgPoolBackprop");L(C.rank===E.rank,function(){return"Rank of input ("+C.rank+") does not match rank of dy ("+E.rank+")"}),L(Jn(w,_),function(){return"Error in avgPoolBackprop: Either strides or dilations must be 1. Got strides "+w+" and dilations '"+_+"'"});var R=C,A=E,D=!1;C.rank===3&&(D=!0,R=C.as4D(1,C.shape[0],C.shape[1],C.shape[2]),A=E.as4D(1,E.shape[0],E.shape[1],E.shape[2])),L(A.rank===4,function(){return"Error in avgPoolBackprop: dy must be rank 4 but got rank "+A.rank+"."}),L(R.rank===4,function(){return"Error in avgPoolBackprop: input must be rank 4 but got rank "+R.rank+"."});var k=pc(R.shape,b,w,_,S),I=K.runKernelFunc(function(O){return O.avgPoolBackprop(A,R,k)},{dy4D:A,input4D:R});return D?I.as3D(I.shape[1],I.shape[2],I.shape[3]):I}(v,l,t,e,n,a)}}},"AvgPool",f);return d=d.cast(s.dtype),c?d.as3D(d.shape[1],d.shape[2],d.shape[3]):d}var hn=j({maxPool_:function(r,t,e,n,a){return _C(r,t,e,1,n,a)}}),Ic=j({avgPool_:function(r,t,e,n,a){return SC(r,t,e,1,n,a)}}),DB=j({pool_:function(r,t,e,n,a,i){a==null&&(a=[1,1]),i==null&&(i=1),n===0&&(n="valid");var s=B(r,"x","maxPool"),l=s,c=!1;s.rank===3&&(c=!0,l=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),L(Jn(i,a),function(){return"Error in pool: Either strides or dilations must be 1. Got strides "+i+" and dilations '"+a+"'"});var f,d=pc(l.shape,t,i,a,n),v=[d.dilationHeight,d.dilationWidth];f=n==="same"?function(R,A){var D=R.map(function(O,M){return O+(O-1)*(A[M]-1)}).map(function(O){return O-1}),k=D.map(function(O){return Math.floor(O/2)}),I=D.map(function(O,M){return O-k[M]});return D.map(function(O,M){return[k[M],I[M]]})}([d.filterHeight,d.filterWidth],v):[[0,0],[0,0]];var m=v[0]===1&&v[1]===1,g=function(R,A,D){var k=D.map(function(te){return te[0]}),I=D.map(function(te){return te[1]}),O=R.concat(k,I),M=A.map(function(te,ne){return(te-O[ne]%te)%te}),V=I.map(function(te,ne){return te+M[ne]}),z=A.map(function(te,ne){return[k[ne],V[ne]]}),J=A.map(function(te,ne){return[0,M[ne]]});return[z,J]}([d.inHeight,d.inWidth],v,f),b=g[0],w=g[1],_=m?n:"valid",S=m?l:DE(l,v,b),E=(e==="avg"?function(){return SC(S,t,i,1,_)}:function(){return _C(S,t,i,1,_)})(),C=m?E:RE(E,v,w);return c?C.as3D(C.shape[1],C.shape[2],C.shape[3]):C}}),kB=j({maxPool3d_:function(r,t,e,n,a,i,s){i===void 0&&(i="NDHWC");var l=B(r,"x","maxPool3d"),c=l,f=!1;l.rank===4&&(f=!0,c=l.as5D(1,l.shape[0],l.shape[1],l.shape[2],l.shape[3])),s==null&&(s=[1,1,1]),L(c.rank===5,function(){return"Error in maxPool3d: x must be rank 5 but got rank "+c.rank+"."}),L(i==="NDHWC",function(){return"Error in maxPool3d: Only NDHWC is currently supported, but got dataFormat of "+i}),L(Jn(e,s),function(){return"Error in maxPool3d: Either strides or dilations must be 1. Got strides "+e+" and dilations '"+s+"'"}),a!=null&&L(jt(n),function(){return"Error in maxPool3d: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+n+"."});var d=nd(c.shape,t,e,s,n,a,i),v=K.runKernelFunc(function(m,g){var b=m.maxPool3d(c,d);return g([c,b]),b},{x:c},function(m,g){var b=g[0],w=g[1];return{x:function(){return function(_,S,E,C,R,A,D,k){var I=B(_,"dy","maxPool3dBackprop"),O=B(S,"input","maxPool3dBackprop"),M=B(E,"output","maxPool3dBackprop"),V=I,z=O,J=M,te=!1;O.rank===4&&(te=!0,V=I.as5D(1,I.shape[0],I.shape[1],I.shape[2],I.shape[3]),z=O.as5D(1,O.shape[0],O.shape[1],O.shape[2],O.shape[3]),J=M.as5D(1,M.shape[0],M.shape[1],M.shape[2],M.shape[3])),L(V.rank===5,function(){return"Error in maxPool3dBackprop: dy must be rank 5 but got rank "+V.rank+"."}),L(z.rank===5,function(){return"Error in maxPool3dBackprop: input must be rank 5 but got rank "+z.rank+"."}),L(J.rank===5,function(){return"Error in maxPool3dBackprop: output must be rank 5 but got rank "+J.rank+"."}),A==null&&(A=[1,1,1]),L(Jn(R,A),function(){return"Error in maxPool3dBackprop: Either strides or dilations must be 1. Got strides "+R+" and dilations '"+A+"'"}),k!=null&&L(jt(D),function(){return"Error in maxPool3dBackprop: pad must be an integer when using, dimRoundingMode "+k+" but got pad "+D+"."});var ne=nd(z.shape,C,R,A,D,k),P=K.runKernelFunc(function(W){return W.maxPool3dBackprop(V,z,J,ne)},{dy5D:V,input5D:z});return te?P.as4D(P.shape[1],P.shape[2],P.shape[3],P.shape[4]):P}(m,b,w,t,e,s,n,a)}}});return f?v.as4D(v.shape[1],v.shape[2],v.shape[3],v.shape[4]):v}}),OB=j({avgPool3d_:function(r,t,e,n,a,i,s){i===void 0&&(i="NDHWC");var l=B(r,"x","avgPool3d","float32"),c=l,f=!1;l.rank===4&&(f=!0,c=l.as5D(1,l.shape[0],l.shape[1],l.shape[2],l.shape[3])),s==null&&(s=[1,1,1]),L(c.rank===5,function(){return"Error in avgPool3d: x must be rank 5 but got rank "+c.rank+"."}),L(i==="NDHWC",function(){return"Error in avgPool3d: Only NDHWC is currently supported, but got dataFormat of "+i}),L(Jn(e,s),function(){return"Error in avgPool3d: Either strides or dilations must be 1. Got strides "+e+" and dilations '"+s+"'"}),a!=null&&L(jt(n),function(){return"Error in avgPool3d: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+n+"."});var d=nd(c.shape,t,e,s,n,a,i),v=K.runKernelFunc(function(m){return m.avgPool3d(c,d)},{x:c},function(m){return{x:function(){return function(g,b,w,_,S,E,C){var R=B(g,"dy","avgPool3dBackprop"),A=B(b,"input","avgPool3dBackprop"),D=R,k=A,I=!1;A.rank===4&&(I=!0,D=R.as5D(1,R.shape[0],R.shape[1],R.shape[2],R.shape[3]),k=A.as5D(1,A.shape[0],A.shape[1],A.shape[2],A.shape[3])),L(D.rank===5,function(){return"Error in avgPool3dBackprop: dy must be rank 5 but got rank "+D.rank+"."}),L(k.rank===5,function(){return"Error in avgPool3dBackprop: input must be rank 5 but got rank "+k.rank+"."}),S==null&&(S=[1,1,1]),L(Jn(_,S),function(){return"Error in avgPool3dBackprop: Either strides or dilations must be 1. Got strides "+_+" and dilations '"+S+"'"}),C!=null&&L(jt(E),function(){return"Error in maxPool3dBackprop: pad must be an integer when using, dimRoundingMode "+C+" but got pad "+E+"."});var O=nd(k.shape,w,_,S,E,C),M=K.runKernelFunc(function(V){return V.avgPool3dBackprop(D,k,O)},{dy5D:D,input5D:k});return I?M.as4D(M.shape[1],M.shape[2],M.shape[3],M.shape[4]):M}(m,c,t,e,s,n,a)}}});return v=v.cast(c.dtype),f?v.as4D(v.shape[1],v.shape[2],v.shape[3],v.shape[4]):v}}),ya=j({slice_:function(r,t,e){var n,a,i=B(r,"x","slice");if(i.rank===0)throw new Error("Slicing scalar is not possible");(n=typeof t=="number"?[t].concat(new Array(i.rank-1).fill(0)):t.length<i.rank?t.concat(new Array(i.rank-t.length).fill(0)):t.slice()).forEach(function(c){L(c!==-1,function(){return"slice() does not support negative begin indexing."})}),a=(a=e==null?new Array(i.rank).fill(-1):typeof e=="number"?[e].concat(new Array(i.rank-1).fill(-1)):e.length<i.rank?e.concat(new Array(i.rank-e.length).fill(-1)):e).map(function(c,f){return c>=0?c:(L(c===-1,function(){return"Negative size values should be exactly -1 but got "+c+" for the slice() size at index "+f+"."}),i.shape[f]-n[f])}),iM(i,n,a);var s=i.shape,l={begin:n,size:a};return K.runKernelFunc(function(c){return c.slice(i,n,a)},{x:i},function(c){for(var f=[],d=0;d<c.rank;d++)f.push([n[d],s[d]-n[d]-a[d]]);return{x:function(){return c.pad(f)}}},"Slice",l)}}),NB=j({slice1d_:function(r,t,e){var n=B(r,"x","slice1d");return L(n.rank===1,function(){return"slice1d expects a rank-1 tensor, but got a rank-"+n.rank+" tensor"}),ya(n,[t],[e])}}),MB=j({slice2d_:function(r,t,e){var n=B(r,"x","slice2d");return L(n.rank===2,function(){return"slice2d expects a rank-2 tensor, but got a rank-"+n.rank+" tensor"}),ya(n,t,e)}}),EC=j({slice3d_:function(r,t,e){var n=B(r,"x","slice3d");return L(n.rank===3,function(){return"slice3d expects a rank-3 tensor, but got a rank-"+n.rank+" tensor"}),ya(n,t,e)}}),IB=j({slice4d_:function(r,t,e){var n=B(r,"x","slice4d");return L(n.rank===4,function(){return"slice4d expects a rank-4 tensor, but got a rank-"+n.rank+" tensor"}),ya(n,t,e)}});function CC(r,t,e,n,a){return t.rank<e.rank&&(t=t.reshape(Zn(t.shape,n))),r.rank<e.rank&&(r=r.reshape(Zn(r.shape,n))),{x:function(){var i=r.mul(e.equal(t).cast(r.dtype));return a==null?i:i.transpose(a)}}}var FB=j({all_:function(r,t,e){t===void 0&&(t=null),e===void 0&&(e=!1);var n=B(r,"x","all","bool"),a=sn(t,n.shape),i=a,s=_a(i,n.rank);s!=null&&(n=n.transpose(s),i=Sa(i.length,n.rank));var l=K.runKernelFunc(function(f){return f.all(n,i)},{$x:n});if(e){var c=Zn(l.shape,a);return l.reshape(c)}return l}}),BB=j({any_:function(r,t,e){t===void 0&&(t=null),e===void 0&&(e=!1);var n=B(r,"x","any","bool"),a=sn(t,n.shape),i=a,s=_a(i,n.rank);s!=null&&(n=n.transpose(s),i=Sa(i.length,n.rank));var l=K.runKernelFunc(function(f){return f.any(n,i)},{$x:n});if(e){var c=Zn(l.shape,a);return l.reshape(c)}return l}}),LB=j({argMax_:function(r,t){t===void 0&&(t=0);var e=B(r,"x","argMax");t==null&&(t=0);var n=sn(t,e.shape),a=_a(n,e.rank);a!=null&&(e=e.transpose(a),n=Sa(n.length,e.rank));var i={axis:n[0]},s=[e];return K.runKernelFunc(function(l,c){var f=l.argMax(e,n[0]);return c([e]),f},{x:e},function(l,c){var f=c[0];return{x:function(){return st(f)}}},"ArgMax",i,s)}}),PB=j({argMin_:function(r,t){t===void 0&&(t=0);var e=B(r,"x","argMin");t==null&&(t=0);var n=sn(t,e.shape),a=_a(n,e.rank);return a!=null&&(e=e.transpose(a),n=Sa(n.length,e.rank)),K.runKernelFunc(function(i,s){var l=i.argMin(e,n[0]);return s([e]),l},{$x:e},function(i,s){var l=s[0];return{$x:function(){return st(l)}}})}}),zB=j({logSumExp_:function(r,t,e){t===void 0&&(t=null),e===void 0&&(e=!1);var n=B(r,"x","logSumExp"),a=sn(t,n.shape),i=n.max(a,!0),s=n.sub(i).exp().sum(a).log(),l=i.reshape(s.shape).add(s);if(e){var c=Zn(l.shape,a);return l.reshape(c)}return l}}),Td=j({max_:function(r,t,e){t===void 0&&(t=null),e===void 0&&(e=!1);var n=B(r,"x","max"),a=n,i=sn(t,n.shape),s=i,l=_a(s,n.rank);l!=null&&(n=n.transpose(l),s=Sa(s.length,n.rank));var c=[n],f=K.runKernelFunc(function(v,m){var g=v.max(n,s);return m([a,g]),g},{x:n},function(v,m){return CC(v,m[1],m[0],i,l)},"Max",{axes:s},c,[!0]);if(e){var d=Zn(f.shape,i);f=f.reshape(d)}return f}}),UB=j({mean_:function(r,t,e){t===void 0&&(t=null),e===void 0&&(e=!1);var n=B(r,"x","mean"),a=sn(t,n.shape),i=Ae(Dn(n.shape,a)[1]);return Sd(function(s){var l=ye(i);return{value:(l.dtype===s.dtype?s:s.cast(l.dtype)).div(l).sum(t,e),gradFunc:function(c){var f=s.shape.slice();return a.forEach(function(d){f[d]=1}),c.reshape(f).mul(Hu(s.shape,"float32")).div(i)}}})(n)}}),VB=j({min_:function(r,t,e){t===void 0&&(t=null),e===void 0&&(e=!1);var n=B(r,"x","min"),a=n,i=sn(t,n.shape),s=i,l=_a(s,n.rank);l!=null&&(n=n.transpose(l),s=Sa(s.length,n.rank));var c=[n],f=K.runKernelFunc(function(v,m){var g=v.min(n,s);return m([a,g]),g},{x:n},function(v,m){return CC(v,m[1],m[0],i,l)},"Min",{axes:s},c,[!0]);if(e){var d=Zn(f.shape,i);f=f.reshape(d)}return f}}),HB=j({moments_:function(r,t,e){t===void 0&&(t=null),e===void 0&&(e=!1);var n=sn(t,(r=B(r,"x","moments")).shape),a=r.mean(n,e),i=a.shape;e||(i=Zn(a.shape,n));var s=r.toFloat().sub(a.reshape(i)).square();return{mean:a,variance:s.mean(n,e)}}}),RC=j({sum_:function(r,t,e){t===void 0&&(t=null),e===void 0&&(e=!1);var n=B(r,"x","sum");n.dtype==="bool"&&(n=n.toInt());var a=sn(t,n.shape);return Sd(function(i){var s=_a(a,i.rank),l=a,c=i;s!=null&&(c=i.transpose(s),l=Sa(l.length,i.rank));var f=function(g){var b=i.shape.slice();return a.forEach(function(w){b[w]=1}),g.reshape(b).mul(Hu(i.shape,"float32"))},d={axes:l},v=K.runKernelFunc(function(g){return g.sum(c,l)},{x:c},function(g){return{x:function(){return f(g)}}},"Sum",d);if(e){var m=Zn(v.shape,a);v=v.reshape(m)}return{value:v,gradFunc:f}})(n)}}),jB=j({prod_:function(r,t,e){t===void 0&&(t=null),e===void 0&&(e=!1);var n=B(r,"x","prod");n.dtype==="bool"&&(n=n.toInt());var a=sn(t,n.shape),i=_a(a,n.rank),s=a,l=n;i!=null&&(l=n.transpose(i),s=Sa(s.length,n.rank));var c=K.runKernelFunc(function(d){return d.prod(l,s)},{permutedX:l});if(e){var f=Zn(c.shape,a);c=c.reshape(f)}return c}}),AC=j({elu_:function(r){var t=B(r,"x","elu");return K.runKernelFunc(function(e,n){var a=e.elu(t);return n([a]),a},{$x:t},function(e,n){var a=n[0];return{$x:function(){return K.runKernelFunc(function(i){return i.eluDer(e,a)},{dy:e,y:a})}}})}}),WB=j({leakyRelu_:function(r,t){t===void 0&&(t=.2);var e=B(r,"x","leakyRelu");return Dy(ye(t).mul(e),e)}}),TC=j({prelu_:function(r,t){var e=B(r,"x","prelu"),n=B(t,"alpha","prelu");return K.runKernelFunc(function(a,i){var s=a.prelu(e,n);return i([e,n]),s},{x:e,alpha:n},function(a,i){var s=i[0],l=i[1],c=s.greater(0);return{x:function(){return Zo(c,a,a.mul(l))},alpha:function(){var f=Zo(c,st(a),a.mul(s)),d=an(l.shape,a.shape);return d.length>0&&(f=f.sum(d)),f.reshape(l.shape)}}},"Prelu")}}),Mt=j({relu_:function(r){var t=B(r,"x","relu");return t.dtype==="bool"?t.toInt():K.runKernelFunc(function(e,n){var a=e.relu(t);return n([t]),a},{x:t},function(e,n){var a=n[0];return{x:function(){return e.mulStrict(a.step().toFloat())}}},"Relu")}}),DC=j({relu6_:function(r){var t=B(r,"x","relu6");return t.dtype==="bool"?t.toInt():K.runKernelFunc(function(e,n){var a=e.relu6(t);return n([t]),a},{x:t},function(e,n){var a=n[0],i=a.lessEqual(6).mul(a.step());return{x:function(){return e.mulStrict(i.toFloat())}}},"Relu6")}}),GB=j({selu_:function(r){var t=B(r,"x","selu");return K.runKernelFunc(function(e,n){var a=e.selu(t);return n([t]),a},{$x:t},function(e,n){var a=n[0];return{$x:function(){var i=a.greater(ye(0)),s=ye(Ry),l=ye(Ay),c=e.mul(l),f=e.mul(s).mul(a.toFloat().exp());return Zo(i,c,f)}}})}}),oo=j({transpose_:function(r,t){var e=B(r,"x","transpose");if(t==null&&(t=e.shape.map(function(a,i){return i}).reverse()),L(e.rank===t.length,function(){return"Error in transpose: rank of input "+e.rank+" must match length of perm "+t+"."}),t.forEach(function(a){L(a>=0&&a<e.rank,function(){return"All entries in 'perm' must be between 0 and "+(e.rank-1)+" but got "+t})}),e.rank<=1)return e.clone();var n={perm:t};return K.runKernelFunc(function(a){return a.transpose(e,t)},{x:e},function(a){var i=my(t);return{x:function(){return a.transpose(i)}}},"Transpose",n)}}),qB=j({localResponseNormalization_:function(r,t,e,n,a){t===void 0&&(t=5),e===void 0&&(e=1),n===void 0&&(n=1),a===void 0&&(a=.5);var i=B(r,"x","localResponseNormalization");L(i.rank===4||i.rank===3,function(){return`Error in localResponseNormalization: x must be rank 3 or 4 but got
               rank `+i.rank+"."}),L(jt(t),function(){return"Error in localResponseNormalization: depthRadius must be an integer but got depthRadius "+t+"."});var s=i,l=!1;i.rank===3&&(l=!0,s=i.as4D(1,i.shape[0],i.shape[1],i.shape[2]));var c=K.runKernelFunc(function(f,d){var v=f.localResponseNormalization4D(s,t,e,n,a);return d([s,v]),v},{x4D:s},function(f,d){var v=d[0],m=d[1];return{x4D:function(){return K.runKernelFunc(function(g){return g.LRNGrad(f,v,m,t,e,n,a)},{})}}});return l?c.as3D(c.shape[1],c.shape[2],c.shape[3]):c}}),kC=j({norm_:function(r,t,e,n){t===void 0&&(t="euclidean"),e===void 0&&(e=null),n===void 0&&(n=!1);var a=function l(c,f,d){if(d===void 0&&(d=null),c.rank===0)return c.abs();if(c.rank!==1&&d===null)return l(c.reshape([-1]),f,d);if(c.rank===1||typeof d=="number"||Array.isArray(d)&&d.length===1){if(f===1)return c.abs().sum(d);if(f===1/0)return c.abs().max(d);if(f===-1/0)return c.abs().min(d);if(f==="euclidean"||f===2)return c.abs().pow(ye(2,"int32")).sum(d).sqrt();throw new Error("Error in norm: invalid ord value: "+f)}if(Array.isArray(d)&&d.length===2){if(f===1)return c.abs().sum(d[0]).max(d[1]-1);if(f===1/0)return c.abs().sum(d[1]).max(d[0]);if(f===-1/0)return c.abs().sum(d[1]).min(d[0]);if(f==="fro"||f==="euclidean")return c.square().sum(d).sqrt();throw new Error("Error in norm: invalid ord value: "+f)}throw new Error("Error in norm: invalid axis: "+d)}(r=B(r,"x","norm"),t,e),i=a.shape;if(n){var s=sn(e,r.shape);i=Zn(a.shape,s)}return a.reshape(i)}}),KB=j({basicLSTMCell_:function(r,t,e,n,a,i){var s=B(r,"forgetBias","basicLSTMCell"),l=B(t,"lstmKernel","basicLSTMCell"),c=B(e,"lstmBias","basicLSTMCell"),f=B(n,"data","basicLSTMCell"),d=B(a,"c","basicLSTMCell"),v=B(i,"h","basicLSTMCell"),m=f.concat(v,1).matMul(l).add(c),g=m.shape[0],b=m.shape[1]/4,w=[g,b],_=m.slice([0,0],w),S=m.slice([0,b],w),E=m.slice([0,2*b],w),C=m.slice([0,3*b],w),R=_.sigmoid().mulStrict(S.tanh()).addStrict(d.mulStrict(s.add(E).sigmoid())),A=R.tanh().mulStrict(C.sigmoid());return[R,A]}}),XB=j({multiRNNCell_:function(r,t,e,n){for(var a=B(t,"data","multiRNNCell"),i=Yh(e,"c","multiRNNCell"),s=Yh(n,"h","multiRNNCell"),l=a,c=[],f=0;f<r.length;f++){var d=r[f](l,i[f],s[f]);c.push(d[0]),c.push(d[1]),l=d[1]}var v=[],m=[];for(f=0;f<c.length;f+=2)v.push(c[f]),m.push(c[f+1]);return[v,m]}}),$B=j({movingAverage_:function(r,t,e,n,a){a===void 0&&(a=!0);var i=B(r,"v","movingAverage"),s=B(t,"x","movingAverage"),l=B(e,"decay","movingAverage");q3(i,s),L(vn(i.shape,s.shape),function(){return"Shape mismatch in v and x"});var c=ye(1),f=c.sub(l),d=s.sub(i).mul(f);if(a){L(n!=null,function(){return"When using zeroDebias: true, step is required."});var v=B(n,"step","movingAverage");d=d.div(c.sub(od(l,v)))}return i.add(d)}}),YB=j({stridedSlice_:function(r,t,e,n,a,i,s,l,c){if(a===void 0&&(a=0),i===void 0&&(i=0),s===void 0&&(s=0),l===void 0&&(l=0),c===void 0&&(c=0),n==null&&(n=new Array(t.length)),s!==0)throw new Error("ellipsis mask is not yet supported");var f=B(r,"x","stridedSlice"),d=q2(l),v=f.shape.slice();d.forEach(function(_){t[_]=0,e[_]=1,v.splice(_,0,1)}),f=f.reshape(v);for(var m=0;m<f.rank;m++)t[m]=oM(a,t,n,f.shape,m),e[m]=sM(i,e,n,f.shape,m),n[m]=n[m]||1;var g=q2(c);g.forEach(function(_){e[_]=t[_]+1,n[_]=1});var b=xy(t,e,n),w=b.filter(function(_,S){return g.indexOf(S)===-1});return n.every(function(_){return _===1})?ya(f,t,b).reshape(w):K.runKernelFunc(function(_){return _.stridedSlice(f,t,e,n)},{$x:f}).reshape(w)}}),QB=j({topk_:function(r,t,e){t===void 0&&(t=1),e===void 0&&(e=!0);var n=B(r,"x","topk");if(n.rank===0)throw new Error("topk() expects the input to be of rank 1 or higher");var a=n.shape[n.shape.length-1];if(t>a)throw new Error("'k' passed to topk() must be <= the last dimension ("+a+") but got "+t);var i=K.runKernelFunc(function(s){return s.topk(n,t,e)},{$x:n});return{values:i[0],indices:i[1]}}}),ZB=j({scatterND_:function(r,t,e){var n=B(r,"indices","scatterND","int32"),a=B(t,"updates","scatterND");return aM(a,n,e),K.runKernelFunc(function(i){return i.scatterND(n,a,e)},{indices:n,updates:a},null,"ScatterNd",{shape:e})}}),My=j({fft_:function(r){L(r.dtype==="complex64",function(){return"The dtype for tf.spectral.fft() must be complex64 but got "+r.dtype+"."});var t=r.shape[r.shape.length-1],e=r.size/t,n=r.as2D(e,t);return K.runKernelFunc(function(a){return a.fft(n)},{input:r}).reshape(r.shape)}}),sd=j({ifft_:function(r){L(r.dtype==="complex64",function(){return"The dtype for tf.spectral.ifft() must be complex64 but got "+r.dtype+"."});var t=r.shape[r.shape.length-1],e=r.size/t,n=r.as2D(e,t);return K.runKernelFunc(function(a){return a.ifft(n)},{input:r}).reshape(r.shape)}}),Iy=j({rfft_:function(r,t){L(r.dtype==="float32",function(){return"The dtype for rfft() must be real value but got "+r.dtype});var e,n=r.shape[r.shape.length-1],a=r.size/n;if(t!=null&&t<n){var i=r.shape.map(function(S){return 0}),s=r.shape.map(function(S){return S});s[r.shape.length-1]=t,e=r.slice(i,s),n=t}else if(t!=null&&t>n){var l=r.shape.map(function(S){return S});l[r.shape.length-1]=t-n,e=r.concat(Dt(l),r.shape.length-1),n=t}else e=r;var c=e.zerosLike(),f=wn(e,c).as2D(a,n),d=My(f),v=Math.floor(n/2)+1,m=Dr(d),g=fa(d),b=m.split([v,n-v],m.shape.length-1),w=g.split([v,n-v],g.shape.length-1),_=e.shape.slice();return _[e.shape.length-1]=v,wn(b[0],w[0]).reshape(_)}}),OC=j({irfft_:function(r){var t=r.shape[r.shape.length-1],e=r.size/t;if(t<=2){var n=r.as2D(e,t),a=sd(n);return Dr(a)}var i=[e,2*(t-1)],s=Dr(r).as2D(e,t),l=fa(r).as2D(e,t),c=s.slice([0,1],[e,t-2]).reverse(1),f=l.slice([0,1],[e,t-2]).reverse(1).mul(ye(-1)),d=s.concat(c,1),v=l.concat(f,1);return n=wn(d,v).as2D(i[0],i[1]),a=sd(n),Dr(a)}}),JB=Object.freeze({fft:My,ifft:sd,rfft:Iy,irfft:OC}),eL=j({sparseToDense_:function(r,t,e,n){n===void 0&&(n=0);var a=B(r,"sparseIndices","sparseToDense","int32"),i=B(t,"sparseValues","sparseToDense"),s=B(n,"defaultValue","sparseToDense",i.dtype);return function(l,c,f,d){if(l.dtype!=="int32")throw new Error("tf.sparseToDense() expects the indices to be int32 type, but the dtype was "+l.dtype+".");if(l.rank>2)throw new Error("sparseIndices should be a scalar, vector, or matrix, but got shape "+l.shape+".");var v=l.rank>0?l.shape[0]:1,m=l.rank>1?l.shape[1]:1;if(f.length!==m)throw new Error("outputShape has incorrect number of elements:, "+f.length+", should be: "+m+".");var g=c.size;if(c.rank!==0&&(c.rank!==1||g!==v))throw new Error("sparseValues has incorrect shape "+c.shape+", should be [] or ["+v+"]");if(c.dtype!==d.dtype)throw new Error("sparseValues.dtype must match defaultValues.dtype")}(a,i,e,s),K.runKernelFunc(function(l){return l.sparseToDense(a,i,e,s)},{$sparseIndices:a,$sparseValues:i,$defaultValue:s})}}),tL=j({gatherND_:function(r,t){var e=B(t,"indices","gatherND","int32"),n=B(r,"x","gatherND");return K.runKernelFunc(function(a){return a.gatherND(n,e)},{x:n,indices:e},null,"GatherNd")}}),nL=j({diag_:function(r){var t=B(r,"x","diag").flatten(),e=r.shape.concat(r.shape);return K.runKernelFunc(function(n){return n.diag(t)},{$x:t}).reshape(e)}}),rL=j({dropout_:function(r,t,e,n){var a=B(r,"x","dropout");if(L(a.dtype==="float32",function(){return"x has to be a floating point tensor since it's going to be scaled, but got a "+a.dtype+" tensor instead."}),L(t>=0&&t<1,function(){return"rate must be a float in the range [0, 1), but got "+t+"."}),t===0)return r instanceof Nt?a.clone():a;var i=function(c,f){if(f==null)return c.shape.slice();if(vn(c.shape,f))return f;if(c.shape.length===f.length){for(var d=[],v=0;v<c.shape.length;v++)f[v]==null&&c.shape[v]!=null?d.push(c.shape[v]):d.push(f[v]);return d}return f}(a,e),s=1-t,l=TE(i,0,1,"float32",n).add(s).floor().div(s);return a.mul(l)}});function NC(r,t,e){for(var n=1-r%2,a=new Float32Array(r),i=0;i<r;++i){var s=2*Math.PI*i/(r+n-1);a[i]=t-e*Math.cos(s)}return Xt(a,"float32")}var Fy=j({hannWindow_:function(r){return NC(r,.5,.5)}}),MC=j({hammingWindow_:function(r){return NC(r,.54,.46)}}),By=j({frame_:function(r,t,e,n,a){n===void 0&&(n=!1),a===void 0&&(a=0);for(var i=0,s=[];i+t<=r.size;)s.push(ya(r,i,t)),i+=e;if(n)for(;i<r.size;){var l=i+t-r.size,c=nn([ya(r,i,t-l),ga([l],a)]);s.push(c),i+=e}return s.length===0?eo([],[0,t]):nn(s).as2D(s.length,t)}}),IC=j({stft_:function(r,t,e,n,a){var i;a===void 0&&(a=Fy),n==null&&(i=t,n=Math.floor(Math.pow(2,Math.ceil(Math.log(i)/Math.log(2)))));for(var s=By(r,t,e),l=Mn(s,a(t)),c=[],f=0;f<s.shape[0];f++)c.push(Iy(l.slice([f,0],[1,t]),n));return nn(c)}}),aL=Object.freeze({hannWindow:Fy,hammingWindow:MC,frame:By,stft:IC}),Nn,iL=function(r,t,e){return e===void 0&&(e=1),Ee(this,void 0,void 0,function(){var n,a,i,s,l,c,f,d,v,m,g,b,w,_;return Ce(this,function(S){switch(S.label){case 0:return n=B(r,"predictions","inTopK"),a=B(t,"targets","inTopK"),L(n.rank>1,function(){return"inTopK() expects the predictions to be of rank 2 or higher, but got "+n.rank}),L(n.rank-1===a.rank,function(){return"predictions rank should be 1 larger than targets rank, but got predictions rank "+n.rank+" and targets rank "+a.rank}),gt(n.shape.slice(0,n.shape.length-1),a.shape,"predictions's shape should be align with the targets' shape, except the last dimension."),i=n.shape[n.shape.length-1],L(e>0&&e<=i,function(){return"'k' passed to inTopK() must be > 0 && <= the predictions last dimension ("+i+"), but got "+e}),[4,n.data()];case 1:return s=S.sent(),[4,a.data()];case 2:for(l=S.sent(),c=[s.length/i,i],d=c[1],v=fc("bool",f=c[0]),m=0;m<f;m++){for(g=m*d,b=s.subarray(g,g+d),w=[],_=0;_<b.length;_++)w.push({value:b[_],index:_});for(w.sort(function(E,C){return C.value-E.value}),v[m]=0,_=0;_<e;_++)if(w[_].index===l[m]){v[m]=1;break}}return r!==n&&n.dispose(),t!==a&&a.dispose(),[2,Sn(v,a.shape,"bool")]}})})};(function(r){r[r.NONE=0]="NONE",r[r.MEAN=1]="MEAN",r[r.SUM=2]="SUM",r[r.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"})(Nn||(Nn={}));var oL=j({absoluteDifference_:function(r,t,e,n){n===void 0&&(n=Nn.SUM_BY_NONZERO_WEIGHTS);var a=B(r,"labels","absoluteDifference"),i=B(t,"predictions","absoluteDifference"),s=null;e!=null&&(s=B(e,"weights","absoluteDifference")),gt(a.shape,i.shape,"Error in absoluteDifference: ");var l=a.sub(i).abs();return ni(l,s,n)}}),ni=j({computeWeightedLoss_:function(r,t,e){e===void 0&&(e=Nn.SUM_BY_NONZERO_WEIGHTS);var n=B(r,"losses","computeWeightedLoss"),a=null;t!=null&&(a=B(t,"weights","computeWeightedLoss"));var i=a==null?n:n.mul(a);if(e===Nn.NONE)return i;if(e===Nn.SUM)return i.sum();if(e===Nn.MEAN){if(a==null)return i.mean();var s=n.size/a.size,l=i.sum().div(a.sum());return s>1?l.div(ye(s)):l}if(e===Nn.SUM_BY_NONZERO_WEIGHTS){if(a==null)return i.sum().div(ye(n.size));var c=a.mul(Hu(n.shape)).notEqual(ye(0)).sum().toFloat();return i.sum().div(c)}throw Error("Unknown reduction: "+e)}}),sL=j({cosineDistance_:function(r,t,e,n,a){a===void 0&&(a=Nn.SUM_BY_NONZERO_WEIGHTS);var i=B(r,"labels","cosineDistance"),s=B(t,"predictions","cosineDistance"),l=null;n!=null&&(l=B(n,"weights","cosineDistance")),gt(i.shape,s.shape,"Error in cosineDistance: ");var c=ye(1).sub(i.mul(s).sum(e,!0));return ni(c,l,a)}}),uL=j({hingeLoss_:function(r,t,e,n){n===void 0&&(n=Nn.SUM_BY_NONZERO_WEIGHTS);var a=B(r,"labels","hingeLoss"),i=B(t,"predictions","hingeLoss"),s=null;e!=null&&(s=B(e,"weights","hingeLoss")),gt(a.shape,i.shape,"Error in hingeLoss: ");var l=ye(1);a=ye(2).mul(a).sub(l);var c=l.sub(a.mul(i)).relu();return ni(c,s,n)}}),lL=j({huberLoss_:function(r,t,e,n,a){n===void 0&&(n=1),a===void 0&&(a=Nn.SUM_BY_NONZERO_WEIGHTS);var i=B(r,"labels","huberLoss"),s=B(t,"predictions","huberLoss"),l=null;e!=null&&(l=B(e,"weights","huberLoss")),gt(i.shape,s.shape,"Error in huberLoss: ");var c=ye(n),f=s.sub(i).abs(),d=dC(f,c),v=f.sub(d),m=ye(.5).mul(d.square()).add(c.mul(v));return ni(m,l,a)}}),cL=j({logLoss_:function(r,t,e,n,a){n===void 0&&(n=1e-7),a===void 0&&(a=Nn.SUM_BY_NONZERO_WEIGHTS);var i=B(r,"labels","logLoss"),s=B(t,"predictions","logLoss"),l=null;e!=null&&(l=B(e,"weights","logLoss")),gt(i.shape,s.shape,"Error in logLoss: ");var c=ye(1),f=ye(n),d=i.mul(s.add(f).log()).neg().sub(c.sub(i).mul(c.sub(s).add(f).log()));return ni(d,l,a)}}),fL=j({meanSquaredError_:function(r,t,e,n){n===void 0&&(n=Nn.SUM_BY_NONZERO_WEIGHTS);var a=B(r,"labels","meanSquaredError"),i=B(t,"predictions","meanSquaredError"),s=null;e!=null&&(s=B(e,"weights","meanSquaredError")),gt(a.shape,i.shape,"Error in meanSquaredError: ");var l=a.squaredDifference(i);return ni(l,s,n)}}),hL=j({sigmoidCrossEntropy_:function(r,t,e,n,a){n===void 0&&(n=0),a===void 0&&(a=Nn.SUM_BY_NONZERO_WEIGHTS);var i=B(r,"multiClassLabels","sigmoidCrossEntropy"),s=B(t,"logits","sigmoidCrossEntropy"),l=null;if(e!=null&&(l=B(e,"weights","sigmoidCrossEntropy")),gt(i.shape,s.shape,"Error in sigmoidCrossEntropy: "),n>0){var c=ye(n),f=ye(1),d=ye(.5);i=i.mul(f.sub(c)).add(d.mul(c))}var v=function(m,g){var b=B(m,"labels","sigmoidCrossEntropyWithLogits"),w=B(g,"logits","sigmoidCrossEntropyWithLogits");gt(b.shape,w.shape,"Error in sigmoidCrossEntropyWithLogits: ");var _=w.relu(),S=w.mul(b),E=w.abs().neg().exp().log1p();return _.sub(S).add(E)}(i,s);return ni(v,l,a)}}),dL=j({softmaxCrossEntropy_:function(r,t,e,n,a){n===void 0&&(n=0),a===void 0&&(a=Nn.SUM_BY_NONZERO_WEIGHTS);var i=B(r,"onehotLabels","softmaxCrossEntropy"),s=B(t,"logits","softmaxCrossEntropy"),l=null;if(e!=null&&(l=B(e,"weights","softmaxCrossEntropy")),gt(i.shape,s.shape,"Error in softmaxCrossEntropy: "),n>0){var c=ye(n),f=ye(1),d=ye(i.shape[1]);i=i.mul(f.sub(c)).add(c.div(d))}var v=function(m,g,b){if(b===void 0&&(b=-1),b===-1&&(b=g.rank-1),b!==g.rank-1)throw Error("Softmax cross entropy along a non-last dimension is not yet supported. Labels / logits was rank "+g.rank+" and dim was "+b);return Sd(function(w,_,S){var E=_.logSumExp([b],!0),C=_.toFloat().sub(E);return S([w,C]),{value:C.mul(w).neg().sum([b]),gradFunc:function(R,A){var D=A[0],k=A[1],I=Zn(R.shape,[b]);return[R.reshape(I).mul(D.toFloat().sub(k.exp())),R.reshape(I).mul(k.exp().sub(D.toFloat()))]}}})(m,g)}(i,s);return ni(v,l,a)}}),pL=Object.freeze({get Reduction(){return Nn},absoluteDifference:oL,computeWeightedLoss:ni,cosineDistance:sL,hingeLoss:uL,huberLoss:lL,logLoss:cL,meanSquaredError:fL,sigmoidCrossEntropy:hL,softmaxCrossEntropy:dL});function p_(r,t){return t===void 0&&(t=!1),K.tidy(function(){if(r.shape.length!==2)throw new Error("qr2d() requires a 2D Tensor, but got a "+r.shape.length+"D Tensor.");for(var e=r.shape[0],n=r.shape[1],a=AE(e),i=r.clone(),s=eo([[1]],[1,1]),l=s.clone(),c=e>=n?n:e,f=function(v){var m,g=i,b=l,w=a;m=K.tidy(function(){var _=i.slice([v,v],[e-v,1]),S=_.norm(),E=i.slice([v,v],[1,1]),C=eo([[-1]]).where(E.greater(0),eo([[1]])),R=E.sub(C.mul(S)),A=_.div(R);l=A.shape[0]===1?s.clone():s.concat(A.slice([1,0],[A.shape[0]-1,A.shape[1]]),0);var D=C.matMul(R).div(S).neg(),k=i.slice([v,0],[e-v,n]),I=D.mul(l);if(v===0)i=k.sub(I.matMul(l.transpose().matMul(k)));else{var O=k.sub(I.matMul(l.transpose().matMul(k)));i=i.slice([0,0],[v,n]).concat(O,0)}var M=a.slice([0,v],[e,a.shape[1]-v]);if(v===0)a=M.sub(M.matMul(l).matMul(I.transpose()));else{var V=M.sub(M.matMul(l).matMul(I.transpose()));a=a.slice([0,0],[e,v]).concat(V,1)}return[l,i,a]}),l=m[0],i=m[1],a=m[2],Qn([g,b,w])},d=0;d<c;++d)f(d);return!t&&e>n&&(a=a.slice([0,0],[e,n]),i=i.slice([0,0],[n,n])),[a,i]})}var vL=j({bandPart_:function(r,t,e){if(t%1!=0)throw new Error("bandPart(): numLower must be an integer, got "+t+".");if(e%1!=0)throw new Error("bandPart(): numUpper must be an integer, got "+e+".");var n=B(r,"a","bandPart");if(n.rank<2)throw new Error("bandPart(): Rank must be at least 2, got "+n.rank+".");var a=n.shape,i=n.shape.slice(-2),s=i[0],l=i[1];if(!(t<=s))throw new Error("bandPart(): numLower ("+t+") must not be greater than the number of rows ("+s+").");if(!(e<=l))throw new Error("bandPart(): numUpper ("+e+") must not be greater than the number of columns ("+l+").");t<0&&(t=s),e<0&&(e=l);var c=Qh(0,s,1,"int32").reshape([-1,1]),f=Qh(0,l,1,"int32"),d=on(c,f),v=Cd(d.lessEqual(ye(+t,"int32")),d.greaterEqual(ye(-e,"int32"))),m=Dt([s,l],n.dtype);return dr(rn(n.reshape([-1,s,l])).map(function(g){return Zo(v,g,m)})).reshape(a)}}),mL=j({gramSchmidt_:function(r){var t;if(Array.isArray(r)){t=!1,L(r!=null&&r.length>0,function(){return"Gram-Schmidt process: input must not be null, undefined, or empty"});for(var e=r[0].shape[0],n=function(c){L(r[c].shape[0]===e,function(){return"Gram-Schmidt: Non-unique lengths found in the input vectors: ("+r[c].shape[0]+" vs. "+e+")"})},a=1;a<r.length;++a)n(a)}else t=!0,r=yy(r,r.shape[0],0).map(function(c){return kE(c,[0])});L(r.length<=r[0].shape[0],function(){return"Gram-Schmidt: Number of vectors ("+r.length+") exceeds number of dimensions ("+r[0].shape[0]+")."});var i=[],s=r,l=function(c){i.push(K.tidy(function(){var f=s[c];if(c>0)for(var d=0;d<c;++d){var v=RC(i[d].mulStrict(f)).mul(i[d]);f=f.sub(v)}return f.div(kC(f,"euclidean"))}))};for(a=0;a<r.length;++a)l(a);return t?dr(i,0):i}}),gL=j({qr_:function(r,t){if(t===void 0&&(t=!1),r.rank<2)throw new Error("qr() requires input tensor to have a rank >= 2, but got rank "+r.rank);if(r.rank===2)return p_(r,t);var e=r.shape.slice(0,r.shape.length-2).reduce(function(s,l){return s*l}),n=rn(r.reshape([e,r.shape[r.shape.length-2],r.shape[r.shape.length-1]]),0),a=[],i=[];return n.forEach(function(s){var l=p_(s,t),c=l[0],f=l[1];a.push(c),i.push(f)}),[dr(a,0).reshape(r.shape),dr(i,0).reshape(r.shape)]}}),yL=Object.freeze({bandPart:vL,gramSchmidt:mL,qr:gL});function Dd(r,t,e,n,a,i){n==null&&(n=.5),a==null&&(a=Number.NEGATIVE_INFINITY),i==null&&(i=0);var s=r.shape[0];return e=Math.min(e,s),L(0<=n&&n<=1,function(){return"iouThreshold must be in [0, 1], but was '"+n+"'"}),L(r.rank===2,function(){return"boxes must be a 2D tensor, but was of rank '"+r.rank+"'"}),L(r.shape[1]===4,function(){return"boxes must have 4 columns, but 2nd dimension was "+r.shape[1]}),L(t.rank===1,function(){return"scores must be a 1D tensor"}),L(t.shape[0]===s,function(){return"scores has incompatible shape with boxes. Expected "+s+", but was "+t.shape[0]}),L(0<=i&&i<=1,function(){return"softNmsSigma must be in [0, 1], but was '"+i+"'"}),{maxOutputSize:e,iouThreshold:n,scoreThreshold:a,softNmsSigma:i}}var bL=j({resizeBilinear_:function(r,t,e){e===void 0&&(e=!1);var n=B(r,"images","resizeBilinear");L(n.rank===3||n.rank===4,function(){return"Error in resizeBilinear: x must be rank 3 or 4, but got rank "+n.rank+"."}),L(t.length===2,function(){return"Error in resizeBilinear: new shape must 2D, but got shape "+t+"."});var a=n,i=!1;n.rank===3&&(i=!0,a=n.as4D(1,n.shape[0],n.shape[1],n.shape[2]));var s=t[0],l=t[1],c=K.runKernelFunc(function(f,d){return d([a]),f.resizeBilinear(a,s,l,e)},{x:a},function(f,d){return{x:function(){return K.runKernelFunc(function(v){return v.resizeBilinearBackprop(f,d[0],e)},{})}}},"ResizeBilinear",{alignCorners:e,newHeight:s,newWidth:l});return i?c.as3D(c.shape[1],c.shape[2],c.shape[3]):c}}),xL=j({resizeNearestNeighbor_:function(r,t,e){e===void 0&&(e=!1);var n=B(r,"images","resizeNearestNeighbor");L(n.rank===3||n.rank===4,function(){return"Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank "+n.rank+"."}),L(t.length===2,function(){return"Error in resizeNearestNeighbor: new shape must 2D, but got shape "+t+"."}),L(n.dtype==="float32"||n.dtype==="int32",function(){return"`images` must have `int32` or `float32` as dtype"});var a=n,i=!1;n.rank===3&&(i=!0,a=n.as4D(1,n.shape[0],n.shape[1],n.shape[2]));var s=t[0],l=t[1],c=K.runKernelFunc(function(f,d){return d([a]),f.resizeNearestNeighbor(a,s,l,e)},{batchImages:a},function(f,d){return{batchImages:function(){return K.runKernelFunc(function(v){return v.resizeNearestNeighborBackprop(f,d[0],e)},{})}}});return i?c.as3D(c.shape[1],c.shape[2],c.shape[3]):c}}),wL=j({nonMaxSuppression_:function(r,t,e,n,a){n===void 0&&(n=.5),a===void 0&&(a=Number.NEGATIVE_INFINITY);var i=B(r,"boxes","nonMaxSuppression"),s=B(t,"scores","nonMaxSuppression"),l=Dd(i,s,e,n,a);e=l.maxOutputSize,n=l.iouThreshold,a=l.scoreThreshold;var c={maxOutputSize:e,iouThreshold:n,scoreThreshold:a};return K.runKernelFunc(function(f){return f.nonMaxSuppression(i,s,e,n,a)},{boxes:i,scores:s},null,"NonMaxSuppressionV3",c)}}),_L=function(r,t,e,n,a){return n===void 0&&(n=.5),a===void 0&&(a=Number.NEGATIVE_INFINITY),Ee(this,void 0,void 0,function(){var i,s,l,c,f,d,v;return Ce(this,function(m){switch(m.label){case 0:return i=B(r,"boxes","nonMaxSuppressionAsync"),s=B(t,"scores","nonMaxSuppressionAsync"),l=Dd(i,s,e,n,a),e=l.maxOutputSize,n=l.iouThreshold,a=l.scoreThreshold,[4,Promise.all([i.data(),s.data()])];case 1:return c=m.sent(),f=c[0],d=c[1],v=_y(f,d,e,n,a),i!==r&&i.dispose(),s!==t&&s.dispose(),[2,v]}})})},SL=j({nonMaxSuppressionWithScore_:function(r,t,e,n,a,i){n===void 0&&(n=.5),a===void 0&&(a=Number.NEGATIVE_INFINITY),i===void 0&&(i=0);var s=B(r,"boxes","nonMaxSuppression"),l=B(t,"scores","nonMaxSuppression"),c=Dd(s,l,e,n,a,i),f={maxOutputSize:e=c.maxOutputSize,iouThreshold:n=c.iouThreshold,scoreThreshold:a=c.scoreThreshold,softNmsSigma:i=c.softNmsSigma},d=K.runKernel("NonMaxSuppressionV5",{boxes:s,scores:l},f);return{selectedIndices:d[0],selectedScores:d[1]}}}),EL=function(r,t,e,n,a,i){return n===void 0&&(n=.5),a===void 0&&(a=Number.NEGATIVE_INFINITY),i===void 0&&(i=0),Ee(this,void 0,void 0,function(){var s,l,c,f,d,v,m;return Ce(this,function(g){switch(g.label){case 0:return s=B(r,"boxes","nonMaxSuppressionAsync"),l=B(t,"scores","nonMaxSuppressionAsync"),c=Dd(s,l,e,n,a,i),e=c.maxOutputSize,n=c.iouThreshold,a=c.scoreThreshold,i=c.softNmsSigma,[4,Promise.all([s.data(),l.data()])];case 1:return f=g.sent(),d=f[0],v=f[1],m=Sy(d,v,e,n,a,i),s!==r&&s.dispose(),l!==t&&l.dispose(),[2,m]}})})},CL=j({cropAndResize_:function(r,t,e,n,a,i){var s=B(r,"image","cropAndResize"),l=B(t,"boxes","cropAndResize","float32"),c=B(e,"boxInd","cropAndResize","int32");a=a||"bilinear",i=i||0;var f=l.shape[0];return L(s.rank===4,function(){return"Error in cropAndResize: image must be rank 4,but got rank "+s.rank+"."}),L(l.rank===2&&l.shape[1]===4,function(){return"Error in cropAndResize: boxes must be have size ["+f+",4] but had shape "+l.shape+"."}),L(c.rank===1&&c.shape[0]===f,function(){return"Error in cropAndResize: boxInd must be have size ["+f+"] but had shape "+l.shape+"."}),L(n.length===2,function(){return"Error in cropAndResize: cropSize must be of length 2, but got length "+n.length+"."}),L(n[0]>=1&&n[1]>=1,function(){return"cropSize must be atleast [1,1], but was "+n}),L(a==="bilinear"||a==="nearest",function(){return"method must be bilinear or nearest, but was "+a}),K.runKernelFunc(function(d,v){return d.cropAndResize(s,l,c,n,a,i)},{images:s,boxes:l,boxInd:c},null,"CropAndResize",{method:a,extrapolationValue:i,cropSize:n})}}),Ly=Object.freeze({resizeBilinear:bL,resizeNearestNeighbor:xL,nonMaxSuppression:wL,nonMaxSuppressionAsync:_L,nonMaxSuppressionWithScore:SL,nonMaxSuppressionWithScoreAsync:EL,cropAndResize:CL}),Py=function(r,t){return!(r>0)||t==="linear"},zy=function(r,t,e){if(e==null||e==="linear")return r;if(e==="relu")return r.mul(t.step());throw new Error("Gradient for activation "+e+" has not been implemented yet.")},Uy=function(r,t){var e=t,n=an(r.shape,t.shape);return n.length>0&&(e=e.sum(n)),e.reshape(r.shape)},Vy=function(r,t,e){if(t==="linear")return r;if(t==="relu")return Mt(r);if(t==="elu")return AC(r);if(t==="relu6")return DC(r);if(t==="prelu")return TC(r,e);throw new Error("Unknown fused activation "+t+".")},RL=j({fusedMatMul_:function(r){var t,e=r.a,n=r.b,a=r.transposeA,i=a!==void 0&&a,s=r.transposeB,l=s!==void 0&&s,c=r.bias,f=r.activation,d=f===void 0?"linear":f,v=r.preluActivationWeights;if(Py(K.state.gradientDepth,d)===!1){var m=Ad(e,n,i,l);return c!=null&&(m=et(m,c)),Vy(m,d,v)}var g=B(e,"a","fused matMul"),b=B(n,"b","fused matMul");t=Ft(g,b),g=t[0],b=t[1];var w=i?g.shape[g.rank-2]:g.shape[g.rank-1],_=l?b.shape[b.rank-1]:b.shape[b.rank-2],S=i?g.shape[g.rank-1]:g.shape[g.rank-2],E=l?b.shape[b.rank-2]:b.shape[b.rank-1],C=g.shape.slice(0,-2),R=b.shape.slice(0,-2),A=Ae(C),D=Ae(R);L(g.rank>=2&&b.rank>=2&&g.rank===b.rank,function(){return"Error in fused matMul: inputs must have the same rank of at least 2, got ranks "+g.rank+" and "+b.rank+"."}),L(vn(C,R),function(){return"Error in fused matMul: outer dimensions ("+C+") and ("+R+") of Tensors with shapes "+g.shape+" and "+b.shape+" must match."}),L(w===_,function(){return"Error in fused matMul: inner shapes ("+w+") and ("+_+") of Tensors with shapes "+g.shape+" and "+b.shape+" and transposeA="+i+" and transposeB="+l+" must match."});var k,I,O=g.shape.slice(0,-2).concat([S,E]),M=i?g.as3D(A,w,S):g.as3D(A,S,w),V=l?b.as3D(D,E,_):b.as3D(D,_,E);c!=null&&at(O,(k=Ft(k=B(c,"bias","fused matMul"),g)[0]).shape),v!=null&&(I=B(v,"prelu weights","fused matMul"));var z={a:M,b:V};c!=null&&(z.bias=k),v!=null&&(z.preluActivationWeights=I);var J=[M,V];return K.runKernelFunc(function(te,ne){var P=te.fusedBatchMatMul({a:M,b:V,transposeA:i,transposeB:l,bias:k,activation:d,preluActivationWeights:I});return ne([M,V,P]),P},z,function(te,ne){var P=ne[0],W=ne[1],X=ne[2],re=zy(te,X,d),F={};return c!=null&&(F={bias:function(){return Uy(k,re)}}),Object.assign(i||l?!i&&l?{a:function(){return re.matMul(W,!1,!1)},b:function(){return re.matMul(P,!0,!1)}}:i&&!l?{a:function(){return W.matMul(re,!1,!0)},b:function(){return P.matMul(re,!1,!1)}}:{a:function(){return W.matMul(re,!0,!0)},b:function(){return re.matMul(P,!0,!0)}}:{a:function(){return re.matMul(W,!1,!0)},b:function(){return P.matMul(re,!0,!1)}},F)},"_FusedMatMul",{transposeA:i,transposeB:l,activation:d},J,[!0]).reshape(O)}}),AL=j({fusedConv2d_:function(r){var t=r.x,e=r.filter,n=r.strides,a=r.pad,i=r.dataFormat,s=i===void 0?"NHWC":i,l=r.dilations,c=l===void 0?[1,1]:l,f=r.dimRoundingMode,d=r.bias,v=r.activation,m=v===void 0?"linear":v,g=r.preluActivationWeights;if(m=m||"linear",Py(K.state.gradientDepth,m)===!1){var b=Ir(t,e,n,a,s,c,f);return d!=null&&(b=et(b,d)),Vy(b,m,g)}var w=B(t,"x","conv2d"),_=B(e,"filter","conv2d"),S=w,E=!1;w.rank===3&&(E=!0,S=w.as4D(1,w.shape[0],w.shape[1],w.shape[2])),L(S.rank===4,function(){return"Error in fused conv2d: input must be rank 4, but got rank "+S.rank+"."}),L(_.rank===4,function(){return"Error in fused conv2d: filter must be rank 4, but got rank "+_.rank+"."}),f!=null&&L(jt(a),function(){return"Error in fused conv2d: pad must be an integer when using, dimRoundingMode "+f+" but got pad "+a+"."}),L(S.shape[3]===_.shape[2],function(){return"Error in conv2d: depth of input ("+S.shape[3]+") must match input depth for filter "+_.shape[2]+"."}),L(Jn(n,c),function(){return"Error in conv2D: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+c+"'"}),L(s==="NHWC",function(){return"Error in conv2d: got dataFormat of "+s+" but only NHWC is currently supported."});var C,R,A=ts(S.shape,_.shape,n,c,a,f);d!=null&&(C=Ft(C=B(d,"bias","fused conv2d"),w)[0],at(A.outShape,C.shape)),g!=null&&(R=B(g,"prelu weights","fused conv2d"));var D={x:S,filter:_};d!=null&&(D.bias=C),g!=null&&(D.preluActivationWeights=R);var k=[_,S],I=K.runKernelFunc(function(O,M){var V=O.fusedConv2d({input:S,filter:_,convInfo:A,bias:C,activation:m,preluActivationWeights:R});return M([_,S,V]),V},D,function(O,M){var V=M,z=V[0],J=V[1],te=V[2],ne=zy(O,te,m);L(Bu(c),function(){return"Error in gradient of fused conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+c+"'"});var P={};return d!=null&&(P={bias:function(){return Uy(C,ne)}}),Object.assign({x:function(){return bC(J.shape,ne,z,n,a)},filter:function(){return Oy(J,ne,z.shape,n,a)}},P)},"FusedConv2D",{convInfo:A,activation:m},k,[!0]);return E?I.as3D(I.shape[1],I.shape[2],I.shape[3]):I}}),TL=j({fusedDepthwiseConv2d_:function(r){var t=r.x,e=r.filter,n=r.strides,a=r.pad,i=r.dataFormat,s=i===void 0?"NHWC":i,l=r.dilations,c=l===void 0?[1,1]:l,f=r.dimRoundingMode,d=r.bias,v=r.activation,m=v===void 0?"linear":v,g=r.preluActivationWeights;if(Py(K.state.gradientDepth,m)===!1){var b=Rd(t,e,n,a,s,c,f);return d!=null&&(b=et(b,d)),Vy(b,m,g)}var w=B(t,"x","depthwiseConv2d"),_=B(e,"filter","depthwiseConv2d"),S=w,E=!1;w.rank===3&&(E=!0,S=w.as4D(1,w.shape[0],w.shape[1],w.shape[2])),L(S.rank===4,function(){return"Error in fused depthwiseConv2d: input must be rank 4, but got rank "+S.rank+"."}),L(_.rank===4,function(){return"Error in fused depthwiseConv2d: filter must be rank 4, but got rank "+_.rank+"."}),L(S.shape[3]===_.shape[2],function(){return"Error in fused depthwiseConv2d: number of input channels ("+S.shape[3]+") must match the inChannels dimension in filter "+_.shape[2]+"."}),c==null&&(c=[1,1]),L(Jn(n,c),function(){return"Error in fused depthwiseConv2d: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+c+"'"}),f!=null&&L(jt(a),function(){return"Error in fused depthwiseConv2d: pad must be an integer when using dimRoundingMode "+f+" but got pad "+a+"."});var C,R,A=ts(S.shape,_.shape,n,c,a,f,!0);d!=null&&(C=Ft(C=B(d,"bias","fused conv2d"),w)[0],at(A.outShape,C.shape)),g!=null&&(R=B(g,"prelu weights","fused depthwiseConv2d"));var D={x:S,filter:_};d!=null&&(D.bias=C),g!=null&&(D.preluActivationWeights=R);var k=[_,S],I=K.runKernelFunc(function(O,M){var V=O.fusedDepthwiseConv2D({input:S,filter:_,convInfo:A,bias:C,activation:m,preluActivationWeights:R});return M([_,S,V]),V},D,function(O,M){L(Bu(c),function(){return"Error in gradient of fused depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '"+c+"'"});var V=M[0],z=M[1],J=M[2],te=zy(O,J,m),ne={};return d!=null&&(ne={bias:function(){return Uy(C,te)}}),Object.assign({x:function(){return xC(z.shape,te,V,A)},filter:function(){return wC(z,te,V.shape,A)}},ne)},"FusedDepthwiseConv2D",{convInfo:A,activation:m},k,[!0]);return E?I.as3D(I.shape[1],I.shape[2],I.shape[3]):I}}),DL=Object.freeze({matMul:RL,conv2d:AL,depthwiseConv2d:TL}),kL=Object.freeze({image:Ly,linalg:yL,losses:pL,spectral:JB,fused:DL,signal:aL,square:cF,squaredDifference:rC,conv1d:bB,conv2d:Ir,conv3d:xB,depthwiseConv2d:Rd,separableConv2d:Ny,conv2dTranspose:wB,conv3dTranspose:_B,op:j,batchNormalization2d:UF,batchNormalization3d:VF,batchNormalization4d:HF,batchNormalization:jF,batchNorm:lC,batchNorm2d:WF,batchNorm3d:GF,batchNorm4d:qF,booleanMaskAsync:yB,complex:wn,real:Dr,imag:fa,concat:nn,concat1d:D4,concat2d:k4,concat3d:O4,concat4d:N4,split:yy,matMul:Ad,dot:SB,outerProduct:EB,reverse:Mc,reverse1d:CB,reverse2d:RB,reverse3d:AB,reverse4d:TB,maxPool:hn,avgPool:Ic,pool:DB,maxPool3d:kB,avgPool3d:OB,slice:ya,slice1d:NB,slice2d:MB,slice3d:EC,slice4d:IB,abs:fF,acos:hF,acosh:dF,asin:pF,asinh:vF,atan:mF,atanh:gF,ceil:yF,clipByValue:Ty,cos:bF,cosh:xF,erf:wF,exp:Vg,expm1:_F,floor:SF,log:EF,log1p:CF,logSigmoid:RF,neg:id,reciprocal:AF,round:TF,rsqrt:aC,sigmoid:iC,sign:DF,isNaN:kF,isInf:OF,isFinite:NF,sin:MF,sinh:IF,softplus:FF,sqrt:BF,step:LF,tan:PF,tanh:zF,all:FB,any:BB,argMax:LB,argMin:PB,logSumExp:zB,max:Td,mean:UB,min:VB,moments:HB,sum:RC,prod:jB,equal:pC,equalStrict:uB,greater:lB,greaterEqual:vC,greaterEqualStrict:cB,greaterStrict:fB,less:hB,lessEqual:dB,lessEqualStrict:pB,lessStrict:vB,notEqual:mB,notEqualStrict:gB,add:et,addN:$F,addStrict:YF,atan2:QF,div:jr,divNoNan:ZF,divStrict:JF,floorDiv:hC,maximum:Dy,maximumStrict:eB,minimum:dC,minimumStrict:tB,mod:nB,modStrict:rB,mul:Mn,mulStrict:aB,pow:od,powStrict:iB,squaredDifferenceStrict:oB,sub:on,subStrict:sB,elu:AC,leakyRelu:WB,prelu:TC,relu:Mt,relu6:DC,selu:GB,logicalAnd:Cd,logicalNot:KF,logicalOr:cC,logicalXor:XF,where:Zo,whereAsync:fC,buffer:je,print:V4,batchToSpaceND:RE,broadcastTo:H4,cast:j4,clone:W4,cumsum:G4,depthToSpace:q4,expandDims:Tr,eye:AE,multinomial:K4,oneHot:Lg,pad:es,pad1d:X4,pad2d:$4,pad3d:Y4,pad4d:Q4,rand:Z4,randomNormal:J4,randomGamma:eM,randomUniform:TE,reshape:Wr,spaceToBatchND:DE,squeeze:kE,stack:dr,tile:au,truncatedNormal:tM,unstack:rn,setdiff1dAsync:nM,fill:ga,linspace:T4,ones:Hu,range:Qh,scalar:ye,tensor:Sn,tensor1d:Xt,tensor2d:eo,tensor3d:gy,tensor4d:Xn,tensor5d:C4,tensor6d:R4,variable:A4,zeros:Dt,onesLike:CE,zerosLike:st,transpose:oo,softmax:ti,logSoftmax:lM,localResponseNormalization:qB,norm:kC,gather:ky,unsortedSegmentSum:mC,basicLSTMCell:KB,multiRNNCell:XB,movingAverage:$B,stridedSlice:YB,topk:QB,scatterND:ZB,fft:My,ifft:sd,rfft:Iy,irfft:OC,sparseToDense:eL,gatherND:tL,diag:nL,dropout:rL,hannWindow:Fy,hammingWindow:MC,frame:By,stft:IC,inTopKAsync:iL});function de(r,t){Array.isArray(r)||(r=[r]),r.forEach(function(e){e!=null&&L(e.dtype!=="complex64",function(){return t+" does not support complex64 tensors."})})}function Bm(r,t,e,n){if(e==="linear")return r.linear(t);if(e==="relu")return r.relu(t);if(e==="elu")return r.elu(t);if(e==="relu6")return r.relu6(t);if(e==="prelu")return r.prelu(t,n);throw new Error("Activation "+e+" has not been implemented for the CPU backend.")}var OL=function(r){function t(){var e=r.call(this)||this;return e.blockSize=48,e.firstUse=!0,e.data=new LE(e,K),e}return Xr(t,r),t.prototype.write=function(e,n,a){this.firstUse&&(this.firstUse=!1,le().get("IS_NODE")&&$h(`
============================
Hi there 👋. Looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, which binds to TensorFlow C++, by running npm i @tensorflow/tfjs-node, or npm i @tensorflow/tfjs-node-gpu if you have CUDA. Then call require('@tensorflow/tfjs-node'); (-gpu suffix for CUDA) at the start of your program. Visit https://github.com/tensorflow/tfjs-node for more details.
============================`));var i={};return this.data.set(i,{values:e,dtype:a}),i},t.prototype.move=function(e,n,a,i){this.data.set(e,{values:n,dtype:i})},t.prototype.numDataIds=function(){return this.data.numDataIds()},t.prototype.read=function(e){return Ee(this,void 0,void 0,function(){return Ce(this,function(n){return[2,this.readSync(e)]})})},t.prototype.readSync=function(e){var n=this.data.get(e),a=n.dtype,i=n.complexTensors;return a==="complex64"?Ug(this.readSync(i.real.dataId),this.readSync(i.imag.dataId)):this.data.get(e).values},t.prototype.bufferSync=function(e){var n=this.readSync(e.dataId),a=n;if(e.dtype==="string")try{a=n.map(function(i){return qh(i)})}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return je(e.shape,e.dtype,a)},t.prototype.makeOutput=function(e,n,a){var i=this.write(e,n,a);return K.makeTensorFromDataId(i,n,a,this)},t.prototype.disposeData=function(e){if(this.data.has(e)){var n=this.data.get(e).complexTensors;n!=null&&(n.real.dispose(),n.imag.dispose()),this.data.delete(e)}},t.prototype.time=function(e){return Ee(this,void 0,void 0,function(){var n;return Ce(this,function(a){return n=la(),e(),[2,{kernelMs:la()-n}]})})},t.prototype.memory=function(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}},t.prototype.complex=function(e,n){var a=this.makeOutput(null,e.shape,"complex64");return this.data.get(a.dataId).complexTensors={real:K.keep(e.clone()),imag:K.keep(n.clone())},a},t.prototype.real=function(e){return this.data.get(e.dataId).complexTensors.real.clone()},t.prototype.imag=function(e){return this.data.get(e.dataId).complexTensors.imag.clone()},t.prototype.slice=function(e,n,a){if(de(e,"slice"),FE(e.shape,n,a)){var i=BE(n,e.strides),s=Ae(a);return Sn(this.readSync(e.dataId).subarray(i,i+s),a,e.dtype)}for(var l=je(a,e.dtype),c=this.bufferSync(e),f=0;f<l.size;++f){var d=l.indexToLoc(f).map(function(v,m){return v+n[m]});l.values[f]=c.get.apply(c,d)}return l.toTensor()},t.prototype.stridedSlice=function(e,n,a,i){de(e,"stridedSlice");var s=xy(n,a,i);if(s.some(function(g){return g===0}))return Sn([],s);for(var l=je(s,e.dtype),c=this.bufferSync(e),f=0;f<l.size;f++){for(var d=l.indexToLoc(f),v=new Array(d.length),m=0;m<v.length;m++)v[m]=d[m]*i[m]+n[m];l.set.apply(l,[c.get.apply(c,v)].concat(d))}return l.toTensor()},t.prototype.diag=function(e){for(var n=this.readSync(e.dataId),a=je([e.size,e.size],e.dtype),i=a.values,s=0;s<n.length;s++)i[s*e.size+s]=n[s];return a.toTensor()},t.prototype.unstack=function(e,n){for(var a=e.shape[n],i=new Array(e.rank-1),s=0,l=0;l<e.rank;l++)l!==n&&(i[s++]=e.shape[l]);var c=new Array(e.rank).fill(0),f=e.shape.slice();f[n]=1;var d=new Array(a);for(l=0;l<d.length;l++)c[n]=l,d[l]=this.slice(e,c,f).reshape(i);return d},t.prototype.reverse=function(e,n){de(e,"reverse");for(var a=je(e.shape,e.dtype),i=this.bufferSync(e),s=function(c){var f=a.indexToLoc(c),d=f.slice();n.forEach(function(v){return d[v]=e.shape[v]-1-d[v]}),a.set.apply(a,[i.get.apply(i,d)].concat(f))},l=0;l<a.size;l++)s(l);return a.toTensor()},t.prototype.concat=function(e,n){var a=this;if(e[0].dtype==="complex64"){var i=e.map(function(g){return Dr(g)}),s=e.map(function(g){return fa(g)});return wn(this.concat(i,n),this.concat(s,n))}var l=e.map(function(g){var b=Ae(g.shape.slice(n));return g.as2D(-1,b)}),c=Fu(l.map(function(g){return g.shape}),1),f=je(c,e[0].dtype).values;if(l[0].shape[0]===1){var d=0;l.forEach(function(g){f.set(a.readSync(g.dataId),d),d+=g.size})}else{var v=0;l.forEach(function(g){for(var b=a.readSync(g.dataId),w=0,_=0;_<g.shape[0];++_)for(var S=_*c[1]+v,E=0;E<g.shape[1];++E)f[S+E]=b[w++];v+=g.shape[1]})}var m=Fu(e.map(function(g){return g.shape}),n);return Sn(f,m,e[0].dtype)},t.prototype.neg=function(e){return de(e,"neg"),this.multiply(ye(-1),e)},t.prototype.add=function(e,n){return e.dtype==="complex64"||n.dtype==="complex64"?this.broadcastedBinaryComplexOp(e.cast("complex64"),n.cast("complex64"),function(a,i,s,l){return{real:a+s,imag:i+l}}):this.broadcastedBinaryOp(e,n,_n(e.dtype,n.dtype),function(a,i){return a+i})},t.prototype.addN=function(e){var n=this;de(e,"addN");for(var a=e.map(function(d){return n.readSync(d.dataId)}),i=je(e[0].shape,e[0].dtype),s=i.values,l=0;l<e.length;l++)for(var c=a[l],f=0;f<s.length;f++)s[f]+=c[f];return i.toTensor()},t.prototype.softmax=function(e,n){var a=sn([n],e.shape),i=this.max(e,a),s=Zn(i.shape,a),l=this.subtract(e,i.reshape(s)),c=this.exp(l),f=this.sum(c,a).reshape(s);return this.realDivide(c,f)},t.prototype.subtract=function(e,n){return e.dtype==="complex64"||n.dtype==="complex64"?this.broadcastedBinaryComplexOp(e.cast("complex64"),n.cast("complex64"),function(a,i,s,l){return{real:a-s,imag:i-l}}):this.broadcastedBinaryOp(e,n,_n(e.dtype,n.dtype),function(a,i){return a-i})},t.prototype.pow=function(e,n){return de([e,n],"pow"),this.broadcastedBinaryOp(e,n,e.dtype,function(a,i){return Math.pow(a,i)})},t.prototype.batchMatMul=function(e,n,a,i){de([e,n],"matMul");for(var s=a?e.shape[1]:e.shape[2],l=a?e.shape[2]:e.shape[1],c=i?n.shape[1]:n.shape[2],f=e.shape[0],d=this.readSync(e.dataId),v=this.readSync(n.dataId),m=a?[e.strides[0],1,e.strides[1]]:[e.strides[0],e.strides[1],1],g=m[0],b=m[1],w=m[2],_=i?[1,n.strides[1],n.strides[0]]:[n.strides[1],1,n.strides[0]],S=_[0],E=_[1],C=_[2],R=l*c,A=je([f,l,c],e.dtype),D=A.values,k=this.blockSize,I=0;I<f;I++)for(var O=0;O<l;O+=k)for(var M=0;M<c;M+=k)for(var V=0;V<s;V+=k)for(var z=Math.min(O+k,l),J=Math.min(M+k,c),te=Math.min(V+k,s),ne=O;ne<z;ne++)for(var P=M;P<J;P++){for(var W=0,X=V;X<te;X++)W+=d[I*g+ne*b+X*w]*v[X*S+P*E+I*C];D[I*R+(ne*c+P)]+=W}return A.toTensor()},t.prototype.fusedBatchMatMul=function(e){var n=e.a,a=e.b,i=e.transposeA,s=e.transposeB,l=e.bias,c=e.activation,f=e.preluActivationWeights,d=this.batchMatMul(n,a,i,s);return l&&(d=this.add(d,l)),c&&(d=Bm(this,d,c,f)),d},t.prototype.multiply=function(e,n){return e.dtype==="complex64"||n.dtype==="complex64"?this.broadcastedBinaryComplexOp(e.cast("complex64"),n.cast("complex64"),function(a,i,s,l){return{real:a*s-i*l,imag:a*l+i*s}}):this.broadcastedBinaryOp(e,n,_n(e.dtype,n.dtype),function(a,i){return a*i})},t.prototype.realDivide=function(e,n){return de([e,n],"realDivide"),this.broadcastedBinaryOp(e,n,"float32",function(a,i){return a/i})},t.prototype.floorDiv=function(e,n){return de([e,n],"floorDiv"),this.broadcastedBinaryOp(e,n,"int32",function(a,i){return Math.floor(a/i)})},t.prototype.sum=function(e,n){de(e,"sum"),ur("sum",n,e.rank);for(var a=Dn(e.shape,n),i=a[0],s=a[1],l=Dt(i,_n(e.dtype,"int32")),c=Ae(s),f=this.readSync(l.dataId),d=this.readSync(e.dataId),v=0;v<f.length;++v){for(var m=v*c,g=0,b=0;b<c;++b)g+=d[m+b];f[v]=g}return l},t.prototype.prod=function(e,n){de(e,"sum");for(var a=Dn(e.shape,n),i=a[0],s=a[1],l=Dt(i,_n(e.dtype,"int32")),c=Ae(s),f=this.readSync(l.dataId),d=this.readSync(e.dataId),v=0;v<f.length;++v){for(var m=v*c,g=1,b=0;b<c;++b)g*=d[m+b];f[v]=g}return l},t.prototype.unsortedSegmentSum=function(e,n,a){de(e,"unsortedSegmentSum");for(var i=[],s=e.rank-n.rank,l=0;l<s;++l)n=n.expandDims(l+1);for(l=0;l<a;++l){var c=ye(l,"int32"),f=pC(c,n).asType("float32").mul(e).sum(0);i.push(f)}return dr(i)},t.prototype.argMin=function(e,n){de(e,"argMin");var a=[n];ur("argMin",a,e.rank);for(var i=Dn(e.shape,a),s=i[0],l=i[1],c=Dt(s,"int32"),f=Ae(l),d=this.readSync(c.dataId),v=this.readSync(e.dataId),m=0;m<d.length;++m){for(var g=m*f,b=v[g],w=0,_=0;_<f;++_){var S=v[g+_];S<b&&(b=S,w=_)}d[m]=w}return c},t.prototype.argMax=function(e,n){de(e,"argMax");var a=[n];ur("argMax",a,e.rank);for(var i=Dn(e.shape,a),s=i[0],l=i[1],c=Dt(s,"int32"),f=Ae(l),d=this.readSync(c.dataId),v=this.readSync(e.dataId),m=0;m<d.length;++m){for(var g=m*f,b=v[g],w=0,_=0;_<f;++_){var S=v[g+_];S>b&&(b=S,w=_)}d[m]=w}return c},t.prototype.cumsum=function(e,n,a,i){if(de(e,"cumsum"),n!==e.rank-1)throw new Error("backend.cumsum in CPU expects an inner-most axis="+(e.rank-1)+" but got axis="+n);for(var s=_n(e.dtype,"int32"),l=Dt(e.shape,s),c=this.readSync(l.dataId),f=this.readSync(e.dataId),d=e.shape[e.rank-1],v=i?function(_,S){return _+d-S-1}:function(_,S){return _+S},m=0;m<f.length;m+=d)for(var g=0;g<d;g++){var b=v(m,g);if(g===0)c[b]=a?0:f[b];else{var w=v(m,g-1);c[b]=a?f[w]+c[w]:f[b]+c[w]}}return l},t.prototype.equal=function(e,n){return de([e,n],"equal"),this.broadcastedBinaryOp(e,n,"bool",function(a,i){return a===i?1:0})},t.prototype.notEqual=function(e,n){return de([e,n],"notEqual"),this.broadcastedBinaryOp(e,n,"bool",function(a,i){return a!==i?1:0})},t.prototype.less=function(e,n){return de([e,n],"less"),this.broadcastedBinaryOp(e,n,"bool",function(a,i){return a<i?1:0})},t.prototype.lessEqual=function(e,n){return de([e,n],"lessEqual"),this.broadcastedBinaryOp(e,n,"bool",function(a,i){return a<=i?1:0})},t.prototype.greater=function(e,n){return de([e,n],"greater"),this.broadcastedBinaryOp(e,n,"bool",function(a,i){return a>i?1:0})},t.prototype.greaterEqual=function(e,n){return de([e,n],"greaterEqual"),this.broadcastedBinaryOp(e,n,"bool",function(a,i){return a>=i?1:0})},t.prototype.logicalNot=function(e){de(e,"logicalNot");for(var n=this.readSync(e.dataId),a=new Uint8Array(n.length),i=0;i<n.length;++i)a[i]=n[i]?0:1;return this.makeOutput(a,e.shape,"bool")},t.prototype.logicalAnd=function(e,n){return de([e,n],"logicalAnd"),this.broadcastedBinaryOp(e,n,"bool",function(a,i){return a&&i})},t.prototype.logicalOr=function(e,n){return de([e,n],"logicalOr"),this.broadcastedBinaryOp(e,n,"bool",function(a,i){return a||i})},t.prototype.select=function(e,n,a){de([e,n,a],"select");for(var i=this.readSync(e.dataId),s=this.readSync(n.dataId),l=this.readSync(a.dataId),c=Dt(n.shape,_n(n.dtype,a.dtype)),f=this.readSync(c.dataId),d=0,v=e.rank===0||e.rank>1||n.rank===1?1:Ae(n.shape.slice(1)),m=0;m<i.length;m++)for(var g=0;g<v;g++)i[m]===1?f[d++]=s[m]:f[d++]=l[m];return c},t.prototype.where=function(e){de([e],"where");var n=this.readSync(e.dataId);return Ey(e.shape,n)},t.prototype.topk=function(e,n,a){return de(e,"topk"),GE(this.readSync(e.dataId),e.shape,e.dtype,n)},t.prototype.min=function(e,n){de(e,"min"),ur("min",n,e.rank);for(var a=Dn(e.shape,n),i=a[0],s=a[1],l=Dt(i,e.dtype),c=Ae(s),f=this.readSync(l.dataId),d=this.readSync(e.dataId),v=0;v<f.length;++v){for(var m=v*c,g=d[m],b=0;b<c;++b){var w=d[m+b];w<g&&(g=w)}f[v]=g}return l},t.prototype.minimum=function(e,n){return de([e,n],"minimum"),this.broadcastedBinaryOp(e,n,e.dtype,function(a,i){return Math.min(a,i)})},t.prototype.mod=function(e,n){return de([e,n],"mod"),this.broadcastedBinaryOp(e,n,e.dtype,function(a,i){var s=a%i;return a<0&&i<0||a>=0&&i>=0?s:(s+i)%i})},t.prototype.max=function(e,n){de(e,"max"),ur("max",n,e.rank);for(var a=Dn(e.shape,n),i=a[0],s=a[1],l=Dt(i,e.dtype),c=Ae(s),f=this.readSync(l.dataId),d=this.readSync(e.dataId),v=0;v<f.length;++v){for(var m=v*c,g=d[m],b=0;b<c;++b){var w=d[m+b];w>g&&(g=w)}f[v]=g}return l},t.prototype.maximum=function(e,n){return de([e,n],"maximum"),this.broadcastedBinaryOp(e,n,e.dtype,function(a,i){return Math.max(a,i)})},t.prototype.all=function(e,n){de(e,"all"),ur("all",n,e.rank);for(var a=Dn(e.shape,n),i=a[0],s=a[1],l=Dt(i,e.dtype),c=Ae(s),f=this.readSync(l.dataId),d=this.readSync(e.dataId),v=0;v<f.length;++v){for(var m=v*c,g=d[m],b=0;b<c;++b){var w=d[m+b];g=g&&w}f[v]=g}return l},t.prototype.any=function(e,n){de(e,"any"),ur("any",n,e.rank);for(var a=Dn(e.shape,n),i=a[0],s=a[1],l=Dt(i,e.dtype),c=Ae(s),f=this.readSync(l.dataId),d=this.readSync(e.dataId),v=0;v<f.length;++v){for(var m=v*c,g=d[m],b=0;b<c;++b){var w=d[m+b];g=g||w}f[v]=g}return l},t.prototype.squaredDifference=function(e,n){return de([e,n],"squaredDifference"),this.broadcastedBinaryOp(e,n,e.dtype,function(a,i){var s=a-i;return s*s})},t.prototype.ceil=function(e){de(e,"ceil");for(var n=this.readSync(e.dataId),a=new Float32Array(n.length),i=0;i<n.length;++i)a[i]=Math.ceil(n[i]);return this.makeOutput(a,e.shape,"float32")},t.prototype.floor=function(e){de(e,"floor");for(var n=this.readSync(e.dataId),a=new Float32Array(n.length),i=0;i<n.length;++i)a[i]=Math.floor(n[i]);return this.makeOutput(a,e.shape,"float32")},t.prototype.sign=function(e){de(e,"x");for(var n=this.readSync(e.dataId),a=new Float32Array(n.length),i=0;i<n.length;++i)n[i]<0?a[i]=-1:n[i]>0?a[i]=1:a[i]=0;return this.makeOutput(a,e.shape,"float32")},t.prototype.isNaN=function(e){de(e,"x");for(var n=this.readSync(e.dataId),a=new Uint8Array(n.length),i=0;i<n.length;++i)Number.isNaN(n[i])&&(a[i]=1);return this.makeOutput(a,e.shape,"bool")},t.prototype.isInf=function(e){de(e,"x");for(var n=this.readSync(e.dataId),a=new Uint8Array(n.length),i=0;i<n.length;++i)Math.abs(n[i])===1/0&&(a[i]=1);return this.makeOutput(a,e.shape,"bool")},t.prototype.isFinite=function(e){de(e,"x");for(var n=this.readSync(e.dataId),a=new Uint8Array(n.length),i=0;i<n.length;++i)Number.isFinite(n[i])&&(a[i]=1);return this.makeOutput(a,e.shape,"bool")},t.prototype.round=function(e){de(e,"round");for(var n=this.readSync(e.dataId),a=new Float32Array(n.length),i=0;i<n.length;++i){var s=Math.floor(n[i]);n[i]-s<.5?a[i]=Math.floor(n[i]):n[i]-s>.5?a[i]=Math.ceil(n[i]):a[i]=s%2==0?s:s+1}return this.makeOutput(a,e.shape,"float32")},t.prototype.exp=function(e){de(e,"exp");for(var n=this.readSync(e.dataId),a=new Float32Array(n.length),i=0;i<n.length;++i)a[i]=Math.exp(n[i]);return this.makeOutput(a,e.shape,"float32")},t.prototype.expm1=function(e){de(e,"expm1");for(var n=this.readSync(e.dataId),a=new Float32Array(n.length),i=0;i<n.length;++i)a[i]=Math.expm1(n[i]);return this.makeOutput(a,e.shape,"float32")},t.prototype.log=function(e){de(e,"log");for(var n=this.readSync(e.dataId),a=new Float32Array(n.length),i=0;i<n.length;++i){var s=n[i];a[i]=Math.log(s)}return this.makeOutput(a,e.shape,"float32")},t.prototype.log1p=function(e){de(e,"log1p");for(var n=this.readSync(e.dataId),a=new Float32Array(n.length),i=0;i<n.length;++i){var s=n[i];a[i]=Math.log1p(s)}return this.makeOutput(a,e.shape,"float32")},t.prototype.sqrt=function(e){de(e,"sqrt");for(var n=this.readSync(e.dataId),a=new Float32Array(n.length),i=0;i<n.length;++i){var s=n[i];a[i]=Math.sqrt(s)}return this.makeOutput(a,e.shape,"float32")},t.prototype.rsqrt=function(e){de(e,"rsqrt");for(var n=this.readSync(e.dataId),a=new Float32Array(n.length),i=0;i<n.length;++i){var s=n[i];a[i]=1/Math.sqrt(s)}return this.makeOutput(a,e.shape,"float32")},t.prototype.reciprocal=function(e){de(e,"reciprocal");for(var n=this.readSync(e.dataId),a=new Float32Array(n.length),i=0;i<n.length;++i)a[i]=1/n[i];return this.makeOutput(a,e.shape,"float32")},t.prototype.linear=function(e){return e},t.prototype.relu=function(e){de(e,"relu");for(var n=Dt(e.shape,e.dtype),a=this.readSync(n.dataId),i=this.readSync(e.dataId),s=0;s<i.length;++s)a[s]=Math.max(0,i[s]);return n},t.prototype.relu6=function(e){de(e,"relu");for(var n=Dt(e.shape,e.dtype),a=this.readSync(n.dataId),i=this.readSync(e.dataId),s=0;s<i.length;++s)a[s]=Math.min(Math.max(0,i[s]),6);return n},t.prototype.prelu=function(e,n){return de([e,n],"prelu"),this.broadcastedBinaryOp(e,n,e.dtype,function(a,i){return a<0?i*a:a})},t.prototype.elu=function(e){de(e,"elu");for(var n=new Float32Array(e.size),a=this.readSync(e.dataId),i=0;i<a.length;++i){var s=a[i];n[i]=s>=0?s:Math.exp(s)-1}return this.makeOutput(n,e.shape,"float32")},t.prototype.eluDer=function(e,n){de([e,n],"eluDer");for(var a=new Float32Array(n.size),i=this.readSync(n.dataId),s=this.readSync(e.dataId),l=0;l<i.length;++l){var c=i[l];a[l]=c>=1?s[l]:s[l]*(c+1)}return this.makeOutput(a,n.shape,"float32")},t.prototype.selu=function(e){de(e,"selu");for(var n=Ry,a=Ay,i=new Float32Array(e.size),s=this.readSync(e.dataId),l=0;l<s.length;++l){var c=s[l];i[l]=c>=0?a*c:n*(Math.exp(c)-1)}return this.makeOutput(i,e.shape,"float32")},t.prototype.clip=function(e,n,a){de(e,"clip");for(var i=new Float32Array(e.size),s=this.readSync(e.dataId),l=0;l<s.length;++l){var c=s[l];i[l]=c>a?a:c<n?n:c}return this.makeOutput(i,e.shape,"float32")},t.prototype.abs=function(e){for(var n=new Float32Array(e.size),a=this.readSync(e.dataId),i=0;i<a.length;++i)n[i]=Math.abs(a[i]);return this.makeOutput(n,e.shape,"float32")},t.prototype.complexAbs=function(e){for(var n=new Float32Array(e.size),a=this.readSync(e.dataId),i=0;i<e.size;++i){var s=a[2*i],l=a[2*i+1];n[i]=Math.hypot(s,l)}return this.makeOutput(n,e.shape,"float32")},t.prototype.int=function(e){de(e,"int");for(var n=new Int32Array(e.size),a=this.readSync(e.dataId),i=0;i<a.length;++i)n[i]=a[i];return this.makeOutput(n,e.shape,"int32")},t.prototype.sigmoid=function(e){de(e,"sigmoid");for(var n=new Float32Array(e.size),a=this.readSync(e.dataId),i=0;i<a.length;++i)n[i]=1/(1+Math.exp(-a[i]));return this.makeOutput(n,e.shape,"float32")},t.prototype.softplus=function(e){de(e,"softplus");for(var n=Math.log(11920928955078125e-23)+2,a=new Float32Array(e.size),i=this.readSync(e.dataId),s=0;s<i.length;++s){var l=i[s]>-n,c=i[s]<n,f=Math.exp(i[s]),d=void 0;d=c?f:l?i[s]:Math.log(1+f),a[s]=d}return this.makeOutput(a,e.shape,"float32")},t.prototype.sin=function(e){de(e,"sin");for(var n=new Float32Array(e.size),a=this.readSync(e.dataId),i=0;i<a.length;++i)n[i]=Math.sin(a[i]);return this.makeOutput(n,e.shape,"float32")},t.prototype.cos=function(e){de(e,"cos");for(var n=new Float32Array(e.size),a=this.readSync(e.dataId),i=0;i<a.length;++i)n[i]=Math.cos(a[i]);return this.makeOutput(n,e.shape,"float32")},t.prototype.tan=function(e){de(e,"tan");for(var n=new Float32Array(e.size),a=this.readSync(e.dataId),i=0;i<a.length;++i)n[i]=Math.tan(a[i]);return this.makeOutput(n,e.shape,"float32")},t.prototype.asin=function(e){de(e,"asin");for(var n=new Float32Array(e.size),a=this.readSync(e.dataId),i=0;i<a.length;++i)n[i]=Math.asin(a[i]);return this.makeOutput(n,e.shape,"float32")},t.prototype.acos=function(e){de(e,"acos");for(var n=new Float32Array(e.size),a=this.readSync(e.dataId),i=0;i<a.length;++i)n[i]=Math.acos(a[i]);return this.makeOutput(n,e.shape,"float32")},t.prototype.atan=function(e){de(e,"atan");for(var n=new Float32Array(e.size),a=this.readSync(e.dataId),i=0;i<a.length;++i)n[i]=Math.atan(a[i]);return this.makeOutput(n,e.shape,"float32")},t.prototype.atan2=function(e,n){return de([e,n],"atan2"),this.broadcastedBinaryOp(e,n,e.dtype,function(a,i){return Math.atan2(a,i)})},t.prototype.sinh=function(e){de(e,"sinh");for(var n=new Float32Array(e.size),a=this.readSync(e.dataId),i=0;i<a.length;++i)n[i]=Math.sinh(a[i]);return this.makeOutput(n,e.shape,"float32")},t.prototype.cosh=function(e){de(e,"cosh");for(var n=new Float32Array(e.size),a=this.readSync(e.dataId),i=0;i<a.length;++i)n[i]=Math.cosh(a[i]);return this.makeOutput(n,e.shape,"float32")},t.prototype.tanh=function(e){de(e,"tanh");for(var n=new Float32Array(e.size),a=this.readSync(e.dataId),i=0;i<a.length;++i)n[i]=N3(a[i]);return this.makeOutput(n,e.shape,"float32")},t.prototype.asinh=function(e){de(e,"asinh");for(var n=new Float32Array(e.size),a=this.readSync(e.dataId),i=0;i<a.length;++i)n[i]=Math.asinh(a[i]);return this.makeOutput(n,e.shape,"float32")},t.prototype.acosh=function(e){de(e,"acosh");for(var n=new Float32Array(e.size),a=this.readSync(e.dataId),i=0;i<a.length;++i)n[i]=Math.acosh(a[i]);return this.makeOutput(n,e.shape,"float32")},t.prototype.atanh=function(e){de(e,"atanh");for(var n=new Float32Array(e.size),a=this.readSync(e.dataId),i=0;i<a.length;++i)n[i]=Math.atanh(a[i]);return this.makeOutput(n,e.shape,"float32")},t.prototype.erf=function(e){de(e,"erf");for(var n=new Float32Array(e.size),a=this.readSync(e.dataId),i=0;i<a.length;++i){var s=Math.sign(a[i]),l=Math.abs(a[i]),c=1/(1+.3275911*l);n[i]=s*(1-((((1.061405429*c-1.453152027)*c+1.421413741)*c-.284496736)*c+.254829592)*c*Math.exp(-l*l))}return this.makeOutput(n,e.shape,"float32")},t.prototype.step=function(e,n){n===void 0&&(n=0),de(e,"step");for(var a=new Float32Array(e.size),i=this.readSync(e.dataId),s=0;s<i.length;++s){var l=i[s];isNaN(l)?a[s]=NaN:a[s]=l>0?1:n}return this.makeOutput(a,e.shape,"float32")},t.prototype.fusedConv2d=function(e){var n=e.input,a=e.filter,i=e.convInfo,s=e.bias,l=e.activation,c=e.preluActivationWeights,f=this.conv2d(n,a,i);return s&&(f=this.add(f,s)),l&&(f=Bm(this,f,l,c)),f},t.prototype.conv2d=function(e,n,a){de([e,n],"conv2d");for(var i=a.filterHeight,s=a.filterWidth,l=a.dilationHeight,c=a.dilationWidth,f=a.padInfo.left,d=a.padInfo.top,v=a.dataFormat==="channelsLast",m=je(a.outShape,e.dtype),g=e.strides[0],b=v?e.strides[1]:e.strides[2],w=v?e.strides[2]:1,_=v?1:e.strides[1],S=m.strides[0],E=v?m.strides[1]:m.strides[2],C=v?m.strides[2]:1,R=v?1:m.strides[1],A=this.readSync(e.dataId),D=this.readSync(n.dataId),k=m.values,I=0;I<a.batchSize;++I)for(var O=I*g,M=I*S,V=0;V<a.outHeight;++V)for(var z=M+V*E,J=V*a.strideHeight-d,te=0;te<i;te++){var ne=J+te*l;if(!(ne<0||ne>=a.inHeight))for(var P=te*n.strides[0],W=O+ne*b,X=0;X<a.outWidth;++X)for(var re=z+X*C,F=X*a.strideWidth-f,q=0;q<s;q++){var oe=F+q*c;if(!(oe<0||oe>=a.inWidth))for(var se=W+oe*w,pe=P+q*n.strides[1],ge=0;ge<a.inChannels;++ge){for(var ve=A[se+ge*_],Ne=0;Ne<a.outChannels;++Ne)k[re+Ne*R]+=ve*D[pe+Ne];pe+=a.outChannels}}}return m.toTensor()},t.prototype.conv3d=function(e,n,a){for(var i=a.filterDepth,s=a.filterHeight,l=a.filterWidth,c=a.dilationDepth,f=a.dilationHeight,d=a.dilationWidth,v=a.padInfo.front,m=a.padInfo.left,g=a.padInfo.top,b=je(a.outShape,e.dtype),w=this.readSync(e.dataId),_=this.readSync(n.dataId),S=b.values,E=0;E<a.batchSize;++E)for(var C=E*e.strides[0],R=E*b.strides[0],A=0;A<a.outDepth;++A)for(var D=R+A*b.strides[1],k=A*a.strideDepth-v,I=0;I<i;I++){var O=k+I*c;if(!(O<0||O>=a.inDepth))for(var M=I*n.strides[0],V=C+O*e.strides[1],z=0;z<a.outHeight;++z)for(var J=D+z*b.strides[2],te=z*a.strideHeight-g,ne=0;ne<s;ne++){var P=te+ne*f;if(!(P<0||P>=a.inHeight))for(var W=M+ne*n.strides[1],X=V+P*e.strides[2],re=0;re<a.outWidth;++re)for(var F=J+re*a.outChannels,q=re*a.strideWidth-m,oe=0;oe<l;oe++){var se=q+oe*d;if(!(se<0||se>=a.inWidth))for(var pe=W+oe*n.strides[2],ge=X+se*a.inChannels,ve=pe,Ne=0;Ne<a.inChannels;++Ne){for(var be=w[ge+Ne],Ie=0;Ie<a.outChannels;++Ie)S[F+Ie]+=be*_[ve+Ie];ve+=a.outChannels}}}}return b.toTensor()},t.prototype.conv2dDerInput=function(e,n,a){de([e,n],"conv2dDerInput");for(var i=je(a.inShape,"float32"),s=i.values,l=this.readSync(e.dataId),c=this.readSync(n.dataId),f=n.strides,d=f[0],v=f[1],m=f[2],g=a.batchSize,b=a.filterHeight,w=a.filterWidth,_=a.inChannels,S=a.inHeight,E=a.inWidth,C=a.outChannels,R=a.outHeight,A=a.outWidth,D=a.strideHeight,k=a.strideWidth,I=a.dataFormat,O=b-1-a.padInfo.top,M=w-1-a.padInfo.left,V=I==="channelsLast",z=i.strides[0],J=V?i.strides[1]:i.strides[2],te=V?i.strides[2]:1,ne=V?1:i.strides[1],P=e.strides[0],W=V?e.strides[1]:e.strides[2],X=V?e.strides[2]:1,re=V?1:e.strides[1],F=0;F<g;++F)for(var q=0;q<_;++q)for(var oe=0;oe<S;++oe)for(var se=oe-O,pe=Math.max(0,Math.ceil(se/D)),ge=Math.min(R,(b+se)/D),ve=0;ve<E;++ve){for(var Ne=ve-M,be=Math.max(0,Math.ceil(Ne/k)),Ie=Math.min(A,(w+Ne)/k),lt=0,Pe=pe;Pe<ge;++Pe)for(var qe=Pe*D-se,Qe=be;Qe<Ie;++Qe)for(var dt=P*F+W*Pe+X*Qe,Et=d*(b-1-qe)+v*(w-1-(Qe*k-Ne))+m*q,xt=0;xt<C;++xt)lt+=l[dt+re*xt]*c[Et+xt];s[z*F+J*oe+te*ve+ne*q]=lt}return i.toTensor()},t.prototype.conv3dDerInput=function(e,n,a){for(var i=je(a.inShape,"float32"),s=i.values,l=i.strides,c=l[0],f=l[1],d=l[2],v=l[3],m=this.readSync(e.dataId),g=e.strides,b=g[0],w=g[1],_=g[2],S=g[3],E=this.readSync(n.dataId),C=n.strides,R=C[0],A=C[1],D=C[2],k=C[3],I=a.batchSize,O=a.filterDepth,M=a.filterHeight,V=a.filterWidth,z=a.inChannels,J=a.inDepth,te=a.inHeight,ne=a.inWidth,P=a.outChannels,W=a.outDepth,X=a.outHeight,re=a.outWidth,F=a.strideDepth,q=a.strideHeight,oe=a.strideWidth,se=O-1-a.padInfo.front,pe=M-1-a.padInfo.top,ge=V-1-a.padInfo.left,ve=0;ve<I;++ve)for(var Ne=0;Ne<z;++Ne)for(var be=0;be<J;++be)for(var Ie=be-se,lt=Math.max(0,Math.ceil(Ie/F)),Pe=Math.min(W,(O+Ie)/F),qe=0;qe<te;++qe)for(var Qe=qe-pe,dt=Math.max(0,Math.ceil(Qe/q)),Et=Math.min(X,(M+Qe)/q),xt=0;xt<ne;++xt){for(var Ut=xt-ge,mr=Math.max(0,Math.ceil(Ut/oe)),En=Math.min(re,(V+Ut)/oe),Ea=0,Un=lt;Un<Pe;++Un)for(var Yr=Un*F-Ie,gr=dt;gr<Et;++gr)for(var oi=gr*q-Qe,Fr=mr;Fr<En;++Fr)for(var Ca=b*ve+w*Un+_*gr+S*Fr,Wt=R*(O-1-Yr)+A*(M-1-oi)+D*(V-1-(Fr*oe-Ut))+k*Ne,$t=0;$t<P;++$t)Ea+=m[Ca+$t]*E[Wt+$t];s[c*ve+f*be+d*qe+v*xt+Ne]=Ea}return i.toTensor()},t.prototype.conv2dDerFilter=function(e,n,a){de([e,n],"conv2dDerFilter");for(var i=a.strideHeight,s=a.strideWidth,l=a.filterHeight,c=a.filterWidth,f=a.dataFormat==="channelsLast",d=je(a.filterShape,"float32"),v=a.padInfo.left,m=a.padInfo.top,g=this.bufferSync(e),b=this.bufferSync(n),w=0;w<l;++w)for(var _=Math.max(0,Math.ceil((m-w)/i)),S=Math.min(a.outHeight,(a.inHeight+m-w)/i),E=0;E<c;++E)for(var C=Math.max(0,Math.ceil((v-E)/s)),R=Math.min(a.outWidth,(a.inWidth+v-E)/s),A=0;A<a.inChannels;++A)for(var D=0;D<a.outChannels;++D){for(var k=0,I=0;I<a.batchSize;++I)for(var O=_;O<S;++O)for(var M=w+O*i-m,V=C;V<R;++V){var z=E+V*s-v;k+=f?g.get(I,M,z,A)*b.get(I,O,V,D):g.get(I,A,M,z)*b.get(I,D,O,V)}d.set(k,w,E,A,D)}return d.toTensor()},t.prototype.conv3dDerFilter=function(e,n,a){for(var i=a.strideDepth,s=a.strideHeight,l=a.strideWidth,c=a.filterDepth,f=a.filterHeight,d=a.filterWidth,v=je(a.filterShape,"float32"),m=v.values,g=v.strides,b=g[0],w=g[1],_=g[2],S=g[3],E=this.readSync(n.dataId),C=n.strides,R=C[0],A=C[1],D=C[2],k=C[3],I=this.readSync(e.dataId),O=e.strides,M=O[0],V=O[1],z=O[2],J=O[3],te=a.padInfo.front,ne=a.padInfo.left,P=a.padInfo.top,W=0;W<c;++W)for(var X=Math.max(0,Math.ceil((te-W)/i)),re=Math.min(a.outDepth,(a.inDepth+te-W)/i),F=W*b,q=0;q<f;++q)for(var oe=Math.max(0,Math.ceil((P-q)/s)),se=Math.min(a.outHeight,(a.inHeight+P-q)/s),pe=q*w+F,ge=0;ge<d;++ge)for(var ve=Math.max(0,Math.ceil((ne-ge)/l)),Ne=Math.min(a.outWidth,(a.inWidth+ne-ge)/l),be=ge*_+pe,Ie=0;Ie<a.inChannels;++Ie)for(var lt=Ie*S+be,Pe=0;Pe<a.outChannels;++Pe){for(var qe=0,Qe=0;Qe<a.batchSize;++Qe)for(var dt=Qe*M,Et=Qe*R,xt=X;xt<re;++xt)for(var Ut=(W+xt*i-te)*V+dt,mr=xt*A+Et,En=oe;En<se;++En)for(var Ea=(q+En*s-P)*z+Ut,Un=En*D+mr,Yr=ve;Yr<Ne;++Yr){var gr=Yr*k+Un;qe+=I[(ge+Yr*l-ne)*J+Ea+Ie]*E[gr+Pe]}m[lt+Pe]=qe}return v.toTensor()},t.prototype.fusedDepthwiseConv2D=function(e){var n=e.input,a=e.filter,i=e.convInfo,s=e.bias,l=e.activation,c=e.preluActivationWeights,f=this.depthwiseConv2D(n,a,i);return s&&(f=this.add(f,s)),l&&(f=Bm(this,f,l,c)),f},t.prototype.depthwiseConv2D=function(e,n,a){de([e,n],"depthwiseConv2D");for(var i=a.filterHeight,s=a.filterWidth,l=a.dilationHeight,c=a.dilationWidth,f=a.padInfo.left,d=a.padInfo.top,v=a.outChannels/a.inChannels,m=je(a.outShape,e.dtype),g=this.readSync(e.dataId),b=this.readSync(n.dataId),w=m.values,_=0;_<a.batchSize;++_)for(var S=_*e.strides[0],E=_*m.strides[0],C=0;C<a.outHeight;++C)for(var R=E+C*m.strides[1],A=C*a.strideHeight-f,D=0;D<i;++D){var k=A+D*l;if(!(k<0||k>=a.inHeight))for(var I=D*n.strides[0],O=S+k*e.strides[1],M=0;M<a.outWidth;++M)for(var V=R+M*m.strides[2],z=M*a.strideWidth-d,J=0;J<s;++J){var te=z+J*c;if(!(te<0||te>=a.inWidth))for(var ne=I+J*n.strides[1],P=O+te*a.inChannels,W=V,X=ne,re=0;re<a.inChannels;++re){for(var F=g[P+re],q=0;q<v;++q)w[W+q]+=F*b[X+q];W+=v,X+=v}}}return m.toTensor()},t.prototype.depthwiseConv2DDerInput=function(e,n,a){de([e,n],"depthwiseConv2DDerInput");for(var i=je(a.inShape,"float32"),s=i.values,l=i.strides,c=l[0],f=l[1],d=l[2],v=this.readSync(e.dataId),m=e.strides,g=m[0],b=m[1],w=m[2],_=this.readSync(n.dataId),S=n.strides,E=S[0],C=S[1],R=S[2],A=a.batchSize,D=a.filterHeight,k=a.filterWidth,I=a.inChannels,O=a.inHeight,M=a.inWidth,V=a.outChannels,z=a.outHeight,J=a.outWidth,te=a.strideHeight,ne=a.strideWidth,P=D-1-a.padInfo.top,W=k-1-a.padInfo.left,X=V/I,re=0;re<A;++re)for(var F=0;F<I;++F)for(var q=0;q<O;++q)for(var oe=q-P,se=Math.max(0,Math.ceil(oe/te)),pe=Math.min(z,(D+oe)/te),ge=0;ge<M;++ge){for(var ve=ge-W,Ne=Math.max(0,Math.ceil(ve/ne)),be=Math.min(J,(k+ve)/ne),Ie=0,lt=se;lt<pe;++lt)for(var Pe=lt*te-oe,qe=Ne;qe<be;++qe)for(var Qe=g*re+b*lt+w*qe,dt=E*(D-1-Pe)+C*(k-1-(qe*ne-ve))+R*F,Et=0;Et<X;++Et)Ie+=v[Qe+(F*X+Et)]*_[dt+Et];s[c*re+f*q+d*ge+F]=Ie}return i.toTensor()},t.prototype.depthwiseConv2DDerFilter=function(e,n,a){de([e,n],"depthwiseConv2DDerFilter");for(var i=a.strideHeight,s=a.strideWidth,l=a.filterHeight,c=a.filterWidth,f=je(a.filterShape,"float32"),d=a.padInfo.left,v=a.padInfo.top,m=a.outChannels/a.inChannels,g=this.bufferSync(e),b=this.bufferSync(n),w=0;w<l;++w)for(var _=Math.max(0,Math.ceil((v-w)/i)),S=Math.min(a.outHeight,(a.inHeight+v-w)/i),E=0;E<c;++E)for(var C=Math.max(0,Math.ceil((d-E)/s)),R=Math.min(a.outWidth,(a.inWidth+d-E)/s),A=0;A<a.outChannels;++A){for(var D=Math.trunc(A/m),k=A%m,I=0,O=0;O<a.batchSize;++O)for(var M=_;M<S;++M)for(var V=w+M*i-v,z=C;z<R;++z){var J=E+z*s-d;I+=g.get(O,V,J,D)*b.get(O,M,z,A)}f.set(I,w,E,D,k)}return f.toTensor()},t.prototype.tile=function(e,n){return de(e,"tile"),WE(this.bufferSync(e),n)},t.prototype.pad=function(e,n,a){de(e,"pad");var i=n.map(function(m,g){return m[0]+e.shape[g]+m[1]}),s=n.map(function(m){return m[0]}),l=this.bufferSync(e),c=je(i,e.dtype);a!==0&&c.values.fill(a);for(var f=0;f<e.size;f++){var d=l.indexToLoc(f),v=d.map(function(m,g){return m+s[g]});c.set.apply(c,[l.get.apply(l,d)].concat(v))}return c.toTensor()},t.prototype.transpose=function(e,n){de(e,"transpose");for(var a=new Array(e.rank),i=0;i<a.length;i++)a[i]=e.shape[n[i]];var s=this.readSync(e.dataId),l=je(a,e.dtype),c=this.bufferSync(e);for(i=0;i<e.size;++i){for(var f=c.indexToLoc(i),d=new Array(f.length),v=0;v<d.length;v++)d[v]=f[n[v]];var m=l.locToIndex(d);l.values[m]=s[i]}return l.toTensor()},t.prototype.gather=function(e,n,a){de([e,n],"gather");var i=e.shape.slice(),s=this.readSync(n.dataId);i[a]=s.length;for(var l=je(i,e.dtype),c=this.bufferSync(e),f=0;f<l.size;++f){var d=l.indexToLoc(f),v=d.slice();v[a]=s[d[a]];var m=c.locToIndex(v);l.values[f]=c.values[m]}return l.toTensor()},t.prototype.batchToSpaceND=function(e,n,a){de([e],"batchToSpaceND");var i=n.reduce(function(v,m){return v*m}),s=Zh(e.shape,n,i),l=Jh(s.length,n.length),c=ed(e.shape,n,i),f=OE(a,n.length),d=NE(c,a,n.length);return e.reshape(s).transpose(l).reshape(c).slice(f,d)},t.prototype.spaceToBatchND=function(e,n,a){de([e],"spaceToBatchND");var i=n.reduce(function(m,g){return m*g}),s=[[0,0]];s.push.apply(s,a);for(var l=1+n.length;l<e.shape.length;++l)s.push([0,0]);var c=e.pad(s),f=Zh(c.shape,n,i,!1),d=Jh(f.length,n.length,!1),v=ed(c.shape,n,i,!1);return c.reshape(f).transpose(d).reshape(v)},t.prototype.pool=function(e,n,a){de(e,"pool");for(var i=n.strideHeight,s=n.strideWidth,l=n.dilationHeight,c=n.dilationWidth,f=n.effectiveFilterHeight,d=n.effectiveFilterWidth,v=n.padInfo.top,m=n.padInfo.left,g=a==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,b=this.readSync(e.dataId),w=je(n.outShape,e.dtype),_=w.values,S=n.outShape[1]*n.outShape[2]*n.outShape[3],E=n.outShape[2]*n.outShape[3],C=n.outShape[3],R=0;R<n.batchSize;++R)for(var A=R*S,D=R*e.strides[0],k=0;k<n.inChannels;++k)for(var I=0;I<n.outHeight;++I)for(var O=I*i-v,M=Math.max(0,O),V=Math.min(n.inHeight,f+O),z=A+I*E,J=0;J<n.outWidth;++J){for(var te=J*s-m,ne=Math.max(0,te),P=Math.min(n.inWidth,d+te),W=g,X=0,re=0,F=M;F<V;F+=l){for(var q=D+F*e.strides[1],oe=ne;oe<P;oe+=c){var se=b[q+oe*e.strides[2]+k];a==="max"&&se>W?W=se:a==="avg"&&(X+=se,re++)}if(isNaN(W))break}_[z+J*C+k]=a==="avg"?X/re:W}return w.toTensor()},t.prototype.maxPool=function(e,n){return this.pool(e,n,"max")},t.prototype.maxPoolPositions=function(e,n){for(var a=je(n.outShape,"int32"),i=n.strideHeight,s=n.strideWidth,l=n.dilationHeight,c=n.dilationWidth,f=n.effectiveFilterHeight,d=n.effectiveFilterWidth,v=n.padInfo.top,m=n.padInfo.left,g=this.bufferSync(e),b=0;b<n.batchSize;++b)for(var w=0;w<n.inChannels;++w)for(var _=0;_<n.outHeight;++_){for(var S=_*i-v,E=S;E<0;)E+=l;for(var C=Math.min(n.inHeight,f+S),R=0;R<n.outWidth;++R){for(var A=R*s-m,D=A;D<0;)D+=c;for(var k=Math.min(n.inWidth,d+A),I=Number.NEGATIVE_INFINITY,O=-1,M=E;M<C;M+=l)for(var V=M-S,z=D;z<k;z+=c){var J=z-A,te=g.get(b,M,z,w);te>I&&(I=te,O=V*d+J)}a.set(O,b,_,R,w)}}return a.toTensor()},t.prototype.maxPoolBackprop=function(e,n,a,i){de([n,a],"maxPoolBackprop");for(var s=this.maxPoolPositions(n,i),l=i.strideHeight,c=i.strideWidth,f=i.dilationHeight,d=i.dilationWidth,v=i.effectiveFilterHeight,m=i.effectiveFilterWidth,g=m-1-i.padInfo.left,b=v-1-i.padInfo.top,w=je(n.shape,"float32"),_=this.bufferSync(s),S=this.bufferSync(e),E=0;E<i.batchSize;++E)for(var C=0;C<i.inChannels;++C)for(var R=0;R<i.inHeight;++R)for(var A=0;A<i.inWidth;++A){for(var D=R-b,k=A-g,I=0,O=0;O<v;O+=f){var M=(D+O)/l;if(!(M<0||M>=i.outHeight||Math.floor(M)!==M))for(var V=0;V<m;V+=d){var z=(k+V)/c;if(!(z<0||z>=i.outWidth||Math.floor(z)!==z)){var J=v*m-1-_.get(E,M,z,C)===O*m+V?1:0;J!==0&&(I+=S.get(E,M,z,C)*J)}}}w.set(I,E,R,A,C)}return w.toTensor()},t.prototype.avgPoolBackprop=function(e,n,a){de([e,n],"avgPoolBackprop");for(var i=a.strideHeight,s=a.strideWidth,l=a.filterHeight,c=a.filterWidth,f=a.dilationHeight,d=a.dilationWidth,v=a.effectiveFilterHeight,m=a.effectiveFilterWidth,g=m-1-a.padInfo.left,b=v-1-a.padInfo.top,w=je(n.shape,"float32"),_=1/(l*c),S=this.bufferSync(e),E=0;E<a.batchSize;++E)for(var C=0;C<a.inChannels;++C)for(var R=0;R<a.inHeight;++R)for(var A=0;A<a.inWidth;++A){for(var D=R-b,k=A-g,I=0,O=0;O<v;O+=f){var M=(D+O)/i;if(!(M<0||M>=a.outHeight||Math.floor(M)!==M))for(var V=0;V<m;V+=d){var z=(k+V)/s;z<0||z>=a.outWidth||Math.floor(z)!==z||(I+=S.get(E,M,z,C))}}w.set(I*_,E,R,A,C)}return w.toTensor()},t.prototype.pool3d=function(e,n,a){de(e,"pool3d");for(var i=n.strideDepth,s=n.strideHeight,l=n.strideWidth,c=n.dilationDepth,f=n.dilationHeight,d=n.dilationWidth,v=n.effectiveFilterDepth,m=n.effectiveFilterHeight,g=n.effectiveFilterWidth,b=n.padInfo.front,w=n.padInfo.top,_=n.padInfo.left,S=a==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,E=this.readSync(e.dataId),C=je(n.outShape,e.dtype),R=C.values,A=n.outShape[1]*n.outShape[2]*n.outShape[3]*n.outShape[4],D=n.outShape[2]*n.outShape[3]*n.outShape[4],k=n.outShape[3]*n.outShape[4],I=n.outShape[4],O=0;O<n.batchSize;++O)for(var M=O*A,V=O*e.strides[0],z=0;z<n.inChannels;++z)for(var J=0;J<n.outDepth;++J){for(var te=J*i-b,ne=te;ne<0;)ne+=c;for(var P=Math.min(n.inDepth,v+te),W=M+J*D,X=0;X<n.outHeight;++X){for(var re=X*s-w,F=re;F<0;)F+=f;for(var q=Math.min(n.inHeight,m+re),oe=W+X*k,se=0;se<n.outWidth;++se){for(var pe=se*l-_,ge=pe;ge<0;)ge+=d;for(var ve=Math.min(n.inWidth,g+pe),Ne=oe+se*I,be=S,Ie=0,lt=0,Pe=ne;Pe<P;Pe+=c){for(var qe=V+Pe*e.strides[1],Qe=F;Qe<q;Qe+=f){for(var dt=qe+Qe*e.strides[2],Et=ge;Et<ve;Et+=d){var xt=E[dt+Et*e.strides[3]+z];if(a==="max"&&xt>be?be=xt:a==="avg"&&(Ie+=xt,lt++),isNaN(be))break}if(isNaN(be))break}if(isNaN(be))break}R[Ne+z]=a==="avg"?Ie/lt:be}}}return C.toTensor()},t.prototype.avgPool3d=function(e,n){return de(e,"avgPool3d"),this.pool3d(e,n,"avg").toFloat()},t.prototype.avgPool3dBackprop=function(e,n,a){de([e,n],"avgPool3dBackprop");for(var i=a.strideDepth,s=a.strideHeight,l=a.strideWidth,c=a.filterDepth,f=a.filterHeight,d=a.filterWidth,v=a.dilationDepth,m=a.dilationHeight,g=a.dilationWidth,b=a.effectiveFilterDepth,w=a.effectiveFilterHeight,_=a.effectiveFilterWidth,S=b-1-a.padInfo.front,E=_-1-a.padInfo.left,C=w-1-a.padInfo.top,R=je(n.shape,"float32"),A=1/(c*f*d),D=this.bufferSync(e),k=0;k<a.batchSize;++k)for(var I=0;I<a.inChannels;++I)for(var O=0;O<a.inDepth;++O)for(var M=0;M<a.inHeight;++M)for(var V=0;V<a.inWidth;++V){for(var z=O-S,J=M-C,te=V-E,ne=0,P=0;P<b;P+=v){var W=(z+P)/i;if(!(W<0||W>=a.outDepth||Math.floor(W)!==W))for(var X=0;X<w;X+=m){var re=(J+X)/s;if(!(re<0||re>=a.outHeight||Math.floor(re)!==re))for(var F=0;F<_;F+=g){var q=(te+F)/l;q<0||q>=a.outWidth||Math.floor(q)!==q||(ne+=D.get(k,W,re,q,I))}}}R.set(ne*A,k,O,M,V,I)}return R.toTensor()},t.prototype.maxPool3d=function(e,n){return de(e,"maxPool3d"),this.pool3d(e,n,"max").toFloat()},t.prototype.maxPool3dPositions=function(e,n){for(var a=je(n.outShape,"int32"),i=n.strideDepth,s=n.strideHeight,l=n.strideWidth,c=n.dilationDepth,f=n.dilationHeight,d=n.dilationWidth,v=n.effectiveFilterDepth,m=n.effectiveFilterHeight,g=n.effectiveFilterWidth,b=n.padInfo.front,w=n.padInfo.top,_=n.padInfo.left,S=this.bufferSync(e),E=0;E<n.batchSize;++E)for(var C=0;C<n.inChannels;++C)for(var R=0;R<n.outDepth;++R){for(var A=R*i-b,D=A;D<0;)D+=c;for(var k=Math.min(n.inDepth,v+A),I=0;I<n.outHeight;++I){for(var O=I*s-w,M=O;M<0;)M+=f;for(var V=Math.min(n.inHeight,m+O),z=0;z<n.outWidth;++z){for(var J=z*l-_,te=J;te<0;)te+=d;for(var ne=Math.min(n.inWidth,g+J),P=Number.NEGATIVE_INFINITY,W=-1,X=D;X<k;X+=c)for(var re=X-A,F=M;F<V;F+=f)for(var q=F-O,oe=te;oe<ne;oe+=d){var se=oe-J,pe=S.get(E,X,F,oe,C);pe>=P&&(P=pe,W=re*m*g+q*m+se)}a.set(W,E,R,I,z,C)}}}return a.toTensor()},t.prototype.maxPool3dBackprop=function(e,n,a,i){de([n,a],"maxPool3dBackprop");for(var s=this.maxPool3dPositions(n,i),l=i.strideDepth,c=i.strideHeight,f=i.strideWidth,d=i.dilationDepth,v=i.dilationHeight,m=i.dilationWidth,g=i.effectiveFilterDepth,b=i.effectiveFilterHeight,w=i.effectiveFilterWidth,_=g-1-i.padInfo.front,S=w-1-i.padInfo.left,E=b-1-i.padInfo.top,C=je(n.shape,"float32"),R=this.bufferSync(s),A=this.bufferSync(e),D=0;D<i.batchSize;++D)for(var k=0;k<i.inChannels;++k)for(var I=0;I<i.inDepth;++I)for(var O=0;O<i.inHeight;++O)for(var M=0;M<i.inWidth;++M){for(var V=I-_,z=O-E,J=M-S,te=0,ne=0;ne<g;ne+=d){var P=(V+ne)/l;if(!(P<0||P>=i.outDepth||Math.floor(P)!==P))for(var W=0;W<b;W+=v){var X=(z+W)/c;if(!(X<0||X>=i.outHeight||Math.floor(X)!==X))for(var re=0;re<w;re+=m){var F=(J+re)/f;if(!(F<0||F>=i.outWidth||Math.floor(F)!==F)){var q=g*b*w-1-R.get(D,P,X,F,k)===ne*b*w+W*w+re?1:0;q!==0&&(te+=A.get(D,P,X,F,k)*q)}}}}C.set(te,D,I,O,M,k)}return C.toTensor()},t.prototype.cast=function(e,n){return UE(e,n,this)},t.prototype.reshape=function(e,n){return zg(e,n)},t.prototype.avgPool=function(e,n){return de(e,"avgPool"),this.pool(e,n,"avg").toFloat()},t.prototype.resizeBilinear=function(e,n,a,i){de(e,"resizeBilinear");for(var s=e.shape,l=s[0],c=s[1],f=s[2],d=s[3],v=this.readSync(e.dataId),m=new Float32Array(Ae([l,n,a,d])),g=[i&&n>1?c-1:c,i&&a>1?f-1:f],b=[i&&n>1?n-1:n,i&&a>1?a-1:a],w=0,_=g[0]/b[0],S=g[1]/b[1],E=0;E<l;E++)for(var C=0;C<n;C++)for(var R=_*C,A=Math.floor(R),D=R-A,k=Math.min(c-1,Math.ceil(R)),I=E*e.strides[0]+A*e.strides[1],O=E*e.strides[0]+k*e.strides[1],M=0;M<a;M++)for(var V=S*M,z=Math.floor(V),J=V-z,te=Math.min(f-1,Math.ceil(V)),ne=I+z*e.strides[2],P=O+z*e.strides[2],W=I+te*e.strides[2],X=O+te*e.strides[2],re=0;re<d;re++){var F=v[ne+re],q=v[P+re],oe=F+(v[W+re]-F)*J,se=oe+(q+(v[X+re]-q)*J-oe)*D;m[w++]=se}return Sn(m,[l,n,a,d])},t.prototype.resizeBilinearBackprop=function(e,n,a){de([e,n],"resizeBilinearBackprop");for(var i=n.shape,s=i[0],l=i[1],c=i[2],f=i[3],d=e.shape,v=d[1],m=d[2],g=new Float32Array(s*l*c*f),b=[a&&v>1?l-1:l,a&&m>1?c-1:c],w=[a&&v>1?v-1:v,a&&m>1?m-1:m],_=b[0]/w[0],S=b[1]/w[1],E=this.readSync(e.dataId),C=0,R=0;R<s;R++)for(var A=R*n.strides[0],D=0;D<v;D++)for(var k=D*_,I=Math.floor(k),O=Math.min(Math.ceil(k),l-1),M=A+I*n.strides[1],V=A+O*n.strides[1],z=k-I,J=1-z,te=0;te<m;te++)for(var ne=te*S,P=Math.floor(ne),W=Math.min(Math.ceil(ne),c-1),X=ne-P,re=1-X,F=M+P*n.strides[2],q=M+W*n.strides[2],oe=V+P*n.strides[2],se=V+W*n.strides[2],pe=J*re,ge=J*X,ve=z*re,Ne=z*X,be=0;be<f;be++){var Ie=E[C++];g[F+be]+=Ie*pe,g[q+be]+=Ie*ge,g[oe+be]+=Ie*ve,g[se+be]+=Ie*Ne}return Xn(g,[s,c,l,f],n.dtype)},t.prototype.resizeNearestNeighbor=function(e,n,a,i){de(e,"resizeNearestNeighbor");for(var s=e.shape,l=s[0],c=s[1],f=s[2],d=s[3],v=this.readSync(e.dataId),m=new Float32Array(l*n*a*d),g=[i&&n>1?c-1:c,i&&a>1?f-1:f],b=[i&&n>1?n-1:n,i&&a>1?a-1:a],w=g[0]/b[0],_=g[1]/b[1],S=0,E=0;E<l;E++)for(var C=E*e.strides[0],R=0;R<n;R++)for(var A=w*R,D=C+Math.min(c-1,i?Math.round(A):Math.floor(A))*e.strides[1],k=0;k<a;k++)for(var I=_*k,O=D+Math.min(f-1,i?Math.round(I):Math.floor(I))*e.strides[2],M=0;M<d;M++){var V=v[O+M];m[S++]=V}return Sn(m,[l,n,a,d],e.dtype)},t.prototype.resizeNearestNeighborBackprop=function(e,n,a){de([e,n],"resizeNearestNeighborBackprop");for(var i=n.shape,s=i[0],l=i[1],c=i[2],f=i[3],d=e.shape,v=d[1],m=d[2],g=new Float32Array(s*l*c*f),b=this.readSync(e.dataId),w=[a&&v>1?l-1:l,a&&m>1?c-1:c],_=[a&&v>1?v-1:v,a&&m>1?m-1:m],S=w[0]/_[0],E=w[1]/_[1],C=1/S,R=1/E,A=2*Math.ceil(C)+2,D=2*Math.ceil(R)+2,k=0;k<s;k++)for(var I=k*n.strides[0],O=0;O<l;O++)for(var M=I+O*n.strides[1],V=Math.floor(O*C),z=Math.floor(V-A/2),J=0;J<c;J++)for(var te=M+J*n.strides[2],ne=Math.floor(J*R),P=Math.floor(ne-D/2),W=0;W<f;W++){for(var X=0,re=0;re<A;re++){var F=re+z;if(!(F<0||F>=v)){var q=I+F*e.strides[1],oe=F*S;if(O===Math.min(l-1,a?Math.round(oe):Math.floor(oe)))for(var se=0;se<D;se++){var pe=se+P;if(!(pe<0||pe>=m)){var ge=q+pe*e.strides[2],ve=pe*E;J===Math.min(c-1,a?Math.round(ve):Math.floor(ve))&&(X+=b[ge+W])}}}}g[te+W]=X}return Xn(g,n.shape,n.dtype)},t.prototype.batchNormalization=function(e,n,a,i,s,l){de([e,n,a,s,l],"batchNorm");for(var c=this.readSync(e.dataId),f=this.readSync(n.dataId),d=this.readSync(a.dataId),v=s?this.readSync(s.dataId):new Float32Array([1]),m=l?this.readSync(l.dataId):new Float32Array([0]),g=new Float32Array(c.length),b=m.length,w=v.length,_=d.length,S=f.length,E=0,C=0,R=0,A=0,D=0;D<c.length;++D)g[D]=m[E++]+(c[D]-f[C++])*v[R++]/Math.sqrt(d[A++]+i),E>=b&&(E=0),C>=S&&(C=0),R>=w&&(R=0),A>=_&&(A=0);return Xn(g,e.shape)},t.prototype.localResponseNormalization4D=function(e,n,a,i,s){de(e,"localResponseNormalization4D");var l=e.shape[3],c=l-1,f=this.readSync(e.dataId),d=e.size,v=new Float32Array(d);function m(_){for(var S=_%l,E=_-S+Math.max(0,S-n),C=_-S+Math.min(S+n,c),R=0;E<=C;E++){var A=f[E];R+=A*A}return R}for(var g=0;g<d;g++){var b=m(g),w=f[g]*Math.pow(a+i*b,-s);v[g]=w}return Xn(v,e.shape)},t.prototype.LRNGrad=function(e,n,a,i,s,l,c){de(e,"LRNGrad");for(var f=e.shape[3],d=this.readSync(e.dataId),v=this.readSync(n.dataId),m=this.readSync(a.dataId),g=new Float32Array(e.size),b=e.size,w=0;w<b;w++){for(var _=w%f,S=w-_+Math.max(0,_-i),E=w-_+Math.min(f,_+i+1),C=0,R=S;R<E;R++)C+=Math.pow(v[R],2);for(C=l*C+s,R=S;R<E;R++){var A=-2*l*c*v[R]*m[w]/C;w===R&&(A+=Math.pow(C,-c)),A*=d[w],g[R]+=A}}return Xn(g,e.shape)},t.prototype.multinomial=function(e,n,a,i){de(e,"multinomial");for(var s=n?e:ti(e),l=s.shape[0],c=s.shape[1],f=Dt([l,a],"int32"),d=this.readSync(f.dataId),v=this.readSync(s.dataId),m=0;m<l;++m){var g=m*c,b=new Float32Array(c-1);b[0]=v[g];for(var w=1;w<b.length;++w)b[w]=b[w-1]+v[g+w];for(var _=_d(i.toString()),S=m*a,E=0;E<a;++E){var C=_();d[S+E]=b.length;for(var R=0;R<b.length;R++)if(C<b[R]){d[S+E]=R;break}}}return f},t.prototype.oneHot=function(e,n,a,i){de(e,"oneHot");var s=new Float32Array(e.size*n);s.fill(i);for(var l=this.readSync(e.dataId),c=0;c<e.size;++c)l[c]>=0&&l[c]<n&&(s[c*n+l[c]]=a);return eo(s,[e.size,n],"int32")},t.prototype.nonMaxSuppression=function(e,n,a,i,s){return de(e,"nonMaxSuppression"),_y(this.readSync(e.dataId),this.readSync(n.dataId),a,i,s)},t.prototype.fft=function(e){return this.fftBatch(e,!1)},t.prototype.ifft=function(e){return this.fftBatch(e,!0)},t.prototype.fftBatch=function(e,n){for(var a=e.shape[0],i=e.shape[1],s=je(e.shape,"float32"),l=je(e.shape,"float32"),c=Dr(e).as2D(a,i),f=fa(e).as2D(a,i),d=0;d<a;d++)for(var v=c.slice([d,0],[1,i]),m=f.slice([d,0],[1,i]),g=wn(v,m),b=this.readSync(this.fftImpl(g,n).dataId),w=0;w<i;w++){var _=K2(b,w);s.values[d*i+w]=_.real,l.values[d*i+w]=_.imag}return wn(s.toTensor(),l.toTensor()).as2D(a,i)},t.prototype.fftImpl=function(e,n){var a=e.as1D(),i=a.size;if(this.isExponentOf2(i)){var s=this.fftRadix2(a,i,n).as2D(e.shape[0],e.shape[1]);return n&&(s=wn(Dr(s).div(ye(i)),fa(s).div(ye(i)))),s}var l=this.readSync(e.dataId),c=function(f){for(var d=new Float32Array(f.length/2),v=new Float32Array(f.length/2),m=0;m<f.length;m+=2)d[m/2]=f[m],v[m/2]=f[m+1];return{real:d,imag:v}}(this.fourierTransformByMatmul(l,i,n));return wn(c.real,c.imag).as2D(e.shape[0],e.shape[1])},t.prototype.isExponentOf2=function(e){return(e&e-1)==0},t.prototype.fftRadix2=function(e,n,a){if(n===1)return e;var i=this.readSync(e.dataId),s=n/2,l=function(S){for(var E=Math.ceil(S.length/4),C=new Float32Array(E),R=new Float32Array(E),A=0;A<S.length;A+=4)C[Math.floor(A/4)]=S[A],R[Math.floor(A/4)]=S[A+1];return{real:C,imag:R}}(i),c=wn(l.real,l.imag).as1D(),f=function(S){for(var E=Math.floor(S.length/4),C=new Float32Array(E),R=new Float32Array(E),A=2;A<S.length;A+=4)C[Math.floor(A/4)]=S[A],R[Math.floor(A/4)]=S[A+1];return{real:C,imag:R}}(i),d=wn(f.real,f.imag).as1D();c=this.fftRadix2(c,s,a),d=this.fftRadix2(d,s,a);var v=function(S,E){for(var C=new Float32Array(S/2),R=new Float32Array(S/2),A=0;A<Math.ceil(S/2);A++){var D=(E?2:-2)*Math.PI*(A/S);C[A]=Math.cos(D),R[A]=Math.sin(D)}return{real:C,imag:R}}(n,a),m=wn(v.real,v.imag).mul(d),g=c.add(m),b=c.sub(m),w=Dr(g).concat(Dr(b)),_=fa(g).concat(fa(b));return wn(w,_).as1D()},t.prototype.fourierTransformByMatmul=function(e,n,a){for(var i=new Float32Array(2*n),s=0;s<n;s++){for(var l=0,c=0,f=0;f<n;f++){var d=fM(s*f,n,a),v=K2(e,f);l+=v.real*d.real-v.imag*d.imag,c+=v.real*d.imag+v.imag*d.real}a&&(l/=n,c/=n),cM(i,l,c,s)}return i},t.prototype.depthToSpace=function(e,n,a){L(a==="NHWC",function(){return"Only NHWC dataFormat supported on CPU for depthToSpace. Got "+a}),L(n>1,function(){return"blockSize should be > 1 for depthToSpace, but was: "+n});for(var i=e.shape[0],s=e.shape[1],l=e.shape[2],c=e.shape[3],f=s*n,d=l*n,v=c/(n*n),m=this.readSync(e.dataId),g=new Float32Array(i*f*d*v),b=0,w=0;w<i;++w)for(var _=0;_<f;++_)for(var S=Math.floor(_/n),E=_%n,C=0;C<d;++C)for(var R=Math.floor(C/n),A=(E*n+C%n)*v,D=0;D<v;++D){var k=D+A+c*(R+l*(S+s*w));g[b++]=m[k]}return Xn(g,[i,f,d,v])},t.prototype.broadcastedBinaryOp=function(e,n,a,i){var s=at(e.shape,n.shape),l=je(s,a),c=this.readSync(e.dataId),f=this.readSync(n.dataId),d=$i(e.shape,s),v=$i(n.shape,s),m=l.values;if(d.length+v.length===0)for(var g=0;g<m.length;++g)m[g]=i(c[g%c.length],f[g%f.length]);else{var b=this.bufferSync(e),w=this.bufferSync(n),_=function(S){var E=l.indexToLoc(S),C=E.slice(-e.rank);d.forEach(function(k){return C[k]=0});var R=b.locToIndex(C),A=E.slice(-n.rank);v.forEach(function(k){return A[k]=0});var D=w.locToIndex(A);m[S]=i(c[R],f[D])};for(g=0;g<m.length;++g)_(g)}return l.toTensor()},t.prototype.broadcastedBinaryComplexOp=function(e,n,a){var i=at(e.shape,n.shape),s=je(i,"float32"),l=je(i,"float32"),c=this.readSync(e.dataId),f=this.readSync(n.dataId),d=$i(e.shape,i),v=$i(n.shape,i),m=s.values,g=l.values;if(d.length+v.length===0)for(var b=0;b<m.length;b++){var w=b%c.length,_=b%f.length,S=a(c[2*w],c[2*w+1],f[2*_],f[2*_+1]);m[b]=S.real,g[b]=S.imag}else{var E=this.bufferSync(this.data.get(e.dataId).complexTensors.real),C=this.bufferSync(this.data.get(n.dataId).complexTensors.real),R=function(A){var D=s.indexToLoc(A),k=D.slice(-e.rank);d.forEach(function(z){return k[z]=0});var I=E.locToIndex(k),O=D.slice(-n.rank);v.forEach(function(z){return O[z]=0});var M=C.locToIndex(O),V=a(c[2*I],c[2*I+1],f[2*M],f[2*M+1]);m[A]=V.real,g[A]=V.imag};for(b=0;b<m.length;b++)R(b)}return this.complex(s.toTensor(),l.toTensor())},t.prototype.split=function(e,n,a){return jE(e,n,a)},t.prototype.dispose=function(){},t.prototype.floatPrecision=function(){return 32},t.prototype.epsilon=function(){return 1e-7},t.prototype.cropAndResize=function(e,n,a,i,s,l){for(var c=e.shape,f=c[0],d=c[1],v=c[2],m=c[3],g=n.shape[0],b=i[0],w=i[1],_=je([g,b,w,m],"float32"),S=this.readSync(n.dataId),E=this.readSync(a.dataId),C=this.readSync(e.dataId),R=e.strides,A=_.strides,D=0;D<g;D++){var k=4*D,I=S[k],O=S[k+1],M=S[k+2],V=S[k+3],z=E[D];if(!(z>=f))for(var J=b>1?(M-I)*(d-1)/(b-1):0,te=w>1?(V-O)*(v-1)/(w-1):0,ne=0;ne<b;ne++){var P=b>1?I*(d-1)+ne*J:.5*(I+M)*(d-1);if(P<0||P>d-1)for(var W=0;W<w;W++)for(var X=0;X<m;X++){var re=X+W*A[2]+ne*A[1]+D*A[0];_.values[re]=l}else if(s==="bilinear"){var F=Math.floor(P),q=Math.ceil(P),oe=P-F;for(W=0;W<w;W++)if((Pe=w>1?O*(v-1)+W*te:.5*(O+V)*(v-1))<0||Pe>v-1)for(X=0;X<m;X++)re=X+W*A[2]+ne*A[1]+D*A[0],_.values[re]=l;else{var se=Math.floor(Pe),pe=Math.ceil(Pe),ge=Pe-se;for(X=0;X<m;X++){var ve=C[re=X+se*R[2]+F*R[1]+z*R[0]],Ne=C[re=X+pe*R[2]+F*R[1]+z*R[0]],be=C[re=X+se*R[2]+q*R[1]+z*R[0]],Ie=ve+(Ne-ve)*ge,lt=be+(C[re=X+pe*R[2]+q*R[1]+z*R[0]]-be)*ge;re=X+W*A[2]+ne*A[1]+D*A[0],_.values[re]=Ie+(lt-Ie)*oe}}}else for(W=0;W<w;++W){var Pe;if((Pe=w>1?O*(v-1)+W*te:.5*(O+V)*(v-1))<0||Pe>v-1)for(X=0;X<m;X++)re=X+W*A[2]+ne*A[1]+D*A[0],_.values[re]=l;else{var qe=Math.round(Pe),Qe=Math.round(P);for(X=0;X<m;X++){var dt=X+qe*R[2]+Qe*R[1]+z*R[0],Et=X+W*A[2]+ne*A[1]+D*A[0];_.values[Et]=C[dt]}}}}}return _.toTensor()},t.prototype.sparseToDense=function(e,n,a,i){var s=td(0,e,a),l=s.sliceRank,c=s.numUpdates,f=s.sliceSize,d=s.strides,v=s.outputSize;return this.scatter(e,n,a,v,f,c,l,d,i,!1)},t.prototype.gatherND=function(e,n){var a=n.shape,i=a[a.length-1],s=ME(e,n),l=s[0],c=s[1],f=s[2],d=s[3];if(c===0)return Sn([],l,e.dtype);for(var v=new hc([c,f],e.dtype),m=this.readSync(n.dataId),g=this.readSync(e.dataId),b=0;b<c;b++){for(var w=[],_=0,S=0;S<i;S++){var E=m[b*i+S];_+=E*d[S],w.push(E)}if(_<0||_>=e.size/f)throw new Error("Invalid indices: "+w+" does not index into "+e.shape);for(var C=0;C<f;C++)v.values[b*f+C]=g[_*f+C]}return v.toTensor().reshape(l)},t.prototype.scatterND=function(e,n,a){var i=td(0,e,a),s=i.sliceRank,l=i.numUpdates,c=i.sliceSize,f=i.strides,d=i.outputSize,v=ye(0);return this.scatter(e,n,a,d,c,l,s,f,v,!0)},t.prototype.fill=function(e,n,a){var i=Gh(a=a||Tc(n),Ae(e));return i.fill(n),K.makeTensor(i,e,a,this)},t.prototype.onesLike=function(e){if(e.dtype==="string")throw new Error("onesLike is not supported for string tensors");return this.fill(e.shape,1,e.dtype)},t.prototype.zerosLike=function(e){var n=Gh(e.dtype,Ae(e.shape));return this.makeOutput(n,e.shape,e.dtype)},t.prototype.linspace=function(e,n,a){return VE(e,n,a)},t.prototype.scatter=function(e,n,a,i,s,l,c,f,d,v){var m=[i/s,s],g=this.readSync(e.dataId),b=this.readSync(n.dataId);if(i===0)return Sn([],a,n.dtype);var w=new hc(m,n.dtype);w.values.fill(this.readSync(d.dataId)[0]);for(var _=0;_<l;_++){for(var S=[],E=0,C=0;C<c;C++){var R=g[_*c+C];S.push(R),E+=R*f[C]}if(E<0||E>=i/s)throw new Error("Invalid indices: "+S+" does not index into "+a);for(var A=0;A<s;A++)v?w.values[E*s+A]+=b[_*s+A]:w.values[E*s+A]=n.rank===0?b[0]:b[_*s+A]}return w.toTensor().reshape(a)},t}(PE);K.registerBackend("cpu",function(){return new OL},1);for(var Lm=0,v_=[{kernelName:"NonMaxSuppressionV5",backendName:"cpu",kernelFunc:function(r){var t=r.inputs,e=r.backend,n=r.attrs,a=t,i=a.boxes,s=a.scores,l=n,c=l.maxOutputSize,f=l.iouThreshold,d=l.scoreThreshold,v=l.softNmsSigma,m=e;de(i,"NonMaxSuppressionWithScore");var g=Sy(m.data.get(i.dataId).values,m.data.get(s.dataId).values,c,f,d,v);return[g.selectedIndices,g.selectedScores]}},{kernelName:"Square",backendName:"cpu",kernelFunc:function(r){var t=r.inputs,e=r.backend,n=t.x,a=e;de(n,"square");for(var i=a.data.get(n.dataId).values,s=new Float32Array(i.length),l=0;l<i.length;++l){var c=i[l];s[l]=c*c}return{dataId:a.write(s,n.shape,n.dtype),shape:n.shape,dtype:n.dtype}}},{kernelName:vc,backendName:"cpu",kernelFunc:function(r){var t=r.inputs,e=r.backend,n=t,a=n.a,i=n.b,s=e;de([a,i],vc);var l=s.data.get(a.dataId).values,c=s.data.get(i.dataId).values,f=function(m,g,b,w,_,S){var E=at(m,g),C=E.length,R=ma(E),A=fc(_,Ae(E)),D=m.length,k=g.length,I=ma(m),O=ma(g),M=$i(m,E),V=$i(g,E);if(M.length+V.length===0)for(var z=0;z<A.length;++z)A[z]=S(b[z%b.length],w[z%w.length]);else{var J=function(te){var ne=V3(te,C,R),P=ne.slice(-D);M.forEach(function(F){return P[F]=0});var W=P2(P,D,I),X=ne.slice(-k);V.forEach(function(F){return X[F]=0});var re=P2(X,k,O);A[te]=S(b[W],w[re])};for(z=0;z<A.length;++z)J(z)}return[A,E]}(a.shape,i.shape,l,c,a.dtype,function(m,g){var b=m-g;return b*b}),d=f[0],v=f[1];return{dataId:s.write(d,v,a.dtype),shape:v,dtype:a.dtype}}}];Lm<v_.length;Lm++)hE(v_[Lm]);var qs,NL=function(r){this.variableNames=["A"];var t=On(),e=r[0],n=r[1];this.outputShape=r,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(`+n+".0, "+e+`.0);

        vec4 values = `+t.texture2D+`(A, uv);
        float value;
        if (depth == 0) {
          value = values.r;
        } else if (depth == 1) {
          value = values.g;
        } else if (depth == 2) {
          value = values.b;
        } else if (depth == 3) {
          value = values.a;
        }

        setOutput(floor(value * 255.0 + 0.5));
      }
    `},ML=function(r){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;var t=On(),e=r[0],n=r[1];this.outputShape=r,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];

        vec4 result = vec4(0.);

        for(int row=0; row<=1; row++) {
          for(int col=0; col<=1; col++) {
            texC = coords[1] + row;
            depth = coords[2] + col;

            vec2 uv = (vec2(texC, texR) + halfCR) /
                       vec2(`+n+".0, "+e+`.0);
            vec4 values = `+t.texture2D+`(A, uv);
            float value;
            if (depth == 0) {
              value = values.r;
            } else if (depth == 1) {
              value = values.g;
            } else if (depth == 2) {
              value = values.b;
            } else if (depth == 3) {
              value = values.a;
            }

            result[row * 2 + col] = floor(value * 255.0 + 0.5);
          }
        }

        `+t.output+` = result;
      }
    `};for(var Pm=0,m_=[{kernelName:"FromPixels",backendName:"webgl",kernelFunc:function(r){var t=r.inputs,e=r.backend,n=r.attrs,a=t.pixels,i=n.numChannels,s=typeof HTMLVideoElement<"u"&&a instanceof HTMLVideoElement,l=typeof HTMLImageElement<"u"&&a instanceof HTMLImageElement,c=s?[a.videoWidth,a.videoHeight]:[a.width,a.height],f=c[0],d=c[1],v=[d,f],m=[d,f,i];(l||s)&&(qs==null&&(qs=document.createElement("canvas").getContext("2d")),qs.canvas.width=f,qs.canvas.height=d,qs.drawImage(a,0,0,f,d),a=qs.canvas);var g=e.makeTensorInfo(v,"int32");e.texData.get(g.dataId).usage=cr.PIXELS,e.gpgpu.uploadPixelDataToTexture(e.getTexture(g.dataId),a);var b=le().getBool("WEBGL_PACK")?new ML(m):new NL(m),w=e.runWebGLProgram(b,[g],"int32");return e.disposeData(g.dataId),w}},{kernelName:"NonMaxSuppressionV5",backendName:"webgl",kernelFunc:function(r){var t=r.inputs,e=r.backend,n=r.attrs;$h("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");var a=t,i=a.boxes,s=a.scores,l=n,c=l.maxOutputSize,f=l.iouThreshold,d=l.scoreThreshold,v=l.softNmsSigma,m=e,g=Sy(m.readSync(i.dataId),m.readSync(s.dataId),c,f,d,v);return[g.selectedIndices,g.selectedScores]}},{kernelName:"Square",backendName:"webgl",kernelFunc:function(r){var t=r.inputs,e=r.backend,n=t.x,a=e,i=new Xe(n.shape,"return x * x;");return a.runWebGLProgram(i,[n],n.dtype)}},{kernelName:vc,backendName:"webgl",kernelFunc:function(r){var t=r.inputs,e=r.backend,n=t,a=n.a,i=n.b,s=e,l=le().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new ja("return (a - b) * (a - b);",a.shape,i.shape):new Pt("return (a - b) * (a - b);",a.shape,i.shape);return s.compileAndRun(l,[a,i])}}];Pm<m_.length;Pm++)hE(m_[Pm]);for(var zm=0,g_=[{kernelName:"Square",gradFunc:function(r,t){var e=t[0];return{x:function(){return r.mul(e.toFloat().mul(2))}}}},{kernelName:vc,gradFunc:function(r,t){var e=t[0],n=t[1],a=ye(2);return{a:function(){return Mn(r,Mn(a,on(e,n)))},b:function(){return Mn(r,Mn(a,on(n,e)))}}}}];zm<g_.length;zm++)k3(g_[zm]);var IL=function(){function r(){}return r.prototype.fetch=function(t,e){return fetch(t,e)},r.prototype.now=function(){return performance.now()},r.prototype.encode=function(t,e){if(e!=="utf-8"&&e!=="utf8")throw new Error("Browser's encoder only supports utf-8, but got "+e);return this.textEncoder==null&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(t)},r.prototype.decode=function(t,e){return new TextDecoder(e).decode(t)},r}();le().get("IS_BROWSER")&&le().setPlatform("browser",new IL);var Um,FL=function(){return require("node-fetch")},BL=function(){function r(){this.util=require("util"),this.textEncoder=new this.util.TextEncoder}return r.prototype.fetch=function(t,e){return le().global.fetch!=null?le().global.fetch(t,e):(Um==null&&(Um=FL()),Um(t,e))},r.prototype.now=function(){var t=process.hrtime();return 1e3*t[0]+t[1]/1e6},r.prototype.encode=function(t,e){if(e!=="utf-8"&&e!=="utf8")throw new Error("Node built-in encoder only supports utf-8, but got "+e);return this.textEncoder.encode(t)},r.prototype.decode=function(t,e){return t.length===0?"":new this.util.TextDecoder(e).decode(t)},r}();le().get("IS_NODE")&&le().setPlatform("node",new BL);var Hg={float32:4,int32:4,uint16:2,uint8:1,bool:1},ud=4;function FC(r,t){for(var e={},n=0,a=function(l){var c=l.name,f=l.dtype,d=l.shape,v=Ae(d),m=void 0;if("quantization"in l){var g=l.quantization;if(g.dtype!=="uint8"&&g.dtype!=="uint16")throw new Error("Weight "+l.name+" has unknown quantization dtype "+g.dtype+". Supported quantization dtypes are: 'uint8' and 'uint16'.");var b=Hg[g.dtype],w=r.slice(n,n+v*b),_=g.dtype==="uint8"?new Uint8Array(w):new Uint16Array(w);if(f==="float32")m=Float32Array.from(_,function(D){return D*g.scale+g.min});else{if(f!=="int32")throw new Error("Unsupported dtype in weight '"+c+"': "+f);m=Int32Array.from(_,function(D){return Math.round(D*g.scale+g.min)})}n+=v*b}else if(f==="string"){var S=Ae(l.shape);m=[];for(var E=0;E<S;E++){var C=new Uint32Array(r.slice(n,n+ud))[0];n+=ud;var R=new Uint8Array(r.slice(n,n+C));m.push(R),n+=C}}else{var A=Hg[f];if(w=r.slice(n,n+v*A),f==="float32")m=new Float32Array(w);else if(f==="int32")m=new Int32Array(w);else{if(f!=="bool")throw new Error("Unsupported dtype in weight '"+c+"': "+f);m=new Uint8Array(w)}n+=v*A}e[c]=Sn(m,d,f)},i=0,s=t;i<s.length;i++)a(s[i]);return e}function LL(r){if(r===null)throw new Error("Invalid input value: "+JSON.stringify(r));var t=0,e=[];r.forEach(function(i){if(t+=i.byteLength,e.push(i.byteLength===i.buffer.byteLength?i:new i.constructor(i)),!(i instanceof Float32Array||i instanceof Int32Array||i instanceof Uint8Array))throw new Error("Unsupported TypedArray subtype: "+i.constructor.name)});var n=new Uint8Array(t),a=0;return e.forEach(function(i){n.set(new Uint8Array(i.buffer),a),a+=i.byteLength}),n.buffer}var jg=typeof Buffer<"u"&&(typeof Blob>"u"||typeof atob>"u"||typeof btoa>"u");function y_(r){return jg?Buffer.byteLength(r):new Blob([r]).size}function Hy(r){var t=0;r.forEach(function(a){t+=a.byteLength});var e=new Uint8Array(t),n=0;return r.forEach(function(a){e.set(new Uint8Array(a),n),n+=a.byteLength}),e.buffer}function b_(r){for(r=r.trim();r.endsWith("/");)r=r.slice(0,r.length-1);var t=r.split("/");return t[t.length-1]}function Fc(r){if(r.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:r.modelTopology==null?0:y_(JSON.stringify(r.modelTopology)),weightSpecsBytes:r.weightSpecs==null?0:y_(JSON.stringify(r.weightSpecs)),weightDataBytes:r.weightData==null?0:r.weightData.byteLength}}var fr=function(){function r(){this.saveRouters=[],this.loadRouters=[]}return r.getInstance=function(){return r.instance==null&&(r.instance=new r),r.instance},r.registerSaveRouter=function(t){r.getInstance().saveRouters.push(t)},r.registerLoadRouter=function(t){r.getInstance().loadRouters.push(t)},r.getSaveHandlers=function(t){return r.getHandlers(t,"save")},r.getLoadHandlers=function(t,e){return r.getHandlers(t,"load",e)},r.getHandlers=function(t,e,n){var a=[];return(e==="load"?r.getInstance().loadRouters:r.getInstance().saveRouters).forEach(function(i){var s=i(t,n);s!==null&&a.push(s)}),a},r}(),ou="://",to=function(){function r(){this.managers={}}return r.getInstance=function(){return r.instance==null&&(r.instance=new r),r.instance},r.registerManager=function(t,e){L(t!=null,function(){return"scheme must not be undefined or null."}),t.endsWith(ou)&&(t=t.slice(0,t.indexOf(ou))),L(t.length>0,function(){return"scheme must not be an empty string."});var n=r.getInstance();L(n.managers[t]==null,function(){return"A model store manager is already registered for scheme '"+t+"'."}),n.managers[t]=e},r.getManager=function(t){var e=this.getInstance().managers[t];if(e==null)throw new Error("Cannot find model manager for scheme '"+t+"'");return e},r.getSchemes=function(){return Object.keys(this.getInstance().managers)},r}();function Rh(r){if(r.indexOf(ou)===-1)throw new Error("The url string provided does not contain a scheme. Supported schemes are: "+to.getSchemes().join(","));return{scheme:r.split(ou)[0],path:r.split(ou)[1]}}function x_(r,t,e){return e===void 0&&(e=!1),Ee(this,void 0,void 0,function(){var n,a,i,s,l,c,f,d,v;return Ce(this,function(m){switch(m.label){case 0:return L(r!==t,function(){return"Old path and new path are the same: '"+r+"'"}),L((n=fr.getLoadHandlers(r)).length>0,function(){return"Copying failed because no load handler is found for source URL "+r+"."}),L(n.length<2,function(){return"Copying failed because more than one ("+n.length+") load handlers for source URL "+r+"."}),a=n[0],L((i=fr.getSaveHandlers(t)).length>0,function(){return"Copying failed because no save handler is found for destination URL "+t+"."}),L(i.length<2,function(){return"Copying failed because more than one ("+n.length+") save handlers for destination URL "+t+"."}),s=i[0],l=Rh(r).scheme,c=Rh(r).path,f=l===Rh(r).scheme,[4,a.load()];case 1:return d=m.sent(),e&&f?[4,to.getManager(l).removeModel(c)]:[3,3];case 2:m.sent(),m.label=3;case 3:return[4,s.save(d)];case 4:return v=m.sent(),!e||f?[3,6]:[4,to.getManager(l).removeModel(c)];case 5:m.sent(),m.label=6;case 6:return[2,v.modelArtifactsInfo]}})})}var Fo="models_store",Yi="model_info_store";function BC(){if(!le().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");var r=window||self,t=r.indexedDB||r.mozIndexedDB||r.webkitIndexedDB||r.msIndexedDB||r.shimIndexedDB;if(t==null)throw new Error("The current browser does not appear to support IndexedDB.");return t}function Wg(r){var t=r.result;t.createObjectStore(Fo,{keyPath:"modelPath"}),t.createObjectStore(Yi,{keyPath:"modelPath"})}var su=function(){function r(t){if(this.indexedDB=BC(),t==null||!t)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=t}return r.prototype.save=function(t){return Ee(this,void 0,void 0,function(){return Ce(this,function(e){if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return[2,this.databaseAction(this.modelPath,t)]})})},r.prototype.load=function(){return Ee(this,void 0,void 0,function(){return Ce(this,function(t){return[2,this.databaseAction(this.modelPath)]})})},r.prototype.databaseAction=function(t,e){var n=this;return new Promise(function(a,i){var s=n.indexedDB.open("tensorflowjs",1);s.onupgradeneeded=function(){return Wg(s)},s.onsuccess=function(){var l=s.result;if(e==null){var c=l.transaction(Fo,"readonly"),f=c.objectStore(Fo).get(n.modelPath);f.onsuccess=function(){if(f.result==null)return l.close(),i(new Error("Cannot find model with path '"+n.modelPath+"' in IndexedDB."));a(f.result.modelArtifacts)},f.onerror=function(w){return l.close(),i(f.error)},c.oncomplete=function(){return l.close()}}else{var d,v=Fc(e),m=l.transaction(Yi,"readwrite"),g=m.objectStore(Yi),b=g.put({modelPath:n.modelPath,modelArtifactsInfo:v});b.onsuccess=function(){var w=(d=l.transaction(Fo,"readwrite")).objectStore(Fo).put({modelPath:n.modelPath,modelArtifacts:e,modelArtifactsInfo:v});w.onsuccess=function(){return a({modelArtifactsInfo:v})},w.onerror=function(_){var S=(g=m.objectStore(Yi)).delete(n.modelPath);S.onsuccess=function(){return l.close(),i(w.error)},S.onerror=function(E){return l.close(),i(w.error)}}},b.onerror=function(w){return l.close(),i(b.error)},m.oncomplete=function(){d==null?l.close():d.oncomplete=function(){return l.close()}}}},s.onerror=function(l){return i(s.error)}})},r.URL_SCHEME="indexeddb://",r}(),w_=function(r){return le().getBool("IS_BROWSER")&&!Array.isArray(r)&&r.startsWith(su.URL_SCHEME)?(t=r.slice(su.URL_SCHEME.length),new su(t)):null;var t};fr.registerSaveRouter(w_),fr.registerLoadRouter(w_);var PL=function(){function r(){this.indexedDB=BC()}return r.prototype.listModels=function(){return Ee(this,void 0,void 0,function(){var t=this;return Ce(this,function(e){return[2,new Promise(function(n,a){var i=t.indexedDB.open("tensorflowjs",1);i.onupgradeneeded=function(){return Wg(i)},i.onsuccess=function(){var s=i.result,l=s.transaction(Yi,"readonly"),c=l.objectStore(Yi).getAll();c.onsuccess=function(){for(var f={},d=0,v=c.result;d<v.length;d++){var m=v[d];f[m.modelPath]=m.modelArtifactsInfo}n(f)},c.onerror=function(f){return s.close(),a(c.error)},l.oncomplete=function(){return s.close()}},i.onerror=function(s){return a(i.error)}})]})})},r.prototype.removeModel=function(t){return Ee(this,void 0,void 0,function(){var e=this;return Ce(this,function(n){var a;return t=(a=t).startsWith(su.URL_SCHEME)?a.slice(su.URL_SCHEME.length):a,[2,new Promise(function(i,s){var l=e.indexedDB.open("tensorflowjs",1);l.onupgradeneeded=function(){return Wg(l)},l.onsuccess=function(){var c,f=l.result,d=f.transaction(Yi,"readwrite"),v=d.objectStore(Yi),m=v.get(t);m.onsuccess=function(){if(m.result==null)return f.close(),s(new Error("Cannot find model with path '"+t+"' in IndexedDB."));var g=v.delete(t),b=function(){var w=(c=f.transaction(Fo,"readwrite")).objectStore(Fo).delete(t);w.onsuccess=function(){return i(m.result.modelArtifactsInfo)},w.onerror=function(_){return s(m.error)}};g.onsuccess=b,g.onerror=function(w){return b(),f.close(),s(m.error)}},m.onerror=function(g){return f.close(),s(m.error)},d.oncomplete=function(){c==null?f.close():c.oncomplete=function(){return f.close()}}},l.onerror=function(c){return s(l.error)}})]})})},r}();if(le().getBool("IS_BROWSER"))try{to.registerManager(su.URL_SCHEME,new PL)}catch{}var Ka="/",eu="tensorflowjs_models",LC="info",zL="model_topology",UL="weight_specs",VL="weight_data",HL="model_metadata";function PC(r){return{info:[eu,r,LC].join(Ka),topology:[eu,r,zL].join(Ka),weightSpecs:[eu,r,UL].join(Ka),weightData:[eu,r,VL].join(Ka),modelMetadata:[eu,r,HL].join(Ka)}}function jL(r){var t=r.split(Ka);if(t.length<3)throw new Error("Invalid key format: "+r);return t.slice(1,t.length-1).join(Ka)}var uu=function(){function r(t){if(!le().getBool("IS_BROWSER")||typeof window>"u"||window.localStorage===void 0)throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,t==null||!t)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=t,this.keys=PC(this.modelPath)}return r.prototype.save=function(t){return Ee(this,void 0,void 0,function(){var e,n,a;return Ce(this,function(i){if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");e=JSON.stringify(t.modelTopology),n=JSON.stringify(t.weightSpecs),a=Fc(t);try{return this.LS.setItem(this.keys.info,JSON.stringify(a)),this.LS.setItem(this.keys.topology,e),this.LS.setItem(this.keys.weightSpecs,n),this.LS.setItem(this.keys.weightData,function(s){if(jg)return Buffer.from(s).toString("base64");for(var l=new Uint8Array(s),c="",f=0,d=l.length;f<d;f++)c+=String.fromCharCode(l[f]);return btoa(c)}(t.weightData)),this.LS.setItem(this.keys.modelMetadata,JSON.stringify({format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,userDefinedMetadata:t.userDefinedMetadata})),[2,{modelArtifactsInfo:a}]}catch{throw this.LS.removeItem(this.keys.info),this.LS.removeItem(this.keys.topology),this.LS.removeItem(this.keys.weightSpecs),this.LS.removeItem(this.keys.weightData),this.LS.removeItem(this.keys.modelMetadata),new Error("Failed to save model '"+this.modelPath+"' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes="+a.modelTopologyBytes+", weightSpecsBytes="+a.weightSpecsBytes+", weightDataBytes="+a.weightDataBytes+".")}return[2]})})},r.prototype.load=function(){return Ee(this,void 0,void 0,function(){var t,e,n,a,i,s,l;return Ce(this,function(c){if((t=JSON.parse(this.LS.getItem(this.keys.info)))==null)throw new Error("In local storage, there is no model with name '"+this.modelPath+"'");if(t.modelTopologyType!=="JSON")throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");if(e={},(n=JSON.parse(this.LS.getItem(this.keys.topology)))==null)throw new Error("In local storage, the topology of model '"+this.modelPath+"' is missing.");if(e.modelTopology=n,(a=JSON.parse(this.LS.getItem(this.keys.weightSpecs)))==null)throw new Error("In local storage, the weight specs of model '"+this.modelPath+"' are missing.");if(e.weightSpecs=a,(i=this.LS.getItem(this.keys.modelMetadata))!=null&&(s=JSON.parse(i),e.format=s.format,e.generatedBy=s.generatedBy,e.convertedBy=s.convertedBy,e.userDefinedMetadata=s.userDefinedMetadata),(l=this.LS.getItem(this.keys.weightData))==null)throw new Error("In local storage, the binary weight values of model '"+this.modelPath+"' are missing.");return e.weightData=function(f){if(jg){var d=Buffer.from(f,"base64");return d.buffer.slice(d.byteOffset,d.byteOffset+d.byteLength)}for(var v=atob(f),m=new Uint8Array(v.length),g=0;g<v.length;++g)m.set([v.charCodeAt(g)],g);return m.buffer}(l),[2,e]})})},r.URL_SCHEME="localstorage://",r}(),__=function(r){return le().getBool("IS_BROWSER")&&!Array.isArray(r)&&r.startsWith(uu.URL_SCHEME)?(t=r.slice(uu.URL_SCHEME.length),new uu(t)):null;var t};fr.registerSaveRouter(__),fr.registerLoadRouter(__);var WL=function(){function r(){L(le().getBool("IS_BROWSER"),function(){return"Current environment is not a web browser"}),L(typeof window>"u"||window.localStorage!==void 0,function(){return"Current browser does not appear to support localStorage"}),this.LS=window.localStorage}return r.prototype.listModels=function(){return Ee(this,void 0,void 0,function(){var t,e,n,a,i,s;return Ce(this,function(l){for(t={},e=eu+Ka,n=Ka+LC,a=0;a<this.LS.length;++a)(i=this.LS.key(a)).startsWith(e)&&i.endsWith(n)&&(s=jL(i),t[s]=JSON.parse(this.LS.getItem(i)));return[2,t]})})},r.prototype.removeModel=function(t){return Ee(this,void 0,void 0,function(){var e,n;return Ce(this,function(a){var i;if(t=(i=t).startsWith(uu.URL_SCHEME)?i.slice(uu.URL_SCHEME.length):i,e=PC(t),this.LS.getItem(e.info)==null)throw new Error("Cannot find model at path '"+t+"'");return n=JSON.parse(this.LS.getItem(e.info)),this.LS.removeItem(e.info),this.LS.removeItem(e.topology),this.LS.removeItem(e.weightSpecs),this.LS.removeItem(e.weightData),[2,n]})})},r}();if(le().getBool("IS_BROWSER"))try{to.registerManager(uu.URL_SCHEME,new WL)}catch{}var GL="model",qL=".json",KL=".weights.bin";function S_(r){return new Promise(function(t){return setTimeout(t)}).then(r)}var Vm=function(){function r(t){if(!le().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");t.startsWith(r.URL_SCHEME)&&(t=t.slice(r.URL_SCHEME.length)),t!=null&&t.length!==0||(t=GL),this.modelTopologyFileName=t+qL,this.weightDataFileName=t+KL}return r.prototype.save=function(t){return Ee(this,void 0,void 0,function(){var e,n,a,i,s,l;return Ce(this,function(c){switch(c.label){case 0:if(typeof document>"u")throw new Error("Browser downloads are not supported in this environment since `document` is not present");if(e=window.URL.createObjectURL(new Blob([t.weightData],{type:"application/octet-stream"})),!(t.modelTopology instanceof ArrayBuffer))return[3,1];throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");case 1:return n=[{paths:["./"+this.weightDataFileName],weights:t.weightSpecs}],a={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,weightsManifest:n},i=window.URL.createObjectURL(new Blob([JSON.stringify(a)],{type:"application/json"})),(s=this.jsonAnchor==null?document.createElement("a"):this.jsonAnchor).download=this.modelTopologyFileName,s.href=i,[4,S_(function(){return s.dispatchEvent(new MouseEvent("click"))})];case 2:return c.sent(),t.weightData==null?[3,4]:((l=this.weightDataAnchor==null?document.createElement("a"):this.weightDataAnchor).download=this.weightDataFileName,l.href=e,[4,S_(function(){return l.dispatchEvent(new MouseEvent("click"))})]);case 3:c.sent(),c.label=4;case 4:return[2,{modelArtifactsInfo:Fc(t)}]}})})},r.URL_SCHEME="downloads://",r}(),XL=function(){function r(t){if(t==null||t.length<1)throw new Error("When calling browserFiles, at least 1 file is required, but received "+t);this.files=t}return r.prototype.load=function(){return Ee(this,void 0,void 0,function(){var t,e,n=this;return Ce(this,function(a){return t=this.files[0],e=this.files.slice(1),[2,new Promise(function(i,s){var l=new FileReader;l.onload=function(c){var f=JSON.parse(c.target.result),d=f.modelTopology;if(d!=null){e.length===0&&i({modelTopology:d});var v=f.weightsManifest;if(v!=null){var m;try{m=n.checkManifestAndWeightFiles(v,e)}catch(_){return void s(_)}var g=[],b=[],w=[];v.forEach(function(_){_.paths.forEach(function(S){b.push(S),w.push(null)}),g.push.apply(g,_.weights)}),v.forEach(function(_){_.paths.forEach(function(S){var E=new FileReader;E.onload=function(C){var R=C.target.result,A=b.indexOf(S);w[A]=R,w.indexOf(null)===-1&&i({modelTopology:d,weightSpecs:g,weightData:Hy(w),format:f.format,generatedBy:f.generatedBy,convertedBy:f.convertedBy,userDefinedMetadata:f.userDefinedMetadata})},E.onerror=function(C){return s("Failed to weights data from file of path '"+S+"'.")},E.readAsArrayBuffer(m[S])})})}else s(new Error("weightManifest field is missing from file "+t.name))}else s(new Error("modelTopology field is missing from file "+t.name))},l.onerror=function(c){return s("Failed to read model topology and weights manifest JSON from file '"+t.name+"'. BrowserFiles supports loading Keras-style tf.Model artifacts only.")},l.readAsText(t)})]})})},r.prototype.checkManifestAndWeightFiles=function(t,e){for(var n=[],a=e.map(function(c){return b_(c.name)}),i={},s=0,l=t;s<l.length;s++)l[s].paths.forEach(function(c){var f=b_(c);if(n.indexOf(f)!==-1)throw new Error("Duplicate file basename found in weights manifest: '"+f+"'");if(n.push(f),a.indexOf(f)===-1)throw new Error("Weight file with basename '"+f+"' is not provided.");i[c]=e[a.indexOf(f)]});if(n.length!==e.length)throw new Error("Mismatch in the number of files in weights manifest ("+n.length+") and the number of weight files provided ("+e.length+").");return i},r}();function E_(r,t,e,n){(function(i){L(i!=null&&Array.isArray(i)&&i.length>0,function(){return"promises must be a none empty array"})})(r),function(i,s){L(i>=0&&i<=1,function(){return"Progress fraction must be in range [0, 1], but got startFraction "+i}),L(s>=0&&s<=1,function(){return"Progress fraction must be in range [0, 1], but got endFraction "+s}),L(s>=i,function(){return"startFraction must be no more than endFraction, but got startFraction "+i+" and endFraction "+s})}(e=e??0,n=n??1);var a=0;return Promise.all(r.map(function(i){return i.then(function(s){var l=e+ ++a/r.length*(n-e);return t(l),s}),i}))}function zC(r,t){return Ee(this,void 0,void 0,function(){var e,n,a,i,s,l,c,f,d;return Ce(this,function(v){switch(v.label){case 0:return t==null&&(t={}),e=t.fetchFunc==null?le().platform.fetch:t.fetchFunc,n=r.map(function(m){return e(m,t.requestInit,{isBinary:!0})}),a=0,i=.5,t.onProgress!=null?[3,2]:[4,Promise.all(n)];case 1:return s=v.sent(),[3,4];case 2:return[4,E_(n,t.onProgress,a,i)];case 3:s=v.sent(),v.label=4;case 4:return l=s.map(function(m){return m.arrayBuffer()}),c=.5,f=1,t.onProgress!=null?[3,6]:[4,Promise.all(l)];case 5:return d=v.sent(),[3,8];case 6:return[4,E_(l,t.onProgress,c,f)];case 7:d=v.sent(),v.label=8;case 8:return[2,d]}})})}function C_(r){var t=this;return function(e,n,a){return n===void 0&&(n=""),Ee(t,void 0,void 0,function(){var i,s,l,c,f,d,v,m,g,b;return Ce(this,function(w){switch(w.label){case 0:if(i=e.map(function(){return!1}),s={},l=a!=null?a.map(function(){return!1}):[],c=[],e.forEach(function(_,S){var E=0;_.weights.forEach(function(C){var R="quantization"in C?C.quantization.dtype:C.dtype,A=Hg[R]*Ae(C.shape),D=function(){i[S]=!0,s[S]==null&&(s[S]=[]),s[S].push({manifestEntry:C,groupOffset:E,sizeBytes:A})};a!=null?a.forEach(function(k,I){k===C.name&&(D(),l[I]=!0)}):D(),c.push(C.name),E+=A})}),!l.every(function(_){return _}))throw f=a.filter(function(_,S){return!l[S]}),new Error("Could not find weights in manifest with names: "+f.join(", ")+`. 
Manifest JSON has weights with names: `+c.join(", ")+".");return d=i.reduce(function(_,S,E){return S&&_.push(E),_},[]),v=[],d.forEach(function(_){e[_].paths.forEach(function(S){var E=n+(n.endsWith("/")?"":"/")+S;v.push(E)})}),[4,r(v)];case 1:return m=w.sent(),g={},b=0,d.forEach(function(_){for(var S=e[_].paths.length,E=0,C=0;C<S;C++)E+=m[b+C].byteLength;for(var R=new ArrayBuffer(E),A=new Uint8Array(R),D=0,k=0;k<S;k++){var I=new Uint8Array(m[b+k]);A.set(I,D),D+=I.byteLength}s[_].forEach(function(O){var M=FC(R.slice(O.groupOffset,O.groupOffset+O.sizeBytes),[O.manifestEntry]);for(var V in M)g[V]=M[V]}),b+=S}),[2,g]}})})}}fr.registerSaveRouter(function(r){return le().getBool("IS_BROWSER")&&!Array.isArray(r)&&r.startsWith(Vm.URL_SCHEME)?function(t){return t===void 0&&(t="model"),new Vm(t)}(r.slice(Vm.URL_SCHEME.length)):null});var UC=function(){function r(t,e){if(this.DEFAULT_METHOD="POST",e==null&&(e={}),this.weightPathPrefix=e.weightPathPrefix,this.onProgress=e.onProgress,e.fetchFunc!=null?(L(typeof e.fetchFunc=="function",function(){return"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"}),this.fetch=e.fetchFunc):this.fetch=le().platform.fetch,L(t!=null&&t.length>0,function(){return"URL path for http must not be null, undefined or empty."}),Array.isArray(t)&&L(t.length===2,function(){return"URL paths for http must have a length of 2, (actual length is "+t.length+")."}),this.path=t,e.requestInit!=null&&e.requestInit.body!=null)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=e.requestInit||{}}return r.prototype.save=function(t){return Ee(this,void 0,void 0,function(){var e,n,a,i;return Ce(this,function(s){switch(s.label){case 0:if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");return(e=Object.assign({method:this.DEFAULT_METHOD},this.requestInit)).body=new FormData,n=[{paths:["./model.weights.bin"],weights:t.weightSpecs}],a={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,userDefinedMetadata:t.userDefinedMetadata,weightsManifest:n},e.body.append("model.json",new Blob([JSON.stringify(a)],{type:"application/json"}),"model.json"),t.weightData!=null&&e.body.append("model.weights.bin",new Blob([t.weightData],{type:"application/octet-stream"}),"model.weights.bin"),[4,this.fetch(this.path,e)];case 1:if((i=s.sent()).ok)return[2,{modelArtifactsInfo:Fc(t),responses:[i]}];throw new Error("BrowserHTTPRequest.save() failed due to HTTP response status "+i.status+".")}})})},r.prototype.load=function(){return Ee(this,void 0,void 0,function(){var t,e,n,a,i,s,l,c,f,d,v,m;return Ce(this,function(g){switch(g.label){case 0:return[4,this.fetch(this.path,this.requestInit)];case 1:if(!(t=g.sent()).ok)throw new Error("Request to "+this.path+" failed with status code "+t.status+". Please verify this URL points to the model JSON of the model to load.");g.label=2;case 2:return g.trys.push([2,4,,5]),[4,t.json()];case 3:return e=g.sent(),[3,5];case 4:throw g.sent(),n="Failed to parse model JSON of response from "+this.path+".",this.path.endsWith(".pb")?n+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":n+=" Please make sure the server is serving valid JSON for this request.",new Error(n);case 5:if(a=e.modelTopology,i=e.weightsManifest,s=e.generatedBy,l=e.convertedBy,c=e.format,f=e.userDefinedMetadata,a==null&&i==null)throw new Error("The JSON from HTTP path "+this.path+" contains neither model topology or manifest for weights.");return i==null?[3,7]:[4,this.loadWeights(i)];case 6:m=g.sent(),d=m[0],v=m[1],g.label=7;case 7:return[2,{modelTopology:a,weightSpecs:d,weightData:v,userDefinedMetadata:f,generatedBy:s,convertedBy:l,format:c}]}})})},r.prototype.loadWeights=function(t){return Ee(this,void 0,void 0,function(){var e,n,a,i,s,l,c,f,d,v,m;return Ce(this,function(g){switch(g.label){case 0:for(e=Array.isArray(this.path)?this.path[1]:this.path,n=function(b){var w=b.lastIndexOf("/"),_=b.lastIndexOf("?"),S=b.substring(0,w),E=_>w?b.substring(_):"";return[S+"/",E]}(e),a=n[0],i=n[1],s=this.weightPathPrefix||a,l=[],c=0,f=t;c<f.length;c++)d=f[c],l.push.apply(l,d.weights);return v=[],t.forEach(function(b){b.paths.forEach(function(w){v.push(s+w+i)})}),[4,zC(v,{requestInit:this.requestInit,fetchFunc:this.fetch,onProgress:this.onProgress})];case 1:return m=g.sent(),[2,[l,Hy(m)]]}})})},r.URL_SCHEME_REGEX=/^https?:\/\//,r}();function Gg(r){return r.match(UC.URL_SCHEME_REGEX)!=null}var R_=function(r,t){return typeof fetch>"u"?null:(Array.isArray(r)?r.every(function(e){return Gg(e)}):Gg(r))?qg(r,{onProgress:t}):null};function qg(r,t){return new UC(r,t)}fr.registerSaveRouter(R_),fr.registerLoadRouter(R_);var Hm=function(){function r(t){this.modelArtifacts=t}return r.prototype.load=function(){return Ee(this,void 0,void 0,function(){return Ce(this,function(t){return[2,this.modelArtifacts]})})},r}(),$L=function(){function r(t){this.saveHandler=t}return r.prototype.save=function(t){return Ee(this,void 0,void 0,function(){return Ce(this,function(e){return[2,this.saveHandler(t)]})})},r}(),VC=Object.freeze({browserFiles:function(r){return new XL(r)},browserHTTPRequest:function(r,t){return qg(r,t)},concatenateArrayBuffers:Hy,decodeWeights:FC,encodeWeights:function(r,t){return Ee(this,void 0,void 0,function(){var e,n,a,i,s,l=this;return Ce(this,function(c){switch(c.label){case 0:for(e=[],n=[],a=Array.isArray(r)?r.map(function(f){return f.name}):Object.keys(r),i=function(f){var d=a[f],v=Array.isArray(r)?r[f].tensor:r[d];if(v.dtype!=="float32"&&v.dtype!=="int32"&&v.dtype!=="bool"&&v.dtype!=="string")throw new Error("Unsupported dtype in weight '"+d+"': "+v.dtype);var m={name:d,shape:v.shape,dtype:v.dtype};if(v.dtype==="string"){var g=new Promise(function(b){return Ee(l,void 0,void 0,function(){var w,_,S,E,C,R,A;return Ce(this,function(D){switch(D.label){case 0:return[4,v.bytes()];case 1:for(w=D.sent(),_=w.reduce(function(k,I){return k+I.length},0)+ud*w.length,S=new Uint8Array(_),E=0,C=0;C<w.length;C++)R=w[C],A=new Uint8Array(new Uint32Array([R.length]).buffer),S.set(A,E),E+=ud,S.set(R,E),E+=R.length;return b(S),[2]}})})});n.push(g)}else n.push(v.data());t!=null&&(m.group=t),e.push(m)},s=0;s<a.length;++s)i(s);return[4,Promise.all(n)];case 1:return[2,{data:LL(c.sent()),specs:e}]}})})},fromMemory:function(r,t,e,n){return arguments.length===1?r.modelTopology!=null||r.weightSpecs!=null?new Hm(r):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new Hm({modelTopology:r})):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new Hm({modelTopology:r,weightSpecs:t,weightData:e,trainingConfig:n}))},getLoadHandlers:function(r,t){return fr.getLoadHandlers(r,t)},getModelArtifactsInfoForJSON:Fc,getSaveHandlers:function(r){return fr.getSaveHandlers(r)},http:qg,isHTTPScheme:Gg,loadWeights:function(r,t,e,n){return t===void 0&&(t=""),Ee(this,void 0,void 0,function(){return Ce(this,function(a){return[2,C_(function(i){return zC(i,{requestInit:n})})(r,t,e)]})})},registerLoadRouter:function(r){return fr.registerLoadRouter(r)},registerSaveRouter:function(r){return fr.registerSaveRouter(r)},weightsLoaderFactory:C_,withSaveHandler:function(r){return new $L(r)},copyModel:function(r,t){return Ee(this,void 0,void 0,function(){return Ce(this,function(e){return[2,x_(r,t,!1)]})})},listModels:function(){return Ee(this,void 0,void 0,function(){var r,t,e,n,a,i,s;return Ce(this,function(l){switch(l.label){case 0:r=to.getSchemes(),t={},e=0,n=r,l.label=1;case 1:return e<n.length?(a=n[e],[4,to.getManager(a).listModels()]):[3,4];case 2:for(s in i=l.sent())t[a+ou+s]=i[s];l.label=3;case 3:return e++,[3,1];case 4:return[2,t]}})})},moveModel:function(r,t){return Ee(this,void 0,void 0,function(){return Ce(this,function(e){return[2,x_(r,t,!0)]})})},removeModel:function(r){return Ee(this,void 0,void 0,function(){var t;return Ce(this,function(e){return t=Rh(r),[2,to.getManager(t.scheme).removeModel(t.path)]})})}}),Ks;j({confusionMatrix_:function(r,t,e){var n=B(r,"labels","confusionMatrix"),a=B(t,"predictions","confusionMatrix");L(e==null||e>0&&Number.isInteger(e),function(){return"If provided, numClasses must be a positive integer, but got "+e}),L(n.rank===1,function(){return"Expected the rank of labels to be 1, but got "+n.rank}),L(a.rank===1,function(){return"Expected the rank of predictions to be 1, but got "+a.rank}),L(n.shape[0]===a.shape[0],function(){return"Mismatch in the number of examples: "+n.shape[0]+" vs. "+a.shape[0]+". Labels and predictions should have the same number of elements."}),L(e>0&&Number.isInteger(e),function(){return"numClasses is required to be a positive integer, but got "+e});var i=Lg(n.asType("int32"),e),s=Lg(a.asType("int32"),e);return i.transpose().matMul(s).asType("int32")}});var YL=j({fromPixels_:function(r,t){if(t===void 0&&(t=3),t>4)throw new Error("Cannot construct Tensor with more than 4 channels from pixels.");if(r==null)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");var e=!1,n=!1,a=!1,i=!1,s=!1;if(r.data instanceof Uint8Array)e=!0;else if(typeof ImageData<"u"&&r instanceof ImageData)n=!0;else if(typeof HTMLVideoElement<"u"&&r instanceof HTMLVideoElement)a=!0;else if(typeof HTMLImageElement<"u"&&r instanceof HTMLImageElement)i=!0;else{if(r.getContext==null)throw new Error("pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData in browser, or OffscreenCanvas, ImageData in webworker or {data: Uint32Array, width: number, height: number}, but was "+r.constructor.name);s=!0}if(a&&a&&r.readyState<2)throw new Error("The video element has not loaded data yet. Please wait for `loadeddata` event on the <video> element.");if(fE("FromPixels",K.backendName)!=null)return K.runKernel("FromPixels",{pixels:r},{numChannels:t});var l,c,f=a?[r.videoWidth,r.videoHeight]:[r.width,r.height],d=f[0],v=f[1];if(s?l=r.getContext("2d").getImageData(0,0,d,v).data:n||e?l=r.data:(i||a)&&(Ks==null&&(Ks=document.createElement("canvas").getContext("2d")),Ks.canvas.width=d,Ks.canvas.height=v,Ks.drawImage(r,0,0,d,v),l=Ks.getImageData(0,0,d,v).data),t===4)c=new Int32Array(l);else{var m=d*v;c=new Int32Array(m*t);for(var g=0;g<m;g++)for(var b=0;b<t;++b)c[g*t+b]=l[4*g+b]}return gy(c,[v,d,t],"int32")}}),jy=Object.freeze({toPixels:function(r,t){return Ee(this,void 0,void 0,function(){var e,n,a,i,s,l,c,f,d,v,m,g,b,w,_,S,E,C,R,A,D,k,I;return Ce(this,function(O){switch(O.label){case 0:if(e=B(r,"img","toPixels"),r instanceof Nt||(e=e.toInt()),e.rank!==2&&e.rank!==3)throw new Error("toPixels only supports rank 2 or 3 tensors, got rank "+e.rank+".");if(n=e.shape.slice(0,2),a=n[0],i=n[1],(s=e.rank===2?1:e.shape[2])>4||s===2)throw new Error("toPixels only supports depth of size 1, 3 or 4 but got "+s);return[4,e.data()];case 1:return l=O.sent(),c=e.min(),f=e.max(),[4,Promise.all([c.data(),f.data()])];case 2:if(d=O.sent(),v=d[0],m=d[1],g=v[0],b=m[0],c.dispose(),f.dispose(),e.dtype==="float32"){if(g<0||b>1)throw new Error("Tensor values for a float32 Tensor must be in the range [0 - 1] but got range ["+g+" - "+b+"].")}else{if(e.dtype!=="int32")throw new Error("Unsupported type for toPixels: "+e.dtype+". Please use float32 or int32 tensors.");if(g<0||b>255)throw new Error("Tensor values for a int32 Tensor must be in the range [0 - 255] but got range ["+g+" - "+b+"].")}for(w=e.dtype==="float32"?255:1,_=new Uint8ClampedArray(i*a*4),S=0;S<a*i;++S)E=void 0,C=void 0,R=void 0,A=void 0,s===1?(E=l[S]*w,C=l[S]*w,R=l[S]*w,A=255):s===3?(E=l[3*S]*w,C=l[3*S+1]*w,R=l[3*S+2]*w,A=255):s===4&&(E=l[4*S]*w,C=l[4*S+1]*w,R=l[4*S+2]*w,A=l[4*S+3]*w),_[(D=4*S)+0]=Math.round(E),_[D+1]=Math.round(C),_[D+2]=Math.round(R),_[D+3]=Math.round(A);return t!=null&&(t.width=i,t.height=a,k=t.getContext("2d"),I=new ImageData(_,i,a),k.putImageData(I,0,0)),e!==r&&e.dispose(),[2,_]}})})},fromPixels:YL}),QL=function(){function r(){}return r.prototype.getClassName=function(){return this.constructor.className},r.fromConfig=function(t,e){return new t(e)},r}(),ZL=function(){function r(){this.classNameMap={}}return r.getMap=function(){return r.instance==null&&(r.instance=new r),r.instance},r.register=function(t){r.getMap().classNameMap[t.className]=[t,t.fromConfig]},r}();function ns(r){L(r.className!=null,function(){return"Class being registered does not have the static className property defined."}),L(typeof r.className=="string",function(){return"className is required to be a string, but got type "+typeof r.className}),L(r.className.length>0,function(){return"Class being registered has an empty-string as its className, which is disallowed."}),ZL.register(r)}var rs=function(r){function t(){return r!==null&&r.apply(this,arguments)||this}return Xr(t,r),t.prototype.minimize=function(e,n,a){n===void 0&&(n=!1);var i=this.computeGradients(e,a),s=i.value,l=i.grads;if(a!=null){var c=a.map(function(f){return{name:f.name,tensor:l[f.name]}});this.applyGradients(c)}else this.applyGradients(l);return Qn(l),n?s:(s.dispose(),null)},Object.defineProperty(t.prototype,"iterations",{get:function(){return this.iterations_==null&&(this.iterations_=0),this.iterations_},enumerable:!0,configurable:!0}),t.prototype.incrementIterations=function(){this.iterations_=this.iterations+1},t.prototype.computeGradients=function(e,n){return uM(e,n)},t.prototype.dispose=function(){this.iterations_!=null&&Qn(this.iterations_)},t.prototype.saveIterations=function(){return Ee(this,void 0,void 0,function(){return Ce(this,function(e){return this.iterations_==null&&(this.iterations_=0),[2,{name:"iter",tensor:ye(this.iterations_,"int32")}]})})},t.prototype.getWeights=function(){return Ee(this,void 0,void 0,function(){return Ce(this,function(e){throw new Error("getWeights() is not implemented for this optimizer yet.")})})},t.prototype.setWeights=function(e){return Ee(this,void 0,void 0,function(){return Ce(this,function(n){throw new Error("setWeights() is not implemented for this optimizer class "+this.getClassName())})})},t.prototype.extractIterations=function(e){return Ee(this,void 0,void 0,function(){var n;return Ce(this,function(a){switch(a.label){case 0:return n=this,[4,e[0].tensor.data()];case 1:return n.iterations_=a.sent()[0],[2,e.slice(1)]}})})},t}(QL);Object.defineProperty(rs,Symbol.hasInstance,{value:function(r){return r.minimize!=null&&r.computeGradients!=null&&r.applyGradients!=null}});var JL=function(r){function t(e,n,a){a===void 0&&(a=null);var i=r.call(this)||this;return i.learningRate=e,i.rho=n,i.epsilon=a,i.accumulatedGrads=[],i.accumulatedUpdates=[],a==null&&(i.epsilon=K.backend.epsilon()),i}return Xr(t,r),t.prototype.applyGradients=function(e){var n=this;(Array.isArray(e)?e.map(function(a){return a.name}):Object.keys(e)).forEach(function(a,i){var s=K.registeredVariables[a];n.accumulatedGrads[i]==null&&(n.accumulatedGrads[i]={originalName:a+"/accum_grad",variable:_e(function(){return st(s).variable(!1)})}),n.accumulatedUpdates[i]==null&&(n.accumulatedUpdates[i]={originalName:a+"/accum_var",variable:_e(function(){return st(s).variable(!1)})});var l=Array.isArray(e)?e[i].tensor:e[a];if(l!=null){var c=n.accumulatedGrads[i].variable,f=n.accumulatedUpdates[i].variable;_e(function(){var d=c.mul(n.rho).add(l.square().mul(1-n.rho)),v=f.add(n.epsilon).sqrt().div(c.add(n.epsilon).sqrt()).mul(l),m=f.mul(n.rho).add(v.square().mul(1-n.rho));c.assign(d),f.assign(m);var g=v.mul(-n.learningRate).add(s);s.assign(g)})}}),this.incrementIterations()},t.prototype.dispose=function(){this.accumulatedUpdates!=null&&(Qn(this.accumulatedGrads.map(function(e){return e.variable})),Qn(this.accumulatedUpdates.map(function(e){return e.variable})))},t.prototype.getWeights=function(){return Ee(this,void 0,void 0,function(){var e;return Ce(this,function(n){switch(n.label){case 0:return e=this.accumulatedGrads.concat(this.accumulatedUpdates),[4,this.saveIterations()];case 1:return[2,[n.sent()].concat(e.map(function(a){return{name:a.originalName,tensor:a.variable}}))]}})})},t.prototype.setWeights=function(e){return Ee(this,void 0,void 0,function(){var n;return Ce(this,function(a){switch(a.label){case 0:return[4,this.extractIterations(e)];case 1:return e=a.sent(),n=e.length/2,this.accumulatedGrads=e.slice(0,n).map(function(i){return{originalName:i.name,variable:i.tensor.variable(!1)}}),this.accumulatedUpdates=e.slice(n,2*n).map(function(i){return{originalName:i.name,variable:i.tensor.variable(!1)}}),[2]}})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}},t.fromConfig=function(e,n){return new e(n.learningRate,n.rho,n.epsilon)},t.className="Adadelta",t}(rs);ns(JL);var eP=function(r){function t(e,n){n===void 0&&(n=.1);var a=r.call(this)||this;return a.learningRate=e,a.initialAccumulatorValue=n,a.accumulatedGrads=[],a}return Xr(t,r),t.prototype.applyGradients=function(e){var n=this;(Array.isArray(e)?e.map(function(a){return a.name}):Object.keys(e)).forEach(function(a,i){var s=K.registeredVariables[a];n.accumulatedGrads[i]==null&&(n.accumulatedGrads[i]={originalName:a+"/accumulator",variable:_e(function(){return ga(s.shape,n.initialAccumulatorValue).variable(!1)})});var l=Array.isArray(e)?e[i].tensor:e[a];if(l!=null){var c=n.accumulatedGrads[i].variable;_e(function(){var f=c.add(l.square());c.assign(f);var d=l.div(f.add(K.backend.epsilon()).sqrt()).mul(-n.learningRate).add(s);s.assign(d)})}}),this.incrementIterations()},t.prototype.dispose=function(){this.accumulatedGrads!=null&&Qn(this.accumulatedGrads.map(function(e){return e.variable}))},t.prototype.getWeights=function(){return Ee(this,void 0,void 0,function(){return Ce(this,function(e){switch(e.label){case 0:return[4,this.saveIterations()];case 1:return[2,[e.sent()].concat(this.accumulatedGrads.map(function(n){return{name:n.originalName,tensor:n.variable}}))]}})})},t.prototype.setWeights=function(e){return Ee(this,void 0,void 0,function(){return Ce(this,function(n){switch(n.label){case 0:return[4,this.extractIterations(e)];case 1:return e=n.sent(),this.accumulatedGrads=e.map(function(a){return{originalName:a.name,variable:a.tensor.variable(!1)}}),[2]}})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}},t.fromConfig=function(e,n){return new e(n.learningRate,n.initialAccumulatorValue)},t.className="Adagrad",t}(rs);ns(eP);var tP=function(r){function t(e,n,a,i){i===void 0&&(i=null);var s=r.call(this)||this;return s.learningRate=e,s.beta1=n,s.beta2=a,s.epsilon=i,s.accumulatedFirstMoment=[],s.accumulatedSecondMoment=[],_e(function(){s.accBeta1=ye(n).variable(),s.accBeta2=ye(a).variable()}),i==null&&(s.epsilon=K.backend.epsilon()),s}return Xr(t,r),t.prototype.applyGradients=function(e){var n=this,a=Array.isArray(e)?e.map(function(i){return i.name}):Object.keys(e);_e(function(){var i=on(1,n.accBeta1),s=on(1,n.accBeta2);a.forEach(function(l,c){var f=K.registeredVariables[l];n.accumulatedFirstMoment[c]==null&&(n.accumulatedFirstMoment[c]={originalName:l+"/m",variable:_e(function(){return st(f).variable(!1)})}),n.accumulatedSecondMoment[c]==null&&(n.accumulatedSecondMoment[c]={originalName:l+"/v",variable:_e(function(){return st(f).variable(!1)})});var d=Array.isArray(e)?e[c].tensor:e[l];if(d!=null){var v=n.accumulatedFirstMoment[c].variable,m=n.accumulatedSecondMoment[c].variable,g=v.mul(n.beta1).add(d.mul(1-n.beta1)),b=m.mul(n.beta2).add(d.square().mul(1-n.beta2)),w=g.div(i),_=b.div(s);v.assign(g),m.assign(b);var S=w.div(_.sqrt().add(n.epsilon)).mul(-n.learningRate).add(f);f.assign(S)}}),n.accBeta1.assign(n.accBeta1.mul(n.beta1)),n.accBeta2.assign(n.accBeta2.mul(n.beta2))}),this.incrementIterations()},t.prototype.dispose=function(){this.accBeta1.dispose(),this.accBeta2.dispose(),this.accumulatedFirstMoment!=null&&Qn(this.accumulatedFirstMoment.map(function(e){return e.variable})),this.accumulatedSecondMoment!=null&&Qn(this.accumulatedSecondMoment.map(function(e){return e.variable}))},t.prototype.getWeights=function(){return Ee(this,void 0,void 0,function(){var e;return Ce(this,function(n){switch(n.label){case 0:return e=this.accumulatedFirstMoment.concat(this.accumulatedSecondMoment),[4,this.saveIterations()];case 1:return[2,[n.sent()].concat(e.map(function(a){return{name:a.originalName,tensor:a.variable}}))]}})})},t.prototype.setWeights=function(e){return Ee(this,void 0,void 0,function(){var n,a=this;return Ce(this,function(i){switch(i.label){case 0:return[4,this.extractIterations(e)];case 1:return e=i.sent(),_e(function(){a.accBeta1.assign(od(a.beta1,a.iterations_+1)),a.accBeta2.assign(od(a.beta2,a.iterations_+1))}),n=e.length/2,this.accumulatedFirstMoment=e.slice(0,n).map(function(s){return{originalName:s.name,variable:s.tensor.variable(!1)}}),this.accumulatedSecondMoment=e.slice(n,2*n).map(function(s){return{originalName:s.name,variable:s.tensor.variable(!1)}}),[2]}})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}},t.fromConfig=function(e,n){return new e(n.learningRate,n.beta1,n.beta2,n.epsilon)},t.className="Adam",t}(rs);ns(tP);var nP=function(r){function t(e,n,a,i,s){i===void 0&&(i=null),s===void 0&&(s=0);var l=r.call(this)||this;return l.learningRate=e,l.beta1=n,l.beta2=a,l.epsilon=i,l.decay=s,l.accumulatedFirstMoment=[],l.accumulatedWeightedInfNorm=[],_e(function(){l.iteration=ye(0).variable(),l.accBeta1=ye(n).variable()}),i==null&&(l.epsilon=K.backend.epsilon()),l}return Xr(t,r),t.prototype.applyGradients=function(e){var n=this,a=Array.isArray(e)?e.map(function(i){return i.name}):Object.keys(e);_e(function(){var i=on(1,n.accBeta1),s=jr(-n.learningRate,n.iteration.mul(n.decay).add(1));a.forEach(function(l,c){var f=K.registeredVariables[l];n.accumulatedFirstMoment[c]==null&&(n.accumulatedFirstMoment[c]={originalName:l+"/m",variable:st(f).variable(!1)}),n.accumulatedWeightedInfNorm[c]==null&&(n.accumulatedWeightedInfNorm[c]={originalName:l+"/v",variable:st(f).variable(!1)});var d=Array.isArray(e)?e[c].tensor:e[l];if(d!=null){var v=n.accumulatedFirstMoment[c].variable,m=n.accumulatedWeightedInfNorm[c].variable,g=v.mul(n.beta1).add(d.mul(1-n.beta1)),b=m.mul(n.beta2),w=d.abs(),_=b.maximum(w);v.assign(g),m.assign(_);var S=s.div(i).mul(g.div(_.add(n.epsilon))).add(f);f.assign(S)}}),n.iteration.assign(n.iteration.add(1)),n.accBeta1.assign(n.accBeta1.mul(n.beta1))}),this.incrementIterations()},t.prototype.dispose=function(){this.accBeta1.dispose(),this.iteration.dispose(),this.accumulatedFirstMoment!=null&&Qn(this.accumulatedFirstMoment.map(function(e){return e.variable})),this.accumulatedWeightedInfNorm!=null&&Qn(this.accumulatedWeightedInfNorm.map(function(e){return e.variable}))},t.prototype.getWeights=function(){return Ee(this,void 0,void 0,function(){return Ce(this,function(e){throw new Error("getWeights() is not implemented for Adamax yet.")})})},t.prototype.setWeights=function(e){return Ee(this,void 0,void 0,function(){return Ce(this,function(n){throw new Error("setWeights() is not implemented for Adamax yet.")})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}},t.fromConfig=function(e,n){return new e(n.learningRate,n.beta1,n.beta2,n.epsilon,n.decay)},t.className="Adamax",t}(rs);ns(nP);var HC=function(r){function t(e){var n=r.call(this)||this;return n.learningRate=e,n.setLearningRate(e),n}return Xr(t,r),t.prototype.applyGradients=function(e){var n=this;(Array.isArray(e)?e.map(function(a){return a.name}):Object.keys(e)).forEach(function(a,i){var s=Array.isArray(e)?e[i].tensor:e[a];if(s!=null){var l=K.registeredVariables[a];_e(function(){var c=n.c.mul(s).add(l);l.assign(c)})}}),this.incrementIterations()},t.prototype.setLearningRate=function(e){this.learningRate=e,this.c!=null&&this.c.dispose(),this.c=_4(ye(-e))},t.prototype.dispose=function(){this.c.dispose()},t.prototype.getWeights=function(){return Ee(this,void 0,void 0,function(){return Ce(this,function(e){switch(e.label){case 0:return[4,this.saveIterations()];case 1:return[2,[e.sent()]]}})})},t.prototype.setWeights=function(e){return Ee(this,void 0,void 0,function(){return Ce(this,function(n){switch(n.label){case 0:return[4,this.extractIterations(e)];case 1:if((e=n.sent()).length!==0)throw new Error("SGD optimizer does not have settable weights.");return[2]}})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate}},t.fromConfig=function(e,n){return new e(n.learningRate)},t.className="SGD",t}(rs);ns(HC);var rP=function(r){function t(e,n,a){a===void 0&&(a=!1);var i=r.call(this,e)||this;return i.learningRate=e,i.momentum=n,i.useNesterov=a,i.accumulations=[],i.m=ye(i.momentum),i}return Xr(t,r),t.prototype.applyGradients=function(e){var n=this;(Array.isArray(e)?e.map(function(a){return a.name}):Object.keys(e)).forEach(function(a,i){var s=K.registeredVariables[a];n.accumulations[i]==null&&(n.accumulations[i]={originalName:a+"/momentum",variable:_e(function(){return st(s).variable(!1)})});var l=n.accumulations[i].variable,c=Array.isArray(e)?e[i].tensor:e[a];c!=null&&_e(function(){var f,d=n.m.mul(l).add(c);f=n.useNesterov?n.c.mul(c.add(d.mul(n.m))).add(s):n.c.mul(d).add(s),l.assign(d),s.assign(f)})}),this.incrementIterations()},t.prototype.dispose=function(){this.m.dispose(),this.accumulations!=null&&Qn(this.accumulations.map(function(e){return e.variable}))},t.prototype.setMomentum=function(e){this.momentum=e},t.prototype.getWeights=function(){return Ee(this,void 0,void 0,function(){return Ce(this,function(e){switch(e.label){case 0:return[4,this.saveIterations()];case 1:return[2,[e.sent()].concat(this.accumulations.map(function(n){return{name:n.originalName,tensor:n.variable}}))]}})})},t.prototype.setWeights=function(e){return Ee(this,void 0,void 0,function(){return Ce(this,function(n){switch(n.label){case 0:return[4,this.extractIterations(e)];case 1:return e=n.sent(),this.accumulations=e.map(function(a){return{originalName:a.name,variable:a.tensor.variable(!1)}}),[2]}})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}},t.fromConfig=function(e,n){return new e(n.learningRate,n.momentum,n.useNesterov)},t.className="Momentum",t}(HC);ns(rP);var aP=function(r){function t(e,n,a,i,s){n===void 0&&(n=.9),a===void 0&&(a=0),i===void 0&&(i=null),s===void 0&&(s=!1);var l=r.call(this)||this;if(l.learningRate=e,l.decay=n,l.momentum=a,l.epsilon=i,l.accumulatedMeanSquares=[],l.accumulatedMoments=[],l.accumulatedMeanGrads=[],l.centered=s,i==null&&(l.epsilon=K.backend.epsilon()),e==null)throw new Error("learningRate for RMSPropOptimizer must be defined.");return l}return Xr(t,r),t.prototype.applyGradients=function(e){var n=this;(Array.isArray(e)?e.map(function(a){return a.name}):Object.keys(e)).forEach(function(a,i){var s=K.registeredVariables[a];n.accumulatedMeanSquares[i]==null&&(n.accumulatedMeanSquares[i]={originalName:a+"/rms",variable:_e(function(){return st(s).variable(!1)})}),n.accumulatedMoments[i]==null&&(n.accumulatedMoments[i]={originalName:a+"/momentum",variable:_e(function(){return st(s).variable(!1)})}),n.accumulatedMeanGrads[i]==null&&n.centered&&(n.accumulatedMeanGrads[i]={originalName:a+"/mg",variable:_e(function(){return st(s).variable(!1)})});var l=Array.isArray(e)?e[i].tensor:e[a];if(l!=null){var c=n.accumulatedMeanSquares[i].variable,f=n.accumulatedMoments[i].variable;_e(function(){var d=c.mul(n.decay).add(l.square().mul(1-n.decay));if(n.centered){var v=n.accumulatedMeanGrads[i].variable,m=v.mul(n.decay).add(l.mul(1-n.decay)),g=f.mul(n.momentum).add(l.mul(n.learningRate).div(d.sub(m.square().add(n.epsilon)).sqrt()));c.assign(d),v.assign(m),f.assign(g);var b=s.sub(g);s.assign(b)}else{var w=c.mul(n.decay).add(l.square().mul(1-n.decay));g=f.mul(n.momentum).add(l.mul(n.learningRate).div(w.add(n.epsilon).sqrt())),c.assign(w),f.assign(g),b=s.sub(g),s.assign(b)}})}}),this.incrementIterations()},t.prototype.dispose=function(){this.accumulatedMeanSquares!=null&&Qn(this.accumulatedMeanSquares.map(function(e){return e.variable})),this.accumulatedMeanGrads!=null&&this.centered&&Qn(this.accumulatedMeanGrads.map(function(e){return e.variable})),this.accumulatedMoments!=null&&Qn(this.accumulatedMoments.map(function(e){return e.variable}))},t.prototype.getWeights=function(){return Ee(this,void 0,void 0,function(){var e;return Ce(this,function(n){switch(n.label){case 0:return e=this.accumulatedMeanSquares.concat(this.accumulatedMoments),this.centered&&e.push.apply(e,this.accumulatedMeanGrads),[4,this.saveIterations()];case 1:return[2,[n.sent()].concat(e.map(function(a){return{name:a.originalName,tensor:a.variable}}))]}})})},t.prototype.setWeights=function(e){return Ee(this,void 0,void 0,function(){var n;return Ce(this,function(a){switch(a.label){case 0:return[4,this.extractIterations(e)];case 1:return e=a.sent(),n=this.centered?e.length/3:e.length/2,this.accumulatedMeanSquares=e.slice(0,n).map(function(i){return{originalName:i.name,variable:i.tensor.variable(!1)}}),this.accumulatedMoments=e.slice(n,2*n).map(function(i){return{originalName:i.name,variable:i.tensor.variable(!1)}}),this.centered&&(this.accumulatedMeanGrads=e.slice(2*n,3*n).map(function(i){return{originalName:i.name,variable:i.tensor.variable(!1)}})),[2]}})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}},t.fromConfig=function(e,n){return new e(n.learningRate,n.decay,n.momentum,n.epsilon,n.centered)},t.className="RMSProp",t}(rs);ns(aP);Nt.prototype.squaredDifference=function(r){return rC(this,r)},ue=kL;/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var Kg=function(r,t){return Kg=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var a in n)n.hasOwnProperty(a)&&(e[a]=n[a])},Kg(r,t)};function He(r,t){Kg(r,t);function e(){this.constructor=r}r.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}var kn=function(){return kn=Object.assign||function(t){for(var e,n=1,a=arguments.length;n<a;n++){e=arguments[n];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}return t},kn.apply(this,arguments)};function ke(r,t,e,n){function a(i){return i instanceof e?i:new e(function(s){s(i)})}return new(e||(e=Promise))(function(i,s){function l(d){try{f(n.next(d))}catch(v){s(v)}}function c(d){try{f(n.throw(d))}catch(v){s(v)}}function f(d){d.done?i(d.value):a(d.value).then(l,c)}f((n=n.apply(r,[])).next())})}function Oe(r,t){var e={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,a,i,s;return s={next:l(0),throw:l(1),return:l(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function l(f){return function(d){return c([f,d])}}function c(f){if(n)throw new TypeError("Generator is already executing.");for(;e;)try{if(n=1,a&&(i=f[0]&2?a.return:f[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,f[1])).done)return i;switch(a=0,i&&(f=[f[0]&2,i.value]),f[0]){case 0:case 1:i=f;break;case 4:return e.label++,{value:f[1],done:!1};case 5:e.label++,a=f[1],f=[0];continue;case 7:f=e.ops.pop(),e.trys.pop();continue;default:if(i=e.trys,!(i=i.length>0&&i[i.length-1])&&(f[0]===6||f[0]===2)){e=0;continue}if(f[0]===3&&(!i||f[1]>i[0]&&f[1]<i[3])){e.label=f[1];break}if(f[0]===6&&e.label<i[1]){e.label=i[1],i=f;break}if(i&&e.label<i[2]){e.label=i[2],e.ops.push(f);break}i[2]&&e.ops.pop(),e.trys.pop();continue}f=t.call(r,e)}catch(d){f=[6,d],a=0}finally{n=i=0}if(f[0]&5)throw f[1];return{value:f[0]?f[1]:void 0,done:!0}}}function nc(){for(var r=0,t=0,e=arguments.length;t<e;t++)r+=arguments[t].length;for(var n=Array(r),a=0,t=0;t<e;t++)for(var i=arguments[t],s=0,l=i.length;s<l;s++,a++)n[a]=i[s];return n}var qo=function(){function r(t,e){if(!Ko(t)||!Ko(e))throw new Error("Dimensions.constructor - expected width and height to be valid numbers, instead have "+JSON.stringify({width:t,height:e}));this._width=t,this._height=e}return Object.defineProperty(r.prototype,"width",{get:function(){return this._width},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"height",{get:function(){return this._height},enumerable:!0,configurable:!0}),r.prototype.reverse=function(){return new r(1/this.width,1/this.height)},r}();function kd(r,t){return r instanceof Nt&&r.shape.length===t}function iP(r){return kd(r,2)}function Od(r){return kd(r,3)}function no(r){return kd(r,4)}function oP(r){return r%1!==0}function A_(r){return r%2===0}function Wy(r,t){t===void 0&&(t=2);var e=Math.pow(10,t);return Math.floor(r*e)/e}function T_(r){return r&&r.width&&r.height}function sP(r,t){var e=r.width,n=r.height,a=t/Math.max(n,e);return new qo(Math.round(e*a),Math.round(n*a))}function Gy(r){return r.reduce(function(t,e){return t.add(e)},new ht(0,0)).div(new ht(r.length,r.length))}function mc(r,t,e){return Array(r).fill(0).map(function(n,a){return t+a*e})}function Ko(r){return!!r&&r!==1/0&&r!==-1/0&&!isNaN(r)||r===0}function D_(r){return Ko(r)&&0<=r&&r<=1}var ht=function(){function r(t,e){this._x=t,this._y=e}return Object.defineProperty(r.prototype,"x",{get:function(){return this._x},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"y",{get:function(){return this._y},enumerable:!0,configurable:!0}),r.prototype.add=function(t){return new r(this.x+t.x,this.y+t.y)},r.prototype.sub=function(t){return new r(this.x-t.x,this.y-t.y)},r.prototype.mul=function(t){return new r(this.x*t.x,this.y*t.y)},r.prototype.div=function(t){return new r(this.x/t.x,this.y/t.y)},r.prototype.abs=function(){return new r(Math.abs(this.x),Math.abs(this.y))},r.prototype.magnitude=function(){return Math.sqrt(Math.pow(this.x,2)+Math.pow(this.y,2))},r.prototype.floor=function(){return new r(Math.floor(this.x),Math.floor(this.y))},r}(),ba=function(){function r(t,e){e===void 0&&(e=!0);var n=t||{},a=[n.left,n.top,n.right,n.bottom].every(Ko),i=[n.x,n.y,n.width,n.height].every(Ko);if(!i&&!a)throw new Error("Box.constructor - expected box to be IBoundingBox | IRect, instead have "+JSON.stringify(n));var s=i?[n.x,n.y,n.width,n.height]:[n.left,n.top,n.right-n.left,n.bottom-n.top],l=s[0],c=s[1],f=s[2],d=s[3];r.assertIsValidBox({x:l,y:c,width:f,height:d},"Box.constructor",e),this._x=l,this._y=c,this._width=f,this._height=d}return r.isRect=function(t){return!!t&&[t.x,t.y,t.width,t.height].every(Ko)},r.assertIsValidBox=function(t,e,n){if(n===void 0&&(n=!1),!r.isRect(t))throw new Error(e+" - invalid box: "+JSON.stringify(t)+", expected object with properties x, y, width, height");if(!n&&(t.width<0||t.height<0))throw new Error(e+" - width ("+t.width+") and height ("+t.height+") must be positive numbers")},Object.defineProperty(r.prototype,"x",{get:function(){return this._x},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"y",{get:function(){return this._y},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"width",{get:function(){return this._width},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"height",{get:function(){return this._height},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"left",{get:function(){return this.x},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"top",{get:function(){return this.y},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"right",{get:function(){return this.x+this.width},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"bottom",{get:function(){return this.y+this.height},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"area",{get:function(){return this.width*this.height},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"topLeft",{get:function(){return new ht(this.left,this.top)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"topRight",{get:function(){return new ht(this.right,this.top)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"bottomLeft",{get:function(){return new ht(this.left,this.bottom)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"bottomRight",{get:function(){return new ht(this.right,this.bottom)},enumerable:!0,configurable:!0}),r.prototype.round=function(){var t=[this.x,this.y,this.width,this.height].map(function(s){return Math.round(s)}),e=t[0],n=t[1],a=t[2],i=t[3];return new r({x:e,y:n,width:a,height:i})},r.prototype.floor=function(){var t=[this.x,this.y,this.width,this.height].map(function(s){return Math.floor(s)}),e=t[0],n=t[1],a=t[2],i=t[3];return new r({x:e,y:n,width:a,height:i})},r.prototype.toSquare=function(){var t=this,e=t.x,n=t.y,a=t.width,i=t.height,s=Math.abs(a-i);return a<i&&(e-=s/2,a+=s),i<a&&(n-=s/2,i+=s),new r({x:e,y:n,width:a,height:i})},r.prototype.rescale=function(t){var e=T_(t)?t.width:t,n=T_(t)?t.height:t;return new r({x:this.x*e,y:this.y*n,width:this.width*e,height:this.height*n})},r.prototype.pad=function(t,e){var n=[this.x-t/2,this.y-e/2,this.width+t,this.height+e],a=n[0],i=n[1],s=n[2],l=n[3];return new r({x:a,y:i,width:s,height:l})},r.prototype.clipAtImageBorders=function(t,e){var n=this,a=n.x,i=n.y,s=n.right,l=n.bottom,c=Math.max(a,0),f=Math.max(i,0),d=s-c,v=l-f,m=Math.min(d,t-c),g=Math.min(v,e-f);return new r({x:c,y:f,width:m,height:g}).floor()},r.prototype.shift=function(t,e){var n=this,a=n.width,i=n.height,s=this.x+t,l=this.y+e;return new r({x:s,y:l,width:a,height:i})},r.prototype.padAtBorders=function(t,e){var n=this.width+1,a=this.height+1,i=1,s=1,l=n,c=a,f=this.left,d=this.top,v=this.right,m=this.bottom;return v>e&&(l=-v+e+n,v=e),m>t&&(c=-m+t+a,m=t),f<1&&(c=2-f,f=1),d<1&&(c=2-d,d=1),{dy:s,edy:c,dx:i,edx:l,y:d,ey:m,x:f,ex:v,w:n,h:a}},r.prototype.calibrate=function(t){return new r({left:this.left+t.left*this.width,top:this.top+t.top*this.height,right:this.right+t.right*this.width,bottom:this.bottom+t.bottom*this.height}).toSquare().round()},r}(),Nd=function(r){He(t,r);function t(e,n,a,i,s){return s===void 0&&(s=!1),r.call(this,{left:e,top:n,right:a,bottom:i},s)||this}return t}(ba),jC=function(){function r(t,e,n,a,i){this._imageDims=new qo(i.width,i.height),this._score=t,this._classScore=e,this._className=n,this._box=new ba(a).rescale(this._imageDims)}return Object.defineProperty(r.prototype,"score",{get:function(){return this._score},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"classScore",{get:function(){return this._classScore},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"className",{get:function(){return this._className},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"box",{get:function(){return this._box},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"imageDims",{get:function(){return this._imageDims},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"imageWidth",{get:function(){return this.imageDims.width},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"imageHeight",{get:function(){return this.imageDims.height},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"relativeBox",{get:function(){return new ba(this._box).rescale(this.imageDims.reverse())},enumerable:!0,configurable:!0}),r.prototype.forSize=function(t,e){return new r(this.score,this.classScore,this.className,this.relativeBox,{width:t,height:e})},r}(),vr=function(r){He(t,r);function t(e,n,a){return r.call(this,e,e,"",n,a)||this}return t.prototype.forSize=function(e,n){var a=r.prototype.forSize.call(this,e,n),i=a.score,s=a.relativeBox,l=a.imageDims;return new t(i,s,l)},t}(jC);function uP(r,t,e){e===void 0&&(e=!0);var n=Math.max(0,Math.min(r.right,t.right)-Math.max(r.left,t.left)),a=Math.max(0,Math.min(r.bottom,t.bottom)-Math.max(r.top,t.top)),i=n*a;return e?i/(r.area+t.area-i):i/Math.min(r.area,t.area)}function lP(r){var t=r.map(function(l){return l.x}),e=r.map(function(l){return l.y}),n=t.reduce(function(l,c){return c<l?c:l},1/0),a=e.reduce(function(l,c){return c<l?c:l},1/0),i=t.reduce(function(l,c){return l<c?c:l},0),s=e.reduce(function(l,c){return l<c?c:l},0);return new Nd(n,a,i,s)}function gc(r,t,e,n){n===void 0&&(n=!0);for(var a=t.map(function(l,c){return{score:l,boxIndex:c}}).sort(function(l,c){return l.score-c.score}).map(function(l){return l.boxIndex}),i=[],s=function(){var l=a.pop();i.push(l);for(var c=a,f=[],d=0;d<c.length;d++){var v=c[d],m=r[l],g=r[v];f.push(uP(m,g,n))}a=a.filter(function(b,w){return f[w]<=e})};a.length>0;)s();return i}function Bc(r,t){return _e(function(){var e=t[0],n=t[1],a=t[2],i=ga(nc(r.shape.slice(0,3),[1]),e),s=ga(nc(r.shape.slice(0,3),[1]),n),l=ga(nc(r.shape.slice(0,3),[1]),a),c=nn([i,s,l],3);return on(r,c)})}function cP(r,t){return t===void 0&&(t=!1),_e(function(){var e=r.shape.slice(1),n=e[0],a=e[1];if(n===a)return r;var i=Math.abs(n-a),s=Math.round(i*(t?.5:1)),l=n>a?2:1,c=function(g){var b=r.shape.slice();return b[l]=g,ga(b,0)},f=c(s),d=i-f.shape[l],v=t&&d?c(d):null,m=[v,r,f].filter(function(g){return!!g}).map(function(g){return g.toFloat()});return nn(m,l)})}function jm(r){return 1/(1+Math.exp(-r))}var qy=function(r){He(t,r);function t(e,n,a,i,s){return s===void 0&&(s=!1),r.call(this,{x:e,y:n,width:a,height:i},s)||this}return t}(ba),fP=.5,hP=.43,dP=.45,yc=function(){function r(t,e,n){n===void 0&&(n=new ht(0,0));var a=e.width,i=e.height;this._imgDims=new qo(a,i),this._shift=n,this._positions=t.map(function(s){return s.mul(new ht(a,i)).add(n)})}return Object.defineProperty(r.prototype,"shift",{get:function(){return new ht(this._shift.x,this._shift.y)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"imageWidth",{get:function(){return this._imgDims.width},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"imageHeight",{get:function(){return this._imgDims.height},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"positions",{get:function(){return this._positions},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"relativePositions",{get:function(){var t=this;return this._positions.map(function(e){return e.sub(t._shift).div(new ht(t.imageWidth,t.imageHeight))})},enumerable:!0,configurable:!0}),r.prototype.forSize=function(t,e){return new this.constructor(this.relativePositions,{width:t,height:e})},r.prototype.shiftBy=function(t,e){return new this.constructor(this.relativePositions,this._imgDims,new ht(t,e))},r.prototype.shiftByPoint=function(t){return this.shiftBy(t.x,t.y)},r.prototype.align=function(t,e){if(e===void 0&&(e={}),t){var n=t instanceof vr?t.box.floor():new ba(t);return this.shiftBy(n.x,n.y).align(null,e)}var a=Object.assign({},{useDlibAlignment:!1,minBoxPadding:.2},e),i=a.useDlibAlignment,s=a.minBoxPadding;return i?this.alignDlib():this.alignMinBbox(s)},r.prototype.alignDlib=function(){var t=this.getRefPointsForAlignment(),e=t[0],n=t[1],a=t[2],i=function(v){return a.sub(v).magnitude()},s=(i(e)+i(n))/2,l=Math.floor(s/dP),c=Gy(t),f=Math.floor(Math.max(0,c.x-fP*l)),d=Math.floor(Math.max(0,c.y-hP*l));return new qy(f,d,Math.min(l,this.imageWidth+f),Math.min(l,this.imageHeight+d))},r.prototype.alignMinBbox=function(t){var e=lP(this.positions);return e.pad(e.width*t,e.height*t)},r.prototype.getRefPointsForAlignment=function(){throw new Error("getRefPointsForAlignment not implemented by base class")},r}(),pP=function(r){He(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.prototype.getRefPointsForAlignment=function(){var e=this.positions;return[e[0],e[1],Gy([e[3],e[4]])]},t}(yc),vP=function(r){He(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.prototype.getJawOutline=function(){return this.positions.slice(0,17)},t.prototype.getLeftEyeBrow=function(){return this.positions.slice(17,22)},t.prototype.getRightEyeBrow=function(){return this.positions.slice(22,27)},t.prototype.getNose=function(){return this.positions.slice(27,36)},t.prototype.getLeftEye=function(){return this.positions.slice(36,42)},t.prototype.getRightEye=function(){return this.positions.slice(42,48)},t.prototype.getMouth=function(){return this.positions.slice(48,68)},t.prototype.getRefPointsForAlignment=function(){return[this.getLeftEye(),this.getRightEye(),this.getMouth()].map(Gy)},t}(yc),k_=function(){function r(t,e){this._label=t,this._distance=e}return Object.defineProperty(r.prototype,"label",{get:function(){return this._label},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"distance",{get:function(){return this._distance},enumerable:!0,configurable:!0}),r.prototype.toString=function(t){return t===void 0&&(t=!0),""+this.label+(t?" ("+Wy(this.distance)+")":"")},r}(),O_=function(r){He(t,r);function t(e,n){var a=r.call(this,e)||this;return a._label=n,a}return t.assertIsValidLabeledBox=function(e,n){if(ba.assertIsValidBox(e,n),!Ko(e.label))throw new Error(n+" - expected property label ("+e.label+") to be a number")},Object.defineProperty(t.prototype,"label",{get:function(){return this._label},enumerable:!0,configurable:!0}),t}(ba),dh=function(){function r(t,e){if(typeof t!="string")throw new Error("LabeledFaceDescriptors - constructor expected label to be a string");if(!Array.isArray(e)||e.some(function(n){return!(n instanceof Float32Array)}))throw new Error("LabeledFaceDescriptors - constructor expected descriptors to be an array of Float32Array");this._label=t,this._descriptors=e}return Object.defineProperty(r.prototype,"label",{get:function(){return this._label},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"descriptors",{get:function(){return this._descriptors},enumerable:!0,configurable:!0}),r.prototype.toJSON=function(){return{label:this.label,descriptors:this.descriptors.map(function(t){return Array.from(t)})}},r.fromJSON=function(t){var e=t.descriptors.map(function(n){return new Float32Array(n)});return new r(t.label,e)},r}();(function(r){He(t,r);function t(e,n,a,i){var s=r.call(this,e,n)||this;return s._score=a,s._classScore=i,s}return t.assertIsValidPredictedBox=function(e,n){if(O_.assertIsValidLabeledBox(e,n),!D_(e.score)||!D_(e.classScore))throw new Error(n+" - expected properties score ("+e.score+") and ("+e.classScore+") to be a number between [0, 1]")},Object.defineProperty(t.prototype,"score",{get:function(){return this._score},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"classScore",{get:function(){return this._classScore},enumerable:!0,configurable:!0}),t})(O_);function bc(r){return r.detection instanceof vr}function xc(r,t){var e={detection:t};return Object.assign({},r,e)}function WC(){var r=window.fetch||function(){throw new Error("fetch - missing fetch implementation for browser environment")},t=function(){throw new Error("readFile - filesystem not available for browser environment")};return{Canvas:HTMLCanvasElement,CanvasRenderingContext2D,Image:HTMLImageElement,ImageData,Video:HTMLVideoElement,createCanvasElement:function(){return document.createElement("canvas")},createImageElement:function(){return document.createElement("img")},fetch:r,readFile:t}}function GC(r){var t="";if(!r)try{r=require("fs")}catch(n){t=n.toString()}var e=r?function(n){return new Promise(function(a,i){r.readFile(n,function(s,l){return s?i(s):a(l)})})}:function(){throw new Error("readFile - failed to require fs in nodejs environment with error: "+t)};return{readFile:e}}function qC(){var r=global.Canvas||global.HTMLCanvasElement,t=global.Image||global.HTMLImageElement,e=function(){if(r)return new r;throw new Error("createCanvasElement - missing Canvas implementation for nodejs environment")},n=function(){if(t)return new t;throw new Error("createImageElement - missing Image implementation for nodejs environment")},a=global.fetch||function(){throw new Error("fetch - missing fetch implementation for nodejs environment")},i=GC();return kn({Canvas:r||function(){function s(){}return s}(),CanvasRenderingContext2D:global.CanvasRenderingContext2D||function(){function s(){}return s}(),Image:t||function(){function s(){}return s}(),ImageData:global.ImageData||function(){function s(){}return s}(),Video:global.HTMLVideoElement||function(){function s(){}return s}(),createCanvasElement:e,createImageElement:n,fetch:a},i)}function KC(){return typeof window=="object"&&typeof document<"u"&&typeof HTMLImageElement<"u"&&typeof HTMLCanvasElement<"u"&&typeof HTMLVideoElement<"u"&&typeof ImageData<"u"&&typeof CanvasRenderingContext2D<"u"}function XC(){return typeof global=="object"&&typeof require=="function"&&typeof module<"u"&&typeof process<"u"&&!!process.version}var Jt;function mP(){if(!Jt)throw new Error("getEnv - environment is not defined, check isNodejs() and isBrowser()");return Jt}function Xg(r){Jt=r}function Ky(){KC()&&Xg(WC()),XC()&&Xg(qC())}function gP(r){if(Jt||Ky(),!Jt)throw new Error("monkeyPatch - environment is not defined, check isNodejs() and isBrowser()");var t=r.Canvas,e=t===void 0?Jt.Canvas:t,n=r.Image,a=n===void 0?Jt.Image:n;Jt.Canvas=e,Jt.Image=a,Jt.createCanvasElement=r.createCanvasElement||function(){return new e},Jt.createImageElement=r.createImageElement||function(){return new a},Jt.ImageData=r.ImageData||Jt.ImageData,Jt.Video=r.Video||Jt.Video,Jt.fetch=r.fetch||Jt.fetch,Jt.readFile=r.readFile||Jt.readFile}var In={getEnv:mP,setEnv:Xg,initialize:Ky,createBrowserEnv:WC,createFileSystem:GC,createNodejsEnv:qC,monkeyPatch:gP,isBrowser:KC,isNodejs:XC};Ky();function Xy(r){return!In.isNodejs()&&typeof r=="string"?document.getElementById(r):r}function Za(r){var t=In.getEnv(),e=t.Canvas,n=t.CanvasRenderingContext2D;if(r instanceof n)return r;var a=Xy(r);if(!(a instanceof e))throw new Error("resolveContext2d - expected canvas to be of instance of Canvas");var i=a.getContext("2d");if(!i)throw new Error("resolveContext2d - canvas 2d context is null");return i}var Qi;(function(r){r.TOP_LEFT="TOP_LEFT",r.TOP_RIGHT="TOP_RIGHT",r.BOTTOM_LEFT="BOTTOM_LEFT",r.BOTTOM_RIGHT="BOTTOM_RIGHT"})(Qi||(Qi={}));var $C=function(){function r(t){t===void 0&&(t={});var e=t.anchorPosition,n=t.backgroundColor,a=t.fontColor,i=t.fontSize,s=t.fontStyle,l=t.padding;this.anchorPosition=e||Qi.TOP_LEFT,this.backgroundColor=n||"rgba(0, 0, 0, 0.5)",this.fontColor=a||"rgba(255, 255, 255, 1)",this.fontSize=i||14,this.fontStyle=s||"Georgia",this.padding=l||4}return r}(),YC=function(){function r(t,e,n){n===void 0&&(n={}),this.text=typeof t=="string"?[t]:t instanceof r?t.text:t,this.anchor=e,this.options=new $C(n)}return r.prototype.measureWidth=function(t){var e=this.options.padding;return this.text.map(function(n){return t.measureText(n).width}).reduce(function(n,a){return n<a?a:n},0)+2*e},r.prototype.measureHeight=function(){var t=this.options,e=t.fontSize,n=t.padding;return this.text.length*e+2*n},r.prototype.getUpperLeft=function(t,e){var n=this.options.anchorPosition,a=n===Qi.BOTTOM_RIGHT||n===Qi.TOP_RIGHT,i=n===Qi.BOTTOM_LEFT||n===Qi.BOTTOM_RIGHT,s=this.measureWidth(t),l=this.measureHeight(),c=a?this.anchor.x-s:this.anchor.x,f=i?this.anchor.y-l:this.anchor.y;if(e){var d=e.width,v=e.height,m=Math.max(Math.min(c,d-s),0),g=Math.max(Math.min(f,v-l),0);return{x:m,y:g}}return{x:c,y:f}},r.prototype.draw=function(t){var e=Xy(t),n=Za(e),a=this.options,i=a.backgroundColor,s=a.fontColor,l=a.fontSize,c=a.fontStyle,f=a.padding;n.font=l+"px "+c;var d=this.measureWidth(n),v=this.measureHeight();n.fillStyle=i;var m=this.getUpperLeft(n,e);n.fillRect(m.x,m.y,d,v),n.fillStyle=s,this.text.forEach(function(g,b){var w=f+m.x,_=f+m.y+(b+1)*l;n.fillText(g,w,_)})},r}(),yP=function(){function r(t){t===void 0&&(t={});var e=t.boxColor,n=t.lineWidth,a=t.label,i=t.drawLabelOptions;this.boxColor=e||"rgba(0, 0, 255, 1)",this.lineWidth=n||2,this.label=a;var s={anchorPosition:Qi.BOTTOM_LEFT,backgroundColor:this.boxColor};this.drawLabelOptions=new $C(Object.assign({},s,i))}return r}(),bP=function(){function r(t,e){e===void 0&&(e={}),this.box=new ba(t),this.options=new yP(e)}return r.prototype.draw=function(t){var e=Za(t),n=this.options,a=n.boxColor,i=n.lineWidth,s=this.box,l=s.x,c=s.y,f=s.width,d=s.height;e.strokeStyle=a,e.lineWidth=i,e.strokeRect(l,c,f,d);var v=this.options.label;v&&new YC([v],{x:l-i/2,y:c},this.options.drawLabelOptions).draw(t)},r}();function xU(r,t){var e=Array.isArray(t)?t:[t];e.forEach(function(n){var a=n instanceof vr?n.score:bc(n)?n.detection.score:void 0,i=n instanceof vr?n.box:bc(n)?n.detection.box:new ba(n),s=a?""+Wy(a):void 0;new bP(i,{label:s}).draw(r)})}function QC(r){var t=In.getEnv(),e=t.Image,n=t.Video;return r instanceof e&&r.complete||r instanceof n&&r.readyState>=3}function xP(r){return new Promise(function(t,e){if(r instanceof In.getEnv().Canvas||QC(r))return t();function n(i){i.currentTarget&&(i.currentTarget.removeEventListener("load",n),i.currentTarget.removeEventListener("error",a),t(i))}function a(i){i.currentTarget&&(i.currentTarget.removeEventListener("load",n),i.currentTarget.removeEventListener("error",a),e(i))}r.addEventListener("load",n),r.addEventListener("error",a)})}function $y(r){var t=In.getEnv(),e=t.Image,n=t.Video;return r instanceof e?new qo(r.naturalWidth,r.naturalHeight):r instanceof n?new qo(r.videoWidth,r.videoHeight):new qo(r.width,r.height)}function Md(r){var t=r.width,e=r.height,n=In.getEnv().createCanvasElement,a=n();return a.width=t,a.height=e,a}function Yy(r,t){var e=In.getEnv().ImageData;if(!(r instanceof e)&&!QC(r))throw new Error("createCanvasFromMedia - media has not finished loading yet");var n=$y(r),a=n.width,i=n.height,s=Md({width:a,height:i});return r instanceof e?Za(s).putImageData(r,0,0):Za(s).drawImage(r,0,0,a,i),s}function wP(r,t){return ke(this,void 0,void 0,function(){var e,n,a,i,s,l;return Oe(this,function(c){switch(c.label){case 0:return e=In.getEnv().createCanvasElement(),n=r.shape.slice(no(r)?1:0),a=n[0],i=n[1],s=n[2],l=_e(function(){return r.as3D(a,i,s).toInt()}),[4,jy.toPixels(l,e)];case 1:return c.sent(),l.dispose(),[2,e]}})})}function N_(r){var t=In.getEnv(),e=t.Image,n=t.Canvas,a=t.Video;return r instanceof e||r instanceof n||r instanceof a}function _P(r,t,e){e===void 0&&(e=!1);var n=In.getEnv(),a=n.Image,i=n.Canvas;if(!(r instanceof a||r instanceof i))throw new Error("imageToSquare - expected arg0 to be HTMLImageElement | HTMLCanvasElement");var s=$y(r),l=t/Math.max(s.height,s.width),c=l*s.width,f=l*s.height,d=Md({width:t,height:t}),v=r instanceof i?r:Yy(r),m=Math.abs(c-f)/2,g=e&&c<f?m:0,b=e&&f<c?m:0;return Za(d).drawImage(v,g,b,c,f),d}var ld=function(){function r(t,e){var n=this;if(e===void 0&&(e=!1),this._imageTensors=[],this._canvases=[],this._treatAsBatchInput=!1,this._inputDimensions=[],!Array.isArray(t))throw new Error("NetInput.constructor - expected inputs to be an Array of TResolvedNetInput or to be instanceof tf.Tensor4D, instead have "+t);this._treatAsBatchInput=e,this._batchSize=t.length,t.forEach(function(a,i){if(Od(a)){n._imageTensors[i]=a,n._inputDimensions[i]=a.shape;return}if(no(a)){var s=a.shape[0];if(s!==1)throw new Error("NetInput - tf.Tensor4D with batchSize "+s+" passed, but not supported in input array");n._imageTensors[i]=a,n._inputDimensions[i]=a.shape.slice(1);return}var l=a instanceof In.getEnv().Canvas?a:Yy(a);n._canvases[i]=l,n._inputDimensions[i]=[l.height,l.width,3]})}return Object.defineProperty(r.prototype,"imageTensors",{get:function(){return this._imageTensors},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"canvases",{get:function(){return this._canvases},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"isBatchInput",{get:function(){return this.batchSize>1||this._treatAsBatchInput},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"batchSize",{get:function(){return this._batchSize},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"inputDimensions",{get:function(){return this._inputDimensions},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"inputSize",{get:function(){return this._inputSize},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"reshapedInputDimensions",{get:function(){var t=this;return mc(this.batchSize,0,1).map(function(e,n){return t.getReshapedInputDimensions(n)})},enumerable:!0,configurable:!0}),r.prototype.getInput=function(t){return this.canvases[t]||this.imageTensors[t]},r.prototype.getInputDimensions=function(t){return this._inputDimensions[t]},r.prototype.getInputHeight=function(t){return this._inputDimensions[t][0]},r.prototype.getInputWidth=function(t){return this._inputDimensions[t][1]},r.prototype.getReshapedInputDimensions=function(t){if(typeof this.inputSize!="number")throw new Error("getReshapedInputDimensions - inputSize not set, toBatchTensor has not been called yet");var e=this.getInputWidth(t),n=this.getInputHeight(t);return sP({width:e,height:n},this.inputSize)},r.prototype.toBatchTensor=function(t,e){var n=this;return e===void 0&&(e=!0),this._inputSize=t,_e(function(){var a=mc(n.batchSize,0,1).map(function(s){var l=n.getInput(s);if(l instanceof Nt){var c=no(l)?l:l.expandDims();return c=cP(c,e),(c.shape[1]!==t||c.shape[2]!==t)&&(c=Ly.resizeBilinear(c,[t,t])),c.as3D(t,t,3)}if(l instanceof In.getEnv().Canvas)return jy.fromPixels(_P(l,t,e));throw new Error("toBatchTensor - at batchIdx "+s+", expected input to be instanceof tf.Tensor or instanceof HTMLCanvasElement, instead have "+l)}),i=dr(a.map(function(s){return s.toFloat()})).as4D(n.batchSize,t,t,3);return i})},r}();function mn(r){return ke(this,void 0,void 0,function(){var t,e,n;return Oe(this,function(a){switch(a.label){case 0:if(r instanceof ld)return[2,r];if(t=Array.isArray(r)?r:[r],!t.length)throw new Error("toNetInput - empty array passed as input");return e=function(i){return Array.isArray(r)?" at input index "+i+":":""},n=t.map(Xy),n.forEach(function(i,s){if(!N_(i)&&!Od(i)&&!no(i))throw typeof t[s]=="string"?new Error("toNetInput -"+e(s)+" string passed, but could not resolve HTMLElement for element id "+t[s]):new Error("toNetInput -"+e(s)+" expected media to be of type HTMLImageElement | HTMLVideoElement | HTMLCanvasElement | tf.Tensor3D, or to be an element id");if(no(i)){var l=i.shape[0];if(l!==1)throw new Error("toNetInput -"+e(s)+" tf.Tensor4D with batchSize "+l+" passed, but not supported in input array")}}),[4,Promise.all(n.map(function(i){return N_(i)&&xP(i)}))];case 1:return a.sent(),[2,new ld(n,Array.isArray(r))]}})})}function Qy(r,t){return ke(this,void 0,void 0,function(){var e,n,a,i,s,l,c;return Oe(this,function(f){switch(f.label){case 0:return e=In.getEnv().Canvas,n=r,r instanceof e?[3,5]:[4,mn(r)];case 1:if(a=f.sent(),a.batchSize>1)throw new Error("extractFaces - batchSize > 1 not supported");return i=a.getInput(0),i instanceof e?(s=i,[3,4]):[3,2];case 2:return[4,wP(i)];case 3:s=f.sent(),f.label=4;case 4:n=s,f.label=5;case 5:return l=Za(n),c=t.map(function(d){return d instanceof vr?d.forSize(n.width,n.height).box.floor():d}).map(function(d){return d.clipAtImageBorders(n.width,n.height)}),[2,c.map(function(d){var v=d.x,m=d.y,g=d.width,b=d.height,w=Md({width:g,height:b});return Za(w).putImageData(l.getImageData(v,m,g,b),0,0),w})]}})})}function Zy(r,t){return ke(this,void 0,void 0,function(){return Oe(this,function(e){if(!Od(r)&&!no(r))throw new Error("extractFaceTensors - expected image tensor to be 3D or 4D");if(no(r)&&r.shape[0]>1)throw new Error("extractFaceTensors - batchSize > 1 not supported");return[2,_e(function(){var n=r.shape.slice(no(r)?1:0),a=n[0],i=n[1],s=n[2],l=t.map(function(f){return f instanceof vr?f.forSize(i,a).box:f}).map(function(f){return f.clipAtImageBorders(i,a)}),c=l.map(function(f){var d=f.x,v=f.y,m=f.width,g=f.height;return EC(r.as3D(a,i,s),[v,d,0],[g,m,s])});return c})]})})}function SP(r,t){return ke(this,void 0,void 0,function(){var e,n;return Oe(this,function(a){switch(a.label){case 0:return e=In.getEnv().fetch,[4,e(r,t)];case 1:if(n=a.sent(),!(n.status<400))throw new Error("failed to fetch: ("+n.status+") "+n.statusText+", from url: "+n.url);return[2,n]}})})}function EP(r){return ke(this,void 0,void 0,function(){return Oe(this,function(t){switch(t.label){case 0:return[4,SP(r)];case 1:return[2,t.sent().json()]}})})}function ZC(r,t){var e=t+"-weights_manifest.json";if(!r)return{modelBaseUri:"",manifestUri:e};if(r==="/")return{modelBaseUri:"/",manifestUri:"/"+e};var n=r.startsWith("http://")?"http://":r.startsWith("https://")?"https://":"";r=r.replace(n,"");var a=r.split("/").filter(function(l){return l}),i=r.endsWith(".json")?a[a.length-1]:e,s=n+(r.endsWith(".json")?a.slice(0,a.length-1):a).join("/");return s=r.startsWith("/")?"/"+s:s,{modelBaseUri:s,manifestUri:s==="/"?"/"+i:s+"/"+i}}function CP(r,t){return ke(this,void 0,void 0,function(){var e,n,a,i;return Oe(this,function(s){switch(s.label){case 0:return e=ZC(r,t),n=e.manifestUri,a=e.modelBaseUri,[4,EP(n)];case 1:return i=s.sent(),[2,VC.loadWeights(i,a)]}})})}function wU(r,t,e){e===void 0&&(e=!1);var n=e?$y(t):t,a=n.width,i=n.height;return r.width=a,r.height=i,{width:a,height:i}}var ri=function(){function r(t){this._name=t,this._params=void 0,this._paramMappings=[]}return Object.defineProperty(r.prototype,"params",{get:function(){return this._params},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"paramMappings",{get:function(){return this._paramMappings},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"isLoaded",{get:function(){return!!this.params},enumerable:!0,configurable:!0}),r.prototype.getParamFromPath=function(t){var e=this.traversePropertyPath(t),n=e.obj,a=e.objProp;return n[a]},r.prototype.reassignParamFromPath=function(t,e){var n=this.traversePropertyPath(t),a=n.obj,i=n.objProp;a[i].dispose(),a[i]=e},r.prototype.getParamList=function(){var t=this;return this._paramMappings.map(function(e){var n=e.paramPath;return{path:n,tensor:t.getParamFromPath(n)}})},r.prototype.getTrainableParams=function(){return this.getParamList().filter(function(t){return t.tensor instanceof Iu})},r.prototype.getFrozenParams=function(){return this.getParamList().filter(function(t){return!(t.tensor instanceof Iu)})},r.prototype.variable=function(){var t=this;this.getFrozenParams().forEach(function(e){var n=e.path,a=e.tensor;t.reassignParamFromPath(n,a.variable())})},r.prototype.freeze=function(){var t=this;this.getTrainableParams().forEach(function(e){var n=e.path,a=e.tensor,i=Sn(a.dataSync());a.dispose(),t.reassignParamFromPath(n,i)})},r.prototype.dispose=function(t){t===void 0&&(t=!0),this.getParamList().forEach(function(e){if(t&&e.tensor.isDisposed)throw new Error("param tensor has already been disposed for path "+e.path);e.tensor.dispose()}),this._params=void 0},r.prototype.serializeParams=function(){return new Float32Array(this.getParamList().map(function(t){var e=t.tensor;return Array.from(e.dataSync())}).reduce(function(t,e){return t.concat(e)}))},r.prototype.load=function(t){return ke(this,void 0,void 0,function(){return Oe(this,function(e){switch(e.label){case 0:return t instanceof Float32Array?(this.extractWeights(t),[2]):[4,this.loadFromUri(t)];case 1:return e.sent(),[2]}})})},r.prototype.loadFromUri=function(t){return ke(this,void 0,void 0,function(){var e;return Oe(this,function(n){switch(n.label){case 0:if(t&&typeof t!="string")throw new Error(this._name+".loadFromUri - expected model uri");return[4,CP(t,this.getDefaultModelName())];case 1:return e=n.sent(),this.loadFromWeightMap(e),[2]}})})},r.prototype.loadFromDisk=function(t){return ke(this,void 0,void 0,function(){var e,n,a,i,s,l,c,f,d,v;return Oe(this,function(m){switch(m.label){case 0:if(t&&typeof t!="string")throw new Error(this._name+".loadFromDisk - expected model file path");return e=In.getEnv().readFile,n=ZC(t,this.getDefaultModelName()),a=n.manifestUri,i=n.modelBaseUri,s=function(g){return Promise.all(g.map(function(b){return e(b).then(function(w){return w.buffer})}))},l=VC.weightsLoaderFactory(s),d=(f=JSON).parse,[4,e(a)];case 1:return c=d.apply(f,[m.sent().toString()]),[4,l(c,i)];case 2:return v=m.sent(),this.loadFromWeightMap(v),[2]}})})},r.prototype.loadFromWeightMap=function(t){var e=this.extractParamsFromWeigthMap(t),n=e.paramMappings,a=e.params;this._paramMappings=n,this._params=a},r.prototype.extractWeights=function(t){var e=this.extractParams(t),n=e.paramMappings,a=e.params;this._paramMappings=n,this._params=a},r.prototype.traversePropertyPath=function(t){if(!this.params)throw new Error("traversePropertyPath - model has no loaded params");var e=t.split("/").reduce(function(i,s){if(!i.nextObj.hasOwnProperty(s))throw new Error("traversePropertyPath - object does not have property "+s+", for path "+t);return{obj:i.nextObj,objProp:s,nextObj:i.nextObj[s]}},{nextObj:this.params}),n=e.obj,a=e.objProp;if(!n||!a||!(n[a]instanceof Nt))throw new Error("traversePropertyPath - parameter is not a tensor, for path "+t);return{obj:n,objProp:a}},r}();function hr(r,t,e){return _e(function(){var n=Ny(r,t.depthwise_filter,t.pointwise_filter,e,"same");return n=et(n,t.bias),n})}function Wm(r,t,e){return e===void 0&&(e=!1),_e(function(){var n=Mt(e?et(Ir(r,t.conv0.filters,[2,2],"same"),t.conv0.bias):hr(r,t.conv0,[2,2])),a=hr(n,t.conv1,[1,1]),i=Mt(et(n,a)),s=hr(i,t.conv2,[1,1]);return Mt(et(n,et(a,s)))})}function ph(r,t,e,n){return e===void 0&&(e=!1),n===void 0&&(n=!0),_e(function(){var a=Mt(e?et(Ir(r,t.conv0.filters,n?[2,2]:[1,1],"same"),t.conv0.bias):hr(r,t.conv0,n?[2,2]:[1,1])),i=hr(a,t.conv1,[1,1]),s=Mt(et(a,i)),l=hr(s,t.conv2,[1,1]),c=Mt(et(a,et(i,l))),f=hr(c,t.conv3,[1,1]);return Mt(et(a,et(i,et(l,f))))})}function qr(r,t,e,n){return e===void 0&&(e="same"),n===void 0&&(n=!1),_e(function(){var a=et(Ir(r,t.filters,[1,1],e),t.bias);return n?Mt(a):a})}function ai(r,t){Object.keys(r).forEach(function(e){t.some(function(n){return n.originalPath===e})||r[e].dispose()})}function Id(r,t){return function(e,n,a,i){var s=Xn(r(e*n*a*a),[a,a,e,n]),l=Xt(r(n));return t.push({paramPath:i+"/filters"},{paramPath:i+"/bias"}),{filters:s,bias:l}}}function Jy(r,t){return function(e,n,a){var i=eo(r(e*n),[e,n]),s=Xt(r(n));return t.push({paramPath:a+"/weights"},{paramPath:a+"/bias"}),{weights:i,bias:s}}}var JC=function(){function r(t,e,n){this.depthwise_filter=t,this.pointwise_filter=e,this.bias=n}return r}();function e0(r,t){return function(e,n,a){var i=Xn(r(9*e),[3,3,e,1]),s=Xn(r(e*n),[1,1,e,n]),l=Xt(r(n));return t.push({paramPath:a+"/depthwise_filter"},{paramPath:a+"/pointwise_filter"},{paramPath:a+"/bias"}),new JC(i,s,l)}}function t0(r){return function(t){var e=r(t+"/depthwise_filter",4),n=r(t+"/pointwise_filter",4),a=r(t+"/bias",1);return new JC(e,n,a)}}function co(r,t){return function(e,n,a){var i=r[e];if(!kd(i,n))throw new Error("expected weightMap["+e+"] to be a Tensor"+n+"D, instead have "+i);return t.push({originalPath:e,paramPath:a||e}),i}}function ii(r){var t=r;function e(a){var i=t.slice(0,a);return t=t.slice(a),i}function n(){return t}return{extractWeights:e,getRemainingWeights:n}}function eR(r,t){var e=Id(r,t),n=e0(r,t);function a(s,l,c,f){f===void 0&&(f=!1);var d=f?e(s,l,3,c+"/conv0"):n(s,l,c+"/conv0"),v=n(l,l,c+"/conv1"),m=n(l,l,c+"/conv2");return{conv0:d,conv1:v,conv2:m}}function i(s,l,c,f){f===void 0&&(f=!1);var d=a(s,l,c,f),v=d.conv0,m=d.conv1,g=d.conv2,b=n(l,l,c+"/conv3");return{conv0:v,conv1:m,conv2:g,conv3:b}}return{extractDenseBlock3Params:a,extractDenseBlock4Params:i}}function RP(r){var t=[],e=ii(r),n=e.extractWeights,a=e.getRemainingWeights,i=eR(n,t).extractDenseBlock4Params,s=i(3,32,"dense0",!0),l=i(32,64,"dense1"),c=i(64,128,"dense2"),f=i(128,256,"dense3");if(a().length!==0)throw new Error("weights remaing after extract: "+a().length);return{paramMappings:t,params:{dense0:s,dense1:l,dense2:c,dense3:f}}}function tR(r){return function(t){var e=r(t+"/filters",4),n=r(t+"/bias",1);return{filters:e,bias:n}}}function nR(r,t){var e=co(r,t),n=tR(e),a=t0(e);function i(l,c){c===void 0&&(c=!1);var f=c?n(l+"/conv0"):a(l+"/conv0"),d=a(l+"/conv1"),v=a(l+"/conv2");return{conv0:f,conv1:d,conv2:v}}function s(l,c){c===void 0&&(c=!1);var f=c?n(l+"/conv0"):a(l+"/conv0"),d=a(l+"/conv1"),v=a(l+"/conv2"),m=a(l+"/conv3");return{conv0:f,conv1:d,conv2:v,conv3:m}}return{extractDenseBlock3Params:i,extractDenseBlock4Params:s}}function AP(r){var t=[],e=nR(r,t).extractDenseBlock4Params,n={dense0:e("dense0",!0),dense1:e("dense1"),dense2:e("dense2"),dense3:e("dense3")};return ai(r,t),{params:n,paramMappings:t}}var rR=function(r){He(t,r);function t(){return r.call(this,"FaceFeatureExtractor")||this}return t.prototype.forwardInput=function(e){var n=this.params;if(!n)throw new Error("FaceFeatureExtractor - load model before inference");return _e(function(){var a=e.toBatchTensor(112,!0),i=[122.782,117.001,104.298],s=Bc(a,i).div(ye(255)),l=ph(s,n.dense0,!0);return l=ph(l,n.dense1),l=ph(l,n.dense2),l=ph(l,n.dense3),l=Ic(l,[7,7],[2,2],"valid"),l})},t.prototype.forward=function(e){return ke(this,void 0,void 0,function(){var n;return Oe(this,function(a){switch(a.label){case 0:return n=this.forwardInput,[4,mn(e)];case 1:return[2,n.apply(this,[a.sent()])]}})})},t.prototype.getDefaultModelName=function(){return"face_feature_extractor_model"},t.prototype.extractParamsFromWeigthMap=function(e){return AP(e)},t.prototype.extractParams=function(e){return RP(e)},t}(ri);function da(r,t){return _e(function(){return et(Ad(r,t.weights),t.bias)})}function TP(r,t,e){var n=[],a=ii(r),i=a.extractWeights,s=a.getRemainingWeights,l=Jy(i,n),c=l(t,e,"fc");if(s().length!==0)throw new Error("weights remaing after extract: "+s().length);return{paramMappings:n,params:{fc:c}}}function DP(r){var t=[],e=co(r,t);function n(i){var s=e(i+"/weights",2),l=e(i+"/bias",1);return{weights:s,bias:l}}var a={fc:n("fc")};return ai(r,t),{params:a,paramMappings:t}}function aR(r){var t={},e={};return Object.keys(r).forEach(function(n){var a=n.startsWith("fc")?e:t;a[n]=r[n]}),{featureExtractorMap:t,classifierMap:e}}var iR=function(r){He(t,r);function t(e,n){var a=r.call(this,e)||this;return a._faceFeatureExtractor=n,a}return Object.defineProperty(t.prototype,"faceFeatureExtractor",{get:function(){return this._faceFeatureExtractor},enumerable:!0,configurable:!0}),t.prototype.runNet=function(e){var n=this,a=this.params;if(!a)throw new Error(this._name+" - load model before inference");return _e(function(){var i=e instanceof ld?n.faceFeatureExtractor.forwardInput(e):e;return da(i.as2D(i.shape[0],-1),a.fc)})},t.prototype.dispose=function(e){e===void 0&&(e=!0),this.faceFeatureExtractor.dispose(e),r.prototype.dispose.call(this,e)},t.prototype.loadClassifierParams=function(e){var n=this.extractClassifierParams(e),a=n.params,i=n.paramMappings;this._params=a,this._paramMappings=i},t.prototype.extractClassifierParams=function(e){return TP(e,this.getClassifierChannelsIn(),this.getClassifierChannelsOut())},t.prototype.extractParamsFromWeigthMap=function(e){var n=aR(e),a=n.featureExtractorMap,i=n.classifierMap;return this.faceFeatureExtractor.loadFromWeightMap(a),DP(i)},t.prototype.extractParams=function(e){var n=this.getClassifierChannelsIn(),a=this.getClassifierChannelsOut(),i=a*n+a,s=e.slice(0,e.length-i),l=e.slice(e.length-i);return this.faceFeatureExtractor.extractWeights(s),this.extractClassifierParams(l)},t}(ri),M_=["neutral","happy","sad","angry","fearful","disgusted","surprised"],n0=function(){function r(t){var e=this;if(t.length!==7)throw new Error("FaceExpressions.constructor - expected probabilities.length to be 7, have: "+t.length);M_.forEach(function(n,a){e[n]=t[a]})}return r.prototype.asSortedArray=function(){var t=this;return M_.map(function(e){return{expression:e,probability:t[e]}}).sort(function(e,n){return n.probability-e.probability})},r}(),kP=function(r){He(t,r);function t(e){return e===void 0&&(e=new rR),r.call(this,"FaceExpressionNet",e)||this}return t.prototype.forwardInput=function(e){var n=this;return _e(function(){return ti(n.runNet(e))})},t.prototype.forward=function(e){return ke(this,void 0,void 0,function(){var n;return Oe(this,function(a){switch(a.label){case 0:return n=this.forwardInput,[4,mn(e)];case 1:return[2,n.apply(this,[a.sent()])]}})})},t.prototype.predictExpressions=function(e){return ke(this,void 0,void 0,function(){var n,a,i,s,l=this;return Oe(this,function(c){switch(c.label){case 0:return[4,mn(e)];case 1:return n=c.sent(),[4,this.forwardInput(n)];case 2:return a=c.sent(),[4,Promise.all(rn(a).map(function(f){return ke(l,void 0,void 0,function(){var d;return Oe(this,function(v){switch(v.label){case 0:return[4,f.data()];case 1:return d=v.sent(),f.dispose(),[2,d]}})})}))];case 3:return i=c.sent(),a.dispose(),s=i.map(function(f){return new n0(f)}),[2,n.isBatchInput?s:s[0]]}})})},t.prototype.getDefaultModelName=function(){return"face_expression_model"},t.prototype.getClassifierChannelsIn=function(){return 256},t.prototype.getClassifierChannelsOut=function(){return 7},t}(iR);function OP(r){return r.expressions instanceof n0}function oR(r,t){var e={expressions:t};return Object.assign({},r,e)}function _U(r,t,e,n){e===void 0&&(e=.1);var a=Array.isArray(t)?t:[t];a.forEach(function(i){var s=i instanceof n0?i:OP(i)?i.expressions:void 0;if(!s)throw new Error("drawFaceExpressions - expected faceExpressions to be FaceExpressions | WithFaceExpressions<{}> or array thereof");var l=s.asSortedArray(),c=l.filter(function(v){return v.probability>e}),f=bc(i)?i.detection.box.bottomLeft:new ht(0,0),d=new YC(c.map(function(v){return v.expression+" ("+Wy(v.probability)+")"}),f);d.draw(r)})}function sR(r){return bc(r)&&r.landmarks instanceof yc&&r.unshiftedLandmarks instanceof yc&&r.alignedRect instanceof vr}function Fd(r,t){var e=r.detection.box,n=t.shiftBy(e.x,e.y),a=n.align(),i=r.detection.imageDims,s=new vr(r.detection.score,a.rescale(i.reverse()),i),l={landmarks:n,unshiftedLandmarks:t,alignedRect:s};return Object.assign({},r,l)}function NP(r,t){var e=Id(r,t),n=e0(r,t);function a(s,l,c){var f=n(s,l,c+"/separable_conv0"),d=n(l,l,c+"/separable_conv1"),v=e(s,l,1,c+"/expansion_conv");return{separable_conv0:f,separable_conv1:d,expansion_conv:v}}function i(s,l){var c=n(s,s,l+"/separable_conv0"),f=n(s,s,l+"/separable_conv1"),d=n(s,s,l+"/separable_conv2");return{separable_conv0:c,separable_conv1:f,separable_conv2:d}}return{extractConvParams:e,extractSeparableConvParams:n,extractReductionBlockParams:a,extractMainBlockParams:i}}function MP(r,t){var e=[],n=ii(r),a=n.extractWeights,i=n.getRemainingWeights,s=NP(a,e),l=s.extractConvParams,c=s.extractSeparableConvParams,f=s.extractReductionBlockParams,d=s.extractMainBlockParams,v=l(3,32,3,"entry_flow/conv_in"),m=f(32,64,"entry_flow/reduction_block_0"),g=f(64,128,"entry_flow/reduction_block_1"),b={conv_in:v,reduction_block_0:m,reduction_block_1:g},w={};mc(t,0,1).forEach(function(C){w["main_block_"+C]=d(128,"middle_flow/main_block_"+C)});var _=f(128,256,"exit_flow/reduction_block"),S=c(256,512,"exit_flow/separable_conv"),E={reduction_block:_,separable_conv:S};if(i().length!==0)throw new Error("weights remaing after extract: "+i().length);return{paramMappings:e,params:{entry_flow:b,middle_flow:w,exit_flow:E}}}function IP(r,t){var e=co(r,t),n=tR(e),a=t0(e);function i(l){var c=a(l+"/separable_conv0"),f=a(l+"/separable_conv1"),d=n(l+"/expansion_conv");return{separable_conv0:c,separable_conv1:f,expansion_conv:d}}function s(l){var c=a(l+"/separable_conv0"),f=a(l+"/separable_conv1"),d=a(l+"/separable_conv2");return{separable_conv0:c,separable_conv1:f,separable_conv2:d}}return{extractConvParams:n,extractSeparableConvParams:a,extractReductionBlockParams:i,extractMainBlockParams:s}}function FP(r,t){var e=[],n=IP(r,e),a=n.extractConvParams,i=n.extractSeparableConvParams,s=n.extractReductionBlockParams,l=n.extractMainBlockParams,c=a("entry_flow/conv_in"),f=s("entry_flow/reduction_block_0"),d=s("entry_flow/reduction_block_1"),v={conv_in:c,reduction_block_0:f,reduction_block_1:d},m={};mc(t,0,1).forEach(function(_){m["main_block_"+_]=l("middle_flow/main_block_"+_)});var g=s("exit_flow/reduction_block"),b=i("exit_flow/separable_conv"),w={reduction_block:g,separable_conv:b};return ai(r,e),{params:{entry_flow:v,middle_flow:m,exit_flow:w},paramMappings:e}}function uR(r,t,e){return et(Ir(r,t.filters,e,"same"),t.bias)}function Gm(r,t,e){e===void 0&&(e=!0);var n=e?Mt(r):r;return n=hr(n,t.separable_conv0,[1,1]),n=hr(Mt(n),t.separable_conv1,[1,1]),n=hn(n,[3,3],[2,2],"same"),n=et(n,uR(r,t.expansion_conv,[2,2])),n}function BP(r,t){var e=hr(Mt(r),t.separable_conv0,[1,1]);return e=hr(Mt(e),t.separable_conv1,[1,1]),e=hr(Mt(e),t.separable_conv2,[1,1]),e=et(e,r),e}var LP=function(r){He(t,r);function t(e){var n=r.call(this,"TinyXception")||this;return n._numMainBlocks=e,n}return t.prototype.forwardInput=function(e){var n=this,a=this.params;if(!a)throw new Error("TinyXception - load model before inference");return _e(function(){var i=e.toBatchTensor(112,!0),s=[122.782,117.001,104.298],l=Bc(i,s).div(ye(256)),c=Mt(uR(l,a.entry_flow.conv_in,[2,2]));return c=Gm(c,a.entry_flow.reduction_block_0,!1),c=Gm(c,a.entry_flow.reduction_block_1),mc(n._numMainBlocks,0,1).forEach(function(f){c=BP(c,a.middle_flow["main_block_"+f])}),c=Gm(c,a.exit_flow.reduction_block),c=Mt(hr(c,a.exit_flow.separable_conv,[1,1])),c})},t.prototype.forward=function(e){return ke(this,void 0,void 0,function(){var n;return Oe(this,function(a){switch(a.label){case 0:return n=this.forwardInput,[4,mn(e)];case 1:return[2,n.apply(this,[a.sent()])]}})})},t.prototype.getDefaultModelName=function(){return"tiny_xception_model"},t.prototype.extractParamsFromWeigthMap=function(e){return FP(e,this._numMainBlocks)},t.prototype.extractParams=function(e){return MP(e,this._numMainBlocks)},t}(ri);function PP(r){var t=[],e=ii(r),n=e.extractWeights,a=e.getRemainingWeights,i=Jy(n,t),s=i(512,1,"fc/age"),l=i(512,2,"fc/gender");if(a().length!==0)throw new Error("weights remaing after extract: "+a().length);return{paramMappings:t,params:{fc:{age:s,gender:l}}}}function zP(r){var t=[],e=co(r,t);function n(i){var s=e(i+"/weights",2),l=e(i+"/bias",1);return{weights:s,bias:l}}var a={fc:{age:n("fc/age"),gender:n("fc/gender")}};return ai(r,t),{params:a,paramMappings:t}}var cd;(function(r){r.FEMALE="female",r.MALE="male"})(cd||(cd={}));var UP=function(r){He(t,r);function t(e){e===void 0&&(e=new LP(2));var n=r.call(this,"AgeGenderNet")||this;return n._faceFeatureExtractor=e,n}return Object.defineProperty(t.prototype,"faceFeatureExtractor",{get:function(){return this._faceFeatureExtractor},enumerable:!0,configurable:!0}),t.prototype.runNet=function(e){var n=this,a=this.params;if(!a)throw new Error(this._name+" - load model before inference");return _e(function(){var i=e instanceof ld?n.faceFeatureExtractor.forwardInput(e):e,s=Ic(i,[7,7],[2,2],"valid").as2D(i.shape[0],-1),l=da(s,a.fc.age).as1D(),c=da(s,a.fc.gender);return{age:l,gender:c}})},t.prototype.forwardInput=function(e){var n=this;return _e(function(){var a=n.runNet(e),i=a.age,s=a.gender;return{age:i,gender:ti(s)}})},t.prototype.forward=function(e){return ke(this,void 0,void 0,function(){var n;return Oe(this,function(a){switch(a.label){case 0:return n=this.forwardInput,[4,mn(e)];case 1:return[2,n.apply(this,[a.sent()])]}})})},t.prototype.predictAgeAndGender=function(e){return ke(this,void 0,void 0,function(){var n,a,i,s,l,c,f=this;return Oe(this,function(d){switch(d.label){case 0:return[4,mn(e)];case 1:return n=d.sent(),[4,this.forwardInput(n)];case 2:return a=d.sent(),i=rn(a.age),s=rn(a.gender),l=i.map(function(v,m){return{ageTensor:v,genderTensor:s[m]}}),[4,Promise.all(l.map(function(v){var m=v.ageTensor,g=v.genderTensor;return ke(f,void 0,void 0,function(){var b,w,_,S,E;return Oe(this,function(C){switch(C.label){case 0:return[4,m.data()];case 1:return b=C.sent()[0],[4,g.data()];case 2:return w=C.sent()[0],_=w>.5,S=_?cd.MALE:cd.FEMALE,E=_?w:1-w,m.dispose(),g.dispose(),[2,{age:b,gender:S,genderProbability:E}]}})})}))];case 3:return c=d.sent(),a.age.dispose(),a.gender.dispose(),[2,n.isBatchInput?c:c[0]]}})})},t.prototype.getDefaultModelName=function(){return"age_gender_model"},t.prototype.dispose=function(e){e===void 0&&(e=!0),this.faceFeatureExtractor.dispose(e),r.prototype.dispose.call(this,e)},t.prototype.loadClassifierParams=function(e){var n=this.extractClassifierParams(e),a=n.params,i=n.paramMappings;this._params=a,this._paramMappings=i},t.prototype.extractClassifierParams=function(e){return PP(e)},t.prototype.extractParamsFromWeigthMap=function(e){var n=aR(e),a=n.featureExtractorMap,i=n.classifierMap;return this.faceFeatureExtractor.loadFromWeightMap(a),zP(i)},t.prototype.extractParams=function(e){var n=1539,a=e.slice(0,e.length-n),i=e.slice(e.length-n);return this.faceFeatureExtractor.extractWeights(a),this.extractClassifierParams(i)},t}(ri),lR=function(r){He(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.prototype.postProcess=function(e,n,a){var i=a.map(function(l){var c=l.width,f=l.height,d=n/Math.max(f,c);return{width:c*d,height:f*d}}),s=i.length;return _e(function(){var l=function(m,g){return dr([ga([68],m),ga([68],g)],1).as2D(1,136).as1D()},c=function(m,g){var b=i[m],w=b.width,_=b.height;return g(w,_)?Math.abs(w-_)/2:0},f=function(m){return c(m,function(g,b){return g<b})},d=function(m){return c(m,function(g,b){return b<g})},v=e.mul(ga([s,136],n)).sub(dr(Array.from(Array(s),function(m,g){return l(f(g),d(g))}))).div(dr(Array.from(Array(s),function(m,g){return l(i[g].width,i[g].height)})));return v})},t.prototype.forwardInput=function(e){var n=this;return _e(function(){var a=n.runNet(e);return n.postProcess(a,e.inputSize,e.inputDimensions.map(function(i){var s=i[0],l=i[1];return{height:s,width:l}}))})},t.prototype.forward=function(e){return ke(this,void 0,void 0,function(){var n;return Oe(this,function(a){switch(a.label){case 0:return n=this.forwardInput,[4,mn(e)];case 1:return[2,n.apply(this,[a.sent()])]}})})},t.prototype.detectLandmarks=function(e){return ke(this,void 0,void 0,function(){var n,a,i,s=this;return Oe(this,function(l){switch(l.label){case 0:return[4,mn(e)];case 1:return n=l.sent(),a=_e(function(){return rn(s.forwardInput(n))}),[4,Promise.all(a.map(function(c,f){return ke(s,void 0,void 0,function(){var d,v,m,g,b;return Oe(this,function(w){switch(w.label){case 0:return m=(v=Array).from,[4,c.data()];case 1:return d=m.apply(v,[w.sent()]),g=d.filter(function(_,S){return A_(S)}),b=d.filter(function(_,S){return!A_(S)}),[2,new vP(Array(68).fill(0).map(function(_,S){return new ht(g[S],b[S])}),{height:n.getInputHeight(f),width:n.getInputWidth(f)})]}})})}))];case 2:return i=l.sent(),a.forEach(function(c){return c.dispose()}),[2,n.isBatchInput?i:i[0]]}})})},t.prototype.getClassifierChannelsOut=function(){return 136},t}(iR),cR=function(r){He(t,r);function t(e){return e===void 0&&(e=new rR),r.call(this,"FaceLandmark68Net",e)||this}return t.prototype.getDefaultModelName=function(){return"face_landmark_68_model"},t.prototype.getClassifierChannelsIn=function(){return 256},t}(lR);function VP(r){var t=[],e=nR(r,t).extractDenseBlock3Params,n={dense0:e("dense0",!0),dense1:e("dense1"),dense2:e("dense2")};return ai(r,t),{params:n,paramMappings:t}}function HP(r){var t=[],e=ii(r),n=e.extractWeights,a=e.getRemainingWeights,i=eR(n,t).extractDenseBlock3Params,s=i(3,32,"dense0",!0),l=i(32,64,"dense1"),c=i(64,128,"dense2");if(a().length!==0)throw new Error("weights remaing after extract: "+a().length);return{paramMappings:t,params:{dense0:s,dense1:l,dense2:c}}}var jP=function(r){He(t,r);function t(){return r.call(this,"TinyFaceFeatureExtractor")||this}return t.prototype.forwardInput=function(e){var n=this.params;if(!n)throw new Error("TinyFaceFeatureExtractor - load model before inference");return _e(function(){var a=e.toBatchTensor(112,!0),i=[122.782,117.001,104.298],s=Bc(a,i).div(ye(255)),l=Wm(s,n.dense0,!0);return l=Wm(l,n.dense1),l=Wm(l,n.dense2),l=Ic(l,[14,14],[2,2],"valid"),l})},t.prototype.forward=function(e){return ke(this,void 0,void 0,function(){var n;return Oe(this,function(a){switch(a.label){case 0:return n=this.forwardInput,[4,mn(e)];case 1:return[2,n.apply(this,[a.sent()])]}})})},t.prototype.getDefaultModelName=function(){return"face_feature_extractor_tiny_model"},t.prototype.extractParamsFromWeigthMap=function(e){return VP(e)},t.prototype.extractParams=function(e){return HP(e)},t}(ri),WP=function(r){He(t,r);function t(e){return e===void 0&&(e=new jP),r.call(this,"FaceLandmark68TinyNet",e)||this}return t.prototype.getDefaultModelName=function(){return"face_landmark_68_tiny_model"},t.prototype.getClassifierChannelsIn=function(){return 128},t}(lR);(function(r){He(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t})(cR);function GP(r,t){return et(Mn(r,t.weights),t.biases)}function r0(r,t,e,n,a){a===void 0&&(a="same");var i=t.conv,s=i.filters,l=i.bias,c=Ir(r,s,e,a);return c=et(c,l),c=GP(c,t.scale),n?Mt(c):c}function qP(r,t){return r0(r,t,[1,1],!0)}function fR(r,t){return r0(r,t,[1,1],!1)}function hR(r,t){return r0(r,t,[2,2],!0,"valid")}function KP(r,t){function e(l,c,f){var d=r(l),v=d.length/(c*f*f);if(oP(v))throw new Error("depth has to be an integer: "+v+", weights.length: "+d.length+", numFilters: "+c+", filterSize: "+f);return _e(function(){return oo(Xn(d,[c,v,f,f]),[2,3,1,0])})}function n(l,c,f,d){var v=e(l,c,f),m=Xt(r(c));return t.push({paramPath:d+"/filters"},{paramPath:d+"/bias"}),{filters:v,bias:m}}function a(l,c){var f=Xt(r(l)),d=Xt(r(l));return t.push({paramPath:c+"/weights"},{paramPath:c+"/biases"}),{weights:f,biases:d}}function i(l,c,f,d){var v=n(l,c,f,d+"/conv"),m=a(c,d+"/scale");return{conv:v,scale:m}}function s(l,c,f,d,v){v===void 0&&(v=!1);var m=i((v?.5:1)*l,c,f,d+"/conv1"),g=i(l,c,f,d+"/conv2");return{conv1:m,conv2:g}}return{extractConvLayerParams:i,extractResidualLayerParams:s}}function XP(r){var t=ii(r),e=t.extractWeights,n=t.getRemainingWeights,a=[],i=KP(e,a),s=i.extractConvLayerParams,l=i.extractResidualLayerParams,c=s(4704,32,7,"conv32_down"),f=l(9216,32,3,"conv32_1"),d=l(9216,32,3,"conv32_2"),v=l(9216,32,3,"conv32_3"),m=l(36864,64,3,"conv64_down",!0),g=l(36864,64,3,"conv64_1"),b=l(36864,64,3,"conv64_2"),w=l(36864,64,3,"conv64_3"),_=l(147456,128,3,"conv128_down",!0),S=l(147456,128,3,"conv128_1"),E=l(147456,128,3,"conv128_2"),C=l(589824,256,3,"conv256_down",!0),R=l(589824,256,3,"conv256_1"),A=l(589824,256,3,"conv256_2"),D=l(589824,256,3,"conv256_down_out"),k=_e(function(){return oo(eo(e(256*128),[128,256]),[1,0])});if(a.push({paramPath:"fc"}),n().length!==0)throw new Error("weights remaing after extract: "+n().length);var I={conv32_down:c,conv32_1:f,conv32_2:d,conv32_3:v,conv64_down:m,conv64_1:g,conv64_2:b,conv64_3:w,conv128_down:_,conv128_1:S,conv128_2:E,conv256_down:C,conv256_1:R,conv256_2:A,conv256_down_out:D,fc:k};return{params:I,paramMappings:a}}function $P(r,t){var e=co(r,t);function n(s){var l=e(s+"/scale/weights",1),c=e(s+"/scale/biases",1);return{weights:l,biases:c}}function a(s){var l=e(s+"/conv/filters",4),c=e(s+"/conv/bias",1),f=n(s);return{conv:{filters:l,bias:c},scale:f}}function i(s){return{conv1:a(s+"/conv1"),conv2:a(s+"/conv2")}}return{extractConvLayerParams:a,extractResidualLayerParams:i}}function YP(r){var t=[],e=$P(r,t),n=e.extractConvLayerParams,a=e.extractResidualLayerParams,i=n("conv32_down"),s=a("conv32_1"),l=a("conv32_2"),c=a("conv32_3"),f=a("conv64_down"),d=a("conv64_1"),v=a("conv64_2"),m=a("conv64_3"),g=a("conv128_down"),b=a("conv128_1"),w=a("conv128_2"),_=a("conv256_down"),S=a("conv256_1"),E=a("conv256_2"),C=a("conv256_down_out"),R=r.fc;if(t.push({originalPath:"fc",paramPath:"fc"}),!iP(R))throw new Error("expected weightMap[fc] to be a Tensor2D, instead have "+R);var A={conv32_down:i,conv32_1:s,conv32_2:l,conv32_3:c,conv64_down:f,conv64_1:d,conv64_2:v,conv64_3:m,conv128_down:g,conv128_1:b,conv128_2:w,conv256_down:_,conv256_1:S,conv256_2:E,conv256_down_out:C,fc:R};return ai(r,t),{params:A,paramMappings:t}}function ra(r,t){var e=qP(r,t.conv1);return e=fR(e,t.conv2),e=et(e,r),e=Mt(e),e}function vh(r,t){var e=hR(r,t.conv1);e=fR(e,t.conv2);var n=Ic(r,2,2,"valid"),a=Dt(n.shape),i=n.shape[3]!==e.shape[3],s=n.shape[1]!==e.shape[1]||n.shape[2]!==e.shape[2];if(s){var l=nc(e.shape);l[1]=1;var c=Dt(l);e=nn([e,c],1);var f=nc(e.shape);f[2]=1;var d=Dt(f);e=nn([e,d],2)}return n=i?nn([n,a],3):n,e=et(n,e),e=Mt(e),e}var QP=function(r){He(t,r);function t(){return r.call(this,"FaceRecognitionNet")||this}return t.prototype.forwardInput=function(e){var n=this.params;if(!n)throw new Error("FaceRecognitionNet - load model before inference");return _e(function(){var a=e.toBatchTensor(150,!0).toFloat(),i=[122.782,117.001,104.298],s=Bc(a,i).div(ye(256)),l=hR(s,n.conv32_down);l=hn(l,3,2,"valid"),l=ra(l,n.conv32_1),l=ra(l,n.conv32_2),l=ra(l,n.conv32_3),l=vh(l,n.conv64_down),l=ra(l,n.conv64_1),l=ra(l,n.conv64_2),l=ra(l,n.conv64_3),l=vh(l,n.conv128_down),l=ra(l,n.conv128_1),l=ra(l,n.conv128_2),l=vh(l,n.conv256_down),l=ra(l,n.conv256_1),l=ra(l,n.conv256_2),l=vh(l,n.conv256_down_out);var c=l.mean([1,2]),f=Ad(c,n.fc);return f})},t.prototype.forward=function(e){return ke(this,void 0,void 0,function(){var n;return Oe(this,function(a){switch(a.label){case 0:return n=this.forwardInput,[4,mn(e)];case 1:return[2,n.apply(this,[a.sent()])]}})})},t.prototype.computeFaceDescriptor=function(e){return ke(this,void 0,void 0,function(){var n,a,i,s=this;return Oe(this,function(l){switch(l.label){case 0:return[4,mn(e)];case 1:return n=l.sent(),a=_e(function(){return rn(s.forwardInput(n))}),[4,Promise.all(a.map(function(c){return c.data()}))];case 2:return i=l.sent(),a.forEach(function(c){return c.dispose()}),[2,n.isBatchInput?i:i[0]]}})})},t.prototype.getDefaultModelName=function(){return"face_recognition_model"},t.prototype.extractParamsFromWeigthMap=function(e){return YP(e)},t.prototype.extractParams=function(e){return XP(e)},t}(ri);function dR(r,t){var e={descriptor:t};return Object.assign({},r,e)}function pR(r,t){var e={age:t};return Object.assign({},r,e)}function vR(r,t,e){var n={gender:t,genderProbability:e};return Object.assign({},r,n)}var mR=function(){function r(t){var e=t===void 0?{}:t,n=e.minFaceSize,a=e.scaleFactor,i=e.maxNumScales,s=e.scoreThresholds,l=e.scaleSteps;if(this._name="MtcnnOptions",this._minFaceSize=n||20,this._scaleFactor=a||.709,this._maxNumScales=i||10,this._scoreThresholds=s||[.6,.7,.7],this._scaleSteps=l,typeof this._minFaceSize!="number"||this._minFaceSize<0)throw new Error(this._name+" - expected minFaceSize to be a number > 0");if(typeof this._scaleFactor!="number"||this._scaleFactor<=0||this._scaleFactor>=1)throw new Error(this._name+" - expected scaleFactor to be a number between 0 and 1");if(typeof this._maxNumScales!="number"||this._maxNumScales<0)throw new Error(this._name+" - expected maxNumScales to be a number > 0");if(!Array.isArray(this._scoreThresholds)||this._scoreThresholds.length!==3||this._scoreThresholds.some(function(c){return typeof c!="number"}))throw new Error(this._name+" - expected scoreThresholds to be an array of numbers of length 3");if(this._scaleSteps&&(!Array.isArray(this._scaleSteps)||this._scaleSteps.some(function(c){return typeof c!="number"})))throw new Error(this._name+" - expected scaleSteps to be an array of numbers")}return Object.defineProperty(r.prototype,"minFaceSize",{get:function(){return this._minFaceSize},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"scaleFactor",{get:function(){return this._scaleFactor},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"maxNumScales",{get:function(){return this._maxNumScales},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"scoreThresholds",{get:function(){return this._scoreThresholds},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"scaleSteps",{get:function(){return this._scaleSteps},enumerable:!0,configurable:!0}),r}();function ZP(r,t){function e(c,f){var d=Xn(r(9*c),[3,3,c,1]),v=Xt(r(c)),m=Xt(r(c)),g=Xt(r(c)),b=Xt(r(c));return t.push({paramPath:f+"/filters"},{paramPath:f+"/batch_norm_scale"},{paramPath:f+"/batch_norm_offset"},{paramPath:f+"/batch_norm_mean"},{paramPath:f+"/batch_norm_variance"}),{filters:d,batch_norm_scale:v,batch_norm_offset:m,batch_norm_mean:g,batch_norm_variance:b}}function n(c,f,d,v,m){var g=Xn(r(c*f*d*d),[d,d,c,f]),b=Xt(r(f));return t.push({paramPath:v+"/filters"},{paramPath:v+"/"+(m?"batch_norm_offset":"bias")}),{filters:g,bias:b}}function a(c,f,d,v){var m=n(c,f,d,v,!0),g=m.filters,b=m.bias;return{filters:g,batch_norm_offset:b}}function i(c,f,d){var v=e(c,d+"/depthwise_conv"),m=a(c,f,1,d+"/pointwise_conv");return{depthwise_conv:v,pointwise_conv:m}}function s(){var c=a(3,32,3,"mobilenetv1/conv_0"),f=i(32,64,"mobilenetv1/conv_1"),d=i(64,128,"mobilenetv1/conv_2"),v=i(128,128,"mobilenetv1/conv_3"),m=i(128,256,"mobilenetv1/conv_4"),g=i(256,256,"mobilenetv1/conv_5"),b=i(256,512,"mobilenetv1/conv_6"),w=i(512,512,"mobilenetv1/conv_7"),_=i(512,512,"mobilenetv1/conv_8"),S=i(512,512,"mobilenetv1/conv_9"),E=i(512,512,"mobilenetv1/conv_10"),C=i(512,512,"mobilenetv1/conv_11"),R=i(512,1024,"mobilenetv1/conv_12"),A=i(1024,1024,"mobilenetv1/conv_13");return{conv_0:c,conv_1:f,conv_2:d,conv_3:v,conv_4:m,conv_5:g,conv_6:b,conv_7:w,conv_8:_,conv_9:S,conv_10:E,conv_11:C,conv_12:R,conv_13:A}}function l(){var c=a(1024,256,1,"prediction_layer/conv_0"),f=a(256,512,3,"prediction_layer/conv_1"),d=a(512,128,1,"prediction_layer/conv_2"),v=a(128,256,3,"prediction_layer/conv_3"),m=a(256,128,1,"prediction_layer/conv_4"),g=a(128,256,3,"prediction_layer/conv_5"),b=a(256,64,1,"prediction_layer/conv_6"),w=a(64,128,3,"prediction_layer/conv_7"),_=n(512,12,1,"prediction_layer/box_predictor_0/box_encoding_predictor"),S=n(512,9,1,"prediction_layer/box_predictor_0/class_predictor"),E=n(1024,24,1,"prediction_layer/box_predictor_1/box_encoding_predictor"),C=n(1024,18,1,"prediction_layer/box_predictor_1/class_predictor"),R=n(512,24,1,"prediction_layer/box_predictor_2/box_encoding_predictor"),A=n(512,18,1,"prediction_layer/box_predictor_2/class_predictor"),D=n(256,24,1,"prediction_layer/box_predictor_3/box_encoding_predictor"),k=n(256,18,1,"prediction_layer/box_predictor_3/class_predictor"),I=n(256,24,1,"prediction_layer/box_predictor_4/box_encoding_predictor"),O=n(256,18,1,"prediction_layer/box_predictor_4/class_predictor"),M=n(128,24,1,"prediction_layer/box_predictor_5/box_encoding_predictor"),V=n(128,18,1,"prediction_layer/box_predictor_5/class_predictor"),z={box_encoding_predictor:_,class_predictor:S},J={box_encoding_predictor:E,class_predictor:C},te={box_encoding_predictor:R,class_predictor:A},ne={box_encoding_predictor:D,class_predictor:k},P={box_encoding_predictor:I,class_predictor:O},W={box_encoding_predictor:M,class_predictor:V};return{conv_0:c,conv_1:f,conv_2:d,conv_3:v,conv_4:m,conv_5:g,conv_6:b,conv_7:w,box_predictor_0:z,box_predictor_1:J,box_predictor_2:te,box_predictor_3:ne,box_predictor_4:P,box_predictor_5:W}}return{extractMobilenetV1Params:s,extractPredictionLayerParams:l}}function JP(r){var t=[],e=ii(r),n=e.extractWeights,a=e.getRemainingWeights,i=ZP(n,t),s=i.extractMobilenetV1Params,l=i.extractPredictionLayerParams,c=s(),f=l(),d=gy(n(5118*4),[1,5118,4]),v={extra_dim:d};if(t.push({paramPath:"output_layer/extra_dim"}),a().length!==0)throw new Error("weights remaing after extract: "+a().length);return{params:{mobilenetv1:c,prediction_layer:f,output_layer:v},paramMappings:t}}function ez(r,t){var e=co(r,t);function n(f,d,v){var m=e(f+"/Conv2d_"+d+"_pointwise/weights",4,v+"/filters"),g=e(f+"/Conv2d_"+d+"_pointwise/convolution_bn_offset",1,v+"/batch_norm_offset");return{filters:m,batch_norm_offset:g}}function a(f){var d="mobilenetv1/conv_"+f,v="MobilenetV1/Conv2d_"+f+"_depthwise",m=d+"/depthwise_conv",g=d+"/pointwise_conv",b=e(v+"/depthwise_weights",4,m+"/filters"),w=e(v+"/BatchNorm/gamma",1,m+"/batch_norm_scale"),_=e(v+"/BatchNorm/beta",1,m+"/batch_norm_offset"),S=e(v+"/BatchNorm/moving_mean",1,m+"/batch_norm_mean"),E=e(v+"/BatchNorm/moving_variance",1,m+"/batch_norm_variance");return{depthwise_conv:{filters:b,batch_norm_scale:w,batch_norm_offset:_,batch_norm_mean:S,batch_norm_variance:E},pointwise_conv:n("MobilenetV1",f,g)}}function i(){return{conv_0:n("MobilenetV1",0,"mobilenetv1/conv_0"),conv_1:a(1),conv_2:a(2),conv_3:a(3),conv_4:a(4),conv_5:a(5),conv_6:a(6),conv_7:a(7),conv_8:a(8),conv_9:a(9),conv_10:a(10),conv_11:a(11),conv_12:a(12),conv_13:a(13)}}function s(f,d){var v=e(f+"/weights",4,d+"/filters"),m=e(f+"/biases",1,d+"/bias");return{filters:v,bias:m}}function l(f){var d=s("Prediction/BoxPredictor_"+f+"/BoxEncodingPredictor","prediction_layer/box_predictor_"+f+"/box_encoding_predictor"),v=s("Prediction/BoxPredictor_"+f+"/ClassPredictor","prediction_layer/box_predictor_"+f+"/class_predictor");return{box_encoding_predictor:d,class_predictor:v}}function c(){return{conv_0:n("Prediction",0,"prediction_layer/conv_0"),conv_1:n("Prediction",1,"prediction_layer/conv_1"),conv_2:n("Prediction",2,"prediction_layer/conv_2"),conv_3:n("Prediction",3,"prediction_layer/conv_3"),conv_4:n("Prediction",4,"prediction_layer/conv_4"),conv_5:n("Prediction",5,"prediction_layer/conv_5"),conv_6:n("Prediction",6,"prediction_layer/conv_6"),conv_7:n("Prediction",7,"prediction_layer/conv_7"),box_predictor_0:l(0),box_predictor_1:l(1),box_predictor_2:l(2),box_predictor_3:l(3),box_predictor_4:l(4),box_predictor_5:l(5)}}return{extractMobilenetV1Params:i,extractPredictionLayerParams:c}}function tz(r){var t=[],e=ez(r,t),n=e.extractMobilenetV1Params,a=e.extractPredictionLayerParams,i=r["Output/extra_dim"];if(t.push({originalPath:"Output/extra_dim",paramPath:"output_layer/extra_dim"}),!Od(i))throw new Error("expected weightMap['Output/extra_dim'] to be a Tensor3D, instead have "+i);var s={mobilenetv1:n(),prediction_layer:a(),output_layer:{extra_dim:i}};return ai(r,t),{params:s,paramMappings:t}}function aa(r,t,e){return _e(function(){var n=Ir(r,t.filters,e,"same");return n=et(n,t.batch_norm_offset),Ty(n,0,6)})}var nz=.0010000000474974513;function rz(r,t,e){return _e(function(){var n=Rd(r,t.filters,e,"same");return n=lC(n,t.batch_norm_mean,t.batch_norm_variance,t.batch_norm_offset,t.batch_norm_scale,nz),Ty(n,0,6)})}function az(r){return[2,4,6,12].some(function(t){return t===r})?[2,2]:[1,1]}function iz(r,t){return _e(function(){var e=null,n=aa(r,t.conv_0,[2,2]),a=[t.conv_1,t.conv_2,t.conv_3,t.conv_4,t.conv_5,t.conv_6,t.conv_7,t.conv_8,t.conv_9,t.conv_10,t.conv_11,t.conv_12,t.conv_13];if(a.forEach(function(i,s){var l=s+1,c=az(l);n=rz(n,i.depthwise_conv,c),n=aa(n,i.pointwise_conv,[1,1]),l===11&&(e=n)}),e===null)throw new Error("mobileNetV1 - output of conv layer 11 is null");return{out:n,conv11:e}})}function oz(r,t,e,n,a){var i=r.shape[0],s=Math.min(e,i),l=t.map(function(d,v){return{score:d,boxIndex:v}}).filter(function(d){return d.score>a}).sort(function(d,v){return v.score-d.score}),c=function(d){return d<=n?1:0},f=[];return l.forEach(function(d){if(!(f.length>=s)){for(var v=d.score,m=f.length-1;m>=0;--m){var g=sz(r,d.boxIndex,f[m]);if(g!==0&&(d.score*=c(g),d.score<=a))break}v===d.score&&f.push(d.boxIndex)}}),f}function sz(r,t,e){var n=r.arraySync(),a=Math.min(n[t][0],n[t][2]),i=Math.min(n[t][1],n[t][3]),s=Math.max(n[t][0],n[t][2]),l=Math.max(n[t][1],n[t][3]),c=Math.min(n[e][0],n[e][2]),f=Math.min(n[e][1],n[e][3]),d=Math.max(n[e][0],n[e][2]),v=Math.max(n[e][1],n[e][3]),m=(s-a)*(l-i),g=(d-c)*(v-f);if(m<=0||g<=0)return 0;var b=Math.max(a,c),w=Math.max(i,f),_=Math.min(s,d),S=Math.min(l,v),E=Math.max(_-b,0)*Math.max(S-w,0);return E/(m+g-E)}function uz(r){var t=rn(oo(r,[1,0])),e=[on(t[2],t[0]),on(t[3],t[1])],n=[et(t[0],jr(e[0],ye(2))),et(t[1],jr(e[1],ye(2)))];return{sizes:e,centers:n}}function lz(r,t){var e=uz(r),n=e.sizes,a=e.centers,i=rn(oo(t,[1,0])),s=jr(Mn(Vg(jr(i[2],ye(5))),n[0]),ye(2)),l=et(Mn(jr(i[0],ye(10)),n[0]),a[0]),c=jr(Mn(Vg(jr(i[3],ye(5))),n[1]),ye(2)),f=et(Mn(jr(i[1],ye(10)),n[1]),a[1]);return oo(dr([on(l,s),on(f,c),et(l,s),et(f,c)]),[1,0])}function cz(r,t,e){return _e(function(){var n=r.shape[0],a=lz(Wr(au(e.extra_dim,[n,1,1]),[-1,4]),Wr(r,[-1,4]));a=Wr(a,[n,a.shape[0]/n,4]);var i=iC(ya(t,[0,0,1],[-1,-1,-1])),s=ya(i,[0,0,0],[-1,-1,1]);s=Wr(s,[n,s.shape[1]]);var l=rn(a),c=rn(s);return{boxes:l,scores:c}})}function Xs(r,t){return _e(function(){var e=r.shape[0],n=Wr(qr(r,t.box_encoding_predictor),[e,-1,1,4]),a=Wr(qr(r,t.class_predictor),[e,-1,3]);return{boxPredictionEncoding:n,classPrediction:a}})}function fz(r,t,e){return _e(function(){var n=aa(r,e.conv_0,[1,1]),a=aa(n,e.conv_1,[2,2]),i=aa(a,e.conv_2,[1,1]),s=aa(i,e.conv_3,[2,2]),l=aa(s,e.conv_4,[1,1]),c=aa(l,e.conv_5,[2,2]),f=aa(c,e.conv_6,[1,1]),d=aa(f,e.conv_7,[2,2]),v=Xs(t,e.box_predictor_0),m=Xs(r,e.box_predictor_1),g=Xs(a,e.box_predictor_2),b=Xs(s,e.box_predictor_3),w=Xs(c,e.box_predictor_4),_=Xs(d,e.box_predictor_5),S=nn([v.boxPredictionEncoding,m.boxPredictionEncoding,g.boxPredictionEncoding,b.boxPredictionEncoding,w.boxPredictionEncoding,_.boxPredictionEncoding],1),E=nn([v.classPrediction,m.classPrediction,g.classPrediction,b.classPrediction,w.classPrediction,_.classPrediction],1);return{boxPredictions:S,classPredictions:E}})}var Bd=function(){function r(t){var e=t===void 0?{}:t,n=e.minConfidence,a=e.maxResults;if(this._name="SsdMobilenetv1Options",this._minConfidence=n||.5,this._maxResults=a||100,typeof this._minConfidence!="number"||this._minConfidence<=0||this._minConfidence>=1)throw new Error(this._name+" - expected minConfidence to be a number between 0 and 1");if(typeof this._maxResults!="number")throw new Error(this._name+" - expected maxResults to be a number")}return Object.defineProperty(r.prototype,"minConfidence",{get:function(){return this._minConfidence},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"maxResults",{get:function(){return this._maxResults},enumerable:!0,configurable:!0}),r}(),gR=function(r){He(t,r);function t(){return r.call(this,"SsdMobilenetv1")||this}return t.prototype.forwardInput=function(e){var n=this.params;if(!n)throw new Error("SsdMobilenetv1 - load model before inference");return _e(function(){var a=e.toBatchTensor(512,!1).toFloat(),i=on(Mn(a,ye(.007843137718737125)),ye(1)),s=iz(i,n.mobilenetv1),l=fz(s.out,s.conv11,n.prediction_layer),c=l.boxPredictions,f=l.classPredictions;return cz(c,f,n.output_layer)})},t.prototype.forward=function(e){return ke(this,void 0,void 0,function(){var n;return Oe(this,function(a){switch(a.label){case 0:return n=this.forwardInput,[4,mn(e)];case 1:return[2,n.apply(this,[a.sent()])]}})})},t.prototype.locateFaces=function(e,n){return n===void 0&&(n={}),ke(this,void 0,void 0,function(){var a,i,s,l,c,f,d,v,m,g,b,w,_,S,E,C,R,A,D,k,I;return Oe(this,function(O){switch(O.label){case 0:return a=new Bd(n),i=a.maxResults,s=a.minConfidence,[4,mn(e)];case 1:for(l=O.sent(),c=this.forwardInput(l),f=c.boxes,d=c.scores,v=f[0],m=d[0],g=1;g<f.length;g++)f[g].dispose(),d[g].dispose();return _=(w=Array).from,[4,m.data()];case 2:return b=_.apply(w,[O.sent()]),S=.5,E=oz(v,b,i,S,s),C=l.getReshapedInputDimensions(0),R=l.inputSize,A=R/C.width,D=R/C.height,k=v.arraySync(),I=E.map(function(M){var V=[Math.max(0,k[M][0]),Math.min(1,k[M][2])].map(function(W){return W*D}),z=V[0],J=V[1],te=[Math.max(0,k[M][1]),Math.min(1,k[M][3])].map(function(W){return W*A}),ne=te[0],P=te[1];return new vr(b[M],new qy(ne,z,P-ne,J-z),{height:l.getInputHeight(0),width:l.getInputWidth(0)})}),v.dispose(),m.dispose(),[2,I]}})})},t.prototype.getDefaultModelName=function(){return"ssd_mobilenetv1_model"},t.prototype.extractParamsFromWeigthMap=function(e){return tz(e)},t.prototype.extractParams=function(e){return JP(e)},t}(ri);(function(r){He(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t})(gR);var hz=.4,dz=[new ht(.738768,.874946),new ht(2.42204,2.65704),new ht(4.30971,7.04493),new ht(10.246,4.59428),new ht(12.6868,11.8741)],pz=[new ht(1.603231,2.094468),new ht(6.041143,7.080126),new ht(2.882459,3.518061),new ht(4.266906,5.178857),new ht(9.041765,10.66308)],vz=[117.001,114.697,97.404],mz="tiny_yolov2_model",gz="tiny_yolov2_separable_conv_model",mh=function(r){return typeof r=="number"};function yz(r){if(!r)throw new Error("invalid config: "+r);if(typeof r.withSeparableConvs!="boolean")throw new Error("config.withSeparableConvs has to be a boolean, have: "+r.withSeparableConvs);if(!mh(r.iouThreshold)||r.iouThreshold<0||r.iouThreshold>1)throw new Error("config.iouThreshold has to be a number between [0, 1], have: "+r.iouThreshold);if(!Array.isArray(r.classes)||!r.classes.length||!r.classes.every(function(t){return typeof t=="string"}))throw new Error("config.classes has to be an array class names: string[], have: "+JSON.stringify(r.classes));if(!Array.isArray(r.anchors)||!r.anchors.length||!r.anchors.map(function(t){return t||{}}).every(function(t){return mh(t.x)&&mh(t.y)}))throw new Error("config.anchors has to be an array of { x: number, y: number }, have: "+JSON.stringify(r.anchors));if(r.meanRgb&&(!Array.isArray(r.meanRgb)||r.meanRgb.length!==3||!r.meanRgb.every(mh)))throw new Error("config.meanRgb has to be an array of shape [number, number, number], have: "+JSON.stringify(r.meanRgb))}function a0(r){return _e(function(){var t=Mn(r,ye(.10000000149011612));return et(Mt(on(r,t)),t)})}function Ni(r,t){return _e(function(){var e=es(r,[[0,0],[1,1],[1,1],[0,0]]);return e=Ir(e,t.conv.filters,[1,1],"valid"),e=on(e,t.bn.sub),e=Mn(e,t.bn.truediv),e=et(e,t.conv.bias),a0(e)})}function Mi(r,t){return _e(function(){var e=es(r,[[0,0],[1,1],[1,1],[0,0]]);return e=Ny(e,t.depthwise_filter,t.pointwise_filter,[1,1],"valid"),e=et(e,t.bias),a0(e)})}function bz(r,t){var e=Id(r,t);function n(s,l){var c=Xt(r(s)),f=Xt(r(s));return t.push({paramPath:l+"/sub"},{paramPath:l+"/truediv"}),{sub:c,truediv:f}}function a(s,l,c){var f=e(s,l,3,c+"/conv"),d=n(l,c+"/bn");return{conv:f,bn:d}}var i=e0(r,t);return{extractConvParams:e,extractConvWithBatchNormParams:a,extractSeparableConvParams:i}}function xz(r,t,e,n){var a=ii(r),i=a.extractWeights,s=a.getRemainingWeights,l=[],c=bz(i,l),f=c.extractConvParams,d=c.extractConvWithBatchNormParams,v=c.extractSeparableConvParams,m;if(t.withSeparableConvs){var g=n[0],b=n[1],w=n[2],_=n[3],S=n[4],E=n[5],C=n[6],R=n[7],A=n[8],D=t.isFirstLayerConv2d?f(g,b,3,"conv0"):v(g,b,"conv0"),k=v(b,w,"conv1"),I=v(w,_,"conv2"),O=v(_,S,"conv3"),M=v(S,E,"conv4"),V=v(E,C,"conv5"),z=R?v(C,R,"conv6"):void 0,J=A?v(R,A,"conv7"):void 0,te=f(A||R||C,5*e,1,"conv8");m={conv0:D,conv1:k,conv2:I,conv3:O,conv4:M,conv5:V,conv6:z,conv7:J,conv8:te}}else{var g=n[0],b=n[1],w=n[2],_=n[3],S=n[4],E=n[5],C=n[6],R=n[7],A=n[8],D=d(g,b,"conv0"),k=d(b,w,"conv1"),I=d(w,_,"conv2"),O=d(_,S,"conv3"),M=d(S,E,"conv4"),V=d(E,C,"conv5"),z=d(C,R,"conv6"),J=d(R,A,"conv7"),te=f(A,5*e,1,"conv8");m={conv0:D,conv1:k,conv2:I,conv3:O,conv4:M,conv5:V,conv6:z,conv7:J,conv8:te}}if(s().length!==0)throw new Error("weights remaing after extract: "+s().length);return{params:m,paramMappings:l}}function wz(r,t){var e=co(r,t);function n(l){var c=e(l+"/sub",1),f=e(l+"/truediv",1);return{sub:c,truediv:f}}function a(l){var c=e(l+"/filters",4),f=e(l+"/bias",1);return{filters:c,bias:f}}function i(l){var c=a(l+"/conv"),f=n(l+"/bn");return{conv:c,bn:f}}var s=t0(e);return{extractConvParams:a,extractConvWithBatchNormParams:i,extractSeparableConvParams:s}}function _z(r,t){var e=[],n=wz(r,e),a=n.extractConvParams,i=n.extractConvWithBatchNormParams,s=n.extractSeparableConvParams,l;if(t.withSeparableConvs){var c=t.filterSizes&&t.filterSizes.length||9;l={conv0:t.isFirstLayerConv2d?a("conv0"):s("conv0"),conv1:s("conv1"),conv2:s("conv2"),conv3:s("conv3"),conv4:s("conv4"),conv5:s("conv5"),conv6:c>7?s("conv6"):void 0,conv7:c>8?s("conv7"):void 0,conv8:a("conv8")}}else l={conv0:i("conv0"),conv1:i("conv1"),conv2:i("conv2"),conv3:i("conv3"),conv4:i("conv4"),conv5:i("conv5"),conv6:i("conv6"),conv7:i("conv7"),conv8:a("conv8")};return ai(r,e),{params:l,paramMappings:e}}var I_;(function(r){r[r.XS=224]="XS",r[r.SM=320]="SM",r[r.MD=416]="MD",r[r.LG=608]="LG"})(I_||(I_={}));var i0=function(){function r(t){var e=t===void 0?{}:t,n=e.inputSize,a=e.scoreThreshold;if(this._name="TinyYolov2Options",this._inputSize=n||416,this._scoreThreshold=a||.5,typeof this._inputSize!="number"||this._inputSize%32!==0)throw new Error(this._name+" - expected inputSize to be a number divisible by 32");if(typeof this._scoreThreshold!="number"||this._scoreThreshold<=0||this._scoreThreshold>=1)throw new Error(this._name+" - expected scoreThreshold to be a number between 0 and 1")}return Object.defineProperty(r.prototype,"inputSize",{get:function(){return this._inputSize},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"scoreThreshold",{get:function(){return this._scoreThreshold},enumerable:!0,configurable:!0}),r}(),yR=function(r){He(t,r);function t(e){var n=r.call(this,"TinyYolov2")||this;return yz(e),n._config=e,n}return Object.defineProperty(t.prototype,"config",{get:function(){return this._config},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"withClassScores",{get:function(){return this.config.withClassScores||this.config.classes.length>1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"boxEncodingSize",{get:function(){return 5+(this.withClassScores?this.config.classes.length:0)},enumerable:!0,configurable:!0}),t.prototype.runTinyYolov2=function(e,n){var a=Ni(e,n.conv0);return a=hn(a,[2,2],[2,2],"same"),a=Ni(a,n.conv1),a=hn(a,[2,2],[2,2],"same"),a=Ni(a,n.conv2),a=hn(a,[2,2],[2,2],"same"),a=Ni(a,n.conv3),a=hn(a,[2,2],[2,2],"same"),a=Ni(a,n.conv4),a=hn(a,[2,2],[2,2],"same"),a=Ni(a,n.conv5),a=hn(a,[2,2],[1,1],"same"),a=Ni(a,n.conv6),a=Ni(a,n.conv7),qr(a,n.conv8,"valid",!1)},t.prototype.runMobilenet=function(e,n){var a=this.config.isFirstLayerConv2d?a0(qr(e,n.conv0,"valid",!1)):Mi(e,n.conv0);return a=hn(a,[2,2],[2,2],"same"),a=Mi(a,n.conv1),a=hn(a,[2,2],[2,2],"same"),a=Mi(a,n.conv2),a=hn(a,[2,2],[2,2],"same"),a=Mi(a,n.conv3),a=hn(a,[2,2],[2,2],"same"),a=Mi(a,n.conv4),a=hn(a,[2,2],[2,2],"same"),a=Mi(a,n.conv5),a=hn(a,[2,2],[1,1],"same"),a=n.conv6?Mi(a,n.conv6):a,a=n.conv7?Mi(a,n.conv7):a,qr(a,n.conv8,"valid",!1)},t.prototype.forwardInput=function(e,n){var a=this,i=this.params;if(!i)throw new Error("TinyYolov2 - load model before inference");return _e(function(){var s=e.toBatchTensor(n,!1).toFloat();return s=a.config.meanRgb?Bc(s,a.config.meanRgb):s,s=s.div(ye(256)),a.config.withSeparableConvs?a.runMobilenet(s,i):a.runTinyYolov2(s,i)})},t.prototype.forward=function(e,n){return ke(this,void 0,void 0,function(){var a;return Oe(this,function(i){switch(i.label){case 0:return a=this.forwardInput,[4,mn(e)];case 1:return[4,a.apply(this,[i.sent(),n])];case 2:return[2,i.sent()]}})})},t.prototype.detect=function(e,n){return n===void 0&&(n={}),ke(this,void 0,void 0,function(){var a,i,s,l,c,f,d,v,m,g,b,w,_,S,E=this;return Oe(this,function(C){switch(C.label){case 0:return a=new i0(n),i=a.inputSize,s=a.scoreThreshold,[4,mn(e)];case 1:return l=C.sent(),[4,this.forwardInput(l,i)];case 2:return c=C.sent(),f=_e(function(){return rn(c)[0].expandDims()}),d={width:l.getInputWidth(0),height:l.getInputHeight(0)},[4,this.extractBoxes(f,l.getReshapedInputDimensions(0),s)];case 3:return v=C.sent(),c.dispose(),f.dispose(),m=v.map(function(R){return R.box}),g=v.map(function(R){return R.score}),b=v.map(function(R){return R.classScore}),w=v.map(function(R){return E.config.classes[R.label]}),_=gc(m.map(function(R){return R.rescale(i)}),g,this.config.iouThreshold,!0),S=_.map(function(R){return new jC(g[R],b[R],w[R],m[R],d)}),[2,S]}})})},t.prototype.getDefaultModelName=function(){return""},t.prototype.extractParamsFromWeigthMap=function(e){return _z(e,this.config)},t.prototype.extractParams=function(e){var n=this.config.filterSizes||t.DEFAULT_FILTER_SIZES,a=n?n.length:void 0;if(a!==7&&a!==8&&a!==9)throw new Error("TinyYolov2 - expected 7 | 8 | 9 convolutional filters, but found "+a+" filterSizes in config");return xz(e,this.config,this.boxEncodingSize,n)},t.prototype.extractBoxes=function(e,n,a){return ke(this,void 0,void 0,function(){var i,s,l,c,f,d,v,m,g,b,w,_,S,E,C,R,A,D,k,I,O,M,V,z,J,te,ne,P,W,X=this;return Oe(this,function(re){switch(re.label){case 0:return i=n.width,s=n.height,l=Math.max(i,s),c=l/i,f=l/s,d=e.shape[1],v=this.config.anchors.length,m=_e(function(){var F=e.reshape([d,d,v,X.boxEncodingSize]),q=F.slice([0,0,0,0],[d,d,v,4]),oe=F.slice([0,0,0,4],[d,d,v,1]),se=X.withClassScores?ti(F.slice([0,0,0,5],[d,d,v,X.config.classes.length]),3):ye(0);return[q,oe,se]}),g=m[0],b=m[1],w=m[2],_=[],[4,b.array()];case 1:return S=re.sent(),[4,g.array()];case 2:E=re.sent(),C=0,re.label=3;case 3:if(!(C<d))return[3,12];R=0,re.label=4;case 4:if(!(R<d))return[3,11];A=0,re.label=5;case 5:return A<v?(D=jm(S[C][R][A][0]),!a||D>a?(k=(R+jm(E[C][R][A][0]))/d*c,I=(C+jm(E[C][R][A][1]))/d*f,O=Math.exp(E[C][R][A][2])*this.config.anchors[A].x/d*c,M=Math.exp(E[C][R][A][3])*this.config.anchors[A].y/d*f,V=k-O/2,z=I-M/2,J={row:C,col:R,anchor:A},this.withClassScores?[4,this.extractPredictedClass(w,J)]:[3,7]):[3,9]):[3,10];case 6:return W=re.sent(),[3,8];case 7:W={classScore:1,label:0},re.label=8;case 8:te=W,ne=te.classScore,P=te.label,_.push(kn({box:new Nd(V,z,V+O,z+M),score:D,classScore:D*ne,label:P},J)),re.label=9;case 9:return A++,[3,5];case 10:return R++,[3,4];case 11:return C++,[3,3];case 12:return g.dispose(),b.dispose(),w.dispose(),[2,_]}})})},t.prototype.extractPredictedClass=function(e,n){return ke(this,void 0,void 0,function(){var a,i,s,l;return Oe(this,function(c){switch(c.label){case 0:return a=n.row,i=n.col,s=n.anchor,[4,e.array()];case 1:return l=c.sent(),[2,Array(this.config.classes.length).fill(0).map(function(f,d){return l[a][i][s][d]}).map(function(f,d){return{classScore:f,label:d}}).reduce(function(f,d){return f.classScore>d.classScore?f:d})]}})})},t.DEFAULT_FILTER_SIZES=[3,16,32,64,128,256,512,1024,1024],t}(ri),Sz=function(r){He(t,r);function t(e){e===void 0&&(e=!0);var n=this,a=Object.assign({},{withSeparableConvs:e,iouThreshold:hz,classes:["face"]},e?{anchors:pz,meanRgb:vz}:{anchors:dz,withClassScores:!0});return n=r.call(this,a)||this,n}return Object.defineProperty(t.prototype,"withSeparableConvs",{get:function(){return this.config.withSeparableConvs},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"anchors",{get:function(){return this.config.anchors},enumerable:!0,configurable:!0}),t.prototype.locateFaces=function(e,n){return ke(this,void 0,void 0,function(){var a;return Oe(this,function(i){switch(i.label){case 0:return[4,this.detect(e,n)];case 1:return a=i.sent(),[2,a.map(function(s){return new vr(s.score,s.relativeBox,{width:s.imageWidth,height:s.imageHeight})})]}})})},t.prototype.getDefaultModelName=function(){return this.withSeparableConvs?gz:mz},t.prototype.extractParamsFromWeigthMap=function(e){return r.prototype.extractParamsFromWeigthMap.call(this,e)},t}(yR),Ez=function(r){He(t,r);function t(){var e=r!==null&&r.apply(this,arguments)||this;return e._name="TinyFaceDetectorOptions",e}return t}(i0),Lc=function(){function r(){}return r.prototype.then=function(t){return ke(this,void 0,void 0,function(){var e;return Oe(this,function(n){switch(n.label){case 0:return e=t,[4,this.run()];case 1:return[2,e.apply(void 0,[n.sent()])]}})})},r.prototype.run=function(){return ke(this,void 0,void 0,function(){return Oe(this,function(t){throw new Error("ComposableTask - run is not implemented")})})},r}();function Ld(r,t,e,n,a){return a===void 0&&(a=function(i){var s=i.alignedRect;return s}),ke(this,void 0,void 0,function(){var i,s,l,c,f;return Oe(this,function(d){switch(d.label){case 0:return i=r.map(function(v){return sR(v)?a(v):v.detection}),l=n,l?[3,5]:t instanceof Nt?[4,Zy(t,i)]:[3,2];case 1:return c=d.sent(),[3,4];case 2:return[4,Qy(t,i)];case 3:c=d.sent(),d.label=4;case 4:l=c,d.label=5;case 5:return s=l,[4,e(s)];case 6:return f=d.sent(),s.forEach(function(v){return v instanceof Nt&&v.dispose()}),[2,f]}})})}function o0(r,t,e,n,a){return ke(this,void 0,void 0,function(){var i=this;return Oe(this,function(s){return[2,Ld([r],t,function(l){return ke(i,void 0,void 0,function(){return Oe(this,function(c){return[2,e(l[0])]})})},n,a)]})})}function Cz(r){return _e(function(){return dr(rn(r,3).reverse(),3)})}var gh=2,fd=12;function Rz(r,t){var e=Id(r,t),n=Jy(r,t);function a(f,d){var v=Xt(r(f));return t.push({paramPath:d}),v}function i(f,d,v){v===void 0&&(v=!1);var m=e(f[0],f[1],3,d+"/conv1"),g=a(f[1],d+"/prelu1_alpha"),b=e(f[1],f[2],3,d+"/conv2"),w=a(f[2],d+"/prelu2_alpha"),_=e(f[2],f[3],v?2:3,d+"/conv3"),S=a(f[3],d+"/prelu3_alpha");return{conv1:m,prelu1_alpha:g,conv2:b,prelu2_alpha:w,conv3:_,prelu3_alpha:S}}function s(){var f=i([3,10,16,32],"pnet"),d=e(32,2,1,"pnet/conv4_1"),v=e(32,4,1,"pnet/conv4_2");return kn(kn({},f),{conv4_1:d,conv4_2:v})}function l(){var f=i([3,28,48,64],"rnet",!0),d=n(576,128,"rnet/fc1"),v=a(128,"rnet/prelu4_alpha"),m=n(128,2,"rnet/fc2_1"),g=n(128,4,"rnet/fc2_2");return kn(kn({},f),{fc1:d,prelu4_alpha:v,fc2_1:m,fc2_2:g})}function c(){var f=i([3,32,64,64],"onet"),d=e(64,128,2,"onet/conv4"),v=a(128,"onet/prelu4_alpha"),m=n(1152,256,"onet/fc1"),g=a(256,"onet/prelu5_alpha"),b=n(256,2,"onet/fc2_1"),w=n(256,4,"onet/fc2_2"),_=n(256,10,"onet/fc2_3");return kn(kn({},f),{conv4:d,prelu4_alpha:v,fc1:m,prelu5_alpha:g,fc2_1:b,fc2_2:w,fc2_3:_})}return{extractPNetParams:s,extractRNetParams:l,extractONetParams:c}}function Az(r){var t=ii(r),e=t.extractWeights,n=t.getRemainingWeights,a=[],i=Rz(e,a),s=i.extractPNetParams,l=i.extractRNetParams,c=i.extractONetParams,f=s(),d=l(),v=c();if(n().length!==0)throw new Error("weights remaing after extract: "+n().length);return{params:{pnet:f,rnet:d,onet:v},paramMappings:a}}function Tz(r,t){var e=co(r,t);function n(d){var v=e(d+"/weights",4,d+"/filters"),m=e(d+"/bias",1);return{filters:v,bias:m}}function a(d){var v=e(d+"/weights",2),m=e(d+"/bias",1);return{weights:v,bias:m}}function i(d){return e(d,1)}function s(d){var v=n(d+"/conv1"),m=i(d+"/prelu1_alpha"),g=n(d+"/conv2"),b=i(d+"/prelu2_alpha"),w=n(d+"/conv3"),_=i(d+"/prelu3_alpha");return{conv1:v,prelu1_alpha:m,conv2:g,prelu2_alpha:b,conv3:w,prelu3_alpha:_}}function l(){var d=s("pnet"),v=n("pnet/conv4_1"),m=n("pnet/conv4_2");return kn(kn({},d),{conv4_1:v,conv4_2:m})}function c(){var d=s("rnet"),v=a("rnet/fc1"),m=i("rnet/prelu4_alpha"),g=a("rnet/fc2_1"),b=a("rnet/fc2_2");return kn(kn({},d),{fc1:v,prelu4_alpha:m,fc2_1:g,fc2_2:b})}function f(){var d=s("onet"),v=n("onet/conv4"),m=i("onet/prelu4_alpha"),g=a("onet/fc1"),b=i("onet/prelu5_alpha"),w=a("onet/fc2_1"),_=a("onet/fc2_2"),S=a("onet/fc2_3");return kn(kn({},d),{conv4:v,prelu4_alpha:m,fc1:g,prelu5_alpha:b,fc2_1:w,fc2_2:_,fc2_3:S})}return{extractPNetParams:l,extractRNetParams:c,extractONetParams:f}}function Dz(r){var t=[],e=Tz(r,t),n=e.extractPNetParams,a=e.extractRNetParams,i=e.extractONetParams,s=n(),l=a(),c=i();return ai(r,t),{params:{pnet:s,rnet:l,onet:c},paramMappings:t}}function $g(r,t){var e=t[0],n=t[1];return{height:Math.floor(e*r),width:Math.floor(n*r)}}function kz(r,t,e){for(var n=e[0],a=e[1],i=fd/r,s=[],l=Math.min(n,a)*i,c=0;l>=12;)s.push(i*Math.pow(t,c)),l=l*t,c+=1;return s}var s0=function(r){He(t,r);function t(e,n,a,i){return r.call(this,{left:e,top:n,right:a,bottom:i},!0)||this}return t}(ba);function bR(r){return _e(function(){return Mn(on(r,ye(127.5)),ye(.0078125))})}function lu(r,t){return _e(function(){return et(Mt(r),Mn(t,id(Mt(id(r)))))})}function u0(r,t,e){return e===void 0&&(e=!1),_e(function(){var n=qr(r,t.conv1,"valid");return n=lu(n,t.prelu1_alpha),n=hn(n,e?[2,2]:[3,3],[2,2],"same"),n=qr(n,t.conv2,"valid"),n=lu(n,t.prelu2_alpha),n=e?n:hn(n,[3,3],[2,2],"valid"),n=qr(n,t.conv3,"valid"),n=lu(n,t.prelu3_alpha),n})}function Oz(r,t){return _e(function(){var e=u0(r,t,!0),n=qr(e,t.conv4_1,"valid"),a=Tr(Td(n,3),3),i=ti(on(n,a),3),s=qr(e,t.conv4_2,"valid");return{prob:i,regions:s}})}function Nz(r,t){return _e(function(){var e=$g(t,r.shape.slice(1)),n=e.height,a=e.width,i=Ly.resizeBilinear(r,[n,a]),s=bR(i);return oo(s,[0,2,1,3])})}function Mz(r,t,e,n){for(var a=[],i=r.arraySync(),s=0;s<r.shape[0];s++)for(var l=0;l<r.shape[1];l++)i[s][l]>=n&&a.push(new ht(l,s));var c=a.map(function(f){var d=new Nd(Math.round((f.y*gh+1)/e),Math.round((f.x*gh+1)/e),Math.round((f.y*gh+fd)/e),Math.round((f.x*gh+fd)/e)),v=i[f.y][f.x],m=t.arraySync(),g=new s0(m[f.y][f.x][0],m[f.y][f.x][1],m[f.y][f.x][2],m[f.y][f.x][3]);return{cell:d,score:v,region:g}});return c}function Iz(r,t,e,n,a){a.stage1=[];var i=t.map(function(m){return _e(function(){var g={scale:m},b=Nz(r,m),w=Date.now(),_=Oz(b,n),S=_.prob,E=_.regions;g.pnet=Date.now()-w;var C=rn(rn(S,3)[1])[0],R=rn(E)[0];return{scoresTensor:C,regionsTensor:R,scale:m,statsForScale:g}})}),s=i.map(function(m){var g=m.scoresTensor,b=m.regionsTensor,w=m.scale,_=m.statsForScale,S=Mz(g,b,w,e);if(g.dispose(),b.dispose(),!S.length)return a.stage1.push(_),[];var E=Date.now(),C=gc(S.map(function(R){return R.cell}),S.map(function(R){return R.score}),.5);return _.nms=Date.now()-E,_.numBoxes=C.length,a.stage1.push(_),C.map(function(R){return S[R]})}),l=s.reduce(function(m,g){return m.concat(g)},[]),c=[],f=[];if(l.length>0){var d=Date.now(),v=gc(l.map(function(m){return m.cell}),l.map(function(m){return m.score}),.7);a.stage1_nms=Date.now()-d,f=v.map(function(m){return l[m].score}),c=v.map(function(m){return l[m]}).map(function(m){var g=m.cell,b=m.region;return new Nd(g.left+b.left*g.width,g.top+b.top*g.height,g.right+b.right*g.width,g.bottom+b.bottom*g.height).toSquare().round()})}return{boxes:c,scores:f}}function xR(r,t,e){var n=e.width,a=e.height;return ke(this,void 0,void 0,function(){var i,s,l,c=this;return Oe(this,function(f){switch(f.label){case 0:return i=Za(r),[4,Promise.all(t.map(function(d){return ke(c,void 0,void 0,function(){var v,m,g,b,w,_,S,E;return Oe(this,function(C){return v=d.padAtBorders(r.height,r.width),m=v.y,g=v.ey,b=v.x,w=v.ex,_=b-1,S=m-1,E=i.getImageData(_,S,w-_,g-S),[2,In.isNodejs()?Yy(E):createImageBitmap(E)]})})}))];case 1:return s=f.sent(),l=[],s.forEach(function(d){var v=Md({width:n,height:a}),m=Za(v);m.drawImage(d,0,0,n,a);for(var g=m.getImageData(0,0,n,a).data,b=[],w=0;w<g.length;w+=4)b.push(g[w+2]),b.push(g[w+1]),b.push(g[w]);l.push(b)}),[2,l.map(function(d){var v=_e(function(){var m=oo(Xn(d,[1,n,a,3]),[0,2,1,3]).toFloat();return bR(m)});return v})]}})})}function Fz(r,t){return _e(function(){var e=u0(r,t),n=Wr(e,[e.shape[0],t.fc1.weights.shape[0]]),a=da(n,t.fc1),i=lu(a,t.prelu4_alpha),s=da(i,t.fc2_1),l=Tr(Td(s,1),1),c=ti(on(s,l),1),f=da(i,t.fc2_2),d=rn(c,1)[1];return{scores:d,regions:f}})}function Bz(r,t,e,n,a){return ke(this,void 0,void 0,function(){var i,s,l,c,f,d,v,m,g,b,w,_,S,E;return Oe(this,function(C){switch(C.label){case 0:return i=Date.now(),[4,xR(r,t,{width:24,height:24})];case 1:return s=C.sent(),a.stage2_extractImagePatches=Date.now()-i,i=Date.now(),l=s.map(function(R){var A=Fz(R,n);return R.dispose(),A}),a.stage2_rnet=Date.now()-i,c=l.length>1?nn(l.map(function(R){return R.scores})):l[0].scores,v=(d=Array).from,[4,c.data()];case 2:return f=v.apply(d,[C.sent()]),c.dispose(),m=f.map(function(R,A){return{score:R,idx:A}}).filter(function(R){return R.score>e}).map(function(R){var A=R.idx;return A}),g=m.map(function(R){return t[R]}),b=m.map(function(R){return f[R]}),w=[],_=[],g.length>0&&(i=Date.now(),S=gc(g,b,.7),a.stage2_nms=Date.now()-i,E=S.map(function(R){var A=l[m[R]].regions.arraySync();return new s0(A[0][0],A[0][1],A[0][2],A[0][3])}),_=S.map(function(R){return b[R]}),w=S.map(function(R,A){return g[R].calibrate(E[A])})),l.forEach(function(R){R.regions.dispose(),R.scores.dispose()}),[2,{boxes:w,scores:_}]}})})}function Lz(r,t){return _e(function(){var e=u0(r,t);e=hn(e,[2,2],[2,2],"same"),e=qr(e,t.conv4,"valid"),e=lu(e,t.prelu4_alpha);var n=Wr(e,[e.shape[0],t.fc1.weights.shape[0]]),a=da(n,t.fc1),i=lu(a,t.prelu5_alpha),s=da(i,t.fc2_1),l=Tr(Td(s,1),1),c=ti(on(s,l),1),f=da(i,t.fc2_2),d=da(i,t.fc2_3),v=rn(c,1)[1];return{scores:v,regions:f,points:d}})}function Pz(r,t,e,n,a){return ke(this,void 0,void 0,function(){var i,s,l,c,f,d,v,m,g,b,w,_,S,E,C;return Oe(this,function(R){switch(R.label){case 0:return i=Date.now(),[4,xR(r,t,{width:48,height:48})];case 1:return s=R.sent(),a.stage3_extractImagePatches=Date.now()-i,i=Date.now(),l=s.map(function(A){var D=Lz(A,n);return A.dispose(),D}),a.stage3_onet=Date.now()-i,c=l.length>1?nn(l.map(function(A){return A.scores})):l[0].scores,v=(d=Array).from,[4,c.data()];case 2:return f=v.apply(d,[R.sent()]),c.dispose(),m=f.map(function(A,D){return{score:A,idx:D}}).filter(function(A){return A.score>e}).map(function(A){var D=A.idx;return D}),g=m.map(function(A){var D=l[A].regions.arraySync();return new s0(D[0][0],D[0][1],D[0][2],D[0][3])}),b=m.map(function(A,D){return t[A].calibrate(g[D])}),w=m.map(function(A){return f[A]}),_=[],S=[],E=[],b.length>0&&(i=Date.now(),C=gc(b,w,.7,!1),a.stage3_nms=Date.now()-i,_=C.map(function(A){return b[A]}),S=C.map(function(A){return w[A]}),E=C.map(function(A,D){return Array(5).fill(0).map(function(k,I){var O=l[A].points.arraySync();return new ht(O[0][I]*(_[D].width+1)+_[D].left,O[0][I+5]*(_[D].height+1)+_[D].top)})})),l.forEach(function(A){A.regions.dispose(),A.scores.dispose(),A.points.dispose()}),[2,{boxes:_,scores:S,points:E}]}})})}var zz=function(r){He(t,r);function t(){return r.call(this,"Mtcnn")||this}return t.prototype.load=function(e){return ke(this,void 0,void 0,function(){return Oe(this,function(n){return console.warn("mtcnn is deprecated and will be removed soon"),[2,r.prototype.load.call(this,e)]})})},t.prototype.loadFromDisk=function(e){return ke(this,void 0,void 0,function(){return Oe(this,function(n){return console.warn("mtcnn is deprecated and will be removed soon"),[2,r.prototype.loadFromDisk.call(this,e)]})})},t.prototype.forwardInput=function(e,n){return n===void 0&&(n={}),ke(this,void 0,void 0,function(){var a,i,s,l,c,f,d,v,m,g,b,w,_,S,E,C,R,A,D,k,I;return Oe(this,function(O){switch(O.label){case 0:if(a=this.params,!a)throw new Error("Mtcnn - load model before inference");if(i=e.canvases[0],!i)throw new Error("Mtcnn - inputCanvas is not defined, note that passing tensors into Mtcnn.forwardInput is not supported yet.");return s={},l=Date.now(),c=_e(function(){return Cz(Tr(jy.fromPixels(i)).toFloat())}),f=function(M){return c.dispose(),s.total=Date.now()-l,M},d=c.shape.slice(1),v=d[0],m=d[1],g=new mR(n),b=g.minFaceSize,w=g.scaleFactor,_=g.maxNumScales,S=g.scoreThresholds,E=g.scaleSteps,C=(E||kz(b,w,[v,m])).filter(function(M){var V=$g(M,[v,m]);return Math.min(V.width,V.height)>fd}).slice(0,_),s.scales=C,s.pyramid=C.map(function(M){return $g(M,[v,m])}),R=Date.now(),[4,Iz(c,C,S[0],a.pnet,s)];case 1:return A=O.sent(),s.total_stage1=Date.now()-R,A.boxes.length?(s.stage2_numInputBoxes=A.boxes.length,R=Date.now(),[4,Bz(i,A.boxes,S[1],a.rnet,s)]):[2,f({results:[],stats:s})];case 2:return D=O.sent(),s.total_stage2=Date.now()-R,D.boxes.length?(s.stage3_numInputBoxes=D.boxes.length,R=Date.now(),[4,Pz(i,D.boxes,S[2],a.onet,s)]):[2,f({results:[],stats:s})];case 3:return k=O.sent(),s.total_stage3=Date.now()-R,I=k.boxes.map(function(M,V){return Fd(xc({},new vr(k.scores[V],new qy(M.left/m,M.top/v,M.width/m,M.height/v),{height:v,width:m})),new pP(k.points[V].map(function(z){return z.sub(new ht(M.left,M.top)).div(new ht(M.width,M.height))}),{width:M.width,height:M.height}))}),[2,f({results:I,stats:s})]}})})},t.prototype.forward=function(e,n){return n===void 0&&(n={}),ke(this,void 0,void 0,function(){var a;return Oe(this,function(i){switch(i.label){case 0:return a=this.forwardInput,[4,mn(e)];case 1:return[4,a.apply(this,[i.sent(),n])];case 2:return[2,i.sent().results]}})})},t.prototype.forwardWithStats=function(e,n){return n===void 0&&(n={}),ke(this,void 0,void 0,function(){var a;return Oe(this,function(i){switch(i.label){case 0:return a=this.forwardInput,[4,mn(e)];case 1:return[2,a.apply(this,[i.sent(),n])]}})})},t.prototype.getDefaultModelName=function(){return"mtcnn_model"},t.prototype.extractParamsFromWeigthMap=function(e){return Dz(e)},t.prototype.extractParams=function(e){return Az(e)},t}(ri),Uz=.4,Vz=[new ht(1.603231,2.094468),new ht(6.041143,7.080126),new ht(2.882459,3.518061),new ht(4.266906,5.178857),new ht(9.041765,10.66308)],Hz=[117.001,114.697,97.404],jz=function(r){He(t,r);function t(){var e=this,n={withSeparableConvs:!0,iouThreshold:Uz,classes:["face"],anchors:Vz,meanRgb:Hz,isFirstLayerConv2d:!0,filterSizes:[3,16,32,64,128,256,512]};return e=r.call(this,n)||this,e}return Object.defineProperty(t.prototype,"anchors",{get:function(){return this.config.anchors},enumerable:!0,configurable:!0}),t.prototype.locateFaces=function(e,n){return ke(this,void 0,void 0,function(){var a;return Oe(this,function(i){switch(i.label){case 0:return[4,this.detect(e,n)];case 1:return a=i.sent(),[2,a.map(function(s){return new vr(s.score,s.relativeBox,{width:s.imageWidth,height:s.imageHeight})})]}})})},t.prototype.getDefaultModelName=function(){return"tiny_face_detector_model"},t.prototype.extractParamsFromWeigthMap=function(e){return r.prototype.extractParamsFromWeigthMap.call(this,e)},t}(yR),Or={ssdMobilenetv1:new gR,tinyFaceDetector:new jz,tinyYolov2:new Sz,mtcnn:new zz,faceLandmark68Net:new cR,faceLandmark68TinyNet:new WP,faceRecognitionNet:new QP,faceExpressionNet:new kP,ageGenderNet:new UP},wR=function(r){He(t,r);function t(e,n,a){var i=r.call(this)||this;return i.parentTask=e,i.input=n,i.extractedFaces=a,i}return t}(Lc),l0=function(r){He(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.prototype.run=function(){return ke(this,void 0,void 0,function(){var e,n,a=this;return Oe(this,function(i){switch(i.label){case 0:return[4,this.parentTask];case 1:return e=i.sent(),[4,Ld(e,this.input,function(s){return ke(a,void 0,void 0,function(){return Oe(this,function(l){switch(l.label){case 0:return[4,Promise.all(s.map(function(c){return Or.faceExpressionNet.predictExpressions(c)}))];case 1:return[2,l.sent()]}})})},this.extractedFaces)];case 2:return n=i.sent(),[2,e.map(function(s,l){return oR(s,n[l])})]}})})},t.prototype.withAgeAndGender=function(){return new d0(this,this.input)},t}(wR),c0=function(r){He(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.prototype.run=function(){return ke(this,void 0,void 0,function(){var e,n;return Oe(this,function(a){switch(a.label){case 0:return[4,this.parentTask];case 1:return e=a.sent(),e?[4,o0(e,this.input,function(i){return Or.faceExpressionNet.predictExpressions(i)},this.extractedFaces)]:[2];case 2:return n=a.sent(),[2,oR(e,n)]}})})},t.prototype.withAgeAndGender=function(){return new p0(this,this.input)},t}(wR),f0=function(r){He(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.prototype.withAgeAndGender=function(){return new v0(this,this.input)},t.prototype.withFaceDescriptors=function(){return new g0(this,this.input)},t}(l0),h0=function(r){He(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.prototype.withAgeAndGender=function(){return new m0(this,this.input)},t.prototype.withFaceDescriptor=function(){return new y0(this,this.input)},t}(c0),_R=function(r){He(t,r);function t(e,n,a){var i=r.call(this)||this;return i.parentTask=e,i.input=n,i.extractedFaces=a,i}return t}(Lc),d0=function(r){He(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.prototype.run=function(){return ke(this,void 0,void 0,function(){var e,n,a=this;return Oe(this,function(i){switch(i.label){case 0:return[4,this.parentTask];case 1:return e=i.sent(),[4,Ld(e,this.input,function(s){return ke(a,void 0,void 0,function(){return Oe(this,function(l){switch(l.label){case 0:return[4,Promise.all(s.map(function(c){return Or.ageGenderNet.predictAgeAndGender(c)}))];case 1:return[2,l.sent()]}})})},this.extractedFaces)];case 2:return n=i.sent(),[2,e.map(function(s,l){var c=n[l],f=c.age,d=c.gender,v=c.genderProbability;return pR(vR(s,d,v),f)})]}})})},t.prototype.withFaceExpressions=function(){return new l0(this,this.input)},t}(_R),p0=function(r){He(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.prototype.run=function(){return ke(this,void 0,void 0,function(){var e,n,a,i,s;return Oe(this,function(l){switch(l.label){case 0:return[4,this.parentTask];case 1:return e=l.sent(),e?[4,o0(e,this.input,function(c){return Or.ageGenderNet.predictAgeAndGender(c)},this.extractedFaces)]:[2];case 2:return n=l.sent(),a=n.age,i=n.gender,s=n.genderProbability,[2,pR(vR(e,i,s),a)]}})})},t.prototype.withFaceExpressions=function(){return new c0(this,this.input)},t}(_R),v0=function(r){He(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.prototype.withFaceExpressions=function(){return new f0(this,this.input)},t.prototype.withFaceDescriptors=function(){return new g0(this,this.input)},t}(d0),m0=function(r){He(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.prototype.withFaceExpressions=function(){return new h0(this,this.input)},t.prototype.withFaceDescriptor=function(){return new y0(this,this.input)},t}(p0),SR=function(r){He(t,r);function t(e,n){var a=r.call(this)||this;return a.parentTask=e,a.input=n,a}return t}(Lc),g0=function(r){He(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.prototype.run=function(){return ke(this,void 0,void 0,function(){var e,n;return Oe(this,function(a){switch(a.label){case 0:return[4,this.parentTask];case 1:return e=a.sent(),[4,Ld(e,this.input,function(i){return Promise.all(i.map(function(s){return Or.faceRecognitionNet.computeFaceDescriptor(s)}))},null,function(i){return i.landmarks.align(null,{useDlibAlignment:!0})})];case 2:return n=a.sent(),[2,n.map(function(i,s){return dR(e[s],i)})]}})})},t.prototype.withFaceExpressions=function(){return new f0(this,this.input)},t.prototype.withAgeAndGender=function(){return new v0(this,this.input)},t}(SR),y0=function(r){He(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.prototype.run=function(){return ke(this,void 0,void 0,function(){var e,n;return Oe(this,function(a){switch(a.label){case 0:return[4,this.parentTask];case 1:return e=a.sent(),e?[4,o0(e,this.input,function(i){return Or.faceRecognitionNet.computeFaceDescriptor(i)},null,function(i){return i.landmarks.align(null,{useDlibAlignment:!0})})]:[2];case 2:return n=a.sent(),[2,dR(e,n)]}})})},t.prototype.withFaceExpressions=function(){return new h0(this,this.input)},t.prototype.withAgeAndGender=function(){return new m0(this,this.input)},t}(SR),ER=function(r){He(t,r);function t(e,n,a){var i=r.call(this)||this;return i.parentTask=e,i.input=n,i.useTinyLandmarkNet=a,i}return Object.defineProperty(t.prototype,"landmarkNet",{get:function(){return this.useTinyLandmarkNet?Or.faceLandmark68TinyNet:Or.faceLandmark68Net},enumerable:!0,configurable:!0}),t}(Lc),Wz=function(r){He(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.prototype.run=function(){return ke(this,void 0,void 0,function(){var e,n,a,i,s,l=this;return Oe(this,function(c){switch(c.label){case 0:return[4,this.parentTask];case 1:return e=c.sent(),n=e.map(function(f){return f.detection}),this.input instanceof Nt?[4,Zy(this.input,n)]:[3,3];case 2:return i=c.sent(),[3,5];case 3:return[4,Qy(this.input,n)];case 4:i=c.sent(),c.label=5;case 5:return a=i,[4,Promise.all(a.map(function(f){return l.landmarkNet.detectLandmarks(f)}))];case 6:return s=c.sent(),a.forEach(function(f){return f instanceof Nt&&f.dispose()}),[2,e.map(function(f,d){return Fd(f,s[d])})]}})})},t.prototype.withFaceExpressions=function(){return new f0(this,this.input)},t.prototype.withAgeAndGender=function(){return new v0(this,this.input)},t.prototype.withFaceDescriptors=function(){return new g0(this,this.input)},t}(ER),Gz=function(r){He(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.prototype.run=function(){return ke(this,void 0,void 0,function(){var e,n,a,i,s;return Oe(this,function(l){switch(l.label){case 0:return[4,this.parentTask];case 1:return e=l.sent(),e?(n=e.detection,this.input instanceof Nt?[4,Zy(this.input,[n])]:[3,3]):[2];case 2:return i=l.sent(),[3,5];case 3:return[4,Qy(this.input,[n])];case 4:i=l.sent(),l.label=5;case 5:return a=i,[4,this.landmarkNet.detectLandmarks(a[0])];case 6:return s=l.sent(),a.forEach(function(c){return c instanceof Nt&&c.dispose()}),[2,Fd(e,s)]}})})},t.prototype.withFaceExpressions=function(){return new h0(this,this.input)},t.prototype.withAgeAndGender=function(){return new m0(this,this.input)},t.prototype.withFaceDescriptor=function(){return new y0(this,this.input)},t}(ER),CR=function(r){He(t,r);function t(e,n){n===void 0&&(n=new Bd);var a=r.call(this)||this;return a.input=e,a.options=n,a}return t}(Lc),RR=function(r){He(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.prototype.run=function(){return ke(this,void 0,void 0,function(){var e,n,a,i;return Oe(this,function(s){switch(s.label){case 0:return e=this,n=e.input,a=e.options,a instanceof mR?[4,Or.mtcnn.forward(n,a)]:[3,2];case 1:return[2,s.sent().map(function(l){return l.detection})];case 2:if(i=a instanceof Ez?function(l){return Or.tinyFaceDetector.locateFaces(l,a)}:a instanceof Bd?function(l){return Or.ssdMobilenetv1.locateFaces(l,a)}:a instanceof i0?function(l){return Or.tinyYolov2.locateFaces(l,a)}:null,!i)throw new Error("detectFaces - expected options to be instance of TinyFaceDetectorOptions | SsdMobilenetv1Options | MtcnnOptions | TinyYolov2Options");return[2,i(n)]}})})},t.prototype.runAndExtendWithFaceDetections=function(){var e=this;return new Promise(function(n){return ke(e,void 0,void 0,function(){var a;return Oe(this,function(i){switch(i.label){case 0:return[4,this.run()];case 1:return a=i.sent(),[2,n(a.map(function(s){return xc({},s)}))]}})})})},t.prototype.withFaceLandmarks=function(e){return e===void 0&&(e=!1),new Wz(this.runAndExtendWithFaceDetections(),this.input,e)},t.prototype.withFaceExpressions=function(){return new l0(this.runAndExtendWithFaceDetections(),this.input)},t.prototype.withAgeAndGender=function(){return new d0(this.runAndExtendWithFaceDetections(),this.input)},t}(CR);(function(r){He(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.prototype.run=function(){return ke(this,void 0,void 0,function(){var e,n;return Oe(this,function(a){switch(a.label){case 0:return[4,new RR(this.input,this.options)];case 1:return e=a.sent(),n=e[0],e.forEach(function(i){i.score>n.score&&(n=i)}),[2,n]}})})},t.prototype.runAndExtendWithFaceDetection=function(){var e=this;return new Promise(function(n){return ke(e,void 0,void 0,function(){var a;return Oe(this,function(i){switch(i.label){case 0:return[4,this.run()];case 1:return a=i.sent(),[2,n(a?xc({},a):void 0)]}})})})},t.prototype.withFaceLandmarks=function(e){return e===void 0&&(e=!1),new Gz(this.runAndExtendWithFaceDetection(),this.input,e)},t.prototype.withFaceExpressions=function(){return new c0(this.runAndExtendWithFaceDetection(),this.input)},t.prototype.withAgeAndGender=function(){return new p0(this.runAndExtendWithFaceDetection(),this.input)},t})(CR);function SU(r,t){return t===void 0&&(t=new Bd),new RR(r,t)}function qz(r,t){if(r.length!==t.length)throw new Error("euclideanDistance: arr1.length !== arr2.length");var e=Array.from(r),n=Array.from(t);return Math.sqrt(e.map(function(a,i){return a-n[i]}).reduce(function(a,i){return a+Math.pow(i,2)},0))}(function(){function r(t,e){e===void 0&&(e=.6),this._distanceThreshold=e;var n=Array.isArray(t)?t:[t];if(!n.length)throw new Error("FaceRecognizer.constructor - expected atleast one input");var a=1,i=function(){return"person "+a++};this._labeledDescriptors=n.map(function(s){if(s instanceof dh)return s;if(s instanceof Float32Array)return new dh(i(),[s]);if(s.descriptor&&s.descriptor instanceof Float32Array)return new dh(i(),[s.descriptor]);throw new Error("FaceRecognizer.constructor - expected inputs to be of type LabeledFaceDescriptors | WithFaceDescriptor<any> | Float32Array | Array<LabeledFaceDescriptors | WithFaceDescriptor<any> | Float32Array>")})}return Object.defineProperty(r.prototype,"labeledDescriptors",{get:function(){return this._labeledDescriptors},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"distanceThreshold",{get:function(){return this._distanceThreshold},enumerable:!0,configurable:!0}),r.prototype.computeMeanDistance=function(t,e){return e.map(function(n){return qz(n,t)}).reduce(function(n,a){return n+a},0)/(e.length||1)},r.prototype.matchDescriptor=function(t){var e=this;return this.labeledDescriptors.map(function(n){var a=n.descriptors,i=n.label;return new k_(i,e.computeMeanDistance(t,a))}).reduce(function(n,a){return n.distance<a.distance?n:a})},r.prototype.findBestMatch=function(t){var e=this.matchDescriptor(t);return e.distance<this.distanceThreshold?e:new k_("unknown",e.distance)},r.prototype.toJSON=function(){return{distanceThreshold:this.distanceThreshold,labeledDescriptors:this.labeledDescriptors.map(function(t){return t.toJSON()})}},r.fromJSON=function(t){var e=t.labeledDescriptors.map(function(n){return dh.fromJSON(n)});return new r(e,t.distanceThreshold)},r})();function Kz(r,t){var e=new qo(t.width,t.height),n=e.width,a=e.height;if(n<=0||a<=0)throw new Error("resizeResults - invalid dimensions: "+JSON.stringify({width:n,height:a}));if(Array.isArray(r))return r.map(function(l){return Kz(l,{width:n,height:a})});if(sR(r)){var i=r.detection.forSize(n,a),s=r.unshiftedLandmarks.forSize(i.box.width,i.box.height);return Fd(xc(r,i),s)}return bc(r)?xc(r,r.detection.forSize(n,a)):r instanceof yc||r instanceof vr?r.forSize(n,a):r}var Xl={},F_;function Xz(){if(F_)return Xl;F_=1,Object.defineProperty(Xl,"__esModule",{value:!0}),Xl.styleq=void 0;var r=new WeakMap,t="$$css";function e(a){var i,s,l;return a!=null&&(i=a.disableCache===!0,s=a.disableMix===!0,l=a.transform),function(){for(var f=[],d="",v=null,m="",g=i?null:r,b=new Array(arguments.length),w=0;w<arguments.length;w++)b[w]=arguments[w];for(;b.length>0;){var _=b.pop();if(!(_==null||_===!1)){if(Array.isArray(_)){for(var S=0;S<_.length;S++)b.push(_[S]);continue}var E=l!=null?l(_):_;if(E.$$css!=null){var C="";if(g!=null&&g.has(E)){var R=g.get(E);R!=null&&(C=R[0],m=R[2],f.push.apply(f,R[1]),g=R[3])}else{var A=[];for(var D in E){var k=E[D];if(D===t){var I=E[D];I!==!0&&(m=m?I+"; "+m:I);continue}typeof k=="string"||k===null?f.includes(D)||(f.push(D),g!=null&&A.push(D),typeof k=="string"&&(C+=C?" "+k:k)):console.error("styleq: ".concat(D," typeof ").concat(String(k),' is not "string" or "null".'))}if(g!=null){var O=new WeakMap;g.set(E,[C,A,m,O]),g=O}}C&&(d=d?C+" "+d:C)}else if(s)v==null&&(v={}),v=Object.assign({},E,v);else{var M=null;for(var V in E){var z=E[V];z!==void 0&&(f.includes(V)||(z!=null&&(v==null&&(v={}),M==null&&(M={}),M[V]=z),f.push(V),g=null))}M!=null&&(v=Object.assign(M,v))}}}var J=[d,v,m];return J}}var n=Xl.styleq=e();return n.factory=e,Xl}var $z=Xz();function EU(){for(var r=arguments.length,t=new Array(r),e=0;e<r;e++)t[e]=arguments[e];const[n,a,i]=$z.styleq(t),s={};return n!=null&&n!==""&&(s.className=n),a!=null&&Object.keys(a).length>0&&(s.style=a),i!=null&&i!==""&&(s["data-style-src"]=i),s}export{Yn as A,EU as B,aU as C,cU as D,rU as E,Uk as F,oU as G,dU as H,mU as I,Zz as J,uU as Q,rE as R,Ez as T,vU as a,pU as b,gU as c,$D as d,JN as e,tU as f,iU as g,hU as h,zn as i,HT as j,fU as k,ry as l,nU as m,Jz as n,eU as o,yU as p,sU as q,Q as r,bU as s,Or as t,AS as u,wU as v,SU as w,Kz as x,xU as y,_U as z};
