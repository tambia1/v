import{g as c2}from"./index-CKjlejWX.js";var Mp={exports:{}},Au={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var L1;function dA(){if(L1)return Au;L1=1;var n=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function e(r,a,i){var u=null;if(i!==void 0&&(u=""+i),a.key!==void 0&&(u=""+a.key),"key"in a){i={};for(var l in a)l!=="key"&&(i[l]=a[l])}else i=a;return a=i.ref,{$$typeof:n,type:r,key:u,ref:a!==void 0?a:null,props:i}}return Au.Fragment=t,Au.jsx=e,Au.jsxs=e,Au}var z1;function pA(){return z1||(z1=1,Mp.exports=dA()),Mp.exports}var vA=pA(),Ip={exports:{}},Tu={},Fp={exports:{}},Bp={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var U1;function mA(){return U1||(U1=1,function(n){function t(L,W){var $=L.length;L.push(W);e:for(;0<$;){var ne=$-1>>>1,M=L[ne];if(0<a(M,W))L[ne]=W,L[$]=M,$=ne;else break e}}function e(L){return L.length===0?null:L[0]}function r(L){if(L.length===0)return null;var W=L[0],$=L.pop();if($!==W){L[0]=$;e:for(var ne=0,M=L.length,j=M>>>1;ne<j;){var ie=2*(ne+1)-1,oe=L[ie],de=ie+1,me=L[de];if(0>a(oe,$))de<M&&0>a(me,oe)?(L[ne]=me,L[de]=$,ne=de):(L[ne]=oe,L[ie]=$,ne=ie);else if(de<M&&0>a(me,$))L[ne]=me,L[de]=$,ne=de;else break e}}return W}function a(L,W){var $=L.sortIndex-W.sortIndex;return $!==0?$:L.id-W.id}if(n.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var i=performance;n.unstable_now=function(){return i.now()}}else{var u=Date,l=u.now();n.unstable_now=function(){return u.now()-l}}var c=[],f=[],d=1,v=null,m=3,g=!1,b=!1,w=!1,S=!1,E=typeof setTimeout=="function"?setTimeout:null,_=typeof clearTimeout=="function"?clearTimeout:null,R=typeof setImmediate<"u"?setImmediate:null;function C(L){for(var W=e(f);W!==null;){if(W.callback===null)r(f);else if(W.startTime<=L)r(f),W.sortIndex=W.expirationTime,t(c,W);else break;W=e(f)}}function A(L){if(w=!1,C(L),!b)if(e(c)!==null)b=!0,D||(D=!0,U());else{var W=e(f);W!==null&&te(A,W.startTime-L)}}var D=!1,O=-1,F=5,N=-1;function B(){return S?!0:!(n.unstable_now()-N<F)}function H(){if(S=!1,D){var L=n.unstable_now();N=L;var W=!0;try{e:{b=!1,w&&(w=!1,_(O),O=-1),g=!0;var $=m;try{t:{for(C(L),v=e(c);v!==null&&!(v.expirationTime>L&&B());){var ne=v.callback;if(typeof ne=="function"){v.callback=null,m=v.priorityLevel;var M=ne(v.expirationTime<=L);if(L=n.unstable_now(),typeof M=="function"){v.callback=M,C(L),W=!0;break t}v===e(c)&&r(c),C(L)}else r(c);v=e(c)}if(v!==null)W=!0;else{var j=e(f);j!==null&&te(A,j.startTime-L),W=!1}}break e}finally{v=null,m=$,g=!1}W=void 0}}finally{W?U():D=!1}}}var U;if(typeof R=="function")U=function(){R(H)};else if(typeof MessageChannel<"u"){var J=new MessageChannel,ee=J.port2;J.port1.onmessage=H,U=function(){ee.postMessage(null)}}else U=function(){E(H,0)};function te(L,W){O=E(function(){L(n.unstable_now())},W)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(L){L.callback=null},n.unstable_forceFrameRate=function(L){0>L||125<L?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):F=0<L?Math.floor(1e3/L):5},n.unstable_getCurrentPriorityLevel=function(){return m},n.unstable_next=function(L){switch(m){case 1:case 2:case 3:var W=3;break;default:W=m}var $=m;m=W;try{return L()}finally{m=$}},n.unstable_requestPaint=function(){S=!0},n.unstable_runWithPriority=function(L,W){switch(L){case 1:case 2:case 3:case 4:case 5:break;default:L=3}var $=m;m=L;try{return W()}finally{m=$}},n.unstable_scheduleCallback=function(L,W,$){var ne=n.unstable_now();switch(typeof $=="object"&&$!==null?($=$.delay,$=typeof $=="number"&&0<$?ne+$:ne):$=ne,L){case 1:var M=-1;break;case 2:M=250;break;case 5:M=1073741823;break;case 4:M=1e4;break;default:M=5e3}return M=$+M,L={id:d++,callback:W,priorityLevel:L,startTime:$,expirationTime:M,sortIndex:-1},$>ne?(L.sortIndex=$,t(f,L),e(c)===null&&L===e(f)&&(w?(_(O),O=-1):w=!0,te(A,$-ne))):(L.sortIndex=M,t(c,L),b||g||(b=!0,D||(D=!0,U()))),L},n.unstable_shouldYield=B,n.unstable_wrapCallback=function(L){var W=m;return function(){var $=m;m=W;try{return L.apply(this,arguments)}finally{m=$}}}}(Bp)),Bp}var H1;function gA(){return H1||(H1=1,Fp.exports=mA()),Fp.exports}var Pp={exports:{}},ze={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var V1;function yA(){if(V1)return ze;V1=1;var n=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),e=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),i=Symbol.for("react.consumer"),u=Symbol.for("react.context"),l=Symbol.for("react.forward_ref"),c=Symbol.for("react.suspense"),f=Symbol.for("react.memo"),d=Symbol.for("react.lazy"),v=Symbol.iterator;function m(M){return M===null||typeof M!="object"?null:(M=v&&M[v]||M["@@iterator"],typeof M=="function"?M:null)}var g={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},b=Object.assign,w={};function S(M,j,ie){this.props=M,this.context=j,this.refs=w,this.updater=ie||g}S.prototype.isReactComponent={},S.prototype.setState=function(M,j){if(typeof M!="object"&&typeof M!="function"&&M!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,M,j,"setState")},S.prototype.forceUpdate=function(M){this.updater.enqueueForceUpdate(this,M,"forceUpdate")};function E(){}E.prototype=S.prototype;function _(M,j,ie){this.props=M,this.context=j,this.refs=w,this.updater=ie||g}var R=_.prototype=new E;R.constructor=_,b(R,S.prototype),R.isPureReactComponent=!0;var C=Array.isArray,A={H:null,A:null,T:null,S:null,V:null},D=Object.prototype.hasOwnProperty;function O(M,j,ie,oe,de,me){return ie=me.ref,{$$typeof:n,type:M,key:j,ref:ie!==void 0?ie:null,props:me}}function F(M,j){return O(M.type,j,void 0,void 0,void 0,M.props)}function N(M){return typeof M=="object"&&M!==null&&M.$$typeof===n}function B(M){var j={"=":"=0",":":"=2"};return"$"+M.replace(/[=:]/g,function(ie){return j[ie]})}var H=/\/+/g;function U(M,j){return typeof M=="object"&&M!==null&&M.key!=null?B(""+M.key):j.toString(36)}function J(){}function ee(M){switch(M.status){case"fulfilled":return M.value;case"rejected":throw M.reason;default:switch(typeof M.status=="string"?M.then(J,J):(M.status="pending",M.then(function(j){M.status==="pending"&&(M.status="fulfilled",M.value=j)},function(j){M.status==="pending"&&(M.status="rejected",M.reason=j)})),M.status){case"fulfilled":return M.value;case"rejected":throw M.reason}}throw M}function te(M,j,ie,oe,de){var me=typeof M;(me==="undefined"||me==="boolean")&&(M=null);var ve=!1;if(M===null)ve=!0;else switch(me){case"bigint":case"string":case"number":ve=!0;break;case"object":switch(M.$$typeof){case n:case t:ve=!0;break;case d:return ve=M._init,te(ve(M._payload),j,ie,oe,de)}}if(ve)return de=de(M),ve=oe===""?"."+U(M,0):oe,C(de)?(ie="",ve!=null&&(ie=ve.replace(H,"$&/")+"/"),te(de,j,ie,"",function(De){return De})):de!=null&&(N(de)&&(de=F(de,ie+(de.key==null||M&&M.key===de.key?"":(""+de.key).replace(H,"$&/")+"/")+ve)),j.push(de)),1;ve=0;var Ae=oe===""?".":oe+":";if(C(M))for(var ye=0;ye<M.length;ye++)oe=M[ye],me=Ae+U(oe,ye),ve+=te(oe,j,ie,me,de);else if(ye=m(M),typeof ye=="function")for(M=ye.call(M),ye=0;!(oe=M.next()).done;)oe=oe.value,me=Ae+U(oe,ye++),ve+=te(oe,j,ie,me,de);else if(me==="object"){if(typeof M.then=="function")return te(ee(M),j,ie,oe,de);throw j=String(M),Error("Objects are not valid as a React child (found: "+(j==="[object Object]"?"object with keys {"+Object.keys(M).join(", ")+"}":j)+"). If you meant to render a collection of children, use an array instead.")}return ve}function L(M,j,ie){if(M==null)return M;var oe=[],de=0;return te(M,oe,"","",function(me){return j.call(ie,me,de++)}),oe}function W(M){if(M._status===-1){var j=M._result;j=j(),j.then(function(ie){(M._status===0||M._status===-1)&&(M._status=1,M._result=ie)},function(ie){(M._status===0||M._status===-1)&&(M._status=2,M._result=ie)}),M._status===-1&&(M._status=0,M._result=j)}if(M._status===1)return M._result.default;throw M._result}var $=typeof reportError=="function"?reportError:function(M){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var j=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof M=="object"&&M!==null&&typeof M.message=="string"?String(M.message):String(M),error:M});if(!window.dispatchEvent(j))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",M);return}console.error(M)};function ne(){}return ze.Children={map:L,forEach:function(M,j,ie){L(M,function(){j.apply(this,arguments)},ie)},count:function(M){var j=0;return L(M,function(){j++}),j},toArray:function(M){return L(M,function(j){return j})||[]},only:function(M){if(!N(M))throw Error("React.Children.only expected to receive a single React element child.");return M}},ze.Component=S,ze.Fragment=e,ze.Profiler=a,ze.PureComponent=_,ze.StrictMode=r,ze.Suspense=c,ze.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=A,ze.__COMPILER_RUNTIME={__proto__:null,c:function(M){return A.H.useMemoCache(M)}},ze.cache=function(M){return function(){return M.apply(null,arguments)}},ze.cloneElement=function(M,j,ie){if(M==null)throw Error("The argument must be a React element, but you passed "+M+".");var oe=b({},M.props),de=M.key,me=void 0;if(j!=null)for(ve in j.ref!==void 0&&(me=void 0),j.key!==void 0&&(de=""+j.key),j)!D.call(j,ve)||ve==="key"||ve==="__self"||ve==="__source"||ve==="ref"&&j.ref===void 0||(oe[ve]=j[ve]);var ve=arguments.length-2;if(ve===1)oe.children=ie;else if(1<ve){for(var Ae=Array(ve),ye=0;ye<ve;ye++)Ae[ye]=arguments[ye+2];oe.children=Ae}return O(M.type,de,void 0,void 0,me,oe)},ze.createContext=function(M){return M={$$typeof:u,_currentValue:M,_currentValue2:M,_threadCount:0,Provider:null,Consumer:null},M.Provider=M,M.Consumer={$$typeof:i,_context:M},M},ze.createElement=function(M,j,ie){var oe,de={},me=null;if(j!=null)for(oe in j.key!==void 0&&(me=""+j.key),j)D.call(j,oe)&&oe!=="key"&&oe!=="__self"&&oe!=="__source"&&(de[oe]=j[oe]);var ve=arguments.length-2;if(ve===1)de.children=ie;else if(1<ve){for(var Ae=Array(ve),ye=0;ye<ve;ye++)Ae[ye]=arguments[ye+2];de.children=Ae}if(M&&M.defaultProps)for(oe in ve=M.defaultProps,ve)de[oe]===void 0&&(de[oe]=ve[oe]);return O(M,me,void 0,void 0,null,de)},ze.createRef=function(){return{current:null}},ze.forwardRef=function(M){return{$$typeof:l,render:M}},ze.isValidElement=N,ze.lazy=function(M){return{$$typeof:d,_payload:{_status:-1,_result:M},_init:W}},ze.memo=function(M,j){return{$$typeof:f,type:M,compare:j===void 0?null:j}},ze.startTransition=function(M){var j=A.T,ie={};A.T=ie;try{var oe=M(),de=A.S;de!==null&&de(ie,oe),typeof oe=="object"&&oe!==null&&typeof oe.then=="function"&&oe.then(ne,$)}catch(me){$(me)}finally{A.T=j}},ze.unstable_useCacheRefresh=function(){return A.H.useCacheRefresh()},ze.use=function(M){return A.H.use(M)},ze.useActionState=function(M,j,ie){return A.H.useActionState(M,j,ie)},ze.useCallback=function(M,j){return A.H.useCallback(M,j)},ze.useContext=function(M){return A.H.useContext(M)},ze.useDebugValue=function(){},ze.useDeferredValue=function(M,j){return A.H.useDeferredValue(M,j)},ze.useEffect=function(M,j,ie){var oe=A.H;if(typeof ie=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return oe.useEffect(M,j)},ze.useId=function(){return A.H.useId()},ze.useImperativeHandle=function(M,j,ie){return A.H.useImperativeHandle(M,j,ie)},ze.useInsertionEffect=function(M,j){return A.H.useInsertionEffect(M,j)},ze.useLayoutEffect=function(M,j){return A.H.useLayoutEffect(M,j)},ze.useMemo=function(M,j){return A.H.useMemo(M,j)},ze.useOptimistic=function(M,j){return A.H.useOptimistic(M,j)},ze.useReducer=function(M,j,ie){return A.H.useReducer(M,j,ie)},ze.useRef=function(M){return A.H.useRef(M)},ze.useState=function(M){return A.H.useState(M)},ze.useSyncExternalStore=function(M,j,ie){return A.H.useSyncExternalStore(M,j,ie)},ze.useTransition=function(){return A.H.useTransition()},ze.version="19.1.1",ze}var W1;function xm(){return W1||(W1=1,Pp.exports=yA()),Pp.exports}var Lp={exports:{}},vn={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var G1;function bA(){if(G1)return vn;G1=1;var n=xm();function t(c){var f="https://react.dev/errors/"+c;if(1<arguments.length){f+="?args[]="+encodeURIComponent(arguments[1]);for(var d=2;d<arguments.length;d++)f+="&args[]="+encodeURIComponent(arguments[d])}return"Minified React error #"+c+"; visit "+f+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function e(){}var r={d:{f:e,r:function(){throw Error(t(522))},D:e,C:e,L:e,m:e,X:e,S:e,M:e},p:0,findDOMNode:null},a=Symbol.for("react.portal");function i(c,f,d){var v=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:a,key:v==null?null:""+v,children:c,containerInfo:f,implementation:d}}var u=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function l(c,f){if(c==="font")return"";if(typeof f=="string")return f==="use-credentials"?f:""}return vn.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=r,vn.createPortal=function(c,f){var d=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!f||f.nodeType!==1&&f.nodeType!==9&&f.nodeType!==11)throw Error(t(299));return i(c,f,null,d)},vn.flushSync=function(c){var f=u.T,d=r.p;try{if(u.T=null,r.p=2,c)return c()}finally{u.T=f,r.p=d,r.d.f()}},vn.preconnect=function(c,f){typeof c=="string"&&(f?(f=f.crossOrigin,f=typeof f=="string"?f==="use-credentials"?f:"":void 0):f=null,r.d.C(c,f))},vn.prefetchDNS=function(c){typeof c=="string"&&r.d.D(c)},vn.preinit=function(c,f){if(typeof c=="string"&&f&&typeof f.as=="string"){var d=f.as,v=l(d,f.crossOrigin),m=typeof f.integrity=="string"?f.integrity:void 0,g=typeof f.fetchPriority=="string"?f.fetchPriority:void 0;d==="style"?r.d.S(c,typeof f.precedence=="string"?f.precedence:void 0,{crossOrigin:v,integrity:m,fetchPriority:g}):d==="script"&&r.d.X(c,{crossOrigin:v,integrity:m,fetchPriority:g,nonce:typeof f.nonce=="string"?f.nonce:void 0})}},vn.preinitModule=function(c,f){if(typeof c=="string")if(typeof f=="object"&&f!==null){if(f.as==null||f.as==="script"){var d=l(f.as,f.crossOrigin);r.d.M(c,{crossOrigin:d,integrity:typeof f.integrity=="string"?f.integrity:void 0,nonce:typeof f.nonce=="string"?f.nonce:void 0})}}else f==null&&r.d.M(c)},vn.preload=function(c,f){if(typeof c=="string"&&typeof f=="object"&&f!==null&&typeof f.as=="string"){var d=f.as,v=l(d,f.crossOrigin);r.d.L(c,d,{crossOrigin:v,integrity:typeof f.integrity=="string"?f.integrity:void 0,nonce:typeof f.nonce=="string"?f.nonce:void 0,type:typeof f.type=="string"?f.type:void 0,fetchPriority:typeof f.fetchPriority=="string"?f.fetchPriority:void 0,referrerPolicy:typeof f.referrerPolicy=="string"?f.referrerPolicy:void 0,imageSrcSet:typeof f.imageSrcSet=="string"?f.imageSrcSet:void 0,imageSizes:typeof f.imageSizes=="string"?f.imageSizes:void 0,media:typeof f.media=="string"?f.media:void 0})}},vn.preloadModule=function(c,f){if(typeof c=="string")if(f){var d=l(f.as,f.crossOrigin);r.d.m(c,{as:typeof f.as=="string"&&f.as!=="script"?f.as:void 0,crossOrigin:d,integrity:typeof f.integrity=="string"?f.integrity:void 0})}else r.d.m(c)},vn.requestFormReset=function(c){r.d.r(c)},vn.unstable_batchedUpdates=function(c,f){return c(f)},vn.useFormState=function(c,f,d){return u.H.useFormState(c,f,d)},vn.useFormStatus=function(){return u.H.useHostTransitionStatus()},vn.version="19.1.1",vn}var j1;function xA(){if(j1)return Lp.exports;j1=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(t){console.error(t)}}return n(),Lp.exports=bA(),Lp.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var q1;function wA(){if(q1)return Tu;q1=1;var n=gA(),t=xm(),e=xA();function r(o){var s="https://react.dev/errors/"+o;if(1<arguments.length){s+="?args[]="+encodeURIComponent(arguments[1]);for(var h=2;h<arguments.length;h++)s+="&args[]="+encodeURIComponent(arguments[h])}return"Minified React error #"+o+"; visit "+s+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(o){return!(!o||o.nodeType!==1&&o.nodeType!==9&&o.nodeType!==11)}function i(o){var s=o,h=o;if(o.alternate)for(;s.return;)s=s.return;else{o=s;do s=o,(s.flags&4098)!==0&&(h=s.return),o=s.return;while(o)}return s.tag===3?h:null}function u(o){if(o.tag===13){var s=o.memoizedState;if(s===null&&(o=o.alternate,o!==null&&(s=o.memoizedState)),s!==null)return s.dehydrated}return null}function l(o){if(i(o)!==o)throw Error(r(188))}function c(o){var s=o.alternate;if(!s){if(s=i(o),s===null)throw Error(r(188));return s!==o?null:o}for(var h=o,p=s;;){var y=h.return;if(y===null)break;var x=y.alternate;if(x===null){if(p=y.return,p!==null){h=p;continue}break}if(y.child===x.child){for(x=y.child;x;){if(x===h)return l(y),o;if(x===p)return l(y),s;x=x.sibling}throw Error(r(188))}if(h.return!==p.return)h=y,p=x;else{for(var T=!1,k=y.child;k;){if(k===h){T=!0,h=y,p=x;break}if(k===p){T=!0,p=y,h=x;break}k=k.sibling}if(!T){for(k=x.child;k;){if(k===h){T=!0,h=x,p=y;break}if(k===p){T=!0,p=x,h=y;break}k=k.sibling}if(!T)throw Error(r(189))}}if(h.alternate!==p)throw Error(r(190))}if(h.tag!==3)throw Error(r(188));return h.stateNode.current===h?o:s}function f(o){var s=o.tag;if(s===5||s===26||s===27||s===6)return o;for(o=o.child;o!==null;){if(s=f(o),s!==null)return s;o=o.sibling}return null}var d=Object.assign,v=Symbol.for("react.element"),m=Symbol.for("react.transitional.element"),g=Symbol.for("react.portal"),b=Symbol.for("react.fragment"),w=Symbol.for("react.strict_mode"),S=Symbol.for("react.profiler"),E=Symbol.for("react.provider"),_=Symbol.for("react.consumer"),R=Symbol.for("react.context"),C=Symbol.for("react.forward_ref"),A=Symbol.for("react.suspense"),D=Symbol.for("react.suspense_list"),O=Symbol.for("react.memo"),F=Symbol.for("react.lazy"),N=Symbol.for("react.activity"),B=Symbol.for("react.memo_cache_sentinel"),H=Symbol.iterator;function U(o){return o===null||typeof o!="object"?null:(o=H&&o[H]||o["@@iterator"],typeof o=="function"?o:null)}var J=Symbol.for("react.client.reference");function ee(o){if(o==null)return null;if(typeof o=="function")return o.$$typeof===J?null:o.displayName||o.name||null;if(typeof o=="string")return o;switch(o){case b:return"Fragment";case S:return"Profiler";case w:return"StrictMode";case A:return"Suspense";case D:return"SuspenseList";case N:return"Activity"}if(typeof o=="object")switch(o.$$typeof){case g:return"Portal";case R:return(o.displayName||"Context")+".Provider";case _:return(o._context.displayName||"Context")+".Consumer";case C:var s=o.render;return o=o.displayName,o||(o=s.displayName||s.name||"",o=o!==""?"ForwardRef("+o+")":"ForwardRef"),o;case O:return s=o.displayName||null,s!==null?s:ee(o.type)||"Memo";case F:s=o._payload,o=o._init;try{return ee(o(s))}catch{}}return null}var te=Array.isArray,L=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,W=e.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,$={pending:!1,data:null,method:null,action:null},ne=[],M=-1;function j(o){return{current:o}}function ie(o){0>M||(o.current=ne[M],ne[M]=null,M--)}function oe(o,s){M++,ne[M]=o.current,o.current=s}var de=j(null),me=j(null),ve=j(null),Ae=j(null);function ye(o,s){switch(oe(ve,s),oe(me,o),oe(de,null),s.nodeType){case 9:case 11:o=(o=s.documentElement)&&(o=o.namespaceURI)?h1(o):0;break;default:if(o=s.tagName,s=s.namespaceURI)s=h1(s),o=d1(s,o);else switch(o){case"svg":o=1;break;case"math":o=2;break;default:o=0}}ie(de),oe(de,o)}function De(){ie(de),ie(me),ie(ve)}function Qe(o){o.memoizedState!==null&&oe(Ae,o);var s=de.current,h=d1(s,o.type);s!==h&&(oe(me,o),oe(de,h))}function Ne(o){me.current===o&&(ie(de),ie(me)),Ae.current===o&&(ie(Ae),Su._currentValue=$)}var Le=Object.prototype.hasOwnProperty,We=n.unstable_scheduleCallback,tt=n.unstable_cancelCallback,ft=n.unstable_shouldYield,st=n.unstable_requestPaint,Dt=n.unstable_now,er=n.unstable_getCurrentPriorityLevel,hn=n.unstable_ImmediatePriority,na=n.unstable_UserBlockingPriority,An=n.unstable_NormalPriority,kr=n.unstable_LowPriority,tr=n.unstable_IdlePriority,Ma=n.log,br=n.unstable_setDisableYieldValue,ra=null,Mt=null;function Lt(o){if(typeof Ma=="function"&&br(o),Mt&&typeof Mt.setStrictMode=="function")try{Mt.setStrictMode(ra,o)}catch{}}var an=Math.clz32?Math.clz32:wh,bh=Math.log,xh=Math.LN2;function wh(o){return o>>>=0,o===0?32:31-(bh(o)/xh|0)|0}var Ia=256,Fa=4194304;function xr(o){var s=o&42;if(s!==0)return s;switch(o&-o){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return o&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return o}}function yl(o,s,h){var p=o.pendingLanes;if(p===0)return 0;var y=0,x=o.suspendedLanes,T=o.pingedLanes;o=o.warmLanes;var k=p&134217727;return k!==0?(p=k&~x,p!==0?y=xr(p):(T&=k,T!==0?y=xr(T):h||(h=k&~o,h!==0&&(y=xr(h))))):(k=p&~x,k!==0?y=xr(k):T!==0?y=xr(T):h||(h=p&~o,h!==0&&(y=xr(h)))),y===0?0:s!==0&&s!==y&&(s&x)===0&&(x=y&-y,h=s&-s,x>=h||x===32&&(h&4194048)!==0)?s:y}function ks(o,s){return(o.pendingLanes&~(o.suspendedLanes&~o.pingedLanes)&s)===0}function eC(o,s){switch(o){case 1:case 2:case 4:case 8:case 64:return s+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Xg(){var o=Ia;return Ia<<=1,(Ia&4194048)===0&&(Ia=256),o}function Zg(){var o=Fa;return Fa<<=1,(Fa&62914560)===0&&(Fa=4194304),o}function Sh(o){for(var s=[],h=0;31>h;h++)s.push(o);return s}function Ns(o,s){o.pendingLanes|=s,s!==268435456&&(o.suspendedLanes=0,o.pingedLanes=0,o.warmLanes=0)}function tC(o,s,h,p,y,x){var T=o.pendingLanes;o.pendingLanes=h,o.suspendedLanes=0,o.pingedLanes=0,o.warmLanes=0,o.expiredLanes&=h,o.entangledLanes&=h,o.errorRecoveryDisabledLanes&=h,o.shellSuspendCounter=0;var k=o.entanglements,z=o.expirationTimes,Y=o.hiddenUpdates;for(h=T&~h;0<h;){var le=31-an(h),fe=1<<le;k[le]=0,z[le]=-1;var Q=Y[le];if(Q!==null)for(Y[le]=null,le=0;le<Q.length;le++){var re=Q[le];re!==null&&(re.lane&=-536870913)}h&=~fe}p!==0&&Yg(o,p,0),x!==0&&y===0&&o.tag!==0&&(o.suspendedLanes|=x&~(T&~s))}function Yg(o,s,h){o.pendingLanes|=s,o.suspendedLanes&=~s;var p=31-an(s);o.entangledLanes|=s,o.entanglements[p]=o.entanglements[p]|1073741824|h&4194090}function Qg(o,s){var h=o.entangledLanes|=s;for(o=o.entanglements;h;){var p=31-an(h),y=1<<p;y&s|o[p]&s&&(o[p]|=s),h&=~y}}function Eh(o){switch(o){case 2:o=1;break;case 8:o=4;break;case 32:o=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:o=128;break;case 268435456:o=134217728;break;default:o=0}return o}function _h(o){return o&=-o,2<o?8<o?(o&134217727)!==0?32:268435456:8:2}function Jg(){var o=W.p;return o!==0?o:(o=window.event,o===void 0?32:N1(o.type))}function nC(o,s){var h=W.p;try{return W.p=o,s()}finally{W.p=h}}var Ba=Math.random().toString(36).slice(2),dn="__reactFiber$"+Ba,Tn="__reactProps$"+Ba,uo="__reactContainer$"+Ba,Ch="__reactEvents$"+Ba,rC="__reactListeners$"+Ba,aC="__reactHandles$"+Ba,ey="__reactResources$"+Ba,Ms="__reactMarker$"+Ba;function Rh(o){delete o[dn],delete o[Tn],delete o[Ch],delete o[rC],delete o[aC]}function lo(o){var s=o[dn];if(s)return s;for(var h=o.parentNode;h;){if(s=h[uo]||h[dn]){if(h=s.alternate,s.child!==null||h!==null&&h.child!==null)for(o=g1(o);o!==null;){if(h=o[dn])return h;o=g1(o)}return s}o=h,h=o.parentNode}return null}function co(o){if(o=o[dn]||o[uo]){var s=o.tag;if(s===5||s===6||s===13||s===26||s===27||s===3)return o}return null}function Is(o){var s=o.tag;if(s===5||s===26||s===27||s===6)return o.stateNode;throw Error(r(33))}function fo(o){var s=o[ey];return s||(s=o[ey]={hoistableStyles:new Map,hoistableScripts:new Map}),s}function Xt(o){o[Ms]=!0}var ty=new Set,ny={};function Ei(o,s){ho(o,s),ho(o+"Capture",s)}function ho(o,s){for(ny[o]=s,o=0;o<s.length;o++)ty.add(s[o])}var iC=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),ry={},ay={};function oC(o){return Le.call(ay,o)?!0:Le.call(ry,o)?!1:iC.test(o)?ay[o]=!0:(ry[o]=!0,!1)}function bl(o,s,h){if(oC(s))if(h===null)o.removeAttribute(s);else{switch(typeof h){case"undefined":case"function":case"symbol":o.removeAttribute(s);return;case"boolean":var p=s.toLowerCase().slice(0,5);if(p!=="data-"&&p!=="aria-"){o.removeAttribute(s);return}}o.setAttribute(s,""+h)}}function xl(o,s,h){if(h===null)o.removeAttribute(s);else{switch(typeof h){case"undefined":case"function":case"symbol":case"boolean":o.removeAttribute(s);return}o.setAttribute(s,""+h)}}function aa(o,s,h,p){if(p===null)o.removeAttribute(h);else{switch(typeof p){case"undefined":case"function":case"symbol":case"boolean":o.removeAttribute(h);return}o.setAttributeNS(s,h,""+p)}}var Ah,iy;function po(o){if(Ah===void 0)try{throw Error()}catch(h){var s=h.stack.trim().match(/\n( *(at )?)/);Ah=s&&s[1]||"",iy=-1<h.stack.indexOf(`
    at`)?" (<anonymous>)":-1<h.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Ah+o+iy}var Th=!1;function Dh(o,s){if(!o||Th)return"";Th=!0;var h=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var p={DetermineComponentFrameRoot:function(){try{if(s){var fe=function(){throw Error()};if(Object.defineProperty(fe.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(fe,[])}catch(re){var Q=re}Reflect.construct(o,[],fe)}else{try{fe.call()}catch(re){Q=re}o.call(fe.prototype)}}else{try{throw Error()}catch(re){Q=re}(fe=o())&&typeof fe.catch=="function"&&fe.catch(function(){})}}catch(re){if(re&&Q&&typeof re.stack=="string")return[re.stack,Q.stack]}return[null,null]}};p.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var y=Object.getOwnPropertyDescriptor(p.DetermineComponentFrameRoot,"name");y&&y.configurable&&Object.defineProperty(p.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var x=p.DetermineComponentFrameRoot(),T=x[0],k=x[1];if(T&&k){var z=T.split(`
`),Y=k.split(`
`);for(y=p=0;p<z.length&&!z[p].includes("DetermineComponentFrameRoot");)p++;for(;y<Y.length&&!Y[y].includes("DetermineComponentFrameRoot");)y++;if(p===z.length||y===Y.length)for(p=z.length-1,y=Y.length-1;1<=p&&0<=y&&z[p]!==Y[y];)y--;for(;1<=p&&0<=y;p--,y--)if(z[p]!==Y[y]){if(p!==1||y!==1)do if(p--,y--,0>y||z[p]!==Y[y]){var le=`
`+z[p].replace(" at new "," at ");return o.displayName&&le.includes("<anonymous>")&&(le=le.replace("<anonymous>",o.displayName)),le}while(1<=p&&0<=y);break}}}finally{Th=!1,Error.prepareStackTrace=h}return(h=o?o.displayName||o.name:"")?po(h):""}function sC(o){switch(o.tag){case 26:case 27:case 5:return po(o.type);case 16:return po("Lazy");case 13:return po("Suspense");case 19:return po("SuspenseList");case 0:case 15:return Dh(o.type,!1);case 11:return Dh(o.type.render,!1);case 1:return Dh(o.type,!0);case 31:return po("Activity");default:return""}}function oy(o){try{var s="";do s+=sC(o),o=o.return;while(o);return s}catch(h){return`
Error generating stack: `+h.message+`
`+h.stack}}function nr(o){switch(typeof o){case"bigint":case"boolean":case"number":case"string":case"undefined":return o;case"object":return o;default:return""}}function sy(o){var s=o.type;return(o=o.nodeName)&&o.toLowerCase()==="input"&&(s==="checkbox"||s==="radio")}function uC(o){var s=sy(o)?"checked":"value",h=Object.getOwnPropertyDescriptor(o.constructor.prototype,s),p=""+o[s];if(!o.hasOwnProperty(s)&&typeof h<"u"&&typeof h.get=="function"&&typeof h.set=="function"){var y=h.get,x=h.set;return Object.defineProperty(o,s,{configurable:!0,get:function(){return y.call(this)},set:function(T){p=""+T,x.call(this,T)}}),Object.defineProperty(o,s,{enumerable:h.enumerable}),{getValue:function(){return p},setValue:function(T){p=""+T},stopTracking:function(){o._valueTracker=null,delete o[s]}}}}function wl(o){o._valueTracker||(o._valueTracker=uC(o))}function uy(o){if(!o)return!1;var s=o._valueTracker;if(!s)return!0;var h=s.getValue(),p="";return o&&(p=sy(o)?o.checked?"true":"false":o.value),o=p,o!==h?(s.setValue(o),!0):!1}function Sl(o){if(o=o||(typeof document<"u"?document:void 0),typeof o>"u")return null;try{return o.activeElement||o.body}catch{return o.body}}var lC=/[\n"\\]/g;function rr(o){return o.replace(lC,function(s){return"\\"+s.charCodeAt(0).toString(16)+" "})}function Oh(o,s,h,p,y,x,T,k){o.name="",T!=null&&typeof T!="function"&&typeof T!="symbol"&&typeof T!="boolean"?o.type=T:o.removeAttribute("type"),s!=null?T==="number"?(s===0&&o.value===""||o.value!=s)&&(o.value=""+nr(s)):o.value!==""+nr(s)&&(o.value=""+nr(s)):T!=="submit"&&T!=="reset"||o.removeAttribute("value"),s!=null?kh(o,T,nr(s)):h!=null?kh(o,T,nr(h)):p!=null&&o.removeAttribute("value"),y==null&&x!=null&&(o.defaultChecked=!!x),y!=null&&(o.checked=y&&typeof y!="function"&&typeof y!="symbol"),k!=null&&typeof k!="function"&&typeof k!="symbol"&&typeof k!="boolean"?o.name=""+nr(k):o.removeAttribute("name")}function ly(o,s,h,p,y,x,T,k){if(x!=null&&typeof x!="function"&&typeof x!="symbol"&&typeof x!="boolean"&&(o.type=x),s!=null||h!=null){if(!(x!=="submit"&&x!=="reset"||s!=null))return;h=h!=null?""+nr(h):"",s=s!=null?""+nr(s):h,k||s===o.value||(o.value=s),o.defaultValue=s}p=p??y,p=typeof p!="function"&&typeof p!="symbol"&&!!p,o.checked=k?o.checked:!!p,o.defaultChecked=!!p,T!=null&&typeof T!="function"&&typeof T!="symbol"&&typeof T!="boolean"&&(o.name=T)}function kh(o,s,h){s==="number"&&Sl(o.ownerDocument)===o||o.defaultValue===""+h||(o.defaultValue=""+h)}function vo(o,s,h,p){if(o=o.options,s){s={};for(var y=0;y<h.length;y++)s["$"+h[y]]=!0;for(h=0;h<o.length;h++)y=s.hasOwnProperty("$"+o[h].value),o[h].selected!==y&&(o[h].selected=y),y&&p&&(o[h].defaultSelected=!0)}else{for(h=""+nr(h),s=null,y=0;y<o.length;y++){if(o[y].value===h){o[y].selected=!0,p&&(o[y].defaultSelected=!0);return}s!==null||o[y].disabled||(s=o[y])}s!==null&&(s.selected=!0)}}function cy(o,s,h){if(s!=null&&(s=""+nr(s),s!==o.value&&(o.value=s),h==null)){o.defaultValue!==s&&(o.defaultValue=s);return}o.defaultValue=h!=null?""+nr(h):""}function fy(o,s,h,p){if(s==null){if(p!=null){if(h!=null)throw Error(r(92));if(te(p)){if(1<p.length)throw Error(r(93));p=p[0]}h=p}h==null&&(h=""),s=h}h=nr(s),o.defaultValue=h,p=o.textContent,p===h&&p!==""&&p!==null&&(o.value=p)}function mo(o,s){if(s){var h=o.firstChild;if(h&&h===o.lastChild&&h.nodeType===3){h.nodeValue=s;return}}o.textContent=s}var cC=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function hy(o,s,h){var p=s.indexOf("--")===0;h==null||typeof h=="boolean"||h===""?p?o.setProperty(s,""):s==="float"?o.cssFloat="":o[s]="":p?o.setProperty(s,h):typeof h!="number"||h===0||cC.has(s)?s==="float"?o.cssFloat=h:o[s]=(""+h).trim():o[s]=h+"px"}function dy(o,s,h){if(s!=null&&typeof s!="object")throw Error(r(62));if(o=o.style,h!=null){for(var p in h)!h.hasOwnProperty(p)||s!=null&&s.hasOwnProperty(p)||(p.indexOf("--")===0?o.setProperty(p,""):p==="float"?o.cssFloat="":o[p]="");for(var y in s)p=s[y],s.hasOwnProperty(y)&&h[y]!==p&&hy(o,y,p)}else for(var x in s)s.hasOwnProperty(x)&&hy(o,x,s[x])}function Nh(o){if(o.indexOf("-")===-1)return!1;switch(o){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var fC=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),hC=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function El(o){return hC.test(""+o)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":o}var Mh=null;function Ih(o){return o=o.target||o.srcElement||window,o.correspondingUseElement&&(o=o.correspondingUseElement),o.nodeType===3?o.parentNode:o}var go=null,yo=null;function py(o){var s=co(o);if(s&&(o=s.stateNode)){var h=o[Tn]||null;e:switch(o=s.stateNode,s.type){case"input":if(Oh(o,h.value,h.defaultValue,h.defaultValue,h.checked,h.defaultChecked,h.type,h.name),s=h.name,h.type==="radio"&&s!=null){for(h=o;h.parentNode;)h=h.parentNode;for(h=h.querySelectorAll('input[name="'+rr(""+s)+'"][type="radio"]'),s=0;s<h.length;s++){var p=h[s];if(p!==o&&p.form===o.form){var y=p[Tn]||null;if(!y)throw Error(r(90));Oh(p,y.value,y.defaultValue,y.defaultValue,y.checked,y.defaultChecked,y.type,y.name)}}for(s=0;s<h.length;s++)p=h[s],p.form===o.form&&uy(p)}break e;case"textarea":cy(o,h.value,h.defaultValue);break e;case"select":s=h.value,s!=null&&vo(o,!!h.multiple,s,!1)}}}var Fh=!1;function vy(o,s,h){if(Fh)return o(s,h);Fh=!0;try{var p=o(s);return p}finally{if(Fh=!1,(go!==null||yo!==null)&&(uc(),go&&(s=go,o=yo,yo=go=null,py(s),o)))for(s=0;s<o.length;s++)py(o[s])}}function Fs(o,s){var h=o.stateNode;if(h===null)return null;var p=h[Tn]||null;if(p===null)return null;h=p[s];e:switch(s){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(p=!p.disabled)||(o=o.type,p=!(o==="button"||o==="input"||o==="select"||o==="textarea")),o=!p;break e;default:o=!1}if(o)return null;if(h&&typeof h!="function")throw Error(r(231,s,typeof h));return h}var ia=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Bh=!1;if(ia)try{var Bs={};Object.defineProperty(Bs,"passive",{get:function(){Bh=!0}}),window.addEventListener("test",Bs,Bs),window.removeEventListener("test",Bs,Bs)}catch{Bh=!1}var Pa=null,Ph=null,_l=null;function my(){if(_l)return _l;var o,s=Ph,h=s.length,p,y="value"in Pa?Pa.value:Pa.textContent,x=y.length;for(o=0;o<h&&s[o]===y[o];o++);var T=h-o;for(p=1;p<=T&&s[h-p]===y[x-p];p++);return _l=y.slice(o,1<p?1-p:void 0)}function Cl(o){var s=o.keyCode;return"charCode"in o?(o=o.charCode,o===0&&s===13&&(o=13)):o=s,o===10&&(o=13),32<=o||o===13?o:0}function Rl(){return!0}function gy(){return!1}function Dn(o){function s(h,p,y,x,T){this._reactName=h,this._targetInst=y,this.type=p,this.nativeEvent=x,this.target=T,this.currentTarget=null;for(var k in o)o.hasOwnProperty(k)&&(h=o[k],this[k]=h?h(x):x[k]);return this.isDefaultPrevented=(x.defaultPrevented!=null?x.defaultPrevented:x.returnValue===!1)?Rl:gy,this.isPropagationStopped=gy,this}return d(s.prototype,{preventDefault:function(){this.defaultPrevented=!0;var h=this.nativeEvent;h&&(h.preventDefault?h.preventDefault():typeof h.returnValue!="unknown"&&(h.returnValue=!1),this.isDefaultPrevented=Rl)},stopPropagation:function(){var h=this.nativeEvent;h&&(h.stopPropagation?h.stopPropagation():typeof h.cancelBubble!="unknown"&&(h.cancelBubble=!0),this.isPropagationStopped=Rl)},persist:function(){},isPersistent:Rl}),s}var _i={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(o){return o.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Al=Dn(_i),Ps=d({},_i,{view:0,detail:0}),dC=Dn(Ps),Lh,zh,Ls,Tl=d({},Ps,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Hh,button:0,buttons:0,relatedTarget:function(o){return o.relatedTarget===void 0?o.fromElement===o.srcElement?o.toElement:o.fromElement:o.relatedTarget},movementX:function(o){return"movementX"in o?o.movementX:(o!==Ls&&(Ls&&o.type==="mousemove"?(Lh=o.screenX-Ls.screenX,zh=o.screenY-Ls.screenY):zh=Lh=0,Ls=o),Lh)},movementY:function(o){return"movementY"in o?o.movementY:zh}}),yy=Dn(Tl),pC=d({},Tl,{dataTransfer:0}),vC=Dn(pC),mC=d({},Ps,{relatedTarget:0}),Uh=Dn(mC),gC=d({},_i,{animationName:0,elapsedTime:0,pseudoElement:0}),yC=Dn(gC),bC=d({},_i,{clipboardData:function(o){return"clipboardData"in o?o.clipboardData:window.clipboardData}}),xC=Dn(bC),wC=d({},_i,{data:0}),by=Dn(wC),SC={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},EC={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},_C={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function CC(o){var s=this.nativeEvent;return s.getModifierState?s.getModifierState(o):(o=_C[o])?!!s[o]:!1}function Hh(){return CC}var RC=d({},Ps,{key:function(o){if(o.key){var s=SC[o.key]||o.key;if(s!=="Unidentified")return s}return o.type==="keypress"?(o=Cl(o),o===13?"Enter":String.fromCharCode(o)):o.type==="keydown"||o.type==="keyup"?EC[o.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Hh,charCode:function(o){return o.type==="keypress"?Cl(o):0},keyCode:function(o){return o.type==="keydown"||o.type==="keyup"?o.keyCode:0},which:function(o){return o.type==="keypress"?Cl(o):o.type==="keydown"||o.type==="keyup"?o.keyCode:0}}),AC=Dn(RC),TC=d({},Tl,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),xy=Dn(TC),DC=d({},Ps,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Hh}),OC=Dn(DC),kC=d({},_i,{propertyName:0,elapsedTime:0,pseudoElement:0}),NC=Dn(kC),MC=d({},Tl,{deltaX:function(o){return"deltaX"in o?o.deltaX:"wheelDeltaX"in o?-o.wheelDeltaX:0},deltaY:function(o){return"deltaY"in o?o.deltaY:"wheelDeltaY"in o?-o.wheelDeltaY:"wheelDelta"in o?-o.wheelDelta:0},deltaZ:0,deltaMode:0}),IC=Dn(MC),FC=d({},_i,{newState:0,oldState:0}),BC=Dn(FC),PC=[9,13,27,32],Vh=ia&&"CompositionEvent"in window,zs=null;ia&&"documentMode"in document&&(zs=document.documentMode);var LC=ia&&"TextEvent"in window&&!zs,wy=ia&&(!Vh||zs&&8<zs&&11>=zs),Sy=" ",Ey=!1;function _y(o,s){switch(o){case"keyup":return PC.indexOf(s.keyCode)!==-1;case"keydown":return s.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Cy(o){return o=o.detail,typeof o=="object"&&"data"in o?o.data:null}var bo=!1;function zC(o,s){switch(o){case"compositionend":return Cy(s);case"keypress":return s.which!==32?null:(Ey=!0,Sy);case"textInput":return o=s.data,o===Sy&&Ey?null:o;default:return null}}function UC(o,s){if(bo)return o==="compositionend"||!Vh&&_y(o,s)?(o=my(),_l=Ph=Pa=null,bo=!1,o):null;switch(o){case"paste":return null;case"keypress":if(!(s.ctrlKey||s.altKey||s.metaKey)||s.ctrlKey&&s.altKey){if(s.char&&1<s.char.length)return s.char;if(s.which)return String.fromCharCode(s.which)}return null;case"compositionend":return wy&&s.locale!=="ko"?null:s.data;default:return null}}var HC={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Ry(o){var s=o&&o.nodeName&&o.nodeName.toLowerCase();return s==="input"?!!HC[o.type]:s==="textarea"}function Ay(o,s,h,p){go?yo?yo.push(p):yo=[p]:go=p,s=pc(s,"onChange"),0<s.length&&(h=new Al("onChange","change",null,h,p),o.push({event:h,listeners:s}))}var Us=null,Hs=null;function VC(o){s1(o,0)}function Dl(o){var s=Is(o);if(uy(s))return o}function Ty(o,s){if(o==="change")return s}var Dy=!1;if(ia){var Wh;if(ia){var Gh="oninput"in document;if(!Gh){var Oy=document.createElement("div");Oy.setAttribute("oninput","return;"),Gh=typeof Oy.oninput=="function"}Wh=Gh}else Wh=!1;Dy=Wh&&(!document.documentMode||9<document.documentMode)}function ky(){Us&&(Us.detachEvent("onpropertychange",Ny),Hs=Us=null)}function Ny(o){if(o.propertyName==="value"&&Dl(Hs)){var s=[];Ay(s,Hs,o,Ih(o)),vy(VC,s)}}function WC(o,s,h){o==="focusin"?(ky(),Us=s,Hs=h,Us.attachEvent("onpropertychange",Ny)):o==="focusout"&&ky()}function GC(o){if(o==="selectionchange"||o==="keyup"||o==="keydown")return Dl(Hs)}function jC(o,s){if(o==="click")return Dl(s)}function qC(o,s){if(o==="input"||o==="change")return Dl(s)}function $C(o,s){return o===s&&(o!==0||1/o===1/s)||o!==o&&s!==s}var zn=typeof Object.is=="function"?Object.is:$C;function Vs(o,s){if(zn(o,s))return!0;if(typeof o!="object"||o===null||typeof s!="object"||s===null)return!1;var h=Object.keys(o),p=Object.keys(s);if(h.length!==p.length)return!1;for(p=0;p<h.length;p++){var y=h[p];if(!Le.call(s,y)||!zn(o[y],s[y]))return!1}return!0}function My(o){for(;o&&o.firstChild;)o=o.firstChild;return o}function Iy(o,s){var h=My(o);o=0;for(var p;h;){if(h.nodeType===3){if(p=o+h.textContent.length,o<=s&&p>=s)return{node:h,offset:s-o};o=p}e:{for(;h;){if(h.nextSibling){h=h.nextSibling;break e}h=h.parentNode}h=void 0}h=My(h)}}function Fy(o,s){return o&&s?o===s?!0:o&&o.nodeType===3?!1:s&&s.nodeType===3?Fy(o,s.parentNode):"contains"in o?o.contains(s):o.compareDocumentPosition?!!(o.compareDocumentPosition(s)&16):!1:!1}function By(o){o=o!=null&&o.ownerDocument!=null&&o.ownerDocument.defaultView!=null?o.ownerDocument.defaultView:window;for(var s=Sl(o.document);s instanceof o.HTMLIFrameElement;){try{var h=typeof s.contentWindow.location.href=="string"}catch{h=!1}if(h)o=s.contentWindow;else break;s=Sl(o.document)}return s}function jh(o){var s=o&&o.nodeName&&o.nodeName.toLowerCase();return s&&(s==="input"&&(o.type==="text"||o.type==="search"||o.type==="tel"||o.type==="url"||o.type==="password")||s==="textarea"||o.contentEditable==="true")}var KC=ia&&"documentMode"in document&&11>=document.documentMode,xo=null,qh=null,Ws=null,$h=!1;function Py(o,s,h){var p=h.window===h?h.document:h.nodeType===9?h:h.ownerDocument;$h||xo==null||xo!==Sl(p)||(p=xo,"selectionStart"in p&&jh(p)?p={start:p.selectionStart,end:p.selectionEnd}:(p=(p.ownerDocument&&p.ownerDocument.defaultView||window).getSelection(),p={anchorNode:p.anchorNode,anchorOffset:p.anchorOffset,focusNode:p.focusNode,focusOffset:p.focusOffset}),Ws&&Vs(Ws,p)||(Ws=p,p=pc(qh,"onSelect"),0<p.length&&(s=new Al("onSelect","select",null,s,h),o.push({event:s,listeners:p}),s.target=xo)))}function Ci(o,s){var h={};return h[o.toLowerCase()]=s.toLowerCase(),h["Webkit"+o]="webkit"+s,h["Moz"+o]="moz"+s,h}var wo={animationend:Ci("Animation","AnimationEnd"),animationiteration:Ci("Animation","AnimationIteration"),animationstart:Ci("Animation","AnimationStart"),transitionrun:Ci("Transition","TransitionRun"),transitionstart:Ci("Transition","TransitionStart"),transitioncancel:Ci("Transition","TransitionCancel"),transitionend:Ci("Transition","TransitionEnd")},Kh={},Ly={};ia&&(Ly=document.createElement("div").style,"AnimationEvent"in window||(delete wo.animationend.animation,delete wo.animationiteration.animation,delete wo.animationstart.animation),"TransitionEvent"in window||delete wo.transitionend.transition);function Ri(o){if(Kh[o])return Kh[o];if(!wo[o])return o;var s=wo[o],h;for(h in s)if(s.hasOwnProperty(h)&&h in Ly)return Kh[o]=s[h];return o}var zy=Ri("animationend"),Uy=Ri("animationiteration"),Hy=Ri("animationstart"),XC=Ri("transitionrun"),ZC=Ri("transitionstart"),YC=Ri("transitioncancel"),Vy=Ri("transitionend"),Wy=new Map,Xh="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Xh.push("scrollEnd");function wr(o,s){Wy.set(o,s),Ei(s,[o])}var Gy=new WeakMap;function ar(o,s){if(typeof o=="object"&&o!==null){var h=Gy.get(o);return h!==void 0?h:(s={value:o,source:s,stack:oy(s)},Gy.set(o,s),s)}return{value:o,source:s,stack:oy(s)}}var ir=[],So=0,Zh=0;function Ol(){for(var o=So,s=Zh=So=0;s<o;){var h=ir[s];ir[s++]=null;var p=ir[s];ir[s++]=null;var y=ir[s];ir[s++]=null;var x=ir[s];if(ir[s++]=null,p!==null&&y!==null){var T=p.pending;T===null?y.next=y:(y.next=T.next,T.next=y),p.pending=y}x!==0&&jy(h,y,x)}}function kl(o,s,h,p){ir[So++]=o,ir[So++]=s,ir[So++]=h,ir[So++]=p,Zh|=p,o.lanes|=p,o=o.alternate,o!==null&&(o.lanes|=p)}function Yh(o,s,h,p){return kl(o,s,h,p),Nl(o)}function Eo(o,s){return kl(o,null,null,s),Nl(o)}function jy(o,s,h){o.lanes|=h;var p=o.alternate;p!==null&&(p.lanes|=h);for(var y=!1,x=o.return;x!==null;)x.childLanes|=h,p=x.alternate,p!==null&&(p.childLanes|=h),x.tag===22&&(o=x.stateNode,o===null||o._visibility&1||(y=!0)),o=x,x=x.return;return o.tag===3?(x=o.stateNode,y&&s!==null&&(y=31-an(h),o=x.hiddenUpdates,p=o[y],p===null?o[y]=[s]:p.push(s),s.lane=h|536870912),x):null}function Nl(o){if(50<pu)throw pu=0,rp=null,Error(r(185));for(var s=o.return;s!==null;)o=s,s=o.return;return o.tag===3?o.stateNode:null}var _o={};function QC(o,s,h,p){this.tag=o,this.key=h,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=s,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=p,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Un(o,s,h,p){return new QC(o,s,h,p)}function Qh(o){return o=o.prototype,!(!o||!o.isReactComponent)}function oa(o,s){var h=o.alternate;return h===null?(h=Un(o.tag,s,o.key,o.mode),h.elementType=o.elementType,h.type=o.type,h.stateNode=o.stateNode,h.alternate=o,o.alternate=h):(h.pendingProps=s,h.type=o.type,h.flags=0,h.subtreeFlags=0,h.deletions=null),h.flags=o.flags&65011712,h.childLanes=o.childLanes,h.lanes=o.lanes,h.child=o.child,h.memoizedProps=o.memoizedProps,h.memoizedState=o.memoizedState,h.updateQueue=o.updateQueue,s=o.dependencies,h.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext},h.sibling=o.sibling,h.index=o.index,h.ref=o.ref,h.refCleanup=o.refCleanup,h}function qy(o,s){o.flags&=65011714;var h=o.alternate;return h===null?(o.childLanes=0,o.lanes=s,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=h.childLanes,o.lanes=h.lanes,o.child=h.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=h.memoizedProps,o.memoizedState=h.memoizedState,o.updateQueue=h.updateQueue,o.type=h.type,s=h.dependencies,o.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext}),o}function Ml(o,s,h,p,y,x){var T=0;if(p=o,typeof o=="function")Qh(o)&&(T=1);else if(typeof o=="string")T=eA(o,h,de.current)?26:o==="html"||o==="head"||o==="body"?27:5;else e:switch(o){case N:return o=Un(31,h,s,y),o.elementType=N,o.lanes=x,o;case b:return Ai(h.children,y,x,s);case w:T=8,y|=24;break;case S:return o=Un(12,h,s,y|2),o.elementType=S,o.lanes=x,o;case A:return o=Un(13,h,s,y),o.elementType=A,o.lanes=x,o;case D:return o=Un(19,h,s,y),o.elementType=D,o.lanes=x,o;default:if(typeof o=="object"&&o!==null)switch(o.$$typeof){case E:case R:T=10;break e;case _:T=9;break e;case C:T=11;break e;case O:T=14;break e;case F:T=16,p=null;break e}T=29,h=Error(r(130,o===null?"null":typeof o,"")),p=null}return s=Un(T,h,s,y),s.elementType=o,s.type=p,s.lanes=x,s}function Ai(o,s,h,p){return o=Un(7,o,p,s),o.lanes=h,o}function Jh(o,s,h){return o=Un(6,o,null,s),o.lanes=h,o}function ed(o,s,h){return s=Un(4,o.children!==null?o.children:[],o.key,s),s.lanes=h,s.stateNode={containerInfo:o.containerInfo,pendingChildren:null,implementation:o.implementation},s}var Co=[],Ro=0,Il=null,Fl=0,or=[],sr=0,Ti=null,sa=1,ua="";function Di(o,s){Co[Ro++]=Fl,Co[Ro++]=Il,Il=o,Fl=s}function $y(o,s,h){or[sr++]=sa,or[sr++]=ua,or[sr++]=Ti,Ti=o;var p=sa;o=ua;var y=32-an(p)-1;p&=~(1<<y),h+=1;var x=32-an(s)+y;if(30<x){var T=y-y%5;x=(p&(1<<T)-1).toString(32),p>>=T,y-=T,sa=1<<32-an(s)+y|h<<y|p,ua=x+o}else sa=1<<x|h<<y|p,ua=o}function td(o){o.return!==null&&(Di(o,1),$y(o,1,0))}function nd(o){for(;o===Il;)Il=Co[--Ro],Co[Ro]=null,Fl=Co[--Ro],Co[Ro]=null;for(;o===Ti;)Ti=or[--sr],or[sr]=null,ua=or[--sr],or[sr]=null,sa=or[--sr],or[sr]=null}var En=null,Rt=null,nt=!1,Oi=null,Nr=!1,rd=Error(r(519));function ki(o){var s=Error(r(418,""));throw qs(ar(s,o)),rd}function Ky(o){var s=o.stateNode,h=o.type,p=o.memoizedProps;switch(s[dn]=o,s[Tn]=p,h){case"dialog":Ke("cancel",s),Ke("close",s);break;case"iframe":case"object":case"embed":Ke("load",s);break;case"video":case"audio":for(h=0;h<mu.length;h++)Ke(mu[h],s);break;case"source":Ke("error",s);break;case"img":case"image":case"link":Ke("error",s),Ke("load",s);break;case"details":Ke("toggle",s);break;case"input":Ke("invalid",s),ly(s,p.value,p.defaultValue,p.checked,p.defaultChecked,p.type,p.name,!0),wl(s);break;case"select":Ke("invalid",s);break;case"textarea":Ke("invalid",s),fy(s,p.value,p.defaultValue,p.children),wl(s)}h=p.children,typeof h!="string"&&typeof h!="number"&&typeof h!="bigint"||s.textContent===""+h||p.suppressHydrationWarning===!0||f1(s.textContent,h)?(p.popover!=null&&(Ke("beforetoggle",s),Ke("toggle",s)),p.onScroll!=null&&Ke("scroll",s),p.onScrollEnd!=null&&Ke("scrollend",s),p.onClick!=null&&(s.onclick=vc),s=!0):s=!1,s||ki(o)}function Xy(o){for(En=o.return;En;)switch(En.tag){case 5:case 13:Nr=!1;return;case 27:case 3:Nr=!0;return;default:En=En.return}}function Gs(o){if(o!==En)return!1;if(!nt)return Xy(o),nt=!0,!1;var s=o.tag,h;if((h=s!==3&&s!==27)&&((h=s===5)&&(h=o.type,h=!(h!=="form"&&h!=="button")||bp(o.type,o.memoizedProps)),h=!h),h&&Rt&&ki(o),Xy(o),s===13){if(o=o.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(r(317));e:{for(o=o.nextSibling,s=0;o;){if(o.nodeType===8)if(h=o.data,h==="/$"){if(s===0){Rt=Er(o.nextSibling);break e}s--}else h!=="$"&&h!=="$!"&&h!=="$?"||s++;o=o.nextSibling}Rt=null}}else s===27?(s=Rt,Ja(o.type)?(o=Ep,Ep=null,Rt=o):Rt=s):Rt=En?Er(o.stateNode.nextSibling):null;return!0}function js(){Rt=En=null,nt=!1}function Zy(){var o=Oi;return o!==null&&(Nn===null?Nn=o:Nn.push.apply(Nn,o),Oi=null),o}function qs(o){Oi===null?Oi=[o]:Oi.push(o)}var ad=j(null),Ni=null,la=null;function La(o,s,h){oe(ad,s._currentValue),s._currentValue=h}function ca(o){o._currentValue=ad.current,ie(ad)}function id(o,s,h){for(;o!==null;){var p=o.alternate;if((o.childLanes&s)!==s?(o.childLanes|=s,p!==null&&(p.childLanes|=s)):p!==null&&(p.childLanes&s)!==s&&(p.childLanes|=s),o===h)break;o=o.return}}function od(o,s,h,p){var y=o.child;for(y!==null&&(y.return=o);y!==null;){var x=y.dependencies;if(x!==null){var T=y.child;x=x.firstContext;e:for(;x!==null;){var k=x;x=y;for(var z=0;z<s.length;z++)if(k.context===s[z]){x.lanes|=h,k=x.alternate,k!==null&&(k.lanes|=h),id(x.return,h,o),p||(T=null);break e}x=k.next}}else if(y.tag===18){if(T=y.return,T===null)throw Error(r(341));T.lanes|=h,x=T.alternate,x!==null&&(x.lanes|=h),id(T,h,o),T=null}else T=y.child;if(T!==null)T.return=y;else for(T=y;T!==null;){if(T===o){T=null;break}if(y=T.sibling,y!==null){y.return=T.return,T=y;break}T=T.return}y=T}}function $s(o,s,h,p){o=null;for(var y=s,x=!1;y!==null;){if(!x){if((y.flags&524288)!==0)x=!0;else if((y.flags&262144)!==0)break}if(y.tag===10){var T=y.alternate;if(T===null)throw Error(r(387));if(T=T.memoizedProps,T!==null){var k=y.type;zn(y.pendingProps.value,T.value)||(o!==null?o.push(k):o=[k])}}else if(y===Ae.current){if(T=y.alternate,T===null)throw Error(r(387));T.memoizedState.memoizedState!==y.memoizedState.memoizedState&&(o!==null?o.push(Su):o=[Su])}y=y.return}o!==null&&od(s,o,h,p),s.flags|=262144}function Bl(o){for(o=o.firstContext;o!==null;){if(!zn(o.context._currentValue,o.memoizedValue))return!0;o=o.next}return!1}function Mi(o){Ni=o,la=null,o=o.dependencies,o!==null&&(o.firstContext=null)}function pn(o){return Yy(Ni,o)}function Pl(o,s){return Ni===null&&Mi(o),Yy(o,s)}function Yy(o,s){var h=s._currentValue;if(s={context:s,memoizedValue:h,next:null},la===null){if(o===null)throw Error(r(308));la=s,o.dependencies={lanes:0,firstContext:s},o.flags|=524288}else la=la.next=s;return h}var JC=typeof AbortController<"u"?AbortController:function(){var o=[],s=this.signal={aborted:!1,addEventListener:function(h,p){o.push(p)}};this.abort=function(){s.aborted=!0,o.forEach(function(h){return h()})}},eR=n.unstable_scheduleCallback,tR=n.unstable_NormalPriority,zt={$$typeof:R,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function sd(){return{controller:new JC,data:new Map,refCount:0}}function Ks(o){o.refCount--,o.refCount===0&&eR(tR,function(){o.controller.abort()})}var Xs=null,ud=0,Ao=0,To=null;function nR(o,s){if(Xs===null){var h=Xs=[];ud=0,Ao=cp(),To={status:"pending",value:void 0,then:function(p){h.push(p)}}}return ud++,s.then(Qy,Qy),s}function Qy(){if(--ud===0&&Xs!==null){To!==null&&(To.status="fulfilled");var o=Xs;Xs=null,Ao=0,To=null;for(var s=0;s<o.length;s++)(0,o[s])()}}function rR(o,s){var h=[],p={status:"pending",value:null,reason:null,then:function(y){h.push(y)}};return o.then(function(){p.status="fulfilled",p.value=s;for(var y=0;y<h.length;y++)(0,h[y])(s)},function(y){for(p.status="rejected",p.reason=y,y=0;y<h.length;y++)(0,h[y])(void 0)}),p}var Jy=L.S;L.S=function(o,s){typeof s=="object"&&s!==null&&typeof s.then=="function"&&nR(o,s),Jy!==null&&Jy(o,s)};var Ii=j(null);function ld(){var o=Ii.current;return o!==null?o:dt.pooledCache}function Ll(o,s){s===null?oe(Ii,Ii.current):oe(Ii,s.pool)}function e0(){var o=ld();return o===null?null:{parent:zt._currentValue,pool:o}}var Zs=Error(r(460)),t0=Error(r(474)),zl=Error(r(542)),cd={then:function(){}};function n0(o){return o=o.status,o==="fulfilled"||o==="rejected"}function Ul(){}function r0(o,s,h){switch(h=o[h],h===void 0?o.push(s):h!==s&&(s.then(Ul,Ul),s=h),s.status){case"fulfilled":return s.value;case"rejected":throw o=s.reason,i0(o),o;default:if(typeof s.status=="string")s.then(Ul,Ul);else{if(o=dt,o!==null&&100<o.shellSuspendCounter)throw Error(r(482));o=s,o.status="pending",o.then(function(p){if(s.status==="pending"){var y=s;y.status="fulfilled",y.value=p}},function(p){if(s.status==="pending"){var y=s;y.status="rejected",y.reason=p}})}switch(s.status){case"fulfilled":return s.value;case"rejected":throw o=s.reason,i0(o),o}throw Ys=s,Zs}}var Ys=null;function a0(){if(Ys===null)throw Error(r(459));var o=Ys;return Ys=null,o}function i0(o){if(o===Zs||o===zl)throw Error(r(483))}var za=!1;function fd(o){o.updateQueue={baseState:o.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function hd(o,s){o=o.updateQueue,s.updateQueue===o&&(s.updateQueue={baseState:o.baseState,firstBaseUpdate:o.firstBaseUpdate,lastBaseUpdate:o.lastBaseUpdate,shared:o.shared,callbacks:null})}function Ua(o){return{lane:o,tag:0,payload:null,callback:null,next:null}}function Ha(o,s,h){var p=o.updateQueue;if(p===null)return null;if(p=p.shared,(it&2)!==0){var y=p.pending;return y===null?s.next=s:(s.next=y.next,y.next=s),p.pending=s,s=Nl(o),jy(o,null,h),s}return kl(o,p,s,h),Nl(o)}function Qs(o,s,h){if(s=s.updateQueue,s!==null&&(s=s.shared,(h&4194048)!==0)){var p=s.lanes;p&=o.pendingLanes,h|=p,s.lanes=h,Qg(o,h)}}function dd(o,s){var h=o.updateQueue,p=o.alternate;if(p!==null&&(p=p.updateQueue,h===p)){var y=null,x=null;if(h=h.firstBaseUpdate,h!==null){do{var T={lane:h.lane,tag:h.tag,payload:h.payload,callback:null,next:null};x===null?y=x=T:x=x.next=T,h=h.next}while(h!==null);x===null?y=x=s:x=x.next=s}else y=x=s;h={baseState:p.baseState,firstBaseUpdate:y,lastBaseUpdate:x,shared:p.shared,callbacks:p.callbacks},o.updateQueue=h;return}o=h.lastBaseUpdate,o===null?h.firstBaseUpdate=s:o.next=s,h.lastBaseUpdate=s}var pd=!1;function Js(){if(pd){var o=To;if(o!==null)throw o}}function eu(o,s,h,p){pd=!1;var y=o.updateQueue;za=!1;var x=y.firstBaseUpdate,T=y.lastBaseUpdate,k=y.shared.pending;if(k!==null){y.shared.pending=null;var z=k,Y=z.next;z.next=null,T===null?x=Y:T.next=Y,T=z;var le=o.alternate;le!==null&&(le=le.updateQueue,k=le.lastBaseUpdate,k!==T&&(k===null?le.firstBaseUpdate=Y:k.next=Y,le.lastBaseUpdate=z))}if(x!==null){var fe=y.baseState;T=0,le=Y=z=null,k=x;do{var Q=k.lane&-536870913,re=Q!==k.lane;if(re?(Ze&Q)===Q:(p&Q)===Q){Q!==0&&Q===Ao&&(pd=!0),le!==null&&(le=le.next={lane:0,tag:k.tag,payload:k.payload,callback:null,next:null});e:{var Me=o,Oe=k;Q=s;var ct=h;switch(Oe.tag){case 1:if(Me=Oe.payload,typeof Me=="function"){fe=Me.call(ct,fe,Q);break e}fe=Me;break e;case 3:Me.flags=Me.flags&-65537|128;case 0:if(Me=Oe.payload,Q=typeof Me=="function"?Me.call(ct,fe,Q):Me,Q==null)break e;fe=d({},fe,Q);break e;case 2:za=!0}}Q=k.callback,Q!==null&&(o.flags|=64,re&&(o.flags|=8192),re=y.callbacks,re===null?y.callbacks=[Q]:re.push(Q))}else re={lane:Q,tag:k.tag,payload:k.payload,callback:k.callback,next:null},le===null?(Y=le=re,z=fe):le=le.next=re,T|=Q;if(k=k.next,k===null){if(k=y.shared.pending,k===null)break;re=k,k=re.next,re.next=null,y.lastBaseUpdate=re,y.shared.pending=null}}while(!0);le===null&&(z=fe),y.baseState=z,y.firstBaseUpdate=Y,y.lastBaseUpdate=le,x===null&&(y.shared.lanes=0),Xa|=T,o.lanes=T,o.memoizedState=fe}}function o0(o,s){if(typeof o!="function")throw Error(r(191,o));o.call(s)}function s0(o,s){var h=o.callbacks;if(h!==null)for(o.callbacks=null,o=0;o<h.length;o++)o0(h[o],s)}var Do=j(null),Hl=j(0);function u0(o,s){o=ga,oe(Hl,o),oe(Do,s),ga=o|s.baseLanes}function vd(){oe(Hl,ga),oe(Do,Do.current)}function md(){ga=Hl.current,ie(Do),ie(Hl)}var Va=0,Ge=null,ut=null,It=null,Vl=!1,Oo=!1,Fi=!1,Wl=0,tu=0,ko=null,aR=0;function Ot(){throw Error(r(321))}function gd(o,s){if(s===null)return!1;for(var h=0;h<s.length&&h<o.length;h++)if(!zn(o[h],s[h]))return!1;return!0}function yd(o,s,h,p,y,x){return Va=x,Ge=s,s.memoizedState=null,s.updateQueue=null,s.lanes=0,L.H=o===null||o.memoizedState===null?j0:q0,Fi=!1,x=h(p,y),Fi=!1,Oo&&(x=c0(s,h,p,y)),l0(o),x}function l0(o){L.H=Xl;var s=ut!==null&&ut.next!==null;if(Va=0,It=ut=Ge=null,Vl=!1,tu=0,ko=null,s)throw Error(r(300));o===null||Zt||(o=o.dependencies,o!==null&&Bl(o)&&(Zt=!0))}function c0(o,s,h,p){Ge=o;var y=0;do{if(Oo&&(ko=null),tu=0,Oo=!1,25<=y)throw Error(r(301));if(y+=1,It=ut=null,o.updateQueue!=null){var x=o.updateQueue;x.lastEffect=null,x.events=null,x.stores=null,x.memoCache!=null&&(x.memoCache.index=0)}L.H=fR,x=s(h,p)}while(Oo);return x}function iR(){var o=L.H,s=o.useState()[0];return s=typeof s.then=="function"?nu(s):s,o=o.useState()[0],(ut!==null?ut.memoizedState:null)!==o&&(Ge.flags|=1024),s}function bd(){var o=Wl!==0;return Wl=0,o}function xd(o,s,h){s.updateQueue=o.updateQueue,s.flags&=-2053,o.lanes&=~h}function wd(o){if(Vl){for(o=o.memoizedState;o!==null;){var s=o.queue;s!==null&&(s.pending=null),o=o.next}Vl=!1}Va=0,It=ut=Ge=null,Oo=!1,tu=Wl=0,ko=null}function On(){var o={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return It===null?Ge.memoizedState=It=o:It=It.next=o,It}function Ft(){if(ut===null){var o=Ge.alternate;o=o!==null?o.memoizedState:null}else o=ut.next;var s=It===null?Ge.memoizedState:It.next;if(s!==null)It=s,ut=o;else{if(o===null)throw Ge.alternate===null?Error(r(467)):Error(r(310));ut=o,o={memoizedState:ut.memoizedState,baseState:ut.baseState,baseQueue:ut.baseQueue,queue:ut.queue,next:null},It===null?Ge.memoizedState=It=o:It=It.next=o}return It}function Sd(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function nu(o){var s=tu;return tu+=1,ko===null&&(ko=[]),o=r0(ko,o,s),s=Ge,(It===null?s.memoizedState:It.next)===null&&(s=s.alternate,L.H=s===null||s.memoizedState===null?j0:q0),o}function Gl(o){if(o!==null&&typeof o=="object"){if(typeof o.then=="function")return nu(o);if(o.$$typeof===R)return pn(o)}throw Error(r(438,String(o)))}function Ed(o){var s=null,h=Ge.updateQueue;if(h!==null&&(s=h.memoCache),s==null){var p=Ge.alternate;p!==null&&(p=p.updateQueue,p!==null&&(p=p.memoCache,p!=null&&(s={data:p.data.map(function(y){return y.slice()}),index:0})))}if(s==null&&(s={data:[],index:0}),h===null&&(h=Sd(),Ge.updateQueue=h),h.memoCache=s,h=s.data[s.index],h===void 0)for(h=s.data[s.index]=Array(o),p=0;p<o;p++)h[p]=B;return s.index++,h}function fa(o,s){return typeof s=="function"?s(o):s}function jl(o){var s=Ft();return _d(s,ut,o)}function _d(o,s,h){var p=o.queue;if(p===null)throw Error(r(311));p.lastRenderedReducer=h;var y=o.baseQueue,x=p.pending;if(x!==null){if(y!==null){var T=y.next;y.next=x.next,x.next=T}s.baseQueue=y=x,p.pending=null}if(x=o.baseState,y===null)o.memoizedState=x;else{s=y.next;var k=T=null,z=null,Y=s,le=!1;do{var fe=Y.lane&-536870913;if(fe!==Y.lane?(Ze&fe)===fe:(Va&fe)===fe){var Q=Y.revertLane;if(Q===0)z!==null&&(z=z.next={lane:0,revertLane:0,action:Y.action,hasEagerState:Y.hasEagerState,eagerState:Y.eagerState,next:null}),fe===Ao&&(le=!0);else if((Va&Q)===Q){Y=Y.next,Q===Ao&&(le=!0);continue}else fe={lane:0,revertLane:Y.revertLane,action:Y.action,hasEagerState:Y.hasEagerState,eagerState:Y.eagerState,next:null},z===null?(k=z=fe,T=x):z=z.next=fe,Ge.lanes|=Q,Xa|=Q;fe=Y.action,Fi&&h(x,fe),x=Y.hasEagerState?Y.eagerState:h(x,fe)}else Q={lane:fe,revertLane:Y.revertLane,action:Y.action,hasEagerState:Y.hasEagerState,eagerState:Y.eagerState,next:null},z===null?(k=z=Q,T=x):z=z.next=Q,Ge.lanes|=fe,Xa|=fe;Y=Y.next}while(Y!==null&&Y!==s);if(z===null?T=x:z.next=k,!zn(x,o.memoizedState)&&(Zt=!0,le&&(h=To,h!==null)))throw h;o.memoizedState=x,o.baseState=T,o.baseQueue=z,p.lastRenderedState=x}return y===null&&(p.lanes=0),[o.memoizedState,p.dispatch]}function Cd(o){var s=Ft(),h=s.queue;if(h===null)throw Error(r(311));h.lastRenderedReducer=o;var p=h.dispatch,y=h.pending,x=s.memoizedState;if(y!==null){h.pending=null;var T=y=y.next;do x=o(x,T.action),T=T.next;while(T!==y);zn(x,s.memoizedState)||(Zt=!0),s.memoizedState=x,s.baseQueue===null&&(s.baseState=x),h.lastRenderedState=x}return[x,p]}function f0(o,s,h){var p=Ge,y=Ft(),x=nt;if(x){if(h===void 0)throw Error(r(407));h=h()}else h=s();var T=!zn((ut||y).memoizedState,h);T&&(y.memoizedState=h,Zt=!0),y=y.queue;var k=p0.bind(null,p,y,o);if(ru(2048,8,k,[o]),y.getSnapshot!==s||T||It!==null&&It.memoizedState.tag&1){if(p.flags|=2048,No(9,ql(),d0.bind(null,p,y,h,s),null),dt===null)throw Error(r(349));x||(Va&124)!==0||h0(p,s,h)}return h}function h0(o,s,h){o.flags|=16384,o={getSnapshot:s,value:h},s=Ge.updateQueue,s===null?(s=Sd(),Ge.updateQueue=s,s.stores=[o]):(h=s.stores,h===null?s.stores=[o]:h.push(o))}function d0(o,s,h,p){s.value=h,s.getSnapshot=p,v0(s)&&m0(o)}function p0(o,s,h){return h(function(){v0(s)&&m0(o)})}function v0(o){var s=o.getSnapshot;o=o.value;try{var h=s();return!zn(o,h)}catch{return!0}}function m0(o){var s=Eo(o,2);s!==null&&jn(s,o,2)}function Rd(o){var s=On();if(typeof o=="function"){var h=o;if(o=h(),Fi){Lt(!0);try{h()}finally{Lt(!1)}}}return s.memoizedState=s.baseState=o,s.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:fa,lastRenderedState:o},s}function g0(o,s,h,p){return o.baseState=h,_d(o,ut,typeof p=="function"?p:fa)}function oR(o,s,h,p,y){if(Kl(o))throw Error(r(485));if(o=s.action,o!==null){var x={payload:y,action:o,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(T){x.listeners.push(T)}};L.T!==null?h(!0):x.isTransition=!1,p(x),h=s.pending,h===null?(x.next=s.pending=x,y0(s,x)):(x.next=h.next,s.pending=h.next=x)}}function y0(o,s){var h=s.action,p=s.payload,y=o.state;if(s.isTransition){var x=L.T,T={};L.T=T;try{var k=h(y,p),z=L.S;z!==null&&z(T,k),b0(o,s,k)}catch(Y){Ad(o,s,Y)}finally{L.T=x}}else try{x=h(y,p),b0(o,s,x)}catch(Y){Ad(o,s,Y)}}function b0(o,s,h){h!==null&&typeof h=="object"&&typeof h.then=="function"?h.then(function(p){x0(o,s,p)},function(p){return Ad(o,s,p)}):x0(o,s,h)}function x0(o,s,h){s.status="fulfilled",s.value=h,w0(s),o.state=h,s=o.pending,s!==null&&(h=s.next,h===s?o.pending=null:(h=h.next,s.next=h,y0(o,h)))}function Ad(o,s,h){var p=o.pending;if(o.pending=null,p!==null){p=p.next;do s.status="rejected",s.reason=h,w0(s),s=s.next;while(s!==p)}o.action=null}function w0(o){o=o.listeners;for(var s=0;s<o.length;s++)(0,o[s])()}function S0(o,s){return s}function E0(o,s){if(nt){var h=dt.formState;if(h!==null){e:{var p=Ge;if(nt){if(Rt){t:{for(var y=Rt,x=Nr;y.nodeType!==8;){if(!x){y=null;break t}if(y=Er(y.nextSibling),y===null){y=null;break t}}x=y.data,y=x==="F!"||x==="F"?y:null}if(y){Rt=Er(y.nextSibling),p=y.data==="F!";break e}}ki(p)}p=!1}p&&(s=h[0])}}return h=On(),h.memoizedState=h.baseState=s,p={pending:null,lanes:0,dispatch:null,lastRenderedReducer:S0,lastRenderedState:s},h.queue=p,h=V0.bind(null,Ge,p),p.dispatch=h,p=Rd(!1),x=Nd.bind(null,Ge,!1,p.queue),p=On(),y={state:s,dispatch:null,action:o,pending:null},p.queue=y,h=oR.bind(null,Ge,y,x,h),y.dispatch=h,p.memoizedState=o,[s,h,!1]}function _0(o){var s=Ft();return C0(s,ut,o)}function C0(o,s,h){if(s=_d(o,s,S0)[0],o=jl(fa)[0],typeof s=="object"&&s!==null&&typeof s.then=="function")try{var p=nu(s)}catch(T){throw T===Zs?zl:T}else p=s;s=Ft();var y=s.queue,x=y.dispatch;return h!==s.memoizedState&&(Ge.flags|=2048,No(9,ql(),sR.bind(null,y,h),null)),[p,x,o]}function sR(o,s){o.action=s}function R0(o){var s=Ft(),h=ut;if(h!==null)return C0(s,h,o);Ft(),s=s.memoizedState,h=Ft();var p=h.queue.dispatch;return h.memoizedState=o,[s,p,!1]}function No(o,s,h,p){return o={tag:o,create:h,deps:p,inst:s,next:null},s=Ge.updateQueue,s===null&&(s=Sd(),Ge.updateQueue=s),h=s.lastEffect,h===null?s.lastEffect=o.next=o:(p=h.next,h.next=o,o.next=p,s.lastEffect=o),o}function ql(){return{destroy:void 0,resource:void 0}}function A0(){return Ft().memoizedState}function $l(o,s,h,p){var y=On();p=p===void 0?null:p,Ge.flags|=o,y.memoizedState=No(1|s,ql(),h,p)}function ru(o,s,h,p){var y=Ft();p=p===void 0?null:p;var x=y.memoizedState.inst;ut!==null&&p!==null&&gd(p,ut.memoizedState.deps)?y.memoizedState=No(s,x,h,p):(Ge.flags|=o,y.memoizedState=No(1|s,x,h,p))}function T0(o,s){$l(8390656,8,o,s)}function D0(o,s){ru(2048,8,o,s)}function O0(o,s){return ru(4,2,o,s)}function k0(o,s){return ru(4,4,o,s)}function N0(o,s){if(typeof s=="function"){o=o();var h=s(o);return function(){typeof h=="function"?h():s(null)}}if(s!=null)return o=o(),s.current=o,function(){s.current=null}}function M0(o,s,h){h=h!=null?h.concat([o]):null,ru(4,4,N0.bind(null,s,o),h)}function Td(){}function I0(o,s){var h=Ft();s=s===void 0?null:s;var p=h.memoizedState;return s!==null&&gd(s,p[1])?p[0]:(h.memoizedState=[o,s],o)}function F0(o,s){var h=Ft();s=s===void 0?null:s;var p=h.memoizedState;if(s!==null&&gd(s,p[1]))return p[0];if(p=o(),Fi){Lt(!0);try{o()}finally{Lt(!1)}}return h.memoizedState=[p,s],p}function Dd(o,s,h){return h===void 0||(Va&1073741824)!==0?o.memoizedState=s:(o.memoizedState=h,o=Lb(),Ge.lanes|=o,Xa|=o,h)}function B0(o,s,h,p){return zn(h,s)?h:Do.current!==null?(o=Dd(o,h,p),zn(o,s)||(Zt=!0),o):(Va&42)===0?(Zt=!0,o.memoizedState=h):(o=Lb(),Ge.lanes|=o,Xa|=o,s)}function P0(o,s,h,p,y){var x=W.p;W.p=x!==0&&8>x?x:8;var T=L.T,k={};L.T=k,Nd(o,!1,s,h);try{var z=y(),Y=L.S;if(Y!==null&&Y(k,z),z!==null&&typeof z=="object"&&typeof z.then=="function"){var le=rR(z,p);au(o,s,le,Gn(o))}else au(o,s,p,Gn(o))}catch(fe){au(o,s,{then:function(){},status:"rejected",reason:fe},Gn())}finally{W.p=x,L.T=T}}function uR(){}function Od(o,s,h,p){if(o.tag!==5)throw Error(r(476));var y=L0(o).queue;P0(o,y,s,$,h===null?uR:function(){return z0(o),h(p)})}function L0(o){var s=o.memoizedState;if(s!==null)return s;s={memoizedState:$,baseState:$,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:fa,lastRenderedState:$},next:null};var h={};return s.next={memoizedState:h,baseState:h,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:fa,lastRenderedState:h},next:null},o.memoizedState=s,o=o.alternate,o!==null&&(o.memoizedState=s),s}function z0(o){var s=L0(o).next.queue;au(o,s,{},Gn())}function kd(){return pn(Su)}function U0(){return Ft().memoizedState}function H0(){return Ft().memoizedState}function lR(o){for(var s=o.return;s!==null;){switch(s.tag){case 24:case 3:var h=Gn();o=Ua(h);var p=Ha(s,o,h);p!==null&&(jn(p,s,h),Qs(p,s,h)),s={cache:sd()},o.payload=s;return}s=s.return}}function cR(o,s,h){var p=Gn();h={lane:p,revertLane:0,action:h,hasEagerState:!1,eagerState:null,next:null},Kl(o)?W0(s,h):(h=Yh(o,s,h,p),h!==null&&(jn(h,o,p),G0(h,s,p)))}function V0(o,s,h){var p=Gn();au(o,s,h,p)}function au(o,s,h,p){var y={lane:p,revertLane:0,action:h,hasEagerState:!1,eagerState:null,next:null};if(Kl(o))W0(s,y);else{var x=o.alternate;if(o.lanes===0&&(x===null||x.lanes===0)&&(x=s.lastRenderedReducer,x!==null))try{var T=s.lastRenderedState,k=x(T,h);if(y.hasEagerState=!0,y.eagerState=k,zn(k,T))return kl(o,s,y,0),dt===null&&Ol(),!1}catch{}finally{}if(h=Yh(o,s,y,p),h!==null)return jn(h,o,p),G0(h,s,p),!0}return!1}function Nd(o,s,h,p){if(p={lane:2,revertLane:cp(),action:p,hasEagerState:!1,eagerState:null,next:null},Kl(o)){if(s)throw Error(r(479))}else s=Yh(o,h,p,2),s!==null&&jn(s,o,2)}function Kl(o){var s=o.alternate;return o===Ge||s!==null&&s===Ge}function W0(o,s){Oo=Vl=!0;var h=o.pending;h===null?s.next=s:(s.next=h.next,h.next=s),o.pending=s}function G0(o,s,h){if((h&4194048)!==0){var p=s.lanes;p&=o.pendingLanes,h|=p,s.lanes=h,Qg(o,h)}}var Xl={readContext:pn,use:Gl,useCallback:Ot,useContext:Ot,useEffect:Ot,useImperativeHandle:Ot,useLayoutEffect:Ot,useInsertionEffect:Ot,useMemo:Ot,useReducer:Ot,useRef:Ot,useState:Ot,useDebugValue:Ot,useDeferredValue:Ot,useTransition:Ot,useSyncExternalStore:Ot,useId:Ot,useHostTransitionStatus:Ot,useFormState:Ot,useActionState:Ot,useOptimistic:Ot,useMemoCache:Ot,useCacheRefresh:Ot},j0={readContext:pn,use:Gl,useCallback:function(o,s){return On().memoizedState=[o,s===void 0?null:s],o},useContext:pn,useEffect:T0,useImperativeHandle:function(o,s,h){h=h!=null?h.concat([o]):null,$l(4194308,4,N0.bind(null,s,o),h)},useLayoutEffect:function(o,s){return $l(4194308,4,o,s)},useInsertionEffect:function(o,s){$l(4,2,o,s)},useMemo:function(o,s){var h=On();s=s===void 0?null:s;var p=o();if(Fi){Lt(!0);try{o()}finally{Lt(!1)}}return h.memoizedState=[p,s],p},useReducer:function(o,s,h){var p=On();if(h!==void 0){var y=h(s);if(Fi){Lt(!0);try{h(s)}finally{Lt(!1)}}}else y=s;return p.memoizedState=p.baseState=y,o={pending:null,lanes:0,dispatch:null,lastRenderedReducer:o,lastRenderedState:y},p.queue=o,o=o.dispatch=cR.bind(null,Ge,o),[p.memoizedState,o]},useRef:function(o){var s=On();return o={current:o},s.memoizedState=o},useState:function(o){o=Rd(o);var s=o.queue,h=V0.bind(null,Ge,s);return s.dispatch=h,[o.memoizedState,h]},useDebugValue:Td,useDeferredValue:function(o,s){var h=On();return Dd(h,o,s)},useTransition:function(){var o=Rd(!1);return o=P0.bind(null,Ge,o.queue,!0,!1),On().memoizedState=o,[!1,o]},useSyncExternalStore:function(o,s,h){var p=Ge,y=On();if(nt){if(h===void 0)throw Error(r(407));h=h()}else{if(h=s(),dt===null)throw Error(r(349));(Ze&124)!==0||h0(p,s,h)}y.memoizedState=h;var x={value:h,getSnapshot:s};return y.queue=x,T0(p0.bind(null,p,x,o),[o]),p.flags|=2048,No(9,ql(),d0.bind(null,p,x,h,s),null),h},useId:function(){var o=On(),s=dt.identifierPrefix;if(nt){var h=ua,p=sa;h=(p&~(1<<32-an(p)-1)).toString(32)+h,s="«"+s+"R"+h,h=Wl++,0<h&&(s+="H"+h.toString(32)),s+="»"}else h=aR++,s="«"+s+"r"+h.toString(32)+"»";return o.memoizedState=s},useHostTransitionStatus:kd,useFormState:E0,useActionState:E0,useOptimistic:function(o){var s=On();s.memoizedState=s.baseState=o;var h={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return s.queue=h,s=Nd.bind(null,Ge,!0,h),h.dispatch=s,[o,s]},useMemoCache:Ed,useCacheRefresh:function(){return On().memoizedState=lR.bind(null,Ge)}},q0={readContext:pn,use:Gl,useCallback:I0,useContext:pn,useEffect:D0,useImperativeHandle:M0,useInsertionEffect:O0,useLayoutEffect:k0,useMemo:F0,useReducer:jl,useRef:A0,useState:function(){return jl(fa)},useDebugValue:Td,useDeferredValue:function(o,s){var h=Ft();return B0(h,ut.memoizedState,o,s)},useTransition:function(){var o=jl(fa)[0],s=Ft().memoizedState;return[typeof o=="boolean"?o:nu(o),s]},useSyncExternalStore:f0,useId:U0,useHostTransitionStatus:kd,useFormState:_0,useActionState:_0,useOptimistic:function(o,s){var h=Ft();return g0(h,ut,o,s)},useMemoCache:Ed,useCacheRefresh:H0},fR={readContext:pn,use:Gl,useCallback:I0,useContext:pn,useEffect:D0,useImperativeHandle:M0,useInsertionEffect:O0,useLayoutEffect:k0,useMemo:F0,useReducer:Cd,useRef:A0,useState:function(){return Cd(fa)},useDebugValue:Td,useDeferredValue:function(o,s){var h=Ft();return ut===null?Dd(h,o,s):B0(h,ut.memoizedState,o,s)},useTransition:function(){var o=Cd(fa)[0],s=Ft().memoizedState;return[typeof o=="boolean"?o:nu(o),s]},useSyncExternalStore:f0,useId:U0,useHostTransitionStatus:kd,useFormState:R0,useActionState:R0,useOptimistic:function(o,s){var h=Ft();return ut!==null?g0(h,ut,o,s):(h.baseState=o,[o,h.queue.dispatch])},useMemoCache:Ed,useCacheRefresh:H0},Mo=null,iu=0;function Zl(o){var s=iu;return iu+=1,Mo===null&&(Mo=[]),r0(Mo,o,s)}function ou(o,s){s=s.props.ref,o.ref=s!==void 0?s:null}function Yl(o,s){throw s.$$typeof===v?Error(r(525)):(o=Object.prototype.toString.call(s),Error(r(31,o==="[object Object]"?"object with keys {"+Object.keys(s).join(", ")+"}":o)))}function $0(o){var s=o._init;return s(o._payload)}function K0(o){function s(K,G){if(o){var X=K.deletions;X===null?(K.deletions=[G],K.flags|=16):X.push(G)}}function h(K,G){if(!o)return null;for(;G!==null;)s(K,G),G=G.sibling;return null}function p(K){for(var G=new Map;K!==null;)K.key!==null?G.set(K.key,K):G.set(K.index,K),K=K.sibling;return G}function y(K,G){return K=oa(K,G),K.index=0,K.sibling=null,K}function x(K,G,X){return K.index=X,o?(X=K.alternate,X!==null?(X=X.index,X<G?(K.flags|=67108866,G):X):(K.flags|=67108866,G)):(K.flags|=1048576,G)}function T(K){return o&&K.alternate===null&&(K.flags|=67108866),K}function k(K,G,X,ce){return G===null||G.tag!==6?(G=Jh(X,K.mode,ce),G.return=K,G):(G=y(G,X),G.return=K,G)}function z(K,G,X,ce){var xe=X.type;return xe===b?le(K,G,X.props.children,ce,X.key):G!==null&&(G.elementType===xe||typeof xe=="object"&&xe!==null&&xe.$$typeof===F&&$0(xe)===G.type)?(G=y(G,X.props),ou(G,X),G.return=K,G):(G=Ml(X.type,X.key,X.props,null,K.mode,ce),ou(G,X),G.return=K,G)}function Y(K,G,X,ce){return G===null||G.tag!==4||G.stateNode.containerInfo!==X.containerInfo||G.stateNode.implementation!==X.implementation?(G=ed(X,K.mode,ce),G.return=K,G):(G=y(G,X.children||[]),G.return=K,G)}function le(K,G,X,ce,xe){return G===null||G.tag!==7?(G=Ai(X,K.mode,ce,xe),G.return=K,G):(G=y(G,X),G.return=K,G)}function fe(K,G,X){if(typeof G=="string"&&G!==""||typeof G=="number"||typeof G=="bigint")return G=Jh(""+G,K.mode,X),G.return=K,G;if(typeof G=="object"&&G!==null){switch(G.$$typeof){case m:return X=Ml(G.type,G.key,G.props,null,K.mode,X),ou(X,G),X.return=K,X;case g:return G=ed(G,K.mode,X),G.return=K,G;case F:var ce=G._init;return G=ce(G._payload),fe(K,G,X)}if(te(G)||U(G))return G=Ai(G,K.mode,X,null),G.return=K,G;if(typeof G.then=="function")return fe(K,Zl(G),X);if(G.$$typeof===R)return fe(K,Pl(K,G),X);Yl(K,G)}return null}function Q(K,G,X,ce){var xe=G!==null?G.key:null;if(typeof X=="string"&&X!==""||typeof X=="number"||typeof X=="bigint")return xe!==null?null:k(K,G,""+X,ce);if(typeof X=="object"&&X!==null){switch(X.$$typeof){case m:return X.key===xe?z(K,G,X,ce):null;case g:return X.key===xe?Y(K,G,X,ce):null;case F:return xe=X._init,X=xe(X._payload),Q(K,G,X,ce)}if(te(X)||U(X))return xe!==null?null:le(K,G,X,ce,null);if(typeof X.then=="function")return Q(K,G,Zl(X),ce);if(X.$$typeof===R)return Q(K,G,Pl(K,X),ce);Yl(K,X)}return null}function re(K,G,X,ce,xe){if(typeof ce=="string"&&ce!==""||typeof ce=="number"||typeof ce=="bigint")return K=K.get(X)||null,k(G,K,""+ce,xe);if(typeof ce=="object"&&ce!==null){switch(ce.$$typeof){case m:return K=K.get(ce.key===null?X:ce.key)||null,z(G,K,ce,xe);case g:return K=K.get(ce.key===null?X:ce.key)||null,Y(G,K,ce,xe);case F:var je=ce._init;return ce=je(ce._payload),re(K,G,X,ce,xe)}if(te(ce)||U(ce))return K=K.get(X)||null,le(G,K,ce,xe,null);if(typeof ce.then=="function")return re(K,G,X,Zl(ce),xe);if(ce.$$typeof===R)return re(K,G,X,Pl(G,ce),xe);Yl(G,ce)}return null}function Me(K,G,X,ce){for(var xe=null,je=null,Te=G,ke=G=0,Qt=null;Te!==null&&ke<X.length;ke++){Te.index>ke?(Qt=Te,Te=null):Qt=Te.sibling;var Je=Q(K,Te,X[ke],ce);if(Je===null){Te===null&&(Te=Qt);break}o&&Te&&Je.alternate===null&&s(K,Te),G=x(Je,G,ke),je===null?xe=Je:je.sibling=Je,je=Je,Te=Qt}if(ke===X.length)return h(K,Te),nt&&Di(K,ke),xe;if(Te===null){for(;ke<X.length;ke++)Te=fe(K,X[ke],ce),Te!==null&&(G=x(Te,G,ke),je===null?xe=Te:je.sibling=Te,je=Te);return nt&&Di(K,ke),xe}for(Te=p(Te);ke<X.length;ke++)Qt=re(Te,K,ke,X[ke],ce),Qt!==null&&(o&&Qt.alternate!==null&&Te.delete(Qt.key===null?ke:Qt.key),G=x(Qt,G,ke),je===null?xe=Qt:je.sibling=Qt,je=Qt);return o&&Te.forEach(function(ai){return s(K,ai)}),nt&&Di(K,ke),xe}function Oe(K,G,X,ce){if(X==null)throw Error(r(151));for(var xe=null,je=null,Te=G,ke=G=0,Qt=null,Je=X.next();Te!==null&&!Je.done;ke++,Je=X.next()){Te.index>ke?(Qt=Te,Te=null):Qt=Te.sibling;var ai=Q(K,Te,Je.value,ce);if(ai===null){Te===null&&(Te=Qt);break}o&&Te&&ai.alternate===null&&s(K,Te),G=x(ai,G,ke),je===null?xe=ai:je.sibling=ai,je=ai,Te=Qt}if(Je.done)return h(K,Te),nt&&Di(K,ke),xe;if(Te===null){for(;!Je.done;ke++,Je=X.next())Je=fe(K,Je.value,ce),Je!==null&&(G=x(Je,G,ke),je===null?xe=Je:je.sibling=Je,je=Je);return nt&&Di(K,ke),xe}for(Te=p(Te);!Je.done;ke++,Je=X.next())Je=re(Te,K,ke,Je.value,ce),Je!==null&&(o&&Je.alternate!==null&&Te.delete(Je.key===null?ke:Je.key),G=x(Je,G,ke),je===null?xe=Je:je.sibling=Je,je=Je);return o&&Te.forEach(function(hA){return s(K,hA)}),nt&&Di(K,ke),xe}function ct(K,G,X,ce){if(typeof X=="object"&&X!==null&&X.type===b&&X.key===null&&(X=X.props.children),typeof X=="object"&&X!==null){switch(X.$$typeof){case m:e:{for(var xe=X.key;G!==null;){if(G.key===xe){if(xe=X.type,xe===b){if(G.tag===7){h(K,G.sibling),ce=y(G,X.props.children),ce.return=K,K=ce;break e}}else if(G.elementType===xe||typeof xe=="object"&&xe!==null&&xe.$$typeof===F&&$0(xe)===G.type){h(K,G.sibling),ce=y(G,X.props),ou(ce,X),ce.return=K,K=ce;break e}h(K,G);break}else s(K,G);G=G.sibling}X.type===b?(ce=Ai(X.props.children,K.mode,ce,X.key),ce.return=K,K=ce):(ce=Ml(X.type,X.key,X.props,null,K.mode,ce),ou(ce,X),ce.return=K,K=ce)}return T(K);case g:e:{for(xe=X.key;G!==null;){if(G.key===xe)if(G.tag===4&&G.stateNode.containerInfo===X.containerInfo&&G.stateNode.implementation===X.implementation){h(K,G.sibling),ce=y(G,X.children||[]),ce.return=K,K=ce;break e}else{h(K,G);break}else s(K,G);G=G.sibling}ce=ed(X,K.mode,ce),ce.return=K,K=ce}return T(K);case F:return xe=X._init,X=xe(X._payload),ct(K,G,X,ce)}if(te(X))return Me(K,G,X,ce);if(U(X)){if(xe=U(X),typeof xe!="function")throw Error(r(150));return X=xe.call(X),Oe(K,G,X,ce)}if(typeof X.then=="function")return ct(K,G,Zl(X),ce);if(X.$$typeof===R)return ct(K,G,Pl(K,X),ce);Yl(K,X)}return typeof X=="string"&&X!==""||typeof X=="number"||typeof X=="bigint"?(X=""+X,G!==null&&G.tag===6?(h(K,G.sibling),ce=y(G,X),ce.return=K,K=ce):(h(K,G),ce=Jh(X,K.mode,ce),ce.return=K,K=ce),T(K)):h(K,G)}return function(K,G,X,ce){try{iu=0;var xe=ct(K,G,X,ce);return Mo=null,xe}catch(Te){if(Te===Zs||Te===zl)throw Te;var je=Un(29,Te,null,K.mode);return je.lanes=ce,je.return=K,je}finally{}}}var Io=K0(!0),X0=K0(!1),ur=j(null),Mr=null;function Wa(o){var s=o.alternate;oe(Ut,Ut.current&1),oe(ur,o),Mr===null&&(s===null||Do.current!==null||s.memoizedState!==null)&&(Mr=o)}function Z0(o){if(o.tag===22){if(oe(Ut,Ut.current),oe(ur,o),Mr===null){var s=o.alternate;s!==null&&s.memoizedState!==null&&(Mr=o)}}else Ga()}function Ga(){oe(Ut,Ut.current),oe(ur,ur.current)}function ha(o){ie(ur),Mr===o&&(Mr=null),ie(Ut)}var Ut=j(0);function Ql(o){for(var s=o;s!==null;){if(s.tag===13){var h=s.memoizedState;if(h!==null&&(h=h.dehydrated,h===null||h.data==="$?"||Sp(h)))return s}else if(s.tag===19&&s.memoizedProps.revealOrder!==void 0){if((s.flags&128)!==0)return s}else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===o)break;for(;s.sibling===null;){if(s.return===null||s.return===o)return null;s=s.return}s.sibling.return=s.return,s=s.sibling}return null}function Md(o,s,h,p){s=o.memoizedState,h=h(p,s),h=h==null?s:d({},s,h),o.memoizedState=h,o.lanes===0&&(o.updateQueue.baseState=h)}var Id={enqueueSetState:function(o,s,h){o=o._reactInternals;var p=Gn(),y=Ua(p);y.payload=s,h!=null&&(y.callback=h),s=Ha(o,y,p),s!==null&&(jn(s,o,p),Qs(s,o,p))},enqueueReplaceState:function(o,s,h){o=o._reactInternals;var p=Gn(),y=Ua(p);y.tag=1,y.payload=s,h!=null&&(y.callback=h),s=Ha(o,y,p),s!==null&&(jn(s,o,p),Qs(s,o,p))},enqueueForceUpdate:function(o,s){o=o._reactInternals;var h=Gn(),p=Ua(h);p.tag=2,s!=null&&(p.callback=s),s=Ha(o,p,h),s!==null&&(jn(s,o,h),Qs(s,o,h))}};function Y0(o,s,h,p,y,x,T){return o=o.stateNode,typeof o.shouldComponentUpdate=="function"?o.shouldComponentUpdate(p,x,T):s.prototype&&s.prototype.isPureReactComponent?!Vs(h,p)||!Vs(y,x):!0}function Q0(o,s,h,p){o=s.state,typeof s.componentWillReceiveProps=="function"&&s.componentWillReceiveProps(h,p),typeof s.UNSAFE_componentWillReceiveProps=="function"&&s.UNSAFE_componentWillReceiveProps(h,p),s.state!==o&&Id.enqueueReplaceState(s,s.state,null)}function Bi(o,s){var h=s;if("ref"in s){h={};for(var p in s)p!=="ref"&&(h[p]=s[p])}if(o=o.defaultProps){h===s&&(h=d({},h));for(var y in o)h[y]===void 0&&(h[y]=o[y])}return h}var Jl=typeof reportError=="function"?reportError:function(o){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var s=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof o=="object"&&o!==null&&typeof o.message=="string"?String(o.message):String(o),error:o});if(!window.dispatchEvent(s))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",o);return}console.error(o)};function J0(o){Jl(o)}function eb(o){console.error(o)}function tb(o){Jl(o)}function ec(o,s){try{var h=o.onUncaughtError;h(s.value,{componentStack:s.stack})}catch(p){setTimeout(function(){throw p})}}function nb(o,s,h){try{var p=o.onCaughtError;p(h.value,{componentStack:h.stack,errorBoundary:s.tag===1?s.stateNode:null})}catch(y){setTimeout(function(){throw y})}}function Fd(o,s,h){return h=Ua(h),h.tag=3,h.payload={element:null},h.callback=function(){ec(o,s)},h}function rb(o){return o=Ua(o),o.tag=3,o}function ab(o,s,h,p){var y=h.type.getDerivedStateFromError;if(typeof y=="function"){var x=p.value;o.payload=function(){return y(x)},o.callback=function(){nb(s,h,p)}}var T=h.stateNode;T!==null&&typeof T.componentDidCatch=="function"&&(o.callback=function(){nb(s,h,p),typeof y!="function"&&(Za===null?Za=new Set([this]):Za.add(this));var k=p.stack;this.componentDidCatch(p.value,{componentStack:k!==null?k:""})})}function hR(o,s,h,p,y){if(h.flags|=32768,p!==null&&typeof p=="object"&&typeof p.then=="function"){if(s=h.alternate,s!==null&&$s(s,h,y,!0),h=ur.current,h!==null){switch(h.tag){case 13:return Mr===null?ip():h.alternate===null&&At===0&&(At=3),h.flags&=-257,h.flags|=65536,h.lanes=y,p===cd?h.flags|=16384:(s=h.updateQueue,s===null?h.updateQueue=new Set([p]):s.add(p),sp(o,p,y)),!1;case 22:return h.flags|=65536,p===cd?h.flags|=16384:(s=h.updateQueue,s===null?(s={transitions:null,markerInstances:null,retryQueue:new Set([p])},h.updateQueue=s):(h=s.retryQueue,h===null?s.retryQueue=new Set([p]):h.add(p)),sp(o,p,y)),!1}throw Error(r(435,h.tag))}return sp(o,p,y),ip(),!1}if(nt)return s=ur.current,s!==null?((s.flags&65536)===0&&(s.flags|=256),s.flags|=65536,s.lanes=y,p!==rd&&(o=Error(r(422),{cause:p}),qs(ar(o,h)))):(p!==rd&&(s=Error(r(423),{cause:p}),qs(ar(s,h))),o=o.current.alternate,o.flags|=65536,y&=-y,o.lanes|=y,p=ar(p,h),y=Fd(o.stateNode,p,y),dd(o,y),At!==4&&(At=2)),!1;var x=Error(r(520),{cause:p});if(x=ar(x,h),du===null?du=[x]:du.push(x),At!==4&&(At=2),s===null)return!0;p=ar(p,h),h=s;do{switch(h.tag){case 3:return h.flags|=65536,o=y&-y,h.lanes|=o,o=Fd(h.stateNode,p,o),dd(h,o),!1;case 1:if(s=h.type,x=h.stateNode,(h.flags&128)===0&&(typeof s.getDerivedStateFromError=="function"||x!==null&&typeof x.componentDidCatch=="function"&&(Za===null||!Za.has(x))))return h.flags|=65536,y&=-y,h.lanes|=y,y=rb(y),ab(y,o,h,p),dd(h,y),!1}h=h.return}while(h!==null);return!1}var ib=Error(r(461)),Zt=!1;function on(o,s,h,p){s.child=o===null?X0(s,null,h,p):Io(s,o.child,h,p)}function ob(o,s,h,p,y){h=h.render;var x=s.ref;if("ref"in p){var T={};for(var k in p)k!=="ref"&&(T[k]=p[k])}else T=p;return Mi(s),p=yd(o,s,h,T,x,y),k=bd(),o!==null&&!Zt?(xd(o,s,y),da(o,s,y)):(nt&&k&&td(s),s.flags|=1,on(o,s,p,y),s.child)}function sb(o,s,h,p,y){if(o===null){var x=h.type;return typeof x=="function"&&!Qh(x)&&x.defaultProps===void 0&&h.compare===null?(s.tag=15,s.type=x,ub(o,s,x,p,y)):(o=Ml(h.type,null,p,s,s.mode,y),o.ref=s.ref,o.return=s,s.child=o)}if(x=o.child,!Wd(o,y)){var T=x.memoizedProps;if(h=h.compare,h=h!==null?h:Vs,h(T,p)&&o.ref===s.ref)return da(o,s,y)}return s.flags|=1,o=oa(x,p),o.ref=s.ref,o.return=s,s.child=o}function ub(o,s,h,p,y){if(o!==null){var x=o.memoizedProps;if(Vs(x,p)&&o.ref===s.ref)if(Zt=!1,s.pendingProps=p=x,Wd(o,y))(o.flags&131072)!==0&&(Zt=!0);else return s.lanes=o.lanes,da(o,s,y)}return Bd(o,s,h,p,y)}function lb(o,s,h){var p=s.pendingProps,y=p.children,x=o!==null?o.memoizedState:null;if(p.mode==="hidden"){if((s.flags&128)!==0){if(p=x!==null?x.baseLanes|h:h,o!==null){for(y=s.child=o.child,x=0;y!==null;)x=x|y.lanes|y.childLanes,y=y.sibling;s.childLanes=x&~p}else s.childLanes=0,s.child=null;return cb(o,s,p,h)}if((h&536870912)!==0)s.memoizedState={baseLanes:0,cachePool:null},o!==null&&Ll(s,x!==null?x.cachePool:null),x!==null?u0(s,x):vd(),Z0(s);else return s.lanes=s.childLanes=536870912,cb(o,s,x!==null?x.baseLanes|h:h,h)}else x!==null?(Ll(s,x.cachePool),u0(s,x),Ga(),s.memoizedState=null):(o!==null&&Ll(s,null),vd(),Ga());return on(o,s,y,h),s.child}function cb(o,s,h,p){var y=ld();return y=y===null?null:{parent:zt._currentValue,pool:y},s.memoizedState={baseLanes:h,cachePool:y},o!==null&&Ll(s,null),vd(),Z0(s),o!==null&&$s(o,s,p,!0),null}function tc(o,s){var h=s.ref;if(h===null)o!==null&&o.ref!==null&&(s.flags|=4194816);else{if(typeof h!="function"&&typeof h!="object")throw Error(r(284));(o===null||o.ref!==h)&&(s.flags|=4194816)}}function Bd(o,s,h,p,y){return Mi(s),h=yd(o,s,h,p,void 0,y),p=bd(),o!==null&&!Zt?(xd(o,s,y),da(o,s,y)):(nt&&p&&td(s),s.flags|=1,on(o,s,h,y),s.child)}function fb(o,s,h,p,y,x){return Mi(s),s.updateQueue=null,h=c0(s,p,h,y),l0(o),p=bd(),o!==null&&!Zt?(xd(o,s,x),da(o,s,x)):(nt&&p&&td(s),s.flags|=1,on(o,s,h,x),s.child)}function hb(o,s,h,p,y){if(Mi(s),s.stateNode===null){var x=_o,T=h.contextType;typeof T=="object"&&T!==null&&(x=pn(T)),x=new h(p,x),s.memoizedState=x.state!==null&&x.state!==void 0?x.state:null,x.updater=Id,s.stateNode=x,x._reactInternals=s,x=s.stateNode,x.props=p,x.state=s.memoizedState,x.refs={},fd(s),T=h.contextType,x.context=typeof T=="object"&&T!==null?pn(T):_o,x.state=s.memoizedState,T=h.getDerivedStateFromProps,typeof T=="function"&&(Md(s,h,T,p),x.state=s.memoizedState),typeof h.getDerivedStateFromProps=="function"||typeof x.getSnapshotBeforeUpdate=="function"||typeof x.UNSAFE_componentWillMount!="function"&&typeof x.componentWillMount!="function"||(T=x.state,typeof x.componentWillMount=="function"&&x.componentWillMount(),typeof x.UNSAFE_componentWillMount=="function"&&x.UNSAFE_componentWillMount(),T!==x.state&&Id.enqueueReplaceState(x,x.state,null),eu(s,p,x,y),Js(),x.state=s.memoizedState),typeof x.componentDidMount=="function"&&(s.flags|=4194308),p=!0}else if(o===null){x=s.stateNode;var k=s.memoizedProps,z=Bi(h,k);x.props=z;var Y=x.context,le=h.contextType;T=_o,typeof le=="object"&&le!==null&&(T=pn(le));var fe=h.getDerivedStateFromProps;le=typeof fe=="function"||typeof x.getSnapshotBeforeUpdate=="function",k=s.pendingProps!==k,le||typeof x.UNSAFE_componentWillReceiveProps!="function"&&typeof x.componentWillReceiveProps!="function"||(k||Y!==T)&&Q0(s,x,p,T),za=!1;var Q=s.memoizedState;x.state=Q,eu(s,p,x,y),Js(),Y=s.memoizedState,k||Q!==Y||za?(typeof fe=="function"&&(Md(s,h,fe,p),Y=s.memoizedState),(z=za||Y0(s,h,z,p,Q,Y,T))?(le||typeof x.UNSAFE_componentWillMount!="function"&&typeof x.componentWillMount!="function"||(typeof x.componentWillMount=="function"&&x.componentWillMount(),typeof x.UNSAFE_componentWillMount=="function"&&x.UNSAFE_componentWillMount()),typeof x.componentDidMount=="function"&&(s.flags|=4194308)):(typeof x.componentDidMount=="function"&&(s.flags|=4194308),s.memoizedProps=p,s.memoizedState=Y),x.props=p,x.state=Y,x.context=T,p=z):(typeof x.componentDidMount=="function"&&(s.flags|=4194308),p=!1)}else{x=s.stateNode,hd(o,s),T=s.memoizedProps,le=Bi(h,T),x.props=le,fe=s.pendingProps,Q=x.context,Y=h.contextType,z=_o,typeof Y=="object"&&Y!==null&&(z=pn(Y)),k=h.getDerivedStateFromProps,(Y=typeof k=="function"||typeof x.getSnapshotBeforeUpdate=="function")||typeof x.UNSAFE_componentWillReceiveProps!="function"&&typeof x.componentWillReceiveProps!="function"||(T!==fe||Q!==z)&&Q0(s,x,p,z),za=!1,Q=s.memoizedState,x.state=Q,eu(s,p,x,y),Js();var re=s.memoizedState;T!==fe||Q!==re||za||o!==null&&o.dependencies!==null&&Bl(o.dependencies)?(typeof k=="function"&&(Md(s,h,k,p),re=s.memoizedState),(le=za||Y0(s,h,le,p,Q,re,z)||o!==null&&o.dependencies!==null&&Bl(o.dependencies))?(Y||typeof x.UNSAFE_componentWillUpdate!="function"&&typeof x.componentWillUpdate!="function"||(typeof x.componentWillUpdate=="function"&&x.componentWillUpdate(p,re,z),typeof x.UNSAFE_componentWillUpdate=="function"&&x.UNSAFE_componentWillUpdate(p,re,z)),typeof x.componentDidUpdate=="function"&&(s.flags|=4),typeof x.getSnapshotBeforeUpdate=="function"&&(s.flags|=1024)):(typeof x.componentDidUpdate!="function"||T===o.memoizedProps&&Q===o.memoizedState||(s.flags|=4),typeof x.getSnapshotBeforeUpdate!="function"||T===o.memoizedProps&&Q===o.memoizedState||(s.flags|=1024),s.memoizedProps=p,s.memoizedState=re),x.props=p,x.state=re,x.context=z,p=le):(typeof x.componentDidUpdate!="function"||T===o.memoizedProps&&Q===o.memoizedState||(s.flags|=4),typeof x.getSnapshotBeforeUpdate!="function"||T===o.memoizedProps&&Q===o.memoizedState||(s.flags|=1024),p=!1)}return x=p,tc(o,s),p=(s.flags&128)!==0,x||p?(x=s.stateNode,h=p&&typeof h.getDerivedStateFromError!="function"?null:x.render(),s.flags|=1,o!==null&&p?(s.child=Io(s,o.child,null,y),s.child=Io(s,null,h,y)):on(o,s,h,y),s.memoizedState=x.state,o=s.child):o=da(o,s,y),o}function db(o,s,h,p){return js(),s.flags|=256,on(o,s,h,p),s.child}var Pd={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Ld(o){return{baseLanes:o,cachePool:e0()}}function zd(o,s,h){return o=o!==null?o.childLanes&~h:0,s&&(o|=lr),o}function pb(o,s,h){var p=s.pendingProps,y=!1,x=(s.flags&128)!==0,T;if((T=x)||(T=o!==null&&o.memoizedState===null?!1:(Ut.current&2)!==0),T&&(y=!0,s.flags&=-129),T=(s.flags&32)!==0,s.flags&=-33,o===null){if(nt){if(y?Wa(s):Ga(),nt){var k=Rt,z;if(z=k){e:{for(z=k,k=Nr;z.nodeType!==8;){if(!k){k=null;break e}if(z=Er(z.nextSibling),z===null){k=null;break e}}k=z}k!==null?(s.memoizedState={dehydrated:k,treeContext:Ti!==null?{id:sa,overflow:ua}:null,retryLane:536870912,hydrationErrors:null},z=Un(18,null,null,0),z.stateNode=k,z.return=s,s.child=z,En=s,Rt=null,z=!0):z=!1}z||ki(s)}if(k=s.memoizedState,k!==null&&(k=k.dehydrated,k!==null))return Sp(k)?s.lanes=32:s.lanes=536870912,null;ha(s)}return k=p.children,p=p.fallback,y?(Ga(),y=s.mode,k=nc({mode:"hidden",children:k},y),p=Ai(p,y,h,null),k.return=s,p.return=s,k.sibling=p,s.child=k,y=s.child,y.memoizedState=Ld(h),y.childLanes=zd(o,T,h),s.memoizedState=Pd,p):(Wa(s),Ud(s,k))}if(z=o.memoizedState,z!==null&&(k=z.dehydrated,k!==null)){if(x)s.flags&256?(Wa(s),s.flags&=-257,s=Hd(o,s,h)):s.memoizedState!==null?(Ga(),s.child=o.child,s.flags|=128,s=null):(Ga(),y=p.fallback,k=s.mode,p=nc({mode:"visible",children:p.children},k),y=Ai(y,k,h,null),y.flags|=2,p.return=s,y.return=s,p.sibling=y,s.child=p,Io(s,o.child,null,h),p=s.child,p.memoizedState=Ld(h),p.childLanes=zd(o,T,h),s.memoizedState=Pd,s=y);else if(Wa(s),Sp(k)){if(T=k.nextSibling&&k.nextSibling.dataset,T)var Y=T.dgst;T=Y,p=Error(r(419)),p.stack="",p.digest=T,qs({value:p,source:null,stack:null}),s=Hd(o,s,h)}else if(Zt||$s(o,s,h,!1),T=(h&o.childLanes)!==0,Zt||T){if(T=dt,T!==null&&(p=h&-h,p=(p&42)!==0?1:Eh(p),p=(p&(T.suspendedLanes|h))!==0?0:p,p!==0&&p!==z.retryLane))throw z.retryLane=p,Eo(o,p),jn(T,o,p),ib;k.data==="$?"||ip(),s=Hd(o,s,h)}else k.data==="$?"?(s.flags|=192,s.child=o.child,s=null):(o=z.treeContext,Rt=Er(k.nextSibling),En=s,nt=!0,Oi=null,Nr=!1,o!==null&&(or[sr++]=sa,or[sr++]=ua,or[sr++]=Ti,sa=o.id,ua=o.overflow,Ti=s),s=Ud(s,p.children),s.flags|=4096);return s}return y?(Ga(),y=p.fallback,k=s.mode,z=o.child,Y=z.sibling,p=oa(z,{mode:"hidden",children:p.children}),p.subtreeFlags=z.subtreeFlags&65011712,Y!==null?y=oa(Y,y):(y=Ai(y,k,h,null),y.flags|=2),y.return=s,p.return=s,p.sibling=y,s.child=p,p=y,y=s.child,k=o.child.memoizedState,k===null?k=Ld(h):(z=k.cachePool,z!==null?(Y=zt._currentValue,z=z.parent!==Y?{parent:Y,pool:Y}:z):z=e0(),k={baseLanes:k.baseLanes|h,cachePool:z}),y.memoizedState=k,y.childLanes=zd(o,T,h),s.memoizedState=Pd,p):(Wa(s),h=o.child,o=h.sibling,h=oa(h,{mode:"visible",children:p.children}),h.return=s,h.sibling=null,o!==null&&(T=s.deletions,T===null?(s.deletions=[o],s.flags|=16):T.push(o)),s.child=h,s.memoizedState=null,h)}function Ud(o,s){return s=nc({mode:"visible",children:s},o.mode),s.return=o,o.child=s}function nc(o,s){return o=Un(22,o,null,s),o.lanes=0,o.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},o}function Hd(o,s,h){return Io(s,o.child,null,h),o=Ud(s,s.pendingProps.children),o.flags|=2,s.memoizedState=null,o}function vb(o,s,h){o.lanes|=s;var p=o.alternate;p!==null&&(p.lanes|=s),id(o.return,s,h)}function Vd(o,s,h,p,y){var x=o.memoizedState;x===null?o.memoizedState={isBackwards:s,rendering:null,renderingStartTime:0,last:p,tail:h,tailMode:y}:(x.isBackwards=s,x.rendering=null,x.renderingStartTime=0,x.last=p,x.tail=h,x.tailMode=y)}function mb(o,s,h){var p=s.pendingProps,y=p.revealOrder,x=p.tail;if(on(o,s,p.children,h),p=Ut.current,(p&2)!==0)p=p&1|2,s.flags|=128;else{if(o!==null&&(o.flags&128)!==0)e:for(o=s.child;o!==null;){if(o.tag===13)o.memoizedState!==null&&vb(o,h,s);else if(o.tag===19)vb(o,h,s);else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===s)break e;for(;o.sibling===null;){if(o.return===null||o.return===s)break e;o=o.return}o.sibling.return=o.return,o=o.sibling}p&=1}switch(oe(Ut,p),y){case"forwards":for(h=s.child,y=null;h!==null;)o=h.alternate,o!==null&&Ql(o)===null&&(y=h),h=h.sibling;h=y,h===null?(y=s.child,s.child=null):(y=h.sibling,h.sibling=null),Vd(s,!1,y,h,x);break;case"backwards":for(h=null,y=s.child,s.child=null;y!==null;){if(o=y.alternate,o!==null&&Ql(o)===null){s.child=y;break}o=y.sibling,y.sibling=h,h=y,y=o}Vd(s,!0,h,null,x);break;case"together":Vd(s,!1,null,null,void 0);break;default:s.memoizedState=null}return s.child}function da(o,s,h){if(o!==null&&(s.dependencies=o.dependencies),Xa|=s.lanes,(h&s.childLanes)===0)if(o!==null){if($s(o,s,h,!1),(h&s.childLanes)===0)return null}else return null;if(o!==null&&s.child!==o.child)throw Error(r(153));if(s.child!==null){for(o=s.child,h=oa(o,o.pendingProps),s.child=h,h.return=s;o.sibling!==null;)o=o.sibling,h=h.sibling=oa(o,o.pendingProps),h.return=s;h.sibling=null}return s.child}function Wd(o,s){return(o.lanes&s)!==0?!0:(o=o.dependencies,!!(o!==null&&Bl(o)))}function dR(o,s,h){switch(s.tag){case 3:ye(s,s.stateNode.containerInfo),La(s,zt,o.memoizedState.cache),js();break;case 27:case 5:Qe(s);break;case 4:ye(s,s.stateNode.containerInfo);break;case 10:La(s,s.type,s.memoizedProps.value);break;case 13:var p=s.memoizedState;if(p!==null)return p.dehydrated!==null?(Wa(s),s.flags|=128,null):(h&s.child.childLanes)!==0?pb(o,s,h):(Wa(s),o=da(o,s,h),o!==null?o.sibling:null);Wa(s);break;case 19:var y=(o.flags&128)!==0;if(p=(h&s.childLanes)!==0,p||($s(o,s,h,!1),p=(h&s.childLanes)!==0),y){if(p)return mb(o,s,h);s.flags|=128}if(y=s.memoizedState,y!==null&&(y.rendering=null,y.tail=null,y.lastEffect=null),oe(Ut,Ut.current),p)break;return null;case 22:case 23:return s.lanes=0,lb(o,s,h);case 24:La(s,zt,o.memoizedState.cache)}return da(o,s,h)}function gb(o,s,h){if(o!==null)if(o.memoizedProps!==s.pendingProps)Zt=!0;else{if(!Wd(o,h)&&(s.flags&128)===0)return Zt=!1,dR(o,s,h);Zt=(o.flags&131072)!==0}else Zt=!1,nt&&(s.flags&1048576)!==0&&$y(s,Fl,s.index);switch(s.lanes=0,s.tag){case 16:e:{o=s.pendingProps;var p=s.elementType,y=p._init;if(p=y(p._payload),s.type=p,typeof p=="function")Qh(p)?(o=Bi(p,o),s.tag=1,s=hb(null,s,p,o,h)):(s.tag=0,s=Bd(null,s,p,o,h));else{if(p!=null){if(y=p.$$typeof,y===C){s.tag=11,s=ob(null,s,p,o,h);break e}else if(y===O){s.tag=14,s=sb(null,s,p,o,h);break e}}throw s=ee(p)||p,Error(r(306,s,""))}}return s;case 0:return Bd(o,s,s.type,s.pendingProps,h);case 1:return p=s.type,y=Bi(p,s.pendingProps),hb(o,s,p,y,h);case 3:e:{if(ye(s,s.stateNode.containerInfo),o===null)throw Error(r(387));p=s.pendingProps;var x=s.memoizedState;y=x.element,hd(o,s),eu(s,p,null,h);var T=s.memoizedState;if(p=T.cache,La(s,zt,p),p!==x.cache&&od(s,[zt],h,!0),Js(),p=T.element,x.isDehydrated)if(x={element:p,isDehydrated:!1,cache:T.cache},s.updateQueue.baseState=x,s.memoizedState=x,s.flags&256){s=db(o,s,p,h);break e}else if(p!==y){y=ar(Error(r(424)),s),qs(y),s=db(o,s,p,h);break e}else{switch(o=s.stateNode.containerInfo,o.nodeType){case 9:o=o.body;break;default:o=o.nodeName==="HTML"?o.ownerDocument.body:o}for(Rt=Er(o.firstChild),En=s,nt=!0,Oi=null,Nr=!0,h=X0(s,null,p,h),s.child=h;h;)h.flags=h.flags&-3|4096,h=h.sibling}else{if(js(),p===y){s=da(o,s,h);break e}on(o,s,p,h)}s=s.child}return s;case 26:return tc(o,s),o===null?(h=w1(s.type,null,s.pendingProps,null))?s.memoizedState=h:nt||(h=s.type,o=s.pendingProps,p=mc(ve.current).createElement(h),p[dn]=s,p[Tn]=o,un(p,h,o),Xt(p),s.stateNode=p):s.memoizedState=w1(s.type,o.memoizedProps,s.pendingProps,o.memoizedState),null;case 27:return Qe(s),o===null&&nt&&(p=s.stateNode=y1(s.type,s.pendingProps,ve.current),En=s,Nr=!0,y=Rt,Ja(s.type)?(Ep=y,Rt=Er(p.firstChild)):Rt=y),on(o,s,s.pendingProps.children,h),tc(o,s),o===null&&(s.flags|=4194304),s.child;case 5:return o===null&&nt&&((y=p=Rt)&&(p=HR(p,s.type,s.pendingProps,Nr),p!==null?(s.stateNode=p,En=s,Rt=Er(p.firstChild),Nr=!1,y=!0):y=!1),y||ki(s)),Qe(s),y=s.type,x=s.pendingProps,T=o!==null?o.memoizedProps:null,p=x.children,bp(y,x)?p=null:T!==null&&bp(y,T)&&(s.flags|=32),s.memoizedState!==null&&(y=yd(o,s,iR,null,null,h),Su._currentValue=y),tc(o,s),on(o,s,p,h),s.child;case 6:return o===null&&nt&&((o=h=Rt)&&(h=VR(h,s.pendingProps,Nr),h!==null?(s.stateNode=h,En=s,Rt=null,o=!0):o=!1),o||ki(s)),null;case 13:return pb(o,s,h);case 4:return ye(s,s.stateNode.containerInfo),p=s.pendingProps,o===null?s.child=Io(s,null,p,h):on(o,s,p,h),s.child;case 11:return ob(o,s,s.type,s.pendingProps,h);case 7:return on(o,s,s.pendingProps,h),s.child;case 8:return on(o,s,s.pendingProps.children,h),s.child;case 12:return on(o,s,s.pendingProps.children,h),s.child;case 10:return p=s.pendingProps,La(s,s.type,p.value),on(o,s,p.children,h),s.child;case 9:return y=s.type._context,p=s.pendingProps.children,Mi(s),y=pn(y),p=p(y),s.flags|=1,on(o,s,p,h),s.child;case 14:return sb(o,s,s.type,s.pendingProps,h);case 15:return ub(o,s,s.type,s.pendingProps,h);case 19:return mb(o,s,h);case 31:return p=s.pendingProps,h=s.mode,p={mode:p.mode,children:p.children},o===null?(h=nc(p,h),h.ref=s.ref,s.child=h,h.return=s,s=h):(h=oa(o.child,p),h.ref=s.ref,s.child=h,h.return=s,s=h),s;case 22:return lb(o,s,h);case 24:return Mi(s),p=pn(zt),o===null?(y=ld(),y===null&&(y=dt,x=sd(),y.pooledCache=x,x.refCount++,x!==null&&(y.pooledCacheLanes|=h),y=x),s.memoizedState={parent:p,cache:y},fd(s),La(s,zt,y)):((o.lanes&h)!==0&&(hd(o,s),eu(s,null,null,h),Js()),y=o.memoizedState,x=s.memoizedState,y.parent!==p?(y={parent:p,cache:p},s.memoizedState=y,s.lanes===0&&(s.memoizedState=s.updateQueue.baseState=y),La(s,zt,p)):(p=x.cache,La(s,zt,p),p!==y.cache&&od(s,[zt],h,!0))),on(o,s,s.pendingProps.children,h),s.child;case 29:throw s.pendingProps}throw Error(r(156,s.tag))}function pa(o){o.flags|=4}function yb(o,s){if(s.type!=="stylesheet"||(s.state.loading&4)!==0)o.flags&=-16777217;else if(o.flags|=16777216,!R1(s)){if(s=ur.current,s!==null&&((Ze&4194048)===Ze?Mr!==null:(Ze&62914560)!==Ze&&(Ze&536870912)===0||s!==Mr))throw Ys=cd,t0;o.flags|=8192}}function rc(o,s){s!==null&&(o.flags|=4),o.flags&16384&&(s=o.tag!==22?Zg():536870912,o.lanes|=s,Lo|=s)}function su(o,s){if(!nt)switch(o.tailMode){case"hidden":s=o.tail;for(var h=null;s!==null;)s.alternate!==null&&(h=s),s=s.sibling;h===null?o.tail=null:h.sibling=null;break;case"collapsed":h=o.tail;for(var p=null;h!==null;)h.alternate!==null&&(p=h),h=h.sibling;p===null?s||o.tail===null?o.tail=null:o.tail.sibling=null:p.sibling=null}}function xt(o){var s=o.alternate!==null&&o.alternate.child===o.child,h=0,p=0;if(s)for(var y=o.child;y!==null;)h|=y.lanes|y.childLanes,p|=y.subtreeFlags&65011712,p|=y.flags&65011712,y.return=o,y=y.sibling;else for(y=o.child;y!==null;)h|=y.lanes|y.childLanes,p|=y.subtreeFlags,p|=y.flags,y.return=o,y=y.sibling;return o.subtreeFlags|=p,o.childLanes=h,s}function pR(o,s,h){var p=s.pendingProps;switch(nd(s),s.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return xt(s),null;case 1:return xt(s),null;case 3:return h=s.stateNode,p=null,o!==null&&(p=o.memoizedState.cache),s.memoizedState.cache!==p&&(s.flags|=2048),ca(zt),De(),h.pendingContext&&(h.context=h.pendingContext,h.pendingContext=null),(o===null||o.child===null)&&(Gs(s)?pa(s):o===null||o.memoizedState.isDehydrated&&(s.flags&256)===0||(s.flags|=1024,Zy())),xt(s),null;case 26:return h=s.memoizedState,o===null?(pa(s),h!==null?(xt(s),yb(s,h)):(xt(s),s.flags&=-16777217)):h?h!==o.memoizedState?(pa(s),xt(s),yb(s,h)):(xt(s),s.flags&=-16777217):(o.memoizedProps!==p&&pa(s),xt(s),s.flags&=-16777217),null;case 27:Ne(s),h=ve.current;var y=s.type;if(o!==null&&s.stateNode!=null)o.memoizedProps!==p&&pa(s);else{if(!p){if(s.stateNode===null)throw Error(r(166));return xt(s),null}o=de.current,Gs(s)?Ky(s):(o=y1(y,p,h),s.stateNode=o,pa(s))}return xt(s),null;case 5:if(Ne(s),h=s.type,o!==null&&s.stateNode!=null)o.memoizedProps!==p&&pa(s);else{if(!p){if(s.stateNode===null)throw Error(r(166));return xt(s),null}if(o=de.current,Gs(s))Ky(s);else{switch(y=mc(ve.current),o){case 1:o=y.createElementNS("http://www.w3.org/2000/svg",h);break;case 2:o=y.createElementNS("http://www.w3.org/1998/Math/MathML",h);break;default:switch(h){case"svg":o=y.createElementNS("http://www.w3.org/2000/svg",h);break;case"math":o=y.createElementNS("http://www.w3.org/1998/Math/MathML",h);break;case"script":o=y.createElement("div"),o.innerHTML="<script><\/script>",o=o.removeChild(o.firstChild);break;case"select":o=typeof p.is=="string"?y.createElement("select",{is:p.is}):y.createElement("select"),p.multiple?o.multiple=!0:p.size&&(o.size=p.size);break;default:o=typeof p.is=="string"?y.createElement(h,{is:p.is}):y.createElement(h)}}o[dn]=s,o[Tn]=p;e:for(y=s.child;y!==null;){if(y.tag===5||y.tag===6)o.appendChild(y.stateNode);else if(y.tag!==4&&y.tag!==27&&y.child!==null){y.child.return=y,y=y.child;continue}if(y===s)break e;for(;y.sibling===null;){if(y.return===null||y.return===s)break e;y=y.return}y.sibling.return=y.return,y=y.sibling}s.stateNode=o;e:switch(un(o,h,p),h){case"button":case"input":case"select":case"textarea":o=!!p.autoFocus;break e;case"img":o=!0;break e;default:o=!1}o&&pa(s)}}return xt(s),s.flags&=-16777217,null;case 6:if(o&&s.stateNode!=null)o.memoizedProps!==p&&pa(s);else{if(typeof p!="string"&&s.stateNode===null)throw Error(r(166));if(o=ve.current,Gs(s)){if(o=s.stateNode,h=s.memoizedProps,p=null,y=En,y!==null)switch(y.tag){case 27:case 5:p=y.memoizedProps}o[dn]=s,o=!!(o.nodeValue===h||p!==null&&p.suppressHydrationWarning===!0||f1(o.nodeValue,h)),o||ki(s)}else o=mc(o).createTextNode(p),o[dn]=s,s.stateNode=o}return xt(s),null;case 13:if(p=s.memoizedState,o===null||o.memoizedState!==null&&o.memoizedState.dehydrated!==null){if(y=Gs(s),p!==null&&p.dehydrated!==null){if(o===null){if(!y)throw Error(r(318));if(y=s.memoizedState,y=y!==null?y.dehydrated:null,!y)throw Error(r(317));y[dn]=s}else js(),(s.flags&128)===0&&(s.memoizedState=null),s.flags|=4;xt(s),y=!1}else y=Zy(),o!==null&&o.memoizedState!==null&&(o.memoizedState.hydrationErrors=y),y=!0;if(!y)return s.flags&256?(ha(s),s):(ha(s),null)}if(ha(s),(s.flags&128)!==0)return s.lanes=h,s;if(h=p!==null,o=o!==null&&o.memoizedState!==null,h){p=s.child,y=null,p.alternate!==null&&p.alternate.memoizedState!==null&&p.alternate.memoizedState.cachePool!==null&&(y=p.alternate.memoizedState.cachePool.pool);var x=null;p.memoizedState!==null&&p.memoizedState.cachePool!==null&&(x=p.memoizedState.cachePool.pool),x!==y&&(p.flags|=2048)}return h!==o&&h&&(s.child.flags|=8192),rc(s,s.updateQueue),xt(s),null;case 4:return De(),o===null&&pp(s.stateNode.containerInfo),xt(s),null;case 10:return ca(s.type),xt(s),null;case 19:if(ie(Ut),y=s.memoizedState,y===null)return xt(s),null;if(p=(s.flags&128)!==0,x=y.rendering,x===null)if(p)su(y,!1);else{if(At!==0||o!==null&&(o.flags&128)!==0)for(o=s.child;o!==null;){if(x=Ql(o),x!==null){for(s.flags|=128,su(y,!1),o=x.updateQueue,s.updateQueue=o,rc(s,o),s.subtreeFlags=0,o=h,h=s.child;h!==null;)qy(h,o),h=h.sibling;return oe(Ut,Ut.current&1|2),s.child}o=o.sibling}y.tail!==null&&Dt()>oc&&(s.flags|=128,p=!0,su(y,!1),s.lanes=4194304)}else{if(!p)if(o=Ql(x),o!==null){if(s.flags|=128,p=!0,o=o.updateQueue,s.updateQueue=o,rc(s,o),su(y,!0),y.tail===null&&y.tailMode==="hidden"&&!x.alternate&&!nt)return xt(s),null}else 2*Dt()-y.renderingStartTime>oc&&h!==536870912&&(s.flags|=128,p=!0,su(y,!1),s.lanes=4194304);y.isBackwards?(x.sibling=s.child,s.child=x):(o=y.last,o!==null?o.sibling=x:s.child=x,y.last=x)}return y.tail!==null?(s=y.tail,y.rendering=s,y.tail=s.sibling,y.renderingStartTime=Dt(),s.sibling=null,o=Ut.current,oe(Ut,p?o&1|2:o&1),s):(xt(s),null);case 22:case 23:return ha(s),md(),p=s.memoizedState!==null,o!==null?o.memoizedState!==null!==p&&(s.flags|=8192):p&&(s.flags|=8192),p?(h&536870912)!==0&&(s.flags&128)===0&&(xt(s),s.subtreeFlags&6&&(s.flags|=8192)):xt(s),h=s.updateQueue,h!==null&&rc(s,h.retryQueue),h=null,o!==null&&o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(h=o.memoizedState.cachePool.pool),p=null,s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(p=s.memoizedState.cachePool.pool),p!==h&&(s.flags|=2048),o!==null&&ie(Ii),null;case 24:return h=null,o!==null&&(h=o.memoizedState.cache),s.memoizedState.cache!==h&&(s.flags|=2048),ca(zt),xt(s),null;case 25:return null;case 30:return null}throw Error(r(156,s.tag))}function vR(o,s){switch(nd(s),s.tag){case 1:return o=s.flags,o&65536?(s.flags=o&-65537|128,s):null;case 3:return ca(zt),De(),o=s.flags,(o&65536)!==0&&(o&128)===0?(s.flags=o&-65537|128,s):null;case 26:case 27:case 5:return Ne(s),null;case 13:if(ha(s),o=s.memoizedState,o!==null&&o.dehydrated!==null){if(s.alternate===null)throw Error(r(340));js()}return o=s.flags,o&65536?(s.flags=o&-65537|128,s):null;case 19:return ie(Ut),null;case 4:return De(),null;case 10:return ca(s.type),null;case 22:case 23:return ha(s),md(),o!==null&&ie(Ii),o=s.flags,o&65536?(s.flags=o&-65537|128,s):null;case 24:return ca(zt),null;case 25:return null;default:return null}}function bb(o,s){switch(nd(s),s.tag){case 3:ca(zt),De();break;case 26:case 27:case 5:Ne(s);break;case 4:De();break;case 13:ha(s);break;case 19:ie(Ut);break;case 10:ca(s.type);break;case 22:case 23:ha(s),md(),o!==null&&ie(Ii);break;case 24:ca(zt)}}function uu(o,s){try{var h=s.updateQueue,p=h!==null?h.lastEffect:null;if(p!==null){var y=p.next;h=y;do{if((h.tag&o)===o){p=void 0;var x=h.create,T=h.inst;p=x(),T.destroy=p}h=h.next}while(h!==y)}}catch(k){ht(s,s.return,k)}}function ja(o,s,h){try{var p=s.updateQueue,y=p!==null?p.lastEffect:null;if(y!==null){var x=y.next;p=x;do{if((p.tag&o)===o){var T=p.inst,k=T.destroy;if(k!==void 0){T.destroy=void 0,y=s;var z=h,Y=k;try{Y()}catch(le){ht(y,z,le)}}}p=p.next}while(p!==x)}}catch(le){ht(s,s.return,le)}}function xb(o){var s=o.updateQueue;if(s!==null){var h=o.stateNode;try{s0(s,h)}catch(p){ht(o,o.return,p)}}}function wb(o,s,h){h.props=Bi(o.type,o.memoizedProps),h.state=o.memoizedState;try{h.componentWillUnmount()}catch(p){ht(o,s,p)}}function lu(o,s){try{var h=o.ref;if(h!==null){switch(o.tag){case 26:case 27:case 5:var p=o.stateNode;break;case 30:p=o.stateNode;break;default:p=o.stateNode}typeof h=="function"?o.refCleanup=h(p):h.current=p}}catch(y){ht(o,s,y)}}function Ir(o,s){var h=o.ref,p=o.refCleanup;if(h!==null)if(typeof p=="function")try{p()}catch(y){ht(o,s,y)}finally{o.refCleanup=null,o=o.alternate,o!=null&&(o.refCleanup=null)}else if(typeof h=="function")try{h(null)}catch(y){ht(o,s,y)}else h.current=null}function Sb(o){var s=o.type,h=o.memoizedProps,p=o.stateNode;try{e:switch(s){case"button":case"input":case"select":case"textarea":h.autoFocus&&p.focus();break e;case"img":h.src?p.src=h.src:h.srcSet&&(p.srcset=h.srcSet)}}catch(y){ht(o,o.return,y)}}function Gd(o,s,h){try{var p=o.stateNode;BR(p,o.type,h,s),p[Tn]=s}catch(y){ht(o,o.return,y)}}function Eb(o){return o.tag===5||o.tag===3||o.tag===26||o.tag===27&&Ja(o.type)||o.tag===4}function jd(o){e:for(;;){for(;o.sibling===null;){if(o.return===null||Eb(o.return))return null;o=o.return}for(o.sibling.return=o.return,o=o.sibling;o.tag!==5&&o.tag!==6&&o.tag!==18;){if(o.tag===27&&Ja(o.type)||o.flags&2||o.child===null||o.tag===4)continue e;o.child.return=o,o=o.child}if(!(o.flags&2))return o.stateNode}}function qd(o,s,h){var p=o.tag;if(p===5||p===6)o=o.stateNode,s?(h.nodeType===9?h.body:h.nodeName==="HTML"?h.ownerDocument.body:h).insertBefore(o,s):(s=h.nodeType===9?h.body:h.nodeName==="HTML"?h.ownerDocument.body:h,s.appendChild(o),h=h._reactRootContainer,h!=null||s.onclick!==null||(s.onclick=vc));else if(p!==4&&(p===27&&Ja(o.type)&&(h=o.stateNode,s=null),o=o.child,o!==null))for(qd(o,s,h),o=o.sibling;o!==null;)qd(o,s,h),o=o.sibling}function ac(o,s,h){var p=o.tag;if(p===5||p===6)o=o.stateNode,s?h.insertBefore(o,s):h.appendChild(o);else if(p!==4&&(p===27&&Ja(o.type)&&(h=o.stateNode),o=o.child,o!==null))for(ac(o,s,h),o=o.sibling;o!==null;)ac(o,s,h),o=o.sibling}function _b(o){var s=o.stateNode,h=o.memoizedProps;try{for(var p=o.type,y=s.attributes;y.length;)s.removeAttributeNode(y[0]);un(s,p,h),s[dn]=o,s[Tn]=h}catch(x){ht(o,o.return,x)}}var va=!1,kt=!1,$d=!1,Cb=typeof WeakSet=="function"?WeakSet:Set,Yt=null;function mR(o,s){if(o=o.containerInfo,gp=Sc,o=By(o),jh(o)){if("selectionStart"in o)var h={start:o.selectionStart,end:o.selectionEnd};else e:{h=(h=o.ownerDocument)&&h.defaultView||window;var p=h.getSelection&&h.getSelection();if(p&&p.rangeCount!==0){h=p.anchorNode;var y=p.anchorOffset,x=p.focusNode;p=p.focusOffset;try{h.nodeType,x.nodeType}catch{h=null;break e}var T=0,k=-1,z=-1,Y=0,le=0,fe=o,Q=null;t:for(;;){for(var re;fe!==h||y!==0&&fe.nodeType!==3||(k=T+y),fe!==x||p!==0&&fe.nodeType!==3||(z=T+p),fe.nodeType===3&&(T+=fe.nodeValue.length),(re=fe.firstChild)!==null;)Q=fe,fe=re;for(;;){if(fe===o)break t;if(Q===h&&++Y===y&&(k=T),Q===x&&++le===p&&(z=T),(re=fe.nextSibling)!==null)break;fe=Q,Q=fe.parentNode}fe=re}h=k===-1||z===-1?null:{start:k,end:z}}else h=null}h=h||{start:0,end:0}}else h=null;for(yp={focusedElem:o,selectionRange:h},Sc=!1,Yt=s;Yt!==null;)if(s=Yt,o=s.child,(s.subtreeFlags&1024)!==0&&o!==null)o.return=s,Yt=o;else for(;Yt!==null;){switch(s=Yt,x=s.alternate,o=s.flags,s.tag){case 0:break;case 11:case 15:break;case 1:if((o&1024)!==0&&x!==null){o=void 0,h=s,y=x.memoizedProps,x=x.memoizedState,p=h.stateNode;try{var Me=Bi(h.type,y,h.elementType===h.type);o=p.getSnapshotBeforeUpdate(Me,x),p.__reactInternalSnapshotBeforeUpdate=o}catch(Oe){ht(h,h.return,Oe)}}break;case 3:if((o&1024)!==0){if(o=s.stateNode.containerInfo,h=o.nodeType,h===9)wp(o);else if(h===1)switch(o.nodeName){case"HEAD":case"HTML":case"BODY":wp(o);break;default:o.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((o&1024)!==0)throw Error(r(163))}if(o=s.sibling,o!==null){o.return=s.return,Yt=o;break}Yt=s.return}}function Rb(o,s,h){var p=h.flags;switch(h.tag){case 0:case 11:case 15:qa(o,h),p&4&&uu(5,h);break;case 1:if(qa(o,h),p&4)if(o=h.stateNode,s===null)try{o.componentDidMount()}catch(T){ht(h,h.return,T)}else{var y=Bi(h.type,s.memoizedProps);s=s.memoizedState;try{o.componentDidUpdate(y,s,o.__reactInternalSnapshotBeforeUpdate)}catch(T){ht(h,h.return,T)}}p&64&&xb(h),p&512&&lu(h,h.return);break;case 3:if(qa(o,h),p&64&&(o=h.updateQueue,o!==null)){if(s=null,h.child!==null)switch(h.child.tag){case 27:case 5:s=h.child.stateNode;break;case 1:s=h.child.stateNode}try{s0(o,s)}catch(T){ht(h,h.return,T)}}break;case 27:s===null&&p&4&&_b(h);case 26:case 5:qa(o,h),s===null&&p&4&&Sb(h),p&512&&lu(h,h.return);break;case 12:qa(o,h);break;case 13:qa(o,h),p&4&&Db(o,h),p&64&&(o=h.memoizedState,o!==null&&(o=o.dehydrated,o!==null&&(h=CR.bind(null,h),WR(o,h))));break;case 22:if(p=h.memoizedState!==null||va,!p){s=s!==null&&s.memoizedState!==null||kt,y=va;var x=kt;va=p,(kt=s)&&!x?$a(o,h,(h.subtreeFlags&8772)!==0):qa(o,h),va=y,kt=x}break;case 30:break;default:qa(o,h)}}function Ab(o){var s=o.alternate;s!==null&&(o.alternate=null,Ab(s)),o.child=null,o.deletions=null,o.sibling=null,o.tag===5&&(s=o.stateNode,s!==null&&Rh(s)),o.stateNode=null,o.return=null,o.dependencies=null,o.memoizedProps=null,o.memoizedState=null,o.pendingProps=null,o.stateNode=null,o.updateQueue=null}var gt=null,kn=!1;function ma(o,s,h){for(h=h.child;h!==null;)Tb(o,s,h),h=h.sibling}function Tb(o,s,h){if(Mt&&typeof Mt.onCommitFiberUnmount=="function")try{Mt.onCommitFiberUnmount(ra,h)}catch{}switch(h.tag){case 26:kt||Ir(h,s),ma(o,s,h),h.memoizedState?h.memoizedState.count--:h.stateNode&&(h=h.stateNode,h.parentNode.removeChild(h));break;case 27:kt||Ir(h,s);var p=gt,y=kn;Ja(h.type)&&(gt=h.stateNode,kn=!1),ma(o,s,h),yu(h.stateNode),gt=p,kn=y;break;case 5:kt||Ir(h,s);case 6:if(p=gt,y=kn,gt=null,ma(o,s,h),gt=p,kn=y,gt!==null)if(kn)try{(gt.nodeType===9?gt.body:gt.nodeName==="HTML"?gt.ownerDocument.body:gt).removeChild(h.stateNode)}catch(x){ht(h,s,x)}else try{gt.removeChild(h.stateNode)}catch(x){ht(h,s,x)}break;case 18:gt!==null&&(kn?(o=gt,m1(o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o,h.stateNode),Ru(o)):m1(gt,h.stateNode));break;case 4:p=gt,y=kn,gt=h.stateNode.containerInfo,kn=!0,ma(o,s,h),gt=p,kn=y;break;case 0:case 11:case 14:case 15:kt||ja(2,h,s),kt||ja(4,h,s),ma(o,s,h);break;case 1:kt||(Ir(h,s),p=h.stateNode,typeof p.componentWillUnmount=="function"&&wb(h,s,p)),ma(o,s,h);break;case 21:ma(o,s,h);break;case 22:kt=(p=kt)||h.memoizedState!==null,ma(o,s,h),kt=p;break;default:ma(o,s,h)}}function Db(o,s){if(s.memoizedState===null&&(o=s.alternate,o!==null&&(o=o.memoizedState,o!==null&&(o=o.dehydrated,o!==null))))try{Ru(o)}catch(h){ht(s,s.return,h)}}function gR(o){switch(o.tag){case 13:case 19:var s=o.stateNode;return s===null&&(s=o.stateNode=new Cb),s;case 22:return o=o.stateNode,s=o._retryCache,s===null&&(s=o._retryCache=new Cb),s;default:throw Error(r(435,o.tag))}}function Kd(o,s){var h=gR(o);s.forEach(function(p){var y=RR.bind(null,o,p);h.has(p)||(h.add(p),p.then(y,y))})}function Hn(o,s){var h=s.deletions;if(h!==null)for(var p=0;p<h.length;p++){var y=h[p],x=o,T=s,k=T;e:for(;k!==null;){switch(k.tag){case 27:if(Ja(k.type)){gt=k.stateNode,kn=!1;break e}break;case 5:gt=k.stateNode,kn=!1;break e;case 3:case 4:gt=k.stateNode.containerInfo,kn=!0;break e}k=k.return}if(gt===null)throw Error(r(160));Tb(x,T,y),gt=null,kn=!1,x=y.alternate,x!==null&&(x.return=null),y.return=null}if(s.subtreeFlags&13878)for(s=s.child;s!==null;)Ob(s,o),s=s.sibling}var Sr=null;function Ob(o,s){var h=o.alternate,p=o.flags;switch(o.tag){case 0:case 11:case 14:case 15:Hn(s,o),Vn(o),p&4&&(ja(3,o,o.return),uu(3,o),ja(5,o,o.return));break;case 1:Hn(s,o),Vn(o),p&512&&(kt||h===null||Ir(h,h.return)),p&64&&va&&(o=o.updateQueue,o!==null&&(p=o.callbacks,p!==null&&(h=o.shared.hiddenCallbacks,o.shared.hiddenCallbacks=h===null?p:h.concat(p))));break;case 26:var y=Sr;if(Hn(s,o),Vn(o),p&512&&(kt||h===null||Ir(h,h.return)),p&4){var x=h!==null?h.memoizedState:null;if(p=o.memoizedState,h===null)if(p===null)if(o.stateNode===null){e:{p=o.type,h=o.memoizedProps,y=y.ownerDocument||y;t:switch(p){case"title":x=y.getElementsByTagName("title")[0],(!x||x[Ms]||x[dn]||x.namespaceURI==="http://www.w3.org/2000/svg"||x.hasAttribute("itemprop"))&&(x=y.createElement(p),y.head.insertBefore(x,y.querySelector("head > title"))),un(x,p,h),x[dn]=o,Xt(x),p=x;break e;case"link":var T=_1("link","href",y).get(p+(h.href||""));if(T){for(var k=0;k<T.length;k++)if(x=T[k],x.getAttribute("href")===(h.href==null||h.href===""?null:h.href)&&x.getAttribute("rel")===(h.rel==null?null:h.rel)&&x.getAttribute("title")===(h.title==null?null:h.title)&&x.getAttribute("crossorigin")===(h.crossOrigin==null?null:h.crossOrigin)){T.splice(k,1);break t}}x=y.createElement(p),un(x,p,h),y.head.appendChild(x);break;case"meta":if(T=_1("meta","content",y).get(p+(h.content||""))){for(k=0;k<T.length;k++)if(x=T[k],x.getAttribute("content")===(h.content==null?null:""+h.content)&&x.getAttribute("name")===(h.name==null?null:h.name)&&x.getAttribute("property")===(h.property==null?null:h.property)&&x.getAttribute("http-equiv")===(h.httpEquiv==null?null:h.httpEquiv)&&x.getAttribute("charset")===(h.charSet==null?null:h.charSet)){T.splice(k,1);break t}}x=y.createElement(p),un(x,p,h),y.head.appendChild(x);break;default:throw Error(r(468,p))}x[dn]=o,Xt(x),p=x}o.stateNode=p}else C1(y,o.type,o.stateNode);else o.stateNode=E1(y,p,o.memoizedProps);else x!==p?(x===null?h.stateNode!==null&&(h=h.stateNode,h.parentNode.removeChild(h)):x.count--,p===null?C1(y,o.type,o.stateNode):E1(y,p,o.memoizedProps)):p===null&&o.stateNode!==null&&Gd(o,o.memoizedProps,h.memoizedProps)}break;case 27:Hn(s,o),Vn(o),p&512&&(kt||h===null||Ir(h,h.return)),h!==null&&p&4&&Gd(o,o.memoizedProps,h.memoizedProps);break;case 5:if(Hn(s,o),Vn(o),p&512&&(kt||h===null||Ir(h,h.return)),o.flags&32){y=o.stateNode;try{mo(y,"")}catch(re){ht(o,o.return,re)}}p&4&&o.stateNode!=null&&(y=o.memoizedProps,Gd(o,y,h!==null?h.memoizedProps:y)),p&1024&&($d=!0);break;case 6:if(Hn(s,o),Vn(o),p&4){if(o.stateNode===null)throw Error(r(162));p=o.memoizedProps,h=o.stateNode;try{h.nodeValue=p}catch(re){ht(o,o.return,re)}}break;case 3:if(bc=null,y=Sr,Sr=gc(s.containerInfo),Hn(s,o),Sr=y,Vn(o),p&4&&h!==null&&h.memoizedState.isDehydrated)try{Ru(s.containerInfo)}catch(re){ht(o,o.return,re)}$d&&($d=!1,kb(o));break;case 4:p=Sr,Sr=gc(o.stateNode.containerInfo),Hn(s,o),Vn(o),Sr=p;break;case 12:Hn(s,o),Vn(o);break;case 13:Hn(s,o),Vn(o),o.child.flags&8192&&o.memoizedState!==null!=(h!==null&&h.memoizedState!==null)&&(ep=Dt()),p&4&&(p=o.updateQueue,p!==null&&(o.updateQueue=null,Kd(o,p)));break;case 22:y=o.memoizedState!==null;var z=h!==null&&h.memoizedState!==null,Y=va,le=kt;if(va=Y||y,kt=le||z,Hn(s,o),kt=le,va=Y,Vn(o),p&8192)e:for(s=o.stateNode,s._visibility=y?s._visibility&-2:s._visibility|1,y&&(h===null||z||va||kt||Pi(o)),h=null,s=o;;){if(s.tag===5||s.tag===26){if(h===null){z=h=s;try{if(x=z.stateNode,y)T=x.style,typeof T.setProperty=="function"?T.setProperty("display","none","important"):T.display="none";else{k=z.stateNode;var fe=z.memoizedProps.style,Q=fe!=null&&fe.hasOwnProperty("display")?fe.display:null;k.style.display=Q==null||typeof Q=="boolean"?"":(""+Q).trim()}}catch(re){ht(z,z.return,re)}}}else if(s.tag===6){if(h===null){z=s;try{z.stateNode.nodeValue=y?"":z.memoizedProps}catch(re){ht(z,z.return,re)}}}else if((s.tag!==22&&s.tag!==23||s.memoizedState===null||s===o)&&s.child!==null){s.child.return=s,s=s.child;continue}if(s===o)break e;for(;s.sibling===null;){if(s.return===null||s.return===o)break e;h===s&&(h=null),s=s.return}h===s&&(h=null),s.sibling.return=s.return,s=s.sibling}p&4&&(p=o.updateQueue,p!==null&&(h=p.retryQueue,h!==null&&(p.retryQueue=null,Kd(o,h))));break;case 19:Hn(s,o),Vn(o),p&4&&(p=o.updateQueue,p!==null&&(o.updateQueue=null,Kd(o,p)));break;case 30:break;case 21:break;default:Hn(s,o),Vn(o)}}function Vn(o){var s=o.flags;if(s&2){try{for(var h,p=o.return;p!==null;){if(Eb(p)){h=p;break}p=p.return}if(h==null)throw Error(r(160));switch(h.tag){case 27:var y=h.stateNode,x=jd(o);ac(o,x,y);break;case 5:var T=h.stateNode;h.flags&32&&(mo(T,""),h.flags&=-33);var k=jd(o);ac(o,k,T);break;case 3:case 4:var z=h.stateNode.containerInfo,Y=jd(o);qd(o,Y,z);break;default:throw Error(r(161))}}catch(le){ht(o,o.return,le)}o.flags&=-3}s&4096&&(o.flags&=-4097)}function kb(o){if(o.subtreeFlags&1024)for(o=o.child;o!==null;){var s=o;kb(s),s.tag===5&&s.flags&1024&&s.stateNode.reset(),o=o.sibling}}function qa(o,s){if(s.subtreeFlags&8772)for(s=s.child;s!==null;)Rb(o,s.alternate,s),s=s.sibling}function Pi(o){for(o=o.child;o!==null;){var s=o;switch(s.tag){case 0:case 11:case 14:case 15:ja(4,s,s.return),Pi(s);break;case 1:Ir(s,s.return);var h=s.stateNode;typeof h.componentWillUnmount=="function"&&wb(s,s.return,h),Pi(s);break;case 27:yu(s.stateNode);case 26:case 5:Ir(s,s.return),Pi(s);break;case 22:s.memoizedState===null&&Pi(s);break;case 30:Pi(s);break;default:Pi(s)}o=o.sibling}}function $a(o,s,h){for(h=h&&(s.subtreeFlags&8772)!==0,s=s.child;s!==null;){var p=s.alternate,y=o,x=s,T=x.flags;switch(x.tag){case 0:case 11:case 15:$a(y,x,h),uu(4,x);break;case 1:if($a(y,x,h),p=x,y=p.stateNode,typeof y.componentDidMount=="function")try{y.componentDidMount()}catch(Y){ht(p,p.return,Y)}if(p=x,y=p.updateQueue,y!==null){var k=p.stateNode;try{var z=y.shared.hiddenCallbacks;if(z!==null)for(y.shared.hiddenCallbacks=null,y=0;y<z.length;y++)o0(z[y],k)}catch(Y){ht(p,p.return,Y)}}h&&T&64&&xb(x),lu(x,x.return);break;case 27:_b(x);case 26:case 5:$a(y,x,h),h&&p===null&&T&4&&Sb(x),lu(x,x.return);break;case 12:$a(y,x,h);break;case 13:$a(y,x,h),h&&T&4&&Db(y,x);break;case 22:x.memoizedState===null&&$a(y,x,h),lu(x,x.return);break;case 30:break;default:$a(y,x,h)}s=s.sibling}}function Xd(o,s){var h=null;o!==null&&o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(h=o.memoizedState.cachePool.pool),o=null,s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(o=s.memoizedState.cachePool.pool),o!==h&&(o!=null&&o.refCount++,h!=null&&Ks(h))}function Zd(o,s){o=null,s.alternate!==null&&(o=s.alternate.memoizedState.cache),s=s.memoizedState.cache,s!==o&&(s.refCount++,o!=null&&Ks(o))}function Fr(o,s,h,p){if(s.subtreeFlags&10256)for(s=s.child;s!==null;)Nb(o,s,h,p),s=s.sibling}function Nb(o,s,h,p){var y=s.flags;switch(s.tag){case 0:case 11:case 15:Fr(o,s,h,p),y&2048&&uu(9,s);break;case 1:Fr(o,s,h,p);break;case 3:Fr(o,s,h,p),y&2048&&(o=null,s.alternate!==null&&(o=s.alternate.memoizedState.cache),s=s.memoizedState.cache,s!==o&&(s.refCount++,o!=null&&Ks(o)));break;case 12:if(y&2048){Fr(o,s,h,p),o=s.stateNode;try{var x=s.memoizedProps,T=x.id,k=x.onPostCommit;typeof k=="function"&&k(T,s.alternate===null?"mount":"update",o.passiveEffectDuration,-0)}catch(z){ht(s,s.return,z)}}else Fr(o,s,h,p);break;case 13:Fr(o,s,h,p);break;case 23:break;case 22:x=s.stateNode,T=s.alternate,s.memoizedState!==null?x._visibility&2?Fr(o,s,h,p):cu(o,s):x._visibility&2?Fr(o,s,h,p):(x._visibility|=2,Fo(o,s,h,p,(s.subtreeFlags&10256)!==0)),y&2048&&Xd(T,s);break;case 24:Fr(o,s,h,p),y&2048&&Zd(s.alternate,s);break;default:Fr(o,s,h,p)}}function Fo(o,s,h,p,y){for(y=y&&(s.subtreeFlags&10256)!==0,s=s.child;s!==null;){var x=o,T=s,k=h,z=p,Y=T.flags;switch(T.tag){case 0:case 11:case 15:Fo(x,T,k,z,y),uu(8,T);break;case 23:break;case 22:var le=T.stateNode;T.memoizedState!==null?le._visibility&2?Fo(x,T,k,z,y):cu(x,T):(le._visibility|=2,Fo(x,T,k,z,y)),y&&Y&2048&&Xd(T.alternate,T);break;case 24:Fo(x,T,k,z,y),y&&Y&2048&&Zd(T.alternate,T);break;default:Fo(x,T,k,z,y)}s=s.sibling}}function cu(o,s){if(s.subtreeFlags&10256)for(s=s.child;s!==null;){var h=o,p=s,y=p.flags;switch(p.tag){case 22:cu(h,p),y&2048&&Xd(p.alternate,p);break;case 24:cu(h,p),y&2048&&Zd(p.alternate,p);break;default:cu(h,p)}s=s.sibling}}var fu=8192;function Bo(o){if(o.subtreeFlags&fu)for(o=o.child;o!==null;)Mb(o),o=o.sibling}function Mb(o){switch(o.tag){case 26:Bo(o),o.flags&fu&&o.memoizedState!==null&&nA(Sr,o.memoizedState,o.memoizedProps);break;case 5:Bo(o);break;case 3:case 4:var s=Sr;Sr=gc(o.stateNode.containerInfo),Bo(o),Sr=s;break;case 22:o.memoizedState===null&&(s=o.alternate,s!==null&&s.memoizedState!==null?(s=fu,fu=16777216,Bo(o),fu=s):Bo(o));break;default:Bo(o)}}function Ib(o){var s=o.alternate;if(s!==null&&(o=s.child,o!==null)){s.child=null;do s=o.sibling,o.sibling=null,o=s;while(o!==null)}}function hu(o){var s=o.deletions;if((o.flags&16)!==0){if(s!==null)for(var h=0;h<s.length;h++){var p=s[h];Yt=p,Bb(p,o)}Ib(o)}if(o.subtreeFlags&10256)for(o=o.child;o!==null;)Fb(o),o=o.sibling}function Fb(o){switch(o.tag){case 0:case 11:case 15:hu(o),o.flags&2048&&ja(9,o,o.return);break;case 3:hu(o);break;case 12:hu(o);break;case 22:var s=o.stateNode;o.memoizedState!==null&&s._visibility&2&&(o.return===null||o.return.tag!==13)?(s._visibility&=-3,ic(o)):hu(o);break;default:hu(o)}}function ic(o){var s=o.deletions;if((o.flags&16)!==0){if(s!==null)for(var h=0;h<s.length;h++){var p=s[h];Yt=p,Bb(p,o)}Ib(o)}for(o=o.child;o!==null;){switch(s=o,s.tag){case 0:case 11:case 15:ja(8,s,s.return),ic(s);break;case 22:h=s.stateNode,h._visibility&2&&(h._visibility&=-3,ic(s));break;default:ic(s)}o=o.sibling}}function Bb(o,s){for(;Yt!==null;){var h=Yt;switch(h.tag){case 0:case 11:case 15:ja(8,h,s);break;case 23:case 22:if(h.memoizedState!==null&&h.memoizedState.cachePool!==null){var p=h.memoizedState.cachePool.pool;p!=null&&p.refCount++}break;case 24:Ks(h.memoizedState.cache)}if(p=h.child,p!==null)p.return=h,Yt=p;else e:for(h=o;Yt!==null;){p=Yt;var y=p.sibling,x=p.return;if(Ab(p),p===h){Yt=null;break e}if(y!==null){y.return=x,Yt=y;break e}Yt=x}}}var yR={getCacheForType:function(o){var s=pn(zt),h=s.data.get(o);return h===void 0&&(h=o(),s.data.set(o,h)),h}},bR=typeof WeakMap=="function"?WeakMap:Map,it=0,dt=null,$e=null,Ze=0,ot=0,Wn=null,Ka=!1,Po=!1,Yd=!1,ga=0,At=0,Xa=0,Li=0,Qd=0,lr=0,Lo=0,du=null,Nn=null,Jd=!1,ep=0,oc=1/0,sc=null,Za=null,sn=0,Ya=null,zo=null,Uo=0,tp=0,np=null,Pb=null,pu=0,rp=null;function Gn(){if((it&2)!==0&&Ze!==0)return Ze&-Ze;if(L.T!==null){var o=Ao;return o!==0?o:cp()}return Jg()}function Lb(){lr===0&&(lr=(Ze&536870912)===0||nt?Xg():536870912);var o=ur.current;return o!==null&&(o.flags|=32),lr}function jn(o,s,h){(o===dt&&(ot===2||ot===9)||o.cancelPendingCommit!==null)&&(Ho(o,0),Qa(o,Ze,lr,!1)),Ns(o,h),((it&2)===0||o!==dt)&&(o===dt&&((it&2)===0&&(Li|=h),At===4&&Qa(o,Ze,lr,!1)),Br(o))}function zb(o,s,h){if((it&6)!==0)throw Error(r(327));var p=!h&&(s&124)===0&&(s&o.expiredLanes)===0||ks(o,s),y=p?SR(o,s):op(o,s,!0),x=p;do{if(y===0){Po&&!p&&Qa(o,s,0,!1);break}else{if(h=o.current.alternate,x&&!xR(h)){y=op(o,s,!1),x=!1;continue}if(y===2){if(x=s,o.errorRecoveryDisabledLanes&x)var T=0;else T=o.pendingLanes&-536870913,T=T!==0?T:T&536870912?536870912:0;if(T!==0){s=T;e:{var k=o;y=du;var z=k.current.memoizedState.isDehydrated;if(z&&(Ho(k,T).flags|=256),T=op(k,T,!1),T!==2){if(Yd&&!z){k.errorRecoveryDisabledLanes|=x,Li|=x,y=4;break e}x=Nn,Nn=y,x!==null&&(Nn===null?Nn=x:Nn.push.apply(Nn,x))}y=T}if(x=!1,y!==2)continue}}if(y===1){Ho(o,0),Qa(o,s,0,!0);break}e:{switch(p=o,x=y,x){case 0:case 1:throw Error(r(345));case 4:if((s&4194048)!==s)break;case 6:Qa(p,s,lr,!Ka);break e;case 2:Nn=null;break;case 3:case 5:break;default:throw Error(r(329))}if((s&62914560)===s&&(y=ep+300-Dt(),10<y)){if(Qa(p,s,lr,!Ka),yl(p,0,!0)!==0)break e;p.timeoutHandle=p1(Ub.bind(null,p,h,Nn,sc,Jd,s,lr,Li,Lo,Ka,x,2,-0,0),y);break e}Ub(p,h,Nn,sc,Jd,s,lr,Li,Lo,Ka,x,0,-0,0)}}break}while(!0);Br(o)}function Ub(o,s,h,p,y,x,T,k,z,Y,le,fe,Q,re){if(o.timeoutHandle=-1,fe=s.subtreeFlags,(fe&8192||(fe&16785408)===16785408)&&(wu={stylesheets:null,count:0,unsuspend:tA},Mb(s),fe=rA(),fe!==null)){o.cancelPendingCommit=fe($b.bind(null,o,s,x,h,p,y,T,k,z,le,1,Q,re)),Qa(o,x,T,!Y);return}$b(o,s,x,h,p,y,T,k,z)}function xR(o){for(var s=o;;){var h=s.tag;if((h===0||h===11||h===15)&&s.flags&16384&&(h=s.updateQueue,h!==null&&(h=h.stores,h!==null)))for(var p=0;p<h.length;p++){var y=h[p],x=y.getSnapshot;y=y.value;try{if(!zn(x(),y))return!1}catch{return!1}}if(h=s.child,s.subtreeFlags&16384&&h!==null)h.return=s,s=h;else{if(s===o)break;for(;s.sibling===null;){if(s.return===null||s.return===o)return!0;s=s.return}s.sibling.return=s.return,s=s.sibling}}return!0}function Qa(o,s,h,p){s&=~Qd,s&=~Li,o.suspendedLanes|=s,o.pingedLanes&=~s,p&&(o.warmLanes|=s),p=o.expirationTimes;for(var y=s;0<y;){var x=31-an(y),T=1<<x;p[x]=-1,y&=~T}h!==0&&Yg(o,h,s)}function uc(){return(it&6)===0?(vu(0),!1):!0}function ap(){if($e!==null){if(ot===0)var o=$e.return;else o=$e,la=Ni=null,wd(o),Mo=null,iu=0,o=$e;for(;o!==null;)bb(o.alternate,o),o=o.return;$e=null}}function Ho(o,s){var h=o.timeoutHandle;h!==-1&&(o.timeoutHandle=-1,LR(h)),h=o.cancelPendingCommit,h!==null&&(o.cancelPendingCommit=null,h()),ap(),dt=o,$e=h=oa(o.current,null),Ze=s,ot=0,Wn=null,Ka=!1,Po=ks(o,s),Yd=!1,Lo=lr=Qd=Li=Xa=At=0,Nn=du=null,Jd=!1,(s&8)!==0&&(s|=s&32);var p=o.entangledLanes;if(p!==0)for(o=o.entanglements,p&=s;0<p;){var y=31-an(p),x=1<<y;s|=o[y],p&=~x}return ga=s,Ol(),h}function Hb(o,s){Ge=null,L.H=Xl,s===Zs||s===zl?(s=a0(),ot=3):s===t0?(s=a0(),ot=4):ot=s===ib?8:s!==null&&typeof s=="object"&&typeof s.then=="function"?6:1,Wn=s,$e===null&&(At=1,ec(o,ar(s,o.current)))}function Vb(){var o=L.H;return L.H=Xl,o===null?Xl:o}function Wb(){var o=L.A;return L.A=yR,o}function ip(){At=4,Ka||(Ze&4194048)!==Ze&&ur.current!==null||(Po=!0),(Xa&134217727)===0&&(Li&134217727)===0||dt===null||Qa(dt,Ze,lr,!1)}function op(o,s,h){var p=it;it|=2;var y=Vb(),x=Wb();(dt!==o||Ze!==s)&&(sc=null,Ho(o,s)),s=!1;var T=At;e:do try{if(ot!==0&&$e!==null){var k=$e,z=Wn;switch(ot){case 8:ap(),T=6;break e;case 3:case 2:case 9:case 6:ur.current===null&&(s=!0);var Y=ot;if(ot=0,Wn=null,Vo(o,k,z,Y),h&&Po){T=0;break e}break;default:Y=ot,ot=0,Wn=null,Vo(o,k,z,Y)}}wR(),T=At;break}catch(le){Hb(o,le)}while(!0);return s&&o.shellSuspendCounter++,la=Ni=null,it=p,L.H=y,L.A=x,$e===null&&(dt=null,Ze=0,Ol()),T}function wR(){for(;$e!==null;)Gb($e)}function SR(o,s){var h=it;it|=2;var p=Vb(),y=Wb();dt!==o||Ze!==s?(sc=null,oc=Dt()+500,Ho(o,s)):Po=ks(o,s);e:do try{if(ot!==0&&$e!==null){s=$e;var x=Wn;t:switch(ot){case 1:ot=0,Wn=null,Vo(o,s,x,1);break;case 2:case 9:if(n0(x)){ot=0,Wn=null,jb(s);break}s=function(){ot!==2&&ot!==9||dt!==o||(ot=7),Br(o)},x.then(s,s);break e;case 3:ot=7;break e;case 4:ot=5;break e;case 7:n0(x)?(ot=0,Wn=null,jb(s)):(ot=0,Wn=null,Vo(o,s,x,7));break;case 5:var T=null;switch($e.tag){case 26:T=$e.memoizedState;case 5:case 27:var k=$e;if(!T||R1(T)){ot=0,Wn=null;var z=k.sibling;if(z!==null)$e=z;else{var Y=k.return;Y!==null?($e=Y,lc(Y)):$e=null}break t}}ot=0,Wn=null,Vo(o,s,x,5);break;case 6:ot=0,Wn=null,Vo(o,s,x,6);break;case 8:ap(),At=6;break e;default:throw Error(r(462))}}ER();break}catch(le){Hb(o,le)}while(!0);return la=Ni=null,L.H=p,L.A=y,it=h,$e!==null?0:(dt=null,Ze=0,Ol(),At)}function ER(){for(;$e!==null&&!ft();)Gb($e)}function Gb(o){var s=gb(o.alternate,o,ga);o.memoizedProps=o.pendingProps,s===null?lc(o):$e=s}function jb(o){var s=o,h=s.alternate;switch(s.tag){case 15:case 0:s=fb(h,s,s.pendingProps,s.type,void 0,Ze);break;case 11:s=fb(h,s,s.pendingProps,s.type.render,s.ref,Ze);break;case 5:wd(s);default:bb(h,s),s=$e=qy(s,ga),s=gb(h,s,ga)}o.memoizedProps=o.pendingProps,s===null?lc(o):$e=s}function Vo(o,s,h,p){la=Ni=null,wd(s),Mo=null,iu=0;var y=s.return;try{if(hR(o,y,s,h,Ze)){At=1,ec(o,ar(h,o.current)),$e=null;return}}catch(x){if(y!==null)throw $e=y,x;At=1,ec(o,ar(h,o.current)),$e=null;return}s.flags&32768?(nt||p===1?o=!0:Po||(Ze&536870912)!==0?o=!1:(Ka=o=!0,(p===2||p===9||p===3||p===6)&&(p=ur.current,p!==null&&p.tag===13&&(p.flags|=16384))),qb(s,o)):lc(s)}function lc(o){var s=o;do{if((s.flags&32768)!==0){qb(s,Ka);return}o=s.return;var h=pR(s.alternate,s,ga);if(h!==null){$e=h;return}if(s=s.sibling,s!==null){$e=s;return}$e=s=o}while(s!==null);At===0&&(At=5)}function qb(o,s){do{var h=vR(o.alternate,o);if(h!==null){h.flags&=32767,$e=h;return}if(h=o.return,h!==null&&(h.flags|=32768,h.subtreeFlags=0,h.deletions=null),!s&&(o=o.sibling,o!==null)){$e=o;return}$e=o=h}while(o!==null);At=6,$e=null}function $b(o,s,h,p,y,x,T,k,z){o.cancelPendingCommit=null;do cc();while(sn!==0);if((it&6)!==0)throw Error(r(327));if(s!==null){if(s===o.current)throw Error(r(177));if(x=s.lanes|s.childLanes,x|=Zh,tC(o,h,x,T,k,z),o===dt&&($e=dt=null,Ze=0),zo=s,Ya=o,Uo=h,tp=x,np=y,Pb=p,(s.subtreeFlags&10256)!==0||(s.flags&10256)!==0?(o.callbackNode=null,o.callbackPriority=0,AR(An,function(){return Qb(),null})):(o.callbackNode=null,o.callbackPriority=0),p=(s.flags&13878)!==0,(s.subtreeFlags&13878)!==0||p){p=L.T,L.T=null,y=W.p,W.p=2,T=it,it|=4;try{mR(o,s,h)}finally{it=T,W.p=y,L.T=p}}sn=1,Kb(),Xb(),Zb()}}function Kb(){if(sn===1){sn=0;var o=Ya,s=zo,h=(s.flags&13878)!==0;if((s.subtreeFlags&13878)!==0||h){h=L.T,L.T=null;var p=W.p;W.p=2;var y=it;it|=4;try{Ob(s,o);var x=yp,T=By(o.containerInfo),k=x.focusedElem,z=x.selectionRange;if(T!==k&&k&&k.ownerDocument&&Fy(k.ownerDocument.documentElement,k)){if(z!==null&&jh(k)){var Y=z.start,le=z.end;if(le===void 0&&(le=Y),"selectionStart"in k)k.selectionStart=Y,k.selectionEnd=Math.min(le,k.value.length);else{var fe=k.ownerDocument||document,Q=fe&&fe.defaultView||window;if(Q.getSelection){var re=Q.getSelection(),Me=k.textContent.length,Oe=Math.min(z.start,Me),ct=z.end===void 0?Oe:Math.min(z.end,Me);!re.extend&&Oe>ct&&(T=ct,ct=Oe,Oe=T);var K=Iy(k,Oe),G=Iy(k,ct);if(K&&G&&(re.rangeCount!==1||re.anchorNode!==K.node||re.anchorOffset!==K.offset||re.focusNode!==G.node||re.focusOffset!==G.offset)){var X=fe.createRange();X.setStart(K.node,K.offset),re.removeAllRanges(),Oe>ct?(re.addRange(X),re.extend(G.node,G.offset)):(X.setEnd(G.node,G.offset),re.addRange(X))}}}}for(fe=[],re=k;re=re.parentNode;)re.nodeType===1&&fe.push({element:re,left:re.scrollLeft,top:re.scrollTop});for(typeof k.focus=="function"&&k.focus(),k=0;k<fe.length;k++){var ce=fe[k];ce.element.scrollLeft=ce.left,ce.element.scrollTop=ce.top}}Sc=!!gp,yp=gp=null}finally{it=y,W.p=p,L.T=h}}o.current=s,sn=2}}function Xb(){if(sn===2){sn=0;var o=Ya,s=zo,h=(s.flags&8772)!==0;if((s.subtreeFlags&8772)!==0||h){h=L.T,L.T=null;var p=W.p;W.p=2;var y=it;it|=4;try{Rb(o,s.alternate,s)}finally{it=y,W.p=p,L.T=h}}sn=3}}function Zb(){if(sn===4||sn===3){sn=0,st();var o=Ya,s=zo,h=Uo,p=Pb;(s.subtreeFlags&10256)!==0||(s.flags&10256)!==0?sn=5:(sn=0,zo=Ya=null,Yb(o,o.pendingLanes));var y=o.pendingLanes;if(y===0&&(Za=null),_h(h),s=s.stateNode,Mt&&typeof Mt.onCommitFiberRoot=="function")try{Mt.onCommitFiberRoot(ra,s,void 0,(s.current.flags&128)===128)}catch{}if(p!==null){s=L.T,y=W.p,W.p=2,L.T=null;try{for(var x=o.onRecoverableError,T=0;T<p.length;T++){var k=p[T];x(k.value,{componentStack:k.stack})}}finally{L.T=s,W.p=y}}(Uo&3)!==0&&cc(),Br(o),y=o.pendingLanes,(h&4194090)!==0&&(y&42)!==0?o===rp?pu++:(pu=0,rp=o):pu=0,vu(0)}}function Yb(o,s){(o.pooledCacheLanes&=s)===0&&(s=o.pooledCache,s!=null&&(o.pooledCache=null,Ks(s)))}function cc(o){return Kb(),Xb(),Zb(),Qb()}function Qb(){if(sn!==5)return!1;var o=Ya,s=tp;tp=0;var h=_h(Uo),p=L.T,y=W.p;try{W.p=32>h?32:h,L.T=null,h=np,np=null;var x=Ya,T=Uo;if(sn=0,zo=Ya=null,Uo=0,(it&6)!==0)throw Error(r(331));var k=it;if(it|=4,Fb(x.current),Nb(x,x.current,T,h),it=k,vu(0,!1),Mt&&typeof Mt.onPostCommitFiberRoot=="function")try{Mt.onPostCommitFiberRoot(ra,x)}catch{}return!0}finally{W.p=y,L.T=p,Yb(o,s)}}function Jb(o,s,h){s=ar(h,s),s=Fd(o.stateNode,s,2),o=Ha(o,s,2),o!==null&&(Ns(o,2),Br(o))}function ht(o,s,h){if(o.tag===3)Jb(o,o,h);else for(;s!==null;){if(s.tag===3){Jb(s,o,h);break}else if(s.tag===1){var p=s.stateNode;if(typeof s.type.getDerivedStateFromError=="function"||typeof p.componentDidCatch=="function"&&(Za===null||!Za.has(p))){o=ar(h,o),h=rb(2),p=Ha(s,h,2),p!==null&&(ab(h,p,s,o),Ns(p,2),Br(p));break}}s=s.return}}function sp(o,s,h){var p=o.pingCache;if(p===null){p=o.pingCache=new bR;var y=new Set;p.set(s,y)}else y=p.get(s),y===void 0&&(y=new Set,p.set(s,y));y.has(h)||(Yd=!0,y.add(h),o=_R.bind(null,o,s,h),s.then(o,o))}function _R(o,s,h){var p=o.pingCache;p!==null&&p.delete(s),o.pingedLanes|=o.suspendedLanes&h,o.warmLanes&=~h,dt===o&&(Ze&h)===h&&(At===4||At===3&&(Ze&62914560)===Ze&&300>Dt()-ep?(it&2)===0&&Ho(o,0):Qd|=h,Lo===Ze&&(Lo=0)),Br(o)}function e1(o,s){s===0&&(s=Zg()),o=Eo(o,s),o!==null&&(Ns(o,s),Br(o))}function CR(o){var s=o.memoizedState,h=0;s!==null&&(h=s.retryLane),e1(o,h)}function RR(o,s){var h=0;switch(o.tag){case 13:var p=o.stateNode,y=o.memoizedState;y!==null&&(h=y.retryLane);break;case 19:p=o.stateNode;break;case 22:p=o.stateNode._retryCache;break;default:throw Error(r(314))}p!==null&&p.delete(s),e1(o,h)}function AR(o,s){return We(o,s)}var fc=null,Wo=null,up=!1,hc=!1,lp=!1,zi=0;function Br(o){o!==Wo&&o.next===null&&(Wo===null?fc=Wo=o:Wo=Wo.next=o),hc=!0,up||(up=!0,DR())}function vu(o,s){if(!lp&&hc){lp=!0;do for(var h=!1,p=fc;p!==null;){if(o!==0){var y=p.pendingLanes;if(y===0)var x=0;else{var T=p.suspendedLanes,k=p.pingedLanes;x=(1<<31-an(42|o)+1)-1,x&=y&~(T&~k),x=x&201326741?x&201326741|1:x?x|2:0}x!==0&&(h=!0,a1(p,x))}else x=Ze,x=yl(p,p===dt?x:0,p.cancelPendingCommit!==null||p.timeoutHandle!==-1),(x&3)===0||ks(p,x)||(h=!0,a1(p,x));p=p.next}while(h);lp=!1}}function TR(){t1()}function t1(){hc=up=!1;var o=0;zi!==0&&(PR()&&(o=zi),zi=0);for(var s=Dt(),h=null,p=fc;p!==null;){var y=p.next,x=n1(p,s);x===0?(p.next=null,h===null?fc=y:h.next=y,y===null&&(Wo=h)):(h=p,(o!==0||(x&3)!==0)&&(hc=!0)),p=y}vu(o)}function n1(o,s){for(var h=o.suspendedLanes,p=o.pingedLanes,y=o.expirationTimes,x=o.pendingLanes&-62914561;0<x;){var T=31-an(x),k=1<<T,z=y[T];z===-1?((k&h)===0||(k&p)!==0)&&(y[T]=eC(k,s)):z<=s&&(o.expiredLanes|=k),x&=~k}if(s=dt,h=Ze,h=yl(o,o===s?h:0,o.cancelPendingCommit!==null||o.timeoutHandle!==-1),p=o.callbackNode,h===0||o===s&&(ot===2||ot===9)||o.cancelPendingCommit!==null)return p!==null&&p!==null&&tt(p),o.callbackNode=null,o.callbackPriority=0;if((h&3)===0||ks(o,h)){if(s=h&-h,s===o.callbackPriority)return s;switch(p!==null&&tt(p),_h(h)){case 2:case 8:h=na;break;case 32:h=An;break;case 268435456:h=tr;break;default:h=An}return p=r1.bind(null,o),h=We(h,p),o.callbackPriority=s,o.callbackNode=h,s}return p!==null&&p!==null&&tt(p),o.callbackPriority=2,o.callbackNode=null,2}function r1(o,s){if(sn!==0&&sn!==5)return o.callbackNode=null,o.callbackPriority=0,null;var h=o.callbackNode;if(cc()&&o.callbackNode!==h)return null;var p=Ze;return p=yl(o,o===dt?p:0,o.cancelPendingCommit!==null||o.timeoutHandle!==-1),p===0?null:(zb(o,p,s),n1(o,Dt()),o.callbackNode!=null&&o.callbackNode===h?r1.bind(null,o):null)}function a1(o,s){if(cc())return null;zb(o,s,!0)}function DR(){zR(function(){(it&6)!==0?We(hn,TR):t1()})}function cp(){return zi===0&&(zi=Xg()),zi}function i1(o){return o==null||typeof o=="symbol"||typeof o=="boolean"?null:typeof o=="function"?o:El(""+o)}function o1(o,s){var h=s.ownerDocument.createElement("input");return h.name=s.name,h.value=s.value,o.id&&h.setAttribute("form",o.id),s.parentNode.insertBefore(h,s),o=new FormData(o),h.parentNode.removeChild(h),o}function OR(o,s,h,p,y){if(s==="submit"&&h&&h.stateNode===y){var x=i1((y[Tn]||null).action),T=p.submitter;T&&(s=(s=T[Tn]||null)?i1(s.formAction):T.getAttribute("formAction"),s!==null&&(x=s,T=null));var k=new Al("action","action",null,p,y);o.push({event:k,listeners:[{instance:null,listener:function(){if(p.defaultPrevented){if(zi!==0){var z=T?o1(y,T):new FormData(y);Od(h,{pending:!0,data:z,method:y.method,action:x},null,z)}}else typeof x=="function"&&(k.preventDefault(),z=T?o1(y,T):new FormData(y),Od(h,{pending:!0,data:z,method:y.method,action:x},x,z))},currentTarget:y}]})}}for(var fp=0;fp<Xh.length;fp++){var hp=Xh[fp],kR=hp.toLowerCase(),NR=hp[0].toUpperCase()+hp.slice(1);wr(kR,"on"+NR)}wr(zy,"onAnimationEnd"),wr(Uy,"onAnimationIteration"),wr(Hy,"onAnimationStart"),wr("dblclick","onDoubleClick"),wr("focusin","onFocus"),wr("focusout","onBlur"),wr(XC,"onTransitionRun"),wr(ZC,"onTransitionStart"),wr(YC,"onTransitionCancel"),wr(Vy,"onTransitionEnd"),ho("onMouseEnter",["mouseout","mouseover"]),ho("onMouseLeave",["mouseout","mouseover"]),ho("onPointerEnter",["pointerout","pointerover"]),ho("onPointerLeave",["pointerout","pointerover"]),Ei("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Ei("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Ei("onBeforeInput",["compositionend","keypress","textInput","paste"]),Ei("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Ei("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Ei("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var mu="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),MR=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(mu));function s1(o,s){s=(s&4)!==0;for(var h=0;h<o.length;h++){var p=o[h],y=p.event;p=p.listeners;e:{var x=void 0;if(s)for(var T=p.length-1;0<=T;T--){var k=p[T],z=k.instance,Y=k.currentTarget;if(k=k.listener,z!==x&&y.isPropagationStopped())break e;x=k,y.currentTarget=Y;try{x(y)}catch(le){Jl(le)}y.currentTarget=null,x=z}else for(T=0;T<p.length;T++){if(k=p[T],z=k.instance,Y=k.currentTarget,k=k.listener,z!==x&&y.isPropagationStopped())break e;x=k,y.currentTarget=Y;try{x(y)}catch(le){Jl(le)}y.currentTarget=null,x=z}}}}function Ke(o,s){var h=s[Ch];h===void 0&&(h=s[Ch]=new Set);var p=o+"__bubble";h.has(p)||(u1(s,o,2,!1),h.add(p))}function dp(o,s,h){var p=0;s&&(p|=4),u1(h,o,p,s)}var dc="_reactListening"+Math.random().toString(36).slice(2);function pp(o){if(!o[dc]){o[dc]=!0,ty.forEach(function(h){h!=="selectionchange"&&(MR.has(h)||dp(h,!1,o),dp(h,!0,o))});var s=o.nodeType===9?o:o.ownerDocument;s===null||s[dc]||(s[dc]=!0,dp("selectionchange",!1,s))}}function u1(o,s,h,p){switch(N1(s)){case 2:var y=oA;break;case 8:y=sA;break;default:y=Tp}h=y.bind(null,s,h,o),y=void 0,!Bh||s!=="touchstart"&&s!=="touchmove"&&s!=="wheel"||(y=!0),p?y!==void 0?o.addEventListener(s,h,{capture:!0,passive:y}):o.addEventListener(s,h,!0):y!==void 0?o.addEventListener(s,h,{passive:y}):o.addEventListener(s,h,!1)}function vp(o,s,h,p,y){var x=p;if((s&1)===0&&(s&2)===0&&p!==null)e:for(;;){if(p===null)return;var T=p.tag;if(T===3||T===4){var k=p.stateNode.containerInfo;if(k===y)break;if(T===4)for(T=p.return;T!==null;){var z=T.tag;if((z===3||z===4)&&T.stateNode.containerInfo===y)return;T=T.return}for(;k!==null;){if(T=lo(k),T===null)return;if(z=T.tag,z===5||z===6||z===26||z===27){p=x=T;continue e}k=k.parentNode}}p=p.return}vy(function(){var Y=x,le=Ih(h),fe=[];e:{var Q=Wy.get(o);if(Q!==void 0){var re=Al,Me=o;switch(o){case"keypress":if(Cl(h)===0)break e;case"keydown":case"keyup":re=AC;break;case"focusin":Me="focus",re=Uh;break;case"focusout":Me="blur",re=Uh;break;case"beforeblur":case"afterblur":re=Uh;break;case"click":if(h.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":re=yy;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":re=vC;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":re=OC;break;case zy:case Uy:case Hy:re=yC;break;case Vy:re=NC;break;case"scroll":case"scrollend":re=dC;break;case"wheel":re=IC;break;case"copy":case"cut":case"paste":re=xC;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":re=xy;break;case"toggle":case"beforetoggle":re=BC}var Oe=(s&4)!==0,ct=!Oe&&(o==="scroll"||o==="scrollend"),K=Oe?Q!==null?Q+"Capture":null:Q;Oe=[];for(var G=Y,X;G!==null;){var ce=G;if(X=ce.stateNode,ce=ce.tag,ce!==5&&ce!==26&&ce!==27||X===null||K===null||(ce=Fs(G,K),ce!=null&&Oe.push(gu(G,ce,X))),ct)break;G=G.return}0<Oe.length&&(Q=new re(Q,Me,null,h,le),fe.push({event:Q,listeners:Oe}))}}if((s&7)===0){e:{if(Q=o==="mouseover"||o==="pointerover",re=o==="mouseout"||o==="pointerout",Q&&h!==Mh&&(Me=h.relatedTarget||h.fromElement)&&(lo(Me)||Me[uo]))break e;if((re||Q)&&(Q=le.window===le?le:(Q=le.ownerDocument)?Q.defaultView||Q.parentWindow:window,re?(Me=h.relatedTarget||h.toElement,re=Y,Me=Me?lo(Me):null,Me!==null&&(ct=i(Me),Oe=Me.tag,Me!==ct||Oe!==5&&Oe!==27&&Oe!==6)&&(Me=null)):(re=null,Me=Y),re!==Me)){if(Oe=yy,ce="onMouseLeave",K="onMouseEnter",G="mouse",(o==="pointerout"||o==="pointerover")&&(Oe=xy,ce="onPointerLeave",K="onPointerEnter",G="pointer"),ct=re==null?Q:Is(re),X=Me==null?Q:Is(Me),Q=new Oe(ce,G+"leave",re,h,le),Q.target=ct,Q.relatedTarget=X,ce=null,lo(le)===Y&&(Oe=new Oe(K,G+"enter",Me,h,le),Oe.target=X,Oe.relatedTarget=ct,ce=Oe),ct=ce,re&&Me)t:{for(Oe=re,K=Me,G=0,X=Oe;X;X=Go(X))G++;for(X=0,ce=K;ce;ce=Go(ce))X++;for(;0<G-X;)Oe=Go(Oe),G--;for(;0<X-G;)K=Go(K),X--;for(;G--;){if(Oe===K||K!==null&&Oe===K.alternate)break t;Oe=Go(Oe),K=Go(K)}Oe=null}else Oe=null;re!==null&&l1(fe,Q,re,Oe,!1),Me!==null&&ct!==null&&l1(fe,ct,Me,Oe,!0)}}e:{if(Q=Y?Is(Y):window,re=Q.nodeName&&Q.nodeName.toLowerCase(),re==="select"||re==="input"&&Q.type==="file")var xe=Ty;else if(Ry(Q))if(Dy)xe=qC;else{xe=GC;var je=WC}else re=Q.nodeName,!re||re.toLowerCase()!=="input"||Q.type!=="checkbox"&&Q.type!=="radio"?Y&&Nh(Y.elementType)&&(xe=Ty):xe=jC;if(xe&&(xe=xe(o,Y))){Ay(fe,xe,h,le);break e}je&&je(o,Q,Y),o==="focusout"&&Y&&Q.type==="number"&&Y.memoizedProps.value!=null&&kh(Q,"number",Q.value)}switch(je=Y?Is(Y):window,o){case"focusin":(Ry(je)||je.contentEditable==="true")&&(xo=je,qh=Y,Ws=null);break;case"focusout":Ws=qh=xo=null;break;case"mousedown":$h=!0;break;case"contextmenu":case"mouseup":case"dragend":$h=!1,Py(fe,h,le);break;case"selectionchange":if(KC)break;case"keydown":case"keyup":Py(fe,h,le)}var Te;if(Vh)e:{switch(o){case"compositionstart":var ke="onCompositionStart";break e;case"compositionend":ke="onCompositionEnd";break e;case"compositionupdate":ke="onCompositionUpdate";break e}ke=void 0}else bo?_y(o,h)&&(ke="onCompositionEnd"):o==="keydown"&&h.keyCode===229&&(ke="onCompositionStart");ke&&(wy&&h.locale!=="ko"&&(bo||ke!=="onCompositionStart"?ke==="onCompositionEnd"&&bo&&(Te=my()):(Pa=le,Ph="value"in Pa?Pa.value:Pa.textContent,bo=!0)),je=pc(Y,ke),0<je.length&&(ke=new by(ke,o,null,h,le),fe.push({event:ke,listeners:je}),Te?ke.data=Te:(Te=Cy(h),Te!==null&&(ke.data=Te)))),(Te=LC?zC(o,h):UC(o,h))&&(ke=pc(Y,"onBeforeInput"),0<ke.length&&(je=new by("onBeforeInput","beforeinput",null,h,le),fe.push({event:je,listeners:ke}),je.data=Te)),OR(fe,o,Y,h,le)}s1(fe,s)})}function gu(o,s,h){return{instance:o,listener:s,currentTarget:h}}function pc(o,s){for(var h=s+"Capture",p=[];o!==null;){var y=o,x=y.stateNode;if(y=y.tag,y!==5&&y!==26&&y!==27||x===null||(y=Fs(o,h),y!=null&&p.unshift(gu(o,y,x)),y=Fs(o,s),y!=null&&p.push(gu(o,y,x))),o.tag===3)return p;o=o.return}return[]}function Go(o){if(o===null)return null;do o=o.return;while(o&&o.tag!==5&&o.tag!==27);return o||null}function l1(o,s,h,p,y){for(var x=s._reactName,T=[];h!==null&&h!==p;){var k=h,z=k.alternate,Y=k.stateNode;if(k=k.tag,z!==null&&z===p)break;k!==5&&k!==26&&k!==27||Y===null||(z=Y,y?(Y=Fs(h,x),Y!=null&&T.unshift(gu(h,Y,z))):y||(Y=Fs(h,x),Y!=null&&T.push(gu(h,Y,z)))),h=h.return}T.length!==0&&o.push({event:s,listeners:T})}var IR=/\r\n?/g,FR=/\u0000|\uFFFD/g;function c1(o){return(typeof o=="string"?o:""+o).replace(IR,`
`).replace(FR,"")}function f1(o,s){return s=c1(s),c1(o)===s}function vc(){}function lt(o,s,h,p,y,x){switch(h){case"children":typeof p=="string"?s==="body"||s==="textarea"&&p===""||mo(o,p):(typeof p=="number"||typeof p=="bigint")&&s!=="body"&&mo(o,""+p);break;case"className":xl(o,"class",p);break;case"tabIndex":xl(o,"tabindex",p);break;case"dir":case"role":case"viewBox":case"width":case"height":xl(o,h,p);break;case"style":dy(o,p,x);break;case"data":if(s!=="object"){xl(o,"data",p);break}case"src":case"href":if(p===""&&(s!=="a"||h!=="href")){o.removeAttribute(h);break}if(p==null||typeof p=="function"||typeof p=="symbol"||typeof p=="boolean"){o.removeAttribute(h);break}p=El(""+p),o.setAttribute(h,p);break;case"action":case"formAction":if(typeof p=="function"){o.setAttribute(h,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof x=="function"&&(h==="formAction"?(s!=="input"&&lt(o,s,"name",y.name,y,null),lt(o,s,"formEncType",y.formEncType,y,null),lt(o,s,"formMethod",y.formMethod,y,null),lt(o,s,"formTarget",y.formTarget,y,null)):(lt(o,s,"encType",y.encType,y,null),lt(o,s,"method",y.method,y,null),lt(o,s,"target",y.target,y,null)));if(p==null||typeof p=="symbol"||typeof p=="boolean"){o.removeAttribute(h);break}p=El(""+p),o.setAttribute(h,p);break;case"onClick":p!=null&&(o.onclick=vc);break;case"onScroll":p!=null&&Ke("scroll",o);break;case"onScrollEnd":p!=null&&Ke("scrollend",o);break;case"dangerouslySetInnerHTML":if(p!=null){if(typeof p!="object"||!("__html"in p))throw Error(r(61));if(h=p.__html,h!=null){if(y.children!=null)throw Error(r(60));o.innerHTML=h}}break;case"multiple":o.multiple=p&&typeof p!="function"&&typeof p!="symbol";break;case"muted":o.muted=p&&typeof p!="function"&&typeof p!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(p==null||typeof p=="function"||typeof p=="boolean"||typeof p=="symbol"){o.removeAttribute("xlink:href");break}h=El(""+p),o.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",h);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":p!=null&&typeof p!="function"&&typeof p!="symbol"?o.setAttribute(h,""+p):o.removeAttribute(h);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":p&&typeof p!="function"&&typeof p!="symbol"?o.setAttribute(h,""):o.removeAttribute(h);break;case"capture":case"download":p===!0?o.setAttribute(h,""):p!==!1&&p!=null&&typeof p!="function"&&typeof p!="symbol"?o.setAttribute(h,p):o.removeAttribute(h);break;case"cols":case"rows":case"size":case"span":p!=null&&typeof p!="function"&&typeof p!="symbol"&&!isNaN(p)&&1<=p?o.setAttribute(h,p):o.removeAttribute(h);break;case"rowSpan":case"start":p==null||typeof p=="function"||typeof p=="symbol"||isNaN(p)?o.removeAttribute(h):o.setAttribute(h,p);break;case"popover":Ke("beforetoggle",o),Ke("toggle",o),bl(o,"popover",p);break;case"xlinkActuate":aa(o,"http://www.w3.org/1999/xlink","xlink:actuate",p);break;case"xlinkArcrole":aa(o,"http://www.w3.org/1999/xlink","xlink:arcrole",p);break;case"xlinkRole":aa(o,"http://www.w3.org/1999/xlink","xlink:role",p);break;case"xlinkShow":aa(o,"http://www.w3.org/1999/xlink","xlink:show",p);break;case"xlinkTitle":aa(o,"http://www.w3.org/1999/xlink","xlink:title",p);break;case"xlinkType":aa(o,"http://www.w3.org/1999/xlink","xlink:type",p);break;case"xmlBase":aa(o,"http://www.w3.org/XML/1998/namespace","xml:base",p);break;case"xmlLang":aa(o,"http://www.w3.org/XML/1998/namespace","xml:lang",p);break;case"xmlSpace":aa(o,"http://www.w3.org/XML/1998/namespace","xml:space",p);break;case"is":bl(o,"is",p);break;case"innerText":case"textContent":break;default:(!(2<h.length)||h[0]!=="o"&&h[0]!=="O"||h[1]!=="n"&&h[1]!=="N")&&(h=fC.get(h)||h,bl(o,h,p))}}function mp(o,s,h,p,y,x){switch(h){case"style":dy(o,p,x);break;case"dangerouslySetInnerHTML":if(p!=null){if(typeof p!="object"||!("__html"in p))throw Error(r(61));if(h=p.__html,h!=null){if(y.children!=null)throw Error(r(60));o.innerHTML=h}}break;case"children":typeof p=="string"?mo(o,p):(typeof p=="number"||typeof p=="bigint")&&mo(o,""+p);break;case"onScroll":p!=null&&Ke("scroll",o);break;case"onScrollEnd":p!=null&&Ke("scrollend",o);break;case"onClick":p!=null&&(o.onclick=vc);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!ny.hasOwnProperty(h))e:{if(h[0]==="o"&&h[1]==="n"&&(y=h.endsWith("Capture"),s=h.slice(2,y?h.length-7:void 0),x=o[Tn]||null,x=x!=null?x[h]:null,typeof x=="function"&&o.removeEventListener(s,x,y),typeof p=="function")){typeof x!="function"&&x!==null&&(h in o?o[h]=null:o.hasAttribute(h)&&o.removeAttribute(h)),o.addEventListener(s,p,y);break e}h in o?o[h]=p:p===!0?o.setAttribute(h,""):bl(o,h,p)}}}function un(o,s,h){switch(s){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Ke("error",o),Ke("load",o);var p=!1,y=!1,x;for(x in h)if(h.hasOwnProperty(x)){var T=h[x];if(T!=null)switch(x){case"src":p=!0;break;case"srcSet":y=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(r(137,s));default:lt(o,s,x,T,h,null)}}y&&lt(o,s,"srcSet",h.srcSet,h,null),p&&lt(o,s,"src",h.src,h,null);return;case"input":Ke("invalid",o);var k=x=T=y=null,z=null,Y=null;for(p in h)if(h.hasOwnProperty(p)){var le=h[p];if(le!=null)switch(p){case"name":y=le;break;case"type":T=le;break;case"checked":z=le;break;case"defaultChecked":Y=le;break;case"value":x=le;break;case"defaultValue":k=le;break;case"children":case"dangerouslySetInnerHTML":if(le!=null)throw Error(r(137,s));break;default:lt(o,s,p,le,h,null)}}ly(o,x,k,z,Y,T,y,!1),wl(o);return;case"select":Ke("invalid",o),p=T=x=null;for(y in h)if(h.hasOwnProperty(y)&&(k=h[y],k!=null))switch(y){case"value":x=k;break;case"defaultValue":T=k;break;case"multiple":p=k;default:lt(o,s,y,k,h,null)}s=x,h=T,o.multiple=!!p,s!=null?vo(o,!!p,s,!1):h!=null&&vo(o,!!p,h,!0);return;case"textarea":Ke("invalid",o),x=y=p=null;for(T in h)if(h.hasOwnProperty(T)&&(k=h[T],k!=null))switch(T){case"value":p=k;break;case"defaultValue":y=k;break;case"children":x=k;break;case"dangerouslySetInnerHTML":if(k!=null)throw Error(r(91));break;default:lt(o,s,T,k,h,null)}fy(o,p,y,x),wl(o);return;case"option":for(z in h)if(h.hasOwnProperty(z)&&(p=h[z],p!=null))switch(z){case"selected":o.selected=p&&typeof p!="function"&&typeof p!="symbol";break;default:lt(o,s,z,p,h,null)}return;case"dialog":Ke("beforetoggle",o),Ke("toggle",o),Ke("cancel",o),Ke("close",o);break;case"iframe":case"object":Ke("load",o);break;case"video":case"audio":for(p=0;p<mu.length;p++)Ke(mu[p],o);break;case"image":Ke("error",o),Ke("load",o);break;case"details":Ke("toggle",o);break;case"embed":case"source":case"link":Ke("error",o),Ke("load",o);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(Y in h)if(h.hasOwnProperty(Y)&&(p=h[Y],p!=null))switch(Y){case"children":case"dangerouslySetInnerHTML":throw Error(r(137,s));default:lt(o,s,Y,p,h,null)}return;default:if(Nh(s)){for(le in h)h.hasOwnProperty(le)&&(p=h[le],p!==void 0&&mp(o,s,le,p,h,void 0));return}}for(k in h)h.hasOwnProperty(k)&&(p=h[k],p!=null&&lt(o,s,k,p,h,null))}function BR(o,s,h,p){switch(s){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var y=null,x=null,T=null,k=null,z=null,Y=null,le=null;for(re in h){var fe=h[re];if(h.hasOwnProperty(re)&&fe!=null)switch(re){case"checked":break;case"value":break;case"defaultValue":z=fe;default:p.hasOwnProperty(re)||lt(o,s,re,null,p,fe)}}for(var Q in p){var re=p[Q];if(fe=h[Q],p.hasOwnProperty(Q)&&(re!=null||fe!=null))switch(Q){case"type":x=re;break;case"name":y=re;break;case"checked":Y=re;break;case"defaultChecked":le=re;break;case"value":T=re;break;case"defaultValue":k=re;break;case"children":case"dangerouslySetInnerHTML":if(re!=null)throw Error(r(137,s));break;default:re!==fe&&lt(o,s,Q,re,p,fe)}}Oh(o,T,k,z,Y,le,x,y);return;case"select":re=T=k=Q=null;for(x in h)if(z=h[x],h.hasOwnProperty(x)&&z!=null)switch(x){case"value":break;case"multiple":re=z;default:p.hasOwnProperty(x)||lt(o,s,x,null,p,z)}for(y in p)if(x=p[y],z=h[y],p.hasOwnProperty(y)&&(x!=null||z!=null))switch(y){case"value":Q=x;break;case"defaultValue":k=x;break;case"multiple":T=x;default:x!==z&&lt(o,s,y,x,p,z)}s=k,h=T,p=re,Q!=null?vo(o,!!h,Q,!1):!!p!=!!h&&(s!=null?vo(o,!!h,s,!0):vo(o,!!h,h?[]:"",!1));return;case"textarea":re=Q=null;for(k in h)if(y=h[k],h.hasOwnProperty(k)&&y!=null&&!p.hasOwnProperty(k))switch(k){case"value":break;case"children":break;default:lt(o,s,k,null,p,y)}for(T in p)if(y=p[T],x=h[T],p.hasOwnProperty(T)&&(y!=null||x!=null))switch(T){case"value":Q=y;break;case"defaultValue":re=y;break;case"children":break;case"dangerouslySetInnerHTML":if(y!=null)throw Error(r(91));break;default:y!==x&&lt(o,s,T,y,p,x)}cy(o,Q,re);return;case"option":for(var Me in h)if(Q=h[Me],h.hasOwnProperty(Me)&&Q!=null&&!p.hasOwnProperty(Me))switch(Me){case"selected":o.selected=!1;break;default:lt(o,s,Me,null,p,Q)}for(z in p)if(Q=p[z],re=h[z],p.hasOwnProperty(z)&&Q!==re&&(Q!=null||re!=null))switch(z){case"selected":o.selected=Q&&typeof Q!="function"&&typeof Q!="symbol";break;default:lt(o,s,z,Q,p,re)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Oe in h)Q=h[Oe],h.hasOwnProperty(Oe)&&Q!=null&&!p.hasOwnProperty(Oe)&&lt(o,s,Oe,null,p,Q);for(Y in p)if(Q=p[Y],re=h[Y],p.hasOwnProperty(Y)&&Q!==re&&(Q!=null||re!=null))switch(Y){case"children":case"dangerouslySetInnerHTML":if(Q!=null)throw Error(r(137,s));break;default:lt(o,s,Y,Q,p,re)}return;default:if(Nh(s)){for(var ct in h)Q=h[ct],h.hasOwnProperty(ct)&&Q!==void 0&&!p.hasOwnProperty(ct)&&mp(o,s,ct,void 0,p,Q);for(le in p)Q=p[le],re=h[le],!p.hasOwnProperty(le)||Q===re||Q===void 0&&re===void 0||mp(o,s,le,Q,p,re);return}}for(var K in h)Q=h[K],h.hasOwnProperty(K)&&Q!=null&&!p.hasOwnProperty(K)&&lt(o,s,K,null,p,Q);for(fe in p)Q=p[fe],re=h[fe],!p.hasOwnProperty(fe)||Q===re||Q==null&&re==null||lt(o,s,fe,Q,p,re)}var gp=null,yp=null;function mc(o){return o.nodeType===9?o:o.ownerDocument}function h1(o){switch(o){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function d1(o,s){if(o===0)switch(s){case"svg":return 1;case"math":return 2;default:return 0}return o===1&&s==="foreignObject"?0:o}function bp(o,s){return o==="textarea"||o==="noscript"||typeof s.children=="string"||typeof s.children=="number"||typeof s.children=="bigint"||typeof s.dangerouslySetInnerHTML=="object"&&s.dangerouslySetInnerHTML!==null&&s.dangerouslySetInnerHTML.__html!=null}var xp=null;function PR(){var o=window.event;return o&&o.type==="popstate"?o===xp?!1:(xp=o,!0):(xp=null,!1)}var p1=typeof setTimeout=="function"?setTimeout:void 0,LR=typeof clearTimeout=="function"?clearTimeout:void 0,v1=typeof Promise=="function"?Promise:void 0,zR=typeof queueMicrotask=="function"?queueMicrotask:typeof v1<"u"?function(o){return v1.resolve(null).then(o).catch(UR)}:p1;function UR(o){setTimeout(function(){throw o})}function Ja(o){return o==="head"}function m1(o,s){var h=s,p=0,y=0;do{var x=h.nextSibling;if(o.removeChild(h),x&&x.nodeType===8)if(h=x.data,h==="/$"){if(0<p&&8>p){h=p;var T=o.ownerDocument;if(h&1&&yu(T.documentElement),h&2&&yu(T.body),h&4)for(h=T.head,yu(h),T=h.firstChild;T;){var k=T.nextSibling,z=T.nodeName;T[Ms]||z==="SCRIPT"||z==="STYLE"||z==="LINK"&&T.rel.toLowerCase()==="stylesheet"||h.removeChild(T),T=k}}if(y===0){o.removeChild(x),Ru(s);return}y--}else h==="$"||h==="$?"||h==="$!"?y++:p=h.charCodeAt(0)-48;else p=0;h=x}while(h);Ru(s)}function wp(o){var s=o.firstChild;for(s&&s.nodeType===10&&(s=s.nextSibling);s;){var h=s;switch(s=s.nextSibling,h.nodeName){case"HTML":case"HEAD":case"BODY":wp(h),Rh(h);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(h.rel.toLowerCase()==="stylesheet")continue}o.removeChild(h)}}function HR(o,s,h,p){for(;o.nodeType===1;){var y=h;if(o.nodeName.toLowerCase()!==s.toLowerCase()){if(!p&&(o.nodeName!=="INPUT"||o.type!=="hidden"))break}else if(p){if(!o[Ms])switch(s){case"meta":if(!o.hasAttribute("itemprop"))break;return o;case"link":if(x=o.getAttribute("rel"),x==="stylesheet"&&o.hasAttribute("data-precedence"))break;if(x!==y.rel||o.getAttribute("href")!==(y.href==null||y.href===""?null:y.href)||o.getAttribute("crossorigin")!==(y.crossOrigin==null?null:y.crossOrigin)||o.getAttribute("title")!==(y.title==null?null:y.title))break;return o;case"style":if(o.hasAttribute("data-precedence"))break;return o;case"script":if(x=o.getAttribute("src"),(x!==(y.src==null?null:y.src)||o.getAttribute("type")!==(y.type==null?null:y.type)||o.getAttribute("crossorigin")!==(y.crossOrigin==null?null:y.crossOrigin))&&x&&o.hasAttribute("async")&&!o.hasAttribute("itemprop"))break;return o;default:return o}}else if(s==="input"&&o.type==="hidden"){var x=y.name==null?null:""+y.name;if(y.type==="hidden"&&o.getAttribute("name")===x)return o}else return o;if(o=Er(o.nextSibling),o===null)break}return null}function VR(o,s,h){if(s==="")return null;for(;o.nodeType!==3;)if((o.nodeType!==1||o.nodeName!=="INPUT"||o.type!=="hidden")&&!h||(o=Er(o.nextSibling),o===null))return null;return o}function Sp(o){return o.data==="$!"||o.data==="$?"&&o.ownerDocument.readyState==="complete"}function WR(o,s){var h=o.ownerDocument;if(o.data!=="$?"||h.readyState==="complete")s();else{var p=function(){s(),h.removeEventListener("DOMContentLoaded",p)};h.addEventListener("DOMContentLoaded",p),o._reactRetry=p}}function Er(o){for(;o!=null;o=o.nextSibling){var s=o.nodeType;if(s===1||s===3)break;if(s===8){if(s=o.data,s==="$"||s==="$!"||s==="$?"||s==="F!"||s==="F")break;if(s==="/$")return null}}return o}var Ep=null;function g1(o){o=o.previousSibling;for(var s=0;o;){if(o.nodeType===8){var h=o.data;if(h==="$"||h==="$!"||h==="$?"){if(s===0)return o;s--}else h==="/$"&&s++}o=o.previousSibling}return null}function y1(o,s,h){switch(s=mc(h),o){case"html":if(o=s.documentElement,!o)throw Error(r(452));return o;case"head":if(o=s.head,!o)throw Error(r(453));return o;case"body":if(o=s.body,!o)throw Error(r(454));return o;default:throw Error(r(451))}}function yu(o){for(var s=o.attributes;s.length;)o.removeAttributeNode(s[0]);Rh(o)}var cr=new Map,b1=new Set;function gc(o){return typeof o.getRootNode=="function"?o.getRootNode():o.nodeType===9?o:o.ownerDocument}var ya=W.d;W.d={f:GR,r:jR,D:qR,C:$R,L:KR,m:XR,X:YR,S:ZR,M:QR};function GR(){var o=ya.f(),s=uc();return o||s}function jR(o){var s=co(o);s!==null&&s.tag===5&&s.type==="form"?z0(s):ya.r(o)}var jo=typeof document>"u"?null:document;function x1(o,s,h){var p=jo;if(p&&typeof s=="string"&&s){var y=rr(s);y='link[rel="'+o+'"][href="'+y+'"]',typeof h=="string"&&(y+='[crossorigin="'+h+'"]'),b1.has(y)||(b1.add(y),o={rel:o,crossOrigin:h,href:s},p.querySelector(y)===null&&(s=p.createElement("link"),un(s,"link",o),Xt(s),p.head.appendChild(s)))}}function qR(o){ya.D(o),x1("dns-prefetch",o,null)}function $R(o,s){ya.C(o,s),x1("preconnect",o,s)}function KR(o,s,h){ya.L(o,s,h);var p=jo;if(p&&o&&s){var y='link[rel="preload"][as="'+rr(s)+'"]';s==="image"&&h&&h.imageSrcSet?(y+='[imagesrcset="'+rr(h.imageSrcSet)+'"]',typeof h.imageSizes=="string"&&(y+='[imagesizes="'+rr(h.imageSizes)+'"]')):y+='[href="'+rr(o)+'"]';var x=y;switch(s){case"style":x=qo(o);break;case"script":x=$o(o)}cr.has(x)||(o=d({rel:"preload",href:s==="image"&&h&&h.imageSrcSet?void 0:o,as:s},h),cr.set(x,o),p.querySelector(y)!==null||s==="style"&&p.querySelector(bu(x))||s==="script"&&p.querySelector(xu(x))||(s=p.createElement("link"),un(s,"link",o),Xt(s),p.head.appendChild(s)))}}function XR(o,s){ya.m(o,s);var h=jo;if(h&&o){var p=s&&typeof s.as=="string"?s.as:"script",y='link[rel="modulepreload"][as="'+rr(p)+'"][href="'+rr(o)+'"]',x=y;switch(p){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":x=$o(o)}if(!cr.has(x)&&(o=d({rel:"modulepreload",href:o},s),cr.set(x,o),h.querySelector(y)===null)){switch(p){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(h.querySelector(xu(x)))return}p=h.createElement("link"),un(p,"link",o),Xt(p),h.head.appendChild(p)}}}function ZR(o,s,h){ya.S(o,s,h);var p=jo;if(p&&o){var y=fo(p).hoistableStyles,x=qo(o);s=s||"default";var T=y.get(x);if(!T){var k={loading:0,preload:null};if(T=p.querySelector(bu(x)))k.loading=5;else{o=d({rel:"stylesheet",href:o,"data-precedence":s},h),(h=cr.get(x))&&_p(o,h);var z=T=p.createElement("link");Xt(z),un(z,"link",o),z._p=new Promise(function(Y,le){z.onload=Y,z.onerror=le}),z.addEventListener("load",function(){k.loading|=1}),z.addEventListener("error",function(){k.loading|=2}),k.loading|=4,yc(T,s,p)}T={type:"stylesheet",instance:T,count:1,state:k},y.set(x,T)}}}function YR(o,s){ya.X(o,s);var h=jo;if(h&&o){var p=fo(h).hoistableScripts,y=$o(o),x=p.get(y);x||(x=h.querySelector(xu(y)),x||(o=d({src:o,async:!0},s),(s=cr.get(y))&&Cp(o,s),x=h.createElement("script"),Xt(x),un(x,"link",o),h.head.appendChild(x)),x={type:"script",instance:x,count:1,state:null},p.set(y,x))}}function QR(o,s){ya.M(o,s);var h=jo;if(h&&o){var p=fo(h).hoistableScripts,y=$o(o),x=p.get(y);x||(x=h.querySelector(xu(y)),x||(o=d({src:o,async:!0,type:"module"},s),(s=cr.get(y))&&Cp(o,s),x=h.createElement("script"),Xt(x),un(x,"link",o),h.head.appendChild(x)),x={type:"script",instance:x,count:1,state:null},p.set(y,x))}}function w1(o,s,h,p){var y=(y=ve.current)?gc(y):null;if(!y)throw Error(r(446));switch(o){case"meta":case"title":return null;case"style":return typeof h.precedence=="string"&&typeof h.href=="string"?(s=qo(h.href),h=fo(y).hoistableStyles,p=h.get(s),p||(p={type:"style",instance:null,count:0,state:null},h.set(s,p)),p):{type:"void",instance:null,count:0,state:null};case"link":if(h.rel==="stylesheet"&&typeof h.href=="string"&&typeof h.precedence=="string"){o=qo(h.href);var x=fo(y).hoistableStyles,T=x.get(o);if(T||(y=y.ownerDocument||y,T={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},x.set(o,T),(x=y.querySelector(bu(o)))&&!x._p&&(T.instance=x,T.state.loading=5),cr.has(o)||(h={rel:"preload",as:"style",href:h.href,crossOrigin:h.crossOrigin,integrity:h.integrity,media:h.media,hrefLang:h.hrefLang,referrerPolicy:h.referrerPolicy},cr.set(o,h),x||JR(y,o,h,T.state))),s&&p===null)throw Error(r(528,""));return T}if(s&&p!==null)throw Error(r(529,""));return null;case"script":return s=h.async,h=h.src,typeof h=="string"&&s&&typeof s!="function"&&typeof s!="symbol"?(s=$o(h),h=fo(y).hoistableScripts,p=h.get(s),p||(p={type:"script",instance:null,count:0,state:null},h.set(s,p)),p):{type:"void",instance:null,count:0,state:null};default:throw Error(r(444,o))}}function qo(o){return'href="'+rr(o)+'"'}function bu(o){return'link[rel="stylesheet"]['+o+"]"}function S1(o){return d({},o,{"data-precedence":o.precedence,precedence:null})}function JR(o,s,h,p){o.querySelector('link[rel="preload"][as="style"]['+s+"]")?p.loading=1:(s=o.createElement("link"),p.preload=s,s.addEventListener("load",function(){return p.loading|=1}),s.addEventListener("error",function(){return p.loading|=2}),un(s,"link",h),Xt(s),o.head.appendChild(s))}function $o(o){return'[src="'+rr(o)+'"]'}function xu(o){return"script[async]"+o}function E1(o,s,h){if(s.count++,s.instance===null)switch(s.type){case"style":var p=o.querySelector('style[data-href~="'+rr(h.href)+'"]');if(p)return s.instance=p,Xt(p),p;var y=d({},h,{"data-href":h.href,"data-precedence":h.precedence,href:null,precedence:null});return p=(o.ownerDocument||o).createElement("style"),Xt(p),un(p,"style",y),yc(p,h.precedence,o),s.instance=p;case"stylesheet":y=qo(h.href);var x=o.querySelector(bu(y));if(x)return s.state.loading|=4,s.instance=x,Xt(x),x;p=S1(h),(y=cr.get(y))&&_p(p,y),x=(o.ownerDocument||o).createElement("link"),Xt(x);var T=x;return T._p=new Promise(function(k,z){T.onload=k,T.onerror=z}),un(x,"link",p),s.state.loading|=4,yc(x,h.precedence,o),s.instance=x;case"script":return x=$o(h.src),(y=o.querySelector(xu(x)))?(s.instance=y,Xt(y),y):(p=h,(y=cr.get(x))&&(p=d({},h),Cp(p,y)),o=o.ownerDocument||o,y=o.createElement("script"),Xt(y),un(y,"link",p),o.head.appendChild(y),s.instance=y);case"void":return null;default:throw Error(r(443,s.type))}else s.type==="stylesheet"&&(s.state.loading&4)===0&&(p=s.instance,s.state.loading|=4,yc(p,h.precedence,o));return s.instance}function yc(o,s,h){for(var p=h.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),y=p.length?p[p.length-1]:null,x=y,T=0;T<p.length;T++){var k=p[T];if(k.dataset.precedence===s)x=k;else if(x!==y)break}x?x.parentNode.insertBefore(o,x.nextSibling):(s=h.nodeType===9?h.head:h,s.insertBefore(o,s.firstChild))}function _p(o,s){o.crossOrigin==null&&(o.crossOrigin=s.crossOrigin),o.referrerPolicy==null&&(o.referrerPolicy=s.referrerPolicy),o.title==null&&(o.title=s.title)}function Cp(o,s){o.crossOrigin==null&&(o.crossOrigin=s.crossOrigin),o.referrerPolicy==null&&(o.referrerPolicy=s.referrerPolicy),o.integrity==null&&(o.integrity=s.integrity)}var bc=null;function _1(o,s,h){if(bc===null){var p=new Map,y=bc=new Map;y.set(h,p)}else y=bc,p=y.get(h),p||(p=new Map,y.set(h,p));if(p.has(o))return p;for(p.set(o,null),h=h.getElementsByTagName(o),y=0;y<h.length;y++){var x=h[y];if(!(x[Ms]||x[dn]||o==="link"&&x.getAttribute("rel")==="stylesheet")&&x.namespaceURI!=="http://www.w3.org/2000/svg"){var T=x.getAttribute(s)||"";T=o+T;var k=p.get(T);k?k.push(x):p.set(T,[x])}}return p}function C1(o,s,h){o=o.ownerDocument||o,o.head.insertBefore(h,s==="title"?o.querySelector("head > title"):null)}function eA(o,s,h){if(h===1||s.itemProp!=null)return!1;switch(o){case"meta":case"title":return!0;case"style":if(typeof s.precedence!="string"||typeof s.href!="string"||s.href==="")break;return!0;case"link":if(typeof s.rel!="string"||typeof s.href!="string"||s.href===""||s.onLoad||s.onError)break;switch(s.rel){case"stylesheet":return o=s.disabled,typeof s.precedence=="string"&&o==null;default:return!0}case"script":if(s.async&&typeof s.async!="function"&&typeof s.async!="symbol"&&!s.onLoad&&!s.onError&&s.src&&typeof s.src=="string")return!0}return!1}function R1(o){return!(o.type==="stylesheet"&&(o.state.loading&3)===0)}var wu=null;function tA(){}function nA(o,s,h){if(wu===null)throw Error(r(475));var p=wu;if(s.type==="stylesheet"&&(typeof h.media!="string"||matchMedia(h.media).matches!==!1)&&(s.state.loading&4)===0){if(s.instance===null){var y=qo(h.href),x=o.querySelector(bu(y));if(x){o=x._p,o!==null&&typeof o=="object"&&typeof o.then=="function"&&(p.count++,p=xc.bind(p),o.then(p,p)),s.state.loading|=4,s.instance=x,Xt(x);return}x=o.ownerDocument||o,h=S1(h),(y=cr.get(y))&&_p(h,y),x=x.createElement("link"),Xt(x);var T=x;T._p=new Promise(function(k,z){T.onload=k,T.onerror=z}),un(x,"link",h),s.instance=x}p.stylesheets===null&&(p.stylesheets=new Map),p.stylesheets.set(s,o),(o=s.state.preload)&&(s.state.loading&3)===0&&(p.count++,s=xc.bind(p),o.addEventListener("load",s),o.addEventListener("error",s))}}function rA(){if(wu===null)throw Error(r(475));var o=wu;return o.stylesheets&&o.count===0&&Rp(o,o.stylesheets),0<o.count?function(s){var h=setTimeout(function(){if(o.stylesheets&&Rp(o,o.stylesheets),o.unsuspend){var p=o.unsuspend;o.unsuspend=null,p()}},6e4);return o.unsuspend=s,function(){o.unsuspend=null,clearTimeout(h)}}:null}function xc(){if(this.count--,this.count===0){if(this.stylesheets)Rp(this,this.stylesheets);else if(this.unsuspend){var o=this.unsuspend;this.unsuspend=null,o()}}}var wc=null;function Rp(o,s){o.stylesheets=null,o.unsuspend!==null&&(o.count++,wc=new Map,s.forEach(aA,o),wc=null,xc.call(o))}function aA(o,s){if(!(s.state.loading&4)){var h=wc.get(o);if(h)var p=h.get(null);else{h=new Map,wc.set(o,h);for(var y=o.querySelectorAll("link[data-precedence],style[data-precedence]"),x=0;x<y.length;x++){var T=y[x];(T.nodeName==="LINK"||T.getAttribute("media")!=="not all")&&(h.set(T.dataset.precedence,T),p=T)}p&&h.set(null,p)}y=s.instance,T=y.getAttribute("data-precedence"),x=h.get(T)||p,x===p&&h.set(null,y),h.set(T,y),this.count++,p=xc.bind(this),y.addEventListener("load",p),y.addEventListener("error",p),x?x.parentNode.insertBefore(y,x.nextSibling):(o=o.nodeType===9?o.head:o,o.insertBefore(y,o.firstChild)),s.state.loading|=4}}var Su={$$typeof:R,Provider:null,Consumer:null,_currentValue:$,_currentValue2:$,_threadCount:0};function iA(o,s,h,p,y,x,T,k){this.tag=1,this.containerInfo=o,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Sh(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Sh(0),this.hiddenUpdates=Sh(null),this.identifierPrefix=p,this.onUncaughtError=y,this.onCaughtError=x,this.onRecoverableError=T,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=k,this.incompleteTransitions=new Map}function A1(o,s,h,p,y,x,T,k,z,Y,le,fe){return o=new iA(o,s,h,T,k,z,Y,fe),s=1,x===!0&&(s|=24),x=Un(3,null,null,s),o.current=x,x.stateNode=o,s=sd(),s.refCount++,o.pooledCache=s,s.refCount++,x.memoizedState={element:p,isDehydrated:h,cache:s},fd(x),o}function T1(o){return o?(o=_o,o):_o}function D1(o,s,h,p,y,x){y=T1(y),p.context===null?p.context=y:p.pendingContext=y,p=Ua(s),p.payload={element:h},x=x===void 0?null:x,x!==null&&(p.callback=x),h=Ha(o,p,s),h!==null&&(jn(h,o,s),Qs(h,o,s))}function O1(o,s){if(o=o.memoizedState,o!==null&&o.dehydrated!==null){var h=o.retryLane;o.retryLane=h!==0&&h<s?h:s}}function Ap(o,s){O1(o,s),(o=o.alternate)&&O1(o,s)}function k1(o){if(o.tag===13){var s=Eo(o,67108864);s!==null&&jn(s,o,67108864),Ap(o,67108864)}}var Sc=!0;function oA(o,s,h,p){var y=L.T;L.T=null;var x=W.p;try{W.p=2,Tp(o,s,h,p)}finally{W.p=x,L.T=y}}function sA(o,s,h,p){var y=L.T;L.T=null;var x=W.p;try{W.p=8,Tp(o,s,h,p)}finally{W.p=x,L.T=y}}function Tp(o,s,h,p){if(Sc){var y=Dp(p);if(y===null)vp(o,s,p,Ec,h),M1(o,p);else if(lA(y,o,s,h,p))p.stopPropagation();else if(M1(o,p),s&4&&-1<uA.indexOf(o)){for(;y!==null;){var x=co(y);if(x!==null)switch(x.tag){case 3:if(x=x.stateNode,x.current.memoizedState.isDehydrated){var T=xr(x.pendingLanes);if(T!==0){var k=x;for(k.pendingLanes|=2,k.entangledLanes|=2;T;){var z=1<<31-an(T);k.entanglements[1]|=z,T&=~z}Br(x),(it&6)===0&&(oc=Dt()+500,vu(0))}}break;case 13:k=Eo(x,2),k!==null&&jn(k,x,2),uc(),Ap(x,2)}if(x=Dp(p),x===null&&vp(o,s,p,Ec,h),x===y)break;y=x}y!==null&&p.stopPropagation()}else vp(o,s,p,null,h)}}function Dp(o){return o=Ih(o),Op(o)}var Ec=null;function Op(o){if(Ec=null,o=lo(o),o!==null){var s=i(o);if(s===null)o=null;else{var h=s.tag;if(h===13){if(o=u(s),o!==null)return o;o=null}else if(h===3){if(s.stateNode.current.memoizedState.isDehydrated)return s.tag===3?s.stateNode.containerInfo:null;o=null}else s!==o&&(o=null)}}return Ec=o,null}function N1(o){switch(o){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(er()){case hn:return 2;case na:return 8;case An:case kr:return 32;case tr:return 268435456;default:return 32}default:return 32}}var kp=!1,ei=null,ti=null,ni=null,Eu=new Map,_u=new Map,ri=[],uA="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function M1(o,s){switch(o){case"focusin":case"focusout":ei=null;break;case"dragenter":case"dragleave":ti=null;break;case"mouseover":case"mouseout":ni=null;break;case"pointerover":case"pointerout":Eu.delete(s.pointerId);break;case"gotpointercapture":case"lostpointercapture":_u.delete(s.pointerId)}}function Cu(o,s,h,p,y,x){return o===null||o.nativeEvent!==x?(o={blockedOn:s,domEventName:h,eventSystemFlags:p,nativeEvent:x,targetContainers:[y]},s!==null&&(s=co(s),s!==null&&k1(s)),o):(o.eventSystemFlags|=p,s=o.targetContainers,y!==null&&s.indexOf(y)===-1&&s.push(y),o)}function lA(o,s,h,p,y){switch(s){case"focusin":return ei=Cu(ei,o,s,h,p,y),!0;case"dragenter":return ti=Cu(ti,o,s,h,p,y),!0;case"mouseover":return ni=Cu(ni,o,s,h,p,y),!0;case"pointerover":var x=y.pointerId;return Eu.set(x,Cu(Eu.get(x)||null,o,s,h,p,y)),!0;case"gotpointercapture":return x=y.pointerId,_u.set(x,Cu(_u.get(x)||null,o,s,h,p,y)),!0}return!1}function I1(o){var s=lo(o.target);if(s!==null){var h=i(s);if(h!==null){if(s=h.tag,s===13){if(s=u(h),s!==null){o.blockedOn=s,nC(o.priority,function(){if(h.tag===13){var p=Gn();p=Eh(p);var y=Eo(h,p);y!==null&&jn(y,h,p),Ap(h,p)}});return}}else if(s===3&&h.stateNode.current.memoizedState.isDehydrated){o.blockedOn=h.tag===3?h.stateNode.containerInfo:null;return}}}o.blockedOn=null}function _c(o){if(o.blockedOn!==null)return!1;for(var s=o.targetContainers;0<s.length;){var h=Dp(o.nativeEvent);if(h===null){h=o.nativeEvent;var p=new h.constructor(h.type,h);Mh=p,h.target.dispatchEvent(p),Mh=null}else return s=co(h),s!==null&&k1(s),o.blockedOn=h,!1;s.shift()}return!0}function F1(o,s,h){_c(o)&&h.delete(s)}function cA(){kp=!1,ei!==null&&_c(ei)&&(ei=null),ti!==null&&_c(ti)&&(ti=null),ni!==null&&_c(ni)&&(ni=null),Eu.forEach(F1),_u.forEach(F1)}function Cc(o,s){o.blockedOn===s&&(o.blockedOn=null,kp||(kp=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,cA)))}var Rc=null;function B1(o){Rc!==o&&(Rc=o,n.unstable_scheduleCallback(n.unstable_NormalPriority,function(){Rc===o&&(Rc=null);for(var s=0;s<o.length;s+=3){var h=o[s],p=o[s+1],y=o[s+2];if(typeof p!="function"){if(Op(p||h)===null)continue;break}var x=co(h);x!==null&&(o.splice(s,3),s-=3,Od(x,{pending:!0,data:y,method:h.method,action:p},p,y))}}))}function Ru(o){function s(z){return Cc(z,o)}ei!==null&&Cc(ei,o),ti!==null&&Cc(ti,o),ni!==null&&Cc(ni,o),Eu.forEach(s),_u.forEach(s);for(var h=0;h<ri.length;h++){var p=ri[h];p.blockedOn===o&&(p.blockedOn=null)}for(;0<ri.length&&(h=ri[0],h.blockedOn===null);)I1(h),h.blockedOn===null&&ri.shift();if(h=(o.ownerDocument||o).$$reactFormReplay,h!=null)for(p=0;p<h.length;p+=3){var y=h[p],x=h[p+1],T=y[Tn]||null;if(typeof x=="function")T||B1(h);else if(T){var k=null;if(x&&x.hasAttribute("formAction")){if(y=x,T=x[Tn]||null)k=T.formAction;else if(Op(y)!==null)continue}else k=T.action;typeof k=="function"?h[p+1]=k:(h.splice(p,3),p-=3),B1(h)}}}function Np(o){this._internalRoot=o}Ac.prototype.render=Np.prototype.render=function(o){var s=this._internalRoot;if(s===null)throw Error(r(409));var h=s.current,p=Gn();D1(h,p,o,s,null,null)},Ac.prototype.unmount=Np.prototype.unmount=function(){var o=this._internalRoot;if(o!==null){this._internalRoot=null;var s=o.containerInfo;D1(o.current,2,null,o,null,null),uc(),s[uo]=null}};function Ac(o){this._internalRoot=o}Ac.prototype.unstable_scheduleHydration=function(o){if(o){var s=Jg();o={blockedOn:null,target:o,priority:s};for(var h=0;h<ri.length&&s!==0&&s<ri[h].priority;h++);ri.splice(h,0,o),h===0&&I1(o)}};var P1=t.version;if(P1!=="19.1.1")throw Error(r(527,P1,"19.1.1"));W.findDOMNode=function(o){var s=o._reactInternals;if(s===void 0)throw typeof o.render=="function"?Error(r(188)):(o=Object.keys(o).join(","),Error(r(268,o)));return o=c(s),o=o!==null?f(o):null,o=o===null?null:o.stateNode,o};var fA={bundleType:0,version:"19.1.1",rendererPackageName:"react-dom",currentDispatcherRef:L,reconcilerVersion:"19.1.1"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Tc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Tc.isDisabled&&Tc.supportsFiber)try{ra=Tc.inject(fA),Mt=Tc}catch{}}return Tu.createRoot=function(o,s){if(!a(o))throw Error(r(299));var h=!1,p="",y=J0,x=eb,T=tb,k=null;return s!=null&&(s.unstable_strictMode===!0&&(h=!0),s.identifierPrefix!==void 0&&(p=s.identifierPrefix),s.onUncaughtError!==void 0&&(y=s.onUncaughtError),s.onCaughtError!==void 0&&(x=s.onCaughtError),s.onRecoverableError!==void 0&&(T=s.onRecoverableError),s.unstable_transitionCallbacks!==void 0&&(k=s.unstable_transitionCallbacks)),s=A1(o,1,!1,null,null,h,p,y,x,T,k,null),o[uo]=s.current,pp(o),new Np(s)},Tu.hydrateRoot=function(o,s,h){if(!a(o))throw Error(r(299));var p=!1,y="",x=J0,T=eb,k=tb,z=null,Y=null;return h!=null&&(h.unstable_strictMode===!0&&(p=!0),h.identifierPrefix!==void 0&&(y=h.identifierPrefix),h.onUncaughtError!==void 0&&(x=h.onUncaughtError),h.onCaughtError!==void 0&&(T=h.onCaughtError),h.onRecoverableError!==void 0&&(k=h.onRecoverableError),h.unstable_transitionCallbacks!==void 0&&(z=h.unstable_transitionCallbacks),h.formState!==void 0&&(Y=h.formState)),s=A1(o,1,!0,s,h??null,p,y,x,T,k,z,Y),s.context=T1(null),h=s.current,p=Gn(),p=Eh(p),y=Ua(p),y.callback=null,Ha(h,y,p),h=p,s.current.lanes=h,Ns(s,h),Br(s),o[uo]=s.current,pp(o),new Ac(s)},Tu.version="19.1.1",Tu}var $1;function SA(){if($1)return Ip.exports;$1=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(t){console.error(t)}}return n(),Ip.exports=wA(),Ip.exports}var EA=SA();const T6=c2(EA);var Z=xm();const xn=c2(Z);var tn=function(){return tn=Object.assign||function(t){for(var e,r=1,a=arguments.length;r<a;r++){e=arguments[r];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}return t},tn.apply(this,arguments)};function vs(n,t,e){if(e||arguments.length===2)for(var r=0,a=t.length,i;r<a;r++)(i||!(r in t))&&(i||(i=Array.prototype.slice.call(t,0,r)),i[r]=t[r]);return n.concat(i||Array.prototype.slice.call(t))}var vt="-ms-",Pu="-moz-",rt="-webkit-",f2="comm",Gf="rule",wm="decl",_A="@import",h2="@keyframes",CA="@layer",d2=Math.abs,Sm=String.fromCharCode,_v=Object.assign;function RA(n,t){return en(n,0)^45?(((t<<2^en(n,0))<<2^en(n,1))<<2^en(n,2))<<2^en(n,3):0}function p2(n){return n.trim()}function wa(n,t){return(n=t.exec(n))?n[0]:n}function Ve(n,t,e){return n.replace(t,e)}function ef(n,t,e){return n.indexOf(t,e)}function en(n,t){return n.charCodeAt(t)|0}function ms(n,t,e){return n.slice(t,e)}function Ur(n){return n.length}function v2(n){return n.length}function Bu(n,t){return t.push(n),n}function AA(n,t){return n.map(t).join("")}function K1(n,t){return n.filter(function(e){return!wa(e,t)})}var jf=1,gs=1,m2=0,mr=0,Bt=0,Cs="";function qf(n,t,e,r,a,i,u,l){return{value:n,root:t,parent:e,type:r,props:a,children:i,line:jf,column:gs,length:u,return:"",siblings:l}}function si(n,t){return _v(qf("",null,null,"",null,null,0,n.siblings),n,{length:-n.length},t)}function Ko(n){for(;n.root;)n=si(n.root,{children:[n]});Bu(n,n.siblings)}function TA(){return Bt}function DA(){return Bt=mr>0?en(Cs,--mr):0,gs--,Bt===10&&(gs=1,jf--),Bt}function Rr(){return Bt=mr<m2?en(Cs,mr++):0,gs++,Bt===10&&(gs=1,jf++),Bt}function $i(){return en(Cs,mr)}function tf(){return mr}function $f(n,t){return ms(Cs,n,t)}function Cv(n){switch(n){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function OA(n){return jf=gs=1,m2=Ur(Cs=n),mr=0,[]}function kA(n){return Cs="",n}function zp(n){return p2($f(mr-1,Rv(n===91?n+2:n===40?n+1:n)))}function NA(n){for(;(Bt=$i())&&Bt<33;)Rr();return Cv(n)>2||Cv(Bt)>3?"":" "}function MA(n,t){for(;--t&&Rr()&&!(Bt<48||Bt>102||Bt>57&&Bt<65||Bt>70&&Bt<97););return $f(n,tf()+(t<6&&$i()==32&&Rr()==32))}function Rv(n){for(;Rr();)switch(Bt){case n:return mr;case 34:case 39:n!==34&&n!==39&&Rv(Bt);break;case 40:n===41&&Rv(n);break;case 92:Rr();break}return mr}function IA(n,t){for(;Rr()&&n+Bt!==57;)if(n+Bt===84&&$i()===47)break;return"/*"+$f(t,mr-1)+"*"+Sm(n===47?n:Rr())}function FA(n){for(;!Cv($i());)Rr();return $f(n,mr)}function BA(n){return kA(nf("",null,null,null,[""],n=OA(n),0,[0],n))}function nf(n,t,e,r,a,i,u,l,c){for(var f=0,d=0,v=u,m=0,g=0,b=0,w=1,S=1,E=1,_=0,R="",C=a,A=i,D=r,O=R;S;)switch(b=_,_=Rr()){case 40:if(b!=108&&en(O,v-1)==58){ef(O+=Ve(zp(_),"&","&\f"),"&\f",d2(f?l[f-1]:0))!=-1&&(E=-1);break}case 34:case 39:case 91:O+=zp(_);break;case 9:case 10:case 13:case 32:O+=NA(b);break;case 92:O+=MA(tf()-1,7);continue;case 47:switch($i()){case 42:case 47:Bu(PA(IA(Rr(),tf()),t,e,c),c);break;default:O+="/"}break;case 123*w:l[f++]=Ur(O)*E;case 125*w:case 59:case 0:switch(_){case 0:case 125:S=0;case 59+d:E==-1&&(O=Ve(O,/\f/g,"")),g>0&&Ur(O)-v&&Bu(g>32?Z1(O+";",r,e,v-1,c):Z1(Ve(O," ","")+";",r,e,v-2,c),c);break;case 59:O+=";";default:if(Bu(D=X1(O,t,e,f,d,a,l,R,C=[],A=[],v,i),i),_===123)if(d===0)nf(O,t,D,D,C,i,v,l,A);else switch(m===99&&en(O,3)===110?100:m){case 100:case 108:case 109:case 115:nf(n,D,D,r&&Bu(X1(n,D,D,0,0,a,l,R,a,C=[],v,A),A),a,A,v,l,r?C:A);break;default:nf(O,D,D,D,[""],A,0,l,A)}}f=d=g=0,w=E=1,R=O="",v=u;break;case 58:v=1+Ur(O),g=b;default:if(w<1){if(_==123)--w;else if(_==125&&w++==0&&DA()==125)continue}switch(O+=Sm(_),_*w){case 38:E=d>0?1:(O+="\f",-1);break;case 44:l[f++]=(Ur(O)-1)*E,E=1;break;case 64:$i()===45&&(O+=zp(Rr())),m=$i(),d=v=Ur(R=O+=FA(tf())),_++;break;case 45:b===45&&Ur(O)==2&&(w=0)}}return i}function X1(n,t,e,r,a,i,u,l,c,f,d,v){for(var m=a-1,g=a===0?i:[""],b=v2(g),w=0,S=0,E=0;w<r;++w)for(var _=0,R=ms(n,m+1,m=d2(S=u[w])),C=n;_<b;++_)(C=p2(S>0?g[_]+" "+R:Ve(R,/&\f/g,g[_])))&&(c[E++]=C);return qf(n,t,e,a===0?Gf:l,c,f,d,v)}function PA(n,t,e,r){return qf(n,t,e,f2,Sm(TA()),ms(n,2,-2),0,r)}function Z1(n,t,e,r,a){return qf(n,t,e,wm,ms(n,0,r),ms(n,r+1,-1),r,a)}function g2(n,t,e){switch(RA(n,t)){case 5103:return rt+"print-"+n+n;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return rt+n+n;case 4789:return Pu+n+n;case 5349:case 4246:case 4810:case 6968:case 2756:return rt+n+Pu+n+vt+n+n;case 5936:switch(en(n,t+11)){case 114:return rt+n+vt+Ve(n,/[svh]\w+-[tblr]{2}/,"tb")+n;case 108:return rt+n+vt+Ve(n,/[svh]\w+-[tblr]{2}/,"tb-rl")+n;case 45:return rt+n+vt+Ve(n,/[svh]\w+-[tblr]{2}/,"lr")+n}case 6828:case 4268:case 2903:return rt+n+vt+n+n;case 6165:return rt+n+vt+"flex-"+n+n;case 5187:return rt+n+Ve(n,/(\w+).+(:[^]+)/,rt+"box-$1$2"+vt+"flex-$1$2")+n;case 5443:return rt+n+vt+"flex-item-"+Ve(n,/flex-|-self/g,"")+(wa(n,/flex-|baseline/)?"":vt+"grid-row-"+Ve(n,/flex-|-self/g,""))+n;case 4675:return rt+n+vt+"flex-line-pack"+Ve(n,/align-content|flex-|-self/g,"")+n;case 5548:return rt+n+vt+Ve(n,"shrink","negative")+n;case 5292:return rt+n+vt+Ve(n,"basis","preferred-size")+n;case 6060:return rt+"box-"+Ve(n,"-grow","")+rt+n+vt+Ve(n,"grow","positive")+n;case 4554:return rt+Ve(n,/([^-])(transform)/g,"$1"+rt+"$2")+n;case 6187:return Ve(Ve(Ve(n,/(zoom-|grab)/,rt+"$1"),/(image-set)/,rt+"$1"),n,"")+n;case 5495:case 3959:return Ve(n,/(image-set\([^]*)/,rt+"$1$`$1");case 4968:return Ve(Ve(n,/(.+:)(flex-)?(.*)/,rt+"box-pack:$3"+vt+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+rt+n+n;case 4200:if(!wa(n,/flex-|baseline/))return vt+"grid-column-align"+ms(n,t)+n;break;case 2592:case 3360:return vt+Ve(n,"template-","")+n;case 4384:case 3616:return e&&e.some(function(r,a){return t=a,wa(r.props,/grid-\w+-end/)})?~ef(n+(e=e[t].value),"span",0)?n:vt+Ve(n,"-start","")+n+vt+"grid-row-span:"+(~ef(e,"span",0)?wa(e,/\d+/):+wa(e,/\d+/)-+wa(n,/\d+/))+";":vt+Ve(n,"-start","")+n;case 4896:case 4128:return e&&e.some(function(r){return wa(r.props,/grid-\w+-start/)})?n:vt+Ve(Ve(n,"-end","-span"),"span ","")+n;case 4095:case 3583:case 4068:case 2532:return Ve(n,/(.+)-inline(.+)/,rt+"$1$2")+n;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(Ur(n)-1-t>6)switch(en(n,t+1)){case 109:if(en(n,t+4)!==45)break;case 102:return Ve(n,/(.+:)(.+)-([^]+)/,"$1"+rt+"$2-$3$1"+Pu+(en(n,t+3)==108?"$3":"$2-$3"))+n;case 115:return~ef(n,"stretch",0)?g2(Ve(n,"stretch","fill-available"),t,e)+n:n}break;case 5152:case 5920:return Ve(n,/(.+?):(\d+)(\s*\/\s*(span)?\s*(\d+))?(.*)/,function(r,a,i,u,l,c,f){return vt+a+":"+i+f+(u?vt+a+"-span:"+(l?c:+c-+i)+f:"")+n});case 4949:if(en(n,t+6)===121)return Ve(n,":",":"+rt)+n;break;case 6444:switch(en(n,en(n,14)===45?18:11)){case 120:return Ve(n,/(.+:)([^;\s!]+)(;|(\s+)?!.+)?/,"$1"+rt+(en(n,14)===45?"inline-":"")+"box$3$1"+rt+"$2$3$1"+vt+"$2box$3")+n;case 100:return Ve(n,":",":"+vt)+n}break;case 5719:case 2647:case 2135:case 3927:case 2391:return Ve(n,"scroll-","scroll-snap-")+n}return n}function lf(n,t){for(var e="",r=0;r<n.length;r++)e+=t(n[r],r,n,t)||"";return e}function LA(n,t,e,r){switch(n.type){case CA:if(n.children.length)break;case _A:case wm:return n.return=n.return||n.value;case f2:return"";case h2:return n.return=n.value+"{"+lf(n.children,r)+"}";case Gf:if(!Ur(n.value=n.props.join(",")))return""}return Ur(e=lf(n.children,r))?n.return=n.value+"{"+e+"}":""}function zA(n){var t=v2(n);return function(e,r,a,i){for(var u="",l=0;l<t;l++)u+=n[l](e,r,a,i)||"";return u}}function UA(n){return function(t){t.root||(t=t.return)&&n(t)}}function HA(n,t,e,r){if(n.length>-1&&!n.return)switch(n.type){case wm:n.return=g2(n.value,n.length,e);return;case h2:return lf([si(n,{value:Ve(n.value,"@","@"+rt)})],r);case Gf:if(n.length)return AA(e=n.props,function(a){switch(wa(a,r=/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":Ko(si(n,{props:[Ve(a,/:(read-\w+)/,":"+Pu+"$1")]})),Ko(si(n,{props:[a]})),_v(n,{props:K1(e,r)});break;case"::placeholder":Ko(si(n,{props:[Ve(a,/:(plac\w+)/,":"+rt+"input-$1")]})),Ko(si(n,{props:[Ve(a,/:(plac\w+)/,":"+Pu+"$1")]})),Ko(si(n,{props:[Ve(a,/:(plac\w+)/,vt+"input-$1")]})),Ko(si(n,{props:[a]})),_v(n,{props:K1(e,r)});break}return""})}}var VA={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},qn={},ys=typeof process<"u"&&qn!==void 0&&(qn.REACT_APP_SC_ATTR||qn.SC_ATTR)||"data-styled",y2="active",b2="data-styled-version",Kf="6.1.19",Em=`/*!sc*/
`,cf=typeof window<"u"&&typeof document<"u",WA=!!(typeof SC_DISABLE_SPEEDY=="boolean"?SC_DISABLE_SPEEDY:typeof process<"u"&&qn!==void 0&&qn.REACT_APP_SC_DISABLE_SPEEDY!==void 0&&qn.REACT_APP_SC_DISABLE_SPEEDY!==""?qn.REACT_APP_SC_DISABLE_SPEEDY!=="false"&&qn.REACT_APP_SC_DISABLE_SPEEDY:typeof process<"u"&&qn!==void 0&&qn.SC_DISABLE_SPEEDY!==void 0&&qn.SC_DISABLE_SPEEDY!==""&&qn.SC_DISABLE_SPEEDY!=="false"&&qn.SC_DISABLE_SPEEDY),GA={},Xf=Object.freeze([]),bs=Object.freeze({});function x2(n,t,e){return e===void 0&&(e=bs),n.theme!==e.theme&&n.theme||t||e.theme}var w2=new Set(["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","tr","track","u","ul","use","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","marker","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"]),jA=/[!"#$%&'()*+,./:;<=>?@[\\\]^`{|}~-]+/g,qA=/(^-|-$)/g;function Y1(n){return n.replace(jA,"-").replace(qA,"")}var $A=/(a)(d)/gi,Dc=52,Q1=function(n){return String.fromCharCode(n+(n>25?39:97))};function Av(n){var t,e="";for(t=Math.abs(n);t>Dc;t=t/Dc|0)e=Q1(t%Dc)+e;return(Q1(t%Dc)+e).replace($A,"$1-$2")}var Up,S2=5381,is=function(n,t){for(var e=t.length;e;)n=33*n^t.charCodeAt(--e);return n},E2=function(n){return is(S2,n)};function _m(n){return Av(E2(n)>>>0)}function KA(n){return n.displayName||n.name||"Component"}function Hp(n){return typeof n=="string"&&!0}var _2=typeof Symbol=="function"&&Symbol.for,C2=_2?Symbol.for("react.memo"):60115,XA=_2?Symbol.for("react.forward_ref"):60112,ZA={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},YA={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},R2={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},QA=((Up={})[XA]={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},Up[C2]=R2,Up);function J1(n){return("type"in(t=n)&&t.type.$$typeof)===C2?R2:"$$typeof"in n?QA[n.$$typeof]:ZA;var t}var JA=Object.defineProperty,eT=Object.getOwnPropertyNames,ex=Object.getOwnPropertySymbols,tT=Object.getOwnPropertyDescriptor,nT=Object.getPrototypeOf,tx=Object.prototype;function A2(n,t,e){if(typeof t!="string"){if(tx){var r=nT(t);r&&r!==tx&&A2(n,r,e)}var a=eT(t);ex&&(a=a.concat(ex(t)));for(var i=J1(n),u=J1(t),l=0;l<a.length;++l){var c=a[l];if(!(c in YA||e&&e[c]||u&&c in u||i&&c in i)){var f=tT(t,c);try{JA(n,c,f)}catch{}}}}return n}function Yi(n){return typeof n=="function"}function Cm(n){return typeof n=="object"&&"styledComponentId"in n}function Gi(n,t){return n&&t?"".concat(n," ").concat(t):n||t||""}function ff(n,t){if(n.length===0)return"";for(var e=n[0],r=1;r<n.length;r++)e+=n[r];return e}function Vu(n){return n!==null&&typeof n=="object"&&n.constructor.name===Object.name&&!("props"in n&&n.$$typeof)}function Tv(n,t,e){if(e===void 0&&(e=!1),!e&&!Vu(n)&&!Array.isArray(n))return t;if(Array.isArray(t))for(var r=0;r<t.length;r++)n[r]=Tv(n[r],t[r]);else if(Vu(t))for(var r in t)n[r]=Tv(n[r],t[r]);return n}function Rm(n,t){Object.defineProperty(n,"toString",{value:t})}function gi(n){for(var t=[],e=1;e<arguments.length;e++)t[e-1]=arguments[e];return new Error("An error occurred. See https://github.com/styled-components/styled-components/blob/main/packages/styled-components/src/utils/errors.md#".concat(n," for more information.").concat(t.length>0?" Args: ".concat(t.join(", ")):""))}var rT=function(){function n(t){this.groupSizes=new Uint32Array(512),this.length=512,this.tag=t}return n.prototype.indexOfGroup=function(t){for(var e=0,r=0;r<t;r++)e+=this.groupSizes[r];return e},n.prototype.insertRules=function(t,e){if(t>=this.groupSizes.length){for(var r=this.groupSizes,a=r.length,i=a;t>=i;)if((i<<=1)<0)throw gi(16,"".concat(t));this.groupSizes=new Uint32Array(i),this.groupSizes.set(r),this.length=i;for(var u=a;u<i;u++)this.groupSizes[u]=0}for(var l=this.indexOfGroup(t+1),c=(u=0,e.length);u<c;u++)this.tag.insertRule(l,e[u])&&(this.groupSizes[t]++,l++)},n.prototype.clearGroup=function(t){if(t<this.length){var e=this.groupSizes[t],r=this.indexOfGroup(t),a=r+e;this.groupSizes[t]=0;for(var i=r;i<a;i++)this.tag.deleteRule(r)}},n.prototype.getGroup=function(t){var e="";if(t>=this.length||this.groupSizes[t]===0)return e;for(var r=this.groupSizes[t],a=this.indexOfGroup(t),i=a+r,u=a;u<i;u++)e+="".concat(this.tag.getRule(u)).concat(Em);return e},n}(),rf=new Map,hf=new Map,af=1,Oc=function(n){if(rf.has(n))return rf.get(n);for(;hf.has(af);)af++;var t=af++;return rf.set(n,t),hf.set(t,n),t},aT=function(n,t){af=t+1,rf.set(n,t),hf.set(t,n)},iT="style[".concat(ys,"][").concat(b2,'="').concat(Kf,'"]'),oT=new RegExp("^".concat(ys,'\\.g(\\d+)\\[id="([\\w\\d-]+)"\\].*?"([^"]*)')),sT=function(n,t,e){for(var r,a=e.split(","),i=0,u=a.length;i<u;i++)(r=a[i])&&n.registerName(t,r)},uT=function(n,t){for(var e,r=((e=t.textContent)!==null&&e!==void 0?e:"").split(Em),a=[],i=0,u=r.length;i<u;i++){var l=r[i].trim();if(l){var c=l.match(oT);if(c){var f=0|parseInt(c[1],10),d=c[2];f!==0&&(aT(d,f),sT(n,d,c[3]),n.getTag().insertRules(f,a)),a.length=0}else a.push(l)}}},nx=function(n){for(var t=document.querySelectorAll(iT),e=0,r=t.length;e<r;e++){var a=t[e];a&&a.getAttribute(ys)!==y2&&(uT(n,a),a.parentNode&&a.parentNode.removeChild(a))}};function lT(){return typeof __webpack_nonce__<"u"?__webpack_nonce__:null}var T2=function(n){var t=document.head,e=n||t,r=document.createElement("style"),a=function(l){var c=Array.from(l.querySelectorAll("style[".concat(ys,"]")));return c[c.length-1]}(e),i=a!==void 0?a.nextSibling:null;r.setAttribute(ys,y2),r.setAttribute(b2,Kf);var u=lT();return u&&r.setAttribute("nonce",u),e.insertBefore(r,i),r},cT=function(){function n(t){this.element=T2(t),this.element.appendChild(document.createTextNode("")),this.sheet=function(e){if(e.sheet)return e.sheet;for(var r=document.styleSheets,a=0,i=r.length;a<i;a++){var u=r[a];if(u.ownerNode===e)return u}throw gi(17)}(this.element),this.length=0}return n.prototype.insertRule=function(t,e){try{return this.sheet.insertRule(e,t),this.length++,!0}catch{return!1}},n.prototype.deleteRule=function(t){this.sheet.deleteRule(t),this.length--},n.prototype.getRule=function(t){var e=this.sheet.cssRules[t];return e&&e.cssText?e.cssText:""},n}(),fT=function(){function n(t){this.element=T2(t),this.nodes=this.element.childNodes,this.length=0}return n.prototype.insertRule=function(t,e){if(t<=this.length&&t>=0){var r=document.createTextNode(e);return this.element.insertBefore(r,this.nodes[t]||null),this.length++,!0}return!1},n.prototype.deleteRule=function(t){this.element.removeChild(this.nodes[t]),this.length--},n.prototype.getRule=function(t){return t<this.length?this.nodes[t].textContent:""},n}(),hT=function(){function n(t){this.rules=[],this.length=0}return n.prototype.insertRule=function(t,e){return t<=this.length&&(this.rules.splice(t,0,e),this.length++,!0)},n.prototype.deleteRule=function(t){this.rules.splice(t,1),this.length--},n.prototype.getRule=function(t){return t<this.length?this.rules[t]:""},n}(),rx=cf,dT={isServer:!cf,useCSSOMInjection:!WA},df=function(){function n(t,e,r){t===void 0&&(t=bs),e===void 0&&(e={});var a=this;this.options=tn(tn({},dT),t),this.gs=e,this.names=new Map(r),this.server=!!t.isServer,!this.server&&cf&&rx&&(rx=!1,nx(this)),Rm(this,function(){return function(i){for(var u=i.getTag(),l=u.length,c="",f=function(v){var m=function(E){return hf.get(E)}(v);if(m===void 0)return"continue";var g=i.names.get(m),b=u.getGroup(v);if(g===void 0||!g.size||b.length===0)return"continue";var w="".concat(ys,".g").concat(v,'[id="').concat(m,'"]'),S="";g!==void 0&&g.forEach(function(E){E.length>0&&(S+="".concat(E,","))}),c+="".concat(b).concat(w,'{content:"').concat(S,'"}').concat(Em)},d=0;d<l;d++)f(d);return c}(a)})}return n.registerId=function(t){return Oc(t)},n.prototype.rehydrate=function(){!this.server&&cf&&nx(this)},n.prototype.reconstructWithOptions=function(t,e){return e===void 0&&(e=!0),new n(tn(tn({},this.options),t),this.gs,e&&this.names||void 0)},n.prototype.allocateGSInstance=function(t){return this.gs[t]=(this.gs[t]||0)+1},n.prototype.getTag=function(){return this.tag||(this.tag=(t=function(e){var r=e.useCSSOMInjection,a=e.target;return e.isServer?new hT(a):r?new cT(a):new fT(a)}(this.options),new rT(t)));var t},n.prototype.hasNameForId=function(t,e){return this.names.has(t)&&this.names.get(t).has(e)},n.prototype.registerName=function(t,e){if(Oc(t),this.names.has(t))this.names.get(t).add(e);else{var r=new Set;r.add(e),this.names.set(t,r)}},n.prototype.insertRules=function(t,e,r){this.registerName(t,e),this.getTag().insertRules(Oc(t),r)},n.prototype.clearNames=function(t){this.names.has(t)&&this.names.get(t).clear()},n.prototype.clearRules=function(t){this.getTag().clearGroup(Oc(t)),this.clearNames(t)},n.prototype.clearTag=function(){this.tag=void 0},n}(),pT=/&/g,vT=/^\s*\/\/.*$/gm;function D2(n,t){return n.map(function(e){return e.type==="rule"&&(e.value="".concat(t," ").concat(e.value),e.value=e.value.replaceAll(",",",".concat(t," ")),e.props=e.props.map(function(r){return"".concat(t," ").concat(r)})),Array.isArray(e.children)&&e.type!=="@keyframes"&&(e.children=D2(e.children,t)),e})}function mT(n){var t,e,r,a=bs,i=a.options,u=i===void 0?bs:i,l=a.plugins,c=l===void 0?Xf:l,f=function(m,g,b){return b.startsWith(e)&&b.endsWith(e)&&b.replaceAll(e,"").length>0?".".concat(t):m},d=c.slice();d.push(function(m){m.type===Gf&&m.value.includes("&")&&(m.props[0]=m.props[0].replace(pT,e).replace(r,f))}),u.prefix&&d.push(HA),d.push(LA);var v=function(m,g,b,w){g===void 0&&(g=""),b===void 0&&(b=""),w===void 0&&(w="&"),t=w,e=g,r=new RegExp("\\".concat(e,"\\b"),"g");var S=m.replace(vT,""),E=BA(b||g?"".concat(b," ").concat(g," { ").concat(S," }"):S);u.namespace&&(E=D2(E,u.namespace));var _=[];return lf(E,zA(d.concat(UA(function(R){return _.push(R)})))),_};return v.hash=c.length?c.reduce(function(m,g){return g.name||gi(15),is(m,g.name)},S2).toString():"",v}var gT=new df,Dv=mT(),O2=xn.createContext({shouldForwardProp:void 0,styleSheet:gT,stylis:Dv});O2.Consumer;xn.createContext(void 0);function Ov(){return Z.useContext(O2)}var k2=function(){function n(t,e){var r=this;this.inject=function(a,i){i===void 0&&(i=Dv);var u=r.name+i.hash;a.hasNameForId(r.id,u)||a.insertRules(r.id,u,i(r.rules,u,"@keyframes"))},this.name=t,this.id="sc-keyframes-".concat(t),this.rules=e,Rm(this,function(){throw gi(12,String(r.name))})}return n.prototype.getName=function(t){return t===void 0&&(t=Dv),this.name+t.hash},n}(),yT=function(n){return n>="A"&&n<="Z"};function ax(n){for(var t="",e=0;e<n.length;e++){var r=n[e];if(e===1&&r==="-"&&n[0]==="-")return n;yT(r)?t+="-"+r.toLowerCase():t+=r}return t.startsWith("ms-")?"-"+t:t}var N2=function(n){return n==null||n===!1||n===""},M2=function(n){var t,e,r=[];for(var a in n){var i=n[a];n.hasOwnProperty(a)&&!N2(i)&&(Array.isArray(i)&&i.isCss||Yi(i)?r.push("".concat(ax(a),":"),i,";"):Vu(i)?r.push.apply(r,vs(vs(["".concat(a," {")],M2(i),!1),["}"],!1)):r.push("".concat(ax(a),": ").concat((t=a,(e=i)==null||typeof e=="boolean"||e===""?"":typeof e!="number"||e===0||t in VA||t.startsWith("--")?String(e).trim():"".concat(e,"px")),";")))}return r};function hi(n,t,e,r){if(N2(n))return[];if(Cm(n))return[".".concat(n.styledComponentId)];if(Yi(n)){if(!Yi(i=n)||i.prototype&&i.prototype.isReactComponent||!t)return[n];var a=n(t);return hi(a,t,e,r)}var i;return n instanceof k2?e?(n.inject(e,r),[n.getName(r)]):[n]:Vu(n)?M2(n):Array.isArray(n)?Array.prototype.concat.apply(Xf,n.map(function(u){return hi(u,t,e,r)})):[n.toString()]}function I2(n){for(var t=0;t<n.length;t+=1){var e=n[t];if(Yi(e)&&!Cm(e))return!1}return!0}var bT=E2(Kf),xT=function(){function n(t,e,r){this.rules=t,this.staticRulesId="",this.isStatic=(r===void 0||r.isStatic)&&I2(t),this.componentId=e,this.baseHash=is(bT,e),this.baseStyle=r,df.registerId(e)}return n.prototype.generateAndInjectStyles=function(t,e,r){var a=this.baseStyle?this.baseStyle.generateAndInjectStyles(t,e,r):"";if(this.isStatic&&!r.hash)if(this.staticRulesId&&e.hasNameForId(this.componentId,this.staticRulesId))a=Gi(a,this.staticRulesId);else{var i=ff(hi(this.rules,t,e,r)),u=Av(is(this.baseHash,i)>>>0);if(!e.hasNameForId(this.componentId,u)){var l=r(i,".".concat(u),void 0,this.componentId);e.insertRules(this.componentId,u,l)}a=Gi(a,u),this.staticRulesId=u}else{for(var c=is(this.baseHash,r.hash),f="",d=0;d<this.rules.length;d++){var v=this.rules[d];if(typeof v=="string")f+=v;else if(v){var m=ff(hi(v,t,e,r));c=is(c,m+d),f+=m}}if(f){var g=Av(c>>>0);e.hasNameForId(this.componentId,g)||e.insertRules(this.componentId,g,r(f,".".concat(g),void 0,this.componentId)),a=Gi(a,g)}}return a},n}(),xs=xn.createContext(void 0);xs.Consumer;function D6(){var n=Z.useContext(xs);if(!n)throw gi(18);return n}function O6(n){var t=xn.useContext(xs),e=Z.useMemo(function(){return function(r,a){if(!r)throw gi(14);if(Yi(r)){var i=r(a);return i}if(Array.isArray(r)||typeof r!="object")throw gi(8);return a?tn(tn({},a),r):r}(n.theme,t)},[n.theme,t]);return n.children?xn.createElement(xs.Provider,{value:e},n.children):null}var Vp={};function wT(n,t,e){var r=Cm(n),a=n,i=!Hp(n),u=t.attrs,l=u===void 0?Xf:u,c=t.componentId,f=c===void 0?function(C,A){var D=typeof C!="string"?"sc":Y1(C);Vp[D]=(Vp[D]||0)+1;var O="".concat(D,"-").concat(_m(Kf+D+Vp[D]));return A?"".concat(A,"-").concat(O):O}(t.displayName,t.parentComponentId):c,d=t.displayName,v=d===void 0?function(C){return Hp(C)?"styled.".concat(C):"Styled(".concat(KA(C),")")}(n):d,m=t.displayName&&t.componentId?"".concat(Y1(t.displayName),"-").concat(t.componentId):t.componentId||f,g=r&&a.attrs?a.attrs.concat(l).filter(Boolean):l,b=t.shouldForwardProp;if(r&&a.shouldForwardProp){var w=a.shouldForwardProp;if(t.shouldForwardProp){var S=t.shouldForwardProp;b=function(C,A){return w(C,A)&&S(C,A)}}else b=w}var E=new xT(e,m,r?a.componentStyle:void 0);function _(C,A){return function(D,O,F){var N=D.attrs,B=D.componentStyle,H=D.defaultProps,U=D.foldedComponentIds,J=D.styledComponentId,ee=D.target,te=xn.useContext(xs),L=Ov(),W=D.shouldForwardProp||L.shouldForwardProp,$=x2(O,te,H)||bs,ne=function(me,ve,Ae){for(var ye,De=tn(tn({},ve),{className:void 0,theme:Ae}),Qe=0;Qe<me.length;Qe+=1){var Ne=Yi(ye=me[Qe])?ye(De):ye;for(var Le in Ne)De[Le]=Le==="className"?Gi(De[Le],Ne[Le]):Le==="style"?tn(tn({},De[Le]),Ne[Le]):Ne[Le]}return ve.className&&(De.className=Gi(De.className,ve.className)),De}(N,O,$),M=ne.as||ee,j={};for(var ie in ne)ne[ie]===void 0||ie[0]==="$"||ie==="as"||ie==="theme"&&ne.theme===$||(ie==="forwardedAs"?j.as=ne.forwardedAs:W&&!W(ie,M)||(j[ie]=ne[ie]));var oe=function(me,ve){var Ae=Ov(),ye=me.generateAndInjectStyles(ve,Ae.styleSheet,Ae.stylis);return ye}(B,ne),de=Gi(U,J);return oe&&(de+=" "+oe),ne.className&&(de+=" "+ne.className),j[Hp(M)&&!w2.has(M)?"class":"className"]=de,F&&(j.ref=F),Z.createElement(M,j)}(R,C,A)}_.displayName=v;var R=xn.forwardRef(_);return R.attrs=g,R.componentStyle=E,R.displayName=v,R.shouldForwardProp=b,R.foldedComponentIds=r?Gi(a.foldedComponentIds,a.styledComponentId):"",R.styledComponentId=m,R.target=r?a.target:n,Object.defineProperty(R,"defaultProps",{get:function(){return this._foldedDefaultProps},set:function(C){this._foldedDefaultProps=r?function(A){for(var D=[],O=1;O<arguments.length;O++)D[O-1]=arguments[O];for(var F=0,N=D;F<N.length;F++)Tv(A,N[F],!0);return A}({},a.defaultProps,C):C}}),Rm(R,function(){return".".concat(R.styledComponentId)}),i&&A2(R,n,{attrs:!0,componentStyle:!0,displayName:!0,foldedComponentIds:!0,shouldForwardProp:!0,styledComponentId:!0,target:!0}),R}function ix(n,t){for(var e=[n[0]],r=0,a=t.length;r<a;r+=1)e.push(t[r],n[r+1]);return e}var ox=function(n){return Object.assign(n,{isCss:!0})};function Am(n){for(var t=[],e=1;e<arguments.length;e++)t[e-1]=arguments[e];if(Yi(n)||Vu(n))return ox(hi(ix(Xf,vs([n],t,!0))));var r=n;return t.length===0&&r.length===1&&typeof r[0]=="string"?hi(r):ox(hi(ix(r,t)))}function kv(n,t,e){if(e===void 0&&(e=bs),!t)throw gi(1,t);var r=function(a){for(var i=[],u=1;u<arguments.length;u++)i[u-1]=arguments[u];return n(t,e,Am.apply(void 0,vs([a],i,!1)))};return r.attrs=function(a){return kv(n,t,tn(tn({},e),{attrs:Array.prototype.concat(e.attrs,a).filter(Boolean)}))},r.withConfig=function(a){return kv(n,t,tn(tn({},e),a))},r}var F2=function(n){return kv(wT,n)},ST=F2;w2.forEach(function(n){ST[n]=F2(n)});var ET=function(){function n(t,e){this.rules=t,this.componentId=e,this.isStatic=I2(t),df.registerId(this.componentId+1)}return n.prototype.createStyles=function(t,e,r,a){var i=a(ff(hi(this.rules,e,r,a)),""),u=this.componentId+t;r.insertRules(u,u,i)},n.prototype.removeStyles=function(t,e){e.clearRules(this.componentId+t)},n.prototype.renderStyles=function(t,e,r,a){t>2&&df.registerId(this.componentId+t),this.removeStyles(t,r),this.createStyles(t,e,r,a)},n}();function k6(n){for(var t=[],e=1;e<arguments.length;e++)t[e-1]=arguments[e];var r=Am.apply(void 0,vs([n],t,!1)),a="sc-global-".concat(_m(JSON.stringify(r))),i=new ET(r,a),u=function(c){var f=Ov(),d=xn.useContext(xs),v=xn.useRef(f.styleSheet.allocateGSInstance(a)).current;return f.styleSheet.server&&l(v,c,f.styleSheet,d,f.stylis),xn.useLayoutEffect(function(){if(!f.styleSheet.server)return l(v,c,f.styleSheet,d,f.stylis),function(){return i.removeStyles(v,f.styleSheet)}},[v,c,f.styleSheet,d,f.stylis]),null};function l(c,f,d,v,m){if(i.isStatic)i.renderStyles(c,GA,d,m);else{var g=tn(tn({},f),{theme:x2(f,v,u.defaultProps)});i.renderStyles(c,g,d,m)}}return xn.memo(u)}function N6(n){for(var t=[],e=1;e<arguments.length;e++)t[e-1]=arguments[e];var r=ff(Am.apply(void 0,vs([n],t,!1))),a=_m(r);return new k2(a,r)}/**
 * react-router v7.8.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var sx="popstate";function _T(n={}){function t(r,a){let{pathname:i,search:u,hash:l}=r.location;return Nv("",{pathname:i,search:u,hash:l},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function e(r,a){return typeof a=="string"?a:Wu(a)}return RT(t,e,null,n)}function Et(n,t){if(n===!1||n===null||typeof n>"u")throw new Error(t)}function Tr(n,t){if(!n){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function CT(){return Math.random().toString(36).substring(2,10)}function ux(n,t){return{usr:n.state,key:n.key,idx:t}}function Nv(n,t,e=null,r){return{pathname:typeof n=="string"?n:n.pathname,search:"",hash:"",...typeof t=="string"?Rs(t):t,state:e,key:t&&t.key||r||CT()}}function Wu({pathname:n="/",search:t="",hash:e=""}){return t&&t!=="?"&&(n+=t.charAt(0)==="?"?t:"?"+t),e&&e!=="#"&&(n+=e.charAt(0)==="#"?e:"#"+e),n}function Rs(n){let t={};if(n){let e=n.indexOf("#");e>=0&&(t.hash=n.substring(e),n=n.substring(0,e));let r=n.indexOf("?");r>=0&&(t.search=n.substring(r),n=n.substring(0,r)),n&&(t.pathname=n)}return t}function RT(n,t,e,r={}){let{window:a=document.defaultView,v5Compat:i=!1}=r,u=a.history,l="POP",c=null,f=d();f==null&&(f=0,u.replaceState({...u.state,idx:f},""));function d(){return(u.state||{idx:null}).idx}function v(){l="POP";let S=d(),E=S==null?null:S-f;f=S,c&&c({action:l,location:w.location,delta:E})}function m(S,E){l="PUSH";let _=Nv(w.location,S,E);f=d()+1;let R=ux(_,f),C=w.createHref(_);try{u.pushState(R,"",C)}catch(A){if(A instanceof DOMException&&A.name==="DataCloneError")throw A;a.location.assign(C)}i&&c&&c({action:l,location:w.location,delta:1})}function g(S,E){l="REPLACE";let _=Nv(w.location,S,E);f=d();let R=ux(_,f),C=w.createHref(_);u.replaceState(R,"",C),i&&c&&c({action:l,location:w.location,delta:0})}function b(S){return AT(S)}let w={get action(){return l},get location(){return n(a,u)},listen(S){if(c)throw new Error("A history only accepts one active listener");return a.addEventListener(sx,v),c=S,()=>{a.removeEventListener(sx,v),c=null}},createHref(S){return t(a,S)},createURL:b,encodeLocation(S){let E=b(S);return{pathname:E.pathname,search:E.search,hash:E.hash}},push:m,replace:g,go(S){return u.go(S)}};return w}function AT(n,t=!1){let e="http://localhost";typeof window<"u"&&(e=window.location.origin!=="null"?window.location.origin:window.location.href),Et(e,"No window.location.(origin|href) available to create URL");let r=typeof n=="string"?n:Wu(n);return r=r.replace(/ $/,"%20"),!t&&r.startsWith("//")&&(r=e+r),new URL(r,e)}function B2(n,t,e="/"){return TT(n,t,e,!1)}function TT(n,t,e,r){let a=typeof t=="string"?Rs(t):t,i=_a(a.pathname||"/",e);if(i==null)return null;let u=P2(n);DT(u);let l=null;for(let c=0;l==null&&c<u.length;++c){let f=UT(i);l=LT(u[c],f,r)}return l}function P2(n,t=[],e=[],r="",a=!1){let i=(u,l,c=a,f)=>{let d={relativePath:f===void 0?u.path||"":f,caseSensitive:u.caseSensitive===!0,childrenIndex:l,route:u};if(d.relativePath.startsWith("/")){if(!d.relativePath.startsWith(r)&&c)return;Et(d.relativePath.startsWith(r),`Absolute route path "${d.relativePath}" nested under path "${r}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),d.relativePath=d.relativePath.slice(r.length)}let v=Ea([r,d.relativePath]),m=e.concat(d);u.children&&u.children.length>0&&(Et(u.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${v}".`),P2(u.children,t,m,v,c)),!(u.path==null&&!u.index)&&t.push({path:v,score:BT(v,u.index),routesMeta:m})};return n.forEach((u,l)=>{if(u.path===""||!u.path?.includes("?"))i(u,l);else for(let c of L2(u.path))i(u,l,!0,c)}),t}function L2(n){let t=n.split("/");if(t.length===0)return[];let[e,...r]=t,a=e.endsWith("?"),i=e.replace(/\?$/,"");if(r.length===0)return a?[i,""]:[i];let u=L2(r.join("/")),l=[];return l.push(...u.map(c=>c===""?i:[i,c].join("/"))),a&&l.push(...u),l.map(c=>n.startsWith("/")&&c===""?"/":c)}function DT(n){n.sort((t,e)=>t.score!==e.score?e.score-t.score:PT(t.routesMeta.map(r=>r.childrenIndex),e.routesMeta.map(r=>r.childrenIndex)))}var OT=/^:[\w-]+$/,kT=3,NT=2,MT=1,IT=10,FT=-2,lx=n=>n==="*";function BT(n,t){let e=n.split("/"),r=e.length;return e.some(lx)&&(r+=FT),t&&(r+=NT),e.filter(a=>!lx(a)).reduce((a,i)=>a+(OT.test(i)?kT:i===""?MT:IT),r)}function PT(n,t){return n.length===t.length&&n.slice(0,-1).every((r,a)=>r===t[a])?n[n.length-1]-t[t.length-1]:0}function LT(n,t,e=!1){let{routesMeta:r}=n,a={},i="/",u=[];for(let l=0;l<r.length;++l){let c=r[l],f=l===r.length-1,d=i==="/"?t:t.slice(i.length)||"/",v=pf({path:c.relativePath,caseSensitive:c.caseSensitive,end:f},d),m=c.route;if(!v&&f&&e&&!r[r.length-1].route.index&&(v=pf({path:c.relativePath,caseSensitive:c.caseSensitive,end:!1},d)),!v)return null;Object.assign(a,v.params),u.push({params:a,pathname:Ea([i,v.pathname]),pathnameBase:GT(Ea([i,v.pathnameBase])),route:m}),v.pathnameBase!=="/"&&(i=Ea([i,v.pathnameBase]))}return u}function pf(n,t){typeof n=="string"&&(n={path:n,caseSensitive:!1,end:!0});let[e,r]=zT(n.path,n.caseSensitive,n.end),a=t.match(e);if(!a)return null;let i=a[0],u=i.replace(/(.)\/+$/,"$1"),l=a.slice(1);return{params:r.reduce((f,{paramName:d,isOptional:v},m)=>{if(d==="*"){let b=l[m]||"";u=i.slice(0,i.length-b.length).replace(/(.)\/+$/,"$1")}const g=l[m];return v&&!g?f[d]=void 0:f[d]=(g||"").replace(/%2F/g,"/"),f},{}),pathname:i,pathnameBase:u,pattern:n}}function zT(n,t=!1,e=!0){Tr(n==="*"||!n.endsWith("*")||n.endsWith("/*"),`Route path "${n}" will be treated as if it were "${n.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${n.replace(/\*$/,"/*")}".`);let r=[],a="^"+n.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(u,l,c)=>(r.push({paramName:l,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return n.endsWith("*")?(r.push({paramName:"*"}),a+=n==="*"||n==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):e?a+="\\/*$":n!==""&&n!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,t?void 0:"i"),r]}function UT(n){try{return n.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return Tr(!1,`The URL path "${n}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${t}).`),n}}function _a(n,t){if(t==="/")return n;if(!n.toLowerCase().startsWith(t.toLowerCase()))return null;let e=t.endsWith("/")?t.length-1:t.length,r=n.charAt(e);return r&&r!=="/"?null:n.slice(e)||"/"}function HT(n,t="/"){let{pathname:e,search:r="",hash:a=""}=typeof n=="string"?Rs(n):n;return{pathname:e?e.startsWith("/")?e:VT(e,t):t,search:jT(r),hash:qT(a)}}function VT(n,t){let e=t.replace(/\/+$/,"").split("/");return n.split("/").forEach(a=>{a===".."?e.length>1&&e.pop():a!=="."&&e.push(a)}),e.length>1?e.join("/"):"/"}function Wp(n,t,e,r){return`Cannot include a '${n}' character in a manually specified \`to.${t}\` field [${JSON.stringify(r)}].  Please separate it out to the \`to.${e}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function WT(n){return n.filter((t,e)=>e===0||t.route.path&&t.route.path.length>0)}function z2(n){let t=WT(n);return t.map((e,r)=>r===t.length-1?e.pathname:e.pathnameBase)}function U2(n,t,e,r=!1){let a;typeof n=="string"?a=Rs(n):(a={...n},Et(!a.pathname||!a.pathname.includes("?"),Wp("?","pathname","search",a)),Et(!a.pathname||!a.pathname.includes("#"),Wp("#","pathname","hash",a)),Et(!a.search||!a.search.includes("#"),Wp("#","search","hash",a)));let i=n===""||a.pathname==="",u=i?"/":a.pathname,l;if(u==null)l=e;else{let v=t.length-1;if(!r&&u.startsWith("..")){let m=u.split("/");for(;m[0]==="..";)m.shift(),v-=1;a.pathname=m.join("/")}l=v>=0?t[v]:"/"}let c=HT(a,l),f=u&&u!=="/"&&u.endsWith("/"),d=(i||u===".")&&e.endsWith("/");return!c.pathname.endsWith("/")&&(f||d)&&(c.pathname+="/"),c}var Ea=n=>n.join("/").replace(/\/\/+/g,"/"),GT=n=>n.replace(/\/+$/,"").replace(/^\/*/,"/"),jT=n=>!n||n==="?"?"":n.startsWith("?")?n:"?"+n,qT=n=>!n||n==="#"?"":n.startsWith("#")?n:"#"+n;function $T(n){return n!=null&&typeof n.status=="number"&&typeof n.statusText=="string"&&typeof n.internal=="boolean"&&"data"in n}var H2=["POST","PUT","PATCH","DELETE"];new Set(H2);var KT=["GET",...H2];new Set(KT);var As=Z.createContext(null);As.displayName="DataRouter";var Zf=Z.createContext(null);Zf.displayName="DataRouterState";Z.createContext(!1);var V2=Z.createContext({isTransitioning:!1});V2.displayName="ViewTransition";var XT=Z.createContext(new Map);XT.displayName="Fetchers";var ZT=Z.createContext(null);ZT.displayName="Await";var Yr=Z.createContext(null);Yr.displayName="Navigation";var al=Z.createContext(null);al.displayName="Location";var Ra=Z.createContext({outlet:null,matches:[],isDataRoute:!1});Ra.displayName="Route";var Tm=Z.createContext(null);Tm.displayName="RouteError";function YT(n,{relative:t}={}){Et(il(),"useHref() may be used only in the context of a <Router> component.");let{basename:e,navigator:r}=Z.useContext(Yr),{hash:a,pathname:i,search:u}=ol(n,{relative:t}),l=i;return e!=="/"&&(l=i==="/"?e:Ea([e,i])),r.createHref({pathname:l,search:u,hash:a})}function il(){return Z.useContext(al)!=null}function bi(){return Et(il(),"useLocation() may be used only in the context of a <Router> component."),Z.useContext(al).location}var W2="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function G2(n){Z.useContext(Yr).static||Z.useLayoutEffect(n)}function j2(){let{isDataRoute:n}=Z.useContext(Ra);return n?cD():QT()}function QT(){Et(il(),"useNavigate() may be used only in the context of a <Router> component.");let n=Z.useContext(As),{basename:t,navigator:e}=Z.useContext(Yr),{matches:r}=Z.useContext(Ra),{pathname:a}=bi(),i=JSON.stringify(z2(r)),u=Z.useRef(!1);return G2(()=>{u.current=!0}),Z.useCallback((c,f={})=>{if(Tr(u.current,W2),!u.current)return;if(typeof c=="number"){e.go(c);return}let d=U2(c,JSON.parse(i),a,f.relative==="path");n==null&&t!=="/"&&(d.pathname=d.pathname==="/"?t:Ea([t,d.pathname])),(f.replace?e.replace:e.push)(d,f.state,f)},[t,e,i,a,n])}Z.createContext(null);function ol(n,{relative:t}={}){let{matches:e}=Z.useContext(Ra),{pathname:r}=bi(),a=JSON.stringify(z2(e));return Z.useMemo(()=>U2(n,JSON.parse(a),r,t==="path"),[n,a,r,t])}function JT(n,t){return q2(n,t)}function q2(n,t,e,r,a){Et(il(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:i}=Z.useContext(Yr),{matches:u}=Z.useContext(Ra),l=u[u.length-1],c=l?l.params:{},f=l?l.pathname:"/",d=l?l.pathnameBase:"/",v=l&&l.route;{let _=v&&v.path||"";$2(f,!v||_.endsWith("*")||_.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${f}" (under <Route path="${_}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${_}"> to <Route path="${_==="/"?"*":`${_}/*`}">.`)}let m=bi(),g;if(t){let _=typeof t=="string"?Rs(t):t;Et(d==="/"||_.pathname?.startsWith(d),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${d}" but pathname "${_.pathname}" was given in the \`location\` prop.`),g=_}else g=m;let b=g.pathname||"/",w=b;if(d!=="/"){let _=d.replace(/^\//,"").split("/");w="/"+b.replace(/^\//,"").split("/").slice(_.length).join("/")}let S=B2(n,{pathname:w});Tr(v||S!=null,`No routes matched location "${g.pathname}${g.search}${g.hash}" `),Tr(S==null||S[S.length-1].route.element!==void 0||S[S.length-1].route.Component!==void 0||S[S.length-1].route.lazy!==void 0,`Matched leaf route at location "${g.pathname}${g.search}${g.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let E=aD(S&&S.map(_=>Object.assign({},_,{params:Object.assign({},c,_.params),pathname:Ea([d,i.encodeLocation?i.encodeLocation(_.pathname).pathname:_.pathname]),pathnameBase:_.pathnameBase==="/"?d:Ea([d,i.encodeLocation?i.encodeLocation(_.pathnameBase).pathname:_.pathnameBase])})),u,e,r,a);return t&&E?Z.createElement(al.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...g},navigationType:"POP"}},E):E}function eD(){let n=lD(),t=$T(n)?`${n.status} ${n.statusText}`:n instanceof Error?n.message:JSON.stringify(n),e=n instanceof Error?n.stack:null,r="rgba(200,200,200, 0.5)",a={padding:"0.5rem",backgroundColor:r},i={padding:"2px 4px",backgroundColor:r},u=null;return console.error("Error handled by React Router default ErrorBoundary:",n),u=Z.createElement(Z.Fragment,null,Z.createElement("p",null,"💿 Hey developer 👋"),Z.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",Z.createElement("code",{style:i},"ErrorBoundary")," or"," ",Z.createElement("code",{style:i},"errorElement")," prop on your route.")),Z.createElement(Z.Fragment,null,Z.createElement("h2",null,"Unexpected Application Error!"),Z.createElement("h3",{style:{fontStyle:"italic"}},t),e?Z.createElement("pre",{style:a},e):null,u)}var tD=Z.createElement(eD,null),nD=class extends Z.Component{constructor(n){super(n),this.state={location:n.location,revalidation:n.revalidation,error:n.error}}static getDerivedStateFromError(n){return{error:n}}static getDerivedStateFromProps(n,t){return t.location!==n.location||t.revalidation!=="idle"&&n.revalidation==="idle"?{error:n.error,location:n.location,revalidation:n.revalidation}:{error:n.error!==void 0?n.error:t.error,location:t.location,revalidation:n.revalidation||t.revalidation}}componentDidCatch(n,t){this.props.unstable_onError?this.props.unstable_onError(n,t):console.error("React Router caught the following error during render",n)}render(){return this.state.error!==void 0?Z.createElement(Ra.Provider,{value:this.props.routeContext},Z.createElement(Tm.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function rD({routeContext:n,match:t,children:e}){let r=Z.useContext(As);return r&&r.static&&r.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=t.route.id),Z.createElement(Ra.Provider,{value:n},e)}function aD(n,t=[],e=null,r=null,a=null){if(n==null){if(!e)return null;if(e.errors)n=e.matches;else if(t.length===0&&!e.initialized&&e.matches.length>0)n=e.matches;else return null}let i=n,u=e?.errors;if(u!=null){let f=i.findIndex(d=>d.route.id&&u?.[d.route.id]!==void 0);Et(f>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(u).join(",")}`),i=i.slice(0,Math.min(i.length,f+1))}let l=!1,c=-1;if(e)for(let f=0;f<i.length;f++){let d=i[f];if((d.route.HydrateFallback||d.route.hydrateFallbackElement)&&(c=f),d.route.id){let{loaderData:v,errors:m}=e,g=d.route.loader&&!v.hasOwnProperty(d.route.id)&&(!m||m[d.route.id]===void 0);if(d.route.lazy||g){l=!0,c>=0?i=i.slice(0,c+1):i=[i[0]];break}}}return i.reduceRight((f,d,v)=>{let m,g=!1,b=null,w=null;e&&(m=u&&d.route.id?u[d.route.id]:void 0,b=d.route.errorElement||tD,l&&(c<0&&v===0?($2("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),g=!0,w=null):c===v&&(g=!0,w=d.route.hydrateFallbackElement||null)));let S=t.concat(i.slice(0,v+1)),E=()=>{let _;return m?_=b:g?_=w:d.route.Component?_=Z.createElement(d.route.Component,null):d.route.element?_=d.route.element:_=f,Z.createElement(rD,{match:d,routeContext:{outlet:f,matches:S,isDataRoute:e!=null},children:_})};return e&&(d.route.ErrorBoundary||d.route.errorElement||v===0)?Z.createElement(nD,{location:e.location,revalidation:e.revalidation,component:b,error:m,children:E(),routeContext:{outlet:null,matches:S,isDataRoute:!0},unstable_onError:r}):E()},null)}function Dm(n){return`${n} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function iD(n){let t=Z.useContext(As);return Et(t,Dm(n)),t}function oD(n){let t=Z.useContext(Zf);return Et(t,Dm(n)),t}function sD(n){let t=Z.useContext(Ra);return Et(t,Dm(n)),t}function Om(n){let t=sD(n),e=t.matches[t.matches.length-1];return Et(e.route.id,`${n} can only be used on routes that contain a unique "id"`),e.route.id}function uD(){return Om("useRouteId")}function lD(){let n=Z.useContext(Tm),t=oD("useRouteError"),e=Om("useRouteError");return n!==void 0?n:t.errors?.[e]}function cD(){let{router:n}=iD("useNavigate"),t=Om("useNavigate"),e=Z.useRef(!1);return G2(()=>{e.current=!0}),Z.useCallback(async(a,i={})=>{Tr(e.current,W2),e.current&&(typeof a=="number"?n.navigate(a):await n.navigate(a,{fromRouteId:t,...i}))},[n,t])}var cx={};function $2(n,t,e){!t&&!cx[n]&&(cx[n]=!0,Tr(!1,e))}Z.memo(fD);function fD({routes:n,future:t,state:e,unstable_onError:r}){return q2(n,void 0,e,r,t)}function hD(n){Et(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function dD({basename:n="/",children:t=null,location:e,navigationType:r="POP",navigator:a,static:i=!1}){Et(!il(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let u=n.replace(/^\/*/,"/"),l=Z.useMemo(()=>({basename:u,navigator:a,static:i,future:{}}),[u,a,i]);typeof e=="string"&&(e=Rs(e));let{pathname:c="/",search:f="",hash:d="",state:v=null,key:m="default"}=e,g=Z.useMemo(()=>{let b=_a(c,u);return b==null?null:{location:{pathname:b,search:f,hash:d,state:v,key:m},navigationType:r}},[u,c,f,d,v,m,r]);return Tr(g!=null,`<Router basename="${u}"> is not able to match the URL "${c}${f}${d}" because it does not start with the basename, so the <Router> won't render anything.`),g==null?null:Z.createElement(Yr.Provider,{value:l},Z.createElement(al.Provider,{children:t,value:g}))}function M6({children:n,location:t}){return JT(Mv(n),t)}function Mv(n,t=[]){let e=[];return Z.Children.forEach(n,(r,a)=>{if(!Z.isValidElement(r))return;let i=[...t,a];if(r.type===Z.Fragment){e.push.apply(e,Mv(r.props.children,i));return}Et(r.type===hD,`[${typeof r.type=="string"?r.type:r.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),Et(!r.props.index||!r.props.children,"An index route cannot have child routes.");let u={id:r.props.id||i.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,hydrateFallbackElement:r.props.hydrateFallbackElement,HydrateFallback:r.props.HydrateFallback,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.hasErrorBoundary===!0||r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(u.children=Mv(r.props.children,i)),e.push(u)}),e}var of="get",sf="application/x-www-form-urlencoded";function Yf(n){return n!=null&&typeof n.tagName=="string"}function pD(n){return Yf(n)&&n.tagName.toLowerCase()==="button"}function vD(n){return Yf(n)&&n.tagName.toLowerCase()==="form"}function mD(n){return Yf(n)&&n.tagName.toLowerCase()==="input"}function gD(n){return!!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)}function yD(n,t){return n.button===0&&(!t||t==="_self")&&!gD(n)}function Iv(n=""){return new URLSearchParams(typeof n=="string"||Array.isArray(n)||n instanceof URLSearchParams?n:Object.keys(n).reduce((t,e)=>{let r=n[e];return t.concat(Array.isArray(r)?r.map(a=>[e,a]):[[e,r]])},[]))}function bD(n,t){let e=Iv(n);return t&&t.forEach((r,a)=>{e.has(a)||t.getAll(a).forEach(i=>{e.append(a,i)})}),e}var kc=null;function xD(){if(kc===null)try{new FormData(document.createElement("form"),0),kc=!1}catch{kc=!0}return kc}var wD=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function Gp(n){return n!=null&&!wD.has(n)?(Tr(!1,`"${n}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${sf}"`),null):n}function SD(n,t){let e,r,a,i,u;if(vD(n)){let l=n.getAttribute("action");r=l?_a(l,t):null,e=n.getAttribute("method")||of,a=Gp(n.getAttribute("enctype"))||sf,i=new FormData(n)}else if(pD(n)||mD(n)&&(n.type==="submit"||n.type==="image")){let l=n.form;if(l==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let c=n.getAttribute("formaction")||l.getAttribute("action");if(r=c?_a(c,t):null,e=n.getAttribute("formmethod")||l.getAttribute("method")||of,a=Gp(n.getAttribute("formenctype"))||Gp(l.getAttribute("enctype"))||sf,i=new FormData(l,n),!xD()){let{name:f,type:d,value:v}=n;if(d==="image"){let m=f?`${f}.`:"";i.append(`${m}x`,"0"),i.append(`${m}y`,"0")}else f&&i.append(f,v)}}else{if(Yf(n))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');e=of,r=null,a=sf,u=n}return i&&a==="text/plain"&&(u=i,i=void 0),{action:r,method:e.toLowerCase(),encType:a,formData:i,body:u}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function km(n,t){if(n===!1||n===null||typeof n>"u")throw new Error(t)}function ED(n,t,e){let r=typeof n=="string"?new URL(n,typeof window>"u"?"server://singlefetch/":window.location.origin):n;return r.pathname==="/"?r.pathname=`_root.${e}`:t&&_a(r.pathname,t)==="/"?r.pathname=`${t.replace(/\/$/,"")}/_root.${e}`:r.pathname=`${r.pathname.replace(/\/$/,"")}.${e}`,r}async function _D(n,t){if(n.id in t)return t[n.id];try{let e=await import(n.module);return t[n.id]=e,e}catch(e){return console.error(`Error loading route module \`${n.module}\`, reloading page...`),console.error(e),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function CD(n){return n==null?!1:n.href==null?n.rel==="preload"&&typeof n.imageSrcSet=="string"&&typeof n.imageSizes=="string":typeof n.rel=="string"&&typeof n.href=="string"}async function RD(n,t,e){let r=await Promise.all(n.map(async a=>{let i=t.routes[a.route.id];if(i){let u=await _D(i,e);return u.links?u.links():[]}return[]}));return OD(r.flat(1).filter(CD).filter(a=>a.rel==="stylesheet"||a.rel==="preload").map(a=>a.rel==="stylesheet"?{...a,rel:"prefetch",as:"style"}:{...a,rel:"prefetch"}))}function fx(n,t,e,r,a,i){let u=(c,f)=>e[f]?c.route.id!==e[f].route.id:!0,l=(c,f)=>e[f].pathname!==c.pathname||e[f].route.path?.endsWith("*")&&e[f].params["*"]!==c.params["*"];return i==="assets"?t.filter((c,f)=>u(c,f)||l(c,f)):i==="data"?t.filter((c,f)=>{let d=r.routes[c.route.id];if(!d||!d.hasLoader)return!1;if(u(c,f)||l(c,f))return!0;if(c.route.shouldRevalidate){let v=c.route.shouldRevalidate({currentUrl:new URL(a.pathname+a.search+a.hash,window.origin),currentParams:e[0]?.params||{},nextUrl:new URL(n,window.origin),nextParams:c.params,defaultShouldRevalidate:!0});if(typeof v=="boolean")return v}return!0}):[]}function AD(n,t,{includeHydrateFallback:e}={}){return TD(n.map(r=>{let a=t.routes[r.route.id];if(!a)return[];let i=[a.module];return a.clientActionModule&&(i=i.concat(a.clientActionModule)),a.clientLoaderModule&&(i=i.concat(a.clientLoaderModule)),e&&a.hydrateFallbackModule&&(i=i.concat(a.hydrateFallbackModule)),a.imports&&(i=i.concat(a.imports)),i}).flat(1))}function TD(n){return[...new Set(n)]}function DD(n){let t={},e=Object.keys(n).sort();for(let r of e)t[r]=n[r];return t}function OD(n,t){let e=new Set;return new Set(t),n.reduce((r,a)=>{let i=JSON.stringify(DD(a));return e.has(i)||(e.add(i),r.push({key:i,link:a})),r},[])}function K2(){let n=Z.useContext(As);return km(n,"You must render this element inside a <DataRouterContext.Provider> element"),n}function kD(){let n=Z.useContext(Zf);return km(n,"You must render this element inside a <DataRouterStateContext.Provider> element"),n}var Nm=Z.createContext(void 0);Nm.displayName="FrameworkContext";function X2(){let n=Z.useContext(Nm);return km(n,"You must render this element inside a <HydratedRouter> element"),n}function ND(n,t){let e=Z.useContext(Nm),[r,a]=Z.useState(!1),[i,u]=Z.useState(!1),{onFocus:l,onBlur:c,onMouseEnter:f,onMouseLeave:d,onTouchStart:v}=t,m=Z.useRef(null);Z.useEffect(()=>{if(n==="render"&&u(!0),n==="viewport"){let w=E=>{E.forEach(_=>{u(_.isIntersecting)})},S=new IntersectionObserver(w,{threshold:.5});return m.current&&S.observe(m.current),()=>{S.disconnect()}}},[n]),Z.useEffect(()=>{if(r){let w=setTimeout(()=>{u(!0)},100);return()=>{clearTimeout(w)}}},[r]);let g=()=>{a(!0)},b=()=>{a(!1),u(!1)};return e?n!=="intent"?[i,m,{}]:[i,m,{onFocus:Du(l,g),onBlur:Du(c,b),onMouseEnter:Du(f,g),onMouseLeave:Du(d,b),onTouchStart:Du(v,g)}]:[!1,m,{}]}function Du(n,t){return e=>{n&&n(e),e.defaultPrevented||t(e)}}function MD({page:n,...t}){let{router:e}=K2(),r=Z.useMemo(()=>B2(e.routes,n,e.basename),[e.routes,n,e.basename]);return r?Z.createElement(FD,{page:n,matches:r,...t}):null}function ID(n){let{manifest:t,routeModules:e}=X2(),[r,a]=Z.useState([]);return Z.useEffect(()=>{let i=!1;return RD(n,t,e).then(u=>{i||a(u)}),()=>{i=!0}},[n,t,e]),r}function FD({page:n,matches:t,...e}){let r=bi(),{manifest:a,routeModules:i}=X2(),{basename:u}=K2(),{loaderData:l,matches:c}=kD(),f=Z.useMemo(()=>fx(n,t,c,a,r,"data"),[n,t,c,a,r]),d=Z.useMemo(()=>fx(n,t,c,a,r,"assets"),[n,t,c,a,r]),v=Z.useMemo(()=>{if(n===r.pathname+r.search+r.hash)return[];let b=new Set,w=!1;if(t.forEach(E=>{let _=a.routes[E.route.id];!_||!_.hasLoader||(!f.some(R=>R.route.id===E.route.id)&&E.route.id in l&&i[E.route.id]?.shouldRevalidate||_.hasClientLoader?w=!0:b.add(E.route.id))}),b.size===0)return[];let S=ED(n,u,"data");return w&&b.size>0&&S.searchParams.set("_routes",t.filter(E=>b.has(E.route.id)).map(E=>E.route.id).join(",")),[S.pathname+S.search]},[u,l,r,a,f,t,n,i]),m=Z.useMemo(()=>AD(d,a),[d,a]),g=ID(d);return Z.createElement(Z.Fragment,null,v.map(b=>Z.createElement("link",{key:b,rel:"prefetch",as:"fetch",href:b,...e})),m.map(b=>Z.createElement("link",{key:b,rel:"modulepreload",href:b,...e})),g.map(({key:b,link:w})=>Z.createElement("link",{key:b,nonce:e.nonce,...w})))}function BD(...n){return t=>{n.forEach(e=>{typeof e=="function"?e(t):e!=null&&(e.current=t)})}}var Z2=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{Z2&&(window.__reactRouterVersion="7.8.2")}catch{}function I6({basename:n,children:t,window:e}){let r=Z.useRef();r.current==null&&(r.current=_T({window:e,v5Compat:!0}));let a=r.current,[i,u]=Z.useState({action:a.action,location:a.location}),l=Z.useCallback(c=>{Z.startTransition(()=>u(c))},[u]);return Z.useLayoutEffect(()=>a.listen(l),[a,l]),Z.createElement(dD,{basename:n,children:t,location:i.location,navigationType:i.action,navigator:a})}var Y2=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Q2=Z.forwardRef(function({onClick:t,discover:e="render",prefetch:r="none",relative:a,reloadDocument:i,replace:u,state:l,target:c,to:f,preventScrollReset:d,viewTransition:v,...m},g){let{basename:b}=Z.useContext(Yr),w=typeof f=="string"&&Y2.test(f),S,E=!1;if(typeof f=="string"&&w&&(S=f,Z2))try{let N=new URL(window.location.href),B=f.startsWith("//")?new URL(N.protocol+f):new URL(f),H=_a(B.pathname,b);B.origin===N.origin&&H!=null?f=H+B.search+B.hash:E=!0}catch{Tr(!1,`<Link to="${f}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let _=YT(f,{relative:a}),[R,C,A]=ND(r,m),D=UD(f,{replace:u,state:l,target:c,preventScrollReset:d,relative:a,viewTransition:v});function O(N){t&&t(N),N.defaultPrevented||D(N)}let F=Z.createElement("a",{...m,...A,href:S||_,onClick:E||i?t:O,ref:BD(g,C),target:c,"data-discover":!w&&e==="render"?"true":void 0});return R&&!w?Z.createElement(Z.Fragment,null,F,Z.createElement(MD,{page:_})):F});Q2.displayName="Link";var PD=Z.forwardRef(function({"aria-current":t="page",caseSensitive:e=!1,className:r="",end:a=!1,style:i,to:u,viewTransition:l,children:c,...f},d){let v=ol(u,{relative:f.relative}),m=bi(),g=Z.useContext(Zf),{navigator:b,basename:w}=Z.useContext(Yr),S=g!=null&&jD(v)&&l===!0,E=b.encodeLocation?b.encodeLocation(v).pathname:v.pathname,_=m.pathname,R=g&&g.navigation&&g.navigation.location?g.navigation.location.pathname:null;e||(_=_.toLowerCase(),R=R?R.toLowerCase():null,E=E.toLowerCase()),R&&w&&(R=_a(R,w)||R);const C=E!=="/"&&E.endsWith("/")?E.length-1:E.length;let A=_===E||!a&&_.startsWith(E)&&_.charAt(C)==="/",D=R!=null&&(R===E||!a&&R.startsWith(E)&&R.charAt(E.length)==="/"),O={isActive:A,isPending:D,isTransitioning:S},F=A?t:void 0,N;typeof r=="function"?N=r(O):N=[r,A?"active":null,D?"pending":null,S?"transitioning":null].filter(Boolean).join(" ");let B=typeof i=="function"?i(O):i;return Z.createElement(Q2,{...f,"aria-current":F,className:N,ref:d,style:B,to:u,viewTransition:l},typeof c=="function"?c(O):c)});PD.displayName="NavLink";var LD=Z.forwardRef(({discover:n="render",fetcherKey:t,navigate:e,reloadDocument:r,replace:a,state:i,method:u=of,action:l,onSubmit:c,relative:f,preventScrollReset:d,viewTransition:v,...m},g)=>{let b=WD(),w=GD(l,{relative:f}),S=u.toLowerCase()==="get"?"get":"post",E=typeof l=="string"&&Y2.test(l),_=R=>{if(c&&c(R),R.defaultPrevented)return;R.preventDefault();let C=R.nativeEvent.submitter,A=C?.getAttribute("formmethod")||u;b(C||R.currentTarget,{fetcherKey:t,method:A,navigate:e,replace:a,state:i,relative:f,preventScrollReset:d,viewTransition:v})};return Z.createElement("form",{ref:g,method:S,action:w,onSubmit:r?c:_,...m,"data-discover":!E&&n==="render"?"true":void 0})});LD.displayName="Form";function zD(n){return`${n} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function J2(n){let t=Z.useContext(As);return Et(t,zD(n)),t}function UD(n,{target:t,replace:e,state:r,preventScrollReset:a,relative:i,viewTransition:u}={}){let l=j2(),c=bi(),f=ol(n,{relative:i});return Z.useCallback(d=>{if(yD(d,t)){d.preventDefault();let v=e!==void 0?e:Wu(c)===Wu(f);l(n,{replace:v,state:r,preventScrollReset:a,relative:i,viewTransition:u})}},[c,l,f,e,r,t,n,a,i,u])}function F6(n){Tr(typeof URLSearchParams<"u","You cannot use the `useSearchParams` hook in a browser that does not support the URLSearchParams API. If you need to support Internet Explorer 11, we recommend you load a polyfill such as https://github.com/ungap/url-search-params.");let t=Z.useRef(Iv(n)),e=Z.useRef(!1),r=bi(),a=Z.useMemo(()=>bD(r.search,e.current?null:t.current),[r.search]),i=j2(),u=Z.useCallback((l,c)=>{const f=Iv(typeof l=="function"?l(new URLSearchParams(a)):l);e.current=!0,i("?"+f,c)},[i,a]);return[a,u]}var HD=0,VD=()=>`__${String(++HD)}__`;function WD(){let{router:n}=J2("useSubmit"),{basename:t}=Z.useContext(Yr),e=uD();return Z.useCallback(async(r,a={})=>{let{action:i,method:u,encType:l,formData:c,body:f}=SD(r,t);if(a.navigate===!1){let d=a.fetcherKey||VD();await n.fetch(d,e,a.action||i,{preventScrollReset:a.preventScrollReset,formData:c,body:f,formMethod:a.method||u,formEncType:a.encType||l,flushSync:a.flushSync})}else await n.navigate(a.action||i,{preventScrollReset:a.preventScrollReset,formData:c,body:f,formMethod:a.method||u,formEncType:a.encType||l,replace:a.replace,state:a.state,fromRouteId:e,flushSync:a.flushSync,viewTransition:a.viewTransition})},[n,t,e])}function GD(n,{relative:t}={}){let{basename:e}=Z.useContext(Yr),r=Z.useContext(Ra);Et(r,"useFormAction must be used inside a RouteContext");let[a]=r.matches.slice(-1),i={...ol(n||".",{relative:t})},u=bi();if(n==null){i.search=u.search;let l=new URLSearchParams(i.search),c=l.getAll("index");if(c.some(d=>d==="")){l.delete("index"),c.filter(v=>v).forEach(v=>l.append("index",v));let d=l.toString();i.search=d?`?${d}`:""}}return(!n||n===".")&&a.route.index&&(i.search=i.search?i.search.replace(/^\?/,"?index&"):"?index"),e!=="/"&&(i.pathname=i.pathname==="/"?e:Ea([e,i.pathname])),Wu(i)}function jD(n,{relative:t}={}){let e=Z.useContext(V2);Et(e!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:r}=J2("useViewTransitionState"),a=ol(n,{relative:t});if(!e.isTransitioning)return!1;let i=_a(e.currentLocation.pathname,r)||e.currentLocation.pathname,u=_a(e.nextLocation.pathname,r)||e.nextLocation.pathname;return pf(a.pathname,u)!=null||pf(a.pathname,i)!=null}function qD(n={}){const{nonce:t,onScriptLoadSuccess:e,onScriptLoadError:r}=n,[a,i]=Z.useState(!1),u=Z.useRef(e);u.current=e;const l=Z.useRef(r);return l.current=r,Z.useEffect(()=>{const c=document.createElement("script");return c.src="https://accounts.google.com/gsi/client",c.async=!0,c.defer=!0,c.nonce=t,c.onload=()=>{var f;i(!0),(f=u.current)===null||f===void 0||f.call(u)},c.onerror=()=>{var f;i(!1),(f=l.current)===null||f===void 0||f.call(l)},document.body.appendChild(c),()=>{document.body.removeChild(c)}},[t]),a}const eS=Z.createContext(null);function B6({clientId:n,nonce:t,onScriptLoadSuccess:e,onScriptLoadError:r,children:a}){const i=qD({nonce:t,onScriptLoadSuccess:e,onScriptLoadError:r}),u=Z.useMemo(()=>({clientId:n,scriptLoadedSuccessfully:i}),[n,i]);return xn.createElement(eS.Provider,{value:u},a)}function $D(){const n=Z.useContext(eS);if(!n)throw new Error("Google OAuth components must be used within GoogleOAuthProvider");return n}function P6({flow:n="implicit",scope:t="",onSuccess:e,onError:r,onNonOAuthError:a,overrideScope:i,state:u,...l}){const{clientId:c,scriptLoadedSuccessfully:f}=$D(),d=Z.useRef(),v=Z.useRef(e);v.current=e;const m=Z.useRef(r);m.current=r;const g=Z.useRef(a);g.current=a,Z.useEffect(()=>{var S,E;if(!f)return;const _=n==="implicit"?"initTokenClient":"initCodeClient",R=(E=(S=window?.google)===null||S===void 0?void 0:S.accounts)===null||E===void 0?void 0:E.oauth2[_]({client_id:c,scope:i?t:`openid profile email ${t}`,callback:C=>{var A,D;if(C.error)return(A=m.current)===null||A===void 0?void 0:A.call(m,C);(D=v.current)===null||D===void 0||D.call(v,C)},error_callback:C=>{var A;(A=g.current)===null||A===void 0||A.call(g,C)},state:u,...l});d.current=R},[c,f,n,t,u]);const b=Z.useCallback(S=>{var E;return(E=d.current)===null||E===void 0?void 0:E.requestAccessToken(S)},[]),w=Z.useCallback(()=>{var S;return(S=d.current)===null||S===void 0?void 0:S.requestCode()},[]);return n==="implicit"?b:w}var Ts=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(n){return this.listeners.add(n),this.onSubscribe(),()=>{this.listeners.delete(n),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},Qi=typeof window>"u"||"Deno"in globalThis;function _n(){}function KD(n,t){return typeof n=="function"?n(t):n}function Fv(n){return typeof n=="number"&&n>=0&&n!==1/0}function tS(n,t){return Math.max(n+(t||0)-Date.now(),0)}function di(n,t){return typeof n=="function"?n(t):n}function fr(n,t){return typeof n=="function"?n(t):n}function hx(n,t){const{type:e="all",exact:r,fetchStatus:a,predicate:i,queryKey:u,stale:l}=n;if(u){if(r){if(t.queryHash!==Mm(u,t.options))return!1}else if(!Gu(t.queryKey,u))return!1}if(e!=="all"){const c=t.isActive();if(e==="active"&&!c||e==="inactive"&&c)return!1}return!(typeof l=="boolean"&&t.isStale()!==l||a&&a!==t.state.fetchStatus||i&&!i(t))}function dx(n,t){const{exact:e,status:r,predicate:a,mutationKey:i}=n;if(i){if(!t.options.mutationKey)return!1;if(e){if(Ji(t.options.mutationKey)!==Ji(i))return!1}else if(!Gu(t.options.mutationKey,i))return!1}return!(r&&t.state.status!==r||a&&!a(t))}function Mm(n,t){return(t?.queryKeyHashFn||Ji)(n)}function Ji(n){return JSON.stringify(n,(t,e)=>Bv(e)?Object.keys(e).sort().reduce((r,a)=>(r[a]=e[a],r),{}):e)}function Gu(n,t){return n===t?!0:typeof n!=typeof t?!1:n&&t&&typeof n=="object"&&typeof t=="object"?Object.keys(t).every(e=>Gu(n[e],t[e])):!1}function nS(n,t){if(n===t)return n;const e=px(n)&&px(t);if(e||Bv(n)&&Bv(t)){const r=e?n:Object.keys(n),a=r.length,i=e?t:Object.keys(t),u=i.length,l=e?[]:{},c=new Set(r);let f=0;for(let d=0;d<u;d++){const v=e?d:i[d];(!e&&c.has(v)||e)&&n[v]===void 0&&t[v]===void 0?(l[v]=void 0,f++):(l[v]=nS(n[v],t[v]),l[v]===n[v]&&n[v]!==void 0&&f++)}return a===u&&f===a?n:l}return t}function vf(n,t){if(!t||Object.keys(n).length!==Object.keys(t).length)return!1;for(const e in n)if(n[e]!==t[e])return!1;return!0}function px(n){return Array.isArray(n)&&n.length===Object.keys(n).length}function Bv(n){if(!vx(n))return!1;const t=n.constructor;if(t===void 0)return!0;const e=t.prototype;return!(!vx(e)||!e.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(n)!==Object.prototype)}function vx(n){return Object.prototype.toString.call(n)==="[object Object]"}function XD(n){return new Promise(t=>{setTimeout(t,n)})}function Pv(n,t,e){return typeof e.structuralSharing=="function"?e.structuralSharing(n,t):e.structuralSharing!==!1?nS(n,t):t}function ZD(n,t,e=0){const r=[...n,t];return e&&r.length>e?r.slice(1):r}function YD(n,t,e=0){const r=[t,...n];return e&&r.length>e?r.slice(0,-1):r}var Im=Symbol();function rS(n,t){return!n.queryFn&&t?.initialPromise?()=>t.initialPromise:!n.queryFn||n.queryFn===Im?()=>Promise.reject(new Error(`Missing queryFn: '${n.queryHash}'`)):n.queryFn}function aS(n,t){return typeof n=="function"?n(...t):!!n}var QD=class extends Ts{#t;#e;#n;constructor(){super(),this.#n=n=>{if(!Qi&&window.addEventListener){const t=()=>n();return window.addEventListener("visibilitychange",t,!1),()=>{window.removeEventListener("visibilitychange",t)}}}}onSubscribe(){this.#e||this.setEventListener(this.#n)}onUnsubscribe(){this.hasListeners()||(this.#e?.(),this.#e=void 0)}setEventListener(n){this.#n=n,this.#e?.(),this.#e=n(t=>{typeof t=="boolean"?this.setFocused(t):this.onFocus()})}setFocused(n){this.#t!==n&&(this.#t=n,this.onFocus())}onFocus(){const n=this.isFocused();this.listeners.forEach(t=>{t(n)})}isFocused(){return typeof this.#t=="boolean"?this.#t:globalThis.document?.visibilityState!=="hidden"}},Fm=new QD,JD=class extends Ts{#t=!0;#e;#n;constructor(){super(),this.#n=n=>{if(!Qi&&window.addEventListener){const t=()=>n(!0),e=()=>n(!1);return window.addEventListener("online",t,!1),window.addEventListener("offline",e,!1),()=>{window.removeEventListener("online",t),window.removeEventListener("offline",e)}}}}onSubscribe(){this.#e||this.setEventListener(this.#n)}onUnsubscribe(){this.hasListeners()||(this.#e?.(),this.#e=void 0)}setEventListener(n){this.#n=n,this.#e?.(),this.#e=n(this.setOnline.bind(this))}setOnline(n){this.#t!==n&&(this.#t=n,this.listeners.forEach(e=>{e(n)}))}isOnline(){return this.#t}},mf=new JD;function Lv(){let n,t;const e=new Promise((a,i)=>{n=a,t=i});e.status="pending",e.catch(()=>{});function r(a){Object.assign(e,a),delete e.resolve,delete e.reject}return e.resolve=a=>{r({status:"fulfilled",value:a}),n(a)},e.reject=a=>{r({status:"rejected",reason:a}),t(a)},e}function eO(n){return Math.min(1e3*2**n,3e4)}function iS(n){return(n??"online")==="online"?mf.isOnline():!0}var zv=class extends Error{constructor(n){super("CancelledError"),this.revert=n?.revert,this.silent=n?.silent}};function oS(n){let t=!1,e=0,r;const a=Lv(),i=()=>a.status!=="pending",u=w=>{if(!i()){const S=new zv(w);m(S),n.onCancel?.(S)}},l=()=>{t=!0},c=()=>{t=!1},f=()=>Fm.isFocused()&&(n.networkMode==="always"||mf.isOnline())&&n.canRun(),d=()=>iS(n.networkMode)&&n.canRun(),v=w=>{i()||(r?.(),a.resolve(w))},m=w=>{i()||(r?.(),a.reject(w))},g=()=>new Promise(w=>{r=S=>{(i()||f())&&w(S)},n.onPause?.()}).then(()=>{r=void 0,i()||n.onContinue?.()}),b=()=>{if(i())return;let w;const S=e===0?n.initialPromise:void 0;try{w=S??n.fn()}catch(E){w=Promise.reject(E)}Promise.resolve(w).then(v).catch(E=>{if(i())return;const _=n.retry??(Qi?0:3),R=n.retryDelay??eO,C=typeof R=="function"?R(e,E):R,A=_===!0||typeof _=="number"&&e<_||typeof _=="function"&&_(e,E);if(t||!A){m(E);return}e++,n.onFail?.(e,E),XD(C).then(()=>f()?void 0:g()).then(()=>{t?m(E):b()})})};return{promise:a,status:()=>a.status,cancel:u,continue:()=>(r?.(),a),cancelRetry:l,continueRetry:c,canStart:d,start:()=>(d()?b():g().then(b),a)}}var tO=n=>setTimeout(n,0);function nO(){let n=[],t=0,e=l=>{l()},r=l=>{l()},a=tO;const i=l=>{t?n.push(l):a(()=>{e(l)})},u=()=>{const l=n;n=[],l.length&&a(()=>{r(()=>{l.forEach(c=>{e(c)})})})};return{batch:l=>{let c;t++;try{c=l()}finally{t--,t||u()}return c},batchCalls:l=>(...c)=>{i(()=>{l(...c)})},schedule:i,setNotifyFunction:l=>{e=l},setBatchNotifyFunction:l=>{r=l},setScheduler:l=>{a=l}}}var Wt=nO(),sS=class{#t;destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),Fv(this.gcTime)&&(this.#t=setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(n){this.gcTime=Math.max(this.gcTime||0,n??(Qi?1/0:5*60*1e3))}clearGcTimeout(){this.#t&&(clearTimeout(this.#t),this.#t=void 0)}},rO=class extends sS{#t;#e;#n;#r;#a;#o;#s;constructor(n){super(),this.#s=!1,this.#o=n.defaultOptions,this.setOptions(n.options),this.observers=[],this.#r=n.client,this.#n=this.#r.getQueryCache(),this.queryKey=n.queryKey,this.queryHash=n.queryHash,this.#t=aO(this.options),this.state=n.state??this.#t,this.scheduleGc()}get meta(){return this.options.meta}get promise(){return this.#a?.promise}setOptions(n){this.options={...this.#o,...n},this.updateGcTime(this.options.gcTime)}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&this.#n.remove(this)}setData(n,t){const e=Pv(this.state.data,n,this.options);return this.#i({data:e,type:"success",dataUpdatedAt:t?.updatedAt,manual:t?.manual}),e}setState(n,t){this.#i({type:"setState",state:n,setStateOptions:t})}cancel(n){const t=this.#a?.promise;return this.#a?.cancel(n),t?t.then(_n).catch(_n):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(this.#t)}isActive(){return this.observers.some(n=>fr(n.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===Im||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(n=>di(n.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(n=>n.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(n=0){return this.state.data===void 0?!0:n==="static"?!1:this.state.isInvalidated?!0:!tS(this.state.dataUpdatedAt,n)}onFocus(){this.observers.find(t=>t.shouldFetchOnWindowFocus())?.refetch({cancelRefetch:!1}),this.#a?.continue()}onOnline(){this.observers.find(t=>t.shouldFetchOnReconnect())?.refetch({cancelRefetch:!1}),this.#a?.continue()}addObserver(n){this.observers.includes(n)||(this.observers.push(n),this.clearGcTimeout(),this.#n.notify({type:"observerAdded",query:this,observer:n}))}removeObserver(n){this.observers.includes(n)&&(this.observers=this.observers.filter(t=>t!==n),this.observers.length||(this.#a&&(this.#s?this.#a.cancel({revert:!0}):this.#a.cancelRetry()),this.scheduleGc()),this.#n.notify({type:"observerRemoved",query:this,observer:n}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||this.#i({type:"invalidate"})}async fetch(n,t){if(this.state.fetchStatus!=="idle"&&this.#a?.status()!=="rejected"){if(this.state.data!==void 0&&t?.cancelRefetch)this.cancel({silent:!0});else if(this.#a)return this.#a.continueRetry(),this.#a.promise}if(n&&this.setOptions(n),!this.options.queryFn){const l=this.observers.find(c=>c.options.queryFn);l&&this.setOptions(l.options)}const e=new AbortController,r=l=>{Object.defineProperty(l,"signal",{enumerable:!0,get:()=>(this.#s=!0,e.signal)})},a=()=>{const l=rS(this.options,t),f=(()=>{const d={client:this.#r,queryKey:this.queryKey,meta:this.meta};return r(d),d})();return this.#s=!1,this.options.persister?this.options.persister(l,f,this):l(f)},u=(()=>{const l={fetchOptions:t,options:this.options,queryKey:this.queryKey,client:this.#r,state:this.state,fetchFn:a};return r(l),l})();this.options.behavior?.onFetch(u,this),this.#e=this.state,(this.state.fetchStatus==="idle"||this.state.fetchMeta!==u.fetchOptions?.meta)&&this.#i({type:"fetch",meta:u.fetchOptions?.meta}),this.#a=oS({initialPromise:t?.initialPromise,fn:u.fetchFn,onCancel:l=>{l instanceof zv&&l.revert&&this.setState({...this.#e,fetchStatus:"idle"}),e.abort()},onFail:(l,c)=>{this.#i({type:"failed",failureCount:l,error:c})},onPause:()=>{this.#i({type:"pause"})},onContinue:()=>{this.#i({type:"continue"})},retry:u.options.retry,retryDelay:u.options.retryDelay,networkMode:u.options.networkMode,canRun:()=>!0});try{const l=await this.#a.start();if(l===void 0)throw new Error(`${this.queryHash} data is undefined`);return this.setData(l),this.#n.config.onSuccess?.(l,this),this.#n.config.onSettled?.(l,this.state.error,this),l}catch(l){if(l instanceof zv){if(l.silent)return this.#a.promise;if(l.revert){if(this.state.data===void 0)throw l;return this.state.data}}throw this.#i({type:"error",error:l}),this.#n.config.onError?.(l,this),this.#n.config.onSettled?.(this.state.data,l,this),l}finally{this.scheduleGc()}}#i(n){const t=e=>{switch(n.type){case"failed":return{...e,fetchFailureCount:n.failureCount,fetchFailureReason:n.error};case"pause":return{...e,fetchStatus:"paused"};case"continue":return{...e,fetchStatus:"fetching"};case"fetch":return{...e,...uS(e.data,this.options),fetchMeta:n.meta??null};case"success":const r={...e,data:n.data,dataUpdateCount:e.dataUpdateCount+1,dataUpdatedAt:n.dataUpdatedAt??Date.now(),error:null,isInvalidated:!1,status:"success",...!n.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};return this.#e=n.manual?r:void 0,r;case"error":const a=n.error;return{...e,error:a,errorUpdateCount:e.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:e.fetchFailureCount+1,fetchFailureReason:a,fetchStatus:"idle",status:"error"};case"invalidate":return{...e,isInvalidated:!0};case"setState":return{...e,...n.state}}};this.state=t(this.state),Wt.batch(()=>{this.observers.forEach(e=>{e.onQueryUpdate()}),this.#n.notify({query:this,type:"updated",action:n})})}};function uS(n,t){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:iS(t.networkMode)?"fetching":"paused",...n===void 0&&{error:null,status:"pending"}}}function aO(n){const t=typeof n.initialData=="function"?n.initialData():n.initialData,e=t!==void 0,r=e?typeof n.initialDataUpdatedAt=="function"?n.initialDataUpdatedAt():n.initialDataUpdatedAt:0;return{data:t,dataUpdateCount:0,dataUpdatedAt:e?r??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:e?"success":"pending",fetchStatus:"idle"}}var iO=class extends Ts{constructor(n={}){super(),this.config=n,this.#t=new Map}#t;build(n,t,e){const r=t.queryKey,a=t.queryHash??Mm(r,t);let i=this.get(a);return i||(i=new rO({client:n,queryKey:r,queryHash:a,options:n.defaultQueryOptions(t),state:e,defaultOptions:n.getQueryDefaults(r)}),this.add(i)),i}add(n){this.#t.has(n.queryHash)||(this.#t.set(n.queryHash,n),this.notify({type:"added",query:n}))}remove(n){const t=this.#t.get(n.queryHash);t&&(n.destroy(),t===n&&this.#t.delete(n.queryHash),this.notify({type:"removed",query:n}))}clear(){Wt.batch(()=>{this.getAll().forEach(n=>{this.remove(n)})})}get(n){return this.#t.get(n)}getAll(){return[...this.#t.values()]}find(n){const t={exact:!0,...n};return this.getAll().find(e=>hx(t,e))}findAll(n={}){const t=this.getAll();return Object.keys(n).length>0?t.filter(e=>hx(n,e)):t}notify(n){Wt.batch(()=>{this.listeners.forEach(t=>{t(n)})})}onFocus(){Wt.batch(()=>{this.getAll().forEach(n=>{n.onFocus()})})}onOnline(){Wt.batch(()=>{this.getAll().forEach(n=>{n.onOnline()})})}},oO=class extends sS{#t;#e;#n;constructor(n){super(),this.mutationId=n.mutationId,this.#e=n.mutationCache,this.#t=[],this.state=n.state||lS(),this.setOptions(n.options),this.scheduleGc()}setOptions(n){this.options=n,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(n){this.#t.includes(n)||(this.#t.push(n),this.clearGcTimeout(),this.#e.notify({type:"observerAdded",mutation:this,observer:n}))}removeObserver(n){this.#t=this.#t.filter(t=>t!==n),this.scheduleGc(),this.#e.notify({type:"observerRemoved",mutation:this,observer:n})}optionalRemove(){this.#t.length||(this.state.status==="pending"?this.scheduleGc():this.#e.remove(this))}continue(){return this.#n?.continue()??this.execute(this.state.variables)}async execute(n){const t=()=>{this.#r({type:"continue"})};this.#n=oS({fn:()=>this.options.mutationFn?this.options.mutationFn(n):Promise.reject(new Error("No mutationFn found")),onFail:(a,i)=>{this.#r({type:"failed",failureCount:a,error:i})},onPause:()=>{this.#r({type:"pause"})},onContinue:t,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>this.#e.canRun(this)});const e=this.state.status==="pending",r=!this.#n.canStart();try{if(e)t();else{this.#r({type:"pending",variables:n,isPaused:r}),await this.#e.config.onMutate?.(n,this);const i=await this.options.onMutate?.(n);i!==this.state.context&&this.#r({type:"pending",context:i,variables:n,isPaused:r})}const a=await this.#n.start();return await this.#e.config.onSuccess?.(a,n,this.state.context,this),await this.options.onSuccess?.(a,n,this.state.context),await this.#e.config.onSettled?.(a,null,this.state.variables,this.state.context,this),await this.options.onSettled?.(a,null,n,this.state.context),this.#r({type:"success",data:a}),a}catch(a){try{throw await this.#e.config.onError?.(a,n,this.state.context,this),await this.options.onError?.(a,n,this.state.context),await this.#e.config.onSettled?.(void 0,a,this.state.variables,this.state.context,this),await this.options.onSettled?.(void 0,a,n,this.state.context),a}finally{this.#r({type:"error",error:a})}}finally{this.#e.runNext(this)}}#r(n){const t=e=>{switch(n.type){case"failed":return{...e,failureCount:n.failureCount,failureReason:n.error};case"pause":return{...e,isPaused:!0};case"continue":return{...e,isPaused:!1};case"pending":return{...e,context:n.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:n.isPaused,status:"pending",variables:n.variables,submittedAt:Date.now()};case"success":return{...e,data:n.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...e,data:void 0,error:n.error,failureCount:e.failureCount+1,failureReason:n.error,isPaused:!1,status:"error"}}};this.state=t(this.state),Wt.batch(()=>{this.#t.forEach(e=>{e.onMutationUpdate(n)}),this.#e.notify({mutation:this,type:"updated",action:n})})}};function lS(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var sO=class extends Ts{constructor(n={}){super(),this.config=n,this.#t=new Set,this.#e=new Map,this.#n=0}#t;#e;#n;build(n,t,e){const r=new oO({mutationCache:this,mutationId:++this.#n,options:n.defaultMutationOptions(t),state:e});return this.add(r),r}add(n){this.#t.add(n);const t=Nc(n);if(typeof t=="string"){const e=this.#e.get(t);e?e.push(n):this.#e.set(t,[n])}this.notify({type:"added",mutation:n})}remove(n){if(this.#t.delete(n)){const t=Nc(n);if(typeof t=="string"){const e=this.#e.get(t);if(e)if(e.length>1){const r=e.indexOf(n);r!==-1&&e.splice(r,1)}else e[0]===n&&this.#e.delete(t)}}this.notify({type:"removed",mutation:n})}canRun(n){const t=Nc(n);if(typeof t=="string"){const r=this.#e.get(t)?.find(a=>a.state.status==="pending");return!r||r===n}else return!0}runNext(n){const t=Nc(n);return typeof t=="string"?this.#e.get(t)?.find(r=>r!==n&&r.state.isPaused)?.continue()??Promise.resolve():Promise.resolve()}clear(){Wt.batch(()=>{this.#t.forEach(n=>{this.notify({type:"removed",mutation:n})}),this.#t.clear(),this.#e.clear()})}getAll(){return Array.from(this.#t)}find(n){const t={exact:!0,...n};return this.getAll().find(e=>dx(t,e))}findAll(n={}){return this.getAll().filter(t=>dx(n,t))}notify(n){Wt.batch(()=>{this.listeners.forEach(t=>{t(n)})})}resumePausedMutations(){const n=this.getAll().filter(t=>t.state.isPaused);return Wt.batch(()=>Promise.all(n.map(t=>t.continue().catch(_n))))}};function Nc(n){return n.options.scope?.id}function mx(n){return{onFetch:(t,e)=>{const r=t.options,a=t.fetchOptions?.meta?.fetchMore?.direction,i=t.state.data?.pages||[],u=t.state.data?.pageParams||[];let l={pages:[],pageParams:[]},c=0;const f=async()=>{let d=!1;const v=b=>{Object.defineProperty(b,"signal",{enumerable:!0,get:()=>(t.signal.aborted?d=!0:t.signal.addEventListener("abort",()=>{d=!0}),t.signal)})},m=rS(t.options,t.fetchOptions),g=async(b,w,S)=>{if(d)return Promise.reject();if(w==null&&b.pages.length)return Promise.resolve(b);const _=(()=>{const D={client:t.client,queryKey:t.queryKey,pageParam:w,direction:S?"backward":"forward",meta:t.options.meta};return v(D),D})(),R=await m(_),{maxPages:C}=t.options,A=S?YD:ZD;return{pages:A(b.pages,R,C),pageParams:A(b.pageParams,w,C)}};if(a&&i.length){const b=a==="backward",w=b?uO:gx,S={pages:i,pageParams:u},E=w(r,S);l=await g(S,E,b)}else{const b=n??i.length;do{const w=c===0?u[0]??r.initialPageParam:gx(r,l);if(c>0&&w==null)break;l=await g(l,w),c++}while(c<b)}return l};t.options.persister?t.fetchFn=()=>t.options.persister?.(f,{client:t.client,queryKey:t.queryKey,meta:t.options.meta,signal:t.signal},e):t.fetchFn=f}}}function gx(n,{pages:t,pageParams:e}){const r=t.length-1;return t.length>0?n.getNextPageParam(t[r],t,e[r],e):void 0}function uO(n,{pages:t,pageParams:e}){return t.length>0?n.getPreviousPageParam?.(t[0],t,e[0],e):void 0}var L6=class{#t;#e;#n;#r;#a;#o;#s;#i;constructor(n={}){this.#t=n.queryCache||new iO,this.#e=n.mutationCache||new sO,this.#n=n.defaultOptions||{},this.#r=new Map,this.#a=new Map,this.#o=0}mount(){this.#o++,this.#o===1&&(this.#s=Fm.subscribe(async n=>{n&&(await this.resumePausedMutations(),this.#t.onFocus())}),this.#i=mf.subscribe(async n=>{n&&(await this.resumePausedMutations(),this.#t.onOnline())}))}unmount(){this.#o--,this.#o===0&&(this.#s?.(),this.#s=void 0,this.#i?.(),this.#i=void 0)}isFetching(n){return this.#t.findAll({...n,fetchStatus:"fetching"}).length}isMutating(n){return this.#e.findAll({...n,status:"pending"}).length}getQueryData(n){const t=this.defaultQueryOptions({queryKey:n});return this.#t.get(t.queryHash)?.state.data}ensureQueryData(n){const t=this.defaultQueryOptions(n),e=this.#t.build(this,t),r=e.state.data;return r===void 0?this.fetchQuery(n):(n.revalidateIfStale&&e.isStaleByTime(di(t.staleTime,e))&&this.prefetchQuery(t),Promise.resolve(r))}getQueriesData(n){return this.#t.findAll(n).map(({queryKey:t,state:e})=>{const r=e.data;return[t,r]})}setQueryData(n,t,e){const r=this.defaultQueryOptions({queryKey:n}),i=this.#t.get(r.queryHash)?.state.data,u=KD(t,i);if(u!==void 0)return this.#t.build(this,r).setData(u,{...e,manual:!0})}setQueriesData(n,t,e){return Wt.batch(()=>this.#t.findAll(n).map(({queryKey:r})=>[r,this.setQueryData(r,t,e)]))}getQueryState(n){const t=this.defaultQueryOptions({queryKey:n});return this.#t.get(t.queryHash)?.state}removeQueries(n){const t=this.#t;Wt.batch(()=>{t.findAll(n).forEach(e=>{t.remove(e)})})}resetQueries(n,t){const e=this.#t;return Wt.batch(()=>(e.findAll(n).forEach(r=>{r.reset()}),this.refetchQueries({type:"active",...n},t)))}cancelQueries(n,t={}){const e={revert:!0,...t},r=Wt.batch(()=>this.#t.findAll(n).map(a=>a.cancel(e)));return Promise.all(r).then(_n).catch(_n)}invalidateQueries(n,t={}){return Wt.batch(()=>(this.#t.findAll(n).forEach(e=>{e.invalidate()}),n?.refetchType==="none"?Promise.resolve():this.refetchQueries({...n,type:n?.refetchType??n?.type??"active"},t)))}refetchQueries(n,t={}){const e={...t,cancelRefetch:t.cancelRefetch??!0},r=Wt.batch(()=>this.#t.findAll(n).filter(a=>!a.isDisabled()&&!a.isStatic()).map(a=>{let i=a.fetch(void 0,e);return e.throwOnError||(i=i.catch(_n)),a.state.fetchStatus==="paused"?Promise.resolve():i}));return Promise.all(r).then(_n)}fetchQuery(n){const t=this.defaultQueryOptions(n);t.retry===void 0&&(t.retry=!1);const e=this.#t.build(this,t);return e.isStaleByTime(di(t.staleTime,e))?e.fetch(t):Promise.resolve(e.state.data)}prefetchQuery(n){return this.fetchQuery(n).then(_n).catch(_n)}fetchInfiniteQuery(n){return n.behavior=mx(n.pages),this.fetchQuery(n)}prefetchInfiniteQuery(n){return this.fetchInfiniteQuery(n).then(_n).catch(_n)}ensureInfiniteQueryData(n){return n.behavior=mx(n.pages),this.ensureQueryData(n)}resumePausedMutations(){return mf.isOnline()?this.#e.resumePausedMutations():Promise.resolve()}getQueryCache(){return this.#t}getMutationCache(){return this.#e}getDefaultOptions(){return this.#n}setDefaultOptions(n){this.#n=n}setQueryDefaults(n,t){this.#r.set(Ji(n),{queryKey:n,defaultOptions:t})}getQueryDefaults(n){const t=[...this.#r.values()],e={};return t.forEach(r=>{Gu(n,r.queryKey)&&Object.assign(e,r.defaultOptions)}),e}setMutationDefaults(n,t){this.#a.set(Ji(n),{mutationKey:n,defaultOptions:t})}getMutationDefaults(n){const t=[...this.#a.values()],e={};return t.forEach(r=>{Gu(n,r.mutationKey)&&Object.assign(e,r.defaultOptions)}),e}defaultQueryOptions(n){if(n._defaulted)return n;const t={...this.#n.queries,...this.getQueryDefaults(n.queryKey),...n,_defaulted:!0};return t.queryHash||(t.queryHash=Mm(t.queryKey,t)),t.refetchOnReconnect===void 0&&(t.refetchOnReconnect=t.networkMode!=="always"),t.throwOnError===void 0&&(t.throwOnError=!!t.suspense),!t.networkMode&&t.persister&&(t.networkMode="offlineFirst"),t.queryFn===Im&&(t.enabled=!1),t}defaultMutationOptions(n){return n?._defaulted?n:{...this.#n.mutations,...n?.mutationKey&&this.getMutationDefaults(n.mutationKey),...n,_defaulted:!0}}clear(){this.#t.clear(),this.#e.clear()}},lO=class extends Ts{constructor(n,t){super(),this.options=t,this.#t=n,this.#i=null,this.#s=Lv(),this.bindMethods(),this.setOptions(t)}#t;#e=void 0;#n=void 0;#r=void 0;#a;#o;#s;#i;#v;#h;#d;#l;#c;#u;#p=new Set;bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(this.#e.addObserver(this),yx(this.#e,this.options)?this.#f():this.updateResult(),this.#b())}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return Uv(this.#e,this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return Uv(this.#e,this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,this.#x(),this.#w(),this.#e.removeObserver(this)}setOptions(n){const t=this.options,e=this.#e;if(this.options=this.#t.defaultQueryOptions(n),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof fr(this.options.enabled,this.#e)!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");this.#S(),this.#e.setOptions(this.options),t._defaulted&&!vf(this.options,t)&&this.#t.getQueryCache().notify({type:"observerOptionsUpdated",query:this.#e,observer:this});const r=this.hasListeners();r&&bx(this.#e,e,this.options,t)&&this.#f(),this.updateResult(),r&&(this.#e!==e||fr(this.options.enabled,this.#e)!==fr(t.enabled,this.#e)||di(this.options.staleTime,this.#e)!==di(t.staleTime,this.#e))&&this.#m();const a=this.#g();r&&(this.#e!==e||fr(this.options.enabled,this.#e)!==fr(t.enabled,this.#e)||a!==this.#u)&&this.#y(a)}getOptimisticResult(n){const t=this.#t.getQueryCache().build(this.#t,n),e=this.createResult(t,n);return fO(this,e)&&(this.#r=e,this.#o=this.options,this.#a=this.#e.state),e}getCurrentResult(){return this.#r}trackResult(n,t){return new Proxy(n,{get:(e,r)=>(this.trackProp(r),t?.(r),r==="promise"&&!this.options.experimental_prefetchInRender&&this.#s.status==="pending"&&this.#s.reject(new Error("experimental_prefetchInRender feature flag is not enabled")),Reflect.get(e,r))})}trackProp(n){this.#p.add(n)}getCurrentQuery(){return this.#e}refetch({...n}={}){return this.fetch({...n})}fetchOptimistic(n){const t=this.#t.defaultQueryOptions(n),e=this.#t.getQueryCache().build(this.#t,t);return e.fetch().then(()=>this.createResult(e,t))}fetch(n){return this.#f({...n,cancelRefetch:n.cancelRefetch??!0}).then(()=>(this.updateResult(),this.#r))}#f(n){this.#S();let t=this.#e.fetch(this.options,n);return n?.throwOnError||(t=t.catch(_n)),t}#m(){this.#x();const n=di(this.options.staleTime,this.#e);if(Qi||this.#r.isStale||!Fv(n))return;const e=tS(this.#r.dataUpdatedAt,n)+1;this.#l=setTimeout(()=>{this.#r.isStale||this.updateResult()},e)}#g(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(this.#e):this.options.refetchInterval)??!1}#y(n){this.#w(),this.#u=n,!(Qi||fr(this.options.enabled,this.#e)===!1||!Fv(this.#u)||this.#u===0)&&(this.#c=setInterval(()=>{(this.options.refetchIntervalInBackground||Fm.isFocused())&&this.#f()},this.#u))}#b(){this.#m(),this.#y(this.#g())}#x(){this.#l&&(clearTimeout(this.#l),this.#l=void 0)}#w(){this.#c&&(clearInterval(this.#c),this.#c=void 0)}createResult(n,t){const e=this.#e,r=this.options,a=this.#r,i=this.#a,u=this.#o,c=n!==e?n.state:this.#n,{state:f}=n;let d={...f},v=!1,m;if(t._optimisticResults){const F=this.hasListeners(),N=!F&&yx(n,t),B=F&&bx(n,e,t,r);(N||B)&&(d={...d,...uS(f.data,n.options)}),t._optimisticResults==="isRestoring"&&(d.fetchStatus="idle")}let{error:g,errorUpdatedAt:b,status:w}=d;m=d.data;let S=!1;if(t.placeholderData!==void 0&&m===void 0&&w==="pending"){let F;a?.isPlaceholderData&&t.placeholderData===u?.placeholderData?(F=a.data,S=!0):F=typeof t.placeholderData=="function"?t.placeholderData(this.#d?.state.data,this.#d):t.placeholderData,F!==void 0&&(w="success",m=Pv(a?.data,F,t),v=!0)}if(t.select&&m!==void 0&&!S)if(a&&m===i?.data&&t.select===this.#v)m=this.#h;else try{this.#v=t.select,m=t.select(m),m=Pv(a?.data,m,t),this.#h=m,this.#i=null}catch(F){this.#i=F}this.#i&&(g=this.#i,m=this.#h,b=Date.now(),w="error");const E=d.fetchStatus==="fetching",_=w==="pending",R=w==="error",C=_&&E,A=m!==void 0,O={status:w,fetchStatus:d.fetchStatus,isPending:_,isSuccess:w==="success",isError:R,isInitialLoading:C,isLoading:C,data:m,dataUpdatedAt:d.dataUpdatedAt,error:g,errorUpdatedAt:b,failureCount:d.fetchFailureCount,failureReason:d.fetchFailureReason,errorUpdateCount:d.errorUpdateCount,isFetched:d.dataUpdateCount>0||d.errorUpdateCount>0,isFetchedAfterMount:d.dataUpdateCount>c.dataUpdateCount||d.errorUpdateCount>c.errorUpdateCount,isFetching:E,isRefetching:E&&!_,isLoadingError:R&&!A,isPaused:d.fetchStatus==="paused",isPlaceholderData:v,isRefetchError:R&&A,isStale:Bm(n,t),refetch:this.refetch,promise:this.#s,isEnabled:fr(t.enabled,n)!==!1};if(this.options.experimental_prefetchInRender){const F=H=>{O.status==="error"?H.reject(O.error):O.data!==void 0&&H.resolve(O.data)},N=()=>{const H=this.#s=O.promise=Lv();F(H)},B=this.#s;switch(B.status){case"pending":n.queryHash===e.queryHash&&F(B);break;case"fulfilled":(O.status==="error"||O.data!==B.value)&&N();break;case"rejected":(O.status!=="error"||O.error!==B.reason)&&N();break}}return O}updateResult(){const n=this.#r,t=this.createResult(this.#e,this.options);if(this.#a=this.#e.state,this.#o=this.options,this.#a.data!==void 0&&(this.#d=this.#e),vf(t,n))return;this.#r=t;const e=()=>{if(!n)return!0;const{notifyOnChangeProps:r}=this.options,a=typeof r=="function"?r():r;if(a==="all"||!a&&!this.#p.size)return!0;const i=new Set(a??this.#p);return this.options.throwOnError&&i.add("error"),Object.keys(this.#r).some(u=>{const l=u;return this.#r[l]!==n[l]&&i.has(l)})};this.#E({listeners:e()})}#S(){const n=this.#t.getQueryCache().build(this.#t,this.options);if(n===this.#e)return;const t=this.#e;this.#e=n,this.#n=n.state,this.hasListeners()&&(t?.removeObserver(this),n.addObserver(this))}onQueryUpdate(){this.updateResult(),this.hasListeners()&&this.#b()}#E(n){Wt.batch(()=>{n.listeners&&this.listeners.forEach(t=>{t(this.#r)}),this.#t.getQueryCache().notify({query:this.#e,type:"observerResultsUpdated"})})}};function cO(n,t){return fr(t.enabled,n)!==!1&&n.state.data===void 0&&!(n.state.status==="error"&&t.retryOnMount===!1)}function yx(n,t){return cO(n,t)||n.state.data!==void 0&&Uv(n,t,t.refetchOnMount)}function Uv(n,t,e){if(fr(t.enabled,n)!==!1&&di(t.staleTime,n)!=="static"){const r=typeof e=="function"?e(n):e;return r==="always"||r!==!1&&Bm(n,t)}return!1}function bx(n,t,e,r){return(n!==t||fr(r.enabled,n)===!1)&&(!e.suspense||n.state.status!=="error")&&Bm(n,e)}function Bm(n,t){return fr(t.enabled,n)!==!1&&n.isStaleByTime(di(t.staleTime,n))}function fO(n,t){return!vf(n.getCurrentResult(),t)}var hO=class extends Ts{#t;#e=void 0;#n;#r;constructor(t,e){super(),this.#t=t,this.setOptions(e),this.bindMethods(),this.#a()}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(t){const e=this.options;this.options=this.#t.defaultMutationOptions(t),vf(this.options,e)||this.#t.getMutationCache().notify({type:"observerOptionsUpdated",mutation:this.#n,observer:this}),e?.mutationKey&&this.options.mutationKey&&Ji(e.mutationKey)!==Ji(this.options.mutationKey)?this.reset():this.#n?.state.status==="pending"&&this.#n.setOptions(this.options)}onUnsubscribe(){this.hasListeners()||this.#n?.removeObserver(this)}onMutationUpdate(t){this.#a(),this.#o(t)}getCurrentResult(){return this.#e}reset(){this.#n?.removeObserver(this),this.#n=void 0,this.#a(),this.#o()}mutate(t,e){return this.#r=e,this.#n?.removeObserver(this),this.#n=this.#t.getMutationCache().build(this.#t,this.options),this.#n.addObserver(this),this.#n.execute(t)}#a(){const t=this.#n?.state??lS();this.#e={...t,isPending:t.status==="pending",isSuccess:t.status==="success",isError:t.status==="error",isIdle:t.status==="idle",mutate:this.mutate,reset:this.reset}}#o(t){Wt.batch(()=>{if(this.#r&&this.hasListeners()){const e=this.#e.variables,r=this.#e.context;t?.type==="success"?(this.#r.onSuccess?.(t.data,e,r),this.#r.onSettled?.(t.data,null,e,r)):t?.type==="error"&&(this.#r.onError?.(t.error,e,r),this.#r.onSettled?.(void 0,t.error,e,r))}this.listeners.forEach(e=>{e(this.#e)})})}},cS=Z.createContext(void 0),fS=n=>{const t=Z.useContext(cS);if(!t)throw new Error("No QueryClient set, use QueryClientProvider to set one");return t},U6=({client:n,children:t})=>(Z.useEffect(()=>(n.mount(),()=>{n.unmount()}),[n]),vA.jsx(cS.Provider,{value:n,children:t})),hS=Z.createContext(!1),dO=()=>Z.useContext(hS);hS.Provider;function pO(){let n=!1;return{clearReset:()=>{n=!1},reset:()=>{n=!0},isReset:()=>n}}var vO=Z.createContext(pO()),mO=()=>Z.useContext(vO),gO=(n,t)=>{(n.suspense||n.throwOnError||n.experimental_prefetchInRender)&&(t.isReset()||(n.retryOnMount=!1))},yO=n=>{Z.useEffect(()=>{n.clearReset()},[n])},bO=({result:n,errorResetBoundary:t,throwOnError:e,query:r,suspense:a})=>n.isError&&!t.isReset()&&!n.isFetching&&r&&(a&&n.data===void 0||aS(e,[n.error,r])),xO=n=>{if(n.suspense){const t=r=>r==="static"?r:Math.max(r??1e3,1e3),e=n.staleTime;n.staleTime=typeof e=="function"?(...r)=>t(e(...r)):t(e),typeof n.gcTime=="number"&&(n.gcTime=Math.max(n.gcTime,1e3))}},wO=(n,t)=>n.isLoading&&n.isFetching&&!t,SO=(n,t)=>n?.suspense&&t.isPending,xx=(n,t,e)=>t.fetchOptimistic(n).catch(()=>{e.clearReset()});function EO(n,t,e){const r=dO(),a=mO(),i=fS(),u=i.defaultQueryOptions(n);i.getDefaultOptions().queries?._experimental_beforeQuery?.(u),u._optimisticResults=r?"isRestoring":"optimistic",xO(u),gO(u,a),yO(a);const l=!i.getQueryCache().get(u.queryHash),[c]=Z.useState(()=>new t(i,u)),f=c.getOptimisticResult(u),d=!r&&n.subscribed!==!1;if(Z.useSyncExternalStore(Z.useCallback(v=>{const m=d?c.subscribe(Wt.batchCalls(v)):_n;return c.updateResult(),m},[c,d]),()=>c.getCurrentResult(),()=>c.getCurrentResult()),Z.useEffect(()=>{c.setOptions(u)},[u,c]),SO(u,f))throw xx(u,c,a);if(bO({result:f,errorResetBoundary:a,throwOnError:u.throwOnError,query:i.getQueryCache().get(u.queryHash),suspense:u.suspense}))throw f.error;return i.getDefaultOptions().queries?._experimental_afterQuery?.(u,f),u.experimental_prefetchInRender&&!Qi&&wO(f,r)&&(l?xx(u,c,a):i.getQueryCache().get(u.queryHash)?.promise)?.catch(_n).finally(()=>{c.updateResult()}),u.notifyOnChangeProps?f:c.trackResult(f)}function H6(n,t){return EO(n,lO)}function V6(n,t){const e=fS(),[r]=Z.useState(()=>new hO(e,n));Z.useEffect(()=>{r.setOptions(n)},[r,n]);const a=Z.useSyncExternalStore(Z.useCallback(u=>r.subscribe(Wt.batchCalls(u)),[r]),()=>r.getCurrentResult(),()=>r.getCurrentResult()),i=Z.useCallback((u,l)=>{r.mutate(u,l).catch(_n)},[r]);if(a.error&&aS(r.options.throwOnError,[a.error]))throw a.error;return{...a,mutate:i,mutateAsync:a.mutate}}var W6=function(){return null};const _O=(n,t,e,r)=>{const a=[e,{code:t,...r||{}}];if(n?.services?.logger?.forward)return n.services.logger.forward(a,"warn","react-i18next::",!0);Ki(a[0])&&(a[0]=`react-i18next:: ${a[0]}`),n?.services?.logger?.warn?n.services.logger.warn(...a):console?.warn&&console.warn(...a)},wx={},Hv=(n,t,e,r)=>{Ki(e)&&wx[e]||(Ki(e)&&(wx[e]=new Date),_O(n,t,e,r))},dS=(n,t)=>()=>{if(n.isInitialized)t();else{const e=()=>{setTimeout(()=>{n.off("initialized",e)},0),t()};n.on("initialized",e)}},Vv=(n,t,e)=>{n.loadNamespaces(t,dS(n,e))},Sx=(n,t,e,r)=>{if(Ki(e)&&(e=[e]),n.options.preload&&n.options.preload.indexOf(t)>-1)return Vv(n,e,r);e.forEach(a=>{n.options.ns.indexOf(a)<0&&n.options.ns.push(a)}),n.loadLanguages(t,dS(n,r))},CO=(n,t,e={})=>!t.languages||!t.languages.length?(Hv(t,"NO_LANGUAGES","i18n.languages were undefined or empty",{languages:t.languages}),!0):t.hasLoadedNamespace(n,{lng:e.lng,precheck:(r,a)=>{if(e.bindI18n&&e.bindI18n.indexOf("languageChanging")>-1&&r.services.backendConnector.backend&&r.isLanguageChangingTo&&!a(r.isLanguageChangingTo,n))return!1}}),Ki=n=>typeof n=="string",RO=n=>typeof n=="object"&&n!==null,AO=/&(?:amp|#38|lt|#60|gt|#62|apos|#39|quot|#34|nbsp|#160|copy|#169|reg|#174|hellip|#8230|#x2F|#47);/g,TO={"&amp;":"&","&#38;":"&","&lt;":"<","&#60;":"<","&gt;":">","&#62;":">","&apos;":"'","&#39;":"'","&quot;":'"',"&#34;":'"',"&nbsp;":" ","&#160;":" ","&copy;":"©","&#169;":"©","&reg;":"®","&#174;":"®","&hellip;":"…","&#8230;":"…","&#x2F;":"/","&#47;":"/"},DO=n=>TO[n],OO=n=>n.replace(AO,DO);let Wv={bindI18n:"languageChanged",bindI18nStore:"",transEmptyNodeValue:"",transSupportBasicHtmlNodes:!0,transWrapTextNodes:"",transKeepBasicHtmlNodesFor:["br","strong","i","p"],useSuspense:!0,unescape:OO};const kO=(n={})=>{Wv={...Wv,...n}},NO=()=>Wv;let pS;const MO=n=>{pS=n},IO=()=>pS,G6={type:"3rdParty",init(n){kO(n.options.react),MO(n)}},vS=Z.createContext();class FO{constructor(){this.usedNamespaces={}}addUsedNamespaces(t){t.forEach(e=>{this.usedNamespaces[e]||(this.usedNamespaces[e]=!0)})}getUsedNamespaces(){return Object.keys(this.usedNamespaces)}}const BO=(n,t)=>{const e=Z.useRef();return Z.useEffect(()=>{e.current=n},[n,t]),e.current},mS=(n,t,e,r)=>n.getFixedT(t,e,r),PO=(n,t,e,r)=>Z.useCallback(mS(n,t,e,r),[n,t,e,r]),j6=(n,t={})=>{const{i18n:e}=t,{i18n:r,defaultNS:a}=Z.useContext(vS)||{},i=e||r||IO();if(i&&!i.reportNamespaces&&(i.reportNamespaces=new FO),!i){Hv(i,"NO_I18NEXT_INSTANCE","useTranslation: You will need to pass in an i18next instance by using initReactI18next");const C=(D,O)=>Ki(O)?O:RO(O)&&Ki(O.defaultValue)?O.defaultValue:Array.isArray(D)?D[D.length-1]:D,A=[C,{},!1];return A.t=C,A.i18n={},A.ready=!1,A}i.options.react?.wait&&Hv(i,"DEPRECATED_OPTION","useTranslation: It seems you are still using the old wait option, you may migrate to the new useSuspense behaviour.");const u={...NO(),...i.options.react,...t},{useSuspense:l,keyPrefix:c}=u;let f=a||i.options?.defaultNS;f=Ki(f)?[f]:f||["translation"],i.reportNamespaces.addUsedNamespaces?.(f);const d=(i.isInitialized||i.initializedStoreOnce)&&f.every(C=>CO(C,i,u)),v=PO(i,t.lng||null,u.nsMode==="fallback"?f:f[0],c),m=()=>v,g=()=>mS(i,t.lng||null,u.nsMode==="fallback"?f:f[0],c),[b,w]=Z.useState(m);let S=f.join();t.lng&&(S=`${t.lng}${S}`);const E=BO(S),_=Z.useRef(!0);Z.useEffect(()=>{const{bindI18n:C,bindI18nStore:A}=u;_.current=!0,!d&&!l&&(t.lng?Sx(i,t.lng,f,()=>{_.current&&w(g)}):Vv(i,f,()=>{_.current&&w(g)})),d&&E&&E!==S&&_.current&&w(g);const D=()=>{_.current&&w(g)};return C&&i?.on(C,D),A&&i?.store.on(A,D),()=>{_.current=!1,i&&C&&C?.split(" ").forEach(O=>i.off(O,D)),A&&i&&A.split(" ").forEach(O=>i.store.off(O,D))}},[i,S]),Z.useEffect(()=>{_.current&&d&&w(m)},[i,c,d]);const R=[b,i,d];if(R.t=b,R.i18n=i,R.ready=d,d||!d&&!l)return R;throw new Promise(C=>{t.lng?Sx(i,t.lng,f,()=>C()):Vv(i,f,()=>C())})};function q6({i18n:n,defaultNS:t,children:e}){const r=Z.useMemo(()=>({i18n:n,defaultNS:t}),[n,t]);return Z.createElement(vS.Provider,{value:r},e)}function LO(n,t){if(n==null)return{};var e={};for(var r in n)if({}.hasOwnProperty.call(n,r)){if(t.indexOf(r)!==-1)continue;e[r]=n[r]}return e}function gf(){return gf=Object.assign?Object.assign.bind():function(n){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var r in e)({}).hasOwnProperty.call(e,r)&&(n[r]=e[r])}return n},gf.apply(null,arguments)}function Gv(n,t){return Gv=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,r){return e.__proto__=r,e},Gv(n,t)}function zO(n,t){n.prototype=Object.create(t.prototype),n.prototype.constructor=n,Gv(n,t)}function jp(n,t,e){if(e||arguments.length===2)for(var r=0,a=t.length,i;r<a;r++)(i||!(r in t))&&(i||(i=Array.prototype.slice.call(t,0,r)),i[r]=t[r]);return n.concat(i||Array.prototype.slice.call(t))}var Mc={};/*!
 * content-type
 * Copyright(c) 2015 Douglas Christopher Wilson
 * MIT Licensed
 */var Ex;function UO(){if(Ex)return Mc;Ex=1;var n=/; *([!#$%&'*+.^_`|~0-9A-Za-z-]+) *= *("(?:[\u000b\u0020\u0021\u0023-\u005b\u005d-\u007e\u0080-\u00ff]|\\[\u000b\u0020-\u00ff])*"|[!#$%&'*+.^_`|~0-9A-Za-z-]+) */g,t=/^[\u000b\u0020-\u007e\u0080-\u00ff]+$/,e=/^[!#$%&'*+.^_`|~0-9A-Za-z-]+$/,r=/\\([\u000b\u0020-\u00ff])/g,a=/([\\"])/g,i=/^[!#$%&'*+.^_`|~0-9A-Za-z-]+\/[!#$%&'*+.^_`|~0-9A-Za-z-]+$/;Mc.format=u,Mc.parse=l;function u(v){if(!v||typeof v!="object")throw new TypeError("argument obj is required");var m=v.parameters,g=v.type;if(!g||!i.test(g))throw new TypeError("invalid type");var b=g;if(m&&typeof m=="object")for(var w,S=Object.keys(m).sort(),E=0;E<S.length;E++){if(w=S[E],!e.test(w))throw new TypeError("invalid parameter name");b+="; "+w+"="+f(m[w])}return b}function l(v){if(!v)throw new TypeError("argument string is required");var m=typeof v=="object"?c(v):v;if(typeof m!="string")throw new TypeError("argument string is required to be a string");var g=m.indexOf(";"),b=g!==-1?m.slice(0,g).trim():m.trim();if(!i.test(b))throw new TypeError("invalid media type");var w=new d(b.toLowerCase());if(g!==-1){var S,E,_;for(n.lastIndex=g;E=n.exec(m);){if(E.index!==g)throw new TypeError("invalid parameter format");g+=E[0].length,S=E[1].toLowerCase(),_=E[2],_.charCodeAt(0)===34&&(_=_.slice(1,-1),_.indexOf("\\")!==-1&&(_=_.replace(r,"$1"))),w.parameters[S]=_}if(g!==m.length)throw new TypeError("invalid parameter format")}return w}function c(v){var m;if(typeof v.getHeader=="function"?m=v.getHeader("content-type"):typeof v.headers=="object"&&(m=v.headers&&v.headers["content-type"]),typeof m!="string")throw new TypeError("content-type header is missing from object");return m}function f(v){var m=String(v);if(e.test(m))return m;if(m.length>0&&!t.test(m))throw new TypeError("invalid parameter value");return'"'+m.replace(a,"\\$1")+'"'}function d(v){this.parameters=Object.create(null),this.type=v}return Mc}var HO=UO(),es=new Map,gS=function(t){return t.cloneNode(!0)},_x=function(){return window.location.protocol==="file:"},yS=function(t,e,r){var a=new XMLHttpRequest;a.onreadystatechange=function(){try{if(!/\.svg/i.test(t)&&a.readyState===2){var i=a.getResponseHeader("Content-Type");if(!i)throw new Error("Content type not found");var u=HO.parse(i).type;if(!(u==="image/svg+xml"||u==="text/plain"))throw new Error("Invalid content type: ".concat(u))}if(a.readyState===4){if(a.status===404||a.responseXML===null)throw new Error(_x()?"Note: SVG injection ajax calls do not work locally without adjusting security settings in your browser. Or consider using a local webserver.":"Unable to load SVG file: "+t);if(a.status===200||_x()&&a.status===0)r(null,a);else throw new Error("There was a problem injecting the SVG: "+a.status+" "+a.statusText)}}catch(l){if(a.abort(),l instanceof Error)r(l,a);else throw l}},a.open("GET",t),a.withCredentials=e,a.overrideMimeType&&a.overrideMimeType("text/xml"),a.send()},ui={},Cx=function(t,e){ui[t]=ui[t]||[],ui[t].push(e)},VO=function(t){for(var e=function(u,l){setTimeout(function(){if(Array.isArray(ui[t])){var c=es.get(t),f=ui[t][u];c instanceof SVGSVGElement&&f(null,gS(c)),c instanceof Error&&f(c),u===ui[t].length-1&&delete ui[t]}},0)},r=0,a=ui[t].length;r<a;r++)e(r)},WO=function(t,e,r){if(es.has(t)){var a=es.get(t);if(a===void 0){Cx(t,r);return}if(a instanceof SVGSVGElement){r(null,gS(a));return}}es.set(t,void 0),Cx(t,r),yS(t,e,function(i,u){var l;i?es.set(t,i):((l=u.responseXML)===null||l===void 0?void 0:l.documentElement)instanceof SVGSVGElement&&es.set(t,u.responseXML.documentElement),VO(t)})},GO=function(t,e,r){yS(t,e,function(a,i){var u;a?r(a):((u=i.responseXML)===null||u===void 0?void 0:u.documentElement)instanceof SVGSVGElement&&r(null,i.responseXML.documentElement)})},jO=0,qO=function(){return++jO},Pr=[],Rx={},$O="http://www.w3.org/2000/svg",qp="http://www.w3.org/1999/xlink",Ax=function(t,e,r,a,i,u,l){var c=t.getAttribute("data-src")||t.getAttribute("src");if(!c){l(new Error("Invalid data-src or src attribute"));return}if(Pr.indexOf(t)!==-1){Pr.splice(Pr.indexOf(t),1),t=null;return}Pr.push(t),t.setAttribute("src","");var f=a?WO:GO;f(c,i,function(d,v){if(!v){Pr.splice(Pr.indexOf(t),1),t=null,l(d);return}var m=t.getAttribute("id");m&&v.setAttribute("id",m);var g=t.getAttribute("title");g&&v.setAttribute("title",g);var b=t.getAttribute("width");b&&v.setAttribute("width",b);var w=t.getAttribute("height");w&&v.setAttribute("height",w);var S=Array.from(new Set(jp(jp(jp([],(v.getAttribute("class")||"").split(" "),!0),["injected-svg"],!1),(t.getAttribute("class")||"").split(" "),!0))).join(" ").trim();v.setAttribute("class",S);var E=t.getAttribute("style");E&&v.setAttribute("style",E),v.setAttribute("data-src",c);var _=[].filter.call(t.attributes,function($){return/^data-\w[\w-]*$/.test($.name)});if(Array.prototype.forEach.call(_,function($){$.name&&$.value&&v.setAttribute($.name,$.value)}),r){var R={clipPath:["clip-path"],"color-profile":["color-profile"],cursor:["cursor"],filter:["filter"],linearGradient:["fill","stroke"],marker:["marker","marker-start","marker-mid","marker-end"],mask:["mask"],path:[],pattern:["fill","stroke"],radialGradient:["fill","stroke"]},C,A,D,O,F;Object.keys(R).forEach(function($){C=$,D=R[$],A=v.querySelectorAll(C+"[id]");for(var ne=function(oe,de){O=A[oe].id,F=O+"-"+qO();var me;Array.prototype.forEach.call(D,function(We){me=v.querySelectorAll("["+We+'*="'+O+'"]');for(var tt=0,ft=me.length;tt<ft;tt++){var st=me[tt].getAttribute(We);st&&!st.match(new RegExp('url\\("?#'+O+'"?\\)'))||me[tt].setAttribute(We,"url(#"+F+")")}});for(var ve=v.querySelectorAll("[*|href]"),Ae=[],ye=0,De=ve.length;ye<De;ye++){var Qe=ve[ye].getAttributeNS(qp,"href");Qe&&Qe.toString()==="#"+A[oe].id&&Ae.push(ve[ye])}for(var Ne=0,Le=Ae.length;Ne<Le;Ne++)Ae[Ne].setAttributeNS(qp,"href","#"+F);A[oe].id=F},M=0,j=A.length;M<j;M++)ne(M)})}v.removeAttribute("xmlns:a");for(var N=v.querySelectorAll("script"),B=[],H,U,J=0,ee=N.length;J<ee;J++)U=N[J].getAttribute("type"),(!U||U==="application/ecmascript"||U==="application/javascript"||U==="text/javascript")&&(H=N[J].innerText||N[J].textContent,H&&B.push(H),v.removeChild(N[J]));if(B.length>0&&(e==="always"||e==="once"&&!Rx[c])){for(var te=0,L=B.length;te<L;te++)new Function(B[te])(window);Rx[c]=!0}var W=v.querySelectorAll("style");if(Array.prototype.forEach.call(W,function($){$.textContent+=""}),v.setAttribute("xmlns",$O),v.setAttribute("xmlns:xlink",qp),u(v),!t.parentNode){Pr.splice(Pr.indexOf(t),1),t=null,l(new Error("Parent node is null"));return}t.parentNode.replaceChild(v,t),Pr.splice(Pr.indexOf(t),1),t=null,l(null,v)})},KO=function(t,e){var r=e===void 0?{}:e,a=r.afterAll,i=a===void 0?function(){}:a,u=r.afterEach,l=u===void 0?function(){}:u,c=r.beforeEach,f=c===void 0?function(){}:c,d=r.cacheRequests,v=d===void 0?!0:d,m=r.evalScripts,g=m===void 0?"never":m,b=r.httpRequestWithCredentials,w=b===void 0?!1:b,S=r.renumerateIRIElements,E=S===void 0?!0:S;if(t&&"length"in t)for(var _=0,R=0,C=t.length;R<C;R++)Ax(t[R],g,E,v,w,f,function(A,D){l(A,D),t&&"length"in t&&t.length===++_&&i(_)});else t?Ax(t,g,E,v,w,f,function(A,D){l(A,D),i(1),t=null}):i(0)},$p={exports:{}},Kp,Tx;function XO(){if(Tx)return Kp;Tx=1;var n="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return Kp=n,Kp}var Xp,Dx;function ZO(){if(Dx)return Xp;Dx=1;var n=XO();function t(){}function e(){}return e.resetWarningCache=t,Xp=function(){function r(u,l,c,f,d,v){if(v!==n){var m=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw m.name="Invariant Violation",m}}r.isRequired=r;function a(){return r}var i={array:r,bigint:r,bool:r,func:r,number:r,object:r,string:r,symbol:r,any:r,arrayOf:a,element:r,elementType:r,instanceOf:a,node:r,objectOf:a,oneOf:a,oneOfType:a,shape:a,exact:a,checkPropTypes:e,resetWarningCache:t};return i.PropTypes=i,i},Xp}var Ox;function YO(){return Ox||(Ox=1,$p.exports=ZO()()),$p.exports}var Ht=YO(),QO=function(t){var e=t?.ownerDocument||document;return e.defaultView||window},JO=function(t,e){for(var r in t)if(!(r in e))return!0;for(var a in e)if(t[a]!==e[a])return!0;return!1},ek=["afterInjection","beforeInjection","desc","evalScripts","fallback","httpRequestWithCredentials","loading","renumerateIRIElements","src","title","useRequestCache","wrapper"],Ic="http://www.w3.org/2000/svg",kx="http://www.w3.org/1999/xlink",bS=function(n){function t(){for(var r,a=arguments.length,i=new Array(a),u=0;u<a;u++)i[u]=arguments[u];return r=n.call.apply(n,[this].concat(i))||this,r.initialState={hasError:!1,isLoading:!0},r.state=r.initialState,r._isMounted=!1,r.reactWrapper=void 0,r.nonReactWrapper=void 0,r.refCallback=function(l){r.reactWrapper=l},r}zO(t,n);var e=t.prototype;return e.renderSVG=function(){var a=this;if(this.reactWrapper instanceof QO(this.reactWrapper).Node){var i=this.props,u=i.desc,l=i.evalScripts,c=i.httpRequestWithCredentials,f=i.renumerateIRIElements,d=i.src,v=i.title,m=i.useRequestCache,g=this.props.onError,b=this.props.beforeInjection,w=this.props.afterInjection,S=this.props.wrapper,E,_;S==="svg"?(E=document.createElementNS(Ic,S),E.setAttribute("xmlns",Ic),E.setAttribute("xmlns:xlink",kx),_=document.createElementNS(Ic,S)):(E=document.createElement(S),_=document.createElement(S)),E.appendChild(_),_.dataset.src=d,this.nonReactWrapper=this.reactWrapper.appendChild(E);var R=function(O){if(a.removeSVG(),!a._isMounted){g(O);return}a.setState(function(){return{hasError:!0,isLoading:!1}},function(){g(O)})},C=function(O,F){if(O){R(O);return}a._isMounted&&a.setState(function(){return{isLoading:!1}},function(){try{w(F)}catch(N){R(N)}})},A=function(O){if(O.setAttribute("role","img"),u){var F=O.querySelector(":scope > desc");F&&O.removeChild(F);var N=document.createElement("desc");N.innerHTML=u,O.prepend(N)}if(v){var B=O.querySelector(":scope > title");B&&O.removeChild(B);var H=document.createElement("title");H.innerHTML=v,O.prepend(H)}try{b(O)}catch(U){R(U)}};KO(_,{afterEach:C,beforeEach:A,cacheRequests:m,evalScripts:l,httpRequestWithCredentials:c,renumerateIRIElements:f})}},e.removeSVG=function(){var a;(a=this.nonReactWrapper)!=null&&a.parentNode&&(this.nonReactWrapper.parentNode.removeChild(this.nonReactWrapper),this.nonReactWrapper=null)},e.componentDidMount=function(){this._isMounted=!0,this.renderSVG()},e.componentDidUpdate=function(a){var i=this;JO(gf({},a),this.props)&&this.setState(function(){return i.initialState},function(){i.removeSVG(),i.renderSVG()})},e.componentWillUnmount=function(){this._isMounted=!1,this.removeSVG()},e.render=function(){var a=this.props;a.afterInjection,a.beforeInjection,a.desc,a.evalScripts;var i=a.fallback;a.httpRequestWithCredentials;var u=a.loading;a.renumerateIRIElements,a.src,a.title,a.useRequestCache;var l=a.wrapper,c=LO(a,ek),f=l;return Z.createElement(f,gf({},c,{ref:this.refCallback},l==="svg"?{xmlns:Ic,xmlnsXlink:kx}:{}),this.state.isLoading&&u&&Z.createElement(u,null),this.state.hasError&&i&&Z.createElement(i,null))},t}(Z.Component);bS.defaultProps={afterInjection:function(){},beforeInjection:function(){},desc:"",evalScripts:"never",fallback:null,httpRequestWithCredentials:!1,loading:null,onError:function(){},renumerateIRIElements:!0,title:"",useRequestCache:!0,wrapper:"div"};bS.propTypes={afterInjection:Ht.func,beforeInjection:Ht.func,desc:Ht.string,evalScripts:Ht.oneOf(["always","once","never"]),fallback:Ht.oneOfType([Ht.func,Ht.object,Ht.string]),httpRequestWithCredentials:Ht.bool,loading:Ht.oneOfType([Ht.func,Ht.object,Ht.string]),onError:Ht.func,renumerateIRIElements:Ht.bool,src:Ht.string.isRequired,title:Ht.string,useRequestCache:Ht.bool,wrapper:Ht.oneOf(["div","span","svg"])};const Fe=n=>typeof n=="string",Ou=()=>{let n,t;const e=new Promise((r,a)=>{n=r,t=a});return e.resolve=n,e.reject=t,e},Nx=n=>n==null?"":""+n,tk=(n,t,e)=>{n.forEach(r=>{t[r]&&(e[r]=t[r])})},nk=/###/g,Mx=n=>n&&n.indexOf("###")>-1?n.replace(nk,"."):n,Ix=n=>!n||Fe(n),Lu=(n,t,e)=>{const r=Fe(t)?t.split("."):t;let a=0;for(;a<r.length-1;){if(Ix(n))return{};const i=Mx(r[a]);!n[i]&&e&&(n[i]=new e),Object.prototype.hasOwnProperty.call(n,i)?n=n[i]:n={},++a}return Ix(n)?{}:{obj:n,k:Mx(r[a])}},Fx=(n,t,e)=>{const{obj:r,k:a}=Lu(n,t,Object);if(r!==void 0||t.length===1){r[a]=e;return}let i=t[t.length-1],u=t.slice(0,t.length-1),l=Lu(n,u,Object);for(;l.obj===void 0&&u.length;)i=`${u[u.length-1]}.${i}`,u=u.slice(0,u.length-1),l=Lu(n,u,Object),l?.obj&&typeof l.obj[`${l.k}.${i}`]<"u"&&(l.obj=void 0);l.obj[`${l.k}.${i}`]=e},rk=(n,t,e,r)=>{const{obj:a,k:i}=Lu(n,t,Object);a[i]=a[i]||[],a[i].push(e)},yf=(n,t)=>{const{obj:e,k:r}=Lu(n,t);if(e&&Object.prototype.hasOwnProperty.call(e,r))return e[r]},ak=(n,t,e)=>{const r=yf(n,e);return r!==void 0?r:yf(t,e)},xS=(n,t,e)=>{for(const r in t)r!=="__proto__"&&r!=="constructor"&&(r in n?Fe(n[r])||n[r]instanceof String||Fe(t[r])||t[r]instanceof String?e&&(n[r]=t[r]):xS(n[r],t[r],e):n[r]=t[r]);return n},Xo=n=>n.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&");var ik={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};const ok=n=>Fe(n)?n.replace(/[&<>"'\/]/g,t=>ik[t]):n;class sk{constructor(t){this.capacity=t,this.regExpMap=new Map,this.regExpQueue=[]}getRegExp(t){const e=this.regExpMap.get(t);if(e!==void 0)return e;const r=new RegExp(t);return this.regExpQueue.length===this.capacity&&this.regExpMap.delete(this.regExpQueue.shift()),this.regExpMap.set(t,r),this.regExpQueue.push(t),r}}const uk=[" ",",","?","!",";"],lk=new sk(20),ck=(n,t,e)=>{t=t||"",e=e||"";const r=uk.filter(u=>t.indexOf(u)<0&&e.indexOf(u)<0);if(r.length===0)return!0;const a=lk.getRegExp(`(${r.map(u=>u==="?"?"\\?":u).join("|")})`);let i=!a.test(n);if(!i){const u=n.indexOf(e);u>0&&!a.test(n.substring(0,u))&&(i=!0)}return i},jv=(n,t,e=".")=>{if(!n)return;if(n[t])return Object.prototype.hasOwnProperty.call(n,t)?n[t]:void 0;const r=t.split(e);let a=n;for(let i=0;i<r.length;){if(!a||typeof a!="object")return;let u,l="";for(let c=i;c<r.length;++c)if(c!==i&&(l+=e),l+=r[c],u=a[l],u!==void 0){if(["string","number","boolean"].indexOf(typeof u)>-1&&c<r.length-1)continue;i+=c-i+1;break}a=u}return a},ju=n=>n?.replace("_","-"),fk={type:"logger",log(n){this.output("log",n)},warn(n){this.output("warn",n)},error(n){this.output("error",n)},output(n,t){console?.[n]?.apply?.(console,t)}};class bf{constructor(t,e={}){this.init(t,e)}init(t,e={}){this.prefix=e.prefix||"i18next:",this.logger=t||fk,this.options=e,this.debug=e.debug}log(...t){return this.forward(t,"log","",!0)}warn(...t){return this.forward(t,"warn","",!0)}error(...t){return this.forward(t,"error","")}deprecate(...t){return this.forward(t,"warn","WARNING DEPRECATED: ",!0)}forward(t,e,r,a){return a&&!this.debug?null:(Fe(t[0])&&(t[0]=`${r}${this.prefix} ${t[0]}`),this.logger[e](t))}create(t){return new bf(this.logger,{prefix:`${this.prefix}:${t}:`,...this.options})}clone(t){return t=t||this.options,t.prefix=t.prefix||this.prefix,new bf(this.logger,t)}}var Gr=new bf;class Qf{constructor(){this.observers={}}on(t,e){return t.split(" ").forEach(r=>{this.observers[r]||(this.observers[r]=new Map);const a=this.observers[r].get(e)||0;this.observers[r].set(e,a+1)}),this}off(t,e){if(this.observers[t]){if(!e){delete this.observers[t];return}this.observers[t].delete(e)}}emit(t,...e){this.observers[t]&&Array.from(this.observers[t].entries()).forEach(([a,i])=>{for(let u=0;u<i;u++)a(...e)}),this.observers["*"]&&Array.from(this.observers["*"].entries()).forEach(([a,i])=>{for(let u=0;u<i;u++)a.apply(a,[t,...e])})}}class Bx extends Qf{constructor(t,e={ns:["translation"],defaultNS:"translation"}){super(),this.data=t||{},this.options=e,this.options.keySeparator===void 0&&(this.options.keySeparator="."),this.options.ignoreJSONStructure===void 0&&(this.options.ignoreJSONStructure=!0)}addNamespaces(t){this.options.ns.indexOf(t)<0&&this.options.ns.push(t)}removeNamespaces(t){const e=this.options.ns.indexOf(t);e>-1&&this.options.ns.splice(e,1)}getResource(t,e,r,a={}){const i=a.keySeparator!==void 0?a.keySeparator:this.options.keySeparator,u=a.ignoreJSONStructure!==void 0?a.ignoreJSONStructure:this.options.ignoreJSONStructure;let l;t.indexOf(".")>-1?l=t.split("."):(l=[t,e],r&&(Array.isArray(r)?l.push(...r):Fe(r)&&i?l.push(...r.split(i)):l.push(r)));const c=yf(this.data,l);return!c&&!e&&!r&&t.indexOf(".")>-1&&(t=l[0],e=l[1],r=l.slice(2).join(".")),c||!u||!Fe(r)?c:jv(this.data?.[t]?.[e],r,i)}addResource(t,e,r,a,i={silent:!1}){const u=i.keySeparator!==void 0?i.keySeparator:this.options.keySeparator;let l=[t,e];r&&(l=l.concat(u?r.split(u):r)),t.indexOf(".")>-1&&(l=t.split("."),a=e,e=l[1]),this.addNamespaces(e),Fx(this.data,l,a),i.silent||this.emit("added",t,e,r,a)}addResources(t,e,r,a={silent:!1}){for(const i in r)(Fe(r[i])||Array.isArray(r[i]))&&this.addResource(t,e,i,r[i],{silent:!0});a.silent||this.emit("added",t,e,r)}addResourceBundle(t,e,r,a,i,u={silent:!1,skipCopy:!1}){let l=[t,e];t.indexOf(".")>-1&&(l=t.split("."),a=r,r=e,e=l[1]),this.addNamespaces(e);let c=yf(this.data,l)||{};u.skipCopy||(r=JSON.parse(JSON.stringify(r))),a?xS(c,r,i):c={...c,...r},Fx(this.data,l,c),u.silent||this.emit("added",t,e,r)}removeResourceBundle(t,e){this.hasResourceBundle(t,e)&&delete this.data[t][e],this.removeNamespaces(e),this.emit("removed",t,e)}hasResourceBundle(t,e){return this.getResource(t,e)!==void 0}getResourceBundle(t,e){return e||(e=this.options.defaultNS),this.getResource(t,e)}getDataByLanguage(t){return this.data[t]}hasLanguageSomeTranslations(t){const e=this.getDataByLanguage(t);return!!(e&&Object.keys(e)||[]).find(a=>e[a]&&Object.keys(e[a]).length>0)}toJSON(){return this.data}}var wS={processors:{},addPostProcessor(n){this.processors[n.name]=n},handle(n,t,e,r,a){return n.forEach(i=>{t=this.processors[i]?.process(t,e,r,a)??t}),t}};const SS=Symbol("i18next/PATH_KEY");function hk(){const n=[],t=Object.create(null);let e;return t.get=(r,a)=>(e?.revoke?.(),a===SS?n:(n.push(a),e=Proxy.revocable(r,t),e.proxy)),Proxy.revocable(Object.create(null),t).proxy}function qv(n,t){const{[SS]:e}=n(hk());return e.join(t?.keySeparator??".")}const Px={},Lx=n=>!Fe(n)&&typeof n!="boolean"&&typeof n!="number";class xf extends Qf{constructor(t,e={}){super(),tk(["resourceStore","languageUtils","pluralResolver","interpolator","backendConnector","i18nFormat","utils"],t,this),this.options=e,this.options.keySeparator===void 0&&(this.options.keySeparator="."),this.logger=Gr.create("translator")}changeLanguage(t){t&&(this.language=t)}exists(t,e={interpolation:{}}){const r={...e};return t==null?!1:this.resolve(t,r)?.res!==void 0}extractFromKey(t,e){let r=e.nsSeparator!==void 0?e.nsSeparator:this.options.nsSeparator;r===void 0&&(r=":");const a=e.keySeparator!==void 0?e.keySeparator:this.options.keySeparator;let i=e.ns||this.options.defaultNS||[];const u=r&&t.indexOf(r)>-1,l=!this.options.userDefinedKeySeparator&&!e.keySeparator&&!this.options.userDefinedNsSeparator&&!e.nsSeparator&&!ck(t,r,a);if(u&&!l){const c=t.match(this.interpolator.nestingRegexp);if(c&&c.length>0)return{key:t,namespaces:Fe(i)?[i]:i};const f=t.split(r);(r!==a||r===a&&this.options.ns.indexOf(f[0])>-1)&&(i=f.shift()),t=f.join(a)}return{key:t,namespaces:Fe(i)?[i]:i}}translate(t,e,r){let a=typeof e=="object"?{...e}:e;if(typeof a!="object"&&this.options.overloadTranslationOptionHandler&&(a=this.options.overloadTranslationOptionHandler(arguments)),typeof a=="object"&&(a={...a}),a||(a={}),t==null)return"";typeof t=="function"&&(t=qv(t,{...this.options,...a})),Array.isArray(t)||(t=[String(t)]);const i=a.returnDetails!==void 0?a.returnDetails:this.options.returnDetails,u=a.keySeparator!==void 0?a.keySeparator:this.options.keySeparator,{key:l,namespaces:c}=this.extractFromKey(t[t.length-1],a),f=c[c.length-1];let d=a.nsSeparator!==void 0?a.nsSeparator:this.options.nsSeparator;d===void 0&&(d=":");const v=a.lng||this.language,m=a.appendNamespaceToCIMode||this.options.appendNamespaceToCIMode;if(v?.toLowerCase()==="cimode")return m?i?{res:`${f}${d}${l}`,usedKey:l,exactUsedKey:l,usedLng:v,usedNS:f,usedParams:this.getUsedParamsDetails(a)}:`${f}${d}${l}`:i?{res:l,usedKey:l,exactUsedKey:l,usedLng:v,usedNS:f,usedParams:this.getUsedParamsDetails(a)}:l;const g=this.resolve(t,a);let b=g?.res;const w=g?.usedKey||l,S=g?.exactUsedKey||l,E=["[object Number]","[object Function]","[object RegExp]"],_=a.joinArrays!==void 0?a.joinArrays:this.options.joinArrays,R=!this.i18nFormat||this.i18nFormat.handleAsObject,C=a.count!==void 0&&!Fe(a.count),A=xf.hasDefaultValue(a),D=C?this.pluralResolver.getSuffix(v,a.count,a):"",O=a.ordinal&&C?this.pluralResolver.getSuffix(v,a.count,{ordinal:!1}):"",F=C&&!a.ordinal&&a.count===0,N=F&&a[`defaultValue${this.options.pluralSeparator}zero`]||a[`defaultValue${D}`]||a[`defaultValue${O}`]||a.defaultValue;let B=b;R&&!b&&A&&(B=N);const H=Lx(B),U=Object.prototype.toString.apply(B);if(R&&B&&H&&E.indexOf(U)<0&&!(Fe(_)&&Array.isArray(B))){if(!a.returnObjects&&!this.options.returnObjects){this.options.returnedObjectHandler||this.logger.warn("accessing an object - but returnObjects options is not enabled!");const J=this.options.returnedObjectHandler?this.options.returnedObjectHandler(w,B,{...a,ns:c}):`key '${l} (${this.language})' returned an object instead of string.`;return i?(g.res=J,g.usedParams=this.getUsedParamsDetails(a),g):J}if(u){const J=Array.isArray(B),ee=J?[]:{},te=J?S:w;for(const L in B)if(Object.prototype.hasOwnProperty.call(B,L)){const W=`${te}${u}${L}`;A&&!b?ee[L]=this.translate(W,{...a,defaultValue:Lx(N)?N[L]:void 0,joinArrays:!1,ns:c}):ee[L]=this.translate(W,{...a,joinArrays:!1,ns:c}),ee[L]===W&&(ee[L]=B[L])}b=ee}}else if(R&&Fe(_)&&Array.isArray(b))b=b.join(_),b&&(b=this.extendTranslation(b,t,a,r));else{let J=!1,ee=!1;!this.isValidLookup(b)&&A&&(J=!0,b=N),this.isValidLookup(b)||(ee=!0,b=l);const L=(a.missingKeyNoValueFallbackToKey||this.options.missingKeyNoValueFallbackToKey)&&ee?void 0:b,W=A&&N!==b&&this.options.updateMissing;if(ee||J||W){if(this.logger.log(W?"updateKey":"missingKey",v,f,l,W?N:b),u){const j=this.resolve(l,{...a,keySeparator:!1});j&&j.res&&this.logger.warn("Seems the loaded translations were in flat JSON format instead of nested. Either set keySeparator: false on init or make sure your translations are published in nested format.")}let $=[];const ne=this.languageUtils.getFallbackCodes(this.options.fallbackLng,a.lng||this.language);if(this.options.saveMissingTo==="fallback"&&ne&&ne[0])for(let j=0;j<ne.length;j++)$.push(ne[j]);else this.options.saveMissingTo==="all"?$=this.languageUtils.toResolveHierarchy(a.lng||this.language):$.push(a.lng||this.language);const M=(j,ie,oe)=>{const de=A&&oe!==b?oe:L;this.options.missingKeyHandler?this.options.missingKeyHandler(j,f,ie,de,W,a):this.backendConnector?.saveMissing&&this.backendConnector.saveMissing(j,f,ie,de,W,a),this.emit("missingKey",j,f,ie,b)};this.options.saveMissing&&(this.options.saveMissingPlurals&&C?$.forEach(j=>{const ie=this.pluralResolver.getSuffixes(j,a);F&&a[`defaultValue${this.options.pluralSeparator}zero`]&&ie.indexOf(`${this.options.pluralSeparator}zero`)<0&&ie.push(`${this.options.pluralSeparator}zero`),ie.forEach(oe=>{M([j],l+oe,a[`defaultValue${oe}`]||N)})}):M($,l,N))}b=this.extendTranslation(b,t,a,g,r),ee&&b===l&&this.options.appendNamespaceToMissingKey&&(b=`${f}${d}${l}`),(ee||J)&&this.options.parseMissingKeyHandler&&(b=this.options.parseMissingKeyHandler(this.options.appendNamespaceToMissingKey?`${f}${d}${l}`:l,J?b:void 0,a))}return i?(g.res=b,g.usedParams=this.getUsedParamsDetails(a),g):b}extendTranslation(t,e,r,a,i){if(this.i18nFormat?.parse)t=this.i18nFormat.parse(t,{...this.options.interpolation.defaultVariables,...r},r.lng||this.language||a.usedLng,a.usedNS,a.usedKey,{resolved:a});else if(!r.skipInterpolation){r.interpolation&&this.interpolator.init({...r,interpolation:{...this.options.interpolation,...r.interpolation}});const c=Fe(t)&&(r?.interpolation?.skipOnVariables!==void 0?r.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables);let f;if(c){const v=t.match(this.interpolator.nestingRegexp);f=v&&v.length}let d=r.replace&&!Fe(r.replace)?r.replace:r;if(this.options.interpolation.defaultVariables&&(d={...this.options.interpolation.defaultVariables,...d}),t=this.interpolator.interpolate(t,d,r.lng||this.language||a.usedLng,r),c){const v=t.match(this.interpolator.nestingRegexp),m=v&&v.length;f<m&&(r.nest=!1)}!r.lng&&a&&a.res&&(r.lng=this.language||a.usedLng),r.nest!==!1&&(t=this.interpolator.nest(t,(...v)=>i?.[0]===v[0]&&!r.context?(this.logger.warn(`It seems you are nesting recursively key: ${v[0]} in key: ${e[0]}`),null):this.translate(...v,e),r)),r.interpolation&&this.interpolator.reset()}const u=r.postProcess||this.options.postProcess,l=Fe(u)?[u]:u;return t!=null&&l?.length&&r.applyPostProcessor!==!1&&(t=wS.handle(l,t,e,this.options&&this.options.postProcessPassResolved?{i18nResolved:{...a,usedParams:this.getUsedParamsDetails(r)},...r}:r,this)),t}resolve(t,e={}){let r,a,i,u,l;return Fe(t)&&(t=[t]),t.forEach(c=>{if(this.isValidLookup(r))return;const f=this.extractFromKey(c,e),d=f.key;a=d;let v=f.namespaces;this.options.fallbackNS&&(v=v.concat(this.options.fallbackNS));const m=e.count!==void 0&&!Fe(e.count),g=m&&!e.ordinal&&e.count===0,b=e.context!==void 0&&(Fe(e.context)||typeof e.context=="number")&&e.context!=="",w=e.lngs?e.lngs:this.languageUtils.toResolveHierarchy(e.lng||this.language,e.fallbackLng);v.forEach(S=>{this.isValidLookup(r)||(l=S,!Px[`${w[0]}-${S}`]&&this.utils?.hasLoadedNamespace&&!this.utils?.hasLoadedNamespace(l)&&(Px[`${w[0]}-${S}`]=!0,this.logger.warn(`key "${a}" for languages "${w.join(", ")}" won't get resolved as namespace "${l}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!")),w.forEach(E=>{if(this.isValidLookup(r))return;u=E;const _=[d];if(this.i18nFormat?.addLookupKeys)this.i18nFormat.addLookupKeys(_,d,E,S,e);else{let C;m&&(C=this.pluralResolver.getSuffix(E,e.count,e));const A=`${this.options.pluralSeparator}zero`,D=`${this.options.pluralSeparator}ordinal${this.options.pluralSeparator}`;if(m&&(e.ordinal&&C.indexOf(D)===0&&_.push(d+C.replace(D,this.options.pluralSeparator)),_.push(d+C),g&&_.push(d+A)),b){const O=`${d}${this.options.contextSeparator||"_"}${e.context}`;_.push(O),m&&(e.ordinal&&C.indexOf(D)===0&&_.push(O+C.replace(D,this.options.pluralSeparator)),_.push(O+C),g&&_.push(O+A))}}let R;for(;R=_.pop();)this.isValidLookup(r)||(i=R,r=this.getResource(E,S,R,e))}))})}),{res:r,usedKey:a,exactUsedKey:i,usedLng:u,usedNS:l}}isValidLookup(t){return t!==void 0&&!(!this.options.returnNull&&t===null)&&!(!this.options.returnEmptyString&&t==="")}getResource(t,e,r,a={}){return this.i18nFormat?.getResource?this.i18nFormat.getResource(t,e,r,a):this.resourceStore.getResource(t,e,r,a)}getUsedParamsDetails(t={}){const e=["defaultValue","ordinal","context","replace","lng","lngs","fallbackLng","ns","keySeparator","nsSeparator","returnObjects","returnDetails","joinArrays","postProcess","interpolation"],r=t.replace&&!Fe(t.replace);let a=r?t.replace:t;if(r&&typeof t.count<"u"&&(a.count=t.count),this.options.interpolation.defaultVariables&&(a={...this.options.interpolation.defaultVariables,...a}),!r){a={...a};for(const i of e)delete a[i]}return a}static hasDefaultValue(t){const e="defaultValue";for(const r in t)if(Object.prototype.hasOwnProperty.call(t,r)&&e===r.substring(0,e.length)&&t[r]!==void 0)return!0;return!1}}class zx{constructor(t){this.options=t,this.supportedLngs=this.options.supportedLngs||!1,this.logger=Gr.create("languageUtils")}getScriptPartFromCode(t){if(t=ju(t),!t||t.indexOf("-")<0)return null;const e=t.split("-");return e.length===2||(e.pop(),e[e.length-1].toLowerCase()==="x")?null:this.formatLanguageCode(e.join("-"))}getLanguagePartFromCode(t){if(t=ju(t),!t||t.indexOf("-")<0)return t;const e=t.split("-");return this.formatLanguageCode(e[0])}formatLanguageCode(t){if(Fe(t)&&t.indexOf("-")>-1){let e;try{e=Intl.getCanonicalLocales(t)[0]}catch{}return e&&this.options.lowerCaseLng&&(e=e.toLowerCase()),e||(this.options.lowerCaseLng?t.toLowerCase():t)}return this.options.cleanCode||this.options.lowerCaseLng?t.toLowerCase():t}isSupportedCode(t){return(this.options.load==="languageOnly"||this.options.nonExplicitSupportedLngs)&&(t=this.getLanguagePartFromCode(t)),!this.supportedLngs||!this.supportedLngs.length||this.supportedLngs.indexOf(t)>-1}getBestMatchFromCodes(t){if(!t)return null;let e;return t.forEach(r=>{if(e)return;const a=this.formatLanguageCode(r);(!this.options.supportedLngs||this.isSupportedCode(a))&&(e=a)}),!e&&this.options.supportedLngs&&t.forEach(r=>{if(e)return;const a=this.getScriptPartFromCode(r);if(this.isSupportedCode(a))return e=a;const i=this.getLanguagePartFromCode(r);if(this.isSupportedCode(i))return e=i;e=this.options.supportedLngs.find(u=>{if(u===i)return u;if(!(u.indexOf("-")<0&&i.indexOf("-")<0)&&(u.indexOf("-")>0&&i.indexOf("-")<0&&u.substring(0,u.indexOf("-"))===i||u.indexOf(i)===0&&i.length>1))return u})}),e||(e=this.getFallbackCodes(this.options.fallbackLng)[0]),e}getFallbackCodes(t,e){if(!t)return[];if(typeof t=="function"&&(t=t(e)),Fe(t)&&(t=[t]),Array.isArray(t))return t;if(!e)return t.default||[];let r=t[e];return r||(r=t[this.getScriptPartFromCode(e)]),r||(r=t[this.formatLanguageCode(e)]),r||(r=t[this.getLanguagePartFromCode(e)]),r||(r=t.default),r||[]}toResolveHierarchy(t,e){const r=this.getFallbackCodes((e===!1?[]:e)||this.options.fallbackLng||[],t),a=[],i=u=>{u&&(this.isSupportedCode(u)?a.push(u):this.logger.warn(`rejecting language code not found in supportedLngs: ${u}`))};return Fe(t)&&(t.indexOf("-")>-1||t.indexOf("_")>-1)?(this.options.load!=="languageOnly"&&i(this.formatLanguageCode(t)),this.options.load!=="languageOnly"&&this.options.load!=="currentOnly"&&i(this.getScriptPartFromCode(t)),this.options.load!=="currentOnly"&&i(this.getLanguagePartFromCode(t))):Fe(t)&&i(this.formatLanguageCode(t)),r.forEach(u=>{a.indexOf(u)<0&&i(this.formatLanguageCode(u))}),a}}const Ux={zero:0,one:1,two:2,few:3,many:4,other:5},Hx={select:n=>n===1?"one":"other",resolvedOptions:()=>({pluralCategories:["one","other"]})};class dk{constructor(t,e={}){this.languageUtils=t,this.options=e,this.logger=Gr.create("pluralResolver"),this.pluralRulesCache={}}addRule(t,e){this.rules[t]=e}clearCache(){this.pluralRulesCache={}}getRule(t,e={}){const r=ju(t==="dev"?"en":t),a=e.ordinal?"ordinal":"cardinal",i=JSON.stringify({cleanedCode:r,type:a});if(i in this.pluralRulesCache)return this.pluralRulesCache[i];let u;try{u=new Intl.PluralRules(r,{type:a})}catch{if(!Intl)return this.logger.error("No Intl support, please use an Intl polyfill!"),Hx;if(!t.match(/-|_/))return Hx;const c=this.languageUtils.getLanguagePartFromCode(t);u=this.getRule(c,e)}return this.pluralRulesCache[i]=u,u}needsPlural(t,e={}){let r=this.getRule(t,e);return r||(r=this.getRule("dev",e)),r?.resolvedOptions().pluralCategories.length>1}getPluralFormsOfKey(t,e,r={}){return this.getSuffixes(t,r).map(a=>`${e}${a}`)}getSuffixes(t,e={}){let r=this.getRule(t,e);return r||(r=this.getRule("dev",e)),r?r.resolvedOptions().pluralCategories.sort((a,i)=>Ux[a]-Ux[i]).map(a=>`${this.options.prepend}${e.ordinal?`ordinal${this.options.prepend}`:""}${a}`):[]}getSuffix(t,e,r={}){const a=this.getRule(t,r);return a?`${this.options.prepend}${r.ordinal?`ordinal${this.options.prepend}`:""}${a.select(e)}`:(this.logger.warn(`no plural rule found for: ${t}`),this.getSuffix("dev",e,r))}}const Vx=(n,t,e,r=".",a=!0)=>{let i=ak(n,t,e);return!i&&a&&Fe(e)&&(i=jv(n,e,r),i===void 0&&(i=jv(t,e,r))),i},Zp=n=>n.replace(/\$/g,"$$$$");class pk{constructor(t={}){this.logger=Gr.create("interpolator"),this.options=t,this.format=t?.interpolation?.format||(e=>e),this.init(t)}init(t={}){t.interpolation||(t.interpolation={escapeValue:!0});const{escape:e,escapeValue:r,useRawValueToEscape:a,prefix:i,prefixEscaped:u,suffix:l,suffixEscaped:c,formatSeparator:f,unescapeSuffix:d,unescapePrefix:v,nestingPrefix:m,nestingPrefixEscaped:g,nestingSuffix:b,nestingSuffixEscaped:w,nestingOptionsSeparator:S,maxReplaces:E,alwaysFormat:_}=t.interpolation;this.escape=e!==void 0?e:ok,this.escapeValue=r!==void 0?r:!0,this.useRawValueToEscape=a!==void 0?a:!1,this.prefix=i?Xo(i):u||"{{",this.suffix=l?Xo(l):c||"}}",this.formatSeparator=f||",",this.unescapePrefix=d?"":v||"-",this.unescapeSuffix=this.unescapePrefix?"":d||"",this.nestingPrefix=m?Xo(m):g||Xo("$t("),this.nestingSuffix=b?Xo(b):w||Xo(")"),this.nestingOptionsSeparator=S||",",this.maxReplaces=E||1e3,this.alwaysFormat=_!==void 0?_:!1,this.resetRegExp()}reset(){this.options&&this.init(this.options)}resetRegExp(){const t=(e,r)=>e?.source===r?(e.lastIndex=0,e):new RegExp(r,"g");this.regexp=t(this.regexp,`${this.prefix}(.+?)${this.suffix}`),this.regexpUnescape=t(this.regexpUnescape,`${this.prefix}${this.unescapePrefix}(.+?)${this.unescapeSuffix}${this.suffix}`),this.nestingRegexp=t(this.nestingRegexp,`${this.nestingPrefix}((?:[^()"']+|"[^"]*"|'[^']*'|\\((?:[^()]|"[^"]*"|'[^']*')*\\))*?)${this.nestingSuffix}`)}interpolate(t,e,r,a){let i,u,l;const c=this.options&&this.options.interpolation&&this.options.interpolation.defaultVariables||{},f=g=>{if(g.indexOf(this.formatSeparator)<0){const E=Vx(e,c,g,this.options.keySeparator,this.options.ignoreJSONStructure);return this.alwaysFormat?this.format(E,void 0,r,{...a,...e,interpolationkey:g}):E}const b=g.split(this.formatSeparator),w=b.shift().trim(),S=b.join(this.formatSeparator).trim();return this.format(Vx(e,c,w,this.options.keySeparator,this.options.ignoreJSONStructure),S,r,{...a,...e,interpolationkey:w})};this.resetRegExp();const d=a?.missingInterpolationHandler||this.options.missingInterpolationHandler,v=a?.interpolation?.skipOnVariables!==void 0?a.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables;return[{regex:this.regexpUnescape,safeValue:g=>Zp(g)},{regex:this.regexp,safeValue:g=>this.escapeValue?Zp(this.escape(g)):Zp(g)}].forEach(g=>{for(l=0;i=g.regex.exec(t);){const b=i[1].trim();if(u=f(b),u===void 0)if(typeof d=="function"){const S=d(t,i,a);u=Fe(S)?S:""}else if(a&&Object.prototype.hasOwnProperty.call(a,b))u="";else if(v){u=i[0];continue}else this.logger.warn(`missed to pass in variable ${b} for interpolating ${t}`),u="";else!Fe(u)&&!this.useRawValueToEscape&&(u=Nx(u));const w=g.safeValue(u);if(t=t.replace(i[0],w),v?(g.regex.lastIndex+=u.length,g.regex.lastIndex-=i[0].length):g.regex.lastIndex=0,l++,l>=this.maxReplaces)break}}),t}nest(t,e,r={}){let a,i,u;const l=(c,f)=>{const d=this.nestingOptionsSeparator;if(c.indexOf(d)<0)return c;const v=c.split(new RegExp(`${d}[ ]*{`));let m=`{${v[1]}`;c=v[0],m=this.interpolate(m,u);const g=m.match(/'/g),b=m.match(/"/g);((g?.length??0)%2===0&&!b||b.length%2!==0)&&(m=m.replace(/'/g,'"'));try{u=JSON.parse(m),f&&(u={...f,...u})}catch(w){return this.logger.warn(`failed parsing options string in nesting for key ${c}`,w),`${c}${d}${m}`}return u.defaultValue&&u.defaultValue.indexOf(this.prefix)>-1&&delete u.defaultValue,c};for(;a=this.nestingRegexp.exec(t);){let c=[];u={...r},u=u.replace&&!Fe(u.replace)?u.replace:u,u.applyPostProcessor=!1,delete u.defaultValue;const f=/{.*}/.test(a[1])?a[1].lastIndexOf("}")+1:a[1].indexOf(this.formatSeparator);if(f!==-1&&(c=a[1].slice(f).split(this.formatSeparator).map(d=>d.trim()).filter(Boolean),a[1]=a[1].slice(0,f)),i=e(l.call(this,a[1].trim(),u),u),i&&a[0]===t&&!Fe(i))return i;Fe(i)||(i=Nx(i)),i||(this.logger.warn(`missed to resolve ${a[1]} for nesting ${t}`),i=""),c.length&&(i=c.reduce((d,v)=>this.format(d,v,r.lng,{...r,interpolationkey:a[1].trim()}),i.trim())),t=t.replace(a[0],i),this.regexp.lastIndex=0}return t}}const vk=n=>{let t=n.toLowerCase().trim();const e={};if(n.indexOf("(")>-1){const r=n.split("(");t=r[0].toLowerCase().trim();const a=r[1].substring(0,r[1].length-1);t==="currency"&&a.indexOf(":")<0?e.currency||(e.currency=a.trim()):t==="relativetime"&&a.indexOf(":")<0?e.range||(e.range=a.trim()):a.split(";").forEach(u=>{if(u){const[l,...c]=u.split(":"),f=c.join(":").trim().replace(/^'+|'+$/g,""),d=l.trim();e[d]||(e[d]=f),f==="false"&&(e[d]=!1),f==="true"&&(e[d]=!0),isNaN(f)||(e[d]=parseInt(f,10))}})}return{formatName:t,formatOptions:e}},Wx=n=>{const t={};return(e,r,a)=>{let i=a;a&&a.interpolationkey&&a.formatParams&&a.formatParams[a.interpolationkey]&&a[a.interpolationkey]&&(i={...i,[a.interpolationkey]:void 0});const u=r+JSON.stringify(i);let l=t[u];return l||(l=n(ju(r),a),t[u]=l),l(e)}},mk=n=>(t,e,r)=>n(ju(e),r)(t);class gk{constructor(t={}){this.logger=Gr.create("formatter"),this.options=t,this.init(t)}init(t,e={interpolation:{}}){this.formatSeparator=e.interpolation.formatSeparator||",";const r=e.cacheInBuiltFormats?Wx:mk;this.formats={number:r((a,i)=>{const u=new Intl.NumberFormat(a,{...i});return l=>u.format(l)}),currency:r((a,i)=>{const u=new Intl.NumberFormat(a,{...i,style:"currency"});return l=>u.format(l)}),datetime:r((a,i)=>{const u=new Intl.DateTimeFormat(a,{...i});return l=>u.format(l)}),relativetime:r((a,i)=>{const u=new Intl.RelativeTimeFormat(a,{...i});return l=>u.format(l,i.range||"day")}),list:r((a,i)=>{const u=new Intl.ListFormat(a,{...i});return l=>u.format(l)})}}add(t,e){this.formats[t.toLowerCase().trim()]=e}addCached(t,e){this.formats[t.toLowerCase().trim()]=Wx(e)}format(t,e,r,a={}){const i=e.split(this.formatSeparator);if(i.length>1&&i[0].indexOf("(")>1&&i[0].indexOf(")")<0&&i.find(l=>l.indexOf(")")>-1)){const l=i.findIndex(c=>c.indexOf(")")>-1);i[0]=[i[0],...i.splice(1,l)].join(this.formatSeparator)}return i.reduce((l,c)=>{const{formatName:f,formatOptions:d}=vk(c);if(this.formats[f]){let v=l;try{const m=a?.formatParams?.[a.interpolationkey]||{},g=m.locale||m.lng||a.locale||a.lng||r;v=this.formats[f](l,g,{...d,...a,...m})}catch(m){this.logger.warn(m)}return v}else this.logger.warn(`there was no format function for ${f}`);return l},t)}}const yk=(n,t)=>{n.pending[t]!==void 0&&(delete n.pending[t],n.pendingCount--)};class bk extends Qf{constructor(t,e,r,a={}){super(),this.backend=t,this.store=e,this.services=r,this.languageUtils=r.languageUtils,this.options=a,this.logger=Gr.create("backendConnector"),this.waitingReads=[],this.maxParallelReads=a.maxParallelReads||10,this.readingCalls=0,this.maxRetries=a.maxRetries>=0?a.maxRetries:5,this.retryTimeout=a.retryTimeout>=1?a.retryTimeout:350,this.state={},this.queue=[],this.backend?.init?.(r,a.backend,a)}queueLoad(t,e,r,a){const i={},u={},l={},c={};return t.forEach(f=>{let d=!0;e.forEach(v=>{const m=`${f}|${v}`;!r.reload&&this.store.hasResourceBundle(f,v)?this.state[m]=2:this.state[m]<0||(this.state[m]===1?u[m]===void 0&&(u[m]=!0):(this.state[m]=1,d=!1,u[m]===void 0&&(u[m]=!0),i[m]===void 0&&(i[m]=!0),c[v]===void 0&&(c[v]=!0)))}),d||(l[f]=!0)}),(Object.keys(i).length||Object.keys(u).length)&&this.queue.push({pending:u,pendingCount:Object.keys(u).length,loaded:{},errors:[],callback:a}),{toLoad:Object.keys(i),pending:Object.keys(u),toLoadLanguages:Object.keys(l),toLoadNamespaces:Object.keys(c)}}loaded(t,e,r){const a=t.split("|"),i=a[0],u=a[1];e&&this.emit("failedLoading",i,u,e),!e&&r&&this.store.addResourceBundle(i,u,r,void 0,void 0,{skipCopy:!0}),this.state[t]=e?-1:2,e&&r&&(this.state[t]=0);const l={};this.queue.forEach(c=>{rk(c.loaded,[i],u),yk(c,t),e&&c.errors.push(e),c.pendingCount===0&&!c.done&&(Object.keys(c.loaded).forEach(f=>{l[f]||(l[f]={});const d=c.loaded[f];d.length&&d.forEach(v=>{l[f][v]===void 0&&(l[f][v]=!0)})}),c.done=!0,c.errors.length?c.callback(c.errors):c.callback())}),this.emit("loaded",l),this.queue=this.queue.filter(c=>!c.done)}read(t,e,r,a=0,i=this.retryTimeout,u){if(!t.length)return u(null,{});if(this.readingCalls>=this.maxParallelReads){this.waitingReads.push({lng:t,ns:e,fcName:r,tried:a,wait:i,callback:u});return}this.readingCalls++;const l=(f,d)=>{if(this.readingCalls--,this.waitingReads.length>0){const v=this.waitingReads.shift();this.read(v.lng,v.ns,v.fcName,v.tried,v.wait,v.callback)}if(f&&d&&a<this.maxRetries){setTimeout(()=>{this.read.call(this,t,e,r,a+1,i*2,u)},i);return}u(f,d)},c=this.backend[r].bind(this.backend);if(c.length===2){try{const f=c(t,e);f&&typeof f.then=="function"?f.then(d=>l(null,d)).catch(l):l(null,f)}catch(f){l(f)}return}return c(t,e,l)}prepareLoading(t,e,r={},a){if(!this.backend)return this.logger.warn("No backend was added via i18next.use. Will not load resources."),a&&a();Fe(t)&&(t=this.languageUtils.toResolveHierarchy(t)),Fe(e)&&(e=[e]);const i=this.queueLoad(t,e,r,a);if(!i.toLoad.length)return i.pending.length||a(),null;i.toLoad.forEach(u=>{this.loadOne(u)})}load(t,e,r){this.prepareLoading(t,e,{},r)}reload(t,e,r){this.prepareLoading(t,e,{reload:!0},r)}loadOne(t,e=""){const r=t.split("|"),a=r[0],i=r[1];this.read(a,i,"read",void 0,void 0,(u,l)=>{u&&this.logger.warn(`${e}loading namespace ${i} for language ${a} failed`,u),!u&&l&&this.logger.log(`${e}loaded namespace ${i} for language ${a}`,l),this.loaded(t,u,l)})}saveMissing(t,e,r,a,i,u={},l=()=>{}){if(this.services?.utils?.hasLoadedNamespace&&!this.services?.utils?.hasLoadedNamespace(e)){this.logger.warn(`did not save key "${r}" as the namespace "${e}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!");return}if(!(r==null||r==="")){if(this.backend?.create){const c={...u,isUpdate:i},f=this.backend.create.bind(this.backend);if(f.length<6)try{let d;f.length===5?d=f(t,e,r,a,c):d=f(t,e,r,a),d&&typeof d.then=="function"?d.then(v=>l(null,v)).catch(l):l(null,d)}catch(d){l(d)}else f(t,e,r,a,l,c)}!t||!t[0]||this.store.addResource(t[0],e,r,a)}}}const Gx=()=>({debug:!1,initAsync:!0,ns:["translation"],defaultNS:["translation"],fallbackLng:["dev"],fallbackNS:!1,supportedLngs:!1,nonExplicitSupportedLngs:!1,load:"all",preload:!1,simplifyPluralSuffix:!0,keySeparator:".",nsSeparator:":",pluralSeparator:"_",contextSeparator:"_",partialBundledLanguages:!1,saveMissing:!1,updateMissing:!1,saveMissingTo:"fallback",saveMissingPlurals:!0,missingKeyHandler:!1,missingInterpolationHandler:!1,postProcess:!1,postProcessPassResolved:!1,returnNull:!1,returnEmptyString:!0,returnObjects:!1,joinArrays:!1,returnedObjectHandler:!1,parseMissingKeyHandler:!1,appendNamespaceToMissingKey:!1,appendNamespaceToCIMode:!1,overloadTranslationOptionHandler:n=>{let t={};if(typeof n[1]=="object"&&(t=n[1]),Fe(n[1])&&(t.defaultValue=n[1]),Fe(n[2])&&(t.tDescription=n[2]),typeof n[2]=="object"||typeof n[3]=="object"){const e=n[3]||n[2];Object.keys(e).forEach(r=>{t[r]=e[r]})}return t},interpolation:{escapeValue:!0,format:n=>n,prefix:"{{",suffix:"}}",formatSeparator:",",unescapePrefix:"-",nestingPrefix:"$t(",nestingSuffix:")",nestingOptionsSeparator:",",maxReplaces:1e3,skipOnVariables:!0},cacheInBuiltFormats:!0}),jx=n=>(Fe(n.ns)&&(n.ns=[n.ns]),Fe(n.fallbackLng)&&(n.fallbackLng=[n.fallbackLng]),Fe(n.fallbackNS)&&(n.fallbackNS=[n.fallbackNS]),n.supportedLngs?.indexOf?.("cimode")<0&&(n.supportedLngs=n.supportedLngs.concat(["cimode"])),typeof n.initImmediate=="boolean"&&(n.initAsync=n.initImmediate),n),Fc=()=>{},xk=n=>{Object.getOwnPropertyNames(Object.getPrototypeOf(n)).forEach(e=>{typeof n[e]=="function"&&(n[e]=n[e].bind(n))})};class qu extends Qf{constructor(t={},e){if(super(),this.options=jx(t),this.services={},this.logger=Gr,this.modules={external:[]},xk(this),e&&!this.isInitialized&&!t.isClone){if(!this.options.initAsync)return this.init(t,e),this;setTimeout(()=>{this.init(t,e)},0)}}init(t={},e){this.isInitializing=!0,typeof t=="function"&&(e=t,t={}),t.defaultNS==null&&t.ns&&(Fe(t.ns)?t.defaultNS=t.ns:t.ns.indexOf("translation")<0&&(t.defaultNS=t.ns[0]));const r=Gx();this.options={...r,...this.options,...jx(t)},this.options.interpolation={...r.interpolation,...this.options.interpolation},t.keySeparator!==void 0&&(this.options.userDefinedKeySeparator=t.keySeparator),t.nsSeparator!==void 0&&(this.options.userDefinedNsSeparator=t.nsSeparator);const a=f=>f?typeof f=="function"?new f:f:null;if(!this.options.isClone){this.modules.logger?Gr.init(a(this.modules.logger),this.options):Gr.init(null,this.options);let f;this.modules.formatter?f=this.modules.formatter:f=gk;const d=new zx(this.options);this.store=new Bx(this.options.resources,this.options);const v=this.services;v.logger=Gr,v.resourceStore=this.store,v.languageUtils=d,v.pluralResolver=new dk(d,{prepend:this.options.pluralSeparator,simplifyPluralSuffix:this.options.simplifyPluralSuffix}),this.options.interpolation.format&&this.options.interpolation.format!==r.interpolation.format&&this.logger.deprecate("init: you are still using the legacy format function, please use the new approach: https://www.i18next.com/translation-function/formatting"),f&&(!this.options.interpolation.format||this.options.interpolation.format===r.interpolation.format)&&(v.formatter=a(f),v.formatter.init&&v.formatter.init(v,this.options),this.options.interpolation.format=v.formatter.format.bind(v.formatter)),v.interpolator=new pk(this.options),v.utils={hasLoadedNamespace:this.hasLoadedNamespace.bind(this)},v.backendConnector=new bk(a(this.modules.backend),v.resourceStore,v,this.options),v.backendConnector.on("*",(g,...b)=>{this.emit(g,...b)}),this.modules.languageDetector&&(v.languageDetector=a(this.modules.languageDetector),v.languageDetector.init&&v.languageDetector.init(v,this.options.detection,this.options)),this.modules.i18nFormat&&(v.i18nFormat=a(this.modules.i18nFormat),v.i18nFormat.init&&v.i18nFormat.init(this)),this.translator=new xf(this.services,this.options),this.translator.on("*",(g,...b)=>{this.emit(g,...b)}),this.modules.external.forEach(g=>{g.init&&g.init(this)})}if(this.format=this.options.interpolation.format,e||(e=Fc),this.options.fallbackLng&&!this.services.languageDetector&&!this.options.lng){const f=this.services.languageUtils.getFallbackCodes(this.options.fallbackLng);f.length>0&&f[0]!=="dev"&&(this.options.lng=f[0])}!this.services.languageDetector&&!this.options.lng&&this.logger.warn("init: no languageDetector is used and no lng is defined"),["getResource","hasResourceBundle","getResourceBundle","getDataByLanguage"].forEach(f=>{this[f]=(...d)=>this.store[f](...d)}),["addResource","addResources","addResourceBundle","removeResourceBundle"].forEach(f=>{this[f]=(...d)=>(this.store[f](...d),this)});const l=Ou(),c=()=>{const f=(d,v)=>{this.isInitializing=!1,this.isInitialized&&!this.initializedStoreOnce&&this.logger.warn("init: i18next is already initialized. You should call init just once!"),this.isInitialized=!0,this.options.isClone||this.logger.log("initialized",this.options),this.emit("initialized",this.options),l.resolve(v),e(d,v)};if(this.languages&&!this.isInitialized)return f(null,this.t.bind(this));this.changeLanguage(this.options.lng,f)};return this.options.resources||!this.options.initAsync?c():setTimeout(c,0),l}loadResources(t,e=Fc){let r=e;const a=Fe(t)?t:this.language;if(typeof t=="function"&&(r=t),!this.options.resources||this.options.partialBundledLanguages){if(a?.toLowerCase()==="cimode"&&(!this.options.preload||this.options.preload.length===0))return r();const i=[],u=l=>{if(!l||l==="cimode")return;this.services.languageUtils.toResolveHierarchy(l).forEach(f=>{f!=="cimode"&&i.indexOf(f)<0&&i.push(f)})};a?u(a):this.services.languageUtils.getFallbackCodes(this.options.fallbackLng).forEach(c=>u(c)),this.options.preload?.forEach?.(l=>u(l)),this.services.backendConnector.load(i,this.options.ns,l=>{!l&&!this.resolvedLanguage&&this.language&&this.setResolvedLanguage(this.language),r(l)})}else r(null)}reloadResources(t,e,r){const a=Ou();return typeof t=="function"&&(r=t,t=void 0),typeof e=="function"&&(r=e,e=void 0),t||(t=this.languages),e||(e=this.options.ns),r||(r=Fc),this.services.backendConnector.reload(t,e,i=>{a.resolve(),r(i)}),a}use(t){if(!t)throw new Error("You are passing an undefined module! Please check the object you are passing to i18next.use()");if(!t.type)throw new Error("You are passing a wrong module! Please check the object you are passing to i18next.use()");return t.type==="backend"&&(this.modules.backend=t),(t.type==="logger"||t.log&&t.warn&&t.error)&&(this.modules.logger=t),t.type==="languageDetector"&&(this.modules.languageDetector=t),t.type==="i18nFormat"&&(this.modules.i18nFormat=t),t.type==="postProcessor"&&wS.addPostProcessor(t),t.type==="formatter"&&(this.modules.formatter=t),t.type==="3rdParty"&&this.modules.external.push(t),this}setResolvedLanguage(t){if(!(!t||!this.languages)&&!(["cimode","dev"].indexOf(t)>-1)){for(let e=0;e<this.languages.length;e++){const r=this.languages[e];if(!(["cimode","dev"].indexOf(r)>-1)&&this.store.hasLanguageSomeTranslations(r)){this.resolvedLanguage=r;break}}!this.resolvedLanguage&&this.languages.indexOf(t)<0&&this.store.hasLanguageSomeTranslations(t)&&(this.resolvedLanguage=t,this.languages.unshift(t))}}changeLanguage(t,e){this.isLanguageChangingTo=t;const r=Ou();this.emit("languageChanging",t);const a=l=>{this.language=l,this.languages=this.services.languageUtils.toResolveHierarchy(l),this.resolvedLanguage=void 0,this.setResolvedLanguage(l)},i=(l,c)=>{c?this.isLanguageChangingTo===t&&(a(c),this.translator.changeLanguage(c),this.isLanguageChangingTo=void 0,this.emit("languageChanged",c),this.logger.log("languageChanged",c)):this.isLanguageChangingTo=void 0,r.resolve((...f)=>this.t(...f)),e&&e(l,(...f)=>this.t(...f))},u=l=>{!t&&!l&&this.services.languageDetector&&(l=[]);const c=Fe(l)?l:l&&l[0],f=this.store.hasLanguageSomeTranslations(c)?c:this.services.languageUtils.getBestMatchFromCodes(Fe(l)?[l]:l);f&&(this.language||a(f),this.translator.language||this.translator.changeLanguage(f),this.services.languageDetector?.cacheUserLanguage?.(f)),this.loadResources(f,d=>{i(d,f)})};return!t&&this.services.languageDetector&&!this.services.languageDetector.async?u(this.services.languageDetector.detect()):!t&&this.services.languageDetector&&this.services.languageDetector.async?this.services.languageDetector.detect.length===0?this.services.languageDetector.detect().then(u):this.services.languageDetector.detect(u):u(t),r}getFixedT(t,e,r){const a=(i,u,...l)=>{let c;typeof u!="object"?c=this.options.overloadTranslationOptionHandler([i,u].concat(l)):c={...u},c.lng=c.lng||a.lng,c.lngs=c.lngs||a.lngs,c.ns=c.ns||a.ns,c.keyPrefix!==""&&(c.keyPrefix=c.keyPrefix||r||a.keyPrefix);const f=this.options.keySeparator||".";let d;return c.keyPrefix&&Array.isArray(i)?d=i.map(v=>(typeof v=="function"&&(v=qv(v,{...this.options,...u})),`${c.keyPrefix}${f}${v}`)):(typeof i=="function"&&(i=qv(i,{...this.options,...u})),d=c.keyPrefix?`${c.keyPrefix}${f}${i}`:i),this.t(d,c)};return Fe(t)?a.lng=t:a.lngs=t,a.ns=e,a.keyPrefix=r,a}t(...t){return this.translator?.translate(...t)}exists(...t){return this.translator?.exists(...t)}setDefaultNamespace(t){this.options.defaultNS=t}hasLoadedNamespace(t,e={}){if(!this.isInitialized)return this.logger.warn("hasLoadedNamespace: i18next was not initialized",this.languages),!1;if(!this.languages||!this.languages.length)return this.logger.warn("hasLoadedNamespace: i18n.languages were undefined or empty",this.languages),!1;const r=e.lng||this.resolvedLanguage||this.languages[0],a=this.options?this.options.fallbackLng:!1,i=this.languages[this.languages.length-1];if(r.toLowerCase()==="cimode")return!0;const u=(l,c)=>{const f=this.services.backendConnector.state[`${l}|${c}`];return f===-1||f===0||f===2};if(e.precheck){const l=e.precheck(this,u);if(l!==void 0)return l}return!!(this.hasResourceBundle(r,t)||!this.services.backendConnector.backend||this.options.resources&&!this.options.partialBundledLanguages||u(r,t)&&(!a||u(i,t)))}loadNamespaces(t,e){const r=Ou();return this.options.ns?(Fe(t)&&(t=[t]),t.forEach(a=>{this.options.ns.indexOf(a)<0&&this.options.ns.push(a)}),this.loadResources(a=>{r.resolve(),e&&e(a)}),r):(e&&e(),Promise.resolve())}loadLanguages(t,e){const r=Ou();Fe(t)&&(t=[t]);const a=this.options.preload||[],i=t.filter(u=>a.indexOf(u)<0&&this.services.languageUtils.isSupportedCode(u));return i.length?(this.options.preload=a.concat(i),this.loadResources(u=>{r.resolve(),e&&e(u)}),r):(e&&e(),Promise.resolve())}dir(t){if(t||(t=this.resolvedLanguage||(this.languages?.length>0?this.languages[0]:this.language)),!t)return"rtl";try{const a=new Intl.Locale(t);if(a&&a.getTextInfo){const i=a.getTextInfo();if(i&&i.direction)return i.direction}}catch{}const e=["ar","shu","sqr","ssh","xaa","yhd","yud","aao","abh","abv","acm","acq","acw","acx","acy","adf","ads","aeb","aec","afb","ajp","apc","apd","arb","arq","ars","ary","arz","auz","avl","ayh","ayl","ayn","ayp","bbz","pga","he","iw","ps","pbt","pbu","pst","prp","prd","ug","ur","ydd","yds","yih","ji","yi","hbo","men","xmn","fa","jpr","peo","pes","prs","dv","sam","ckb"],r=this.services?.languageUtils||new zx(Gx());return t.toLowerCase().indexOf("-latn")>1?"ltr":e.indexOf(r.getLanguagePartFromCode(t))>-1||t.toLowerCase().indexOf("-arab")>1?"rtl":"ltr"}static createInstance(t={},e){return new qu(t,e)}cloneInstance(t={},e=Fc){const r=t.forkResourceStore;r&&delete t.forkResourceStore;const a={...this.options,...t,isClone:!0},i=new qu(a);if((t.debug!==void 0||t.prefix!==void 0)&&(i.logger=i.logger.clone(t)),["store","services","language"].forEach(l=>{i[l]=this[l]}),i.services={...this.services},i.services.utils={hasLoadedNamespace:i.hasLoadedNamespace.bind(i)},r){const l=Object.keys(this.store.data).reduce((c,f)=>(c[f]={...this.store.data[f]},c[f]=Object.keys(c[f]).reduce((d,v)=>(d[v]={...c[f][v]},d),c[f]),c),{});i.store=new Bx(l,a),i.services.resourceStore=i.store}return i.translator=new xf(i.services,a),i.translator.on("*",(l,...c)=>{i.emit(l,...c)}),i.init(a,e),i.translator.options=a,i.translator.backendConnector.services.utils={hasLoadedNamespace:i.hasLoadedNamespace.bind(i)},i}toJSON(){return{options:this.options,store:this.store,language:this.language,languages:this.languages,resolvedLanguage:this.resolvedLanguage}}}const Cn=qu.createInstance();Cn.createInstance=qu.createInstance;Cn.createInstance;Cn.dir;Cn.init;Cn.loadResources;Cn.reloadResources;Cn.use;Cn.changeLanguage;Cn.getFixedT;Cn.t;Cn.exists;Cn.setDefaultNamespace;Cn.hasLoadedNamespace;Cn.loadNamespaces;Cn.loadLanguages;const qx=n=>{let t;const e=new Set,r=(f,d)=>{const v=typeof f=="function"?f(t):f;if(!Object.is(v,t)){const m=t;t=d??(typeof v!="object"||v===null)?v:Object.assign({},t,v),e.forEach(g=>g(t,m))}},a=()=>t,l={setState:r,getState:a,getInitialState:()=>c,subscribe:f=>(e.add(f),()=>e.delete(f))},c=t=n(r,a,l);return l},wk=n=>n?qx(n):qx,Sk=n=>n;function Ek(n,t=Sk){const e=xn.useSyncExternalStore(n.subscribe,xn.useCallback(()=>t(n.getState()),[n,t]),xn.useCallback(()=>t(n.getInitialState()),[n,t]));return xn.useDebugValue(e),e}const _k=n=>{const t=wk(n),e=r=>Ek(t,r);return Object.assign(e,t),e},$6=n=>_k;function Ck(n,t){let e;try{e=n()}catch{return}return{getItem:a=>{var i;const u=c=>c===null?null:JSON.parse(c,void 0),l=(i=e.getItem(a))!=null?i:null;return l instanceof Promise?l.then(u):u(l)},setItem:(a,i)=>e.setItem(a,JSON.stringify(i,void 0)),removeItem:a=>e.removeItem(a)}}const $v=n=>t=>{try{const e=n(t);return e instanceof Promise?e:{then(r){return $v(r)(e)},catch(r){return this}}}catch(e){return{then(r){return this},catch(r){return $v(r)(e)}}}},Rk=(n,t)=>(e,r,a)=>{let i={storage:Ck(()=>localStorage),partialize:w=>w,version:0,merge:(w,S)=>({...S,...w}),...t},u=!1;const l=new Set,c=new Set;let f=i.storage;if(!f)return n((...w)=>{console.warn(`[zustand persist middleware] Unable to update item '${i.name}', the given storage is currently unavailable.`),e(...w)},r,a);const d=()=>{const w=i.partialize({...r()});return f.setItem(i.name,{state:w,version:i.version})},v=a.setState;a.setState=(w,S)=>(v(w,S),d());const m=n((...w)=>(e(...w),d()),r,a);a.getInitialState=()=>m;let g;const b=()=>{var w,S;if(!f)return;u=!1,l.forEach(_=>{var R;return _((R=r())!=null?R:m)});const E=((S=i.onRehydrateStorage)==null?void 0:S.call(i,(w=r())!=null?w:m))||void 0;return $v(f.getItem.bind(f))(i.name).then(_=>{if(_)if(typeof _.version=="number"&&_.version!==i.version){if(i.migrate){const R=i.migrate(_.state,_.version);return R instanceof Promise?R.then(C=>[!0,C]):[!0,R]}console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,_.state];return[!1,void 0]}).then(_=>{var R;const[C,A]=_;if(g=i.merge(A,(R=r())!=null?R:m),e(g,!0),C)return d()}).then(()=>{E?.(g,void 0),g=r(),u=!0,c.forEach(_=>_(g))}).catch(_=>{E?.(void 0,_)})};return a.persist={setOptions:w=>{i={...i,...w},w.storage&&(f=w.storage)},clearStorage:()=>{f?.removeItem(i.name)},getOptions:()=>i,rehydrate:()=>b(),hasHydrated:()=>u,onHydrate:w=>(l.add(w),()=>{l.delete(w)}),onFinishHydration:w=>(c.add(w),()=>{c.delete(w)})},i.skipHydration||b(),g||m},K6=Rk;function pe(n,t,e){function r(l,c){var f;Object.defineProperty(l,"_zod",{value:l._zod??{},enumerable:!1}),(f=l._zod).traits??(f.traits=new Set),l._zod.traits.add(n),t(l,c);for(const d in u.prototype)d in l||Object.defineProperty(l,d,{value:u.prototype[d].bind(l)});l._zod.constr=u,l._zod.def=c}const a=e?.Parent??Object;class i extends a{}Object.defineProperty(i,"name",{value:n});function u(l){var c;const f=e?.Parent?new i:this;r(f,l),(c=f._zod).deferred??(c.deferred=[]);for(const d of f._zod.deferred)d();return f}return Object.defineProperty(u,"init",{value:r}),Object.defineProperty(u,Symbol.hasInstance,{value:l=>e?.Parent&&l instanceof e.Parent?!0:l?._zod?.traits?.has(n)}),Object.defineProperty(u,"name",{value:n}),u}class ss extends Error{constructor(){super("Encountered Promise during synchronous parse. Use .parseAsync() instead.")}}class ES extends Error{constructor(t){super(`Encountered unidirectional transform during encode: ${t}`),this.name="ZodEncodeError"}}const Ak={};function eo(n){return Ak}function Kv(n,t){return typeof t=="bigint"?t.toString():t}function Pm(n){return n==null}function Lm(n){const t=n.startsWith("^")?1:0,e=n.endsWith("$")?n.length-1:n.length;return n.slice(t,e)}const $x=Symbol("evaluating");function yt(n,t,e){let r;Object.defineProperty(n,t,{get(){if(r!==$x)return r===void 0&&(r=$x,r=e()),r},set(a){Object.defineProperty(n,t,{value:a})},configurable:!0})}const _S="captureStackTrace"in Error?Error.captureStackTrace:(...n)=>{};function Kx(n){return typeof n=="object"&&n!==null&&!Array.isArray(n)}function Xv(n){if(Kx(n)===!1)return!1;const t=n.constructor;if(t===void 0)return!0;const e=t.prototype;return!(Kx(e)===!1||Object.prototype.hasOwnProperty.call(e,"isPrototypeOf")===!1)}function CS(n){return Xv(n)?{...n}:n}function zm(n){return n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function Tk(n,t,e){const r=new n._zod.constr(t??n._zod.def);return(!t||e?.parent)&&(r._zod.parent=n),r}function He(n){const t=n;if(!t)return{};if(typeof t=="string")return{error:()=>t};if(t?.message!==void 0){if(t?.error!==void 0)throw new Error("Cannot specify both `message` and `error` params");t.error=t.message}return delete t.message,typeof t.error=="string"?{...t,error:()=>t.error}:t}function os(n,t=0){if(n.aborted===!0)return!0;for(let e=t;e<n.issues.length;e++)if(n.issues[e]?.continue!==!0)return!0;return!1}function Dk(n,t){return t.map(e=>{var r;return(r=e).path??(r.path=[]),e.path.unshift(n),e})}function Bc(n){return typeof n=="string"?n:n?.message}function to(n,t,e){const r={...n,path:n.path??[]};if(!n.message){const a=Bc(n.inst?._zod.def?.error?.(n))??Bc(t?.error?.(n))??Bc(e.customError?.(n))??Bc(e.localeError?.(n))??"Invalid input";r.message=a}return delete r.inst,delete r.continue,t?.reportInput||delete r.input,r}function Um(n){return Array.isArray(n)?"array":typeof n=="string"?"string":"unknown"}function $u(...n){const[t,e,r]=n;return typeof t=="string"?{message:t,code:"custom",input:e,inst:r}:{...t}}const RS=(n,t)=>{n.name="$ZodError",Object.defineProperty(n,"_zod",{value:n._zod,enumerable:!1}),Object.defineProperty(n,"issues",{value:t,enumerable:!1}),n.message=JSON.stringify(t,Kv,2),Object.defineProperty(n,"toString",{value:()=>n.message,enumerable:!1})},AS=pe("$ZodError",RS),TS=pe("$ZodError",RS,{Parent:Error});function Ok(n,t=e=>e.message){const e={},r=[];for(const a of n.issues)a.path.length>0?(e[a.path[0]]=e[a.path[0]]||[],e[a.path[0]].push(t(a))):r.push(t(a));return{formErrors:r,fieldErrors:e}}function kk(n,t){const e=t||function(i){return i.message},r={_errors:[]},a=i=>{for(const u of i.issues)if(u.code==="invalid_union"&&u.errors.length)u.errors.map(l=>a({issues:l}));else if(u.code==="invalid_key")a({issues:u.issues});else if(u.code==="invalid_element")a({issues:u.issues});else if(u.path.length===0)r._errors.push(e(u));else{let l=r,c=0;for(;c<u.path.length;){const f=u.path[c];c===u.path.length-1?(l[f]=l[f]||{_errors:[]},l[f]._errors.push(e(u))):l[f]=l[f]||{_errors:[]},l=l[f],c++}}};return a(n),r}const Hm=n=>(t,e,r,a)=>{const i=r?Object.assign(r,{async:!1}):{async:!1},u=t._zod.run({value:e,issues:[]},i);if(u instanceof Promise)throw new ss;if(u.issues.length){const l=new(a?.Err??n)(u.issues.map(c=>to(c,i,eo())));throw _S(l,a?.callee),l}return u.value},Vm=n=>async(t,e,r,a)=>{const i=r?Object.assign(r,{async:!0}):{async:!0};let u=t._zod.run({value:e,issues:[]},i);if(u instanceof Promise&&(u=await u),u.issues.length){const l=new(a?.Err??n)(u.issues.map(c=>to(c,i,eo())));throw _S(l,a?.callee),l}return u.value},Jf=n=>(t,e,r)=>{const a=r?{...r,async:!1}:{async:!1},i=t._zod.run({value:e,issues:[]},a);if(i instanceof Promise)throw new ss;return i.issues.length?{success:!1,error:new(n??AS)(i.issues.map(u=>to(u,a,eo())))}:{success:!0,data:i.value}},Nk=Jf(TS),eh=n=>async(t,e,r)=>{const a=r?Object.assign(r,{async:!0}):{async:!0};let i=t._zod.run({value:e,issues:[]},a);return i instanceof Promise&&(i=await i),i.issues.length?{success:!1,error:new n(i.issues.map(u=>to(u,a,eo())))}:{success:!0,data:i.value}},Mk=eh(TS),Ik=n=>(t,e,r)=>{const a=r?Object.assign(r,{direction:"backward"}):{direction:"backward"};return Hm(n)(t,e,a)},Fk=n=>(t,e,r)=>Hm(n)(t,e,r),Bk=n=>async(t,e,r)=>{const a=r?Object.assign(r,{direction:"backward"}):{direction:"backward"};return Vm(n)(t,e,a)},Pk=n=>async(t,e,r)=>Vm(n)(t,e,r),Lk=n=>(t,e,r)=>{const a=r?Object.assign(r,{direction:"backward"}):{direction:"backward"};return Jf(n)(t,e,a)},zk=n=>(t,e,r)=>Jf(n)(t,e,r),Uk=n=>async(t,e,r)=>{const a=r?Object.assign(r,{direction:"backward"}):{direction:"backward"};return eh(n)(t,e,a)},Hk=n=>async(t,e,r)=>eh(n)(t,e,r),Vk=/^[cC][^\s-]{8,}$/,Wk=/^[0-9a-z]+$/,Gk=/^[0-9A-HJKMNP-TV-Za-hjkmnp-tv-z]{26}$/,jk=/^[0-9a-vA-V]{20}$/,qk=/^[A-Za-z0-9]{27}$/,$k=/^[a-zA-Z0-9_-]{21}$/,Kk=/^P(?:(\d+W)|(?!.*W)(?=\d|T\d)(\d+Y)?(\d+M)?(\d+D)?(T(?=\d)(\d+H)?(\d+M)?(\d+([.,]\d+)?S)?)?)$/,Xk=/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12})$/,Xx=n=>n?new RegExp(`^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-${n}[0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12})$`):/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-8][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}|00000000-0000-0000-0000-000000000000|ffffffff-ffff-ffff-ffff-ffffffffffff)$/,Zk=/^(?!\.)(?!.*\.\.)([A-Za-z0-9_'+\-\.]*)[A-Za-z0-9_+-]@([A-Za-z0-9][A-Za-z0-9\-]*\.)+[A-Za-z]{2,}$/,Yk="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";function Qk(){return new RegExp(Yk,"u")}const Jk=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,e3=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|::|([0-9a-fA-F]{1,4})?::([0-9a-fA-F]{1,4}:?){0,6})$/,t3=/^((25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/([0-9]|[1-2][0-9]|3[0-2])$/,n3=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|::|([0-9a-fA-F]{1,4})?::([0-9a-fA-F]{1,4}:?){0,6})\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,r3=/^$|^(?:[0-9a-zA-Z+/]{4})*(?:(?:[0-9a-zA-Z+/]{2}==)|(?:[0-9a-zA-Z+/]{3}=))?$/,DS=/^[A-Za-z0-9_-]*$/,a3=/^(?=.{1,253}\.?$)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[-0-9a-zA-Z]{0,61}[0-9a-zA-Z])?)*\.?$/,i3=/^\+(?:[0-9]){6,14}[0-9]$/,OS="(?:(?:\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-(?:(?:0[13578]|1[02])-(?:0[1-9]|[12]\\d|3[01])|(?:0[469]|11)-(?:0[1-9]|[12]\\d|30)|(?:02)-(?:0[1-9]|1\\d|2[0-8])))",o3=new RegExp(`^${OS}$`);function kS(n){const t="(?:[01]\\d|2[0-3]):[0-5]\\d";return typeof n.precision=="number"?n.precision===-1?`${t}`:n.precision===0?`${t}:[0-5]\\d`:`${t}:[0-5]\\d\\.\\d{${n.precision}}`:`${t}(?::[0-5]\\d(?:\\.\\d+)?)?`}function s3(n){return new RegExp(`^${kS(n)}$`)}function u3(n){const t=kS({precision:n.precision}),e=["Z"];n.local&&e.push(""),n.offset&&e.push("([+-](?:[01]\\d|2[0-3]):[0-5]\\d)");const r=`${t}(?:${e.join("|")})`;return new RegExp(`^${OS}T(?:${r})$`)}const l3=n=>{const t=n?`[\\s\\S]{${n?.minimum??0},${n?.maximum??""}}`:"[\\s\\S]*";return new RegExp(`^${t}$`)},c3=/^[^A-Z]*$/,f3=/^[^a-z]*$/,Qr=pe("$ZodCheck",(n,t)=>{var e;n._zod??(n._zod={}),n._zod.def=t,(e=n._zod).onattach??(e.onattach=[])}),h3=pe("$ZodCheckMaxLength",(n,t)=>{var e;Qr.init(n,t),(e=n._zod.def).when??(e.when=r=>{const a=r.value;return!Pm(a)&&a.length!==void 0}),n._zod.onattach.push(r=>{const a=r._zod.bag.maximum??Number.POSITIVE_INFINITY;t.maximum<a&&(r._zod.bag.maximum=t.maximum)}),n._zod.check=r=>{const a=r.value;if(a.length<=t.maximum)return;const u=Um(a);r.issues.push({origin:u,code:"too_big",maximum:t.maximum,inclusive:!0,input:a,inst:n,continue:!t.abort})}}),d3=pe("$ZodCheckMinLength",(n,t)=>{var e;Qr.init(n,t),(e=n._zod.def).when??(e.when=r=>{const a=r.value;return!Pm(a)&&a.length!==void 0}),n._zod.onattach.push(r=>{const a=r._zod.bag.minimum??Number.NEGATIVE_INFINITY;t.minimum>a&&(r._zod.bag.minimum=t.minimum)}),n._zod.check=r=>{const a=r.value;if(a.length>=t.minimum)return;const u=Um(a);r.issues.push({origin:u,code:"too_small",minimum:t.minimum,inclusive:!0,input:a,inst:n,continue:!t.abort})}}),p3=pe("$ZodCheckLengthEquals",(n,t)=>{var e;Qr.init(n,t),(e=n._zod.def).when??(e.when=r=>{const a=r.value;return!Pm(a)&&a.length!==void 0}),n._zod.onattach.push(r=>{const a=r._zod.bag;a.minimum=t.length,a.maximum=t.length,a.length=t.length}),n._zod.check=r=>{const a=r.value,i=a.length;if(i===t.length)return;const u=Um(a),l=i>t.length;r.issues.push({origin:u,...l?{code:"too_big",maximum:t.length}:{code:"too_small",minimum:t.length},inclusive:!0,exact:!0,input:r.value,inst:n,continue:!t.abort})}}),th=pe("$ZodCheckStringFormat",(n,t)=>{var e,r;Qr.init(n,t),n._zod.onattach.push(a=>{const i=a._zod.bag;i.format=t.format,t.pattern&&(i.patterns??(i.patterns=new Set),i.patterns.add(t.pattern))}),t.pattern?(e=n._zod).check??(e.check=a=>{t.pattern.lastIndex=0,!t.pattern.test(a.value)&&a.issues.push({origin:"string",code:"invalid_format",format:t.format,input:a.value,...t.pattern?{pattern:t.pattern.toString()}:{},inst:n,continue:!t.abort})}):(r=n._zod).check??(r.check=()=>{})}),v3=pe("$ZodCheckRegex",(n,t)=>{th.init(n,t),n._zod.check=e=>{t.pattern.lastIndex=0,!t.pattern.test(e.value)&&e.issues.push({origin:"string",code:"invalid_format",format:"regex",input:e.value,pattern:t.pattern.toString(),inst:n,continue:!t.abort})}}),m3=pe("$ZodCheckLowerCase",(n,t)=>{t.pattern??(t.pattern=c3),th.init(n,t)}),g3=pe("$ZodCheckUpperCase",(n,t)=>{t.pattern??(t.pattern=f3),th.init(n,t)}),y3=pe("$ZodCheckIncludes",(n,t)=>{Qr.init(n,t);const e=zm(t.includes),r=new RegExp(typeof t.position=="number"?`^.{${t.position}}${e}`:e);t.pattern=r,n._zod.onattach.push(a=>{const i=a._zod.bag;i.patterns??(i.patterns=new Set),i.patterns.add(r)}),n._zod.check=a=>{a.value.includes(t.includes,t.position)||a.issues.push({origin:"string",code:"invalid_format",format:"includes",includes:t.includes,input:a.value,inst:n,continue:!t.abort})}}),b3=pe("$ZodCheckStartsWith",(n,t)=>{Qr.init(n,t);const e=new RegExp(`^${zm(t.prefix)}.*`);t.pattern??(t.pattern=e),n._zod.onattach.push(r=>{const a=r._zod.bag;a.patterns??(a.patterns=new Set),a.patterns.add(e)}),n._zod.check=r=>{r.value.startsWith(t.prefix)||r.issues.push({origin:"string",code:"invalid_format",format:"starts_with",prefix:t.prefix,input:r.value,inst:n,continue:!t.abort})}}),x3=pe("$ZodCheckEndsWith",(n,t)=>{Qr.init(n,t);const e=new RegExp(`.*${zm(t.suffix)}$`);t.pattern??(t.pattern=e),n._zod.onattach.push(r=>{const a=r._zod.bag;a.patterns??(a.patterns=new Set),a.patterns.add(e)}),n._zod.check=r=>{r.value.endsWith(t.suffix)||r.issues.push({origin:"string",code:"invalid_format",format:"ends_with",suffix:t.suffix,input:r.value,inst:n,continue:!t.abort})}}),w3=pe("$ZodCheckOverwrite",(n,t)=>{Qr.init(n,t),n._zod.check=e=>{e.value=t.tx(e.value)}}),S3={major:4,minor:1,patch:5},Rn=pe("$ZodType",(n,t)=>{var e;n??(n={}),n._zod.def=t,n._zod.bag=n._zod.bag||{},n._zod.version=S3;const r=[...n._zod.def.checks??[]];n._zod.traits.has("$ZodCheck")&&r.unshift(n);for(const a of r)for(const i of a._zod.onattach)i(n);if(r.length===0)(e=n._zod).deferred??(e.deferred=[]),n._zod.deferred?.push(()=>{n._zod.run=n._zod.parse});else{const a=(u,l,c)=>{let f=os(u),d;for(const v of l){if(v._zod.def.when){if(!v._zod.def.when(u))continue}else if(f)continue;const m=u.issues.length,g=v._zod.check(u);if(g instanceof Promise&&c?.async===!1)throw new ss;if(d||g instanceof Promise)d=(d??Promise.resolve()).then(async()=>{await g,u.issues.length!==m&&(f||(f=os(u,m)))});else{if(u.issues.length===m)continue;f||(f=os(u,m))}}return d?d.then(()=>u):u},i=(u,l,c)=>{if(os(u))return u.aborted=!0,u;const f=a(l,r,c);if(f instanceof Promise){if(c.async===!1)throw new ss;return f.then(d=>n._zod.parse(d,c))}return n._zod.parse(f,c)};n._zod.run=(u,l)=>{if(l.skipChecks)return n._zod.parse(u,l);if(l.direction==="backward"){const f=n._zod.parse({value:u.value,issues:[]},{...l,skipChecks:!0});return f instanceof Promise?f.then(d=>i(d,u,l)):i(f,u,l)}const c=n._zod.parse(u,l);if(c instanceof Promise){if(l.async===!1)throw new ss;return c.then(f=>a(f,r,l))}return a(c,r,l)}}n["~standard"]={validate:a=>{try{const i=Nk(n,a);return i.success?{value:i.data}:{issues:i.error?.issues}}catch{return Mk(n,a).then(u=>u.success?{value:u.data}:{issues:u.error?.issues})}},vendor:"zod",version:1}}),Wm=pe("$ZodString",(n,t)=>{Rn.init(n,t),n._zod.pattern=[...n?._zod.bag?.patterns??[]].pop()??l3(n._zod.bag),n._zod.parse=(e,r)=>{if(t.coerce)try{e.value=String(e.value)}catch{}return typeof e.value=="string"||e.issues.push({expected:"string",code:"invalid_type",input:e.value,inst:n}),e}}),bt=pe("$ZodStringFormat",(n,t)=>{th.init(n,t),Wm.init(n,t)}),E3=pe("$ZodGUID",(n,t)=>{t.pattern??(t.pattern=Xk),bt.init(n,t)}),_3=pe("$ZodUUID",(n,t)=>{if(t.version){const r={v1:1,v2:2,v3:3,v4:4,v5:5,v6:6,v7:7,v8:8}[t.version];if(r===void 0)throw new Error(`Invalid UUID version: "${t.version}"`);t.pattern??(t.pattern=Xx(r))}else t.pattern??(t.pattern=Xx());bt.init(n,t)}),C3=pe("$ZodEmail",(n,t)=>{t.pattern??(t.pattern=Zk),bt.init(n,t)}),R3=pe("$ZodURL",(n,t)=>{bt.init(n,t),n._zod.check=e=>{try{const r=e.value.trim(),a=new URL(r);t.hostname&&(t.hostname.lastIndex=0,t.hostname.test(a.hostname)||e.issues.push({code:"invalid_format",format:"url",note:"Invalid hostname",pattern:a3.source,input:e.value,inst:n,continue:!t.abort})),t.protocol&&(t.protocol.lastIndex=0,t.protocol.test(a.protocol.endsWith(":")?a.protocol.slice(0,-1):a.protocol)||e.issues.push({code:"invalid_format",format:"url",note:"Invalid protocol",pattern:t.protocol.source,input:e.value,inst:n,continue:!t.abort})),t.normalize?e.value=a.href:e.value=r;return}catch{e.issues.push({code:"invalid_format",format:"url",input:e.value,inst:n,continue:!t.abort})}}}),A3=pe("$ZodEmoji",(n,t)=>{t.pattern??(t.pattern=Qk()),bt.init(n,t)}),T3=pe("$ZodNanoID",(n,t)=>{t.pattern??(t.pattern=$k),bt.init(n,t)}),D3=pe("$ZodCUID",(n,t)=>{t.pattern??(t.pattern=Vk),bt.init(n,t)}),O3=pe("$ZodCUID2",(n,t)=>{t.pattern??(t.pattern=Wk),bt.init(n,t)}),k3=pe("$ZodULID",(n,t)=>{t.pattern??(t.pattern=Gk),bt.init(n,t)}),N3=pe("$ZodXID",(n,t)=>{t.pattern??(t.pattern=jk),bt.init(n,t)}),M3=pe("$ZodKSUID",(n,t)=>{t.pattern??(t.pattern=qk),bt.init(n,t)}),I3=pe("$ZodISODateTime",(n,t)=>{t.pattern??(t.pattern=u3(t)),bt.init(n,t)}),F3=pe("$ZodISODate",(n,t)=>{t.pattern??(t.pattern=o3),bt.init(n,t)}),B3=pe("$ZodISOTime",(n,t)=>{t.pattern??(t.pattern=s3(t)),bt.init(n,t)}),P3=pe("$ZodISODuration",(n,t)=>{t.pattern??(t.pattern=Kk),bt.init(n,t)}),L3=pe("$ZodIPv4",(n,t)=>{t.pattern??(t.pattern=Jk),bt.init(n,t),n._zod.onattach.push(e=>{const r=e._zod.bag;r.format="ipv4"})}),z3=pe("$ZodIPv6",(n,t)=>{t.pattern??(t.pattern=e3),bt.init(n,t),n._zod.onattach.push(e=>{const r=e._zod.bag;r.format="ipv6"}),n._zod.check=e=>{try{new URL(`http://[${e.value}]`)}catch{e.issues.push({code:"invalid_format",format:"ipv6",input:e.value,inst:n,continue:!t.abort})}}}),U3=pe("$ZodCIDRv4",(n,t)=>{t.pattern??(t.pattern=t3),bt.init(n,t)}),H3=pe("$ZodCIDRv6",(n,t)=>{t.pattern??(t.pattern=n3),bt.init(n,t),n._zod.check=e=>{const[r,a]=e.value.split("/");try{if(!a)throw new Error;const i=Number(a);if(`${i}`!==a)throw new Error;if(i<0||i>128)throw new Error;new URL(`http://[${r}]`)}catch{e.issues.push({code:"invalid_format",format:"cidrv6",input:e.value,inst:n,continue:!t.abort})}}});function NS(n){if(n==="")return!0;if(n.length%4!==0)return!1;try{return atob(n),!0}catch{return!1}}const V3=pe("$ZodBase64",(n,t)=>{t.pattern??(t.pattern=r3),bt.init(n,t),n._zod.onattach.push(e=>{e._zod.bag.contentEncoding="base64"}),n._zod.check=e=>{NS(e.value)||e.issues.push({code:"invalid_format",format:"base64",input:e.value,inst:n,continue:!t.abort})}});function W3(n){if(!DS.test(n))return!1;const t=n.replace(/[-_]/g,r=>r==="-"?"+":"/"),e=t.padEnd(Math.ceil(t.length/4)*4,"=");return NS(e)}const G3=pe("$ZodBase64URL",(n,t)=>{t.pattern??(t.pattern=DS),bt.init(n,t),n._zod.onattach.push(e=>{e._zod.bag.contentEncoding="base64url"}),n._zod.check=e=>{W3(e.value)||e.issues.push({code:"invalid_format",format:"base64url",input:e.value,inst:n,continue:!t.abort})}}),j3=pe("$ZodE164",(n,t)=>{t.pattern??(t.pattern=i3),bt.init(n,t)});function q3(n,t=null){try{const e=n.split(".");if(e.length!==3)return!1;const[r]=e;if(!r)return!1;const a=JSON.parse(atob(r));return!("typ"in a&&a?.typ!=="JWT"||!a.alg||t&&(!("alg"in a)||a.alg!==t))}catch{return!1}}const $3=pe("$ZodJWT",(n,t)=>{bt.init(n,t),n._zod.check=e=>{q3(e.value,t.alg)||e.issues.push({code:"invalid_format",format:"jwt",input:e.value,inst:n,continue:!t.abort})}});function Zx(n,t,e){n.issues.length&&t.issues.push(...Dk(e,n.issues)),t.value[e]=n.value}const K3=pe("$ZodArray",(n,t)=>{Rn.init(n,t),n._zod.parse=(e,r)=>{const a=e.value;if(!Array.isArray(a))return e.issues.push({expected:"array",code:"invalid_type",input:a,inst:n}),e;e.value=Array(a.length);const i=[];for(let u=0;u<a.length;u++){const l=a[u],c=t.element._zod.run({value:l,issues:[]},r);c instanceof Promise?i.push(c.then(f=>Zx(f,e,u))):Zx(c,e,u)}return i.length?Promise.all(i).then(()=>e):e}});function Yx(n,t,e,r){for(const i of n)if(i.issues.length===0)return t.value=i.value,t;const a=n.filter(i=>!os(i));return a.length===1?(t.value=a[0].value,a[0]):(t.issues.push({code:"invalid_union",input:t.value,inst:e,errors:n.map(i=>i.issues.map(u=>to(u,r,eo())))}),t)}const X3=pe("$ZodUnion",(n,t)=>{Rn.init(n,t),yt(n._zod,"optin",()=>t.options.some(a=>a._zod.optin==="optional")?"optional":void 0),yt(n._zod,"optout",()=>t.options.some(a=>a._zod.optout==="optional")?"optional":void 0),yt(n._zod,"values",()=>{if(t.options.every(a=>a._zod.values))return new Set(t.options.flatMap(a=>Array.from(a._zod.values)))}),yt(n._zod,"pattern",()=>{if(t.options.every(a=>a._zod.pattern)){const a=t.options.map(i=>i._zod.pattern);return new RegExp(`^(${a.map(i=>Lm(i.source)).join("|")})$`)}});const e=t.options.length===1,r=t.options[0]._zod.run;n._zod.parse=(a,i)=>{if(e)return r(a,i);let u=!1;const l=[];for(const c of t.options){const f=c._zod.run({value:a.value,issues:[]},i);if(f instanceof Promise)l.push(f),u=!0;else{if(f.issues.length===0)return f;l.push(f)}}return u?Promise.all(l).then(c=>Yx(c,a,n,i)):Yx(l,a,n,i)}}),Z3=pe("$ZodIntersection",(n,t)=>{Rn.init(n,t),n._zod.parse=(e,r)=>{const a=e.value,i=t.left._zod.run({value:a,issues:[]},r),u=t.right._zod.run({value:a,issues:[]},r);return i instanceof Promise||u instanceof Promise?Promise.all([i,u]).then(([c,f])=>Qx(e,c,f)):Qx(e,i,u)}});function Zv(n,t){if(n===t)return{valid:!0,data:n};if(n instanceof Date&&t instanceof Date&&+n==+t)return{valid:!0,data:n};if(Xv(n)&&Xv(t)){const e=Object.keys(t),r=Object.keys(n).filter(i=>e.indexOf(i)!==-1),a={...n,...t};for(const i of r){const u=Zv(n[i],t[i]);if(!u.valid)return{valid:!1,mergeErrorPath:[i,...u.mergeErrorPath]};a[i]=u.data}return{valid:!0,data:a}}if(Array.isArray(n)&&Array.isArray(t)){if(n.length!==t.length)return{valid:!1,mergeErrorPath:[]};const e=[];for(let r=0;r<n.length;r++){const a=n[r],i=t[r],u=Zv(a,i);if(!u.valid)return{valid:!1,mergeErrorPath:[r,...u.mergeErrorPath]};e.push(u.data)}return{valid:!0,data:e}}return{valid:!1,mergeErrorPath:[]}}function Qx(n,t,e){if(t.issues.length&&n.issues.push(...t.issues),e.issues.length&&n.issues.push(...e.issues),os(n))return n;const r=Zv(t.value,e.value);if(!r.valid)throw new Error(`Unmergable intersection. Error path: ${JSON.stringify(r.mergeErrorPath)}`);return n.value=r.data,n}const Y3=pe("$ZodTransform",(n,t)=>{Rn.init(n,t),n._zod.parse=(e,r)=>{if(r.direction==="backward")throw new ES(n.constructor.name);const a=t.transform(e.value,e);if(r.async)return(a instanceof Promise?a:Promise.resolve(a)).then(u=>(e.value=u,e));if(a instanceof Promise)throw new ss;return e.value=a,e}});function Jx(n,t){return n.issues.length&&t===void 0?{issues:[],value:void 0}:n}const Q3=pe("$ZodOptional",(n,t)=>{Rn.init(n,t),n._zod.optin="optional",n._zod.optout="optional",yt(n._zod,"values",()=>t.innerType._zod.values?new Set([...t.innerType._zod.values,void 0]):void 0),yt(n._zod,"pattern",()=>{const e=t.innerType._zod.pattern;return e?new RegExp(`^(${Lm(e.source)})?$`):void 0}),n._zod.parse=(e,r)=>{if(t.innerType._zod.optin==="optional"){const a=t.innerType._zod.run(e,r);return a instanceof Promise?a.then(i=>Jx(i,e.value)):Jx(a,e.value)}return e.value===void 0?e:t.innerType._zod.run(e,r)}}),J3=pe("$ZodNullable",(n,t)=>{Rn.init(n,t),yt(n._zod,"optin",()=>t.innerType._zod.optin),yt(n._zod,"optout",()=>t.innerType._zod.optout),yt(n._zod,"pattern",()=>{const e=t.innerType._zod.pattern;return e?new RegExp(`^(${Lm(e.source)}|null)$`):void 0}),yt(n._zod,"values",()=>t.innerType._zod.values?new Set([...t.innerType._zod.values,null]):void 0),n._zod.parse=(e,r)=>e.value===null?e:t.innerType._zod.run(e,r)}),eN=pe("$ZodDefault",(n,t)=>{Rn.init(n,t),n._zod.optin="optional",yt(n._zod,"values",()=>t.innerType._zod.values),n._zod.parse=(e,r)=>{if(r.direction==="backward")return t.innerType._zod.run(e,r);if(e.value===void 0)return e.value=t.defaultValue,e;const a=t.innerType._zod.run(e,r);return a instanceof Promise?a.then(i=>ew(i,t)):ew(a,t)}});function ew(n,t){return n.value===void 0&&(n.value=t.defaultValue),n}const tN=pe("$ZodPrefault",(n,t)=>{Rn.init(n,t),n._zod.optin="optional",yt(n._zod,"values",()=>t.innerType._zod.values),n._zod.parse=(e,r)=>(r.direction==="backward"||e.value===void 0&&(e.value=t.defaultValue),t.innerType._zod.run(e,r))}),nN=pe("$ZodNonOptional",(n,t)=>{Rn.init(n,t),yt(n._zod,"values",()=>{const e=t.innerType._zod.values;return e?new Set([...e].filter(r=>r!==void 0)):void 0}),n._zod.parse=(e,r)=>{const a=t.innerType._zod.run(e,r);return a instanceof Promise?a.then(i=>tw(i,n)):tw(a,n)}});function tw(n,t){return!n.issues.length&&n.value===void 0&&n.issues.push({code:"invalid_type",expected:"nonoptional",input:n.value,inst:t}),n}const rN=pe("$ZodCatch",(n,t)=>{Rn.init(n,t),yt(n._zod,"optin",()=>t.innerType._zod.optin),yt(n._zod,"optout",()=>t.innerType._zod.optout),yt(n._zod,"values",()=>t.innerType._zod.values),n._zod.parse=(e,r)=>{if(r.direction==="backward")return t.innerType._zod.run(e,r);const a=t.innerType._zod.run(e,r);return a instanceof Promise?a.then(i=>(e.value=i.value,i.issues.length&&(e.value=t.catchValue({...e,error:{issues:i.issues.map(u=>to(u,r,eo()))},input:e.value}),e.issues=[]),e)):(e.value=a.value,a.issues.length&&(e.value=t.catchValue({...e,error:{issues:a.issues.map(i=>to(i,r,eo()))},input:e.value}),e.issues=[]),e)}}),aN=pe("$ZodPipe",(n,t)=>{Rn.init(n,t),yt(n._zod,"values",()=>t.in._zod.values),yt(n._zod,"optin",()=>t.in._zod.optin),yt(n._zod,"optout",()=>t.out._zod.optout),yt(n._zod,"propValues",()=>t.in._zod.propValues),n._zod.parse=(e,r)=>{if(r.direction==="backward"){const i=t.out._zod.run(e,r);return i instanceof Promise?i.then(u=>Pc(u,t.in,r)):Pc(i,t.in,r)}const a=t.in._zod.run(e,r);return a instanceof Promise?a.then(i=>Pc(i,t.out,r)):Pc(a,t.out,r)}});function Pc(n,t,e){return n.issues.length?(n.aborted=!0,n):t._zod.run({value:n.value,issues:n.issues},e)}const iN=pe("$ZodReadonly",(n,t)=>{Rn.init(n,t),yt(n._zod,"propValues",()=>t.innerType._zod.propValues),yt(n._zod,"values",()=>t.innerType._zod.values),yt(n._zod,"optin",()=>t.innerType._zod.optin),yt(n._zod,"optout",()=>t.innerType._zod.optout),n._zod.parse=(e,r)=>{if(r.direction==="backward")return t.innerType._zod.run(e,r);const a=t.innerType._zod.run(e,r);return a instanceof Promise?a.then(nw):nw(a)}});function nw(n){return n.value=Object.freeze(n.value),n}const oN=pe("$ZodCustom",(n,t)=>{Qr.init(n,t),Rn.init(n,t),n._zod.parse=(e,r)=>e,n._zod.check=e=>{const r=e.value,a=t.fn(r);if(a instanceof Promise)return a.then(i=>rw(i,e,r,n));rw(a,e,r,n)}});function rw(n,t,e,r){if(!n){const a={code:"custom",input:e,inst:r,path:[...r._zod.def.path??[]],continue:!r._zod.def.abort};r._zod.def.params&&(a.params=r._zod.def.params),t.issues.push($u(a))}}class sN{constructor(){this._map=new Map,this._idmap=new Map}add(t,...e){const r=e[0];if(this._map.set(t,r),r&&typeof r=="object"&&"id"in r){if(this._idmap.has(r.id))throw new Error(`ID ${r.id} already exists in the registry`);this._idmap.set(r.id,t)}return this}clear(){return this._map=new Map,this._idmap=new Map,this}remove(t){const e=this._map.get(t);return e&&typeof e=="object"&&"id"in e&&this._idmap.delete(e.id),this._map.delete(t),this}get(t){const e=t._zod.parent;if(e){const r={...this.get(e)??{}};delete r.id;const a={...r,...this._map.get(t)};return Object.keys(a).length?a:void 0}return this._map.get(t)}has(t){return this._map.has(t)}}function uN(){return new sN}const Lc=uN();function lN(n,t){return new n({type:"string",...He(t)})}function cN(n,t){return new n({type:"string",format:"email",check:"string_format",abort:!1,...He(t)})}function aw(n,t){return new n({type:"string",format:"guid",check:"string_format",abort:!1,...He(t)})}function fN(n,t){return new n({type:"string",format:"uuid",check:"string_format",abort:!1,...He(t)})}function hN(n,t){return new n({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v4",...He(t)})}function dN(n,t){return new n({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v6",...He(t)})}function pN(n,t){return new n({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v7",...He(t)})}function vN(n,t){return new n({type:"string",format:"url",check:"string_format",abort:!1,...He(t)})}function mN(n,t){return new n({type:"string",format:"emoji",check:"string_format",abort:!1,...He(t)})}function gN(n,t){return new n({type:"string",format:"nanoid",check:"string_format",abort:!1,...He(t)})}function yN(n,t){return new n({type:"string",format:"cuid",check:"string_format",abort:!1,...He(t)})}function bN(n,t){return new n({type:"string",format:"cuid2",check:"string_format",abort:!1,...He(t)})}function xN(n,t){return new n({type:"string",format:"ulid",check:"string_format",abort:!1,...He(t)})}function wN(n,t){return new n({type:"string",format:"xid",check:"string_format",abort:!1,...He(t)})}function SN(n,t){return new n({type:"string",format:"ksuid",check:"string_format",abort:!1,...He(t)})}function EN(n,t){return new n({type:"string",format:"ipv4",check:"string_format",abort:!1,...He(t)})}function _N(n,t){return new n({type:"string",format:"ipv6",check:"string_format",abort:!1,...He(t)})}function CN(n,t){return new n({type:"string",format:"cidrv4",check:"string_format",abort:!1,...He(t)})}function RN(n,t){return new n({type:"string",format:"cidrv6",check:"string_format",abort:!1,...He(t)})}function AN(n,t){return new n({type:"string",format:"base64",check:"string_format",abort:!1,...He(t)})}function TN(n,t){return new n({type:"string",format:"base64url",check:"string_format",abort:!1,...He(t)})}function DN(n,t){return new n({type:"string",format:"e164",check:"string_format",abort:!1,...He(t)})}function ON(n,t){return new n({type:"string",format:"jwt",check:"string_format",abort:!1,...He(t)})}function kN(n,t){return new n({type:"string",format:"datetime",check:"string_format",offset:!1,local:!1,precision:null,...He(t)})}function NN(n,t){return new n({type:"string",format:"date",check:"string_format",...He(t)})}function MN(n,t){return new n({type:"string",format:"time",check:"string_format",precision:null,...He(t)})}function IN(n,t){return new n({type:"string",format:"duration",check:"string_format",...He(t)})}function MS(n,t){return new h3({check:"max_length",...He(t),maximum:n})}function wf(n,t){return new d3({check:"min_length",...He(t),minimum:n})}function IS(n,t){return new p3({check:"length_equals",...He(t),length:n})}function FN(n,t){return new v3({check:"string_format",format:"regex",...He(t),pattern:n})}function BN(n){return new m3({check:"string_format",format:"lowercase",...He(n)})}function PN(n){return new g3({check:"string_format",format:"uppercase",...He(n)})}function LN(n,t){return new y3({check:"string_format",format:"includes",...He(t),includes:n})}function zN(n,t){return new b3({check:"string_format",format:"starts_with",...He(t),prefix:n})}function UN(n,t){return new x3({check:"string_format",format:"ends_with",...He(t),suffix:n})}function sl(n){return new w3({check:"overwrite",tx:n})}function HN(n){return sl(t=>t.normalize(n))}function VN(){return sl(n=>n.trim())}function WN(){return sl(n=>n.toLowerCase())}function GN(){return sl(n=>n.toUpperCase())}function jN(n,t,e){return new n({type:"array",element:t,...He(e)})}function qN(n,t,e){return new n({type:"custom",check:"custom",fn:t,...He(e)})}function $N(n){const t=KN(e=>(e.addIssue=r=>{if(typeof r=="string")e.issues.push($u(r,e.value,t._zod.def));else{const a=r;a.fatal&&(a.continue=!1),a.code??(a.code="custom"),a.input??(a.input=e.value),a.inst??(a.inst=t),a.continue??(a.continue=!t._zod.def.abort),e.issues.push($u(a))}},n(e.value,e)));return t}function KN(n,t){const e=new Qr({check:"custom",...He(t)});return e._zod.check=n,e}const XN=pe("ZodISODateTime",(n,t)=>{I3.init(n,t),Ct.init(n,t)});function ZN(n){return kN(XN,n)}const YN=pe("ZodISODate",(n,t)=>{F3.init(n,t),Ct.init(n,t)});function QN(n){return NN(YN,n)}const JN=pe("ZodISOTime",(n,t)=>{B3.init(n,t),Ct.init(n,t)});function e4(n){return MN(JN,n)}const t4=pe("ZodISODuration",(n,t)=>{P3.init(n,t),Ct.init(n,t)});function n4(n){return IN(t4,n)}const r4=(n,t)=>{AS.init(n,t),n.name="ZodError",Object.defineProperties(n,{format:{value:e=>kk(n,e)},flatten:{value:e=>Ok(n,e)},addIssue:{value:e=>{n.issues.push(e),n.message=JSON.stringify(n.issues,Kv,2)}},addIssues:{value:e=>{n.issues.push(...e),n.message=JSON.stringify(n.issues,Kv,2)}},isEmpty:{get(){return n.issues.length===0}}})},gr=pe("ZodError",r4,{Parent:Error}),a4=Hm(gr),i4=Vm(gr),o4=Jf(gr),s4=eh(gr),u4=Ik(gr),l4=Fk(gr),c4=Bk(gr),f4=Pk(gr),h4=Lk(gr),d4=zk(gr),p4=Uk(gr),v4=Hk(gr),Ln=pe("ZodType",(n,t)=>(Rn.init(n,t),n.def=t,n.type=t.type,Object.defineProperty(n,"_def",{value:t}),n.check=(...e)=>n.clone({...t,checks:[...t.checks??[],...e.map(r=>typeof r=="function"?{_zod:{check:r,def:{check:"custom"},onattach:[]}}:r)]}),n.clone=(e,r)=>Tk(n,e,r),n.brand=()=>n,n.register=(e,r)=>(e.add(n,r),n),n.parse=(e,r)=>a4(n,e,r,{callee:n.parse}),n.safeParse=(e,r)=>o4(n,e,r),n.parseAsync=async(e,r)=>i4(n,e,r,{callee:n.parseAsync}),n.safeParseAsync=async(e,r)=>s4(n,e,r),n.spa=n.safeParseAsync,n.encode=(e,r)=>u4(n,e,r),n.decode=(e,r)=>l4(n,e,r),n.encodeAsync=async(e,r)=>c4(n,e,r),n.decodeAsync=async(e,r)=>f4(n,e,r),n.safeEncode=(e,r)=>h4(n,e,r),n.safeDecode=(e,r)=>d4(n,e,r),n.safeEncodeAsync=async(e,r)=>p4(n,e,r),n.safeDecodeAsync=async(e,r)=>v4(n,e,r),n.refine=(e,r)=>n.check(nM(e,r)),n.superRefine=e=>n.check(rM(e)),n.overwrite=e=>n.check(sl(e)),n.optional=()=>ow(n),n.nullable=()=>sw(n),n.nullish=()=>ow(sw(n)),n.nonoptional=e=>X4(n,e),n.array=()=>F4(n),n.or=e=>P4([n,e]),n.and=e=>z4(n,e),n.transform=e=>uw(n,H4(e)),n.default=e=>j4(n,e),n.prefault=e=>$4(n,e),n.catch=e=>Y4(n,e),n.pipe=e=>uw(n,e),n.readonly=()=>eM(n),n.describe=e=>{const r=n.clone();return Lc.add(r,{description:e}),r},Object.defineProperty(n,"description",{get(){return Lc.get(n)?.description},configurable:!0}),n.meta=(...e)=>{if(e.length===0)return Lc.get(n);const r=n.clone();return Lc.add(r,e[0]),r},n.isOptional=()=>n.safeParse(void 0).success,n.isNullable=()=>n.safeParse(null).success,n)),FS=pe("_ZodString",(n,t)=>{Wm.init(n,t),Ln.init(n,t);const e=n._zod.bag;n.format=e.format??null,n.minLength=e.minimum??null,n.maxLength=e.maximum??null,n.regex=(...r)=>n.check(FN(...r)),n.includes=(...r)=>n.check(LN(...r)),n.startsWith=(...r)=>n.check(zN(...r)),n.endsWith=(...r)=>n.check(UN(...r)),n.min=(...r)=>n.check(wf(...r)),n.max=(...r)=>n.check(MS(...r)),n.length=(...r)=>n.check(IS(...r)),n.nonempty=(...r)=>n.check(wf(1,...r)),n.lowercase=r=>n.check(BN(r)),n.uppercase=r=>n.check(PN(r)),n.trim=()=>n.check(VN()),n.normalize=(...r)=>n.check(HN(...r)),n.toLowerCase=()=>n.check(WN()),n.toUpperCase=()=>n.check(GN())}),m4=pe("ZodString",(n,t)=>{Wm.init(n,t),FS.init(n,t),n.email=e=>n.check(cN(g4,e)),n.url=e=>n.check(vN(y4,e)),n.jwt=e=>n.check(ON(M4,e)),n.emoji=e=>n.check(mN(b4,e)),n.guid=e=>n.check(aw(iw,e)),n.uuid=e=>n.check(fN(zc,e)),n.uuidv4=e=>n.check(hN(zc,e)),n.uuidv6=e=>n.check(dN(zc,e)),n.uuidv7=e=>n.check(pN(zc,e)),n.nanoid=e=>n.check(gN(x4,e)),n.guid=e=>n.check(aw(iw,e)),n.cuid=e=>n.check(yN(w4,e)),n.cuid2=e=>n.check(bN(S4,e)),n.ulid=e=>n.check(xN(E4,e)),n.base64=e=>n.check(AN(O4,e)),n.base64url=e=>n.check(TN(k4,e)),n.xid=e=>n.check(wN(_4,e)),n.ksuid=e=>n.check(SN(C4,e)),n.ipv4=e=>n.check(EN(R4,e)),n.ipv6=e=>n.check(_N(A4,e)),n.cidrv4=e=>n.check(CN(T4,e)),n.cidrv6=e=>n.check(RN(D4,e)),n.e164=e=>n.check(DN(N4,e)),n.datetime=e=>n.check(ZN(e)),n.date=e=>n.check(QN(e)),n.time=e=>n.check(e4(e)),n.duration=e=>n.check(n4(e))});function X6(n){return lN(m4,n)}const Ct=pe("ZodStringFormat",(n,t)=>{bt.init(n,t),FS.init(n,t)}),g4=pe("ZodEmail",(n,t)=>{C3.init(n,t),Ct.init(n,t)}),iw=pe("ZodGUID",(n,t)=>{E3.init(n,t),Ct.init(n,t)}),zc=pe("ZodUUID",(n,t)=>{_3.init(n,t),Ct.init(n,t)}),y4=pe("ZodURL",(n,t)=>{R3.init(n,t),Ct.init(n,t)}),b4=pe("ZodEmoji",(n,t)=>{A3.init(n,t),Ct.init(n,t)}),x4=pe("ZodNanoID",(n,t)=>{T3.init(n,t),Ct.init(n,t)}),w4=pe("ZodCUID",(n,t)=>{D3.init(n,t),Ct.init(n,t)}),S4=pe("ZodCUID2",(n,t)=>{O3.init(n,t),Ct.init(n,t)}),E4=pe("ZodULID",(n,t)=>{k3.init(n,t),Ct.init(n,t)}),_4=pe("ZodXID",(n,t)=>{N3.init(n,t),Ct.init(n,t)}),C4=pe("ZodKSUID",(n,t)=>{M3.init(n,t),Ct.init(n,t)}),R4=pe("ZodIPv4",(n,t)=>{L3.init(n,t),Ct.init(n,t)}),A4=pe("ZodIPv6",(n,t)=>{z3.init(n,t),Ct.init(n,t)}),T4=pe("ZodCIDRv4",(n,t)=>{U3.init(n,t),Ct.init(n,t)}),D4=pe("ZodCIDRv6",(n,t)=>{H3.init(n,t),Ct.init(n,t)}),O4=pe("ZodBase64",(n,t)=>{V3.init(n,t),Ct.init(n,t)}),k4=pe("ZodBase64URL",(n,t)=>{G3.init(n,t),Ct.init(n,t)}),N4=pe("ZodE164",(n,t)=>{j3.init(n,t),Ct.init(n,t)}),M4=pe("ZodJWT",(n,t)=>{$3.init(n,t),Ct.init(n,t)}),I4=pe("ZodArray",(n,t)=>{K3.init(n,t),Ln.init(n,t),n.element=t.element,n.min=(e,r)=>n.check(wf(e,r)),n.nonempty=e=>n.check(wf(1,e)),n.max=(e,r)=>n.check(MS(e,r)),n.length=(e,r)=>n.check(IS(e,r)),n.unwrap=()=>n.element});function F4(n,t){return jN(I4,n,t)}const B4=pe("ZodUnion",(n,t)=>{X3.init(n,t),Ln.init(n,t),n.options=t.options});function P4(n,t){return new B4({type:"union",options:n,...He(t)})}const L4=pe("ZodIntersection",(n,t)=>{Z3.init(n,t),Ln.init(n,t)});function z4(n,t){return new L4({type:"intersection",left:n,right:t})}const U4=pe("ZodTransform",(n,t)=>{Y3.init(n,t),Ln.init(n,t),n._zod.parse=(e,r)=>{if(r.direction==="backward")throw new ES(n.constructor.name);e.addIssue=i=>{if(typeof i=="string")e.issues.push($u(i,e.value,t));else{const u=i;u.fatal&&(u.continue=!1),u.code??(u.code="custom"),u.input??(u.input=e.value),u.inst??(u.inst=n),e.issues.push($u(u))}};const a=t.transform(e.value,e);return a instanceof Promise?a.then(i=>(e.value=i,e)):(e.value=a,e)}});function H4(n){return new U4({type:"transform",transform:n})}const V4=pe("ZodOptional",(n,t)=>{Q3.init(n,t),Ln.init(n,t),n.unwrap=()=>n._zod.def.innerType});function ow(n){return new V4({type:"optional",innerType:n})}const W4=pe("ZodNullable",(n,t)=>{J3.init(n,t),Ln.init(n,t),n.unwrap=()=>n._zod.def.innerType});function sw(n){return new W4({type:"nullable",innerType:n})}const G4=pe("ZodDefault",(n,t)=>{eN.init(n,t),Ln.init(n,t),n.unwrap=()=>n._zod.def.innerType,n.removeDefault=n.unwrap});function j4(n,t){return new G4({type:"default",innerType:n,get defaultValue(){return typeof t=="function"?t():CS(t)}})}const q4=pe("ZodPrefault",(n,t)=>{tN.init(n,t),Ln.init(n,t),n.unwrap=()=>n._zod.def.innerType});function $4(n,t){return new q4({type:"prefault",innerType:n,get defaultValue(){return typeof t=="function"?t():CS(t)}})}const K4=pe("ZodNonOptional",(n,t)=>{nN.init(n,t),Ln.init(n,t),n.unwrap=()=>n._zod.def.innerType});function X4(n,t){return new K4({type:"nonoptional",innerType:n,...He(t)})}const Z4=pe("ZodCatch",(n,t)=>{rN.init(n,t),Ln.init(n,t),n.unwrap=()=>n._zod.def.innerType,n.removeCatch=n.unwrap});function Y4(n,t){return new Z4({type:"catch",innerType:n,catchValue:typeof t=="function"?t:()=>t})}const Q4=pe("ZodPipe",(n,t)=>{aN.init(n,t),Ln.init(n,t),n.in=t.in,n.out=t.out});function uw(n,t){return new Q4({type:"pipe",in:n,out:t})}const J4=pe("ZodReadonly",(n,t)=>{iN.init(n,t),Ln.init(n,t),n.unwrap=()=>n._zod.def.innerType});function eM(n){return new J4({type:"readonly",innerType:n})}const tM=pe("ZodCustom",(n,t)=>{oN.init(n,t),Ln.init(n,t)});function nM(n,t={}){return qN(tM,n,t)}function rM(n){return $N(n)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var BS=function(n,t){return(BS=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var a in r)r.hasOwnProperty(a)&&(e[a]=r[a])})(n,t)};function Dr(n,t){function e(){this.constructor=n}BS(n,t),n.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}function we(n,t,e,r){return new(e||(e=Promise))(function(a,i){function u(f){try{c(r.next(f))}catch(d){i(d)}}function l(f){try{c(r.throw(f))}catch(d){i(d)}}function c(f){f.done?a(f.value):new e(function(d){d(f.value)}).then(u,l)}c((r=r.apply(n,[])).next())})}function Se(n,t){var e,r,a,i,u={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},typeof Symbol=="function"&&(i[Symbol.iterator]=function(){return this}),i;function l(c){return function(f){return function(d){if(e)throw new TypeError("Generator is already executing.");for(;u;)try{if(e=1,r&&(a=2&d[0]?r.return:d[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,d[1])).done)return a;switch(r=0,a&&(d=[2&d[0],a.value]),d[0]){case 0:case 1:a=d;break;case 4:return u.label++,{value:d[1],done:!1};case 5:u.label++,r=d[1],d=[0];continue;case 7:d=u.ops.pop(),u.trys.pop();continue;default:if(!(a=(a=u.trys).length>0&&a[a.length-1])&&(d[0]===6||d[0]===2)){u=0;continue}if(d[0]===3&&(!a||d[1]>a[0]&&d[1]<a[3])){u.label=d[1];break}if(d[0]===6&&u.label<a[1]){u.label=a[1],a=d;break}if(a&&u.label<a[2]){u.label=a[2],u.ops.push(d);break}a[2]&&u.ops.pop(),u.trys.pop();continue}d=t.call(n,u)}catch(v){d=[6,v],r=0}finally{e=a=0}if(5&d[0])throw d[1];return{value:d[0]?d[1]:void 0,done:!0}}([c,f])}}}var aM=function(){function n(t){this.global=t,this.flags={},this.flagRegistry={},this.urlFlags={},this.populateURLFlags()}return n.prototype.setPlatform=function(t,e){this.platform!=null&&console.warn("Platform "+this.platformName+" has already been set. Overwriting the platform with "+e+"."),this.platformName=t,this.platform=e},n.prototype.registerFlag=function(t,e,r){if(this.flagRegistry[t]={evaluationFn:e,setHook:r},this.urlFlags[t]!=null){var a=this.urlFlags[t];console.warn("Setting feature override from URL "+t+": "+a+"."),this.set(t,a)}},n.prototype.get=function(t){return t in this.flags?this.flags[t]:(this.flags[t]=this.evaluateFlag(t),this.flags[t])},n.prototype.getNumber=function(t){return this.get(t)},n.prototype.getBool=function(t){return this.get(t)},n.prototype.getFlags=function(){return this.flags},Object.defineProperty(n.prototype,"features",{get:function(){return this.flags},enumerable:!0,configurable:!0}),n.prototype.set=function(t,e){if(this.flagRegistry[t]==null)throw new Error("Cannot set flag "+t+" as it has not been registered.");this.flags[t]=e,this.flagRegistry[t].setHook!=null&&this.flagRegistry[t].setHook(e)},n.prototype.evaluateFlag=function(t){if(this.flagRegistry[t]==null)throw new Error("Cannot evaluate flag '"+t+"': no evaluation function found.");return this.flagRegistry[t].evaluationFn()},n.prototype.setFlags=function(t){this.flags=Object.assign({},t)},n.prototype.reset=function(){this.flags={},this.urlFlags={},this.populateURLFlags()},n.prototype.populateURLFlags=function(){var t=this;if(this.global!==void 0&&this.global.location!==void 0&&this.global.location.search!==void 0){var e,r,a=(e=this.global.location.search,r={},e.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,function(i){for(var u=[],l=1;l<arguments.length;l++)u[l-1]=arguments[l];return iM(r,u[0],u[1]),u.join("=")}),r);"tfjsflags"in a&&a.tfjsflags.split(",").forEach(function(i){var u=i.split(":"),l=u[0],c=u[1];t.urlFlags[l]=function(f,d){if((d=d.toLowerCase())==="true"||d==="false")return d==="true";if(""+ +d===d)return+d;throw new Error("Could not parse value flag value "+d+" for flag "+f+".")}(l,c)})}},n}();function iM(n,t,e){n[decodeURIComponent(t)]=decodeURIComponent(e||"")}function ue(){return PS}var PS=null,Sf=new Map,Yv=new Map;function LS(n,t){var e=US(n,t);return Sf.get(e)}function oM(n){return Yv.get(n)}function lw(n){for(var t=Sf.entries(),e=[];;){var r=t.next(),a=r.done,i=r.value;if(a)break;var u=i[0],l=i[1];u.split("_")[0]===n&&e.push(l)}return e}function zS(n){var t=n.kernelName,e=n.backendName,r=US(t,e);if(Sf.has(r))throw new Error("The kernel '"+t+"' for backend '"+e+"' is already registered");Sf.set(r,n)}function sM(n){var t=n.kernelName;Yv.has(t)&&console.warn("Overriding the gradient for '"+t+"'"),Yv.set(t,n)}function US(n,t){return t+"_"+n}function Qv(n,t,e){return Math.max(n,Math.min(t,e))}function HS(n){return n%2==0?n:n+1}function uM(n){for(var t=0,e=0;e<n.length;e++)t+=n[e];return t}function P(n,t){if(!n)throw new Error(typeof t=="string"?t:t())}function at(n,t,e){e===void 0&&(e=""),P(nn(n,t),function(){return e+" Shapes "+n+" and "+t+" must match"})}function Ds(n){P(n!=null,function(){return"The input to the tensor constructor must be a non-null value."})}function ws(n,t,e){if(t===void 0&&(t=[]),e===void 0&&(e=!1),t==null&&(t=[]),Array.isArray(n)||qr(n)&&!e)for(var r=0;r<n.length;++r)ws(n[r],t,e);else t.push(n);return t}function Ee(n){if(n.length===0)return 1;for(var t=n[0],e=1;e<n.length;e++)t*=n[e];return t}function nn(n,t){if(n===t)return!0;if(n==null||t==null||n.length!==t.length)return!1;for(var e=0;e<n.length;e++)if(n[e]!==t[e])return!1;return!0}function Nt(n){return n%1==0}function lM(n){if(Math.tanh!=null)return Math.tanh(n);if(n===1/0)return 1;if(n===-1/0)return-1;var t=Math.exp(2*n);return(t-1)/(t+1)}function Jv(n){var t=Math.ceil(Math.sqrt(n));return[t,Math.ceil(n/t)]}function us(n,t){return t<=n.length?n:n+" ".repeat(t-n.length)}function cw(n,t,e){return t===void 0&&(t=function(r){return 0}),new Promise(function(r,a){var i=0,u=function(){if(n())r();else{i++;var l=t(i);e!=null&&i>=e?a():setTimeout(u,l)}};u()})}function cM(n,t){for(var e=1,r=-1,a=0;a<n.length;++a)if(n[a]>=0)e*=n[a];else if(n[a]===-1){if(r!==-1)throw Error("Shapes can only have 1 implicit size. Found -1 at dim "+r+" and dim "+a);r=a}else if(n[a]<0)throw Error("Shapes can not be < 0. Found "+n[a]+" at dim "+a);if(r===-1){if(t>0&&t!==e)throw Error("Size("+t+") must match the product of shape "+n);return n}if(e===0)throw Error("Cannot infer the missing size in ["+n+"] when there are 0 elements");if(t%e!=0)throw Error("The implicit shape can't be a fractional number. Got "+t+" / "+e);var i=n.slice();return i[r]=t/e,i}function Kt(n,t){var e=t.length;return P((n=n==null?t.map(function(r,a){return a}):[].concat(n)).every(function(r){return r>=-e&&r<e}),function(){return"All values in axis param must be in range [-"+e+", "+e+") but got axis "+n}),P(n.every(function(r){return Nt(r)}),function(){return"All values in axis param must be integers but got axis "+n}),n.map(function(r){return r<0?e+r:r})}function Wi(n,t){for(var e=[],r=[],a=t!=null&&Array.isArray(t)&&t.length===0,i=t==null||a?null:Kt(t,n).sort(),u=0,l=0;l<n.length;++l){if(i!=null){if(i[u]===l&&n[l]!==1)throw new Error("Can't squeeze axis "+l+" since its dim '"+n[l]+"' is not 1");(i[u]==null||i[u]>l)&&n[l]===1&&(e.push(n[l]),r.push(l)),i[u]<=l&&u++}n[l]!==1&&(e.push(n[l]),r.push(l))}return{newShape:e,keptDims:r}}function Ku(n,t){var e=null;if(n==null||n==="float32")e=new Float32Array(t);else if(n==="int32")e=new Int32Array(t);else{if(n!=="bool")throw new Error("Unknown data type "+n);e=new Uint8Array(t)}return e}function Ef(n,t){var e=null;if(n==null||n==="float32")e=new Float32Array(t);else if(n==="int32")e=new Int32Array(t);else if(n==="bool")e=new Uint8Array(t);else{if(n!=="string")throw new Error("Unknown data type "+n);e=new Array(t)}return e}function fM(n,t){for(var e=0;e<n.length;e++){var r=n[e];if(isNaN(r)||!isFinite(r))throw Error("A tensor of type "+t+" being uploaded contains "+r+".")}}function hM(n){return n==="bool"||n==="complex64"||n==="float32"||n==="int32"||n==="string"}function dM(n,t){return t!=="complex64"&&(t!=="float32"||n==="complex64")&&(t!=="int32"||n==="float32"||n==="complex64")&&(t!=="bool"||n!=="bool")}function qr(n){return n instanceof Float32Array||n instanceof Int32Array||n instanceof Uint8Array}function VS(n){if(n==="float32"||n==="int32")return 4;if(n==="complex64")return 8;if(n==="bool")return 1;throw new Error("Unknown dtype "+n)}function pM(n){if(n==null)return 0;var t=0;return n.forEach(function(e){return t+=e.length}),t}function Gm(n){return typeof n=="string"||n instanceof String}function vM(n){return typeof n=="boolean"}function mM(n){return typeof n=="number"}function ul(n){return Array.isArray(n)?ul(n[0]):n instanceof Float32Array?"float32":n instanceof Int32Array||n instanceof Uint8Array?"int32":mM(n)?"float32":Gm(n)?"string":vM(n)?"bool":"float32"}function em(n){return!!(n&&n.constructor&&n.call&&n.apply)}function tm(n,t){for(var e=t;e<n;++e)if(n%e==0)return e;return n}function $r(n){var t=n.length;if(t<2)return[];var e=new Array(t-1);e[t-2]=n[t-1];for(var r=t-3;r>=0;--r)e[r]=e[r+1]*n[r+1];return e}function WS(n,t,e){if(t==="string")throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(n)&&(n=ws(n)),e&&fM(n,t),function(i,u){return i instanceof Float32Array&&u==="float32"||i instanceof Int32Array&&u==="int32"||i instanceof Uint8Array&&u==="bool"}(n,t))return n;if(t==null||t==="float32"||t==="complex64")return new Float32Array(n);if(t==="int32")return new Int32Array(n);if(t==="bool"){for(var r=new Uint8Array(n.length),a=0;a<r.length;++a)Math.round(n[a])!==0&&(r[a]=1);return r}throw new Error("Unknown data type "+t)}function fw(n,t){if(n.length===0)return t[0];var e=n.reduce(function(r,a){return r*a});if(e===0)return[];if(e!==t.length)throw new Error("["+n+"] does not match the input size.");return function r(a,i,u){var l=new Array;if(i.length===1)for(var c=i[0],f=0;f<c;f++)l[f]=u[a+f];else{c=i[0];var d=i.slice(1),v=d.reduce(function(m,g){return m*g});for(f=0;f<c;f++)l[f]=r(a+f*v,d,u)}return l}(0,n,t)}function GS(n,t){for(var e=ll(n,t),r=0;r<e.length;r++)e[r]=1;return e}function ll(n,t){if(t==null||t==="float32"||t==="complex64")return new Float32Array(n);if(t==="int32")return new Int32Array(n);if(t==="bool")return new Uint8Array(n);throw new Error("Unknown data type "+t)}function Hr(){return ue().platform.now()}function jS(n){n.forEach(function(t){P(Number.isInteger(t)&&t>=0,function(){return"Tensor must have a shape comprised of positive integers but got shape ["+n+"]."})})}function gM(n,t){return t===void 0&&(t="utf-8"),t=t||"utf-8",ue().platform.encode(n,t)}function _f(n,t){return t===void 0&&(t="utf-8"),t=t||"utf-8",ue().platform.decode(n,t)}function hw(n,t,e){if(t===0)return 0;if(t===1)return n[0];for(var r=n[n.length-1],a=0;a<n.length-1;++a)r+=e[a]*n[a];return r}function yM(n,t,e){if(t===0)return[];if(t===1)return[n];for(var r=new Array(t),a=0;a<r.length-1;++a)r[a]=Math.floor(n/e[a]),n-=r[a]*e[a];return r[r.length-1]=n,r}var bM=function(){function n(t,e){this.backendTimer=t,this.logger=e,e==null&&(this.logger=new xM)}return n.prototype.profileKernel=function(t,e,r){var a,i=this,u=this.backendTimer.time(function(){a=r()});return a.forEach(function(l){l.data().then(function(c){(function(f,d,v){if(d!=="float32")return!1;for(var m=0;m<f.length;m++){var g=f[m];if(isNaN(g)||!isFinite(g))return console.warn("Found "+g+" in the result of '"+v+"'"),!0}})(c,l.dtype,t),u.then(function(f){var d="";f.getExtraProfileInfo!=null&&(d=f.getExtraProfileInfo()),i.logger.logKernelProfile(t,l,c,f.kernelMs,e,d)})})}),a},n}(),xM=function(){function n(){}return n.prototype.logKernelProfile=function(t,e,r,a,i,u){var l=typeof a=="number"?us(a+"ms",9):a.error,c=us(t,25),f=e.rank,d=e.size,v=us(e.shape.toString(),14),m="";for(var g in i){var b=i[g].shape||e.shape,w=b.length;m+=g+": "+w+"D "+(w>0?b:"")+" "}console.log("%c"+c+"	%c"+l+"	%c"+f+"D "+v+"	%c"+d+"	%c"+m+"	%c"+u,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")},n}(),dw=20,ku=3,Yp=7;function wM(n,t,e,r){var a=$r(t),i=function(f,d,v,m){var g=Ee(d),b=m[m.length-1],w=new Array(b).fill(0),S=d.length,E=v==="complex64"?Mu(f):f;if(S>1)for(var _=0;_<g/b;_++)for(var R=_*b,C=0;C<b;C++)w[C]=Math.max(w[C],Nu(E[R+C],0,v).length);return w}(n,t,e,a),u=t.length,l=function f(d,v,m,g,b,w){w===void 0&&(w=!0);var S=m==="complex64"?2:1,E=v[0],_=v.length;if(_===0)return m==="complex64"?[Nu(Mu(d)[0],0,m)]:m==="bool"?[qS(d[0])]:[d[0].toString()];if(_===1){if(E>dw){var R=ku*S,C=Array.from(d.slice(0,R)),A=Array.from(d.slice((E-ku)*S,E*S));return m==="complex64"&&(C=Mu(C),A=Mu(A)),["["+C.map(function(te,L){return Nu(te,b[L],m)}).join(", ")+", ..., "+A.map(function(te,L){return Nu(te,b[E-ku+L],m)}).join(", ")+"]"]}return["["+(m==="complex64"?Mu(d):Array.from(d)).map(function(te,L){return Nu(te,b[L],m)}).join(", ")+"]"]}var D=v.slice(1),O=g.slice(1),F=g[0]*S,N=[];if(E>dw){for(var B=0;B<ku;B++){var H=(U=B*F)+F;N.push.apply(N,f(d.slice(U,H),D,m,O,b,!1))}for(N.push("..."),B=E-ku;B<E;B++)H=(U=B*F)+F,N.push.apply(N,f(d.slice(U,H),D,m,O,b,B===E-1))}else for(B=0;B<E;B++){var U;H=(U=B*F)+F,N.push.apply(N,f(d.slice(U,H),D,m,O,b,B===E-1))}var J=_===2?",":"";for(N[0]="["+N[0]+J,B=1;B<N.length-1;B++)N[B]=" "+N[B]+J;var ee=`,
`;for(B=2;B<_;B++)ee+=`
`;return N[N.length-1]=" "+N[N.length-1]+"]"+(w?"":ee),N}(n,t,e,a,i),c=["Tensor"];return r&&(c.push("  dtype: "+e),c.push("  rank: "+u),c.push("  shape: ["+t+"]"),c.push("  values:")),c.push(l.map(function(f){return"    "+f}).join(`
`)),c.join(`
`)}function Nu(n,t,e){return us(Array.isArray(n)?parseFloat(n[0].toFixed(Yp))+" + "+parseFloat(n[1].toFixed(Yp))+"j":Gm(n)?"'"+n+"'":e==="bool"?qS(n):parseFloat(n.toFixed(Yp)).toString(),t)}function qS(n){return n===0?"false":"true"}function Mu(n){for(var t=[],e=0;e<n.length;e+=2)t.push([n[e],n[e+1]]);return t}var Xu=function(){function n(t,e,r){var a=this;if(this.dtype=e,this.shape=t.slice(),this.size=Ee(t),r!=null){var i=r.length;P(i===this.size,function(){return"Length of values '"+i+"' does not match the size inferred by the shape '"+a.size+"'."})}if(e==="complex64")throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=r||Ef(e,this.size),this.strides=$r(t)}return n.prototype.set=function(t){for(var e=this,r=[],a=1;a<arguments.length;a++)r[a-1]=arguments[a];r.length===0&&(r=[0]),P(r.length===this.rank,function(){return"The number of provided coordinates ("+r.length+") must match the rank ("+e.rank+")"});var i=this.locToIndex(r);this.values[i]=t},n.prototype.get=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];t.length===0&&(t=[0]);for(var r=0,a=0,i=t;a<i.length;a++){var u=i[a];if(u<0||u>=this.shape[r]){var l="Requested out of range element at "+t+".   Buffer shape="+this.shape;throw new Error(l)}r++}for(var c=t[t.length-1],f=0;f<t.length-1;++f)c+=this.strides[f]*t[f];return this.values[c]},n.prototype.locToIndex=function(t){if(this.rank===0)return 0;if(this.rank===1)return t[0];for(var e=t[t.length-1],r=0;r<t.length-1;++r)e+=this.strides[r]*t[r];return e},n.prototype.indexToLoc=function(t){if(this.rank===0)return[];if(this.rank===1)return[t];for(var e=new Array(this.shape.length),r=0;r<e.length-1;++r)e[r]=Math.floor(t/this.strides[r]),t-=e[r]*this.strides[r];return e[e.length-1]=t,e},Object.defineProperty(n.prototype,"rank",{get:function(){return this.shape.length},enumerable:!0,configurable:!0}),n.prototype.toTensor=function(){return Vr().makeTensor(this.values,this.shape,this.dtype)},n}(),Vr=null,se=null,$S=null,wt=function(){function n(t,e,r,a){this.kept=!1,this.isDisposedInternal=!1,this.shape=t.slice(),this.dtype=e||"float32",this.size=Ee(t),this.strides=$r(t),this.dataId=r,this.id=a,this.rankType=this.rank<5?this.rank.toString():"higher"}return n.prototype.flatten=function(){return this.throwIfDisposed(),this.as1D()},n.prototype.asScalar=function(){return this.throwIfDisposed(),P(this.size===1,function(){return"The array must have only 1 element."}),this.reshape([])},n.prototype.as1D=function(){return this.throwIfDisposed(),this.reshape([this.size])},n.prototype.as2D=function(t,e){return this.throwIfDisposed(),this.reshape([t,e])},n.prototype.as3D=function(t,e,r){return this.throwIfDisposed(),this.reshape([t,e,r])},n.prototype.as4D=function(t,e,r,a){return this.throwIfDisposed(),this.reshape([t,e,r,a])},n.prototype.as5D=function(t,e,r,a,i){return this.throwIfDisposed(),this.reshape([t,e,r,a,i])},n.prototype.asType=function(t){return this.throwIfDisposed(),se.cast(this,t)},Object.defineProperty(n.prototype,"rank",{get:function(){return this.shape.length},enumerable:!0,configurable:!0}),n.prototype.buffer=function(){return we(this,void 0,void 0,function(){var t;return Se(this,function(e){switch(e.label){case 0:return[4,this.data()];case 1:return t=e.sent(),[2,se.buffer(this.shape,this.dtype,t)]}})})},n.prototype.bufferSync=function(){return se.buffer(this.shape,this.dtype,this.dataSync())},n.prototype.array=function(){return we(this,void 0,void 0,function(){var t;return Se(this,function(e){switch(e.label){case 0:return[4,this.data()];case 1:return t=e.sent(),[2,fw(this.shape,t)]}})})},n.prototype.arraySync=function(){return fw(this.shape,this.dataSync())},n.prototype.data=function(){return we(this,void 0,void 0,function(){var t,e;return Se(this,function(r){switch(r.label){case 0:return this.throwIfDisposed(),t=Vr().read(this.dataId),this.dtype!=="string"?[3,2]:[4,t];case 1:e=r.sent();try{return[2,e.map(function(a){return _f(a)})]}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}r.label=2;case 2:return[2,t]}})})},n.prototype.dataSync=function(){this.throwIfDisposed();var t=Vr().readSync(this.dataId);if(this.dtype==="string")try{return t.map(function(e){return _f(e)})}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return t},n.prototype.bytes=function(){return we(this,void 0,void 0,function(){var t;return Se(this,function(e){switch(e.label){case 0:return this.throwIfDisposed(),[4,Vr().read(this.dataId)];case 1:return t=e.sent(),this.dtype==="string"?[2,t]:[2,new Uint8Array(t.buffer)]}})})},n.prototype.dispose=function(){this.isDisposed||(Vr().disposeTensor(this),this.isDisposedInternal=!0)},Object.defineProperty(n.prototype,"isDisposed",{get:function(){return this.isDisposedInternal},enumerable:!0,configurable:!0}),n.prototype.throwIfDisposed=function(){if(this.isDisposed)throw new Error("Tensor is disposed.")},n.prototype.toFloat=function(){return this.asType("float32")},n.prototype.toInt=function(){return this.asType("int32")},n.prototype.toBool=function(){return this.asType("bool")},n.prototype.print=function(t){return t===void 0&&(t=!1),se.print(this,t)},n.prototype.reshape=function(t){return this.throwIfDisposed(),se.reshape(this,t)},n.prototype.reshapeAs=function(t){return this.throwIfDisposed(),this.reshape(t.shape)},n.prototype.expandDims=function(t){return t===void 0&&(t=0),se.expandDims(this,t)},n.prototype.cumsum=function(t,e,r){return t===void 0&&(t=0),e===void 0&&(e=!1),r===void 0&&(r=!1),se.cumsum(this,t,e,r)},n.prototype.squeeze=function(t){return this.throwIfDisposed(),se.squeeze(this,t)},n.prototype.clone=function(){return this.throwIfDisposed(),se.clone(this)},n.prototype.oneHot=function(t,e,r){return this.throwIfDisposed(),se.oneHot(this,t,e,r)},n.prototype.toString=function(t){return t===void 0&&(t=!1),wM(this.dataSync(),this.shape,this.dtype,t)},n.prototype.tile=function(t){return this.throwIfDisposed(),se.tile(this,t)},n.prototype.gather=function(t,e){return e===void 0&&(e=0),this.throwIfDisposed(),se.gather(this,t,e)},n.prototype.matMul=function(t,e,r){return e===void 0&&(e=!1),r===void 0&&(r=!1),this.throwIfDisposed(),se.matMul(this,t,e,r)},n.prototype.dot=function(t){return this.throwIfDisposed(),se.dot(this,t)},n.prototype.norm=function(t,e,r){return t===void 0&&(t="euclidean"),e===void 0&&(e=null),r===void 0&&(r=!1),this.throwIfDisposed(),se.norm(this,t,e,r)},n.prototype.slice=function(t,e){return this.throwIfDisposed(),se.slice(this,t,e)},n.prototype.reverse=function(t){return this.throwIfDisposed(),se.reverse(this,t)},n.prototype.concat=function(t,e){return e===void 0&&(e=0),this.throwIfDisposed(),t instanceof n&&(t=[t]),se.concat([this].concat(t),e)},n.prototype.split=function(t,e){return e===void 0&&(e=0),this.throwIfDisposed(),se.split(this,t,e)},n.prototype.stack=function(t,e){return e===void 0&&(e=0),se.stack([this,t],e)},n.prototype.unstack=function(t){return t===void 0&&(t=0),se.unstack(this,t)},n.prototype.pad=function(t,e){return e===void 0&&(e=0),se.pad(this,t,e)},n.prototype.batchNormalization=function(t,e,r,a,i){return r===void 0&&(r=.001),$S("tf.batchNormalization() is going away. Use tf.batchNorm() instead, and note the positional argument change of scale, offset, and varianceEpsilon"),this.batchNorm(t,e,i,a,r)},n.prototype.batchNorm=function(t,e,r,a,i){return i===void 0&&(i=.001),this.throwIfDisposed(),se.batchNorm(this,t,e,r,a,i)},n.prototype.all=function(t,e){return t===void 0&&(t=null),e===void 0&&(e=!1),this.throwIfDisposed(),se.all(this,t,e)},n.prototype.any=function(t,e){return t===void 0&&(t=null),e===void 0&&(e=!1),this.throwIfDisposed(),se.any(this,t,e)},n.prototype.logSumExp=function(t,e){return t===void 0&&(t=null),e===void 0&&(e=!1),this.throwIfDisposed(),se.logSumExp(this,t,e)},n.prototype.sum=function(t,e){return t===void 0&&(t=null),e===void 0&&(e=!1),this.throwIfDisposed(),se.sum(this,t,e)},n.prototype.prod=function(t,e){return t===void 0&&(t=null),e===void 0&&(e=!1),this.throwIfDisposed(),se.prod(this,t,e)},n.prototype.mean=function(t,e){return t===void 0&&(t=null),e===void 0&&(e=!1),this.throwIfDisposed(),se.mean(this,t,e)},n.prototype.min=function(t,e){return t===void 0&&(t=null),e===void 0&&(e=!1),this.throwIfDisposed(),se.min(this,t,e)},n.prototype.max=function(t,e){return t===void 0&&(t=null),e===void 0&&(e=!1),this.throwIfDisposed(),se.max(this,t,e)},n.prototype.argMin=function(t){return t===void 0&&(t=null),this.throwIfDisposed(),se.argMin(this,t)},n.prototype.argMax=function(t){return t===void 0&&(t=null),this.throwIfDisposed(),se.argMax(this,t)},n.prototype.cast=function(t){return this.throwIfDisposed(),se.cast(this,t)},n.prototype.add=function(t){return this.throwIfDisposed(),se.add(this,t)},n.prototype.addStrict=function(t){return this.throwIfDisposed(),se.addStrict(this,t)},n.prototype.atan2=function(t){return this.throwIfDisposed(),se.atan2(this,t)},n.prototype.sub=function(t){return this.throwIfDisposed(),se.sub(this,t)},n.prototype.subStrict=function(t){return this.throwIfDisposed(),se.subStrict(this,t)},n.prototype.pow=function(t){return this.throwIfDisposed(),se.pow(this,t)},n.prototype.powStrict=function(t){return this.throwIfDisposed(),se.powStrict(this,t)},n.prototype.mul=function(t){return this.throwIfDisposed(),se.mul(this,t)},n.prototype.mulStrict=function(t){return this.throwIfDisposed(),se.mulStrict(this,t)},n.prototype.div=function(t){return this.throwIfDisposed(),se.div(this,t)},n.prototype.divNoNan=function(t){return this.throwIfDisposed(),se.divNoNan(this,t)},n.prototype.floorDiv=function(t){return this.throwIfDisposed(),se.floorDiv(this,t)},n.prototype.divStrict=function(t){return this.throwIfDisposed(),se.divStrict(this,t)},n.prototype.minimum=function(t){return this.throwIfDisposed(),se.minimum(this,t)},n.prototype.minimumStrict=function(t){return this.throwIfDisposed(),se.minimumStrict(this,t)},n.prototype.maximum=function(t){return this.throwIfDisposed(),se.maximum(this,t)},n.prototype.maximumStrict=function(t){return this.throwIfDisposed(),se.maximumStrict(this,t)},n.prototype.mod=function(t){return this.throwIfDisposed(),se.mod(this,t)},n.prototype.modStrict=function(t){return this.throwIfDisposed(),se.modStrict(this,t)},n.prototype.squaredDifferenceStrict=function(t){return this.throwIfDisposed(),se.squaredDifferenceStrict(this,t)},n.prototype.transpose=function(t){return this.throwIfDisposed(),se.transpose(this,t)},n.prototype.notEqual=function(t){return this.throwIfDisposed(),se.notEqual(this,t)},n.prototype.notEqualStrict=function(t){return this.throwIfDisposed(),se.notEqualStrict(this,t)},n.prototype.less=function(t){return this.throwIfDisposed(),se.less(this,t)},n.prototype.lessStrict=function(t){return this.throwIfDisposed(),se.lessStrict(this,t)},n.prototype.equal=function(t){return this.throwIfDisposed(),se.equal(this,t)},n.prototype.equalStrict=function(t){return this.throwIfDisposed(),se.equalStrict(this,t)},n.prototype.lessEqual=function(t){return this.throwIfDisposed(),se.lessEqual(this,t)},n.prototype.lessEqualStrict=function(t){return this.throwIfDisposed(),se.lessEqualStrict(this,t)},n.prototype.greater=function(t){return this.throwIfDisposed(),se.greater(this,t)},n.prototype.greaterStrict=function(t){return this.throwIfDisposed(),se.greaterStrict(this,t)},n.prototype.greaterEqual=function(t){return this.throwIfDisposed(),se.greaterEqual(this,t)},n.prototype.greaterEqualStrict=function(t){return this.throwIfDisposed(),se.greaterEqualStrict(this,t)},n.prototype.logicalAnd=function(t){return this.throwIfDisposed(),se.logicalAnd(this,t)},n.prototype.logicalOr=function(t){return this.throwIfDisposed(),se.logicalOr(this,t)},n.prototype.logicalNot=function(){return this.throwIfDisposed(),se.logicalNot(this)},n.prototype.logicalXor=function(t){return this.throwIfDisposed(),se.logicalXor(this,t)},n.prototype.where=function(t,e){return this.throwIfDisposed(),se.where(t,this,e)},n.prototype.neg=function(){return this.throwIfDisposed(),se.neg(this)},n.prototype.ceil=function(){return this.throwIfDisposed(),se.ceil(this)},n.prototype.floor=function(){return this.throwIfDisposed(),se.floor(this)},n.prototype.sign=function(){return this.throwIfDisposed(),se.sign(this)},n.prototype.isNaN=function(){return this.throwIfDisposed(),se.isNaN(this)},n.prototype.isInf=function(){return this.throwIfDisposed(),se.isInf(this)},n.prototype.isFinite=function(){return this.throwIfDisposed(),se.isFinite(this)},n.prototype.exp=function(){return this.throwIfDisposed(),se.exp(this)},n.prototype.expm1=function(){return this.throwIfDisposed(),se.expm1(this)},n.prototype.log=function(){return this.throwIfDisposed(),se.log(this)},n.prototype.log1p=function(){return this.throwIfDisposed(),se.log1p(this)},n.prototype.sqrt=function(){return this.throwIfDisposed(),se.sqrt(this)},n.prototype.rsqrt=function(){return this.throwIfDisposed(),se.rsqrt(this)},n.prototype.square=function(){return this.throwIfDisposed(),se.square(this)},n.prototype.reciprocal=function(){return this.throwIfDisposed(),se.reciprocal(this)},n.prototype.abs=function(){return this.throwIfDisposed(),se.abs(this)},n.prototype.clipByValue=function(t,e){return this.throwIfDisposed(),se.clipByValue(this,t,e)},n.prototype.relu=function(){return this.throwIfDisposed(),se.relu(this)},n.prototype.relu6=function(){return this.throwIfDisposed(),se.relu6(this)},n.prototype.elu=function(){return this.throwIfDisposed(),se.elu(this)},n.prototype.selu=function(){return this.throwIfDisposed(),se.selu(this)},n.prototype.leakyRelu=function(t){return t===void 0&&(t=.2),this.throwIfDisposed(),se.leakyRelu(this,t)},n.prototype.prelu=function(t){return this.throwIfDisposed(),se.prelu(this,t)},n.prototype.sigmoid=function(){return this.throwIfDisposed(),se.sigmoid(this)},n.prototype.logSigmoid=function(){return this.throwIfDisposed(),se.logSigmoid(this)},n.prototype.softplus=function(){return this.throwIfDisposed(),se.softplus(this)},n.prototype.zerosLike=function(){return this.throwIfDisposed(),se.zerosLike(this)},n.prototype.onesLike=function(){return this.throwIfDisposed(),se.onesLike(this)},n.prototype.sin=function(){return this.throwIfDisposed(),se.sin(this)},n.prototype.cos=function(){return this.throwIfDisposed(),se.cos(this)},n.prototype.tan=function(){return this.throwIfDisposed(),se.tan(this)},n.prototype.asin=function(){return this.throwIfDisposed(),se.asin(this)},n.prototype.acos=function(){return this.throwIfDisposed(),se.acos(this)},n.prototype.atan=function(){return this.throwIfDisposed(),se.atan(this)},n.prototype.sinh=function(){return this.throwIfDisposed(),se.sinh(this)},n.prototype.cosh=function(){return this.throwIfDisposed(),se.cosh(this)},n.prototype.tanh=function(){return this.throwIfDisposed(),se.tanh(this)},n.prototype.asinh=function(){return this.throwIfDisposed(),se.asinh(this)},n.prototype.acosh=function(){return this.throwIfDisposed(),se.acosh(this)},n.prototype.atanh=function(){return this.throwIfDisposed(),se.atanh(this)},n.prototype.erf=function(){return this.throwIfDisposed(),se.erf(this)},n.prototype.round=function(){return this.throwIfDisposed(),se.round(this)},n.prototype.step=function(t){return t===void 0&&(t=0),this.throwIfDisposed(),se.step(this,t)},n.prototype.softmax=function(t){return t===void 0&&(t=-1),this.throwIfDisposed(),se.softmax(this,t)},n.prototype.logSoftmax=function(t){return t===void 0&&(t=-1),this.throwIfDisposed(),se.logSoftmax(this,t)},n.prototype.resizeBilinear=function(t,e){return e===void 0&&(e=!1),this.throwIfDisposed(),se.image.resizeBilinear(this,t,e)},n.prototype.resizeNearestNeighbor=function(t,e){return e===void 0&&(e=!1),this.throwIfDisposed(),se.image.resizeNearestNeighbor(this,t,e)},n.prototype.conv1d=function(t,e,r,a,i,u){return a===void 0&&(a="NWC"),i===void 0&&(i=1),this.throwIfDisposed(),se.conv1d(this,t,e,r,a,i,u)},n.prototype.conv2d=function(t,e,r,a,i,u){return a===void 0&&(a="NHWC"),i===void 0&&(i=[1,1]),this.throwIfDisposed(),se.conv2d(this,t,e,r,a,i,u)},n.prototype.conv2dTranspose=function(t,e,r,a,i){return this.throwIfDisposed(),se.conv2dTranspose(this,t,e,r,a,i)},n.prototype.depthwiseConv2D=function(t,e,r,a,i,u){return a===void 0&&(a="NHWC"),i===void 0&&(i=[1,1]),this.throwIfDisposed(),se.depthwiseConv2d(this,t,e,r,a,i,u)},n.prototype.separableConv2d=function(t,e,r,a,i,u){return i===void 0&&(i=[1,1]),u===void 0&&(u="NHWC"),this.throwIfDisposed(),se.separableConv2d(this,t,e,r,a,i,u)},n.prototype.avgPool=function(t,e,r,a){return this.throwIfDisposed(),se.avgPool(this,t,e,r,a)},n.prototype.maxPool=function(t,e,r,a){return this.throwIfDisposed(),se.maxPool(this,t,e,r,a)},n.prototype.localResponseNormalization=function(t,e,r,a){return t===void 0&&(t=5),e===void 0&&(e=1),r===void 0&&(r=1),a===void 0&&(a=.5),se.localResponseNormalization(this,t,e,r,a)},n.prototype.pool=function(t,e,r,a,i){return this.throwIfDisposed(),se.pool(this,t,e,r,a,i)},n.prototype.variable=function(t,e,r){return t===void 0&&(t=!0),this.throwIfDisposed(),Vr().makeVariable(this,t,e,r)},n.prototype.unsortedSegmentSum=function(t,e){return this.throwIfDisposed(),se.unsortedSegmentSum(this,t,e)},n.prototype.batchToSpaceND=function(t,e){return this.throwIfDisposed(),se.batchToSpaceND(this,t,e)},n.prototype.spaceToBatchND=function(t,e){return this.throwIfDisposed(),se.spaceToBatchND(this,t,e)},n.prototype.topk=function(t,e){return t===void 0&&(t=1),e===void 0&&(e=!0),this.throwIfDisposed(),se.topk(this,t,e)},n.prototype.stridedSlice=function(t,e,r,a,i,u,l,c){return a===void 0&&(a=0),i===void 0&&(i=0),u===void 0&&(u=0),l===void 0&&(l=0),c===void 0&&(c=0),this.throwIfDisposed(),se.stridedSlice(this,t,e,r,a,i,u,l,c)},n.prototype.depthToSpace=function(t,e){return this.throwIfDisposed(),se.depthToSpace(this,t,e)},n.prototype.fft=function(){return this.throwIfDisposed(),se.spectral.fft(this)},n.prototype.ifft=function(){return this.throwIfDisposed(),se.spectral.ifft(this)},n.prototype.rfft=function(){return this.throwIfDisposed(),se.spectral.rfft(this)},n.prototype.irfft=function(){return this.throwIfDisposed(),se.spectral.irfft(this)},n}();Object.defineProperty(wt,Symbol.hasInstance,{value:function(n){return!!n&&n.dataId!=null&&n.shape!=null&&n.dtype!=null}});var pw,nm,rm,am,im,Ss=function(n){function t(e,r,a,i){var u=n.call(this,e.shape,e.dtype,e.dataId,i)||this;return u.trainable=r,u.name=a,u}return Dr(t,n),t.prototype.assign=function(e){if(e.dtype!==this.dtype)throw new Error("dtype of the new value ("+e.dtype+") and previous value ("+this.dtype+") must match");if(!nn(e.shape,this.shape))throw new Error("shape of the new value ("+e.shape+") and previous value ("+this.shape+") must match");Vr().disposeTensor(this),this.dataId=e.dataId,Vr().incRef(this,null)},t.prototype.dispose=function(){Vr().disposeVariable(this),this.isDisposedInternal=!0},t}(wt);Object.defineProperty(Ss,Symbol.hasInstance,{value:function(n){return n instanceof wt&&n.assign!=null&&n.assign instanceof Function}}),function(n){n.R0="R0",n.R1="R1",n.R2="R2",n.R3="R3",n.R4="R4",n.R5="R5",n.R6="R6"}(pw||(pw={})),function(n){n.float32="float32",n.int32="int32",n.bool="int32",n.complex64="complex64"}(nm||(nm={})),function(n){n.float32="float32",n.int32="int32",n.bool="bool",n.complex64="complex64"}(rm||(rm={})),function(n){n.float32="float32",n.int32="float32",n.bool="float32",n.complex64="complex64"}(am||(am={})),function(n){n.float32="complex64",n.int32="complex64",n.bool="complex64",n.complex64="complex64"}(im||(im={}));var SM={float32:am,int32:nm,bool:rm,complex64:im};function cn(n,t){if(n==="string"||t==="string"){if(n==="string"&&t==="string")return"string";throw new Error("Can not upcast "+n+" with "+t)}return SM[n][t]}function Qp(n){return cn(n,"int32")}function _t(n,t){if(n.dtype===t.dtype)return[n,t];var e=cn(n.dtype,t.dtype);return[n.cast(e),t.cast(e)]}function EM(n,t){P(n.dtype===t.dtype,function(){return"The dtypes of the first("+n.dtype+") and second("+t.dtype+") input must match"})}function KS(n){var t=[];return function e(r,a,i){if(r!=null){if(r instanceof wt)return void a.push(r);if(u=r,!(!Array.isArray(u)&&typeof u!="object")){var u,l=r;for(var c in l){var f=l[c];i.has(f)||(i.add(f),e(f,a,i))}}}}(n,t,new Set),t}var Jp,vw=function(){function n(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null}}return n.prototype.dispose=function(){for(var t in this.registeredVariables)this.registeredVariables[t].dispose()},n}(),_M=function(){function n(t){this.ENV=t,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new vw}return n.prototype.ready=function(){return we(this,void 0,void 0,function(){var t,e,r;return Se(this,function(a){switch(a.label){case 0:if(this.pendingBackendInit!=null)return[2,this.pendingBackendInit.then(function(){})];if(this.backendInstance!=null)return[2];t=this.getSortedBackends(),e=0,a.label=1;case 1:return e<t.length?(r=t[e],[4,this.initializeBackend(r).success]):[3,5];case 2:return a.sent()?[4,this.setBackend(r)]:[3,4];case 3:return a.sent(),[2];case 4:return e++,[3,1];case 5:throw new Error("Could not initialize any backends, all backend initializations failed.")}})})},Object.defineProperty(n.prototype,"backend",{get:function(){if(this.pendingBackendInit!=null)throw new Error("Backend '"+this.backendName+"' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods");if(this.backendInstance==null){var t=this.initializeBackendsAndReturnBest(),e=t.name;if(t.asyncInit)throw new Error("The highest priority backend '"+e+"' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods");this.setBackend(e)}return this.backendInstance},enumerable:!0,configurable:!0}),n.prototype.backendNames=function(){return Object.keys(this.registryFactory)},n.prototype.findBackend=function(t){return!(t in this.registry)&&(!(t in this.registryFactory)||this.initializeBackend(t).asyncInit)?null:this.registry[t]},n.prototype.findBackendFactory=function(t){return t in this.registryFactory?this.registryFactory[t].factory:null},n.prototype.registerBackend=function(t,e,r){return r===void 0&&(r=1),t in this.registryFactory?(console.warn(t+" backend was already registered. Reusing existing backend factory."),!1):(this.registryFactory[t]={factory:e,priority:r},!0)},n.prototype.setBackend=function(t){return we(this,void 0,void 0,function(){var e,r,a;return Se(this,function(i){switch(i.label){case 0:if(this.registryFactory[t]==null)throw new Error("Backend name '"+t+"' not found in registry");return this.backendName=t,this.registry[t]!=null?[3,4]:(this.backendInstance=null,e=this.initializeBackend(t),r=e.success,e.asyncInit?[4,r]:[3,2]);case 1:return a=i.sent(),[3,3];case 2:a=r,i.label=3;case 3:if(!a)return[2,!1];i.label=4;case 4:return this.backendInstance=this.registry[t],this.setupRegisteredKernels(),this.profiler=new bM(this.backendInstance),[2,!0]}})})},n.prototype.setupRegisteredKernels=function(){var t=this;lw(this.backendName).forEach(function(e){e.setupFunc!=null&&e.setupFunc(t.backendInstance)})},n.prototype.disposeRegisteredKernels=function(t){var e=this;lw(t).forEach(function(r){r.disposeFunc!=null&&r.disposeFunc(e.registry[t])})},n.prototype.initializeBackend=function(t){var e=this,r=this.registryFactory[t];if(r==null)throw new Error("Cannot initialize backend "+t+", no registration found.");try{var a=r.factory();if(Promise.resolve(a)===a){var i=++this.pendingBackendInitId,u=a.then(function(l){return!(i<e.pendingBackendInitId)&&(e.registry[t]=l,e.pendingBackendInit=null,!0)}).catch(function(l){return!(i<e.pendingBackendInitId)&&(e.pendingBackendInit=null,console.warn("Initialization of backend "+t+" failed"),console.warn(l.stack||l.message),!1)});return this.pendingBackendInit=u,{success:u,asyncInit:!0}}return this.registry[t]=a,{success:!0,asyncInit:!1}}catch(l){return console.warn("Initialization of backend "+t+" failed"),console.warn(l.stack||l.message),{success:!1,asyncInit:!1}}},n.prototype.removeBackend=function(t){if(!(t in this.registryFactory))throw new Error(t+" backend not found in registry");this.backendName===t&&this.pendingBackendInit!=null&&this.pendingBackendInitId++,t in this.registry&&(this.disposeRegisteredKernels(t),this.registry[t].dispose(),delete this.registry[t]),delete this.registryFactory[t],this.backendName===t&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)},n.prototype.getSortedBackends=function(){var t=this;if(Object.keys(this.registryFactory).length===0)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort(function(e,r){return t.registryFactory[r].priority-t.registryFactory[e].priority})},n.prototype.initializeBackendsAndReturnBest=function(){for(var t=this.getSortedBackends(),e=0;e<t.length;e++){var r=t[e],a=this.initializeBackend(r),i=a.success,u=a.asyncInit;if(u||i)return{name:r,asyncInit:u}}throw new Error("Could not initialize any backends, all backend initializations failed.")},n.prototype.moveData=function(t,e){var r=this.state.tensorInfo.get(e),a=r.backend,i=this.readSync(e);a.disposeData(e),r.backend=t,t.move(e,i,r.shape,r.dtype),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++},n.prototype.tidy=function(t,e){var r,a=this,i=null;if(e==null){if(typeof t!="function")throw new Error("Please provide a function to tidy()");e=t}else{if(typeof t!="string"&&!(t instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if(typeof e!="function")throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");i=t}return this.scopedRun(function(){return a.startScope(i)},function(){return a.endScope(r)},function(){return(r=e())instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),r})},n.prototype.scopedRun=function(t,e,r){t();try{var a=r();return e(),a}catch(i){throw e(),i}},n.prototype.nextTensorId=function(){return n.nextTensorId++},n.prototype.nextVariableId=function(){return n.nextVariableId++},n.prototype.clone=function(t){var e=this.makeTensorFromDataId(t.dataId,t.shape,t.dtype),r={x:t};return this.addTapeNode(this.state.activeScope.name,r,[e],function(a){return{x:function(){return a.toFloat()}}},[]),e},n.prototype.runKernel=function(t,e,r,a,i){return this.runKernelFunc(null,e,null,t,r,a,i)},n.prototype.shouldCheckForMemLeaks=function(){return this.ENV.getBool("IS_TEST")},n.prototype.checkKernelForMemLeak=function(t,e,r){var a=this.backend.numDataIds(),i=0;r.forEach(function(c){i+=c.dtype==="complex64"?3:1});var u=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],l=a-e-i-u;if(l>0)throw new Error("Backend '"+this.backendName+"' has an internal memory leak ("+l+" data ids) after running '"+t+"'")},n.prototype.runKernelFunc=function(t,e,r,a,i,u,l){var c,f=this;u===void 0&&(u=[]),l===void 0&&(l=[]);var d=[],v=this.isTapeOn();a==null&&(a=this.state.activeScope!=null?this.state.activeScope.name:"");var m,g=function(_){v&&(d=_.map(function(R){return f.keep(f.clone(R))}))},b=this.state.numBytes,w=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0);var S,E=LS(a,this.backendName);return m=E!=null?function(){var _=f.backend.numDataIds();S=E.kernelFunc({inputs:e,attrs:i,backend:f.backend});var R=Array.isArray(S)?S:[S];f.shouldCheckForMemLeaks()&&f.checkKernelForMemLeak(a,_,R);var C=R.map(function(D){var O=D.dataId,F=D.shape,N=D.dtype;return f.makeTensorFromDataId(O,F,N)}),A=C.filter(function(D,O){return l[O]});return g((u||[]).slice().concat(A)),C}:function(){var _=f.backend.numDataIds();S=f.tidy(function(){return t(f.backend,g)});var R=Array.isArray(S)?S:[S];return f.shouldCheckForMemLeaks()&&f.checkKernelForMemLeak(a,_,R),R},this.scopedRun(function(){return f.state.kernelDepth++},function(){return f.state.kernelDepth--},function(){c=f.ENV.getBool("DEBUG")?f.profiler.profileKernel(a,e,function(){return m()}):m()}),v&&this.addTapeNode(a,e,c,r,d),this.state.profiling&&this.state.activeProfile.kernels.push({name:a,bytesAdded:this.state.numBytes-b,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-w,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(e).map(function(_){return e[_].shape}),outputShapes:c.map(function(_){return _.shape})}),Array.isArray(S)?c:c[0]},n.prototype.makeTensor=function(t,e,r,a){if(t==null)throw new Error("Values passed to engine.makeTensor() are null");r=r||"float32",a=a||this.backend;var i=t;r==="string"&&Gm(t[0])&&(i=t.map(function(d){return gM(d)}));var u=a.write(i,e,r),l=new wt(e,r,u,this.nextTensorId());if(this.incRef(l,a),r==="string"){var c=this.state.tensorInfo.get(u),f=pM(i);this.state.numBytes+=f-c.bytes,c.bytes=f}return l},n.prototype.makeTensorFromDataId=function(t,e,r,a){var i=new wt(e,r=r||"float32",t,this.nextTensorId());return this.incRef(i,a),i},n.prototype.makeVariable=function(t,e,r,a){e===void 0&&(e=!0),r=r||this.nextVariableId().toString(),a!=null&&a!==t.dtype&&(t=t.asType(a));var i=new Ss(t,e,r,this.nextTensorId());if(this.state.registeredVariables[i.name]!=null)throw new Error("Variable with name "+i.name+" was already registered");return this.state.registeredVariables[i.name]=i,this.incRef(i,this.backend),i},n.prototype.incRef=function(t,e){var r=this.state.tensorInfo.has(t.dataId)?this.state.tensorInfo.get(t.dataId).refCount:0;if(this.state.numTensors++,t.dtype==="string"&&this.state.numStringTensors++,r===0){this.state.numDataBuffers++;var a=0;t.dtype!=="complex64"&&t.dtype!=="string"&&(a=t.size*VS(t.dtype)),this.state.tensorInfo.set(t.dataId,{backend:e||this.backend,dtype:t.dtype,shape:t.shape,bytes:a,refCount:0}),this.state.numBytes+=a}this.state.tensorInfo.get(t.dataId).refCount++,t instanceof Ss||this.track(t)},n.prototype.disposeTensor=function(t){if(this.state.tensorInfo.has(t.dataId)){this.state.numTensors--,t.dtype==="string"&&this.state.numStringTensors--;var e=this.state.tensorInfo.get(t.dataId);e.refCount<=1?(t.dtype!=="complex64"&&(this.state.numBytes-=e.bytes),this.state.numDataBuffers--,e.backend.disposeData(t.dataId),this.state.tensorInfo.delete(t.dataId)):this.state.tensorInfo.get(t.dataId).refCount--}},n.prototype.disposeVariables=function(){for(var t in this.state.registeredVariables){var e=this.state.registeredVariables[t];this.disposeVariable(e)}},n.prototype.disposeVariable=function(t){this.disposeTensor(t),this.state.registeredVariables[t.name]!=null&&delete this.state.registeredVariables[t.name]},n.prototype.memory=function(){var t=this.backend.memory();return t.numTensors=this.state.numTensors,t.numDataBuffers=this.state.numDataBuffers,t.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(t.unreliable=!0,t.reasons==null&&(t.reasons=[]),t.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),t},n.prototype.profile=function(t){return we(this,void 0,void 0,function(){var e,r;return Se(this,function(a){return this.state.profiling=!0,e=this.state.numBytes,r=this.state.numTensors,this.state.activeProfile.kernels=[],this.state.activeProfile.result=t(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max.apply(Math,this.state.activeProfile.kernels.map(function(i){return i.totalBytesSnapshot})),this.state.activeProfile.newBytes=this.state.numBytes-e,this.state.activeProfile.newTensors=this.state.numTensors-r,[2,this.state.activeProfile]})})},n.prototype.isTapeOn=function(){return this.state.gradientDepth>0&&this.state.kernelDepth===0},n.prototype.addTapeNode=function(t,e,r,a,i){var u=this,l={id:this.state.nextTapeNodeId++,kernelName:t,inputs:e,outputs:r,saved:i},c=oM(t);c!=null&&(a=c.gradFunc),a!=null&&(l.gradient=function(f){return f=f.map(function(d,v){if(d==null){var m=r[v],g=ll(m.size,m.dtype);return u.makeTensor(g,m.shape,m.dtype)}return d}),a(f.length>1?f:f[0],i)}),this.state.activeTape.push(l)},n.prototype.keep=function(t){return t.kept=!0,t},n.prototype.startTape=function(){this.state.gradientDepth===0&&(this.state.activeTape=[]),this.state.gradientDepth++},n.prototype.endTape=function(){this.state.gradientDepth--},n.prototype.startScope=function(t){var e={track:[],name:"unnamed scope",id:this.state.nextScopeId++};t&&(e.name=t),this.state.scopeStack.push(e),this.state.activeScope=e},n.prototype.endScope=function(t){for(var e=this,r=KS(t),a=new Set(r.map(function(c){return c.id})),i=0;i<this.state.activeScope.track.length;i++){var u=this.state.activeScope.track[i];u.kept||a.has(u.id)||u.dispose()}var l=this.state.scopeStack.pop();this.state.activeScope=this.state.scopeStack.length===0?null:this.state.scopeStack[this.state.scopeStack.length-1],r.forEach(function(c){c.kept||c.scopeId!==l.id||e.track(c)})},n.prototype.gradients=function(t,e,r,a){var i=this;if(a===void 0&&(a=!1),P(e.length>0,function(){return"gradients() received an empty list of xs."}),r!=null&&r.dtype!=="float32")throw new Error("dy must have 'float32' dtype, but has '"+r.dtype+"'");var u=this.scopedRun(function(){return i.startTape()},function(){return i.endTape()},function(){return i.tidy("forward",t)});P(u instanceof wt,function(){return"The result y returned by f() must be a tensor."});var l=function(c,f,d){for(var v={},m={},g=0;g<f.length;g++)v[f[g].id]=!0;for(g=0;g<c.length;g++){var b=(D=c[g]).inputs;for(var w in b){for(var S=b[w],E=!1,_=0;_<f.length;_++)if(v[S.id]){D.outputs.forEach(function(B){return v[B.id]=!0}),E=!0,m[D.id]=!0;break}if(E)break}}var R={};R[d.id]=!0;var C={};for(g=c.length-1;g>=0;g--)for(b=(D=c[g]).inputs,_=0;_<D.outputs.length;_++)if(R[D.outputs[_].id]){for(var w in b)R[b[w].id]=!0,C[D.id]=!0;break}var A=[];for(g=0;g<c.length;g++){var D;if(m[(D=c[g]).id]&&C[D.id]){var O={};for(var w in D.inputs){var F=D.inputs[w];v[F.id]&&(O[w]=F)}var N=Object.assign({},D);N.inputs=O,N.outputs=D.outputs,A.push(N)}}return A}(this.state.activeTape,e,u);if(!a&&l.length===0&&e.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",function(){var c,f,d={};d[u.id]=r??(c=u.shape,f=GS(Ee(c),"float32"),q.makeTensor(f,c,"float32")),function(m,g,b){for(var w=function(E){var _=g[E],R=[];if(_.outputs.forEach(function(O){var F=m[O.id];F!=null?R.push(F):R.push(null)}),_.gradient==null)throw new Error("Cannot compute gradient: gradient function not found for "+_.kernelName+".");var C=_.gradient(R),A=function(O){if(!(O in C))throw new Error("Cannot backprop through input "+O+". Available gradients found: "+Object.keys(C)+".");var F=b(function(){return C[O]()});if(F.dtype!=="float32")throw new Error("Error in gradient for op "+_.kernelName+". The gradient of input "+O+" must have 'float32' dtype, but has '"+F.dtype+"'");var N=_.inputs[O];if(!nn(F.shape,N.shape))throw new Error("Error in gradient for op "+_.kernelName+". The gradient of input '"+O+"' has shape '"+F.shape+"', which does not match the shape of the input '"+N.shape+"'");if(m[N.id]==null)m[N.id]=F;else{var B=m[N.id];m[N.id]=B.add(F),B.dispose()}};for(var D in _.inputs)A(D)},S=g.length-1;S>=0;S--)w(S)}(d,l,function(m){return i.tidy(m)});var v=e.map(function(m){return d[m.id]});return i.state.gradientDepth===0&&(i.state.activeTape.forEach(function(m){for(var g=0,b=m.saved;g<b.length;g++)b[g].dispose()}),i.state.activeTape=null),{value:u,grads:v}})},n.prototype.customGrad=function(t){var e=this;return P(em(t),function(){return"The f passed in customGrad(f) must be a function."}),function(){for(var r,a=[],i=0;i<arguments.length;i++)a[i]=arguments[i];P(a.every(function(l){return l instanceof wt}),function(){return"The args passed in customGrad(f)(x1, x2,...) must all be tensors"});var u={};return a.forEach(function(l,c){u[c]=l}),e.runKernelFunc(function(l,c){return P((r=t.apply(void 0,a.concat([c]))).value instanceof wt,function(){return"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"}),P(em(r.gradFunc),function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."}),r.value},u,function(l,c){var f=r.gradFunc(l,c),d=Array.isArray(f)?f:[f];P(d.length===a.length,function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."}),P(d.every(function(m){return m instanceof wt}),function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors."});var v={};return d.forEach(function(m,g){v[g]=function(){return m}}),v})}},n.prototype.readSync=function(t){return this.state.tensorInfo.get(t).backend.readSync(t)},n.prototype.read=function(t){return this.state.tensorInfo.get(t).backend.read(t)},n.prototype.time=function(t){return we(this,void 0,void 0,function(){var e,r;return Se(this,function(a){switch(a.label){case 0:return e=Hr(),[4,this.backend.time(t)];case 1:return(r=a.sent()).wallMs=Hr()-e,[2,r]}})})},n.prototype.track=function(t){return this.state.activeScope!=null&&(t.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(t)),t},Object.defineProperty(n.prototype,"registeredVariables",{get:function(){return this.state.registeredVariables},enumerable:!0,configurable:!0}),n.prototype.reset=function(){for(var t in this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new vw,this.registry)this.disposeRegisteredKernels(t),this.registry[t].dispose(),delete this.registry[t];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null},n.nextTensorId=0,n.nextVariableId=0,n}(),q=function(){var n=function(){if(Jp==null){var e=void 0;if(typeof window<"u")e=window;else if(typeof global<"u")e=global;else if(typeof process<"u")e=process;else{if(typeof self>"u")throw new Error("Could not find a global object");e=self}Jp=e}return Jp}();if(n._tfengine==null){var t=new aM(n);n._tfengine=new _M(t)}return function(e){PS=e}(n._tfengine.ENV),Vr=function(){return n._tfengine},n._tfengine}();function XS(){return typeof window<"u"&&window.document!=null||typeof WorkerGlobalScope<"u"}var ba=ue();ba.registerFlag("DEBUG",function(){return!1},function(n){n&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")}),ba.registerFlag("IS_BROWSER",function(){return XS()}),ba.registerFlag("IS_NODE",function(){return typeof process<"u"&&process.versions!==void 0&&process.versions.node!==void 0}),ba.registerFlag("IS_CHROME",function(){return typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)}),ba.registerFlag("PROD",function(){return!1}),ba.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",function(){return ba.getBool("DEBUG")}),ba.registerFlag("DEPRECATION_WARNINGS_ENABLED",function(){return!0}),ba.registerFlag("IS_TEST",function(){return!1});var Zu,Xn,Kn,Hi={},ev={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function CM(n,t){Hi[n]=t}function Jr(n){n in Hi||(Hi[n]=function(e){if(e!==1&&e!==2)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");var r=function(a){if(typeof OffscreenCanvas<"u"&&a===2)return new OffscreenCanvas(300,150);if(typeof document<"u")return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}(e);return r.addEventListener("webglcontextlost",function(a){a.preventDefault(),delete Hi[e]},!1),e===1?r.getContext("webgl",ev)||r.getContext("experimental-webgl",ev):r.getContext("webgl2",ev)}(n));var t=Hi[n];return t.isContextLost()?(delete Hi[n],Jr(n)):(t.disable(t.DEPTH_TEST),t.disable(t.STENCIL_TEST),t.disable(t.BLEND),t.disable(t.DITHER),t.disable(t.POLYGON_OFFSET_FILL),t.disable(t.SAMPLE_COVERAGE),t.enable(t.SCISSOR_TEST),t.enable(t.CULL_FACE),t.cullFace(t.BACK),Hi[n])}function nh(n,t){return[t,n]}function zu(n){var t=Ee(n);return Jv(Math.ceil(t/4))}function cl(n,t){return[Math.max(1,Math.ceil(t/2)),Math.max(1,Math.ceil(n/2))]}function jm(n,t){var e,r,a,i,u,l,c,f,d,v=n;return ue().getNumber("WEBGL_VERSION")===2?(e=v.R32F,r=v.R16F,a=v.RGBA16F,i=v.RGBA32F,u=v.RED,l=4,c=1,f=v.HALF_FLOAT,d=v.FLOAT):(e=n.RGBA,r=n.RGBA,a=n.RGBA,i=v.RGBA,u=n.RGBA,l=4,c=4,f=t!=null?t.HALF_FLOAT_OES:null,d=n.FLOAT),{internalFormatFloat:e,internalFormatHalfFloat:r,internalFormatPackedHalfFloat:a,internalFormatPackedFloat:i,textureFormatFloat:u,downloadTextureFormat:n.RGBA,downloadUnpackNumChannels:l,defaultNumChannels:c,textureTypeHalfFloat:f,textureTypeFloat:d}}function _e(n,t,e){var r=e();return t&&function(a){var i=a.getError();if(i!==a.NO_ERROR)throw new Error("WebGL Error: "+DM(a,i))}(n),r}(function(n){n[n.DENSE=0]="DENSE",n[n.SHARED_BATCH=1]="SHARED_BATCH"})(Zu||(Zu={})),function(n){n[n.RENDER=0]="RENDER",n[n.UPLOAD=1]="UPLOAD",n[n.PIXELS=2]="PIXELS",n[n.DOWNLOAD=3]="DOWNLOAD"}(Xn||(Xn={})),function(n){n[n.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",n[n.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",n[n.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",n[n.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",n[n.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"}(Kn||(Kn={}));var RM=596e-10,AM=65504;function TM(n){return!!(ue().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||n===0||RM<Math.abs(n)&&Math.abs(n)<AM)}function DM(n,t){switch(t){case n.NO_ERROR:return"NO_ERROR";case n.INVALID_ENUM:return"INVALID_ENUM";case n.INVALID_VALUE:return"INVALID_VALUE";case n.INVALID_OPERATION:return"INVALID_OPERATION";case n.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case n.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case n.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return"Unknown error code "+t}}function Uc(n,t,e){return Aa(n,t,function(){return n.getExtension(e)},'Extension "'+e+'" not supported on this browser.')}function OM(n,t,e){var r=Aa(n,t,function(){return n.createShader(n.VERTEX_SHADER)},"Unable to create vertex WebGLShader.");if(_e(n,t,function(){return n.shaderSource(r,e)}),_e(n,t,function(){return n.compileShader(r)}),n.getShaderParameter(r,n.COMPILE_STATUS)===!1)throw console.log(n.getShaderInfoLog(r)),new Error("Failed to compile vertex shader.");return r}function kM(n,t,e){var r=Aa(n,t,function(){return n.createShader(n.FRAGMENT_SHADER)},"Unable to create fragment WebGLShader.");if(_e(n,t,function(){return n.shaderSource(r,e)}),_e(n,t,function(){return n.compileShader(r)}),n.getShaderParameter(r,n.COMPILE_STATUS)===!1)throw function(a,i){var u=NM.exec(i);if(u==null)return console.log("Couldn't parse line number in error: "+i),void console.log(a);for(var l=+u[1],c=a.split(`
`),f=c.length.toString().length+2,d=c.map(function(S,E){return us((E+1).toString(),f)+S}),v=0,m=0;m<d.length;m++)v=Math.max(d[m].length,v);var g=d.slice(0,l-1),b=d.slice(l-1,l),w=d.slice(l);console.log(g.join(`
`)),console.log(i.split(`
`)[0]),console.log("%c "+us(b[0],v),"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(w.join(`
`))}(e,n.getShaderInfoLog(r)),new Error("Failed to compile fragment shader.");return r}var tv,nv,NM=/ERROR: [0-9]+:([0-9]+):/g;function MM(n,t){return Aa(n,t,function(){return n.createProgram()},"Unable to create WebGLProgram.")}function IM(n,t,e){if(_e(n,t,function(){return n.linkProgram(e)}),n.getProgramParameter(e,n.LINK_STATUS)===!1)throw console.log(n.getProgramInfoLog(e)),new Error("Failed to link vertex and fragment shaders.")}function rv(n,t,e){if(_e(n,t,function(){return n.validateProgram(e)}),n.getProgramParameter(e,n.VALIDATE_STATUS)===!1)throw console.log(n.getProgramInfoLog(e)),new Error("Shader program validation failed.")}function FM(n,t,e){var r=Aa(n,t,function(){return n.createBuffer()},"Unable to create WebGLBuffer");return _e(n,t,function(){return n.bindBuffer(n.ARRAY_BUFFER,r)}),_e(n,t,function(){return n.bufferData(n.ARRAY_BUFFER,e,n.STATIC_DRAW)}),r}function BM(n,t,e){var r=Aa(n,t,function(){return n.createBuffer()},"Unable to create WebGLBuffer");return _e(n,t,function(){return n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,r)}),_e(n,t,function(){return n.bufferData(n.ELEMENT_ARRAY_BUFFER,e,n.STATIC_DRAW)}),r}function PM(n,t){return Aa(n,t,function(){return n.createTexture()},"Unable to create WebGLTexture.")}function LM(n,t){var e=ue().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(n<=0||t<=0){var r="["+n+"x"+t+"]";throw new Error("Requested texture size "+r+" is invalid.")}if(n>e||t>e)throw r="["+n+"x"+t+"]",new Error("Requested texture size "+r+" greater than WebGL maximum on this browser / GPU "+("["+e+"x"+e+"]")+".")}function zM(n,t){return Aa(n,t,function(){return n.createFramebuffer()},"Unable to create WebGLFramebuffer.")}function mw(n,t,e,r,a,i,u,l){var c=n.getAttribLocation(e,r);return c!==-1&&(_e(n,t,function(){return n.bindBuffer(n.ARRAY_BUFFER,a)}),_e(n,t,function(){return n.vertexAttribPointer(c,i,n.FLOAT,!1,u,l)}),_e(n,t,function(){return n.enableVertexAttribArray(c)}),!0)}function UM(n,t,e,r){jM(n,r),_e(n,t,function(){return n.activeTexture(n.TEXTURE0+r)}),_e(n,t,function(){return n.bindTexture(n.TEXTURE_2D,e)})}function HM(n,t,e,r){return Aa(n,t,function(){return n.getUniformLocation(e,r)},'uniform "'+r+'" not present in program.')}function VM(n,t,e){return n.getUniformLocation(t,e)}function WM(n,t,e,r,a,i){_e(n,t,function(){return UM(n,t,r,i)}),_e(n,t,function(){return n.uniform1i(a,i)})}function av(n,t,e,r){_e(n,t,function(){return n.bindFramebuffer(n.FRAMEBUFFER,r)}),_e(n,t,function(){return n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,e,0)})}function gw(n,t,e){_e(n,t,function(){return n.bindFramebuffer(n.FRAMEBUFFER,e)}),_e(n,t,function(){return n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,null,0)})}function Hc(n){var t=n.checkFramebufferStatus(n.FRAMEBUFFER);if(t!==n.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+GM(n,t))}function GM(n,t){switch(t){case n.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case n.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case n.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case n.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return"unknown error "+t}}function Aa(n,t,e,r){var a=_e(n,t,function(){return e()});if(a==null)throw new Error(r);return a}function jM(n,t){var e=n.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,r=t+n.TEXTURE0;if(r<n.TEXTURE0||r>e)throw new Error("textureUnit must be in "+("[gl.TEXTURE0, gl.TEXTURE"+e+"]")+".")}function Cf(n,t){return t===void 0&&(t=2),Ee(n.slice(0,n.length-t))}function Rf(n){if(n.length===0)throw Error("Cannot get rows and columns of an empty shape array.");return[n.length>1?n[n.length-2]:1,n[n.length-1]]}function iv(n){var t=[1,1,1];return n.length===0||n.length===1&&n[0]===1||(t=[Cf(n)].concat(Rf(n))),t}function qM(n,t){var e;t===void 0&&(t=!1);var r=ue().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(t&&(r*=2,(n=n.map(function(f,d){return d>=n.length-2?HS(n[d]):n[d]})).length===1&&(n=[2,n[0]])),n.length!==2){var a=Wi(n);n=a.newShape}var i=Ee(n);if(n.length<=1&&i<=r)return[1,i];if(n.length===2&&n[0]<=r&&n[1]<=r)return n;if(n.length===3&&n[0]*n[1]<=r&&n[2]<=r)return[n[0]*n[1],n[2]];if(n.length===3&&n[0]<=r&&n[1]*n[2]<=r)return[n[0],n[1]*n[2]];if(n.length===4&&n[0]*n[1]*n[2]<=r&&n[3]<=r)return[n[0]*n[1]*n[2],n[3]];if(n.length===4&&n[0]<=r&&n[1]*n[2]*n[3]<=r)return[n[0],n[1]*n[2]*n[3]];if(t){var u=Cf(n),l=2,c=2;return n.length&&(l=(e=Rf(n))[0],c=e[1]),Jv(i=u*(l/2)*(c/2)).map(function(f){return 2*f})}return Jv(i)}function Vc(n){return n%2==0}function Wc(n,t){if(nn(n=n.slice(-2),t=t.slice(-2))||!n.length||!t.length||n[0]===0||n[1]===0||t[0]===0||t[1]===0)return!0;if(n.length!==t.length){var e=n.slice(-1)[0],r=t.slice(-1)[0];if(e===r||Vc(e)&&Vc(r)&&(n[0]===1||t[0]===1))return!0}return n[1]===t[1]&&Vc(n[0])&&Vc(t[0])}function $M(n){if(tv==null){var t=Jr(n);tv=t.getParameter(t.MAX_TEXTURE_SIZE)}return tv}function KM(n){if(nv==null){var t=Jr(n);nv=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,nv)}function XM(n){if(n===0)return 0;var t=Jr(n);return pr(t,"EXT_disjoint_timer_query_webgl2")&&n===2?2:pr(t,"EXT_disjoint_timer_query")?1:0}function pr(n,t){return n.getExtension(t)!=null}function yw(n){try{if(Jr(n)!=null)return!0}catch{return!1}return!1}function ZM(n){if(n===0)return!1;var t=Jr(n);if(n===1){if(!pr(t,"OES_texture_float"))return!1}else if(!pr(t,"EXT_color_buffer_float"))return!1;return om(t)}function YM(n){if(n===0)return!1;var t=Jr(n);if(n!==1){if(pr(t,"EXT_color_buffer_float"))return om(t);if(pr(t,"EXT_color_buffer_half_float")){var e=t.getExtension("EXT_color_buffer_half_float");return function(r,a){var i=jm(r,a),u=r.createTexture();r.bindTexture(r.TEXTURE_2D,u),r.texImage2D(r.TEXTURE_2D,0,i.internalFormatHalfFloat,1,1,0,i.textureFormatFloat,i.textureTypeHalfFloat,null);var l=r.createFramebuffer();r.bindFramebuffer(r.FRAMEBUFFER,l),r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,u,0);var c=r.checkFramebufferStatus(r.FRAMEBUFFER)===r.FRAMEBUFFER_COMPLETE;return r.bindTexture(r.TEXTURE_2D,null),r.bindFramebuffer(r.FRAMEBUFFER,null),r.deleteTexture(u),r.deleteFramebuffer(l),c}(t,e)}return!1}return!!pr(t,"OES_texture_float")&&!!pr(t,"WEBGL_color_buffer_float")&&om(t)}function om(n){var t=jm(n),e=n.createTexture();n.bindTexture(n.TEXTURE_2D,e),n.texImage2D(n.TEXTURE_2D,0,t.internalFormatFloat,1,1,0,t.textureFormatFloat,t.textureTypeFloat,null);var r=n.createFramebuffer();n.bindFramebuffer(n.FRAMEBUFFER,r),n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,e,0);var a=n.checkFramebufferStatus(n.FRAMEBUFFER)===n.FRAMEBUFFER_COMPLETE;return n.bindTexture(n.TEXTURE_2D,null),n.bindFramebuffer(n.FRAMEBUFFER,null),n.deleteTexture(e),n.deleteFramebuffer(r),a}function QM(n){return n===2&&Jr(n).fenceSync!=null}var Ie=ue();function ZS(n){ue().getBool("DEPRECATION_WARNINGS_ENABLED")&&console.warn(n+" You can disable deprecation warnings with tf.disableDeprecationWarnings().")}function be(n,t){return q.tidy(n,t)}function Fn(n){KS(n).forEach(function(t){return t.dispose()})}function JM(n){return q.keep(n)}function Af(){for(var n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];ue().getBool("IS_TEST")||console.warn.apply(console,n)}function xi(n,t){var e=n;if(qr(n))return t==="string"?[]:[n.length];if(!Array.isArray(n))return[];for(var r=[];Array.isArray(e)||qr(e)&&t!=="string";)r.push(e.length),e=e[0];return Array.isArray(n)&&ue().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&function a(i,u,l){if(l=l||[],!Array.isArray(i)&&!qr(i))return void P(u.length===0,function(){return"Element arr["+l.join("][")+"] is a primitive, but should be an array/TypedArray of "+u[0]+" elements"});P(u.length>0,function(){return"Element arr["+l.join("][")+"] should be a primitive, but is an array of "+i.length+" elements"}),P(i.length===u[0],function(){return"Element arr["+l.join("][")+"] should have "+u[0]+" elements, but has "+i.length+" elements"});for(var c=u.slice(1),f=0;f<i.length;++f)a(i[f],c,l.concat(f))}(n,r,[]),r}function bw(n,t,e,r){if(n!=null&&(n!=="numeric"&&n!==t||n==="numeric"&&t==="string"))throw new Error("Argument '"+e+"' passed to '"+r+"' must be "+n+" tensor, but got "+t+" tensor")}function I(n,t,e,r){if(r===void 0&&(r="numeric"),n instanceof wt)return bw(r,n.dtype,t,e),n;var a=ul(n);if(a!=="string"&&["bool","int32","float32"].indexOf(r)>=0&&(a=r),bw(r,a,t,e),n==null||!qr(n)&&!Array.isArray(n)&&typeof n!="number"&&typeof n!="boolean"&&typeof n!="string"){var i=n==null?"null":n.constructor.name;throw new Error("Argument '"+t+"' passed to '"+e+"' must be a Tensor or TensorLike, but got '"+i+"'")}var u=xi(n,a);qr(n)||Array.isArray(n)||(n=[n]);var l=a!=="string"?WS(n,a,ue().getBool("DEBUG")):ws(n,[],!0);return q.makeTensor(l,u,a)}function Tf(n,t,e,r){if(r===void 0&&(r="numeric"),!Array.isArray(n))throw new Error("Argument "+t+" passed to "+e+" must be a `Tensor[]` or `TensorLike[]`");return n.map(function(a,i){return I(a,t+"["+i+"]",e)},r)}function YS(n,t){for(var e=0;e<n.length;++e)if(n[n.length-e-1]!==t-1-e)return!1;return!0}function eI(n,t,e){for(var r=n.length+t.length,a=[],i=0,u=0,l=0;l<r;l++)e.indexOf(l)===-1?a.push(n[i++]):a.push(t[u++]);return a}function mn(n,t){for(var e=[],r=n.length,a=0;a<r;a++)t.indexOf(a)===-1&&e.push(n[a]);return[e,t.map(function(i){return n[i]})]}function Bn(n,t){return eI(n,t.map(function(e){return 1}),t)}function $n(n,t,e){P(YS(t,e),function(){return n+" supports only inner-most axes for now. Got axes "+t+" and rank-"+e+" input."})}function ea(n,t){if(YS(n,t))return null;for(var e=[],r=0;r<t;++r)n.indexOf(r)===-1&&e.push(r);return n.forEach(function(a){return e.push(a)}),e}function qm(n){return n.map(function(t,e){return[e,t]}).sort(function(t,e){return t[1]-e[1]}).map(function(t){return t[0]})}function ta(n,t){for(var e=[],r=t-n;r<t;++r)e.push(r);return e}function tI(n,t){var e=n[0].length;n.forEach(function(a,i){P(a.length===e,function(){return"Error in concat"+e+"D: rank of tensors["+i+"] must be the same as the rank of the rest ("+e+")"})}),P(t>=0&&t<e,function(){return"Error in concat"+e+"D: axis must be between 0 and "+(e-1)+"."});var r=n[0];n.forEach(function(a,i){for(var u=0;u<e;u++)P(u===t||a[u]===r[u],function(){return"Error in concat"+e+"D: Shape of tensors["+i+"] ("+a+") does not match the shape of the rest ("+r+") along the non-concatenated axis "+i+"."})})}function Es(n,t){for(var e=n[0].slice(),r=1;r<n.length;r++)e[t]+=n[r][t];return e}function V(n){var t=Object.keys(n);if(t.length!==1)throw new Error("Please provide an object with a single key (operation name) mapping to a function. Got an object with "+t.length+" keys.");var e=t[0],r=n[e];e.endsWith("_")&&(e=e.substring(0,e.length-1));var a=function(){for(var i=[],u=0;u<arguments.length;u++)i[u]=arguments[u];q.startScope(e);try{var l=r.apply(void 0,i);return l instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),q.endScope(l),l}catch(c){throw q.endScope(null),c}};return Object.defineProperty(a,"name",{value:e,configurable:!0}),a}Ie.registerFlag("HAS_WEBGL",function(){return Ie.getNumber("WEBGL_VERSION")>0}),Ie.registerFlag("WEBGL_VERSION",function(){return yw(2)?2:yw(1)?1:0}),Ie.registerFlag("WEBGL_BUFFER_SUPPORTED",function(){return Ie.get("WEBGL_VERSION")===2}),Ie.registerFlag("WEBGL_CPU_FORWARD",function(){return!0}),Ie.registerFlag("WEBGL_FORCE_F16_TEXTURES",function(){return!1}),Ie.registerFlag("WEBGL_PACK",function(){return Ie.getBool("HAS_WEBGL")}),Ie.registerFlag("WEBGL_PACK_NORMALIZATION",function(){return Ie.getBool("WEBGL_PACK")}),Ie.registerFlag("WEBGL_PACK_CLIP",function(){return Ie.getBool("WEBGL_PACK")}),Ie.registerFlag("WEBGL_PACK_DEPTHWISECONV",function(){return!1}),Ie.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",function(){return Ie.getBool("WEBGL_PACK")}),Ie.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",function(){return Ie.getBool("WEBGL_PACK")}),Ie.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",function(){return Ie.getBool("WEBGL_PACK")}),Ie.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",function(){return Ie.getBool("WEBGL_PACK")}),Ie.registerFlag("WEBGL_PACK_REDUCE",function(){return Ie.getBool("WEBGL_PACK")}),Ie.registerFlag("WEBGL_LAZILY_UNPACK",function(){return Ie.getBool("WEBGL_PACK")}),Ie.registerFlag("WEBGL_CONV_IM2COL",function(){return Ie.getBool("WEBGL_PACK")}),Ie.registerFlag("WEBGL_MAX_TEXTURE_SIZE",function(){return $M(Ie.getNumber("WEBGL_VERSION"))}),Ie.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",function(){return KM(Ie.getNumber("WEBGL_VERSION"))}),Ie.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",function(){var n=Ie.getNumber("WEBGL_VERSION");return n===0?0:XM(n)}),Ie.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",function(){return Ie.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&(n=navigator.userAgent||navigator.vendor||window.opera,!(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(n)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(n.substr(0,4))));var n}),Ie.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",function(){return ZM(Ie.getNumber("WEBGL_VERSION"))}),Ie.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",function(){return!Ie.getBool("WEBGL_FORCE_F16_TEXTURES")&&Ie.getBool("WEBGL_RENDER_FLOAT32_CAPABLE")}),Ie.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",function(){return YM(Ie.getNumber("WEBGL_VERSION"))}),Ie.registerFlag("WEBGL_FENCE_API_ENABLED",function(){return QM(Ie.getNumber("WEBGL_VERSION"))}),Ie.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",function(){return Ie.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0}),$S=ZS;var ln=V({complex_:function(n,t){var e=I(n,"real","complex"),r=I(t,"imag","complex");return at(e.shape,r.shape,"real and imag shapes, "+e.shape+" and "+r.shape+", must match in call to tf.complex()."),q.runKernelFunc(function(a){return a.complex(e,r)},{$real:e,$imag:r})}}),dr=V({real_:function(n){var t=I(n,"input","real");return q.runKernelFunc(function(e){return e.real(t)},{$input:t})}}),Wr=V({imag_:function(n){var t=I(n,"input","imag");return q.runKernelFunc(function(e){return e.imag(t)},{$input:t})}});function fn(n,t,e){return wi(n,t,xi(n,e),e)}function wi(n,t,e,r){if(r==null&&(r=ul(n)),r==="complex64")throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(!qr(n)&&!Array.isArray(n)&&typeof n!="number"&&typeof n!="boolean"&&typeof n!="string")throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(t!=null){jS(t);var a=Ee(t),i=Ee(e);P(a===i,function(){return"Based on the provided shape, ["+t+"], the tensor should have "+a+" values but has "+i});for(var u=0;u<e.length;++u){var l=e[u],c=u!==e.length-1||l!==Ee(t.slice(u));P(e[u]===t[u]||!c,function(){return"Error creating a new Tensor. Inferred shape ("+e+") does not match the provided shape ("+t+"). "})}}return qr(n)||Array.isArray(n)||(n=[n]),t=t||e,n=r!=="string"?WS(n,r,ue().getBool("DEBUG")):ws(n,[],!0),q.makeTensor(n,t,r)}function ge(n,t){if((qr(n)&&t!=="string"||Array.isArray(n))&&t!=="complex64")throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if(t==="string"&&qr(n)&&!(n instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return wi(n,[],[],t)}function Pt(n,t){Ds(n);var e=xi(n,t);if(e.length!==1)throw new Error("tensor1d() requires values to be a flat/TypedArray");return wi(n,null,e,t)}function pi(n,t,e){if(Ds(n),t!=null&&t.length!==2)throw new Error("tensor2d() requires shape to have two numbers");var r=xi(n,e);if(r.length!==2&&r.length!==1)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(r.length===1&&t==null)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return wi(n,t,r,e)}function $m(n,t,e){if(Ds(n),t!=null&&t.length!==3)throw new Error("tensor3d() requires shape to have three numbers");var r=xi(n,e);if(r.length!==3&&r.length!==1)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(r.length===1&&t==null)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return wi(n,t,r,e)}function Mn(n,t,e){if(Ds(n),t!=null&&t.length!==4)throw new Error("tensor4d() requires shape to have four numbers");var r=xi(n,e);if(r.length!==4&&r.length!==1)throw new Error("tensor4d() requires values to be number[][][][] or flat/TypedArray");if(r.length===1&&t==null)throw new Error("tensor4d() requires shape to be provided when `values` are a flat array");return wi(n,t,r,e)}function nI(n,t,e){if(Ds(n),t!=null&&t.length!==5)throw new Error("tensor5d() requires shape to have five numbers");var r=xi(n,e);if(r.length!==5&&r.length!==1)throw new Error("tensor5d() requires values to be number[][][][][] or flat/TypedArray");if(r.length===1&&t==null)throw new Error("tensor5d() requires shape to be provided when `values` are a flat array");return wi(n,t,r,e)}function rI(n,t,e){if(Ds(n),t!=null&&t.length!==6)throw new Error("tensor6d() requires shape to have six numbers");var r=xi(n,e);if(r.length!==6&&r.length!==1)throw new Error("tensor6d() requires values to be number[][][][][][] or flat/TypedArray");if(r.length===1&&t==null)throw new Error("tensor6d() requires shape to be provided when `values` are a flat array");return wi(n,t=t||r,r,e)}function aI(n,t,e,r){return t===void 0&&(t=!0),q.makeVariable(n,t,e,r)}function Os(n,t){if(t===void 0&&(t="float32"),t==="complex64"){var e=Os(n,"float32"),r=mt(n,"float32");return ln(e,r)}var a=GS(Ee(n),t);return q.makeTensor(a,n,t)}function mt(n,t){if(t===void 0&&(t="float32"),t==="complex64"){var e=mt(n,"float32"),r=mt(n,"float32");return ln(e,r)}var a=ll(Ee(n),t);return q.makeTensor(a,n,t)}function Kr(n,t,e){return q.runKernelFunc(function(r){return r.fill(n,t,e)},{})}function iI(n,t,e){if(e<=0)throw new Error("The number of values should be positive.");return q.runKernelFunc(function(r){return r.linspace(n,t,e)},{})}function Df(n,t,e,r){if(e===void 0&&(e=1),r===void 0&&(r="float32"),e===0)throw new Error("Cannot have a step of zero");if(n===t||n<t&&e<0||t<n&&e>1)return mt([0],r);var a=ll(Math.abs(Math.ceil((t-n)/e)),r);t<n&&e===1&&(e=-1),a[0]=n;for(var i=1;i<a.length;i++)a[i]=a[i-1]+e;return Pt(a,r)}var QS=V({onesLike_:function(n){var t=I(n,"x","onesLike");if(t.dtype==="complex64"){var e=QS(dr(t)),r=Ye(Wr(t));return ln(e,r)}return q.runKernelFunc(function(a){return a.onesLike(t)},{$x:t},function(a,i){return{$x:function(){return Ye(a)}}})}}),Ye=V({zerosLike_:function(n){var t=I(n,"x","zerosLike");return q.runKernelFunc(function(e){return e.zerosLike(t)},{$x:t},function(e,r){return{$x:function(){return Ye(e)}}})}}),Gt=V({concat_:function(n,t){t===void 0&&(t=0),P(n.length>=1,function(){return"Pass at least one tensor to concat"});var e=Tf(n,"tensors","concat");e[0].dtype==="complex64"&&e.forEach(function(l){if(l.dtype!=="complex64")throw new Error(`Cannot concatenate complex64 tensors with a tensor
          with dtype `+l.dtype+". ")}),t=Kt(t,e[0].shape)[0];var r=Es(e.map(function(l){return l.shape}),t);if(Ee(r)===0)return fn([],r);if((e=e.filter(function(l){return l.size>0})).length===1)return e[0];var a=e.map(function(l){return l.shape});tI(a,t);var i=e,u={axis:t};return q.runKernelFunc(function(l){return l.concat(e,t)},i,function(l){var c=a.map(function(f){return f[t]});return Km(l,c,t).map(function(f){return function(){return f}})},"Concat",u)}}),oI=V({concat1d_:function(n){return Gt(n,0)}}),sI=V({concat2d_:function(n,t){return Gt(n,t)}}),uI=V({concat3d_:function(n,t){return Gt(n,t)}}),lI=V({concat4d_:function(n,t){return Gt(n,t)}}),Km=V({split_:function(n,t,e){e===void 0&&(e=0);var r,a=I(n,"x","split");return e=Kt(e,a.shape)[0],typeof t=="number"?(P(a.shape[e]%t==0,function(){return"Number of splits must evenly divide the axis."}),r=new Array(t).fill(a.shape[e]/t)):(P(a.shape[e]===t.reduce(function(i,u){return i+u}),function(){return"The sum of sizes must match the size of the axis dimension."}),r=t),q.runKernelFunc(function(i){return i.split(a,r,e)},{$x:a},function(i){return{$x:function(){return Gt(i,e)}}})}});function ro(n,t){return n(t={exports:{}},t.exports),t.exports}var cI=ro(function(n){(function(t,e,r){function a(l){var c,f=this,d=(c=4022871197,function(v){v=v.toString();for(var m=0;m<v.length;m++){var g=.02519603282416938*(c+=v.charCodeAt(m));g-=c=g>>>0,c=(g*=c)>>>0,c+=4294967296*(g-=c)}return 23283064365386963e-26*(c>>>0)});f.next=function(){var v=2091639*f.s0+23283064365386963e-26*f.c;return f.s0=f.s1,f.s1=f.s2,f.s2=v-(f.c=0|v)},f.c=1,f.s0=d(" "),f.s1=d(" "),f.s2=d(" "),f.s0-=d(l),f.s0<0&&(f.s0+=1),f.s1-=d(l),f.s1<0&&(f.s1+=1),f.s2-=d(l),f.s2<0&&(f.s2+=1),d=null}function i(l,c){return c.c=l.c,c.s0=l.s0,c.s1=l.s1,c.s2=l.s2,c}function u(l,c){var f=new a(l),d=c&&c.state,v=f.next;return v.int32=function(){return 4294967296*f.next()|0},v.double=function(){return v()+11102230246251565e-32*(2097152*v()|0)},v.quick=v,d&&(typeof d=="object"&&i(d,f),v.state=function(){return i(f,{})}),v}e&&e.exports?e.exports=u:this.alea=u})(0,n)}),fI=ro(function(n){(function(t,e,r){function a(l){var c=this,f="";c.x=0,c.y=0,c.z=0,c.w=0,c.next=function(){var v=c.x^c.x<<11;return c.x=c.y,c.y=c.z,c.z=c.w,c.w^=c.w>>>19^v^v>>>8},l===(0|l)?c.x=l:f+=l;for(var d=0;d<f.length+64;d++)c.x^=0|f.charCodeAt(d),c.next()}function i(l,c){return c.x=l.x,c.y=l.y,c.z=l.z,c.w=l.w,c}function u(l,c){var f=new a(l),d=c&&c.state,v=function(){return(f.next()>>>0)/4294967296};return v.double=function(){do var m=((f.next()>>>11)+(f.next()>>>0)/4294967296)/2097152;while(m===0);return m},v.int32=f.next,v.quick=v,d&&(typeof d=="object"&&i(d,f),v.state=function(){return i(f,{})}),v}e&&e.exports?e.exports=u:this.xor128=u})(0,n)}),hI=ro(function(n){(function(t,e,r){function a(l){var c=this,f="";c.next=function(){var v=c.x^c.x>>>2;return c.x=c.y,c.y=c.z,c.z=c.w,c.w=c.v,(c.d=c.d+362437|0)+(c.v=c.v^c.v<<4^v^v<<1)|0},c.x=0,c.y=0,c.z=0,c.w=0,c.v=0,l===(0|l)?c.x=l:f+=l;for(var d=0;d<f.length+64;d++)c.x^=0|f.charCodeAt(d),d==f.length&&(c.d=c.x<<10^c.x>>>4),c.next()}function i(l,c){return c.x=l.x,c.y=l.y,c.z=l.z,c.w=l.w,c.v=l.v,c.d=l.d,c}function u(l,c){var f=new a(l),d=c&&c.state,v=function(){return(f.next()>>>0)/4294967296};return v.double=function(){do var m=((f.next()>>>11)+(f.next()>>>0)/4294967296)/2097152;while(m===0);return m},v.int32=f.next,v.quick=v,d&&(typeof d=="object"&&i(d,f),v.state=function(){return i(f,{})}),v}e&&e.exports?e.exports=u:this.xorwow=u})(0,n)}),dI=ro(function(n){(function(t,e,r){function a(l){var c=this;c.next=function(){var f,d,v=c.x,m=c.i;return f=v[m],d=(f^=f>>>7)^f<<24,d^=(f=v[m+1&7])^f>>>10,d^=(f=v[m+3&7])^f>>>3,d^=(f=v[m+4&7])^f<<7,f=v[m+7&7],d^=(f^=f<<13)^f<<9,v[m]=d,c.i=m+1&7,d},function(f,d){var v,m=[];if(d===(0|d))m[0]=d;else for(d=""+d,v=0;v<d.length;++v)m[7&v]=m[7&v]<<15^d.charCodeAt(v)+m[v+1&7]<<13;for(;m.length<8;)m.push(0);for(v=0;v<8&&m[v]===0;++v);for(v==8?m[7]=-1:m[v],f.x=m,f.i=0,v=256;v>0;--v)f.next()}(c,l)}function i(l,c){return c.x=l.x.slice(),c.i=l.i,c}function u(l,c){l==null&&(l=+new Date);var f=new a(l),d=c&&c.state,v=function(){return(f.next()>>>0)/4294967296};return v.double=function(){do var m=((f.next()>>>11)+(f.next()>>>0)/4294967296)/2097152;while(m===0);return m},v.int32=f.next,v.quick=v,d&&(d.x&&i(d,f),v.state=function(){return i(f,{})}),v}e&&e.exports?e.exports=u:this.xorshift7=u})(0,n)}),pI=ro(function(n){(function(t,e,r){function a(l){var c=this;c.next=function(){var f,d,v=c.w,m=c.X,g=c.i;return c.w=v=v+1640531527|0,d=m[g+34&127],f=m[g=g+1&127],d^=d<<13,f^=f<<17,d^=d>>>15,f^=f>>>12,d=m[g]=d^f,c.i=g,d+(v^v>>>16)|0},function(f,d){var v,m,g,b,w,S=[],E=128;for(d===(0|d)?(m=d,d=null):(d+="\0",m=0,E=Math.max(E,d.length)),g=0,b=-32;b<E;++b)d&&(m^=d.charCodeAt((b+32)%d.length)),b===0&&(w=m),m^=m<<10,m^=m>>>15,m^=m<<4,m^=m>>>13,b>=0&&(w=w+1640531527|0,g=(v=S[127&b]^=m+w)==0?g+1:0);for(g>=128&&(S[127&(d&&d.length||0)]=-1),g=127,b=512;b>0;--b)m=S[g+34&127],v=S[g=g+1&127],m^=m<<13,v^=v<<17,m^=m>>>15,v^=v>>>12,S[g]=m^v;f.w=w,f.X=S,f.i=g}(c,l)}function i(l,c){return c.i=l.i,c.w=l.w,c.X=l.X.slice(),c}function u(l,c){l==null&&(l=+new Date);var f=new a(l),d=c&&c.state,v=function(){return(f.next()>>>0)/4294967296};return v.double=function(){do var m=((f.next()>>>11)+(f.next()>>>0)/4294967296)/2097152;while(m===0);return m},v.int32=f.next,v.quick=v,d&&(d.X&&i(d,f),v.state=function(){return i(f,{})}),v}e&&e.exports?e.exports=u:this.xor4096=u})(0,n)}),vI=ro(function(n){(function(t,e,r){function a(l){var c=this,f="";c.next=function(){var v=c.b,m=c.c,g=c.d,b=c.a;return v=v<<25^v>>>7^m,m=m-g|0,g=g<<24^g>>>8^b,b=b-v|0,c.b=v=v<<20^v>>>12^m,c.c=m=m-g|0,c.d=g<<16^m>>>16^b,c.a=b-v|0},c.a=0,c.b=0,c.c=-1640531527,c.d=1367130551,l===Math.floor(l)?(c.a=l/4294967296|0,c.b=0|l):f+=l;for(var d=0;d<f.length+20;d++)c.b^=0|f.charCodeAt(d),c.next()}function i(l,c){return c.a=l.a,c.b=l.b,c.c=l.c,c.d=l.d,c}function u(l,c){var f=new a(l),d=c&&c.state,v=function(){return(f.next()>>>0)/4294967296};return v.double=function(){do var m=((f.next()>>>11)+(f.next()>>>0)/4294967296)/2097152;while(m===0);return m},v.int32=f.next,v.quick=v,d&&(typeof d=="object"&&i(d,f),v.state=function(){return i(f,{})}),v}e&&e.exports?e.exports=u:this.tychei=u})(0,n)}),Vi=ro(function(n){(function(t,e){var r,a=this,i=256,u=6,l="random",c=e.pow(i,u),f=e.pow(2,52),d=2*f,v=i-1;function m(E,_,R){var C=[],A=w(function F(N,B){var H,U=[],J=typeof N;if(B&&J=="object")for(H in N)try{U.push(F(N[H],B-1))}catch{}return U.length?U:J=="string"?N:N+"\0"}((_=_==1?{entropy:!0}:_||{}).entropy?[E,S(t)]:E??function(){try{var F;return r&&(F=r.randomBytes)?F=F(i):(F=new Uint8Array(i),(a.crypto||a.msCrypto).getRandomValues(F)),S(F)}catch{var N=a.navigator,B=N&&N.plugins;return[+new Date,a,B,a.screen,S(t)]}}(),3),C),D=new g(C),O=function(){for(var F=D.g(u),N=c,B=0;F<f;)F=(F+B)*i,N*=i,B=D.g(1);for(;F>=d;)F/=2,N/=2,B>>>=1;return(F+B)/N};return O.int32=function(){return 0|D.g(4)},O.quick=function(){return D.g(4)/4294967296},O.double=O,w(S(D.S),t),(_.pass||R||function(F,N,B,H){return H&&(H.S&&b(H,D),F.state=function(){return b(D,{})}),B?(e[l]=F,N):F})(O,A,"global"in _?_.global:this==e,_.state)}function g(E){var _,R=E.length,C=this,A=0,D=C.i=C.j=0,O=C.S=[];for(R||(E=[R++]);A<i;)O[A]=A++;for(A=0;A<i;A++)O[A]=O[D=v&D+E[A%R]+(_=O[A])],O[D]=_;(C.g=function(F){for(var N,B=0,H=C.i,U=C.j,J=C.S;F--;)N=J[H=v&H+1],B=B*i+J[v&(J[H]=J[U=v&U+N])+(J[U]=N)];return C.i=H,C.j=U,B})(i)}function b(E,_){return _.i=E.i,_.j=E.j,_.S=E.S.slice(),_}function w(E,_){for(var R,C=E+"",A=0;A<C.length;)_[v&A]=v&(R^=19*_[v&A])+C.charCodeAt(A++);return S(_)}function S(E){return String.fromCharCode.apply(0,E)}if(e["seed"+l]=m,w(e.random(),t),n.exports){n.exports=m;try{r=require("crypto")}catch{}}})([],Math)});Vi.alea=cI,Vi.xor128=fI,Vi.xorwow=hI,Vi.xorshift7=dI,Vi.xor4096=pI,Vi.tychei=vI;var rh=Vi.alea,Xm=function(){function n(t,e,r,a,i){this.mean=t,this.stdDev=e,this.dtype=r,this.nextVal=NaN,this.truncated=a,this.truncated&&(this.upper=this.mean+2*this.stdDev,this.lower=this.mean-2*this.stdDev);var u=i||Math.random();this.random=rh(u.toString())}return n.prototype.nextValue=function(){if(!isNaN(this.nextVal)){var t=this.nextVal;return this.nextVal=NaN,t}for(var e,r,a=!1;!a;){var i=void 0,u=void 0,l=void 0;do l=(i=2*this.random()-1)*i+(u=2*this.random()-1)*u;while(l>=1||l===0);var c=Math.sqrt(-2*Math.log(l)/l);e=this.mean+this.stdDev*i*c,r=this.mean+this.stdDev*u*c,this.truncated&&!this.isValidTruncated(e)||(a=!0)}return this.truncated&&!this.isValidTruncated(r)||(this.nextVal=this.convertValue(r)),this.convertValue(e)},n.prototype.convertValue=function(t){return this.dtype==null||this.dtype==="float32"?t:Math.round(t)},n.prototype.isValidTruncated=function(t){return t<=this.upper&&t>=this.lower},n}(),mI=function(){function n(t,e,r,a){this.alpha=t,this.beta=1/e,this.dtype=r;var i=a||Math.random();this.randu=rh(i.toString()),this.randn=new Xm(0,1,r,!1,this.randu()),this.d=t<1?t+2/3:t-1/3,this.c=1/Math.sqrt(9*this.d)}return n.prototype.nextValue=function(){for(var t,e,r,a,i,u;;){do a=this.randn.nextValue(),u=1+this.c*a;while(u<=0);if(u*=u*u,e=1-.331*(t=a*a)*t,r=.5*t+this.d*(1-u+Math.log(u)),(i=this.randu())<e||Math.log(i)<r)break}return u=1/this.beta*this.d*u,this.alpha<1&&(u*=Math.pow(this.randu(),1/this.alpha)),this.convertValue(u)},n.prototype.convertValue=function(t){return this.dtype==="float32"?t:Math.round(t)},n}(),gI=function(){function n(t,e,r,a){var i=this;if(t===void 0&&(t=0),e===void 0&&(e=1),this.canReturnFloat=function(){return i.dtype==null||i.dtype==="float32"},this.min=t,this.range=e-t,this.dtype=r,a==null&&(a=Math.random()),typeof a=="number"&&(a=a.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error("The difference between "+t+" - "+e+" <= 1 and dtype is not float");this.random=rh(a)}return n.prototype.convertValue=function(t){return this.canReturnFloat()?t:Math.round(t)},n.prototype.nextValue=function(){return this.convertValue(this.min+this.range*this.random())},n}();function Pe(n,t,e){return t===void 0&&(t="float32"),t=t||"float32",jS(n),new Xu(n,t,e)}function yI(n,t){t===void 0&&(t=!1),console.log(n.toString(t))}var JS=V({batchToSpaceND_:function(n,t,e){var r=I(n,"x","batchToSpaceND"),a=t.reduce(function(i,u){return i*u});return P(r.rank>=1+t.length,function(){return"input rank is "+r.rank+" but should be > than blockShape.length "+t.length}),P(e.length===t.length,function(){return"crops.length is "+e.length+" but should be equal to blockShape.length  "+t.length}),P(r.shape[0]%a==0,function(){return"input tensor batch is "+r.shape[0]+" but is not divisible by the product of the elements of blockShape "+t.join(" * ")+" === "+a}),q.runKernelFunc(function(i){return i.batchToSpaceND(r,t,e)},{$x:r},function(i){return{$x:function(){return i.spaceToBatchND(t,e)}}})}}),bI=V({broadcastTo_:function(n,t){var e=I(n,"broadcastTo","x"),r=e.shape;if(t.some(function(c){return!(c>0)||c%1!=0}))throw new Error("broadcastTo(): Invalid broadcast shape ["+t+"].");if(t.length<e.rank)throw new Error("broadcastTo(): shape.length="+t.length+" < input.rank="+e.rank+".");if(t.length>e.rank){for(var a=e.shape.slice();a.length<t.length;)a.unshift(1);e=e.reshape(a)}for(var i=Array.from(t),u=t.length-1;u>=0;u--)if(e.shape[u]===t[u])i[u]=1;else if(e.shape[u]!==1)throw new Error("broadcastTo(): ["+r+"] cannot be broadcast to ["+t+"].");var l=i.map(function(c,f){return c>1?f:-1}).filter(function(c){return c>=0});return l.length===0?e.clone():q.runKernelFunc(function(c){return c.tile(e,i)},{input:e},function(c){return{input:function(){return c.sum(l,!0)}}})}}),xI=V({cast_:function(n,t){var e=I(n,"x","cast");if(!hM(t))throw new Error("Failed to cast to unknown dtype "+t);if(t==="string"&&e.dtype!=="string"||t!=="string"&&e.dtype==="string")throw new Error("Only strings can be casted to strings");var r={dtype:t};return q.runKernelFunc(function(a){return a.cast(e,t)},{x:e},function(a){return{x:function(){return a.clone()}}},"Cast",r)}}),wI=V({clone_:function(n){var t=I(n,"x","clone",null);return q.runKernelFunc(function(){return q.makeTensorFromDataId(t.dataId,t.shape,t.dtype)},{$x:t},function(e){return{$x:function(){return e.toFloat()}}})}}),SI=V({cumsum_:function(n,t,e,r){t===void 0&&(t=0),e===void 0&&(e=!1),r===void 0&&(r=!1);var a=I(n,"x","cumsum"),i=ea([t|=0],a.rank),u=a;i!=null&&(u=a.transpose(i));var l=ta(1,a.rank)[0],c=q.runKernelFunc(function(f){return f.cumsum(u,l,e,r)},{permutedX:u},function(f){return{permutedX:function(){return f.cumsum(t,e,!r)}}});return i!=null&&(c=c.transpose(i)),c}}),EI=V({depthToSpace_:function(n,t,e){e===void 0&&(e="NHWC");var r=I(n,"x","depthToSpace"),a=e==="NHWC"?r.shape[1]:r.shape[2],i=e==="NHWC"?r.shape[2]:r.shape[3],u=e==="NHWC"?r.shape[3]:r.shape[1];return P(a*t>=0,function(){return`Negative dimension size caused by overflow when multiplying
      `+a+" and "+t+`  for depthToSpace with input shape
      `+r.shape}),P(i*t>=0,function(){return`Negative dimension size caused by overflow when multiplying
      `+i+" and "+t+` for depthToSpace with input shape
          `+r.shape}),P(u%(t*t)==0,function(){return"Dimension size must be evenly divisible by "+t*t+" but is "+u+" for depthToSpace with input shape "+r.shape}),q.runKernelFunc(function(l){return l.depthToSpace(r,t,e)},{$x:r})}}),hr=V({expandDims_:function(n,t){t===void 0&&(t=0);var e=I(n,"x","expandDims",null);P(t<=e.rank,function(){return"Axis must be <= rank of the tensor"});var r=e.shape.slice();return t<0&&(P(-(e.rank+1)<=t,function(){return"Axis must be in the interval ["+-(e.rank+1)+", "+e.rank+"]"}),t=e.rank+t+1),r.splice(t,0,1),Cr(e,r)}}),eE=V({eye_:function(n,t,e,r){r===void 0&&(r="float32"),t==null&&(t=n);for(var a=Pe([n,t],r),i=n<=t?n:t,u=0;u<i;++u)a.set(1,u,u);var l=a.toTensor().as2D(n,t);if(e==null)return l;if(e.length===1)return ls(hr(l,0),[e[0],1,1]);if(e.length===2)return ls(hr(hr(l,0),0),[e[0],e[1],1,1]);if(e.length===3)return ls(hr(hr(hr(l,0),0),0),[e[0],e[1],e[2],1,1]);throw new Error("eye() currently supports only 1D and 2D batchShapes, but received "+e.length+"D.")}}),_I=V({multinomial_:function(n,t,e,r){r===void 0&&(r=!1);var a=I(n,"logits","multinomial"),i=a.size,u=a.rank;if(i<2)throw new Error("Error in multinomial: you need at least 2 outcomes, but got "+i+".");if(u>2)throw new Error("Rank of probabilities must be 1 or 2, but is "+u);e=e||Math.random();var l=u===1?a.as2D(1,-1):a,c=q.runKernelFunc(function(f){return f.multinomial(l,r,t,e)},{logits2D:l});return u===1?c.as1D():c}}),sm=V({oneHot_:function(n,t,e,r){if(e===void 0&&(e=1),r===void 0&&(r=0),t<2)throw new Error("Error in oneHot: depth must be >=2, but it is "+t);var a=I(n,"indices","oneHot","int32"),i=a.shape.concat([t]);return a=a.flatten(),q.runKernelFunc(function(u){return u.oneHot(a,t,e,r)},{$indices:a},function(u){return{$indices:function(){return mt(a.shape,"float32")}}}).reshape(i)}}),ao=V({pad_:function(n,t,e){e===void 0&&(e=0);var r=I(n,"x","pad");if(r.rank===0)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");var a={paddings:t,constantValue:e};return q.runKernelFunc(function(i){return i.pad(r,t,e)},{x:r},function(i){var u=t.map(function(l){return l[0]});return{x:function(){return i.slice(u,r.shape)}}},"PadV2",a)}}),CI=V({pad1d_:function(n,t,e){return e===void 0&&(e=0),P(t.length===2,function(){return"Invalid number of paddings. Must be length of 2."}),ao(n,[t],e)}}),RI=V({pad2d_:function(n,t,e){return e===void 0&&(e=0),P(t.length===2&&t[0].length===2&&t[1].length===2,function(){return"Invalid number of paddings. Must be length of 2 each."}),ao(n,t,e)}}),AI=V({pad3d_:function(n,t,e){return e===void 0&&(e=0),P(t.length===3&&t[0].length===2&&t[1].length===2&&t[2].length===2,function(){return"Invalid number of paddings. Must be length of 2 each."}),ao(n,t,e)}}),TI=V({pad4d_:function(n,t,e){return e===void 0&&(e=0),P(t.length===4&&t[0].length===2&&t[1].length===2&&t[2].length===2&&t[3].length===2,function(){return"Invalid number of paddings. Must be length of 2 each."}),ao(n,t,e)}}),DI=V({rand_:function(n,t,e){var r=Ee(n),a=null;if(e==null||e==="float32")a=new Float32Array(r);else if(e==="int32")a=new Int32Array(r);else{if(e!=="bool")throw new Error("Unknown data type "+e);a=new Uint8Array(r)}for(var i=0;i<r;i++)a[i]=t();return q.makeTensor(a,n,e)}}),OI=V({randomNormal_:function(n,t,e,r,a){if(t===void 0&&(t=0),e===void 0&&(e=1),r!=null&&r==="bool")throw new Error("Unsupported data type "+r);for(var i=new Xm(t,e,r,!1,a),u=Pe(n,r),l=0;l<u.values.length;l++)u.values[l]=i.nextValue();return u.toTensor()}}),kI=V({randomGamma_:function(n,t,e,r,a){if(e===void 0&&(e=1),r===void 0&&(r="float32"),e==null&&(e=1),r==null&&(r="float32"),r!=="float32"&&r!=="int32")throw new Error("Unsupported data type "+r);for(var i=new mI(t,e,r,a),u=Pe(n,r),l=0;l<u.values.length;l++)u.values[l]=i.nextValue();return u.toTensor()}}),tE=V({randomUniform_:function(n,t,e,r,a){t===void 0&&(t=0),e===void 0&&(e=1),r===void 0&&(r="float32");for(var i=Pe(n,r),u=new gI(t,e,null,a),l=0;l<i.values.length;l++)i.values[l]=u.nextValue();return i.toTensor()}}),Cr=V({reshape_:function(n,t){var e=I(n,"x","reshape",null);t=cM(t,e.size),P(e.size===Ee(t),function(){return"new shape and old shape must have the same number of elements."});var r={shape:t};return q.runKernelFunc(function(a){return a.reshape(e,t)},{x:e},function(a){return{x:function(){return a.reshape(e.shape)}}},"Reshape",r)}}),nE=V({spaceToBatchND_:function(n,t,e){var r=I(n,"x","spaceToBatchND");return P(r.rank>=1+t.length,function(){return"input rank "+r.rank+" should be > than [blockShape] "+t.length}),P(e.length===t.length,function(){return"paddings.shape[0] "+e.length+" must be equal to [blockShape] "+t.length}),P(r.shape.reduce(function(a,i,u){return u>0&&u<=t.length?a&&(i+e[u-1][0]+e[u-1][1])%t[u-1]==0:a},!0),function(){return"input spatial dimensions "+r.shape.slice(1)+" with paddings "+e.toString()+" must be divisible by blockShapes "+t.toString()}),q.runKernelFunc(function(a){return a.spaceToBatchND(r,t,e)},{$x:r},function(a){return{$x:function(){return a.batchToSpaceND(t,e)}}})}}),rE=V({squeeze_:function(n,t){var e=I(n,"x","squeeze");return Cr(e,Wi(e.shape,t).newShape)}}),Qn=V({stack_:function(n,t){t===void 0&&(t=0);var e=Tf(n,"tensors","stack");if(P(e.length>=1,function(){return"Pass at least one tensor to tf.stack"}),e.length===1)return e[0].expandDims(t);var r=e[0].rank,a=e[0].shape,i=e[0].dtype;P(t<=r,function(){return"Axis must be <= rank of the tensor"}),e.forEach(function(l){at(a,l.shape,"All tensors passed to stack must have matching shapes")}),e.forEach(function(l){P(i===l.dtype,function(){return"All tensors passed to stack must have matching dtypes"})});var u=e.map(function(l){return l.expandDims(t)});return Gt(u,t)}}),ls=V({tile_:function(n,t){var e=I(n,"x","tile",null);P(e.rank===t.length,function(){return"Error in transpose: rank of input "+e.rank+" must match length of reps "+t+"."});var r=[e],a={reps:t};return q.runKernelFunc(function(i,u){var l=i.tile(e,t);return u([e]),l},{x:e},function(i,u){var l=u[0];return{x:function(){var c=Ye(l);if(l.rank===1)for(var f=0;f<t[0];++f)c=c.add(i.slice([f*l.shape[0]],[l.shape[0]]));else if(l.rank===2)for(f=0;f<t[0];++f)for(var d=0;d<t[1];++d)c=c.add(i.slice([f*l.shape[0],d*l.shape[1]],[l.shape[0],l.shape[1]]));else if(l.rank===3)for(f=0;f<t[0];++f)for(d=0;d<t[1];++d)for(var v=0;v<t[2];++v)c=c.add(i.slice([f*l.shape[0],d*l.shape[1],v*l.shape[2]],[l.shape[0],l.shape[1],l.shape[2]]));else{if(l.rank!==4)throw new Error("Gradient for tile operation is not implemented for rank-"+l.rank+" tensors yet.");for(f=0;f<t[0];++f)for(d=0;d<t[1];++d)for(v=0;v<t[2];++v)for(var m=0;m<t[3];++m)c=c.add(i.slice([f*l.shape[0],d*l.shape[1],v*l.shape[2],m*l.shape[3]],[l.shape[0],l.shape[1],l.shape[2],l.shape[3]]))}return c}}},"Tile",a,r)}}),NI=V({truncatedNormal_:function(n,t,e,r,a){if(t===void 0&&(t=0),e===void 0&&(e=1),r!=null&&r==="bool")throw new Error("Unsupported data type "+r);for(var i=new Xm(t,e,r,!0,a),u=Pe(n,r),l=0;l<u.values.length;l++)u.values[l]=i.nextValue();return u.toTensor()}}),jt=V({unstack_:function(n,t){t===void 0&&(t=0),t=t||0;var e=I(n,"x","unstack");P(t>=-e.shape.length&&t<e.shape.length,function(){return"Axis = "+t+" is not in [-"+e.shape.length+", "+e.shape.length+")"}),t<0&&(t+=e.shape.length);var r={axis:t};return q.runKernelFunc(function(a){return a.unstack(e,t)},{x:e},function(a){return{x:function(){return Qn(a,t)}}},"Unpack",r)}}),MI=function(n,t){return we(this,void 0,void 0,function(){var e,r,a,i,u,l,c,f,d,v;return Se(this,function(m){switch(m.label){case 0:return e=I(n,"x","setdiff1d"),r=I(t,"y","setdiff1d"),P(e.dtype===r.dtype,function(){return"x and y should have the same dtype, but got x ("+e.dtype+") and y ("+r.dtype+")."}),P(e.rank===1,function(){return"x should be 1D tensor, but got x ("+e.shape+")."}),P(r.rank===1,function(){return"y should be 1D tensor, but got y ("+r.shape+")."}),[4,e.data()];case 1:return a=m.sent(),[4,r.data()];case 2:for(i=m.sent(),u=new Set(i),l=0,d=0;d<a.length;d++)u.has(a[d])||l++;for(c=new Xu([l],e.dtype),f=new Xu([l],"int32"),d=0,v=0;d<a.length;d++)u.has(a[d])||(c.values[v]=a[d],f.values[v]=d,v++);return[2,[c.toTensor(),f.toTensor()]]}})})};function Of(n,t,e,r){r===void 0&&(r=!0);var a=[];if(r)(a=a.concat(t.slice(0))).push(n[0]/e),a=a.concat(n.slice(1));else{a=a.concat(n[0]);for(var i=t.length,u=0;u<i;++u)a=a.concat([n[u+1]/t[u],t[u]]);a=a.concat(n.slice(i+1))}return a}function kf(n,t,e){e===void 0&&(e=!0);var r=[];if(e){r.push(t);for(var a=t+1;a<n;++a)a<=2*t?(r.push(a),r.push(a-(t+1))):r.push(a)}else{var i=[],u=[];for(a=1;a<n;++a)a>=2*t+1||a%2==1?u.push(a):i.push(a);r.push.apply(r,i),r.push(0),r.push.apply(r,u)}return r}function Nf(n,t,e,r){r===void 0&&(r=!0);var a=[];r?a.push(n[0]/e):a.push(n[0]*e);for(var i=1;i<n.length;++i)i<=t.length?r?a.push(t[i-1]*n[i]):a.push(n[i]/t[i-1]):a.push(n[i]);return a}function aE(n,t){for(var e=[0],r=0;r<t;++r)e.push(n[r][0]);return e}function iE(n,t,e){for(var r=n.slice(0,1),a=0;a<e;++a)r.push(n[a+1]-t[a][0]-t[a][1]);return r}function oE(n,t){if(n.rank<1)throw new Error("tf.gatherND() expects the input to be rank 1 or higher, but the rank was "+n.rank+".");if(t.rank<1)throw new Error("tf.gatherND() expects the indices to be rank 1 or higher, but the rank was "+t.rank+".");if(t.dtype!=="int32")throw new Error("tf.gatherND() expects the indices to be int32 type, but the dtype was "+t.dtype+".");if(t.shape[t.rank-1]>n.rank)throw new Error("index innermost dimension length must be <= tensor rank; saw: "+t.shape[t.rank-1]+" vs. "+n.rank);if(n.size===0)throw new Error("Requested more than 0 entries, but input is empty. Input shape: "+n.shape+".");for(var e=t.shape,r=e[e.length-1],a=1,i=0;i<e.length-1;++i)a*=e[i];var u=n.shape,l=e.slice();l.pop();var c=1;for(i=r;i<n.rank;++i)c*=u[i],l.push(u[i]);var f=$r(n.shape).map(function(d){return d/c}).concat([1]).slice(0,r);return[l,a,c,f]}var sE=30;function ov(n){return n<=sE?n:tm(n,Math.floor(Math.sqrt(n)))}function II(n,t,e){var r=t.rank>1?t.shape[t.rank-1]:1,a=t.rank>1?t.rank-1:1,i="Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: "+e.shape+", indices.shape: "+t.shape+", shape: "+n+", sliceDim: "+r+", and batchDim: "+a+".";if(e.rank<a)throw new Error(i+" update.rank < "+a+". ");if(n.length<r+(e.rank-a))throw new Error(i+" Output shape length < "+(r+(e.rank-a)));if(e.rank!==a+n.length-r)throw new Error(i+" update.rank != "+(a+n.length-r));for(var u=0;u<a;++u)if(e.shape[u]!==t.shape[u])throw new Error(i+" updates.shape["+u+"] ("+e.shape[u]+") != indices.shape["+u+"] ("+t.shape[u]+").");for(u=0;u<e.rank-a;++u)if(e.shape[u+a]!==n[u+r])throw new Error(i+" updates.shape["+(u+a)+"] ("+e.shape[u+a]+") != shape["+(u+a)+"] ("+n[u+a]+")")}function FI(n,t,e){if(t.rank<1)throw new Error("tf.scatterND() expects the indices to be rank 1 or higher, but the rank was "+t.rank+".");if(n.rank<1)throw new Error("tf.scatterND() expects the updates to be rank 1 or higher, but the rank was "+n.rank+".");if(t.dtype!=="int32")throw new Error("The dtype of 'indices' should be int32, but got dtype: "+t.dtype);if(e.length<1)throw new Error("Output rank must be greater or equal to 1, but got shape: "+e);if(e.length===0){if(t.size===0)throw new Error("Indices specified for empty output. indices shape: "+t.shape);if(n.size===0)throw new Error("Updates specified for empty output. updates shape: "+n.shape)}II(e,t,n)}function Mf(n,t,e){for(var r=t.shape.length,a=r>1?t.shape[r-1]:1,i=e.length,u=1,l=a;l<i;++l)u*=e[l];var c=a<1?1:a;return{sliceRank:a,numUpdates:Ee(t.shape)/c,sliceSize:u,strides:$r(e.slice(0,a)).concat([1]),outputSize:Ee(e)}}function BI(n,t,e){P(n.rank===t.length,function(){return"Error in slice"+n.rank+"D: Length of begin "+t+" must match the rank of the array ("+n.rank+")."}),P(n.rank===e.length,function(){return"Error in slice"+n.rank+"D: Length of size "+e+" must match the rank of the array ("+n.rank+")."});for(var r=function(i){P(t[i]+e[i]<=n.shape[i],function(){return"Error in slice"+n.rank+"D: begin["+i+"] + size["+i+"] ("+(t[i]+e[i])+") would overflow input.shape["+i+"] ("+n.shape[i]+")"})},a=0;a<n.rank;++a)r(a)}function xw(n){for(var t=[],e=0;n>0;)1&n&&t.push(e),n/=2,e++;return t}function Zm(n,t,e){for(var r=[],a=0;a<n.length;a++)r[a]=Math.ceil((t[a]-n[a])/e[a]);return r}function PI(n,t,e,r,a){var i=t[a],u=e[a]||1;(n&1<<a||i==null)&&(i=u>0?Number.MIN_SAFE_INTEGER:Number.MAX_SAFE_INTEGER);var l=r[a];return i<0&&(i+=l),i=Qv(0,i,l-1)}function LI(n,t,e,r,a){var i=t[a],u=e[a]||1;(n&1<<a||i==null)&&(i=u>0?Number.MAX_SAFE_INTEGER:Number.MIN_SAFE_INTEGER);var l=r[a];return i<0&&(i+=l),i=u>0?Qv(0,i,l):Qv(-1,i,l-1)}function uE(n,t,e){for(var r=e.length,a=0;a<e.length;a++)if(e[a]>1){r=a;break}for(a=r+1;a<e.length;a++)if(t[a]>0||e[a]!==n[a])return!1;return!0}function lE(n,t){for(var e=n.length>0?n[n.length-1]:1,r=0;r<n.length-1;r++)e+=n[r]*t[r];return e}function zI(n,t){P(em(n),function(){return"The f passed in variableGrads(f) must be a function"}),P(t==null||Array.isArray(t)&&t.every(function(d){return d instanceof Ss}),function(){return"The varList passed in variableGrads(f, varList) must be an array of variables"});var e=t!=null;if(!e)for(var r in t=[],q.registeredVariables)t.push(q.registeredVariables[r]);var a=e?t.filter(function(d){return!d.trainable}):null,i=t.length;P((t=t.filter(function(d){return d.trainable})).length>0,function(){return"variableGrads() expects at least one of the input variables to be trainable, but none of the "+i+" variables is trainable."});var u=q.gradients(n,t,null,!0),l=u.value,c=u.grads;P(c.some(function(d){return d!=null}),function(){return"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."}),P(l.rank===0,function(){return"The f passed in variableGrads(f) must return a scalar, but it returned a rank-"+l.rank+" tensor"});var f={};return t.forEach(function(d,v){c[v]!=null&&(f[d.name]=c[v])}),a?.forEach(function(d){return f[d.name]=null}),{value:l,grads:f}}function ah(n){return q.customGrad(n)}var Ta=V({softmax_:function(n,t){t===void 0&&(t=-1);var e=I(n,"logits","softmax","float32");if(t===-1&&(t=e.rank-1),t!==e.rank-1)throw Error("Softmax along a non-last dimension is not yet supported. Logits was rank "+e.rank+" and dim was "+t);return q.runKernelFunc(function(r,a){var i=r.softmax(e,t);return a([i]),i},{logits:e},function(r,a){var i=a[0],u=r.mul(i);return{logits:function(){return u.sub(u.sum([t],!0).mul(i))}}},"Softmax",{dim:t},[],[!0])}}),UI=V({logSoftmax_:function(n,t){t===void 0&&(t=-1);var e=I(n,"logits","logSoftmax");if(t===-1&&(t=e.rank-1),t!==e.rank-1)throw Error("Log Softmax along a non-last dimension is not yet supported. Logits was rank "+e.rank+" and axis was "+t);return ah(function(r,a){var i=r.max(t,!0),u=r.sub(i),l=u.toFloat().sub(u.exp().sum(t,!0).log());return a([l]),{value:l,gradFunc:function(c,f){var d=f[0].exp();return c.sub(c.sum(t,!0).mul(d))}}})(e)}}),cE=function(){function n(t,e){this.backend=t,this.dataMover=e,this.data=new WeakMap,this.dataIdsCount=0}return n.prototype.get=function(t){return this.data.has(t)||this.dataMover.moveData(this.backend,t),this.data.get(t)},n.prototype.set=function(t,e){this.dataIdsCount++,this.data.set(t,e)},n.prototype.has=function(t){return this.data.has(t)},n.prototype.delete=function(t){return this.dataIdsCount--,this.data.delete(t)},n.prototype.numDataIds=function(){return this.dataIdsCount},n}(),fE=function(){function n(){}return n.prototype.time=function(t){return ae("time")},n.prototype.read=function(t){return ae("read")},n.prototype.readSync=function(t){return ae("readSync")},n.prototype.numDataIds=function(){return ae("numDataIds")},n.prototype.disposeData=function(t){return ae("disposeData")},n.prototype.write=function(t,e,r){return ae("write")},n.prototype.move=function(t,e,r,a){return ae("move")},n.prototype.memory=function(){return ae("memory")},n.prototype.floatPrecision=function(){return ae("floatPrecision")},n.prototype.epsilon=function(){return this.floatPrecision()===32?1e-7:1e-4},n.prototype.batchMatMul=function(t,e,r,a){return ae("batchMatMul")},n.prototype.fusedBatchMatMul=function(t){return t.a,t.b,t.transposeA,t.transposeB,t.bias,t.activation,t.preluActivationWeights,ae("fusedBatchMatMul")},n.prototype.slice=function(t,e,r){return ae("slice")},n.prototype.stridedSlice=function(t,e,r,a){return ae("stridedSlice")},n.prototype.unstack=function(t,e){return ae("unstack")},n.prototype.reverse=function(t,e){return ae("reverse")},n.prototype.concat=function(t,e){return ae("concat")},n.prototype.neg=function(t){return ae("neg")},n.prototype.add=function(t,e){return ae("add")},n.prototype.addN=function(t){return ae("addN")},n.prototype.subtract=function(t,e){return ae("subtract")},n.prototype.multiply=function(t,e){return ae("multiply")},n.prototype.realDivide=function(t,e){return ae("realDivide")},n.prototype.floorDiv=function(t,e){return ae("floorDiv")},n.prototype.sum=function(t,e){return ae("sum")},n.prototype.prod=function(t,e){return ae("prod")},n.prototype.unsortedSegmentSum=function(t,e,r){return ae("unsortedSegmentSum")},n.prototype.argMin=function(t,e){return ae("argMin")},n.prototype.argMax=function(t,e){return ae("argMax")},n.prototype.equal=function(t,e){return ae("equal")},n.prototype.notEqual=function(t,e){return ae("notEqual")},n.prototype.less=function(t,e){return ae("less")},n.prototype.lessEqual=function(t,e){return ae("lessEqual")},n.prototype.greater=function(t,e){return ae("greater")},n.prototype.greaterEqual=function(t,e){return ae("greaterEqual")},n.prototype.logicalNot=function(t){return ae("logicalNot")},n.prototype.logicalAnd=function(t,e){return ae("logicalAnd")},n.prototype.logicalOr=function(t,e){return ae("logicalOr")},n.prototype.where=function(t){return ae("where")},n.prototype.select=function(t,e,r){return ae("select")},n.prototype.topk=function(t,e,r){return ae("topk")},n.prototype.min=function(t,e){return ae("min")},n.prototype.minimum=function(t,e){return ae("minimum")},n.prototype.mod=function(t,e){return ae("mod")},n.prototype.max=function(t,e){return ae("max")},n.prototype.maximum=function(t,e){return ae("maximum")},n.prototype.all=function(t,e){return ae("all")},n.prototype.any=function(t,e){return ae("any")},n.prototype.squaredDifference=function(t,e){return ae("squaredDifference")},n.prototype.ceil=function(t){return ae("ceil")},n.prototype.floor=function(t){return ae("floor")},n.prototype.round=function(t){return ae("round")},n.prototype.sign=function(t){return ae("sign")},n.prototype.isNaN=function(t){return ae("isNaN")},n.prototype.isInf=function(t){return ae("isInf")},n.prototype.isFinite=function(t){return ae("isFinite")},n.prototype.pow=function(t,e){return ae("pow")},n.prototype.exp=function(t){return ae("exp")},n.prototype.expm1=function(t){return ae("expm1")},n.prototype.softmax=function(t,e){return ae("softmax")},n.prototype.log=function(t){return ae("log")},n.prototype.log1p=function(t){return ae("log1p")},n.prototype.sqrt=function(t){return ae("sqrt")},n.prototype.rsqrt=function(t){return ae("rsqrt")},n.prototype.square=function(t){return ae("square")},n.prototype.reciprocal=function(t){return ae("reciprocal")},n.prototype.relu=function(t){return ae("relu")},n.prototype.relu6=function(t){return ae("relu6")},n.prototype.prelu=function(t,e){return ae("prelu")},n.prototype.elu=function(t){return ae("elu")},n.prototype.eluDer=function(t,e){return ae("eluDer")},n.prototype.selu=function(t){return ae("selu")},n.prototype.int=function(t){return ae("int")},n.prototype.clip=function(t,e,r){return ae("clip")},n.prototype.abs=function(t){return ae("abs")},n.prototype.complexAbs=function(t){return ae("complexAbs")},n.prototype.sigmoid=function(t){return ae("sigmoid")},n.prototype.softplus=function(t){return ae("softplus")},n.prototype.sin=function(t){return ae("sin")},n.prototype.cos=function(t){return ae("cos")},n.prototype.tan=function(t){return ae("tan")},n.prototype.asin=function(t){return ae("asin")},n.prototype.acos=function(t){return ae("acos")},n.prototype.atan=function(t){return ae("atan")},n.prototype.atan2=function(t,e){return ae("atan2")},n.prototype.sinh=function(t){return ae("sinh")},n.prototype.cosh=function(t){return ae("cosh")},n.prototype.tanh=function(t){return ae("tanh")},n.prototype.asinh=function(t){return ae("asinh")},n.prototype.acosh=function(t){return ae("acosh")},n.prototype.atanh=function(t){return ae("atanh")},n.prototype.erf=function(t){return ae("erf")},n.prototype.step=function(t,e){return ae("step")},n.prototype.fusedConv2d=function(t){return t.input,t.filter,t.convInfo,t.bias,t.activation,t.preluActivationWeights,ae("fusedConv2d")},n.prototype.conv2d=function(t,e,r){return ae("conv2d")},n.prototype.conv2dDerInput=function(t,e,r){return ae("conv2dDerInput")},n.prototype.conv2dDerFilter=function(t,e,r){return ae("conv2dDerFilter")},n.prototype.fusedDepthwiseConv2D=function(t){return t.input,t.filter,t.convInfo,t.bias,t.activation,t.preluActivationWeights,ae("fusedDepthwiseConv2D")},n.prototype.depthwiseConv2D=function(t,e,r){return ae("depthwiseConv2D")},n.prototype.depthwiseConv2DDerInput=function(t,e,r){return ae("depthwiseConv2DDerInput")},n.prototype.depthwiseConv2DDerFilter=function(t,e,r){return ae("depthwiseConv2DDerFilter")},n.prototype.conv3d=function(t,e,r){return ae("conv3d")},n.prototype.conv3dDerInput=function(t,e,r){return ae("conv3dDerInput")},n.prototype.conv3dDerFilter=function(t,e,r){return ae("conv3dDerFilter")},n.prototype.maxPool=function(t,e){return ae("maxPool")},n.prototype.maxPoolBackprop=function(t,e,r,a){return ae("maxPoolBackprop")},n.prototype.avgPool=function(t,e){return ae("avgPool")},n.prototype.avgPoolBackprop=function(t,e,r){return ae("avgPoolBackprop")},n.prototype.avgPool3d=function(t,e){return ae("avgPool3d")},n.prototype.avgPool3dBackprop=function(t,e,r){return ae("avgPool3dBackprop")},n.prototype.maxPool3d=function(t,e){return ae("maxPool3d")},n.prototype.maxPool3dBackprop=function(t,e,r,a){return ae("maxPool3dBackprop")},n.prototype.reshape=function(t,e){return ae("reshape")},n.prototype.cast=function(t,e){return ae("cast")},n.prototype.tile=function(t,e){return ae("tile")},n.prototype.pad=function(t,e,r){return ae("pad")},n.prototype.transpose=function(t,e){return ae("transpose")},n.prototype.gather=function(t,e,r){return ae("gather")},n.prototype.gatherND=function(t,e){return ae("gatherND")},n.prototype.scatterND=function(t,e,r){return ae("scatterND")},n.prototype.batchToSpaceND=function(t,e,r){return ae("batchToSpaceND")},n.prototype.spaceToBatchND=function(t,e,r){return ae("spaceToBatchND")},n.prototype.resizeBilinear=function(t,e,r,a){return ae("resizeBilinear")},n.prototype.resizeBilinearBackprop=function(t,e,r){return ae("resizeBilinearBackprop")},n.prototype.resizeNearestNeighbor=function(t,e,r,a){return ae("resizeNearestNeighbor")},n.prototype.resizeNearestNeighborBackprop=function(t,e,r){return ae("resizeNearestNeighborBackprop")},n.prototype.batchNormalization=function(t,e,r,a,i,u){return ae("batchNormalization")},n.prototype.localResponseNormalization4D=function(t,e,r,a,i){return ae("localResponseNormalization4D")},n.prototype.LRNGrad=function(t,e,r,a,i,u,l){return ae("LRNGrad")},n.prototype.multinomial=function(t,e,r,a){return ae("multinomial")},n.prototype.oneHot=function(t,e,r,a){return ae("oneHot")},n.prototype.cumsum=function(t,e,r,a){return ae("cumsum")},n.prototype.nonMaxSuppression=function(t,e,r,a,i){return ae("nonMaxSuppression")},n.prototype.fft=function(t){return ae("fft")},n.prototype.ifft=function(t){return ae("ifft")},n.prototype.complex=function(t,e){return ae("complex")},n.prototype.real=function(t){return ae("real")},n.prototype.imag=function(t){return ae("imag")},n.prototype.cropAndResize=function(t,e,r,a,i,u){return ae("cropAndResize")},n.prototype.depthToSpace=function(t,e,r){return ae("depthToSpace")},n.prototype.split=function(t,e,r){return ae("split")},n.prototype.sparseToDense=function(t,e,r,a){return ae("sparseToDense")},n.prototype.diag=function(t){return ae("diag")},n.prototype.fill=function(t,e,r){return ae("fill")},n.prototype.onesLike=function(t){return ae("onesLike")},n.prototype.zerosLike=function(t){return ae("zerosLike")},n.prototype.linspace=function(t,e,r){return ae("linspace")},n.prototype.dispose=function(){return ae("dispose")},n}();function ae(n){throw new Error("'"+n+"' not yet implemented or not found in the registry. Did you forget to import the kernel?")}function li(n,t){for(var e=n.length,r=[],a=0;a<e;a++){var i=e-1-a,u=n[i]||1;(t[t.length-1-a]||1)>1&&u===1&&r.unshift(i)}return r}function qt(n,t){for(var e=[],r=0;r<t.length;r++){var a=n[n.length-r-1],i=t.length-r-1,u=t[i];(a==null||a===1&&u>1)&&e.unshift(i)}return e}function Xe(n,t){for(var e=[],r=Math.max(n.length,t.length),a=0;a<r;a++){var i=n[n.length-a-1];i==null&&(i=1);var u=t[t.length-a-1];if(u==null&&(u=1),i===1)e.unshift(u);else if(u===1)e.unshift(i);else{if(i!==u)throw Error("Operands could not be broadcast together with shapes "+n+" and "+t+".");e.unshift(i)}}return e}function Yu(n,t,e,r,a,i,u){u===void 0&&(u="channelsLast");var l,c=Bf(t),f=c[0],d=c[1];if(u==="channelsLast")l=[f,d,n[3],n[3]];else{if(u!=="channelsFirst")throw new Error("Unknown dataFormat "+u);l=[f,d,n[1],n[1]]}return io(n,l,e,r,a,i,!1,u)}function If(n,t,e,r,a,i,u){u===void 0&&(u="NDHWC");var l,c,f=um(t),d=f[0],v=f[1],m=f[2];if(u==="NDHWC")c="channelsLast",l=[d,v,m,n[4],n[4]];else{if(u!=="NCDHW")throw new Error("Unknown dataFormat "+u);c="channelsFirst",l=[d,v,m,n[1],n[1]]}return Ff(n,l,e,r,a,!1,c,i)}function io(n,t,e,r,a,i,u,l){u===void 0&&(u=!1),l===void 0&&(l="channelsLast");var c=[-1,-1,-1,-1],f=c[0],d=c[1],v=c[2],m=c[3];if(l==="channelsLast")f=n[0],d=n[1],v=n[2],m=n[3];else{if(l!=="channelsFirst")throw new Error("Unknown dataFormat "+l);f=n[0],m=n[1],d=n[2],v=n[3]}var g,b=t[0],w=t[1],S=t[3],E=Bf(e),_=E[0],R=E[1],C=Bf(r),A=C[0],D=C[1],O=cs(b,A),F=cs(w,D),N=function(ee,te,L,W,$,ne,M,j){var ie,oe,de;if(typeof ee=="number"){ie={top:ee,bottom:ee,left:ee,right:ee,type:ee===0?"VALID":"NUMBER"};var me=function(Ne,Le,We,tt,ft){tt==null&&(tt=hE(Ne,Le,We));var st=Ne[0],Dt=Ne[1],er=Uu((st-Le+2*tt)/We+1,ft);P(Nt(er),function(){return"The output # of rows ("+er+") must be an integer. Change the stride and/or zero pad parameters"});var hn=Uu((Dt-Le+2*tt)/We+1,ft);return P(Nt(hn),function(){return"The output # of columns ("+hn+") must be an integer. Change the stride and/or zero pad parameters"}),[er,hn]}([te,L],ne,W,ee,j);oe=me[0],de=me[1]}else if(ee==="same"){oe=Math.ceil(te/W),de=Math.ceil(L/$);var ve=Math.max(0,(oe-1)*W+ne-te),Ae=Math.max(0,(de-1)*$+M-L),ye=Math.floor(ve/2),De=ve-ye,Qe=Math.floor(Ae/2);ie={top:ye,bottom:De,left:Qe,right:Ae-Qe,type:"SAME"}}else{if(ee!=="valid")throw Error("Unknown padding parameter: "+ee);ie={top:0,bottom:0,left:0,right:0,type:"VALID"},oe=Math.ceil((te-ne+1)/W),de=Math.ceil((L-M+1)/$)}return{padInfo:ie,outHeight:oe,outWidth:de}}(a,d,v,_,R,O,F,i),B=N.padInfo,H=N.outHeight,U=N.outWidth,J=u?S*m:S;return l==="channelsFirst"?g=[f,J,H,U]:l==="channelsLast"&&(g=[f,H,U,J]),{batchSize:f,dataFormat:l,inHeight:d,inWidth:v,inChannels:m,outHeight:H,outWidth:U,outChannels:J,padInfo:B,strideHeight:_,strideWidth:R,filterHeight:b,filterWidth:w,effectiveFilterHeight:O,effectiveFilterWidth:F,dilationHeight:A,dilationWidth:D,inShape:n,outShape:g,filterShape:t}}function Ff(n,t,e,r,a,i,u,l){i===void 0&&(i=!1),u===void 0&&(u="channelsLast");var c=[-1,-1,-1,-1,-1],f=c[0],d=c[1],v=c[2],m=c[3],g=c[4];if(u==="channelsLast")f=n[0],d=n[1],v=n[2],m=n[3],g=n[4];else{if(u!=="channelsFirst")throw new Error("Unknown dataFormat "+u);f=n[0],g=n[1],d=n[2],v=n[3],m=n[4]}var b,w=t[0],S=t[1],E=t[2],_=t[4],R=um(e),C=R[0],A=R[1],D=R[2],O=um(r),F=O[0],N=O[1],B=O[2],H=cs(w,F),U=cs(S,N),J=cs(E,B),ee=function(M,j,ie,oe,de,me,ve,Ae,ye,De,Qe){var Ne,Le,We,tt;if(typeof M=="number"){Ne={top:M,bottom:M,left:M,right:M,front:M,back:M,type:M===0?"VALID":"NUMBER"};var ft=function(Ma,br,ra,Mt,Lt,an){Lt==null&&(Lt=hE(Ma,br,Mt));var bh=Ma[0],xh=Ma[1],wh=Ma[2],Ia=Uu((bh-br+2*Lt)/Mt+1,an);P(Nt(Ia),function(){return"The output # of depths ("+Ia+") must be an integer. Change the stride and/or zero pad parameters"});var Fa=Uu((xh-br+2*Lt)/Mt+1,an);P(Nt(Fa),function(){return"The output # of rows ("+Fa+") must be an integer. Change the stride and/or zero pad parameters"});var xr=Uu((wh-br+2*Lt)/Mt+1,an);return P(Nt(xr),function(){return"The output # of columns ("+xr+") must be an integer. Change the stride and/or zero pad parameters"}),[Ia,Fa,xr,ra]}([j,ie,oe,1],Ae,1,de,M,Qe);Le=ft[0],We=ft[1],tt=ft[2]}else if(M==="same"){Le=Math.ceil(j/de),We=Math.ceil(ie/me),tt=Math.ceil(oe/ve);var st=(Le-1)*de+Ae-j,Dt=(We-1)*me+ye-ie,er=(tt-1)*ve+De-oe,hn=Math.floor(st/2),na=st-hn,An=Math.floor(Dt/2),kr=Dt-An,tr=Math.floor(er/2);Ne={top:An,bottom:kr,left:tr,right:er-tr,front:hn,back:na,type:"SAME"}}else{if(M!=="valid")throw Error("Unknown padding parameter: "+M);Ne={top:0,bottom:0,left:0,right:0,front:0,back:0,type:"VALID"},Le=Math.ceil((j-Ae+1)/de),We=Math.ceil((ie-ye+1)/me),tt=Math.ceil((oe-De+1)/ve)}return{padInfo:Ne,outDepth:Le,outHeight:We,outWidth:tt}}(a,d,v,m,C,A,D,H,U,J,l),te=ee.padInfo,L=ee.outDepth,W=ee.outHeight,$=ee.outWidth,ne=i?_*g:_;return u==="channelsFirst"?b=[f,ne,L,W,$]:u==="channelsLast"&&(b=[f,L,W,$,ne]),{batchSize:f,dataFormat:u,inDepth:d,inHeight:v,inWidth:m,inChannels:g,outDepth:L,outHeight:W,outWidth:$,outChannels:ne,padInfo:te,strideDepth:C,strideHeight:A,strideWidth:D,filterDepth:w,filterHeight:S,filterWidth:E,effectiveFilterDepth:H,effectiveFilterHeight:U,effectiveFilterWidth:J,dilationDepth:F,dilationHeight:N,dilationWidth:B,inShape:n,outShape:b,filterShape:t}}function hE(n,t,e,r){r===void 0&&(r=1);var a=cs(t,r);return Math.floor((n[0]*(e-1)-e+a)/2)}function Bf(n){return typeof n=="number"?[n,n,n]:n.length===2?[n[0],n[1],1]:n}function um(n){return typeof n=="number"?[n,n,n]:n}function cs(n,t){return t<=1?n:n+(n-1)*(t-1)}function Uu(n,t){if(!t)return n;switch(t){case"round":return Math.round(n);case"ceil":return Math.ceil(n);case"floor":return Math.floor(n);default:throw new Error("Unknown roundingMode "+t)}}function _s(n){var t=Bf(n),e=t[0],r=t[1],a=t[2];return e===1&&r===1&&a===1}function Pn(n,t){return _s(n)||_s(t)}function Ym(n){if(n==="NHWC")return"channelsLast";if(n==="NCHW")return"channelsFirst";throw new Error("Unknown dataFormat "+n)}function dE(n,t,e){if(t==="complex64"){if(n.dtype==="complex64")return n.clone();var r=mt(n.shape),a=n.toFloat(),i=e.complex(a,r);return r.dispose(),a.dispose(),i}if(!dM(n.dtype,t))return q.makeTensorFromDataId(n.dataId,n.shape,t);if(n.dtype==="complex64"){var u=e.real(n);return i=u.cast(t),u.dispose(),i}if(t==="int32")return e.int(n);if(t==="bool"){var l=ge(0,n.dtype);return i=e.notEqual(n,l),l.dispose(),i}throw new Error("Error in Cast: failed to cast "+n.dtype+" to "+t)}function lm(n,t){return q.makeTensorFromDataId(n.dataId,t,n.dtype)}function pE(n,t,e){var r=(t-n)/(e-1),a=ll(e,"float32");a[0]=n;for(var i=1;i<a.length;i++)a[i]=a[i-1]+r;return Pt(a,"float32")}function cm(n,t){if(n.length!==t.length)throw new Error("Cannot merge real and imag arrays of different lengths. real:"+n.length+", imag: "+t.length+".");for(var e=new Float32Array(2*n.length),r=0;r<e.length;r+=2)e[r]=n[r/2],e[r+1]=t[r/2];return e}function ww(n,t){return{real:n[2*t],imag:n[2*t+1]}}function HI(n,t,e,r){n[2*r]=t,n[2*r+1]=e}function VI(n,t,e){var r=(e?2:-2)*Math.PI*(n/t);return{real:Math.cos(r),imag:Math.sin(r)}}function WI(n,t,e){var r=function(i,u,l){return function(c,f,d){for(var v=0,m=c.length,g=0,b=!1;v<m;){var w=d(f,c[g=v+(m-v>>>1)]);w>0?v=g+1:(m=g,b=!w)}return b?v:-v-1}(i,u,l||GI)}(n,t,e),a=r<0?-(r+1):r;n.splice(a,0,t)}function GI(n,t){return n>t?1:n<t?-1:0}function Qm(n,t,e,r,a){return vE(n,t,e,r,a,0).selectedIndices}function Jm(n,t,e,r,a,i){var u=vE(n,t,e,r,a,i);return u.numValidOutputs.dispose(),{selectedIndices:u.selectedIndices,selectedScores:u.selectedScores}}function vE(n,t,e,r,a,i,u,l){l===void 0&&(l=!1);for(var c=Array.from(t).map(function(C,A){return{score:C,boxIndex:A,suppressBeginIndex:0}}).filter(function(C){return C.score>a}).sort(Sw),f=i>0?-.5/i:0,d=[],v=[];d.length<e&&c.length>0;){var m=c.pop(),g=m.score,b=m.boxIndex,w=m.suppressBeginIndex;if(g<a)break;for(var S=!1,E=d.length-1;E>=w;--E){var _=jI(n,b,d[E]);if(_>=r){S=!0;break}if(m.score=m.score*qI(r,f,_),m.score<=a)break}m.suppressBeginIndex=d.length,S||(m.score===g?(d.push(b),v.push(m.score)):m.score>a&&WI(c,m,Sw))}var R=d.length;return l&&(d.fill(0,R),v.fill(0,R)),{selectedIndices:Pt(d,"int32"),selectedScores:Pt(v,"float32"),numValidOutputs:ge(R,"int32")}}function jI(n,t,e){var r=n.subarray(4*t,4*t+4),a=n.subarray(4*e,4*e+4),i=Math.min(r[0],r[2]),u=Math.min(r[1],r[3]),l=Math.max(r[0],r[2]),c=Math.max(r[1],r[3]),f=Math.min(a[0],a[2]),d=Math.min(a[1],a[3]),v=Math.max(a[0],a[2]),m=Math.max(a[1],a[3]),g=(l-i)*(c-u),b=(v-f)*(m-d);if(g<=0||b<=0)return 0;var w=Math.max(i,f),S=Math.max(u,d),E=Math.min(l,v),_=Math.min(c,m),R=Math.max(E-w,0)*Math.max(_-S,0);return R/(g+b-R)}function qI(n,t,e){var r=Math.exp(t*e*e);return e<=n?r:0}function Sw(n,t){return n.score-t.score||n.score===t.score&&t.boxIndex-n.boxIndex}function mE(n,t,e){var r=new Array(n.rank).fill(0),a=n.shape.slice();return t.map(function(i){a[e]=i;var u=n.slice(r,a);return r[e]+=i,u})}function gE(n,t){for(var e=new Array(n.rank),r=0;r<e.length;r++)e[r]=n.shape[r]*t[r];var a=Pe(e,n.dtype);for(r=0;r<a.values.length;++r){for(var i=a.indexToLoc(r),u=new Array(n.rank),l=0;l<u.length;l++)u[l]=i[l]%n.shape[l];var c=n.locToIndex(u);a.values[r]=n.values[c]}return a.toTensor()}function yE(n,t,e,r,a){for(var i=t[t.length-1],u=[n.length/i,i],l=u[0],c=u[1],f=Ku(e,l*r),d=Ku("int32",l*r),v=0;v<l;v++){for(var m=v*c,g=n.subarray(m,m+c),b=[],w=0;w<g.length;w++)b.push({value:g[w],index:w});b.sort(function(C,A){return A.value-C.value});var S=v*r,E=f.subarray(S,S+r),_=d.subarray(S,S+r);for(w=0;w<r;w++)E[w]=b[w].value,_[w]=b[w].index}var R=t.slice();return R[R.length-1]=r,[fn(f,R,e),fn(d,R,"int32")]}function eg(n,t){for(var e=[],r=0;r<t.length;r++)t[r]&&e.push(r);var a=Pe(n,"int32"),i=Pe([e.length,n.length],"int32");for(r=0;r<e.length;r++){var u=a.indexToLoc(e[r]),l=r*n.length;i.values.set(u,l)}return i.toTensor()}var $I=function(n,t){this.outputShape=[],this.outputShape=n,this.variableNames=t.map(function(a,i){return"T"+i});var e=[];this.variableNames.forEach(function(a){e.push("float v"+a+" = get"+a+"AtOutCoords();")});var r=this.variableNames.map(function(a){return"v"+a}).join(" + ");this.userCode=`
      void main() {
        `+e.join(`
        `)+`

        float result = `+r+`;
        setOutput(result);
      }
    `},KI=function(n,t){this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n,this.variableNames=t.map(function(a,i){return"T"+i});var e=[];this.variableNames.forEach(function(a){e.push("vec4 v"+a+" = get"+a+"AtOutCoords();")});var r=this.variableNames.map(function(a){return"v"+a}).join(" + ");this.userCode=`
      void main() {
        `+e.join(`
        `)+`

        vec4 result = `+r+`;
        setOutput(result);
      }
    `},XI=function(n,t,e){this.variableNames=["A"];var r=n.windowSize,a=n.batchSize,i=n.inSize,u=Math.ceil(i/r);e||this.variableNames.push("bestIndicesA"),this.outputShape=[a,u];var l=t==="max"?">":"<",c=e?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));";this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * `+r+`;

        int bestIndex = inOffset;
        float bestValue = getA(batch, bestIndex);

        for (int i = 0; i < `+r+`; i++) {
          int inIdx = `+c+`;
          float candidate = getA(batch, inIdx);
          if (candidate `+l+` bestValue) {
            bestValue = candidate;
            bestIndex = inIdx;
          }
        }
        setOutput(float(bestIndex));
      }
    `};function bE(n,t){return["x","y","z","w","u","v"].slice(0,t).map(function(e){return n+"."+e})}function In(n,t){return t===1?[n]:bE(n,t)}function yn(){var n,t,e,r,a,i,u,l,c,f;return ue().getNumber("WEBGL_VERSION")===2?(n="#version 300 es",t="in",e="out",r="in",a="texture",i="outputColor",u="out vec4 outputColor;",l=`
      bool isnan_custom(float val) {
        return (val > 0.0 || val < 0.0) ? false : val != 0.0;
      }

      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan_custom(val.x),
          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));
      }

      #define isnan(value) isnan_custom(value)
    `,c="",f=`
      #define round(value) newRound(value)
      int newRound(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 newRound(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `):(n="",t="attribute",e="varying",r="varying",a="texture2D",i="gl_FragColor",u="",l=`
      #define isnan(value) isnan_custom(value)
      bool isnan_custom(float val) {
        return (val > 0. || val < 1. || val == 0.) ? false : true;
      }
      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));
      }
    `,c=`
      uniform float INFINITY;

      bool isinf(float val) {
        return abs(val) == INFINITY;
      }
      bvec4 isinf(vec4 val) {
        return equal(abs(val), vec4(INFINITY));
      }
    `,f=`
      int round(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 round(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `),{version:n,attribute:t,varyingVs:e,varyingFs:r,texture2D:a,output:i,defineOutput:u,defineSpecialNaN:l,defineSpecialInf:c,defineRound:f}}function ji(n,t,e){e===void 0&&(e="index");var r=$r(t);return r.map(function(a,i){return"int "+n[i]+" = "+e+" / "+a+"; "+(i===r.length-1?"int "+n[i+1]+" = "+e+" - "+n[i]+" * "+a:"index -= "+n[i]+" * "+a)+";"}).join("")}function tg(n){var t=$r(n).map(function(e){return e.toString()});return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * `+t[0]+" + coords.y * "+t[1]+` + coords.z;
  }
`}var xE=`
  const float FLOAT_MAX = 1.70141184e38;
  const float FLOAT_MIN = 1.17549435e-38;

  lowp vec4 encode_float(highp float v) {
    if (isnan(v)) {
      return vec4(255, 255, 255, 255);
    }

    highp float av = abs(v);

    if(av < FLOAT_MIN) {
      return vec4(0.0, 0.0, 0.0, 0.0);
    } else if(v > FLOAT_MAX) {
      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;
    } else if(v < -FLOAT_MAX) {
      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;
    }

    highp vec4 c = vec4(0,0,0,0);

    highp float e = floor(log2(av));
    highp float m = exp2(fract(log2(av))) - 1.0;

    c[2] = floor(128.0 * m);
    m -= c[2] / 128.0;
    c[1] = floor(32768.0 * m);
    m -= c[1] / 32768.0;
    c[0] = floor(8388608.0 * m);

    highp float ebias = e + 127.0;
    c[3] = floor(ebias / 2.0);
    ebias -= c[3] * 2.0;
    c[2] += floor(ebias) * 128.0;

    c[3] += 128.0 * step(0.0, -v);

    return c / 255.0;
  }
`;function ZI(n,t,e,r){var a=[];n.forEach(function(g){var b=Ee(g.shapeInfo.logicalShape);g.shapeInfo.isUniform?a.push("uniform float "+g.name+(b>1?"["+b+"]":"")+";"):(a.push("uniform sampler2D "+g.name+";"),a.push("uniform int offset"+g.name+";"))});var i,u,l=a.join(`
`),c=n.map(function(g){return function(b,w,S){S===void 0&&(S=!1);var E="";E+=S?wE(b):ts(b);var _=b.shapeInfo.logicalShape,R=w.logicalShape;return _.length<=R.length&&(E+=S?function(C,A){var D,O=C.name,F=O.charAt(0).toUpperCase()+O.slice(1),N="get"+F+"AtOutCoords",B=C.shapeInfo.logicalShape.length,H=A.logicalShape.length,U=li(C.shapeInfo.logicalShape,A.logicalShape),J=pt(H),ee=H-B,te=["x","y","z","w","u","v"];D=B===0?"":H<2&&U.length>=1?"coords = 0;":U.map(function(ie){return"coords."+te[ie+ee]+" = 0;"}).join(`
`);var L="";L=H<2&&B>0?"coords":C.shapeInfo.logicalShape.map(function(ie,oe){return"coords."+te[oe+ee]}).join(", ");var W="return outputValue;",$=Ee(C.shapeInfo.logicalShape)===1,ne=Ee(A.logicalShape)===1;if(B!==1||$||ne){if($&&!ne)W=H===1?`
        return vec4(outputValue.x, outputValue.x, 0., 0.);
      `:`
        return vec4(outputValue.x);
      `;else if(U.length){var M=B-2,j=B-1;U.indexOf(M)>-1&&U.indexOf(j)>-1?W="return vec4(outputValue.x);":U.indexOf(M)>-1?W="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":U.indexOf(j)>-1&&(W="return vec4(outputValue.xx, outputValue.zz);")}}else W=`
      return vec4(outputValue.xy, outputValue.xy);
    `;return`
    vec4 `+N+`() {
      `+J+` coords = getOutputCoords();
      `+D+`
      vec4 outputValue = get`+F+"("+L+`);
      `+W+`
    }
  `}(b,w):function(C,A){var D=C.name,O=D.charAt(0).toUpperCase()+D.slice(1),F="get"+O+"AtOutCoords",N=A.texShape,B=C.shapeInfo.texShape,H=C.shapeInfo.logicalShape.length,U=A.logicalShape.length;if(!C.shapeInfo.isUniform&&H===U&&C.shapeInfo.flatOffset==null&&nn(B,N))return`
      float `+F+`() {
        return sampleTexture(`+D+`, resultUV);
      }
    `;var J,ee=pt(U),te=li(C.shapeInfo.logicalShape,A.logicalShape),L=U-H,W=["x","y","z","w","u","v"];J=H===0?"":U<2&&te.length>=1?"coords = 0;":te.map(function(ne){return"coords."+W[ne+L]+" = 0;"}).join(`
`);var $="";return $=U<2&&H>0?"coords":C.shapeInfo.logicalShape.map(function(ne,M){return"coords."+W[M+L]}).join(", "),`
    float `+F+`() {
      `+ee+` coords = getOutputCoords();
      `+J+`
      return get`+O+"("+$+`);
    }
  `}(b,w)),E}(g,t,r)}).join(`
`),f=t.texShape,d=yn(),v=function(g){return`
    float sampleTexture(sampler2D textureSampler, vec2 uv) {
      return `+g.texture2D+`(textureSampler, uv).r;
    }
  `}(d),m=function(g){return g.version+`
    precision highp float;
    precision highp int;
    precision highp sampler2D;
    `+g.varyingFs+` vec2 resultUV;
    `+g.defineOutput+`
    const vec2 halfCR = vec2(0.5, 0.5);

    struct ivec5
    {
      int x;
      int y;
      int z;
      int w;
      int u;
    };

    struct ivec6
    {
      int x;
      int y;
      int z;
      int w;
      int u;
      int v;
    };

    uniform float NAN;
    `+g.defineSpecialNaN+`
    `+g.defineSpecialInf+`
    `+g.defineRound+`

    int imod(int x, int y) {
      return x - y * (x / y);
    }

    int idiv(int a, int b, float sign) {
      int res = a / b;
      int mod = imod(a, b);
      if (sign < 0. && mod != 0) {
        res -= 1;
      }
      return res;
    }

    //Based on the work of Dave Hoskins
    //https://www.shadertoy.com/view/4djSRW
    #define HASHSCALE1 443.8975
    float random(float seed){
      vec2 p = resultUV * seed;
      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);
      p3 += dot(p3, p3.yzx + 19.19);
      return fract((p3.x + p3.y) * p3.z);
    }

    `+YI+`
    `+QI+`
    `+JI+`
  `}(d);return t.isPacked?(i=function(g,b){switch(g.length){case 0:return`
    int getOutputCoords() {
      return 0;
    }
  `;case 1:return function(C,A){var D=[Math.ceil(A[0]/2),Math.ceil(A[1]/2)];return D[0]===1?`
      int getOutputCoords() {
        return 2 * int(resultUV.x * `+D[1]+`.0);
      }
    `:D[1]===1?`
      int getOutputCoords() {
        return 2 * int(resultUV.y * `+D[0]+`.0);
      }
    `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+D[0]+", "+D[1]+`));
      return 2 * (resTexRC.x * `+D[1]+` + resTexRC.y);
    }
  `}(0,b);case 2:return function(C,A){var D=[Math.ceil(A[0]/2),Math.ceil(A[1]/2)];if(nn(C,A))return`
      ivec2 getOutputCoords() {
        return 2 * ivec2(resultUV.yx * vec2(`+D[0]+", "+D[1]+`));
      }
    `;var O=Math.ceil(C[1]/2);return`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+D[0]+", "+D[1]+`));

      int index = resTexRC.x * `+D[1]+` + resTexRC.y;
      int r = 2 * (index / `+O+`);
      int c = imod(index, `+O+`) * 2;

      return ivec2(r, c);
    }
  `}(g,b);case 3:return w=g,S=b,E=[Math.ceil(S[0]/2),Math.ceil(S[1]/2)],_=Math.ceil(w[2]/2),R=_*Math.ceil(w[1]/2),`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+E[0]+", "+E[1]+`));
      int index = resTexRC.x * `+E[1]+` + resTexRC.y;

      int b = index / `+R+`;
      index -= b * `+R+`;

      int r = 2 * (index / `+_+`);
      int c = imod(index, `+_+`) * 2;

      return ivec3(b, r, c);
    }
  `;default:return function(C,A){for(var D=[Math.ceil(A[0]/2),Math.ceil(A[1]/2)],O=Math.ceil(C[C.length-1]/2),F=O*Math.ceil(C[C.length-2]/2),N=F,B="",H="b, r, c",U=2;U<C.length-1;U++)N*=C[C.length-U-1],B=`
      int b`+U+" = index / "+N+`;
      index -= b`+U+" * "+N+`;
    `+B,H="b"+U+", "+H;return`
    ivec`+C.length+` getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+D[0]+", "+D[1]+`));
      int index = resTexRC.x * `+D[1]+` + resTexRC.y;

      `+B+`

      int b = index / `+F+`;
      index -= b * `+F+`;

      int r = 2 * (index / `+O+`);
      int c = imod(index, `+O+`) * 2;

      return ivec`+C.length+"("+H+`);
    }
  `}(g,b)}var w,S,E,_,R}(t.logicalShape,f),u=function(g){return`
    void setOutput(vec4 val) {
      `+g.output+` = val;
    }
  `}(d)):(i=function(g,b){switch(g.length){case 0:return`
    int getOutputCoords() {
      return 0;
    }
  `;case 1:return function(E,_){return _[0]===1?`
      int getOutputCoords() {
        return int(resultUV.x * `+_[1]+`.0);
      }
    `:_[1]===1?`
      int getOutputCoords() {
        return int(resultUV.y * `+_[0]+`.0);
      }
    `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+_[0]+", "+_[1]+`));
      return resTexRC.x * `+_[1]+` + resTexRC.y;
    }
  `}(0,b);case 2:return function(E,_){return nn(E,_)?`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(`+_[0]+", "+_[1]+`));
      }
    `:E[1]===1?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(`+_[0]+", "+_[1]+`));
        int index = resTexRC.x * `+_[1]+` + resTexRC.y;
        return ivec2(index, 0);
      }
    `:E[0]===1?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(`+_[0]+", "+_[1]+`));
        int index = resTexRC.x * `+_[1]+` + resTexRC.y;
        return ivec2(0, index);
      }
    `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+_[0]+", "+_[1]+`));
      int index = resTexRC.x * `+_[1]+` + resTexRC.y;
      int r = index / `+E[1]+`;
      int c = index - r * `+E[1]+`;
      return ivec2(r, c);
    }
  `}(g,b);case 3:return w=b,S=ji(["r","c","d"],g),`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+w[0]+", "+w[1]+`));
      int index = resTexRC.x * `+w[1]+` + resTexRC.y;
      `+S+`
      return ivec3(r, c, d);
    }
  `;case 4:return function(E,_){var R=ji(["r","c","d","d2"],E);return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(`+_[0]+", "+_[1]+`));
      int index = resTexRC.x * `+_[1]+` + resTexRC.y;
      `+R+`
      return ivec4(r, c, d, d2);
    }
  `}(g,b);case 5:return function(E,_){var R=ji(["r","c","d","d2","d3"],E);return`
    ivec5 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx * vec2(`+_[0]+`,
                             `+_[1]+`));

      int index = resTexRC.x * `+_[1]+` + resTexRC.y;

      `+R+`

      ivec5 outShape = ivec5(r, c, d, d2, d3);
      return outShape;
    }
  `}(g,b);case 6:return function(E,_){var R=ji(["r","c","d","d2","d3","d4"],E);return`
    ivec6 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(`+_[0]+", "+_[1]+`));
      int index = resTexRC.x * `+_[1]+` + resTexRC.y;

      `+R+`

      ivec6 result = ivec6(r, c, d, d2, d3, d4);
      return result;
    }
  `}(g,b);default:throw new Error(g.length+"-D output sampling is not yet supported")}var w,S}(t.logicalShape,f),u=function(g){return`
    void setOutput(float val) {
      `+g.output+` = vec4(val, 0, 0, 0);
    }
  `}(d)),r&&(m+=eF),[m,v,u,l,i,c,e].join(`
`)}function ts(n){var t=n.shapeInfo.logicalShape;switch(t.length){case 0:return function(e){var r=e.name,a="get"+r.charAt(0).toUpperCase()+r.slice(1);if(e.shapeInfo.isUniform)return"float "+a+"() {return "+r+";}";var i=e.shapeInfo.texShape,u=i[0],l=i[1];if(u===1&&l===1)return`
      float `+a+`() {
        return sampleTexture(`+r+`, halfCR);
      }
    `;var c=e.shapeInfo.texShape,f=c[0],d=c[1],v=Ui(r);return`
    float `+a+`() {
      vec2 uv = uvFromFlat(`+f+", "+d+", "+v+`);
      return sampleTexture(`+r+`, uv);
    }
  `}(n);case 1:return function(e){var r=e.name,a="get"+r.charAt(0).toUpperCase()+r.slice(1);if(e.shapeInfo.isUniform)return`
      float `+a+`(int index) {
        `+Zo(e)+`
      }
    `;var i=e.shapeInfo.texShape,u=i[0],l=i[1];if(l===1&&u===1)return`
      float `+a+`(int index) {
        return sampleTexture(`+r+`, halfCR);
      }
    `;var c=Ui(r);return l===1?`
      float `+a+`(int index) {
        vec2 uv = vec2(0.5, (float(index + `+c+") + 0.5) / "+u+`.0);
        return sampleTexture(`+r+`, uv);
      }
    `:u===1?`
      float `+a+`(int index) {
        vec2 uv = vec2((float(index + `+c+") + 0.5) / "+l+`.0, 0.5);
        return sampleTexture(`+r+`, uv);
      }
    `:`
    float `+a+`(int index) {
      vec2 uv = uvFromFlat(`+u+", "+l+", index + "+c+`);
      return sampleTexture(`+r+`, uv);
    }
  `}(n);case 2:return function(e){var r=e.shapeInfo.logicalShape,a=e.name,i="get"+a.charAt(0).toUpperCase()+a.slice(1),u=e.shapeInfo.texShape;if(u!=null&&nn(r,u)){var l=u[0],c=u[1];return`
    float `+i+`(int row, int col) {
      vec2 uv = (vec2(col, row) + halfCR) / vec2(`+c+".0, "+l+`.0);
      return sampleTexture(`+a+`, uv);
    }
  `}var f=Wi(r),d=f.newShape,v=f.keptDims,m=d;if(m.length<r.length){var g=ns(e,m);return`
      `+ts(g)+`
      float `+i+`(int row, int col) {
        return `+i+"("+rs(["row","col"],v)+`);
      }
    `}if(e.shapeInfo.isUniform)return`
      float `+i+`(int row, int col) {
        int index = round(dot(vec2(row, col), vec2(`+r[1]+`, 1)));
        `+Zo(e)+`
      }
    `;var b=u[0],w=u[1],S=Ui(a);return w===1?`
    float `+i+`(int row, int col) {
      float index = dot(vec3(row, col, `+S+"), vec3("+r[1]+`, 1, 1));
      vec2 uv = vec2(0.5, (index + 0.5) / `+b+`.0);
      return sampleTexture(`+a+`, uv);
    }
  `:b===1?`
    float `+i+`(int row, int col) {
      float index = dot(vec3(row, col, `+S+"), vec3("+r[1]+`, 1, 1));
      vec2 uv = vec2((index + 0.5) / `+w+`.0, 0.5);
      return sampleTexture(`+a+`, uv);
    }
  `:`
  float `+i+`(int row, int col) {
    // Explicitly use integer operations as dot() only works on floats.
    int index = row * `+r[1]+" + col + "+S+`;
    vec2 uv = uvFromFlat(`+b+", "+w+`, index);
    return sampleTexture(`+a+`, uv);
  }
`}(n);case 3:return function(e){var r=e.shapeInfo.logicalShape,a=e.name,i="get"+a.charAt(0).toUpperCase()+a.slice(1),u=r[1]*r[2],l=r[2],c=Wi(r),f=c.newShape,d=c.keptDims,v=f;if(v.length<r.length){var m=ns(e,v);return`
        `+ts(m)+`
        float `+i+`(int row, int col, int depth) {
          return `+i+"("+rs(["row","col","depth"],d)+`);
        }
      `}if(e.shapeInfo.isUniform)return`
      float `+i+`(int row, int col, int depth) {
        int index = round(dot(vec3(row, col, depth),
                          vec3(`+u+", "+l+`, 1)));
        `+Zo(e)+`
      }
    `;var g=e.shapeInfo.texShape,b=g[0],w=g[1],S=e.shapeInfo.flatOffset;if(w===u&&S==null)return`
        float `+i+`(int row, int col, int depth) {
          float texR = float(row);
          float texC = dot(vec2(col, depth), vec2(`+l+`, 1));
          vec2 uv = (vec2(texC, texR) + halfCR) /
                     vec2(`+w+".0, "+b+`.0);
          return sampleTexture(`+a+`, uv);
        }
      `;if(w===l&&S==null)return`
    float `+i+`(int row, int col, int depth) {
      float texR = dot(vec2(row, col), vec2(`+r[1]+`, 1));
      float texC = float(depth);
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(`+w+".0, "+b+`.0);
      return sampleTexture(`+a+`, uv);
    }
  `;var E=Ui(a);return`
      float `+i+`(int row, int col, int depth) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * `+u+" + col * "+l+" + depth + "+E+`;
        vec2 uv = uvFromFlat(`+b+", "+w+`, index);
        return sampleTexture(`+a+`, uv);
      }
  `}(n);case 4:return function(e){var r=e.shapeInfo.logicalShape,a=e.name,i="get"+a.charAt(0).toUpperCase()+a.slice(1),u=r[3],l=r[2]*u,c=r[1]*l,f=Wi(r),d=f.newShape,v=f.keptDims;if(d.length<r.length){var m=ns(e,d);return`
      `+ts(m)+`
      float `+i+`(int row, int col, int depth, int depth2) {
        return `+i+"("+rs(["row","col","depth","depth2"],v)+`);
      }
    `}if(e.shapeInfo.isUniform)return`
      float `+i+`(int row, int col, int depth, int depth2) {
        int index = round(dot(vec4(row, col, depth, depth2),
                          vec4(`+c+", "+l+", "+u+`, 1)));
        `+Zo(e)+`
      }
    `;var g=e.shapeInfo.flatOffset,b=e.shapeInfo.texShape,w=b[0],S=b[1];if(S===c&&g==null)return`
      float `+i+`(int row, int col, int depth, int depth2) {
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(`+l+", "+u+`, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(`+S+".0, "+w+`.0);
        return sampleTexture(`+a+`, uv);
      }
    `;if(S===u&&g==null)return`
      float `+i+`(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(`+r[1]*r[2]+", "+r[2]+`, 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(`+S+".0, "+w+`.0);
        return sampleTexture(`+a+`, uv);
      }
    `;var E=Ui(a);return`
    float `+i+`(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * `+c+" + col * "+l+` +
          depth * `+u+` + depth2;
      vec2 uv = uvFromFlat(`+w+", "+S+", index + "+E+`);
      return sampleTexture(`+a+`, uv);
    }
  `}(n);case 5:return function(e){var r=e.shapeInfo.logicalShape,a=e.name,i="get"+a.charAt(0).toUpperCase()+a.slice(1),u=r[4],l=r[3]*u,c=r[2]*l,f=r[1]*c,d=Wi(r),v=d.newShape,m=d.keptDims;if(v.length<r.length){var g=ns(e,v);return`
      `+ts(g)+`
      float `+i+`(int row, int col, int depth, int depth2, int depth3) {
        return `+i+"("+rs(["row","col","depth","depth2","depth3"],m)+`);
      }
    `}if(e.shapeInfo.isUniform)return`
      float `+i+`(int row, int col, int depth, int depth2, int depth3) {
        float index = dot(
          vec4(row, col, depth, depth2),
          vec4(`+f+", "+c+", "+l+", "+u+`)) +
          depth3;
        `+Zo(e)+`
      }
    `;var b=e.shapeInfo.flatOffset,w=e.shapeInfo.texShape,S=w[0],E=w[1];if(E===f&&b==null)return`
      float `+i+`(int row, int col, int depth, int depth2, int depth3) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
                         vec4(`+c+", "+l+", "+u+`, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(`+E+".0, "+S+`.0);
        return sampleTexture(`+a+`, uv);
      }
    `;if(E===u&&b==null)return`
      float `+i+`(int row, int col, int depth, int depth2, int depth3) {
        float texR = dot(
          vec4(row, col, depth, depth2),
          vec4(`+r[1]*r[2]*r[3]+`,
               `+r[2]*r[3]+", "+r[3]+`, 1));
        int texC = depth3;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(`+E+".0, "+S+`.0);
        return sampleTexture(`+a+`, uv);
      }
    `;var _=Ui(a);return`
    float `+i+`(int row, int col, int depth, int depth2, int depth3) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * `+f+" + col * "+c+" + depth * "+l+` +
          depth2 * `+u+" + depth3 + "+_+`;
      vec2 uv = uvFromFlat(`+S+", "+E+`, index);
      return sampleTexture(`+a+`, uv);
    }
  `}(n);case 6:return function(e){var r=e.shapeInfo.logicalShape,a=e.name,i="get"+a.charAt(0).toUpperCase()+a.slice(1),u=Wi(r),l=u.newShape,c=u.keptDims;if(l.length<r.length){var f=ns(e,l);return`
      `+ts(f)+`
      float `+i+`(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        return `+i+"("+rs(["row","col","depth","depth2","depth3","depth4"],c)+`);
      }
    `}var d=r[5],v=r[4]*d,m=r[3]*v,g=r[2]*m,b=r[1]*g;if(e.shapeInfo.isUniform)return`
      float `+i+`(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
        int index = round(dot(
          vec4(row, col, depth, depth2),
          vec4(`+b+", "+g+", "+m+", "+v+`)) +
          dot(
            vec2(depth3, depth4),
            vec2(`+d+`, 1)));
        `+Zo(e)+`
      }
    `;var w=e.shapeInfo.flatOffset,S=e.shapeInfo.texShape,E=S[0],_=S[1];if(_===b&&w==null)return`
      float `+i+`(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
          vec4(`+g+", "+m+", "+v+", "+d+`)) +
               float(depth4);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(`+_+".0, "+E+`.0);
        return sampleTexture(`+a+`, uv);
      }
    `;if(_===d&&w==null)return`
      float `+i+`(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        float texR = dot(vec4(row, col, depth, depth2),
          vec4(`+r[1]*r[2]*r[3]*r[4]+`,
               `+r[2]*r[3]*r[4]+`,
               `+r[3]*r[4]+`,
               `+r[4]+`)) + float(depth3);
        int texC = depth4;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(`+_+".0, "+E+`.0);
        return sampleTexture(`+a+`, uv);
      }
    `;var R=Ui(a);return`
    float `+i+`(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * `+b+" + col * "+g+" + depth * "+m+` +
          depth2 * `+v+" + depth3 * "+d+" + depth4 + "+R+`;
      vec2 uv = uvFromFlat(`+E+", "+_+`, index);
      return sampleTexture(`+a+`, uv);
    }
  `}(n);default:throw new Error(t.length+"-D input sampling is not yet supported")}}function wE(n){var t,e,r;switch(n.shapeInfo.logicalShape.length){case 0:return t=n.name,e="get"+t.charAt(0).toUpperCase()+t.slice(1),r=yn(),`
    vec4 `+e+`() {
      return `+r.texture2D+"("+t+`, halfCR);
    }
  `;case 1:return function(a){var i=a.name,u="get"+i.charAt(0).toUpperCase()+i.slice(1),l=a.shapeInfo.texShape,c=[Math.ceil(l[0]/2),Math.ceil(l[1]/2)],f=yn();return`
    vec4 `+u+`(int index) {
      vec2 uv = packedUVfrom1D(
        `+c[0]+", "+c[1]+`, index);
      return `+f.texture2D+"("+i+`, uv);
    }
  `}(n);case 2:return function(a){var i=a.shapeInfo.logicalShape,u=a.name,l="get"+u.charAt(0).toUpperCase()+u.slice(1),c=a.shapeInfo.texShape,f=c[0],d=c[1],v=yn();if(c!=null&&nn(i,c))return`
      vec4 `+l+`(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(`+d+".0, "+f+`.0);

        return `+v.texture2D+"("+u+`, uv);
      }
    `;var m=[Math.ceil(c[0]/2),Math.ceil(c[1]/2)],g=Math.ceil(i[1]/2);return`
    vec4 `+l+`(int row, int col) {
      vec2 uv = packedUVfrom2D(`+g+", "+m[0]+", "+m[1]+`, row, col);
      return `+v.texture2D+"("+u+`, uv);
    }
  `}(n);case 3:return function(a){var i=a.shapeInfo.logicalShape,u=a.name,l="get"+u.charAt(0).toUpperCase()+u.slice(1),c=a.shapeInfo.texShape,f=[Math.ceil(c[0]/2),Math.ceil(c[1]/2)];if(i[0]===1){var d=i.slice(1),v=ns(a,d);return`
        `+wE(v)+`
        vec4 `+l+`(int b, int row, int col) {
          return `+l+"("+rs(["b","row","col"],[1,2])+`);
        }
      `}var m=f[0],g=f[1],b=Math.ceil(i[2]/2),w=b*Math.ceil(i[1]/2),S=yn();return`
    vec4 `+l+`(int b, int row, int col) {
      vec2 uv = packedUVfrom3D(
        `+m+", "+g+", "+w+", "+b+`, b, row, col);
      return `+S.texture2D+"("+u+`, uv);
    }
  `}(n);default:return function(a){for(var i=a.shapeInfo.logicalShape,u=i.length,l=a.name,c="get"+l.charAt(0).toUpperCase()+l.slice(1),f=a.shapeInfo.texShape,d=[Math.ceil(f[0]/2),Math.ceil(f[1]/2)],v=d[0],m=d[1],g=Math.ceil(i[u-1]/2),b=g*Math.ceil(i[u-2]/2),w="int b, int row, int col",S="b * "+b+" + (row / 2) * "+g+" + (col / 2)",E=2;E<u-1;E++)w="int b"+E+", "+w,b*=i[u-E-1],S="b"+E+" * "+b+" + "+S;var _=yn();return`
    vec4 `+c+"("+w+`) {
      int index = `+S+`;
      int texR = index / `+m+`;
      int texC = index - texR * `+m+`;
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(`+m+", "+v+`);
      return `+_.texture2D+"("+l+`, uv);
    }
  `}(n)}}var YI=`
vec2 uvFromFlat(int texNumR, int texNumC, int index) {
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
vec2 packedUVfrom1D(int texNumR, int texNumC, int index) {
  int texelIndex = index / 2;
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,QI=`
vec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,
  int texNumC, int row, int col) {
  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,JI=`
vec2 packedUVfrom3D(int texNumR, int texNumC,
    int texelsInBatch, int texelsInLogicalRow, int b,
    int row, int col) {
  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,eF=`
  float getChannel(vec4 frag, vec2 innerDims) {
    vec2 modCoord = mod(innerDims, 2.);
    return modCoord.x == 0. ?
      (modCoord.y == 0. ? frag.r : frag.g) :
      (modCoord.y == 0. ? frag.b : frag.a);
  }
  float getChannel(vec4 frag, int dim) {
    float modCoord = mod(float(dim), 2.);
    return modCoord == 0. ? frag.r : frag.g;
  }
`;function Ui(n){return"offset"+n}function Zo(n){var t=n.name,e=Ee(n.shapeInfo.logicalShape);return e<2?"return "+t+";":`
    for (int i = 0; i < `+e+`; i++) {
      if (i == index) {
        return `+t+`[i];
      }
    }
  `}function pt(n){if(n<=1)return"int";if(n===2)return"ivec2";if(n===3)return"ivec3";if(n===4)return"ivec4";if(n===5)return"ivec5";if(n===6)return"ivec6";throw Error("GPU for rank "+n+" is not yet supported")}function ns(n,t){var e=JSON.parse(JSON.stringify(n));return e.shapeInfo.logicalShape=t,e}function rs(n,t){return t.map(function(e){return n[e]}).join(", ")}var tF=function(n,t,e,r){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,P(n.length>2,function(){return"Packed arg"+(e.charAt(0).toUpperCase()+e.slice(1))+" supports only inputs with rank above 2."});var a=n[n.length-1],i=Math.ceil(a/t);this.outputShape=n.slice(0,-1),i>1&&this.outputShape.push(i),r||this.variableNames.push("bestIndicesA");var u,l,c=this.outputShape,f=c.length,d=pt(f),v=In("coords",f);if(i===1){var m=pt(l=f+1);u=`
        `+m+" sourceLocR = "+m+"("+v.join()+`, 0);
        ++`+v[f-1]+`;
        `+m+" sourceLocG = "+m+"("+v.join()+`, 0);
        ++`+v[f-2]+`;
        `+m+" sourceLocA = "+m+"("+v.join()+`, 0);
        --`+v[f-1]+`;
        `+m+" sourceLocB = "+m+"("+v.join()+`, 0);
        --`+v[f-2]+";"}else l=f,u=`
        `+d+` sourceLocR = coords;
        ++`+v[f-1]+`;
        `+d+` sourceLocG = coords;
        ++`+v[f-2]+`;
        `+d+` sourceLocA = coords;
        --`+v[f-1]+`;
        `+d+` sourceLocB = coords;
        --`+v[f-2]+";";var g=["x","y","z","w","u","v"].slice(0,l),b="."+g[l-1],w=g.map(function(F){return"int "+F}),S=In("sourceLocR",l-1).concat("inIdx.r"),E=In("sourceLocG",l-1).concat("inIdx.g"),_=In("sourceLocB",l-1).concat("inIdx.b"),R=In("sourceLocA",l-1).concat("inIdx.a"),C=e==="max"?"greaterThan":"lessThan",A=r?"":`
          inIdx = round(vec4(getBestIndicesAChannel(`+S.join()+`),
                             getBestIndicesAChannel(`+E.join()+`),
                             getBestIndicesAChannel(`+_.join()+`),
                             getBestIndicesAChannel(`+R.join()+")));",D=`vec4(
            getAChannel(`+S.join()+`),
            hasNextCol ? getAChannel(`+E.join()+`) : 0.,
            hasNextRow ? getAChannel(`+_.join()+`) : 0.,
            hasNextRow && hasNextCol ? getAChannel(`+R.join()+") : 0.)",O=r?"":`
      float getBestIndicesAChannel(`+w.join()+`) {
        return getChannel(getBestIndicesA(`+g.join()+`),
                                          vec2(`+g.slice(-2).join()+`));
      }`;this.userCode=`
      float getAChannel(`+w.join()+`) {
        return getChannel(getA(`+g.join()+`),
                               vec2(`+g.slice(-2).join()+`));
      }
      `+O+`
      void main() {
        `+d+` coords = getOutputCoords();
        bool hasNextCol = `+v[f-1]+" < "+(c[f-1]-1)+`;
        bool hasNextRow = `+v[f-2]+" < "+(c[f-2]-1)+`;
        `+u+`
        ivec4 srcIdx = ivec4(sourceLocR`+b+", sourceLocG"+b+`,
          sourceLocB`+b+", sourceLocA"+b+") * "+t+`;
        ivec4 inIdx = srcIdx;
        vec4 bestIndex = vec4(inIdx);
        vec4 bestValue = `+D+`;

        for (int i = 0; i < `+t+`; i++) {
          inIdx = srcIdx;
          `+A+`
          vec4 candidate = `+D+`;
          bvec4 nan = isnan(candidate);
          bvec4 replace = bvec4(
            vec4(`+C+`(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));

          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,
                           replace.y  ? candidate.y : bestValue.y,
                           replace.z  ? candidate.z : bestValue.z,
                           replace.w  ? candidate.w : bestValue.w);
          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));
          srcIdx++;
        }
        setOutput(bestIndex);
      }
    `},nF=function(n){this.variableNames=["dy"],this.outputShape=n.inShape;var t=n.filterHeight,e=n.filterWidth,r=n.strideHeight,a=n.strideWidth,i=n.dilationHeight,u=n.dilationWidth,l=n.effectiveFilterHeight,c=n.effectiveFilterWidth,f=l-1-n.padInfo.top,d=c-1-n.padInfo.left,v=1/(t*e);this.userCode=`
      const ivec2 pads = ivec2(`+f+", "+d+`);
      const float avgMultiplier = float(`+v+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < `+l+`;
            wR += `+i+`) {
          float dyR = float(dyRCorner + wR) / `+r+`.0;

          if (dyR < 0.0 || dyR >= `+n.outHeight+`.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < `+c+`;
            wC+= `+u+`) {
            float dyC = float(dyCCorner + wC) / `+a+`.0;

            if (dyC < 0.0 || dyC >= `+n.outWidth+`.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);

            dotProd += dyValue * avgMultiplier;
          }
        }
        setOutput(dotProd);
      }
    `},rF=function(n){this.variableNames=["dy"],this.outputShape=n.inShape;var t=n.filterDepth,e=n.filterHeight,r=n.filterWidth,a=n.strideDepth,i=n.strideHeight,u=n.strideWidth,l=n.dilationDepth,c=n.dilationHeight,f=n.dilationWidth,d=n.effectiveFilterDepth,v=n.effectiveFilterHeight,m=n.effectiveFilterWidth,g=d-1-n.padInfo.front,b=v-1-n.padInfo.top,w=m-1-n.padInfo.left,S=1/(t*e*r);this.userCode=`
      const ivec3 pads = ivec3(`+g+", "+b+", "+w+`);
      const float avgMultiplier = float(`+S+`);

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < `+d+`;
            wD += `+l+`) {
          float dyD = float(dyDCorner + wD) / `+a+`.0;

          if (dyD < 0.0 || dyD >= `+n.outDepth+`.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < `+v+`;
              wR += `+c+`) {
            float dyR = float(dyRCorner + wR) / `+i+`.0;

            if (dyR < 0.0 || dyR >= `+n.outHeight+`.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < `+m+`;
                wC += `+f+`) {
              float dyC = float(dyCCorner + wC) / `+u+`.0;

              if (dyC < 0.0 || dyC >= `+n.outWidth+`.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);

              dotProd += dyValue * avgMultiplier;
            }
          }
        }
        setOutput(dotProd);
      }
    `},aF=function(n,t,e,r,a,i){this.outputShape=[],this.variableNames=["x","mean","variance"],Xe(n,t),Xe(n,e);var u="0.0";r!=null&&(Xe(n,r),this.variableNames.push("offset"),u="getOffsetAtOutCoords()");var l="1.0";a!=null&&(Xe(n,a),this.variableNames.push("scale"),l="getScaleAtOutCoords()"),this.outputShape=n,this.userCode=`
      void main() {
        float x = getXAtOutCoords();
        float mean = getMeanAtOutCoords();
        float variance = getVarianceAtOutCoords();
        float offset = `+u+`;
        float scale = `+l+`;
        float inv = scale * inversesqrt(variance + float(`+i+`));
        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));
      }
    `},iF=function(n,t,e,r,a,i){this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],Xe(n,t),Xe(n,e);var u="vec4(0.0)";r!=null&&(Xe(n,r),this.variableNames.push("offset"),u="getOffsetAtOutCoords()");var l="vec4(1.0)";a!=null&&(Xe(n,a),this.variableNames.push("scale"),l="getScaleAtOutCoords()"),this.outputShape=n,this.userCode=`
      void main() {
        vec4 offset = `+u+`;
        vec4 scale = `+l+`;

        vec4 x = getXAtOutCoords();
        vec4 mean = getMeanAtOutCoords();
        vec4 variance = getVarianceAtOutCoords();

        vec4 inv = scale * inversesqrt(variance + vec4(`+i+`));

        setOutput((x - mean) * inv + offset);
      }
    `},oF="return areal * breal - aimag * bimag;",sF="return areal * bimag + aimag * breal;",Ew=function(n,t,e){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=Xe(t,e),this.userCode=`
      float binaryOpComplex(
          float areal, float aimag, float breal, float bimag) {
        `+n+`
      }

      void main() {
        float areal = getARealAtOutCoords();
        float aimag = getAImagAtOutCoords();
        float breal = getBRealAtOutCoords();
        float bimag = getBImagAtOutCoords();
        setOutput(binaryOpComplex(areal, aimag, breal, bimag));
      }
    `},sv="return a + b;",uv="return a - b;",_w="return a * b;",SE="return (a < 0.) ? b * a : a;",Tt=function(n,t,e){this.variableNames=["A","B"],this.outputShape=Xe(t,e),this.userCode=`
      float binaryOperation(float a, float b) {
        `+n+`
      }

      void main() {
        float a = getAAtOutCoords();
        float b = getBAtOutCoords();
        setOutput(binaryOperation(a, b));
      }
    `},EE=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`,xa=function(n,t,e,r){r===void 0&&(r=!1),this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=Xe(t,e);var a=this.outputShape.length,i="";if(r)if(a===0||Ee(this.outputShape)===1)i=`
          result.y = 0.;
          result.z = 0.;
          result.w = 0.;
        `;else if(i=`
          `+pt(a)+` coords = getOutputCoords();
        `,a===1)i+=`
            result.y = (coords + 1) >= `+this.outputShape[0]+` ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `;else{var u=In("coords",a);i+=`
            bool nextRowOutOfBounds =
              (`+u[a-2]+" + 1) >= "+this.outputShape[a-2]+`;
            bool nextColOutOfBounds =
              (`+u[a-1]+" + 1) >= "+this.outputShape[a-1]+`;
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `}this.userCode=`
      vec4 binaryOperation(vec4 a, vec4 b) {
        `+n+`
      }

      void main() {
        vec4 a = getAAtOutCoords();
        vec4 b = getBAtOutCoords();

        vec4 result = binaryOperation(a, b);
        `+i+`

        setOutput(result);
      }
    `},uF=function(){function n(t){this.variableNames=["A"],this.outputShape=t,this.userCode=`
      uniform float minVal;
      uniform float maxVal;

      void main() {
        float value = getAAtOutCoords();
        if (isnan(value)) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, minVal, maxVal));
      }
    `}return n.prototype.getCustomSetupFunc=function(t,e){var r=this;return function(a,i){r.minLoc==null&&(r.minLoc=a.getUniformLocationNoThrow(i,"minVal"),r.maxLoc=a.getUniformLocationNoThrow(i,"maxVal")),a.gl.uniform1f(r.minLoc,t),a.gl.uniform1f(r.maxLoc,e)}},n}(),lF=function(){function n(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.userCode=`
      uniform float minVal;
      uniform float maxVal;

      void main() {
        vec4 value = getAAtOutCoords();

        if (any(isnan(value))) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));
      }
    `}return n.prototype.getCustomSetupFunc=function(t,e){var r=this;return function(a,i){r.minLoc==null&&(r.minLoc=a.getUniformLocationNoThrow(i,"minVal"),r.maxLoc=a.getUniformLocationNoThrow(i,"maxVal")),a.gl.uniform1f(r.minLoc,t),a.gl.uniform1f(r.maxLoc,e)}},n}(),cF=function(n){this.variableNames=["real","imag"],this.outputShape=n,this.userCode=`
      void main() {
        float re = abs(getRealAtOutCoords());
        float im = abs(getImagAtOutCoords());
        float mx = max(re, im);

        // sadly the length function in glsl is not underflow-safe
        // (at least not on Intel GPUs). So the safe solution is
        // to ensure underflow-safety in all cases.
        setOutput(
          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))
        );
      }
    `},fF=function(n){this.outputShape=[],this.outputShape=Es(n,1),this.variableNames=n.map(function(l,c){return"T"+c});var t=new Array(n.length-1);t[0]=n[0][1];for(var e=1;e<t.length;e++)t[e]=t[e-1]+n[e][1];var r=["if (yC < "+t[0]+") setOutput(getT0(yR, yC));"];for(e=1;e<t.length;e++){var a=t[e-1];r.push("else if (yC < "+t[e]+") setOutput(getT"+e+"(yR, yC-"+a+"));")}var i=t.length,u=t[t.length-1];r.push("else setOutput(getT"+i+"(yR, yC-"+u+"));"),this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int yR = coords.x;
        int yC = coords.y;

        `+r.join(`
        `)+`
      }
    `},hF=function(n,t){this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=Es(n,t);var e=this.outputShape,r=e.length,a=pt(r),i=In("coords",r),u=["x","y","z","w","u","v"].slice(0,r);this.variableNames=n.map(function(S,E){return"T"+E});var l=new Array(n.length-1);l[0]=n[0][t];for(var c=1;c<l.length;c++)l[c]=l[c-1]+n[c][t];var f=u[t],d=u.slice(-2),v=u.join(),m="if ("+f+" < "+l[0]+`) {
        return getChannel(
            getT0(`+v+"), vec2("+d.join()+`));
        }`;for(c=1;c<l.length;c++){var g=l[c-1];m+=`
        if (`+f+" < "+l[c]+"  && "+f+" >= "+l[c-1]+`) {
          return getChannel(
            getT`+c+"("+Gc(u,f,g)+`),
            vec2(`+Gc(d,f,g)+`));
        }`}var b=l.length,w=l[l.length-1];m+=`
        return getChannel(
          getT`+b+"("+Gc(u,f,w)+`),
          vec2(`+Gc(d,f,w)+"));",this.userCode=`
      float getValue(`+u.map(function(S){return"int "+S})+`) {
        `+m+`
      }

      void main() {
        `+a+` coords = getOutputCoords();
        vec4 result = vec4(getValue(`+i+`), 0., 0., 0.);

        `+i[r-1]+" = "+i[r-1]+` + 1;
        if (`+i[r-1]+" < "+e[r-1]+`) {
          result.g = getValue(`+i+`);
        }

        `+i[r-2]+" = "+i[r-2]+` + 1;
        if (`+i[r-2]+" < "+e[r-2]+`) {
          result.a = getValue(`+i+`);
        }

        `+i[r-1]+" = "+i[r-1]+` - 1;
        if (`+i[r-2]+" < "+e[r-2]+` &&
            `+i[r-1]+" < "+e[r-1]+`) {
          result.b = getValue(`+i+`);
        }
        setOutput(result);
      }
    `};function Gc(n,t,e){var r=n.indexOf(t);return n.map(function(a,i){return i===r?a+" - "+e:a}).join()}var dF=function(n){this.variableNames=["x","dy"],this.outputShape=n.filterShape;var t=n.strideHeight,e=n.strideWidth,r=n.padInfo.top,a=n.padInfo.left,i=n.dataFormat==="channelsLast";this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int d2 = coords.w;

        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int b = 0; b < `+n.batchSize+`; b++) {
          for (int yR = 0; yR < `+n.outHeight+`; yR++) {
            int xR = wR + yR * `+t+" - "+r+`;

            if (xR < 0 || xR >= `+n.inHeight+`) {
              continue;
            }

            for (int yC = 0; yC < `+n.outWidth+`; yC++) {
              int xC = wC + yC * `+e+" - "+a+`;

              if (xC < 0 || xC >= `+n.inWidth+`) {
                continue;
              }

              if (`+i+`) {
                float dyValue = getDy(b, yR, yC, d2);
                float xValue = getX(b, xR, xC, d1);
                dotProd += (xValue * dyValue);
              } else {
                float dyValue = getDy(b, d2, yR, yC);
                float xValue = getX(b, d1, xR, xC);
                dotProd += (xValue * dyValue);
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `},pF=function(n){this.variableNames=["dy","W"],this.outputShape=n.inShape;var t=n.filterHeight,e=n.filterWidth,r=n.strideHeight,a=n.strideWidth,i=n.dataFormat==="channelsLast",u=t-1-n.padInfo.top,l=e-1-n.padInfo.left,c=i?1:2,f=i?2:3,d=i?3:1;this.userCode=`
      const ivec2 pads = ivec2(`+u+", "+l+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[`+d+`];

        ivec2 dyCorner = ivec2(coords[`+c+"], coords["+f+`]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < `+t+`; wR++) {
          float dyR = float(dyRCorner + wR) / `+r+`.0;

          if (dyR < 0.0 || dyR >= `+n.outHeight+`.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = `+t+` - 1 - wR;

          for (int wC = 0; wC < `+e+`; wC++) {
            float dyC = float(dyCCorner + wC) / `+a+`.0;

            if (dyC < 0.0 || dyC >= `+n.outWidth+`.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = `+e+` - 1 - wC;

            for (int d2 = 0; d2 < `+n.outChannels+`; d2++) {

              if (`+i+`) {
                float xValue = getDy(batch, idyR, idyC, d2);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              } else {
                float xValue = getDy(batch, d2, idyR, idyC);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `},vF=function(n){this.variableNames=["x","dy"],this.outputShape=n.filterShape;var t=n.strideDepth,e=n.strideHeight,r=n.strideWidth,a=n.padInfo.front,i=n.padInfo.top,u=n.padInfo.left;this.userCode=`
      void main() {
        ivec5 coords = getOutputCoords();
        int wF = coords.x;
        int wR = coords.y;
        int wC = coords.z;
        int d1 = coords.w;
        int d2 = coords.u;

        float dotProd = 0.0;

        for (int b = 0; b < `+n.batchSize+`; b++) {
          for (int yF = 0; yF < `+n.outDepth+`; yF++) {
            int xF = wF + yF * `+t+" - "+a+`;

            if (xF < 0 || xF >= `+n.inDepth+`) {
              continue;
            }

            for (int yR = 0; yR < `+n.outHeight+`; yR++) {
              int xR = wR + yR * `+e+" - "+i+`;

              if (xR < 0 || xR >= `+n.inHeight+`) {
                continue;
              }

              for (int yC = 0; yC < `+n.outWidth+`; yC++) {
                int xC = wC + yC * `+r+" - "+u+`;

                if (xC < 0 || xC >= `+n.inWidth+`) {
                  continue;
                }

                float dyValue = getDy(b, yF, yR, yC, d2);
                float xValue = getX(b, xF, xR, xC, d1);
                dotProd += (xValue * dyValue);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `},mF=function(n){this.variableNames=["dy","W"],this.outputShape=n.inShape;var t=n.filterDepth,e=n.filterHeight,r=n.filterWidth,a=n.strideDepth,i=n.strideHeight,u=n.strideWidth,l=t-1-n.padInfo.front,c=e-1-n.padInfo.top,f=r-1-n.padInfo.left;this.userCode=`
      const ivec3 pads = ivec3(`+l+", "+c+", "+f+`);

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.u;


        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyFCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        float dotProd = 0.0;
        for (int wF = 0; wF < `+t+`; wF++) {
          float dyF = float(dyFCorner + wF) / `+a+`.0;

          if (dyF < 0.0 || dyF >= `+n.outDepth+`.0 || fract(dyF) > 0.0) {
            continue;
          }
          int idyF = int(dyF);

          int wFPerm = `+t+` - 1 - wF;

          for (int wR = 0; wR < `+e+`; wR++) {
            float dyR = float(dyRCorner + wR) / `+i+`.0;

            if (dyR < 0.0 || dyR >= `+n.outHeight+`.0 ||
              fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            int wRPerm = `+e+` - 1 - wR;

            for (int wC = 0; wC < `+r+`; wC++) {
              float dyC = float(dyCCorner + wC) / `+u+`.0;

              if (dyC < 0.0 || dyC >= `+n.outWidth+`.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              int wCPerm = `+r+` - 1 - wC;

              for (int d2 = 0; d2 < `+n.outChannels+`; d2++) {
                float xValue = getDy(batch, idyF, idyR, idyC, d2);
                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `},gF=function(n){this.variableNames=["x","dy"],this.outputShape=n.filterShape;var t=n.strideHeight,e=n.strideWidth,r=n.padInfo.top,a=n.padInfo.left,i=n.outChannels/n.inChannels;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int dm = coords.w;
        int d2 = d1 * `+i+` + dm;

        float dotProd = 0.0;

        // TO DO: Vec4 over the batch size
        for (int b = 0; b < `+n.batchSize+`; b++) {
          for (int yR = 0; yR < `+n.outHeight+`; yR++) {
            int xR = wR + yR * `+t+" - "+r+`;

            if (xR < 0 || xR >= `+n.inHeight+`) {
              continue;
            }

            for (int yC = 0; yC < `+n.outWidth+`; yC++) {
              int xC = wC + yC * `+e+" - "+a+`;

              if (xC < 0 || xC >= `+n.inWidth+`) {
                continue;
              }

              float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);
            }
          }
        }
        setOutput(dotProd);
      }
    `},yF=function(n){this.variableNames=["dy","W"],this.outputShape=n.inShape;var t=n.filterHeight,e=n.filterWidth,r=n.strideHeight,a=n.strideWidth,i=t-1-n.padInfo.top,u=e-1-n.padInfo.left,l=n.outChannels/n.inChannels;this.userCode=`
      const ivec2 pads = ivec2(`+i+", "+u+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];
        ivec2 dyCorner = coords.yz - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        float dotProd = 0.0;

        for (int wR = 0; wR < `+t+`; wR++) {
          float dyR = float(dyRCorner + wR) / `+r+`.0;

          if (dyR < 0.0 || dyR >= `+n.outHeight+`.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = `+t+` - 1 - wR;

          for (int wC = 0; wC < `+e+`; wC++) {
            float dyC = float(dyCCorner + wC) / `+a+`.0;

            if (dyC < 0.0 || dyC >= `+n.outWidth+`.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = `+e+` - 1 - wC;

            // TO DO: Vec4 over the channelMul
            for (int dm = 0; dm < `+l+`; dm++) {
              int d2 = d1 * `+l+` + dm;
              float xValue = getDy(batch, idyR, idyC, d2);
              float wValue = getW(wRPerm, wCPerm, d1, dm);
              dotProd += xValue * wValue;
            }
          }
        }
        setOutput(dotProd);
      }
    `},Cw=function(n,t,e,r){t===void 0&&(t=!1),e===void 0&&(e=null),r===void 0&&(r=!1),this.variableNames=["x","W"],this.outputShape=n.outShape;var a=n.padInfo.top,i=n.padInfo.left,u=n.strideHeight,l=n.strideWidth,c=n.dilationHeight,f=n.dilationWidth,d=n.filterHeight,v=n.filterWidth,m=4*Math.floor(n.inChannels/4),g=n.inChannels%4,b=n.dataFormat==="channelsLast",w=b?1:2,S=b?2:3,E=b?3:1,_="",R="";e&&(_=r?`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          `+e+`
        }`:`
          float activation(float x) {
            `+e+`
          }
        `,R="result = activation(result);");var C=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),this.userCode=`
      `+_+`

      const ivec2 strides = ivec2(`+u+", "+l+`);
      const ivec2 pads = ivec2(`+a+", "+i+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d2 = coords[`+E+`];

        ivec2 xRCCorner =
            ivec2(coords[`+w+"], coords["+S+`]) * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < `+d+`; wR++) {
          int xR = xRCorner + wR * `+c+`;

          if (xR < 0 || xR >= `+n.inHeight+`) {
            continue;
          }

          for (int wC = 0; wC < `+v+`; wC++) {
            int xC = xCCorner + wC * `+f+`;

            if (xC < 0 || xC >= `+n.inWidth+`) {
              continue;
            }

            for (int d1 = 0; d1 < `+m+`; d1 += 4) {
              vec4 wValues = vec4(
                getW(wR, wC, d1, d2),
                getW(wR, wC, d1 + 1, d2),
                getW(wR, wC, d1 + 2, d2),
                getW(wR, wC, d1 + 3, d2)
              );

              if (`+b+`) {
                vec4 xValues = vec4(
                  getX(batch, xR, xC, d1),
                  getX(batch, xR, xC, d1 + 1),
                  getX(batch, xR, xC, d1 + 2),
                  getX(batch, xR, xC, d1 + 3)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec4 xValues = vec4(
                  getX(batch, d1, xR, xC),
                  getX(batch, d1 + 1, xR, xC),
                  getX(batch, d1 + 2, xR, xC),
                  getX(batch, d1 + 3, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }
            }

            if (`+(g===1)+`) {

              if (`+b+`) {
                dotProd +=
                    getX(batch, xR, xC, `+m+`) *
                    getW(wR, wC, `+m+`, d2);
              } else {
                dotProd +=
                    getX(batch, `+m+`, xR, xC) *
                    getW(wR, wC, `+m+`, d2);
              }

            } else if (`+(g===2)+`) {
              vec2 wValues = vec2(
                getW(wR, wC, `+m+`, d2),
                getW(wR, wC, `+m+` + 1, d2)
              );

              if (`+b+`) {
                vec2 xValues = vec2(
                  getX(batch, xR, xC, `+m+`),
                  getX(batch, xR, xC, `+m+` + 1)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec2 xValues = vec2(
                  getX(batch, `+m+`, xR, xC),
                  getX(batch, `+m+` + 1, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            } else if (`+(g===3)+`) {
              vec3 wValues = vec3(
                getW(wR, wC, `+m+`, d2),
                getW(wR, wC, `+m+` + 1, d2),
                getW(wR, wC, `+m+` + 2, d2)
              );

              if (`+b+`) {
                vec3 xValues = vec3(
                  getX(batch, xR, xC, `+m+`),
                  getX(batch, xR, xC, `+m+` + 1),
                  getX(batch, xR, xC, `+m+` + 2)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec3 xValues = vec3(
                  getX(batch, `+m+`, xR, xC),
                  getX(batch, `+m+` + 1, xR, xC),
                  getX(batch, `+m+` + 2, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            }
          }
        }

        float result = dotProd;
        `+C+`
        `+R+`
        setOutput(result);
      }
    `},bF=function(n){this.variableNames=["x","W"],this.outputShape=n.outShape;var t=n.padInfo.front,e=n.padInfo.top,r=n.padInfo.left,a=n.strideDepth,i=n.strideHeight,u=n.strideWidth,l=n.dilationDepth,c=n.dilationHeight,f=n.dilationWidth,d=n.filterDepth,v=n.filterHeight,m=n.filterWidth,g=4*Math.floor(n.inChannels/4),b=n.inChannels%4;this.userCode=`
      const ivec3 strides = ivec3(`+a+", "+i+", "+u+`);
      const ivec3 pads = ivec3(`+t+", "+e+", "+r+`);

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d2 = coords.u;

        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xFCorner = xFRCCorner.x;
        int xRCorner = xFRCCorner.y;
        int xCCorner = xFRCCorner.z;

        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get
        // y(yF, yR, yC, d2). ? = to be determined. : = across all
        // values in that axis.
        float dotProd = 0.0;
        for (int wF = 0; wF < `+d+`; wF++) {
          int xF = xFCorner + wF * `+l+`;

          if (xF < 0 || xF >= `+n.inDepth+`) {
            continue;
          }

          for (int wR = 0; wR < `+v+`; wR++) {
            int xR = xRCorner + wR * `+c+`;

            if (xR < 0 || xR >= `+n.inHeight+`) {
              continue;
            }

            for (int wC = 0; wC < `+m+`; wC++) {
              int xC = xCCorner + wC * `+f+`;

              if (xC < 0 || xC >= `+n.inWidth+`) {
                continue;
              }

              for (int d1 = 0; d1 < `+g+`; d1 += 4) {
                vec4 xValues = vec4(
                  getX(batch, xF, xR, xC, d1),
                  getX(batch, xF, xR, xC, d1 + 1),
                  getX(batch, xF, xR, xC, d1 + 2),
                  getX(batch, xF, xR, xC, d1 + 3)
                );
                vec4 wValues = vec4(
                  getW(wF, wR, wC, d1, d2),
                  getW(wF, wR, wC, d1 + 1, d2),
                  getW(wF, wR, wC, d1 + 2, d2),
                  getW(wF, wR, wC, d1 + 3, d2)
                );

                dotProd += dot(xValues, wValues);
              }

              if (`+(b===1)+`) {
                dotProd +=
                  getX(batch, xF, xR, xC, `+g+`) *
                  getW(wF, wR, wC, `+g+`, d2);
              } else if (`+(b===2)+`) {
                vec2 xValues = vec2(
                  getX(batch, xF, xR, xC, `+g+`),
                  getX(batch, xF, xR, xC, `+g+` + 1)
                );
                vec2 wValues = vec2(
                  getW(wF, wR, wC, `+g+`, d2),
                  getW(wF, wR, wC, `+g+` + 1, d2)
                );
                dotProd += dot(xValues, wValues);
              } else if (`+(b===3)+`) {
                vec3 xValues = vec3(
                  getX(batch, xF, xR, xC, `+g+`),
                  getX(batch, xF, xR, xC, `+g+` + 1),
                  getX(batch, xF, xR, xC, `+g+` + 2)
                );
                vec3 wValues = vec3(
                  getW(wF, wR, wC, `+g+`, d2),
                  getW(wF, wR, wC, `+g+` + 1, d2),
                  getW(wF, wR, wC, `+g+` + 2, d2)
                );
                dotProd += dot(xValues, wValues);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `},Rw=function(n,t,e,r){t===void 0&&(t=!1),e===void 0&&(e=null),r===void 0&&(r=!1),this.variableNames=["x","W"],this.outputShape=n.outShape;var a=n.inHeight,i=n.inWidth,u=n.padInfo.top,l=n.padInfo.left,c=n.strideHeight,f=n.strideWidth,d=n.dilationHeight,v=n.dilationWidth,m=n.filterHeight,g=n.filterWidth,b=n.outChannels/n.inChannels,w="",S="";e&&(w=r?`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          `+e+`
        }`:`
          float activation(float x) {
            `+e+`
          }
        `,S="result = activation(result);");var E=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),this.userCode=`
      `+w+`

      const ivec2 strides = ivec2(`+c+", "+f+`);
      const ivec2 pads = ivec2(`+u+", "+l+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / `+b+`;
        int q = d2 - d1 * `+b+`;

        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.
        for (int wR = 0; wR < `+m+`; wR++) {
          int xR = xRCorner + wR * `+d+`;

          if (xR < 0 || xR >= `+a+`) {
            continue;
          }

          for (int wC = 0; wC < `+g+`; wC++) {
            int xC = xCCorner + wC * `+v+`;

            if (xC < 0 || xC >= `+i+`) {
              continue;
            }

            float xVal = getX(batch, xR, xC, d1);
            float wVal = getW(wR, wC, d1, q);
            dotProd += xVal * wVal;
          }
        }

        float result = dotProd;
        `+E+`
        `+S+`
        setOutput(result);
      }
    `},Aw=function(n,t,e,r){t===void 0&&(t=!1),e===void 0&&(e=null),r===void 0&&(r=!1),this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n.outShape;for(var a=n.inHeight,i=n.inWidth,u=n.padInfo.top,l=n.padInfo.left,c=n.strideHeight,f=n.strideWidth,d=n.dilationHeight,v=n.dilationWidth,m=n.filterHeight,g=n.filterWidth,b=g,w="int xR; int xC; int xCOffset;",S=0;S<m;S++)for(var E=0;E<g;E++)w+=`
          vec4 xTexelR`+S+"C"+2*E+` = vec4(0.);
          vec4 wR`+S+"C"+E+` = vec4(0.);
          vec4 xR`+S+"C"+E+" = vec4(0.);";for(S=0;S<m;S++)for(var _=0;_<b;_++){if(w+=`
          xR = xRCorner + `+S*d+`;
          xC = xCCorner + `+(E=2*_)*v+`;
        `,f===1){if(E<g&&(w+=l%2==1?`
                xCOffset = xC + 1;
                if(xR >= 0 && xR < `+a+" && xCOffset >= 0 && xCOffset < "+i+`) {
                  xTexelR`+S+"C"+E+` = getX(batch, xR, xCOffset, d1);

                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if(xCOffset + 1 >= `+i+`) {
                    xTexelR`+S+"C"+E+`.zw = vec2(0.);
                  }
                } else {
                  xTexelR`+S+"C"+E+` = vec4(0.);
                }

                xCOffset = xC + 1 - 2;
                if(xR >= 0 && xR < `+a+" && xCOffset >= 0 && xCOffset < "+i+`) {
                  vec4 previous = getX(batch, xR, xCOffset, d1);

                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if(xCOffset + 1 >= `+i+`) {
                    previous.zw = vec2(0.);
                  }

                  xR`+S+"C"+E+" = vec4(previous.zw, xTexelR"+S+"C"+E+`.xy);
                } else {
                  xR`+S+"C"+E+" = vec4(0, 0, xTexelR"+S+"C"+E+`.xy);
                }
              `:`
                if(xR >= 0 && xR < `+a+" && xC >= 0 && xC < "+i+`) {
                  xTexelR`+S+"C"+E+` = getX(batch, xR, xC, d1);
                } else {
                  xTexelR`+S+"C"+E+` = vec4(0.);
                }

                xR`+S+"C"+E+" = xTexelR"+S+"C"+E+`;
              `,E+1<g)){var R=l%2==0?HS(v):v;v%2==0&&l%2==1||v%2!=0&&l%2!=1?(w+=`
                  xCOffset = xC + `+l%2+" + "+R+`;

                  if(xR >= 0 && xR < `+a+` &&
                    xCOffset >= 0 && xCOffset < `+i+`) {
                    xTexelR`+S+"C"+(E+2)+` = getX(batch, xR, xCOffset, d1);
                  }
                `,v>1&&(w+=`
                    xCOffset -= 2;
                    if(xR >= 0 && xR < `+a+` &&
                      xCOffset >= 0 && xCOffset < `+i+`) {
                      xTexelR`+S+"C"+E+` = getX(batch, xR, xCOffset, d1);
                    } else {
                      xTexelR`+S+"C"+E+` = vec4(0.);
                    }
                  `),w+=`
                  xR`+S+"C"+(E+1)+` = vec4(
                    xTexelR`+S+"C"+E+".zw, xTexelR"+S+"C"+(E+2)+`.xy);
                `):w+=`
                  xCOffset = xC + `+R+`;

                  if(xR >= 0 && xR < `+a+` &&
                    xCOffset >= 0 && xCOffset < `+i+`) {
                    xTexelR`+S+"C"+(E+2)+` = getX(batch, xR, xCOffset, d1);
                  }

                  xR`+S+"C"+(E+1)+" = xTexelR"+S+"C"+(E+2)+`;
                `}}else E<g&&(w+=`
              if(xR >= 0 && xR < `+a+`) {
            `,l%2==1?(w+=`
                xCOffset = xC + 1 - `+f+`;
                if(xCOffset >= 0 && xCOffset < `+i+`) {
                  xTexelR`+S+"C"+E+` = getX(batch, xR, xCOffset, d1);
                } else {
                  xTexelR`+S+"C"+E+` = vec4(0.);
                }

                if(xC + 1 >= 0 && xC + 1 < `+i+`) {
                  xTexelR`+S+"C"+(E+2)+` = getX(batch, xR, xC + 1, d1);
                } else {
                  xTexelR`+S+"C"+(E+2)+` = vec4(0.);
                }

                xR`+S+"C"+E+` = vec4(
                  xTexelR`+S+"C"+E+".zw, xTexelR"+S+"C"+(E+2)+`.zw);
              `,E+1<g&&(w+=`
                  vec4 final = vec4(0.);
                  xCOffset = xC + 1 + `+f+`;
                  if(xCOffset >= 0 && xCOffset < `+i+`) {
                    final = getX(batch, xR, xCOffset, d1);
                  }
                  xR`+S+"C"+(E+1)+" = vec4(xTexelR"+S+"C"+(E+2)+`.xy, final.xy);
                `)):(w+=`
                if(xC >= 0 && xC < `+i+`) {
                  xTexelR`+S+"C"+E+` = getX(batch, xR, xC, d1);
                } else {
                  xTexelR`+S+"C"+E+` = vec4(0.);
                }

                xCOffset = xC + `+f+`;
                if(xCOffset >= 0 && xCOffset < `+i+`) {
                  xTexelR`+S+"C"+(E+2)+` = getX(batch, xR, xCOffset, d1);
                } else {
                  xTexelR`+S+"C"+(E+2)+` = vec4(0.);
                }

                xR`+S+"C"+E+` = vec4(
                  xTexelR`+S+"C"+E+".xy, xTexelR"+S+"C"+(E+2)+`.xy);
              `,E+1<g&&(w+=`
                  xR`+S+"C"+(E+1)+` = vec4(
                    xTexelR`+S+"C"+E+".zw, xTexelR"+S+"C"+(E+2)+`.zw);
                `)),w+="}");E<g&&(w+=`
            vec4 wTexelR`+S+"C"+E+" = getW("+S+", "+E+`, d1, q);
            wR`+S+"C"+E+" = vec4(wTexelR"+S+"C"+E+".xz, wTexelR"+S+"C"+E+`.xz);
          `,E+1<g&&(w+=`
              vec4 wTexelR`+S+"C"+(E+1)+" = getW("+S+", "+(E+1)+`, d1, q);
              wR`+S+"C"+(E+1)+` =
                vec4(wTexelR`+S+"C"+(E+1)+".xz, wTexelR"+S+"C"+(E+1)+".xz);"))}for(S=0;S<m;S++)for(E=0;E<g;E++)w+="dotProd += xR"+S+"C"+E+" * wR"+S+"C"+E+";";var C="",A="";e&&(C=r?`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          `+e+`
        }`:`vec4 activation(vec4 x) {
          `+e+`
        }`,A="result = activation(result);");var D=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),this.userCode=`
      `+C+`

      const ivec2 strides = ivec2(`+c+", "+f+`);
      const ivec2 pads = ivec2(`+u+", "+l+`);

      void main() {

        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2;
        int q = 0;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        vec4 dotProd = vec4(0.);

        `+w+`

        vec4 result = dotProd;
        `+D+`
        `+A+`
        setOutput(result);
      }
    `},xF=function(n,t,e,r,a){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];var i=n[0],u=n[1],l=n[2],c=n[3],f=t[0],d=e[0],v=e[1];this.outputShape=[f,d,v,c];var m=r==="bilinear"?1:0,g=[u-1+".0",l-1+".0"],b=g[0],w=g[1],S=d>1?[""+(u-1)/(d-1),"(y2-y1) * height_ratio","y1*"+b+" + float(y)*(height_scale)"]:["0.0","0.0","0.5 * (y1+y2) * "+b],E=S[0],_=S[1],R=S[2],C=v>1?[""+(l-1)/(v-1),"(x2-x1) * width_ratio","x1*"+w+" + float(x)*(width_scale)"]:["0.0","0.0","0.5 * (x1+x2) * "+w],A=C[0],D=C[1],O=C[2];this.userCode=`
      const float height_ratio = float(`+E+`);
      const float width_ratio = float(`+A+`);
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int y = coords[1];
        int x = coords[2];
        int d = coords[3];

        // get box vals
        float y1 = getBoxes(b,0);
        float x1 = getBoxes(b,1);
        float y2 = getBoxes(b,2);
        float x2 = getBoxes(b,3);

        // get image in batch index
        int bInd = round(getBoxInd(b));
        if(bInd < 0 || bInd >= `+i+`) {
          return;
        }

        float height_scale = `+_+`;
        float width_scale = `+D+`;

        float in_y = `+R+`;
        if( in_y < 0.0 || in_y > `+b+` ) {
          setOutput(float(`+a+`));
          return;
        }
        float in_x = `+O+`;
        if( in_x < 0.0 || in_x > `+w+` ) {
          setOutput(float(`+a+`));
          return;
        }

        vec2 sourceFracIndexCR = vec2(in_x,in_y);
        if(`+m+` == 1) {
          // Compute the four integer indices.
          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);
          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));

          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);
          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);
          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);
          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);

          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);

          float top = topLeft + (topRight - topLeft) * fracCR.x;
          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;
          float newValue = top + (bottom - top) * fracCR.y;
          setOutput(newValue);
        } else {
          // Compute the coordinators of nearest neighbor point.
          ivec2 sourceNearestCR = ivec2(floor(
            sourceFracIndexCR + vec2(0.5,0.5)));
          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);
          setOutput(newValue);
        }
      }
    `},wF=function(n,t,e){this.variableNames=["x"],this.outputShape=n;var r=n.length,a=n[n.length-1],i=e?"<":">";this.userCode=`
      int getIndex(int i) {
        `+(e?"return "+a+" -i - 1;":"return i;")+`
      }

      void main() {
        `+pt(r)+` coords = getOutputCoords();
        int end = `+Tw(r,"coords")+`;
        float val = 0.0;
        for (int i = `+a+` - 1; i >= 0; i -= 1) {
          int idx = getIndex(i);
          if (idx `+i+` end) {
            continue;
          }
          if (idx == end && `+t+`) {
            continue;
          }
          `+Tw(r,"coords")+` = idx;
          val += getX(`+function(u,l){if(u===1)return""+l;if(u===2)return l+".x, "+l+".y";if(u===3)return l+".x, "+l+".y, "+l+".z";if(u===4)return l+".x, "+l+".y, "+l+".z, "+l+".w";throw Error("Cumulative sum for rank "+u+" is not yet supported")}(r,"coords")+`);
        }
        setOutput(val);
      }
    `};function Tw(n,t){if(n===1)return""+t;if(n===2)return t+".y";if(n===3)return t+".z";if(n===4)return t+".w";throw Error("Cumulative sum for rank "+n+" is not yet supported")}var SF=function(n){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=Zu.DENSE;var t=zu(n),e=yn();this.outputShape=n,this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        `+ji(["r","c","d"],n)+`
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx *
          vec2(`+t[0]+", "+t[1]+`));
        int index = 4 * (resTexRC.x * `+t[1]+` + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getA(rc.x, rc.y, rc.z);
        }

        `+e.output+` = result;
      }
    `},EF=function(n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=Zu.DENSE;var t=zu(n),e=yn();this.outputShape=n,this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        `+ji(["r","c","d"],n)+`
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx *
          vec2(`+t[0]+", "+t[1]+`));
        int index = 4 * (resTexRC.x * `+t[1]+` + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));
        }

        `+e.output+` = result;
      }
    `},_F=function(){function n(t,e,r){this.variableNames=["x"],this.outputShape=[],this.outputShape=t,this.blockSize=e,this.dataFormat=r,this.userCode=`
    void main() {
      ivec4 coords = getOutputCoords();
      int b = coords[0];
      int h = `+this.getHeightCoordString()+`;
      int w = `+this.getWidthCoordString()+`;
      int d = `+this.getDepthCoordString()+`;

      int in_h = h / `+e+`;
      int offset_h = imod(h, `+e+`);
      int in_w = w / `+e+`;
      int offset_w = imod(w, `+e+`);
      int offset_d = (offset_h * `+e+` + offset_w) *
        `+this.getOutputDepthSize()+`;
      int in_d = d + offset_d;

      float result = `+this.getInputSamplingString()+`;
      setOutput(result);
    }
  `}return n.prototype.getHeightCoordString=function(){return this.dataFormat==="NHWC"?"coords[1]":"coords[2]"},n.prototype.getWidthCoordString=function(){return this.dataFormat==="NHWC"?"coords[2]":"coords[3]"},n.prototype.getDepthCoordString=function(){return this.dataFormat==="NHWC"?"coords[3]":"coords[1]"},n.prototype.getOutputDepthSize=function(){return this.dataFormat==="NHWC"?this.outputShape[3]:this.outputShape[1]},n.prototype.getInputSamplingString=function(){return this.dataFormat==="NHWC"?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"},n}(),CF=function(n){this.variableNames=["X"],this.outputShape=[n,n],this.userCode=`
      void main() {
          ivec2 coords = getOutputCoords();
          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;
          setOutput(val);
      }
    `},RF=function(n){this.variableNames=["A"],this.outTexUsage=Xn.DOWNLOAD;var t=yn();this.outputShape=n,this.userCode=`
      `+xE+`

      void main() {
        float x = getAAtOutCoords();
        `+t.output+` = encode_float(x);
      }
    `},AF=function(n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=Xn.DOWNLOAD;var t=yn();this.outputShape=n,this.userCode=`
      `+xE+`

      void main() {
        ivec3 coords = getOutputCoords();
        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));
        `+t.output+` = encode_float(x);
      }
    `},TF=function(n,t,e){e===void 0&&(e=!1),this.variableNames=["A"];var r=yn(),a=t[0],i=t[1];this.outputShape=n;var u="result";e&&(u="floor(result * 255. + 0.5)"),this.userCode=`
      `+tg(n)+`

      void main() {
        ivec3 coords = getOutputCoords();

        int flatIndex = getFlatIndex(coords);
        int offset = imod(flatIndex, 4);

        flatIndex = idiv(flatIndex, 4, 1.);
        
        int r = flatIndex / `+i+`;
        int c = imod(flatIndex, `+i+`);
        vec2 uv = (vec2(c, r) + halfCR) / vec2(`+i+".0, "+a+`.0);
        vec4 values = `+r.texture2D+`(A, uv);

        float result;

        if(offset == 0) {
          result = values[0];
        } else if(offset == 1) {
          result = values[1];
        } else if(offset == 2) {
          result = values[2];
        } else {
          result = values[3];
        }

        `+r.output+" = vec4("+u+`, 0., 0., 0.);
      }
    `},DF=function(n,t,e){e===void 0&&(e=!1),this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;var r=yn(),a=t[0],i=t[1];this.outputShape=n;var u="",l="result";e&&(l="floor(result * 255. + 0.5)");for(var c=0;c<=1;c++)for(var f=0;f<=1;f++){var d=2*c+f;u+=`
          localCoords = coords;
          if(localCoords[2] + `+f+" < "+n[2]+`) {
            localCoords[2] += `+f+`;
            if(localCoords[1] + `+c+" < "+n[1]+`) {
              localCoords[1] += `+c+`;

              flatIndex = getFlatIndex(localCoords);
              offset = imod(flatIndex, 4);

              flatIndex = idiv(flatIndex, 4, 1.);

              r = flatIndex / `+i+`;
              c = imod(flatIndex, `+i+`);
              uv = (vec2(c, r) + halfCR) / vec2(`+i+".0, "+a+`.0);
              values = `+r.texture2D+`(A, uv);

              if(offset == 0) {
                result[`+d+`] = values[0];
              } else if(offset == 1) {
                result[`+d+`] = values[1];
              } else if(offset == 2) {
                result[`+d+`] = values[2];
              } else {
                result[`+d+`] = values[3];
              }
            }
          }
        `}this.userCode=`
      `+tg(n)+`

      void main() {
        ivec3 coords = getOutputCoords();

        vec4 result = vec4(0.);
        int flatIndex, r, c, offset;
        ivec3 localCoords;
        vec2 uv;
        vec4 values;

        `+u+`

        `+r.output+" = "+l+`;
      }
    `},OF="return real * expR - imag * expI;",kF="return real * expI + imag * expR;",Dw=function(n,t,e){this.variableNames=["real","imag"];var r=t[1];this.outputShape=t;var a=e?"2.0 * "+Math.PI:"-2.0 * "+Math.PI,i=e?r+".0":"1.0";this.userCode=`
      const float exponentMultiplier = `+a+`;

      float unaryOpComplex(float real, float expR, float imag, float expI) {
        `+n+`
      }

      float mulMatDFT(int batch, int index) {
        float indexRatio = float(index) / float(`+r+`);
        float exponentMultiplierTimesIndexRatio =
            exponentMultiplier * indexRatio;

        float result = 0.0;

        for (int i = 0; i < `+r+`; i++) {
          // x = (-2|2 * PI / N) * index * i;
          float x = exponentMultiplierTimesIndexRatio * float(i);
          float expR = cos(x);
          float expI = sin(x);
          float real = getReal(batch, i);
          float imag = getImag(batch, i);

          result +=
              unaryOpComplex(real, expR, imag, expI) / `+i+`;
        }

        return result;
      }

      void main() {
        ivec2 coords = getOutputCoords();
        setOutput(mulMatDFT(coords[0], coords[1]));
      }
    `},NF=function(){function n(t,e){this.outputShape=[],this.variableNames=["x"],this.outputShape=t,this.userCode=`
      uniform float value;
      void main() {
        // Input can be obtained from uniform value.
        setOutput(value);
      }
    `}return n.prototype.getCustomSetupFunc=function(t){var e=this;return function(r,a){e.valueLoc==null&&(e.valueLoc=r.getUniformLocationNoThrow(a,"value")),r.gl.uniform1f(e.valueLoc,t)}},n}(),MF=function(n,t,e){this.variableNames=["A","indices"];var r=n.slice();r[e]=t,this.outputShape=r,this.rank=r.length;var a=pt(this.rank),i=function(u,l){var c=u.length;if(c>4)throw Error("Gather for rank "+c+" is not yet supported");if(c===1)return"int(getIndices(resRC))";for(var f=["resRC.x","resRC.y","resRC.z","resRC.w"],d=[],v=0;v<u.length;v++)v===l?d.push("int(getIndices("+f[v]+"))"):d.push(""+f[v]);return d.join()}(n,e);this.userCode=`
      void main() {
        `+a+` resRC = getOutputCoords();
        setOutput(getA(`+i+`));
      }
    `},IF=function(n,t,e){this.sliceDim=n,this.strides=t,this.variableNames=["x","indices"],this.outputShape=e;var r=pt(t.length),a=pt(e.length),i=this.sliceDim>1?"strides[j]":"strides";this.userCode=`
        `+r+" strides = "+r+"("+this.strides+`);
         void main() {
          `+a+` coords = getOutputCoords();
          int flattenIndex = 0;
          for (int j = 0; j < `+this.sliceDim+`; j++) {
            int index = round(getIndices(coords[0], j));
            flattenIndex += index * `+i+`;
          }
          setOutput(getX(flattenIndex, coords[1]));
        }
      `};function FF(n,t){var e=yn();return OM(n,t,e.version+`
    precision highp float;
    `+e.attribute+` vec3 clipSpacePos;
    `+e.attribute+` vec2 uv;
    `+e.varyingVs+` vec2 resultUV;

    void main() {
      gl_Position = vec4(clipSpacePos, 1);
      resultUV = uv;
    }`)}function BF(n,t){return FM(n,t,new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]))}function PF(n,t){return BM(n,t,new Uint16Array([0,1,2,2,1,3]))}function fl(n,t,e,r,a,i,u){LM(e,r);var l=PM(n,t),c=n.TEXTURE_2D;return _e(n,t,function(){return n.bindTexture(c,l)}),_e(n,t,function(){return n.texParameteri(c,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE)}),_e(n,t,function(){return n.texParameteri(c,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE)}),_e(n,t,function(){return n.texParameteri(c,n.TEXTURE_MIN_FILTER,n.NEAREST)}),_e(n,t,function(){return n.texParameteri(c,n.TEXTURE_MAG_FILTER,n.NEAREST)}),_e(n,t,function(){return n.texImage2D(c,0,a,e,r,0,i,u,null)}),_e(n,t,function(){return n.bindTexture(n.TEXTURE_2D,null)}),l}function LF(n,t,e,r,a){var i=nh(e,r);return fl(n,t,i[0],i[1],a.internalFormatFloat,a.textureFormatFloat,n.FLOAT)}function zF(n,t,e,r,a){var i=nh(e,r);return fl(n,t,i[0],i[1],a.internalFormatHalfFloat,a.textureFormatFloat,a.textureTypeHalfFloat)}function UF(n,t,e,r,a){var i=nh(e,r);return fl(n,t,i[0],i[1],n.RGBA,n.RGBA,n.UNSIGNED_BYTE)}function HF(n,t,e,r,a){var i=cl(e,r);return fl(n,t,i[0],i[1],a.internalFormatPackedFloat,n.RGBA,n.FLOAT)}function VF(n,t,e,r,a){var i=cl(e,r);return fl(n,t,i[0],i[1],a.internalFormatPackedHalfFloat,n.RGBA,a.textureTypeHalfFloat)}function WF(n,t,e,r){return _e(n,t,function(){return n.bindBuffer(n.ARRAY_BUFFER,r)}),mw(n,t,e,"clipSpacePos",r,3,20,0)&&mw(n,t,e,"uv",r,2,20,12)}function GF(n,t,e,r,a,i,u){var l,c,f;_e(n,t,function(){return n.bindTexture(n.TEXTURE_2D,e)}),i instanceof Uint8Array?(l=new Uint8Array(r*a*4),c=n.UNSIGNED_BYTE,f=n.RGBA):(l=new Float32Array(r*a*4),c=n.FLOAT,f=u.internalFormatPackedFloat),l.set(i),_e(n,t,function(){return n.texImage2D(n.TEXTURE_2D,0,f,r,a,0,n.RGBA,c,l)}),_e(n,t,function(){return n.bindTexture(n.TEXTURE_2D,null)})}function jF(n,t,e,r){_e(n,t,function(){return n.bindTexture(n.TEXTURE_2D,e)}),r.data instanceof Uint8Array?_e(n,t,function(){return n.texImage2D(n.TEXTURE_2D,0,n.RGBA,r.width,r.height,0,n.RGBA,n.UNSIGNED_BYTE,r.data)}):_e(n,t,function(){return n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,r)}),_e(n,t,function(){return n.bindTexture(n.TEXTURE_2D,null)})}function qF(n,t,e,r,a){var i=n.createBuffer();_e(n,t,function(){return n.bindBuffer(n.PIXEL_PACK_BUFFER,i)});var u=16*e*r;return _e(n,t,function(){return n.bufferData(n.PIXEL_PACK_BUFFER,u,n.STREAM_READ)}),_e(n,t,function(){return n.readPixels(0,0,r,e,n.RGBA,n.FLOAT,0)}),_e(n,t,function(){return n.bindBuffer(n.PIXEL_PACK_BUFFER,null)}),i}function $F(n,t,e){var r=n,a=new Float32Array(e);return r.bindBuffer(r.PIXEL_PACK_BUFFER,t),r.getBufferSubData(r.PIXEL_PACK_BUFFER,0,a),r.bindBuffer(r.PIXEL_PACK_BUFFER,null),a}function KF(n,t,e,r,a){var i=nh(e,r),u=i[0],l=i[1],c=new Uint8Array(e*r*4);return _e(n,t,function(){return n.readPixels(0,0,u,l,a.downloadTextureFormat,n.UNSIGNED_BYTE,c)}),new Float32Array(c.buffer)}function XF(n,t,e,r,a,i,u,l){var c=n,f=new Float32Array(function(d,v){var m=cl(d,v);return m[0]*m[1]*4}(i,u));return c.bindBuffer(c.PIXEL_PACK_BUFFER,t),c.getBufferSubData(c.PIXEL_PACK_BUFFER,0,f),c.bindBuffer(c.PIXEL_PACK_BUFFER,null),f}function ZF(n,t,e,r){var a=new Float32Array(e*r*4);return _e(n,t,function(){return n.readPixels(0,0,r,e,n.RGBA,n.FLOAT,a)}),a}var YF=function(){function n(t){this.outputTexture=null,this.program=null,this.disposed=!1,this.vertexAttrsAreBound=!1,this.itemsToPoll=[];var e=ue().getNumber("WEBGL_VERSION");t!=null?(this.gl=t,CM(e,t)):this.gl=Jr(e);var r="WEBGL_color_buffer_float";if(ue().getNumber("WEBGL_VERSION")===1){if(this.textureFloatExtension=Uc(this.gl,this.debug,"OES_texture_float"),pr(this.gl,"OES_texture_half_float"))this.textureHalfFloatExtension=Uc(this.gl,this.debug,"OES_texture_half_float");else if(ue().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(r),pr(this.gl,"EXT_color_buffer_half_float"))this.colorBufferHalfFloatExtension=Uc(this.gl,this.debug,"EXT_color_buffer_half_float");else if(ue().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(r="EXT_color_buffer_float",pr(this.gl,r))this.colorBufferFloatExtension=this.gl.getExtension(r);else{if(!pr(this.gl,"EXT_color_buffer_half_float"))throw new Error("GL context does not support color renderable floats");this.colorBufferHalfFloatExtension=this.gl.getExtension("EXT_color_buffer_half_float")}this.vertexBuffer=BF(this.gl,this.debug),this.indexBuffer=PF(this.gl,this.debug),this.framebuffer=zM(this.gl,this.debug),this.textureConfig=jm(this.gl,this.textureHalfFloatExtension)}return Object.defineProperty(n.prototype,"debug",{get:function(){return ue().getBool("DEBUG")},enumerable:!0,configurable:!0}),n.prototype.dispose=function(){var t=this;if(!this.disposed){this.program!=null&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),this.outputTexture!=null&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");var e=this.gl;_e(e,this.debug,function(){return e.finish()}),_e(e,this.debug,function(){return e.bindFramebuffer(e.FRAMEBUFFER,null)}),_e(e,this.debug,function(){return e.deleteFramebuffer(t.framebuffer)}),_e(e,this.debug,function(){return e.bindBuffer(e.ARRAY_BUFFER,null)}),_e(e,this.debug,function(){return e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null)}),_e(e,this.debug,function(){return e.deleteBuffer(t.indexBuffer)}),this.disposed=!0}},n.prototype.createFloat32MatrixTexture=function(t,e){return this.throwIfDisposed(),LF(this.gl,this.debug,t,e,this.textureConfig)},n.prototype.createFloat16MatrixTexture=function(t,e){return this.throwIfDisposed(),zF(this.gl,this.debug,t,e,this.textureConfig)},n.prototype.createUnsignedBytesMatrixTexture=function(t,e){return this.throwIfDisposed(),UF(this.gl,this.debug,t,e,this.textureConfig)},n.prototype.uploadPixelDataToTexture=function(t,e){this.throwIfDisposed(),jF(this.gl,this.debug,t,e)},n.prototype.uploadDenseMatrixToTexture=function(t,e,r,a){this.throwIfDisposed(),GF(this.gl,this.debug,t,e,r,a,this.textureConfig)},n.prototype.createFloat16PackedMatrixTexture=function(t,e){return this.throwIfDisposed(),VF(this.gl,this.debug,t,e,this.textureConfig)},n.prototype.createPackedMatrixTexture=function(t,e){return this.throwIfDisposed(),HF(this.gl,this.debug,t,e,this.textureConfig)},n.prototype.deleteMatrixTexture=function(t){var e=this;this.throwIfDisposed(),this.outputTexture===t&&(gw(this.gl,this.debug,this.framebuffer),this.outputTexture=null),_e(this.gl,this.debug,function(){return e.gl.deleteTexture(t)})},n.prototype.downloadByteEncodedFloatMatrixFromOutputTexture=function(t,e,r){var a=this;return this.downloadMatrixDriver(t,function(){return KF(a.gl,a.debug,e,r,a.textureConfig)})},n.prototype.downloadPackedMatrixFromBuffer=function(t,e,r,a,i,u){return XF(this.gl,t,0,0,0,i,u,this.textureConfig)},n.prototype.downloadFloat32MatrixFromBuffer=function(t,e){return $F(this.gl,t,e)},n.prototype.createBufferFromTexture=function(t,e,r){this.bindTextureToFrameBuffer(t);var a=qF(this.gl,this.debug,e,r,this.textureConfig);return this.unbindTextureToFrameBuffer(),a},n.prototype.createAndWaitForFence=function(){var t=this.createFence(this.gl);return this.pollFence(t)},n.prototype.createFence=function(t){var e,r,a=this;if(ue().getBool("WEBGL_FENCE_API_ENABLED")){var i=t,u=i.fenceSync(i.SYNC_GPU_COMMANDS_COMPLETE,0);t.flush(),r=function(){var l=i.clientWaitSync(u,0,0);return l===i.ALREADY_SIGNALED||l===i.CONDITION_SATISFIED},e=u}else ue().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(e=this.beginQuery(),this.endQuery(),r=function(){return a.isQueryAvailable(e,ue().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}):r=function(){return!0};return{query:e,isFencePassed:r}},n.prototype.downloadMatrixFromPackedTexture=function(t,e,r){var a=this;return this.downloadMatrixDriver(t,function(){return ZF(a.gl,a.debug,e,r)})},n.prototype.createProgram=function(t){this.throwIfDisposed();var e=this.gl,r=kM(e,this.debug,t),a=FF(e,this.debug),i=MM(e,this.debug);return _e(e,this.debug,function(){return e.attachShader(i,a)}),_e(e,this.debug,function(){return e.attachShader(i,r)}),IM(e,this.debug,i),this.debug&&rv(e,this.debug,i),this.vertexAttrsAreBound||(this.setProgram(i),this.vertexAttrsAreBound=WF(e,this.debug,this.program,this.vertexBuffer)),i},n.prototype.deleteProgram=function(t){var e=this;this.throwIfDisposed(),t===this.program&&(this.program=null),t!=null&&_e(this.gl,this.debug,function(){return e.gl.deleteProgram(t)})},n.prototype.setProgram=function(t){var e=this;this.throwIfDisposed(),this.program=t,this.program!=null&&this.debug&&rv(this.gl,this.debug,this.program),_e(this.gl,this.debug,function(){return e.gl.useProgram(t)})},n.prototype.getUniformLocation=function(t,e,r){return r===void 0&&(r=!0),this.throwIfDisposed(),r?HM(this.gl,this.debug,t,e):VM(this.gl,t,e)},n.prototype.getAttributeLocation=function(t,e){var r=this;return this.throwIfDisposed(),_e(this.gl,this.debug,function(){return r.gl.getAttribLocation(t,e)})},n.prototype.getUniformLocationNoThrow=function(t,e){return this.throwIfDisposed(),this.gl.getUniformLocation(t,e)},n.prototype.setInputMatrixTexture=function(t,e,r){this.throwIfDisposed(),this.throwIfNoProgram(),WM(this.gl,this.debug,this.program,t,e,r)},n.prototype.setOutputMatrixTexture=function(t,e,r){this.setOutputMatrixTextureDriver(t,r,e)},n.prototype.setOutputPackedMatrixTexture=function(t,e,r){this.throwIfDisposed();var a=cl(e,r),i=a[0],u=a[1];this.setOutputMatrixTextureDriver(t,i,u)},n.prototype.setOutputMatrixWriteRegion=function(t,e,r,a){this.setOutputMatrixWriteRegionDriver(r,t,a,e)},n.prototype.setOutputPackedMatrixWriteRegion=function(t,e,r,a){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")},n.prototype.debugValidate=function(){this.program!=null&&rv(this.gl,this.debug,this.program),Hc(this.gl)},n.prototype.executeProgram=function(){this.throwIfDisposed(),this.throwIfNoProgram();var t=this.gl;this.debug&&this.debugValidate(),_e(t,this.debug,function(){return t.drawElements(t.TRIANGLES,6,t.UNSIGNED_SHORT,0)})},n.prototype.blockUntilAllProgramsCompleted=function(){var t=this;this.throwIfDisposed(),_e(this.gl,this.debug,function(){return t.gl.finish()})},n.prototype.getQueryTimerExtension=function(){return this.disjointQueryTimerExtension==null&&(this.disjointQueryTimerExtension=Uc(this.gl,this.debug,ue().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension},n.prototype.getQueryTimerExtensionWebGL2=function(){return this.getQueryTimerExtension()},n.prototype.getQueryTimerExtensionWebGL1=function(){return this.getQueryTimerExtension()},n.prototype.beginQuery=function(){if(ue().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){var t=this.gl,e=this.getQueryTimerExtensionWebGL2(),r=t.createQuery();return t.beginQuery(e.TIME_ELAPSED_EXT,r),r}var a=this.getQueryTimerExtensionWebGL1(),i=a.createQueryEXT();return a.beginQueryEXT(a.TIME_ELAPSED_EXT,i),i},n.prototype.endQuery=function(){if(ue().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")!==2){var t=this.getQueryTimerExtensionWebGL1();t.endQueryEXT(t.TIME_ELAPSED_EXT)}else{var e=this.gl,r=this.getQueryTimerExtensionWebGL2();e.endQuery(r.TIME_ELAPSED_EXT)}},n.prototype.waitForQueryAndGetTime=function(t){return we(this,void 0,void 0,function(){var e=this;return Se(this,function(r){switch(r.label){case 0:return[4,cw(function(){return e.disposed||e.isQueryAvailable(t,ue().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))})];case 1:return r.sent(),[2,this.getQueryTime(t,ue().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))]}})})},n.prototype.getQueryTime=function(t,e){if(e===0)return null;if(e===2){var r=this.gl;return r.getQueryParameter(t,r.QUERY_RESULT)/1e6}var a=this.getQueryTimerExtensionWebGL1();return a.getQueryObjectEXT(t,a.QUERY_RESULT_EXT)/1e6},n.prototype.isQueryAvailable=function(t,e){if(e===0)return!0;if(e===2){var r=this.gl,a=this.getQueryTimerExtensionWebGL2(),i=r.getQueryParameter(t,r.QUERY_RESULT_AVAILABLE);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(a.GPU_DISJOINT_EXT)),i&&!this.disjoint}return i=(a=this.getQueryTimerExtensionWebGL1()).getQueryObjectEXT(t,a.QUERY_RESULT_AVAILABLE_EXT),this.disjoint==null&&(this.disjoint=this.gl.getParameter(a.GPU_DISJOINT_EXT)),i&&!this.disjoint},n.prototype.pollFence=function(t){var e=this;return new Promise(function(r){e.addItemToPoll(function(){return t.isFencePassed()},function(){return r()})})},n.prototype.pollItems=function(){for(var t=function(r){for(var a=0;a<r.length&&r[a]();++a);return a-1}(this.itemsToPoll.map(function(r){return r.isDoneFn})),e=0;e<=t;++e)(0,this.itemsToPoll[e].resolveFn)();this.itemsToPoll=this.itemsToPoll.slice(t+1)},n.prototype.addItemToPoll=function(t,e){var r=this;this.itemsToPoll.push({isDoneFn:t,resolveFn:e}),this.itemsToPoll.length>1||cw(function(){return r.pollItems(),r.itemsToPoll.length===0})},n.prototype.bindTextureToFrameBuffer=function(t){this.throwIfDisposed(),av(this.gl,this.debug,t,this.framebuffer),this.debug&&Hc(this.gl)},n.prototype.unbindTextureToFrameBuffer=function(){this.outputTexture!=null?(av(this.gl,this.debug,this.outputTexture,this.framebuffer),this.debug&&Hc(this.gl)):gw(this.gl,this.debug,this.framebuffer)},n.prototype.downloadMatrixDriver=function(t,e){this.bindTextureToFrameBuffer(t);var r=e();return this.unbindTextureToFrameBuffer(),r},n.prototype.setOutputMatrixTextureDriver=function(t,e,r){this.throwIfDisposed();var a=this.gl;av(a,this.debug,t,this.framebuffer),this.debug&&Hc(a),this.outputTexture=t,_e(a,this.debug,function(){return a.viewport(0,0,e,r)}),_e(a,this.debug,function(){return a.scissor(0,0,e,r)})},n.prototype.setOutputMatrixWriteRegionDriver=function(t,e,r,a){var i=this;this.throwIfDisposed(),_e(this.gl,this.debug,function(){return i.gl.scissor(t,e,r,a)})},n.prototype.throwIfDisposed=function(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")},n.prototype.throwIfNoProgram=function(){if(this.program==null)throw new Error("No GPU program is currently set.")},n}();function Ow(n,t){if(n.length!==t.length)throw Error("Binary was compiled with "+n.length+" inputs, but was executed with "+t.length+" inputs");n.forEach(function(e,r){var a=e.logicalShape,i=t[r],u=i.shape;if(!nn(a,u))throw Error("Binary was compiled with different shapes than the current args. Shapes "+a+" and "+u+" must match");if(!e.isUniform||!i.isUniform){var l=e.texShape,c=i.isUniform?null:i.texData.texShape;if(!nn(l,c))throw Error("Binary was compiled with different texture shapes than the current args. Shape "+l+" and "+c+" must match")}})}var QF=function(n,t,e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n;for(var r=e.filterWidth,a=e.inChannels,i=e.strideWidth,u=e.strideHeight,l=e.padInfo,c=e.outWidth,f=e.dilationWidth,d=e.dilationHeight,v=e.dataFormat,m=l.left,g=l.top,b=a*r,w=yn(),S=v==="channelsLast",E=S?0:1,_=S?1:2,R="",C=0;C<=1;C++)for(var A=0;A<=1;A++)R+=`
          blockIndex = rc.y + `+A+`;
          pos = rc.x + `+C+`;

          if(blockIndex < `+n[1]+" && pos < "+n[0]+`) {
            offsetY = int(blockIndex / (`+c+")) * "+u+" - "+g+`;
            d0 = offsetY + `+d+" * (pos / "+b+`);

            if(d0 < `+t[E]+` && d0 >= 0) {

              offsetX = int(mod(float(blockIndex), `+c+".) * "+i+". - "+m+`.);
              d1 = offsetX + `+f+" * (int(mod(float(pos), "+b+".) / "+a+`.));

              if(d1 < `+t[_]+` && d1 >= 0) {

                ch = int(mod(float(pos), `+a+`.));

                if (`+S+`) {
                  innerDims = vec2(d1, ch);
                  result[`+(2*C+A)+`] = getChannel(
                    getA(d0, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                } else {
                  innerDims = vec2(d0, d1);
                  result[`+(2*C+A)+`] = getChannel(
                    getA(ch, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                }
              }
            }
          }
        `;this.userCode=`
      void main() {
        ivec2 rc = getOutputCoords();

        vec4 result = vec4(0);

        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;
        vec2 innerDims;

        `+R+`

        `+w.output+` = result;
      }
    `},JF=function(n,t,e,r,a){this.variableNames=["x"],this.outputShape=[];var i,u=t,l=n[3]-1;this.outputShape=n;var c="float("+e+") + float("+r+") * sum";i=a===.5?"inversesqrt("+c+")":a===1?"1.0/("+c+")":"exp(log("+c+") * float(-"+a+"));",this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];
        int d = coords[3];
        float x = getX(b, r, c, d);
        float sum = 0.0;
        for (int j = -`+u+"; j <= "+u+`; j++) {
          int idx = d + j;
          if (idx >= 0 && idx <=  `+l+`) {
            float z = getX(b, r, c, idx);
            sum += z * z;
          }
        }
        float val = x * `+i+`;
        setOutput(val);
      }
    `},eB=function(n,t,e,r,a){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=n,this.depth=n[3],this.depthRadius=t,this.bias=e,this.alpha=r,this.beta=a,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];

        float result = 0.0;
        for (int d = 0; d < `+this.depth+`; ++d) {
          int depthBegin = int(max(0.0, float(d - `+t+`)));
          int depthEnd = int(min(float(`+this.depth+`),
              float(d + `+t+` + 1)));

          const int MIN_DEPTH_BEGIN = 0;
          const int MAX_DEPTH_END = `+this.depth+`;

          float norm = 0.0;
          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd) {
              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);
            }
            else {
              break;
            }
          }

          norm = float(`+r+") * norm + float("+e+`);

          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd){
              float dyi = -2.0 * float(`+r+`)
                * float(`+a+`)
                * getInputImage(b ,r ,c, k) * getOutputImage(b, r, c, d)
                / norm;
              if (k == d) {
                dyi += pow(norm, -1.0 * `+a+`);
              }
              if (k == coords[3]) {
                dyi *= getDy(b, r, c, d);
                result += dyi;
              }
            }
            else {
              break;
            }
          }
      }
      setOutput(result);
      }
    `},tB=function(n,t,e,r,a){this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;var i,u=t,l=n[3]-1;this.outputShape=n;var c="float("+e+") + float("+r+") * sum";i=a===.5?"inversesqrt("+c+")":a===1?"1.0/("+c+")":"exp(log("+c+") * float(-"+a+"));",this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords.x;
        int r = coords.y;
        int c = coords.z;
        int d = coords.w;

        bool hasNextCol = d < `+this.outputShape[3]+`;
        bool hasNextRow = c < `+this.outputShape[2]+`;

        vec4 sum = vec4(0.);
        vec4 xFragAtOutputCoords = getX(b, r, c, d);

        vec4 xAtOutputCoords = vec4(
          getChannel(xFragAtOutputCoords, vec2(c, d)),
          hasNextCol ?
            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,
          hasNextRow ?
            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,
          (hasNextRow && hasNextCol) ?
            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0
        );

        int firstChannel = d - `+u+`;
        vec2 cache = vec2(0.);
        if(firstChannel >= 0){
          vec4 firstChannelFrag = getX(b, r, c, firstChannel);
          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));
            if(hasNextRow){
              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));
            }
        }

        ivec2 depth = ivec2(d, d + 1);
        for (int j = - `+u+"; j <= "+u+`; j++) {
          ivec2 idx = depth + j;
          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));
          bvec2 belowUpperBound = lessThanEqual(idx, ivec2(`+l+`));

          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;
          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;

          if(depthInRange || depthPlusOneInRange){
            vec4 z = vec4(0.);
            vec4 xFragAtCurrentDepth;
            z.xz = cache.xy;
            if(depthPlusOneInRange && hasNextCol){
              xFragAtCurrentDepth = idx.y != d ?
                getX(b, r, c, idx.y) : xFragAtOutputCoords;
              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));
              if(hasNextRow){
                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));
              }
            }
            cache.xy = z.yw;
            sum += z * z;
          }
        }
        vec4 result = xAtOutputCoords * `+i+`;
        setOutput(result);
      }
    `},nB=function(n){this.variableNames=["dy","maxPos"],this.outputShape=n.inShape;var t=n.strideHeight,e=n.strideWidth,r=n.dilationHeight,a=n.effectiveFilterHeight,i=n.effectiveFilterWidth,u=a-1-n.padInfo.top,l=i-1-n.padInfo.left,c=a*i-1;this.userCode=`
      const ivec2 pads = ivec2(`+u+", "+l+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < `+a+`;
          wR += `+r+`) {
          float dyR = float(dyRCorner + wR) / `+t+`.0;

          if (dyR < 0.0 || dyR >= `+n.outHeight+`.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < `+i+`; wC++) {
            float dyC = float(dyCCorner + wC) / `+e+`.0;

            if (dyC < 0.0 || dyC >= `+n.outWidth+`.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);
            int maxPosValue = `+c+` - int(getMaxPos(b, idyR, idyC, d));

            // Get the current value, check it against the value from the
            // position matrix.
            int curPosValue = wR * `+i+` + wC;
            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

            dotProd += dyValue * mask;
          }
        }
        setOutput(dotProd);
      }
    `},rB=function(n){this.variableNames=["dy","maxPos"],this.outputShape=n.inShape;var t=n.strideDepth,e=n.strideHeight,r=n.strideWidth,a=n.dilationDepth,i=n.dilationHeight,u=n.dilationWidth,l=n.effectiveFilterDepth,c=n.effectiveFilterHeight,f=n.effectiveFilterWidth,d=l-1-n.padInfo.front,v=c-1-n.padInfo.top,m=f-1-n.padInfo.left,g=l*c*f-1;this.userCode=`
      const ivec3 pads = ivec3(`+d+", "+v+", "+m+`);

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < `+l+`;
           wD += `+a+`) {
          float dyD = float(dyDCorner + wD) / `+t+`.0;

          if (dyD < 0.0 || dyD >= `+n.outDepth+`.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < `+c+`;
              wR += `+i+`) {
            float dyR = float(dyRCorner + wR) / `+e+`.0;

            if (dyR < 0.0 || dyR >= `+n.outHeight+`.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < `+f+`;
                wC += `+u+`) {
              float dyC = float(dyCCorner + wC) / `+r+`.0;

              if (dyC < 0.0 || dyC >= `+n.outWidth+`.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);
              int maxPosValue = `+g+` -
                  int(getMaxPos(batch, idyD, idyR, idyC, ch));

              // Get the current value, check it against the value from the
              // position matrix.
              int curPosValue =
                  wD * `+c+" * "+f+` +
                  wR * `+f+` + wC;
              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

              dotProd += dyValue * mask;
            }
          }
        }
        setOutput(dotProd);
      }
    `},lv=function(n,t,e,r,a,i,u){e===void 0&&(e=!1),r===void 0&&(r=!1),a===void 0&&(a=!1),i===void 0&&(i=null),u===void 0&&(u=!1),this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t;var l=e?n[1]:n[2],c=Math.ceil(l/2),f=e?"i * 2, rc.y":"rc.y, i * 2",d=r?"rc.z, i * 2":"i * 2, rc.z",v=e?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],m=r?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"],g="",b="";i&&(g=u?`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          `+i+`
        }`:`vec4 activation(vec4 x) {
          `+i+`
        }`,b="result = activation(result);");var w=a?"result += getBiasAtOutCoords();":"";a&&this.variableNames.push("bias"),u&&this.variableNames.push("preluActivationWeights"),this.userCode=`
      `+g+`

      const float sharedDimension = `+c+`.0;

      vec4 dot2x2ARowBCol(ivec3 rc) {
        vec4 result = vec4(0);
        for (int i = 0; i < `+c+`; i++) {
          vec4 a = getMatrixA(rc.x, `+f+`);
          vec4 b = getMatrixB(rc.x, `+d+`);

          // These swizzled products need to be separately added.
          // See: https://github.com/tensorflow/tfjs/issues/1735
          result += (`+v[0]+" * "+m[0]+`);
          result += (`+v[1]+" * "+m[1]+`);
        }
        return result;
      }

      void main() {
        ivec3 rc = getOutputCoords();
        vec4 result = dot2x2ARowBCol(rc);

        `+w+`

        `+b+`

        setOutput(result);
      }
    `},aB=function(){function n(t,e,r){this.variableNames=["probs"],this.outputShape=[t,r],this.userCode=`
      uniform float seed;

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];

        float r = random(seed);
        float cdf = 0.0;

        for (int i = 0; i < `+(e-1)+`; i++) {
          cdf += getProbs(batch, i);

          if (r < cdf) {
            setOutput(float(i));
            return;
          }
        }

        // If no other event happened, last event happened.
        setOutput(float(`+(e-1)+`));
      }
    `}return n.prototype.getCustomSetupFunc=function(t){var e=this;return function(r,a){e.seedLoc==null&&(e.seedLoc=r.getUniformLocation(a,"seed")),r.gl.uniform1f(e.seedLoc,t)}},n}(),iB=function(n,t,e,r){this.variableNames=["indices"],this.outputShape=[n,t],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int index = round(getIndices(coords.x));
        setOutput(mix(float(`+r+"), float("+e+`),
                      float(index == coords.y)));
      }
    `},oB=function(n){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=n;var t=n.length;if(t===0)this.userCode=`
        void main() {
          setOutput(vec4(getA(), 0., 0., 0.));
        }
      `;else{var e=In("rc",t),r=pt(t),a=function(l,c,f){if(l===1)return"rc > "+c[0];for(var d="",v=l-2;v<l;v++)d+=f[v]+" >= "+c[v],v<l-1&&(d+="||");return d}(t,n,e),i=function(l,c,f,d){if(l===1)return"";var v=d.slice(-2);return`
    int r = `+v[0]+`;
    int c = `+v[1]+`;
    int rp1 = r + 1;
    int cp1 = c + 1;

    bool cEdge = cp1 >= `+c+`;
    bool rEdge = rp1 >= `+f+`;
  `}(t,n[n.length-1],n[n.length-2],e),u=function(l,c){var f=l.length,d=function(v,m){for(var g=[],b=0;b<=1;b++)for(var w=0;w<=1;w++){for(var S=(b===0?"r":"rp1")+", "+(w===0?"c":"cp1"),E=2;E<v;E++)S=m[m.length-1-E]+","+S;g.push(S)}return g}(f,c);return f===1?`getA(rc),
            rc + 1 >= `+l[0]+` ? 0. : getA(rc + 1),
            0, 0`:"getA("+d[0]+`),
          cEdge ? 0. : getA(`+d[1]+`),
          rEdge ? 0. : getA(`+d[2]+`),
          rEdge || cEdge ? 0. : getA(`+d[3]+")"}(n,e);this.userCode=`
        void main() {
          `+r+` rc = getOutputCoords();

          if(`+a+`) {
            setOutput(vec4(0));
          } else {
            `+i+`

            setOutput(vec4(`+u+`));
          }
        }
      `}},sB=function(n,t,e){this.variableNames=["x"],this.outputShape=t.map(function(c,f){return c[0]+n[f]+c[1]});var r=n.length,a=pt(r),i=t.map(function(c){return c[0]}).join(","),u=t.map(function(c,f){return c[0]+n[f]}).join(","),l=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,r);this.userCode=r!==1?`
      `+a+" start = "+a+"("+i+`);
      `+a+" end = "+a+"("+u+`);

      void main() {
        `+a+` outC = getOutputCoords();
        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {
          setOutput(float(`+e+`));
        } else {
          `+a+` coords = outC - start;
          setOutput(getX(`+l+`));
        }
      }
    `:`
        int start = `+i+`;
        int end = `+u+`;

        void main() {
          int outC = getOutputCoords();
          if (outC < start || outC >= end) {
            setOutput(float(`+e+`));
          } else {
            setOutput(getX(outC - start));
          }
        }
      `},uB=function(n,t,e){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t.map(function(S,E){return S[0]+n[E]+S[1]});for(var r=n.length,a=pt(r),i=t.map(function(S){return S[0]}).join(","),u=t.map(function(S,E){return S[0]+n[E]}).join(","),l=In("rc",r),c=In("source",r),f=l[r-1]+" < "+this.outputShape[r-1],d=r===1?"source":"vec2("+c.slice(-2).join()+")",v=[a+" rc = outputLoc;",l[r-1]+` += 1;
       if(`+f+`) {
      `,r===1?"":`}
       rc = outputLoc;
       `+l[r-2]+` += 1;
       if(`+l[r-2]+" < "+this.outputShape[r-2]+") {",r===1?"":"  "+l[r-1]+` += 1;
         if(`+f+") {"],m=r===1?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))",g="",b=0,w=r===1?2:4;b<w;b++)g+=`
        `+v[b]+`
        if (`+m+`) {
          result[`+b+"] = float("+e+`);
        } else {
          `+a+` source = rc - start;
          result[`+b+"] = getChannel(getX("+c.join()+"), "+d+`);
        }
      `;g+=r===1?"} ":"}}",this.userCode=`
      const `+a+" start = "+a+"("+i+`);
      const `+a+" end = "+a+"("+u+`);

      void main() {
        `+a+` outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        `+g+`
        setOutput(result);
      }
    `},cv=function(n,t,e){if(this.variableNames=["x"],t==="avg"&&e)throw new Error("Cannot compute positions for average pool.");var r=n.filterWidth,a=n.strideHeight,i=n.strideWidth,u=n.dilationHeight,l=n.dilationWidth,c=n.effectiveFilterHeight,f=n.effectiveFilterWidth,d=n.padInfo.top,v=n.padInfo.left;this.outputShape=n.outShape;var m=t==="avg",g="0.0";if(m||(g="-1.0 / 1e-20"),e)this.userCode=`
        const ivec2 strides = ivec2(`+a+", "+i+`);
        const ivec2 pads = ivec2(`+d+", "+v+`);

        void main() {
          ivec4 coords = getOutputCoords();
          int batch = coords[0];
          int d = coords[3];

          ivec2 xRCCorner = coords.yz * strides - pads;
          int xRCorner = xRCCorner.x;
          int xCCorner = xRCCorner.y;

          // max/min x(?, ?, d) to get y(yR, yC, d).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;
          float avgValue = 0.0;

          for (int wR = 0; wR < `+c+`;
              wR += `+u+`) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= `+n.inHeight+`) {
              continue;
            }

            for (int wC = 0; wC < `+f+`;
                wC += `+l+`) {
              int xC = xCCorner + wC;

              if (xC < 0 || xC >= `+n.inWidth+`) {
                continue;
              }

              float value = getX(batch, xR, xC, d);

              // If a min / max value has already been found, use it. If not,
              // use the current value.
              float currMinMaxValue = mix(
                  value, minMaxValue, minMaxValueFound);
              if (value >= currMinMaxValue) {
                minMaxValue = value;
                minMaxValueFound = 1.0;
                minMaxPosition = wR * `+f+` + wC;
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;else{var b=t+"("+t+"("+t+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";t==="avg"&&(b="avgValue / count");var w=4*Math.floor(r/4),S=r%4,E=`
      if (`+m+`) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = max(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec2 strides = ivec2(`+a+", "+i+`);
      const ivec2 pads = ivec2(`+d+", "+v+`);
      const float initializationValue = `+g+`;
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xR, int xC, int d) {
        if (xC < 0 || xC >= `+n.inWidth+`) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xR, xC, d);
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d = coords[3];

        ivec2 xRCCorner = coords.yz * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // max/min x(?, ?, d) to get y(yR, yC, d).
        // ? = to be determined
        vec4 minMaxValue = vec4(`+g+`);
        float avgValue = 0.0;
        count = 0.0;

        for (int wR = 0; wR < `+c+`;
            wR += `+u+`) {
          int xR = xRCorner + wR;

          if (xR < 0 || xR >= `+n.inHeight+`) {
            continue;
          }

          for (int wC = 0; wC < `+w+`; wC += 4) {
            int xC = xCCorner + wC * `+l+`;

            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + `+l+`, d),
              getValue(batch, xR, xC + 2 * `+l+`, d),
              getValue(batch, xR, xC + 3 * `+l+`, d)
            );

            `+E+`
          }

          int xC = xCCorner + `+w+`;
          if (`+(S===1)+`) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              initializationValue,
              initializationValue,
              initializationValue
            );

            `+E+`
          } else if (`+(S===2)+`) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + `+l+`, d),
              initializationValue,
              initializationValue
            );

            `+E+`
          } else if (`+(S===3)+`) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + `+l+`, d),
              getValue(batch, xR, xC + 2 * `+l+`, d),
              initializationValue
            );

            `+E+`
          }
        }
        setOutput(`+b+`);
      }
    `}},fv=function(n,t,e){if(this.variableNames=["x"],t==="avg"&&e)throw new Error("Cannot compute positions for average pool.");var r=n.filterWidth,a=n.strideDepth,i=n.strideHeight,u=n.strideWidth,l=n.dilationDepth,c=n.dilationHeight,f=n.dilationWidth,d=n.effectiveFilterDepth,v=n.effectiveFilterHeight,m=n.effectiveFilterWidth,g=n.padInfo.front,b=n.padInfo.top,w=n.padInfo.left;this.outputShape=n.outShape;var S=t==="avg",E="0.0";if(S||(E="-1.0 / 1e-20"),e)this.userCode=`
        const ivec3 strides =
            ivec3(`+a+", "+i+", "+u+`);
        const ivec3 pads = ivec3(`+g+", "+b+", "+w+`);

        void main() {
          ivec5 coords = getOutputCoords();
          int batch = coords.x;
          int ch = coords.u;

          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
          int xDCorner = xCorner.x;
          int xRCorner = xCorner.y;
          int xCCorner = xCorner.z;

          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;

          for (int wD = 0; wD < `+d+`;
              wD += `+l+`) {
            int xD = xDCorner + wD;

            if (xD < 0 || xD >= `+n.inDepth+`) {
              continue;
            }

            for (int wR = 0; wR < `+v+`;
                wR += `+c+`) {
              int xR = xRCorner + wR;

              if (xR < 0 || xR >= `+n.inHeight+`) {
                continue;
              }

              for (int wC = 0; wC < `+m+`;
                  wC += `+f+`) {
                int xC = xCCorner + wC;

                if (xC < 0 || xC >= `+n.inWidth+`) {
                  continue;
                }

                float value = getX(batch, xD, xR, xC, ch);

                // If a min / max value has already been found, use it. If not,
                // use the current value.
                float currMinMaxValue = mix(
                    value, minMaxValue, minMaxValueFound);
                if (value >= currMinMaxValue) {
                  minMaxValue = value;
                  minMaxValueFound = 1.0;
                  minMaxPosition =
                      wD * `+v+" * "+m+` +
                      wR * `+m+` + wC;;
                }
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;else{var _=t+"("+t+"("+t+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";t==="avg"&&(_="avgValue / count");var R=4*Math.floor(r/4),C=r%4,A=`
      if (`+S+`) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = max(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec3 strides =
        ivec3(`+a+", "+i+", "+u+`);
      const ivec3 pads = ivec3(`+g+", "+b+", "+w+`);
      const float initializationValue = `+E+`;
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xD, int xR, int xC, int ch) {
        if (xC < 0 || xC >= `+n.inWidth+`) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xD, xR, xC, ch);
      }

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xDCorner = xCorner.x;
        int xRCorner = xCorner.y;
        int xCCorner = xCorner.z;

        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).
        // ? = to be determined
        vec4 minMaxValue = vec4(`+E+`);
        float avgValue = 0.0;
        count = 0.0;

        for (int wD = 0; wD < `+d+`;
            wD += `+l+`) {
          int xD = xDCorner + wD;

          if (xD < 0 || xD >= `+n.inDepth+`) {
            continue;
          }

          for (int wR = 0; wR < `+v+`;
            wR += `+c+`) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= `+n.inHeight+`) {
              continue;
            }

            for (int wC = 0; wC < `+R+`; wC += 4) {
              int xC = xCCorner + wC * `+f+`;

              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + `+f+`, ch),
                getValue(batch, xD, xR, xC + 2 * `+f+`, ch),
                getValue(batch, xD, xR, xC + 3 * `+f+`, ch)
              );

              `+A+`
            }

            int xC = xCCorner + `+R+`;
            if (`+(C===1)+`) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                initializationValue,
                initializationValue,
                initializationValue
              );

              `+A+`
            } else if (`+(C===2)+`) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + `+f+`, ch),
                initializationValue,
                initializationValue
              );

              `+A+`
            } else if (`+(C===3)+`) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + `+f+`, ch),
                getValue(batch, xD, xR, xC + 2 * `+f+`, ch),
                initializationValue
              );

              `+A+`
            }
          }
          setOutput(`+_+`);
        }
      }
    `}},lB=function(n,t){this.variableNames=["x"];var e=n.windowSize,r=n.batchSize,a=n.inSize,i=Math.ceil(a/e);this.outputShape=[r,i];var u="0.0",l="";t==="prod"?u="1.0":t==="min"?(u="1.0 / 1e-20",l="min"):t==="max"&&(u="-1.0 / 1e-20",l="max");var c=t+"("+t+"("+t+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";t==="sum"?c="sumValue":t==="prod"?c="prodValue":t==="all"?c="allValue":t==="any"&&(c="anyValue");var f=4*Math.floor(e/4),d=e%4,v=`
      if (`+(t==="sum")+`) {
        sumValue += dot(values, ones);
      } else if (`+(t==="prod")+`) {
        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);
        prodValue *= tmp[0] * tmp[1];
      } else {
        minMaxValue = `+l+`(values, minMaxValue);
      }
    `,m="vec4";t==="all"?(u="1.0",v=`
        bool reducedAllValue = all(values);
        float floatedReducedAllValue = float(reducedAllValue);
        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);
      `,m="bvec4"):t==="any"&&(u="0.0",v=`
        bool reducedAnyValue = any(values);
        float floatedReducedAnyValue = float(reducedAnyValue);
        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);
      `,m="bvec4");var g="";a%e>0&&(g=`
        if (inIdx < 0 || inIdx >= `+a+`) {
          return initializationValue;
        }
      `),this.userCode=`
      const float initializationValue = `+u+`;
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        `+g+`
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * `+e+`;

        vec4 minMaxValue = vec4(`+u+`);
        float prodValue = 1.0;
        float sumValue = 0.0;
        float allValue = 1.0;
        float anyValue = 0.0;

        for (int i = 0; i < `+f+`; i += 4) {
          int inIdx = inOffset + i;
          `+m+" values = "+m+`(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          `+v+`
        }

        int inIdx = inOffset + `+f+`;
        if (`+(d===1)+`) {
          `+m+" values = "+m+`(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          `+v+`
        } else if (`+(d===2)+`) {
          `+m+" values = "+m+`(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          `+v+`
        } else if (`+(d===3)+`) {
          `+m+" values = "+m+`(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          `+v+`
        }
        setOutput(`+c+`);
      }
    `},cB=function(n,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n;for(var e="",r=0;r<4;r++){var a="thisRC = rc;";r%2==1&&(a+="thisRC.z += 1;"),r>1&&(a+="thisRC.y += 1;"),e+=`
        `+a+`
        `+(r>0?"if(thisRC.y < rows && thisRC.z < cols){":"")+`
          int flatIndex = getFlatIndex(thisRC);

          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);
          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));

          result[`+r+`] =
            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);
        `+(r>0?"}":"")+`
      `}this.userCode=`
      
    ivec3 inputCoordsFromReshapedOutCoords(int index) {
      `+ji(["r","c","d"],t)+`
      return ivec3(r, c, d);
    }
  
      `+tg(n)+`

      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0.);

        ivec3 thisRC;
        int rows = `+n[1]+`;
        int cols = `+n[2]+`;

        `+e+`

        setOutput(result);
      }
    `},fB=function(n,t,e){this.variableNames=["dy"],this.outputShape=[],this.outputShape=t.shape;var r=t.shape,a=r[1],i=r[2],u=n.shape,l=u[1],c=u[2],f=[e&&l>1?a-1:a,e&&c>1?i-1:i],d=[e&&l>1?l-1:l,e&&c>1?c-1:c],v=f[0]/d[0],m=f[1]/d[1],g=1/v,b=1/m,w=2*Math.ceil(g)+2,S=2*Math.ceil(b)+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(`+v+`);
        const float widthScale = float(`+m+`);

        const float invHeightScale = float(`+g+`);
        const float invWidthScale = float(`+b+`);

        const int winHeight = int(`+w+`);
        const int winWidth = int(`+S+`);

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(startRLerp - float(winHeight / 2));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(startCLerp - float(winWidth / 2));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= `+l+`) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= `+c+`) {
              continue;
            }

            float dxR = float(dyR) * heightScale;
            int topDxRIndex = int(floor(dxR));
            int bottomDxRIndex = int(min(ceil(dxR), `+(a-1)+`.0));
            float dxRLerp = dxR - float(topDxRIndex);
            float inverseDxRLerp = 1.0 - dxRLerp;

            float dxC = float(dyC) * widthScale;
            int leftDxCIndex = int(floor(dxC));
            int rightDxCIndex = int(min(ceil(dxC), `+(i-1)+`.0));
            float dxCLerp = dxC - float(leftDxCIndex);
            float inverseDxCLerp = 1.0 - dxCLerp;

            if (r == topDxRIndex && c == leftDxCIndex) {
              // topLeft
              accumulator +=
                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;
            }

            if (r == topDxRIndex && c == rightDxCIndex) {
              // topRight
              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;
            }

            if (r == bottomDxRIndex && c == leftDxCIndex) {
              // bottomLeft
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;
            }

            if (r == bottomDxRIndex && c == rightDxCIndex) {
              // bottomRight
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `},hB=function(n,t,e,r){this.variableNames=["A"],this.outputShape=[];var a=n[0],i=n[1],u=n[2],l=n[3];this.outputShape=[a,t,e,l];var c=[r&&t>1?i-1:i,r&&e>1?u-1:u],f=[r&&t>1?t-1:t,r&&e>1?e-1:e];this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          `+c[0]/f[0]+`,
          `+c[1]/f[1]+`);
      const vec2 inputShapeRC = vec2(`+i+".0, "+u+`.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = vec2(yRC) * effectiveInputOverOutputRatioRC;

        // Compute the four integer indices.
        ivec2 sourceFloorRC = ivec2(sourceFracIndexRC);
        ivec2 sourceCeilRC = ivec2(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);
        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);
        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);
        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);

        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);

        float top = topLeft + (topRight - topLeft) * fracRC.y;
        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;
        float newValue = top + (bottom - top) * fracRC.x;

        setOutput(newValue);
      }
    `},dB=function(n,t,e,r){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];var a=n[0],i=n[1],u=n[2],l=n[3];this.outputShape=[a,t,e,l];var c=[r&&t>1?i-1:i,r&&e>1?u-1:u],f=[r&&t>1?t-1:t,r&&e>1?e-1:e];this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          `+c[0]/f[0]+`,
          `+c[1]/f[1]+`,
          `+c[1]/f[1]+`);
      const vec3 inputShapeRC = vec3(`+i+".0, "+u+`.0,
                                     `+u+`.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = vec3(yRC) * effectiveInputOverOutputRatioRC;

        // Compute the four integer indices.
        ivec3 sourceFloorRC = ivec3(sourceFracIndexRC);
        ivec3 sourceCeilRC = ivec3(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < `+(l-1)+`;
        bool hasNextRow = coords.z < `+(e-1)+`;

        // In parallel, construct four corners for all four components in
        // packed 2x2 cell.
        vec4 topLeft = vec4(
          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 bottomLeft = vec4(
          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 topRight = vec4(
          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec4 bottomRight = vec4(
          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);

        vec4 top = mix(topLeft, topRight, fracRC.yyzz);
        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);
        vec4 newValue = mix(top, bottom, fracRC.x);

        setOutput(newValue);
      }
    `},pB=function(n,t,e){this.variableNames=["dy"],this.outputShape=[],this.outputShape=t.shape;var r=t.shape,a=r[1],i=r[2],u=n.shape,l=u[1],c=u[2],f=[e&&l>1?a-1:a,e&&c>1?i-1:i],d=[e&&l>1?l-1:l,e&&c>1?c-1:c],v=f[0]/d[0],m=f[1]/d[1],g=1/v,b=1/m,w=2*Math.ceil(g)+2,S=2*Math.ceil(b)+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(`+v+`);
        const float widthScale = float(`+m+`);

        const float invHeightScale = float(`+g+`);
        const float invWidthScale = float(`+b+`);

        const int winHeight = int(`+w+`);
        const int winWidth = int(`+S+`);

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(floor(startRLerp - float(winHeight / 2)));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(floor(startCLerp - float(winWidth / 2)));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= `+l+`) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= `+c+`) {
              continue;
            }

            float sourceFracRow =
              float(`+f[0]+`) *
                (float(dyR) / float(`+d[0]+`));

            float sourceFracCol =
                float(`+f[1]+`) *
                  (float(dyC) / float(`+d[1]+`));

            int sourceNearestRow = int(min(
                float(int(`+a+`) - 1),
                `+e+` ? float(round(sourceFracRow)) :
                                  float(floor(sourceFracRow))));

            int sourceNearestCol = int(min(
                float(int(`+i+`) - 1),
                `+e+` ? float(round(sourceFracCol)) :
                                  float(floor(sourceFracCol))));

            if (r == sourceNearestRow && c == sourceNearestCol) {
              accumulator += getDy(b, dyR, dyC, d);
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `},vB=function(n,t,e,r){this.variableNames=["A"],this.outputShape=[];var a=n[0],i=n[1],u=n[2],l=n[3];this.outputShape=[a,t,e,l];var c=[r&&t>1?i-1:i,r&&e>1?u-1:u],f=[r&&t>1?t-1:t,r&&e>1?e-1:e],d=r?"0.5":"0.0";this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          `+c[0]/f[0]+`,
          `+c[1]/f[1]+`);
      const vec2 inputShapeRC = vec2(`+i+".0, "+u+`.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = vec2(yRC) * effectiveInputOverOutputRatioRC;

        // Compute the coordinators of nearest neighbor point.
        ivec2 sourceNearestRC = ivec2(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + `+d+`)));

        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);

        setOutput(newValue);
      }
    `},mB=function(n,t){this.variableNames=["x"];var e=n.length;if(e>4)throw new Error("WebGL backend: Reverse of rank-"+e+" tensor is not yet supported");if(this.outputShape=n,e!==1){var r=n.map(function(i,u){return function(l){return t.indexOf(l)!==-1&&n[l]!==1?n[l]+" - coords["+l+"] - 1":"coords["+l+"]"}(u)}).join(","),a=pt(e);this.userCode=`
      void main() {
        `+a+` coords = getOutputCoords();
        setOutput(getX(`+r+`));
      }
    `}else this.userCode=`
        void main() {
          int coord = getOutputCoords();
          setOutput(getX(`+n[0]+` - coord - 1));
        }
      `},gB=function(n,t){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;var e=n.length;if(e>4)throw new Error("WebGL backend: Reverse of rank-"+e+" tensor is not yet supported");this.outputShape=n;var r=In("rc",e),a=r[e-1]+" + 1 < "+this.outputShape[e-1],i=r[e-2]+" + 1 < "+this.outputShape[e-2],u=pt(e);function l(c){var f=n.map(function(d,v){return function(m,g){return t.indexOf(m)!==-1&&n[m]!==1?n[m]+" - "+g[m]+" - 1":""+g[m]}(v,c)});return"getChannel(getX("+f.join(",")+"), vec2("+f.slice(-2).join(",")+"))"}this.userCode=e===1?`
        void main(){
          int rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = getChannel(getX(`+n[0]+` - rc - 1),
            `+n[0]+` - rc - 1);
          if(`+a+`){
              result.g = getChannel(getX(`+n[0]+` - (rc  + 1) - 1),
                `+n[0]+` - (rc  + 1) - 1);
          }
          setOutput(result);
        }
      `:`
        void main() {
          `+u+` rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = `+function(c){return l(c)}(r.slice())+`;
          if(`+a+`){
            result.g = `+function(c){return c[e-1]="("+c[e-1]+" + 1)",l(c)}(r.slice())+`;
          }
          if(`+i+`) {
            result.b = `+function(c){return c[e-2]="("+c[e-2]+" + 1)",l(c)}(r.slice())+`;
            if(`+a+`) {
              result.a = `+function(c){return c[e-1]="("+c[e-1]+" + 1)",c[e-2]="("+c[e-2]+" + 1)",l(c)}(r.slice())+`;
            }
          }
          setOutput(result);
        }
    `},kw=function(n,t,e,r,a,i,u){this.variableNames=["updates","indices","defaultValue"],this.outputShape=i;var l=pt(a.length),c=pt(i.length),f="";e===1?f="i":e===2&&(f="i, j");var d="getIndices("+f+")",v="";r===1?v="i":r===2&&(v="i, coords[1]");var m="getUpdates("+v+")",g=t>1?"strides[j]":"strides";this.userCode=`
        `+l+" strides = "+l+"("+a+`);

        void main() {
          `+c+` coords = getOutputCoords();
          float sum = 0.0;
          bool found = false;
          for (int i = 0; i < `+n+`; i++) {
            int flattenedIndex = 0;
            for (int j = 0; j < `+t+`; j++) {
              int index = round(`+d+`);
              flattenedIndex += index * `+g+`;
            }
            if (flattenedIndex == coords[0]) {
              sum += `+m+`;
              found = true;
            }
          }
          setOutput(mix(getDefaultValue(), sum, float(found)));
        }
      `},yB=function(n,t){this.variableNames=["x","segmentIds"];var e=n.windowSize,r=n.batchSize,a=n.inSize,i=n.numSegments,u=i*Math.ceil(a/e);this.outputShape=[r,u];var l=4*Math.floor(e/4),c=e%4,f=`
        sumValue += dot(values, segFilter);
    `,d="";a%e>0&&(d=`
        if (inIdx < 0 || inIdx >= `+a+`) {
          return initializationValue;
        }
      `);var v="";a%e>0&&(v=`
        if (inIdx < 0 || inIdx >= `+a+`) {
          return -1.0;
        }
      `),this.userCode=`
      const float initializationValue = 0.0;

      float getValue(int batch, int inIdx) {
        `+d+`
        return getX(batch, inIdx);
      }

      float getSegmentIdAtIndex(int inIdx) {
        `+v+`
        return getSegmentIds(inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = int(floor(float(outIdx) / float(
          `+i+")) * float("+e+`));
        int currentSeg = int(mod(float(outIdx), float(`+i+`)));

        float sumValue = 0.0;

        for (int i = 0; i < `+l+`; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0
          );

          `+f+`
        }

        int inIdx = inOffset + `+l+`;
        if (`+(c===1)+`) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            0,
            0,
            0
          );

          `+f+`
        } else if (`+(c===2)+`) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
              0,
              0
          );

          `+f+`
        } else if (`+(c===3)+`) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            0
          );

          `+f+`
        }
        setOutput(sumValue);
      }
    `},bB=function(n,t,e){var r,a;if(this.variableNames=["c","a","b"],this.outputShape=t,e>4)throw Error("Where for rank "+e+" is not yet supported");if(e===1)a="resRC",r="resRC";else{for(var i=["resRC.x","resRC.y","resRC.z","resRC.w"],u=[],l=[],c=0;c<t.length;c++)l.push(""+i[c]),c<n&&u.push(""+i[c]);r=u.join(),a=l.join()}var f=pt(e);this.userCode=`
      void main() {
        `+f+` resRC = getOutputCoords();
        float cVal = getC(`+r+`);
        if (cVal >= 1.0) {
          setOutput(getA(`+a+`));
        } else {
          setOutput(getB(`+a+`));
        }
      }
    `},xB=function(){function n(t){this.variableNames=["source"],this.outputShape=t,this.rank=t.length;var e,r=pt(this.rank),a="uniform int start["+this.rank+"];",i=function(u){if(u===1)return"sourceLoc";if(u<=6)return hv.slice(0,u).map(function(l){return"sourceLoc."+l}).join(",");throw Error("Slicing for rank "+u+" is not yet supported")}(this.rank);e=`
        `+r+` sourceLoc;
        `+r+` coords = getOutputCoords();
        `+t.map(function(u,l){return"sourceLoc."+hv[l]+" = start["+l+"] + coords."+hv[l]+";"}).join(`
`)+`
      `,this.userCode=`
      `+a+`
      void main() {
        `+e+`
        setOutput(getSource(`+i+`));
      }
    `}return n.prototype.getCustomSetupFunc=function(t){var e=this;if(t.length!==this.rank)throw Error("The rank ("+this.rank+") of the program must match the length of start ("+t.length+")");return function(r,a){e.startLoc==null&&(e.startLoc=r.getUniformLocationNoThrow(a,"start"),e.startLoc==null)||r.gl.uniform1iv(e.startLoc,t)}},n}(),hv=["x","y","z","w","u","v"],wB=function(){function n(t){this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.rank=t.length;var e=pt(this.rank),r=In("coords",this.rank),a=In("sourceLoc",this.rank),i=this.rank===1?"sourceLoc":"vec2("+a.slice(-2).join()+")",u="getChannel(getSource("+a.join()+"), "+i+")",l=`
      result.x = `+u+`;
      if (++`+r[this.rank-1]+" < "+t[this.rank-1]+`) {
        ++`+a[this.rank-1]+`;
        result.y = `+u+`;
        --`+a[this.rank-1]+`;
      }
    `,c=this.rank===1?"":`
      --`+r[this.rank-1]+`;
      if (++`+r[this.rank-2]+" < "+t[this.rank-2]+`) {
        ++`+a[this.rank-2]+`;
        result.z = `+u+`;
        if (++`+r[this.rank-1]+" < "+t[this.rank-1]+`) {
          ++`+a[this.rank-1]+`;
          result.w = `+u+`;
        }
      }
    `,f=this.rank<=4?`sourceLoc = coords +
            `+e+"("+t.map(function(d,v){return"start["+v+"]"}).join()+");":t.map(function(d,v){return a[v]+" = "+r[v]+" + start["+v+"];"}).join(`
`);this.userCode=`
      uniform int start[`+this.rank+`];
      void main() {
        `+e+` coords = getOutputCoords();
        `+e+` sourceLoc;
        `+f+`
        vec4 result = vec4(0.);
        `+l+`
        `+c+`
        setOutput(result);
      }
    `}return n.prototype.getCustomSetupFunc=function(t){var e=this;if(t.length!==this.rank)throw Error("The rank ("+this.rank+") of the program must match the length of start ("+t.length+")");return function(r,a){e.startLoc==null&&(e.startLoc=r.getUniformLocationNoThrow(a,"start"),e.startLoc==null)||r.gl.uniform1iv(e.startLoc,t)}},n}(),SB=function(n,t,e){this.variableNames=["x"],this.outputShape=e;var r=e.length,a=pt(e.length),i=pt(e.length),u="";if(r===1)u="coords * strides + begin";else{var l=0;u=e.map(function(c,f){return l++,e.length===1?"coords * strides["+f+"] + begin["+f+"]":"coords["+(l-1)+"] * strides["+f+"] + begin["+f+"]"}).join(",")}this.userCode=`
      `+a+" begin = "+a+"("+n+`);
      `+a+" strides = "+a+"("+t+`);

      void main() {
        `+i+` coords = getOutputCoords();
        setOutput(getX(`+u+`));
      }
    `},EB=function(){function n(t){this.gpgpu=t,this.numUsedTextures=0,this.numFreeTextures=0,this.freeTextures={},this.logEnabled=!1,this.usedTextures={}}return n.prototype.acquireTexture=function(t,e,r){var a,i=Nw(e,r),u=Mw(t,i,r);if(u in this.freeTextures||(this.freeTextures[u]=[]),u in this.usedTextures||(this.usedTextures[u]=[]),this.freeTextures[u].length>0){this.numFreeTextures--,this.numUsedTextures++,this.log();var l=this.freeTextures[u].shift();return this.usedTextures[u].push(l),l}return this.numUsedTextures++,this.log(),i===Kn.PACKED_2X2_FLOAT32?a=this.gpgpu.createPackedMatrixTexture(t[0],t[1]):i===Kn.PACKED_2X2_FLOAT16?a=this.gpgpu.createFloat16PackedMatrixTexture(t[0],t[1]):i===Kn.UNPACKED_FLOAT32?a=this.gpgpu.createFloat32MatrixTexture(t[0],t[1]):i===Kn.UNPACKED_FLOAT16?a=this.gpgpu.createFloat16MatrixTexture(t[0],t[1]):i===Kn.PACKED_4X1_UNSIGNED_BYTE&&(a=this.gpgpu.createUnsignedBytesMatrixTexture(t[0],t[1])),this.usedTextures[u].push(a),a},n.prototype.releaseTexture=function(t,e,r,a){if(this.freeTextures!=null){var i=Mw(e,Nw(r,a),a);i in this.freeTextures||(this.freeTextures[i]=[]),this.freeTextures[i].push(t),this.numFreeTextures++,this.numUsedTextures--;var u=this.usedTextures[i],l=u.indexOf(t);if(l<0)throw new Error("Cannot release a texture that was never provided by this texture manager");u.splice(l,1),this.log()}},n.prototype.log=function(){if(this.logEnabled){var t=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used",this.numFreeTextures+" / "+this.numUsedTextures,"("+t+")")}},n.prototype.getNumUsedTextures=function(){return this.numUsedTextures},n.prototype.getNumFreeTextures=function(){return this.numFreeTextures},n.prototype.dispose=function(){var t=this;if(this.freeTextures!=null){for(var e in this.freeTextures)this.freeTextures[e].forEach(function(r){t.gpgpu.deleteMatrixTexture(r)});for(var e in this.usedTextures)this.usedTextures[e].forEach(function(a){t.gpgpu.deleteMatrixTexture(a)});this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0}},n}();function Nw(n,t){if(n===Xn.UPLOAD)return Kn.PACKED_2X2_FLOAT32;if(n===Xn.RENDER||n==null)return function(e){return ue().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?e?Kn.PACKED_2X2_FLOAT32:Kn.UNPACKED_FLOAT32:e?Kn.PACKED_2X2_FLOAT16:Kn.UNPACKED_FLOAT16}(t);if(n===Xn.DOWNLOAD||n===Xn.PIXELS)return Kn.PACKED_4X1_UNSIGNED_BYTE;throw new Error("Unknown logical texture type "+n)}function Mw(n,t,e){return n[0]+"_"+n[1]+"_"+t+"_"+e}var _B=function(n,t){this.variableNames=["A"];for(var e=new Array(n.length),r=0;r<e.length;r++)e[r]=n[r]*t[r];this.outputShape=e,this.rank=e.length;var a=pt(this.rank),i=function(u){var l=u.length;if(l>5)throw Error("Tile for rank "+l+" is not yet supported");if(l===1)return"imod(resRC, "+u[0]+")";for(var c=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],f=[],d=0;d<u.length;d++)f.push("imod("+c[d]+", "+u[d]+")");return f.join()}(n);this.userCode=`
      void main() {
        `+a+` resRC = getOutputCoords();
        setOutput(getA(`+i+`));
      }
    `},CB=function(n,t){this.variableNames=["A"];for(var e=new Array(n.length),r=0;r<e.length;r++)e[r]=n[t[r]];this.outputShape=e,this.rank=e.length;var a=pt(this.rank),i=function(u){var l=u.length;if(l>6)throw Error("Transpose for rank "+l+" is not yet supported");for(var c=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],f=new Array(l),d=0;d<u.length;d++)f[u[d]]=c[d];return f.join()}(t);this.userCode=`
    void main() {
      `+a+` resRC = getOutputCoords();
      setOutput(getA(`+i+`));
    }
    `},RB=function(n,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;for(var e=new Array(n.length),r=0;r<e.length;r++)e[r]=n[t[r]];if(this.outputShape=e,this.rank=e.length,this.rank>6)throw Error("Packed transpose for rank "+this.rank+" is not yet supported.");var a=pt(this.rank),i=bE("rc",this.rank),u=new Array(this.rank);for(r=0;r<t.length;r++)u[t[r]]=i[r];var l="vec2("+u.slice(-2).join()+")",c="++"+i[this.rank-1]+" < "+e[this.rank-1],f="getChannel(getA("+u.join()+"), "+l+")";this.userCode=`
    void main() {
      `+a+` rc = getOutputCoords();
      vec4 result = vec4(0.);
      result[0] = `+f+`;
      if(`+c+`) {
        result[1] = `+f+`;
      }
      --`+i[this.rank-1]+`;
      if(++`+i[this.rank-2]+" < "+e[this.rank-2]+`) {
        result[2] = `+f+`;
        if(`+c+`) {
          result[3] = `+f+`;
        }
      }
      setOutput(result);
    }
    `},ng=1.7580993408473768,rg=1.0507009873554805,Ue=function(n,t){this.variableNames=["A"],this.outputShape=n,this.userCode=`
      float unaryOperation(float x) {
        `+t+`
      }

      void main() {
        float x = getAAtOutCoords();
        float y = unaryOperation(x);

        setOutput(y);
      }
    `},Or="if (isnan(x)) return x;",AB="return x;",Iw="return abs(x);",_E=Or+`
  return (x < 0.0) ? 0.0 : x;
`,CE=Or+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,RE="return (x >= 0.0) ? x : (exp(x) - 1.0);",TB=`
  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.
  // see: https://arxiv.org/abs/1706.02515
  float scaleAlpha = `+ng+`;
  float scale = `+rg+`;
  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);
`,Fw="return -x;",Bw="return ceil(x);",Pw="return floor(x);",Lw="return exp(x);",zw="return exp(x) - 1.0;",DB=Or+`
  return sin(x);
`,OB=Or+`
  return cos(x);
`,kB=Or+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return asin(x);
`,NB=Or+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return acos(x);
`,MB=Or+`
  return atan(x);
`,IB=Or+"return log(x + sqrt(x * x + 1.0));",FB=Or+`
  if (x < 1.0) return NAN;
  return log(x + sqrt(x * x - 1.0));`,BB=Or+`
  if ((x < -1.0) || (x > 1.0)) return NAN;
  return (log(1.0 + x) - log(1.0 - x)) / 2.0;`,jc="return x;",PB="return x;",AE=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,TE=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,DE=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,Iu=function(n,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n,this.userCode=`
      vec4 unaryOperation(vec4 x) {
        `+t+`
      }

      void main() {
        vec4 x = getAAtOutCoords();
        vec4 y = unaryOperation(x);

        setOutput(y);
      }
    `},LB=function(n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=n;var t=n.length,e=In("rc",t),r=pt(t),a=function(l,c){if(l===1)return"rc";for(var f="",d=0;d<l;d++)f+=c[d],d<l-1&&(f+=",");return f}(t,e),i=e.slice(-2),u=t<=1?"rc":"vec2("+i.join(",")+")";this.userCode=`
      void main() {
        `+r+` rc = getOutputCoords();
        vec4 packedInput = getA(`+a+`);

        setOutput(getChannel(packedInput, `+u+`));
      }
    `},qc={};function $c(n,t){if(t===void 0&&(t=!1),n==="linear")return t?PB:AB;if(n==="relu")return t?AE:_E;if(n==="elu")return t?DE:RE;if(n==="relu6")return t?TE:CE;if(n==="prelu")return t?EE:SE;throw new Error("Activation "+n+" has not been implemented for the WebGL backend.")}var zB=600,UB=function(n){function t(e){var r,a=n.call(this)||this;if(a.pendingRead=new WeakMap,a.pendingDisposal=new WeakSet,a.dataRefCount=new WeakMap,a.numBytesInGPU=0,a.uploadWaitMs=0,a.downloadWaitMs=0,a.warnedAboutMemory=!1,a.pendingDeletes=0,a.disposed=!1,!ue().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");if(e==null){var i=Jr(ue().getNumber("WEBGL_VERSION"));a.binaryCache=((r=ue().getNumber("WEBGL_VERSION"))in qc||(qc[r]={}),qc[r]),a.gpgpu=new YF(i),a.canvas=i.canvas,a.gpgpuCreatedLocally=!0}else a.gpgpu=e,a.binaryCache={},a.gpgpuCreatedLocally=!1,a.canvas=e.gl.canvas;return a.textureManager=new EB(a.gpgpu),a.numMBBeforeWarning=ue().global.screen==null?1024:ue().global.screen.height*ue().global.screen.width*window.devicePixelRatio*zB/1024/1024,a.texData=new cE(a,q),a}return Dr(t,n),t.prototype.numDataIds=function(){return this.texData.numDataIds()+(this.cpuBackend?this.cpuBackend.numDataIds():0)-this.pendingDeletes},t.prototype.write=function(e,r,a){if(ue().getBool("DEBUG")&&this.checkNumericalProblems(e),a==="complex64"&&e!=null)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");var i={};return this.texData.set(i,{shape:r,dtype:a,values:e,usage:Xn.UPLOAD}),i},t.prototype.move=function(e,r,a,i){if(ue().getBool("DEBUG")&&this.checkNumericalProblems(r),i==="complex64")throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(e,{shape:a,dtype:i,values:r,usage:Xn.UPLOAD})},t.prototype.readSync=function(e){var r=this.texData.get(e),a=r.values,i=r.dtype,u=r.complexTensors,l=r.slice,c=r.shape,f=r.isPacked;if(l!=null){var d=void 0;d=f?new Iu(c,jc):new Ue(c,jc);var v=this.runWebGLProgram(d,[{dataId:e,shape:c,dtype:i}],i),m=this.readSync(v.dataId);return this.disposeData(v.dataId),m}if(a!=null)return this.convertAndCacheOnCPU(e);if(i==="string")return a;var g,b,w=this.activeTimers!=null;return w&&(g=Hr()),i==="complex64"?b=cm(u.real.dataSync(),u.imag.dataSync()):b=this.getValuesFromTexture(e),w&&(this.downloadWaitMs+=Hr()-g),this.convertAndCacheOnCPU(e,b)},t.prototype.read=function(e){return we(this,void 0,void 0,function(){var r,a,i,u,l,c,f,d,v,m,g,b,w,S,E,_,R,C,A,D,O,F;return Se(this,function(N){switch(N.label){case 0:if(this.pendingRead.has(e))return r=this.pendingRead.get(e),[2,new Promise(function(B){return r.push(B)})];if(a=this.texData.get(e),i=a.values,u=a.shape,l=a.slice,c=a.dtype,f=a.complexTensors,d=a.isPacked,l!=null)return v=void 0,v=d?new Iu(u,jc):new Ue(u,jc),m=this.runWebGLProgram(v,[{dataId:e,shape:u,dtype:c}],c),g=this.read(m.dataId),this.disposeData(m.dataId),[2,g];if(i!=null)return[2,this.convertAndCacheOnCPU(e)];if(!ue().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&ue().getNumber("WEBGL_VERSION")===2)throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");return b=null,c!=="complex64"&&ue().get("WEBGL_BUFFER_SUPPORTED")&&(w=this.decode(e),S=this.texData.get(w.dataId),b=(F=this.gpgpu).createBufferFromTexture.apply(F,[S.texture].concat(zu(u)))),this.pendingRead.set(e,[]),c==="complex64"?[3,2]:[4,this.gpgpu.createAndWaitForFence()];case 1:N.sent(),N.label=2;case 2:return c!=="complex64"?[3,4]:[4,Promise.all([f.real.data(),f.imag.data()])];case 3:return _=N.sent(),R=_[0],C=_[1],E=cm(R,C),[3,5];case 4:b==null?E=this.getValuesFromTexture(e):(A=Ee(u),E=this.gpgpu.downloadFloat32MatrixFromBuffer(b,A)),N.label=5;case 5:return w!=null&&this.disposeData(w.dataId),D=this.convertAndCacheOnCPU(e,E),O=this.pendingRead.get(e),this.pendingRead.delete(e),O.forEach(function(B){return B(D)}),this.pendingDisposal.has(e)&&(this.pendingDisposal.delete(e),this.disposeData(e),this.pendingDeletes--),[2,D]}})})},t.prototype.checkNumericalProblems=function(e){if(e!=null)for(var r=0;r<e.length;r++){var a=e[r];if(!TM(a))throw ue().getBool("WEBGL_RENDER_FLOAT32_CAPABLE")?Error("The value "+a+" cannot be represented with your current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'"):Error("The value "+a+" cannot be represented on this device.")}},t.prototype.getValuesFromTexture=function(e){var r,a=this.texData.get(e),i=a.shape,u=a.dtype,l=a.isPacked,c=Ee(i);if(ue().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){var f=this.decode(e),d=this.texData.get(f.dataId),v=(r=this.gpgpu).downloadMatrixFromPackedTexture.apply(r,[d.texture].concat(zu(i))).subarray(0,c);return this.disposeData(f.dataId),v}var m=ue().getBool("WEBGL_PACK")&&l===!0,g=m?iv(i):i,b=m?new AF(g):new RF(g),w=this.runWebGLProgram(b,[{shape:g,dtype:u,dataId:e}],"float32"),S=this.texData.get(w.dataId),E=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(S.texture,S.texShape[0],S.texShape[1]).subarray(0,c);return this.disposeData(w.dataId),E},t.prototype.time=function(e){return we(this,void 0,void 0,function(){var r,a,i,u,l,c,f;return Se(this,function(d){switch(d.label){case 0:return r=this.activeTimers,a=[],i=!1,this.programTimersStack==null?(this.programTimersStack=a,i=!0):this.activeTimers.push(a),this.activeTimers=a,e(),u=ws(this.activeTimers.map(function(v){return v.query})).filter(function(v){return v!=null}),l=ws(this.activeTimers.map(function(v){return v.name})).filter(function(v){return v!=null}),this.activeTimers=r,i&&(this.programTimersStack=null),c={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null},ue().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?[4,Promise.all(u)]:[3,2];case 1:return f=d.sent(),c.kernelMs=uM(f),c.getExtraProfileInfo=function(){return f.map(function(v,m){return{name:l[m],ms:v}}).map(function(v){return v.name+": "+v.ms}).join(", ")},[3,3];case 2:c.kernelMs={error:"WebGL query timers are not supported in this environment."},d.label=3;case 3:return this.uploadWaitMs=0,this.downloadWaitMs=0,[2,c]}})})},t.prototype.memory=function(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU}},t.prototype.startTimer=function(){return ue().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:Hr(),endMs:null}},t.prototype.endTimer=function(e){return ue().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),e):(e.endMs=Hr(),e)},t.prototype.getQueryTime=function(e){return we(this,void 0,void 0,function(){var r;return Se(this,function(a){return ue().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?[2,this.gpgpu.waitForQueryAndGetTime(e)]:[2,(r=e).endMs-r.startMs]})})},t.prototype.disposeData=function(e){if(!this.pendingDisposal.has(e)){if(this.pendingRead.has(e))return this.pendingDisposal.add(e),void this.pendingDeletes++;if(this.texData.has(e)){this.releaseGPUData(e);var r=this.texData.get(e).complexTensors;r!=null&&(r.real.dispose(),r.imag.dispose()),this.texData.delete(e)}}},t.prototype.releaseGPUData=function(e){var r=this.texData.get(e),a=r.texture,i=r.dtype,u=r.texShape,l=r.usage,c=r.isPacked,f=r.slice,d=f&&f.origDataId||e,v=this.dataRefCount.get(d);v>1?this.dataRefCount.set(d,v-1):(this.dataRefCount.delete(d),a!=null&&(this.numBytesInGPU-=this.computeBytes(u,i),this.textureManager.releaseTexture(a,u,l,c)));var m=this.texData.get(e);m.texture=null,m.texShape=null,m.isPacked=!1,m.slice=null},t.prototype.getTexture=function(e){return this.uploadToGPU(e),this.texData.get(e).texture},t.prototype.getDataInfo=function(e){return this.texData.get(e)},t.prototype.getCPUBackend=function(){return ue().getBool("WEBGL_CPU_FORWARD")?(this.cpuBackend==null&&(this.cpuBackend=q.findBackend("cpu")),this.cpuBackend):null},t.prototype.shouldExecuteOnCPU=function(e,r){var a=this;return r===void 0&&(r=128),this.getCPUBackend()!=null&&e.every(function(i){return a.texData.get(i.dataId).texture==null&&i.size<r})},t.prototype.getGPGPUContext=function(){return this.gpgpu},t.prototype.complex=function(e,r){var a=this.makeOutput(e.shape,"complex64");return this.texData.get(a.dataId).complexTensors={real:q.keep(e.clone()),imag:q.keep(r.clone())},a},t.prototype.real=function(e){return this.texData.get(e.dataId).complexTensors.real.clone()},t.prototype.imag=function(e){return this.texData.get(e.dataId).complexTensors.imag.clone()},t.prototype.slice=function(e,r,a){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.slice(e,r,a);if(Ee(a)===0)return fn([],a,e.dtype);var i=this.texData.get(e.dataId).isPacked,u=uE(e.shape,r,a);if(i||!u){var l=ue().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new wB(a):new xB(a),c=l.getCustomSetupFunc(r);return this.compileAndRun(l,[e],null,c)}return this.uploadToGPU(e.dataId),this.shallowSlice(e,r,a)},t.prototype.shallowSlice=function(e,r,a){var i=this.texData.get(e.dataId),u=this.makeOutput(a,e.dtype),l=this.texData.get(u.dataId);Object.assign(l,i),l.shape=a,l.dtype=e.dtype;var c=lE(r,e.strides);i.slice&&(c+=i.slice.flatOffset),l.slice={flatOffset:c,origDataId:i.slice&&i.slice.origDataId||e.dataId};var f=this.dataRefCount.get(l.slice.origDataId)||1;return this.dataRefCount.set(l.slice.origDataId,f+1),u},t.prototype.stridedSlice=function(e,r,a,i){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.stridedSlice(e,r,a,i);var u=Zm(r,a,i);if(u.some(function(c){return c===0}))return fn([],u);var l=new SB(r,i,u);return this.compileAndRun(l,[e])},t.prototype.reverse=function(e,r){var a=ue().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new gB(e.shape,r):new mB(e.shape,r);return this.compileAndRun(a,[e])},t.prototype.concat=function(e,r){if(e[0].dtype==="complex64"){var a=e.map(function(g){return dr(g)}),i=e.map(function(g){return Wr(g)});return ln(this.concat(a,r),this.concat(i,r))}if(this.shouldExecuteOnCPU(e))return this.cpuBackend.concat(e,r);if(e.length===1)return e[0];if(e.length>ue().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER")){var u=Math.floor(e.length/2),l=this.concat(e.slice(0,u),r),c=this.concat(e.slice(u),r);return this.concat([l,c],r)}if(ue().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&e[0].rank>1){var f=new hF(e.map(function(g){return g.shape}),r);return this.compileAndRun(f,e)}var d=Es(e.map(function(g){return g.shape}),r),v=e.map(function(g){return g.as2D(-1,Ee(g.shape.slice(r)))}),m=new fF(v.map(function(g){return g.shape}));return this.compileAndRun(m,v).reshape(d)},t.prototype.neg=function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.neg(e);if(ue().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,Fw,e.dtype);var r=new Ue(e.shape,Fw);return this.compileAndRun(r,[e])},t.prototype.batchMatMul=function(e,r,a,i){var u=a?e.shape[2]:e.shape[1],l=i?r.shape[1]:r.shape[2],c=a?e.shape[1]:e.shape[2],f=e.shape[0];if((u===1||l===1)&&c>1e3){a&&(e=e.transpose([0,2,1])),i&&(r=r.transpose([0,2,1]));var d=l===1?e:e.as3D(f,c,1),v=l===1?2:1,m=l===1?r.as3D(f,1,c):r;return this.multiply(d,m).sum(v,!0)}var g=cn(e.dtype,r.dtype),b=new lv(e.shape,[f,u,l],a,i);return this.compileAndRun(b,[e,r],g)},t.prototype.fusedBatchMatMul=function(e){var r=e.a,a=e.b,i=e.transposeA,u=e.transposeB,l=e.bias,c=e.activation,f=e.preluActivationWeights,d=i?r.shape[2]:r.shape[1],v=u?a.shape[1]:a.shape[2],m=r.shape[0],g=cn(r.dtype,a.dtype),b=l!=null,w=f!=null,S=c?$c(c,!0):null,E=new lv(r.shape,[m,d,v],i,u,b,S,w),_=[r,a];return l&&_.push(l),f&&_.push(f),this.compileAndRun(E,_,g)},t.prototype.multiply=function(e,r){if(e.dtype==="complex64"){var a=this.texData.get(e.dataId),i=this.texData.get(r.dataId),u=new Ew(oF,e.shape,r.shape),l=new Ew(sF,e.shape,r.shape),c=[this.makeComplexComponentTensorInfo(e,a.complexTensors.real),this.makeComplexComponentTensorInfo(e,a.complexTensors.imag),this.makeComplexComponentTensorInfo(r,i.complexTensors.real),this.makeComplexComponentTensorInfo(r,i.complexTensors.imag)],f=this.compileAndRun(u,c),d=this.compileAndRun(l,c),v=this.complex(f,d);return f.dispose(),d.dispose(),v}if(this.shouldExecuteOnCPU([e,r]))return this.cpuBackend.multiply(e,r);if(ue().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,r,_w,e.dtype);var m=new Tt(_w,e.shape,r.shape);return this.compileAndRun(m,[e,r],e.dtype)},t.prototype.batchNormalization=function(e,r,a,i,u,l){var c=[e,r,a],f=null;l!=null&&(f=l.shape,c.push(l));var d=null;if(u!=null&&(d=u.shape,c.push(u)),ue().getBool("WEBGL_PACK_NORMALIZATION")){var v=new iF(e.shape,r.shape,a.shape,f,d,i);return this.compileAndRun(v,c)}var m=new aF(e.shape,r.shape,a.shape,f,d,i);return this.compileAndRun(m,c)},t.prototype.localResponseNormalization4D=function(e,r,a,i,u){var l=ue().getBool("WEBGL_PACK_NORMALIZATION")?new tB(e.shape,r,a,i,u):new JF(e.shape,r,a,i,u);return this.compileAndRun(l,[e])},t.prototype.LRNGrad=function(e,r,a,i,u,l,c){var f=new eB(r.shape,i,u,l,c);return this.compileAndRun(f,[r,a,e])},t.prototype.tile=function(e,r){if(e.dtype==="string"){var a=this.readSync(e.dataId).map(function(u){return _f(u)});return gE(Pe(e.shape,e.dtype,a),r)}var i=new _B(e.shape,r);return this.compileAndRun(i,[e])},t.prototype.pad=function(e,r,a){var i=ue().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new uB(e.shape,r,a):new sB(e.shape,r,a);return this.compileAndRun(i,[e])},t.prototype.transpose=function(e,r){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.transpose(e,r);var a=ue().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new RB(e.shape,r):new CB(e.shape,r);return this.compileAndRun(a,[e])},t.prototype.gather=function(e,r,a){if(this.shouldExecuteOnCPU([e,r]))return this.cpuBackend.gather(e,r,a);var i=new MF(e.shape,r.size,a);return this.compileAndRun(i,[e,r])},t.prototype.batchToSpaceND=function(e,r,a){P(e.rank<=4,function(){return"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet"});var i=r.reduce(function(v,m){return v*m}),u=Of(e.shape,r,i),l=kf(u.length,r.length),c=Nf(e.shape,r,i),f=aE(a,r.length),d=iE(c,a,r.length);return e.reshape(u).transpose(l).reshape(c).slice(f,d)},t.prototype.spaceToBatchND=function(e,r,a){P(e.rank<=4,function(){return"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet"});var i=r.reduce(function(m,g){return m*g}),u=[[0,0]];u.push.apply(u,a);for(var l=1+r.length;l<e.shape.length;++l)u.push([0,0]);var c=e.pad(u),f=Of(c.shape,r,i,!1),d=kf(f.length,r.length,!1),v=Nf(c.shape,r,i,!1);return c.reshape(f).transpose(d).reshape(v)},t.prototype.reduce=function(e,r,a){var i=e.shape[0],u=e.shape[1],l=ov(u),c=new lB({windowSize:l,inSize:u,batchSize:i},r),f=this.compileAndRun(c,[e],a);return f.shape[1]===1?f:this.reduce(f,r,a)},t.prototype.argReduce=function(e,r,a){a===void 0&&(a=null);var i=e.shape[0],u=e.shape[1];a!=null&&(i=a.shape[0],u=a.shape[1]);var l=ov(u),c=new XI({windowSize:l,inSize:u,batchSize:i},r,a==null),f=[e];a!=null&&f.push(a);var d=this.compileAndRun(c,f,"int32");return d.shape[1]===1?d:this.argReduce(e,r,d)},t.prototype.argReducePacked=function(e,r,a){a===void 0&&(a=null);var i=a!=null?a.shape:e.shape,u=ov(i[i.length-1]),l=new tF(i,u,r,a==null),c=a==null?[e]:[e,a],f=this.compileAndRun(l,c,"int32");return f.rank===e.rank?this.argReducePacked(e,r,f):f},t.prototype.sum=function(e,r){$n("sum",r,e.rank);var a=mn(e.shape,r),i=a[0],u=Ee(a[1]),l=e.as2D(-1,u),c=Qp(e.dtype);return this.reduce(l,"sum",c).reshape(i)},t.prototype.prod=function(e,r){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.prod(e,r);var a=mn(e.shape,r),i=a[0],u=Ee(a[1]),l=e.as2D(-1,u),c=Qp(e.dtype);return this.reduce(l,"prod",c).reshape(i)},t.prototype.unsortedSegmentSum=function(e,r,a){var i=0,u=ea([i],e.rank),l=e;u!=null&&(l=e.transpose(u),i=ta(1,e.rank)[0]);var c=function(g,b,w){for(var S=[],E=g.length,_=0;_<E;_++)_!==b?S.push(g[_]):S.push(w);return S}(l.shape,i,a),f=Ee([l.shape[i]]),d=l.as2D(-1,f),v=Qp(e.dtype),m=this.segOpCompute(d,"unsortedSegmentSum",r,v,a).reshape(c);return u!=null&&(m=m.transpose(qm(u))),m},t.prototype.segOpCompute=function(e,r,a,i,u){var l=e.shape[0],c=e.shape[1],f=function(m,g){var b,w=!1;for(m<=sE?(b=m,w=!0):b=tm(m,Math.floor(Math.sqrt(m)));!w;)b>g||b===m?w=!0:b=tm(m,b+1);return b}(c,u),d=new yB({windowSize:f,inSize:c,batchSize:l,numSegments:u}),v=this.compileAndRun(d,[e,a],i);return v.shape[1]===u?v:(a=Df(0,u).tile([c/f]),this.segOpCompute(v,r,a,i,u))},t.prototype.argMinMaxReduce=function(e,r,a){var i=[r];if($n("arg"+a.charAt(0).toUpperCase()+a.slice(1),i,e.rank),!ue().getBool("WEBGL_PACK_REDUCE")||e.rank<=2){var u=mn(e.shape,i),l=u[0],c=Ee(u[1]),f=e.as2D(-1,c);return this.argReduce(f,a).reshape(l)}return this.argReducePacked(e,a)},t.prototype.argMin=function(e,r){return this.argMinMaxReduce(e,r,"min")},t.prototype.argMax=function(e,r){return this.argMinMaxReduce(e,r,"max")},t.prototype.cumsum=function(e,r,a,i){if(r!==e.rank-1)throw new Error("WebGL cumsum shader expects an inner-most axis="+(e.rank-1)+" but got axis="+r);var u=new wF(e.shape,a,i);return this.compileAndRun(u,[e])},t.prototype.equal=function(e,r){if(ue().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,r,`
  return vec4(equal(a, b));
`,"bool");var a=new Tt("return float(a == b);",e.shape,r.shape);return this.compileAndRun(a,[e,r],"bool")},t.prototype.notEqual=function(e,r){if(ue().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,r,`
  return vec4(notEqual(a, b));
`,"bool");var a=new Tt("return float(a != b);",e.shape,r.shape);return this.compileAndRun(a,[e,r],"bool")},t.prototype.less=function(e,r){if(this.shouldExecuteOnCPU([e,r]))return this.cpuBackend.less(e,r);if(ue().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,r,`
  return vec4(lessThan(a, b));
`,"bool");var a=new Tt("return float(a < b);",e.shape,r.shape);return this.compileAndRun(a,[e,r],"bool")},t.prototype.lessEqual=function(e,r){if(ue().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,r,`
  return vec4(lessThanEqual(a, b));
`,"bool");var a=new Tt("return float(a <= b);",e.shape,r.shape);return this.compileAndRun(a,[e,r],"bool")},t.prototype.greater=function(e,r){if(this.shouldExecuteOnCPU([e,r]))return this.cpuBackend.greater(e,r);if(ue().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,r,`
  return vec4(greaterThan(a, b));
`,"bool");var a=new Tt("return float(a > b);",e.shape,r.shape);return this.compileAndRun(a,[e,r],"bool")},t.prototype.greaterEqual=function(e,r){if(ue().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,r,`
  return vec4(greaterThanEqual(a, b));
`,"bool");var a=new Tt("return float(a >= b);",e.shape,r.shape);return this.compileAndRun(a,[e,r],"bool")},t.prototype.logicalNot=function(e){var r=new Ue(e.shape,"return float(!(x >= 1.0));");return this.compileAndRun(r,[e])},t.prototype.logicalAnd=function(e,r){if(ue().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,r,`
  return vec4(
    vec4(greaterThanEqual(a, vec4(1.0))) *
    vec4(greaterThanEqual(b, vec4(1.0))));
`,"bool");var a=new Tt("return float(a >= 1.0 && b >= 1.0);",e.shape,r.shape);return this.compileAndRun(a,[e,r],"bool")},t.prototype.logicalOr=function(e,r){if(ue().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,r,`
  return min(
    vec4(greaterThanEqual(a, vec4(1.0))) +
    vec4(greaterThanEqual(b, vec4(1.0))),
    vec4(1.0));
`,"bool");var a=new Tt("return float(a >= 1.0 || b >= 1.0);",e.shape,r.shape);return this.compileAndRun(a,[e,r],"bool")},t.prototype.select=function(e,r,a){var i=new bB(e.rank,r.shape,r.rank);return this.compileAndRun(i,[e,r,a],cn(r.dtype,a.dtype))},t.prototype.where=function(e){Af("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");var r=e.dataSync();return eg(e.shape,r)},t.prototype.topk=function(e,r,a){return yE(e.dataSync(),e.shape,e.dtype,r)},t.prototype.min=function(e,r){$n("min",r,e.rank);var a=mn(e.shape,r),i=a[0],u=Ee(a[1]),l=e.as2D(-1,u);return this.reduce(l,"min",l.dtype).reshape(i)},t.prototype.minimum=function(e,r){if(this.shouldExecuteOnCPU([e,r]))return this.cpuBackend.minimum(e,r);var a=ue().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new xa(`
  vec4 result = vec4(min(a, b));
  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,e.shape,r.shape):new Tt(`
  if (isnan(a)) return a;
  if (isnan(b)) return b;

  return min(a, b);
`,e.shape,r.shape);return this.compileAndRun(a,[e,r])},t.prototype.mod=function(e,r){var a=ue().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new xa(`
  vec4 result = mod(a, b);
  vec4 isNaN = vec4(equal(b, vec4(0.0)));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,e.shape,r.shape):new Tt(`if (b == 0.0) return NAN;
  return mod(a, b);`,e.shape,r.shape);return this.compileAndRun(a,[e,r])},t.prototype.max=function(e,r){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.max(e,r);$n("max",r,e.rank);var a=mn(e.shape,r),i=a[0],u=Ee(a[1]),l=e.as2D(-1,u);return this.reduce(l,"max",l.dtype).reshape(i)},t.prototype.maximum=function(e,r){if(this.shouldExecuteOnCPU([e,r]))return this.cpuBackend.maximum(e,r);var a=ue().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new xa(`
  vec4 result = vec4(max(a, b));
  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,e.shape,r.shape):new Tt(`
  if (isnan(a)) return a;
  if (isnan(b)) return b;

  return max(a, b);
`,e.shape,r.shape);return this.compileAndRun(a,[e,r])},t.prototype.all=function(e,r){$n("all",r,e.rank);var a=mn(e.shape,r),i=a[0],u=Ee(a[1]),l=e.as2D(-1,u);return this.reduce(l,"all",l.dtype).reshape(i)},t.prototype.any=function(e,r){$n("any",r,e.rank);var a=mn(e.shape,r),i=a[0],u=Ee(a[1]),l=e.as2D(-1,u);return this.reduce(l,"any",l.dtype).reshape(i)},t.prototype.realDivide=function(e,r){if(ue().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,r,`
  // vec4 one = vec4(equal(a, b));
  // return one + (vec4(1.0) - one) * a / b;
  vec4 result = a / b;
  if(a.x == b.x) {
    result.x = 1.;
  }
  if(a.y == b.y) {
    result.y = 1.;
  }
  if(a.z == b.z) {
    result.z = 1.;
  }
  if(a.w == b.w) {
    result.w = 1.;
  }

  return result;
`,"float32",!0);var a=new Tt(`
if (a == b) {
  return 1.0;
};
return a / b;`,e.shape,r.shape);return this.compileAndRun(a,[e,r],"float32")},t.prototype.floorDiv=function(e,r){if(ue().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,r,`
  ivec4 ia = round(a);
  ivec4 ib = round(b);
  bvec4 cond = notEqual(ib, ivec4(0));
  ivec4 result = ivec4(0);
  vec4 s = sign(a) * sign(b);

  // Windows (D3D) wants guaranteed non-zero int division at compile-time.
  if (cond[0]) {
    result[0] = idiv(ia[0], ib[0], s[0]);
  }
  if (cond[1]) {
    result[1] = idiv(ia[1], ib[1], s[1]);
  }
  if (cond[2]) {
    result[2] = idiv(ia[2], ib[2], s[2]);
  }
  if (cond[3]) {
    result[3] = idiv(ia[3], ib[3], s[3]);
  }
  return vec4(result);
`,"int32");var a=new Tt(`
  float s = sign(a) * sign(b);
  int ia = round(a);
  int ib = round(b);
  if (ib != 0) {
    // Windows (D3D) wants guaranteed non-zero int division at compile-time.
    return float(idiv(ia, ib, s));
  } else {
    return NAN;
  }
`,e.shape,r.shape);return this.compileAndRun(a,[e,r],"int32")},t.prototype.add=function(e,r){if(e.dtype==="complex64"&&r.dtype==="complex64")return this.complexSeparableBinaryOp(e,r,sv);if(this.shouldExecuteOnCPU([e,r]))return this.cpuBackend.add(e,r);var a=cn(e.dtype,r.dtype);if(ue().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,r,sv,a);var i=new Tt(sv,e.shape,r.shape);return this.compileAndRun(i,[e,r],a)},t.prototype.packedUnaryOp=function(e,r,a){var i=new Iu(e.shape,r);return this.compileAndRun(i,[e],a)},t.prototype.packedBinaryOp=function(e,r,a,i,u){u===void 0&&(u=!1);var l=new xa(a,e.shape,r.shape,u);return this.compileAndRun(l,[e,r],i)},t.prototype.complexSeparableBinaryOp=function(e,r,a){var i=this,u=this.texData.get(e.dataId),l=this.texData.get(r.dataId),c=[[u.complexTensors.real,l.complexTensors.real],[u.complexTensors.imag,l.complexTensors.imag]].map(function(m){var g=m[0],b=m[1],w=i.makeComplexComponentTensorInfo(e,g),S=i.makeComplexComponentTensorInfo(r,b),E=new Tt(a,e.shape,r.shape);return i.compileAndRun(E,[w,S],cn(g.dtype,b.dtype))}),f=c[0],d=c[1],v=this.complex(f,d);return f.dispose(),d.dispose(),v},t.prototype.makeComplexComponentTensorInfo=function(e,r){return{dataId:r.dataId,dtype:r.dtype,shape:e.shape}},t.prototype.addN=function(e){if(e.length===1)return e[0];if(e.length>ue().get("WEBGL_MAX_TEXTURES_IN_SHADER")){var r=Math.floor(e.length/2),a=this.addN(e.slice(0,r)),i=this.addN(e.slice(r));return this.addN([a,i])}var u=e.map(function(f){return f.dtype}).reduce(function(f,d){return cn(f,d)}),l=e.map(function(f){return f.shape}),c=ue().getBool("WEBGL_PACK")?new KI(e[0].shape,l):new $I(e[0].shape,l);return this.compileAndRun(c,e,u)},t.prototype.subtract=function(e,r){if(e.dtype==="complex64"&&r.dtype==="complex64")return this.complexSeparableBinaryOp(e,r,uv);if(this.shouldExecuteOnCPU([e,r]))return this.cpuBackend.subtract(e,r);var a=cn(e.dtype,r.dtype);if(ue().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,r,uv,e.dtype);var i=new Tt(uv,e.shape,r.shape);return this.compileAndRun(i,[e,r],a)},t.prototype.pow=function(e,r){var a=ue().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new xa(`
  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.
  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));
  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);
  vec4 result = multiplier * pow(abs(a), b);

  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS
  bvec4 isExpZero = equal(b, vec4(0.0));
  result.r = isExpZero.r ? 1.0 : result.r;
  result.g = isExpZero.g ? 1.0 : result.g;
  result.b = isExpZero.b ? 1.0 : result.b;
  result.a = isExpZero.a ? 1.0 : result.a;

  vec4 isNaN = vec4(lessThan(a, vec4(0.0))) * vec4(lessThan(floor(b), b));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,e.shape,r.shape):new Tt(`
if(a < 0.0 && floor(b) < b){
  return NAN;
}
if (b == 0.0) {
  return 1.0;
}
return (round(mod(b, 2.0)) != 1) ?
    pow(abs(a), b) : sign(a) * pow(abs(a), b);
`,e.shape,r.shape),i=cn(e.dtype,r.dtype);return this.compileAndRun(a,[e,r],i)},t.prototype.ceil=function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.ceil(e);if(ue().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,Bw,e.dtype);var r=new Ue(e.shape,Bw);return this.compileAndRun(r,[e])},t.prototype.floor=function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.floor(e);if(ue().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,Pw,e.dtype);var r=new Ue(e.shape,Pw);return this.compileAndRun(r,[e])},t.prototype.sign=function(e){var r=new Ue(e.shape,`
  if (isnan(x)) { return 0.0; }
  return sign(x);
`);return this.compileAndRun(r,[e])},t.prototype.isNaN=function(e){var r=new Ue(e.shape,"return float(isnan(x));");return this.compileAndRun(r,[e],"bool")},t.prototype.isInf=function(e){var r=new Ue(e.shape,"return float(isinf(x));");return this.compileAndRun(r,[e],"bool")},t.prototype.isFinite=function(e){var r=new Ue(e.shape,"return float(!isnan(x) && !isinf(x));");return this.compileAndRun(r,[e],"bool")},t.prototype.round=function(e){var r=new Ue(e.shape,`
  // OpenGL ES does not support round function.
  // The algorithm is based on banker's rounding.
  float base = floor(x);
  if ((x - base) < 0.5) {
    return floor(x);
  } else if ((x - base) > 0.5) {
    return ceil(x);
  } else {
    if (mod(base, 2.0) == 0.0) {
      return base;
    } else {
      return base + 1.0;
    }
  }
`);return this.compileAndRun(r,[e])},t.prototype.exp=function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.exp(e);if(ue().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,Lw,e.dtype);var r=new Ue(e.shape,Lw);return this.compileAndRun(r,[e])},t.prototype.expm1=function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.expm1(e);if(ue().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,zw,e.dtype);var r=new Ue(e.shape,zw);return this.compileAndRun(r,[e])},t.prototype.softmax=function(e,r){var a=Kt([r],e.shape),i=this.max(e,a),u=Bn(i.shape,a),l=this.subtract(e,i.reshape(u)),c=this.exp(l),f=this.sum(c,a).reshape(u);return this.realDivide(c,f)},t.prototype.log=function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.log(e);if(ue().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,`
  vec4 result = log(x);
  vec4 isNaN = vec4(lessThan(x, vec4(0.0)));
  result.r = isNaN.r == 1.0 ? NAN : result.r;
  result.g = isNaN.g == 1.0 ? NAN : result.g;
  result.b = isNaN.b == 1.0 ? NAN : result.b;
  result.a = isNaN.a == 1.0 ? NAN : result.a;

  return result;
`,e.dtype);var r=new Ue(e.shape,`if (x < 0.0) return NAN;
  return log(x);`);return this.compileAndRun(r,[e])},t.prototype.log1p=function(e){var r=new Ue(e.shape,"return log(1.0 + x);");return this.compileAndRun(r,[e])},t.prototype.sqrt=function(e){var r=new Ue(e.shape,"return sqrt(x);");return this.compileAndRun(r,[e])},t.prototype.rsqrt=function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.rsqrt(e);var r=new Ue(e.shape,"return inversesqrt(x);");return this.compileAndRun(r,[e])},t.prototype.reciprocal=function(e){var r=new Ue(e.shape,"return 1.0 / x;");return this.compileAndRun(r,[e])},t.prototype.relu=function(e){var r;return r=ue().getBool("WEBGL_PACK")?new Iu(e.shape,AE):new Ue(e.shape,_E),this.compileAndRun(r,[e])},t.prototype.relu6=function(e){var r;return r=ue().getBool("WEBGL_PACK")?new Iu(e.shape,TE):new Ue(e.shape,CE),this.compileAndRun(r,[e])},t.prototype.prelu=function(e,r){var a=ue().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new xa(EE,e.shape,r.shape):new Tt(SE,e.shape,r.shape);return this.compileAndRun(a,[e,r])},t.prototype.elu=function(e){if(ue().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,DE,e.dtype);var r=new Ue(e.shape,RE);return this.compileAndRun(r,[e])},t.prototype.eluDer=function(e,r){var a=ue().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new xa(`
  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));
  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));
`,e.shape,r.shape):new Tt("return (b >= 1.0) ? a : a * (b + 1.0);",e.shape,r.shape);return this.compileAndRun(a,[e,r])},t.prototype.selu=function(e){var r=new Ue(e.shape,TB);return this.compileAndRun(r,[e])},t.prototype.int=function(e){var r=new Ue(e.shape,"return float(int(x));");return this.compileAndRun(r,[e],"int32")},t.prototype.clip=function(e,r,a){var i,u=(i=ue().getBool("WEBGL_PACK_CLIP")?new lF(e.shape):new uF(e.shape)).getCustomSetupFunc(r,a);return this.compileAndRun(i,[e],null,u)},t.prototype.abs=function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.abs(e);if(ue().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,Iw,e.dtype);var r=new Ue(e.shape,Iw);return this.compileAndRun(r,[e])},t.prototype.complexAbs=function(e){var r=this.texData.get(e.dataId),a=new cF(e.shape),i=[this.makeComplexComponentTensorInfo(e,r.complexTensors.real),this.makeComplexComponentTensorInfo(e,r.complexTensors.imag)];return this.compileAndRun(a,i)},t.prototype.sigmoid=function(e){var r=new Ue(e.shape,"return 1.0 / (1.0 + exp(-1.0 * x));");return this.compileAndRun(r,[e])},t.prototype.softplus=function(e){var r=new Ue(e.shape,`
  float epsilon = 1.1920928955078125e-7;
  float threshold = log(epsilon) + 2.0;

  bool too_large = x > -threshold;
  bool too_small = x < threshold;

  float result;
  float exp_x = exp(x);

  if (too_large){
    result = x;
  }
  else if (too_small){
    result = exp_x;
  }
  else{
    result = log(exp_x + 1.0);
  }
  return result;
`);return this.compileAndRun(r,[e])},t.prototype.sin=function(e){var r=new Ue(e.shape,DB);return this.compileAndRun(r,[e])},t.prototype.cos=function(e){var r=new Ue(e.shape,OB);return this.compileAndRun(r,[e])},t.prototype.tan=function(e){var r=new Ue(e.shape,"return tan(x);");return this.compileAndRun(r,[e])},t.prototype.asin=function(e){var r=new Ue(e.shape,kB);return this.compileAndRun(r,[e])},t.prototype.acos=function(e){var r=new Ue(e.shape,NB);return this.compileAndRun(r,[e])},t.prototype.atan=function(e){var r=new Ue(e.shape,MB);return this.compileAndRun(r,[e])},t.prototype.atan2=function(e,r){var a=ue().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new xa(`
  vec4 result = atan(a, b);
  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,e.shape,r.shape):new Tt(`
  if (isnan(a)) return a;
  if (isnan(b)) return b;

  return atan(a, b);
`,e.shape,r.shape);return this.compileAndRun(a,[e,r])},t.prototype.sinh=function(e){var r=new Ue(e.shape,`
  float e2x = exp(x);
  return (e2x - 1.0 / e2x) / 2.0;
`);return this.compileAndRun(r,[e])},t.prototype.cosh=function(e){var r=new Ue(e.shape,`
  float e2x = exp(-x);
  return (e2x + 1.0 / e2x) / 2.0;
`);return this.compileAndRun(r,[e])},t.prototype.tanh=function(e){var r=new Ue(e.shape,`
  float e2x = exp(-2.0 * abs(x));
  return sign(x) * (1.0 - e2x) / (1.0 + e2x);
`);return this.compileAndRun(r,[e])},t.prototype.asinh=function(e){var r=new Ue(e.shape,IB);return this.compileAndRun(r,[e])},t.prototype.acosh=function(e){var r=new Ue(e.shape,FB);return this.compileAndRun(r,[e])},t.prototype.atanh=function(e){var r=new Ue(e.shape,BB);return this.compileAndRun(r,[e])},t.prototype.erf=function(e){var r=new Ue(e.shape,`
  // Error function is calculated approximately with elementary function.
  // See "Handbook of Mathematical Functions with Formulas,
  // Graphs, and Mathematical Tables", Abramowitz and Stegun.
  float p = 0.3275911;
  float a1 = 0.254829592;
  float a2 = -0.284496736;
  float a3 = 1.421413741;
  float a4 = -1.453152027;
  float a5 = 1.061405429;

  float sign = sign(x);
  x = abs(x);
  float t = 1.0 / (1.0 + p * x);
  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));
`);return this.compileAndRun(r,[e])},t.prototype.step=function(e,r){var a=new Ue(e.shape,function(i){return i===void 0&&(i=0),Or+`
    return x > 0.0 ? 1.0 : float(`+i+`);
  `}(r));return this.compileAndRun(a,[e])},t.prototype.conv2dByMatMul=function(e,r,a,i,u,l){var c=e.shape,f=this.texData.get(e.dataId),d=a.inChannels,v=c[0]*c[1]*c[2],m=a.outChannels,g=a.dataFormat==="channelsLast",b=(v===1||m===1)&&d>1e3,w=c[2]%2!=0&&!!f.isPacked;if(b||!ue().getBool("WEBGL_LAZILY_UNPACK")||!ue().getBool("WEBGL_PACK_BINARY_OPERATIONS")||!w){var S=g?c[0]*c[1]*c[2]:c[0]*c[2]*c[3],E=this.reshape(e,[1,S,a.inChannels]),_=this.reshape(r,[1,a.inChannels,a.outChannels]);return this.reshape(this.fusedBatchMatMul({a:E,b:_,transposeA:!1,transposeB:!1,bias:i,activation:u,preluActivationWeights:l}),a.outShape)}var R=g?c[0]*c[1]*(c[2]+1):c[0]*c[2]*(c[3]+1),C={dataId:e.dataId,shape:[1,R,a.inChannels],dtype:e.dtype},A=f.shape;f.shape=f.shape.slice(),f.shape[f.shape.length-2]++,P(Wc(f.shape,C.shape),function(){return"packed reshape "+f.shape+" to "+C.shape+" isn't free"});var D=this.reshape(r,[1,a.inChannels,a.outChannels]),O=this.fusedBatchMatMul({a:C,b:D,transposeA:!1,transposeB:!1,bias:i,activation:u,preluActivationWeights:l}),F=this.texData.get(O.dataId);return P(F.isPacked,function(){return"batchMatMul result is expected to be packed"}),f.shape=A,F.shape=a.outShape,q.makeTensorFromDataId(O.dataId,a.outShape,O.dtype)},t.prototype.conv2dWithIm2Row=function(e,r,a,i,u,l){var c=a.filterWidth,f=a.filterHeight,d=a.inChannels,v=a.outWidth,m=a.outHeight,g=a.dataFormat==="channelsLast",b=c*f*d,w=m*v,S=[b,w],E=e.squeeze([0]),_=r.reshape([1,b,-1]),R=new QF(S,E.shape,a),C=this.compileAndRun(R,[E]).reshape([1,S[0],S[1]]),A=i!=null,D=l!=null,O=u?$c(u,!0):null,F=new lv(C.shape,[1,w,a.outChannels],!0,!1,A,O,D),N=[C,_];i&&N.push(i),D&&N.push(l);var B=this.compileAndRun(F,N);return g?B.reshape([1,m,v,a.outChannels]):B.reshape([1,a.outChannels,m,v])},t.prototype.fusedConv2d=function(e){var r=e.input,a=e.filter,i=e.convInfo,u=e.bias,l=e.activation,c=e.preluActivationWeights;if(i.filterHeight===1&&i.filterWidth===1&&i.dilationHeight===1&&i.dilationWidth===1&&i.strideHeight===1&&i.strideWidth===1&&(i.padInfo.type==="SAME"||i.padInfo.type==="VALID"))return this.conv2dByMatMul(r,a,i,u,l,c);if(ue().getBool("WEBGL_CONV_IM2COL")&&r.shape[0]===1)return this.conv2dWithIm2Row(r,a,i,u,l,c);var f=u!=null,d=c!=null,v=l?$c(l,!1):null,m=new Cw(i,f,v,d),g=[r,a];return u&&g.push(u),c&&g.push(c),this.compileAndRun(m,g)},t.prototype.conv2d=function(e,r,a){if(a.filterHeight===1&&a.filterWidth===1&&a.dilationHeight===1&&a.dilationWidth===1&&a.strideHeight===1&&a.strideWidth===1&&(a.padInfo.type==="SAME"||a.padInfo.type==="VALID"))return this.conv2dByMatMul(e,r,a);if(ue().getBool("WEBGL_CONV_IM2COL")&&e.shape[0]===1)return this.conv2dWithIm2Row(e,r,a);var i=new Cw(a);return this.compileAndRun(i,[e,r])},t.prototype.conv2dDerInput=function(e,r,a){var i=new pF(a);return this.compileAndRun(i,[e,r])},t.prototype.conv2dDerFilter=function(e,r,a){var i=new dF(a);return this.compileAndRun(i,[e,r])},t.prototype.fusedDepthwiseConv2D=function(e){var r,a=e.input,i=e.filter,u=e.convInfo,l=e.bias,c=e.activation,f=e.preluActivationWeights,d=ue().getBool("WEBGL_PACK_DEPTHWISECONV")&&u.strideWidth<=2&&u.outChannels/u.inChannels==1,v=c?$c(c,d):null,m=[a,i],g=l!=null,b=f!=null;return g&&m.push(l),b&&m.push(f),d?(r=new Aw(u,g,v,b),this.compileAndRun(r,m)):(r=new Rw(u,g,v,b),this.compileAndRun(r,m))},t.prototype.depthwiseConv2D=function(e,r,a){var i;return ue().getBool("WEBGL_PACK_DEPTHWISECONV")&&a.strideWidth<=2&&a.outChannels/a.inChannels==1?(i=new Aw(a),this.compileAndRun(i,[e,r])):(i=new Rw(a),this.compileAndRun(i,[e,r]))},t.prototype.depthwiseConv2DDerInput=function(e,r,a){var i=new yF(a);return this.compileAndRun(i,[e,r])},t.prototype.depthwiseConv2DDerFilter=function(e,r,a){var i=new gF(a);return this.compileAndRun(i,[e,r])},t.prototype.conv3d=function(e,r,a){var i=new bF(a);return this.compileAndRun(i,[e,r])},t.prototype.conv3dDerInput=function(e,r,a){var i=new mF(a);return this.compileAndRun(i,[e,r])},t.prototype.conv3dDerFilter=function(e,r,a){var i=new vF(a);return this.compileAndRun(i,[e,r])},t.prototype.maxPool=function(e,r){var a=new cv(r,"max",!1);return this.compileAndRun(a,[e])},t.prototype.avgPool=function(e,r){var a=new cv(r,"avg",!1);return this.compileAndRun(a,[e],"float32")},t.prototype.maxPoolBackprop=function(e,r,a,i){var u=new cv(i,"max",!0),l=this.compileAndRun(u,[r]),c=new nB(i),f=this.compileAndRun(c,[e,l],r.dtype);return l.dispose(),f},t.prototype.avgPoolBackprop=function(e,r,a){var i=new nF(a);return this.compileAndRun(i,[e],r.dtype)},t.prototype.cast=function(e,r){return dE(e,r,this)},t.prototype.unstack=function(e,r){for(var a=e.shape[r],i=new Array(e.rank-1),u=0,l=0;l<e.rank;l++)l!==r&&(i[u++]=e.shape[l]);var c=new Array(e.rank).fill(0),f=e.shape.slice();f[r]=1;var d=new Array(a);for(l=0;l<d.length;l++)c[r]=l,d[l]=this.slice(e,c,f).reshape(i);return d},t.prototype.avgPool3d=function(e,r){var a=new fv(r,"avg",!1);return this.compileAndRun(a,[e],"float32")},t.prototype.avgPool3dBackprop=function(e,r,a){var i=new rF(a);return this.compileAndRun(i,[e],r.dtype)},t.prototype.maxPool3d=function(e,r){var a=new fv(r,"max",!1);return this.compileAndRun(a,[e],"float32")},t.prototype.maxPool3dBackprop=function(e,r,a,i){var u=new fv(i,"max",!0),l=this.compileAndRun(u,[r]),c=new rB(i),f=this.compileAndRun(c,[e,l],r.dtype);return l.dispose(),f},t.prototype.reshape=function(e,r){var a=this.texData.get(e.dataId);if(a.isPacked&&!Wc(e.shape,r)&&(a.texture===null||!Wc(a.shape,r))){var i=this.packedReshape(e,r);return q.makeTensorFromDataId(i.dataId,i.shape,i.dtype)}return lm(e,r)},t.prototype.resizeBilinear=function(e,r,a,i){var u=ue().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new dB(e.shape,r,a,i):new hB(e.shape,r,a,i);return this.compileAndRun(u,[e],"float32")},t.prototype.resizeBilinearBackprop=function(e,r,a){var i=new fB(e,r,a);return this.compileAndRun(i,[e])},t.prototype.resizeNearestNeighbor=function(e,r,a,i){var u=new vB(e.shape,r,a,i);return this.compileAndRun(u,[e])},t.prototype.resizeNearestNeighborBackprop=function(e,r,a){var i=new pB(e,r,a);return this.compileAndRun(i,[e])},t.prototype.multinomial=function(e,r,a,i){var u=r?e:Ta(e),l=u.shape[0],c=u.shape[1],f=new aB(l,c,a),d=f.getCustomSetupFunc(i);return this.compileAndRun(f,[u],"int32",d)},t.prototype.oneHot=function(e,r,a,i){var u=new iB(e.size,r,a,i);return this.compileAndRun(u,[e])},t.prototype.diag=function(e){var r=new CF(e.size);return this.compileAndRun(r,[e])},t.prototype.nonMaxSuppression=function(e,r,a,i,u){return Af("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead"),Qm(e.dataSync(),r.dataSync(),a,i,u)},t.prototype.cropAndResize=function(e,r,a,i,u,l){var c=new xF(e.shape,r.shape,i,u,l);return this.compileAndRun(c,[e,r,a],"float32")},t.prototype.depthToSpace=function(e,r,a){P(r>1,function(){return"blockSize should be > 1 for depthToSpace, but was: "+r});var i=e.shape[0],u=a==="NHWC"?e.shape[1]:e.shape[2],l=a==="NHWC"?e.shape[2]:e.shape[3],c=a==="NHWC"?e.shape[3]:e.shape[1],f=u*r,d=l*r,v=c/(r*r),m=new _F(a==="NHWC"?[i,f,d,v]:[i,v,f,d],r,a);return this.compileAndRun(m,[e])},t.prototype.split=function(e,r,a){return mE(e,r,a)},t.prototype.scatterND=function(e,r,a){var i=Mf(0,e,a),u=i.sliceRank,l=i.numUpdates,c=i.sliceSize,f=i.strides,d=i.outputSize,v=[d/c,c],m=e.reshape([l,u]),g=r.reshape([l,c]);if(d===0)return lm(fn([]),a);var b=ge(0),w=new kw(l,u,m.rank,g.rank,f,v);return this.compileAndRun(w,[g,m,b]).reshape(a)},t.prototype.sparseToDense=function(e,r,a,i){var u=Mf(0,e,a),l=u.sliceRank,c=u.numUpdates,f=u.strides,d=u.outputSize,v=new kw(c,l,e.rank,r.rank,f,[d,1]);return this.compileAndRun(v,[r,e,i]).reshape(a)},t.prototype.fft=function(e){return this.fftImpl(e,!1)},t.prototype.ifft=function(e){return this.fftImpl(e,!0)},t.prototype.fftImpl=function(e,r){var a=this.texData.get(e.dataId),i=new Dw(OF,e.shape,r),u=new Dw(kF,e.shape,r),l=[this.makeComplexComponentTensorInfo(e,a.complexTensors.real),this.makeComplexComponentTensorInfo(e,a.complexTensors.imag)],c=this.compileAndRun(i,l),f=this.compileAndRun(u,l),d=this.complex(c,f).as2D(e.shape[0],e.shape[1]);return c.dispose(),f.dispose(),d},t.prototype.gatherND=function(e,r){var a=r.shape,i=a[a.length-1],u=oE(e,r),l=u[0],c=u[1],f=u[2],d=u[3],v=r.reshape([c,i]),m=e.reshape([e.size/f,f]),g=new IF(i,d,[c,f]);return this.compileAndRun(g,[m,v]).reshape(l)},t.prototype.fill=function(e,r,a){if((a=a||ul(r))==="string"){var i=Ef(a,Ee(e));return i.fill(r),q.makeTensor(i,e,a,this)}var u=new NF(e,r),l=u.getCustomSetupFunc(r);return this.compileAndRun(u,[],a,l)},t.prototype.onesLike=function(e){if(e.dtype==="string")throw new Error("onesLike is not supported under string dtype");return this.fill(e.shape,1,e.dtype)},t.prototype.zerosLike=function(e){return this.fill(e.shape,e.dtype==="string"?"":0,e.dtype)},t.prototype.linspace=function(e,r,a){return pE(e,r,a)},t.prototype.makeTensorInfo=function(e,r){var a=this.write(null,e,r);return this.texData.get(a).usage=null,{dataId:a,shape:e,dtype:r}},t.prototype.makeOutput=function(e,r){var a=this.makeTensorInfo(e,r).dataId;return q.makeTensorFromDataId(a,e,r,this)},t.prototype.unpackTensor=function(e){var r=new LB(e.shape);return this.runWebGLProgram(r,[e],e.dtype)},t.prototype.packTensor=function(e){var r=new oB(e.shape);return this.runWebGLProgram(r,[e],e.dtype,null,!0)},t.prototype.packedReshape=function(e,r){var a=[Cf(e.shape)].concat(Rf(e.shape)),i={dtype:e.dtype,shape:a,dataId:e.dataId},u=[Cf(r)].concat(Rf(r)),l=new cB(u,a),c=this.runWebGLProgram(l,[i],e.dtype,null,!0);return{dataId:c.dataId,shape:r,dtype:c.dtype}},t.prototype.decode=function(e){var r,a=this.texData.get(e),i=a.isPacked,u=a.shape,l=a.dtype,c=iv(u);return r=i?new EF(c):new SF(c),{dtype:l,shape:u,dataId:this.runWebGLProgram(r,[{shape:c,dtype:l,dataId:e}],l,null,!0).dataId}},t.prototype.runWebGLProgram=function(e,r,a,i,u){var l=this;u===void 0&&(u=!1);var c=this.makeTensorInfo(e.outputShape,a),f=this.texData.get(c.dataId);if(e.packedOutput&&(f.isPacked=!0),e.outPackingScheme===Zu.DENSE){var d=zu(e.outputShape);f.texShape=d.map(function(R){return 2*R})}if(e.outTexUsage!=null&&(f.usage=e.outTexUsage),Ee(c.shape)===0)return f.values=Ku(c.dtype,0),c;var v=[],m=r.map(function(R){if(R.dtype==="complex64")throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");var C=l.texData.get(R.dataId);if(C.texture==null){if(!e.packedInputs&&Ee(R.shape)<=ue().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:R.shape,texData:null,isUniform:!0,uniformValues:C.values};e.packedInputs&&(C.isPacked=!0,C.shape=R.shape)}else if(!!C.isPacked!=!!e.packedInputs)R=C.isPacked?l.unpackTensor(R):l.packTensor(R),v.push(R),C=l.texData.get(R.dataId);else if(C.isPacked&&!Wc(C.shape,R.shape)){var A=R,D=R.shape;R.shape=C.shape,R=l.packedReshape(R,D),v.push(R),C=l.texData.get(R.dataId),A.shape=D}return l.uploadToGPU(R.dataId),{shape:R.shape,texData:C,isUniform:!1}});this.uploadToGPU(c.dataId);var g,b={shape:c.shape,texData:f,isUniform:!1},w=function(R,C,A){var D="";C.concat(A).forEach(function(N){var B=N.texData!=null&&N.texData.slice!=null&&N.texData.slice.flatOffset>0,H=N.isUniform?"uniform":N.texData.texShape;D+=N.shape+"_"+H+"_"+B});var O=R.userCode,F=R.constructor.name;return F+="_"+D+"_"+O}(e,m,b),S=this.getAndSaveBinary(w,function(){return function(R,C,A,D){var O=C.userCode,F=A.map(function($,ne){var M={logicalShape:$.shape,texShape:$.isUniform?null:$.texData.texShape,isUniform:$.isUniform,isPacked:!$.isUniform&&$.texData.isPacked,flatOffset:null};return $.texData!=null&&$.texData.slice!=null&&$.texData.slice.flatOffset>0&&(M.flatOffset=$.texData.slice.flatOffset),{name:C.variableNames[ne],shapeInfo:M}}),N=F.map(function($){return $.shapeInfo}),B={logicalShape:D.shape,texShape:D.texData.texShape,isUniform:!1,isPacked:D.texData.isPacked,flatOffset:null},H=ZI(F,B,O,C.packedInputs),U=R.createProgram(H),J=null,ee=R.getUniformLocation(U,"NAN",!1);ue().getNumber("WEBGL_VERSION")===1&&(J=R.getUniformLocation(U,"INFINITY",!1));for(var te={},L=0;L<C.variableNames.length;L++){var W=C.variableNames[L];te[W]=R.getUniformLocation(U,W,!1),te["offset"+W]=R.getUniformLocation(U,"offset"+W,!1)}return{program:C,source:H,webGLProgram:U,uniformLocations:te,inShapeInfos:N,outShapeInfo:B,infLoc:J,nanLoc:ee}}(l.gpgpu,e,m,b)}),E=this.activeTimers!=null;if(E&&(g=this.startTimer()),function(R,C,A,D,O){Ow(C.inShapeInfos,A),Ow([C.outShapeInfo],[D]);var F=D.texData.texture,N=D.texData.texShape;D.texData.isPacked?R.setOutputPackedMatrixTexture(F,N[0],N[1]):R.setOutputMatrixTexture(F,N[0],N[1]),R.setProgram(C.webGLProgram),ue().getNumber("WEBGL_VERSION")===1&&C.infLoc!==null&&R.gl.uniform1f(C.infLoc,1/0),C.nanLoc!==null&&R.gl.uniform1f(C.nanLoc,NaN),A.forEach(function(B,H){var U=C.program.variableNames[H],J=C.uniformLocations[U],ee=C.uniformLocations["offset"+U];if(J!=null)if(B.isUniform)if(Ee(B.shape)<2)R.gl.uniform1f(J,B.uniformValues[0]);else{var te=B.uniformValues;te instanceof Float32Array||(te=new Float32Array(te)),R.gl.uniform1fv(J,te)}else B.texData.slice!=null&&ee!=null&&R.gl.uniform1i(ee,B.texData.slice.flatOffset),R.setInputMatrixTexture(B.texData.texture,J,H)}),O?.(R,C.webGLProgram),R.executeProgram()}(this.gpgpu,S,m,b,i),v.forEach(function(R){return l.disposeData(R.dataId)}),E&&(g=this.endTimer(g),this.activeTimers.push({name:e.constructor.name,query:this.getQueryTime(g)})),!ue().getBool("WEBGL_LAZILY_UNPACK")&&f.isPacked&&u===!1){var _=this.unpackTensor(c);return this.disposeData(c.dataId),_}return c},t.prototype.compileAndRun=function(e,r,a,i,u){u===void 0&&(u=!1),a=a||r[0].dtype;var l=this.runWebGLProgram(e,r,a,i,u);return q.makeTensorFromDataId(l.dataId,l.shape,l.dtype)},t.prototype.getAndSaveBinary=function(e,r){return e in this.binaryCache||(this.binaryCache[e]=r()),this.binaryCache[e]},t.prototype.getTextureManager=function(){return this.textureManager},t.prototype.dispose=function(){var e=this;this.disposed||(ue().getBool("IS_TEST")||Object.keys(this.binaryCache).forEach(function(r){e.gpgpu.deleteProgram(e.binaryCache[r].webGLProgram),delete e.binaryCache[r]}),this.textureManager.dispose(),this.canvas!=null&&typeof HTMLCanvasElement<"u"&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0)},t.prototype.floatPrecision=function(){var e=this;return this.floatPrecisionValue==null&&(this.floatPrecisionValue=be(function(){if(!ue().get("WEBGL_RENDER_FLOAT32_ENABLED")){var r=ue().getBool("DEBUG");ue().set("DEBUG",!1);var a=e.abs(ge(1e-8)).dataSync()[0];if(ue().set("DEBUG",r),a>0)return 32}return 16})),this.floatPrecisionValue},t.prototype.epsilon=function(){return this.floatPrecision()===32?1e-7:1e-4},t.prototype.uploadToGPU=function(e){var r,a=this.texData.get(e),i=a.shape,u=a.dtype,l=a.values,c=a.texture,f=a.usage,d=a.isPacked;if(c==null){var v,m=this.activeTimers!=null;m&&(v=Hr());var g=a.texShape;if(g==null&&(g=qM(i,d),a.texShape=g),l!=null){var b=iv(i),w=void 0,S=g[1],E=g[0],_=l instanceof Uint8Array;d?(S=(r=cl(g[0],g[1]))[0],E=r[1],w=new DF(b,[E,S],_)):w=new TF(b,[E,S],_);var R=this.makeTensorInfo([E,S],u);this.texData.get(R.dataId).usage=_?Xn.PIXELS:Xn.UPLOAD,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(R.dataId),S,E,l);var C=this.runWebGLProgram(w,[R],u,null,!0),A=this.texData.get(C.dataId);a.texture=A.texture,a.texShape=A.texShape,a.isPacked=A.isPacked,a.usage=A.usage,this.disposeData(R.dataId),this.texData.delete(C.dataId),a.values=null,m&&(this.uploadWaitMs+=Hr()-v)}else{var D=this.acquireTexture(g,f,u,d);a.texture=D}}},t.prototype.convertAndCacheOnCPU=function(e,r){var a=this.texData.get(e),i=a.dtype;return this.releaseGPUData(e),r!=null&&(a.values=function(u,l){if(l==="float32"||l==="complex64")return u;if(l==="int32"||l==="bool"){for(var c=l==="int32"?new Int32Array(u.length):new Uint8Array(u.length),f=0;f<c.length;++f)c[f]=Math.round(u[f]);return c}throw new Error("Unknown dtype "+l)}(r,i)),a.values},t.prototype.acquireTexture=function(e,r,a,i){if(this.numBytesInGPU+=this.computeBytes(e,a),!this.warnedAboutMemory&&this.numBytesInGPU>1024*this.numMBBeforeWarning*1024){var u=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn("High memory usage in GPU: "+u+" MB, most likely due to a memory leak")}return this.textureManager.acquireTexture(e,r,i)},t.prototype.computeBytes=function(e,r){return e[0]*e[1]*VS(r)},t}(fE);XS()&&q.registerBackend("webgl",function(){return new UB},2);var HB=V({square_:function(n){var t=I(n,"x","square"),e=[t];return q.runKernelFunc(function(r,a){return a([t]),r.square(t)},{x:t},null,"Square",{},e,[])}}),Qu="SquaredDifference",OE=V({squaredDifference_:function(n,t){var e,r=I(n,"a","squaredDifference"),a=I(t,"b","squaredDifference");e=_t(r,a),r=e[0],a=e[1],Xe(r.shape,a.shape);var i={a:r,b:a},u=[r,a];return q.runKernelFunc(function(l,c){var f=l.squaredDifference(r,a);return c([r,a]),f},i,function(l,c){var f=c[0],d=c[1],v=ge(2);return{a:function(){return l.mul(f.sub(d).mul(v))},b:function(){return l.mul(d.sub(f).mul(v))}}},Qu,{},u,[])}}),VB=V({abs_:function(n){var t=I(n,"x","abs");return t.dtype==="complex64"?q.runKernelFunc(function(e){return e.complexAbs(t)},{$x:t}):q.runKernelFunc(function(e,r){var a=e.abs(t);return r([t]),a},{x:t},function(e,r){var a=r[0];return{x:function(){return e.mul(a.toFloat().step(-1))}}},"Abs")}}),WB=V({acos_:function(n){var t=I(n,"x","acos");return q.runKernelFunc(function(e,r){var a=e.acos(t);return r([t]),a},{$x:t},function(e,r){var a=r[0];return{$x:function(){return e.divStrict(ge(1).sub(a.toFloat().square()).sqrt()).neg()}}})}}),GB=V({acosh_:function(n){var t=I(n,"x","acosh");return q.runKernelFunc(function(e,r){var a=e.acosh(t);return r([t]),a},{$x:t},function(e,r){var a=r[0];return{$x:function(){return e.divStrict(a.toFloat().square().sub(1).sqrt())}}})}}),jB=V({asin_:function(n){var t=I(n,"x","asin");return q.runKernelFunc(function(e,r){var a=e.asin(t);return r([t]),a},{$x:t},function(e,r){var a=r[0];return{$x:function(){return e.divStrict(ge(1).sub(a.toFloat().square()).sqrt())}}})}}),qB=V({asinh_:function(n){var t=I(n,"x","asinh");return q.runKernelFunc(function(e,r){var a=e.asinh(t);return r([t]),a},{$x:t},function(e,r){var a=r[0];return{$x:function(){return e.divStrict(ge(1).add(a.toFloat().square()).sqrt())}}})}}),$B=V({atan_:function(n){var t=I(n,"x","atan");return q.runKernelFunc(function(e,r){var a=e.atan(t);return r([t]),a},{$x:t},function(e,r){var a=r[0];return{$x:function(){return e.div(a.toFloat().square().add(1))}}})}}),KB=V({atanh_:function(n){var t=I(n,"x","atanh");return q.runKernelFunc(function(e,r){var a=e.atanh(t);return r([t]),a},{$x:t},function(e,r){var a=r[0];return{$x:function(){return e.div(ge(1).sub(a.toFloat().square()))}}})}}),XB=V({ceil_:function(n){var t=I(n,"x","ceil");return q.runKernelFunc(function(e){return e.ceil(t)},{$x:t},function(e){return{$x:function(){return Ye(e)}}})}}),ag=V({clipByValue_:function(n,t,e){var r=I(n,"x","clipByValue");P(t<=e,function(){return"Error in clip: min ("+t+") must be less than or equal to max ("+e+")."});var a=[r],i={min:t,max:e};return q.runKernelFunc(function(u,l){var c=u.clip(r,t,e);return l([r]),c},{x:r},function(u,l){var c=l[0];return{x:function(){return u.where(c.greaterEqual(t).logicalAnd(c.lessEqual(e)),Ye(u))}}},"ClipByValue",i,a)}}),ZB=V({cos_:function(n){var t=I(n,"x","cos"),e=[t];return q.runKernelFunc(function(r,a){var i=r.cos(t);return a([t]),i},{x:t},function(r,a){var i=a[0];return{x:function(){return i.toFloat().sin().neg().mul(r)}}},"Cos",{},e)}}),YB=V({cosh_:function(n){var t=I(n,"x","cosh");return q.runKernelFunc(function(e,r){var a=e.cosh(t);return r([t]),a},{$x:t},function(e,r){var a=r[0];return{$x:function(){return a.toFloat().sinh().mulStrict(e)}}})}}),QB=V({erf_:function(n){var t=I(n,"x","erf");return P(t.dtype==="int32"||t.dtype==="float32",function(){return"Input dtype must be `int32` or `float32`."}),t.dtype==="int32"&&(t=t.toFloat()),q.runKernelFunc(function(e,r){var a=e.erf(t);return r([t]),a},{$x:t},function(e,r){var a=r[0];return{$x:function(){return e.mul(a.square().neg().exp().mul(2/Math.sqrt(Math.PI)))}}})}}),fm=V({exp_:function(n){var t=I(n,"x","exp");return q.runKernelFunc(function(e,r){var a=e.exp(t);return r([a]),a},{x:t},function(e,r){return{x:function(){return e.mulStrict(r[0])}}},"Exp",{},[],[!0])}}),JB=V({expm1_:function(n){var t=I(n,"x","expm1");return q.runKernelFunc(function(e,r){var a=e.expm1(t);return r([t]),a},{$x:t},function(e,r){var a=r[0];return{$x:function(){return e.mul(a.exp())}}})}}),eP=V({floor_:function(n){var t=I(n,"x","floor");return q.runKernelFunc(function(e){return e.floor(t)},{$x:t},function(e){return{$x:function(){return Ye(e)}}})}}),tP=V({log_:function(n){var t=I(n,"x","log"),e=[t];return q.runKernelFunc(function(r,a){var i=r.log(t);return a([t]),i},{x:t},function(r,a){var i=a[0];return{x:function(){return r.div(i.toFloat())}}},"Log",{},e)}}),nP=V({log1p_:function(n){var t=I(n,"x","log1p");return q.runKernelFunc(function(e,r){var a=e.log1p(t);return r([t]),a},{$x:t},function(e,r){var a=r[0];return{$x:function(){return e.div(a.add(1))}}})}}),rP=V({logSigmoid_:function(n){var t=I(n,"x","logSigmoid");return q.runKernelFunc(function(e,r){var a=e.softplus(t.neg()).neg();return r([t]),a},{$x:t},function(e,r){var a=r[0];return{$x:function(){return e.mul(a.neg().sigmoid())}}})}}),Pf=V({neg_:function(n){var t=I(n,"x","neg"),e=[t];return q.runKernelFunc(function(r){return r.neg(t)},{x:t},function(r){return{x:function(){return r.neg()}}},"Neg",{},e)}}),aP=V({reciprocal_:function(n){var t=I(n,"x","reciprocal");return q.runKernelFunc(function(e,r){var a=e.reciprocal(t);return r([t]),a},{$x:t},function(e,r){var a=r[0];return{$x:function(){return e.div(a.square().neg())}}})}}),iP=V({round_:function(n){var t=I(n,"x","round");return q.runKernelFunc(function(e){return e.round(t)},{$x:t},function(e){return{$x:function(){return Ye(e)}}})}}),kE=V({rsqrt_:function(n){var t=I(n,"x","rsqrt"),e=[t];return q.runKernelFunc(function(r,a){var i=r.rsqrt(t);return a([t]),i},{x:t},function(r,a){var i=a[0];return{x:function(){return r.div(i.pow(1.5).mul(2)).neg()}}},"Rsqrt",{},e)}}),NE=V({sigmoid_:function(n){var t=I(n,"x","sigmoid");return q.runKernelFunc(function(e,r){var a=e.sigmoid(t);return r([a]),a},{x:t},function(e,r){var a=r[0];return{x:function(){return e.mul(a.mul(ge(1).sub(a)))}}},"Sigmoid")}}),oP=V({sign_:function(n){var t=I(n,"x","sign");return q.runKernelFunc(function(e){return e.sign(t)},{$x:t},function(e){return{$x:function(){return Ye(e)}}})}}),sP=V({isNaN_:function(n){var t=I(n,"x","isNaN");return q.runKernelFunc(function(e){return e.isNaN(t)},{$x:t},function(e){return{$x:function(){return Ye(e)}}})}}),uP=V({isInf_:function(n){var t=I(n,"x","isInf");return q.runKernelFunc(function(e){return e.isInf(t)},{$x:t},function(e){return{$x:function(){return Ye(e)}}})}}),lP=V({isFinite_:function(n){var t=I(n,"x","isFinite");return q.runKernelFunc(function(e){return e.isFinite(t)},{$x:t},function(e){return{$x:function(){return Ye(e)}}})}}),cP=V({sin_:function(n){var t=I(n,"x","sin"),e=[t];return q.runKernelFunc(function(r,a){var i=r.sin(t);return a([t]),i},{x:t},function(r,a){var i=a[0];return{x:function(){return i.toFloat().cos().mul(r)}}},"Sin",{},e)}}),fP=V({sinh_:function(n){var t=I(n,"x","sinh");return q.runKernelFunc(function(e,r){var a=e.sinh(t);return r([t]),a},{$x:t},function(e,r){var a=r[0];return{$x:function(){return a.toFloat().cosh().mulStrict(e)}}})}}),hP=V({softplus_:function(n){var t=I(n,"x","softplus");return q.runKernelFunc(function(e,r){var a=e.softplus(t);return r([t]),a},{$x:t},function(e,r){var a=r[0];return{$x:function(){return e.mul(a.sigmoid())}}})}}),dP=V({sqrt_:function(n){var t=I(n,"x","sqrt");return q.runKernelFunc(function(e,r){var a=e.sqrt(t);return r([t]),a},{$x:t},function(e,r){var a=r[0];return{$x:function(){return e.div(a.toFloat().sqrt().mul(2))}}})}}),pP=V({step_:function(n,t){t===void 0&&(t=0);var e=I(n,"x","step");return q.runKernelFunc(function(r){return r.step(e,t)},{$x:e},function(r){return{$x:function(){return Ye(r)}}})}}),vP=V({tan_:function(n){var t=I(n,"x","tan");return q.runKernelFunc(function(e,r){var a=e.tan(t);return r([t]),a},{$x:t},function(e,r){var a=r[0];return{$x:function(){return e.div(a.cos().square())}}})}}),mP=V({tanh_:function(n){var t=I(n,"x","tanh");return q.runKernelFunc(function(e,r){var a=e.tanh(t);return r([a]),a},{x:t},function(e,r){var a=r[0];return{x:function(){return ge(1).sub(a.square()).mulStrict(e)}}},"Tanh",{},null,[!0])}});function ME(n,t,e,r,a,i){var u,l,c=I(n,"x","batchNorm"),f=I(t,"mean","batchNorm"),d=I(e,"variance","batchNorm");return a!=null&&(u=I(a,"scale","batchNorm")),r!=null&&(l=I(r,"offset","batchNorm")),P(c.rank===2,function(){return"Error in batchNorm3D: x must be rank 3 but got rank "+c.rank+"."}),P(f.rank===2||f.rank===1,function(){return"Error in batchNorm2D: mean must be rank 2 or rank 1 but got rank "+f.rank+"."}),P(d.rank===2||d.rank===1,function(){return"Error in batchNorm2D: variance must be rank 2 or rank 1 but got rank "+d.rank+"."}),u!=null&&P(u.rank===2||u.rank===1,function(){return"Error in batchNorm2D: scale must be rank 2 or rank 1 but got rank "+u.rank+"."}),l!=null&&P(l.rank===2||l.rank===1,function(){return"Error in batchNorm2D: offset must be rank 2 or rank 1 but got rank "+l.rank+"."}),hl(c,f,d,l,u,i)}function IE(n,t,e,r,a,i){var u,l,c=I(n,"x","batchNorm"),f=I(t,"mean","batchNorm"),d=I(e,"variance","batchNorm");return a!=null&&(u=I(a,"scale","batchNorm")),r!=null&&(l=I(r,"offset","batchNorm")),P(c.rank===3,function(){return"Error in batchNorm3D: x must be rank 3 but got rank "+c.rank+"."}),P(f.rank===3||f.rank===1,function(){return"Error in batchNorm3D: mean must be rank 3 or rank 1 but got rank "+f.rank+"."}),P(d.rank===3||d.rank===1,function(){return"Error in batchNorm3D: variance must be rank 3 or rank 1 but got rank "+d.rank+"."}),u!=null&&P(u.rank===3||u.rank===1,function(){return"Error in batchNorm3D: scale must be rank 3 or rank 1 but got rank "+u.rank+"."}),l!=null&&P(l.rank===3||l.rank===1,function(){return"Error in batchNorm3D: offset must be rank 3 or rank 1 but got rank "+l.rank+"."}),hl(c,f,d,l,u,i)}function FE(n,t,e,r,a,i){var u,l,c=I(n,"x","batchNorm"),f=I(t,"mean","batchNorm"),d=I(e,"variance","batchNorm");return a!=null&&(u=I(a,"scale","batchNorm")),r!=null&&(l=I(r,"offset","batchNorm")),P(c.rank===4,function(){return"Error in batchNorm4D: x must be rank 4 but got rank "+c.rank+"."}),P(f.rank===4||f.rank===1,function(){return"Error in batchNorm4D: mean must be rank 4 or rank 1 but got rank "+f.rank+"."}),P(d.rank===4||d.rank===1,function(){return"Error in batchNorm4D: variance must be rank 4 or rank 1 but got rank "+d.rank+"."}),u!=null&&P(u.rank===4||u.rank===1,function(){return"Error in batchNorm4D: scale must be rank 4 or rank 1 but got rank "+u.rank+"."}),l!=null&&P(l.rank===4||l.rank===1,function(){return"Error in batchNorm4D: offset must be rank 4 or rank 1 but got rank "+l.rank+"."}),hl(c,f,d,l,u,i)}function hl(n,t,e,r,a,i){i==null&&(i=.001);var u,l,c,f=I(n,"x","batchNorm"),d=I(t,"mean","batchNorm"),v=I(e,"variance","batchNorm");a!=null&&(u=I(a,"scale","batchNorm")),r!=null&&(l=I(r,"offset","batchNorm")),P(d.rank===v.rank,function(){return"Batch normalization gradient requires mean and variance to have equal ranks."}),P(l==null||d.rank===l.rank,function(){return"Batch normalization gradient requires mean and offset to have equal ranks."}),P(u==null||d.rank===u.rank,function(){return"Batch normalization gradient requires mean and scale to have equal ranks."}),c=f.rank===0||f.rank===1?f.as4D(1,1,1,f.size):f.rank===2?f.as4D(1,1,f.shape[0],f.shape[1]):f.rank===3?f.as4D(1,f.shape[0],f.shape[1],f.shape[2]):f;var m=[f,d,v,u];return q.runKernelFunc(function(g,b){var w=g.batchNormalization(c,Kc(d),Kc(v),i,Kc(u),Kc(l));return b([f,d,v,u]),w},{x:f,mean:d,variance:v,scale:u,offset:l},function(g,b){var w=b,S=w[0],E=w[1],_=w[2],R=w[3],C=R??ge(1),A=qt(E.shape,c.shape),D=[];if(E.rank===1){for(var O=0;O<c.shape.length-1;++O)D.push(c.shape[O]);D.push(1)}var F=S.sub(E),N=g.mul(C),B=kE(_.add(ge(i))),H=B.mul(B).mul(B).mul(ge(-.5));return{x:function(){return E.rank===1?g.mul(ls(B.as4D(1,1,1,E.shape[0]),D)).mul(C).reshape(S.shape):g.mul(B).mul(C).reshape(S.shape)},mean:function(){var U=B.mul(ge(-1)).mul(N);return E.rank===1&&(U=U.sum(A)),U.reshape(E.shape)},variance:function(){var U=H.mul(F).mul(N);return E.rank===1&&(U=U.sum(A)),U.reshape(E.shape)},scale:function(){var U=F.mul(B),J=g.mul(U);return E.rank===1&&(J=J.sum(A)),J.reshape(E.shape)},offset:function(){var U=g;return E.rank===1&&(U=U.sum(A)),U.reshape(E.shape)}}},"BatchNormalization",{varianceEpsilon:i},m).reshape(f.shape)}function Kc(n){return n==null?null:n.rank===0?n.as1D():n.rank===1?n:n.rank===2?n.as4D(1,1,n.shape[0],n.shape[1]):n.rank===3?n.as4D(1,n.shape[0],n.shape[1],n.shape[2]):n}function ih(){ZS("tf.batchNormalization() is going away. Use tf.batchNorm() instead, and note the positional argument change of scale, offset, and varianceEpsilon")}var gP=V({batchNormalization2d_:function(n,t,e,r,a,i){return r===void 0&&(r=.001),ih(),ME(n,t,e,i,a,r)}}),yP=V({batchNormalization3d_:function(n,t,e,r,a,i){return r===void 0&&(r=.001),ih(),IE(n,t,e,i,a,r)}}),bP=V({batchNormalization4d_:function(n,t,e,r,a,i){return r===void 0&&(r=.001),ih(),FE(n,t,e,i,a,r)}}),xP=V({batchNormalization_:function(n,t,e,r,a,i){return r===void 0&&(r=.001),ih(),hl(n,t,e,i,a,r)}}),BE=V({batchNorm_:hl}),wP=V({batchNorm2d_:ME}),SP=V({batchNorm3d_:IE}),EP=V({batchNorm4d_:FE}),oh=V({logicalAnd_:function(n,t){var e=I(n,"a","logicalAnd","bool"),r=I(t,"b","logicalAnd","bool");return Xe(e.shape,r.shape),q.runKernelFunc(function(a){return a.logicalAnd(e,r)},{a:e,b:r},null,"LogicalAnd")}}),_P=V({logicalNot_:function(n){var t=I(n,"x","logicalNot","bool");return q.runKernelFunc(function(e){return e.logicalNot(t)},{$x:t})}}),PE=V({logicalOr_:function(n,t){var e=I(n,"a","logicalOr","bool"),r=I(t,"b","logicalOr","bool");return Xe(e.shape,r.shape),q.runKernelFunc(function(a){return a.logicalOr(e,r)},{$a:e,$b:r})}}),CP=V({logicalXor_:function(n,t){var e=I(n,"a","logicalXor","bool"),r=I(t,"b","logicalXor","bool");return Xe(e.shape,r.shape),PE(n,t).logicalAnd(oh(n,t).logicalNot())}}),no=V({where_:function(n,t,e){var r=I(t,"a","where"),a=I(e,"b","where"),i=I(n,"condition","where","bool");return at(r.shape,a.shape,"Error in where: "),i.rank===1?P(i.shape[0]===r.shape[0],function(){return"The first dimension of `a` must match the size of `condition`."}):at(i.shape,a.shape,"Error in where: "),q.runKernelFunc(function(u,l){var c=u.select(i,r,a);return l([i]),c},{$condition:i,$a:r,$b:a},function(u,l){var c=l[0];return{$condition:function(){return Ye(c).toFloat()},$a:function(){return u.mul(c.cast(u.dtype))},$b:function(){return u.mul(c.logicalNot().cast(u.dtype))}}})}}),LE=function(n){return we(this,void 0,void 0,function(){var t,e,r;return Se(this,function(a){switch(a.label){case 0:return[4,(t=I(n,"condition","whereAsync","bool")).data()];case 1:return e=a.sent(),r=eg(t.shape,e),n!==t&&t.dispose(),[2,r]}})})},qe=V({add_:function(n,t){var e,r=I(n,"a","add"),a=I(t,"b","add");e=_t(r,a),r=e[0],a=e[1];var i=Xe(r.shape,a.shape);return q.runKernelFunc(function(u){return u.add(r,a)},{a:r,b:a},function(u){return{a:function(){var l=u,c=qt(r.shape,i);return c.length>0&&(l=l.sum(c)),l.reshape(r.shape)},b:function(){var l=u,c=qt(a.shape,i);return c.length>0&&(l=l.sum(c)),l.reshape(a.shape)}}},"Add")}}),RP=V({addN_:function(n){P(Array.isArray(n),function(){return"The argument passed to tf.addN() must be a list of tensors"}),P(n.length>=1,function(){return"Must pass at least one tensor to tf.addN(), but got "+n.length});var t=n.map(function(a,i){return I(a,"tensors"+i,"addN")}),e=t[0];t.forEach(function(a){if(a.dtype!==e.dtype)throw new Error("All tensors passed to tf.addN() must have the same dtype")}),t.forEach(function(a){if(!nn(a.shape,e.shape))throw new Error("All tensors passed to tf.addN() must have the same shape")});var r=t;return q.runKernelFunc(function(a){return a.addN(t)},r,function(a){var i={};return t.forEach(function(u,l){i[l]=function(){return a.clone()}}),i},"AddN")}}),AP=V({addStrict_:function(n,t){var e=I(n,"a","addStrict"),r=I(t,"b","addStrict");return at(e.shape,r.shape,"Error in addStrict: "),e.add(r)}}),TP=V({atan2_:function(n,t){var e,r=I(n,"a","atan2"),a=I(t,"b","atan2");e=_t(r,a),r=e[0],a=e[1];var i=Xe(r.shape,a.shape);return q.runKernelFunc(function(u,l){var c=u.atan2(r,a);return l([r,a]),c},{$a:r,$b:a},function(u,l){var c=l[0],f=l[1];return{$a:function(){var d=qe(c.square(),f.square()),v=u.mul(f.div(d)),m=qt(c.shape,i);return m.length>0&&(v=v.sum(m)),v.reshape(c.shape)},$b:function(){var d=qe(c.square(),f.square()),v=Pf(u.mul(c.div(d))),m=qt(f.shape,i);return m.length>0&&(v=v.sum(m)),v.reshape(f.shape)}}})}}),_r=V({div_:function(n,t){var e,r=I(n,"a","div"),a=I(t,"b","div");if(e=_t(r,a),r=e[0],a=e[1],r.dtype==="int32"&&a.dtype==="int32")return zE(r,a);var i=Xe(r.shape,a.shape);return q.runKernelFunc(function(u,l){var c=u.realDivide(r,a);return l([r,a]),c},{a:r,b:a},function(u,l){var c=l[0],f=l[1];return{a:function(){var d=u.div(f.toFloat()),v=qt(c.shape,i);return v.length>0?d.sum(v).reshape(c.shape):d},b:function(){var d=u.mul(c.toFloat()),v=qt(f.shape,i);v.length>0&&(d=d.sum(v).reshape(f.shape));var m=f.square();return d.div(m.toFloat()).neg()}}},"Div")}}),DP=V({divNoNan_:function(n,t){var e,r=I(n,"a","div"),a=I(t,"b","div");r=(e=_t(r,a))[0],a=e[1];var i=_r(r,a),u=Ye(i),l=a.equal(u);return no(l,u,i)}}),OP=V({divStrict_:function(n,t){var e=I(n,"a","div"),r=I(t,"b","div");return at(e.shape,r.shape,"Error in divideStrict: "),e.div(r)}}),zE=V({floorDiv_:function(n,t){var e,r=I(n,"a","floorDiv"),a=I(t,"b","floorDiv");e=_t(r,a),r=e[0],a=e[1];var i=Xe(r.shape,a.shape);return q.runKernelFunc(function(u,l){var c=u.floorDiv(r,a);return l([r,a]),c},{a:r,b:a},function(u,l){var c=l[0],f=l[1];return{a:function(){var d=u.div(f.toFloat()),v=qt(c.shape,i);return v.length>0?d.sum(v).reshape(c.shape):d},b:function(){var d=u.mul(c.toFloat()),v=qt(f.shape,i);v.length>0&&(d=d.sum(v).reshape(f.shape));var m=f.square();return d.div(m.toFloat()).neg()}}},"FloorDiv")}}),ig=V({maximum_:function(n,t){var e,r=I(n,"a","maximum"),a=I(t,"b","maximum");return e=_t(r,a),r=e[0],a=e[1],r.dtype==="bool"&&(r=r.toInt(),a=a.toInt()),Xe(r.shape,a.shape),q.runKernelFunc(function(i,u){var l=i.maximum(r,a);return u([r,a]),l},{a:r,b:a},function(i,u){var l=u[0],c=u[1];return{a:function(){return i.mul(l.greaterEqual(c).toFloat())},b:function(){return i.mul(l.less(c).toFloat())}}},"Maximum")}}),kP=V({maximumStrict_:function(n,t){var e=I(n,"a","maximumStrict"),r=I(t,"b","maximumStrict");return at(e.shape,r.shape,"Error in maximumStrict: "),e.maximum(r)}}),UE=V({minimum_:function(n,t){var e,r=I(n,"a","minimum"),a=I(t,"b","minimum");return e=_t(r,a),r=e[0],a=e[1],r.dtype==="bool"&&(r=r.toInt(),a=a.toInt()),Xe(r.shape,a.shape),q.runKernelFunc(function(i,u){var l=i.minimum(r,a);return u([r,a]),l},{a:r,b:a},function(i,u){var l=u[0],c=u[1];return{a:function(){return i.mul(l.lessEqual(c).toFloat())},b:function(){return i.mul(l.greater(c).toFloat())}}},"Minimum")}}),NP=V({minimumStrict_:function(n,t){var e=I(n,"a","minimumStrict"),r=I(t,"b","minimumStrict");return at(e.shape,r.shape,"Error in minimumStrict: "),e.minimum(r)}}),MP=V({mod_:function(n,t){var e,r=I(n,"a","mod"),a=I(t,"b","mod");e=_t(r,a),r=e[0],a=e[1];var i=Xe(r.shape,a.shape);return q.runKernelFunc(function(u,l){var c=u.mod(r,a);return l([r,a]),c},{$a:r,$b:a},function(u,l){var c=l[0],f=l[1];return{$a:function(){var d=qt(c.shape,i);return d.length>0?u.sum(d).reshape(c.shape):u},$b:function(){var d=u.mul(c.div(f).floor().neg()),v=qt(f.shape,i);return v.length>0?d.sum(v).reshape(f.shape):d}}})}}),IP=V({modStrict_:function(n,t){var e=I(n,"a","modStrict"),r=I(t,"b","modStrict");return at(e.shape,r.shape,"Error in modStrict: "),e.mod(r)}}),wn=V({mul_:function(n,t){var e,r=I(n,"a","mul"),a=I(t,"b","mul");e=_t(r,a),r=e[0],a=e[1];var i=Xe(r.shape,a.shape);return q.runKernelFunc(function(u,l){var c=u.multiply(r,a);return l([r,a]),c},{a:r,b:a},function(u,l){var c=l[0],f=l[1];return{a:function(){var d=u.mul(f.toFloat()),v=qt(c.shape,i);return v.length>0?d.sum(v).reshape(c.shape):d},b:function(){var d=u.mul(c.toFloat()),v=qt(f.shape,i);return v.length>0?d.sum(v).reshape(f.shape):d}}},"Mul")}}),FP=V({mulStrict_:function(n,t){var e=I(n,"a","mul"),r=I(t,"b","mul");return at(e.shape,r.shape,"Error in multiplyStrict: "),e.mul(r)}}),Lf=V({pow_:function(n,t){var e,r=I(n,"base","pow"),a=I(t,"exp","pow");e=_t(r,a),r=e[0],a=e[1];var i=Xe(r.shape,a.shape),u=[r,a];return q.runKernelFunc(function(l,c){var f=l.pow(r,a);return c([r,a,f]),f},{a:r,b:a},function(l,c){var f=c[0],d=c[1],v=c[2];return{a:function(){var m=d.toFloat(),g=l.mul(m.mul(f.pow(m.sub(ge(1))))),b=qt(f.shape,i);return b.length>0&&(g=g.sum(b)),g.reshape(f.shape)},b:function(){var m=f.greater(0),g=f.log().where(m,Ye(f)),b=l.mul(v.mul(g)),w=qt(d.shape,i);return w.length>0&&(b=b.sum(w)),b.reshape(d.shape)}}},"Pow",{},u,[!0])}}),BP=V({powStrict_:function(n,t){return at(n.shape,t.shape,"Error in powStrict: "),n.pow(t)}}),PP=V({squaredDifferenceStrict_:function(n,t){var e=I(n,"a","squaredDifferenceStrict"),r=I(t,"b","squaredDifferenceStrict");return at(e.shape,r.shape,"Error in squaredDifferenceStrict: "),e.squaredDifference(r)}}),$t=V({sub_:function(n,t){var e,r=I(n,"a","sub"),a=I(t,"b","sub");e=_t(r,a),r=e[0],a=e[1];var i=Xe(r.shape,a.shape);return q.runKernelFunc(function(u){return u.subtract(r,a)},{a:r,b:a},function(u){return{a:function(){var l=u,c=qt(r.shape,i);return c.length>0&&(l=l.sum(c)),l.reshape(r.shape)},b:function(){var l=u,c=qt(a.shape,i);return c.length>0&&(l=l.sum(c)),l.neg().reshape(a.shape)}}},"Sub")}}),LP=V({subStrict_:function(n,t){var e=I(n,"a","subStrict"),r=I(t,"b","subStrict");return at(e.shape,r.shape,"Error in subStrict: "),e.sub(r)}}),HE=V({equal_:function(n,t){var e,r=I(n,"a","equal"),a=I(t,"b","equal");return e=_t(r,a),r=e[0],a=e[1],Xe(r.shape,a.shape),q.runKernelFunc(function(i){return i.equal(r,a)},{$a:r,$b:a})}}),zP=V({equalStrict_:function(n,t){var e=I(n,"a","equalStrict"),r=I(t,"b","equalStrict");return at(e.shape,r.shape,"Error in equalStrict: "),e.equal(r)}}),UP=V({greater_:function(n,t){var e,r=I(n,"a","greater"),a=I(t,"b","greater");return e=_t(r,a),r=e[0],a=e[1],Xe(r.shape,a.shape),q.runKernelFunc(function(i){return i.greater(r,a)},{a:r,b:a},null,"Greater")}}),VE=V({greaterEqual_:function(n,t){var e,r=I(n,"a","greaterEqual"),a=I(t,"b","greaterEqual");return e=_t(r,a),r=e[0],a=e[1],Xe(r.shape,a.shape),q.runKernelFunc(function(i,u){var l=i.greaterEqual(r,a);return u([r,a]),l},{a:r,b:a},function(i,u){var l=u[0],c=u[1];return{a:function(){return Ye(l)},b:function(){return Ye(c)}}},"GreaterEqual")}}),HP=V({greaterEqualStrict_:function(n,t){var e=I(n,"a","greaterEqualStrict"),r=I(t,"b","greaterEqualStrict");return at(e.shape,r.shape,"Error in greaterEqualStrict: "),e.greaterEqual(r)}}),VP=V({greaterStrict_:function(n,t){var e=I(n,"a","greaterStrict"),r=I(t,"b","greaterStrict");return at(e.shape,r.shape,"Error in greaterStrict: "),e.greater(r)}}),WP=V({less_:function(n,t){var e,r=I(n,"a","less"),a=I(t,"b","less");return e=_t(r,a),r=e[0],a=e[1],Xe(r.shape,a.shape),q.runKernelFunc(function(i){return i.less(r,a)},{a:r,b:a},null,"Less")}}),GP=V({lessEqual_:function(n,t){var e,r=I(n,"a","lessEqual"),a=I(t,"b","lessEqual");return e=_t(r,a),r=e[0],a=e[1],Xe(r.shape,a.shape),q.runKernelFunc(function(i,u){var l=i.lessEqual(r,a);return u([r,a]),l},{a:r,b:a},null,"LessEqual")}}),jP=V({lessEqualStrict_:function(n,t){var e=I(n,"a","lessEqualStrict"),r=I(t,"b","lessEqualStrict");return at(e.shape,r.shape,"Error in lessEqualStrict: "),e.lessEqual(r)}}),qP=V({lessStrict_:function(n,t){var e=I(n,"a","lessStrict"),r=I(t,"b","lessStrict");return at(e.shape,r.shape,"Error in lessStrict: "),e.less(r)}}),$P=V({notEqual_:function(n,t){var e,r=I(n,"a","notEqual"),a=I(t,"b","notEqual");return e=_t(r,a),r=e[0],a=e[1],Xe(r.shape,a.shape),q.runKernelFunc(function(i){return i.notEqual(r,a)},{a:r,b:a},null,"NotEqual")}}),KP=V({notEqualStrict_:function(n,t){var e=I(n,"a","notEqualStrict"),r=I(t,"b","notEqualStrict");return at(e.shape,r.shape,"Error in notEqualStrict: "),e.notEqual(r)}});function Uw(n,t){for(var e=[],r=n;r<t;++r)e.push(r);return e}function Hw(n){for(var t=[],e=0;e<n.length;++e)for(var r=0;r<n[e].length;++r)t.push(n[e][r]);return t}var og=V({gather_:function(n,t,e){e===void 0&&(e=0);var r=I(n,"x","gather"),a=I(t,"indices","gather","int32");e=Kt(e,r.shape)[0];var i=function(u,l,c){for(var f=u.shape[c],d=[],v=1,m=1,g=0;g<c;g++)d.push(u.shape[g]),v*=u.shape[g];for(g=0;g<l.rank;g++)d.push(l.shape[g]);for(g=c+1;g<u.rank;g++)d.push(u.shape[g]),m*=u.shape[g];return{batchSize:v,sliceSize:m,dimSize:f,outputShape:d}}(r,a,e);return q.runKernelFunc(function(u,l){var c=u.gather(r,a.flatten(),e);return l([a]),c},{x:r,indices:a},function(u,l){var c=l[0];return{x:function(){var f=r.shape,d=c.size,v=f.slice(0,e),m=v.length,g=f.slice(e,f.length).slice(1),b=g.length,w=Uw(0,m),S=Uw(m+1,m+1+b),E=Hw([v,[d],g]),_=u.reshape(E),R=c.reshape([d]),C=Hw([[m],w,S]),A=_.transpose(C),D=WE(A,R,r.shape[e]),O=qm(C);return D=D.transpose(O)},indices:function(){return c}}},"Gather",{axis:e}).reshape(i.outputShape)}}),WE=V({unsortedSegmentSum_:function(n,t,e){var r=I(n,"x","unsortedSegmentSum"),a=I(t,"segmentIds","unsortedSegmentSum","int32");return P(Nt(e),function(){return"numSegments must be of dtype int"}),q.runKernelFunc(function(i,u){var l=i.unsortedSegmentSum(r,a,e);return u([a]),l},{$x:r},function(i,u){var l=u[0];return{$x:function(){return function(c,f){for(var d=ig(f,Ye(f)),v=og(c,d),m=VE(f,ge(0,"int32")),g=v.rank-m.rank,b=0;b<g;++b)m=hr(m,b+1);m=oh(m,Os(v.shape,"bool"));var w=Ye(v);return no(m,v,w)}(i,l)}}})}}),XP=function(n,t,e){return we(this,void 0,void 0,function(){var r,a,i,u,l,c,f,d,v,m,g,b,w;return Se(this,function(S){switch(S.label){case 0:for(r=I(n,"tensor","boolMask"),a=I(t,"mask","boolMask","bool"),i=e??0,u=a.rank,l=r.shape,P(u>0,function(){return"mask cannot be scalar"}),at(l.slice(i,i+u),a.shape,"mask's shape must match the first K dimensions of tensor's shape,"),c=1,f=i;f<i+u;f++)c*=l[f];return d=l.slice(0,i).concat([c],l.slice(i+u)),v=r.reshape(d),m=a.reshape([-1]),[4,LE(m)];case 1:return g=S.sent(),b=g.squeeze([1]),w=og(v,b,i),n!==r&&r.dispose(),t!==a&&a.dispose(),b.dispose(),v.dispose(),m.dispose(),g.dispose(),[2,w]}})})};function GE(n,t,e,r,a,i,u){i===void 0&&(i="NHWC"),P(n.length===t.rank,function(){return"Length of inShape ("+n.length+") and rank of dy ("+t.rank+") must match"});var l=n,c=t,f=!1;t.rank===3&&(f=!0,c=t.as4D(1,t.shape[0],t.shape[1],t.shape[2]),l=[1,n[0],n[1],n[2]]),P(l.length===4,function(){return"Error in conv2dDerInput: inShape must be length 4, but got length "+l.length+"."}),P(c.rank===4,function(){return"Error in conv2dDerInput: dy must be rank 4, but got rank "+c.rank}),P(e.rank===4,function(){return"Error in conv2dDerInput: filter must be rank 4, but got rank "+e.rank});var d=i==="NHWC"?l[3]:l[1],v=i==="NHWC"?c.shape[3]:c.shape[1];P(d===e.shape[2],function(){return"Error in conv2dDerInput: depth of input ("+d+") must match input depth for filter "+e.shape[2]+"."}),P(v===e.shape[3],function(){return"Error in conv2dDerInput: depth of output ("+v+") must match output depth for filter "+e.shape[3]+"."}),u!=null&&P(Nt(a),function(){return"Error in conv2dDerInput: pad must be an integer when using, dimRoundingMode "+u+" but got pad "+a+"."});var m=Ym(i),g=io(l,e.shape,r,1,a,u,!1,m),b=q.runKernelFunc(function(w,S){var E=w.conv2dDerInput(c,e,g);return S([e,c]),E},{dy4D:c,filter:e},function(w,S){var E=S[0],_=S[1];return{dy4D:function(){return yr(w,E,r,a,i,1,u)},filter:function(){return sg(w,_,E.shape,r,a,i,u)}}});return f?b.as3D(b.shape[1],b.shape[2],b.shape[3]):b}function dv(n){var t=function(i){return typeof i=="number"?[i,i,i]:i.length===2?[i[0],i[1],1]:i}(n),e=t[0],r=t[1],a=t[2];return e===1&&r===1&&a===1}function jE(n,t,e,r,a){P(n.length===t.rank,function(){return"Length of inShape ("+n.length+") and rank of dy ("+t.rank+") must match"});var i=n,u=t,l=!1;t.rank===4&&(l=!0,u=t.as5D(1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]),i=[1,n[0],n[1],n[2],n[3]]);var c=i[4],f=u.shape[4];P(i.length===5,function(){return"Error in conv3dDerInput: inShape must be length 5, but got length "+i.length+"."}),P(u.rank===5,function(){return"Error in conv3dDerInput: dy must be rank 5, but got rank "+u.rank}),P(e.rank===5,function(){return"Error in conv3dDerInput: filter must be rank 5, but got rank "+e.rank}),P(c===e.shape[3],function(){return"Error in conv3dDerInput: depth of input ("+c+") must match input depth for filter "+e.shape[3]+"."}),P(f===e.shape[4],function(){return"Error in conv3dDerInput: depth of output ("+f+") must match output depth for filter "+e.shape[4]+"."});var d=Ff(i,e.shape,r,1,a),v=q.runKernelFunc(function(m){return m.conv3dDerInput(u,e,d)},{dy5D:u});return l?v.as4D(v.shape[1],v.shape[2],v.shape[3],v.shape[4]):v}var ZP=V({conv1d_:function(n,t,e,r,a,i,u){a===void 0&&(a="NWC"),i===void 0&&(i=1);var l=I(n,"x","conv1d"),c=I(t,"filter","conv1d"),f=l,d=!1;l.rank===2&&(d=!0,f=l.as3D(1,l.shape[0],l.shape[1])),P(f.rank===3,function(){return"Error in conv1d: input must be rank 3, but got rank "+f.rank+"."}),P(c.rank===3,function(){return"Error in conv1d: filter must be rank 3, but got rank "+c.rank+"."}),u!=null&&P(Nt(r),function(){return"Error in conv1d: pad must be an integer when using, dimRoundingMode "+u+" but got pad "+r+"."}),P(f.shape[2]===c.shape[1],function(){return"Error in conv1d: depth of input ("+f.shape[2]+") must match input depth for filter "+c.shape[1]+"."}),P(Pn(e,i),function(){return"Error in conv1D: Either stride or dilation must be 1. Got stride "+e+" and dilation '"+i+"'"}),P(a==="NWC",function(){return"Error in conv1d: got dataFormat of "+a+" but only NWC is currently supported."});var v=c.as4D(1,c.shape[0],c.shape[1],c.shape[2]),m=f.as4D(f.shape[0],1,f.shape[1],f.shape[2]),g=yr(m,v,[1,e],r,"NHWC",[1,i],u);return d?g.as2D(g.shape[2],g.shape[3]):g.as3D(g.shape[0],g.shape[2],g.shape[3])}}),yr=V({conv2d_:function(n,t,e,r,a,i,u){a===void 0&&(a="NHWC"),i===void 0&&(i=[1,1]);var l=I(n,"x","conv2d"),c=I(t,"filter","conv2d"),f=l,d=!1;l.rank===3&&(d=!0,f=l.as4D(1,l.shape[0],l.shape[1],l.shape[2])),P(f.rank===4,function(){return"Error in conv2d: input must be rank 4, but got rank "+f.rank+"."}),P(c.rank===4,function(){return"Error in conv2d: filter must be rank 4, but got rank "+c.rank+"."}),u!=null&&P(Nt(r),function(){return"Error in conv2d: pad must be an integer when using, dimRoundingMode "+u+" but got pad "+r+"."});var v=a==="NHWC"?f.shape[3]:f.shape[1];P(v===c.shape[2],function(){return"Error in conv2d: depth of input ("+v+") must match input depth for filter "+c.shape[2]+"."}),P(Pn(e,i),function(){return"Error in conv2D: Either strides or dilations must be 1. Got strides "+e+" and dilations '"+i+"'"});var m=Ym(a),g=io(f.shape,c.shape,e,i,r,u,!1,m),b=[c,f],w=q.runKernelFunc(function(S,E){var _=S.conv2d(f,c,g);return E([c,f]),_},{x:f,filter:c},function(S,E){var _=E,R=_[0],C=_[1];return P(_s(i),function(){return"Error in gradient of conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+i+"'"}),{x:function(){return qE(C.shape,S,R,e,r,a)},filter:function(){return sg(C,S,R.shape,e,r,a)}}},"Conv2D",g,b);return d?w.as3D(w.shape[1],w.shape[2],w.shape[3]):w}}),YP=V({conv3d_:function(n,t,e,r,a,i){a===void 0&&(a="NDHWC"),i===void 0&&(i=[1,1,1]);var u=I(n,"x","conv3d"),l=I(t,"filter","conv3d"),c=u,f=!1;u.rank===4&&(f=!0,c=u.as5D(1,u.shape[0],u.shape[1],u.shape[2],u.shape[3])),P(c.rank===5,function(){return"Error in conv3d: input must be rank 5, but got rank "+c.rank+"."}),P(l.rank===5,function(){return"Error in conv3d: filter must be rank 5, but got rank "+l.rank+"."}),P(c.shape[4]===l.shape[3],function(){return"Error in conv3d: depth of input ("+c.shape[4]+") must match input depth for filter "+l.shape[3]+"."}),P(function(m,g){return dv(m)||dv(g)}(e,i),function(){return"Error in conv3D: Either strides or dilations must be 1. Got strides "+e+" and dilations '"+i+"'"}),P(a==="NDHWC",function(){return"Error in conv3d: got dataFormat of "+a+" but only NDHWC is currently supported."});var d=Ff(c.shape,l.shape,e,i,r),v=q.runKernelFunc(function(m,g){var b=m.conv3d(c,l,d);return g([c,l]),b},{x:c,$filter:l},function(m,g){P(dv(i),function(){return"Error in gradient of conv3D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+i+"'"});var b=g[0],w=g[1];return{x:function(){return jE(b.shape,m,w,e,r)},$filter:function(){return function(S,E,_,R,C){var A=S;S.rank===4&&(A=S.as5D(1,S.shape[0],S.shape[1],S.shape[2],S.shape[3]));var D=E;D.rank===4&&(D=E.as5D(1,E.shape[0],E.shape[1],E.shape[2],E.shape[3])),P(A.rank===5,function(){return"Error in conv3dDerFilter: input must be rank 5, but got shape "+A.shape+"."}),P(D.rank===5,function(){return"Error in conv3dDerFilter: dy must be rank 5, but got shape "+D.shape+"."}),P(_.length===5,function(){return"Error in conv3dDerFilter: filterShape must be length 5, but got "+_+"."}),P(A.shape[4]===_[3],function(){return"Error in conv3dDerFilter: depth of input "+A.shape[4]+") must match input depth in filter ("+_[3]+"."}),P(D.shape[4]===_[4],function(){return"Error in conv3dDerFilter: depth of dy ("+D.shape[4]+") must match output depth for filter ("+_[4]+")."});var O=Ff(A.shape,_,R,1,C);return q.runKernelFunc(function(F){return F.conv3dDerFilter(A,D,O)},{x5D:A,dy5D:D})}(b,m,w.shape,e,r)}}});return f?v.as4D(v.shape[1],v.shape[2],v.shape[3],v.shape[4]):v}}),sg=V({conv2dDerFilter_:function(n,t,e,r,a,i,u){i===void 0&&(i="NHWC");var l=n;n.rank===3&&(l=n.as4D(1,n.shape[0],n.shape[1],n.shape[2]));var c=t;c.rank===3&&(c=t.as4D(1,t.shape[0],t.shape[1],t.shape[2])),P(l.rank===4,function(){return"Error in conv2dDerFilter: input must be rank 4, but got shape "+l.shape+"."}),P(c.rank===4,function(){return"Error in conv2dDerFilter: dy must be rank 4, but got shape "+c.shape+"."}),P(e.length===4,function(){return"Error in conv2dDerFilter: filterShape must be length 4, but got "+e+"."});var f=i==="NHWC"?l.shape[3]:l.shape[1],d=i==="NHWC"?c.shape[3]:c.shape[1];P(f===e[2],function(){return"Error in conv2dDerFilter: depth of input "+f+") must match input depth in filter ("+e[2]+"."}),P(d===e[3],function(){return"Error in conv2dDerFilter: depth of dy ("+d+") must match output depth for filter ("+e[3]+")."}),u!=null&&P(Nt(a),function(){return"Error in conv2dDerFilter: pad must be an integer when using, dimRoundingMode "+u+" but got pad "+a+"."});var v=Ym(i),m=io(l.shape,e,r,1,a,u,!1,v);return q.runKernelFunc(function(g){return g.conv2dDerFilter(l,c,m)},{x4D:l,dy4D:c})}}),qE=V({conv2dDerInput_:GE}),sh=V({depthwiseConv2d_:function(n,t,e,r,a,i,u){i===void 0&&(i=[1,1]);var l=I(n,"x","depthwiseConv2d"),c=I(t,"filter","depthwiseConv2d"),f=l,d=!1;l.rank===3&&(d=!0,f=l.as4D(1,l.shape[0],l.shape[1],l.shape[2])),P(f.rank===4,function(){return"Error in depthwiseConv2d: input must be rank 4, but got rank "+f.rank+"."}),P(c.rank===4,function(){return"Error in depthwiseConv2d: filter must be rank 4, but got rank "+c.rank+"."}),P(f.shape[3]===c.shape[2],function(){return"Error in depthwiseConv2d: number of input channels ("+f.shape[3]+") must match the inChannels dimension in filter "+c.shape[2]+"."}),i==null&&(i=[1,1]),P(Pn(e,i),function(){return"Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides "+e+" and dilations '"+i+"'"}),u!=null&&P(Nt(r),function(){return"Error in depthwiseConv2d: pad must be an integer when using, dimRoundingMode "+u+" but got pad "+r+"."});var v=io(f.shape,c.shape,e,i,r,u,!0),m=[f,c],g=q.runKernelFunc(function(b,w){var S=b.depthwiseConv2D(f,c,v);return w([f,c]),S},{x:f,filter:c},function(b,w){P(_s(i),function(){return"Error in gradient of depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '"+i+"'"});var S=w[0],E=w[1];return{x:function(){return $E(S.shape,b,E,v)},filter:function(){return KE(S,b,E.shape,v)}}},"DepthwiseConv2dNative",v,m);return d?g.as3D(g.shape[1],g.shape[2],g.shape[3]):g}}),$E=V({depthwiseConv2dDerInput_:function(n,t,e,r){var a=t,i=!1;t.rank===3&&(i=!0,a=t.as4D(1,t.shape[0],t.shape[1],t.shape[2]));var u=q.runKernelFunc(function(l){return l.depthwiseConv2DDerInput(a,e,r)},{dy4D:a});return i?u.as3D(u.shape[1],u.shape[2],u.shape[3]):u}}),KE=V({depthwiseConv2dDerFilter_:function(n,t,e,r){var a=n;n.rank===3&&(a=n.as4D(1,n.shape[0],n.shape[1],n.shape[2]));var i=t;return i.rank===3&&(i=t.as4D(1,t.shape[0],t.shape[1],t.shape[2])),q.runKernelFunc(function(u){return u.depthwiseConv2DDerFilter(a,i,r)},{x4D:a,dy4D:i})}}),ug=V({separableConv2d_:function(n,t,e,r,a,i,u){i===void 0&&(i=[1,1]),u===void 0&&(u="NHWC");var l=I(n,"x","separableConv2d"),c=I(t,"depthwiseFilter","separableConv2d"),f=I(e,"pointwiseFilter","separableConv2d"),d=l,v=!1;if(l.rank===3&&(v=!0,d=l.as4D(1,l.shape[0],l.shape[1],l.shape[2])),u==="NCHW")throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");P(d.rank===4,function(){return"Error in separableConv2d: input must be rank 4, but got rank "+d.rank+"."}),P(c.rank===4,function(){return"Error in separableConv2d: depthwise filter must be rank 4, but got rank "+c.rank+"."}),P(f.rank===4,function(){return"Error in separableConv2d: pointwise filter must be rank 4, but got rank "+c.rank+"."}),P(f.shape[0]===1,function(){return"Error in separableConv2d: the first dimension of pointwise filter  must be 1, but got "+f.shape[0]+"."}),P(f.shape[1]===1,function(){return"Error in separableConv2d: the second dimension of pointwise filter must be 1, but got "+f.shape[1]+"."});var m=c.shape[2],g=c.shape[3];P(f.shape[2]===m*g,function(){return"Error in separableConv2d: the third dimension of pointwise filter must be "+m*g+", but got "+f.shape[2]+"."});var b=sh(d,c,r,a,u,i),w=yr(b,f,1,"valid",u);return v?w.as3D(w.shape[1],w.shape[2],w.shape[3]):w}}),QP=V({conv2dTranspose_:function(n,t,e,r,a,i){return GE(e,I(n,"x","conv2dTranspose"),I(t,"filter","conv2dTranspose"),r,a,"NHWC",i)}}),JP=V({conv3dTranspose_:function(n,t,e,r,a){return jE(e,I(n,"x","conv3dTranspose"),I(t,"filter","conv3dTranspose"),r,a)}}),uh=V({matMul_:function(n,t,e,r){var a;e===void 0&&(e=!1),r===void 0&&(r=!1);var i=I(n,"a","matMul"),u=I(t,"b","matMul");a=_t(i,u),i=a[0],u=a[1];var l=e?i.shape[i.rank-2]:i.shape[i.rank-1],c=r?u.shape[u.rank-1]:u.shape[u.rank-2],f=e?i.shape[i.rank-1]:i.shape[i.rank-2],d=r?u.shape[u.rank-2]:u.shape[u.rank-1],v=i.shape.slice(0,-2),m=u.shape.slice(0,-2),g=Ee(v),b=Ee(m);P(i.rank>=2&&u.rank>=2&&i.rank===u.rank,function(){return"Error in matMul: inputs must have the same rank of at least 2, got ranks "+i.rank+" and "+u.rank+"."}),P(nn(v,m),function(){return"Error in matMul: outer dimensions ("+v+") and ("+m+") of Tensors with shapes "+i.shape+" and "+u.shape+" must match."}),P(l===c,function(){return"Error in matMul: inner shapes ("+l+") and ("+c+") of Tensors with shapes "+i.shape+" and "+u.shape+" and transposeA="+e+" and transposeB="+r+" must match."});var w=i.shape.slice(0,-2).concat([f,d]),S=e?i.as3D(g,l,f):i.as3D(g,f,l),E=r?u.as3D(b,d,c):u.as3D(b,c,d),_={transposeA:e,transposeB:r};return q.runKernelFunc(function(R,C){var A=R.batchMatMul(S,E,e,r);return C([S,E]),A},{a:S,b:E},function(R,C){var A=C,D=A[0],O=A[1];return e||r?!e&&r?{a:function(){return R.matMul(O,!1,!1)},b:function(){return R.matMul(D,!0,!1)}}:e&&!r?{a:function(){return O.matMul(R,!1,!0)},b:function(){return D.matMul(R,!1,!1)}}:{a:function(){return O.matMul(R,!0,!0)},b:function(){return R.matMul(D,!0,!0)}}:{a:function(){return R.matMul(O,!1,!0)},b:function(){return D.matMul(R,!0,!1)}}},"BatchMatMul",_).reshape(w)}}),eL=V({dot_:function(n,t){var e=I(n,"t1","dot"),r=I(t,"t2","dot");P(!(e.rank!==1&&e.rank!==2||r.rank!==1&&r.rank!==2),function(){return"Error in dot: inputs must all be rank 1 or 2, but got ranks "+e.rank+" and "+r.rank+"."});var a=e.rank===1?e.size:e.shape[1],i=r.rank===1?r.size:r.shape[0];return P(a===i,function(){return"Error in dot: inner dimensions of inputs must match, but got "+a+" and "+i+"."}),e.rank===1&&r.rank===1?e.as2D(1,-1).matMul(r.as2D(-1,1)).asScalar():e.rank===1&&r.rank===2?e.as2D(1,-1).matMul(r.as2D(r.shape[0],r.shape[1])).as1D():e.rank===2&&r.rank===1?e.matMul(r.as2D(-1,1)).as1D():e.matMul(r.as2D(r.shape[0],r.shape[1]))}}),tL=V({outerProduct_:function(n,t){var e=I(n,"v1","outerProduct"),r=I(t,"v2","outerProduct");return P(e.rank===1&&r.rank===1,function(){return"Error in outerProduct: inputs must be rank 1, but got ranks "+e.rank+" and "+r.rank+"."}),e.as2D(-1,1).matMul(r.as2D(1,-1))}}),dl=V({reverse_:function(n,t){var e=I(n,"x","reverse");if(e.rank===0)return e.clone();var r=Kt(t,e.shape);return q.runKernelFunc(function(a){return a.reverse(e,r)},{$x:e},function(a){return{$x:function(){return a.reverse(r)}}}).reshapeAs(e)}}),nL=V({reverse1d_:function(n){var t=I(n,"x","reverse");return P(t.rank===1,function(){return"Error in reverse1D: x must be rank 1 but got rank "+t.rank+"."}),dl(t,0)}}),rL=V({reverse2d_:function(n,t){var e=I(n,"x","reverse");return P(e.rank===2,function(){return"Error in reverse2D: x must be rank 2 but got rank "+e.rank+"."}),dl(e,t)}}),aL=V({reverse3d_:function(n,t){var e=I(n,"x","reverse");return P(e.rank===3,function(){return"Error in reverse3D: x must be rank 3 but got rank "+e.rank+"."}),dl(e,t)}}),iL=V({reverse4d_:function(n,t){var e=I(n,"x","reverse");return P(e.rank===4,function(){return"Error in reverse4D: x must be rank 4 but got rank "+e.rank+"."}),dl(e,t)}});function XE(n,t,e,r,a,i){var u=I(n,"x","maxPool"),l=u,c=!1;u.rank===3&&(c=!0,l=u.as4D(1,u.shape[0],u.shape[1],u.shape[2])),P(l.rank===4,function(){return"Error in maxPool: input must be rank 4 but got rank "+l.rank+"."}),P(Pn(e,r),function(){return"Error in maxPool: Either strides or dilations must be 1. Got strides "+e+" and dilations '"+r+"'"}),i!=null&&P(Nt(a),function(){return"Error in maxPool: pad must be an integer when using, dimRoundingMode "+i+" but got pad "+a+"."});var f=Yu(l.shape,t,e,r,a,i);if(f.filterWidth===1&&f.filterHeight===1&&nn(f.inShape,f.outShape))return u.clone();var d=[l],v=q.runKernelFunc(function(m,g){var b=m.maxPool(l,f);return g([l,b]),b},{x:l},function(m,g){var b=g[0],w=g[1];return{x:function(){return function(S,E,_,R,C,A,D,O){var F=I(S,"dy","maxPoolBackprop"),N=I(E,"input","maxPoolBackprop"),B=I(_,"output","maxPoolBackprop");P(N.rank===F.rank,function(){return"Rank of input ("+N.rank+") does not match rank of dy ("+F.rank+")"}),P(Pn(C,A),function(){return"Error in maxPoolBackProp: Either strides or dilations must be 1. Got strides "+C+" and dilations '"+A+"'"}),P(F.rank===4,function(){return"Error in maxPoolBackprop: dy must be rank 4 but got rank "+F.rank+"."}),P(N.rank===4,function(){return"Error in maxPoolBackprop: input must be rank 4 but got rank "+N.rank+"."});var H=Yu(N.shape,R,C,A,D,O);return q.runKernelFunc(function(U){return U.maxPoolBackprop(F,N,B,H)},{$dy:F,$input:N})}(m,b,w,t,e,r,a)}}},"MaxPool",f,d);return c?v.as3D(v.shape[1],v.shape[2],v.shape[3]):v}function ZE(n,t,e,r,a,i){var u=I(n,"x","avgPool","float32");P(Pn(e,r),function(){return"Error in avgPool: Either strides or dilations must be 1. Got strides "+e+" and dilations '"+r+"'"});var l=u,c=!1;u.rank===3&&(c=!0,l=u.as4D(1,u.shape[0],u.shape[1],u.shape[2])),P(l.rank===4,function(){return"Error in avgPool: x must be rank 4 but got rank "+l.rank+"."}),i!=null&&P(Nt(a),function(){return"Error in avgPool: pad must be an integer when using, dimRoundingMode "+i+" but got pad "+a+"."});var f=Yu(l.shape,t,e,r,a,i);if(f.filterWidth===1&&f.filterHeight===1&&nn(f.inShape,f.outShape))return u.clone();var d=q.runKernelFunc(function(v){return v.avgPool(l,f)},{x:l},function(v){return{x:function(){return function(m,g,b,w,S,E){var _=I(m,"dy","avgPoolBackprop"),R=I(g,"input","avgPoolBackprop");P(R.rank===_.rank,function(){return"Rank of input ("+R.rank+") does not match rank of dy ("+_.rank+")"}),P(Pn(w,S),function(){return"Error in avgPoolBackprop: Either strides or dilations must be 1. Got strides "+w+" and dilations '"+S+"'"});var C=R,A=_,D=!1;R.rank===3&&(D=!0,C=R.as4D(1,R.shape[0],R.shape[1],R.shape[2]),A=_.as4D(1,_.shape[0],_.shape[1],_.shape[2])),P(A.rank===4,function(){return"Error in avgPoolBackprop: dy must be rank 4 but got rank "+A.rank+"."}),P(C.rank===4,function(){return"Error in avgPoolBackprop: input must be rank 4 but got rank "+C.rank+"."});var O=Yu(C.shape,b,w,S,E),F=q.runKernelFunc(function(N){return N.avgPoolBackprop(A,C,O)},{dy4D:A,input4D:C});return D?F.as3D(F.shape[1],F.shape[2],F.shape[3]):F}(v,l,t,e,r,a)}}},"AvgPool",f);return d=d.cast(u.dtype),c?d.as3D(d.shape[1],d.shape[2],d.shape[3]):d}var Jt=V({maxPool_:function(n,t,e,r,a){return XE(n,t,e,1,r,a)}}),pl=V({avgPool_:function(n,t,e,r,a){return ZE(n,t,e,1,r,a)}}),oL=V({pool_:function(n,t,e,r,a,i){a==null&&(a=[1,1]),i==null&&(i=1),r===0&&(r="valid");var u=I(n,"x","maxPool"),l=u,c=!1;u.rank===3&&(c=!0,l=u.as4D(1,u.shape[0],u.shape[1],u.shape[2])),P(Pn(i,a),function(){return"Error in pool: Either strides or dilations must be 1. Got strides "+i+" and dilations '"+a+"'"});var f,d=Yu(l.shape,t,i,a,r),v=[d.dilationHeight,d.dilationWidth];f=r==="same"?function(C,A){var D=C.map(function(N,B){return N+(N-1)*(A[B]-1)}).map(function(N){return N-1}),O=D.map(function(N){return Math.floor(N/2)}),F=D.map(function(N,B){return N-O[B]});return D.map(function(N,B){return[O[B],F[B]]})}([d.filterHeight,d.filterWidth],v):[[0,0],[0,0]];var m=v[0]===1&&v[1]===1,g=function(C,A,D){var O=D.map(function(ee){return ee[0]}),F=D.map(function(ee){return ee[1]}),N=C.concat(O,F),B=A.map(function(ee,te){return(ee-N[te]%ee)%ee}),H=F.map(function(ee,te){return ee+B[te]}),U=A.map(function(ee,te){return[O[te],H[te]]}),J=A.map(function(ee,te){return[0,B[te]]});return[U,J]}([d.inHeight,d.inWidth],v,f),b=g[0],w=g[1],S=m?r:"valid",E=m?l:nE(l,v,b),_=(e==="avg"?function(){return ZE(E,t,i,1,S)}:function(){return XE(E,t,i,1,S)})(),R=m?_:JS(_,v,w);return c?R.as3D(R.shape[1],R.shape[2],R.shape[3]):R}}),sL=V({maxPool3d_:function(n,t,e,r,a,i,u){i===void 0&&(i="NDHWC");var l=I(n,"x","maxPool3d"),c=l,f=!1;l.rank===4&&(f=!0,c=l.as5D(1,l.shape[0],l.shape[1],l.shape[2],l.shape[3])),u==null&&(u=[1,1,1]),P(c.rank===5,function(){return"Error in maxPool3d: x must be rank 5 but got rank "+c.rank+"."}),P(i==="NDHWC",function(){return"Error in maxPool3d: Only NDHWC is currently supported, but got dataFormat of "+i}),P(Pn(e,u),function(){return"Error in maxPool3d: Either strides or dilations must be 1. Got strides "+e+" and dilations '"+u+"'"}),a!=null&&P(Nt(r),function(){return"Error in maxPool3d: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+r+"."});var d=If(c.shape,t,e,u,r,a,i),v=q.runKernelFunc(function(m,g){var b=m.maxPool3d(c,d);return g([c,b]),b},{x:c},function(m,g){var b=g[0],w=g[1];return{x:function(){return function(S,E,_,R,C,A,D,O){var F=I(S,"dy","maxPool3dBackprop"),N=I(E,"input","maxPool3dBackprop"),B=I(_,"output","maxPool3dBackprop"),H=F,U=N,J=B,ee=!1;N.rank===4&&(ee=!0,H=F.as5D(1,F.shape[0],F.shape[1],F.shape[2],F.shape[3]),U=N.as5D(1,N.shape[0],N.shape[1],N.shape[2],N.shape[3]),J=B.as5D(1,B.shape[0],B.shape[1],B.shape[2],B.shape[3])),P(H.rank===5,function(){return"Error in maxPool3dBackprop: dy must be rank 5 but got rank "+H.rank+"."}),P(U.rank===5,function(){return"Error in maxPool3dBackprop: input must be rank 5 but got rank "+U.rank+"."}),P(J.rank===5,function(){return"Error in maxPool3dBackprop: output must be rank 5 but got rank "+J.rank+"."}),A==null&&(A=[1,1,1]),P(Pn(C,A),function(){return"Error in maxPool3dBackprop: Either strides or dilations must be 1. Got strides "+C+" and dilations '"+A+"'"}),O!=null&&P(Nt(D),function(){return"Error in maxPool3dBackprop: pad must be an integer when using, dimRoundingMode "+O+" but got pad "+D+"."});var te=If(U.shape,R,C,A,D,O),L=q.runKernelFunc(function(W){return W.maxPool3dBackprop(H,U,J,te)},{dy5D:H,input5D:U});return ee?L.as4D(L.shape[1],L.shape[2],L.shape[3],L.shape[4]):L}(m,b,w,t,e,u,r,a)}}});return f?v.as4D(v.shape[1],v.shape[2],v.shape[3],v.shape[4]):v}}),uL=V({avgPool3d_:function(n,t,e,r,a,i,u){i===void 0&&(i="NDHWC");var l=I(n,"x","avgPool3d","float32"),c=l,f=!1;l.rank===4&&(f=!0,c=l.as5D(1,l.shape[0],l.shape[1],l.shape[2],l.shape[3])),u==null&&(u=[1,1,1]),P(c.rank===5,function(){return"Error in avgPool3d: x must be rank 5 but got rank "+c.rank+"."}),P(i==="NDHWC",function(){return"Error in avgPool3d: Only NDHWC is currently supported, but got dataFormat of "+i}),P(Pn(e,u),function(){return"Error in avgPool3d: Either strides or dilations must be 1. Got strides "+e+" and dilations '"+u+"'"}),a!=null&&P(Nt(r),function(){return"Error in avgPool3d: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+r+"."});var d=If(c.shape,t,e,u,r,a,i),v=q.runKernelFunc(function(m){return m.avgPool3d(c,d)},{x:c},function(m){return{x:function(){return function(g,b,w,S,E,_,R){var C=I(g,"dy","avgPool3dBackprop"),A=I(b,"input","avgPool3dBackprop"),D=C,O=A,F=!1;A.rank===4&&(F=!0,D=C.as5D(1,C.shape[0],C.shape[1],C.shape[2],C.shape[3]),O=A.as5D(1,A.shape[0],A.shape[1],A.shape[2],A.shape[3])),P(D.rank===5,function(){return"Error in avgPool3dBackprop: dy must be rank 5 but got rank "+D.rank+"."}),P(O.rank===5,function(){return"Error in avgPool3dBackprop: input must be rank 5 but got rank "+O.rank+"."}),E==null&&(E=[1,1,1]),P(Pn(S,E),function(){return"Error in avgPool3dBackprop: Either strides or dilations must be 1. Got strides "+S+" and dilations '"+E+"'"}),R!=null&&P(Nt(_),function(){return"Error in maxPool3dBackprop: pad must be an integer when using, dimRoundingMode "+R+" but got pad "+_+"."});var N=If(O.shape,w,S,E,_,R),B=q.runKernelFunc(function(H){return H.avgPool3dBackprop(D,O,N)},{dy5D:D,input5D:O});return F?B.as4D(B.shape[1],B.shape[2],B.shape[3],B.shape[4]):B}(m,c,t,e,u,r,a)}}});return v=v.cast(c.dtype),f?v.as4D(v.shape[1],v.shape[2],v.shape[3],v.shape[4]):v}}),Xr=V({slice_:function(n,t,e){var r,a,i=I(n,"x","slice");if(i.rank===0)throw new Error("Slicing scalar is not possible");(r=typeof t=="number"?[t].concat(new Array(i.rank-1).fill(0)):t.length<i.rank?t.concat(new Array(i.rank-t.length).fill(0)):t.slice()).forEach(function(c){P(c!==-1,function(){return"slice() does not support negative begin indexing."})}),a=(a=e==null?new Array(i.rank).fill(-1):typeof e=="number"?[e].concat(new Array(i.rank-1).fill(-1)):e.length<i.rank?e.concat(new Array(i.rank-e.length).fill(-1)):e).map(function(c,f){return c>=0?c:(P(c===-1,function(){return"Negative size values should be exactly -1 but got "+c+" for the slice() size at index "+f+"."}),i.shape[f]-r[f])}),BI(i,r,a);var u=i.shape,l={begin:r,size:a};return q.runKernelFunc(function(c){return c.slice(i,r,a)},{x:i},function(c){for(var f=[],d=0;d<c.rank;d++)f.push([r[d],u[d]-r[d]-a[d]]);return{x:function(){return c.pad(f)}}},"Slice",l)}}),lL=V({slice1d_:function(n,t,e){var r=I(n,"x","slice1d");return P(r.rank===1,function(){return"slice1d expects a rank-1 tensor, but got a rank-"+r.rank+" tensor"}),Xr(r,[t],[e])}}),cL=V({slice2d_:function(n,t,e){var r=I(n,"x","slice2d");return P(r.rank===2,function(){return"slice2d expects a rank-2 tensor, but got a rank-"+r.rank+" tensor"}),Xr(r,t,e)}}),YE=V({slice3d_:function(n,t,e){var r=I(n,"x","slice3d");return P(r.rank===3,function(){return"slice3d expects a rank-3 tensor, but got a rank-"+r.rank+" tensor"}),Xr(r,t,e)}}),fL=V({slice4d_:function(n,t,e){var r=I(n,"x","slice4d");return P(r.rank===4,function(){return"slice4d expects a rank-4 tensor, but got a rank-"+r.rank+" tensor"}),Xr(r,t,e)}});function QE(n,t,e,r,a){return t.rank<e.rank&&(t=t.reshape(Bn(t.shape,r))),n.rank<e.rank&&(n=n.reshape(Bn(n.shape,r))),{x:function(){var i=n.mul(e.equal(t).cast(n.dtype));return a==null?i:i.transpose(a)}}}var hL=V({all_:function(n,t,e){t===void 0&&(t=null),e===void 0&&(e=!1);var r=I(n,"x","all","bool"),a=Kt(t,r.shape),i=a,u=ea(i,r.rank);u!=null&&(r=r.transpose(u),i=ta(i.length,r.rank));var l=q.runKernelFunc(function(f){return f.all(r,i)},{$x:r});if(e){var c=Bn(l.shape,a);return l.reshape(c)}return l}}),dL=V({any_:function(n,t,e){t===void 0&&(t=null),e===void 0&&(e=!1);var r=I(n,"x","any","bool"),a=Kt(t,r.shape),i=a,u=ea(i,r.rank);u!=null&&(r=r.transpose(u),i=ta(i.length,r.rank));var l=q.runKernelFunc(function(f){return f.any(r,i)},{$x:r});if(e){var c=Bn(l.shape,a);return l.reshape(c)}return l}}),pL=V({argMax_:function(n,t){t===void 0&&(t=0);var e=I(n,"x","argMax");t==null&&(t=0);var r=Kt(t,e.shape),a=ea(r,e.rank);a!=null&&(e=e.transpose(a),r=ta(r.length,e.rank));var i={axis:r[0]},u=[e];return q.runKernelFunc(function(l,c){var f=l.argMax(e,r[0]);return c([e]),f},{x:e},function(l,c){var f=c[0];return{x:function(){return Ye(f)}}},"ArgMax",i,u)}}),vL=V({argMin_:function(n,t){t===void 0&&(t=0);var e=I(n,"x","argMin");t==null&&(t=0);var r=Kt(t,e.shape),a=ea(r,e.rank);return a!=null&&(e=e.transpose(a),r=ta(r.length,e.rank)),q.runKernelFunc(function(i,u){var l=i.argMin(e,r[0]);return u([e]),l},{$x:e},function(i,u){var l=u[0];return{$x:function(){return Ye(l)}}})}}),mL=V({logSumExp_:function(n,t,e){t===void 0&&(t=null),e===void 0&&(e=!1);var r=I(n,"x","logSumExp"),a=Kt(t,r.shape),i=r.max(a,!0),u=r.sub(i).exp().sum(a).log(),l=i.reshape(u.shape).add(u);if(e){var c=Bn(l.shape,a);return l.reshape(c)}return l}}),lh=V({max_:function(n,t,e){t===void 0&&(t=null),e===void 0&&(e=!1);var r=I(n,"x","max"),a=r,i=Kt(t,r.shape),u=i,l=ea(u,r.rank);l!=null&&(r=r.transpose(l),u=ta(u.length,r.rank));var c=[r],f=q.runKernelFunc(function(v,m){var g=v.max(r,u);return m([a,g]),g},{x:r},function(v,m){return QE(v,m[1],m[0],i,l)},"Max",{axes:u},c,[!0]);if(e){var d=Bn(f.shape,i);f=f.reshape(d)}return f}}),gL=V({mean_:function(n,t,e){t===void 0&&(t=null),e===void 0&&(e=!1);var r=I(n,"x","mean"),a=Kt(t,r.shape),i=Ee(mn(r.shape,a)[1]);return ah(function(u){var l=ge(i);return{value:(l.dtype===u.dtype?u:u.cast(l.dtype)).div(l).sum(t,e),gradFunc:function(c){var f=u.shape.slice();return a.forEach(function(d){f[d]=1}),c.reshape(f).mul(Os(u.shape,"float32")).div(i)}}})(r)}}),yL=V({min_:function(n,t,e){t===void 0&&(t=null),e===void 0&&(e=!1);var r=I(n,"x","min"),a=r,i=Kt(t,r.shape),u=i,l=ea(u,r.rank);l!=null&&(r=r.transpose(l),u=ta(u.length,r.rank));var c=[r],f=q.runKernelFunc(function(v,m){var g=v.min(r,u);return m([a,g]),g},{x:r},function(v,m){return QE(v,m[1],m[0],i,l)},"Min",{axes:u},c,[!0]);if(e){var d=Bn(f.shape,i);f=f.reshape(d)}return f}}),bL=V({moments_:function(n,t,e){t===void 0&&(t=null),e===void 0&&(e=!1);var r=Kt(t,(n=I(n,"x","moments")).shape),a=n.mean(r,e),i=a.shape;e||(i=Bn(a.shape,r));var u=n.toFloat().sub(a.reshape(i)).square();return{mean:a,variance:u.mean(r,e)}}}),JE=V({sum_:function(n,t,e){t===void 0&&(t=null),e===void 0&&(e=!1);var r=I(n,"x","sum");r.dtype==="bool"&&(r=r.toInt());var a=Kt(t,r.shape);return ah(function(i){var u=ea(a,i.rank),l=a,c=i;u!=null&&(c=i.transpose(u),l=ta(l.length,i.rank));var f=function(g){var b=i.shape.slice();return a.forEach(function(w){b[w]=1}),g.reshape(b).mul(Os(i.shape,"float32"))},d={axes:l},v=q.runKernelFunc(function(g){return g.sum(c,l)},{x:c},function(g){return{x:function(){return f(g)}}},"Sum",d);if(e){var m=Bn(v.shape,a);v=v.reshape(m)}return{value:v,gradFunc:f}})(r)}}),xL=V({prod_:function(n,t,e){t===void 0&&(t=null),e===void 0&&(e=!1);var r=I(n,"x","prod");r.dtype==="bool"&&(r=r.toInt());var a=Kt(t,r.shape),i=ea(a,r.rank),u=a,l=r;i!=null&&(l=r.transpose(i),u=ta(u.length,r.rank));var c=q.runKernelFunc(function(d){return d.prod(l,u)},{permutedX:l});if(e){var f=Bn(c.shape,a);c=c.reshape(f)}return c}}),e_=V({elu_:function(n){var t=I(n,"x","elu");return q.runKernelFunc(function(e,r){var a=e.elu(t);return r([a]),a},{$x:t},function(e,r){var a=r[0];return{$x:function(){return q.runKernelFunc(function(i){return i.eluDer(e,a)},{dy:e,y:a})}}})}}),wL=V({leakyRelu_:function(n,t){t===void 0&&(t=.2);var e=I(n,"x","leakyRelu");return ig(ge(t).mul(e),e)}}),t_=V({prelu_:function(n,t){var e=I(n,"x","prelu"),r=I(t,"alpha","prelu");return q.runKernelFunc(function(a,i){var u=a.prelu(e,r);return i([e,r]),u},{x:e,alpha:r},function(a,i){var u=i[0],l=i[1],c=u.greater(0);return{x:function(){return no(c,a,a.mul(l))},alpha:function(){var f=no(c,Ye(a),a.mul(u)),d=qt(l.shape,a.shape);return d.length>0&&(f=f.sum(d)),f.reshape(l.shape)}}},"Prelu")}}),St=V({relu_:function(n){var t=I(n,"x","relu");return t.dtype==="bool"?t.toInt():q.runKernelFunc(function(e,r){var a=e.relu(t);return r([t]),a},{x:t},function(e,r){var a=r[0];return{x:function(){return e.mulStrict(a.step().toFloat())}}},"Relu")}}),n_=V({relu6_:function(n){var t=I(n,"x","relu6");return t.dtype==="bool"?t.toInt():q.runKernelFunc(function(e,r){var a=e.relu6(t);return r([t]),a},{x:t},function(e,r){var a=r[0],i=a.lessEqual(6).mul(a.step());return{x:function(){return e.mulStrict(i.toFloat())}}},"Relu6")}}),SL=V({selu_:function(n){var t=I(n,"x","selu");return q.runKernelFunc(function(e,r){var a=e.selu(t);return r([t]),a},{$x:t},function(e,r){var a=r[0];return{$x:function(){var i=a.greater(ge(0)),u=ge(ng),l=ge(rg),c=e.mul(l),f=e.mul(u).mul(a.toFloat().exp());return no(i,c,f)}}})}}),yi=V({transpose_:function(n,t){var e=I(n,"x","transpose");if(t==null&&(t=e.shape.map(function(a,i){return i}).reverse()),P(e.rank===t.length,function(){return"Error in transpose: rank of input "+e.rank+" must match length of perm "+t+"."}),t.forEach(function(a){P(a>=0&&a<e.rank,function(){return"All entries in 'perm' must be between 0 and "+(e.rank-1)+" but got "+t})}),e.rank<=1)return e.clone();var r={perm:t};return q.runKernelFunc(function(a){return a.transpose(e,t)},{x:e},function(a){var i=qm(t);return{x:function(){return a.transpose(i)}}},"Transpose",r)}}),EL=V({localResponseNormalization_:function(n,t,e,r,a){t===void 0&&(t=5),e===void 0&&(e=1),r===void 0&&(r=1),a===void 0&&(a=.5);var i=I(n,"x","localResponseNormalization");P(i.rank===4||i.rank===3,function(){return`Error in localResponseNormalization: x must be rank 3 or 4 but got
               rank `+i.rank+"."}),P(Nt(t),function(){return"Error in localResponseNormalization: depthRadius must be an integer but got depthRadius "+t+"."});var u=i,l=!1;i.rank===3&&(l=!0,u=i.as4D(1,i.shape[0],i.shape[1],i.shape[2]));var c=q.runKernelFunc(function(f,d){var v=f.localResponseNormalization4D(u,t,e,r,a);return d([u,v]),v},{x4D:u},function(f,d){var v=d[0],m=d[1];return{x4D:function(){return q.runKernelFunc(function(g){return g.LRNGrad(f,v,m,t,e,r,a)},{})}}});return l?c.as3D(c.shape[1],c.shape[2],c.shape[3]):c}}),r_=V({norm_:function(n,t,e,r){t===void 0&&(t="euclidean"),e===void 0&&(e=null),r===void 0&&(r=!1);var a=function l(c,f,d){if(d===void 0&&(d=null),c.rank===0)return c.abs();if(c.rank!==1&&d===null)return l(c.reshape([-1]),f,d);if(c.rank===1||typeof d=="number"||Array.isArray(d)&&d.length===1){if(f===1)return c.abs().sum(d);if(f===1/0)return c.abs().max(d);if(f===-1/0)return c.abs().min(d);if(f==="euclidean"||f===2)return c.abs().pow(ge(2,"int32")).sum(d).sqrt();throw new Error("Error in norm: invalid ord value: "+f)}if(Array.isArray(d)&&d.length===2){if(f===1)return c.abs().sum(d[0]).max(d[1]-1);if(f===1/0)return c.abs().sum(d[1]).max(d[0]);if(f===-1/0)return c.abs().sum(d[1]).min(d[0]);if(f==="fro"||f==="euclidean")return c.square().sum(d).sqrt();throw new Error("Error in norm: invalid ord value: "+f)}throw new Error("Error in norm: invalid axis: "+d)}(n=I(n,"x","norm"),t,e),i=a.shape;if(r){var u=Kt(e,n.shape);i=Bn(a.shape,u)}return a.reshape(i)}}),_L=V({basicLSTMCell_:function(n,t,e,r,a,i){var u=I(n,"forgetBias","basicLSTMCell"),l=I(t,"lstmKernel","basicLSTMCell"),c=I(e,"lstmBias","basicLSTMCell"),f=I(r,"data","basicLSTMCell"),d=I(a,"c","basicLSTMCell"),v=I(i,"h","basicLSTMCell"),m=f.concat(v,1).matMul(l).add(c),g=m.shape[0],b=m.shape[1]/4,w=[g,b],S=m.slice([0,0],w),E=m.slice([0,b],w),_=m.slice([0,2*b],w),R=m.slice([0,3*b],w),C=S.sigmoid().mulStrict(E.tanh()).addStrict(d.mulStrict(u.add(_).sigmoid())),A=C.tanh().mulStrict(R.sigmoid());return[C,A]}}),CL=V({multiRNNCell_:function(n,t,e,r){for(var a=I(t,"data","multiRNNCell"),i=Tf(e,"c","multiRNNCell"),u=Tf(r,"h","multiRNNCell"),l=a,c=[],f=0;f<n.length;f++){var d=n[f](l,i[f],u[f]);c.push(d[0]),c.push(d[1]),l=d[1]}var v=[],m=[];for(f=0;f<c.length;f+=2)v.push(c[f]),m.push(c[f+1]);return[v,m]}}),RL=V({movingAverage_:function(n,t,e,r,a){a===void 0&&(a=!0);var i=I(n,"v","movingAverage"),u=I(t,"x","movingAverage"),l=I(e,"decay","movingAverage");EM(i,u),P(nn(i.shape,u.shape),function(){return"Shape mismatch in v and x"});var c=ge(1),f=c.sub(l),d=u.sub(i).mul(f);if(a){P(r!=null,function(){return"When using zeroDebias: true, step is required."});var v=I(r,"step","movingAverage");d=d.div(c.sub(Lf(l,v)))}return i.add(d)}}),AL=V({stridedSlice_:function(n,t,e,r,a,i,u,l,c){if(a===void 0&&(a=0),i===void 0&&(i=0),u===void 0&&(u=0),l===void 0&&(l=0),c===void 0&&(c=0),r==null&&(r=new Array(t.length)),u!==0)throw new Error("ellipsis mask is not yet supported");var f=I(n,"x","stridedSlice"),d=xw(l),v=f.shape.slice();d.forEach(function(S){t[S]=0,e[S]=1,v.splice(S,0,1)}),f=f.reshape(v);for(var m=0;m<f.rank;m++)t[m]=PI(a,t,r,f.shape,m),e[m]=LI(i,e,r,f.shape,m),r[m]=r[m]||1;var g=xw(c);g.forEach(function(S){e[S]=t[S]+1,r[S]=1});var b=Zm(t,e,r),w=b.filter(function(S,E){return g.indexOf(E)===-1});return r.every(function(S){return S===1})?Xr(f,t,b).reshape(w):q.runKernelFunc(function(S){return S.stridedSlice(f,t,e,r)},{$x:f}).reshape(w)}}),TL=V({topk_:function(n,t,e){t===void 0&&(t=1),e===void 0&&(e=!0);var r=I(n,"x","topk");if(r.rank===0)throw new Error("topk() expects the input to be of rank 1 or higher");var a=r.shape[r.shape.length-1];if(t>a)throw new Error("'k' passed to topk() must be <= the last dimension ("+a+") but got "+t);var i=q.runKernelFunc(function(u){return u.topk(r,t,e)},{$x:r});return{values:i[0],indices:i[1]}}}),DL=V({scatterND_:function(n,t,e){var r=I(n,"indices","scatterND","int32"),a=I(t,"updates","scatterND");return FI(a,r,e),q.runKernelFunc(function(i){return i.scatterND(r,a,e)},{indices:r,updates:a},null,"ScatterNd",{shape:e})}}),lg=V({fft_:function(n){P(n.dtype==="complex64",function(){return"The dtype for tf.spectral.fft() must be complex64 but got "+n.dtype+"."});var t=n.shape[n.shape.length-1],e=n.size/t,r=n.as2D(e,t);return q.runKernelFunc(function(a){return a.fft(r)},{input:n}).reshape(n.shape)}}),zf=V({ifft_:function(n){P(n.dtype==="complex64",function(){return"The dtype for tf.spectral.ifft() must be complex64 but got "+n.dtype+"."});var t=n.shape[n.shape.length-1],e=n.size/t,r=n.as2D(e,t);return q.runKernelFunc(function(a){return a.ifft(r)},{input:n}).reshape(n.shape)}}),cg=V({rfft_:function(n,t){P(n.dtype==="float32",function(){return"The dtype for rfft() must be real value but got "+n.dtype});var e,r=n.shape[n.shape.length-1],a=n.size/r;if(t!=null&&t<r){var i=n.shape.map(function(E){return 0}),u=n.shape.map(function(E){return E});u[n.shape.length-1]=t,e=n.slice(i,u),r=t}else if(t!=null&&t>r){var l=n.shape.map(function(E){return E});l[n.shape.length-1]=t-r,e=n.concat(mt(l),n.shape.length-1),r=t}else e=n;var c=e.zerosLike(),f=ln(e,c).as2D(a,r),d=lg(f),v=Math.floor(r/2)+1,m=dr(d),g=Wr(d),b=m.split([v,r-v],m.shape.length-1),w=g.split([v,r-v],g.shape.length-1),S=e.shape.slice();return S[e.shape.length-1]=v,ln(b[0],w[0]).reshape(S)}}),a_=V({irfft_:function(n){var t=n.shape[n.shape.length-1],e=n.size/t;if(t<=2){var r=n.as2D(e,t),a=zf(r);return dr(a)}var i=[e,2*(t-1)],u=dr(n).as2D(e,t),l=Wr(n).as2D(e,t),c=u.slice([0,1],[e,t-2]).reverse(1),f=l.slice([0,1],[e,t-2]).reverse(1).mul(ge(-1)),d=u.concat(c,1),v=l.concat(f,1);return r=ln(d,v).as2D(i[0],i[1]),a=zf(r),dr(a)}}),OL=Object.freeze({fft:lg,ifft:zf,rfft:cg,irfft:a_}),kL=V({sparseToDense_:function(n,t,e,r){r===void 0&&(r=0);var a=I(n,"sparseIndices","sparseToDense","int32"),i=I(t,"sparseValues","sparseToDense"),u=I(r,"defaultValue","sparseToDense",i.dtype);return function(l,c,f,d){if(l.dtype!=="int32")throw new Error("tf.sparseToDense() expects the indices to be int32 type, but the dtype was "+l.dtype+".");if(l.rank>2)throw new Error("sparseIndices should be a scalar, vector, or matrix, but got shape "+l.shape+".");var v=l.rank>0?l.shape[0]:1,m=l.rank>1?l.shape[1]:1;if(f.length!==m)throw new Error("outputShape has incorrect number of elements:, "+f.length+", should be: "+m+".");var g=c.size;if(c.rank!==0&&(c.rank!==1||g!==v))throw new Error("sparseValues has incorrect shape "+c.shape+", should be [] or ["+v+"]");if(c.dtype!==d.dtype)throw new Error("sparseValues.dtype must match defaultValues.dtype")}(a,i,e,u),q.runKernelFunc(function(l){return l.sparseToDense(a,i,e,u)},{$sparseIndices:a,$sparseValues:i,$defaultValue:u})}}),NL=V({gatherND_:function(n,t){var e=I(t,"indices","gatherND","int32"),r=I(n,"x","gatherND");return q.runKernelFunc(function(a){return a.gatherND(r,e)},{x:r,indices:e},null,"GatherNd")}}),ML=V({diag_:function(n){var t=I(n,"x","diag").flatten(),e=n.shape.concat(n.shape);return q.runKernelFunc(function(r){return r.diag(t)},{$x:t}).reshape(e)}}),IL=V({dropout_:function(n,t,e,r){var a=I(n,"x","dropout");if(P(a.dtype==="float32",function(){return"x has to be a floating point tensor since it's going to be scaled, but got a "+a.dtype+" tensor instead."}),P(t>=0&&t<1,function(){return"rate must be a float in the range [0, 1), but got "+t+"."}),t===0)return n instanceof wt?a.clone():a;var i=function(c,f){if(f==null)return c.shape.slice();if(nn(c.shape,f))return f;if(c.shape.length===f.length){for(var d=[],v=0;v<c.shape.length;v++)f[v]==null&&c.shape[v]!=null?d.push(c.shape[v]):d.push(f[v]);return d}return f}(a,e),u=1-t,l=tE(i,0,1,"float32",r).add(u).floor().div(u);return a.mul(l)}});function i_(n,t,e){for(var r=1-n%2,a=new Float32Array(n),i=0;i<n;++i){var u=2*Math.PI*i/(n+r-1);a[i]=t-e*Math.cos(u)}return Pt(a,"float32")}var fg=V({hannWindow_:function(n){return i_(n,.5,.5)}}),o_=V({hammingWindow_:function(n){return i_(n,.54,.46)}}),hg=V({frame_:function(n,t,e,r,a){r===void 0&&(r=!1),a===void 0&&(a=0);for(var i=0,u=[];i+t<=n.size;)u.push(Xr(n,i,t)),i+=e;if(r)for(;i<n.size;){var l=i+t-n.size,c=Gt([Xr(n,i,t-l),Kr([l],a)]);u.push(c),i+=e}return u.length===0?pi([],[0,t]):Gt(u).as2D(u.length,t)}}),s_=V({stft_:function(n,t,e,r,a){var i;a===void 0&&(a=fg),r==null&&(i=t,r=Math.floor(Math.pow(2,Math.ceil(Math.log(i)/Math.log(2)))));for(var u=hg(n,t,e),l=wn(u,a(t)),c=[],f=0;f<u.shape[0];f++)c.push(cg(l.slice([f,0],[1,t]),r));return Gt(c)}}),FL=Object.freeze({hannWindow:fg,hammingWindow:o_,frame:hg,stft:s_}),bn,BL=function(n,t,e){return e===void 0&&(e=1),we(this,void 0,void 0,function(){var r,a,i,u,l,c,f,d,v,m,g,b,w,S;return Se(this,function(E){switch(E.label){case 0:return r=I(n,"predictions","inTopK"),a=I(t,"targets","inTopK"),P(r.rank>1,function(){return"inTopK() expects the predictions to be of rank 2 or higher, but got "+r.rank}),P(r.rank-1===a.rank,function(){return"predictions rank should be 1 larger than targets rank, but got predictions rank "+r.rank+" and targets rank "+a.rank}),at(r.shape.slice(0,r.shape.length-1),a.shape,"predictions's shape should be align with the targets' shape, except the last dimension."),i=r.shape[r.shape.length-1],P(e>0&&e<=i,function(){return"'k' passed to inTopK() must be > 0 && <= the predictions last dimension ("+i+"), but got "+e}),[4,r.data()];case 1:return u=E.sent(),[4,a.data()];case 2:for(l=E.sent(),c=[u.length/i,i],d=c[1],v=Ku("bool",f=c[0]),m=0;m<f;m++){for(g=m*d,b=u.subarray(g,g+d),w=[],S=0;S<b.length;S++)w.push({value:b[S],index:S});for(w.sort(function(_,R){return R.value-_.value}),v[m]=0,S=0;S<e;S++)if(w[S].index===l[m]){v[m]=1;break}}return n!==r&&r.dispose(),t!==a&&a.dispose(),[2,fn(v,a.shape,"bool")]}})})};(function(n){n[n.NONE=0]="NONE",n[n.MEAN=1]="MEAN",n[n.SUM=2]="SUM",n[n.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"})(bn||(bn={}));var PL=V({absoluteDifference_:function(n,t,e,r){r===void 0&&(r=bn.SUM_BY_NONZERO_WEIGHTS);var a=I(n,"labels","absoluteDifference"),i=I(t,"predictions","absoluteDifference"),u=null;e!=null&&(u=I(e,"weights","absoluteDifference")),at(a.shape,i.shape,"Error in absoluteDifference: ");var l=a.sub(i).abs();return Da(l,u,r)}}),Da=V({computeWeightedLoss_:function(n,t,e){e===void 0&&(e=bn.SUM_BY_NONZERO_WEIGHTS);var r=I(n,"losses","computeWeightedLoss"),a=null;t!=null&&(a=I(t,"weights","computeWeightedLoss"));var i=a==null?r:r.mul(a);if(e===bn.NONE)return i;if(e===bn.SUM)return i.sum();if(e===bn.MEAN){if(a==null)return i.mean();var u=r.size/a.size,l=i.sum().div(a.sum());return u>1?l.div(ge(u)):l}if(e===bn.SUM_BY_NONZERO_WEIGHTS){if(a==null)return i.sum().div(ge(r.size));var c=a.mul(Os(r.shape)).notEqual(ge(0)).sum().toFloat();return i.sum().div(c)}throw Error("Unknown reduction: "+e)}}),LL=V({cosineDistance_:function(n,t,e,r,a){a===void 0&&(a=bn.SUM_BY_NONZERO_WEIGHTS);var i=I(n,"labels","cosineDistance"),u=I(t,"predictions","cosineDistance"),l=null;r!=null&&(l=I(r,"weights","cosineDistance")),at(i.shape,u.shape,"Error in cosineDistance: ");var c=ge(1).sub(i.mul(u).sum(e,!0));return Da(c,l,a)}}),zL=V({hingeLoss_:function(n,t,e,r){r===void 0&&(r=bn.SUM_BY_NONZERO_WEIGHTS);var a=I(n,"labels","hingeLoss"),i=I(t,"predictions","hingeLoss"),u=null;e!=null&&(u=I(e,"weights","hingeLoss")),at(a.shape,i.shape,"Error in hingeLoss: ");var l=ge(1);a=ge(2).mul(a).sub(l);var c=l.sub(a.mul(i)).relu();return Da(c,u,r)}}),UL=V({huberLoss_:function(n,t,e,r,a){r===void 0&&(r=1),a===void 0&&(a=bn.SUM_BY_NONZERO_WEIGHTS);var i=I(n,"labels","huberLoss"),u=I(t,"predictions","huberLoss"),l=null;e!=null&&(l=I(e,"weights","huberLoss")),at(i.shape,u.shape,"Error in huberLoss: ");var c=ge(r),f=u.sub(i).abs(),d=UE(f,c),v=f.sub(d),m=ge(.5).mul(d.square()).add(c.mul(v));return Da(m,l,a)}}),HL=V({logLoss_:function(n,t,e,r,a){r===void 0&&(r=1e-7),a===void 0&&(a=bn.SUM_BY_NONZERO_WEIGHTS);var i=I(n,"labels","logLoss"),u=I(t,"predictions","logLoss"),l=null;e!=null&&(l=I(e,"weights","logLoss")),at(i.shape,u.shape,"Error in logLoss: ");var c=ge(1),f=ge(r),d=i.mul(u.add(f).log()).neg().sub(c.sub(i).mul(c.sub(u).add(f).log()));return Da(d,l,a)}}),VL=V({meanSquaredError_:function(n,t,e,r){r===void 0&&(r=bn.SUM_BY_NONZERO_WEIGHTS);var a=I(n,"labels","meanSquaredError"),i=I(t,"predictions","meanSquaredError"),u=null;e!=null&&(u=I(e,"weights","meanSquaredError")),at(a.shape,i.shape,"Error in meanSquaredError: ");var l=a.squaredDifference(i);return Da(l,u,r)}}),WL=V({sigmoidCrossEntropy_:function(n,t,e,r,a){r===void 0&&(r=0),a===void 0&&(a=bn.SUM_BY_NONZERO_WEIGHTS);var i=I(n,"multiClassLabels","sigmoidCrossEntropy"),u=I(t,"logits","sigmoidCrossEntropy"),l=null;if(e!=null&&(l=I(e,"weights","sigmoidCrossEntropy")),at(i.shape,u.shape,"Error in sigmoidCrossEntropy: "),r>0){var c=ge(r),f=ge(1),d=ge(.5);i=i.mul(f.sub(c)).add(d.mul(c))}var v=function(m,g){var b=I(m,"labels","sigmoidCrossEntropyWithLogits"),w=I(g,"logits","sigmoidCrossEntropyWithLogits");at(b.shape,w.shape,"Error in sigmoidCrossEntropyWithLogits: ");var S=w.relu(),E=w.mul(b),_=w.abs().neg().exp().log1p();return S.sub(E).add(_)}(i,u);return Da(v,l,a)}}),GL=V({softmaxCrossEntropy_:function(n,t,e,r,a){r===void 0&&(r=0),a===void 0&&(a=bn.SUM_BY_NONZERO_WEIGHTS);var i=I(n,"onehotLabels","softmaxCrossEntropy"),u=I(t,"logits","softmaxCrossEntropy"),l=null;if(e!=null&&(l=I(e,"weights","softmaxCrossEntropy")),at(i.shape,u.shape,"Error in softmaxCrossEntropy: "),r>0){var c=ge(r),f=ge(1),d=ge(i.shape[1]);i=i.mul(f.sub(c)).add(c.div(d))}var v=function(m,g,b){if(b===void 0&&(b=-1),b===-1&&(b=g.rank-1),b!==g.rank-1)throw Error("Softmax cross entropy along a non-last dimension is not yet supported. Labels / logits was rank "+g.rank+" and dim was "+b);return ah(function(w,S,E){var _=S.logSumExp([b],!0),R=S.toFloat().sub(_);return E([w,R]),{value:R.mul(w).neg().sum([b]),gradFunc:function(C,A){var D=A[0],O=A[1],F=Bn(C.shape,[b]);return[C.reshape(F).mul(D.toFloat().sub(O.exp())),C.reshape(F).mul(O.exp().sub(D.toFloat()))]}}})(m,g)}(i,u);return Da(v,l,a)}}),jL=Object.freeze({get Reduction(){return bn},absoluteDifference:PL,computeWeightedLoss:Da,cosineDistance:LL,hingeLoss:zL,huberLoss:UL,logLoss:HL,meanSquaredError:VL,sigmoidCrossEntropy:WL,softmaxCrossEntropy:GL});function Vw(n,t){return t===void 0&&(t=!1),q.tidy(function(){if(n.shape.length!==2)throw new Error("qr2d() requires a 2D Tensor, but got a "+n.shape.length+"D Tensor.");for(var e=n.shape[0],r=n.shape[1],a=eE(e),i=n.clone(),u=pi([[1]],[1,1]),l=u.clone(),c=e>=r?r:e,f=function(v){var m,g=i,b=l,w=a;m=q.tidy(function(){var S=i.slice([v,v],[e-v,1]),E=S.norm(),_=i.slice([v,v],[1,1]),R=pi([[-1]]).where(_.greater(0),pi([[1]])),C=_.sub(R.mul(E)),A=S.div(C);l=A.shape[0]===1?u.clone():u.concat(A.slice([1,0],[A.shape[0]-1,A.shape[1]]),0);var D=R.matMul(C).div(E).neg(),O=i.slice([v,0],[e-v,r]),F=D.mul(l);if(v===0)i=O.sub(F.matMul(l.transpose().matMul(O)));else{var N=O.sub(F.matMul(l.transpose().matMul(O)));i=i.slice([0,0],[v,r]).concat(N,0)}var B=a.slice([0,v],[e,a.shape[1]-v]);if(v===0)a=B.sub(B.matMul(l).matMul(F.transpose()));else{var H=B.sub(B.matMul(l).matMul(F.transpose()));a=a.slice([0,0],[e,v]).concat(H,1)}return[l,i,a]}),l=m[0],i=m[1],a=m[2],Fn([g,b,w])},d=0;d<c;++d)f(d);return!t&&e>r&&(a=a.slice([0,0],[e,r]),i=i.slice([0,0],[r,r])),[a,i]})}var qL=V({bandPart_:function(n,t,e){if(t%1!=0)throw new Error("bandPart(): numLower must be an integer, got "+t+".");if(e%1!=0)throw new Error("bandPart(): numUpper must be an integer, got "+e+".");var r=I(n,"a","bandPart");if(r.rank<2)throw new Error("bandPart(): Rank must be at least 2, got "+r.rank+".");var a=r.shape,i=r.shape.slice(-2),u=i[0],l=i[1];if(!(t<=u))throw new Error("bandPart(): numLower ("+t+") must not be greater than the number of rows ("+u+").");if(!(e<=l))throw new Error("bandPart(): numUpper ("+e+") must not be greater than the number of columns ("+l+").");t<0&&(t=u),e<0&&(e=l);var c=Df(0,u,1,"int32").reshape([-1,1]),f=Df(0,l,1,"int32"),d=$t(c,f),v=oh(d.lessEqual(ge(+t,"int32")),d.greaterEqual(ge(-e,"int32"))),m=mt([u,l],r.dtype);return Qn(jt(r.reshape([-1,u,l])).map(function(g){return no(v,g,m)})).reshape(a)}}),$L=V({gramSchmidt_:function(n){var t;if(Array.isArray(n)){t=!1,P(n!=null&&n.length>0,function(){return"Gram-Schmidt process: input must not be null, undefined, or empty"});for(var e=n[0].shape[0],r=function(c){P(n[c].shape[0]===e,function(){return"Gram-Schmidt: Non-unique lengths found in the input vectors: ("+n[c].shape[0]+" vs. "+e+")"})},a=1;a<n.length;++a)r(a)}else t=!0,n=Km(n,n.shape[0],0).map(function(c){return rE(c,[0])});P(n.length<=n[0].shape[0],function(){return"Gram-Schmidt: Number of vectors ("+n.length+") exceeds number of dimensions ("+n[0].shape[0]+")."});var i=[],u=n,l=function(c){i.push(q.tidy(function(){var f=u[c];if(c>0)for(var d=0;d<c;++d){var v=JE(i[d].mulStrict(f)).mul(i[d]);f=f.sub(v)}return f.div(r_(f,"euclidean"))}))};for(a=0;a<n.length;++a)l(a);return t?Qn(i,0):i}}),KL=V({qr_:function(n,t){if(t===void 0&&(t=!1),n.rank<2)throw new Error("qr() requires input tensor to have a rank >= 2, but got rank "+n.rank);if(n.rank===2)return Vw(n,t);var e=n.shape.slice(0,n.shape.length-2).reduce(function(u,l){return u*l}),r=jt(n.reshape([e,n.shape[n.shape.length-2],n.shape[n.shape.length-1]]),0),a=[],i=[];return r.forEach(function(u){var l=Vw(u,t),c=l[0],f=l[1];a.push(c),i.push(f)}),[Qn(a,0).reshape(n.shape),Qn(i,0).reshape(n.shape)]}}),XL=Object.freeze({bandPart:qL,gramSchmidt:$L,qr:KL});function ch(n,t,e,r,a,i){r==null&&(r=.5),a==null&&(a=Number.NEGATIVE_INFINITY),i==null&&(i=0);var u=n.shape[0];return e=Math.min(e,u),P(0<=r&&r<=1,function(){return"iouThreshold must be in [0, 1], but was '"+r+"'"}),P(n.rank===2,function(){return"boxes must be a 2D tensor, but was of rank '"+n.rank+"'"}),P(n.shape[1]===4,function(){return"boxes must have 4 columns, but 2nd dimension was "+n.shape[1]}),P(t.rank===1,function(){return"scores must be a 1D tensor"}),P(t.shape[0]===u,function(){return"scores has incompatible shape with boxes. Expected "+u+", but was "+t.shape[0]}),P(0<=i&&i<=1,function(){return"softNmsSigma must be in [0, 1], but was '"+i+"'"}),{maxOutputSize:e,iouThreshold:r,scoreThreshold:a,softNmsSigma:i}}var ZL=V({resizeBilinear_:function(n,t,e){e===void 0&&(e=!1);var r=I(n,"images","resizeBilinear");P(r.rank===3||r.rank===4,function(){return"Error in resizeBilinear: x must be rank 3 or 4, but got rank "+r.rank+"."}),P(t.length===2,function(){return"Error in resizeBilinear: new shape must 2D, but got shape "+t+"."});var a=r,i=!1;r.rank===3&&(i=!0,a=r.as4D(1,r.shape[0],r.shape[1],r.shape[2]));var u=t[0],l=t[1],c=q.runKernelFunc(function(f,d){return d([a]),f.resizeBilinear(a,u,l,e)},{x:a},function(f,d){return{x:function(){return q.runKernelFunc(function(v){return v.resizeBilinearBackprop(f,d[0],e)},{})}}},"ResizeBilinear",{alignCorners:e,newHeight:u,newWidth:l});return i?c.as3D(c.shape[1],c.shape[2],c.shape[3]):c}}),YL=V({resizeNearestNeighbor_:function(n,t,e){e===void 0&&(e=!1);var r=I(n,"images","resizeNearestNeighbor");P(r.rank===3||r.rank===4,function(){return"Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank "+r.rank+"."}),P(t.length===2,function(){return"Error in resizeNearestNeighbor: new shape must 2D, but got shape "+t+"."}),P(r.dtype==="float32"||r.dtype==="int32",function(){return"`images` must have `int32` or `float32` as dtype"});var a=r,i=!1;r.rank===3&&(i=!0,a=r.as4D(1,r.shape[0],r.shape[1],r.shape[2]));var u=t[0],l=t[1],c=q.runKernelFunc(function(f,d){return d([a]),f.resizeNearestNeighbor(a,u,l,e)},{batchImages:a},function(f,d){return{batchImages:function(){return q.runKernelFunc(function(v){return v.resizeNearestNeighborBackprop(f,d[0],e)},{})}}});return i?c.as3D(c.shape[1],c.shape[2],c.shape[3]):c}}),QL=V({nonMaxSuppression_:function(n,t,e,r,a){r===void 0&&(r=.5),a===void 0&&(a=Number.NEGATIVE_INFINITY);var i=I(n,"boxes","nonMaxSuppression"),u=I(t,"scores","nonMaxSuppression"),l=ch(i,u,e,r,a);e=l.maxOutputSize,r=l.iouThreshold,a=l.scoreThreshold;var c={maxOutputSize:e,iouThreshold:r,scoreThreshold:a};return q.runKernelFunc(function(f){return f.nonMaxSuppression(i,u,e,r,a)},{boxes:i,scores:u},null,"NonMaxSuppressionV3",c)}}),JL=function(n,t,e,r,a){return r===void 0&&(r=.5),a===void 0&&(a=Number.NEGATIVE_INFINITY),we(this,void 0,void 0,function(){var i,u,l,c,f,d,v;return Se(this,function(m){switch(m.label){case 0:return i=I(n,"boxes","nonMaxSuppressionAsync"),u=I(t,"scores","nonMaxSuppressionAsync"),l=ch(i,u,e,r,a),e=l.maxOutputSize,r=l.iouThreshold,a=l.scoreThreshold,[4,Promise.all([i.data(),u.data()])];case 1:return c=m.sent(),f=c[0],d=c[1],v=Qm(f,d,e,r,a),i!==n&&i.dispose(),u!==t&&u.dispose(),[2,v]}})})},ez=V({nonMaxSuppressionWithScore_:function(n,t,e,r,a,i){r===void 0&&(r=.5),a===void 0&&(a=Number.NEGATIVE_INFINITY),i===void 0&&(i=0);var u=I(n,"boxes","nonMaxSuppression"),l=I(t,"scores","nonMaxSuppression"),c=ch(u,l,e,r,a,i),f={maxOutputSize:e=c.maxOutputSize,iouThreshold:r=c.iouThreshold,scoreThreshold:a=c.scoreThreshold,softNmsSigma:i=c.softNmsSigma},d=q.runKernel("NonMaxSuppressionV5",{boxes:u,scores:l},f);return{selectedIndices:d[0],selectedScores:d[1]}}}),tz=function(n,t,e,r,a,i){return r===void 0&&(r=.5),a===void 0&&(a=Number.NEGATIVE_INFINITY),i===void 0&&(i=0),we(this,void 0,void 0,function(){var u,l,c,f,d,v,m;return Se(this,function(g){switch(g.label){case 0:return u=I(n,"boxes","nonMaxSuppressionAsync"),l=I(t,"scores","nonMaxSuppressionAsync"),c=ch(u,l,e,r,a,i),e=c.maxOutputSize,r=c.iouThreshold,a=c.scoreThreshold,i=c.softNmsSigma,[4,Promise.all([u.data(),l.data()])];case 1:return f=g.sent(),d=f[0],v=f[1],m=Jm(d,v,e,r,a,i),u!==n&&u.dispose(),l!==t&&l.dispose(),[2,m]}})})},nz=V({cropAndResize_:function(n,t,e,r,a,i){var u=I(n,"image","cropAndResize"),l=I(t,"boxes","cropAndResize","float32"),c=I(e,"boxInd","cropAndResize","int32");a=a||"bilinear",i=i||0;var f=l.shape[0];return P(u.rank===4,function(){return"Error in cropAndResize: image must be rank 4,but got rank "+u.rank+"."}),P(l.rank===2&&l.shape[1]===4,function(){return"Error in cropAndResize: boxes must be have size ["+f+",4] but had shape "+l.shape+"."}),P(c.rank===1&&c.shape[0]===f,function(){return"Error in cropAndResize: boxInd must be have size ["+f+"] but had shape "+l.shape+"."}),P(r.length===2,function(){return"Error in cropAndResize: cropSize must be of length 2, but got length "+r.length+"."}),P(r[0]>=1&&r[1]>=1,function(){return"cropSize must be atleast [1,1], but was "+r}),P(a==="bilinear"||a==="nearest",function(){return"method must be bilinear or nearest, but was "+a}),q.runKernelFunc(function(d,v){return d.cropAndResize(u,l,c,r,a,i)},{images:u,boxes:l,boxInd:c},null,"CropAndResize",{method:a,extrapolationValue:i,cropSize:r})}}),dg=Object.freeze({resizeBilinear:ZL,resizeNearestNeighbor:YL,nonMaxSuppression:QL,nonMaxSuppressionAsync:JL,nonMaxSuppressionWithScore:ez,nonMaxSuppressionWithScoreAsync:tz,cropAndResize:nz}),pg=function(n,t){return!(n>0)||t==="linear"},vg=function(n,t,e){if(e==null||e==="linear")return n;if(e==="relu")return n.mul(t.step());throw new Error("Gradient for activation "+e+" has not been implemented yet.")},mg=function(n,t){var e=t,r=qt(n.shape,t.shape);return r.length>0&&(e=e.sum(r)),e.reshape(n.shape)},gg=function(n,t,e){if(t==="linear")return n;if(t==="relu")return St(n);if(t==="elu")return e_(n);if(t==="relu6")return n_(n);if(t==="prelu")return t_(n,e);throw new Error("Unknown fused activation "+t+".")},rz=V({fusedMatMul_:function(n){var t,e=n.a,r=n.b,a=n.transposeA,i=a!==void 0&&a,u=n.transposeB,l=u!==void 0&&u,c=n.bias,f=n.activation,d=f===void 0?"linear":f,v=n.preluActivationWeights;if(pg(q.state.gradientDepth,d)===!1){var m=uh(e,r,i,l);return c!=null&&(m=qe(m,c)),gg(m,d,v)}var g=I(e,"a","fused matMul"),b=I(r,"b","fused matMul");t=_t(g,b),g=t[0],b=t[1];var w=i?g.shape[g.rank-2]:g.shape[g.rank-1],S=l?b.shape[b.rank-1]:b.shape[b.rank-2],E=i?g.shape[g.rank-1]:g.shape[g.rank-2],_=l?b.shape[b.rank-2]:b.shape[b.rank-1],R=g.shape.slice(0,-2),C=b.shape.slice(0,-2),A=Ee(R),D=Ee(C);P(g.rank>=2&&b.rank>=2&&g.rank===b.rank,function(){return"Error in fused matMul: inputs must have the same rank of at least 2, got ranks "+g.rank+" and "+b.rank+"."}),P(nn(R,C),function(){return"Error in fused matMul: outer dimensions ("+R+") and ("+C+") of Tensors with shapes "+g.shape+" and "+b.shape+" must match."}),P(w===S,function(){return"Error in fused matMul: inner shapes ("+w+") and ("+S+") of Tensors with shapes "+g.shape+" and "+b.shape+" and transposeA="+i+" and transposeB="+l+" must match."});var O,F,N=g.shape.slice(0,-2).concat([E,_]),B=i?g.as3D(A,w,E):g.as3D(A,E,w),H=l?b.as3D(D,_,S):b.as3D(D,S,_);c!=null&&Xe(N,(O=_t(O=I(c,"bias","fused matMul"),g)[0]).shape),v!=null&&(F=I(v,"prelu weights","fused matMul"));var U={a:B,b:H};c!=null&&(U.bias=O),v!=null&&(U.preluActivationWeights=F);var J=[B,H];return q.runKernelFunc(function(ee,te){var L=ee.fusedBatchMatMul({a:B,b:H,transposeA:i,transposeB:l,bias:O,activation:d,preluActivationWeights:F});return te([B,H,L]),L},U,function(ee,te){var L=te[0],W=te[1],$=te[2],ne=vg(ee,$,d),M={};return c!=null&&(M={bias:function(){return mg(O,ne)}}),Object.assign(i||l?!i&&l?{a:function(){return ne.matMul(W,!1,!1)},b:function(){return ne.matMul(L,!0,!1)}}:i&&!l?{a:function(){return W.matMul(ne,!1,!0)},b:function(){return L.matMul(ne,!1,!1)}}:{a:function(){return W.matMul(ne,!0,!0)},b:function(){return ne.matMul(L,!0,!0)}}:{a:function(){return ne.matMul(W,!1,!0)},b:function(){return L.matMul(ne,!0,!1)}},M)},"_FusedMatMul",{transposeA:i,transposeB:l,activation:d},J,[!0]).reshape(N)}}),az=V({fusedConv2d_:function(n){var t=n.x,e=n.filter,r=n.strides,a=n.pad,i=n.dataFormat,u=i===void 0?"NHWC":i,l=n.dilations,c=l===void 0?[1,1]:l,f=n.dimRoundingMode,d=n.bias,v=n.activation,m=v===void 0?"linear":v,g=n.preluActivationWeights;if(m=m||"linear",pg(q.state.gradientDepth,m)===!1){var b=yr(t,e,r,a,u,c,f);return d!=null&&(b=qe(b,d)),gg(b,m,g)}var w=I(t,"x","conv2d"),S=I(e,"filter","conv2d"),E=w,_=!1;w.rank===3&&(_=!0,E=w.as4D(1,w.shape[0],w.shape[1],w.shape[2])),P(E.rank===4,function(){return"Error in fused conv2d: input must be rank 4, but got rank "+E.rank+"."}),P(S.rank===4,function(){return"Error in fused conv2d: filter must be rank 4, but got rank "+S.rank+"."}),f!=null&&P(Nt(a),function(){return"Error in fused conv2d: pad must be an integer when using, dimRoundingMode "+f+" but got pad "+a+"."}),P(E.shape[3]===S.shape[2],function(){return"Error in conv2d: depth of input ("+E.shape[3]+") must match input depth for filter "+S.shape[2]+"."}),P(Pn(r,c),function(){return"Error in conv2D: Either strides or dilations must be 1. Got strides "+r+" and dilations '"+c+"'"}),P(u==="NHWC",function(){return"Error in conv2d: got dataFormat of "+u+" but only NHWC is currently supported."});var R,C,A=io(E.shape,S.shape,r,c,a,f);d!=null&&(R=_t(R=I(d,"bias","fused conv2d"),w)[0],Xe(A.outShape,R.shape)),g!=null&&(C=I(g,"prelu weights","fused conv2d"));var D={x:E,filter:S};d!=null&&(D.bias=R),g!=null&&(D.preluActivationWeights=C);var O=[S,E],F=q.runKernelFunc(function(N,B){var H=N.fusedConv2d({input:E,filter:S,convInfo:A,bias:R,activation:m,preluActivationWeights:C});return B([S,E,H]),H},D,function(N,B){var H=B,U=H[0],J=H[1],ee=H[2],te=vg(N,ee,m);P(_s(c),function(){return"Error in gradient of fused conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+c+"'"});var L={};return d!=null&&(L={bias:function(){return mg(R,te)}}),Object.assign({x:function(){return qE(J.shape,te,U,r,a)},filter:function(){return sg(J,te,U.shape,r,a)}},L)},"FusedConv2D",{convInfo:A,activation:m},O,[!0]);return _?F.as3D(F.shape[1],F.shape[2],F.shape[3]):F}}),iz=V({fusedDepthwiseConv2d_:function(n){var t=n.x,e=n.filter,r=n.strides,a=n.pad,i=n.dataFormat,u=i===void 0?"NHWC":i,l=n.dilations,c=l===void 0?[1,1]:l,f=n.dimRoundingMode,d=n.bias,v=n.activation,m=v===void 0?"linear":v,g=n.preluActivationWeights;if(pg(q.state.gradientDepth,m)===!1){var b=sh(t,e,r,a,u,c,f);return d!=null&&(b=qe(b,d)),gg(b,m,g)}var w=I(t,"x","depthwiseConv2d"),S=I(e,"filter","depthwiseConv2d"),E=w,_=!1;w.rank===3&&(_=!0,E=w.as4D(1,w.shape[0],w.shape[1],w.shape[2])),P(E.rank===4,function(){return"Error in fused depthwiseConv2d: input must be rank 4, but got rank "+E.rank+"."}),P(S.rank===4,function(){return"Error in fused depthwiseConv2d: filter must be rank 4, but got rank "+S.rank+"."}),P(E.shape[3]===S.shape[2],function(){return"Error in fused depthwiseConv2d: number of input channels ("+E.shape[3]+") must match the inChannels dimension in filter "+S.shape[2]+"."}),c==null&&(c=[1,1]),P(Pn(r,c),function(){return"Error in fused depthwiseConv2d: Either strides or dilations must be 1. Got strides "+r+" and dilations '"+c+"'"}),f!=null&&P(Nt(a),function(){return"Error in fused depthwiseConv2d: pad must be an integer when using dimRoundingMode "+f+" but got pad "+a+"."});var R,C,A=io(E.shape,S.shape,r,c,a,f,!0);d!=null&&(R=_t(R=I(d,"bias","fused conv2d"),w)[0],Xe(A.outShape,R.shape)),g!=null&&(C=I(g,"prelu weights","fused depthwiseConv2d"));var D={x:E,filter:S};d!=null&&(D.bias=R),g!=null&&(D.preluActivationWeights=C);var O=[S,E],F=q.runKernelFunc(function(N,B){var H=N.fusedDepthwiseConv2D({input:E,filter:S,convInfo:A,bias:R,activation:m,preluActivationWeights:C});return B([S,E,H]),H},D,function(N,B){P(_s(c),function(){return"Error in gradient of fused depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '"+c+"'"});var H=B[0],U=B[1],J=B[2],ee=vg(N,J,m),te={};return d!=null&&(te={bias:function(){return mg(R,ee)}}),Object.assign({x:function(){return $E(U.shape,ee,H,A)},filter:function(){return KE(U,ee,H.shape,A)}},te)},"FusedDepthwiseConv2D",{convInfo:A,activation:m},O,[!0]);return _?F.as3D(F.shape[1],F.shape[2],F.shape[3]):F}}),oz=Object.freeze({matMul:rz,conv2d:az,depthwiseConv2d:iz}),sz=Object.freeze({image:dg,linalg:XL,losses:jL,spectral:OL,fused:oz,signal:FL,square:HB,squaredDifference:OE,conv1d:ZP,conv2d:yr,conv3d:YP,depthwiseConv2d:sh,separableConv2d:ug,conv2dTranspose:QP,conv3dTranspose:JP,op:V,batchNormalization2d:gP,batchNormalization3d:yP,batchNormalization4d:bP,batchNormalization:xP,batchNorm:BE,batchNorm2d:wP,batchNorm3d:SP,batchNorm4d:EP,booleanMaskAsync:XP,complex:ln,real:dr,imag:Wr,concat:Gt,concat1d:oI,concat2d:sI,concat3d:uI,concat4d:lI,split:Km,matMul:uh,dot:eL,outerProduct:tL,reverse:dl,reverse1d:nL,reverse2d:rL,reverse3d:aL,reverse4d:iL,maxPool:Jt,avgPool:pl,pool:oL,maxPool3d:sL,avgPool3d:uL,slice:Xr,slice1d:lL,slice2d:cL,slice3d:YE,slice4d:fL,abs:VB,acos:WB,acosh:GB,asin:jB,asinh:qB,atan:$B,atanh:KB,ceil:XB,clipByValue:ag,cos:ZB,cosh:YB,erf:QB,exp:fm,expm1:JB,floor:eP,log:tP,log1p:nP,logSigmoid:rP,neg:Pf,reciprocal:aP,round:iP,rsqrt:kE,sigmoid:NE,sign:oP,isNaN:sP,isInf:uP,isFinite:lP,sin:cP,sinh:fP,softplus:hP,sqrt:dP,step:pP,tan:vP,tanh:mP,all:hL,any:dL,argMax:pL,argMin:vL,logSumExp:mL,max:lh,mean:gL,min:yL,moments:bL,sum:JE,prod:xL,equal:HE,equalStrict:zP,greater:UP,greaterEqual:VE,greaterEqualStrict:HP,greaterStrict:VP,less:WP,lessEqual:GP,lessEqualStrict:jP,lessStrict:qP,notEqual:$P,notEqualStrict:KP,add:qe,addN:RP,addStrict:AP,atan2:TP,div:_r,divNoNan:DP,divStrict:OP,floorDiv:zE,maximum:ig,maximumStrict:kP,minimum:UE,minimumStrict:NP,mod:MP,modStrict:IP,mul:wn,mulStrict:FP,pow:Lf,powStrict:BP,squaredDifferenceStrict:PP,sub:$t,subStrict:LP,elu:e_,leakyRelu:wL,prelu:t_,relu:St,relu6:n_,selu:SL,logicalAnd:oh,logicalNot:_P,logicalOr:PE,logicalXor:CP,where:no,whereAsync:LE,buffer:Pe,print:yI,batchToSpaceND:JS,broadcastTo:bI,cast:xI,clone:wI,cumsum:SI,depthToSpace:EI,expandDims:hr,eye:eE,multinomial:_I,oneHot:sm,pad:ao,pad1d:CI,pad2d:RI,pad3d:AI,pad4d:TI,rand:DI,randomNormal:OI,randomGamma:kI,randomUniform:tE,reshape:Cr,spaceToBatchND:nE,squeeze:rE,stack:Qn,tile:ls,truncatedNormal:NI,unstack:jt,setdiff1dAsync:MI,fill:Kr,linspace:iI,ones:Os,range:Df,scalar:ge,tensor:fn,tensor1d:Pt,tensor2d:pi,tensor3d:$m,tensor4d:Mn,tensor5d:nI,tensor6d:rI,variable:aI,zeros:mt,onesLike:QS,zerosLike:Ye,transpose:yi,softmax:Ta,logSoftmax:UI,localResponseNormalization:EL,norm:r_,gather:og,unsortedSegmentSum:WE,basicLSTMCell:_L,multiRNNCell:CL,movingAverage:RL,stridedSlice:AL,topk:TL,scatterND:DL,fft:lg,ifft:zf,rfft:cg,irfft:a_,sparseToDense:kL,gatherND:NL,diag:ML,dropout:IL,hannWindow:fg,hammingWindow:o_,frame:hg,stft:s_,inTopKAsync:BL});function he(n,t){Array.isArray(n)||(n=[n]),n.forEach(function(e){e!=null&&P(e.dtype!=="complex64",function(){return t+" does not support complex64 tensors."})})}function pv(n,t,e,r){if(e==="linear")return n.linear(t);if(e==="relu")return n.relu(t);if(e==="elu")return n.elu(t);if(e==="relu6")return n.relu6(t);if(e==="prelu")return n.prelu(t,r);throw new Error("Activation "+e+" has not been implemented for the CPU backend.")}var uz=function(n){function t(){var e=n.call(this)||this;return e.blockSize=48,e.firstUse=!0,e.data=new cE(e,q),e}return Dr(t,n),t.prototype.write=function(e,r,a){this.firstUse&&(this.firstUse=!1,ue().get("IS_NODE")&&Af(`
============================
Hi there 👋. Looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, which binds to TensorFlow C++, by running npm i @tensorflow/tfjs-node, or npm i @tensorflow/tfjs-node-gpu if you have CUDA. Then call require('@tensorflow/tfjs-node'); (-gpu suffix for CUDA) at the start of your program. Visit https://github.com/tensorflow/tfjs-node for more details.
============================`));var i={};return this.data.set(i,{values:e,dtype:a}),i},t.prototype.move=function(e,r,a,i){this.data.set(e,{values:r,dtype:i})},t.prototype.numDataIds=function(){return this.data.numDataIds()},t.prototype.read=function(e){return we(this,void 0,void 0,function(){return Se(this,function(r){return[2,this.readSync(e)]})})},t.prototype.readSync=function(e){var r=this.data.get(e),a=r.dtype,i=r.complexTensors;return a==="complex64"?cm(this.readSync(i.real.dataId),this.readSync(i.imag.dataId)):this.data.get(e).values},t.prototype.bufferSync=function(e){var r=this.readSync(e.dataId),a=r;if(e.dtype==="string")try{a=r.map(function(i){return _f(i)})}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return Pe(e.shape,e.dtype,a)},t.prototype.makeOutput=function(e,r,a){var i=this.write(e,r,a);return q.makeTensorFromDataId(i,r,a,this)},t.prototype.disposeData=function(e){if(this.data.has(e)){var r=this.data.get(e).complexTensors;r!=null&&(r.real.dispose(),r.imag.dispose()),this.data.delete(e)}},t.prototype.time=function(e){return we(this,void 0,void 0,function(){var r;return Se(this,function(a){return r=Hr(),e(),[2,{kernelMs:Hr()-r}]})})},t.prototype.memory=function(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}},t.prototype.complex=function(e,r){var a=this.makeOutput(null,e.shape,"complex64");return this.data.get(a.dataId).complexTensors={real:q.keep(e.clone()),imag:q.keep(r.clone())},a},t.prototype.real=function(e){return this.data.get(e.dataId).complexTensors.real.clone()},t.prototype.imag=function(e){return this.data.get(e.dataId).complexTensors.imag.clone()},t.prototype.slice=function(e,r,a){if(he(e,"slice"),uE(e.shape,r,a)){var i=lE(r,e.strides),u=Ee(a);return fn(this.readSync(e.dataId).subarray(i,i+u),a,e.dtype)}for(var l=Pe(a,e.dtype),c=this.bufferSync(e),f=0;f<l.size;++f){var d=l.indexToLoc(f).map(function(v,m){return v+r[m]});l.values[f]=c.get.apply(c,d)}return l.toTensor()},t.prototype.stridedSlice=function(e,r,a,i){he(e,"stridedSlice");var u=Zm(r,a,i);if(u.some(function(g){return g===0}))return fn([],u);for(var l=Pe(u,e.dtype),c=this.bufferSync(e),f=0;f<l.size;f++){for(var d=l.indexToLoc(f),v=new Array(d.length),m=0;m<v.length;m++)v[m]=d[m]*i[m]+r[m];l.set.apply(l,[c.get.apply(c,v)].concat(d))}return l.toTensor()},t.prototype.diag=function(e){for(var r=this.readSync(e.dataId),a=Pe([e.size,e.size],e.dtype),i=a.values,u=0;u<r.length;u++)i[u*e.size+u]=r[u];return a.toTensor()},t.prototype.unstack=function(e,r){for(var a=e.shape[r],i=new Array(e.rank-1),u=0,l=0;l<e.rank;l++)l!==r&&(i[u++]=e.shape[l]);var c=new Array(e.rank).fill(0),f=e.shape.slice();f[r]=1;var d=new Array(a);for(l=0;l<d.length;l++)c[r]=l,d[l]=this.slice(e,c,f).reshape(i);return d},t.prototype.reverse=function(e,r){he(e,"reverse");for(var a=Pe(e.shape,e.dtype),i=this.bufferSync(e),u=function(c){var f=a.indexToLoc(c),d=f.slice();r.forEach(function(v){return d[v]=e.shape[v]-1-d[v]}),a.set.apply(a,[i.get.apply(i,d)].concat(f))},l=0;l<a.size;l++)u(l);return a.toTensor()},t.prototype.concat=function(e,r){var a=this;if(e[0].dtype==="complex64"){var i=e.map(function(g){return dr(g)}),u=e.map(function(g){return Wr(g)});return ln(this.concat(i,r),this.concat(u,r))}var l=e.map(function(g){var b=Ee(g.shape.slice(r));return g.as2D(-1,b)}),c=Es(l.map(function(g){return g.shape}),1),f=Pe(c,e[0].dtype).values;if(l[0].shape[0]===1){var d=0;l.forEach(function(g){f.set(a.readSync(g.dataId),d),d+=g.size})}else{var v=0;l.forEach(function(g){for(var b=a.readSync(g.dataId),w=0,S=0;S<g.shape[0];++S)for(var E=S*c[1]+v,_=0;_<g.shape[1];++_)f[E+_]=b[w++];v+=g.shape[1]})}var m=Es(e.map(function(g){return g.shape}),r);return fn(f,m,e[0].dtype)},t.prototype.neg=function(e){return he(e,"neg"),this.multiply(ge(-1),e)},t.prototype.add=function(e,r){return e.dtype==="complex64"||r.dtype==="complex64"?this.broadcastedBinaryComplexOp(e.cast("complex64"),r.cast("complex64"),function(a,i,u,l){return{real:a+u,imag:i+l}}):this.broadcastedBinaryOp(e,r,cn(e.dtype,r.dtype),function(a,i){return a+i})},t.prototype.addN=function(e){var r=this;he(e,"addN");for(var a=e.map(function(d){return r.readSync(d.dataId)}),i=Pe(e[0].shape,e[0].dtype),u=i.values,l=0;l<e.length;l++)for(var c=a[l],f=0;f<u.length;f++)u[f]+=c[f];return i.toTensor()},t.prototype.softmax=function(e,r){var a=Kt([r],e.shape),i=this.max(e,a),u=Bn(i.shape,a),l=this.subtract(e,i.reshape(u)),c=this.exp(l),f=this.sum(c,a).reshape(u);return this.realDivide(c,f)},t.prototype.subtract=function(e,r){return e.dtype==="complex64"||r.dtype==="complex64"?this.broadcastedBinaryComplexOp(e.cast("complex64"),r.cast("complex64"),function(a,i,u,l){return{real:a-u,imag:i-l}}):this.broadcastedBinaryOp(e,r,cn(e.dtype,r.dtype),function(a,i){return a-i})},t.prototype.pow=function(e,r){return he([e,r],"pow"),this.broadcastedBinaryOp(e,r,e.dtype,function(a,i){return Math.pow(a,i)})},t.prototype.batchMatMul=function(e,r,a,i){he([e,r],"matMul");for(var u=a?e.shape[1]:e.shape[2],l=a?e.shape[2]:e.shape[1],c=i?r.shape[1]:r.shape[2],f=e.shape[0],d=this.readSync(e.dataId),v=this.readSync(r.dataId),m=a?[e.strides[0],1,e.strides[1]]:[e.strides[0],e.strides[1],1],g=m[0],b=m[1],w=m[2],S=i?[1,r.strides[1],r.strides[0]]:[r.strides[1],1,r.strides[0]],E=S[0],_=S[1],R=S[2],C=l*c,A=Pe([f,l,c],e.dtype),D=A.values,O=this.blockSize,F=0;F<f;F++)for(var N=0;N<l;N+=O)for(var B=0;B<c;B+=O)for(var H=0;H<u;H+=O)for(var U=Math.min(N+O,l),J=Math.min(B+O,c),ee=Math.min(H+O,u),te=N;te<U;te++)for(var L=B;L<J;L++){for(var W=0,$=H;$<ee;$++)W+=d[F*g+te*b+$*w]*v[$*E+L*_+F*R];D[F*C+(te*c+L)]+=W}return A.toTensor()},t.prototype.fusedBatchMatMul=function(e){var r=e.a,a=e.b,i=e.transposeA,u=e.transposeB,l=e.bias,c=e.activation,f=e.preluActivationWeights,d=this.batchMatMul(r,a,i,u);return l&&(d=this.add(d,l)),c&&(d=pv(this,d,c,f)),d},t.prototype.multiply=function(e,r){return e.dtype==="complex64"||r.dtype==="complex64"?this.broadcastedBinaryComplexOp(e.cast("complex64"),r.cast("complex64"),function(a,i,u,l){return{real:a*u-i*l,imag:a*l+i*u}}):this.broadcastedBinaryOp(e,r,cn(e.dtype,r.dtype),function(a,i){return a*i})},t.prototype.realDivide=function(e,r){return he([e,r],"realDivide"),this.broadcastedBinaryOp(e,r,"float32",function(a,i){return a/i})},t.prototype.floorDiv=function(e,r){return he([e,r],"floorDiv"),this.broadcastedBinaryOp(e,r,"int32",function(a,i){return Math.floor(a/i)})},t.prototype.sum=function(e,r){he(e,"sum"),$n("sum",r,e.rank);for(var a=mn(e.shape,r),i=a[0],u=a[1],l=mt(i,cn(e.dtype,"int32")),c=Ee(u),f=this.readSync(l.dataId),d=this.readSync(e.dataId),v=0;v<f.length;++v){for(var m=v*c,g=0,b=0;b<c;++b)g+=d[m+b];f[v]=g}return l},t.prototype.prod=function(e,r){he(e,"sum");for(var a=mn(e.shape,r),i=a[0],u=a[1],l=mt(i,cn(e.dtype,"int32")),c=Ee(u),f=this.readSync(l.dataId),d=this.readSync(e.dataId),v=0;v<f.length;++v){for(var m=v*c,g=1,b=0;b<c;++b)g*=d[m+b];f[v]=g}return l},t.prototype.unsortedSegmentSum=function(e,r,a){he(e,"unsortedSegmentSum");for(var i=[],u=e.rank-r.rank,l=0;l<u;++l)r=r.expandDims(l+1);for(l=0;l<a;++l){var c=ge(l,"int32"),f=HE(c,r).asType("float32").mul(e).sum(0);i.push(f)}return Qn(i)},t.prototype.argMin=function(e,r){he(e,"argMin");var a=[r];$n("argMin",a,e.rank);for(var i=mn(e.shape,a),u=i[0],l=i[1],c=mt(u,"int32"),f=Ee(l),d=this.readSync(c.dataId),v=this.readSync(e.dataId),m=0;m<d.length;++m){for(var g=m*f,b=v[g],w=0,S=0;S<f;++S){var E=v[g+S];E<b&&(b=E,w=S)}d[m]=w}return c},t.prototype.argMax=function(e,r){he(e,"argMax");var a=[r];$n("argMax",a,e.rank);for(var i=mn(e.shape,a),u=i[0],l=i[1],c=mt(u,"int32"),f=Ee(l),d=this.readSync(c.dataId),v=this.readSync(e.dataId),m=0;m<d.length;++m){for(var g=m*f,b=v[g],w=0,S=0;S<f;++S){var E=v[g+S];E>b&&(b=E,w=S)}d[m]=w}return c},t.prototype.cumsum=function(e,r,a,i){if(he(e,"cumsum"),r!==e.rank-1)throw new Error("backend.cumsum in CPU expects an inner-most axis="+(e.rank-1)+" but got axis="+r);for(var u=cn(e.dtype,"int32"),l=mt(e.shape,u),c=this.readSync(l.dataId),f=this.readSync(e.dataId),d=e.shape[e.rank-1],v=i?function(S,E){return S+d-E-1}:function(S,E){return S+E},m=0;m<f.length;m+=d)for(var g=0;g<d;g++){var b=v(m,g);if(g===0)c[b]=a?0:f[b];else{var w=v(m,g-1);c[b]=a?f[w]+c[w]:f[b]+c[w]}}return l},t.prototype.equal=function(e,r){return he([e,r],"equal"),this.broadcastedBinaryOp(e,r,"bool",function(a,i){return a===i?1:0})},t.prototype.notEqual=function(e,r){return he([e,r],"notEqual"),this.broadcastedBinaryOp(e,r,"bool",function(a,i){return a!==i?1:0})},t.prototype.less=function(e,r){return he([e,r],"less"),this.broadcastedBinaryOp(e,r,"bool",function(a,i){return a<i?1:0})},t.prototype.lessEqual=function(e,r){return he([e,r],"lessEqual"),this.broadcastedBinaryOp(e,r,"bool",function(a,i){return a<=i?1:0})},t.prototype.greater=function(e,r){return he([e,r],"greater"),this.broadcastedBinaryOp(e,r,"bool",function(a,i){return a>i?1:0})},t.prototype.greaterEqual=function(e,r){return he([e,r],"greaterEqual"),this.broadcastedBinaryOp(e,r,"bool",function(a,i){return a>=i?1:0})},t.prototype.logicalNot=function(e){he(e,"logicalNot");for(var r=this.readSync(e.dataId),a=new Uint8Array(r.length),i=0;i<r.length;++i)a[i]=r[i]?0:1;return this.makeOutput(a,e.shape,"bool")},t.prototype.logicalAnd=function(e,r){return he([e,r],"logicalAnd"),this.broadcastedBinaryOp(e,r,"bool",function(a,i){return a&&i})},t.prototype.logicalOr=function(e,r){return he([e,r],"logicalOr"),this.broadcastedBinaryOp(e,r,"bool",function(a,i){return a||i})},t.prototype.select=function(e,r,a){he([e,r,a],"select");for(var i=this.readSync(e.dataId),u=this.readSync(r.dataId),l=this.readSync(a.dataId),c=mt(r.shape,cn(r.dtype,a.dtype)),f=this.readSync(c.dataId),d=0,v=e.rank===0||e.rank>1||r.rank===1?1:Ee(r.shape.slice(1)),m=0;m<i.length;m++)for(var g=0;g<v;g++)i[m]===1?f[d++]=u[m]:f[d++]=l[m];return c},t.prototype.where=function(e){he([e],"where");var r=this.readSync(e.dataId);return eg(e.shape,r)},t.prototype.topk=function(e,r,a){return he(e,"topk"),yE(this.readSync(e.dataId),e.shape,e.dtype,r)},t.prototype.min=function(e,r){he(e,"min"),$n("min",r,e.rank);for(var a=mn(e.shape,r),i=a[0],u=a[1],l=mt(i,e.dtype),c=Ee(u),f=this.readSync(l.dataId),d=this.readSync(e.dataId),v=0;v<f.length;++v){for(var m=v*c,g=d[m],b=0;b<c;++b){var w=d[m+b];w<g&&(g=w)}f[v]=g}return l},t.prototype.minimum=function(e,r){return he([e,r],"minimum"),this.broadcastedBinaryOp(e,r,e.dtype,function(a,i){return Math.min(a,i)})},t.prototype.mod=function(e,r){return he([e,r],"mod"),this.broadcastedBinaryOp(e,r,e.dtype,function(a,i){var u=a%i;return a<0&&i<0||a>=0&&i>=0?u:(u+i)%i})},t.prototype.max=function(e,r){he(e,"max"),$n("max",r,e.rank);for(var a=mn(e.shape,r),i=a[0],u=a[1],l=mt(i,e.dtype),c=Ee(u),f=this.readSync(l.dataId),d=this.readSync(e.dataId),v=0;v<f.length;++v){for(var m=v*c,g=d[m],b=0;b<c;++b){var w=d[m+b];w>g&&(g=w)}f[v]=g}return l},t.prototype.maximum=function(e,r){return he([e,r],"maximum"),this.broadcastedBinaryOp(e,r,e.dtype,function(a,i){return Math.max(a,i)})},t.prototype.all=function(e,r){he(e,"all"),$n("all",r,e.rank);for(var a=mn(e.shape,r),i=a[0],u=a[1],l=mt(i,e.dtype),c=Ee(u),f=this.readSync(l.dataId),d=this.readSync(e.dataId),v=0;v<f.length;++v){for(var m=v*c,g=d[m],b=0;b<c;++b){var w=d[m+b];g=g&&w}f[v]=g}return l},t.prototype.any=function(e,r){he(e,"any"),$n("any",r,e.rank);for(var a=mn(e.shape,r),i=a[0],u=a[1],l=mt(i,e.dtype),c=Ee(u),f=this.readSync(l.dataId),d=this.readSync(e.dataId),v=0;v<f.length;++v){for(var m=v*c,g=d[m],b=0;b<c;++b){var w=d[m+b];g=g||w}f[v]=g}return l},t.prototype.squaredDifference=function(e,r){return he([e,r],"squaredDifference"),this.broadcastedBinaryOp(e,r,e.dtype,function(a,i){var u=a-i;return u*u})},t.prototype.ceil=function(e){he(e,"ceil");for(var r=this.readSync(e.dataId),a=new Float32Array(r.length),i=0;i<r.length;++i)a[i]=Math.ceil(r[i]);return this.makeOutput(a,e.shape,"float32")},t.prototype.floor=function(e){he(e,"floor");for(var r=this.readSync(e.dataId),a=new Float32Array(r.length),i=0;i<r.length;++i)a[i]=Math.floor(r[i]);return this.makeOutput(a,e.shape,"float32")},t.prototype.sign=function(e){he(e,"x");for(var r=this.readSync(e.dataId),a=new Float32Array(r.length),i=0;i<r.length;++i)r[i]<0?a[i]=-1:r[i]>0?a[i]=1:a[i]=0;return this.makeOutput(a,e.shape,"float32")},t.prototype.isNaN=function(e){he(e,"x");for(var r=this.readSync(e.dataId),a=new Uint8Array(r.length),i=0;i<r.length;++i)Number.isNaN(r[i])&&(a[i]=1);return this.makeOutput(a,e.shape,"bool")},t.prototype.isInf=function(e){he(e,"x");for(var r=this.readSync(e.dataId),a=new Uint8Array(r.length),i=0;i<r.length;++i)Math.abs(r[i])===1/0&&(a[i]=1);return this.makeOutput(a,e.shape,"bool")},t.prototype.isFinite=function(e){he(e,"x");for(var r=this.readSync(e.dataId),a=new Uint8Array(r.length),i=0;i<r.length;++i)Number.isFinite(r[i])&&(a[i]=1);return this.makeOutput(a,e.shape,"bool")},t.prototype.round=function(e){he(e,"round");for(var r=this.readSync(e.dataId),a=new Float32Array(r.length),i=0;i<r.length;++i){var u=Math.floor(r[i]);r[i]-u<.5?a[i]=Math.floor(r[i]):r[i]-u>.5?a[i]=Math.ceil(r[i]):a[i]=u%2==0?u:u+1}return this.makeOutput(a,e.shape,"float32")},t.prototype.exp=function(e){he(e,"exp");for(var r=this.readSync(e.dataId),a=new Float32Array(r.length),i=0;i<r.length;++i)a[i]=Math.exp(r[i]);return this.makeOutput(a,e.shape,"float32")},t.prototype.expm1=function(e){he(e,"expm1");for(var r=this.readSync(e.dataId),a=new Float32Array(r.length),i=0;i<r.length;++i)a[i]=Math.expm1(r[i]);return this.makeOutput(a,e.shape,"float32")},t.prototype.log=function(e){he(e,"log");for(var r=this.readSync(e.dataId),a=new Float32Array(r.length),i=0;i<r.length;++i){var u=r[i];a[i]=Math.log(u)}return this.makeOutput(a,e.shape,"float32")},t.prototype.log1p=function(e){he(e,"log1p");for(var r=this.readSync(e.dataId),a=new Float32Array(r.length),i=0;i<r.length;++i){var u=r[i];a[i]=Math.log1p(u)}return this.makeOutput(a,e.shape,"float32")},t.prototype.sqrt=function(e){he(e,"sqrt");for(var r=this.readSync(e.dataId),a=new Float32Array(r.length),i=0;i<r.length;++i){var u=r[i];a[i]=Math.sqrt(u)}return this.makeOutput(a,e.shape,"float32")},t.prototype.rsqrt=function(e){he(e,"rsqrt");for(var r=this.readSync(e.dataId),a=new Float32Array(r.length),i=0;i<r.length;++i){var u=r[i];a[i]=1/Math.sqrt(u)}return this.makeOutput(a,e.shape,"float32")},t.prototype.reciprocal=function(e){he(e,"reciprocal");for(var r=this.readSync(e.dataId),a=new Float32Array(r.length),i=0;i<r.length;++i)a[i]=1/r[i];return this.makeOutput(a,e.shape,"float32")},t.prototype.linear=function(e){return e},t.prototype.relu=function(e){he(e,"relu");for(var r=mt(e.shape,e.dtype),a=this.readSync(r.dataId),i=this.readSync(e.dataId),u=0;u<i.length;++u)a[u]=Math.max(0,i[u]);return r},t.prototype.relu6=function(e){he(e,"relu");for(var r=mt(e.shape,e.dtype),a=this.readSync(r.dataId),i=this.readSync(e.dataId),u=0;u<i.length;++u)a[u]=Math.min(Math.max(0,i[u]),6);return r},t.prototype.prelu=function(e,r){return he([e,r],"prelu"),this.broadcastedBinaryOp(e,r,e.dtype,function(a,i){return a<0?i*a:a})},t.prototype.elu=function(e){he(e,"elu");for(var r=new Float32Array(e.size),a=this.readSync(e.dataId),i=0;i<a.length;++i){var u=a[i];r[i]=u>=0?u:Math.exp(u)-1}return this.makeOutput(r,e.shape,"float32")},t.prototype.eluDer=function(e,r){he([e,r],"eluDer");for(var a=new Float32Array(r.size),i=this.readSync(r.dataId),u=this.readSync(e.dataId),l=0;l<i.length;++l){var c=i[l];a[l]=c>=1?u[l]:u[l]*(c+1)}return this.makeOutput(a,r.shape,"float32")},t.prototype.selu=function(e){he(e,"selu");for(var r=ng,a=rg,i=new Float32Array(e.size),u=this.readSync(e.dataId),l=0;l<u.length;++l){var c=u[l];i[l]=c>=0?a*c:r*(Math.exp(c)-1)}return this.makeOutput(i,e.shape,"float32")},t.prototype.clip=function(e,r,a){he(e,"clip");for(var i=new Float32Array(e.size),u=this.readSync(e.dataId),l=0;l<u.length;++l){var c=u[l];i[l]=c>a?a:c<r?r:c}return this.makeOutput(i,e.shape,"float32")},t.prototype.abs=function(e){for(var r=new Float32Array(e.size),a=this.readSync(e.dataId),i=0;i<a.length;++i)r[i]=Math.abs(a[i]);return this.makeOutput(r,e.shape,"float32")},t.prototype.complexAbs=function(e){for(var r=new Float32Array(e.size),a=this.readSync(e.dataId),i=0;i<e.size;++i){var u=a[2*i],l=a[2*i+1];r[i]=Math.hypot(u,l)}return this.makeOutput(r,e.shape,"float32")},t.prototype.int=function(e){he(e,"int");for(var r=new Int32Array(e.size),a=this.readSync(e.dataId),i=0;i<a.length;++i)r[i]=a[i];return this.makeOutput(r,e.shape,"int32")},t.prototype.sigmoid=function(e){he(e,"sigmoid");for(var r=new Float32Array(e.size),a=this.readSync(e.dataId),i=0;i<a.length;++i)r[i]=1/(1+Math.exp(-a[i]));return this.makeOutput(r,e.shape,"float32")},t.prototype.softplus=function(e){he(e,"softplus");for(var r=Math.log(11920928955078125e-23)+2,a=new Float32Array(e.size),i=this.readSync(e.dataId),u=0;u<i.length;++u){var l=i[u]>-r,c=i[u]<r,f=Math.exp(i[u]),d=void 0;d=c?f:l?i[u]:Math.log(1+f),a[u]=d}return this.makeOutput(a,e.shape,"float32")},t.prototype.sin=function(e){he(e,"sin");for(var r=new Float32Array(e.size),a=this.readSync(e.dataId),i=0;i<a.length;++i)r[i]=Math.sin(a[i]);return this.makeOutput(r,e.shape,"float32")},t.prototype.cos=function(e){he(e,"cos");for(var r=new Float32Array(e.size),a=this.readSync(e.dataId),i=0;i<a.length;++i)r[i]=Math.cos(a[i]);return this.makeOutput(r,e.shape,"float32")},t.prototype.tan=function(e){he(e,"tan");for(var r=new Float32Array(e.size),a=this.readSync(e.dataId),i=0;i<a.length;++i)r[i]=Math.tan(a[i]);return this.makeOutput(r,e.shape,"float32")},t.prototype.asin=function(e){he(e,"asin");for(var r=new Float32Array(e.size),a=this.readSync(e.dataId),i=0;i<a.length;++i)r[i]=Math.asin(a[i]);return this.makeOutput(r,e.shape,"float32")},t.prototype.acos=function(e){he(e,"acos");for(var r=new Float32Array(e.size),a=this.readSync(e.dataId),i=0;i<a.length;++i)r[i]=Math.acos(a[i]);return this.makeOutput(r,e.shape,"float32")},t.prototype.atan=function(e){he(e,"atan");for(var r=new Float32Array(e.size),a=this.readSync(e.dataId),i=0;i<a.length;++i)r[i]=Math.atan(a[i]);return this.makeOutput(r,e.shape,"float32")},t.prototype.atan2=function(e,r){return he([e,r],"atan2"),this.broadcastedBinaryOp(e,r,e.dtype,function(a,i){return Math.atan2(a,i)})},t.prototype.sinh=function(e){he(e,"sinh");for(var r=new Float32Array(e.size),a=this.readSync(e.dataId),i=0;i<a.length;++i)r[i]=Math.sinh(a[i]);return this.makeOutput(r,e.shape,"float32")},t.prototype.cosh=function(e){he(e,"cosh");for(var r=new Float32Array(e.size),a=this.readSync(e.dataId),i=0;i<a.length;++i)r[i]=Math.cosh(a[i]);return this.makeOutput(r,e.shape,"float32")},t.prototype.tanh=function(e){he(e,"tanh");for(var r=new Float32Array(e.size),a=this.readSync(e.dataId),i=0;i<a.length;++i)r[i]=lM(a[i]);return this.makeOutput(r,e.shape,"float32")},t.prototype.asinh=function(e){he(e,"asinh");for(var r=new Float32Array(e.size),a=this.readSync(e.dataId),i=0;i<a.length;++i)r[i]=Math.asinh(a[i]);return this.makeOutput(r,e.shape,"float32")},t.prototype.acosh=function(e){he(e,"acosh");for(var r=new Float32Array(e.size),a=this.readSync(e.dataId),i=0;i<a.length;++i)r[i]=Math.acosh(a[i]);return this.makeOutput(r,e.shape,"float32")},t.prototype.atanh=function(e){he(e,"atanh");for(var r=new Float32Array(e.size),a=this.readSync(e.dataId),i=0;i<a.length;++i)r[i]=Math.atanh(a[i]);return this.makeOutput(r,e.shape,"float32")},t.prototype.erf=function(e){he(e,"erf");for(var r=new Float32Array(e.size),a=this.readSync(e.dataId),i=0;i<a.length;++i){var u=Math.sign(a[i]),l=Math.abs(a[i]),c=1/(1+.3275911*l);r[i]=u*(1-((((1.061405429*c-1.453152027)*c+1.421413741)*c-.284496736)*c+.254829592)*c*Math.exp(-l*l))}return this.makeOutput(r,e.shape,"float32")},t.prototype.step=function(e,r){r===void 0&&(r=0),he(e,"step");for(var a=new Float32Array(e.size),i=this.readSync(e.dataId),u=0;u<i.length;++u){var l=i[u];isNaN(l)?a[u]=NaN:a[u]=l>0?1:r}return this.makeOutput(a,e.shape,"float32")},t.prototype.fusedConv2d=function(e){var r=e.input,a=e.filter,i=e.convInfo,u=e.bias,l=e.activation,c=e.preluActivationWeights,f=this.conv2d(r,a,i);return u&&(f=this.add(f,u)),l&&(f=pv(this,f,l,c)),f},t.prototype.conv2d=function(e,r,a){he([e,r],"conv2d");for(var i=a.filterHeight,u=a.filterWidth,l=a.dilationHeight,c=a.dilationWidth,f=a.padInfo.left,d=a.padInfo.top,v=a.dataFormat==="channelsLast",m=Pe(a.outShape,e.dtype),g=e.strides[0],b=v?e.strides[1]:e.strides[2],w=v?e.strides[2]:1,S=v?1:e.strides[1],E=m.strides[0],_=v?m.strides[1]:m.strides[2],R=v?m.strides[2]:1,C=v?1:m.strides[1],A=this.readSync(e.dataId),D=this.readSync(r.dataId),O=m.values,F=0;F<a.batchSize;++F)for(var N=F*g,B=F*E,H=0;H<a.outHeight;++H)for(var U=B+H*_,J=H*a.strideHeight-d,ee=0;ee<i;ee++){var te=J+ee*l;if(!(te<0||te>=a.inHeight))for(var L=ee*r.strides[0],W=N+te*b,$=0;$<a.outWidth;++$)for(var ne=U+$*R,M=$*a.strideWidth-f,j=0;j<u;j++){var ie=M+j*c;if(!(ie<0||ie>=a.inWidth))for(var oe=W+ie*w,de=L+j*r.strides[1],me=0;me<a.inChannels;++me){for(var ve=A[oe+me*S],Ae=0;Ae<a.outChannels;++Ae)O[ne+Ae*C]+=ve*D[de+Ae];de+=a.outChannels}}}return m.toTensor()},t.prototype.conv3d=function(e,r,a){for(var i=a.filterDepth,u=a.filterHeight,l=a.filterWidth,c=a.dilationDepth,f=a.dilationHeight,d=a.dilationWidth,v=a.padInfo.front,m=a.padInfo.left,g=a.padInfo.top,b=Pe(a.outShape,e.dtype),w=this.readSync(e.dataId),S=this.readSync(r.dataId),E=b.values,_=0;_<a.batchSize;++_)for(var R=_*e.strides[0],C=_*b.strides[0],A=0;A<a.outDepth;++A)for(var D=C+A*b.strides[1],O=A*a.strideDepth-v,F=0;F<i;F++){var N=O+F*c;if(!(N<0||N>=a.inDepth))for(var B=F*r.strides[0],H=R+N*e.strides[1],U=0;U<a.outHeight;++U)for(var J=D+U*b.strides[2],ee=U*a.strideHeight-g,te=0;te<u;te++){var L=ee+te*f;if(!(L<0||L>=a.inHeight))for(var W=B+te*r.strides[1],$=H+L*e.strides[2],ne=0;ne<a.outWidth;++ne)for(var M=J+ne*a.outChannels,j=ne*a.strideWidth-m,ie=0;ie<l;ie++){var oe=j+ie*d;if(!(oe<0||oe>=a.inWidth))for(var de=W+ie*r.strides[2],me=$+oe*a.inChannels,ve=de,Ae=0;Ae<a.inChannels;++Ae){for(var ye=w[me+Ae],De=0;De<a.outChannels;++De)E[M+De]+=ye*S[ve+De];ve+=a.outChannels}}}}return b.toTensor()},t.prototype.conv2dDerInput=function(e,r,a){he([e,r],"conv2dDerInput");for(var i=Pe(a.inShape,"float32"),u=i.values,l=this.readSync(e.dataId),c=this.readSync(r.dataId),f=r.strides,d=f[0],v=f[1],m=f[2],g=a.batchSize,b=a.filterHeight,w=a.filterWidth,S=a.inChannels,E=a.inHeight,_=a.inWidth,R=a.outChannels,C=a.outHeight,A=a.outWidth,D=a.strideHeight,O=a.strideWidth,F=a.dataFormat,N=b-1-a.padInfo.top,B=w-1-a.padInfo.left,H=F==="channelsLast",U=i.strides[0],J=H?i.strides[1]:i.strides[2],ee=H?i.strides[2]:1,te=H?1:i.strides[1],L=e.strides[0],W=H?e.strides[1]:e.strides[2],$=H?e.strides[2]:1,ne=H?1:e.strides[1],M=0;M<g;++M)for(var j=0;j<S;++j)for(var ie=0;ie<E;++ie)for(var oe=ie-N,de=Math.max(0,Math.ceil(oe/D)),me=Math.min(C,(b+oe)/D),ve=0;ve<_;++ve){for(var Ae=ve-B,ye=Math.max(0,Math.ceil(Ae/O)),De=Math.min(A,(w+Ae)/O),Qe=0,Ne=de;Ne<me;++Ne)for(var Le=Ne*D-oe,We=ye;We<De;++We)for(var tt=L*M+W*Ne+$*We,ft=d*(b-1-Le)+v*(w-1-(We*O-Ae))+m*j,st=0;st<R;++st)Qe+=l[tt+ne*st]*c[ft+st];u[U*M+J*ie+ee*ve+te*j]=Qe}return i.toTensor()},t.prototype.conv3dDerInput=function(e,r,a){for(var i=Pe(a.inShape,"float32"),u=i.values,l=i.strides,c=l[0],f=l[1],d=l[2],v=l[3],m=this.readSync(e.dataId),g=e.strides,b=g[0],w=g[1],S=g[2],E=g[3],_=this.readSync(r.dataId),R=r.strides,C=R[0],A=R[1],D=R[2],O=R[3],F=a.batchSize,N=a.filterDepth,B=a.filterHeight,H=a.filterWidth,U=a.inChannels,J=a.inDepth,ee=a.inHeight,te=a.inWidth,L=a.outChannels,W=a.outDepth,$=a.outHeight,ne=a.outWidth,M=a.strideDepth,j=a.strideHeight,ie=a.strideWidth,oe=N-1-a.padInfo.front,de=B-1-a.padInfo.top,me=H-1-a.padInfo.left,ve=0;ve<F;++ve)for(var Ae=0;Ae<U;++Ae)for(var ye=0;ye<J;++ye)for(var De=ye-oe,Qe=Math.max(0,Math.ceil(De/M)),Ne=Math.min(W,(N+De)/M),Le=0;Le<ee;++Le)for(var We=Le-de,tt=Math.max(0,Math.ceil(We/j)),ft=Math.min($,(B+We)/j),st=0;st<te;++st){for(var Dt=st-me,er=Math.max(0,Math.ceil(Dt/ie)),hn=Math.min(ne,(H+Dt)/ie),na=0,An=Qe;An<Ne;++An)for(var kr=An*M-De,tr=tt;tr<ft;++tr)for(var Ma=tr*j-We,br=er;br<hn;++br)for(var ra=b*ve+w*An+S*tr+E*br,Mt=C*(N-1-kr)+A*(B-1-Ma)+D*(H-1-(br*ie-Dt))+O*Ae,Lt=0;Lt<L;++Lt)na+=m[ra+Lt]*_[Mt+Lt];u[c*ve+f*ye+d*Le+v*st+Ae]=na}return i.toTensor()},t.prototype.conv2dDerFilter=function(e,r,a){he([e,r],"conv2dDerFilter");for(var i=a.strideHeight,u=a.strideWidth,l=a.filterHeight,c=a.filterWidth,f=a.dataFormat==="channelsLast",d=Pe(a.filterShape,"float32"),v=a.padInfo.left,m=a.padInfo.top,g=this.bufferSync(e),b=this.bufferSync(r),w=0;w<l;++w)for(var S=Math.max(0,Math.ceil((m-w)/i)),E=Math.min(a.outHeight,(a.inHeight+m-w)/i),_=0;_<c;++_)for(var R=Math.max(0,Math.ceil((v-_)/u)),C=Math.min(a.outWidth,(a.inWidth+v-_)/u),A=0;A<a.inChannels;++A)for(var D=0;D<a.outChannels;++D){for(var O=0,F=0;F<a.batchSize;++F)for(var N=S;N<E;++N)for(var B=w+N*i-m,H=R;H<C;++H){var U=_+H*u-v;O+=f?g.get(F,B,U,A)*b.get(F,N,H,D):g.get(F,A,B,U)*b.get(F,D,N,H)}d.set(O,w,_,A,D)}return d.toTensor()},t.prototype.conv3dDerFilter=function(e,r,a){for(var i=a.strideDepth,u=a.strideHeight,l=a.strideWidth,c=a.filterDepth,f=a.filterHeight,d=a.filterWidth,v=Pe(a.filterShape,"float32"),m=v.values,g=v.strides,b=g[0],w=g[1],S=g[2],E=g[3],_=this.readSync(r.dataId),R=r.strides,C=R[0],A=R[1],D=R[2],O=R[3],F=this.readSync(e.dataId),N=e.strides,B=N[0],H=N[1],U=N[2],J=N[3],ee=a.padInfo.front,te=a.padInfo.left,L=a.padInfo.top,W=0;W<c;++W)for(var $=Math.max(0,Math.ceil((ee-W)/i)),ne=Math.min(a.outDepth,(a.inDepth+ee-W)/i),M=W*b,j=0;j<f;++j)for(var ie=Math.max(0,Math.ceil((L-j)/u)),oe=Math.min(a.outHeight,(a.inHeight+L-j)/u),de=j*w+M,me=0;me<d;++me)for(var ve=Math.max(0,Math.ceil((te-me)/l)),Ae=Math.min(a.outWidth,(a.inWidth+te-me)/l),ye=me*S+de,De=0;De<a.inChannels;++De)for(var Qe=De*E+ye,Ne=0;Ne<a.outChannels;++Ne){for(var Le=0,We=0;We<a.batchSize;++We)for(var tt=We*B,ft=We*C,st=$;st<ne;++st)for(var Dt=(W+st*i-ee)*H+tt,er=st*A+ft,hn=ie;hn<oe;++hn)for(var na=(j+hn*u-L)*U+Dt,An=hn*D+er,kr=ve;kr<Ae;++kr){var tr=kr*O+An;Le+=F[(me+kr*l-te)*J+na+De]*_[tr+Ne]}m[Qe+Ne]=Le}return v.toTensor()},t.prototype.fusedDepthwiseConv2D=function(e){var r=e.input,a=e.filter,i=e.convInfo,u=e.bias,l=e.activation,c=e.preluActivationWeights,f=this.depthwiseConv2D(r,a,i);return u&&(f=this.add(f,u)),l&&(f=pv(this,f,l,c)),f},t.prototype.depthwiseConv2D=function(e,r,a){he([e,r],"depthwiseConv2D");for(var i=a.filterHeight,u=a.filterWidth,l=a.dilationHeight,c=a.dilationWidth,f=a.padInfo.left,d=a.padInfo.top,v=a.outChannels/a.inChannels,m=Pe(a.outShape,e.dtype),g=this.readSync(e.dataId),b=this.readSync(r.dataId),w=m.values,S=0;S<a.batchSize;++S)for(var E=S*e.strides[0],_=S*m.strides[0],R=0;R<a.outHeight;++R)for(var C=_+R*m.strides[1],A=R*a.strideHeight-f,D=0;D<i;++D){var O=A+D*l;if(!(O<0||O>=a.inHeight))for(var F=D*r.strides[0],N=E+O*e.strides[1],B=0;B<a.outWidth;++B)for(var H=C+B*m.strides[2],U=B*a.strideWidth-d,J=0;J<u;++J){var ee=U+J*c;if(!(ee<0||ee>=a.inWidth))for(var te=F+J*r.strides[1],L=N+ee*a.inChannels,W=H,$=te,ne=0;ne<a.inChannels;++ne){for(var M=g[L+ne],j=0;j<v;++j)w[W+j]+=M*b[$+j];W+=v,$+=v}}}return m.toTensor()},t.prototype.depthwiseConv2DDerInput=function(e,r,a){he([e,r],"depthwiseConv2DDerInput");for(var i=Pe(a.inShape,"float32"),u=i.values,l=i.strides,c=l[0],f=l[1],d=l[2],v=this.readSync(e.dataId),m=e.strides,g=m[0],b=m[1],w=m[2],S=this.readSync(r.dataId),E=r.strides,_=E[0],R=E[1],C=E[2],A=a.batchSize,D=a.filterHeight,O=a.filterWidth,F=a.inChannels,N=a.inHeight,B=a.inWidth,H=a.outChannels,U=a.outHeight,J=a.outWidth,ee=a.strideHeight,te=a.strideWidth,L=D-1-a.padInfo.top,W=O-1-a.padInfo.left,$=H/F,ne=0;ne<A;++ne)for(var M=0;M<F;++M)for(var j=0;j<N;++j)for(var ie=j-L,oe=Math.max(0,Math.ceil(ie/ee)),de=Math.min(U,(D+ie)/ee),me=0;me<B;++me){for(var ve=me-W,Ae=Math.max(0,Math.ceil(ve/te)),ye=Math.min(J,(O+ve)/te),De=0,Qe=oe;Qe<de;++Qe)for(var Ne=Qe*ee-ie,Le=Ae;Le<ye;++Le)for(var We=g*ne+b*Qe+w*Le,tt=_*(D-1-Ne)+R*(O-1-(Le*te-ve))+C*M,ft=0;ft<$;++ft)De+=v[We+(M*$+ft)]*S[tt+ft];u[c*ne+f*j+d*me+M]=De}return i.toTensor()},t.prototype.depthwiseConv2DDerFilter=function(e,r,a){he([e,r],"depthwiseConv2DDerFilter");for(var i=a.strideHeight,u=a.strideWidth,l=a.filterHeight,c=a.filterWidth,f=Pe(a.filterShape,"float32"),d=a.padInfo.left,v=a.padInfo.top,m=a.outChannels/a.inChannels,g=this.bufferSync(e),b=this.bufferSync(r),w=0;w<l;++w)for(var S=Math.max(0,Math.ceil((v-w)/i)),E=Math.min(a.outHeight,(a.inHeight+v-w)/i),_=0;_<c;++_)for(var R=Math.max(0,Math.ceil((d-_)/u)),C=Math.min(a.outWidth,(a.inWidth+d-_)/u),A=0;A<a.outChannels;++A){for(var D=Math.trunc(A/m),O=A%m,F=0,N=0;N<a.batchSize;++N)for(var B=S;B<E;++B)for(var H=w+B*i-v,U=R;U<C;++U){var J=_+U*u-d;F+=g.get(N,H,J,D)*b.get(N,B,U,A)}f.set(F,w,_,D,O)}return f.toTensor()},t.prototype.tile=function(e,r){return he(e,"tile"),gE(this.bufferSync(e),r)},t.prototype.pad=function(e,r,a){he(e,"pad");var i=r.map(function(m,g){return m[0]+e.shape[g]+m[1]}),u=r.map(function(m){return m[0]}),l=this.bufferSync(e),c=Pe(i,e.dtype);a!==0&&c.values.fill(a);for(var f=0;f<e.size;f++){var d=l.indexToLoc(f),v=d.map(function(m,g){return m+u[g]});c.set.apply(c,[l.get.apply(l,d)].concat(v))}return c.toTensor()},t.prototype.transpose=function(e,r){he(e,"transpose");for(var a=new Array(e.rank),i=0;i<a.length;i++)a[i]=e.shape[r[i]];var u=this.readSync(e.dataId),l=Pe(a,e.dtype),c=this.bufferSync(e);for(i=0;i<e.size;++i){for(var f=c.indexToLoc(i),d=new Array(f.length),v=0;v<d.length;v++)d[v]=f[r[v]];var m=l.locToIndex(d);l.values[m]=u[i]}return l.toTensor()},t.prototype.gather=function(e,r,a){he([e,r],"gather");var i=e.shape.slice(),u=this.readSync(r.dataId);i[a]=u.length;for(var l=Pe(i,e.dtype),c=this.bufferSync(e),f=0;f<l.size;++f){var d=l.indexToLoc(f),v=d.slice();v[a]=u[d[a]];var m=c.locToIndex(v);l.values[f]=c.values[m]}return l.toTensor()},t.prototype.batchToSpaceND=function(e,r,a){he([e],"batchToSpaceND");var i=r.reduce(function(v,m){return v*m}),u=Of(e.shape,r,i),l=kf(u.length,r.length),c=Nf(e.shape,r,i),f=aE(a,r.length),d=iE(c,a,r.length);return e.reshape(u).transpose(l).reshape(c).slice(f,d)},t.prototype.spaceToBatchND=function(e,r,a){he([e],"spaceToBatchND");var i=r.reduce(function(m,g){return m*g}),u=[[0,0]];u.push.apply(u,a);for(var l=1+r.length;l<e.shape.length;++l)u.push([0,0]);var c=e.pad(u),f=Of(c.shape,r,i,!1),d=kf(f.length,r.length,!1),v=Nf(c.shape,r,i,!1);return c.reshape(f).transpose(d).reshape(v)},t.prototype.pool=function(e,r,a){he(e,"pool");for(var i=r.strideHeight,u=r.strideWidth,l=r.dilationHeight,c=r.dilationWidth,f=r.effectiveFilterHeight,d=r.effectiveFilterWidth,v=r.padInfo.top,m=r.padInfo.left,g=a==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,b=this.readSync(e.dataId),w=Pe(r.outShape,e.dtype),S=w.values,E=r.outShape[1]*r.outShape[2]*r.outShape[3],_=r.outShape[2]*r.outShape[3],R=r.outShape[3],C=0;C<r.batchSize;++C)for(var A=C*E,D=C*e.strides[0],O=0;O<r.inChannels;++O)for(var F=0;F<r.outHeight;++F)for(var N=F*i-v,B=Math.max(0,N),H=Math.min(r.inHeight,f+N),U=A+F*_,J=0;J<r.outWidth;++J){for(var ee=J*u-m,te=Math.max(0,ee),L=Math.min(r.inWidth,d+ee),W=g,$=0,ne=0,M=B;M<H;M+=l){for(var j=D+M*e.strides[1],ie=te;ie<L;ie+=c){var oe=b[j+ie*e.strides[2]+O];a==="max"&&oe>W?W=oe:a==="avg"&&($+=oe,ne++)}if(isNaN(W))break}S[U+J*R+O]=a==="avg"?$/ne:W}return w.toTensor()},t.prototype.maxPool=function(e,r){return this.pool(e,r,"max")},t.prototype.maxPoolPositions=function(e,r){for(var a=Pe(r.outShape,"int32"),i=r.strideHeight,u=r.strideWidth,l=r.dilationHeight,c=r.dilationWidth,f=r.effectiveFilterHeight,d=r.effectiveFilterWidth,v=r.padInfo.top,m=r.padInfo.left,g=this.bufferSync(e),b=0;b<r.batchSize;++b)for(var w=0;w<r.inChannels;++w)for(var S=0;S<r.outHeight;++S){for(var E=S*i-v,_=E;_<0;)_+=l;for(var R=Math.min(r.inHeight,f+E),C=0;C<r.outWidth;++C){for(var A=C*u-m,D=A;D<0;)D+=c;for(var O=Math.min(r.inWidth,d+A),F=Number.NEGATIVE_INFINITY,N=-1,B=_;B<R;B+=l)for(var H=B-E,U=D;U<O;U+=c){var J=U-A,ee=g.get(b,B,U,w);ee>F&&(F=ee,N=H*d+J)}a.set(N,b,S,C,w)}}return a.toTensor()},t.prototype.maxPoolBackprop=function(e,r,a,i){he([r,a],"maxPoolBackprop");for(var u=this.maxPoolPositions(r,i),l=i.strideHeight,c=i.strideWidth,f=i.dilationHeight,d=i.dilationWidth,v=i.effectiveFilterHeight,m=i.effectiveFilterWidth,g=m-1-i.padInfo.left,b=v-1-i.padInfo.top,w=Pe(r.shape,"float32"),S=this.bufferSync(u),E=this.bufferSync(e),_=0;_<i.batchSize;++_)for(var R=0;R<i.inChannels;++R)for(var C=0;C<i.inHeight;++C)for(var A=0;A<i.inWidth;++A){for(var D=C-b,O=A-g,F=0,N=0;N<v;N+=f){var B=(D+N)/l;if(!(B<0||B>=i.outHeight||Math.floor(B)!==B))for(var H=0;H<m;H+=d){var U=(O+H)/c;if(!(U<0||U>=i.outWidth||Math.floor(U)!==U)){var J=v*m-1-S.get(_,B,U,R)===N*m+H?1:0;J!==0&&(F+=E.get(_,B,U,R)*J)}}}w.set(F,_,C,A,R)}return w.toTensor()},t.prototype.avgPoolBackprop=function(e,r,a){he([e,r],"avgPoolBackprop");for(var i=a.strideHeight,u=a.strideWidth,l=a.filterHeight,c=a.filterWidth,f=a.dilationHeight,d=a.dilationWidth,v=a.effectiveFilterHeight,m=a.effectiveFilterWidth,g=m-1-a.padInfo.left,b=v-1-a.padInfo.top,w=Pe(r.shape,"float32"),S=1/(l*c),E=this.bufferSync(e),_=0;_<a.batchSize;++_)for(var R=0;R<a.inChannels;++R)for(var C=0;C<a.inHeight;++C)for(var A=0;A<a.inWidth;++A){for(var D=C-b,O=A-g,F=0,N=0;N<v;N+=f){var B=(D+N)/i;if(!(B<0||B>=a.outHeight||Math.floor(B)!==B))for(var H=0;H<m;H+=d){var U=(O+H)/u;U<0||U>=a.outWidth||Math.floor(U)!==U||(F+=E.get(_,B,U,R))}}w.set(F*S,_,C,A,R)}return w.toTensor()},t.prototype.pool3d=function(e,r,a){he(e,"pool3d");for(var i=r.strideDepth,u=r.strideHeight,l=r.strideWidth,c=r.dilationDepth,f=r.dilationHeight,d=r.dilationWidth,v=r.effectiveFilterDepth,m=r.effectiveFilterHeight,g=r.effectiveFilterWidth,b=r.padInfo.front,w=r.padInfo.top,S=r.padInfo.left,E=a==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,_=this.readSync(e.dataId),R=Pe(r.outShape,e.dtype),C=R.values,A=r.outShape[1]*r.outShape[2]*r.outShape[3]*r.outShape[4],D=r.outShape[2]*r.outShape[3]*r.outShape[4],O=r.outShape[3]*r.outShape[4],F=r.outShape[4],N=0;N<r.batchSize;++N)for(var B=N*A,H=N*e.strides[0],U=0;U<r.inChannels;++U)for(var J=0;J<r.outDepth;++J){for(var ee=J*i-b,te=ee;te<0;)te+=c;for(var L=Math.min(r.inDepth,v+ee),W=B+J*D,$=0;$<r.outHeight;++$){for(var ne=$*u-w,M=ne;M<0;)M+=f;for(var j=Math.min(r.inHeight,m+ne),ie=W+$*O,oe=0;oe<r.outWidth;++oe){for(var de=oe*l-S,me=de;me<0;)me+=d;for(var ve=Math.min(r.inWidth,g+de),Ae=ie+oe*F,ye=E,De=0,Qe=0,Ne=te;Ne<L;Ne+=c){for(var Le=H+Ne*e.strides[1],We=M;We<j;We+=f){for(var tt=Le+We*e.strides[2],ft=me;ft<ve;ft+=d){var st=_[tt+ft*e.strides[3]+U];if(a==="max"&&st>ye?ye=st:a==="avg"&&(De+=st,Qe++),isNaN(ye))break}if(isNaN(ye))break}if(isNaN(ye))break}C[Ae+U]=a==="avg"?De/Qe:ye}}}return R.toTensor()},t.prototype.avgPool3d=function(e,r){return he(e,"avgPool3d"),this.pool3d(e,r,"avg").toFloat()},t.prototype.avgPool3dBackprop=function(e,r,a){he([e,r],"avgPool3dBackprop");for(var i=a.strideDepth,u=a.strideHeight,l=a.strideWidth,c=a.filterDepth,f=a.filterHeight,d=a.filterWidth,v=a.dilationDepth,m=a.dilationHeight,g=a.dilationWidth,b=a.effectiveFilterDepth,w=a.effectiveFilterHeight,S=a.effectiveFilterWidth,E=b-1-a.padInfo.front,_=S-1-a.padInfo.left,R=w-1-a.padInfo.top,C=Pe(r.shape,"float32"),A=1/(c*f*d),D=this.bufferSync(e),O=0;O<a.batchSize;++O)for(var F=0;F<a.inChannels;++F)for(var N=0;N<a.inDepth;++N)for(var B=0;B<a.inHeight;++B)for(var H=0;H<a.inWidth;++H){for(var U=N-E,J=B-R,ee=H-_,te=0,L=0;L<b;L+=v){var W=(U+L)/i;if(!(W<0||W>=a.outDepth||Math.floor(W)!==W))for(var $=0;$<w;$+=m){var ne=(J+$)/u;if(!(ne<0||ne>=a.outHeight||Math.floor(ne)!==ne))for(var M=0;M<S;M+=g){var j=(ee+M)/l;j<0||j>=a.outWidth||Math.floor(j)!==j||(te+=D.get(O,W,ne,j,F))}}}C.set(te*A,O,N,B,H,F)}return C.toTensor()},t.prototype.maxPool3d=function(e,r){return he(e,"maxPool3d"),this.pool3d(e,r,"max").toFloat()},t.prototype.maxPool3dPositions=function(e,r){for(var a=Pe(r.outShape,"int32"),i=r.strideDepth,u=r.strideHeight,l=r.strideWidth,c=r.dilationDepth,f=r.dilationHeight,d=r.dilationWidth,v=r.effectiveFilterDepth,m=r.effectiveFilterHeight,g=r.effectiveFilterWidth,b=r.padInfo.front,w=r.padInfo.top,S=r.padInfo.left,E=this.bufferSync(e),_=0;_<r.batchSize;++_)for(var R=0;R<r.inChannels;++R)for(var C=0;C<r.outDepth;++C){for(var A=C*i-b,D=A;D<0;)D+=c;for(var O=Math.min(r.inDepth,v+A),F=0;F<r.outHeight;++F){for(var N=F*u-w,B=N;B<0;)B+=f;for(var H=Math.min(r.inHeight,m+N),U=0;U<r.outWidth;++U){for(var J=U*l-S,ee=J;ee<0;)ee+=d;for(var te=Math.min(r.inWidth,g+J),L=Number.NEGATIVE_INFINITY,W=-1,$=D;$<O;$+=c)for(var ne=$-A,M=B;M<H;M+=f)for(var j=M-N,ie=ee;ie<te;ie+=d){var oe=ie-J,de=E.get(_,$,M,ie,R);de>=L&&(L=de,W=ne*m*g+j*m+oe)}a.set(W,_,C,F,U,R)}}}return a.toTensor()},t.prototype.maxPool3dBackprop=function(e,r,a,i){he([r,a],"maxPool3dBackprop");for(var u=this.maxPool3dPositions(r,i),l=i.strideDepth,c=i.strideHeight,f=i.strideWidth,d=i.dilationDepth,v=i.dilationHeight,m=i.dilationWidth,g=i.effectiveFilterDepth,b=i.effectiveFilterHeight,w=i.effectiveFilterWidth,S=g-1-i.padInfo.front,E=w-1-i.padInfo.left,_=b-1-i.padInfo.top,R=Pe(r.shape,"float32"),C=this.bufferSync(u),A=this.bufferSync(e),D=0;D<i.batchSize;++D)for(var O=0;O<i.inChannels;++O)for(var F=0;F<i.inDepth;++F)for(var N=0;N<i.inHeight;++N)for(var B=0;B<i.inWidth;++B){for(var H=F-S,U=N-_,J=B-E,ee=0,te=0;te<g;te+=d){var L=(H+te)/l;if(!(L<0||L>=i.outDepth||Math.floor(L)!==L))for(var W=0;W<b;W+=v){var $=(U+W)/c;if(!($<0||$>=i.outHeight||Math.floor($)!==$))for(var ne=0;ne<w;ne+=m){var M=(J+ne)/f;if(!(M<0||M>=i.outWidth||Math.floor(M)!==M)){var j=g*b*w-1-C.get(D,L,$,M,O)===te*b*w+W*w+ne?1:0;j!==0&&(ee+=A.get(D,L,$,M,O)*j)}}}}R.set(ee,D,F,N,B,O)}return R.toTensor()},t.prototype.cast=function(e,r){return dE(e,r,this)},t.prototype.reshape=function(e,r){return lm(e,r)},t.prototype.avgPool=function(e,r){return he(e,"avgPool"),this.pool(e,r,"avg").toFloat()},t.prototype.resizeBilinear=function(e,r,a,i){he(e,"resizeBilinear");for(var u=e.shape,l=u[0],c=u[1],f=u[2],d=u[3],v=this.readSync(e.dataId),m=new Float32Array(Ee([l,r,a,d])),g=[i&&r>1?c-1:c,i&&a>1?f-1:f],b=[i&&r>1?r-1:r,i&&a>1?a-1:a],w=0,S=g[0]/b[0],E=g[1]/b[1],_=0;_<l;_++)for(var R=0;R<r;R++)for(var C=S*R,A=Math.floor(C),D=C-A,O=Math.min(c-1,Math.ceil(C)),F=_*e.strides[0]+A*e.strides[1],N=_*e.strides[0]+O*e.strides[1],B=0;B<a;B++)for(var H=E*B,U=Math.floor(H),J=H-U,ee=Math.min(f-1,Math.ceil(H)),te=F+U*e.strides[2],L=N+U*e.strides[2],W=F+ee*e.strides[2],$=N+ee*e.strides[2],ne=0;ne<d;ne++){var M=v[te+ne],j=v[L+ne],ie=M+(v[W+ne]-M)*J,oe=ie+(j+(v[$+ne]-j)*J-ie)*D;m[w++]=oe}return fn(m,[l,r,a,d])},t.prototype.resizeBilinearBackprop=function(e,r,a){he([e,r],"resizeBilinearBackprop");for(var i=r.shape,u=i[0],l=i[1],c=i[2],f=i[3],d=e.shape,v=d[1],m=d[2],g=new Float32Array(u*l*c*f),b=[a&&v>1?l-1:l,a&&m>1?c-1:c],w=[a&&v>1?v-1:v,a&&m>1?m-1:m],S=b[0]/w[0],E=b[1]/w[1],_=this.readSync(e.dataId),R=0,C=0;C<u;C++)for(var A=C*r.strides[0],D=0;D<v;D++)for(var O=D*S,F=Math.floor(O),N=Math.min(Math.ceil(O),l-1),B=A+F*r.strides[1],H=A+N*r.strides[1],U=O-F,J=1-U,ee=0;ee<m;ee++)for(var te=ee*E,L=Math.floor(te),W=Math.min(Math.ceil(te),c-1),$=te-L,ne=1-$,M=B+L*r.strides[2],j=B+W*r.strides[2],ie=H+L*r.strides[2],oe=H+W*r.strides[2],de=J*ne,me=J*$,ve=U*ne,Ae=U*$,ye=0;ye<f;ye++){var De=_[R++];g[M+ye]+=De*de,g[j+ye]+=De*me,g[ie+ye]+=De*ve,g[oe+ye]+=De*Ae}return Mn(g,[u,c,l,f],r.dtype)},t.prototype.resizeNearestNeighbor=function(e,r,a,i){he(e,"resizeNearestNeighbor");for(var u=e.shape,l=u[0],c=u[1],f=u[2],d=u[3],v=this.readSync(e.dataId),m=new Float32Array(l*r*a*d),g=[i&&r>1?c-1:c,i&&a>1?f-1:f],b=[i&&r>1?r-1:r,i&&a>1?a-1:a],w=g[0]/b[0],S=g[1]/b[1],E=0,_=0;_<l;_++)for(var R=_*e.strides[0],C=0;C<r;C++)for(var A=w*C,D=R+Math.min(c-1,i?Math.round(A):Math.floor(A))*e.strides[1],O=0;O<a;O++)for(var F=S*O,N=D+Math.min(f-1,i?Math.round(F):Math.floor(F))*e.strides[2],B=0;B<d;B++){var H=v[N+B];m[E++]=H}return fn(m,[l,r,a,d],e.dtype)},t.prototype.resizeNearestNeighborBackprop=function(e,r,a){he([e,r],"resizeNearestNeighborBackprop");for(var i=r.shape,u=i[0],l=i[1],c=i[2],f=i[3],d=e.shape,v=d[1],m=d[2],g=new Float32Array(u*l*c*f),b=this.readSync(e.dataId),w=[a&&v>1?l-1:l,a&&m>1?c-1:c],S=[a&&v>1?v-1:v,a&&m>1?m-1:m],E=w[0]/S[0],_=w[1]/S[1],R=1/E,C=1/_,A=2*Math.ceil(R)+2,D=2*Math.ceil(C)+2,O=0;O<u;O++)for(var F=O*r.strides[0],N=0;N<l;N++)for(var B=F+N*r.strides[1],H=Math.floor(N*R),U=Math.floor(H-A/2),J=0;J<c;J++)for(var ee=B+J*r.strides[2],te=Math.floor(J*C),L=Math.floor(te-D/2),W=0;W<f;W++){for(var $=0,ne=0;ne<A;ne++){var M=ne+U;if(!(M<0||M>=v)){var j=F+M*e.strides[1],ie=M*E;if(N===Math.min(l-1,a?Math.round(ie):Math.floor(ie)))for(var oe=0;oe<D;oe++){var de=oe+L;if(!(de<0||de>=m)){var me=j+de*e.strides[2],ve=de*_;J===Math.min(c-1,a?Math.round(ve):Math.floor(ve))&&($+=b[me+W])}}}}g[ee+W]=$}return Mn(g,r.shape,r.dtype)},t.prototype.batchNormalization=function(e,r,a,i,u,l){he([e,r,a,u,l],"batchNorm");for(var c=this.readSync(e.dataId),f=this.readSync(r.dataId),d=this.readSync(a.dataId),v=u?this.readSync(u.dataId):new Float32Array([1]),m=l?this.readSync(l.dataId):new Float32Array([0]),g=new Float32Array(c.length),b=m.length,w=v.length,S=d.length,E=f.length,_=0,R=0,C=0,A=0,D=0;D<c.length;++D)g[D]=m[_++]+(c[D]-f[R++])*v[C++]/Math.sqrt(d[A++]+i),_>=b&&(_=0),R>=E&&(R=0),C>=w&&(C=0),A>=S&&(A=0);return Mn(g,e.shape)},t.prototype.localResponseNormalization4D=function(e,r,a,i,u){he(e,"localResponseNormalization4D");var l=e.shape[3],c=l-1,f=this.readSync(e.dataId),d=e.size,v=new Float32Array(d);function m(S){for(var E=S%l,_=S-E+Math.max(0,E-r),R=S-E+Math.min(E+r,c),C=0;_<=R;_++){var A=f[_];C+=A*A}return C}for(var g=0;g<d;g++){var b=m(g),w=f[g]*Math.pow(a+i*b,-u);v[g]=w}return Mn(v,e.shape)},t.prototype.LRNGrad=function(e,r,a,i,u,l,c){he(e,"LRNGrad");for(var f=e.shape[3],d=this.readSync(e.dataId),v=this.readSync(r.dataId),m=this.readSync(a.dataId),g=new Float32Array(e.size),b=e.size,w=0;w<b;w++){for(var S=w%f,E=w-S+Math.max(0,S-i),_=w-S+Math.min(f,S+i+1),R=0,C=E;C<_;C++)R+=Math.pow(v[C],2);for(R=l*R+u,C=E;C<_;C++){var A=-2*l*c*v[C]*m[w]/R;w===C&&(A+=Math.pow(R,-c)),A*=d[w],g[C]+=A}}return Mn(g,e.shape)},t.prototype.multinomial=function(e,r,a,i){he(e,"multinomial");for(var u=r?e:Ta(e),l=u.shape[0],c=u.shape[1],f=mt([l,a],"int32"),d=this.readSync(f.dataId),v=this.readSync(u.dataId),m=0;m<l;++m){var g=m*c,b=new Float32Array(c-1);b[0]=v[g];for(var w=1;w<b.length;++w)b[w]=b[w-1]+v[g+w];for(var S=rh(i.toString()),E=m*a,_=0;_<a;++_){var R=S();d[E+_]=b.length;for(var C=0;C<b.length;C++)if(R<b[C]){d[E+_]=C;break}}}return f},t.prototype.oneHot=function(e,r,a,i){he(e,"oneHot");var u=new Float32Array(e.size*r);u.fill(i);for(var l=this.readSync(e.dataId),c=0;c<e.size;++c)l[c]>=0&&l[c]<r&&(u[c*r+l[c]]=a);return pi(u,[e.size,r],"int32")},t.prototype.nonMaxSuppression=function(e,r,a,i,u){return he(e,"nonMaxSuppression"),Qm(this.readSync(e.dataId),this.readSync(r.dataId),a,i,u)},t.prototype.fft=function(e){return this.fftBatch(e,!1)},t.prototype.ifft=function(e){return this.fftBatch(e,!0)},t.prototype.fftBatch=function(e,r){for(var a=e.shape[0],i=e.shape[1],u=Pe(e.shape,"float32"),l=Pe(e.shape,"float32"),c=dr(e).as2D(a,i),f=Wr(e).as2D(a,i),d=0;d<a;d++)for(var v=c.slice([d,0],[1,i]),m=f.slice([d,0],[1,i]),g=ln(v,m),b=this.readSync(this.fftImpl(g,r).dataId),w=0;w<i;w++){var S=ww(b,w);u.values[d*i+w]=S.real,l.values[d*i+w]=S.imag}return ln(u.toTensor(),l.toTensor()).as2D(a,i)},t.prototype.fftImpl=function(e,r){var a=e.as1D(),i=a.size;if(this.isExponentOf2(i)){var u=this.fftRadix2(a,i,r).as2D(e.shape[0],e.shape[1]);return r&&(u=ln(dr(u).div(ge(i)),Wr(u).div(ge(i)))),u}var l=this.readSync(e.dataId),c=function(f){for(var d=new Float32Array(f.length/2),v=new Float32Array(f.length/2),m=0;m<f.length;m+=2)d[m/2]=f[m],v[m/2]=f[m+1];return{real:d,imag:v}}(this.fourierTransformByMatmul(l,i,r));return ln(c.real,c.imag).as2D(e.shape[0],e.shape[1])},t.prototype.isExponentOf2=function(e){return(e&e-1)==0},t.prototype.fftRadix2=function(e,r,a){if(r===1)return e;var i=this.readSync(e.dataId),u=r/2,l=function(E){for(var _=Math.ceil(E.length/4),R=new Float32Array(_),C=new Float32Array(_),A=0;A<E.length;A+=4)R[Math.floor(A/4)]=E[A],C[Math.floor(A/4)]=E[A+1];return{real:R,imag:C}}(i),c=ln(l.real,l.imag).as1D(),f=function(E){for(var _=Math.floor(E.length/4),R=new Float32Array(_),C=new Float32Array(_),A=2;A<E.length;A+=4)R[Math.floor(A/4)]=E[A],C[Math.floor(A/4)]=E[A+1];return{real:R,imag:C}}(i),d=ln(f.real,f.imag).as1D();c=this.fftRadix2(c,u,a),d=this.fftRadix2(d,u,a);var v=function(E,_){for(var R=new Float32Array(E/2),C=new Float32Array(E/2),A=0;A<Math.ceil(E/2);A++){var D=(_?2:-2)*Math.PI*(A/E);R[A]=Math.cos(D),C[A]=Math.sin(D)}return{real:R,imag:C}}(r,a),m=ln(v.real,v.imag).mul(d),g=c.add(m),b=c.sub(m),w=dr(g).concat(dr(b)),S=Wr(g).concat(Wr(b));return ln(w,S).as1D()},t.prototype.fourierTransformByMatmul=function(e,r,a){for(var i=new Float32Array(2*r),u=0;u<r;u++){for(var l=0,c=0,f=0;f<r;f++){var d=VI(u*f,r,a),v=ww(e,f);l+=v.real*d.real-v.imag*d.imag,c+=v.real*d.imag+v.imag*d.real}a&&(l/=r,c/=r),HI(i,l,c,u)}return i},t.prototype.depthToSpace=function(e,r,a){P(a==="NHWC",function(){return"Only NHWC dataFormat supported on CPU for depthToSpace. Got "+a}),P(r>1,function(){return"blockSize should be > 1 for depthToSpace, but was: "+r});for(var i=e.shape[0],u=e.shape[1],l=e.shape[2],c=e.shape[3],f=u*r,d=l*r,v=c/(r*r),m=this.readSync(e.dataId),g=new Float32Array(i*f*d*v),b=0,w=0;w<i;++w)for(var S=0;S<f;++S)for(var E=Math.floor(S/r),_=S%r,R=0;R<d;++R)for(var C=Math.floor(R/r),A=(_*r+R%r)*v,D=0;D<v;++D){var O=D+A+c*(C+l*(E+u*w));g[b++]=m[O]}return Mn(g,[i,f,d,v])},t.prototype.broadcastedBinaryOp=function(e,r,a,i){var u=Xe(e.shape,r.shape),l=Pe(u,a),c=this.readSync(e.dataId),f=this.readSync(r.dataId),d=li(e.shape,u),v=li(r.shape,u),m=l.values;if(d.length+v.length===0)for(var g=0;g<m.length;++g)m[g]=i(c[g%c.length],f[g%f.length]);else{var b=this.bufferSync(e),w=this.bufferSync(r),S=function(E){var _=l.indexToLoc(E),R=_.slice(-e.rank);d.forEach(function(O){return R[O]=0});var C=b.locToIndex(R),A=_.slice(-r.rank);v.forEach(function(O){return A[O]=0});var D=w.locToIndex(A);m[E]=i(c[C],f[D])};for(g=0;g<m.length;++g)S(g)}return l.toTensor()},t.prototype.broadcastedBinaryComplexOp=function(e,r,a){var i=Xe(e.shape,r.shape),u=Pe(i,"float32"),l=Pe(i,"float32"),c=this.readSync(e.dataId),f=this.readSync(r.dataId),d=li(e.shape,i),v=li(r.shape,i),m=u.values,g=l.values;if(d.length+v.length===0)for(var b=0;b<m.length;b++){var w=b%c.length,S=b%f.length,E=a(c[2*w],c[2*w+1],f[2*S],f[2*S+1]);m[b]=E.real,g[b]=E.imag}else{var _=this.bufferSync(this.data.get(e.dataId).complexTensors.real),R=this.bufferSync(this.data.get(r.dataId).complexTensors.real),C=function(A){var D=u.indexToLoc(A),O=D.slice(-e.rank);d.forEach(function(U){return O[U]=0});var F=_.locToIndex(O),N=D.slice(-r.rank);v.forEach(function(U){return N[U]=0});var B=R.locToIndex(N),H=a(c[2*F],c[2*F+1],f[2*B],f[2*B+1]);m[A]=H.real,g[A]=H.imag};for(b=0;b<m.length;b++)C(b)}return this.complex(u.toTensor(),l.toTensor())},t.prototype.split=function(e,r,a){return mE(e,r,a)},t.prototype.dispose=function(){},t.prototype.floatPrecision=function(){return 32},t.prototype.epsilon=function(){return 1e-7},t.prototype.cropAndResize=function(e,r,a,i,u,l){for(var c=e.shape,f=c[0],d=c[1],v=c[2],m=c[3],g=r.shape[0],b=i[0],w=i[1],S=Pe([g,b,w,m],"float32"),E=this.readSync(r.dataId),_=this.readSync(a.dataId),R=this.readSync(e.dataId),C=e.strides,A=S.strides,D=0;D<g;D++){var O=4*D,F=E[O],N=E[O+1],B=E[O+2],H=E[O+3],U=_[D];if(!(U>=f))for(var J=b>1?(B-F)*(d-1)/(b-1):0,ee=w>1?(H-N)*(v-1)/(w-1):0,te=0;te<b;te++){var L=b>1?F*(d-1)+te*J:.5*(F+B)*(d-1);if(L<0||L>d-1)for(var W=0;W<w;W++)for(var $=0;$<m;$++){var ne=$+W*A[2]+te*A[1]+D*A[0];S.values[ne]=l}else if(u==="bilinear"){var M=Math.floor(L),j=Math.ceil(L),ie=L-M;for(W=0;W<w;W++)if((Ne=w>1?N*(v-1)+W*ee:.5*(N+H)*(v-1))<0||Ne>v-1)for($=0;$<m;$++)ne=$+W*A[2]+te*A[1]+D*A[0],S.values[ne]=l;else{var oe=Math.floor(Ne),de=Math.ceil(Ne),me=Ne-oe;for($=0;$<m;$++){var ve=R[ne=$+oe*C[2]+M*C[1]+U*C[0]],Ae=R[ne=$+de*C[2]+M*C[1]+U*C[0]],ye=R[ne=$+oe*C[2]+j*C[1]+U*C[0]],De=ve+(Ae-ve)*me,Qe=ye+(R[ne=$+de*C[2]+j*C[1]+U*C[0]]-ye)*me;ne=$+W*A[2]+te*A[1]+D*A[0],S.values[ne]=De+(Qe-De)*ie}}}else for(W=0;W<w;++W){var Ne;if((Ne=w>1?N*(v-1)+W*ee:.5*(N+H)*(v-1))<0||Ne>v-1)for($=0;$<m;$++)ne=$+W*A[2]+te*A[1]+D*A[0],S.values[ne]=l;else{var Le=Math.round(Ne),We=Math.round(L);for($=0;$<m;$++){var tt=$+Le*C[2]+We*C[1]+U*C[0],ft=$+W*A[2]+te*A[1]+D*A[0];S.values[ft]=R[tt]}}}}}return S.toTensor()},t.prototype.sparseToDense=function(e,r,a,i){var u=Mf(0,e,a),l=u.sliceRank,c=u.numUpdates,f=u.sliceSize,d=u.strides,v=u.outputSize;return this.scatter(e,r,a,v,f,c,l,d,i,!1)},t.prototype.gatherND=function(e,r){var a=r.shape,i=a[a.length-1],u=oE(e,r),l=u[0],c=u[1],f=u[2],d=u[3];if(c===0)return fn([],l,e.dtype);for(var v=new Xu([c,f],e.dtype),m=this.readSync(r.dataId),g=this.readSync(e.dataId),b=0;b<c;b++){for(var w=[],S=0,E=0;E<i;E++){var _=m[b*i+E];S+=_*d[E],w.push(_)}if(S<0||S>=e.size/f)throw new Error("Invalid indices: "+w+" does not index into "+e.shape);for(var R=0;R<f;R++)v.values[b*f+R]=g[S*f+R]}return v.toTensor().reshape(l)},t.prototype.scatterND=function(e,r,a){var i=Mf(0,e,a),u=i.sliceRank,l=i.numUpdates,c=i.sliceSize,f=i.strides,d=i.outputSize,v=ge(0);return this.scatter(e,r,a,d,c,l,u,f,v,!0)},t.prototype.fill=function(e,r,a){var i=Ef(a=a||ul(r),Ee(e));return i.fill(r),q.makeTensor(i,e,a,this)},t.prototype.onesLike=function(e){if(e.dtype==="string")throw new Error("onesLike is not supported for string tensors");return this.fill(e.shape,1,e.dtype)},t.prototype.zerosLike=function(e){var r=Ef(e.dtype,Ee(e.shape));return this.makeOutput(r,e.shape,e.dtype)},t.prototype.linspace=function(e,r,a){return pE(e,r,a)},t.prototype.scatter=function(e,r,a,i,u,l,c,f,d,v){var m=[i/u,u],g=this.readSync(e.dataId),b=this.readSync(r.dataId);if(i===0)return fn([],a,r.dtype);var w=new Xu(m,r.dtype);w.values.fill(this.readSync(d.dataId)[0]);for(var S=0;S<l;S++){for(var E=[],_=0,R=0;R<c;R++){var C=g[S*c+R];E.push(C),_+=C*f[R]}if(_<0||_>=i/u)throw new Error("Invalid indices: "+E+" does not index into "+a);for(var A=0;A<u;A++)v?w.values[_*u+A]+=b[S*u+A]:w.values[_*u+A]=r.rank===0?b[0]:b[S*u+A]}return w.toTensor().reshape(a)},t}(fE);q.registerBackend("cpu",function(){return new uz},1);for(var vv=0,Ww=[{kernelName:"NonMaxSuppressionV5",backendName:"cpu",kernelFunc:function(n){var t=n.inputs,e=n.backend,r=n.attrs,a=t,i=a.boxes,u=a.scores,l=r,c=l.maxOutputSize,f=l.iouThreshold,d=l.scoreThreshold,v=l.softNmsSigma,m=e;he(i,"NonMaxSuppressionWithScore");var g=Jm(m.data.get(i.dataId).values,m.data.get(u.dataId).values,c,f,d,v);return[g.selectedIndices,g.selectedScores]}},{kernelName:"Square",backendName:"cpu",kernelFunc:function(n){var t=n.inputs,e=n.backend,r=t.x,a=e;he(r,"square");for(var i=a.data.get(r.dataId).values,u=new Float32Array(i.length),l=0;l<i.length;++l){var c=i[l];u[l]=c*c}return{dataId:a.write(u,r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}},{kernelName:Qu,backendName:"cpu",kernelFunc:function(n){var t=n.inputs,e=n.backend,r=t,a=r.a,i=r.b,u=e;he([a,i],Qu);var l=u.data.get(a.dataId).values,c=u.data.get(i.dataId).values,f=function(m,g,b,w,S,E){var _=Xe(m,g),R=_.length,C=$r(_),A=Ku(S,Ee(_)),D=m.length,O=g.length,F=$r(m),N=$r(g),B=li(m,_),H=li(g,_);if(B.length+H.length===0)for(var U=0;U<A.length;++U)A[U]=E(b[U%b.length],w[U%w.length]);else{var J=function(ee){var te=yM(ee,R,C),L=te.slice(-D);B.forEach(function(M){return L[M]=0});var W=hw(L,D,F),$=te.slice(-O);H.forEach(function(M){return $[M]=0});var ne=hw($,O,N);A[ee]=E(b[W],w[ne])};for(U=0;U<A.length;++U)J(U)}return[A,_]}(a.shape,i.shape,l,c,a.dtype,function(m,g){var b=m-g;return b*b}),d=f[0],v=f[1];return{dataId:u.write(d,v,a.dtype),shape:v,dtype:a.dtype}}}];vv<Ww.length;vv++)zS(Ww[vv]);var Yo,lz=function(n){this.variableNames=["A"];var t=yn(),e=n[0],r=n[1];this.outputShape=n,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(`+r+".0, "+e+`.0);

        vec4 values = `+t.texture2D+`(A, uv);
        float value;
        if (depth == 0) {
          value = values.r;
        } else if (depth == 1) {
          value = values.g;
        } else if (depth == 2) {
          value = values.b;
        } else if (depth == 3) {
          value = values.a;
        }

        setOutput(floor(value * 255.0 + 0.5));
      }
    `},cz=function(n){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;var t=yn(),e=n[0],r=n[1];this.outputShape=n,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];

        vec4 result = vec4(0.);

        for(int row=0; row<=1; row++) {
          for(int col=0; col<=1; col++) {
            texC = coords[1] + row;
            depth = coords[2] + col;

            vec2 uv = (vec2(texC, texR) + halfCR) /
                       vec2(`+r+".0, "+e+`.0);
            vec4 values = `+t.texture2D+`(A, uv);
            float value;
            if (depth == 0) {
              value = values.r;
            } else if (depth == 1) {
              value = values.g;
            } else if (depth == 2) {
              value = values.b;
            } else if (depth == 3) {
              value = values.a;
            }

            result[row * 2 + col] = floor(value * 255.0 + 0.5);
          }
        }

        `+t.output+` = result;
      }
    `};for(var mv=0,Gw=[{kernelName:"FromPixels",backendName:"webgl",kernelFunc:function(n){var t=n.inputs,e=n.backend,r=n.attrs,a=t.pixels,i=r.numChannels,u=typeof HTMLVideoElement<"u"&&a instanceof HTMLVideoElement,l=typeof HTMLImageElement<"u"&&a instanceof HTMLImageElement,c=u?[a.videoWidth,a.videoHeight]:[a.width,a.height],f=c[0],d=c[1],v=[d,f],m=[d,f,i];(l||u)&&(Yo==null&&(Yo=document.createElement("canvas").getContext("2d")),Yo.canvas.width=f,Yo.canvas.height=d,Yo.drawImage(a,0,0,f,d),a=Yo.canvas);var g=e.makeTensorInfo(v,"int32");e.texData.get(g.dataId).usage=Xn.PIXELS,e.gpgpu.uploadPixelDataToTexture(e.getTexture(g.dataId),a);var b=ue().getBool("WEBGL_PACK")?new cz(m):new lz(m),w=e.runWebGLProgram(b,[g],"int32");return e.disposeData(g.dataId),w}},{kernelName:"NonMaxSuppressionV5",backendName:"webgl",kernelFunc:function(n){var t=n.inputs,e=n.backend,r=n.attrs;Af("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");var a=t,i=a.boxes,u=a.scores,l=r,c=l.maxOutputSize,f=l.iouThreshold,d=l.scoreThreshold,v=l.softNmsSigma,m=e,g=Jm(m.readSync(i.dataId),m.readSync(u.dataId),c,f,d,v);return[g.selectedIndices,g.selectedScores]}},{kernelName:"Square",backendName:"webgl",kernelFunc:function(n){var t=n.inputs,e=n.backend,r=t.x,a=e,i=new Ue(r.shape,"return x * x;");return a.runWebGLProgram(i,[r],r.dtype)}},{kernelName:Qu,backendName:"webgl",kernelFunc:function(n){var t=n.inputs,e=n.backend,r=t,a=r.a,i=r.b,u=e,l=ue().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new xa("return (a - b) * (a - b);",a.shape,i.shape):new Tt("return (a - b) * (a - b);",a.shape,i.shape);return u.compileAndRun(l,[a,i])}}];mv<Gw.length;mv++)zS(Gw[mv]);for(var gv=0,jw=[{kernelName:"Square",gradFunc:function(n,t){var e=t[0];return{x:function(){return n.mul(e.toFloat().mul(2))}}}},{kernelName:Qu,gradFunc:function(n,t){var e=t[0],r=t[1],a=ge(2);return{a:function(){return wn(n,wn(a,$t(e,r)))},b:function(){return wn(n,wn(a,$t(r,e)))}}}}];gv<jw.length;gv++)sM(jw[gv]);var fz=function(){function n(){}return n.prototype.fetch=function(t,e){return fetch(t,e)},n.prototype.now=function(){return performance.now()},n.prototype.encode=function(t,e){if(e!=="utf-8"&&e!=="utf8")throw new Error("Browser's encoder only supports utf-8, but got "+e);return this.textEncoder==null&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(t)},n.prototype.decode=function(t,e){return new TextDecoder(e).decode(t)},n}();ue().get("IS_BROWSER")&&ue().setPlatform("browser",new fz);var yv,hz=function(){return require("node-fetch")},dz=function(){function n(){this.util=require("util"),this.textEncoder=new this.util.TextEncoder}return n.prototype.fetch=function(t,e){return ue().global.fetch!=null?ue().global.fetch(t,e):(yv==null&&(yv=hz()),yv(t,e))},n.prototype.now=function(){var t=process.hrtime();return 1e3*t[0]+t[1]/1e6},n.prototype.encode=function(t,e){if(e!=="utf-8"&&e!=="utf8")throw new Error("Node built-in encoder only supports utf-8, but got "+e);return this.textEncoder.encode(t)},n.prototype.decode=function(t,e){return t.length===0?"":new this.util.TextDecoder(e).decode(t)},n}();ue().get("IS_NODE")&&ue().setPlatform("node",new dz);var hm={float32:4,int32:4,uint16:2,uint8:1,bool:1},Uf=4;function u_(n,t){for(var e={},r=0,a=function(l){var c=l.name,f=l.dtype,d=l.shape,v=Ee(d),m=void 0;if("quantization"in l){var g=l.quantization;if(g.dtype!=="uint8"&&g.dtype!=="uint16")throw new Error("Weight "+l.name+" has unknown quantization dtype "+g.dtype+". Supported quantization dtypes are: 'uint8' and 'uint16'.");var b=hm[g.dtype],w=n.slice(r,r+v*b),S=g.dtype==="uint8"?new Uint8Array(w):new Uint16Array(w);if(f==="float32")m=Float32Array.from(S,function(D){return D*g.scale+g.min});else{if(f!=="int32")throw new Error("Unsupported dtype in weight '"+c+"': "+f);m=Int32Array.from(S,function(D){return Math.round(D*g.scale+g.min)})}r+=v*b}else if(f==="string"){var E=Ee(l.shape);m=[];for(var _=0;_<E;_++){var R=new Uint32Array(n.slice(r,r+Uf))[0];r+=Uf;var C=new Uint8Array(n.slice(r,r+R));m.push(C),r+=R}}else{var A=hm[f];if(w=n.slice(r,r+v*A),f==="float32")m=new Float32Array(w);else if(f==="int32")m=new Int32Array(w);else{if(f!=="bool")throw new Error("Unsupported dtype in weight '"+c+"': "+f);m=new Uint8Array(w)}r+=v*A}e[c]=fn(m,d,f)},i=0,u=t;i<u.length;i++)a(u[i]);return e}function pz(n){if(n===null)throw new Error("Invalid input value: "+JSON.stringify(n));var t=0,e=[];n.forEach(function(i){if(t+=i.byteLength,e.push(i.byteLength===i.buffer.byteLength?i:new i.constructor(i)),!(i instanceof Float32Array||i instanceof Int32Array||i instanceof Uint8Array))throw new Error("Unsupported TypedArray subtype: "+i.constructor.name)});var r=new Uint8Array(t),a=0;return e.forEach(function(i){r.set(new Uint8Array(i.buffer),a),a+=i.byteLength}),r.buffer}var dm=typeof Buffer<"u"&&(typeof Blob>"u"||typeof atob>"u"||typeof btoa>"u");function qw(n){return dm?Buffer.byteLength(n):new Blob([n]).size}function yg(n){var t=0;n.forEach(function(a){t+=a.byteLength});var e=new Uint8Array(t),r=0;return n.forEach(function(a){e.set(new Uint8Array(a),r),r+=a.byteLength}),e.buffer}function $w(n){for(n=n.trim();n.endsWith("/");)n=n.slice(0,n.length-1);var t=n.split("/");return t[t.length-1]}function vl(n){if(n.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:n.modelTopology==null?0:qw(JSON.stringify(n.modelTopology)),weightSpecsBytes:n.weightSpecs==null?0:qw(JSON.stringify(n.weightSpecs)),weightDataBytes:n.weightData==null?0:n.weightData.byteLength}}var Zn=function(){function n(){this.saveRouters=[],this.loadRouters=[]}return n.getInstance=function(){return n.instance==null&&(n.instance=new n),n.instance},n.registerSaveRouter=function(t){n.getInstance().saveRouters.push(t)},n.registerLoadRouter=function(t){n.getInstance().loadRouters.push(t)},n.getSaveHandlers=function(t){return n.getHandlers(t,"save")},n.getLoadHandlers=function(t,e){return n.getHandlers(t,"load",e)},n.getHandlers=function(t,e,r){var a=[];return(e==="load"?n.getInstance().loadRouters:n.getInstance().saveRouters).forEach(function(i){var u=i(t,r);u!==null&&a.push(u)}),a},n}(),fs="://",vi=function(){function n(){this.managers={}}return n.getInstance=function(){return n.instance==null&&(n.instance=new n),n.instance},n.registerManager=function(t,e){P(t!=null,function(){return"scheme must not be undefined or null."}),t.endsWith(fs)&&(t=t.slice(0,t.indexOf(fs))),P(t.length>0,function(){return"scheme must not be an empty string."});var r=n.getInstance();P(r.managers[t]==null,function(){return"A model store manager is already registered for scheme '"+t+"'."}),r.managers[t]=e},n.getManager=function(t){var e=this.getInstance().managers[t];if(e==null)throw new Error("Cannot find model manager for scheme '"+t+"'");return e},n.getSchemes=function(){return Object.keys(this.getInstance().managers)},n}();function uf(n){if(n.indexOf(fs)===-1)throw new Error("The url string provided does not contain a scheme. Supported schemes are: "+vi.getSchemes().join(","));return{scheme:n.split(fs)[0],path:n.split(fs)[1]}}function Kw(n,t,e){return e===void 0&&(e=!1),we(this,void 0,void 0,function(){var r,a,i,u,l,c,f,d,v;return Se(this,function(m){switch(m.label){case 0:return P(n!==t,function(){return"Old path and new path are the same: '"+n+"'"}),P((r=Zn.getLoadHandlers(n)).length>0,function(){return"Copying failed because no load handler is found for source URL "+n+"."}),P(r.length<2,function(){return"Copying failed because more than one ("+r.length+") load handlers for source URL "+n+"."}),a=r[0],P((i=Zn.getSaveHandlers(t)).length>0,function(){return"Copying failed because no save handler is found for destination URL "+t+"."}),P(i.length<2,function(){return"Copying failed because more than one ("+r.length+") save handlers for destination URL "+t+"."}),u=i[0],l=uf(n).scheme,c=uf(n).path,f=l===uf(n).scheme,[4,a.load()];case 1:return d=m.sent(),e&&f?[4,vi.getManager(l).removeModel(c)]:[3,3];case 2:m.sent(),m.label=3;case 3:return[4,u.save(d)];case 4:return v=m.sent(),!e||f?[3,6]:[4,vi.getManager(l).removeModel(c)];case 5:m.sent(),m.label=6;case 6:return[2,v.modelArtifactsInfo]}})})}var qi="models_store",ci="model_info_store";function l_(){if(!ue().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");var n=window||self,t=n.indexedDB||n.mozIndexedDB||n.webkitIndexedDB||n.msIndexedDB||n.shimIndexedDB;if(t==null)throw new Error("The current browser does not appear to support IndexedDB.");return t}function pm(n){var t=n.result;t.createObjectStore(qi,{keyPath:"modelPath"}),t.createObjectStore(ci,{keyPath:"modelPath"})}var hs=function(){function n(t){if(this.indexedDB=l_(),t==null||!t)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=t}return n.prototype.save=function(t){return we(this,void 0,void 0,function(){return Se(this,function(e){if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return[2,this.databaseAction(this.modelPath,t)]})})},n.prototype.load=function(){return we(this,void 0,void 0,function(){return Se(this,function(t){return[2,this.databaseAction(this.modelPath)]})})},n.prototype.databaseAction=function(t,e){var r=this;return new Promise(function(a,i){var u=r.indexedDB.open("tensorflowjs",1);u.onupgradeneeded=function(){return pm(u)},u.onsuccess=function(){var l=u.result;if(e==null){var c=l.transaction(qi,"readonly"),f=c.objectStore(qi).get(r.modelPath);f.onsuccess=function(){if(f.result==null)return l.close(),i(new Error("Cannot find model with path '"+r.modelPath+"' in IndexedDB."));a(f.result.modelArtifacts)},f.onerror=function(w){return l.close(),i(f.error)},c.oncomplete=function(){return l.close()}}else{var d,v=vl(e),m=l.transaction(ci,"readwrite"),g=m.objectStore(ci),b=g.put({modelPath:r.modelPath,modelArtifactsInfo:v});b.onsuccess=function(){var w=(d=l.transaction(qi,"readwrite")).objectStore(qi).put({modelPath:r.modelPath,modelArtifacts:e,modelArtifactsInfo:v});w.onsuccess=function(){return a({modelArtifactsInfo:v})},w.onerror=function(S){var E=(g=m.objectStore(ci)).delete(r.modelPath);E.onsuccess=function(){return l.close(),i(w.error)},E.onerror=function(_){return l.close(),i(w.error)}}},b.onerror=function(w){return l.close(),i(b.error)},m.oncomplete=function(){d==null?l.close():d.oncomplete=function(){return l.close()}}}},u.onerror=function(l){return i(u.error)}})},n.URL_SCHEME="indexeddb://",n}(),Xw=function(n){return ue().getBool("IS_BROWSER")&&!Array.isArray(n)&&n.startsWith(hs.URL_SCHEME)?(t=n.slice(hs.URL_SCHEME.length),new hs(t)):null;var t};Zn.registerSaveRouter(Xw),Zn.registerLoadRouter(Xw);var vz=function(){function n(){this.indexedDB=l_()}return n.prototype.listModels=function(){return we(this,void 0,void 0,function(){var t=this;return Se(this,function(e){return[2,new Promise(function(r,a){var i=t.indexedDB.open("tensorflowjs",1);i.onupgradeneeded=function(){return pm(i)},i.onsuccess=function(){var u=i.result,l=u.transaction(ci,"readonly"),c=l.objectStore(ci).getAll();c.onsuccess=function(){for(var f={},d=0,v=c.result;d<v.length;d++){var m=v[d];f[m.modelPath]=m.modelArtifactsInfo}r(f)},c.onerror=function(f){return u.close(),a(c.error)},l.oncomplete=function(){return u.close()}},i.onerror=function(u){return a(i.error)}})]})})},n.prototype.removeModel=function(t){return we(this,void 0,void 0,function(){var e=this;return Se(this,function(r){var a;return t=(a=t).startsWith(hs.URL_SCHEME)?a.slice(hs.URL_SCHEME.length):a,[2,new Promise(function(i,u){var l=e.indexedDB.open("tensorflowjs",1);l.onupgradeneeded=function(){return pm(l)},l.onsuccess=function(){var c,f=l.result,d=f.transaction(ci,"readwrite"),v=d.objectStore(ci),m=v.get(t);m.onsuccess=function(){if(m.result==null)return f.close(),u(new Error("Cannot find model with path '"+t+"' in IndexedDB."));var g=v.delete(t),b=function(){var w=(c=f.transaction(qi,"readwrite")).objectStore(qi).delete(t);w.onsuccess=function(){return i(m.result.modelArtifactsInfo)},w.onerror=function(S){return u(m.error)}};g.onsuccess=b,g.onerror=function(w){return b(),f.close(),u(m.error)}},m.onerror=function(g){return f.close(),u(m.error)},d.oncomplete=function(){c==null?f.close():c.oncomplete=function(){return f.close()}}},l.onerror=function(c){return u(l.error)}})]})})},n}();if(ue().getBool("IS_BROWSER"))try{vi.registerManager(hs.URL_SCHEME,new vz)}catch{}var Sa="/",as="tensorflowjs_models",c_="info",mz="model_topology",gz="weight_specs",yz="weight_data",bz="model_metadata";function f_(n){return{info:[as,n,c_].join(Sa),topology:[as,n,mz].join(Sa),weightSpecs:[as,n,gz].join(Sa),weightData:[as,n,yz].join(Sa),modelMetadata:[as,n,bz].join(Sa)}}function xz(n){var t=n.split(Sa);if(t.length<3)throw new Error("Invalid key format: "+n);return t.slice(1,t.length-1).join(Sa)}var ds=function(){function n(t){if(!ue().getBool("IS_BROWSER")||typeof window>"u"||window.localStorage===void 0)throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,t==null||!t)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=t,this.keys=f_(this.modelPath)}return n.prototype.save=function(t){return we(this,void 0,void 0,function(){var e,r,a;return Se(this,function(i){if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");e=JSON.stringify(t.modelTopology),r=JSON.stringify(t.weightSpecs),a=vl(t);try{return this.LS.setItem(this.keys.info,JSON.stringify(a)),this.LS.setItem(this.keys.topology,e),this.LS.setItem(this.keys.weightSpecs,r),this.LS.setItem(this.keys.weightData,function(u){if(dm)return Buffer.from(u).toString("base64");for(var l=new Uint8Array(u),c="",f=0,d=l.length;f<d;f++)c+=String.fromCharCode(l[f]);return btoa(c)}(t.weightData)),this.LS.setItem(this.keys.modelMetadata,JSON.stringify({format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,userDefinedMetadata:t.userDefinedMetadata})),[2,{modelArtifactsInfo:a}]}catch{throw this.LS.removeItem(this.keys.info),this.LS.removeItem(this.keys.topology),this.LS.removeItem(this.keys.weightSpecs),this.LS.removeItem(this.keys.weightData),this.LS.removeItem(this.keys.modelMetadata),new Error("Failed to save model '"+this.modelPath+"' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes="+a.modelTopologyBytes+", weightSpecsBytes="+a.weightSpecsBytes+", weightDataBytes="+a.weightDataBytes+".")}return[2]})})},n.prototype.load=function(){return we(this,void 0,void 0,function(){var t,e,r,a,i,u,l;return Se(this,function(c){if((t=JSON.parse(this.LS.getItem(this.keys.info)))==null)throw new Error("In local storage, there is no model with name '"+this.modelPath+"'");if(t.modelTopologyType!=="JSON")throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");if(e={},(r=JSON.parse(this.LS.getItem(this.keys.topology)))==null)throw new Error("In local storage, the topology of model '"+this.modelPath+"' is missing.");if(e.modelTopology=r,(a=JSON.parse(this.LS.getItem(this.keys.weightSpecs)))==null)throw new Error("In local storage, the weight specs of model '"+this.modelPath+"' are missing.");if(e.weightSpecs=a,(i=this.LS.getItem(this.keys.modelMetadata))!=null&&(u=JSON.parse(i),e.format=u.format,e.generatedBy=u.generatedBy,e.convertedBy=u.convertedBy,e.userDefinedMetadata=u.userDefinedMetadata),(l=this.LS.getItem(this.keys.weightData))==null)throw new Error("In local storage, the binary weight values of model '"+this.modelPath+"' are missing.");return e.weightData=function(f){if(dm){var d=Buffer.from(f,"base64");return d.buffer.slice(d.byteOffset,d.byteOffset+d.byteLength)}for(var v=atob(f),m=new Uint8Array(v.length),g=0;g<v.length;++g)m.set([v.charCodeAt(g)],g);return m.buffer}(l),[2,e]})})},n.URL_SCHEME="localstorage://",n}(),Zw=function(n){return ue().getBool("IS_BROWSER")&&!Array.isArray(n)&&n.startsWith(ds.URL_SCHEME)?(t=n.slice(ds.URL_SCHEME.length),new ds(t)):null;var t};Zn.registerSaveRouter(Zw),Zn.registerLoadRouter(Zw);var wz=function(){function n(){P(ue().getBool("IS_BROWSER"),function(){return"Current environment is not a web browser"}),P(typeof window>"u"||window.localStorage!==void 0,function(){return"Current browser does not appear to support localStorage"}),this.LS=window.localStorage}return n.prototype.listModels=function(){return we(this,void 0,void 0,function(){var t,e,r,a,i,u;return Se(this,function(l){for(t={},e=as+Sa,r=Sa+c_,a=0;a<this.LS.length;++a)(i=this.LS.key(a)).startsWith(e)&&i.endsWith(r)&&(u=xz(i),t[u]=JSON.parse(this.LS.getItem(i)));return[2,t]})})},n.prototype.removeModel=function(t){return we(this,void 0,void 0,function(){var e,r;return Se(this,function(a){var i;if(t=(i=t).startsWith(ds.URL_SCHEME)?i.slice(ds.URL_SCHEME.length):i,e=f_(t),this.LS.getItem(e.info)==null)throw new Error("Cannot find model at path '"+t+"'");return r=JSON.parse(this.LS.getItem(e.info)),this.LS.removeItem(e.info),this.LS.removeItem(e.topology),this.LS.removeItem(e.weightSpecs),this.LS.removeItem(e.weightData),[2,r]})})},n}();if(ue().getBool("IS_BROWSER"))try{vi.registerManager(ds.URL_SCHEME,new wz)}catch{}var Sz="model",Ez=".json",_z=".weights.bin";function Yw(n){return new Promise(function(t){return setTimeout(t)}).then(n)}var bv=function(){function n(t){if(!ue().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");t.startsWith(n.URL_SCHEME)&&(t=t.slice(n.URL_SCHEME.length)),t!=null&&t.length!==0||(t=Sz),this.modelTopologyFileName=t+Ez,this.weightDataFileName=t+_z}return n.prototype.save=function(t){return we(this,void 0,void 0,function(){var e,r,a,i,u,l;return Se(this,function(c){switch(c.label){case 0:if(typeof document>"u")throw new Error("Browser downloads are not supported in this environment since `document` is not present");if(e=window.URL.createObjectURL(new Blob([t.weightData],{type:"application/octet-stream"})),!(t.modelTopology instanceof ArrayBuffer))return[3,1];throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");case 1:return r=[{paths:["./"+this.weightDataFileName],weights:t.weightSpecs}],a={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,weightsManifest:r},i=window.URL.createObjectURL(new Blob([JSON.stringify(a)],{type:"application/json"})),(u=this.jsonAnchor==null?document.createElement("a"):this.jsonAnchor).download=this.modelTopologyFileName,u.href=i,[4,Yw(function(){return u.dispatchEvent(new MouseEvent("click"))})];case 2:return c.sent(),t.weightData==null?[3,4]:((l=this.weightDataAnchor==null?document.createElement("a"):this.weightDataAnchor).download=this.weightDataFileName,l.href=e,[4,Yw(function(){return l.dispatchEvent(new MouseEvent("click"))})]);case 3:c.sent(),c.label=4;case 4:return[2,{modelArtifactsInfo:vl(t)}]}})})},n.URL_SCHEME="downloads://",n}(),Cz=function(){function n(t){if(t==null||t.length<1)throw new Error("When calling browserFiles, at least 1 file is required, but received "+t);this.files=t}return n.prototype.load=function(){return we(this,void 0,void 0,function(){var t,e,r=this;return Se(this,function(a){return t=this.files[0],e=this.files.slice(1),[2,new Promise(function(i,u){var l=new FileReader;l.onload=function(c){var f=JSON.parse(c.target.result),d=f.modelTopology;if(d!=null){e.length===0&&i({modelTopology:d});var v=f.weightsManifest;if(v!=null){var m;try{m=r.checkManifestAndWeightFiles(v,e)}catch(S){return void u(S)}var g=[],b=[],w=[];v.forEach(function(S){S.paths.forEach(function(E){b.push(E),w.push(null)}),g.push.apply(g,S.weights)}),v.forEach(function(S){S.paths.forEach(function(E){var _=new FileReader;_.onload=function(R){var C=R.target.result,A=b.indexOf(E);w[A]=C,w.indexOf(null)===-1&&i({modelTopology:d,weightSpecs:g,weightData:yg(w),format:f.format,generatedBy:f.generatedBy,convertedBy:f.convertedBy,userDefinedMetadata:f.userDefinedMetadata})},_.onerror=function(R){return u("Failed to weights data from file of path '"+E+"'.")},_.readAsArrayBuffer(m[E])})})}else u(new Error("weightManifest field is missing from file "+t.name))}else u(new Error("modelTopology field is missing from file "+t.name))},l.onerror=function(c){return u("Failed to read model topology and weights manifest JSON from file '"+t.name+"'. BrowserFiles supports loading Keras-style tf.Model artifacts only.")},l.readAsText(t)})]})})},n.prototype.checkManifestAndWeightFiles=function(t,e){for(var r=[],a=e.map(function(c){return $w(c.name)}),i={},u=0,l=t;u<l.length;u++)l[u].paths.forEach(function(c){var f=$w(c);if(r.indexOf(f)!==-1)throw new Error("Duplicate file basename found in weights manifest: '"+f+"'");if(r.push(f),a.indexOf(f)===-1)throw new Error("Weight file with basename '"+f+"' is not provided.");i[c]=e[a.indexOf(f)]});if(r.length!==e.length)throw new Error("Mismatch in the number of files in weights manifest ("+r.length+") and the number of weight files provided ("+e.length+").");return i},n}();function Qw(n,t,e,r){(function(i){P(i!=null&&Array.isArray(i)&&i.length>0,function(){return"promises must be a none empty array"})})(n),function(i,u){P(i>=0&&i<=1,function(){return"Progress fraction must be in range [0, 1], but got startFraction "+i}),P(u>=0&&u<=1,function(){return"Progress fraction must be in range [0, 1], but got endFraction "+u}),P(u>=i,function(){return"startFraction must be no more than endFraction, but got startFraction "+i+" and endFraction "+u})}(e=e??0,r=r??1);var a=0;return Promise.all(n.map(function(i){return i.then(function(u){var l=e+ ++a/n.length*(r-e);return t(l),u}),i}))}function h_(n,t){return we(this,void 0,void 0,function(){var e,r,a,i,u,l,c,f,d;return Se(this,function(v){switch(v.label){case 0:return t==null&&(t={}),e=t.fetchFunc==null?ue().platform.fetch:t.fetchFunc,r=n.map(function(m){return e(m,t.requestInit,{isBinary:!0})}),a=0,i=.5,t.onProgress!=null?[3,2]:[4,Promise.all(r)];case 1:return u=v.sent(),[3,4];case 2:return[4,Qw(r,t.onProgress,a,i)];case 3:u=v.sent(),v.label=4;case 4:return l=u.map(function(m){return m.arrayBuffer()}),c=.5,f=1,t.onProgress!=null?[3,6]:[4,Promise.all(l)];case 5:return d=v.sent(),[3,8];case 6:return[4,Qw(l,t.onProgress,c,f)];case 7:d=v.sent(),v.label=8;case 8:return[2,d]}})})}function Jw(n){var t=this;return function(e,r,a){return r===void 0&&(r=""),we(t,void 0,void 0,function(){var i,u,l,c,f,d,v,m,g,b;return Se(this,function(w){switch(w.label){case 0:if(i=e.map(function(){return!1}),u={},l=a!=null?a.map(function(){return!1}):[],c=[],e.forEach(function(S,E){var _=0;S.weights.forEach(function(R){var C="quantization"in R?R.quantization.dtype:R.dtype,A=hm[C]*Ee(R.shape),D=function(){i[E]=!0,u[E]==null&&(u[E]=[]),u[E].push({manifestEntry:R,groupOffset:_,sizeBytes:A})};a!=null?a.forEach(function(O,F){O===R.name&&(D(),l[F]=!0)}):D(),c.push(R.name),_+=A})}),!l.every(function(S){return S}))throw f=a.filter(function(S,E){return!l[E]}),new Error("Could not find weights in manifest with names: "+f.join(", ")+`. 
Manifest JSON has weights with names: `+c.join(", ")+".");return d=i.reduce(function(S,E,_){return E&&S.push(_),S},[]),v=[],d.forEach(function(S){e[S].paths.forEach(function(E){var _=r+(r.endsWith("/")?"":"/")+E;v.push(_)})}),[4,n(v)];case 1:return m=w.sent(),g={},b=0,d.forEach(function(S){for(var E=e[S].paths.length,_=0,R=0;R<E;R++)_+=m[b+R].byteLength;for(var C=new ArrayBuffer(_),A=new Uint8Array(C),D=0,O=0;O<E;O++){var F=new Uint8Array(m[b+O]);A.set(F,D),D+=F.byteLength}u[S].forEach(function(N){var B=u_(C.slice(N.groupOffset,N.groupOffset+N.sizeBytes),[N.manifestEntry]);for(var H in B)g[H]=B[H]}),b+=E}),[2,g]}})})}}Zn.registerSaveRouter(function(n){return ue().getBool("IS_BROWSER")&&!Array.isArray(n)&&n.startsWith(bv.URL_SCHEME)?function(t){return t===void 0&&(t="model"),new bv(t)}(n.slice(bv.URL_SCHEME.length)):null});var d_=function(){function n(t,e){if(this.DEFAULT_METHOD="POST",e==null&&(e={}),this.weightPathPrefix=e.weightPathPrefix,this.onProgress=e.onProgress,e.fetchFunc!=null?(P(typeof e.fetchFunc=="function",function(){return"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"}),this.fetch=e.fetchFunc):this.fetch=ue().platform.fetch,P(t!=null&&t.length>0,function(){return"URL path for http must not be null, undefined or empty."}),Array.isArray(t)&&P(t.length===2,function(){return"URL paths for http must have a length of 2, (actual length is "+t.length+")."}),this.path=t,e.requestInit!=null&&e.requestInit.body!=null)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=e.requestInit||{}}return n.prototype.save=function(t){return we(this,void 0,void 0,function(){var e,r,a,i;return Se(this,function(u){switch(u.label){case 0:if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");return(e=Object.assign({method:this.DEFAULT_METHOD},this.requestInit)).body=new FormData,r=[{paths:["./model.weights.bin"],weights:t.weightSpecs}],a={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,userDefinedMetadata:t.userDefinedMetadata,weightsManifest:r},e.body.append("model.json",new Blob([JSON.stringify(a)],{type:"application/json"}),"model.json"),t.weightData!=null&&e.body.append("model.weights.bin",new Blob([t.weightData],{type:"application/octet-stream"}),"model.weights.bin"),[4,this.fetch(this.path,e)];case 1:if((i=u.sent()).ok)return[2,{modelArtifactsInfo:vl(t),responses:[i]}];throw new Error("BrowserHTTPRequest.save() failed due to HTTP response status "+i.status+".")}})})},n.prototype.load=function(){return we(this,void 0,void 0,function(){var t,e,r,a,i,u,l,c,f,d,v,m;return Se(this,function(g){switch(g.label){case 0:return[4,this.fetch(this.path,this.requestInit)];case 1:if(!(t=g.sent()).ok)throw new Error("Request to "+this.path+" failed with status code "+t.status+". Please verify this URL points to the model JSON of the model to load.");g.label=2;case 2:return g.trys.push([2,4,,5]),[4,t.json()];case 3:return e=g.sent(),[3,5];case 4:throw g.sent(),r="Failed to parse model JSON of response from "+this.path+".",this.path.endsWith(".pb")?r+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":r+=" Please make sure the server is serving valid JSON for this request.",new Error(r);case 5:if(a=e.modelTopology,i=e.weightsManifest,u=e.generatedBy,l=e.convertedBy,c=e.format,f=e.userDefinedMetadata,a==null&&i==null)throw new Error("The JSON from HTTP path "+this.path+" contains neither model topology or manifest for weights.");return i==null?[3,7]:[4,this.loadWeights(i)];case 6:m=g.sent(),d=m[0],v=m[1],g.label=7;case 7:return[2,{modelTopology:a,weightSpecs:d,weightData:v,userDefinedMetadata:f,generatedBy:u,convertedBy:l,format:c}]}})})},n.prototype.loadWeights=function(t){return we(this,void 0,void 0,function(){var e,r,a,i,u,l,c,f,d,v,m;return Se(this,function(g){switch(g.label){case 0:for(e=Array.isArray(this.path)?this.path[1]:this.path,r=function(b){var w=b.lastIndexOf("/"),S=b.lastIndexOf("?"),E=b.substring(0,w),_=S>w?b.substring(S):"";return[E+"/",_]}(e),a=r[0],i=r[1],u=this.weightPathPrefix||a,l=[],c=0,f=t;c<f.length;c++)d=f[c],l.push.apply(l,d.weights);return v=[],t.forEach(function(b){b.paths.forEach(function(w){v.push(u+w+i)})}),[4,h_(v,{requestInit:this.requestInit,fetchFunc:this.fetch,onProgress:this.onProgress})];case 1:return m=g.sent(),[2,[l,yg(m)]]}})})},n.URL_SCHEME_REGEX=/^https?:\/\//,n}();function vm(n){return n.match(d_.URL_SCHEME_REGEX)!=null}var e2=function(n,t){return typeof fetch>"u"?null:(Array.isArray(n)?n.every(function(e){return vm(e)}):vm(n))?mm(n,{onProgress:t}):null};function mm(n,t){return new d_(n,t)}Zn.registerSaveRouter(e2),Zn.registerLoadRouter(e2);var xv=function(){function n(t){this.modelArtifacts=t}return n.prototype.load=function(){return we(this,void 0,void 0,function(){return Se(this,function(t){return[2,this.modelArtifacts]})})},n}(),Rz=function(){function n(t){this.saveHandler=t}return n.prototype.save=function(t){return we(this,void 0,void 0,function(){return Se(this,function(e){return[2,this.saveHandler(t)]})})},n}(),p_=Object.freeze({browserFiles:function(n){return new Cz(n)},browserHTTPRequest:function(n,t){return mm(n,t)},concatenateArrayBuffers:yg,decodeWeights:u_,encodeWeights:function(n,t){return we(this,void 0,void 0,function(){var e,r,a,i,u,l=this;return Se(this,function(c){switch(c.label){case 0:for(e=[],r=[],a=Array.isArray(n)?n.map(function(f){return f.name}):Object.keys(n),i=function(f){var d=a[f],v=Array.isArray(n)?n[f].tensor:n[d];if(v.dtype!=="float32"&&v.dtype!=="int32"&&v.dtype!=="bool"&&v.dtype!=="string")throw new Error("Unsupported dtype in weight '"+d+"': "+v.dtype);var m={name:d,shape:v.shape,dtype:v.dtype};if(v.dtype==="string"){var g=new Promise(function(b){return we(l,void 0,void 0,function(){var w,S,E,_,R,C,A;return Se(this,function(D){switch(D.label){case 0:return[4,v.bytes()];case 1:for(w=D.sent(),S=w.reduce(function(O,F){return O+F.length},0)+Uf*w.length,E=new Uint8Array(S),_=0,R=0;R<w.length;R++)C=w[R],A=new Uint8Array(new Uint32Array([C.length]).buffer),E.set(A,_),_+=Uf,E.set(C,_),_+=C.length;return b(E),[2]}})})});r.push(g)}else r.push(v.data());t!=null&&(m.group=t),e.push(m)},u=0;u<a.length;++u)i(u);return[4,Promise.all(r)];case 1:return[2,{data:pz(c.sent()),specs:e}]}})})},fromMemory:function(n,t,e,r){return arguments.length===1?n.modelTopology!=null||n.weightSpecs!=null?new xv(n):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new xv({modelTopology:n})):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new xv({modelTopology:n,weightSpecs:t,weightData:e,trainingConfig:r}))},getLoadHandlers:function(n,t){return Zn.getLoadHandlers(n,t)},getModelArtifactsInfoForJSON:vl,getSaveHandlers:function(n){return Zn.getSaveHandlers(n)},http:mm,isHTTPScheme:vm,loadWeights:function(n,t,e,r){return t===void 0&&(t=""),we(this,void 0,void 0,function(){return Se(this,function(a){return[2,Jw(function(i){return h_(i,{requestInit:r})})(n,t,e)]})})},registerLoadRouter:function(n){return Zn.registerLoadRouter(n)},registerSaveRouter:function(n){return Zn.registerSaveRouter(n)},weightsLoaderFactory:Jw,withSaveHandler:function(n){return new Rz(n)},copyModel:function(n,t){return we(this,void 0,void 0,function(){return Se(this,function(e){return[2,Kw(n,t,!1)]})})},listModels:function(){return we(this,void 0,void 0,function(){var n,t,e,r,a,i,u;return Se(this,function(l){switch(l.label){case 0:n=vi.getSchemes(),t={},e=0,r=n,l.label=1;case 1:return e<r.length?(a=r[e],[4,vi.getManager(a).listModels()]):[3,4];case 2:for(u in i=l.sent())t[a+fs+u]=i[u];l.label=3;case 3:return e++,[3,1];case 4:return[2,t]}})})},moveModel:function(n,t){return we(this,void 0,void 0,function(){return Se(this,function(e){return[2,Kw(n,t,!0)]})})},removeModel:function(n){return we(this,void 0,void 0,function(){var t;return Se(this,function(e){return t=uf(n),[2,vi.getManager(t.scheme).removeModel(t.path)]})})}}),Qo;V({confusionMatrix_:function(n,t,e){var r=I(n,"labels","confusionMatrix"),a=I(t,"predictions","confusionMatrix");P(e==null||e>0&&Number.isInteger(e),function(){return"If provided, numClasses must be a positive integer, but got "+e}),P(r.rank===1,function(){return"Expected the rank of labels to be 1, but got "+r.rank}),P(a.rank===1,function(){return"Expected the rank of predictions to be 1, but got "+a.rank}),P(r.shape[0]===a.shape[0],function(){return"Mismatch in the number of examples: "+r.shape[0]+" vs. "+a.shape[0]+". Labels and predictions should have the same number of elements."}),P(e>0&&Number.isInteger(e),function(){return"numClasses is required to be a positive integer, but got "+e});var i=sm(r.asType("int32"),e),u=sm(a.asType("int32"),e);return i.transpose().matMul(u).asType("int32")}});var Az=V({fromPixels_:function(n,t){if(t===void 0&&(t=3),t>4)throw new Error("Cannot construct Tensor with more than 4 channels from pixels.");if(n==null)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");var e=!1,r=!1,a=!1,i=!1,u=!1;if(n.data instanceof Uint8Array)e=!0;else if(typeof ImageData<"u"&&n instanceof ImageData)r=!0;else if(typeof HTMLVideoElement<"u"&&n instanceof HTMLVideoElement)a=!0;else if(typeof HTMLImageElement<"u"&&n instanceof HTMLImageElement)i=!0;else{if(n.getContext==null)throw new Error("pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData in browser, or OffscreenCanvas, ImageData in webworker or {data: Uint32Array, width: number, height: number}, but was "+n.constructor.name);u=!0}if(a&&a&&n.readyState<2)throw new Error("The video element has not loaded data yet. Please wait for `loadeddata` event on the <video> element.");if(LS("FromPixels",q.backendName)!=null)return q.runKernel("FromPixels",{pixels:n},{numChannels:t});var l,c,f=a?[n.videoWidth,n.videoHeight]:[n.width,n.height],d=f[0],v=f[1];if(u?l=n.getContext("2d").getImageData(0,0,d,v).data:r||e?l=n.data:(i||a)&&(Qo==null&&(Qo=document.createElement("canvas").getContext("2d")),Qo.canvas.width=d,Qo.canvas.height=v,Qo.drawImage(n,0,0,d,v),l=Qo.getImageData(0,0,d,v).data),t===4)c=new Int32Array(l);else{var m=d*v;c=new Int32Array(m*t);for(var g=0;g<m;g++)for(var b=0;b<t;++b)c[g*t+b]=l[4*g+b]}return $m(c,[v,d,t],"int32")}}),bg=Object.freeze({toPixels:function(n,t){return we(this,void 0,void 0,function(){var e,r,a,i,u,l,c,f,d,v,m,g,b,w,S,E,_,R,C,A,D,O,F;return Se(this,function(N){switch(N.label){case 0:if(e=I(n,"img","toPixels"),n instanceof wt||(e=e.toInt()),e.rank!==2&&e.rank!==3)throw new Error("toPixels only supports rank 2 or 3 tensors, got rank "+e.rank+".");if(r=e.shape.slice(0,2),a=r[0],i=r[1],(u=e.rank===2?1:e.shape[2])>4||u===2)throw new Error("toPixels only supports depth of size 1, 3 or 4 but got "+u);return[4,e.data()];case 1:return l=N.sent(),c=e.min(),f=e.max(),[4,Promise.all([c.data(),f.data()])];case 2:if(d=N.sent(),v=d[0],m=d[1],g=v[0],b=m[0],c.dispose(),f.dispose(),e.dtype==="float32"){if(g<0||b>1)throw new Error("Tensor values for a float32 Tensor must be in the range [0 - 1] but got range ["+g+" - "+b+"].")}else{if(e.dtype!=="int32")throw new Error("Unsupported type for toPixels: "+e.dtype+". Please use float32 or int32 tensors.");if(g<0||b>255)throw new Error("Tensor values for a int32 Tensor must be in the range [0 - 255] but got range ["+g+" - "+b+"].")}for(w=e.dtype==="float32"?255:1,S=new Uint8ClampedArray(i*a*4),E=0;E<a*i;++E)_=void 0,R=void 0,C=void 0,A=void 0,u===1?(_=l[E]*w,R=l[E]*w,C=l[E]*w,A=255):u===3?(_=l[3*E]*w,R=l[3*E+1]*w,C=l[3*E+2]*w,A=255):u===4&&(_=l[4*E]*w,R=l[4*E+1]*w,C=l[4*E+2]*w,A=l[4*E+3]*w),S[(D=4*E)+0]=Math.round(_),S[D+1]=Math.round(R),S[D+2]=Math.round(C),S[D+3]=Math.round(A);return t!=null&&(t.width=i,t.height=a,O=t.getContext("2d"),F=new ImageData(S,i,a),O.putImageData(F,0,0)),e!==n&&e.dispose(),[2,S]}})})},fromPixels:Az}),Tz=function(){function n(){}return n.prototype.getClassName=function(){return this.constructor.className},n.fromConfig=function(t,e){return new t(e)},n}(),Dz=function(){function n(){this.classNameMap={}}return n.getMap=function(){return n.instance==null&&(n.instance=new n),n.instance},n.register=function(t){n.getMap().classNameMap[t.className]=[t,t.fromConfig]},n}();function oo(n){P(n.className!=null,function(){return"Class being registered does not have the static className property defined."}),P(typeof n.className=="string",function(){return"className is required to be a string, but got type "+typeof n.className}),P(n.className.length>0,function(){return"Class being registered has an empty-string as its className, which is disallowed."}),Dz.register(n)}var so=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return Dr(t,n),t.prototype.minimize=function(e,r,a){r===void 0&&(r=!1);var i=this.computeGradients(e,a),u=i.value,l=i.grads;if(a!=null){var c=a.map(function(f){return{name:f.name,tensor:l[f.name]}});this.applyGradients(c)}else this.applyGradients(l);return Fn(l),r?u:(u.dispose(),null)},Object.defineProperty(t.prototype,"iterations",{get:function(){return this.iterations_==null&&(this.iterations_=0),this.iterations_},enumerable:!0,configurable:!0}),t.prototype.incrementIterations=function(){this.iterations_=this.iterations+1},t.prototype.computeGradients=function(e,r){return zI(e,r)},t.prototype.dispose=function(){this.iterations_!=null&&Fn(this.iterations_)},t.prototype.saveIterations=function(){return we(this,void 0,void 0,function(){return Se(this,function(e){return this.iterations_==null&&(this.iterations_=0),[2,{name:"iter",tensor:ge(this.iterations_,"int32")}]})})},t.prototype.getWeights=function(){return we(this,void 0,void 0,function(){return Se(this,function(e){throw new Error("getWeights() is not implemented for this optimizer yet.")})})},t.prototype.setWeights=function(e){return we(this,void 0,void 0,function(){return Se(this,function(r){throw new Error("setWeights() is not implemented for this optimizer class "+this.getClassName())})})},t.prototype.extractIterations=function(e){return we(this,void 0,void 0,function(){var r;return Se(this,function(a){switch(a.label){case 0:return r=this,[4,e[0].tensor.data()];case 1:return r.iterations_=a.sent()[0],[2,e.slice(1)]}})})},t}(Tz);Object.defineProperty(so,Symbol.hasInstance,{value:function(n){return n.minimize!=null&&n.computeGradients!=null&&n.applyGradients!=null}});var Oz=function(n){function t(e,r,a){a===void 0&&(a=null);var i=n.call(this)||this;return i.learningRate=e,i.rho=r,i.epsilon=a,i.accumulatedGrads=[],i.accumulatedUpdates=[],a==null&&(i.epsilon=q.backend.epsilon()),i}return Dr(t,n),t.prototype.applyGradients=function(e){var r=this;(Array.isArray(e)?e.map(function(a){return a.name}):Object.keys(e)).forEach(function(a,i){var u=q.registeredVariables[a];r.accumulatedGrads[i]==null&&(r.accumulatedGrads[i]={originalName:a+"/accum_grad",variable:be(function(){return Ye(u).variable(!1)})}),r.accumulatedUpdates[i]==null&&(r.accumulatedUpdates[i]={originalName:a+"/accum_var",variable:be(function(){return Ye(u).variable(!1)})});var l=Array.isArray(e)?e[i].tensor:e[a];if(l!=null){var c=r.accumulatedGrads[i].variable,f=r.accumulatedUpdates[i].variable;be(function(){var d=c.mul(r.rho).add(l.square().mul(1-r.rho)),v=f.add(r.epsilon).sqrt().div(c.add(r.epsilon).sqrt()).mul(l),m=f.mul(r.rho).add(v.square().mul(1-r.rho));c.assign(d),f.assign(m);var g=v.mul(-r.learningRate).add(u);u.assign(g)})}}),this.incrementIterations()},t.prototype.dispose=function(){this.accumulatedUpdates!=null&&(Fn(this.accumulatedGrads.map(function(e){return e.variable})),Fn(this.accumulatedUpdates.map(function(e){return e.variable})))},t.prototype.getWeights=function(){return we(this,void 0,void 0,function(){var e;return Se(this,function(r){switch(r.label){case 0:return e=this.accumulatedGrads.concat(this.accumulatedUpdates),[4,this.saveIterations()];case 1:return[2,[r.sent()].concat(e.map(function(a){return{name:a.originalName,tensor:a.variable}}))]}})})},t.prototype.setWeights=function(e){return we(this,void 0,void 0,function(){var r;return Se(this,function(a){switch(a.label){case 0:return[4,this.extractIterations(e)];case 1:return e=a.sent(),r=e.length/2,this.accumulatedGrads=e.slice(0,r).map(function(i){return{originalName:i.name,variable:i.tensor.variable(!1)}}),this.accumulatedUpdates=e.slice(r,2*r).map(function(i){return{originalName:i.name,variable:i.tensor.variable(!1)}}),[2]}})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}},t.fromConfig=function(e,r){return new e(r.learningRate,r.rho,r.epsilon)},t.className="Adadelta",t}(so);oo(Oz);var kz=function(n){function t(e,r){r===void 0&&(r=.1);var a=n.call(this)||this;return a.learningRate=e,a.initialAccumulatorValue=r,a.accumulatedGrads=[],a}return Dr(t,n),t.prototype.applyGradients=function(e){var r=this;(Array.isArray(e)?e.map(function(a){return a.name}):Object.keys(e)).forEach(function(a,i){var u=q.registeredVariables[a];r.accumulatedGrads[i]==null&&(r.accumulatedGrads[i]={originalName:a+"/accumulator",variable:be(function(){return Kr(u.shape,r.initialAccumulatorValue).variable(!1)})});var l=Array.isArray(e)?e[i].tensor:e[a];if(l!=null){var c=r.accumulatedGrads[i].variable;be(function(){var f=c.add(l.square());c.assign(f);var d=l.div(f.add(q.backend.epsilon()).sqrt()).mul(-r.learningRate).add(u);u.assign(d)})}}),this.incrementIterations()},t.prototype.dispose=function(){this.accumulatedGrads!=null&&Fn(this.accumulatedGrads.map(function(e){return e.variable}))},t.prototype.getWeights=function(){return we(this,void 0,void 0,function(){return Se(this,function(e){switch(e.label){case 0:return[4,this.saveIterations()];case 1:return[2,[e.sent()].concat(this.accumulatedGrads.map(function(r){return{name:r.originalName,tensor:r.variable}}))]}})})},t.prototype.setWeights=function(e){return we(this,void 0,void 0,function(){return Se(this,function(r){switch(r.label){case 0:return[4,this.extractIterations(e)];case 1:return e=r.sent(),this.accumulatedGrads=e.map(function(a){return{originalName:a.name,variable:a.tensor.variable(!1)}}),[2]}})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}},t.fromConfig=function(e,r){return new e(r.learningRate,r.initialAccumulatorValue)},t.className="Adagrad",t}(so);oo(kz);var Nz=function(n){function t(e,r,a,i){i===void 0&&(i=null);var u=n.call(this)||this;return u.learningRate=e,u.beta1=r,u.beta2=a,u.epsilon=i,u.accumulatedFirstMoment=[],u.accumulatedSecondMoment=[],be(function(){u.accBeta1=ge(r).variable(),u.accBeta2=ge(a).variable()}),i==null&&(u.epsilon=q.backend.epsilon()),u}return Dr(t,n),t.prototype.applyGradients=function(e){var r=this,a=Array.isArray(e)?e.map(function(i){return i.name}):Object.keys(e);be(function(){var i=$t(1,r.accBeta1),u=$t(1,r.accBeta2);a.forEach(function(l,c){var f=q.registeredVariables[l];r.accumulatedFirstMoment[c]==null&&(r.accumulatedFirstMoment[c]={originalName:l+"/m",variable:be(function(){return Ye(f).variable(!1)})}),r.accumulatedSecondMoment[c]==null&&(r.accumulatedSecondMoment[c]={originalName:l+"/v",variable:be(function(){return Ye(f).variable(!1)})});var d=Array.isArray(e)?e[c].tensor:e[l];if(d!=null){var v=r.accumulatedFirstMoment[c].variable,m=r.accumulatedSecondMoment[c].variable,g=v.mul(r.beta1).add(d.mul(1-r.beta1)),b=m.mul(r.beta2).add(d.square().mul(1-r.beta2)),w=g.div(i),S=b.div(u);v.assign(g),m.assign(b);var E=w.div(S.sqrt().add(r.epsilon)).mul(-r.learningRate).add(f);f.assign(E)}}),r.accBeta1.assign(r.accBeta1.mul(r.beta1)),r.accBeta2.assign(r.accBeta2.mul(r.beta2))}),this.incrementIterations()},t.prototype.dispose=function(){this.accBeta1.dispose(),this.accBeta2.dispose(),this.accumulatedFirstMoment!=null&&Fn(this.accumulatedFirstMoment.map(function(e){return e.variable})),this.accumulatedSecondMoment!=null&&Fn(this.accumulatedSecondMoment.map(function(e){return e.variable}))},t.prototype.getWeights=function(){return we(this,void 0,void 0,function(){var e;return Se(this,function(r){switch(r.label){case 0:return e=this.accumulatedFirstMoment.concat(this.accumulatedSecondMoment),[4,this.saveIterations()];case 1:return[2,[r.sent()].concat(e.map(function(a){return{name:a.originalName,tensor:a.variable}}))]}})})},t.prototype.setWeights=function(e){return we(this,void 0,void 0,function(){var r,a=this;return Se(this,function(i){switch(i.label){case 0:return[4,this.extractIterations(e)];case 1:return e=i.sent(),be(function(){a.accBeta1.assign(Lf(a.beta1,a.iterations_+1)),a.accBeta2.assign(Lf(a.beta2,a.iterations_+1))}),r=e.length/2,this.accumulatedFirstMoment=e.slice(0,r).map(function(u){return{originalName:u.name,variable:u.tensor.variable(!1)}}),this.accumulatedSecondMoment=e.slice(r,2*r).map(function(u){return{originalName:u.name,variable:u.tensor.variable(!1)}}),[2]}})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}},t.fromConfig=function(e,r){return new e(r.learningRate,r.beta1,r.beta2,r.epsilon)},t.className="Adam",t}(so);oo(Nz);var Mz=function(n){function t(e,r,a,i,u){i===void 0&&(i=null),u===void 0&&(u=0);var l=n.call(this)||this;return l.learningRate=e,l.beta1=r,l.beta2=a,l.epsilon=i,l.decay=u,l.accumulatedFirstMoment=[],l.accumulatedWeightedInfNorm=[],be(function(){l.iteration=ge(0).variable(),l.accBeta1=ge(r).variable()}),i==null&&(l.epsilon=q.backend.epsilon()),l}return Dr(t,n),t.prototype.applyGradients=function(e){var r=this,a=Array.isArray(e)?e.map(function(i){return i.name}):Object.keys(e);be(function(){var i=$t(1,r.accBeta1),u=_r(-r.learningRate,r.iteration.mul(r.decay).add(1));a.forEach(function(l,c){var f=q.registeredVariables[l];r.accumulatedFirstMoment[c]==null&&(r.accumulatedFirstMoment[c]={originalName:l+"/m",variable:Ye(f).variable(!1)}),r.accumulatedWeightedInfNorm[c]==null&&(r.accumulatedWeightedInfNorm[c]={originalName:l+"/v",variable:Ye(f).variable(!1)});var d=Array.isArray(e)?e[c].tensor:e[l];if(d!=null){var v=r.accumulatedFirstMoment[c].variable,m=r.accumulatedWeightedInfNorm[c].variable,g=v.mul(r.beta1).add(d.mul(1-r.beta1)),b=m.mul(r.beta2),w=d.abs(),S=b.maximum(w);v.assign(g),m.assign(S);var E=u.div(i).mul(g.div(S.add(r.epsilon))).add(f);f.assign(E)}}),r.iteration.assign(r.iteration.add(1)),r.accBeta1.assign(r.accBeta1.mul(r.beta1))}),this.incrementIterations()},t.prototype.dispose=function(){this.accBeta1.dispose(),this.iteration.dispose(),this.accumulatedFirstMoment!=null&&Fn(this.accumulatedFirstMoment.map(function(e){return e.variable})),this.accumulatedWeightedInfNorm!=null&&Fn(this.accumulatedWeightedInfNorm.map(function(e){return e.variable}))},t.prototype.getWeights=function(){return we(this,void 0,void 0,function(){return Se(this,function(e){throw new Error("getWeights() is not implemented for Adamax yet.")})})},t.prototype.setWeights=function(e){return we(this,void 0,void 0,function(){return Se(this,function(r){throw new Error("setWeights() is not implemented for Adamax yet.")})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}},t.fromConfig=function(e,r){return new e(r.learningRate,r.beta1,r.beta2,r.epsilon,r.decay)},t.className="Adamax",t}(so);oo(Mz);var v_=function(n){function t(e){var r=n.call(this)||this;return r.learningRate=e,r.setLearningRate(e),r}return Dr(t,n),t.prototype.applyGradients=function(e){var r=this;(Array.isArray(e)?e.map(function(a){return a.name}):Object.keys(e)).forEach(function(a,i){var u=Array.isArray(e)?e[i].tensor:e[a];if(u!=null){var l=q.registeredVariables[a];be(function(){var c=r.c.mul(u).add(l);l.assign(c)})}}),this.incrementIterations()},t.prototype.setLearningRate=function(e){this.learningRate=e,this.c!=null&&this.c.dispose(),this.c=JM(ge(-e))},t.prototype.dispose=function(){this.c.dispose()},t.prototype.getWeights=function(){return we(this,void 0,void 0,function(){return Se(this,function(e){switch(e.label){case 0:return[4,this.saveIterations()];case 1:return[2,[e.sent()]]}})})},t.prototype.setWeights=function(e){return we(this,void 0,void 0,function(){return Se(this,function(r){switch(r.label){case 0:return[4,this.extractIterations(e)];case 1:if((e=r.sent()).length!==0)throw new Error("SGD optimizer does not have settable weights.");return[2]}})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate}},t.fromConfig=function(e,r){return new e(r.learningRate)},t.className="SGD",t}(so);oo(v_);var Iz=function(n){function t(e,r,a){a===void 0&&(a=!1);var i=n.call(this,e)||this;return i.learningRate=e,i.momentum=r,i.useNesterov=a,i.accumulations=[],i.m=ge(i.momentum),i}return Dr(t,n),t.prototype.applyGradients=function(e){var r=this;(Array.isArray(e)?e.map(function(a){return a.name}):Object.keys(e)).forEach(function(a,i){var u=q.registeredVariables[a];r.accumulations[i]==null&&(r.accumulations[i]={originalName:a+"/momentum",variable:be(function(){return Ye(u).variable(!1)})});var l=r.accumulations[i].variable,c=Array.isArray(e)?e[i].tensor:e[a];c!=null&&be(function(){var f,d=r.m.mul(l).add(c);f=r.useNesterov?r.c.mul(c.add(d.mul(r.m))).add(u):r.c.mul(d).add(u),l.assign(d),u.assign(f)})}),this.incrementIterations()},t.prototype.dispose=function(){this.m.dispose(),this.accumulations!=null&&Fn(this.accumulations.map(function(e){return e.variable}))},t.prototype.setMomentum=function(e){this.momentum=e},t.prototype.getWeights=function(){return we(this,void 0,void 0,function(){return Se(this,function(e){switch(e.label){case 0:return[4,this.saveIterations()];case 1:return[2,[e.sent()].concat(this.accumulations.map(function(r){return{name:r.originalName,tensor:r.variable}}))]}})})},t.prototype.setWeights=function(e){return we(this,void 0,void 0,function(){return Se(this,function(r){switch(r.label){case 0:return[4,this.extractIterations(e)];case 1:return e=r.sent(),this.accumulations=e.map(function(a){return{originalName:a.name,variable:a.tensor.variable(!1)}}),[2]}})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}},t.fromConfig=function(e,r){return new e(r.learningRate,r.momentum,r.useNesterov)},t.className="Momentum",t}(v_);oo(Iz);var Fz=function(n){function t(e,r,a,i,u){r===void 0&&(r=.9),a===void 0&&(a=0),i===void 0&&(i=null),u===void 0&&(u=!1);var l=n.call(this)||this;if(l.learningRate=e,l.decay=r,l.momentum=a,l.epsilon=i,l.accumulatedMeanSquares=[],l.accumulatedMoments=[],l.accumulatedMeanGrads=[],l.centered=u,i==null&&(l.epsilon=q.backend.epsilon()),e==null)throw new Error("learningRate for RMSPropOptimizer must be defined.");return l}return Dr(t,n),t.prototype.applyGradients=function(e){var r=this;(Array.isArray(e)?e.map(function(a){return a.name}):Object.keys(e)).forEach(function(a,i){var u=q.registeredVariables[a];r.accumulatedMeanSquares[i]==null&&(r.accumulatedMeanSquares[i]={originalName:a+"/rms",variable:be(function(){return Ye(u).variable(!1)})}),r.accumulatedMoments[i]==null&&(r.accumulatedMoments[i]={originalName:a+"/momentum",variable:be(function(){return Ye(u).variable(!1)})}),r.accumulatedMeanGrads[i]==null&&r.centered&&(r.accumulatedMeanGrads[i]={originalName:a+"/mg",variable:be(function(){return Ye(u).variable(!1)})});var l=Array.isArray(e)?e[i].tensor:e[a];if(l!=null){var c=r.accumulatedMeanSquares[i].variable,f=r.accumulatedMoments[i].variable;be(function(){var d=c.mul(r.decay).add(l.square().mul(1-r.decay));if(r.centered){var v=r.accumulatedMeanGrads[i].variable,m=v.mul(r.decay).add(l.mul(1-r.decay)),g=f.mul(r.momentum).add(l.mul(r.learningRate).div(d.sub(m.square().add(r.epsilon)).sqrt()));c.assign(d),v.assign(m),f.assign(g);var b=u.sub(g);u.assign(b)}else{var w=c.mul(r.decay).add(l.square().mul(1-r.decay));g=f.mul(r.momentum).add(l.mul(r.learningRate).div(w.add(r.epsilon).sqrt())),c.assign(w),f.assign(g),b=u.sub(g),u.assign(b)}})}}),this.incrementIterations()},t.prototype.dispose=function(){this.accumulatedMeanSquares!=null&&Fn(this.accumulatedMeanSquares.map(function(e){return e.variable})),this.accumulatedMeanGrads!=null&&this.centered&&Fn(this.accumulatedMeanGrads.map(function(e){return e.variable})),this.accumulatedMoments!=null&&Fn(this.accumulatedMoments.map(function(e){return e.variable}))},t.prototype.getWeights=function(){return we(this,void 0,void 0,function(){var e;return Se(this,function(r){switch(r.label){case 0:return e=this.accumulatedMeanSquares.concat(this.accumulatedMoments),this.centered&&e.push.apply(e,this.accumulatedMeanGrads),[4,this.saveIterations()];case 1:return[2,[r.sent()].concat(e.map(function(a){return{name:a.originalName,tensor:a.variable}}))]}})})},t.prototype.setWeights=function(e){return we(this,void 0,void 0,function(){var r;return Se(this,function(a){switch(a.label){case 0:return[4,this.extractIterations(e)];case 1:return e=a.sent(),r=this.centered?e.length/3:e.length/2,this.accumulatedMeanSquares=e.slice(0,r).map(function(i){return{originalName:i.name,variable:i.tensor.variable(!1)}}),this.accumulatedMoments=e.slice(r,2*r).map(function(i){return{originalName:i.name,variable:i.tensor.variable(!1)}}),this.centered&&(this.accumulatedMeanGrads=e.slice(2*r,3*r).map(function(i){return{originalName:i.name,variable:i.tensor.variable(!1)}})),[2]}})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}},t.fromConfig=function(e,r){return new e(r.learningRate,r.decay,r.momentum,r.epsilon,r.centered)},t.className="RMSProp",t}(so);oo(Fz);wt.prototype.squaredDifference=function(n){return OE(this,n)},se=sz;/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var gm=function(n,t){return gm=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var a in r)r.hasOwnProperty(a)&&(e[a]=r[a])},gm(n,t)};function Be(n,t){gm(n,t);function e(){this.constructor=n}n.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}var gn=function(){return gn=Object.assign||function(t){for(var e,r=1,a=arguments.length;r<a;r++){e=arguments[r];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}return t},gn.apply(this,arguments)};function Ce(n,t,e,r){function a(i){return i instanceof e?i:new e(function(u){u(i)})}return new(e||(e=Promise))(function(i,u){function l(d){try{f(r.next(d))}catch(v){u(v)}}function c(d){try{f(r.throw(d))}catch(v){u(v)}}function f(d){d.done?i(d.value):a(d.value).then(l,c)}f((r=r.apply(n,[])).next())})}function Re(n,t){var e={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},r,a,i,u;return u={next:l(0),throw:l(1),return:l(2)},typeof Symbol=="function"&&(u[Symbol.iterator]=function(){return this}),u;function l(f){return function(d){return c([f,d])}}function c(f){if(r)throw new TypeError("Generator is already executing.");for(;e;)try{if(r=1,a&&(i=f[0]&2?a.return:f[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,f[1])).done)return i;switch(a=0,i&&(f=[f[0]&2,i.value]),f[0]){case 0:case 1:i=f;break;case 4:return e.label++,{value:f[1],done:!1};case 5:e.label++,a=f[1],f=[0];continue;case 7:f=e.ops.pop(),e.trys.pop();continue;default:if(i=e.trys,!(i=i.length>0&&i[i.length-1])&&(f[0]===6||f[0]===2)){e=0;continue}if(f[0]===3&&(!i||f[1]>i[0]&&f[1]<i[3])){e.label=f[1];break}if(f[0]===6&&e.label<i[1]){e.label=i[1],i=f;break}if(i&&e.label<i[2]){e.label=i[2],e.ops.push(f);break}i[2]&&e.ops.pop(),e.trys.pop();continue}f=t.call(n,e)}catch(d){f=[6,d],a=0}finally{r=i=0}if(f[0]&5)throw f[1];return{value:f[0]?f[1]:void 0,done:!0}}}function Hu(){for(var n=0,t=0,e=arguments.length;t<e;t++)n+=arguments[t].length;for(var r=Array(n),a=0,t=0;t<e;t++)for(var i=arguments[t],u=0,l=i.length;u<l;u++,a++)r[a]=i[u];return r}var Xi=function(){function n(t,e){if(!Zi(t)||!Zi(e))throw new Error("Dimensions.constructor - expected width and height to be valid numbers, instead have "+JSON.stringify({width:t,height:e}));this._width=t,this._height=e}return Object.defineProperty(n.prototype,"width",{get:function(){return this._width},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"height",{get:function(){return this._height},enumerable:!0,configurable:!0}),n.prototype.reverse=function(){return new n(1/this.width,1/this.height)},n}();function fh(n,t){return n instanceof wt&&n.shape.length===t}function Bz(n){return fh(n,2)}function hh(n){return fh(n,3)}function mi(n){return fh(n,4)}function Pz(n){return n%1!==0}function t2(n){return n%2===0}function xg(n,t){t===void 0&&(t=2);var e=Math.pow(10,t);return Math.floor(n*e)/e}function n2(n){return n&&n.width&&n.height}function Lz(n,t){var e=n.width,r=n.height,a=t/Math.max(r,e);return new Xi(Math.round(e*a),Math.round(r*a))}function wg(n){return n.reduce(function(t,e){return t.add(e)},new et(0,0)).div(new et(n.length,n.length))}function Ju(n,t,e){return Array(n).fill(0).map(function(r,a){return t+a*e})}function Zi(n){return!!n&&n!==1/0&&n!==-1/0&&!isNaN(n)||n===0}function r2(n){return Zi(n)&&0<=n&&n<=1}var et=function(){function n(t,e){this._x=t,this._y=e}return Object.defineProperty(n.prototype,"x",{get:function(){return this._x},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"y",{get:function(){return this._y},enumerable:!0,configurable:!0}),n.prototype.add=function(t){return new n(this.x+t.x,this.y+t.y)},n.prototype.sub=function(t){return new n(this.x-t.x,this.y-t.y)},n.prototype.mul=function(t){return new n(this.x*t.x,this.y*t.y)},n.prototype.div=function(t){return new n(this.x/t.x,this.y/t.y)},n.prototype.abs=function(){return new n(Math.abs(this.x),Math.abs(this.y))},n.prototype.magnitude=function(){return Math.sqrt(Math.pow(this.x,2)+Math.pow(this.y,2))},n.prototype.floor=function(){return new n(Math.floor(this.x),Math.floor(this.y))},n}(),Zr=function(){function n(t,e){e===void 0&&(e=!0);var r=t||{},a=[r.left,r.top,r.right,r.bottom].every(Zi),i=[r.x,r.y,r.width,r.height].every(Zi);if(!i&&!a)throw new Error("Box.constructor - expected box to be IBoundingBox | IRect, instead have "+JSON.stringify(r));var u=i?[r.x,r.y,r.width,r.height]:[r.left,r.top,r.right-r.left,r.bottom-r.top],l=u[0],c=u[1],f=u[2],d=u[3];n.assertIsValidBox({x:l,y:c,width:f,height:d},"Box.constructor",e),this._x=l,this._y=c,this._width=f,this._height=d}return n.isRect=function(t){return!!t&&[t.x,t.y,t.width,t.height].every(Zi)},n.assertIsValidBox=function(t,e,r){if(r===void 0&&(r=!1),!n.isRect(t))throw new Error(e+" - invalid box: "+JSON.stringify(t)+", expected object with properties x, y, width, height");if(!r&&(t.width<0||t.height<0))throw new Error(e+" - width ("+t.width+") and height ("+t.height+") must be positive numbers")},Object.defineProperty(n.prototype,"x",{get:function(){return this._x},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"y",{get:function(){return this._y},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"width",{get:function(){return this._width},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"height",{get:function(){return this._height},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"left",{get:function(){return this.x},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"top",{get:function(){return this.y},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"right",{get:function(){return this.x+this.width},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"bottom",{get:function(){return this.y+this.height},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"area",{get:function(){return this.width*this.height},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"topLeft",{get:function(){return new et(this.left,this.top)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"topRight",{get:function(){return new et(this.right,this.top)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"bottomLeft",{get:function(){return new et(this.left,this.bottom)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"bottomRight",{get:function(){return new et(this.right,this.bottom)},enumerable:!0,configurable:!0}),n.prototype.round=function(){var t=[this.x,this.y,this.width,this.height].map(function(u){return Math.round(u)}),e=t[0],r=t[1],a=t[2],i=t[3];return new n({x:e,y:r,width:a,height:i})},n.prototype.floor=function(){var t=[this.x,this.y,this.width,this.height].map(function(u){return Math.floor(u)}),e=t[0],r=t[1],a=t[2],i=t[3];return new n({x:e,y:r,width:a,height:i})},n.prototype.toSquare=function(){var t=this,e=t.x,r=t.y,a=t.width,i=t.height,u=Math.abs(a-i);return a<i&&(e-=u/2,a+=u),i<a&&(r-=u/2,i+=u),new n({x:e,y:r,width:a,height:i})},n.prototype.rescale=function(t){var e=n2(t)?t.width:t,r=n2(t)?t.height:t;return new n({x:this.x*e,y:this.y*r,width:this.width*e,height:this.height*r})},n.prototype.pad=function(t,e){var r=[this.x-t/2,this.y-e/2,this.width+t,this.height+e],a=r[0],i=r[1],u=r[2],l=r[3];return new n({x:a,y:i,width:u,height:l})},n.prototype.clipAtImageBorders=function(t,e){var r=this,a=r.x,i=r.y,u=r.right,l=r.bottom,c=Math.max(a,0),f=Math.max(i,0),d=u-c,v=l-f,m=Math.min(d,t-c),g=Math.min(v,e-f);return new n({x:c,y:f,width:m,height:g}).floor()},n.prototype.shift=function(t,e){var r=this,a=r.width,i=r.height,u=this.x+t,l=this.y+e;return new n({x:u,y:l,width:a,height:i})},n.prototype.padAtBorders=function(t,e){var r=this.width+1,a=this.height+1,i=1,u=1,l=r,c=a,f=this.left,d=this.top,v=this.right,m=this.bottom;return v>e&&(l=-v+e+r,v=e),m>t&&(c=-m+t+a,m=t),f<1&&(c=2-f,f=1),d<1&&(c=2-d,d=1),{dy:u,edy:c,dx:i,edx:l,y:d,ey:m,x:f,ex:v,w:r,h:a}},n.prototype.calibrate=function(t){return new n({left:this.left+t.left*this.width,top:this.top+t.top*this.height,right:this.right+t.right*this.width,bottom:this.bottom+t.bottom*this.height}).toSquare().round()},n}(),dh=function(n){Be(t,n);function t(e,r,a,i,u){return u===void 0&&(u=!1),n.call(this,{left:e,top:r,right:a,bottom:i},u)||this}return t}(Zr),m_=function(){function n(t,e,r,a,i){this._imageDims=new Xi(i.width,i.height),this._score=t,this._classScore=e,this._className=r,this._box=new Zr(a).rescale(this._imageDims)}return Object.defineProperty(n.prototype,"score",{get:function(){return this._score},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"classScore",{get:function(){return this._classScore},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"className",{get:function(){return this._className},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"box",{get:function(){return this._box},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"imageDims",{get:function(){return this._imageDims},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"imageWidth",{get:function(){return this.imageDims.width},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"imageHeight",{get:function(){return this.imageDims.height},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"relativeBox",{get:function(){return new Zr(this._box).rescale(this.imageDims.reverse())},enumerable:!0,configurable:!0}),n.prototype.forSize=function(t,e){return new n(this.score,this.classScore,this.className,this.relativeBox,{width:t,height:e})},n}(),Jn=function(n){Be(t,n);function t(e,r,a){return n.call(this,e,e,"",r,a)||this}return t.prototype.forSize=function(e,r){var a=n.prototype.forSize.call(this,e,r),i=a.score,u=a.relativeBox,l=a.imageDims;return new t(i,u,l)},t}(m_);function zz(n,t,e){e===void 0&&(e=!0);var r=Math.max(0,Math.min(n.right,t.right)-Math.max(n.left,t.left)),a=Math.max(0,Math.min(n.bottom,t.bottom)-Math.max(n.top,t.top)),i=r*a;return e?i/(n.area+t.area-i):i/Math.min(n.area,t.area)}function Uz(n){var t=n.map(function(l){return l.x}),e=n.map(function(l){return l.y}),r=t.reduce(function(l,c){return c<l?c:l},1/0),a=e.reduce(function(l,c){return c<l?c:l},1/0),i=t.reduce(function(l,c){return l<c?c:l},0),u=e.reduce(function(l,c){return l<c?c:l},0);return new dh(r,a,i,u)}function el(n,t,e,r){r===void 0&&(r=!0);for(var a=t.map(function(l,c){return{score:l,boxIndex:c}}).sort(function(l,c){return l.score-c.score}).map(function(l){return l.boxIndex}),i=[],u=function(){var l=a.pop();i.push(l);for(var c=a,f=[],d=0;d<c.length;d++){var v=c[d],m=n[l],g=n[v];f.push(zz(m,g,r))}a=a.filter(function(b,w){return f[w]<=e})};a.length>0;)u();return i}function ml(n,t){return be(function(){var e=t[0],r=t[1],a=t[2],i=Kr(Hu(n.shape.slice(0,3),[1]),e),u=Kr(Hu(n.shape.slice(0,3),[1]),r),l=Kr(Hu(n.shape.slice(0,3),[1]),a),c=Gt([i,u,l],3);return $t(n,c)})}function Hz(n,t){return t===void 0&&(t=!1),be(function(){var e=n.shape.slice(1),r=e[0],a=e[1];if(r===a)return n;var i=Math.abs(r-a),u=Math.round(i*(t?.5:1)),l=r>a?2:1,c=function(g){var b=n.shape.slice();return b[l]=g,Kr(b,0)},f=c(u),d=i-f.shape[l],v=t&&d?c(d):null,m=[v,n,f].filter(function(g){return!!g}).map(function(g){return g.toFloat()});return Gt(m,l)})}function wv(n){return 1/(1+Math.exp(-n))}var Sg=function(n){Be(t,n);function t(e,r,a,i,u){return u===void 0&&(u=!1),n.call(this,{x:e,y:r,width:a,height:i},u)||this}return t}(Zr),Vz=.5,Wz=.43,Gz=.45,tl=function(){function n(t,e,r){r===void 0&&(r=new et(0,0));var a=e.width,i=e.height;this._imgDims=new Xi(a,i),this._shift=r,this._positions=t.map(function(u){return u.mul(new et(a,i)).add(r)})}return Object.defineProperty(n.prototype,"shift",{get:function(){return new et(this._shift.x,this._shift.y)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"imageWidth",{get:function(){return this._imgDims.width},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"imageHeight",{get:function(){return this._imgDims.height},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"positions",{get:function(){return this._positions},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"relativePositions",{get:function(){var t=this;return this._positions.map(function(e){return e.sub(t._shift).div(new et(t.imageWidth,t.imageHeight))})},enumerable:!0,configurable:!0}),n.prototype.forSize=function(t,e){return new this.constructor(this.relativePositions,{width:t,height:e})},n.prototype.shiftBy=function(t,e){return new this.constructor(this.relativePositions,this._imgDims,new et(t,e))},n.prototype.shiftByPoint=function(t){return this.shiftBy(t.x,t.y)},n.prototype.align=function(t,e){if(e===void 0&&(e={}),t){var r=t instanceof Jn?t.box.floor():new Zr(t);return this.shiftBy(r.x,r.y).align(null,e)}var a=Object.assign({},{useDlibAlignment:!1,minBoxPadding:.2},e),i=a.useDlibAlignment,u=a.minBoxPadding;return i?this.alignDlib():this.alignMinBbox(u)},n.prototype.alignDlib=function(){var t=this.getRefPointsForAlignment(),e=t[0],r=t[1],a=t[2],i=function(v){return a.sub(v).magnitude()},u=(i(e)+i(r))/2,l=Math.floor(u/Gz),c=wg(t),f=Math.floor(Math.max(0,c.x-Vz*l)),d=Math.floor(Math.max(0,c.y-Wz*l));return new Sg(f,d,Math.min(l,this.imageWidth+f),Math.min(l,this.imageHeight+d))},n.prototype.alignMinBbox=function(t){var e=Uz(this.positions);return e.pad(e.width*t,e.height*t)},n.prototype.getRefPointsForAlignment=function(){throw new Error("getRefPointsForAlignment not implemented by base class")},n}(),jz=function(n){Be(t,n);function t(){return n!==null&&n.apply(this,arguments)||this}return t.prototype.getRefPointsForAlignment=function(){var e=this.positions;return[e[0],e[1],wg([e[3],e[4]])]},t}(tl),qz=function(n){Be(t,n);function t(){return n!==null&&n.apply(this,arguments)||this}return t.prototype.getJawOutline=function(){return this.positions.slice(0,17)},t.prototype.getLeftEyeBrow=function(){return this.positions.slice(17,22)},t.prototype.getRightEyeBrow=function(){return this.positions.slice(22,27)},t.prototype.getNose=function(){return this.positions.slice(27,36)},t.prototype.getLeftEye=function(){return this.positions.slice(36,42)},t.prototype.getRightEye=function(){return this.positions.slice(42,48)},t.prototype.getMouth=function(){return this.positions.slice(48,68)},t.prototype.getRefPointsForAlignment=function(){return[this.getLeftEye(),this.getRightEye(),this.getMouth()].map(wg)},t}(tl),a2=function(){function n(t,e){this._label=t,this._distance=e}return Object.defineProperty(n.prototype,"label",{get:function(){return this._label},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"distance",{get:function(){return this._distance},enumerable:!0,configurable:!0}),n.prototype.toString=function(t){return t===void 0&&(t=!0),""+this.label+(t?" ("+xg(this.distance)+")":"")},n}(),i2=function(n){Be(t,n);function t(e,r){var a=n.call(this,e)||this;return a._label=r,a}return t.assertIsValidLabeledBox=function(e,r){if(Zr.assertIsValidBox(e,r),!Zi(e.label))throw new Error(r+" - expected property label ("+e.label+") to be a number")},Object.defineProperty(t.prototype,"label",{get:function(){return this._label},enumerable:!0,configurable:!0}),t}(Zr),Xc=function(){function n(t,e){if(typeof t!="string")throw new Error("LabeledFaceDescriptors - constructor expected label to be a string");if(!Array.isArray(e)||e.some(function(r){return!(r instanceof Float32Array)}))throw new Error("LabeledFaceDescriptors - constructor expected descriptors to be an array of Float32Array");this._label=t,this._descriptors=e}return Object.defineProperty(n.prototype,"label",{get:function(){return this._label},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"descriptors",{get:function(){return this._descriptors},enumerable:!0,configurable:!0}),n.prototype.toJSON=function(){return{label:this.label,descriptors:this.descriptors.map(function(t){return Array.from(t)})}},n.fromJSON=function(t){var e=t.descriptors.map(function(r){return new Float32Array(r)});return new n(t.label,e)},n}();(function(n){Be(t,n);function t(e,r,a,i){var u=n.call(this,e,r)||this;return u._score=a,u._classScore=i,u}return t.assertIsValidPredictedBox=function(e,r){if(i2.assertIsValidLabeledBox(e,r),!r2(e.score)||!r2(e.classScore))throw new Error(r+" - expected properties score ("+e.score+") and ("+e.classScore+") to be a number between [0, 1]")},Object.defineProperty(t.prototype,"score",{get:function(){return this._score},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"classScore",{get:function(){return this._classScore},enumerable:!0,configurable:!0}),t})(i2);function nl(n){return n.detection instanceof Jn}function rl(n,t){var e={detection:t};return Object.assign({},n,e)}function g_(){var n=window.fetch||function(){throw new Error("fetch - missing fetch implementation for browser environment")},t=function(){throw new Error("readFile - filesystem not available for browser environment")};return{Canvas:HTMLCanvasElement,CanvasRenderingContext2D,Image:HTMLImageElement,ImageData,Video:HTMLVideoElement,createCanvasElement:function(){return document.createElement("canvas")},createImageElement:function(){return document.createElement("img")},fetch:n,readFile:t}}function y_(n){var t="";if(!n)try{n=require("fs")}catch(r){t=r.toString()}var e=n?function(r){return new Promise(function(a,i){n.readFile(r,function(u,l){return u?i(u):a(l)})})}:function(){throw new Error("readFile - failed to require fs in nodejs environment with error: "+t)};return{readFile:e}}function b_(){var n=global.Canvas||global.HTMLCanvasElement,t=global.Image||global.HTMLImageElement,e=function(){if(n)return new n;throw new Error("createCanvasElement - missing Canvas implementation for nodejs environment")},r=function(){if(t)return new t;throw new Error("createImageElement - missing Image implementation for nodejs environment")},a=global.fetch||function(){throw new Error("fetch - missing fetch implementation for nodejs environment")},i=y_();return gn({Canvas:n||function(){function u(){}return u}(),CanvasRenderingContext2D:global.CanvasRenderingContext2D||function(){function u(){}return u}(),Image:t||function(){function u(){}return u}(),ImageData:global.ImageData||function(){function u(){}return u}(),Video:global.HTMLVideoElement||function(){function u(){}return u}(),createCanvasElement:e,createImageElement:r,fetch:a},i)}function x_(){return typeof window=="object"&&typeof document<"u"&&typeof HTMLImageElement<"u"&&typeof HTMLCanvasElement<"u"&&typeof HTMLVideoElement<"u"&&typeof ImageData<"u"&&typeof CanvasRenderingContext2D<"u"}function w_(){return typeof global=="object"&&typeof require=="function"&&typeof module<"u"&&typeof process<"u"&&!!process.version}var Vt;function $z(){if(!Vt)throw new Error("getEnv - environment is not defined, check isNodejs() and isBrowser()");return Vt}function ym(n){Vt=n}function Eg(){x_()&&ym(g_()),w_()&&ym(b_())}function Kz(n){if(Vt||Eg(),!Vt)throw new Error("monkeyPatch - environment is not defined, check isNodejs() and isBrowser()");var t=n.Canvas,e=t===void 0?Vt.Canvas:t,r=n.Image,a=r===void 0?Vt.Image:r;Vt.Canvas=e,Vt.Image=a,Vt.createCanvasElement=n.createCanvasElement||function(){return new e},Vt.createImageElement=n.createImageElement||function(){return new a},Vt.ImageData=n.ImageData||Vt.ImageData,Vt.Video=n.Video||Vt.Video,Vt.fetch=n.fetch||Vt.fetch,Vt.readFile=n.readFile||Vt.readFile}var Sn={getEnv:$z,setEnv:ym,initialize:Eg,createBrowserEnv:g_,createFileSystem:y_,createNodejsEnv:b_,monkeyPatch:Kz,isBrowser:x_,isNodejs:w_};Eg();function _g(n){return!Sn.isNodejs()&&typeof n=="string"?document.getElementById(n):n}function Ca(n){var t=Sn.getEnv(),e=t.Canvas,r=t.CanvasRenderingContext2D;if(n instanceof r)return n;var a=_g(n);if(!(a instanceof e))throw new Error("resolveContext2d - expected canvas to be of instance of Canvas");var i=a.getContext("2d");if(!i)throw new Error("resolveContext2d - canvas 2d context is null");return i}var fi;(function(n){n.TOP_LEFT="TOP_LEFT",n.TOP_RIGHT="TOP_RIGHT",n.BOTTOM_LEFT="BOTTOM_LEFT",n.BOTTOM_RIGHT="BOTTOM_RIGHT"})(fi||(fi={}));var S_=function(){function n(t){t===void 0&&(t={});var e=t.anchorPosition,r=t.backgroundColor,a=t.fontColor,i=t.fontSize,u=t.fontStyle,l=t.padding;this.anchorPosition=e||fi.TOP_LEFT,this.backgroundColor=r||"rgba(0, 0, 0, 0.5)",this.fontColor=a||"rgba(255, 255, 255, 1)",this.fontSize=i||14,this.fontStyle=u||"Georgia",this.padding=l||4}return n}(),E_=function(){function n(t,e,r){r===void 0&&(r={}),this.text=typeof t=="string"?[t]:t instanceof n?t.text:t,this.anchor=e,this.options=new S_(r)}return n.prototype.measureWidth=function(t){var e=this.options.padding;return this.text.map(function(r){return t.measureText(r).width}).reduce(function(r,a){return r<a?a:r},0)+2*e},n.prototype.measureHeight=function(){var t=this.options,e=t.fontSize,r=t.padding;return this.text.length*e+2*r},n.prototype.getUpperLeft=function(t,e){var r=this.options.anchorPosition,a=r===fi.BOTTOM_RIGHT||r===fi.TOP_RIGHT,i=r===fi.BOTTOM_LEFT||r===fi.BOTTOM_RIGHT,u=this.measureWidth(t),l=this.measureHeight(),c=a?this.anchor.x-u:this.anchor.x,f=i?this.anchor.y-l:this.anchor.y;if(e){var d=e.width,v=e.height,m=Math.max(Math.min(c,d-u),0),g=Math.max(Math.min(f,v-l),0);return{x:m,y:g}}return{x:c,y:f}},n.prototype.draw=function(t){var e=_g(t),r=Ca(e),a=this.options,i=a.backgroundColor,u=a.fontColor,l=a.fontSize,c=a.fontStyle,f=a.padding;r.font=l+"px "+c;var d=this.measureWidth(r),v=this.measureHeight();r.fillStyle=i;var m=this.getUpperLeft(r,e);r.fillRect(m.x,m.y,d,v),r.fillStyle=u,this.text.forEach(function(g,b){var w=f+m.x,S=f+m.y+(b+1)*l;r.fillText(g,w,S)})},n}(),Xz=function(){function n(t){t===void 0&&(t={});var e=t.boxColor,r=t.lineWidth,a=t.label,i=t.drawLabelOptions;this.boxColor=e||"rgba(0, 0, 255, 1)",this.lineWidth=r||2,this.label=a;var u={anchorPosition:fi.BOTTOM_LEFT,backgroundColor:this.boxColor};this.drawLabelOptions=new S_(Object.assign({},u,i))}return n}(),Zz=function(){function n(t,e){e===void 0&&(e={}),this.box=new Zr(t),this.options=new Xz(e)}return n.prototype.draw=function(t){var e=Ca(t),r=this.options,a=r.boxColor,i=r.lineWidth,u=this.box,l=u.x,c=u.y,f=u.width,d=u.height;e.strokeStyle=a,e.lineWidth=i,e.strokeRect(l,c,f,d);var v=this.options.label;v&&new E_([v],{x:l-i/2,y:c},this.options.drawLabelOptions).draw(t)},n}();function Z6(n,t){var e=Array.isArray(t)?t:[t];e.forEach(function(r){var a=r instanceof Jn?r.score:nl(r)?r.detection.score:void 0,i=r instanceof Jn?r.box:nl(r)?r.detection.box:new Zr(r),u=a?""+xg(a):void 0;new Zz(i,{label:u}).draw(n)})}function __(n){var t=Sn.getEnv(),e=t.Image,r=t.Video;return n instanceof e&&n.complete||n instanceof r&&n.readyState>=3}function Yz(n){return new Promise(function(t,e){if(n instanceof Sn.getEnv().Canvas||__(n))return t();function r(i){i.currentTarget&&(i.currentTarget.removeEventListener("load",r),i.currentTarget.removeEventListener("error",a),t(i))}function a(i){i.currentTarget&&(i.currentTarget.removeEventListener("load",r),i.currentTarget.removeEventListener("error",a),e(i))}n.addEventListener("load",r),n.addEventListener("error",a)})}function Cg(n){var t=Sn.getEnv(),e=t.Image,r=t.Video;return n instanceof e?new Xi(n.naturalWidth,n.naturalHeight):n instanceof r?new Xi(n.videoWidth,n.videoHeight):new Xi(n.width,n.height)}function ph(n){var t=n.width,e=n.height,r=Sn.getEnv().createCanvasElement,a=r();return a.width=t,a.height=e,a}function Rg(n,t){var e=Sn.getEnv().ImageData;if(!(n instanceof e)&&!__(n))throw new Error("createCanvasFromMedia - media has not finished loading yet");var r=Cg(n),a=r.width,i=r.height,u=ph({width:a,height:i});return n instanceof e?Ca(u).putImageData(n,0,0):Ca(u).drawImage(n,0,0,a,i),u}function Qz(n,t){return Ce(this,void 0,void 0,function(){var e,r,a,i,u,l;return Re(this,function(c){switch(c.label){case 0:return e=Sn.getEnv().createCanvasElement(),r=n.shape.slice(mi(n)?1:0),a=r[0],i=r[1],u=r[2],l=be(function(){return n.as3D(a,i,u).toInt()}),[4,bg.toPixels(l,e)];case 1:return c.sent(),l.dispose(),[2,e]}})})}function o2(n){var t=Sn.getEnv(),e=t.Image,r=t.Canvas,a=t.Video;return n instanceof e||n instanceof r||n instanceof a}function Jz(n,t,e){e===void 0&&(e=!1);var r=Sn.getEnv(),a=r.Image,i=r.Canvas;if(!(n instanceof a||n instanceof i))throw new Error("imageToSquare - expected arg0 to be HTMLImageElement | HTMLCanvasElement");var u=Cg(n),l=t/Math.max(u.height,u.width),c=l*u.width,f=l*u.height,d=ph({width:t,height:t}),v=n instanceof i?n:Rg(n),m=Math.abs(c-f)/2,g=e&&c<f?m:0,b=e&&f<c?m:0;return Ca(d).drawImage(v,g,b,c,f),d}var Hf=function(){function n(t,e){var r=this;if(e===void 0&&(e=!1),this._imageTensors=[],this._canvases=[],this._treatAsBatchInput=!1,this._inputDimensions=[],!Array.isArray(t))throw new Error("NetInput.constructor - expected inputs to be an Array of TResolvedNetInput or to be instanceof tf.Tensor4D, instead have "+t);this._treatAsBatchInput=e,this._batchSize=t.length,t.forEach(function(a,i){if(hh(a)){r._imageTensors[i]=a,r._inputDimensions[i]=a.shape;return}if(mi(a)){var u=a.shape[0];if(u!==1)throw new Error("NetInput - tf.Tensor4D with batchSize "+u+" passed, but not supported in input array");r._imageTensors[i]=a,r._inputDimensions[i]=a.shape.slice(1);return}var l=a instanceof Sn.getEnv().Canvas?a:Rg(a);r._canvases[i]=l,r._inputDimensions[i]=[l.height,l.width,3]})}return Object.defineProperty(n.prototype,"imageTensors",{get:function(){return this._imageTensors},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"canvases",{get:function(){return this._canvases},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"isBatchInput",{get:function(){return this.batchSize>1||this._treatAsBatchInput},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"batchSize",{get:function(){return this._batchSize},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"inputDimensions",{get:function(){return this._inputDimensions},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"inputSize",{get:function(){return this._inputSize},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"reshapedInputDimensions",{get:function(){var t=this;return Ju(this.batchSize,0,1).map(function(e,r){return t.getReshapedInputDimensions(r)})},enumerable:!0,configurable:!0}),n.prototype.getInput=function(t){return this.canvases[t]||this.imageTensors[t]},n.prototype.getInputDimensions=function(t){return this._inputDimensions[t]},n.prototype.getInputHeight=function(t){return this._inputDimensions[t][0]},n.prototype.getInputWidth=function(t){return this._inputDimensions[t][1]},n.prototype.getReshapedInputDimensions=function(t){if(typeof this.inputSize!="number")throw new Error("getReshapedInputDimensions - inputSize not set, toBatchTensor has not been called yet");var e=this.getInputWidth(t),r=this.getInputHeight(t);return Lz({width:e,height:r},this.inputSize)},n.prototype.toBatchTensor=function(t,e){var r=this;return e===void 0&&(e=!0),this._inputSize=t,be(function(){var a=Ju(r.batchSize,0,1).map(function(u){var l=r.getInput(u);if(l instanceof wt){var c=mi(l)?l:l.expandDims();return c=Hz(c,e),(c.shape[1]!==t||c.shape[2]!==t)&&(c=dg.resizeBilinear(c,[t,t])),c.as3D(t,t,3)}if(l instanceof Sn.getEnv().Canvas)return bg.fromPixels(Jz(l,t,e));throw new Error("toBatchTensor - at batchIdx "+u+", expected input to be instanceof tf.Tensor or instanceof HTMLCanvasElement, instead have "+l)}),i=Qn(a.map(function(u){return u.toFloat()})).as4D(r.batchSize,t,t,3);return i})},n}();function rn(n){return Ce(this,void 0,void 0,function(){var t,e,r;return Re(this,function(a){switch(a.label){case 0:if(n instanceof Hf)return[2,n];if(t=Array.isArray(n)?n:[n],!t.length)throw new Error("toNetInput - empty array passed as input");return e=function(i){return Array.isArray(n)?" at input index "+i+":":""},r=t.map(_g),r.forEach(function(i,u){if(!o2(i)&&!hh(i)&&!mi(i))throw typeof t[u]=="string"?new Error("toNetInput -"+e(u)+" string passed, but could not resolve HTMLElement for element id "+t[u]):new Error("toNetInput -"+e(u)+" expected media to be of type HTMLImageElement | HTMLVideoElement | HTMLCanvasElement | tf.Tensor3D, or to be an element id");if(mi(i)){var l=i.shape[0];if(l!==1)throw new Error("toNetInput -"+e(u)+" tf.Tensor4D with batchSize "+l+" passed, but not supported in input array")}}),[4,Promise.all(r.map(function(i){return o2(i)&&Yz(i)}))];case 1:return a.sent(),[2,new Hf(r,Array.isArray(n))]}})})}function Ag(n,t){return Ce(this,void 0,void 0,function(){var e,r,a,i,u,l,c;return Re(this,function(f){switch(f.label){case 0:return e=Sn.getEnv().Canvas,r=n,n instanceof e?[3,5]:[4,rn(n)];case 1:if(a=f.sent(),a.batchSize>1)throw new Error("extractFaces - batchSize > 1 not supported");return i=a.getInput(0),i instanceof e?(u=i,[3,4]):[3,2];case 2:return[4,Qz(i)];case 3:u=f.sent(),f.label=4;case 4:r=u,f.label=5;case 5:return l=Ca(r),c=t.map(function(d){return d instanceof Jn?d.forSize(r.width,r.height).box.floor():d}).map(function(d){return d.clipAtImageBorders(r.width,r.height)}),[2,c.map(function(d){var v=d.x,m=d.y,g=d.width,b=d.height,w=ph({width:g,height:b});return Ca(w).putImageData(l.getImageData(v,m,g,b),0,0),w})]}})})}function Tg(n,t){return Ce(this,void 0,void 0,function(){return Re(this,function(e){if(!hh(n)&&!mi(n))throw new Error("extractFaceTensors - expected image tensor to be 3D or 4D");if(mi(n)&&n.shape[0]>1)throw new Error("extractFaceTensors - batchSize > 1 not supported");return[2,be(function(){var r=n.shape.slice(mi(n)?1:0),a=r[0],i=r[1],u=r[2],l=t.map(function(f){return f instanceof Jn?f.forSize(i,a).box:f}).map(function(f){return f.clipAtImageBorders(i,a)}),c=l.map(function(f){var d=f.x,v=f.y,m=f.width,g=f.height;return YE(n.as3D(a,i,u),[v,d,0],[g,m,u])});return c})]})})}function eU(n,t){return Ce(this,void 0,void 0,function(){var e,r;return Re(this,function(a){switch(a.label){case 0:return e=Sn.getEnv().fetch,[4,e(n,t)];case 1:if(r=a.sent(),!(r.status<400))throw new Error("failed to fetch: ("+r.status+") "+r.statusText+", from url: "+r.url);return[2,r]}})})}function tU(n){return Ce(this,void 0,void 0,function(){return Re(this,function(t){switch(t.label){case 0:return[4,eU(n)];case 1:return[2,t.sent().json()]}})})}function C_(n,t){var e=t+"-weights_manifest.json";if(!n)return{modelBaseUri:"",manifestUri:e};if(n==="/")return{modelBaseUri:"/",manifestUri:"/"+e};var r=n.startsWith("http://")?"http://":n.startsWith("https://")?"https://":"";n=n.replace(r,"");var a=n.split("/").filter(function(l){return l}),i=n.endsWith(".json")?a[a.length-1]:e,u=r+(n.endsWith(".json")?a.slice(0,a.length-1):a).join("/");return u=n.startsWith("/")?"/"+u:u,{modelBaseUri:u,manifestUri:u==="/"?"/"+i:u+"/"+i}}function nU(n,t){return Ce(this,void 0,void 0,function(){var e,r,a,i;return Re(this,function(u){switch(u.label){case 0:return e=C_(n,t),r=e.manifestUri,a=e.modelBaseUri,[4,tU(r)];case 1:return i=u.sent(),[2,p_.loadWeights(i,a)]}})})}function Y6(n,t,e){e===void 0&&(e=!1);var r=e?Cg(t):t,a=r.width,i=r.height;return n.width=a,n.height=i,{width:a,height:i}}var Oa=function(){function n(t){this._name=t,this._params=void 0,this._paramMappings=[]}return Object.defineProperty(n.prototype,"params",{get:function(){return this._params},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"paramMappings",{get:function(){return this._paramMappings},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"isLoaded",{get:function(){return!!this.params},enumerable:!0,configurable:!0}),n.prototype.getParamFromPath=function(t){var e=this.traversePropertyPath(t),r=e.obj,a=e.objProp;return r[a]},n.prototype.reassignParamFromPath=function(t,e){var r=this.traversePropertyPath(t),a=r.obj,i=r.objProp;a[i].dispose(),a[i]=e},n.prototype.getParamList=function(){var t=this;return this._paramMappings.map(function(e){var r=e.paramPath;return{path:r,tensor:t.getParamFromPath(r)}})},n.prototype.getTrainableParams=function(){return this.getParamList().filter(function(t){return t.tensor instanceof Ss})},n.prototype.getFrozenParams=function(){return this.getParamList().filter(function(t){return!(t.tensor instanceof Ss)})},n.prototype.variable=function(){var t=this;this.getFrozenParams().forEach(function(e){var r=e.path,a=e.tensor;t.reassignParamFromPath(r,a.variable())})},n.prototype.freeze=function(){var t=this;this.getTrainableParams().forEach(function(e){var r=e.path,a=e.tensor,i=fn(a.dataSync());a.dispose(),t.reassignParamFromPath(r,i)})},n.prototype.dispose=function(t){t===void 0&&(t=!0),this.getParamList().forEach(function(e){if(t&&e.tensor.isDisposed)throw new Error("param tensor has already been disposed for path "+e.path);e.tensor.dispose()}),this._params=void 0},n.prototype.serializeParams=function(){return new Float32Array(this.getParamList().map(function(t){var e=t.tensor;return Array.from(e.dataSync())}).reduce(function(t,e){return t.concat(e)}))},n.prototype.load=function(t){return Ce(this,void 0,void 0,function(){return Re(this,function(e){switch(e.label){case 0:return t instanceof Float32Array?(this.extractWeights(t),[2]):[4,this.loadFromUri(t)];case 1:return e.sent(),[2]}})})},n.prototype.loadFromUri=function(t){return Ce(this,void 0,void 0,function(){var e;return Re(this,function(r){switch(r.label){case 0:if(t&&typeof t!="string")throw new Error(this._name+".loadFromUri - expected model uri");return[4,nU(t,this.getDefaultModelName())];case 1:return e=r.sent(),this.loadFromWeightMap(e),[2]}})})},n.prototype.loadFromDisk=function(t){return Ce(this,void 0,void 0,function(){var e,r,a,i,u,l,c,f,d,v;return Re(this,function(m){switch(m.label){case 0:if(t&&typeof t!="string")throw new Error(this._name+".loadFromDisk - expected model file path");return e=Sn.getEnv().readFile,r=C_(t,this.getDefaultModelName()),a=r.manifestUri,i=r.modelBaseUri,u=function(g){return Promise.all(g.map(function(b){return e(b).then(function(w){return w.buffer})}))},l=p_.weightsLoaderFactory(u),d=(f=JSON).parse,[4,e(a)];case 1:return c=d.apply(f,[m.sent().toString()]),[4,l(c,i)];case 2:return v=m.sent(),this.loadFromWeightMap(v),[2]}})})},n.prototype.loadFromWeightMap=function(t){var e=this.extractParamsFromWeigthMap(t),r=e.paramMappings,a=e.params;this._paramMappings=r,this._params=a},n.prototype.extractWeights=function(t){var e=this.extractParams(t),r=e.paramMappings,a=e.params;this._paramMappings=r,this._params=a},n.prototype.traversePropertyPath=function(t){if(!this.params)throw new Error("traversePropertyPath - model has no loaded params");var e=t.split("/").reduce(function(i,u){if(!i.nextObj.hasOwnProperty(u))throw new Error("traversePropertyPath - object does not have property "+u+", for path "+t);return{obj:i.nextObj,objProp:u,nextObj:i.nextObj[u]}},{nextObj:this.params}),r=e.obj,a=e.objProp;if(!r||!a||!(r[a]instanceof wt))throw new Error("traversePropertyPath - parameter is not a tensor, for path "+t);return{obj:r,objProp:a}},n}();function Yn(n,t,e){return be(function(){var r=ug(n,t.depthwise_filter,t.pointwise_filter,e,"same");return r=qe(r,t.bias),r})}function Sv(n,t,e){return e===void 0&&(e=!1),be(function(){var r=St(e?qe(yr(n,t.conv0.filters,[2,2],"same"),t.conv0.bias):Yn(n,t.conv0,[2,2])),a=Yn(r,t.conv1,[1,1]),i=St(qe(r,a)),u=Yn(i,t.conv2,[1,1]);return St(qe(r,qe(a,u)))})}function Zc(n,t,e,r){return e===void 0&&(e=!1),r===void 0&&(r=!0),be(function(){var a=St(e?qe(yr(n,t.conv0.filters,r?[2,2]:[1,1],"same"),t.conv0.bias):Yn(n,t.conv0,r?[2,2]:[1,1])),i=Yn(a,t.conv1,[1,1]),u=St(qe(a,i)),l=Yn(u,t.conv2,[1,1]),c=St(qe(a,qe(i,l))),f=Yn(c,t.conv3,[1,1]);return St(qe(a,qe(i,qe(l,f))))})}function Ar(n,t,e,r){return e===void 0&&(e="same"),r===void 0&&(r=!1),be(function(){var a=qe(yr(n,t.filters,[1,1],e),t.bias);return r?St(a):a})}function ka(n,t){Object.keys(n).forEach(function(e){t.some(function(r){return r.originalPath===e})||n[e].dispose()})}function vh(n,t){return function(e,r,a,i){var u=Mn(n(e*r*a*a),[a,a,e,r]),l=Pt(n(r));return t.push({paramPath:i+"/filters"},{paramPath:i+"/bias"}),{filters:u,bias:l}}}function Dg(n,t){return function(e,r,a){var i=pi(n(e*r),[e,r]),u=Pt(n(r));return t.push({paramPath:a+"/weights"},{paramPath:a+"/bias"}),{weights:i,bias:u}}}var R_=function(){function n(t,e,r){this.depthwise_filter=t,this.pointwise_filter=e,this.bias=r}return n}();function Og(n,t){return function(e,r,a){var i=Mn(n(9*e),[3,3,e,1]),u=Mn(n(e*r),[1,1,e,r]),l=Pt(n(r));return t.push({paramPath:a+"/depthwise_filter"},{paramPath:a+"/pointwise_filter"},{paramPath:a+"/bias"}),new R_(i,u,l)}}function kg(n){return function(t){var e=n(t+"/depthwise_filter",4),r=n(t+"/pointwise_filter",4),a=n(t+"/bias",1);return new R_(e,r,a)}}function Si(n,t){return function(e,r,a){var i=n[e];if(!fh(i,r))throw new Error("expected weightMap["+e+"] to be a Tensor"+r+"D, instead have "+i);return t.push({originalPath:e,paramPath:a||e}),i}}function Na(n){var t=n;function e(a){var i=t.slice(0,a);return t=t.slice(a),i}function r(){return t}return{extractWeights:e,getRemainingWeights:r}}function A_(n,t){var e=vh(n,t),r=Og(n,t);function a(u,l,c,f){f===void 0&&(f=!1);var d=f?e(u,l,3,c+"/conv0"):r(u,l,c+"/conv0"),v=r(l,l,c+"/conv1"),m=r(l,l,c+"/conv2");return{conv0:d,conv1:v,conv2:m}}function i(u,l,c,f){f===void 0&&(f=!1);var d=a(u,l,c,f),v=d.conv0,m=d.conv1,g=d.conv2,b=r(l,l,c+"/conv3");return{conv0:v,conv1:m,conv2:g,conv3:b}}return{extractDenseBlock3Params:a,extractDenseBlock4Params:i}}function rU(n){var t=[],e=Na(n),r=e.extractWeights,a=e.getRemainingWeights,i=A_(r,t).extractDenseBlock4Params,u=i(3,32,"dense0",!0),l=i(32,64,"dense1"),c=i(64,128,"dense2"),f=i(128,256,"dense3");if(a().length!==0)throw new Error("weights remaing after extract: "+a().length);return{paramMappings:t,params:{dense0:u,dense1:l,dense2:c,dense3:f}}}function T_(n){return function(t){var e=n(t+"/filters",4),r=n(t+"/bias",1);return{filters:e,bias:r}}}function D_(n,t){var e=Si(n,t),r=T_(e),a=kg(e);function i(l,c){c===void 0&&(c=!1);var f=c?r(l+"/conv0"):a(l+"/conv0"),d=a(l+"/conv1"),v=a(l+"/conv2");return{conv0:f,conv1:d,conv2:v}}function u(l,c){c===void 0&&(c=!1);var f=c?r(l+"/conv0"):a(l+"/conv0"),d=a(l+"/conv1"),v=a(l+"/conv2"),m=a(l+"/conv3");return{conv0:f,conv1:d,conv2:v,conv3:m}}return{extractDenseBlock3Params:i,extractDenseBlock4Params:u}}function aU(n){var t=[],e=D_(n,t).extractDenseBlock4Params,r={dense0:e("dense0",!0),dense1:e("dense1"),dense2:e("dense2"),dense3:e("dense3")};return ka(n,t),{params:r,paramMappings:t}}var O_=function(n){Be(t,n);function t(){return n.call(this,"FaceFeatureExtractor")||this}return t.prototype.forwardInput=function(e){var r=this.params;if(!r)throw new Error("FaceFeatureExtractor - load model before inference");return be(function(){var a=e.toBatchTensor(112,!0),i=[122.782,117.001,104.298],u=ml(a,i).div(ge(255)),l=Zc(u,r.dense0,!0);return l=Zc(l,r.dense1),l=Zc(l,r.dense2),l=Zc(l,r.dense3),l=pl(l,[7,7],[2,2],"valid"),l})},t.prototype.forward=function(e){return Ce(this,void 0,void 0,function(){var r;return Re(this,function(a){switch(a.label){case 0:return r=this.forwardInput,[4,rn(e)];case 1:return[2,r.apply(this,[a.sent()])]}})})},t.prototype.getDefaultModelName=function(){return"face_feature_extractor_model"},t.prototype.extractParamsFromWeigthMap=function(e){return aU(e)},t.prototype.extractParams=function(e){return rU(e)},t}(Oa);function jr(n,t){return be(function(){return qe(uh(n,t.weights),t.bias)})}function iU(n,t,e){var r=[],a=Na(n),i=a.extractWeights,u=a.getRemainingWeights,l=Dg(i,r),c=l(t,e,"fc");if(u().length!==0)throw new Error("weights remaing after extract: "+u().length);return{paramMappings:r,params:{fc:c}}}function oU(n){var t=[],e=Si(n,t);function r(i){var u=e(i+"/weights",2),l=e(i+"/bias",1);return{weights:u,bias:l}}var a={fc:r("fc")};return ka(n,t),{params:a,paramMappings:t}}function k_(n){var t={},e={};return Object.keys(n).forEach(function(r){var a=r.startsWith("fc")?e:t;a[r]=n[r]}),{featureExtractorMap:t,classifierMap:e}}var N_=function(n){Be(t,n);function t(e,r){var a=n.call(this,e)||this;return a._faceFeatureExtractor=r,a}return Object.defineProperty(t.prototype,"faceFeatureExtractor",{get:function(){return this._faceFeatureExtractor},enumerable:!0,configurable:!0}),t.prototype.runNet=function(e){var r=this,a=this.params;if(!a)throw new Error(this._name+" - load model before inference");return be(function(){var i=e instanceof Hf?r.faceFeatureExtractor.forwardInput(e):e;return jr(i.as2D(i.shape[0],-1),a.fc)})},t.prototype.dispose=function(e){e===void 0&&(e=!0),this.faceFeatureExtractor.dispose(e),n.prototype.dispose.call(this,e)},t.prototype.loadClassifierParams=function(e){var r=this.extractClassifierParams(e),a=r.params,i=r.paramMappings;this._params=a,this._paramMappings=i},t.prototype.extractClassifierParams=function(e){return iU(e,this.getClassifierChannelsIn(),this.getClassifierChannelsOut())},t.prototype.extractParamsFromWeigthMap=function(e){var r=k_(e),a=r.featureExtractorMap,i=r.classifierMap;return this.faceFeatureExtractor.loadFromWeightMap(a),oU(i)},t.prototype.extractParams=function(e){var r=this.getClassifierChannelsIn(),a=this.getClassifierChannelsOut(),i=a*r+a,u=e.slice(0,e.length-i),l=e.slice(e.length-i);return this.faceFeatureExtractor.extractWeights(u),this.extractClassifierParams(l)},t}(Oa),s2=["neutral","happy","sad","angry","fearful","disgusted","surprised"],Ng=function(){function n(t){var e=this;if(t.length!==7)throw new Error("FaceExpressions.constructor - expected probabilities.length to be 7, have: "+t.length);s2.forEach(function(r,a){e[r]=t[a]})}return n.prototype.asSortedArray=function(){var t=this;return s2.map(function(e){return{expression:e,probability:t[e]}}).sort(function(e,r){return r.probability-e.probability})},n}(),sU=function(n){Be(t,n);function t(e){return e===void 0&&(e=new O_),n.call(this,"FaceExpressionNet",e)||this}return t.prototype.forwardInput=function(e){var r=this;return be(function(){return Ta(r.runNet(e))})},t.prototype.forward=function(e){return Ce(this,void 0,void 0,function(){var r;return Re(this,function(a){switch(a.label){case 0:return r=this.forwardInput,[4,rn(e)];case 1:return[2,r.apply(this,[a.sent()])]}})})},t.prototype.predictExpressions=function(e){return Ce(this,void 0,void 0,function(){var r,a,i,u,l=this;return Re(this,function(c){switch(c.label){case 0:return[4,rn(e)];case 1:return r=c.sent(),[4,this.forwardInput(r)];case 2:return a=c.sent(),[4,Promise.all(jt(a).map(function(f){return Ce(l,void 0,void 0,function(){var d;return Re(this,function(v){switch(v.label){case 0:return[4,f.data()];case 1:return d=v.sent(),f.dispose(),[2,d]}})})}))];case 3:return i=c.sent(),a.dispose(),u=i.map(function(f){return new Ng(f)}),[2,r.isBatchInput?u:u[0]]}})})},t.prototype.getDefaultModelName=function(){return"face_expression_model"},t.prototype.getClassifierChannelsIn=function(){return 256},t.prototype.getClassifierChannelsOut=function(){return 7},t}(N_);function uU(n){return n.expressions instanceof Ng}function M_(n,t){var e={expressions:t};return Object.assign({},n,e)}function Q6(n,t,e,r){e===void 0&&(e=.1);var a=Array.isArray(t)?t:[t];a.forEach(function(i){var u=i instanceof Ng?i:uU(i)?i.expressions:void 0;if(!u)throw new Error("drawFaceExpressions - expected faceExpressions to be FaceExpressions | WithFaceExpressions<{}> or array thereof");var l=u.asSortedArray(),c=l.filter(function(v){return v.probability>e}),f=nl(i)?i.detection.box.bottomLeft:new et(0,0),d=new E_(c.map(function(v){return v.expression+" ("+xg(v.probability)+")"}),f);d.draw(n)})}function I_(n){return nl(n)&&n.landmarks instanceof tl&&n.unshiftedLandmarks instanceof tl&&n.alignedRect instanceof Jn}function mh(n,t){var e=n.detection.box,r=t.shiftBy(e.x,e.y),a=r.align(),i=n.detection.imageDims,u=new Jn(n.detection.score,a.rescale(i.reverse()),i),l={landmarks:r,unshiftedLandmarks:t,alignedRect:u};return Object.assign({},n,l)}function lU(n,t){var e=vh(n,t),r=Og(n,t);function a(u,l,c){var f=r(u,l,c+"/separable_conv0"),d=r(l,l,c+"/separable_conv1"),v=e(u,l,1,c+"/expansion_conv");return{separable_conv0:f,separable_conv1:d,expansion_conv:v}}function i(u,l){var c=r(u,u,l+"/separable_conv0"),f=r(u,u,l+"/separable_conv1"),d=r(u,u,l+"/separable_conv2");return{separable_conv0:c,separable_conv1:f,separable_conv2:d}}return{extractConvParams:e,extractSeparableConvParams:r,extractReductionBlockParams:a,extractMainBlockParams:i}}function cU(n,t){var e=[],r=Na(n),a=r.extractWeights,i=r.getRemainingWeights,u=lU(a,e),l=u.extractConvParams,c=u.extractSeparableConvParams,f=u.extractReductionBlockParams,d=u.extractMainBlockParams,v=l(3,32,3,"entry_flow/conv_in"),m=f(32,64,"entry_flow/reduction_block_0"),g=f(64,128,"entry_flow/reduction_block_1"),b={conv_in:v,reduction_block_0:m,reduction_block_1:g},w={};Ju(t,0,1).forEach(function(R){w["main_block_"+R]=d(128,"middle_flow/main_block_"+R)});var S=f(128,256,"exit_flow/reduction_block"),E=c(256,512,"exit_flow/separable_conv"),_={reduction_block:S,separable_conv:E};if(i().length!==0)throw new Error("weights remaing after extract: "+i().length);return{paramMappings:e,params:{entry_flow:b,middle_flow:w,exit_flow:_}}}function fU(n,t){var e=Si(n,t),r=T_(e),a=kg(e);function i(l){var c=a(l+"/separable_conv0"),f=a(l+"/separable_conv1"),d=r(l+"/expansion_conv");return{separable_conv0:c,separable_conv1:f,expansion_conv:d}}function u(l){var c=a(l+"/separable_conv0"),f=a(l+"/separable_conv1"),d=a(l+"/separable_conv2");return{separable_conv0:c,separable_conv1:f,separable_conv2:d}}return{extractConvParams:r,extractSeparableConvParams:a,extractReductionBlockParams:i,extractMainBlockParams:u}}function hU(n,t){var e=[],r=fU(n,e),a=r.extractConvParams,i=r.extractSeparableConvParams,u=r.extractReductionBlockParams,l=r.extractMainBlockParams,c=a("entry_flow/conv_in"),f=u("entry_flow/reduction_block_0"),d=u("entry_flow/reduction_block_1"),v={conv_in:c,reduction_block_0:f,reduction_block_1:d},m={};Ju(t,0,1).forEach(function(S){m["main_block_"+S]=l("middle_flow/main_block_"+S)});var g=u("exit_flow/reduction_block"),b=i("exit_flow/separable_conv"),w={reduction_block:g,separable_conv:b};return ka(n,e),{params:{entry_flow:v,middle_flow:m,exit_flow:w},paramMappings:e}}function F_(n,t,e){return qe(yr(n,t.filters,e,"same"),t.bias)}function Ev(n,t,e){e===void 0&&(e=!0);var r=e?St(n):n;return r=Yn(r,t.separable_conv0,[1,1]),r=Yn(St(r),t.separable_conv1,[1,1]),r=Jt(r,[3,3],[2,2],"same"),r=qe(r,F_(n,t.expansion_conv,[2,2])),r}function dU(n,t){var e=Yn(St(n),t.separable_conv0,[1,1]);return e=Yn(St(e),t.separable_conv1,[1,1]),e=Yn(St(e),t.separable_conv2,[1,1]),e=qe(e,n),e}var pU=function(n){Be(t,n);function t(e){var r=n.call(this,"TinyXception")||this;return r._numMainBlocks=e,r}return t.prototype.forwardInput=function(e){var r=this,a=this.params;if(!a)throw new Error("TinyXception - load model before inference");return be(function(){var i=e.toBatchTensor(112,!0),u=[122.782,117.001,104.298],l=ml(i,u).div(ge(256)),c=St(F_(l,a.entry_flow.conv_in,[2,2]));return c=Ev(c,a.entry_flow.reduction_block_0,!1),c=Ev(c,a.entry_flow.reduction_block_1),Ju(r._numMainBlocks,0,1).forEach(function(f){c=dU(c,a.middle_flow["main_block_"+f])}),c=Ev(c,a.exit_flow.reduction_block),c=St(Yn(c,a.exit_flow.separable_conv,[1,1])),c})},t.prototype.forward=function(e){return Ce(this,void 0,void 0,function(){var r;return Re(this,function(a){switch(a.label){case 0:return r=this.forwardInput,[4,rn(e)];case 1:return[2,r.apply(this,[a.sent()])]}})})},t.prototype.getDefaultModelName=function(){return"tiny_xception_model"},t.prototype.extractParamsFromWeigthMap=function(e){return hU(e,this._numMainBlocks)},t.prototype.extractParams=function(e){return cU(e,this._numMainBlocks)},t}(Oa);function vU(n){var t=[],e=Na(n),r=e.extractWeights,a=e.getRemainingWeights,i=Dg(r,t),u=i(512,1,"fc/age"),l=i(512,2,"fc/gender");if(a().length!==0)throw new Error("weights remaing after extract: "+a().length);return{paramMappings:t,params:{fc:{age:u,gender:l}}}}function mU(n){var t=[],e=Si(n,t);function r(i){var u=e(i+"/weights",2),l=e(i+"/bias",1);return{weights:u,bias:l}}var a={fc:{age:r("fc/age"),gender:r("fc/gender")}};return ka(n,t),{params:a,paramMappings:t}}var Vf;(function(n){n.FEMALE="female",n.MALE="male"})(Vf||(Vf={}));var gU=function(n){Be(t,n);function t(e){e===void 0&&(e=new pU(2));var r=n.call(this,"AgeGenderNet")||this;return r._faceFeatureExtractor=e,r}return Object.defineProperty(t.prototype,"faceFeatureExtractor",{get:function(){return this._faceFeatureExtractor},enumerable:!0,configurable:!0}),t.prototype.runNet=function(e){var r=this,a=this.params;if(!a)throw new Error(this._name+" - load model before inference");return be(function(){var i=e instanceof Hf?r.faceFeatureExtractor.forwardInput(e):e,u=pl(i,[7,7],[2,2],"valid").as2D(i.shape[0],-1),l=jr(u,a.fc.age).as1D(),c=jr(u,a.fc.gender);return{age:l,gender:c}})},t.prototype.forwardInput=function(e){var r=this;return be(function(){var a=r.runNet(e),i=a.age,u=a.gender;return{age:i,gender:Ta(u)}})},t.prototype.forward=function(e){return Ce(this,void 0,void 0,function(){var r;return Re(this,function(a){switch(a.label){case 0:return r=this.forwardInput,[4,rn(e)];case 1:return[2,r.apply(this,[a.sent()])]}})})},t.prototype.predictAgeAndGender=function(e){return Ce(this,void 0,void 0,function(){var r,a,i,u,l,c,f=this;return Re(this,function(d){switch(d.label){case 0:return[4,rn(e)];case 1:return r=d.sent(),[4,this.forwardInput(r)];case 2:return a=d.sent(),i=jt(a.age),u=jt(a.gender),l=i.map(function(v,m){return{ageTensor:v,genderTensor:u[m]}}),[4,Promise.all(l.map(function(v){var m=v.ageTensor,g=v.genderTensor;return Ce(f,void 0,void 0,function(){var b,w,S,E,_;return Re(this,function(R){switch(R.label){case 0:return[4,m.data()];case 1:return b=R.sent()[0],[4,g.data()];case 2:return w=R.sent()[0],S=w>.5,E=S?Vf.MALE:Vf.FEMALE,_=S?w:1-w,m.dispose(),g.dispose(),[2,{age:b,gender:E,genderProbability:_}]}})})}))];case 3:return c=d.sent(),a.age.dispose(),a.gender.dispose(),[2,r.isBatchInput?c:c[0]]}})})},t.prototype.getDefaultModelName=function(){return"age_gender_model"},t.prototype.dispose=function(e){e===void 0&&(e=!0),this.faceFeatureExtractor.dispose(e),n.prototype.dispose.call(this,e)},t.prototype.loadClassifierParams=function(e){var r=this.extractClassifierParams(e),a=r.params,i=r.paramMappings;this._params=a,this._paramMappings=i},t.prototype.extractClassifierParams=function(e){return vU(e)},t.prototype.extractParamsFromWeigthMap=function(e){var r=k_(e),a=r.featureExtractorMap,i=r.classifierMap;return this.faceFeatureExtractor.loadFromWeightMap(a),mU(i)},t.prototype.extractParams=function(e){var r=1539,a=e.slice(0,e.length-r),i=e.slice(e.length-r);return this.faceFeatureExtractor.extractWeights(a),this.extractClassifierParams(i)},t}(Oa),B_=function(n){Be(t,n);function t(){return n!==null&&n.apply(this,arguments)||this}return t.prototype.postProcess=function(e,r,a){var i=a.map(function(l){var c=l.width,f=l.height,d=r/Math.max(f,c);return{width:c*d,height:f*d}}),u=i.length;return be(function(){var l=function(m,g){return Qn([Kr([68],m),Kr([68],g)],1).as2D(1,136).as1D()},c=function(m,g){var b=i[m],w=b.width,S=b.height;return g(w,S)?Math.abs(w-S)/2:0},f=function(m){return c(m,function(g,b){return g<b})},d=function(m){return c(m,function(g,b){return b<g})},v=e.mul(Kr([u,136],r)).sub(Qn(Array.from(Array(u),function(m,g){return l(f(g),d(g))}))).div(Qn(Array.from(Array(u),function(m,g){return l(i[g].width,i[g].height)})));return v})},t.prototype.forwardInput=function(e){var r=this;return be(function(){var a=r.runNet(e);return r.postProcess(a,e.inputSize,e.inputDimensions.map(function(i){var u=i[0],l=i[1];return{height:u,width:l}}))})},t.prototype.forward=function(e){return Ce(this,void 0,void 0,function(){var r;return Re(this,function(a){switch(a.label){case 0:return r=this.forwardInput,[4,rn(e)];case 1:return[2,r.apply(this,[a.sent()])]}})})},t.prototype.detectLandmarks=function(e){return Ce(this,void 0,void 0,function(){var r,a,i,u=this;return Re(this,function(l){switch(l.label){case 0:return[4,rn(e)];case 1:return r=l.sent(),a=be(function(){return jt(u.forwardInput(r))}),[4,Promise.all(a.map(function(c,f){return Ce(u,void 0,void 0,function(){var d,v,m,g,b;return Re(this,function(w){switch(w.label){case 0:return m=(v=Array).from,[4,c.data()];case 1:return d=m.apply(v,[w.sent()]),g=d.filter(function(S,E){return t2(E)}),b=d.filter(function(S,E){return!t2(E)}),[2,new qz(Array(68).fill(0).map(function(S,E){return new et(g[E],b[E])}),{height:r.getInputHeight(f),width:r.getInputWidth(f)})]}})})}))];case 2:return i=l.sent(),a.forEach(function(c){return c.dispose()}),[2,r.isBatchInput?i:i[0]]}})})},t.prototype.getClassifierChannelsOut=function(){return 136},t}(N_),P_=function(n){Be(t,n);function t(e){return e===void 0&&(e=new O_),n.call(this,"FaceLandmark68Net",e)||this}return t.prototype.getDefaultModelName=function(){return"face_landmark_68_model"},t.prototype.getClassifierChannelsIn=function(){return 256},t}(B_);function yU(n){var t=[],e=D_(n,t).extractDenseBlock3Params,r={dense0:e("dense0",!0),dense1:e("dense1"),dense2:e("dense2")};return ka(n,t),{params:r,paramMappings:t}}function bU(n){var t=[],e=Na(n),r=e.extractWeights,a=e.getRemainingWeights,i=A_(r,t).extractDenseBlock3Params,u=i(3,32,"dense0",!0),l=i(32,64,"dense1"),c=i(64,128,"dense2");if(a().length!==0)throw new Error("weights remaing after extract: "+a().length);return{paramMappings:t,params:{dense0:u,dense1:l,dense2:c}}}var xU=function(n){Be(t,n);function t(){return n.call(this,"TinyFaceFeatureExtractor")||this}return t.prototype.forwardInput=function(e){var r=this.params;if(!r)throw new Error("TinyFaceFeatureExtractor - load model before inference");return be(function(){var a=e.toBatchTensor(112,!0),i=[122.782,117.001,104.298],u=ml(a,i).div(ge(255)),l=Sv(u,r.dense0,!0);return l=Sv(l,r.dense1),l=Sv(l,r.dense2),l=pl(l,[14,14],[2,2],"valid"),l})},t.prototype.forward=function(e){return Ce(this,void 0,void 0,function(){var r;return Re(this,function(a){switch(a.label){case 0:return r=this.forwardInput,[4,rn(e)];case 1:return[2,r.apply(this,[a.sent()])]}})})},t.prototype.getDefaultModelName=function(){return"face_feature_extractor_tiny_model"},t.prototype.extractParamsFromWeigthMap=function(e){return yU(e)},t.prototype.extractParams=function(e){return bU(e)},t}(Oa),wU=function(n){Be(t,n);function t(e){return e===void 0&&(e=new xU),n.call(this,"FaceLandmark68TinyNet",e)||this}return t.prototype.getDefaultModelName=function(){return"face_landmark_68_tiny_model"},t.prototype.getClassifierChannelsIn=function(){return 128},t}(B_);(function(n){Be(t,n);function t(){return n!==null&&n.apply(this,arguments)||this}return t})(P_);function SU(n,t){return qe(wn(n,t.weights),t.biases)}function Mg(n,t,e,r,a){a===void 0&&(a="same");var i=t.conv,u=i.filters,l=i.bias,c=yr(n,u,e,a);return c=qe(c,l),c=SU(c,t.scale),r?St(c):c}function EU(n,t){return Mg(n,t,[1,1],!0)}function L_(n,t){return Mg(n,t,[1,1],!1)}function z_(n,t){return Mg(n,t,[2,2],!0,"valid")}function _U(n,t){function e(l,c,f){var d=n(l),v=d.length/(c*f*f);if(Pz(v))throw new Error("depth has to be an integer: "+v+", weights.length: "+d.length+", numFilters: "+c+", filterSize: "+f);return be(function(){return yi(Mn(d,[c,v,f,f]),[2,3,1,0])})}function r(l,c,f,d){var v=e(l,c,f),m=Pt(n(c));return t.push({paramPath:d+"/filters"},{paramPath:d+"/bias"}),{filters:v,bias:m}}function a(l,c){var f=Pt(n(l)),d=Pt(n(l));return t.push({paramPath:c+"/weights"},{paramPath:c+"/biases"}),{weights:f,biases:d}}function i(l,c,f,d){var v=r(l,c,f,d+"/conv"),m=a(c,d+"/scale");return{conv:v,scale:m}}function u(l,c,f,d,v){v===void 0&&(v=!1);var m=i((v?.5:1)*l,c,f,d+"/conv1"),g=i(l,c,f,d+"/conv2");return{conv1:m,conv2:g}}return{extractConvLayerParams:i,extractResidualLayerParams:u}}function CU(n){var t=Na(n),e=t.extractWeights,r=t.getRemainingWeights,a=[],i=_U(e,a),u=i.extractConvLayerParams,l=i.extractResidualLayerParams,c=u(4704,32,7,"conv32_down"),f=l(9216,32,3,"conv32_1"),d=l(9216,32,3,"conv32_2"),v=l(9216,32,3,"conv32_3"),m=l(36864,64,3,"conv64_down",!0),g=l(36864,64,3,"conv64_1"),b=l(36864,64,3,"conv64_2"),w=l(36864,64,3,"conv64_3"),S=l(147456,128,3,"conv128_down",!0),E=l(147456,128,3,"conv128_1"),_=l(147456,128,3,"conv128_2"),R=l(589824,256,3,"conv256_down",!0),C=l(589824,256,3,"conv256_1"),A=l(589824,256,3,"conv256_2"),D=l(589824,256,3,"conv256_down_out"),O=be(function(){return yi(pi(e(256*128),[128,256]),[1,0])});if(a.push({paramPath:"fc"}),r().length!==0)throw new Error("weights remaing after extract: "+r().length);var F={conv32_down:c,conv32_1:f,conv32_2:d,conv32_3:v,conv64_down:m,conv64_1:g,conv64_2:b,conv64_3:w,conv128_down:S,conv128_1:E,conv128_2:_,conv256_down:R,conv256_1:C,conv256_2:A,conv256_down_out:D,fc:O};return{params:F,paramMappings:a}}function RU(n,t){var e=Si(n,t);function r(u){var l=e(u+"/scale/weights",1),c=e(u+"/scale/biases",1);return{weights:l,biases:c}}function a(u){var l=e(u+"/conv/filters",4),c=e(u+"/conv/bias",1),f=r(u);return{conv:{filters:l,bias:c},scale:f}}function i(u){return{conv1:a(u+"/conv1"),conv2:a(u+"/conv2")}}return{extractConvLayerParams:a,extractResidualLayerParams:i}}function AU(n){var t=[],e=RU(n,t),r=e.extractConvLayerParams,a=e.extractResidualLayerParams,i=r("conv32_down"),u=a("conv32_1"),l=a("conv32_2"),c=a("conv32_3"),f=a("conv64_down"),d=a("conv64_1"),v=a("conv64_2"),m=a("conv64_3"),g=a("conv128_down"),b=a("conv128_1"),w=a("conv128_2"),S=a("conv256_down"),E=a("conv256_1"),_=a("conv256_2"),R=a("conv256_down_out"),C=n.fc;if(t.push({originalPath:"fc",paramPath:"fc"}),!Bz(C))throw new Error("expected weightMap[fc] to be a Tensor2D, instead have "+C);var A={conv32_down:i,conv32_1:u,conv32_2:l,conv32_3:c,conv64_down:f,conv64_1:d,conv64_2:v,conv64_3:m,conv128_down:g,conv128_1:b,conv128_2:w,conv256_down:S,conv256_1:E,conv256_2:_,conv256_down_out:R,fc:C};return ka(n,t),{params:A,paramMappings:t}}function Lr(n,t){var e=EU(n,t.conv1);return e=L_(e,t.conv2),e=qe(e,n),e=St(e),e}function Yc(n,t){var e=z_(n,t.conv1);e=L_(e,t.conv2);var r=pl(n,2,2,"valid"),a=mt(r.shape),i=r.shape[3]!==e.shape[3],u=r.shape[1]!==e.shape[1]||r.shape[2]!==e.shape[2];if(u){var l=Hu(e.shape);l[1]=1;var c=mt(l);e=Gt([e,c],1);var f=Hu(e.shape);f[2]=1;var d=mt(f);e=Gt([e,d],2)}return r=i?Gt([r,a],3):r,e=qe(r,e),e=St(e),e}var TU=function(n){Be(t,n);function t(){return n.call(this,"FaceRecognitionNet")||this}return t.prototype.forwardInput=function(e){var r=this.params;if(!r)throw new Error("FaceRecognitionNet - load model before inference");return be(function(){var a=e.toBatchTensor(150,!0).toFloat(),i=[122.782,117.001,104.298],u=ml(a,i).div(ge(256)),l=z_(u,r.conv32_down);l=Jt(l,3,2,"valid"),l=Lr(l,r.conv32_1),l=Lr(l,r.conv32_2),l=Lr(l,r.conv32_3),l=Yc(l,r.conv64_down),l=Lr(l,r.conv64_1),l=Lr(l,r.conv64_2),l=Lr(l,r.conv64_3),l=Yc(l,r.conv128_down),l=Lr(l,r.conv128_1),l=Lr(l,r.conv128_2),l=Yc(l,r.conv256_down),l=Lr(l,r.conv256_1),l=Lr(l,r.conv256_2),l=Yc(l,r.conv256_down_out);var c=l.mean([1,2]),f=uh(c,r.fc);return f})},t.prototype.forward=function(e){return Ce(this,void 0,void 0,function(){var r;return Re(this,function(a){switch(a.label){case 0:return r=this.forwardInput,[4,rn(e)];case 1:return[2,r.apply(this,[a.sent()])]}})})},t.prototype.computeFaceDescriptor=function(e){return Ce(this,void 0,void 0,function(){var r,a,i,u=this;return Re(this,function(l){switch(l.label){case 0:return[4,rn(e)];case 1:return r=l.sent(),a=be(function(){return jt(u.forwardInput(r))}),[4,Promise.all(a.map(function(c){return c.data()}))];case 2:return i=l.sent(),a.forEach(function(c){return c.dispose()}),[2,r.isBatchInput?i:i[0]]}})})},t.prototype.getDefaultModelName=function(){return"face_recognition_model"},t.prototype.extractParamsFromWeigthMap=function(e){return AU(e)},t.prototype.extractParams=function(e){return CU(e)},t}(Oa);function U_(n,t){var e={descriptor:t};return Object.assign({},n,e)}function H_(n,t){var e={age:t};return Object.assign({},n,e)}function V_(n,t,e){var r={gender:t,genderProbability:e};return Object.assign({},n,r)}var W_=function(){function n(t){var e=t===void 0?{}:t,r=e.minFaceSize,a=e.scaleFactor,i=e.maxNumScales,u=e.scoreThresholds,l=e.scaleSteps;if(this._name="MtcnnOptions",this._minFaceSize=r||20,this._scaleFactor=a||.709,this._maxNumScales=i||10,this._scoreThresholds=u||[.6,.7,.7],this._scaleSteps=l,typeof this._minFaceSize!="number"||this._minFaceSize<0)throw new Error(this._name+" - expected minFaceSize to be a number > 0");if(typeof this._scaleFactor!="number"||this._scaleFactor<=0||this._scaleFactor>=1)throw new Error(this._name+" - expected scaleFactor to be a number between 0 and 1");if(typeof this._maxNumScales!="number"||this._maxNumScales<0)throw new Error(this._name+" - expected maxNumScales to be a number > 0");if(!Array.isArray(this._scoreThresholds)||this._scoreThresholds.length!==3||this._scoreThresholds.some(function(c){return typeof c!="number"}))throw new Error(this._name+" - expected scoreThresholds to be an array of numbers of length 3");if(this._scaleSteps&&(!Array.isArray(this._scaleSteps)||this._scaleSteps.some(function(c){return typeof c!="number"})))throw new Error(this._name+" - expected scaleSteps to be an array of numbers")}return Object.defineProperty(n.prototype,"minFaceSize",{get:function(){return this._minFaceSize},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"scaleFactor",{get:function(){return this._scaleFactor},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"maxNumScales",{get:function(){return this._maxNumScales},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"scoreThresholds",{get:function(){return this._scoreThresholds},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"scaleSteps",{get:function(){return this._scaleSteps},enumerable:!0,configurable:!0}),n}();function DU(n,t){function e(c,f){var d=Mn(n(9*c),[3,3,c,1]),v=Pt(n(c)),m=Pt(n(c)),g=Pt(n(c)),b=Pt(n(c));return t.push({paramPath:f+"/filters"},{paramPath:f+"/batch_norm_scale"},{paramPath:f+"/batch_norm_offset"},{paramPath:f+"/batch_norm_mean"},{paramPath:f+"/batch_norm_variance"}),{filters:d,batch_norm_scale:v,batch_norm_offset:m,batch_norm_mean:g,batch_norm_variance:b}}function r(c,f,d,v,m){var g=Mn(n(c*f*d*d),[d,d,c,f]),b=Pt(n(f));return t.push({paramPath:v+"/filters"},{paramPath:v+"/"+(m?"batch_norm_offset":"bias")}),{filters:g,bias:b}}function a(c,f,d,v){var m=r(c,f,d,v,!0),g=m.filters,b=m.bias;return{filters:g,batch_norm_offset:b}}function i(c,f,d){var v=e(c,d+"/depthwise_conv"),m=a(c,f,1,d+"/pointwise_conv");return{depthwise_conv:v,pointwise_conv:m}}function u(){var c=a(3,32,3,"mobilenetv1/conv_0"),f=i(32,64,"mobilenetv1/conv_1"),d=i(64,128,"mobilenetv1/conv_2"),v=i(128,128,"mobilenetv1/conv_3"),m=i(128,256,"mobilenetv1/conv_4"),g=i(256,256,"mobilenetv1/conv_5"),b=i(256,512,"mobilenetv1/conv_6"),w=i(512,512,"mobilenetv1/conv_7"),S=i(512,512,"mobilenetv1/conv_8"),E=i(512,512,"mobilenetv1/conv_9"),_=i(512,512,"mobilenetv1/conv_10"),R=i(512,512,"mobilenetv1/conv_11"),C=i(512,1024,"mobilenetv1/conv_12"),A=i(1024,1024,"mobilenetv1/conv_13");return{conv_0:c,conv_1:f,conv_2:d,conv_3:v,conv_4:m,conv_5:g,conv_6:b,conv_7:w,conv_8:S,conv_9:E,conv_10:_,conv_11:R,conv_12:C,conv_13:A}}function l(){var c=a(1024,256,1,"prediction_layer/conv_0"),f=a(256,512,3,"prediction_layer/conv_1"),d=a(512,128,1,"prediction_layer/conv_2"),v=a(128,256,3,"prediction_layer/conv_3"),m=a(256,128,1,"prediction_layer/conv_4"),g=a(128,256,3,"prediction_layer/conv_5"),b=a(256,64,1,"prediction_layer/conv_6"),w=a(64,128,3,"prediction_layer/conv_7"),S=r(512,12,1,"prediction_layer/box_predictor_0/box_encoding_predictor"),E=r(512,9,1,"prediction_layer/box_predictor_0/class_predictor"),_=r(1024,24,1,"prediction_layer/box_predictor_1/box_encoding_predictor"),R=r(1024,18,1,"prediction_layer/box_predictor_1/class_predictor"),C=r(512,24,1,"prediction_layer/box_predictor_2/box_encoding_predictor"),A=r(512,18,1,"prediction_layer/box_predictor_2/class_predictor"),D=r(256,24,1,"prediction_layer/box_predictor_3/box_encoding_predictor"),O=r(256,18,1,"prediction_layer/box_predictor_3/class_predictor"),F=r(256,24,1,"prediction_layer/box_predictor_4/box_encoding_predictor"),N=r(256,18,1,"prediction_layer/box_predictor_4/class_predictor"),B=r(128,24,1,"prediction_layer/box_predictor_5/box_encoding_predictor"),H=r(128,18,1,"prediction_layer/box_predictor_5/class_predictor"),U={box_encoding_predictor:S,class_predictor:E},J={box_encoding_predictor:_,class_predictor:R},ee={box_encoding_predictor:C,class_predictor:A},te={box_encoding_predictor:D,class_predictor:O},L={box_encoding_predictor:F,class_predictor:N},W={box_encoding_predictor:B,class_predictor:H};return{conv_0:c,conv_1:f,conv_2:d,conv_3:v,conv_4:m,conv_5:g,conv_6:b,conv_7:w,box_predictor_0:U,box_predictor_1:J,box_predictor_2:ee,box_predictor_3:te,box_predictor_4:L,box_predictor_5:W}}return{extractMobilenetV1Params:u,extractPredictionLayerParams:l}}function OU(n){var t=[],e=Na(n),r=e.extractWeights,a=e.getRemainingWeights,i=DU(r,t),u=i.extractMobilenetV1Params,l=i.extractPredictionLayerParams,c=u(),f=l(),d=$m(r(5118*4),[1,5118,4]),v={extra_dim:d};if(t.push({paramPath:"output_layer/extra_dim"}),a().length!==0)throw new Error("weights remaing after extract: "+a().length);return{params:{mobilenetv1:c,prediction_layer:f,output_layer:v},paramMappings:t}}function kU(n,t){var e=Si(n,t);function r(f,d,v){var m=e(f+"/Conv2d_"+d+"_pointwise/weights",4,v+"/filters"),g=e(f+"/Conv2d_"+d+"_pointwise/convolution_bn_offset",1,v+"/batch_norm_offset");return{filters:m,batch_norm_offset:g}}function a(f){var d="mobilenetv1/conv_"+f,v="MobilenetV1/Conv2d_"+f+"_depthwise",m=d+"/depthwise_conv",g=d+"/pointwise_conv",b=e(v+"/depthwise_weights",4,m+"/filters"),w=e(v+"/BatchNorm/gamma",1,m+"/batch_norm_scale"),S=e(v+"/BatchNorm/beta",1,m+"/batch_norm_offset"),E=e(v+"/BatchNorm/moving_mean",1,m+"/batch_norm_mean"),_=e(v+"/BatchNorm/moving_variance",1,m+"/batch_norm_variance");return{depthwise_conv:{filters:b,batch_norm_scale:w,batch_norm_offset:S,batch_norm_mean:E,batch_norm_variance:_},pointwise_conv:r("MobilenetV1",f,g)}}function i(){return{conv_0:r("MobilenetV1",0,"mobilenetv1/conv_0"),conv_1:a(1),conv_2:a(2),conv_3:a(3),conv_4:a(4),conv_5:a(5),conv_6:a(6),conv_7:a(7),conv_8:a(8),conv_9:a(9),conv_10:a(10),conv_11:a(11),conv_12:a(12),conv_13:a(13)}}function u(f,d){var v=e(f+"/weights",4,d+"/filters"),m=e(f+"/biases",1,d+"/bias");return{filters:v,bias:m}}function l(f){var d=u("Prediction/BoxPredictor_"+f+"/BoxEncodingPredictor","prediction_layer/box_predictor_"+f+"/box_encoding_predictor"),v=u("Prediction/BoxPredictor_"+f+"/ClassPredictor","prediction_layer/box_predictor_"+f+"/class_predictor");return{box_encoding_predictor:d,class_predictor:v}}function c(){return{conv_0:r("Prediction",0,"prediction_layer/conv_0"),conv_1:r("Prediction",1,"prediction_layer/conv_1"),conv_2:r("Prediction",2,"prediction_layer/conv_2"),conv_3:r("Prediction",3,"prediction_layer/conv_3"),conv_4:r("Prediction",4,"prediction_layer/conv_4"),conv_5:r("Prediction",5,"prediction_layer/conv_5"),conv_6:r("Prediction",6,"prediction_layer/conv_6"),conv_7:r("Prediction",7,"prediction_layer/conv_7"),box_predictor_0:l(0),box_predictor_1:l(1),box_predictor_2:l(2),box_predictor_3:l(3),box_predictor_4:l(4),box_predictor_5:l(5)}}return{extractMobilenetV1Params:i,extractPredictionLayerParams:c}}function NU(n){var t=[],e=kU(n,t),r=e.extractMobilenetV1Params,a=e.extractPredictionLayerParams,i=n["Output/extra_dim"];if(t.push({originalPath:"Output/extra_dim",paramPath:"output_layer/extra_dim"}),!hh(i))throw new Error("expected weightMap['Output/extra_dim'] to be a Tensor3D, instead have "+i);var u={mobilenetv1:r(),prediction_layer:a(),output_layer:{extra_dim:i}};return ka(n,t),{params:u,paramMappings:t}}function zr(n,t,e){return be(function(){var r=yr(n,t.filters,e,"same");return r=qe(r,t.batch_norm_offset),ag(r,0,6)})}var MU=.0010000000474974513;function IU(n,t,e){return be(function(){var r=sh(n,t.filters,e,"same");return r=BE(r,t.batch_norm_mean,t.batch_norm_variance,t.batch_norm_offset,t.batch_norm_scale,MU),ag(r,0,6)})}function FU(n){return[2,4,6,12].some(function(t){return t===n})?[2,2]:[1,1]}function BU(n,t){return be(function(){var e=null,r=zr(n,t.conv_0,[2,2]),a=[t.conv_1,t.conv_2,t.conv_3,t.conv_4,t.conv_5,t.conv_6,t.conv_7,t.conv_8,t.conv_9,t.conv_10,t.conv_11,t.conv_12,t.conv_13];if(a.forEach(function(i,u){var l=u+1,c=FU(l);r=IU(r,i.depthwise_conv,c),r=zr(r,i.pointwise_conv,[1,1]),l===11&&(e=r)}),e===null)throw new Error("mobileNetV1 - output of conv layer 11 is null");return{out:r,conv11:e}})}function PU(n,t,e,r,a){var i=n.shape[0],u=Math.min(e,i),l=t.map(function(d,v){return{score:d,boxIndex:v}}).filter(function(d){return d.score>a}).sort(function(d,v){return v.score-d.score}),c=function(d){return d<=r?1:0},f=[];return l.forEach(function(d){if(!(f.length>=u)){for(var v=d.score,m=f.length-1;m>=0;--m){var g=LU(n,d.boxIndex,f[m]);if(g!==0&&(d.score*=c(g),d.score<=a))break}v===d.score&&f.push(d.boxIndex)}}),f}function LU(n,t,e){var r=n.arraySync(),a=Math.min(r[t][0],r[t][2]),i=Math.min(r[t][1],r[t][3]),u=Math.max(r[t][0],r[t][2]),l=Math.max(r[t][1],r[t][3]),c=Math.min(r[e][0],r[e][2]),f=Math.min(r[e][1],r[e][3]),d=Math.max(r[e][0],r[e][2]),v=Math.max(r[e][1],r[e][3]),m=(u-a)*(l-i),g=(d-c)*(v-f);if(m<=0||g<=0)return 0;var b=Math.max(a,c),w=Math.max(i,f),S=Math.min(u,d),E=Math.min(l,v),_=Math.max(S-b,0)*Math.max(E-w,0);return _/(m+g-_)}function zU(n){var t=jt(yi(n,[1,0])),e=[$t(t[2],t[0]),$t(t[3],t[1])],r=[qe(t[0],_r(e[0],ge(2))),qe(t[1],_r(e[1],ge(2)))];return{sizes:e,centers:r}}function UU(n,t){var e=zU(n),r=e.sizes,a=e.centers,i=jt(yi(t,[1,0])),u=_r(wn(fm(_r(i[2],ge(5))),r[0]),ge(2)),l=qe(wn(_r(i[0],ge(10)),r[0]),a[0]),c=_r(wn(fm(_r(i[3],ge(5))),r[1]),ge(2)),f=qe(wn(_r(i[1],ge(10)),r[1]),a[1]);return yi(Qn([$t(l,u),$t(f,c),qe(l,u),qe(f,c)]),[1,0])}function HU(n,t,e){return be(function(){var r=n.shape[0],a=UU(Cr(ls(e.extra_dim,[r,1,1]),[-1,4]),Cr(n,[-1,4]));a=Cr(a,[r,a.shape[0]/r,4]);var i=NE(Xr(t,[0,0,1],[-1,-1,-1])),u=Xr(i,[0,0,0],[-1,-1,1]);u=Cr(u,[r,u.shape[1]]);var l=jt(a),c=jt(u);return{boxes:l,scores:c}})}function Jo(n,t){return be(function(){var e=n.shape[0],r=Cr(Ar(n,t.box_encoding_predictor),[e,-1,1,4]),a=Cr(Ar(n,t.class_predictor),[e,-1,3]);return{boxPredictionEncoding:r,classPrediction:a}})}function VU(n,t,e){return be(function(){var r=zr(n,e.conv_0,[1,1]),a=zr(r,e.conv_1,[2,2]),i=zr(a,e.conv_2,[1,1]),u=zr(i,e.conv_3,[2,2]),l=zr(u,e.conv_4,[1,1]),c=zr(l,e.conv_5,[2,2]),f=zr(c,e.conv_6,[1,1]),d=zr(f,e.conv_7,[2,2]),v=Jo(t,e.box_predictor_0),m=Jo(n,e.box_predictor_1),g=Jo(a,e.box_predictor_2),b=Jo(u,e.box_predictor_3),w=Jo(c,e.box_predictor_4),S=Jo(d,e.box_predictor_5),E=Gt([v.boxPredictionEncoding,m.boxPredictionEncoding,g.boxPredictionEncoding,b.boxPredictionEncoding,w.boxPredictionEncoding,S.boxPredictionEncoding],1),_=Gt([v.classPrediction,m.classPrediction,g.classPrediction,b.classPrediction,w.classPrediction,S.classPrediction],1);return{boxPredictions:E,classPredictions:_}})}var gh=function(){function n(t){var e=t===void 0?{}:t,r=e.minConfidence,a=e.maxResults;if(this._name="SsdMobilenetv1Options",this._minConfidence=r||.5,this._maxResults=a||100,typeof this._minConfidence!="number"||this._minConfidence<=0||this._minConfidence>=1)throw new Error(this._name+" - expected minConfidence to be a number between 0 and 1");if(typeof this._maxResults!="number")throw new Error(this._name+" - expected maxResults to be a number")}return Object.defineProperty(n.prototype,"minConfidence",{get:function(){return this._minConfidence},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"maxResults",{get:function(){return this._maxResults},enumerable:!0,configurable:!0}),n}(),G_=function(n){Be(t,n);function t(){return n.call(this,"SsdMobilenetv1")||this}return t.prototype.forwardInput=function(e){var r=this.params;if(!r)throw new Error("SsdMobilenetv1 - load model before inference");return be(function(){var a=e.toBatchTensor(512,!1).toFloat(),i=$t(wn(a,ge(.007843137718737125)),ge(1)),u=BU(i,r.mobilenetv1),l=VU(u.out,u.conv11,r.prediction_layer),c=l.boxPredictions,f=l.classPredictions;return HU(c,f,r.output_layer)})},t.prototype.forward=function(e){return Ce(this,void 0,void 0,function(){var r;return Re(this,function(a){switch(a.label){case 0:return r=this.forwardInput,[4,rn(e)];case 1:return[2,r.apply(this,[a.sent()])]}})})},t.prototype.locateFaces=function(e,r){return r===void 0&&(r={}),Ce(this,void 0,void 0,function(){var a,i,u,l,c,f,d,v,m,g,b,w,S,E,_,R,C,A,D,O,F;return Re(this,function(N){switch(N.label){case 0:return a=new gh(r),i=a.maxResults,u=a.minConfidence,[4,rn(e)];case 1:for(l=N.sent(),c=this.forwardInput(l),f=c.boxes,d=c.scores,v=f[0],m=d[0],g=1;g<f.length;g++)f[g].dispose(),d[g].dispose();return S=(w=Array).from,[4,m.data()];case 2:return b=S.apply(w,[N.sent()]),E=.5,_=PU(v,b,i,E,u),R=l.getReshapedInputDimensions(0),C=l.inputSize,A=C/R.width,D=C/R.height,O=v.arraySync(),F=_.map(function(B){var H=[Math.max(0,O[B][0]),Math.min(1,O[B][2])].map(function(W){return W*D}),U=H[0],J=H[1],ee=[Math.max(0,O[B][1]),Math.min(1,O[B][3])].map(function(W){return W*A}),te=ee[0],L=ee[1];return new Jn(b[B],new Sg(te,U,L-te,J-U),{height:l.getInputHeight(0),width:l.getInputWidth(0)})}),v.dispose(),m.dispose(),[2,F]}})})},t.prototype.getDefaultModelName=function(){return"ssd_mobilenetv1_model"},t.prototype.extractParamsFromWeigthMap=function(e){return NU(e)},t.prototype.extractParams=function(e){return OU(e)},t}(Oa);(function(n){Be(t,n);function t(){return n!==null&&n.apply(this,arguments)||this}return t})(G_);var WU=.4,GU=[new et(.738768,.874946),new et(2.42204,2.65704),new et(4.30971,7.04493),new et(10.246,4.59428),new et(12.6868,11.8741)],jU=[new et(1.603231,2.094468),new et(6.041143,7.080126),new et(2.882459,3.518061),new et(4.266906,5.178857),new et(9.041765,10.66308)],qU=[117.001,114.697,97.404],$U="tiny_yolov2_model",KU="tiny_yolov2_separable_conv_model",Qc=function(n){return typeof n=="number"};function XU(n){if(!n)throw new Error("invalid config: "+n);if(typeof n.withSeparableConvs!="boolean")throw new Error("config.withSeparableConvs has to be a boolean, have: "+n.withSeparableConvs);if(!Qc(n.iouThreshold)||n.iouThreshold<0||n.iouThreshold>1)throw new Error("config.iouThreshold has to be a number between [0, 1], have: "+n.iouThreshold);if(!Array.isArray(n.classes)||!n.classes.length||!n.classes.every(function(t){return typeof t=="string"}))throw new Error("config.classes has to be an array class names: string[], have: "+JSON.stringify(n.classes));if(!Array.isArray(n.anchors)||!n.anchors.length||!n.anchors.map(function(t){return t||{}}).every(function(t){return Qc(t.x)&&Qc(t.y)}))throw new Error("config.anchors has to be an array of { x: number, y: number }, have: "+JSON.stringify(n.anchors));if(n.meanRgb&&(!Array.isArray(n.meanRgb)||n.meanRgb.length!==3||!n.meanRgb.every(Qc)))throw new Error("config.meanRgb has to be an array of shape [number, number, number], have: "+JSON.stringify(n.meanRgb))}function Ig(n){return be(function(){var t=wn(n,ge(.10000000149011612));return qe(St($t(n,t)),t)})}function ii(n,t){return be(function(){var e=ao(n,[[0,0],[1,1],[1,1],[0,0]]);return e=yr(e,t.conv.filters,[1,1],"valid"),e=$t(e,t.bn.sub),e=wn(e,t.bn.truediv),e=qe(e,t.conv.bias),Ig(e)})}function oi(n,t){return be(function(){var e=ao(n,[[0,0],[1,1],[1,1],[0,0]]);return e=ug(e,t.depthwise_filter,t.pointwise_filter,[1,1],"valid"),e=qe(e,t.bias),Ig(e)})}function ZU(n,t){var e=vh(n,t);function r(u,l){var c=Pt(n(u)),f=Pt(n(u));return t.push({paramPath:l+"/sub"},{paramPath:l+"/truediv"}),{sub:c,truediv:f}}function a(u,l,c){var f=e(u,l,3,c+"/conv"),d=r(l,c+"/bn");return{conv:f,bn:d}}var i=Og(n,t);return{extractConvParams:e,extractConvWithBatchNormParams:a,extractSeparableConvParams:i}}function YU(n,t,e,r){var a=Na(n),i=a.extractWeights,u=a.getRemainingWeights,l=[],c=ZU(i,l),f=c.extractConvParams,d=c.extractConvWithBatchNormParams,v=c.extractSeparableConvParams,m;if(t.withSeparableConvs){var g=r[0],b=r[1],w=r[2],S=r[3],E=r[4],_=r[5],R=r[6],C=r[7],A=r[8],D=t.isFirstLayerConv2d?f(g,b,3,"conv0"):v(g,b,"conv0"),O=v(b,w,"conv1"),F=v(w,S,"conv2"),N=v(S,E,"conv3"),B=v(E,_,"conv4"),H=v(_,R,"conv5"),U=C?v(R,C,"conv6"):void 0,J=A?v(C,A,"conv7"):void 0,ee=f(A||C||R,5*e,1,"conv8");m={conv0:D,conv1:O,conv2:F,conv3:N,conv4:B,conv5:H,conv6:U,conv7:J,conv8:ee}}else{var g=r[0],b=r[1],w=r[2],S=r[3],E=r[4],_=r[5],R=r[6],C=r[7],A=r[8],D=d(g,b,"conv0"),O=d(b,w,"conv1"),F=d(w,S,"conv2"),N=d(S,E,"conv3"),B=d(E,_,"conv4"),H=d(_,R,"conv5"),U=d(R,C,"conv6"),J=d(C,A,"conv7"),ee=f(A,5*e,1,"conv8");m={conv0:D,conv1:O,conv2:F,conv3:N,conv4:B,conv5:H,conv6:U,conv7:J,conv8:ee}}if(u().length!==0)throw new Error("weights remaing after extract: "+u().length);return{params:m,paramMappings:l}}function QU(n,t){var e=Si(n,t);function r(l){var c=e(l+"/sub",1),f=e(l+"/truediv",1);return{sub:c,truediv:f}}function a(l){var c=e(l+"/filters",4),f=e(l+"/bias",1);return{filters:c,bias:f}}function i(l){var c=a(l+"/conv"),f=r(l+"/bn");return{conv:c,bn:f}}var u=kg(e);return{extractConvParams:a,extractConvWithBatchNormParams:i,extractSeparableConvParams:u}}function JU(n,t){var e=[],r=QU(n,e),a=r.extractConvParams,i=r.extractConvWithBatchNormParams,u=r.extractSeparableConvParams,l;if(t.withSeparableConvs){var c=t.filterSizes&&t.filterSizes.length||9;l={conv0:t.isFirstLayerConv2d?a("conv0"):u("conv0"),conv1:u("conv1"),conv2:u("conv2"),conv3:u("conv3"),conv4:u("conv4"),conv5:u("conv5"),conv6:c>7?u("conv6"):void 0,conv7:c>8?u("conv7"):void 0,conv8:a("conv8")}}else l={conv0:i("conv0"),conv1:i("conv1"),conv2:i("conv2"),conv3:i("conv3"),conv4:i("conv4"),conv5:i("conv5"),conv6:i("conv6"),conv7:i("conv7"),conv8:a("conv8")};return ka(n,e),{params:l,paramMappings:e}}var u2;(function(n){n[n.XS=224]="XS",n[n.SM=320]="SM",n[n.MD=416]="MD",n[n.LG=608]="LG"})(u2||(u2={}));var Fg=function(){function n(t){var e=t===void 0?{}:t,r=e.inputSize,a=e.scoreThreshold;if(this._name="TinyYolov2Options",this._inputSize=r||416,this._scoreThreshold=a||.5,typeof this._inputSize!="number"||this._inputSize%32!==0)throw new Error(this._name+" - expected inputSize to be a number divisible by 32");if(typeof this._scoreThreshold!="number"||this._scoreThreshold<=0||this._scoreThreshold>=1)throw new Error(this._name+" - expected scoreThreshold to be a number between 0 and 1")}return Object.defineProperty(n.prototype,"inputSize",{get:function(){return this._inputSize},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"scoreThreshold",{get:function(){return this._scoreThreshold},enumerable:!0,configurable:!0}),n}(),j_=function(n){Be(t,n);function t(e){var r=n.call(this,"TinyYolov2")||this;return XU(e),r._config=e,r}return Object.defineProperty(t.prototype,"config",{get:function(){return this._config},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"withClassScores",{get:function(){return this.config.withClassScores||this.config.classes.length>1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"boxEncodingSize",{get:function(){return 5+(this.withClassScores?this.config.classes.length:0)},enumerable:!0,configurable:!0}),t.prototype.runTinyYolov2=function(e,r){var a=ii(e,r.conv0);return a=Jt(a,[2,2],[2,2],"same"),a=ii(a,r.conv1),a=Jt(a,[2,2],[2,2],"same"),a=ii(a,r.conv2),a=Jt(a,[2,2],[2,2],"same"),a=ii(a,r.conv3),a=Jt(a,[2,2],[2,2],"same"),a=ii(a,r.conv4),a=Jt(a,[2,2],[2,2],"same"),a=ii(a,r.conv5),a=Jt(a,[2,2],[1,1],"same"),a=ii(a,r.conv6),a=ii(a,r.conv7),Ar(a,r.conv8,"valid",!1)},t.prototype.runMobilenet=function(e,r){var a=this.config.isFirstLayerConv2d?Ig(Ar(e,r.conv0,"valid",!1)):oi(e,r.conv0);return a=Jt(a,[2,2],[2,2],"same"),a=oi(a,r.conv1),a=Jt(a,[2,2],[2,2],"same"),a=oi(a,r.conv2),a=Jt(a,[2,2],[2,2],"same"),a=oi(a,r.conv3),a=Jt(a,[2,2],[2,2],"same"),a=oi(a,r.conv4),a=Jt(a,[2,2],[2,2],"same"),a=oi(a,r.conv5),a=Jt(a,[2,2],[1,1],"same"),a=r.conv6?oi(a,r.conv6):a,a=r.conv7?oi(a,r.conv7):a,Ar(a,r.conv8,"valid",!1)},t.prototype.forwardInput=function(e,r){var a=this,i=this.params;if(!i)throw new Error("TinyYolov2 - load model before inference");return be(function(){var u=e.toBatchTensor(r,!1).toFloat();return u=a.config.meanRgb?ml(u,a.config.meanRgb):u,u=u.div(ge(256)),a.config.withSeparableConvs?a.runMobilenet(u,i):a.runTinyYolov2(u,i)})},t.prototype.forward=function(e,r){return Ce(this,void 0,void 0,function(){var a;return Re(this,function(i){switch(i.label){case 0:return a=this.forwardInput,[4,rn(e)];case 1:return[4,a.apply(this,[i.sent(),r])];case 2:return[2,i.sent()]}})})},t.prototype.detect=function(e,r){return r===void 0&&(r={}),Ce(this,void 0,void 0,function(){var a,i,u,l,c,f,d,v,m,g,b,w,S,E,_=this;return Re(this,function(R){switch(R.label){case 0:return a=new Fg(r),i=a.inputSize,u=a.scoreThreshold,[4,rn(e)];case 1:return l=R.sent(),[4,this.forwardInput(l,i)];case 2:return c=R.sent(),f=be(function(){return jt(c)[0].expandDims()}),d={width:l.getInputWidth(0),height:l.getInputHeight(0)},[4,this.extractBoxes(f,l.getReshapedInputDimensions(0),u)];case 3:return v=R.sent(),c.dispose(),f.dispose(),m=v.map(function(C){return C.box}),g=v.map(function(C){return C.score}),b=v.map(function(C){return C.classScore}),w=v.map(function(C){return _.config.classes[C.label]}),S=el(m.map(function(C){return C.rescale(i)}),g,this.config.iouThreshold,!0),E=S.map(function(C){return new m_(g[C],b[C],w[C],m[C],d)}),[2,E]}})})},t.prototype.getDefaultModelName=function(){return""},t.prototype.extractParamsFromWeigthMap=function(e){return JU(e,this.config)},t.prototype.extractParams=function(e){var r=this.config.filterSizes||t.DEFAULT_FILTER_SIZES,a=r?r.length:void 0;if(a!==7&&a!==8&&a!==9)throw new Error("TinyYolov2 - expected 7 | 8 | 9 convolutional filters, but found "+a+" filterSizes in config");return YU(e,this.config,this.boxEncodingSize,r)},t.prototype.extractBoxes=function(e,r,a){return Ce(this,void 0,void 0,function(){var i,u,l,c,f,d,v,m,g,b,w,S,E,_,R,C,A,D,O,F,N,B,H,U,J,ee,te,L,W,$=this;return Re(this,function(ne){switch(ne.label){case 0:return i=r.width,u=r.height,l=Math.max(i,u),c=l/i,f=l/u,d=e.shape[1],v=this.config.anchors.length,m=be(function(){var M=e.reshape([d,d,v,$.boxEncodingSize]),j=M.slice([0,0,0,0],[d,d,v,4]),ie=M.slice([0,0,0,4],[d,d,v,1]),oe=$.withClassScores?Ta(M.slice([0,0,0,5],[d,d,v,$.config.classes.length]),3):ge(0);return[j,ie,oe]}),g=m[0],b=m[1],w=m[2],S=[],[4,b.array()];case 1:return E=ne.sent(),[4,g.array()];case 2:_=ne.sent(),R=0,ne.label=3;case 3:if(!(R<d))return[3,12];C=0,ne.label=4;case 4:if(!(C<d))return[3,11];A=0,ne.label=5;case 5:return A<v?(D=wv(E[R][C][A][0]),!a||D>a?(O=(C+wv(_[R][C][A][0]))/d*c,F=(R+wv(_[R][C][A][1]))/d*f,N=Math.exp(_[R][C][A][2])*this.config.anchors[A].x/d*c,B=Math.exp(_[R][C][A][3])*this.config.anchors[A].y/d*f,H=O-N/2,U=F-B/2,J={row:R,col:C,anchor:A},this.withClassScores?[4,this.extractPredictedClass(w,J)]:[3,7]):[3,9]):[3,10];case 6:return W=ne.sent(),[3,8];case 7:W={classScore:1,label:0},ne.label=8;case 8:ee=W,te=ee.classScore,L=ee.label,S.push(gn({box:new dh(H,U,H+N,U+B),score:D,classScore:D*te,label:L},J)),ne.label=9;case 9:return A++,[3,5];case 10:return C++,[3,4];case 11:return R++,[3,3];case 12:return g.dispose(),b.dispose(),w.dispose(),[2,S]}})})},t.prototype.extractPredictedClass=function(e,r){return Ce(this,void 0,void 0,function(){var a,i,u,l;return Re(this,function(c){switch(c.label){case 0:return a=r.row,i=r.col,u=r.anchor,[4,e.array()];case 1:return l=c.sent(),[2,Array(this.config.classes.length).fill(0).map(function(f,d){return l[a][i][u][d]}).map(function(f,d){return{classScore:f,label:d}}).reduce(function(f,d){return f.classScore>d.classScore?f:d})]}})})},t.DEFAULT_FILTER_SIZES=[3,16,32,64,128,256,512,1024,1024],t}(Oa),e6=function(n){Be(t,n);function t(e){e===void 0&&(e=!0);var r=this,a=Object.assign({},{withSeparableConvs:e,iouThreshold:WU,classes:["face"]},e?{anchors:jU,meanRgb:qU}:{anchors:GU,withClassScores:!0});return r=n.call(this,a)||this,r}return Object.defineProperty(t.prototype,"withSeparableConvs",{get:function(){return this.config.withSeparableConvs},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"anchors",{get:function(){return this.config.anchors},enumerable:!0,configurable:!0}),t.prototype.locateFaces=function(e,r){return Ce(this,void 0,void 0,function(){var a;return Re(this,function(i){switch(i.label){case 0:return[4,this.detect(e,r)];case 1:return a=i.sent(),[2,a.map(function(u){return new Jn(u.score,u.relativeBox,{width:u.imageWidth,height:u.imageHeight})})]}})})},t.prototype.getDefaultModelName=function(){return this.withSeparableConvs?KU:$U},t.prototype.extractParamsFromWeigthMap=function(e){return n.prototype.extractParamsFromWeigthMap.call(this,e)},t}(j_),t6=function(n){Be(t,n);function t(){var e=n!==null&&n.apply(this,arguments)||this;return e._name="TinyFaceDetectorOptions",e}return t}(Fg),gl=function(){function n(){}return n.prototype.then=function(t){return Ce(this,void 0,void 0,function(){var e;return Re(this,function(r){switch(r.label){case 0:return e=t,[4,this.run()];case 1:return[2,e.apply(void 0,[r.sent()])]}})})},n.prototype.run=function(){return Ce(this,void 0,void 0,function(){return Re(this,function(t){throw new Error("ComposableTask - run is not implemented")})})},n}();function yh(n,t,e,r,a){return a===void 0&&(a=function(i){var u=i.alignedRect;return u}),Ce(this,void 0,void 0,function(){var i,u,l,c,f;return Re(this,function(d){switch(d.label){case 0:return i=n.map(function(v){return I_(v)?a(v):v.detection}),l=r,l?[3,5]:t instanceof wt?[4,Tg(t,i)]:[3,2];case 1:return c=d.sent(),[3,4];case 2:return[4,Ag(t,i)];case 3:c=d.sent(),d.label=4;case 4:l=c,d.label=5;case 5:return u=l,[4,e(u)];case 6:return f=d.sent(),u.forEach(function(v){return v instanceof wt&&v.dispose()}),[2,f]}})})}function Bg(n,t,e,r,a){return Ce(this,void 0,void 0,function(){var i=this;return Re(this,function(u){return[2,yh([n],t,function(l){return Ce(i,void 0,void 0,function(){return Re(this,function(c){return[2,e(l[0])]})})},r,a)]})})}function n6(n){return be(function(){return Qn(jt(n,3).reverse(),3)})}var Jc=2,Wf=12;function r6(n,t){var e=vh(n,t),r=Dg(n,t);function a(f,d){var v=Pt(n(f));return t.push({paramPath:d}),v}function i(f,d,v){v===void 0&&(v=!1);var m=e(f[0],f[1],3,d+"/conv1"),g=a(f[1],d+"/prelu1_alpha"),b=e(f[1],f[2],3,d+"/conv2"),w=a(f[2],d+"/prelu2_alpha"),S=e(f[2],f[3],v?2:3,d+"/conv3"),E=a(f[3],d+"/prelu3_alpha");return{conv1:m,prelu1_alpha:g,conv2:b,prelu2_alpha:w,conv3:S,prelu3_alpha:E}}function u(){var f=i([3,10,16,32],"pnet"),d=e(32,2,1,"pnet/conv4_1"),v=e(32,4,1,"pnet/conv4_2");return gn(gn({},f),{conv4_1:d,conv4_2:v})}function l(){var f=i([3,28,48,64],"rnet",!0),d=r(576,128,"rnet/fc1"),v=a(128,"rnet/prelu4_alpha"),m=r(128,2,"rnet/fc2_1"),g=r(128,4,"rnet/fc2_2");return gn(gn({},f),{fc1:d,prelu4_alpha:v,fc2_1:m,fc2_2:g})}function c(){var f=i([3,32,64,64],"onet"),d=e(64,128,2,"onet/conv4"),v=a(128,"onet/prelu4_alpha"),m=r(1152,256,"onet/fc1"),g=a(256,"onet/prelu5_alpha"),b=r(256,2,"onet/fc2_1"),w=r(256,4,"onet/fc2_2"),S=r(256,10,"onet/fc2_3");return gn(gn({},f),{conv4:d,prelu4_alpha:v,fc1:m,prelu5_alpha:g,fc2_1:b,fc2_2:w,fc2_3:S})}return{extractPNetParams:u,extractRNetParams:l,extractONetParams:c}}function a6(n){var t=Na(n),e=t.extractWeights,r=t.getRemainingWeights,a=[],i=r6(e,a),u=i.extractPNetParams,l=i.extractRNetParams,c=i.extractONetParams,f=u(),d=l(),v=c();if(r().length!==0)throw new Error("weights remaing after extract: "+r().length);return{params:{pnet:f,rnet:d,onet:v},paramMappings:a}}function i6(n,t){var e=Si(n,t);function r(d){var v=e(d+"/weights",4,d+"/filters"),m=e(d+"/bias",1);return{filters:v,bias:m}}function a(d){var v=e(d+"/weights",2),m=e(d+"/bias",1);return{weights:v,bias:m}}function i(d){return e(d,1)}function u(d){var v=r(d+"/conv1"),m=i(d+"/prelu1_alpha"),g=r(d+"/conv2"),b=i(d+"/prelu2_alpha"),w=r(d+"/conv3"),S=i(d+"/prelu3_alpha");return{conv1:v,prelu1_alpha:m,conv2:g,prelu2_alpha:b,conv3:w,prelu3_alpha:S}}function l(){var d=u("pnet"),v=r("pnet/conv4_1"),m=r("pnet/conv4_2");return gn(gn({},d),{conv4_1:v,conv4_2:m})}function c(){var d=u("rnet"),v=a("rnet/fc1"),m=i("rnet/prelu4_alpha"),g=a("rnet/fc2_1"),b=a("rnet/fc2_2");return gn(gn({},d),{fc1:v,prelu4_alpha:m,fc2_1:g,fc2_2:b})}function f(){var d=u("onet"),v=r("onet/conv4"),m=i("onet/prelu4_alpha"),g=a("onet/fc1"),b=i("onet/prelu5_alpha"),w=a("onet/fc2_1"),S=a("onet/fc2_2"),E=a("onet/fc2_3");return gn(gn({},d),{conv4:v,prelu4_alpha:m,fc1:g,prelu5_alpha:b,fc2_1:w,fc2_2:S,fc2_3:E})}return{extractPNetParams:l,extractRNetParams:c,extractONetParams:f}}function o6(n){var t=[],e=i6(n,t),r=e.extractPNetParams,a=e.extractRNetParams,i=e.extractONetParams,u=r(),l=a(),c=i();return ka(n,t),{params:{pnet:u,rnet:l,onet:c},paramMappings:t}}function bm(n,t){var e=t[0],r=t[1];return{height:Math.floor(e*n),width:Math.floor(r*n)}}function s6(n,t,e){for(var r=e[0],a=e[1],i=Wf/n,u=[],l=Math.min(r,a)*i,c=0;l>=12;)u.push(i*Math.pow(t,c)),l=l*t,c+=1;return u}var Pg=function(n){Be(t,n);function t(e,r,a,i){return n.call(this,{left:e,top:r,right:a,bottom:i},!0)||this}return t}(Zr);function q_(n){return be(function(){return wn($t(n,ge(127.5)),ge(.0078125))})}function ps(n,t){return be(function(){return qe(St(n),wn(t,Pf(St(Pf(n)))))})}function Lg(n,t,e){return e===void 0&&(e=!1),be(function(){var r=Ar(n,t.conv1,"valid");return r=ps(r,t.prelu1_alpha),r=Jt(r,e?[2,2]:[3,3],[2,2],"same"),r=Ar(r,t.conv2,"valid"),r=ps(r,t.prelu2_alpha),r=e?r:Jt(r,[3,3],[2,2],"valid"),r=Ar(r,t.conv3,"valid"),r=ps(r,t.prelu3_alpha),r})}function u6(n,t){return be(function(){var e=Lg(n,t,!0),r=Ar(e,t.conv4_1,"valid"),a=hr(lh(r,3),3),i=Ta($t(r,a),3),u=Ar(e,t.conv4_2,"valid");return{prob:i,regions:u}})}function l6(n,t){return be(function(){var e=bm(t,n.shape.slice(1)),r=e.height,a=e.width,i=dg.resizeBilinear(n,[r,a]),u=q_(i);return yi(u,[0,2,1,3])})}function c6(n,t,e,r){for(var a=[],i=n.arraySync(),u=0;u<n.shape[0];u++)for(var l=0;l<n.shape[1];l++)i[u][l]>=r&&a.push(new et(l,u));var c=a.map(function(f){var d=new dh(Math.round((f.y*Jc+1)/e),Math.round((f.x*Jc+1)/e),Math.round((f.y*Jc+Wf)/e),Math.round((f.x*Jc+Wf)/e)),v=i[f.y][f.x],m=t.arraySync(),g=new Pg(m[f.y][f.x][0],m[f.y][f.x][1],m[f.y][f.x][2],m[f.y][f.x][3]);return{cell:d,score:v,region:g}});return c}function f6(n,t,e,r,a){a.stage1=[];var i=t.map(function(m){return be(function(){var g={scale:m},b=l6(n,m),w=Date.now(),S=u6(b,r),E=S.prob,_=S.regions;g.pnet=Date.now()-w;var R=jt(jt(E,3)[1])[0],C=jt(_)[0];return{scoresTensor:R,regionsTensor:C,scale:m,statsForScale:g}})}),u=i.map(function(m){var g=m.scoresTensor,b=m.regionsTensor,w=m.scale,S=m.statsForScale,E=c6(g,b,w,e);if(g.dispose(),b.dispose(),!E.length)return a.stage1.push(S),[];var _=Date.now(),R=el(E.map(function(C){return C.cell}),E.map(function(C){return C.score}),.5);return S.nms=Date.now()-_,S.numBoxes=R.length,a.stage1.push(S),R.map(function(C){return E[C]})}),l=u.reduce(function(m,g){return m.concat(g)},[]),c=[],f=[];if(l.length>0){var d=Date.now(),v=el(l.map(function(m){return m.cell}),l.map(function(m){return m.score}),.7);a.stage1_nms=Date.now()-d,f=v.map(function(m){return l[m].score}),c=v.map(function(m){return l[m]}).map(function(m){var g=m.cell,b=m.region;return new dh(g.left+b.left*g.width,g.top+b.top*g.height,g.right+b.right*g.width,g.bottom+b.bottom*g.height).toSquare().round()})}return{boxes:c,scores:f}}function $_(n,t,e){var r=e.width,a=e.height;return Ce(this,void 0,void 0,function(){var i,u,l,c=this;return Re(this,function(f){switch(f.label){case 0:return i=Ca(n),[4,Promise.all(t.map(function(d){return Ce(c,void 0,void 0,function(){var v,m,g,b,w,S,E,_;return Re(this,function(R){return v=d.padAtBorders(n.height,n.width),m=v.y,g=v.ey,b=v.x,w=v.ex,S=b-1,E=m-1,_=i.getImageData(S,E,w-S,g-E),[2,Sn.isNodejs()?Rg(_):createImageBitmap(_)]})})}))];case 1:return u=f.sent(),l=[],u.forEach(function(d){var v=ph({width:r,height:a}),m=Ca(v);m.drawImage(d,0,0,r,a);for(var g=m.getImageData(0,0,r,a).data,b=[],w=0;w<g.length;w+=4)b.push(g[w+2]),b.push(g[w+1]),b.push(g[w]);l.push(b)}),[2,l.map(function(d){var v=be(function(){var m=yi(Mn(d,[1,r,a,3]),[0,2,1,3]).toFloat();return q_(m)});return v})]}})})}function h6(n,t){return be(function(){var e=Lg(n,t),r=Cr(e,[e.shape[0],t.fc1.weights.shape[0]]),a=jr(r,t.fc1),i=ps(a,t.prelu4_alpha),u=jr(i,t.fc2_1),l=hr(lh(u,1),1),c=Ta($t(u,l),1),f=jr(i,t.fc2_2),d=jt(c,1)[1];return{scores:d,regions:f}})}function d6(n,t,e,r,a){return Ce(this,void 0,void 0,function(){var i,u,l,c,f,d,v,m,g,b,w,S,E,_;return Re(this,function(R){switch(R.label){case 0:return i=Date.now(),[4,$_(n,t,{width:24,height:24})];case 1:return u=R.sent(),a.stage2_extractImagePatches=Date.now()-i,i=Date.now(),l=u.map(function(C){var A=h6(C,r);return C.dispose(),A}),a.stage2_rnet=Date.now()-i,c=l.length>1?Gt(l.map(function(C){return C.scores})):l[0].scores,v=(d=Array).from,[4,c.data()];case 2:return f=v.apply(d,[R.sent()]),c.dispose(),m=f.map(function(C,A){return{score:C,idx:A}}).filter(function(C){return C.score>e}).map(function(C){var A=C.idx;return A}),g=m.map(function(C){return t[C]}),b=m.map(function(C){return f[C]}),w=[],S=[],g.length>0&&(i=Date.now(),E=el(g,b,.7),a.stage2_nms=Date.now()-i,_=E.map(function(C){var A=l[m[C]].regions.arraySync();return new Pg(A[0][0],A[0][1],A[0][2],A[0][3])}),S=E.map(function(C){return b[C]}),w=E.map(function(C,A){return g[C].calibrate(_[A])})),l.forEach(function(C){C.regions.dispose(),C.scores.dispose()}),[2,{boxes:w,scores:S}]}})})}function p6(n,t){return be(function(){var e=Lg(n,t);e=Jt(e,[2,2],[2,2],"same"),e=Ar(e,t.conv4,"valid"),e=ps(e,t.prelu4_alpha);var r=Cr(e,[e.shape[0],t.fc1.weights.shape[0]]),a=jr(r,t.fc1),i=ps(a,t.prelu5_alpha),u=jr(i,t.fc2_1),l=hr(lh(u,1),1),c=Ta($t(u,l),1),f=jr(i,t.fc2_2),d=jr(i,t.fc2_3),v=jt(c,1)[1];return{scores:v,regions:f,points:d}})}function v6(n,t,e,r,a){return Ce(this,void 0,void 0,function(){var i,u,l,c,f,d,v,m,g,b,w,S,E,_,R;return Re(this,function(C){switch(C.label){case 0:return i=Date.now(),[4,$_(n,t,{width:48,height:48})];case 1:return u=C.sent(),a.stage3_extractImagePatches=Date.now()-i,i=Date.now(),l=u.map(function(A){var D=p6(A,r);return A.dispose(),D}),a.stage3_onet=Date.now()-i,c=l.length>1?Gt(l.map(function(A){return A.scores})):l[0].scores,v=(d=Array).from,[4,c.data()];case 2:return f=v.apply(d,[C.sent()]),c.dispose(),m=f.map(function(A,D){return{score:A,idx:D}}).filter(function(A){return A.score>e}).map(function(A){var D=A.idx;return D}),g=m.map(function(A){var D=l[A].regions.arraySync();return new Pg(D[0][0],D[0][1],D[0][2],D[0][3])}),b=m.map(function(A,D){return t[A].calibrate(g[D])}),w=m.map(function(A){return f[A]}),S=[],E=[],_=[],b.length>0&&(i=Date.now(),R=el(b,w,.7,!1),a.stage3_nms=Date.now()-i,S=R.map(function(A){return b[A]}),E=R.map(function(A){return w[A]}),_=R.map(function(A,D){return Array(5).fill(0).map(function(O,F){var N=l[A].points.arraySync();return new et(N[0][F]*(S[D].width+1)+S[D].left,N[0][F+5]*(S[D].height+1)+S[D].top)})})),l.forEach(function(A){A.regions.dispose(),A.scores.dispose(),A.points.dispose()}),[2,{boxes:S,scores:E,points:_}]}})})}var m6=function(n){Be(t,n);function t(){return n.call(this,"Mtcnn")||this}return t.prototype.load=function(e){return Ce(this,void 0,void 0,function(){return Re(this,function(r){return console.warn("mtcnn is deprecated and will be removed soon"),[2,n.prototype.load.call(this,e)]})})},t.prototype.loadFromDisk=function(e){return Ce(this,void 0,void 0,function(){return Re(this,function(r){return console.warn("mtcnn is deprecated and will be removed soon"),[2,n.prototype.loadFromDisk.call(this,e)]})})},t.prototype.forwardInput=function(e,r){return r===void 0&&(r={}),Ce(this,void 0,void 0,function(){var a,i,u,l,c,f,d,v,m,g,b,w,S,E,_,R,C,A,D,O,F;return Re(this,function(N){switch(N.label){case 0:if(a=this.params,!a)throw new Error("Mtcnn - load model before inference");if(i=e.canvases[0],!i)throw new Error("Mtcnn - inputCanvas is not defined, note that passing tensors into Mtcnn.forwardInput is not supported yet.");return u={},l=Date.now(),c=be(function(){return n6(hr(bg.fromPixels(i)).toFloat())}),f=function(B){return c.dispose(),u.total=Date.now()-l,B},d=c.shape.slice(1),v=d[0],m=d[1],g=new W_(r),b=g.minFaceSize,w=g.scaleFactor,S=g.maxNumScales,E=g.scoreThresholds,_=g.scaleSteps,R=(_||s6(b,w,[v,m])).filter(function(B){var H=bm(B,[v,m]);return Math.min(H.width,H.height)>Wf}).slice(0,S),u.scales=R,u.pyramid=R.map(function(B){return bm(B,[v,m])}),C=Date.now(),[4,f6(c,R,E[0],a.pnet,u)];case 1:return A=N.sent(),u.total_stage1=Date.now()-C,A.boxes.length?(u.stage2_numInputBoxes=A.boxes.length,C=Date.now(),[4,d6(i,A.boxes,E[1],a.rnet,u)]):[2,f({results:[],stats:u})];case 2:return D=N.sent(),u.total_stage2=Date.now()-C,D.boxes.length?(u.stage3_numInputBoxes=D.boxes.length,C=Date.now(),[4,v6(i,D.boxes,E[2],a.onet,u)]):[2,f({results:[],stats:u})];case 3:return O=N.sent(),u.total_stage3=Date.now()-C,F=O.boxes.map(function(B,H){return mh(rl({},new Jn(O.scores[H],new Sg(B.left/m,B.top/v,B.width/m,B.height/v),{height:v,width:m})),new jz(O.points[H].map(function(U){return U.sub(new et(B.left,B.top)).div(new et(B.width,B.height))}),{width:B.width,height:B.height}))}),[2,f({results:F,stats:u})]}})})},t.prototype.forward=function(e,r){return r===void 0&&(r={}),Ce(this,void 0,void 0,function(){var a;return Re(this,function(i){switch(i.label){case 0:return a=this.forwardInput,[4,rn(e)];case 1:return[4,a.apply(this,[i.sent(),r])];case 2:return[2,i.sent().results]}})})},t.prototype.forwardWithStats=function(e,r){return r===void 0&&(r={}),Ce(this,void 0,void 0,function(){var a;return Re(this,function(i){switch(i.label){case 0:return a=this.forwardInput,[4,rn(e)];case 1:return[2,a.apply(this,[i.sent(),r])]}})})},t.prototype.getDefaultModelName=function(){return"mtcnn_model"},t.prototype.extractParamsFromWeigthMap=function(e){return o6(e)},t.prototype.extractParams=function(e){return a6(e)},t}(Oa),g6=.4,y6=[new et(1.603231,2.094468),new et(6.041143,7.080126),new et(2.882459,3.518061),new et(4.266906,5.178857),new et(9.041765,10.66308)],b6=[117.001,114.697,97.404],x6=function(n){Be(t,n);function t(){var e=this,r={withSeparableConvs:!0,iouThreshold:g6,classes:["face"],anchors:y6,meanRgb:b6,isFirstLayerConv2d:!0,filterSizes:[3,16,32,64,128,256,512]};return e=n.call(this,r)||this,e}return Object.defineProperty(t.prototype,"anchors",{get:function(){return this.config.anchors},enumerable:!0,configurable:!0}),t.prototype.locateFaces=function(e,r){return Ce(this,void 0,void 0,function(){var a;return Re(this,function(i){switch(i.label){case 0:return[4,this.detect(e,r)];case 1:return a=i.sent(),[2,a.map(function(u){return new Jn(u.score,u.relativeBox,{width:u.imageWidth,height:u.imageHeight})})]}})})},t.prototype.getDefaultModelName=function(){return"tiny_face_detector_model"},t.prototype.extractParamsFromWeigthMap=function(e){return n.prototype.extractParamsFromWeigthMap.call(this,e)},t}(j_),vr={ssdMobilenetv1:new G_,tinyFaceDetector:new x6,tinyYolov2:new e6,mtcnn:new m6,faceLandmark68Net:new P_,faceLandmark68TinyNet:new wU,faceRecognitionNet:new TU,faceExpressionNet:new sU,ageGenderNet:new gU},K_=function(n){Be(t,n);function t(e,r,a){var i=n.call(this)||this;return i.parentTask=e,i.input=r,i.extractedFaces=a,i}return t}(gl),zg=function(n){Be(t,n);function t(){return n!==null&&n.apply(this,arguments)||this}return t.prototype.run=function(){return Ce(this,void 0,void 0,function(){var e,r,a=this;return Re(this,function(i){switch(i.label){case 0:return[4,this.parentTask];case 1:return e=i.sent(),[4,yh(e,this.input,function(u){return Ce(a,void 0,void 0,function(){return Re(this,function(l){switch(l.label){case 0:return[4,Promise.all(u.map(function(c){return vr.faceExpressionNet.predictExpressions(c)}))];case 1:return[2,l.sent()]}})})},this.extractedFaces)];case 2:return r=i.sent(),[2,e.map(function(u,l){return M_(u,r[l])})]}})})},t.prototype.withAgeAndGender=function(){return new Wg(this,this.input)},t}(K_),Ug=function(n){Be(t,n);function t(){return n!==null&&n.apply(this,arguments)||this}return t.prototype.run=function(){return Ce(this,void 0,void 0,function(){var e,r;return Re(this,function(a){switch(a.label){case 0:return[4,this.parentTask];case 1:return e=a.sent(),e?[4,Bg(e,this.input,function(i){return vr.faceExpressionNet.predictExpressions(i)},this.extractedFaces)]:[2];case 2:return r=a.sent(),[2,M_(e,r)]}})})},t.prototype.withAgeAndGender=function(){return new Gg(this,this.input)},t}(K_),Hg=function(n){Be(t,n);function t(){return n!==null&&n.apply(this,arguments)||this}return t.prototype.withAgeAndGender=function(){return new jg(this,this.input)},t.prototype.withFaceDescriptors=function(){return new $g(this,this.input)},t}(zg),Vg=function(n){Be(t,n);function t(){return n!==null&&n.apply(this,arguments)||this}return t.prototype.withAgeAndGender=function(){return new qg(this,this.input)},t.prototype.withFaceDescriptor=function(){return new Kg(this,this.input)},t}(Ug),X_=function(n){Be(t,n);function t(e,r,a){var i=n.call(this)||this;return i.parentTask=e,i.input=r,i.extractedFaces=a,i}return t}(gl),Wg=function(n){Be(t,n);function t(){return n!==null&&n.apply(this,arguments)||this}return t.prototype.run=function(){return Ce(this,void 0,void 0,function(){var e,r,a=this;return Re(this,function(i){switch(i.label){case 0:return[4,this.parentTask];case 1:return e=i.sent(),[4,yh(e,this.input,function(u){return Ce(a,void 0,void 0,function(){return Re(this,function(l){switch(l.label){case 0:return[4,Promise.all(u.map(function(c){return vr.ageGenderNet.predictAgeAndGender(c)}))];case 1:return[2,l.sent()]}})})},this.extractedFaces)];case 2:return r=i.sent(),[2,e.map(function(u,l){var c=r[l],f=c.age,d=c.gender,v=c.genderProbability;return H_(V_(u,d,v),f)})]}})})},t.prototype.withFaceExpressions=function(){return new zg(this,this.input)},t}(X_),Gg=function(n){Be(t,n);function t(){return n!==null&&n.apply(this,arguments)||this}return t.prototype.run=function(){return Ce(this,void 0,void 0,function(){var e,r,a,i,u;return Re(this,function(l){switch(l.label){case 0:return[4,this.parentTask];case 1:return e=l.sent(),e?[4,Bg(e,this.input,function(c){return vr.ageGenderNet.predictAgeAndGender(c)},this.extractedFaces)]:[2];case 2:return r=l.sent(),a=r.age,i=r.gender,u=r.genderProbability,[2,H_(V_(e,i,u),a)]}})})},t.prototype.withFaceExpressions=function(){return new Ug(this,this.input)},t}(X_),jg=function(n){Be(t,n);function t(){return n!==null&&n.apply(this,arguments)||this}return t.prototype.withFaceExpressions=function(){return new Hg(this,this.input)},t.prototype.withFaceDescriptors=function(){return new $g(this,this.input)},t}(Wg),qg=function(n){Be(t,n);function t(){return n!==null&&n.apply(this,arguments)||this}return t.prototype.withFaceExpressions=function(){return new Vg(this,this.input)},t.prototype.withFaceDescriptor=function(){return new Kg(this,this.input)},t}(Gg),Z_=function(n){Be(t,n);function t(e,r){var a=n.call(this)||this;return a.parentTask=e,a.input=r,a}return t}(gl),$g=function(n){Be(t,n);function t(){return n!==null&&n.apply(this,arguments)||this}return t.prototype.run=function(){return Ce(this,void 0,void 0,function(){var e,r;return Re(this,function(a){switch(a.label){case 0:return[4,this.parentTask];case 1:return e=a.sent(),[4,yh(e,this.input,function(i){return Promise.all(i.map(function(u){return vr.faceRecognitionNet.computeFaceDescriptor(u)}))},null,function(i){return i.landmarks.align(null,{useDlibAlignment:!0})})];case 2:return r=a.sent(),[2,r.map(function(i,u){return U_(e[u],i)})]}})})},t.prototype.withFaceExpressions=function(){return new Hg(this,this.input)},t.prototype.withAgeAndGender=function(){return new jg(this,this.input)},t}(Z_),Kg=function(n){Be(t,n);function t(){return n!==null&&n.apply(this,arguments)||this}return t.prototype.run=function(){return Ce(this,void 0,void 0,function(){var e,r;return Re(this,function(a){switch(a.label){case 0:return[4,this.parentTask];case 1:return e=a.sent(),e?[4,Bg(e,this.input,function(i){return vr.faceRecognitionNet.computeFaceDescriptor(i)},null,function(i){return i.landmarks.align(null,{useDlibAlignment:!0})})]:[2];case 2:return r=a.sent(),[2,U_(e,r)]}})})},t.prototype.withFaceExpressions=function(){return new Vg(this,this.input)},t.prototype.withAgeAndGender=function(){return new qg(this,this.input)},t}(Z_),Y_=function(n){Be(t,n);function t(e,r,a){var i=n.call(this)||this;return i.parentTask=e,i.input=r,i.useTinyLandmarkNet=a,i}return Object.defineProperty(t.prototype,"landmarkNet",{get:function(){return this.useTinyLandmarkNet?vr.faceLandmark68TinyNet:vr.faceLandmark68Net},enumerable:!0,configurable:!0}),t}(gl),w6=function(n){Be(t,n);function t(){return n!==null&&n.apply(this,arguments)||this}return t.prototype.run=function(){return Ce(this,void 0,void 0,function(){var e,r,a,i,u,l=this;return Re(this,function(c){switch(c.label){case 0:return[4,this.parentTask];case 1:return e=c.sent(),r=e.map(function(f){return f.detection}),this.input instanceof wt?[4,Tg(this.input,r)]:[3,3];case 2:return i=c.sent(),[3,5];case 3:return[4,Ag(this.input,r)];case 4:i=c.sent(),c.label=5;case 5:return a=i,[4,Promise.all(a.map(function(f){return l.landmarkNet.detectLandmarks(f)}))];case 6:return u=c.sent(),a.forEach(function(f){return f instanceof wt&&f.dispose()}),[2,e.map(function(f,d){return mh(f,u[d])})]}})})},t.prototype.withFaceExpressions=function(){return new Hg(this,this.input)},t.prototype.withAgeAndGender=function(){return new jg(this,this.input)},t.prototype.withFaceDescriptors=function(){return new $g(this,this.input)},t}(Y_),S6=function(n){Be(t,n);function t(){return n!==null&&n.apply(this,arguments)||this}return t.prototype.run=function(){return Ce(this,void 0,void 0,function(){var e,r,a,i,u;return Re(this,function(l){switch(l.label){case 0:return[4,this.parentTask];case 1:return e=l.sent(),e?(r=e.detection,this.input instanceof wt?[4,Tg(this.input,[r])]:[3,3]):[2];case 2:return i=l.sent(),[3,5];case 3:return[4,Ag(this.input,[r])];case 4:i=l.sent(),l.label=5;case 5:return a=i,[4,this.landmarkNet.detectLandmarks(a[0])];case 6:return u=l.sent(),a.forEach(function(c){return c instanceof wt&&c.dispose()}),[2,mh(e,u)]}})})},t.prototype.withFaceExpressions=function(){return new Vg(this,this.input)},t.prototype.withAgeAndGender=function(){return new qg(this,this.input)},t.prototype.withFaceDescriptor=function(){return new Kg(this,this.input)},t}(Y_),Q_=function(n){Be(t,n);function t(e,r){r===void 0&&(r=new gh);var a=n.call(this)||this;return a.input=e,a.options=r,a}return t}(gl),J_=function(n){Be(t,n);function t(){return n!==null&&n.apply(this,arguments)||this}return t.prototype.run=function(){return Ce(this,void 0,void 0,function(){var e,r,a,i;return Re(this,function(u){switch(u.label){case 0:return e=this,r=e.input,a=e.options,a instanceof W_?[4,vr.mtcnn.forward(r,a)]:[3,2];case 1:return[2,u.sent().map(function(l){return l.detection})];case 2:if(i=a instanceof t6?function(l){return vr.tinyFaceDetector.locateFaces(l,a)}:a instanceof gh?function(l){return vr.ssdMobilenetv1.locateFaces(l,a)}:a instanceof Fg?function(l){return vr.tinyYolov2.locateFaces(l,a)}:null,!i)throw new Error("detectFaces - expected options to be instance of TinyFaceDetectorOptions | SsdMobilenetv1Options | MtcnnOptions | TinyYolov2Options");return[2,i(r)]}})})},t.prototype.runAndExtendWithFaceDetections=function(){var e=this;return new Promise(function(r){return Ce(e,void 0,void 0,function(){var a;return Re(this,function(i){switch(i.label){case 0:return[4,this.run()];case 1:return a=i.sent(),[2,r(a.map(function(u){return rl({},u)}))]}})})})},t.prototype.withFaceLandmarks=function(e){return e===void 0&&(e=!1),new w6(this.runAndExtendWithFaceDetections(),this.input,e)},t.prototype.withFaceExpressions=function(){return new zg(this.runAndExtendWithFaceDetections(),this.input)},t.prototype.withAgeAndGender=function(){return new Wg(this.runAndExtendWithFaceDetections(),this.input)},t}(Q_);(function(n){Be(t,n);function t(){return n!==null&&n.apply(this,arguments)||this}return t.prototype.run=function(){return Ce(this,void 0,void 0,function(){var e,r;return Re(this,function(a){switch(a.label){case 0:return[4,new J_(this.input,this.options)];case 1:return e=a.sent(),r=e[0],e.forEach(function(i){i.score>r.score&&(r=i)}),[2,r]}})})},t.prototype.runAndExtendWithFaceDetection=function(){var e=this;return new Promise(function(r){return Ce(e,void 0,void 0,function(){var a;return Re(this,function(i){switch(i.label){case 0:return[4,this.run()];case 1:return a=i.sent(),[2,r(a?rl({},a):void 0)]}})})})},t.prototype.withFaceLandmarks=function(e){return e===void 0&&(e=!1),new S6(this.runAndExtendWithFaceDetection(),this.input,e)},t.prototype.withFaceExpressions=function(){return new Ug(this.runAndExtendWithFaceDetection(),this.input)},t.prototype.withAgeAndGender=function(){return new Gg(this.runAndExtendWithFaceDetection(),this.input)},t})(Q_);function J6(n,t){return t===void 0&&(t=new gh),new J_(n,t)}function E6(n,t){if(n.length!==t.length)throw new Error("euclideanDistance: arr1.length !== arr2.length");var e=Array.from(n),r=Array.from(t);return Math.sqrt(e.map(function(a,i){return a-r[i]}).reduce(function(a,i){return a+Math.pow(i,2)},0))}(function(){function n(t,e){e===void 0&&(e=.6),this._distanceThreshold=e;var r=Array.isArray(t)?t:[t];if(!r.length)throw new Error("FaceRecognizer.constructor - expected atleast one input");var a=1,i=function(){return"person "+a++};this._labeledDescriptors=r.map(function(u){if(u instanceof Xc)return u;if(u instanceof Float32Array)return new Xc(i(),[u]);if(u.descriptor&&u.descriptor instanceof Float32Array)return new Xc(i(),[u.descriptor]);throw new Error("FaceRecognizer.constructor - expected inputs to be of type LabeledFaceDescriptors | WithFaceDescriptor<any> | Float32Array | Array<LabeledFaceDescriptors | WithFaceDescriptor<any> | Float32Array>")})}return Object.defineProperty(n.prototype,"labeledDescriptors",{get:function(){return this._labeledDescriptors},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"distanceThreshold",{get:function(){return this._distanceThreshold},enumerable:!0,configurable:!0}),n.prototype.computeMeanDistance=function(t,e){return e.map(function(r){return E6(r,t)}).reduce(function(r,a){return r+a},0)/(e.length||1)},n.prototype.matchDescriptor=function(t){var e=this;return this.labeledDescriptors.map(function(r){var a=r.descriptors,i=r.label;return new a2(i,e.computeMeanDistance(t,a))}).reduce(function(r,a){return r.distance<a.distance?r:a})},n.prototype.findBestMatch=function(t){var e=this.matchDescriptor(t);return e.distance<this.distanceThreshold?e:new a2("unknown",e.distance)},n.prototype.toJSON=function(){return{distanceThreshold:this.distanceThreshold,labeledDescriptors:this.labeledDescriptors.map(function(t){return t.toJSON()})}},n.fromJSON=function(t){var e=t.labeledDescriptors.map(function(r){return Xc.fromJSON(r)});return new n(e,t.distanceThreshold)},n})();function _6(n,t){var e=new Xi(t.width,t.height),r=e.width,a=e.height;if(r<=0||a<=0)throw new Error("resizeResults - invalid dimensions: "+JSON.stringify({width:r,height:a}));if(Array.isArray(n))return n.map(function(l){return _6(l,{width:r,height:a})});if(I_(n)){var i=n.detection.forSize(r,a),u=n.unshiftedLandmarks.forSize(i.box.width,i.box.height);return mh(rl(n,i),u)}return nl(n)?rl(n,n.detection.forSize(r,a)):n instanceof tl||n instanceof Jn?n.forSize(r,a):n}var Fu={},l2;function C6(){if(l2)return Fu;l2=1,Object.defineProperty(Fu,"__esModule",{value:!0}),Fu.styleq=void 0;var n=new WeakMap,t="$$css";function e(a){var i,u,l;return a!=null&&(i=a.disableCache===!0,u=a.disableMix===!0,l=a.transform),function(){for(var f=[],d="",v=null,m="",g=i?null:n,b=new Array(arguments.length),w=0;w<arguments.length;w++)b[w]=arguments[w];for(;b.length>0;){var S=b.pop();if(!(S==null||S===!1)){if(Array.isArray(S)){for(var E=0;E<S.length;E++)b.push(S[E]);continue}var _=l!=null?l(S):S;if(_.$$css!=null){var R="";if(g!=null&&g.has(_)){var C=g.get(_);C!=null&&(R=C[0],m=C[2],f.push.apply(f,C[1]),g=C[3])}else{var A=[];for(var D in _){var O=_[D];if(D===t){var F=_[D];F!==!0&&(m=m?F+"; "+m:F);continue}typeof O=="string"||O===null?f.includes(D)||(f.push(D),g!=null&&A.push(D),typeof O=="string"&&(R+=R?" "+O:O)):console.error("styleq: ".concat(D," typeof ").concat(String(O),' is not "string" or "null".'))}if(g!=null){var N=new WeakMap;g.set(_,[R,A,m,N]),g=N}}R&&(d=d?R+" "+d:R)}else if(u)v==null&&(v={}),v=Object.assign({},_,v);else{var B=null;for(var H in _){var U=_[H];U!==void 0&&(f.includes(H)||(U!=null&&(v==null&&(v={}),B==null&&(B={}),B[H]=U),f.push(H),g=null))}B!=null&&(v=Object.assign(B,v))}}}var J=[d,v,m];return J}}var r=Fu.styleq=e();return r.factory=e,Fu}var R6=C6();function e5(...n){const[t,e,r]=R6.styleq(n),a={};return t!=null&&t!==""&&(a.className=t),e!=null&&Object.keys(e).length>0&&(a.style=e),r!=null&&r!==""&&(a["data-style-src"]=r),a}export{xn as A,e5 as B,I6 as C,U6 as D,M6 as E,hD as F,B6 as G,W6 as H,q6 as I,T6 as J,L6 as Q,bS as R,t6 as T,G6 as a,j6 as b,$6 as c,ST as d,Ck as e,k6 as f,F6 as g,V6 as h,Cn as i,vA as j,H6 as k,Am as l,N6 as m,D6 as n,O6 as o,K6 as p,P6 as q,Z as r,X6 as s,vr as t,j2 as u,Y6 as v,J6 as w,_6 as x,Z6 as y,Q6 as z};
