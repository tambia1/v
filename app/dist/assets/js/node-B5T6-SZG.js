import{g as b2}from"./index-CvIG0b0B.js";var Gp={exports:{}},zu={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var q1;function hA(){if(q1)return zu;q1=1;var n=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function e(r,a,i){var u=null;if(i!==void 0&&(u=""+i),a.key!==void 0&&(u=""+a.key),"key"in a){i={};for(var l in a)l!=="key"&&(i[l]=a[l])}else i=a;return a=i.ref,{$$typeof:n,type:r,key:u,ref:a!==void 0?a:null,props:i}}return zu.Fragment=t,zu.jsx=e,zu.jsxs=e,zu}var K1;function dA(){return K1||(K1=1,Gp.exports=hA()),Gp.exports}var pA=dA(),qp={exports:{}},Uu={},Kp={exports:{}},Xp={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var X1;function vA(){return X1||(X1=1,function(n){function t(P,j){var K=P.length;P.push(j);e:for(;0<K;){var ne=K-1>>>1,M=P[ne];if(0<a(M,j))P[ne]=j,P[K]=M,K=ne;else break e}}function e(P){return P.length===0?null:P[0]}function r(P){if(P.length===0)return null;var j=P[0],K=P.pop();if(K!==j){P[0]=K;e:for(var ne=0,M=P.length,G=M>>>1;ne<G;){var ie=2*(ne+1)-1,oe=P[ie],de=ie+1,me=P[de];if(0>a(oe,K))de<M&&0>a(me,oe)?(P[ne]=me,P[de]=K,ne=de):(P[ne]=oe,P[ie]=K,ne=ie);else if(de<M&&0>a(me,K))P[ne]=me,P[de]=K,ne=de;else break e}}return j}function a(P,j){var K=P.sortIndex-j.sortIndex;return K!==0?K:P.id-j.id}if(n.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var i=performance;n.unstable_now=function(){return i.now()}}else{var u=Date,l=u.now();n.unstable_now=function(){return u.now()-l}}var c=[],f=[],d=1,v=null,m=3,g=!1,b=!1,w=!1,S=!1,_=typeof setTimeout=="function"?setTimeout:null,E=typeof clearTimeout=="function"?clearTimeout:null,R=typeof setImmediate<"u"?setImmediate:null;function C(P){for(var j=e(f);j!==null;){if(j.callback===null)r(f);else if(j.startTime<=P)r(f),j.sortIndex=j.expirationTime,t(c,j);else break;j=e(f)}}function A(P){if(w=!1,C(P),!b)if(e(c)!==null)b=!0,D||(D=!0,U());else{var j=e(f);j!==null&&te(A,j.startTime-P)}}var D=!1,k=-1,I=5,N=-1;function B(){return S?!0:!(n.unstable_now()-N<I)}function V(){if(S=!1,D){var P=n.unstable_now();N=P;var j=!0;try{e:{b=!1,w&&(w=!1,E(k),k=-1),g=!0;var K=m;try{t:{for(C(P),v=e(c);v!==null&&!(v.expirationTime>P&&B());){var ne=v.callback;if(typeof ne=="function"){v.callback=null,m=v.priorityLevel;var M=ne(v.expirationTime<=P);if(P=n.unstable_now(),typeof M=="function"){v.callback=M,C(P),j=!0;break t}v===e(c)&&r(c),C(P)}else r(c);v=e(c)}if(v!==null)j=!0;else{var G=e(f);G!==null&&te(A,G.startTime-P),j=!1}}break e}finally{v=null,m=K,g=!1}j=void 0}}finally{j?U():D=!1}}}var U;if(typeof R=="function")U=function(){R(V)};else if(typeof MessageChannel<"u"){var J=new MessageChannel,ee=J.port2;J.port1.onmessage=V,U=function(){ee.postMessage(null)}}else U=function(){_(V,0)};function te(P,j){k=_(function(){P(n.unstable_now())},j)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(P){P.callback=null},n.unstable_forceFrameRate=function(P){0>P||125<P?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):I=0<P?Math.floor(1e3/P):5},n.unstable_getCurrentPriorityLevel=function(){return m},n.unstable_next=function(P){switch(m){case 1:case 2:case 3:var j=3;break;default:j=m}var K=m;m=j;try{return P()}finally{m=K}},n.unstable_requestPaint=function(){S=!0},n.unstable_runWithPriority=function(P,j){switch(P){case 1:case 2:case 3:case 4:case 5:break;default:P=3}var K=m;m=P;try{return j()}finally{m=K}},n.unstable_scheduleCallback=function(P,j,K){var ne=n.unstable_now();switch(typeof K=="object"&&K!==null?(K=K.delay,K=typeof K=="number"&&0<K?ne+K:ne):K=ne,P){case 1:var M=-1;break;case 2:M=250;break;case 5:M=1073741823;break;case 4:M=1e4;break;default:M=5e3}return M=K+M,P={id:d++,callback:j,priorityLevel:P,startTime:K,expirationTime:M,sortIndex:-1},K>ne?(P.sortIndex=K,t(f,P),e(c)===null&&P===e(f)&&(w?(E(k),k=-1):w=!0,te(A,K-ne))):(P.sortIndex=M,t(c,P),b||g||(b=!0,D||(D=!0,U()))),P},n.unstable_shouldYield=B,n.unstable_wrapCallback=function(P){var j=m;return function(){var K=m;m=j;try{return P.apply(this,arguments)}finally{m=K}}}}(Xp)),Xp}var $1;function mA(){return $1||($1=1,Kp.exports=vA()),Kp.exports}var $p={exports:{}},We={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Y1;function gA(){if(Y1)return We;Y1=1;var n=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),e=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),i=Symbol.for("react.consumer"),u=Symbol.for("react.context"),l=Symbol.for("react.forward_ref"),c=Symbol.for("react.suspense"),f=Symbol.for("react.memo"),d=Symbol.for("react.lazy"),v=Symbol.iterator;function m(M){return M===null||typeof M!="object"?null:(M=v&&M[v]||M["@@iterator"],typeof M=="function"?M:null)}var g={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},b=Object.assign,w={};function S(M,G,ie){this.props=M,this.context=G,this.refs=w,this.updater=ie||g}S.prototype.isReactComponent={},S.prototype.setState=function(M,G){if(typeof M!="object"&&typeof M!="function"&&M!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,M,G,"setState")},S.prototype.forceUpdate=function(M){this.updater.enqueueForceUpdate(this,M,"forceUpdate")};function _(){}_.prototype=S.prototype;function E(M,G,ie){this.props=M,this.context=G,this.refs=w,this.updater=ie||g}var R=E.prototype=new _;R.constructor=E,b(R,S.prototype),R.isPureReactComponent=!0;var C=Array.isArray,A={H:null,A:null,T:null,S:null,V:null},D=Object.prototype.hasOwnProperty;function k(M,G,ie,oe,de,me){return ie=me.ref,{$$typeof:n,type:M,key:G,ref:ie!==void 0?ie:null,props:me}}function I(M,G){return k(M.type,G,void 0,void 0,void 0,M.props)}function N(M){return typeof M=="object"&&M!==null&&M.$$typeof===n}function B(M){var G={"=":"=0",":":"=2"};return"$"+M.replace(/[=:]/g,function(ie){return G[ie]})}var V=/\/+/g;function U(M,G){return typeof M=="object"&&M!==null&&M.key!=null?B(""+M.key):G.toString(36)}function J(){}function ee(M){switch(M.status){case"fulfilled":return M.value;case"rejected":throw M.reason;default:switch(typeof M.status=="string"?M.then(J,J):(M.status="pending",M.then(function(G){M.status==="pending"&&(M.status="fulfilled",M.value=G)},function(G){M.status==="pending"&&(M.status="rejected",M.reason=G)})),M.status){case"fulfilled":return M.value;case"rejected":throw M.reason}}throw M}function te(M,G,ie,oe,de){var me=typeof M;(me==="undefined"||me==="boolean")&&(M=null);var pe=!1;if(M===null)pe=!0;else switch(me){case"bigint":case"string":case"number":pe=!0;break;case"object":switch(M.$$typeof){case n:case t:pe=!0;break;case d:return pe=M._init,te(pe(M._payload),G,ie,oe,de)}}if(pe)return de=de(M),pe=oe===""?"."+U(M,0):oe,C(de)?(ie="",pe!=null&&(ie=pe.replace(V,"$&/")+"/"),te(de,G,ie,"",function(Ne){return Ne})):de!=null&&(N(de)&&(de=I(de,ie+(de.key==null||M&&M.key===de.key?"":(""+de.key).replace(V,"$&/")+"/")+pe)),G.push(de)),1;pe=0;var ke=oe===""?".":oe+":";if(C(M))for(var ye=0;ye<M.length;ye++)oe=M[ye],me=ke+U(oe,ye),pe+=te(oe,G,ie,me,de);else if(ye=m(M),typeof ye=="function")for(M=ye.call(M),ye=0;!(oe=M.next()).done;)oe=oe.value,me=ke+U(oe,ye++),pe+=te(oe,G,ie,me,de);else if(me==="object"){if(typeof M.then=="function")return te(ee(M),G,ie,oe,de);throw G=String(M),Error("Objects are not valid as a React child (found: "+(G==="[object Object]"?"object with keys {"+Object.keys(M).join(", ")+"}":G)+"). If you meant to render a collection of children, use an array instead.")}return pe}function P(M,G,ie){if(M==null)return M;var oe=[],de=0;return te(M,oe,"","",function(me){return G.call(ie,me,de++)}),oe}function j(M){if(M._status===-1){var G=M._result;G=G(),G.then(function(ie){(M._status===0||M._status===-1)&&(M._status=1,M._result=ie)},function(ie){(M._status===0||M._status===-1)&&(M._status=2,M._result=ie)}),M._status===-1&&(M._status=0,M._result=G)}if(M._status===1)return M._result.default;throw M._result}var K=typeof reportError=="function"?reportError:function(M){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var G=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof M=="object"&&M!==null&&typeof M.message=="string"?String(M.message):String(M),error:M});if(!window.dispatchEvent(G))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",M);return}console.error(M)};function ne(){}return We.Children={map:P,forEach:function(M,G,ie){P(M,function(){G.apply(this,arguments)},ie)},count:function(M){var G=0;return P(M,function(){G++}),G},toArray:function(M){return P(M,function(G){return G})||[]},only:function(M){if(!N(M))throw Error("React.Children.only expected to receive a single React element child.");return M}},We.Component=S,We.Fragment=e,We.Profiler=a,We.PureComponent=E,We.StrictMode=r,We.Suspense=c,We.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=A,We.__COMPILER_RUNTIME={__proto__:null,c:function(M){return A.H.useMemoCache(M)}},We.cache=function(M){return function(){return M.apply(null,arguments)}},We.cloneElement=function(M,G,ie){if(M==null)throw Error("The argument must be a React element, but you passed "+M+".");var oe=b({},M.props),de=M.key,me=void 0;if(G!=null)for(pe in G.ref!==void 0&&(me=void 0),G.key!==void 0&&(de=""+G.key),G)!D.call(G,pe)||pe==="key"||pe==="__self"||pe==="__source"||pe==="ref"&&G.ref===void 0||(oe[pe]=G[pe]);var pe=arguments.length-2;if(pe===1)oe.children=ie;else if(1<pe){for(var ke=Array(pe),ye=0;ye<pe;ye++)ke[ye]=arguments[ye+2];oe.children=ke}return k(M.type,de,void 0,void 0,me,oe)},We.createContext=function(M){return M={$$typeof:u,_currentValue:M,_currentValue2:M,_threadCount:0,Provider:null,Consumer:null},M.Provider=M,M.Consumer={$$typeof:i,_context:M},M},We.createElement=function(M,G,ie){var oe,de={},me=null;if(G!=null)for(oe in G.key!==void 0&&(me=""+G.key),G)D.call(G,oe)&&oe!=="key"&&oe!=="__self"&&oe!=="__source"&&(de[oe]=G[oe]);var pe=arguments.length-2;if(pe===1)de.children=ie;else if(1<pe){for(var ke=Array(pe),ye=0;ye<pe;ye++)ke[ye]=arguments[ye+2];de.children=ke}if(M&&M.defaultProps)for(oe in pe=M.defaultProps,pe)de[oe]===void 0&&(de[oe]=pe[oe]);return k(M,me,void 0,void 0,null,de)},We.createRef=function(){return{current:null}},We.forwardRef=function(M){return{$$typeof:l,render:M}},We.isValidElement=N,We.lazy=function(M){return{$$typeof:d,_payload:{_status:-1,_result:M},_init:j}},We.memo=function(M,G){return{$$typeof:f,type:M,compare:G===void 0?null:G}},We.startTransition=function(M){var G=A.T,ie={};A.T=ie;try{var oe=M(),de=A.S;de!==null&&de(ie,oe),typeof oe=="object"&&oe!==null&&typeof oe.then=="function"&&oe.then(ne,K)}catch(me){K(me)}finally{A.T=G}},We.unstable_useCacheRefresh=function(){return A.H.useCacheRefresh()},We.use=function(M){return A.H.use(M)},We.useActionState=function(M,G,ie){return A.H.useActionState(M,G,ie)},We.useCallback=function(M,G){return A.H.useCallback(M,G)},We.useContext=function(M){return A.H.useContext(M)},We.useDebugValue=function(){},We.useDeferredValue=function(M,G){return A.H.useDeferredValue(M,G)},We.useEffect=function(M,G,ie){var oe=A.H;if(typeof ie=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return oe.useEffect(M,G)},We.useId=function(){return A.H.useId()},We.useImperativeHandle=function(M,G,ie){return A.H.useImperativeHandle(M,G,ie)},We.useInsertionEffect=function(M,G){return A.H.useInsertionEffect(M,G)},We.useLayoutEffect=function(M,G){return A.H.useLayoutEffect(M,G)},We.useMemo=function(M,G){return A.H.useMemo(M,G)},We.useOptimistic=function(M,G){return A.H.useOptimistic(M,G)},We.useReducer=function(M,G,ie){return A.H.useReducer(M,G,ie)},We.useRef=function(M){return A.H.useRef(M)},We.useState=function(M){return A.H.useState(M)},We.useSyncExternalStore=function(M,G,ie){return A.H.useSyncExternalStore(M,G,ie)},We.useTransition=function(){return A.H.useTransition()},We.version="19.1.0",We}var Q1;function Im(){return Q1||(Q1=1,$p.exports=gA()),$p.exports}var Yp={exports:{}},xn={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Z1;function yA(){if(Z1)return xn;Z1=1;var n=Im();function t(c){var f="https://react.dev/errors/"+c;if(1<arguments.length){f+="?args[]="+encodeURIComponent(arguments[1]);for(var d=2;d<arguments.length;d++)f+="&args[]="+encodeURIComponent(arguments[d])}return"Minified React error #"+c+"; visit "+f+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function e(){}var r={d:{f:e,r:function(){throw Error(t(522))},D:e,C:e,L:e,m:e,X:e,S:e,M:e},p:0,findDOMNode:null},a=Symbol.for("react.portal");function i(c,f,d){var v=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:a,key:v==null?null:""+v,children:c,containerInfo:f,implementation:d}}var u=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function l(c,f){if(c==="font")return"";if(typeof f=="string")return f==="use-credentials"?f:""}return xn.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=r,xn.createPortal=function(c,f){var d=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!f||f.nodeType!==1&&f.nodeType!==9&&f.nodeType!==11)throw Error(t(299));return i(c,f,null,d)},xn.flushSync=function(c){var f=u.T,d=r.p;try{if(u.T=null,r.p=2,c)return c()}finally{u.T=f,r.p=d,r.d.f()}},xn.preconnect=function(c,f){typeof c=="string"&&(f?(f=f.crossOrigin,f=typeof f=="string"?f==="use-credentials"?f:"":void 0):f=null,r.d.C(c,f))},xn.prefetchDNS=function(c){typeof c=="string"&&r.d.D(c)},xn.preinit=function(c,f){if(typeof c=="string"&&f&&typeof f.as=="string"){var d=f.as,v=l(d,f.crossOrigin),m=typeof f.integrity=="string"?f.integrity:void 0,g=typeof f.fetchPriority=="string"?f.fetchPriority:void 0;d==="style"?r.d.S(c,typeof f.precedence=="string"?f.precedence:void 0,{crossOrigin:v,integrity:m,fetchPriority:g}):d==="script"&&r.d.X(c,{crossOrigin:v,integrity:m,fetchPriority:g,nonce:typeof f.nonce=="string"?f.nonce:void 0})}},xn.preinitModule=function(c,f){if(typeof c=="string")if(typeof f=="object"&&f!==null){if(f.as==null||f.as==="script"){var d=l(f.as,f.crossOrigin);r.d.M(c,{crossOrigin:d,integrity:typeof f.integrity=="string"?f.integrity:void 0,nonce:typeof f.nonce=="string"?f.nonce:void 0})}}else f==null&&r.d.M(c)},xn.preload=function(c,f){if(typeof c=="string"&&typeof f=="object"&&f!==null&&typeof f.as=="string"){var d=f.as,v=l(d,f.crossOrigin);r.d.L(c,d,{crossOrigin:v,integrity:typeof f.integrity=="string"?f.integrity:void 0,nonce:typeof f.nonce=="string"?f.nonce:void 0,type:typeof f.type=="string"?f.type:void 0,fetchPriority:typeof f.fetchPriority=="string"?f.fetchPriority:void 0,referrerPolicy:typeof f.referrerPolicy=="string"?f.referrerPolicy:void 0,imageSrcSet:typeof f.imageSrcSet=="string"?f.imageSrcSet:void 0,imageSizes:typeof f.imageSizes=="string"?f.imageSizes:void 0,media:typeof f.media=="string"?f.media:void 0})}},xn.preloadModule=function(c,f){if(typeof c=="string")if(f){var d=l(f.as,f.crossOrigin);r.d.m(c,{as:typeof f.as=="string"&&f.as!=="script"?f.as:void 0,crossOrigin:d,integrity:typeof f.integrity=="string"?f.integrity:void 0})}else r.d.m(c)},xn.requestFormReset=function(c){r.d.r(c)},xn.unstable_batchedUpdates=function(c,f){return c(f)},xn.useFormState=function(c,f,d){return u.H.useFormState(c,f,d)},xn.useFormStatus=function(){return u.H.useHostTransitionStatus()},xn.version="19.1.0",xn}var J1;function bA(){if(J1)return Yp.exports;J1=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(t){console.error(t)}}return n(),Yp.exports=yA(),Yp.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ex;function xA(){if(ex)return Uu;ex=1;var n=mA(),t=Im(),e=bA();function r(o){var s="https://react.dev/errors/"+o;if(1<arguments.length){s+="?args[]="+encodeURIComponent(arguments[1]);for(var h=2;h<arguments.length;h++)s+="&args[]="+encodeURIComponent(arguments[h])}return"Minified React error #"+o+"; visit "+s+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(o){return!(!o||o.nodeType!==1&&o.nodeType!==9&&o.nodeType!==11)}function i(o){var s=o,h=o;if(o.alternate)for(;s.return;)s=s.return;else{o=s;do s=o,(s.flags&4098)!==0&&(h=s.return),o=s.return;while(o)}return s.tag===3?h:null}function u(o){if(o.tag===13){var s=o.memoizedState;if(s===null&&(o=o.alternate,o!==null&&(s=o.memoizedState)),s!==null)return s.dehydrated}return null}function l(o){if(i(o)!==o)throw Error(r(188))}function c(o){var s=o.alternate;if(!s){if(s=i(o),s===null)throw Error(r(188));return s!==o?null:o}for(var h=o,p=s;;){var y=h.return;if(y===null)break;var x=y.alternate;if(x===null){if(p=y.return,p!==null){h=p;continue}break}if(y.child===x.child){for(x=y.child;x;){if(x===h)return l(y),o;if(x===p)return l(y),s;x=x.sibling}throw Error(r(188))}if(h.return!==p.return)h=y,p=x;else{for(var T=!1,O=y.child;O;){if(O===h){T=!0,h=y,p=x;break}if(O===p){T=!0,p=y,h=x;break}O=O.sibling}if(!T){for(O=x.child;O;){if(O===h){T=!0,h=x,p=y;break}if(O===p){T=!0,p=x,h=y;break}O=O.sibling}if(!T)throw Error(r(189))}}if(h.alternate!==p)throw Error(r(190))}if(h.tag!==3)throw Error(r(188));return h.stateNode.current===h?o:s}function f(o){var s=o.tag;if(s===5||s===26||s===27||s===6)return o;for(o=o.child;o!==null;){if(s=f(o),s!==null)return s;o=o.sibling}return null}var d=Object.assign,v=Symbol.for("react.element"),m=Symbol.for("react.transitional.element"),g=Symbol.for("react.portal"),b=Symbol.for("react.fragment"),w=Symbol.for("react.strict_mode"),S=Symbol.for("react.profiler"),_=Symbol.for("react.provider"),E=Symbol.for("react.consumer"),R=Symbol.for("react.context"),C=Symbol.for("react.forward_ref"),A=Symbol.for("react.suspense"),D=Symbol.for("react.suspense_list"),k=Symbol.for("react.memo"),I=Symbol.for("react.lazy"),N=Symbol.for("react.activity"),B=Symbol.for("react.memo_cache_sentinel"),V=Symbol.iterator;function U(o){return o===null||typeof o!="object"?null:(o=V&&o[V]||o["@@iterator"],typeof o=="function"?o:null)}var J=Symbol.for("react.client.reference");function ee(o){if(o==null)return null;if(typeof o=="function")return o.$$typeof===J?null:o.displayName||o.name||null;if(typeof o=="string")return o;switch(o){case b:return"Fragment";case S:return"Profiler";case w:return"StrictMode";case A:return"Suspense";case D:return"SuspenseList";case N:return"Activity"}if(typeof o=="object")switch(o.$$typeof){case g:return"Portal";case R:return(o.displayName||"Context")+".Provider";case E:return(o._context.displayName||"Context")+".Consumer";case C:var s=o.render;return o=o.displayName,o||(o=s.displayName||s.name||"",o=o!==""?"ForwardRef("+o+")":"ForwardRef"),o;case k:return s=o.displayName||null,s!==null?s:ee(o.type)||"Memo";case I:s=o._payload,o=o._init;try{return ee(o(s))}catch{}}return null}var te=Array.isArray,P=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,j=e.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,K={pending:!1,data:null,method:null,action:null},ne=[],M=-1;function G(o){return{current:o}}function ie(o){0>M||(o.current=ne[M],ne[M]=null,M--)}function oe(o,s){M++,ne[M]=o.current,o.current=s}var de=G(null),me=G(null),pe=G(null),ke=G(null);function ye(o,s){switch(oe(pe,s),oe(me,o),oe(de,null),s.nodeType){case 9:case 11:o=(o=s.documentElement)&&(o=o.namespaceURI)?x1(o):0;break;default:if(o=s.tagName,s=s.namespaceURI)s=x1(s),o=w1(s,o);else switch(o){case"svg":o=1;break;case"math":o=2;break;default:o=0}}ie(de),oe(de,o)}function Ne(){ie(de),ie(me),ie(pe)}function at(o){o.memoizedState!==null&&oe(ke,o);var s=de.current,h=w1(s,o.type);s!==h&&(oe(me,o),oe(de,h))}function Fe(o){me.current===o&&(ie(de),ie(me)),ke.current===o&&(ie(ke),Iu._currentValue=K)}var je=Object.prototype.hasOwnProperty,Ke=n.unstable_scheduleCallback,ut=n.unstable_cancelCallback,yt=n.unstable_shouldYield,pt=n.unstable_requestPaint,Mt=n.unstable_now,ar=n.unstable_getCurrentPriorityLevel,gn=n.unstable_ImmediatePriority,oa=n.unstable_UserBlockingPriority,kn=n.unstable_NormalPriority,Fr=n.unstable_LowPriority,ir=n.unstable_IdlePriority,Pa=n.log,_r=n.unstable_setDisableYieldValue,sa=null,Lt=null;function Ht(o){if(typeof Pa=="function"&&_r(o),Lt&&typeof Lt.setStrictMode=="function")try{Lt.setStrictMode(sa,o)}catch{}}var cn=Math.clz32?Math.clz32:Mh,Oh=Math.log,Nh=Math.LN2;function Mh(o){return o>>>=0,o===0?32:31-(Oh(o)/Nh|0)|0}var za=256,Ua=4194304;function Sr(o){var s=o&42;if(s!==0)return s;switch(o&-o){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return o&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return o}}function Ml(o,s,h){var p=o.pendingLanes;if(p===0)return 0;var y=0,x=o.suspendedLanes,T=o.pingedLanes;o=o.warmLanes;var O=p&134217727;return O!==0?(p=O&~x,p!==0?y=Sr(p):(T&=O,T!==0?y=Sr(T):h||(h=O&~o,h!==0&&(y=Sr(h))))):(O=p&~x,O!==0?y=Sr(O):T!==0?y=Sr(T):h||(h=p&~o,h!==0&&(y=Sr(h)))),y===0?0:s!==0&&s!==y&&(s&x)===0&&(x=y&-y,h=s&-s,x>=h||x===32&&(h&4194048)!==0)?s:y}function js(o,s){return(o.pendingLanes&~(o.suspendedLanes&~o.pingedLanes)&s)===0}function JE(o,s){switch(o){case 1:case 2:case 4:case 8:case 64:return s+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function ry(){var o=za;return za<<=1,(za&4194048)===0&&(za=256),o}function ay(){var o=Ua;return Ua<<=1,(Ua&62914560)===0&&(Ua=4194304),o}function Ih(o){for(var s=[],h=0;31>h;h++)s.push(o);return s}function Ws(o,s){o.pendingLanes|=s,s!==268435456&&(o.suspendedLanes=0,o.pingedLanes=0,o.warmLanes=0)}function eC(o,s,h,p,y,x){var T=o.pendingLanes;o.pendingLanes=h,o.suspendedLanes=0,o.pingedLanes=0,o.warmLanes=0,o.expiredLanes&=h,o.entangledLanes&=h,o.errorRecoveryDisabledLanes&=h,o.shellSuspendCounter=0;var O=o.entanglements,z=o.expirationTimes,Q=o.hiddenUpdates;for(h=T&~h;0<h;){var le=31-cn(h),fe=1<<le;O[le]=0,z[le]=-1;var Z=Q[le];if(Z!==null)for(Q[le]=null,le=0;le<Z.length;le++){var re=Z[le];re!==null&&(re.lane&=-536870913)}h&=~fe}p!==0&&iy(o,p,0),x!==0&&y===0&&o.tag!==0&&(o.suspendedLanes|=x&~(T&~s))}function iy(o,s,h){o.pendingLanes|=s,o.suspendedLanes&=~s;var p=31-cn(s);o.entangledLanes|=s,o.entanglements[p]=o.entanglements[p]|1073741824|h&4194090}function oy(o,s){var h=o.entangledLanes|=s;for(o=o.entanglements;h;){var p=31-cn(h),y=1<<p;y&s|o[p]&s&&(o[p]|=s),h&=~y}}function Fh(o){switch(o){case 2:o=1;break;case 8:o=4;break;case 32:o=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:o=128;break;case 268435456:o=134217728;break;default:o=0}return o}function Bh(o){return o&=-o,2<o?8<o?(o&134217727)!==0?32:268435456:8:2}function sy(){var o=j.p;return o!==0?o:(o=window.event,o===void 0?32:U1(o.type))}function tC(o,s){var h=j.p;try{return j.p=o,s()}finally{j.p=h}}var Va=Math.random().toString(36).slice(2),yn="__reactFiber$"+Va,On="__reactProps$"+Va,yo="__reactContainer$"+Va,Lh="__reactEvents$"+Va,nC="__reactListeners$"+Va,rC="__reactHandles$"+Va,uy="__reactResources$"+Va,Gs="__reactMarker$"+Va;function Ph(o){delete o[yn],delete o[On],delete o[Lh],delete o[nC],delete o[rC]}function bo(o){var s=o[yn];if(s)return s;for(var h=o.parentNode;h;){if(s=h[yo]||h[yn]){if(h=s.alternate,s.child!==null||h!==null&&h.child!==null)for(o=C1(o);o!==null;){if(h=o[yn])return h;o=C1(o)}return s}o=h,h=o.parentNode}return null}function xo(o){if(o=o[yn]||o[yo]){var s=o.tag;if(s===5||s===6||s===13||s===26||s===27||s===3)return o}return null}function qs(o){var s=o.tag;if(s===5||s===26||s===27||s===6)return o.stateNode;throw Error(r(33))}function wo(o){var s=o[uy];return s||(s=o[uy]={hoistableStyles:new Map,hoistableScripts:new Map}),s}function en(o){o[Gs]=!0}var ly=new Set,cy={};function Mi(o,s){_o(o,s),_o(o+"Capture",s)}function _o(o,s){for(cy[o]=s,o=0;o<s.length;o++)ly.add(s[o])}var aC=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),fy={},hy={};function iC(o){return je.call(hy,o)?!0:je.call(fy,o)?!1:aC.test(o)?hy[o]=!0:(fy[o]=!0,!1)}function Il(o,s,h){if(iC(s))if(h===null)o.removeAttribute(s);else{switch(typeof h){case"undefined":case"function":case"symbol":o.removeAttribute(s);return;case"boolean":var p=s.toLowerCase().slice(0,5);if(p!=="data-"&&p!=="aria-"){o.removeAttribute(s);return}}o.setAttribute(s,""+h)}}function Fl(o,s,h){if(h===null)o.removeAttribute(s);else{switch(typeof h){case"undefined":case"function":case"symbol":case"boolean":o.removeAttribute(s);return}o.setAttribute(s,""+h)}}function ua(o,s,h,p){if(p===null)o.removeAttribute(h);else{switch(typeof p){case"undefined":case"function":case"symbol":case"boolean":o.removeAttribute(h);return}o.setAttributeNS(s,h,""+p)}}var zh,dy;function So(o){if(zh===void 0)try{throw Error()}catch(h){var s=h.stack.trim().match(/\n( *(at )?)/);zh=s&&s[1]||"",dy=-1<h.stack.indexOf(`
    at`)?" (<anonymous>)":-1<h.stack.indexOf("@")?"@unknown:0:0":""}return`
`+zh+o+dy}var Uh=!1;function Vh(o,s){if(!o||Uh)return"";Uh=!0;var h=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var p={DetermineComponentFrameRoot:function(){try{if(s){var fe=function(){throw Error()};if(Object.defineProperty(fe.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(fe,[])}catch(re){var Z=re}Reflect.construct(o,[],fe)}else{try{fe.call()}catch(re){Z=re}o.call(fe.prototype)}}else{try{throw Error()}catch(re){Z=re}(fe=o())&&typeof fe.catch=="function"&&fe.catch(function(){})}}catch(re){if(re&&Z&&typeof re.stack=="string")return[re.stack,Z.stack]}return[null,null]}};p.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var y=Object.getOwnPropertyDescriptor(p.DetermineComponentFrameRoot,"name");y&&y.configurable&&Object.defineProperty(p.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var x=p.DetermineComponentFrameRoot(),T=x[0],O=x[1];if(T&&O){var z=T.split(`
`),Q=O.split(`
`);for(y=p=0;p<z.length&&!z[p].includes("DetermineComponentFrameRoot");)p++;for(;y<Q.length&&!Q[y].includes("DetermineComponentFrameRoot");)y++;if(p===z.length||y===Q.length)for(p=z.length-1,y=Q.length-1;1<=p&&0<=y&&z[p]!==Q[y];)y--;for(;1<=p&&0<=y;p--,y--)if(z[p]!==Q[y]){if(p!==1||y!==1)do if(p--,y--,0>y||z[p]!==Q[y]){var le=`
`+z[p].replace(" at new "," at ");return o.displayName&&le.includes("<anonymous>")&&(le=le.replace("<anonymous>",o.displayName)),le}while(1<=p&&0<=y);break}}}finally{Uh=!1,Error.prepareStackTrace=h}return(h=o?o.displayName||o.name:"")?So(h):""}function oC(o){switch(o.tag){case 26:case 27:case 5:return So(o.type);case 16:return So("Lazy");case 13:return So("Suspense");case 19:return So("SuspenseList");case 0:case 15:return Vh(o.type,!1);case 11:return Vh(o.type.render,!1);case 1:return Vh(o.type,!0);case 31:return So("Activity");default:return""}}function py(o){try{var s="";do s+=oC(o),o=o.return;while(o);return s}catch(h){return`
Error generating stack: `+h.message+`
`+h.stack}}function or(o){switch(typeof o){case"bigint":case"boolean":case"number":case"string":case"undefined":return o;case"object":return o;default:return""}}function vy(o){var s=o.type;return(o=o.nodeName)&&o.toLowerCase()==="input"&&(s==="checkbox"||s==="radio")}function sC(o){var s=vy(o)?"checked":"value",h=Object.getOwnPropertyDescriptor(o.constructor.prototype,s),p=""+o[s];if(!o.hasOwnProperty(s)&&typeof h<"u"&&typeof h.get=="function"&&typeof h.set=="function"){var y=h.get,x=h.set;return Object.defineProperty(o,s,{configurable:!0,get:function(){return y.call(this)},set:function(T){p=""+T,x.call(this,T)}}),Object.defineProperty(o,s,{enumerable:h.enumerable}),{getValue:function(){return p},setValue:function(T){p=""+T},stopTracking:function(){o._valueTracker=null,delete o[s]}}}}function Bl(o){o._valueTracker||(o._valueTracker=sC(o))}function my(o){if(!o)return!1;var s=o._valueTracker;if(!s)return!0;var h=s.getValue(),p="";return o&&(p=vy(o)?o.checked?"true":"false":o.value),o=p,o!==h?(s.setValue(o),!0):!1}function Ll(o){if(o=o||(typeof document<"u"?document:void 0),typeof o>"u")return null;try{return o.activeElement||o.body}catch{return o.body}}var uC=/[\n"\\]/g;function sr(o){return o.replace(uC,function(s){return"\\"+s.charCodeAt(0).toString(16)+" "})}function Hh(o,s,h,p,y,x,T,O){o.name="",T!=null&&typeof T!="function"&&typeof T!="symbol"&&typeof T!="boolean"?o.type=T:o.removeAttribute("type"),s!=null?T==="number"?(s===0&&o.value===""||o.value!=s)&&(o.value=""+or(s)):o.value!==""+or(s)&&(o.value=""+or(s)):T!=="submit"&&T!=="reset"||o.removeAttribute("value"),s!=null?jh(o,T,or(s)):h!=null?jh(o,T,or(h)):p!=null&&o.removeAttribute("value"),y==null&&x!=null&&(o.defaultChecked=!!x),y!=null&&(o.checked=y&&typeof y!="function"&&typeof y!="symbol"),O!=null&&typeof O!="function"&&typeof O!="symbol"&&typeof O!="boolean"?o.name=""+or(O):o.removeAttribute("name")}function gy(o,s,h,p,y,x,T,O){if(x!=null&&typeof x!="function"&&typeof x!="symbol"&&typeof x!="boolean"&&(o.type=x),s!=null||h!=null){if(!(x!=="submit"&&x!=="reset"||s!=null))return;h=h!=null?""+or(h):"",s=s!=null?""+or(s):h,O||s===o.value||(o.value=s),o.defaultValue=s}p=p??y,p=typeof p!="function"&&typeof p!="symbol"&&!!p,o.checked=O?o.checked:!!p,o.defaultChecked=!!p,T!=null&&typeof T!="function"&&typeof T!="symbol"&&typeof T!="boolean"&&(o.name=T)}function jh(o,s,h){s==="number"&&Ll(o.ownerDocument)===o||o.defaultValue===""+h||(o.defaultValue=""+h)}function Eo(o,s,h,p){if(o=o.options,s){s={};for(var y=0;y<h.length;y++)s["$"+h[y]]=!0;for(h=0;h<o.length;h++)y=s.hasOwnProperty("$"+o[h].value),o[h].selected!==y&&(o[h].selected=y),y&&p&&(o[h].defaultSelected=!0)}else{for(h=""+or(h),s=null,y=0;y<o.length;y++){if(o[y].value===h){o[y].selected=!0,p&&(o[y].defaultSelected=!0);return}s!==null||o[y].disabled||(s=o[y])}s!==null&&(s.selected=!0)}}function yy(o,s,h){if(s!=null&&(s=""+or(s),s!==o.value&&(o.value=s),h==null)){o.defaultValue!==s&&(o.defaultValue=s);return}o.defaultValue=h!=null?""+or(h):""}function by(o,s,h,p){if(s==null){if(p!=null){if(h!=null)throw Error(r(92));if(te(p)){if(1<p.length)throw Error(r(93));p=p[0]}h=p}h==null&&(h=""),s=h}h=or(s),o.defaultValue=h,p=o.textContent,p===h&&p!==""&&p!==null&&(o.value=p)}function Co(o,s){if(s){var h=o.firstChild;if(h&&h===o.lastChild&&h.nodeType===3){h.nodeValue=s;return}}o.textContent=s}var lC=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function xy(o,s,h){var p=s.indexOf("--")===0;h==null||typeof h=="boolean"||h===""?p?o.setProperty(s,""):s==="float"?o.cssFloat="":o[s]="":p?o.setProperty(s,h):typeof h!="number"||h===0||lC.has(s)?s==="float"?o.cssFloat=h:o[s]=(""+h).trim():o[s]=h+"px"}function wy(o,s,h){if(s!=null&&typeof s!="object")throw Error(r(62));if(o=o.style,h!=null){for(var p in h)!h.hasOwnProperty(p)||s!=null&&s.hasOwnProperty(p)||(p.indexOf("--")===0?o.setProperty(p,""):p==="float"?o.cssFloat="":o[p]="");for(var y in s)p=s[y],s.hasOwnProperty(y)&&h[y]!==p&&xy(o,y,p)}else for(var x in s)s.hasOwnProperty(x)&&xy(o,x,s[x])}function Wh(o){if(o.indexOf("-")===-1)return!1;switch(o){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var cC=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),fC=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Pl(o){return fC.test(""+o)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":o}var Gh=null;function qh(o){return o=o.target||o.srcElement||window,o.correspondingUseElement&&(o=o.correspondingUseElement),o.nodeType===3?o.parentNode:o}var Ro=null,Ao=null;function _y(o){var s=xo(o);if(s&&(o=s.stateNode)){var h=o[On]||null;e:switch(o=s.stateNode,s.type){case"input":if(Hh(o,h.value,h.defaultValue,h.defaultValue,h.checked,h.defaultChecked,h.type,h.name),s=h.name,h.type==="radio"&&s!=null){for(h=o;h.parentNode;)h=h.parentNode;for(h=h.querySelectorAll('input[name="'+sr(""+s)+'"][type="radio"]'),s=0;s<h.length;s++){var p=h[s];if(p!==o&&p.form===o.form){var y=p[On]||null;if(!y)throw Error(r(90));Hh(p,y.value,y.defaultValue,y.defaultValue,y.checked,y.defaultChecked,y.type,y.name)}}for(s=0;s<h.length;s++)p=h[s],p.form===o.form&&my(p)}break e;case"textarea":yy(o,h.value,h.defaultValue);break e;case"select":s=h.value,s!=null&&Eo(o,!!h.multiple,s,!1)}}}var Kh=!1;function Sy(o,s,h){if(Kh)return o(s,h);Kh=!0;try{var p=o(s);return p}finally{if(Kh=!1,(Ro!==null||Ao!==null)&&(Sc(),Ro&&(s=Ro,o=Ao,Ao=Ro=null,_y(s),o)))for(s=0;s<o.length;s++)_y(o[s])}}function Ks(o,s){var h=o.stateNode;if(h===null)return null;var p=h[On]||null;if(p===null)return null;h=p[s];e:switch(s){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(p=!p.disabled)||(o=o.type,p=!(o==="button"||o==="input"||o==="select"||o==="textarea")),o=!p;break e;default:o=!1}if(o)return null;if(h&&typeof h!="function")throw Error(r(231,s,typeof h));return h}var la=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Xh=!1;if(la)try{var Xs={};Object.defineProperty(Xs,"passive",{get:function(){Xh=!0}}),window.addEventListener("test",Xs,Xs),window.removeEventListener("test",Xs,Xs)}catch{Xh=!1}var Ha=null,$h=null,zl=null;function Ey(){if(zl)return zl;var o,s=$h,h=s.length,p,y="value"in Ha?Ha.value:Ha.textContent,x=y.length;for(o=0;o<h&&s[o]===y[o];o++);var T=h-o;for(p=1;p<=T&&s[h-p]===y[x-p];p++);return zl=y.slice(o,1<p?1-p:void 0)}function Ul(o){var s=o.keyCode;return"charCode"in o?(o=o.charCode,o===0&&s===13&&(o=13)):o=s,o===10&&(o=13),32<=o||o===13?o:0}function Vl(){return!0}function Cy(){return!1}function Nn(o){function s(h,p,y,x,T){this._reactName=h,this._targetInst=y,this.type=p,this.nativeEvent=x,this.target=T,this.currentTarget=null;for(var O in o)o.hasOwnProperty(O)&&(h=o[O],this[O]=h?h(x):x[O]);return this.isDefaultPrevented=(x.defaultPrevented!=null?x.defaultPrevented:x.returnValue===!1)?Vl:Cy,this.isPropagationStopped=Cy,this}return d(s.prototype,{preventDefault:function(){this.defaultPrevented=!0;var h=this.nativeEvent;h&&(h.preventDefault?h.preventDefault():typeof h.returnValue!="unknown"&&(h.returnValue=!1),this.isDefaultPrevented=Vl)},stopPropagation:function(){var h=this.nativeEvent;h&&(h.stopPropagation?h.stopPropagation():typeof h.cancelBubble!="unknown"&&(h.cancelBubble=!0),this.isPropagationStopped=Vl)},persist:function(){},isPersistent:Vl}),s}var Ii={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(o){return o.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Hl=Nn(Ii),$s=d({},Ii,{view:0,detail:0}),hC=Nn($s),Yh,Qh,Ys,jl=d({},$s,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Jh,button:0,buttons:0,relatedTarget:function(o){return o.relatedTarget===void 0?o.fromElement===o.srcElement?o.toElement:o.fromElement:o.relatedTarget},movementX:function(o){return"movementX"in o?o.movementX:(o!==Ys&&(Ys&&o.type==="mousemove"?(Yh=o.screenX-Ys.screenX,Qh=o.screenY-Ys.screenY):Qh=Yh=0,Ys=o),Yh)},movementY:function(o){return"movementY"in o?o.movementY:Qh}}),Ry=Nn(jl),dC=d({},jl,{dataTransfer:0}),pC=Nn(dC),vC=d({},$s,{relatedTarget:0}),Zh=Nn(vC),mC=d({},Ii,{animationName:0,elapsedTime:0,pseudoElement:0}),gC=Nn(mC),yC=d({},Ii,{clipboardData:function(o){return"clipboardData"in o?o.clipboardData:window.clipboardData}}),bC=Nn(yC),xC=d({},Ii,{data:0}),Ay=Nn(xC),wC={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},_C={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},SC={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function EC(o){var s=this.nativeEvent;return s.getModifierState?s.getModifierState(o):(o=SC[o])?!!s[o]:!1}function Jh(){return EC}var CC=d({},$s,{key:function(o){if(o.key){var s=wC[o.key]||o.key;if(s!=="Unidentified")return s}return o.type==="keypress"?(o=Ul(o),o===13?"Enter":String.fromCharCode(o)):o.type==="keydown"||o.type==="keyup"?_C[o.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Jh,charCode:function(o){return o.type==="keypress"?Ul(o):0},keyCode:function(o){return o.type==="keydown"||o.type==="keyup"?o.keyCode:0},which:function(o){return o.type==="keypress"?Ul(o):o.type==="keydown"||o.type==="keyup"?o.keyCode:0}}),RC=Nn(CC),AC=d({},jl,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Ty=Nn(AC),TC=d({},$s,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Jh}),DC=Nn(TC),kC=d({},Ii,{propertyName:0,elapsedTime:0,pseudoElement:0}),OC=Nn(kC),NC=d({},jl,{deltaX:function(o){return"deltaX"in o?o.deltaX:"wheelDeltaX"in o?-o.wheelDeltaX:0},deltaY:function(o){return"deltaY"in o?o.deltaY:"wheelDeltaY"in o?-o.wheelDeltaY:"wheelDelta"in o?-o.wheelDelta:0},deltaZ:0,deltaMode:0}),MC=Nn(NC),IC=d({},Ii,{newState:0,oldState:0}),FC=Nn(IC),BC=[9,13,27,32],ed=la&&"CompositionEvent"in window,Qs=null;la&&"documentMode"in document&&(Qs=document.documentMode);var LC=la&&"TextEvent"in window&&!Qs,Dy=la&&(!ed||Qs&&8<Qs&&11>=Qs),ky=" ",Oy=!1;function Ny(o,s){switch(o){case"keyup":return BC.indexOf(s.keyCode)!==-1;case"keydown":return s.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function My(o){return o=o.detail,typeof o=="object"&&"data"in o?o.data:null}var To=!1;function PC(o,s){switch(o){case"compositionend":return My(s);case"keypress":return s.which!==32?null:(Oy=!0,ky);case"textInput":return o=s.data,o===ky&&Oy?null:o;default:return null}}function zC(o,s){if(To)return o==="compositionend"||!ed&&Ny(o,s)?(o=Ey(),zl=$h=Ha=null,To=!1,o):null;switch(o){case"paste":return null;case"keypress":if(!(s.ctrlKey||s.altKey||s.metaKey)||s.ctrlKey&&s.altKey){if(s.char&&1<s.char.length)return s.char;if(s.which)return String.fromCharCode(s.which)}return null;case"compositionend":return Dy&&s.locale!=="ko"?null:s.data;default:return null}}var UC={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Iy(o){var s=o&&o.nodeName&&o.nodeName.toLowerCase();return s==="input"?!!UC[o.type]:s==="textarea"}function Fy(o,s,h,p){Ro?Ao?Ao.push(p):Ao=[p]:Ro=p,s=Dc(s,"onChange"),0<s.length&&(h=new Hl("onChange","change",null,h,p),o.push({event:h,listeners:s}))}var Zs=null,Js=null;function VC(o){v1(o,0)}function Wl(o){var s=qs(o);if(my(s))return o}function By(o,s){if(o==="change")return s}var Ly=!1;if(la){var td;if(la){var nd="oninput"in document;if(!nd){var Py=document.createElement("div");Py.setAttribute("oninput","return;"),nd=typeof Py.oninput=="function"}td=nd}else td=!1;Ly=td&&(!document.documentMode||9<document.documentMode)}function zy(){Zs&&(Zs.detachEvent("onpropertychange",Uy),Js=Zs=null)}function Uy(o){if(o.propertyName==="value"&&Wl(Js)){var s=[];Fy(s,Js,o,qh(o)),Sy(VC,s)}}function HC(o,s,h){o==="focusin"?(zy(),Zs=s,Js=h,Zs.attachEvent("onpropertychange",Uy)):o==="focusout"&&zy()}function jC(o){if(o==="selectionchange"||o==="keyup"||o==="keydown")return Wl(Js)}function WC(o,s){if(o==="click")return Wl(s)}function GC(o,s){if(o==="input"||o==="change")return Wl(s)}function qC(o,s){return o===s&&(o!==0||1/o===1/s)||o!==o&&s!==s}var Hn=typeof Object.is=="function"?Object.is:qC;function eu(o,s){if(Hn(o,s))return!0;if(typeof o!="object"||o===null||typeof s!="object"||s===null)return!1;var h=Object.keys(o),p=Object.keys(s);if(h.length!==p.length)return!1;for(p=0;p<h.length;p++){var y=h[p];if(!je.call(s,y)||!Hn(o[y],s[y]))return!1}return!0}function Vy(o){for(;o&&o.firstChild;)o=o.firstChild;return o}function Hy(o,s){var h=Vy(o);o=0;for(var p;h;){if(h.nodeType===3){if(p=o+h.textContent.length,o<=s&&p>=s)return{node:h,offset:s-o};o=p}e:{for(;h;){if(h.nextSibling){h=h.nextSibling;break e}h=h.parentNode}h=void 0}h=Vy(h)}}function jy(o,s){return o&&s?o===s?!0:o&&o.nodeType===3?!1:s&&s.nodeType===3?jy(o,s.parentNode):"contains"in o?o.contains(s):o.compareDocumentPosition?!!(o.compareDocumentPosition(s)&16):!1:!1}function Wy(o){o=o!=null&&o.ownerDocument!=null&&o.ownerDocument.defaultView!=null?o.ownerDocument.defaultView:window;for(var s=Ll(o.document);s instanceof o.HTMLIFrameElement;){try{var h=typeof s.contentWindow.location.href=="string"}catch{h=!1}if(h)o=s.contentWindow;else break;s=Ll(o.document)}return s}function rd(o){var s=o&&o.nodeName&&o.nodeName.toLowerCase();return s&&(s==="input"&&(o.type==="text"||o.type==="search"||o.type==="tel"||o.type==="url"||o.type==="password")||s==="textarea"||o.contentEditable==="true")}var KC=la&&"documentMode"in document&&11>=document.documentMode,Do=null,ad=null,tu=null,id=!1;function Gy(o,s,h){var p=h.window===h?h.document:h.nodeType===9?h:h.ownerDocument;id||Do==null||Do!==Ll(p)||(p=Do,"selectionStart"in p&&rd(p)?p={start:p.selectionStart,end:p.selectionEnd}:(p=(p.ownerDocument&&p.ownerDocument.defaultView||window).getSelection(),p={anchorNode:p.anchorNode,anchorOffset:p.anchorOffset,focusNode:p.focusNode,focusOffset:p.focusOffset}),tu&&eu(tu,p)||(tu=p,p=Dc(ad,"onSelect"),0<p.length&&(s=new Hl("onSelect","select",null,s,h),o.push({event:s,listeners:p}),s.target=Do)))}function Fi(o,s){var h={};return h[o.toLowerCase()]=s.toLowerCase(),h["Webkit"+o]="webkit"+s,h["Moz"+o]="moz"+s,h}var ko={animationend:Fi("Animation","AnimationEnd"),animationiteration:Fi("Animation","AnimationIteration"),animationstart:Fi("Animation","AnimationStart"),transitionrun:Fi("Transition","TransitionRun"),transitionstart:Fi("Transition","TransitionStart"),transitioncancel:Fi("Transition","TransitionCancel"),transitionend:Fi("Transition","TransitionEnd")},od={},qy={};la&&(qy=document.createElement("div").style,"AnimationEvent"in window||(delete ko.animationend.animation,delete ko.animationiteration.animation,delete ko.animationstart.animation),"TransitionEvent"in window||delete ko.transitionend.transition);function Bi(o){if(od[o])return od[o];if(!ko[o])return o;var s=ko[o],h;for(h in s)if(s.hasOwnProperty(h)&&h in qy)return od[o]=s[h];return o}var Ky=Bi("animationend"),Xy=Bi("animationiteration"),$y=Bi("animationstart"),XC=Bi("transitionrun"),$C=Bi("transitionstart"),YC=Bi("transitioncancel"),Yy=Bi("transitionend"),Qy=new Map,sd="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");sd.push("scrollEnd");function Er(o,s){Qy.set(o,s),Mi(s,[o])}var Zy=new WeakMap;function ur(o,s){if(typeof o=="object"&&o!==null){var h=Zy.get(o);return h!==void 0?h:(s={value:o,source:s,stack:py(s)},Zy.set(o,s),s)}return{value:o,source:s,stack:py(s)}}var lr=[],Oo=0,ud=0;function Gl(){for(var o=Oo,s=ud=Oo=0;s<o;){var h=lr[s];lr[s++]=null;var p=lr[s];lr[s++]=null;var y=lr[s];lr[s++]=null;var x=lr[s];if(lr[s++]=null,p!==null&&y!==null){var T=p.pending;T===null?y.next=y:(y.next=T.next,T.next=y),p.pending=y}x!==0&&Jy(h,y,x)}}function ql(o,s,h,p){lr[Oo++]=o,lr[Oo++]=s,lr[Oo++]=h,lr[Oo++]=p,ud|=p,o.lanes|=p,o=o.alternate,o!==null&&(o.lanes|=p)}function ld(o,s,h,p){return ql(o,s,h,p),Kl(o)}function No(o,s){return ql(o,null,null,s),Kl(o)}function Jy(o,s,h){o.lanes|=h;var p=o.alternate;p!==null&&(p.lanes|=h);for(var y=!1,x=o.return;x!==null;)x.childLanes|=h,p=x.alternate,p!==null&&(p.childLanes|=h),x.tag===22&&(o=x.stateNode,o===null||o._visibility&1||(y=!0)),o=x,x=x.return;return o.tag===3?(x=o.stateNode,y&&s!==null&&(y=31-cn(h),o=x.hiddenUpdates,p=o[y],p===null?o[y]=[s]:p.push(s),s.lane=h|536870912),x):null}function Kl(o){if(50<Ru)throw Ru=0,vp=null,Error(r(185));for(var s=o.return;s!==null;)o=s,s=o.return;return o.tag===3?o.stateNode:null}var Mo={};function QC(o,s,h,p){this.tag=o,this.key=h,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=s,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=p,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function jn(o,s,h,p){return new QC(o,s,h,p)}function cd(o){return o=o.prototype,!(!o||!o.isReactComponent)}function ca(o,s){var h=o.alternate;return h===null?(h=jn(o.tag,s,o.key,o.mode),h.elementType=o.elementType,h.type=o.type,h.stateNode=o.stateNode,h.alternate=o,o.alternate=h):(h.pendingProps=s,h.type=o.type,h.flags=0,h.subtreeFlags=0,h.deletions=null),h.flags=o.flags&65011712,h.childLanes=o.childLanes,h.lanes=o.lanes,h.child=o.child,h.memoizedProps=o.memoizedProps,h.memoizedState=o.memoizedState,h.updateQueue=o.updateQueue,s=o.dependencies,h.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext},h.sibling=o.sibling,h.index=o.index,h.ref=o.ref,h.refCleanup=o.refCleanup,h}function e0(o,s){o.flags&=65011714;var h=o.alternate;return h===null?(o.childLanes=0,o.lanes=s,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=h.childLanes,o.lanes=h.lanes,o.child=h.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=h.memoizedProps,o.memoizedState=h.memoizedState,o.updateQueue=h.updateQueue,o.type=h.type,s=h.dependencies,o.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext}),o}function Xl(o,s,h,p,y,x){var T=0;if(p=o,typeof o=="function")cd(o)&&(T=1);else if(typeof o=="string")T=JR(o,h,de.current)?26:o==="html"||o==="head"||o==="body"?27:5;else e:switch(o){case N:return o=jn(31,h,s,y),o.elementType=N,o.lanes=x,o;case b:return Li(h.children,y,x,s);case w:T=8,y|=24;break;case S:return o=jn(12,h,s,y|2),o.elementType=S,o.lanes=x,o;case A:return o=jn(13,h,s,y),o.elementType=A,o.lanes=x,o;case D:return o=jn(19,h,s,y),o.elementType=D,o.lanes=x,o;default:if(typeof o=="object"&&o!==null)switch(o.$$typeof){case _:case R:T=10;break e;case E:T=9;break e;case C:T=11;break e;case k:T=14;break e;case I:T=16,p=null;break e}T=29,h=Error(r(130,o===null?"null":typeof o,"")),p=null}return s=jn(T,h,s,y),s.elementType=o,s.type=p,s.lanes=x,s}function Li(o,s,h,p){return o=jn(7,o,p,s),o.lanes=h,o}function fd(o,s,h){return o=jn(6,o,null,s),o.lanes=h,o}function hd(o,s,h){return s=jn(4,o.children!==null?o.children:[],o.key,s),s.lanes=h,s.stateNode={containerInfo:o.containerInfo,pendingChildren:null,implementation:o.implementation},s}var Io=[],Fo=0,$l=null,Yl=0,cr=[],fr=0,Pi=null,fa=1,ha="";function zi(o,s){Io[Fo++]=Yl,Io[Fo++]=$l,$l=o,Yl=s}function t0(o,s,h){cr[fr++]=fa,cr[fr++]=ha,cr[fr++]=Pi,Pi=o;var p=fa;o=ha;var y=32-cn(p)-1;p&=~(1<<y),h+=1;var x=32-cn(s)+y;if(30<x){var T=y-y%5;x=(p&(1<<T)-1).toString(32),p>>=T,y-=T,fa=1<<32-cn(s)+y|h<<y|p,ha=x+o}else fa=1<<x|h<<y|p,ha=o}function dd(o){o.return!==null&&(zi(o,1),t0(o,1,0))}function pd(o){for(;o===$l;)$l=Io[--Fo],Io[Fo]=null,Yl=Io[--Fo],Io[Fo]=null;for(;o===Pi;)Pi=cr[--fr],cr[fr]=null,ha=cr[--fr],cr[fr]=null,fa=cr[--fr],cr[fr]=null}var An=null,kt=null,lt=!1,Ui=null,Br=!1,vd=Error(r(519));function Vi(o){var s=Error(r(418,""));throw au(ur(s,o)),vd}function n0(o){var s=o.stateNode,h=o.type,p=o.memoizedProps;switch(s[yn]=o,s[On]=p,h){case"dialog":Je("cancel",s),Je("close",s);break;case"iframe":case"object":case"embed":Je("load",s);break;case"video":case"audio":for(h=0;h<Tu.length;h++)Je(Tu[h],s);break;case"source":Je("error",s);break;case"img":case"image":case"link":Je("error",s),Je("load",s);break;case"details":Je("toggle",s);break;case"input":Je("invalid",s),gy(s,p.value,p.defaultValue,p.checked,p.defaultChecked,p.type,p.name,!0),Bl(s);break;case"select":Je("invalid",s);break;case"textarea":Je("invalid",s),by(s,p.value,p.defaultValue,p.children),Bl(s)}h=p.children,typeof h!="string"&&typeof h!="number"&&typeof h!="bigint"||s.textContent===""+h||p.suppressHydrationWarning===!0||b1(s.textContent,h)?(p.popover!=null&&(Je("beforetoggle",s),Je("toggle",s)),p.onScroll!=null&&Je("scroll",s),p.onScrollEnd!=null&&Je("scrollend",s),p.onClick!=null&&(s.onclick=kc),s=!0):s=!1,s||Vi(o)}function r0(o){for(An=o.return;An;)switch(An.tag){case 5:case 13:Br=!1;return;case 27:case 3:Br=!0;return;default:An=An.return}}function nu(o){if(o!==An)return!1;if(!lt)return r0(o),lt=!0,!1;var s=o.tag,h;if((h=s!==3&&s!==27)&&((h=s===5)&&(h=o.type,h=!(h!=="form"&&h!=="button")||Op(o.type,o.memoizedProps)),h=!h),h&&kt&&Vi(o),r0(o),s===13){if(o=o.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(r(317));e:{for(o=o.nextSibling,s=0;o;){if(o.nodeType===8)if(h=o.data,h==="/$"){if(s===0){kt=Rr(o.nextSibling);break e}s--}else h!=="$"&&h!=="$!"&&h!=="$?"||s++;o=o.nextSibling}kt=null}}else s===27?(s=kt,ai(o.type)?(o=Fp,Fp=null,kt=o):kt=s):kt=An?Rr(o.stateNode.nextSibling):null;return!0}function ru(){kt=An=null,lt=!1}function a0(){var o=Ui;return o!==null&&(Fn===null?Fn=o:Fn.push.apply(Fn,o),Ui=null),o}function au(o){Ui===null?Ui=[o]:Ui.push(o)}var md=G(null),Hi=null,da=null;function ja(o,s,h){oe(md,s._currentValue),s._currentValue=h}function pa(o){o._currentValue=md.current,ie(md)}function gd(o,s,h){for(;o!==null;){var p=o.alternate;if((o.childLanes&s)!==s?(o.childLanes|=s,p!==null&&(p.childLanes|=s)):p!==null&&(p.childLanes&s)!==s&&(p.childLanes|=s),o===h)break;o=o.return}}function yd(o,s,h,p){var y=o.child;for(y!==null&&(y.return=o);y!==null;){var x=y.dependencies;if(x!==null){var T=y.child;x=x.firstContext;e:for(;x!==null;){var O=x;x=y;for(var z=0;z<s.length;z++)if(O.context===s[z]){x.lanes|=h,O=x.alternate,O!==null&&(O.lanes|=h),gd(x.return,h,o),p||(T=null);break e}x=O.next}}else if(y.tag===18){if(T=y.return,T===null)throw Error(r(341));T.lanes|=h,x=T.alternate,x!==null&&(x.lanes|=h),gd(T,h,o),T=null}else T=y.child;if(T!==null)T.return=y;else for(T=y;T!==null;){if(T===o){T=null;break}if(y=T.sibling,y!==null){y.return=T.return,T=y;break}T=T.return}y=T}}function iu(o,s,h,p){o=null;for(var y=s,x=!1;y!==null;){if(!x){if((y.flags&524288)!==0)x=!0;else if((y.flags&262144)!==0)break}if(y.tag===10){var T=y.alternate;if(T===null)throw Error(r(387));if(T=T.memoizedProps,T!==null){var O=y.type;Hn(y.pendingProps.value,T.value)||(o!==null?o.push(O):o=[O])}}else if(y===ke.current){if(T=y.alternate,T===null)throw Error(r(387));T.memoizedState.memoizedState!==y.memoizedState.memoizedState&&(o!==null?o.push(Iu):o=[Iu])}y=y.return}o!==null&&yd(s,o,h,p),s.flags|=262144}function Ql(o){for(o=o.firstContext;o!==null;){if(!Hn(o.context._currentValue,o.memoizedValue))return!0;o=o.next}return!1}function ji(o){Hi=o,da=null,o=o.dependencies,o!==null&&(o.firstContext=null)}function bn(o){return i0(Hi,o)}function Zl(o,s){return Hi===null&&ji(o),i0(o,s)}function i0(o,s){var h=s._currentValue;if(s={context:s,memoizedValue:h,next:null},da===null){if(o===null)throw Error(r(308));da=s,o.dependencies={lanes:0,firstContext:s},o.flags|=524288}else da=da.next=s;return h}var ZC=typeof AbortController<"u"?AbortController:function(){var o=[],s=this.signal={aborted:!1,addEventListener:function(h,p){o.push(p)}};this.abort=function(){s.aborted=!0,o.forEach(function(h){return h()})}},JC=n.unstable_scheduleCallback,eR=n.unstable_NormalPriority,jt={$$typeof:R,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function bd(){return{controller:new ZC,data:new Map,refCount:0}}function ou(o){o.refCount--,o.refCount===0&&JC(eR,function(){o.controller.abort()})}var su=null,xd=0,Bo=0,Lo=null;function tR(o,s){if(su===null){var h=su=[];xd=0,Bo=_p(),Lo={status:"pending",value:void 0,then:function(p){h.push(p)}}}return xd++,s.then(o0,o0),s}function o0(){if(--xd===0&&su!==null){Lo!==null&&(Lo.status="fulfilled");var o=su;su=null,Bo=0,Lo=null;for(var s=0;s<o.length;s++)(0,o[s])()}}function nR(o,s){var h=[],p={status:"pending",value:null,reason:null,then:function(y){h.push(y)}};return o.then(function(){p.status="fulfilled",p.value=s;for(var y=0;y<h.length;y++)(0,h[y])(s)},function(y){for(p.status="rejected",p.reason=y,y=0;y<h.length;y++)(0,h[y])(void 0)}),p}var s0=P.S;P.S=function(o,s){typeof s=="object"&&s!==null&&typeof s.then=="function"&&tR(o,s),s0!==null&&s0(o,s)};var Wi=G(null);function wd(){var o=Wi.current;return o!==null?o:xt.pooledCache}function Jl(o,s){s===null?oe(Wi,Wi.current):oe(Wi,s.pool)}function u0(){var o=wd();return o===null?null:{parent:jt._currentValue,pool:o}}var uu=Error(r(460)),l0=Error(r(474)),ec=Error(r(542)),_d={then:function(){}};function c0(o){return o=o.status,o==="fulfilled"||o==="rejected"}function tc(){}function f0(o,s,h){switch(h=o[h],h===void 0?o.push(s):h!==s&&(s.then(tc,tc),s=h),s.status){case"fulfilled":return s.value;case"rejected":throw o=s.reason,d0(o),o;default:if(typeof s.status=="string")s.then(tc,tc);else{if(o=xt,o!==null&&100<o.shellSuspendCounter)throw Error(r(482));o=s,o.status="pending",o.then(function(p){if(s.status==="pending"){var y=s;y.status="fulfilled",y.value=p}},function(p){if(s.status==="pending"){var y=s;y.status="rejected",y.reason=p}})}switch(s.status){case"fulfilled":return s.value;case"rejected":throw o=s.reason,d0(o),o}throw lu=s,uu}}var lu=null;function h0(){if(lu===null)throw Error(r(459));var o=lu;return lu=null,o}function d0(o){if(o===uu||o===ec)throw Error(r(483))}var Wa=!1;function Sd(o){o.updateQueue={baseState:o.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Ed(o,s){o=o.updateQueue,s.updateQueue===o&&(s.updateQueue={baseState:o.baseState,firstBaseUpdate:o.firstBaseUpdate,lastBaseUpdate:o.lastBaseUpdate,shared:o.shared,callbacks:null})}function Ga(o){return{lane:o,tag:0,payload:null,callback:null,next:null}}function qa(o,s,h){var p=o.updateQueue;if(p===null)return null;if(p=p.shared,(ht&2)!==0){var y=p.pending;return y===null?s.next=s:(s.next=y.next,y.next=s),p.pending=s,s=Kl(o),Jy(o,null,h),s}return ql(o,p,s,h),Kl(o)}function cu(o,s,h){if(s=s.updateQueue,s!==null&&(s=s.shared,(h&4194048)!==0)){var p=s.lanes;p&=o.pendingLanes,h|=p,s.lanes=h,oy(o,h)}}function Cd(o,s){var h=o.updateQueue,p=o.alternate;if(p!==null&&(p=p.updateQueue,h===p)){var y=null,x=null;if(h=h.firstBaseUpdate,h!==null){do{var T={lane:h.lane,tag:h.tag,payload:h.payload,callback:null,next:null};x===null?y=x=T:x=x.next=T,h=h.next}while(h!==null);x===null?y=x=s:x=x.next=s}else y=x=s;h={baseState:p.baseState,firstBaseUpdate:y,lastBaseUpdate:x,shared:p.shared,callbacks:p.callbacks},o.updateQueue=h;return}o=h.lastBaseUpdate,o===null?h.firstBaseUpdate=s:o.next=s,h.lastBaseUpdate=s}var Rd=!1;function fu(){if(Rd){var o=Lo;if(o!==null)throw o}}function hu(o,s,h,p){Rd=!1;var y=o.updateQueue;Wa=!1;var x=y.firstBaseUpdate,T=y.lastBaseUpdate,O=y.shared.pending;if(O!==null){y.shared.pending=null;var z=O,Q=z.next;z.next=null,T===null?x=Q:T.next=Q,T=z;var le=o.alternate;le!==null&&(le=le.updateQueue,O=le.lastBaseUpdate,O!==T&&(O===null?le.firstBaseUpdate=Q:O.next=Q,le.lastBaseUpdate=z))}if(x!==null){var fe=y.baseState;T=0,le=Q=z=null,O=x;do{var Z=O.lane&-536870913,re=Z!==O.lane;if(re?(tt&Z)===Z:(p&Z)===Z){Z!==0&&Z===Bo&&(Rd=!0),le!==null&&(le=le.next={lane:0,tag:O.tag,payload:O.payload,callback:null,next:null});e:{var Be=o,Me=O;Z=s;var gt=h;switch(Me.tag){case 1:if(Be=Me.payload,typeof Be=="function"){fe=Be.call(gt,fe,Z);break e}fe=Be;break e;case 3:Be.flags=Be.flags&-65537|128;case 0:if(Be=Me.payload,Z=typeof Be=="function"?Be.call(gt,fe,Z):Be,Z==null)break e;fe=d({},fe,Z);break e;case 2:Wa=!0}}Z=O.callback,Z!==null&&(o.flags|=64,re&&(o.flags|=8192),re=y.callbacks,re===null?y.callbacks=[Z]:re.push(Z))}else re={lane:Z,tag:O.tag,payload:O.payload,callback:O.callback,next:null},le===null?(Q=le=re,z=fe):le=le.next=re,T|=Z;if(O=O.next,O===null){if(O=y.shared.pending,O===null)break;re=O,O=re.next,re.next=null,y.lastBaseUpdate=re,y.shared.pending=null}}while(!0);le===null&&(z=fe),y.baseState=z,y.firstBaseUpdate=Q,y.lastBaseUpdate=le,x===null&&(y.shared.lanes=0),ei|=T,o.lanes=T,o.memoizedState=fe}}function p0(o,s){if(typeof o!="function")throw Error(r(191,o));o.call(s)}function v0(o,s){var h=o.callbacks;if(h!==null)for(o.callbacks=null,o=0;o<h.length;o++)p0(h[o],s)}var Po=G(null),nc=G(0);function m0(o,s){o=wa,oe(nc,o),oe(Po,s),wa=o|s.baseLanes}function Ad(){oe(nc,wa),oe(Po,Po.current)}function Td(){wa=nc.current,ie(Po),ie(nc)}var Ka=0,Xe=null,vt=null,Pt=null,rc=!1,zo=!1,Gi=!1,ac=0,du=0,Uo=null,rR=0;function It(){throw Error(r(321))}function Dd(o,s){if(s===null)return!1;for(var h=0;h<s.length&&h<o.length;h++)if(!Hn(o[h],s[h]))return!1;return!0}function kd(o,s,h,p,y,x){return Ka=x,Xe=s,s.memoizedState=null,s.updateQueue=null,s.lanes=0,P.H=o===null||o.memoizedState===null?J0:eb,Gi=!1,x=h(p,y),Gi=!1,zo&&(x=y0(s,h,p,y)),g0(o),x}function g0(o){P.H=cc;var s=vt!==null&&vt.next!==null;if(Ka=0,Pt=vt=Xe=null,rc=!1,du=0,Uo=null,s)throw Error(r(300));o===null||tn||(o=o.dependencies,o!==null&&Ql(o)&&(tn=!0))}function y0(o,s,h,p){Xe=o;var y=0;do{if(zo&&(Uo=null),du=0,zo=!1,25<=y)throw Error(r(301));if(y+=1,Pt=vt=null,o.updateQueue!=null){var x=o.updateQueue;x.lastEffect=null,x.events=null,x.stores=null,x.memoCache!=null&&(x.memoCache.index=0)}P.H=cR,x=s(h,p)}while(zo);return x}function aR(){var o=P.H,s=o.useState()[0];return s=typeof s.then=="function"?pu(s):s,o=o.useState()[0],(vt!==null?vt.memoizedState:null)!==o&&(Xe.flags|=1024),s}function Od(){var o=ac!==0;return ac=0,o}function Nd(o,s,h){s.updateQueue=o.updateQueue,s.flags&=-2053,o.lanes&=~h}function Md(o){if(rc){for(o=o.memoizedState;o!==null;){var s=o.queue;s!==null&&(s.pending=null),o=o.next}rc=!1}Ka=0,Pt=vt=Xe=null,zo=!1,du=ac=0,Uo=null}function Mn(){var o={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Pt===null?Xe.memoizedState=Pt=o:Pt=Pt.next=o,Pt}function zt(){if(vt===null){var o=Xe.alternate;o=o!==null?o.memoizedState:null}else o=vt.next;var s=Pt===null?Xe.memoizedState:Pt.next;if(s!==null)Pt=s,vt=o;else{if(o===null)throw Xe.alternate===null?Error(r(467)):Error(r(310));vt=o,o={memoizedState:vt.memoizedState,baseState:vt.baseState,baseQueue:vt.baseQueue,queue:vt.queue,next:null},Pt===null?Xe.memoizedState=Pt=o:Pt=Pt.next=o}return Pt}function Id(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function pu(o){var s=du;return du+=1,Uo===null&&(Uo=[]),o=f0(Uo,o,s),s=Xe,(Pt===null?s.memoizedState:Pt.next)===null&&(s=s.alternate,P.H=s===null||s.memoizedState===null?J0:eb),o}function ic(o){if(o!==null&&typeof o=="object"){if(typeof o.then=="function")return pu(o);if(o.$$typeof===R)return bn(o)}throw Error(r(438,String(o)))}function Fd(o){var s=null,h=Xe.updateQueue;if(h!==null&&(s=h.memoCache),s==null){var p=Xe.alternate;p!==null&&(p=p.updateQueue,p!==null&&(p=p.memoCache,p!=null&&(s={data:p.data.map(function(y){return y.slice()}),index:0})))}if(s==null&&(s={data:[],index:0}),h===null&&(h=Id(),Xe.updateQueue=h),h.memoCache=s,h=s.data[s.index],h===void 0)for(h=s.data[s.index]=Array(o),p=0;p<o;p++)h[p]=B;return s.index++,h}function va(o,s){return typeof s=="function"?s(o):s}function oc(o){var s=zt();return Bd(s,vt,o)}function Bd(o,s,h){var p=o.queue;if(p===null)throw Error(r(311));p.lastRenderedReducer=h;var y=o.baseQueue,x=p.pending;if(x!==null){if(y!==null){var T=y.next;y.next=x.next,x.next=T}s.baseQueue=y=x,p.pending=null}if(x=o.baseState,y===null)o.memoizedState=x;else{s=y.next;var O=T=null,z=null,Q=s,le=!1;do{var fe=Q.lane&-536870913;if(fe!==Q.lane?(tt&fe)===fe:(Ka&fe)===fe){var Z=Q.revertLane;if(Z===0)z!==null&&(z=z.next={lane:0,revertLane:0,action:Q.action,hasEagerState:Q.hasEagerState,eagerState:Q.eagerState,next:null}),fe===Bo&&(le=!0);else if((Ka&Z)===Z){Q=Q.next,Z===Bo&&(le=!0);continue}else fe={lane:0,revertLane:Q.revertLane,action:Q.action,hasEagerState:Q.hasEagerState,eagerState:Q.eagerState,next:null},z===null?(O=z=fe,T=x):z=z.next=fe,Xe.lanes|=Z,ei|=Z;fe=Q.action,Gi&&h(x,fe),x=Q.hasEagerState?Q.eagerState:h(x,fe)}else Z={lane:fe,revertLane:Q.revertLane,action:Q.action,hasEagerState:Q.hasEagerState,eagerState:Q.eagerState,next:null},z===null?(O=z=Z,T=x):z=z.next=Z,Xe.lanes|=fe,ei|=fe;Q=Q.next}while(Q!==null&&Q!==s);if(z===null?T=x:z.next=O,!Hn(x,o.memoizedState)&&(tn=!0,le&&(h=Lo,h!==null)))throw h;o.memoizedState=x,o.baseState=T,o.baseQueue=z,p.lastRenderedState=x}return y===null&&(p.lanes=0),[o.memoizedState,p.dispatch]}function Ld(o){var s=zt(),h=s.queue;if(h===null)throw Error(r(311));h.lastRenderedReducer=o;var p=h.dispatch,y=h.pending,x=s.memoizedState;if(y!==null){h.pending=null;var T=y=y.next;do x=o(x,T.action),T=T.next;while(T!==y);Hn(x,s.memoizedState)||(tn=!0),s.memoizedState=x,s.baseQueue===null&&(s.baseState=x),h.lastRenderedState=x}return[x,p]}function b0(o,s,h){var p=Xe,y=zt(),x=lt;if(x){if(h===void 0)throw Error(r(407));h=h()}else h=s();var T=!Hn((vt||y).memoizedState,h);T&&(y.memoizedState=h,tn=!0),y=y.queue;var O=_0.bind(null,p,y,o);if(vu(2048,8,O,[o]),y.getSnapshot!==s||T||Pt!==null&&Pt.memoizedState.tag&1){if(p.flags|=2048,Vo(9,sc(),w0.bind(null,p,y,h,s),null),xt===null)throw Error(r(349));x||(Ka&124)!==0||x0(p,s,h)}return h}function x0(o,s,h){o.flags|=16384,o={getSnapshot:s,value:h},s=Xe.updateQueue,s===null?(s=Id(),Xe.updateQueue=s,s.stores=[o]):(h=s.stores,h===null?s.stores=[o]:h.push(o))}function w0(o,s,h,p){s.value=h,s.getSnapshot=p,S0(s)&&E0(o)}function _0(o,s,h){return h(function(){S0(s)&&E0(o)})}function S0(o){var s=o.getSnapshot;o=o.value;try{var h=s();return!Hn(o,h)}catch{return!0}}function E0(o){var s=No(o,2);s!==null&&Xn(s,o,2)}function Pd(o){var s=Mn();if(typeof o=="function"){var h=o;if(o=h(),Gi){Ht(!0);try{h()}finally{Ht(!1)}}}return s.memoizedState=s.baseState=o,s.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:va,lastRenderedState:o},s}function C0(o,s,h,p){return o.baseState=h,Bd(o,vt,typeof p=="function"?p:va)}function iR(o,s,h,p,y){if(lc(o))throw Error(r(485));if(o=s.action,o!==null){var x={payload:y,action:o,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(T){x.listeners.push(T)}};P.T!==null?h(!0):x.isTransition=!1,p(x),h=s.pending,h===null?(x.next=s.pending=x,R0(s,x)):(x.next=h.next,s.pending=h.next=x)}}function R0(o,s){var h=s.action,p=s.payload,y=o.state;if(s.isTransition){var x=P.T,T={};P.T=T;try{var O=h(y,p),z=P.S;z!==null&&z(T,O),A0(o,s,O)}catch(Q){zd(o,s,Q)}finally{P.T=x}}else try{x=h(y,p),A0(o,s,x)}catch(Q){zd(o,s,Q)}}function A0(o,s,h){h!==null&&typeof h=="object"&&typeof h.then=="function"?h.then(function(p){T0(o,s,p)},function(p){return zd(o,s,p)}):T0(o,s,h)}function T0(o,s,h){s.status="fulfilled",s.value=h,D0(s),o.state=h,s=o.pending,s!==null&&(h=s.next,h===s?o.pending=null:(h=h.next,s.next=h,R0(o,h)))}function zd(o,s,h){var p=o.pending;if(o.pending=null,p!==null){p=p.next;do s.status="rejected",s.reason=h,D0(s),s=s.next;while(s!==p)}o.action=null}function D0(o){o=o.listeners;for(var s=0;s<o.length;s++)(0,o[s])()}function k0(o,s){return s}function O0(o,s){if(lt){var h=xt.formState;if(h!==null){e:{var p=Xe;if(lt){if(kt){t:{for(var y=kt,x=Br;y.nodeType!==8;){if(!x){y=null;break t}if(y=Rr(y.nextSibling),y===null){y=null;break t}}x=y.data,y=x==="F!"||x==="F"?y:null}if(y){kt=Rr(y.nextSibling),p=y.data==="F!";break e}}Vi(p)}p=!1}p&&(s=h[0])}}return h=Mn(),h.memoizedState=h.baseState=s,p={pending:null,lanes:0,dispatch:null,lastRenderedReducer:k0,lastRenderedState:s},h.queue=p,h=Y0.bind(null,Xe,p),p.dispatch=h,p=Pd(!1),x=Wd.bind(null,Xe,!1,p.queue),p=Mn(),y={state:s,dispatch:null,action:o,pending:null},p.queue=y,h=iR.bind(null,Xe,y,x,h),y.dispatch=h,p.memoizedState=o,[s,h,!1]}function N0(o){var s=zt();return M0(s,vt,o)}function M0(o,s,h){if(s=Bd(o,s,k0)[0],o=oc(va)[0],typeof s=="object"&&s!==null&&typeof s.then=="function")try{var p=pu(s)}catch(T){throw T===uu?ec:T}else p=s;s=zt();var y=s.queue,x=y.dispatch;return h!==s.memoizedState&&(Xe.flags|=2048,Vo(9,sc(),oR.bind(null,y,h),null)),[p,x,o]}function oR(o,s){o.action=s}function I0(o){var s=zt(),h=vt;if(h!==null)return M0(s,h,o);zt(),s=s.memoizedState,h=zt();var p=h.queue.dispatch;return h.memoizedState=o,[s,p,!1]}function Vo(o,s,h,p){return o={tag:o,create:h,deps:p,inst:s,next:null},s=Xe.updateQueue,s===null&&(s=Id(),Xe.updateQueue=s),h=s.lastEffect,h===null?s.lastEffect=o.next=o:(p=h.next,h.next=o,o.next=p,s.lastEffect=o),o}function sc(){return{destroy:void 0,resource:void 0}}function F0(){return zt().memoizedState}function uc(o,s,h,p){var y=Mn();p=p===void 0?null:p,Xe.flags|=o,y.memoizedState=Vo(1|s,sc(),h,p)}function vu(o,s,h,p){var y=zt();p=p===void 0?null:p;var x=y.memoizedState.inst;vt!==null&&p!==null&&Dd(p,vt.memoizedState.deps)?y.memoizedState=Vo(s,x,h,p):(Xe.flags|=o,y.memoizedState=Vo(1|s,x,h,p))}function B0(o,s){uc(8390656,8,o,s)}function L0(o,s){vu(2048,8,o,s)}function P0(o,s){return vu(4,2,o,s)}function z0(o,s){return vu(4,4,o,s)}function U0(o,s){if(typeof s=="function"){o=o();var h=s(o);return function(){typeof h=="function"?h():s(null)}}if(s!=null)return o=o(),s.current=o,function(){s.current=null}}function V0(o,s,h){h=h!=null?h.concat([o]):null,vu(4,4,U0.bind(null,s,o),h)}function Ud(){}function H0(o,s){var h=zt();s=s===void 0?null:s;var p=h.memoizedState;return s!==null&&Dd(s,p[1])?p[0]:(h.memoizedState=[o,s],o)}function j0(o,s){var h=zt();s=s===void 0?null:s;var p=h.memoizedState;if(s!==null&&Dd(s,p[1]))return p[0];if(p=o(),Gi){Ht(!0);try{o()}finally{Ht(!1)}}return h.memoizedState=[p,s],p}function Vd(o,s,h){return h===void 0||(Ka&1073741824)!==0?o.memoizedState=s:(o.memoizedState=h,o=qb(),Xe.lanes|=o,ei|=o,h)}function W0(o,s,h,p){return Hn(h,s)?h:Po.current!==null?(o=Vd(o,h,p),Hn(o,s)||(tn=!0),o):(Ka&42)===0?(tn=!0,o.memoizedState=h):(o=qb(),Xe.lanes|=o,ei|=o,s)}function G0(o,s,h,p,y){var x=j.p;j.p=x!==0&&8>x?x:8;var T=P.T,O={};P.T=O,Wd(o,!1,s,h);try{var z=y(),Q=P.S;if(Q!==null&&Q(O,z),z!==null&&typeof z=="object"&&typeof z.then=="function"){var le=nR(z,p);mu(o,s,le,Kn(o))}else mu(o,s,p,Kn(o))}catch(fe){mu(o,s,{then:function(){},status:"rejected",reason:fe},Kn())}finally{j.p=x,P.T=T}}function sR(){}function Hd(o,s,h,p){if(o.tag!==5)throw Error(r(476));var y=q0(o).queue;G0(o,y,s,K,h===null?sR:function(){return K0(o),h(p)})}function q0(o){var s=o.memoizedState;if(s!==null)return s;s={memoizedState:K,baseState:K,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:va,lastRenderedState:K},next:null};var h={};return s.next={memoizedState:h,baseState:h,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:va,lastRenderedState:h},next:null},o.memoizedState=s,o=o.alternate,o!==null&&(o.memoizedState=s),s}function K0(o){var s=q0(o).next.queue;mu(o,s,{},Kn())}function jd(){return bn(Iu)}function X0(){return zt().memoizedState}function $0(){return zt().memoizedState}function uR(o){for(var s=o.return;s!==null;){switch(s.tag){case 24:case 3:var h=Kn();o=Ga(h);var p=qa(s,o,h);p!==null&&(Xn(p,s,h),cu(p,s,h)),s={cache:bd()},o.payload=s;return}s=s.return}}function lR(o,s,h){var p=Kn();h={lane:p,revertLane:0,action:h,hasEagerState:!1,eagerState:null,next:null},lc(o)?Q0(s,h):(h=ld(o,s,h,p),h!==null&&(Xn(h,o,p),Z0(h,s,p)))}function Y0(o,s,h){var p=Kn();mu(o,s,h,p)}function mu(o,s,h,p){var y={lane:p,revertLane:0,action:h,hasEagerState:!1,eagerState:null,next:null};if(lc(o))Q0(s,y);else{var x=o.alternate;if(o.lanes===0&&(x===null||x.lanes===0)&&(x=s.lastRenderedReducer,x!==null))try{var T=s.lastRenderedState,O=x(T,h);if(y.hasEagerState=!0,y.eagerState=O,Hn(O,T))return ql(o,s,y,0),xt===null&&Gl(),!1}catch{}finally{}if(h=ld(o,s,y,p),h!==null)return Xn(h,o,p),Z0(h,s,p),!0}return!1}function Wd(o,s,h,p){if(p={lane:2,revertLane:_p(),action:p,hasEagerState:!1,eagerState:null,next:null},lc(o)){if(s)throw Error(r(479))}else s=ld(o,h,p,2),s!==null&&Xn(s,o,2)}function lc(o){var s=o.alternate;return o===Xe||s!==null&&s===Xe}function Q0(o,s){zo=rc=!0;var h=o.pending;h===null?s.next=s:(s.next=h.next,h.next=s),o.pending=s}function Z0(o,s,h){if((h&4194048)!==0){var p=s.lanes;p&=o.pendingLanes,h|=p,s.lanes=h,oy(o,h)}}var cc={readContext:bn,use:ic,useCallback:It,useContext:It,useEffect:It,useImperativeHandle:It,useLayoutEffect:It,useInsertionEffect:It,useMemo:It,useReducer:It,useRef:It,useState:It,useDebugValue:It,useDeferredValue:It,useTransition:It,useSyncExternalStore:It,useId:It,useHostTransitionStatus:It,useFormState:It,useActionState:It,useOptimistic:It,useMemoCache:It,useCacheRefresh:It},J0={readContext:bn,use:ic,useCallback:function(o,s){return Mn().memoizedState=[o,s===void 0?null:s],o},useContext:bn,useEffect:B0,useImperativeHandle:function(o,s,h){h=h!=null?h.concat([o]):null,uc(4194308,4,U0.bind(null,s,o),h)},useLayoutEffect:function(o,s){return uc(4194308,4,o,s)},useInsertionEffect:function(o,s){uc(4,2,o,s)},useMemo:function(o,s){var h=Mn();s=s===void 0?null:s;var p=o();if(Gi){Ht(!0);try{o()}finally{Ht(!1)}}return h.memoizedState=[p,s],p},useReducer:function(o,s,h){var p=Mn();if(h!==void 0){var y=h(s);if(Gi){Ht(!0);try{h(s)}finally{Ht(!1)}}}else y=s;return p.memoizedState=p.baseState=y,o={pending:null,lanes:0,dispatch:null,lastRenderedReducer:o,lastRenderedState:y},p.queue=o,o=o.dispatch=lR.bind(null,Xe,o),[p.memoizedState,o]},useRef:function(o){var s=Mn();return o={current:o},s.memoizedState=o},useState:function(o){o=Pd(o);var s=o.queue,h=Y0.bind(null,Xe,s);return s.dispatch=h,[o.memoizedState,h]},useDebugValue:Ud,useDeferredValue:function(o,s){var h=Mn();return Vd(h,o,s)},useTransition:function(){var o=Pd(!1);return o=G0.bind(null,Xe,o.queue,!0,!1),Mn().memoizedState=o,[!1,o]},useSyncExternalStore:function(o,s,h){var p=Xe,y=Mn();if(lt){if(h===void 0)throw Error(r(407));h=h()}else{if(h=s(),xt===null)throw Error(r(349));(tt&124)!==0||x0(p,s,h)}y.memoizedState=h;var x={value:h,getSnapshot:s};return y.queue=x,B0(_0.bind(null,p,x,o),[o]),p.flags|=2048,Vo(9,sc(),w0.bind(null,p,x,h,s),null),h},useId:function(){var o=Mn(),s=xt.identifierPrefix;if(lt){var h=ha,p=fa;h=(p&~(1<<32-cn(p)-1)).toString(32)+h,s=""+s+"R"+h,h=ac++,0<h&&(s+="H"+h.toString(32)),s+=""}else h=rR++,s=""+s+"r"+h.toString(32)+"";return o.memoizedState=s},useHostTransitionStatus:jd,useFormState:O0,useActionState:O0,useOptimistic:function(o){var s=Mn();s.memoizedState=s.baseState=o;var h={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return s.queue=h,s=Wd.bind(null,Xe,!0,h),h.dispatch=s,[o,s]},useMemoCache:Fd,useCacheRefresh:function(){return Mn().memoizedState=uR.bind(null,Xe)}},eb={readContext:bn,use:ic,useCallback:H0,useContext:bn,useEffect:L0,useImperativeHandle:V0,useInsertionEffect:P0,useLayoutEffect:z0,useMemo:j0,useReducer:oc,useRef:F0,useState:function(){return oc(va)},useDebugValue:Ud,useDeferredValue:function(o,s){var h=zt();return W0(h,vt.memoizedState,o,s)},useTransition:function(){var o=oc(va)[0],s=zt().memoizedState;return[typeof o=="boolean"?o:pu(o),s]},useSyncExternalStore:b0,useId:X0,useHostTransitionStatus:jd,useFormState:N0,useActionState:N0,useOptimistic:function(o,s){var h=zt();return C0(h,vt,o,s)},useMemoCache:Fd,useCacheRefresh:$0},cR={readContext:bn,use:ic,useCallback:H0,useContext:bn,useEffect:L0,useImperativeHandle:V0,useInsertionEffect:P0,useLayoutEffect:z0,useMemo:j0,useReducer:Ld,useRef:F0,useState:function(){return Ld(va)},useDebugValue:Ud,useDeferredValue:function(o,s){var h=zt();return vt===null?Vd(h,o,s):W0(h,vt.memoizedState,o,s)},useTransition:function(){var o=Ld(va)[0],s=zt().memoizedState;return[typeof o=="boolean"?o:pu(o),s]},useSyncExternalStore:b0,useId:X0,useHostTransitionStatus:jd,useFormState:I0,useActionState:I0,useOptimistic:function(o,s){var h=zt();return vt!==null?C0(h,vt,o,s):(h.baseState=o,[o,h.queue.dispatch])},useMemoCache:Fd,useCacheRefresh:$0},Ho=null,gu=0;function fc(o){var s=gu;return gu+=1,Ho===null&&(Ho=[]),f0(Ho,o,s)}function yu(o,s){s=s.props.ref,o.ref=s!==void 0?s:null}function hc(o,s){throw s.$$typeof===v?Error(r(525)):(o=Object.prototype.toString.call(s),Error(r(31,o==="[object Object]"?"object with keys {"+Object.keys(s).join(", ")+"}":o)))}function tb(o){var s=o._init;return s(o._payload)}function nb(o){function s(X,W){if(o){var $=X.deletions;$===null?(X.deletions=[W],X.flags|=16):$.push(W)}}function h(X,W){if(!o)return null;for(;W!==null;)s(X,W),W=W.sibling;return null}function p(X){for(var W=new Map;X!==null;)X.key!==null?W.set(X.key,X):W.set(X.index,X),X=X.sibling;return W}function y(X,W){return X=ca(X,W),X.index=0,X.sibling=null,X}function x(X,W,$){return X.index=$,o?($=X.alternate,$!==null?($=$.index,$<W?(X.flags|=67108866,W):$):(X.flags|=67108866,W)):(X.flags|=1048576,W)}function T(X){return o&&X.alternate===null&&(X.flags|=67108866),X}function O(X,W,$,ce){return W===null||W.tag!==6?(W=fd($,X.mode,ce),W.return=X,W):(W=y(W,$),W.return=X,W)}function z(X,W,$,ce){var we=$.type;return we===b?le(X,W,$.props.children,ce,$.key):W!==null&&(W.elementType===we||typeof we=="object"&&we!==null&&we.$$typeof===I&&tb(we)===W.type)?(W=y(W,$.props),yu(W,$),W.return=X,W):(W=Xl($.type,$.key,$.props,null,X.mode,ce),yu(W,$),W.return=X,W)}function Q(X,W,$,ce){return W===null||W.tag!==4||W.stateNode.containerInfo!==$.containerInfo||W.stateNode.implementation!==$.implementation?(W=hd($,X.mode,ce),W.return=X,W):(W=y(W,$.children||[]),W.return=X,W)}function le(X,W,$,ce,we){return W===null||W.tag!==7?(W=Li($,X.mode,ce,we),W.return=X,W):(W=y(W,$),W.return=X,W)}function fe(X,W,$){if(typeof W=="string"&&W!==""||typeof W=="number"||typeof W=="bigint")return W=fd(""+W,X.mode,$),W.return=X,W;if(typeof W=="object"&&W!==null){switch(W.$$typeof){case m:return $=Xl(W.type,W.key,W.props,null,X.mode,$),yu($,W),$.return=X,$;case g:return W=hd(W,X.mode,$),W.return=X,W;case I:var ce=W._init;return W=ce(W._payload),fe(X,W,$)}if(te(W)||U(W))return W=Li(W,X.mode,$,null),W.return=X,W;if(typeof W.then=="function")return fe(X,fc(W),$);if(W.$$typeof===R)return fe(X,Zl(X,W),$);hc(X,W)}return null}function Z(X,W,$,ce){var we=W!==null?W.key:null;if(typeof $=="string"&&$!==""||typeof $=="number"||typeof $=="bigint")return we!==null?null:O(X,W,""+$,ce);if(typeof $=="object"&&$!==null){switch($.$$typeof){case m:return $.key===we?z(X,W,$,ce):null;case g:return $.key===we?Q(X,W,$,ce):null;case I:return we=$._init,$=we($._payload),Z(X,W,$,ce)}if(te($)||U($))return we!==null?null:le(X,W,$,ce,null);if(typeof $.then=="function")return Z(X,W,fc($),ce);if($.$$typeof===R)return Z(X,W,Zl(X,$),ce);hc(X,$)}return null}function re(X,W,$,ce,we){if(typeof ce=="string"&&ce!==""||typeof ce=="number"||typeof ce=="bigint")return X=X.get($)||null,O(W,X,""+ce,we);if(typeof ce=="object"&&ce!==null){switch(ce.$$typeof){case m:return X=X.get(ce.key===null?$:ce.key)||null,z(W,X,ce,we);case g:return X=X.get(ce.key===null?$:ce.key)||null,Q(W,X,ce,we);case I:var $e=ce._init;return ce=$e(ce._payload),re(X,W,$,ce,we)}if(te(ce)||U(ce))return X=X.get($)||null,le(W,X,ce,we,null);if(typeof ce.then=="function")return re(X,W,$,fc(ce),we);if(ce.$$typeof===R)return re(X,W,$,Zl(W,ce),we);hc(W,ce)}return null}function Be(X,W,$,ce){for(var we=null,$e=null,Oe=W,Ie=W=0,rn=null;Oe!==null&&Ie<$.length;Ie++){Oe.index>Ie?(rn=Oe,Oe=null):rn=Oe.sibling;var it=Z(X,Oe,$[Ie],ce);if(it===null){Oe===null&&(Oe=rn);break}o&&Oe&&it.alternate===null&&s(X,Oe),W=x(it,W,Ie),$e===null?we=it:$e.sibling=it,$e=it,Oe=rn}if(Ie===$.length)return h(X,Oe),lt&&zi(X,Ie),we;if(Oe===null){for(;Ie<$.length;Ie++)Oe=fe(X,$[Ie],ce),Oe!==null&&(W=x(Oe,W,Ie),$e===null?we=Oe:$e.sibling=Oe,$e=Oe);return lt&&zi(X,Ie),we}for(Oe=p(Oe);Ie<$.length;Ie++)rn=re(Oe,X,Ie,$[Ie],ce),rn!==null&&(o&&rn.alternate!==null&&Oe.delete(rn.key===null?Ie:rn.key),W=x(rn,W,Ie),$e===null?we=rn:$e.sibling=rn,$e=rn);return o&&Oe.forEach(function(li){return s(X,li)}),lt&&zi(X,Ie),we}function Me(X,W,$,ce){if($==null)throw Error(r(151));for(var we=null,$e=null,Oe=W,Ie=W=0,rn=null,it=$.next();Oe!==null&&!it.done;Ie++,it=$.next()){Oe.index>Ie?(rn=Oe,Oe=null):rn=Oe.sibling;var li=Z(X,Oe,it.value,ce);if(li===null){Oe===null&&(Oe=rn);break}o&&Oe&&li.alternate===null&&s(X,Oe),W=x(li,W,Ie),$e===null?we=li:$e.sibling=li,$e=li,Oe=rn}if(it.done)return h(X,Oe),lt&&zi(X,Ie),we;if(Oe===null){for(;!it.done;Ie++,it=$.next())it=fe(X,it.value,ce),it!==null&&(W=x(it,W,Ie),$e===null?we=it:$e.sibling=it,$e=it);return lt&&zi(X,Ie),we}for(Oe=p(Oe);!it.done;Ie++,it=$.next())it=re(Oe,X,Ie,it.value,ce),it!==null&&(o&&it.alternate!==null&&Oe.delete(it.key===null?Ie:it.key),W=x(it,W,Ie),$e===null?we=it:$e.sibling=it,$e=it);return o&&Oe.forEach(function(fA){return s(X,fA)}),lt&&zi(X,Ie),we}function gt(X,W,$,ce){if(typeof $=="object"&&$!==null&&$.type===b&&$.key===null&&($=$.props.children),typeof $=="object"&&$!==null){switch($.$$typeof){case m:e:{for(var we=$.key;W!==null;){if(W.key===we){if(we=$.type,we===b){if(W.tag===7){h(X,W.sibling),ce=y(W,$.props.children),ce.return=X,X=ce;break e}}else if(W.elementType===we||typeof we=="object"&&we!==null&&we.$$typeof===I&&tb(we)===W.type){h(X,W.sibling),ce=y(W,$.props),yu(ce,$),ce.return=X,X=ce;break e}h(X,W);break}else s(X,W);W=W.sibling}$.type===b?(ce=Li($.props.children,X.mode,ce,$.key),ce.return=X,X=ce):(ce=Xl($.type,$.key,$.props,null,X.mode,ce),yu(ce,$),ce.return=X,X=ce)}return T(X);case g:e:{for(we=$.key;W!==null;){if(W.key===we)if(W.tag===4&&W.stateNode.containerInfo===$.containerInfo&&W.stateNode.implementation===$.implementation){h(X,W.sibling),ce=y(W,$.children||[]),ce.return=X,X=ce;break e}else{h(X,W);break}else s(X,W);W=W.sibling}ce=hd($,X.mode,ce),ce.return=X,X=ce}return T(X);case I:return we=$._init,$=we($._payload),gt(X,W,$,ce)}if(te($))return Be(X,W,$,ce);if(U($)){if(we=U($),typeof we!="function")throw Error(r(150));return $=we.call($),Me(X,W,$,ce)}if(typeof $.then=="function")return gt(X,W,fc($),ce);if($.$$typeof===R)return gt(X,W,Zl(X,$),ce);hc(X,$)}return typeof $=="string"&&$!==""||typeof $=="number"||typeof $=="bigint"?($=""+$,W!==null&&W.tag===6?(h(X,W.sibling),ce=y(W,$),ce.return=X,X=ce):(h(X,W),ce=fd($,X.mode,ce),ce.return=X,X=ce),T(X)):h(X,W)}return function(X,W,$,ce){try{gu=0;var we=gt(X,W,$,ce);return Ho=null,we}catch(Oe){if(Oe===uu||Oe===ec)throw Oe;var $e=jn(29,Oe,null,X.mode);return $e.lanes=ce,$e.return=X,$e}finally{}}}var jo=nb(!0),rb=nb(!1),hr=G(null),Lr=null;function Xa(o){var s=o.alternate;oe(Wt,Wt.current&1),oe(hr,o),Lr===null&&(s===null||Po.current!==null||s.memoizedState!==null)&&(Lr=o)}function ab(o){if(o.tag===22){if(oe(Wt,Wt.current),oe(hr,o),Lr===null){var s=o.alternate;s!==null&&s.memoizedState!==null&&(Lr=o)}}else $a()}function $a(){oe(Wt,Wt.current),oe(hr,hr.current)}function ma(o){ie(hr),Lr===o&&(Lr=null),ie(Wt)}var Wt=G(0);function dc(o){for(var s=o;s!==null;){if(s.tag===13){var h=s.memoizedState;if(h!==null&&(h=h.dehydrated,h===null||h.data==="$?"||Ip(h)))return s}else if(s.tag===19&&s.memoizedProps.revealOrder!==void 0){if((s.flags&128)!==0)return s}else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===o)break;for(;s.sibling===null;){if(s.return===null||s.return===o)return null;s=s.return}s.sibling.return=s.return,s=s.sibling}return null}function Gd(o,s,h,p){s=o.memoizedState,h=h(p,s),h=h==null?s:d({},s,h),o.memoizedState=h,o.lanes===0&&(o.updateQueue.baseState=h)}var qd={enqueueSetState:function(o,s,h){o=o._reactInternals;var p=Kn(),y=Ga(p);y.payload=s,h!=null&&(y.callback=h),s=qa(o,y,p),s!==null&&(Xn(s,o,p),cu(s,o,p))},enqueueReplaceState:function(o,s,h){o=o._reactInternals;var p=Kn(),y=Ga(p);y.tag=1,y.payload=s,h!=null&&(y.callback=h),s=qa(o,y,p),s!==null&&(Xn(s,o,p),cu(s,o,p))},enqueueForceUpdate:function(o,s){o=o._reactInternals;var h=Kn(),p=Ga(h);p.tag=2,s!=null&&(p.callback=s),s=qa(o,p,h),s!==null&&(Xn(s,o,h),cu(s,o,h))}};function ib(o,s,h,p,y,x,T){return o=o.stateNode,typeof o.shouldComponentUpdate=="function"?o.shouldComponentUpdate(p,x,T):s.prototype&&s.prototype.isPureReactComponent?!eu(h,p)||!eu(y,x):!0}function ob(o,s,h,p){o=s.state,typeof s.componentWillReceiveProps=="function"&&s.componentWillReceiveProps(h,p),typeof s.UNSAFE_componentWillReceiveProps=="function"&&s.UNSAFE_componentWillReceiveProps(h,p),s.state!==o&&qd.enqueueReplaceState(s,s.state,null)}function qi(o,s){var h=s;if("ref"in s){h={};for(var p in s)p!=="ref"&&(h[p]=s[p])}if(o=o.defaultProps){h===s&&(h=d({},h));for(var y in o)h[y]===void 0&&(h[y]=o[y])}return h}var pc=typeof reportError=="function"?reportError:function(o){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var s=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof o=="object"&&o!==null&&typeof o.message=="string"?String(o.message):String(o),error:o});if(!window.dispatchEvent(s))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",o);return}console.error(o)};function sb(o){pc(o)}function ub(o){console.error(o)}function lb(o){pc(o)}function vc(o,s){try{var h=o.onUncaughtError;h(s.value,{componentStack:s.stack})}catch(p){setTimeout(function(){throw p})}}function cb(o,s,h){try{var p=o.onCaughtError;p(h.value,{componentStack:h.stack,errorBoundary:s.tag===1?s.stateNode:null})}catch(y){setTimeout(function(){throw y})}}function Kd(o,s,h){return h=Ga(h),h.tag=3,h.payload={element:null},h.callback=function(){vc(o,s)},h}function fb(o){return o=Ga(o),o.tag=3,o}function hb(o,s,h,p){var y=h.type.getDerivedStateFromError;if(typeof y=="function"){var x=p.value;o.payload=function(){return y(x)},o.callback=function(){cb(s,h,p)}}var T=h.stateNode;T!==null&&typeof T.componentDidCatch=="function"&&(o.callback=function(){cb(s,h,p),typeof y!="function"&&(ti===null?ti=new Set([this]):ti.add(this));var O=p.stack;this.componentDidCatch(p.value,{componentStack:O!==null?O:""})})}function fR(o,s,h,p,y){if(h.flags|=32768,p!==null&&typeof p=="object"&&typeof p.then=="function"){if(s=h.alternate,s!==null&&iu(s,h,y,!0),h=hr.current,h!==null){switch(h.tag){case 13:return Lr===null?gp():h.alternate===null&&Ot===0&&(Ot=3),h.flags&=-257,h.flags|=65536,h.lanes=y,p===_d?h.flags|=16384:(s=h.updateQueue,s===null?h.updateQueue=new Set([p]):s.add(p),bp(o,p,y)),!1;case 22:return h.flags|=65536,p===_d?h.flags|=16384:(s=h.updateQueue,s===null?(s={transitions:null,markerInstances:null,retryQueue:new Set([p])},h.updateQueue=s):(h=s.retryQueue,h===null?s.retryQueue=new Set([p]):h.add(p)),bp(o,p,y)),!1}throw Error(r(435,h.tag))}return bp(o,p,y),gp(),!1}if(lt)return s=hr.current,s!==null?((s.flags&65536)===0&&(s.flags|=256),s.flags|=65536,s.lanes=y,p!==vd&&(o=Error(r(422),{cause:p}),au(ur(o,h)))):(p!==vd&&(s=Error(r(423),{cause:p}),au(ur(s,h))),o=o.current.alternate,o.flags|=65536,y&=-y,o.lanes|=y,p=ur(p,h),y=Kd(o.stateNode,p,y),Cd(o,y),Ot!==4&&(Ot=2)),!1;var x=Error(r(520),{cause:p});if(x=ur(x,h),Cu===null?Cu=[x]:Cu.push(x),Ot!==4&&(Ot=2),s===null)return!0;p=ur(p,h),h=s;do{switch(h.tag){case 3:return h.flags|=65536,o=y&-y,h.lanes|=o,o=Kd(h.stateNode,p,o),Cd(h,o),!1;case 1:if(s=h.type,x=h.stateNode,(h.flags&128)===0&&(typeof s.getDerivedStateFromError=="function"||x!==null&&typeof x.componentDidCatch=="function"&&(ti===null||!ti.has(x))))return h.flags|=65536,y&=-y,h.lanes|=y,y=fb(y),hb(y,o,h,p),Cd(h,y),!1}h=h.return}while(h!==null);return!1}var db=Error(r(461)),tn=!1;function fn(o,s,h,p){s.child=o===null?rb(s,null,h,p):jo(s,o.child,h,p)}function pb(o,s,h,p,y){h=h.render;var x=s.ref;if("ref"in p){var T={};for(var O in p)O!=="ref"&&(T[O]=p[O])}else T=p;return ji(s),p=kd(o,s,h,T,x,y),O=Od(),o!==null&&!tn?(Nd(o,s,y),ga(o,s,y)):(lt&&O&&dd(s),s.flags|=1,fn(o,s,p,y),s.child)}function vb(o,s,h,p,y){if(o===null){var x=h.type;return typeof x=="function"&&!cd(x)&&x.defaultProps===void 0&&h.compare===null?(s.tag=15,s.type=x,mb(o,s,x,p,y)):(o=Xl(h.type,null,p,s,s.mode,y),o.ref=s.ref,o.return=s,s.child=o)}if(x=o.child,!tp(o,y)){var T=x.memoizedProps;if(h=h.compare,h=h!==null?h:eu,h(T,p)&&o.ref===s.ref)return ga(o,s,y)}return s.flags|=1,o=ca(x,p),o.ref=s.ref,o.return=s,s.child=o}function mb(o,s,h,p,y){if(o!==null){var x=o.memoizedProps;if(eu(x,p)&&o.ref===s.ref)if(tn=!1,s.pendingProps=p=x,tp(o,y))(o.flags&131072)!==0&&(tn=!0);else return s.lanes=o.lanes,ga(o,s,y)}return Xd(o,s,h,p,y)}function gb(o,s,h){var p=s.pendingProps,y=p.children,x=o!==null?o.memoizedState:null;if(p.mode==="hidden"){if((s.flags&128)!==0){if(p=x!==null?x.baseLanes|h:h,o!==null){for(y=s.child=o.child,x=0;y!==null;)x=x|y.lanes|y.childLanes,y=y.sibling;s.childLanes=x&~p}else s.childLanes=0,s.child=null;return yb(o,s,p,h)}if((h&536870912)!==0)s.memoizedState={baseLanes:0,cachePool:null},o!==null&&Jl(s,x!==null?x.cachePool:null),x!==null?m0(s,x):Ad(),ab(s);else return s.lanes=s.childLanes=536870912,yb(o,s,x!==null?x.baseLanes|h:h,h)}else x!==null?(Jl(s,x.cachePool),m0(s,x),$a(),s.memoizedState=null):(o!==null&&Jl(s,null),Ad(),$a());return fn(o,s,y,h),s.child}function yb(o,s,h,p){var y=wd();return y=y===null?null:{parent:jt._currentValue,pool:y},s.memoizedState={baseLanes:h,cachePool:y},o!==null&&Jl(s,null),Ad(),ab(s),o!==null&&iu(o,s,p,!0),null}function mc(o,s){var h=s.ref;if(h===null)o!==null&&o.ref!==null&&(s.flags|=4194816);else{if(typeof h!="function"&&typeof h!="object")throw Error(r(284));(o===null||o.ref!==h)&&(s.flags|=4194816)}}function Xd(o,s,h,p,y){return ji(s),h=kd(o,s,h,p,void 0,y),p=Od(),o!==null&&!tn?(Nd(o,s,y),ga(o,s,y)):(lt&&p&&dd(s),s.flags|=1,fn(o,s,h,y),s.child)}function bb(o,s,h,p,y,x){return ji(s),s.updateQueue=null,h=y0(s,p,h,y),g0(o),p=Od(),o!==null&&!tn?(Nd(o,s,x),ga(o,s,x)):(lt&&p&&dd(s),s.flags|=1,fn(o,s,h,x),s.child)}function xb(o,s,h,p,y){if(ji(s),s.stateNode===null){var x=Mo,T=h.contextType;typeof T=="object"&&T!==null&&(x=bn(T)),x=new h(p,x),s.memoizedState=x.state!==null&&x.state!==void 0?x.state:null,x.updater=qd,s.stateNode=x,x._reactInternals=s,x=s.stateNode,x.props=p,x.state=s.memoizedState,x.refs={},Sd(s),T=h.contextType,x.context=typeof T=="object"&&T!==null?bn(T):Mo,x.state=s.memoizedState,T=h.getDerivedStateFromProps,typeof T=="function"&&(Gd(s,h,T,p),x.state=s.memoizedState),typeof h.getDerivedStateFromProps=="function"||typeof x.getSnapshotBeforeUpdate=="function"||typeof x.UNSAFE_componentWillMount!="function"&&typeof x.componentWillMount!="function"||(T=x.state,typeof x.componentWillMount=="function"&&x.componentWillMount(),typeof x.UNSAFE_componentWillMount=="function"&&x.UNSAFE_componentWillMount(),T!==x.state&&qd.enqueueReplaceState(x,x.state,null),hu(s,p,x,y),fu(),x.state=s.memoizedState),typeof x.componentDidMount=="function"&&(s.flags|=4194308),p=!0}else if(o===null){x=s.stateNode;var O=s.memoizedProps,z=qi(h,O);x.props=z;var Q=x.context,le=h.contextType;T=Mo,typeof le=="object"&&le!==null&&(T=bn(le));var fe=h.getDerivedStateFromProps;le=typeof fe=="function"||typeof x.getSnapshotBeforeUpdate=="function",O=s.pendingProps!==O,le||typeof x.UNSAFE_componentWillReceiveProps!="function"&&typeof x.componentWillReceiveProps!="function"||(O||Q!==T)&&ob(s,x,p,T),Wa=!1;var Z=s.memoizedState;x.state=Z,hu(s,p,x,y),fu(),Q=s.memoizedState,O||Z!==Q||Wa?(typeof fe=="function"&&(Gd(s,h,fe,p),Q=s.memoizedState),(z=Wa||ib(s,h,z,p,Z,Q,T))?(le||typeof x.UNSAFE_componentWillMount!="function"&&typeof x.componentWillMount!="function"||(typeof x.componentWillMount=="function"&&x.componentWillMount(),typeof x.UNSAFE_componentWillMount=="function"&&x.UNSAFE_componentWillMount()),typeof x.componentDidMount=="function"&&(s.flags|=4194308)):(typeof x.componentDidMount=="function"&&(s.flags|=4194308),s.memoizedProps=p,s.memoizedState=Q),x.props=p,x.state=Q,x.context=T,p=z):(typeof x.componentDidMount=="function"&&(s.flags|=4194308),p=!1)}else{x=s.stateNode,Ed(o,s),T=s.memoizedProps,le=qi(h,T),x.props=le,fe=s.pendingProps,Z=x.context,Q=h.contextType,z=Mo,typeof Q=="object"&&Q!==null&&(z=bn(Q)),O=h.getDerivedStateFromProps,(Q=typeof O=="function"||typeof x.getSnapshotBeforeUpdate=="function")||typeof x.UNSAFE_componentWillReceiveProps!="function"&&typeof x.componentWillReceiveProps!="function"||(T!==fe||Z!==z)&&ob(s,x,p,z),Wa=!1,Z=s.memoizedState,x.state=Z,hu(s,p,x,y),fu();var re=s.memoizedState;T!==fe||Z!==re||Wa||o!==null&&o.dependencies!==null&&Ql(o.dependencies)?(typeof O=="function"&&(Gd(s,h,O,p),re=s.memoizedState),(le=Wa||ib(s,h,le,p,Z,re,z)||o!==null&&o.dependencies!==null&&Ql(o.dependencies))?(Q||typeof x.UNSAFE_componentWillUpdate!="function"&&typeof x.componentWillUpdate!="function"||(typeof x.componentWillUpdate=="function"&&x.componentWillUpdate(p,re,z),typeof x.UNSAFE_componentWillUpdate=="function"&&x.UNSAFE_componentWillUpdate(p,re,z)),typeof x.componentDidUpdate=="function"&&(s.flags|=4),typeof x.getSnapshotBeforeUpdate=="function"&&(s.flags|=1024)):(typeof x.componentDidUpdate!="function"||T===o.memoizedProps&&Z===o.memoizedState||(s.flags|=4),typeof x.getSnapshotBeforeUpdate!="function"||T===o.memoizedProps&&Z===o.memoizedState||(s.flags|=1024),s.memoizedProps=p,s.memoizedState=re),x.props=p,x.state=re,x.context=z,p=le):(typeof x.componentDidUpdate!="function"||T===o.memoizedProps&&Z===o.memoizedState||(s.flags|=4),typeof x.getSnapshotBeforeUpdate!="function"||T===o.memoizedProps&&Z===o.memoizedState||(s.flags|=1024),p=!1)}return x=p,mc(o,s),p=(s.flags&128)!==0,x||p?(x=s.stateNode,h=p&&typeof h.getDerivedStateFromError!="function"?null:x.render(),s.flags|=1,o!==null&&p?(s.child=jo(s,o.child,null,y),s.child=jo(s,null,h,y)):fn(o,s,h,y),s.memoizedState=x.state,o=s.child):o=ga(o,s,y),o}function wb(o,s,h,p){return ru(),s.flags|=256,fn(o,s,h,p),s.child}var $d={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Yd(o){return{baseLanes:o,cachePool:u0()}}function Qd(o,s,h){return o=o!==null?o.childLanes&~h:0,s&&(o|=dr),o}function _b(o,s,h){var p=s.pendingProps,y=!1,x=(s.flags&128)!==0,T;if((T=x)||(T=o!==null&&o.memoizedState===null?!1:(Wt.current&2)!==0),T&&(y=!0,s.flags&=-129),T=(s.flags&32)!==0,s.flags&=-33,o===null){if(lt){if(y?Xa(s):$a(),lt){var O=kt,z;if(z=O){e:{for(z=O,O=Br;z.nodeType!==8;){if(!O){O=null;break e}if(z=Rr(z.nextSibling),z===null){O=null;break e}}O=z}O!==null?(s.memoizedState={dehydrated:O,treeContext:Pi!==null?{id:fa,overflow:ha}:null,retryLane:536870912,hydrationErrors:null},z=jn(18,null,null,0),z.stateNode=O,z.return=s,s.child=z,An=s,kt=null,z=!0):z=!1}z||Vi(s)}if(O=s.memoizedState,O!==null&&(O=O.dehydrated,O!==null))return Ip(O)?s.lanes=32:s.lanes=536870912,null;ma(s)}return O=p.children,p=p.fallback,y?($a(),y=s.mode,O=gc({mode:"hidden",children:O},y),p=Li(p,y,h,null),O.return=s,p.return=s,O.sibling=p,s.child=O,y=s.child,y.memoizedState=Yd(h),y.childLanes=Qd(o,T,h),s.memoizedState=$d,p):(Xa(s),Zd(s,O))}if(z=o.memoizedState,z!==null&&(O=z.dehydrated,O!==null)){if(x)s.flags&256?(Xa(s),s.flags&=-257,s=Jd(o,s,h)):s.memoizedState!==null?($a(),s.child=o.child,s.flags|=128,s=null):($a(),y=p.fallback,O=s.mode,p=gc({mode:"visible",children:p.children},O),y=Li(y,O,h,null),y.flags|=2,p.return=s,y.return=s,p.sibling=y,s.child=p,jo(s,o.child,null,h),p=s.child,p.memoizedState=Yd(h),p.childLanes=Qd(o,T,h),s.memoizedState=$d,s=y);else if(Xa(s),Ip(O)){if(T=O.nextSibling&&O.nextSibling.dataset,T)var Q=T.dgst;T=Q,p=Error(r(419)),p.stack="",p.digest=T,au({value:p,source:null,stack:null}),s=Jd(o,s,h)}else if(tn||iu(o,s,h,!1),T=(h&o.childLanes)!==0,tn||T){if(T=xt,T!==null&&(p=h&-h,p=(p&42)!==0?1:Fh(p),p=(p&(T.suspendedLanes|h))!==0?0:p,p!==0&&p!==z.retryLane))throw z.retryLane=p,No(o,p),Xn(T,o,p),db;O.data==="$?"||gp(),s=Jd(o,s,h)}else O.data==="$?"?(s.flags|=192,s.child=o.child,s=null):(o=z.treeContext,kt=Rr(O.nextSibling),An=s,lt=!0,Ui=null,Br=!1,o!==null&&(cr[fr++]=fa,cr[fr++]=ha,cr[fr++]=Pi,fa=o.id,ha=o.overflow,Pi=s),s=Zd(s,p.children),s.flags|=4096);return s}return y?($a(),y=p.fallback,O=s.mode,z=o.child,Q=z.sibling,p=ca(z,{mode:"hidden",children:p.children}),p.subtreeFlags=z.subtreeFlags&65011712,Q!==null?y=ca(Q,y):(y=Li(y,O,h,null),y.flags|=2),y.return=s,p.return=s,p.sibling=y,s.child=p,p=y,y=s.child,O=o.child.memoizedState,O===null?O=Yd(h):(z=O.cachePool,z!==null?(Q=jt._currentValue,z=z.parent!==Q?{parent:Q,pool:Q}:z):z=u0(),O={baseLanes:O.baseLanes|h,cachePool:z}),y.memoizedState=O,y.childLanes=Qd(o,T,h),s.memoizedState=$d,p):(Xa(s),h=o.child,o=h.sibling,h=ca(h,{mode:"visible",children:p.children}),h.return=s,h.sibling=null,o!==null&&(T=s.deletions,T===null?(s.deletions=[o],s.flags|=16):T.push(o)),s.child=h,s.memoizedState=null,h)}function Zd(o,s){return s=gc({mode:"visible",children:s},o.mode),s.return=o,o.child=s}function gc(o,s){return o=jn(22,o,null,s),o.lanes=0,o.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},o}function Jd(o,s,h){return jo(s,o.child,null,h),o=Zd(s,s.pendingProps.children),o.flags|=2,s.memoizedState=null,o}function Sb(o,s,h){o.lanes|=s;var p=o.alternate;p!==null&&(p.lanes|=s),gd(o.return,s,h)}function ep(o,s,h,p,y){var x=o.memoizedState;x===null?o.memoizedState={isBackwards:s,rendering:null,renderingStartTime:0,last:p,tail:h,tailMode:y}:(x.isBackwards=s,x.rendering=null,x.renderingStartTime=0,x.last=p,x.tail=h,x.tailMode=y)}function Eb(o,s,h){var p=s.pendingProps,y=p.revealOrder,x=p.tail;if(fn(o,s,p.children,h),p=Wt.current,(p&2)!==0)p=p&1|2,s.flags|=128;else{if(o!==null&&(o.flags&128)!==0)e:for(o=s.child;o!==null;){if(o.tag===13)o.memoizedState!==null&&Sb(o,h,s);else if(o.tag===19)Sb(o,h,s);else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===s)break e;for(;o.sibling===null;){if(o.return===null||o.return===s)break e;o=o.return}o.sibling.return=o.return,o=o.sibling}p&=1}switch(oe(Wt,p),y){case"forwards":for(h=s.child,y=null;h!==null;)o=h.alternate,o!==null&&dc(o)===null&&(y=h),h=h.sibling;h=y,h===null?(y=s.child,s.child=null):(y=h.sibling,h.sibling=null),ep(s,!1,y,h,x);break;case"backwards":for(h=null,y=s.child,s.child=null;y!==null;){if(o=y.alternate,o!==null&&dc(o)===null){s.child=y;break}o=y.sibling,y.sibling=h,h=y,y=o}ep(s,!0,h,null,x);break;case"together":ep(s,!1,null,null,void 0);break;default:s.memoizedState=null}return s.child}function ga(o,s,h){if(o!==null&&(s.dependencies=o.dependencies),ei|=s.lanes,(h&s.childLanes)===0)if(o!==null){if(iu(o,s,h,!1),(h&s.childLanes)===0)return null}else return null;if(o!==null&&s.child!==o.child)throw Error(r(153));if(s.child!==null){for(o=s.child,h=ca(o,o.pendingProps),s.child=h,h.return=s;o.sibling!==null;)o=o.sibling,h=h.sibling=ca(o,o.pendingProps),h.return=s;h.sibling=null}return s.child}function tp(o,s){return(o.lanes&s)!==0?!0:(o=o.dependencies,!!(o!==null&&Ql(o)))}function hR(o,s,h){switch(s.tag){case 3:ye(s,s.stateNode.containerInfo),ja(s,jt,o.memoizedState.cache),ru();break;case 27:case 5:at(s);break;case 4:ye(s,s.stateNode.containerInfo);break;case 10:ja(s,s.type,s.memoizedProps.value);break;case 13:var p=s.memoizedState;if(p!==null)return p.dehydrated!==null?(Xa(s),s.flags|=128,null):(h&s.child.childLanes)!==0?_b(o,s,h):(Xa(s),o=ga(o,s,h),o!==null?o.sibling:null);Xa(s);break;case 19:var y=(o.flags&128)!==0;if(p=(h&s.childLanes)!==0,p||(iu(o,s,h,!1),p=(h&s.childLanes)!==0),y){if(p)return Eb(o,s,h);s.flags|=128}if(y=s.memoizedState,y!==null&&(y.rendering=null,y.tail=null,y.lastEffect=null),oe(Wt,Wt.current),p)break;return null;case 22:case 23:return s.lanes=0,gb(o,s,h);case 24:ja(s,jt,o.memoizedState.cache)}return ga(o,s,h)}function Cb(o,s,h){if(o!==null)if(o.memoizedProps!==s.pendingProps)tn=!0;else{if(!tp(o,h)&&(s.flags&128)===0)return tn=!1,hR(o,s,h);tn=(o.flags&131072)!==0}else tn=!1,lt&&(s.flags&1048576)!==0&&t0(s,Yl,s.index);switch(s.lanes=0,s.tag){case 16:e:{o=s.pendingProps;var p=s.elementType,y=p._init;if(p=y(p._payload),s.type=p,typeof p=="function")cd(p)?(o=qi(p,o),s.tag=1,s=xb(null,s,p,o,h)):(s.tag=0,s=Xd(null,s,p,o,h));else{if(p!=null){if(y=p.$$typeof,y===C){s.tag=11,s=pb(null,s,p,o,h);break e}else if(y===k){s.tag=14,s=vb(null,s,p,o,h);break e}}throw s=ee(p)||p,Error(r(306,s,""))}}return s;case 0:return Xd(o,s,s.type,s.pendingProps,h);case 1:return p=s.type,y=qi(p,s.pendingProps),xb(o,s,p,y,h);case 3:e:{if(ye(s,s.stateNode.containerInfo),o===null)throw Error(r(387));p=s.pendingProps;var x=s.memoizedState;y=x.element,Ed(o,s),hu(s,p,null,h);var T=s.memoizedState;if(p=T.cache,ja(s,jt,p),p!==x.cache&&yd(s,[jt],h,!0),fu(),p=T.element,x.isDehydrated)if(x={element:p,isDehydrated:!1,cache:T.cache},s.updateQueue.baseState=x,s.memoizedState=x,s.flags&256){s=wb(o,s,p,h);break e}else if(p!==y){y=ur(Error(r(424)),s),au(y),s=wb(o,s,p,h);break e}else{switch(o=s.stateNode.containerInfo,o.nodeType){case 9:o=o.body;break;default:o=o.nodeName==="HTML"?o.ownerDocument.body:o}for(kt=Rr(o.firstChild),An=s,lt=!0,Ui=null,Br=!0,h=rb(s,null,p,h),s.child=h;h;)h.flags=h.flags&-3|4096,h=h.sibling}else{if(ru(),p===y){s=ga(o,s,h);break e}fn(o,s,p,h)}s=s.child}return s;case 26:return mc(o,s),o===null?(h=D1(s.type,null,s.pendingProps,null))?s.memoizedState=h:lt||(h=s.type,o=s.pendingProps,p=Oc(pe.current).createElement(h),p[yn]=s,p[On]=o,dn(p,h,o),en(p),s.stateNode=p):s.memoizedState=D1(s.type,o.memoizedProps,s.pendingProps,o.memoizedState),null;case 27:return at(s),o===null&&lt&&(p=s.stateNode=R1(s.type,s.pendingProps,pe.current),An=s,Br=!0,y=kt,ai(s.type)?(Fp=y,kt=Rr(p.firstChild)):kt=y),fn(o,s,s.pendingProps.children,h),mc(o,s),o===null&&(s.flags|=4194304),s.child;case 5:return o===null&&lt&&((y=p=kt)&&(p=UR(p,s.type,s.pendingProps,Br),p!==null?(s.stateNode=p,An=s,kt=Rr(p.firstChild),Br=!1,y=!0):y=!1),y||Vi(s)),at(s),y=s.type,x=s.pendingProps,T=o!==null?o.memoizedProps:null,p=x.children,Op(y,x)?p=null:T!==null&&Op(y,T)&&(s.flags|=32),s.memoizedState!==null&&(y=kd(o,s,aR,null,null,h),Iu._currentValue=y),mc(o,s),fn(o,s,p,h),s.child;case 6:return o===null&&lt&&((o=h=kt)&&(h=VR(h,s.pendingProps,Br),h!==null?(s.stateNode=h,An=s,kt=null,o=!0):o=!1),o||Vi(s)),null;case 13:return _b(o,s,h);case 4:return ye(s,s.stateNode.containerInfo),p=s.pendingProps,o===null?s.child=jo(s,null,p,h):fn(o,s,p,h),s.child;case 11:return pb(o,s,s.type,s.pendingProps,h);case 7:return fn(o,s,s.pendingProps,h),s.child;case 8:return fn(o,s,s.pendingProps.children,h),s.child;case 12:return fn(o,s,s.pendingProps.children,h),s.child;case 10:return p=s.pendingProps,ja(s,s.type,p.value),fn(o,s,p.children,h),s.child;case 9:return y=s.type._context,p=s.pendingProps.children,ji(s),y=bn(y),p=p(y),s.flags|=1,fn(o,s,p,h),s.child;case 14:return vb(o,s,s.type,s.pendingProps,h);case 15:return mb(o,s,s.type,s.pendingProps,h);case 19:return Eb(o,s,h);case 31:return p=s.pendingProps,h=s.mode,p={mode:p.mode,children:p.children},o===null?(h=gc(p,h),h.ref=s.ref,s.child=h,h.return=s,s=h):(h=ca(o.child,p),h.ref=s.ref,s.child=h,h.return=s,s=h),s;case 22:return gb(o,s,h);case 24:return ji(s),p=bn(jt),o===null?(y=wd(),y===null&&(y=xt,x=bd(),y.pooledCache=x,x.refCount++,x!==null&&(y.pooledCacheLanes|=h),y=x),s.memoizedState={parent:p,cache:y},Sd(s),ja(s,jt,y)):((o.lanes&h)!==0&&(Ed(o,s),hu(s,null,null,h),fu()),y=o.memoizedState,x=s.memoizedState,y.parent!==p?(y={parent:p,cache:p},s.memoizedState=y,s.lanes===0&&(s.memoizedState=s.updateQueue.baseState=y),ja(s,jt,p)):(p=x.cache,ja(s,jt,p),p!==y.cache&&yd(s,[jt],h,!0))),fn(o,s,s.pendingProps.children,h),s.child;case 29:throw s.pendingProps}throw Error(r(156,s.tag))}function ya(o){o.flags|=4}function Rb(o,s){if(s.type!=="stylesheet"||(s.state.loading&4)!==0)o.flags&=-16777217;else if(o.flags|=16777216,!I1(s)){if(s=hr.current,s!==null&&((tt&4194048)===tt?Lr!==null:(tt&62914560)!==tt&&(tt&536870912)===0||s!==Lr))throw lu=_d,l0;o.flags|=8192}}function yc(o,s){s!==null&&(o.flags|=4),o.flags&16384&&(s=o.tag!==22?ay():536870912,o.lanes|=s,Ko|=s)}function bu(o,s){if(!lt)switch(o.tailMode){case"hidden":s=o.tail;for(var h=null;s!==null;)s.alternate!==null&&(h=s),s=s.sibling;h===null?o.tail=null:h.sibling=null;break;case"collapsed":h=o.tail;for(var p=null;h!==null;)h.alternate!==null&&(p=h),h=h.sibling;p===null?s||o.tail===null?o.tail=null:o.tail.sibling=null:p.sibling=null}}function Ct(o){var s=o.alternate!==null&&o.alternate.child===o.child,h=0,p=0;if(s)for(var y=o.child;y!==null;)h|=y.lanes|y.childLanes,p|=y.subtreeFlags&65011712,p|=y.flags&65011712,y.return=o,y=y.sibling;else for(y=o.child;y!==null;)h|=y.lanes|y.childLanes,p|=y.subtreeFlags,p|=y.flags,y.return=o,y=y.sibling;return o.subtreeFlags|=p,o.childLanes=h,s}function dR(o,s,h){var p=s.pendingProps;switch(pd(s),s.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ct(s),null;case 1:return Ct(s),null;case 3:return h=s.stateNode,p=null,o!==null&&(p=o.memoizedState.cache),s.memoizedState.cache!==p&&(s.flags|=2048),pa(jt),Ne(),h.pendingContext&&(h.context=h.pendingContext,h.pendingContext=null),(o===null||o.child===null)&&(nu(s)?ya(s):o===null||o.memoizedState.isDehydrated&&(s.flags&256)===0||(s.flags|=1024,a0())),Ct(s),null;case 26:return h=s.memoizedState,o===null?(ya(s),h!==null?(Ct(s),Rb(s,h)):(Ct(s),s.flags&=-16777217)):h?h!==o.memoizedState?(ya(s),Ct(s),Rb(s,h)):(Ct(s),s.flags&=-16777217):(o.memoizedProps!==p&&ya(s),Ct(s),s.flags&=-16777217),null;case 27:Fe(s),h=pe.current;var y=s.type;if(o!==null&&s.stateNode!=null)o.memoizedProps!==p&&ya(s);else{if(!p){if(s.stateNode===null)throw Error(r(166));return Ct(s),null}o=de.current,nu(s)?n0(s):(o=R1(y,p,h),s.stateNode=o,ya(s))}return Ct(s),null;case 5:if(Fe(s),h=s.type,o!==null&&s.stateNode!=null)o.memoizedProps!==p&&ya(s);else{if(!p){if(s.stateNode===null)throw Error(r(166));return Ct(s),null}if(o=de.current,nu(s))n0(s);else{switch(y=Oc(pe.current),o){case 1:o=y.createElementNS("http://www.w3.org/2000/svg",h);break;case 2:o=y.createElementNS("http://www.w3.org/1998/Math/MathML",h);break;default:switch(h){case"svg":o=y.createElementNS("http://www.w3.org/2000/svg",h);break;case"math":o=y.createElementNS("http://www.w3.org/1998/Math/MathML",h);break;case"script":o=y.createElement("div"),o.innerHTML="<script><\/script>",o=o.removeChild(o.firstChild);break;case"select":o=typeof p.is=="string"?y.createElement("select",{is:p.is}):y.createElement("select"),p.multiple?o.multiple=!0:p.size&&(o.size=p.size);break;default:o=typeof p.is=="string"?y.createElement(h,{is:p.is}):y.createElement(h)}}o[yn]=s,o[On]=p;e:for(y=s.child;y!==null;){if(y.tag===5||y.tag===6)o.appendChild(y.stateNode);else if(y.tag!==4&&y.tag!==27&&y.child!==null){y.child.return=y,y=y.child;continue}if(y===s)break e;for(;y.sibling===null;){if(y.return===null||y.return===s)break e;y=y.return}y.sibling.return=y.return,y=y.sibling}s.stateNode=o;e:switch(dn(o,h,p),h){case"button":case"input":case"select":case"textarea":o=!!p.autoFocus;break e;case"img":o=!0;break e;default:o=!1}o&&ya(s)}}return Ct(s),s.flags&=-16777217,null;case 6:if(o&&s.stateNode!=null)o.memoizedProps!==p&&ya(s);else{if(typeof p!="string"&&s.stateNode===null)throw Error(r(166));if(o=pe.current,nu(s)){if(o=s.stateNode,h=s.memoizedProps,p=null,y=An,y!==null)switch(y.tag){case 27:case 5:p=y.memoizedProps}o[yn]=s,o=!!(o.nodeValue===h||p!==null&&p.suppressHydrationWarning===!0||b1(o.nodeValue,h)),o||Vi(s)}else o=Oc(o).createTextNode(p),o[yn]=s,s.stateNode=o}return Ct(s),null;case 13:if(p=s.memoizedState,o===null||o.memoizedState!==null&&o.memoizedState.dehydrated!==null){if(y=nu(s),p!==null&&p.dehydrated!==null){if(o===null){if(!y)throw Error(r(318));if(y=s.memoizedState,y=y!==null?y.dehydrated:null,!y)throw Error(r(317));y[yn]=s}else ru(),(s.flags&128)===0&&(s.memoizedState=null),s.flags|=4;Ct(s),y=!1}else y=a0(),o!==null&&o.memoizedState!==null&&(o.memoizedState.hydrationErrors=y),y=!0;if(!y)return s.flags&256?(ma(s),s):(ma(s),null)}if(ma(s),(s.flags&128)!==0)return s.lanes=h,s;if(h=p!==null,o=o!==null&&o.memoizedState!==null,h){p=s.child,y=null,p.alternate!==null&&p.alternate.memoizedState!==null&&p.alternate.memoizedState.cachePool!==null&&(y=p.alternate.memoizedState.cachePool.pool);var x=null;p.memoizedState!==null&&p.memoizedState.cachePool!==null&&(x=p.memoizedState.cachePool.pool),x!==y&&(p.flags|=2048)}return h!==o&&h&&(s.child.flags|=8192),yc(s,s.updateQueue),Ct(s),null;case 4:return Ne(),o===null&&Rp(s.stateNode.containerInfo),Ct(s),null;case 10:return pa(s.type),Ct(s),null;case 19:if(ie(Wt),y=s.memoizedState,y===null)return Ct(s),null;if(p=(s.flags&128)!==0,x=y.rendering,x===null)if(p)bu(y,!1);else{if(Ot!==0||o!==null&&(o.flags&128)!==0)for(o=s.child;o!==null;){if(x=dc(o),x!==null){for(s.flags|=128,bu(y,!1),o=x.updateQueue,s.updateQueue=o,yc(s,o),s.subtreeFlags=0,o=h,h=s.child;h!==null;)e0(h,o),h=h.sibling;return oe(Wt,Wt.current&1|2),s.child}o=o.sibling}y.tail!==null&&Mt()>wc&&(s.flags|=128,p=!0,bu(y,!1),s.lanes=4194304)}else{if(!p)if(o=dc(x),o!==null){if(s.flags|=128,p=!0,o=o.updateQueue,s.updateQueue=o,yc(s,o),bu(y,!0),y.tail===null&&y.tailMode==="hidden"&&!x.alternate&&!lt)return Ct(s),null}else 2*Mt()-y.renderingStartTime>wc&&h!==536870912&&(s.flags|=128,p=!0,bu(y,!1),s.lanes=4194304);y.isBackwards?(x.sibling=s.child,s.child=x):(o=y.last,o!==null?o.sibling=x:s.child=x,y.last=x)}return y.tail!==null?(s=y.tail,y.rendering=s,y.tail=s.sibling,y.renderingStartTime=Mt(),s.sibling=null,o=Wt.current,oe(Wt,p?o&1|2:o&1),s):(Ct(s),null);case 22:case 23:return ma(s),Td(),p=s.memoizedState!==null,o!==null?o.memoizedState!==null!==p&&(s.flags|=8192):p&&(s.flags|=8192),p?(h&536870912)!==0&&(s.flags&128)===0&&(Ct(s),s.subtreeFlags&6&&(s.flags|=8192)):Ct(s),h=s.updateQueue,h!==null&&yc(s,h.retryQueue),h=null,o!==null&&o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(h=o.memoizedState.cachePool.pool),p=null,s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(p=s.memoizedState.cachePool.pool),p!==h&&(s.flags|=2048),o!==null&&ie(Wi),null;case 24:return h=null,o!==null&&(h=o.memoizedState.cache),s.memoizedState.cache!==h&&(s.flags|=2048),pa(jt),Ct(s),null;case 25:return null;case 30:return null}throw Error(r(156,s.tag))}function pR(o,s){switch(pd(s),s.tag){case 1:return o=s.flags,o&65536?(s.flags=o&-65537|128,s):null;case 3:return pa(jt),Ne(),o=s.flags,(o&65536)!==0&&(o&128)===0?(s.flags=o&-65537|128,s):null;case 26:case 27:case 5:return Fe(s),null;case 13:if(ma(s),o=s.memoizedState,o!==null&&o.dehydrated!==null){if(s.alternate===null)throw Error(r(340));ru()}return o=s.flags,o&65536?(s.flags=o&-65537|128,s):null;case 19:return ie(Wt),null;case 4:return Ne(),null;case 10:return pa(s.type),null;case 22:case 23:return ma(s),Td(),o!==null&&ie(Wi),o=s.flags,o&65536?(s.flags=o&-65537|128,s):null;case 24:return pa(jt),null;case 25:return null;default:return null}}function Ab(o,s){switch(pd(s),s.tag){case 3:pa(jt),Ne();break;case 26:case 27:case 5:Fe(s);break;case 4:Ne();break;case 13:ma(s);break;case 19:ie(Wt);break;case 10:pa(s.type);break;case 22:case 23:ma(s),Td(),o!==null&&ie(Wi);break;case 24:pa(jt)}}function xu(o,s){try{var h=s.updateQueue,p=h!==null?h.lastEffect:null;if(p!==null){var y=p.next;h=y;do{if((h.tag&o)===o){p=void 0;var x=h.create,T=h.inst;p=x(),T.destroy=p}h=h.next}while(h!==y)}}catch(O){bt(s,s.return,O)}}function Ya(o,s,h){try{var p=s.updateQueue,y=p!==null?p.lastEffect:null;if(y!==null){var x=y.next;p=x;do{if((p.tag&o)===o){var T=p.inst,O=T.destroy;if(O!==void 0){T.destroy=void 0,y=s;var z=h,Q=O;try{Q()}catch(le){bt(y,z,le)}}}p=p.next}while(p!==x)}}catch(le){bt(s,s.return,le)}}function Tb(o){var s=o.updateQueue;if(s!==null){var h=o.stateNode;try{v0(s,h)}catch(p){bt(o,o.return,p)}}}function Db(o,s,h){h.props=qi(o.type,o.memoizedProps),h.state=o.memoizedState;try{h.componentWillUnmount()}catch(p){bt(o,s,p)}}function wu(o,s){try{var h=o.ref;if(h!==null){switch(o.tag){case 26:case 27:case 5:var p=o.stateNode;break;case 30:p=o.stateNode;break;default:p=o.stateNode}typeof h=="function"?o.refCleanup=h(p):h.current=p}}catch(y){bt(o,s,y)}}function Pr(o,s){var h=o.ref,p=o.refCleanup;if(h!==null)if(typeof p=="function")try{p()}catch(y){bt(o,s,y)}finally{o.refCleanup=null,o=o.alternate,o!=null&&(o.refCleanup=null)}else if(typeof h=="function")try{h(null)}catch(y){bt(o,s,y)}else h.current=null}function kb(o){var s=o.type,h=o.memoizedProps,p=o.stateNode;try{e:switch(s){case"button":case"input":case"select":case"textarea":h.autoFocus&&p.focus();break e;case"img":h.src?p.src=h.src:h.srcSet&&(p.srcset=h.srcSet)}}catch(y){bt(o,o.return,y)}}function np(o,s,h){try{var p=o.stateNode;FR(p,o.type,h,s),p[On]=s}catch(y){bt(o,o.return,y)}}function Ob(o){return o.tag===5||o.tag===3||o.tag===26||o.tag===27&&ai(o.type)||o.tag===4}function rp(o){e:for(;;){for(;o.sibling===null;){if(o.return===null||Ob(o.return))return null;o=o.return}for(o.sibling.return=o.return,o=o.sibling;o.tag!==5&&o.tag!==6&&o.tag!==18;){if(o.tag===27&&ai(o.type)||o.flags&2||o.child===null||o.tag===4)continue e;o.child.return=o,o=o.child}if(!(o.flags&2))return o.stateNode}}function ap(o,s,h){var p=o.tag;if(p===5||p===6)o=o.stateNode,s?(h.nodeType===9?h.body:h.nodeName==="HTML"?h.ownerDocument.body:h).insertBefore(o,s):(s=h.nodeType===9?h.body:h.nodeName==="HTML"?h.ownerDocument.body:h,s.appendChild(o),h=h._reactRootContainer,h!=null||s.onclick!==null||(s.onclick=kc));else if(p!==4&&(p===27&&ai(o.type)&&(h=o.stateNode,s=null),o=o.child,o!==null))for(ap(o,s,h),o=o.sibling;o!==null;)ap(o,s,h),o=o.sibling}function bc(o,s,h){var p=o.tag;if(p===5||p===6)o=o.stateNode,s?h.insertBefore(o,s):h.appendChild(o);else if(p!==4&&(p===27&&ai(o.type)&&(h=o.stateNode),o=o.child,o!==null))for(bc(o,s,h),o=o.sibling;o!==null;)bc(o,s,h),o=o.sibling}function Nb(o){var s=o.stateNode,h=o.memoizedProps;try{for(var p=o.type,y=s.attributes;y.length;)s.removeAttributeNode(y[0]);dn(s,p,h),s[yn]=o,s[On]=h}catch(x){bt(o,o.return,x)}}var ba=!1,Ft=!1,ip=!1,Mb=typeof WeakSet=="function"?WeakSet:Set,nn=null;function vR(o,s){if(o=o.containerInfo,Dp=Lc,o=Wy(o),rd(o)){if("selectionStart"in o)var h={start:o.selectionStart,end:o.selectionEnd};else e:{h=(h=o.ownerDocument)&&h.defaultView||window;var p=h.getSelection&&h.getSelection();if(p&&p.rangeCount!==0){h=p.anchorNode;var y=p.anchorOffset,x=p.focusNode;p=p.focusOffset;try{h.nodeType,x.nodeType}catch{h=null;break e}var T=0,O=-1,z=-1,Q=0,le=0,fe=o,Z=null;t:for(;;){for(var re;fe!==h||y!==0&&fe.nodeType!==3||(O=T+y),fe!==x||p!==0&&fe.nodeType!==3||(z=T+p),fe.nodeType===3&&(T+=fe.nodeValue.length),(re=fe.firstChild)!==null;)Z=fe,fe=re;for(;;){if(fe===o)break t;if(Z===h&&++Q===y&&(O=T),Z===x&&++le===p&&(z=T),(re=fe.nextSibling)!==null)break;fe=Z,Z=fe.parentNode}fe=re}h=O===-1||z===-1?null:{start:O,end:z}}else h=null}h=h||{start:0,end:0}}else h=null;for(kp={focusedElem:o,selectionRange:h},Lc=!1,nn=s;nn!==null;)if(s=nn,o=s.child,(s.subtreeFlags&1024)!==0&&o!==null)o.return=s,nn=o;else for(;nn!==null;){switch(s=nn,x=s.alternate,o=s.flags,s.tag){case 0:break;case 11:case 15:break;case 1:if((o&1024)!==0&&x!==null){o=void 0,h=s,y=x.memoizedProps,x=x.memoizedState,p=h.stateNode;try{var Be=qi(h.type,y,h.elementType===h.type);o=p.getSnapshotBeforeUpdate(Be,x),p.__reactInternalSnapshotBeforeUpdate=o}catch(Me){bt(h,h.return,Me)}}break;case 3:if((o&1024)!==0){if(o=s.stateNode.containerInfo,h=o.nodeType,h===9)Mp(o);else if(h===1)switch(o.nodeName){case"HEAD":case"HTML":case"BODY":Mp(o);break;default:o.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((o&1024)!==0)throw Error(r(163))}if(o=s.sibling,o!==null){o.return=s.return,nn=o;break}nn=s.return}}function Ib(o,s,h){var p=h.flags;switch(h.tag){case 0:case 11:case 15:Qa(o,h),p&4&&xu(5,h);break;case 1:if(Qa(o,h),p&4)if(o=h.stateNode,s===null)try{o.componentDidMount()}catch(T){bt(h,h.return,T)}else{var y=qi(h.type,s.memoizedProps);s=s.memoizedState;try{o.componentDidUpdate(y,s,o.__reactInternalSnapshotBeforeUpdate)}catch(T){bt(h,h.return,T)}}p&64&&Tb(h),p&512&&wu(h,h.return);break;case 3:if(Qa(o,h),p&64&&(o=h.updateQueue,o!==null)){if(s=null,h.child!==null)switch(h.child.tag){case 27:case 5:s=h.child.stateNode;break;case 1:s=h.child.stateNode}try{v0(o,s)}catch(T){bt(h,h.return,T)}}break;case 27:s===null&&p&4&&Nb(h);case 26:case 5:Qa(o,h),s===null&&p&4&&kb(h),p&512&&wu(h,h.return);break;case 12:Qa(o,h);break;case 13:Qa(o,h),p&4&&Lb(o,h),p&64&&(o=h.memoizedState,o!==null&&(o=o.dehydrated,o!==null&&(h=ER.bind(null,h),HR(o,h))));break;case 22:if(p=h.memoizedState!==null||ba,!p){s=s!==null&&s.memoizedState!==null||Ft,y=ba;var x=Ft;ba=p,(Ft=s)&&!x?Za(o,h,(h.subtreeFlags&8772)!==0):Qa(o,h),ba=y,Ft=x}break;case 30:break;default:Qa(o,h)}}function Fb(o){var s=o.alternate;s!==null&&(o.alternate=null,Fb(s)),o.child=null,o.deletions=null,o.sibling=null,o.tag===5&&(s=o.stateNode,s!==null&&Ph(s)),o.stateNode=null,o.return=null,o.dependencies=null,o.memoizedProps=null,o.memoizedState=null,o.pendingProps=null,o.stateNode=null,o.updateQueue=null}var Et=null,In=!1;function xa(o,s,h){for(h=h.child;h!==null;)Bb(o,s,h),h=h.sibling}function Bb(o,s,h){if(Lt&&typeof Lt.onCommitFiberUnmount=="function")try{Lt.onCommitFiberUnmount(sa,h)}catch{}switch(h.tag){case 26:Ft||Pr(h,s),xa(o,s,h),h.memoizedState?h.memoizedState.count--:h.stateNode&&(h=h.stateNode,h.parentNode.removeChild(h));break;case 27:Ft||Pr(h,s);var p=Et,y=In;ai(h.type)&&(Et=h.stateNode,In=!1),xa(o,s,h),ku(h.stateNode),Et=p,In=y;break;case 5:Ft||Pr(h,s);case 6:if(p=Et,y=In,Et=null,xa(o,s,h),Et=p,In=y,Et!==null)if(In)try{(Et.nodeType===9?Et.body:Et.nodeName==="HTML"?Et.ownerDocument.body:Et).removeChild(h.stateNode)}catch(x){bt(h,s,x)}else try{Et.removeChild(h.stateNode)}catch(x){bt(h,s,x)}break;case 18:Et!==null&&(In?(o=Et,E1(o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o,h.stateNode),Pu(o)):E1(Et,h.stateNode));break;case 4:p=Et,y=In,Et=h.stateNode.containerInfo,In=!0,xa(o,s,h),Et=p,In=y;break;case 0:case 11:case 14:case 15:Ft||Ya(2,h,s),Ft||Ya(4,h,s),xa(o,s,h);break;case 1:Ft||(Pr(h,s),p=h.stateNode,typeof p.componentWillUnmount=="function"&&Db(h,s,p)),xa(o,s,h);break;case 21:xa(o,s,h);break;case 22:Ft=(p=Ft)||h.memoizedState!==null,xa(o,s,h),Ft=p;break;default:xa(o,s,h)}}function Lb(o,s){if(s.memoizedState===null&&(o=s.alternate,o!==null&&(o=o.memoizedState,o!==null&&(o=o.dehydrated,o!==null))))try{Pu(o)}catch(h){bt(s,s.return,h)}}function mR(o){switch(o.tag){case 13:case 19:var s=o.stateNode;return s===null&&(s=o.stateNode=new Mb),s;case 22:return o=o.stateNode,s=o._retryCache,s===null&&(s=o._retryCache=new Mb),s;default:throw Error(r(435,o.tag))}}function op(o,s){var h=mR(o);s.forEach(function(p){var y=CR.bind(null,o,p);h.has(p)||(h.add(p),p.then(y,y))})}function Wn(o,s){var h=s.deletions;if(h!==null)for(var p=0;p<h.length;p++){var y=h[p],x=o,T=s,O=T;e:for(;O!==null;){switch(O.tag){case 27:if(ai(O.type)){Et=O.stateNode,In=!1;break e}break;case 5:Et=O.stateNode,In=!1;break e;case 3:case 4:Et=O.stateNode.containerInfo,In=!0;break e}O=O.return}if(Et===null)throw Error(r(160));Bb(x,T,y),Et=null,In=!1,x=y.alternate,x!==null&&(x.return=null),y.return=null}if(s.subtreeFlags&13878)for(s=s.child;s!==null;)Pb(s,o),s=s.sibling}var Cr=null;function Pb(o,s){var h=o.alternate,p=o.flags;switch(o.tag){case 0:case 11:case 14:case 15:Wn(s,o),Gn(o),p&4&&(Ya(3,o,o.return),xu(3,o),Ya(5,o,o.return));break;case 1:Wn(s,o),Gn(o),p&512&&(Ft||h===null||Pr(h,h.return)),p&64&&ba&&(o=o.updateQueue,o!==null&&(p=o.callbacks,p!==null&&(h=o.shared.hiddenCallbacks,o.shared.hiddenCallbacks=h===null?p:h.concat(p))));break;case 26:var y=Cr;if(Wn(s,o),Gn(o),p&512&&(Ft||h===null||Pr(h,h.return)),p&4){var x=h!==null?h.memoizedState:null;if(p=o.memoizedState,h===null)if(p===null)if(o.stateNode===null){e:{p=o.type,h=o.memoizedProps,y=y.ownerDocument||y;t:switch(p){case"title":x=y.getElementsByTagName("title")[0],(!x||x[Gs]||x[yn]||x.namespaceURI==="http://www.w3.org/2000/svg"||x.hasAttribute("itemprop"))&&(x=y.createElement(p),y.head.insertBefore(x,y.querySelector("head > title"))),dn(x,p,h),x[yn]=o,en(x),p=x;break e;case"link":var T=N1("link","href",y).get(p+(h.href||""));if(T){for(var O=0;O<T.length;O++)if(x=T[O],x.getAttribute("href")===(h.href==null||h.href===""?null:h.href)&&x.getAttribute("rel")===(h.rel==null?null:h.rel)&&x.getAttribute("title")===(h.title==null?null:h.title)&&x.getAttribute("crossorigin")===(h.crossOrigin==null?null:h.crossOrigin)){T.splice(O,1);break t}}x=y.createElement(p),dn(x,p,h),y.head.appendChild(x);break;case"meta":if(T=N1("meta","content",y).get(p+(h.content||""))){for(O=0;O<T.length;O++)if(x=T[O],x.getAttribute("content")===(h.content==null?null:""+h.content)&&x.getAttribute("name")===(h.name==null?null:h.name)&&x.getAttribute("property")===(h.property==null?null:h.property)&&x.getAttribute("http-equiv")===(h.httpEquiv==null?null:h.httpEquiv)&&x.getAttribute("charset")===(h.charSet==null?null:h.charSet)){T.splice(O,1);break t}}x=y.createElement(p),dn(x,p,h),y.head.appendChild(x);break;default:throw Error(r(468,p))}x[yn]=o,en(x),p=x}o.stateNode=p}else M1(y,o.type,o.stateNode);else o.stateNode=O1(y,p,o.memoizedProps);else x!==p?(x===null?h.stateNode!==null&&(h=h.stateNode,h.parentNode.removeChild(h)):x.count--,p===null?M1(y,o.type,o.stateNode):O1(y,p,o.memoizedProps)):p===null&&o.stateNode!==null&&np(o,o.memoizedProps,h.memoizedProps)}break;case 27:Wn(s,o),Gn(o),p&512&&(Ft||h===null||Pr(h,h.return)),h!==null&&p&4&&np(o,o.memoizedProps,h.memoizedProps);break;case 5:if(Wn(s,o),Gn(o),p&512&&(Ft||h===null||Pr(h,h.return)),o.flags&32){y=o.stateNode;try{Co(y,"")}catch(re){bt(o,o.return,re)}}p&4&&o.stateNode!=null&&(y=o.memoizedProps,np(o,y,h!==null?h.memoizedProps:y)),p&1024&&(ip=!0);break;case 6:if(Wn(s,o),Gn(o),p&4){if(o.stateNode===null)throw Error(r(162));p=o.memoizedProps,h=o.stateNode;try{h.nodeValue=p}catch(re){bt(o,o.return,re)}}break;case 3:if(Ic=null,y=Cr,Cr=Nc(s.containerInfo),Wn(s,o),Cr=y,Gn(o),p&4&&h!==null&&h.memoizedState.isDehydrated)try{Pu(s.containerInfo)}catch(re){bt(o,o.return,re)}ip&&(ip=!1,zb(o));break;case 4:p=Cr,Cr=Nc(o.stateNode.containerInfo),Wn(s,o),Gn(o),Cr=p;break;case 12:Wn(s,o),Gn(o);break;case 13:Wn(s,o),Gn(o),o.child.flags&8192&&o.memoizedState!==null!=(h!==null&&h.memoizedState!==null)&&(hp=Mt()),p&4&&(p=o.updateQueue,p!==null&&(o.updateQueue=null,op(o,p)));break;case 22:y=o.memoizedState!==null;var z=h!==null&&h.memoizedState!==null,Q=ba,le=Ft;if(ba=Q||y,Ft=le||z,Wn(s,o),Ft=le,ba=Q,Gn(o),p&8192)e:for(s=o.stateNode,s._visibility=y?s._visibility&-2:s._visibility|1,y&&(h===null||z||ba||Ft||Ki(o)),h=null,s=o;;){if(s.tag===5||s.tag===26){if(h===null){z=h=s;try{if(x=z.stateNode,y)T=x.style,typeof T.setProperty=="function"?T.setProperty("display","none","important"):T.display="none";else{O=z.stateNode;var fe=z.memoizedProps.style,Z=fe!=null&&fe.hasOwnProperty("display")?fe.display:null;O.style.display=Z==null||typeof Z=="boolean"?"":(""+Z).trim()}}catch(re){bt(z,z.return,re)}}}else if(s.tag===6){if(h===null){z=s;try{z.stateNode.nodeValue=y?"":z.memoizedProps}catch(re){bt(z,z.return,re)}}}else if((s.tag!==22&&s.tag!==23||s.memoizedState===null||s===o)&&s.child!==null){s.child.return=s,s=s.child;continue}if(s===o)break e;for(;s.sibling===null;){if(s.return===null||s.return===o)break e;h===s&&(h=null),s=s.return}h===s&&(h=null),s.sibling.return=s.return,s=s.sibling}p&4&&(p=o.updateQueue,p!==null&&(h=p.retryQueue,h!==null&&(p.retryQueue=null,op(o,h))));break;case 19:Wn(s,o),Gn(o),p&4&&(p=o.updateQueue,p!==null&&(o.updateQueue=null,op(o,p)));break;case 30:break;case 21:break;default:Wn(s,o),Gn(o)}}function Gn(o){var s=o.flags;if(s&2){try{for(var h,p=o.return;p!==null;){if(Ob(p)){h=p;break}p=p.return}if(h==null)throw Error(r(160));switch(h.tag){case 27:var y=h.stateNode,x=rp(o);bc(o,x,y);break;case 5:var T=h.stateNode;h.flags&32&&(Co(T,""),h.flags&=-33);var O=rp(o);bc(o,O,T);break;case 3:case 4:var z=h.stateNode.containerInfo,Q=rp(o);ap(o,Q,z);break;default:throw Error(r(161))}}catch(le){bt(o,o.return,le)}o.flags&=-3}s&4096&&(o.flags&=-4097)}function zb(o){if(o.subtreeFlags&1024)for(o=o.child;o!==null;){var s=o;zb(s),s.tag===5&&s.flags&1024&&s.stateNode.reset(),o=o.sibling}}function Qa(o,s){if(s.subtreeFlags&8772)for(s=s.child;s!==null;)Ib(o,s.alternate,s),s=s.sibling}function Ki(o){for(o=o.child;o!==null;){var s=o;switch(s.tag){case 0:case 11:case 14:case 15:Ya(4,s,s.return),Ki(s);break;case 1:Pr(s,s.return);var h=s.stateNode;typeof h.componentWillUnmount=="function"&&Db(s,s.return,h),Ki(s);break;case 27:ku(s.stateNode);case 26:case 5:Pr(s,s.return),Ki(s);break;case 22:s.memoizedState===null&&Ki(s);break;case 30:Ki(s);break;default:Ki(s)}o=o.sibling}}function Za(o,s,h){for(h=h&&(s.subtreeFlags&8772)!==0,s=s.child;s!==null;){var p=s.alternate,y=o,x=s,T=x.flags;switch(x.tag){case 0:case 11:case 15:Za(y,x,h),xu(4,x);break;case 1:if(Za(y,x,h),p=x,y=p.stateNode,typeof y.componentDidMount=="function")try{y.componentDidMount()}catch(Q){bt(p,p.return,Q)}if(p=x,y=p.updateQueue,y!==null){var O=p.stateNode;try{var z=y.shared.hiddenCallbacks;if(z!==null)for(y.shared.hiddenCallbacks=null,y=0;y<z.length;y++)p0(z[y],O)}catch(Q){bt(p,p.return,Q)}}h&&T&64&&Tb(x),wu(x,x.return);break;case 27:Nb(x);case 26:case 5:Za(y,x,h),h&&p===null&&T&4&&kb(x),wu(x,x.return);break;case 12:Za(y,x,h);break;case 13:Za(y,x,h),h&&T&4&&Lb(y,x);break;case 22:x.memoizedState===null&&Za(y,x,h),wu(x,x.return);break;case 30:break;default:Za(y,x,h)}s=s.sibling}}function sp(o,s){var h=null;o!==null&&o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(h=o.memoizedState.cachePool.pool),o=null,s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(o=s.memoizedState.cachePool.pool),o!==h&&(o!=null&&o.refCount++,h!=null&&ou(h))}function up(o,s){o=null,s.alternate!==null&&(o=s.alternate.memoizedState.cache),s=s.memoizedState.cache,s!==o&&(s.refCount++,o!=null&&ou(o))}function zr(o,s,h,p){if(s.subtreeFlags&10256)for(s=s.child;s!==null;)Ub(o,s,h,p),s=s.sibling}function Ub(o,s,h,p){var y=s.flags;switch(s.tag){case 0:case 11:case 15:zr(o,s,h,p),y&2048&&xu(9,s);break;case 1:zr(o,s,h,p);break;case 3:zr(o,s,h,p),y&2048&&(o=null,s.alternate!==null&&(o=s.alternate.memoizedState.cache),s=s.memoizedState.cache,s!==o&&(s.refCount++,o!=null&&ou(o)));break;case 12:if(y&2048){zr(o,s,h,p),o=s.stateNode;try{var x=s.memoizedProps,T=x.id,O=x.onPostCommit;typeof O=="function"&&O(T,s.alternate===null?"mount":"update",o.passiveEffectDuration,-0)}catch(z){bt(s,s.return,z)}}else zr(o,s,h,p);break;case 13:zr(o,s,h,p);break;case 23:break;case 22:x=s.stateNode,T=s.alternate,s.memoizedState!==null?x._visibility&2?zr(o,s,h,p):_u(o,s):x._visibility&2?zr(o,s,h,p):(x._visibility|=2,Wo(o,s,h,p,(s.subtreeFlags&10256)!==0)),y&2048&&sp(T,s);break;case 24:zr(o,s,h,p),y&2048&&up(s.alternate,s);break;default:zr(o,s,h,p)}}function Wo(o,s,h,p,y){for(y=y&&(s.subtreeFlags&10256)!==0,s=s.child;s!==null;){var x=o,T=s,O=h,z=p,Q=T.flags;switch(T.tag){case 0:case 11:case 15:Wo(x,T,O,z,y),xu(8,T);break;case 23:break;case 22:var le=T.stateNode;T.memoizedState!==null?le._visibility&2?Wo(x,T,O,z,y):_u(x,T):(le._visibility|=2,Wo(x,T,O,z,y)),y&&Q&2048&&sp(T.alternate,T);break;case 24:Wo(x,T,O,z,y),y&&Q&2048&&up(T.alternate,T);break;default:Wo(x,T,O,z,y)}s=s.sibling}}function _u(o,s){if(s.subtreeFlags&10256)for(s=s.child;s!==null;){var h=o,p=s,y=p.flags;switch(p.tag){case 22:_u(h,p),y&2048&&sp(p.alternate,p);break;case 24:_u(h,p),y&2048&&up(p.alternate,p);break;default:_u(h,p)}s=s.sibling}}var Su=8192;function Go(o){if(o.subtreeFlags&Su)for(o=o.child;o!==null;)Vb(o),o=o.sibling}function Vb(o){switch(o.tag){case 26:Go(o),o.flags&Su&&o.memoizedState!==null&&tA(Cr,o.memoizedState,o.memoizedProps);break;case 5:Go(o);break;case 3:case 4:var s=Cr;Cr=Nc(o.stateNode.containerInfo),Go(o),Cr=s;break;case 22:o.memoizedState===null&&(s=o.alternate,s!==null&&s.memoizedState!==null?(s=Su,Su=16777216,Go(o),Su=s):Go(o));break;default:Go(o)}}function Hb(o){var s=o.alternate;if(s!==null&&(o=s.child,o!==null)){s.child=null;do s=o.sibling,o.sibling=null,o=s;while(o!==null)}}function Eu(o){var s=o.deletions;if((o.flags&16)!==0){if(s!==null)for(var h=0;h<s.length;h++){var p=s[h];nn=p,Wb(p,o)}Hb(o)}if(o.subtreeFlags&10256)for(o=o.child;o!==null;)jb(o),o=o.sibling}function jb(o){switch(o.tag){case 0:case 11:case 15:Eu(o),o.flags&2048&&Ya(9,o,o.return);break;case 3:Eu(o);break;case 12:Eu(o);break;case 22:var s=o.stateNode;o.memoizedState!==null&&s._visibility&2&&(o.return===null||o.return.tag!==13)?(s._visibility&=-3,xc(o)):Eu(o);break;default:Eu(o)}}function xc(o){var s=o.deletions;if((o.flags&16)!==0){if(s!==null)for(var h=0;h<s.length;h++){var p=s[h];nn=p,Wb(p,o)}Hb(o)}for(o=o.child;o!==null;){switch(s=o,s.tag){case 0:case 11:case 15:Ya(8,s,s.return),xc(s);break;case 22:h=s.stateNode,h._visibility&2&&(h._visibility&=-3,xc(s));break;default:xc(s)}o=o.sibling}}function Wb(o,s){for(;nn!==null;){var h=nn;switch(h.tag){case 0:case 11:case 15:Ya(8,h,s);break;case 23:case 22:if(h.memoizedState!==null&&h.memoizedState.cachePool!==null){var p=h.memoizedState.cachePool.pool;p!=null&&p.refCount++}break;case 24:ou(h.memoizedState.cache)}if(p=h.child,p!==null)p.return=h,nn=p;else e:for(h=o;nn!==null;){p=nn;var y=p.sibling,x=p.return;if(Fb(p),p===h){nn=null;break e}if(y!==null){y.return=x,nn=y;break e}nn=x}}}var gR={getCacheForType:function(o){var s=bn(jt),h=s.data.get(o);return h===void 0&&(h=o(),s.data.set(o,h)),h}},yR=typeof WeakMap=="function"?WeakMap:Map,ht=0,xt=null,Ze=null,tt=0,dt=0,qn=null,Ja=!1,qo=!1,lp=!1,wa=0,Ot=0,ei=0,Xi=0,cp=0,dr=0,Ko=0,Cu=null,Fn=null,fp=!1,hp=0,wc=1/0,_c=null,ti=null,hn=0,ni=null,Xo=null,$o=0,dp=0,pp=null,Gb=null,Ru=0,vp=null;function Kn(){if((ht&2)!==0&&tt!==0)return tt&-tt;if(P.T!==null){var o=Bo;return o!==0?o:_p()}return sy()}function qb(){dr===0&&(dr=(tt&536870912)===0||lt?ry():536870912);var o=hr.current;return o!==null&&(o.flags|=32),dr}function Xn(o,s,h){(o===xt&&(dt===2||dt===9)||o.cancelPendingCommit!==null)&&(Yo(o,0),ri(o,tt,dr,!1)),Ws(o,h),((ht&2)===0||o!==xt)&&(o===xt&&((ht&2)===0&&(Xi|=h),Ot===4&&ri(o,tt,dr,!1)),Ur(o))}function Kb(o,s,h){if((ht&6)!==0)throw Error(r(327));var p=!h&&(s&124)===0&&(s&o.expiredLanes)===0||js(o,s),y=p?wR(o,s):yp(o,s,!0),x=p;do{if(y===0){qo&&!p&&ri(o,s,0,!1);break}else{if(h=o.current.alternate,x&&!bR(h)){y=yp(o,s,!1),x=!1;continue}if(y===2){if(x=s,o.errorRecoveryDisabledLanes&x)var T=0;else T=o.pendingLanes&-536870913,T=T!==0?T:T&536870912?536870912:0;if(T!==0){s=T;e:{var O=o;y=Cu;var z=O.current.memoizedState.isDehydrated;if(z&&(Yo(O,T).flags|=256),T=yp(O,T,!1),T!==2){if(lp&&!z){O.errorRecoveryDisabledLanes|=x,Xi|=x,y=4;break e}x=Fn,Fn=y,x!==null&&(Fn===null?Fn=x:Fn.push.apply(Fn,x))}y=T}if(x=!1,y!==2)continue}}if(y===1){Yo(o,0),ri(o,s,0,!0);break}e:{switch(p=o,x=y,x){case 0:case 1:throw Error(r(345));case 4:if((s&4194048)!==s)break;case 6:ri(p,s,dr,!Ja);break e;case 2:Fn=null;break;case 3:case 5:break;default:throw Error(r(329))}if((s&62914560)===s&&(y=hp+300-Mt(),10<y)){if(ri(p,s,dr,!Ja),Ml(p,0,!0)!==0)break e;p.timeoutHandle=_1(Xb.bind(null,p,h,Fn,_c,fp,s,dr,Xi,Ko,Ja,x,2,-0,0),y);break e}Xb(p,h,Fn,_c,fp,s,dr,Xi,Ko,Ja,x,0,-0,0)}}break}while(!0);Ur(o)}function Xb(o,s,h,p,y,x,T,O,z,Q,le,fe,Z,re){if(o.timeoutHandle=-1,fe=s.subtreeFlags,(fe&8192||(fe&16785408)===16785408)&&(Mu={stylesheets:null,count:0,unsuspend:eA},Vb(s),fe=nA(),fe!==null)){o.cancelPendingCommit=fe(t1.bind(null,o,s,x,h,p,y,T,O,z,le,1,Z,re)),ri(o,x,T,!Q);return}t1(o,s,x,h,p,y,T,O,z)}function bR(o){for(var s=o;;){var h=s.tag;if((h===0||h===11||h===15)&&s.flags&16384&&(h=s.updateQueue,h!==null&&(h=h.stores,h!==null)))for(var p=0;p<h.length;p++){var y=h[p],x=y.getSnapshot;y=y.value;try{if(!Hn(x(),y))return!1}catch{return!1}}if(h=s.child,s.subtreeFlags&16384&&h!==null)h.return=s,s=h;else{if(s===o)break;for(;s.sibling===null;){if(s.return===null||s.return===o)return!0;s=s.return}s.sibling.return=s.return,s=s.sibling}}return!0}function ri(o,s,h,p){s&=~cp,s&=~Xi,o.suspendedLanes|=s,o.pingedLanes&=~s,p&&(o.warmLanes|=s),p=o.expirationTimes;for(var y=s;0<y;){var x=31-cn(y),T=1<<x;p[x]=-1,y&=~T}h!==0&&iy(o,h,s)}function Sc(){return(ht&6)===0?(Au(0),!1):!0}function mp(){if(Ze!==null){if(dt===0)var o=Ze.return;else o=Ze,da=Hi=null,Md(o),Ho=null,gu=0,o=Ze;for(;o!==null;)Ab(o.alternate,o),o=o.return;Ze=null}}function Yo(o,s){var h=o.timeoutHandle;h!==-1&&(o.timeoutHandle=-1,LR(h)),h=o.cancelPendingCommit,h!==null&&(o.cancelPendingCommit=null,h()),mp(),xt=o,Ze=h=ca(o.current,null),tt=s,dt=0,qn=null,Ja=!1,qo=js(o,s),lp=!1,Ko=dr=cp=Xi=ei=Ot=0,Fn=Cu=null,fp=!1,(s&8)!==0&&(s|=s&32);var p=o.entangledLanes;if(p!==0)for(o=o.entanglements,p&=s;0<p;){var y=31-cn(p),x=1<<y;s|=o[y],p&=~x}return wa=s,Gl(),h}function $b(o,s){Xe=null,P.H=cc,s===uu||s===ec?(s=h0(),dt=3):s===l0?(s=h0(),dt=4):dt=s===db?8:s!==null&&typeof s=="object"&&typeof s.then=="function"?6:1,qn=s,Ze===null&&(Ot=1,vc(o,ur(s,o.current)))}function Yb(){var o=P.H;return P.H=cc,o===null?cc:o}function Qb(){var o=P.A;return P.A=gR,o}function gp(){Ot=4,Ja||(tt&4194048)!==tt&&hr.current!==null||(qo=!0),(ei&134217727)===0&&(Xi&134217727)===0||xt===null||ri(xt,tt,dr,!1)}function yp(o,s,h){var p=ht;ht|=2;var y=Yb(),x=Qb();(xt!==o||tt!==s)&&(_c=null,Yo(o,s)),s=!1;var T=Ot;e:do try{if(dt!==0&&Ze!==null){var O=Ze,z=qn;switch(dt){case 8:mp(),T=6;break e;case 3:case 2:case 9:case 6:hr.current===null&&(s=!0);var Q=dt;if(dt=0,qn=null,Qo(o,O,z,Q),h&&qo){T=0;break e}break;default:Q=dt,dt=0,qn=null,Qo(o,O,z,Q)}}xR(),T=Ot;break}catch(le){$b(o,le)}while(!0);return s&&o.shellSuspendCounter++,da=Hi=null,ht=p,P.H=y,P.A=x,Ze===null&&(xt=null,tt=0,Gl()),T}function xR(){for(;Ze!==null;)Zb(Ze)}function wR(o,s){var h=ht;ht|=2;var p=Yb(),y=Qb();xt!==o||tt!==s?(_c=null,wc=Mt()+500,Yo(o,s)):qo=js(o,s);e:do try{if(dt!==0&&Ze!==null){s=Ze;var x=qn;t:switch(dt){case 1:dt=0,qn=null,Qo(o,s,x,1);break;case 2:case 9:if(c0(x)){dt=0,qn=null,Jb(s);break}s=function(){dt!==2&&dt!==9||xt!==o||(dt=7),Ur(o)},x.then(s,s);break e;case 3:dt=7;break e;case 4:dt=5;break e;case 7:c0(x)?(dt=0,qn=null,Jb(s)):(dt=0,qn=null,Qo(o,s,x,7));break;case 5:var T=null;switch(Ze.tag){case 26:T=Ze.memoizedState;case 5:case 27:var O=Ze;if(!T||I1(T)){dt=0,qn=null;var z=O.sibling;if(z!==null)Ze=z;else{var Q=O.return;Q!==null?(Ze=Q,Ec(Q)):Ze=null}break t}}dt=0,qn=null,Qo(o,s,x,5);break;case 6:dt=0,qn=null,Qo(o,s,x,6);break;case 8:mp(),Ot=6;break e;default:throw Error(r(462))}}_R();break}catch(le){$b(o,le)}while(!0);return da=Hi=null,P.H=p,P.A=y,ht=h,Ze!==null?0:(xt=null,tt=0,Gl(),Ot)}function _R(){for(;Ze!==null&&!yt();)Zb(Ze)}function Zb(o){var s=Cb(o.alternate,o,wa);o.memoizedProps=o.pendingProps,s===null?Ec(o):Ze=s}function Jb(o){var s=o,h=s.alternate;switch(s.tag){case 15:case 0:s=bb(h,s,s.pendingProps,s.type,void 0,tt);break;case 11:s=bb(h,s,s.pendingProps,s.type.render,s.ref,tt);break;case 5:Md(s);default:Ab(h,s),s=Ze=e0(s,wa),s=Cb(h,s,wa)}o.memoizedProps=o.pendingProps,s===null?Ec(o):Ze=s}function Qo(o,s,h,p){da=Hi=null,Md(s),Ho=null,gu=0;var y=s.return;try{if(fR(o,y,s,h,tt)){Ot=1,vc(o,ur(h,o.current)),Ze=null;return}}catch(x){if(y!==null)throw Ze=y,x;Ot=1,vc(o,ur(h,o.current)),Ze=null;return}s.flags&32768?(lt||p===1?o=!0:qo||(tt&536870912)!==0?o=!1:(Ja=o=!0,(p===2||p===9||p===3||p===6)&&(p=hr.current,p!==null&&p.tag===13&&(p.flags|=16384))),e1(s,o)):Ec(s)}function Ec(o){var s=o;do{if((s.flags&32768)!==0){e1(s,Ja);return}o=s.return;var h=dR(s.alternate,s,wa);if(h!==null){Ze=h;return}if(s=s.sibling,s!==null){Ze=s;return}Ze=s=o}while(s!==null);Ot===0&&(Ot=5)}function e1(o,s){do{var h=pR(o.alternate,o);if(h!==null){h.flags&=32767,Ze=h;return}if(h=o.return,h!==null&&(h.flags|=32768,h.subtreeFlags=0,h.deletions=null),!s&&(o=o.sibling,o!==null)){Ze=o;return}Ze=o=h}while(o!==null);Ot=6,Ze=null}function t1(o,s,h,p,y,x,T,O,z){o.cancelPendingCommit=null;do Cc();while(hn!==0);if((ht&6)!==0)throw Error(r(327));if(s!==null){if(s===o.current)throw Error(r(177));if(x=s.lanes|s.childLanes,x|=ud,eC(o,h,x,T,O,z),o===xt&&(Ze=xt=null,tt=0),Xo=s,ni=o,$o=h,dp=x,pp=y,Gb=p,(s.subtreeFlags&10256)!==0||(s.flags&10256)!==0?(o.callbackNode=null,o.callbackPriority=0,RR(kn,function(){return o1(),null})):(o.callbackNode=null,o.callbackPriority=0),p=(s.flags&13878)!==0,(s.subtreeFlags&13878)!==0||p){p=P.T,P.T=null,y=j.p,j.p=2,T=ht,ht|=4;try{vR(o,s,h)}finally{ht=T,j.p=y,P.T=p}}hn=1,n1(),r1(),a1()}}function n1(){if(hn===1){hn=0;var o=ni,s=Xo,h=(s.flags&13878)!==0;if((s.subtreeFlags&13878)!==0||h){h=P.T,P.T=null;var p=j.p;j.p=2;var y=ht;ht|=4;try{Pb(s,o);var x=kp,T=Wy(o.containerInfo),O=x.focusedElem,z=x.selectionRange;if(T!==O&&O&&O.ownerDocument&&jy(O.ownerDocument.documentElement,O)){if(z!==null&&rd(O)){var Q=z.start,le=z.end;if(le===void 0&&(le=Q),"selectionStart"in O)O.selectionStart=Q,O.selectionEnd=Math.min(le,O.value.length);else{var fe=O.ownerDocument||document,Z=fe&&fe.defaultView||window;if(Z.getSelection){var re=Z.getSelection(),Be=O.textContent.length,Me=Math.min(z.start,Be),gt=z.end===void 0?Me:Math.min(z.end,Be);!re.extend&&Me>gt&&(T=gt,gt=Me,Me=T);var X=Hy(O,Me),W=Hy(O,gt);if(X&&W&&(re.rangeCount!==1||re.anchorNode!==X.node||re.anchorOffset!==X.offset||re.focusNode!==W.node||re.focusOffset!==W.offset)){var $=fe.createRange();$.setStart(X.node,X.offset),re.removeAllRanges(),Me>gt?(re.addRange($),re.extend(W.node,W.offset)):($.setEnd(W.node,W.offset),re.addRange($))}}}}for(fe=[],re=O;re=re.parentNode;)re.nodeType===1&&fe.push({element:re,left:re.scrollLeft,top:re.scrollTop});for(typeof O.focus=="function"&&O.focus(),O=0;O<fe.length;O++){var ce=fe[O];ce.element.scrollLeft=ce.left,ce.element.scrollTop=ce.top}}Lc=!!Dp,kp=Dp=null}finally{ht=y,j.p=p,P.T=h}}o.current=s,hn=2}}function r1(){if(hn===2){hn=0;var o=ni,s=Xo,h=(s.flags&8772)!==0;if((s.subtreeFlags&8772)!==0||h){h=P.T,P.T=null;var p=j.p;j.p=2;var y=ht;ht|=4;try{Ib(o,s.alternate,s)}finally{ht=y,j.p=p,P.T=h}}hn=3}}function a1(){if(hn===4||hn===3){hn=0,pt();var o=ni,s=Xo,h=$o,p=Gb;(s.subtreeFlags&10256)!==0||(s.flags&10256)!==0?hn=5:(hn=0,Xo=ni=null,i1(o,o.pendingLanes));var y=o.pendingLanes;if(y===0&&(ti=null),Bh(h),s=s.stateNode,Lt&&typeof Lt.onCommitFiberRoot=="function")try{Lt.onCommitFiberRoot(sa,s,void 0,(s.current.flags&128)===128)}catch{}if(p!==null){s=P.T,y=j.p,j.p=2,P.T=null;try{for(var x=o.onRecoverableError,T=0;T<p.length;T++){var O=p[T];x(O.value,{componentStack:O.stack})}}finally{P.T=s,j.p=y}}($o&3)!==0&&Cc(),Ur(o),y=o.pendingLanes,(h&4194090)!==0&&(y&42)!==0?o===vp?Ru++:(Ru=0,vp=o):Ru=0,Au(0)}}function i1(o,s){(o.pooledCacheLanes&=s)===0&&(s=o.pooledCache,s!=null&&(o.pooledCache=null,ou(s)))}function Cc(o){return n1(),r1(),a1(),o1()}function o1(){if(hn!==5)return!1;var o=ni,s=dp;dp=0;var h=Bh($o),p=P.T,y=j.p;try{j.p=32>h?32:h,P.T=null,h=pp,pp=null;var x=ni,T=$o;if(hn=0,Xo=ni=null,$o=0,(ht&6)!==0)throw Error(r(331));var O=ht;if(ht|=4,jb(x.current),Ub(x,x.current,T,h),ht=O,Au(0,!1),Lt&&typeof Lt.onPostCommitFiberRoot=="function")try{Lt.onPostCommitFiberRoot(sa,x)}catch{}return!0}finally{j.p=y,P.T=p,i1(o,s)}}function s1(o,s,h){s=ur(h,s),s=Kd(o.stateNode,s,2),o=qa(o,s,2),o!==null&&(Ws(o,2),Ur(o))}function bt(o,s,h){if(o.tag===3)s1(o,o,h);else for(;s!==null;){if(s.tag===3){s1(s,o,h);break}else if(s.tag===1){var p=s.stateNode;if(typeof s.type.getDerivedStateFromError=="function"||typeof p.componentDidCatch=="function"&&(ti===null||!ti.has(p))){o=ur(h,o),h=fb(2),p=qa(s,h,2),p!==null&&(hb(h,p,s,o),Ws(p,2),Ur(p));break}}s=s.return}}function bp(o,s,h){var p=o.pingCache;if(p===null){p=o.pingCache=new yR;var y=new Set;p.set(s,y)}else y=p.get(s),y===void 0&&(y=new Set,p.set(s,y));y.has(h)||(lp=!0,y.add(h),o=SR.bind(null,o,s,h),s.then(o,o))}function SR(o,s,h){var p=o.pingCache;p!==null&&p.delete(s),o.pingedLanes|=o.suspendedLanes&h,o.warmLanes&=~h,xt===o&&(tt&h)===h&&(Ot===4||Ot===3&&(tt&62914560)===tt&&300>Mt()-hp?(ht&2)===0&&Yo(o,0):cp|=h,Ko===tt&&(Ko=0)),Ur(o)}function u1(o,s){s===0&&(s=ay()),o=No(o,s),o!==null&&(Ws(o,s),Ur(o))}function ER(o){var s=o.memoizedState,h=0;s!==null&&(h=s.retryLane),u1(o,h)}function CR(o,s){var h=0;switch(o.tag){case 13:var p=o.stateNode,y=o.memoizedState;y!==null&&(h=y.retryLane);break;case 19:p=o.stateNode;break;case 22:p=o.stateNode._retryCache;break;default:throw Error(r(314))}p!==null&&p.delete(s),u1(o,h)}function RR(o,s){return Ke(o,s)}var Rc=null,Zo=null,xp=!1,Ac=!1,wp=!1,$i=0;function Ur(o){o!==Zo&&o.next===null&&(Zo===null?Rc=Zo=o:Zo=Zo.next=o),Ac=!0,xp||(xp=!0,TR())}function Au(o,s){if(!wp&&Ac){wp=!0;do for(var h=!1,p=Rc;p!==null;){if(o!==0){var y=p.pendingLanes;if(y===0)var x=0;else{var T=p.suspendedLanes,O=p.pingedLanes;x=(1<<31-cn(42|o)+1)-1,x&=y&~(T&~O),x=x&201326741?x&201326741|1:x?x|2:0}x!==0&&(h=!0,h1(p,x))}else x=tt,x=Ml(p,p===xt?x:0,p.cancelPendingCommit!==null||p.timeoutHandle!==-1),(x&3)===0||js(p,x)||(h=!0,h1(p,x));p=p.next}while(h);wp=!1}}function AR(){l1()}function l1(){Ac=xp=!1;var o=0;$i!==0&&(BR()&&(o=$i),$i=0);for(var s=Mt(),h=null,p=Rc;p!==null;){var y=p.next,x=c1(p,s);x===0?(p.next=null,h===null?Rc=y:h.next=y,y===null&&(Zo=h)):(h=p,(o!==0||(x&3)!==0)&&(Ac=!0)),p=y}Au(o)}function c1(o,s){for(var h=o.suspendedLanes,p=o.pingedLanes,y=o.expirationTimes,x=o.pendingLanes&-62914561;0<x;){var T=31-cn(x),O=1<<T,z=y[T];z===-1?((O&h)===0||(O&p)!==0)&&(y[T]=JE(O,s)):z<=s&&(o.expiredLanes|=O),x&=~O}if(s=xt,h=tt,h=Ml(o,o===s?h:0,o.cancelPendingCommit!==null||o.timeoutHandle!==-1),p=o.callbackNode,h===0||o===s&&(dt===2||dt===9)||o.cancelPendingCommit!==null)return p!==null&&p!==null&&ut(p),o.callbackNode=null,o.callbackPriority=0;if((h&3)===0||js(o,h)){if(s=h&-h,s===o.callbackPriority)return s;switch(p!==null&&ut(p),Bh(h)){case 2:case 8:h=oa;break;case 32:h=kn;break;case 268435456:h=ir;break;default:h=kn}return p=f1.bind(null,o),h=Ke(h,p),o.callbackPriority=s,o.callbackNode=h,s}return p!==null&&p!==null&&ut(p),o.callbackPriority=2,o.callbackNode=null,2}function f1(o,s){if(hn!==0&&hn!==5)return o.callbackNode=null,o.callbackPriority=0,null;var h=o.callbackNode;if(Cc()&&o.callbackNode!==h)return null;var p=tt;return p=Ml(o,o===xt?p:0,o.cancelPendingCommit!==null||o.timeoutHandle!==-1),p===0?null:(Kb(o,p,s),c1(o,Mt()),o.callbackNode!=null&&o.callbackNode===h?f1.bind(null,o):null)}function h1(o,s){if(Cc())return null;Kb(o,s,!0)}function TR(){PR(function(){(ht&6)!==0?Ke(gn,AR):l1()})}function _p(){return $i===0&&($i=ry()),$i}function d1(o){return o==null||typeof o=="symbol"||typeof o=="boolean"?null:typeof o=="function"?o:Pl(""+o)}function p1(o,s){var h=s.ownerDocument.createElement("input");return h.name=s.name,h.value=s.value,o.id&&h.setAttribute("form",o.id),s.parentNode.insertBefore(h,s),o=new FormData(o),h.parentNode.removeChild(h),o}function DR(o,s,h,p,y){if(s==="submit"&&h&&h.stateNode===y){var x=d1((y[On]||null).action),T=p.submitter;T&&(s=(s=T[On]||null)?d1(s.formAction):T.getAttribute("formAction"),s!==null&&(x=s,T=null));var O=new Hl("action","action",null,p,y);o.push({event:O,listeners:[{instance:null,listener:function(){if(p.defaultPrevented){if($i!==0){var z=T?p1(y,T):new FormData(y);Hd(h,{pending:!0,data:z,method:y.method,action:x},null,z)}}else typeof x=="function"&&(O.preventDefault(),z=T?p1(y,T):new FormData(y),Hd(h,{pending:!0,data:z,method:y.method,action:x},x,z))},currentTarget:y}]})}}for(var Sp=0;Sp<sd.length;Sp++){var Ep=sd[Sp],kR=Ep.toLowerCase(),OR=Ep[0].toUpperCase()+Ep.slice(1);Er(kR,"on"+OR)}Er(Ky,"onAnimationEnd"),Er(Xy,"onAnimationIteration"),Er($y,"onAnimationStart"),Er("dblclick","onDoubleClick"),Er("focusin","onFocus"),Er("focusout","onBlur"),Er(XC,"onTransitionRun"),Er($C,"onTransitionStart"),Er(YC,"onTransitionCancel"),Er(Yy,"onTransitionEnd"),_o("onMouseEnter",["mouseout","mouseover"]),_o("onMouseLeave",["mouseout","mouseover"]),_o("onPointerEnter",["pointerout","pointerover"]),_o("onPointerLeave",["pointerout","pointerover"]),Mi("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Mi("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Mi("onBeforeInput",["compositionend","keypress","textInput","paste"]),Mi("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Mi("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Mi("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Tu="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),NR=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Tu));function v1(o,s){s=(s&4)!==0;for(var h=0;h<o.length;h++){var p=o[h],y=p.event;p=p.listeners;e:{var x=void 0;if(s)for(var T=p.length-1;0<=T;T--){var O=p[T],z=O.instance,Q=O.currentTarget;if(O=O.listener,z!==x&&y.isPropagationStopped())break e;x=O,y.currentTarget=Q;try{x(y)}catch(le){pc(le)}y.currentTarget=null,x=z}else for(T=0;T<p.length;T++){if(O=p[T],z=O.instance,Q=O.currentTarget,O=O.listener,z!==x&&y.isPropagationStopped())break e;x=O,y.currentTarget=Q;try{x(y)}catch(le){pc(le)}y.currentTarget=null,x=z}}}}function Je(o,s){var h=s[Lh];h===void 0&&(h=s[Lh]=new Set);var p=o+"__bubble";h.has(p)||(m1(s,o,2,!1),h.add(p))}function Cp(o,s,h){var p=0;s&&(p|=4),m1(h,o,p,s)}var Tc="_reactListening"+Math.random().toString(36).slice(2);function Rp(o){if(!o[Tc]){o[Tc]=!0,ly.forEach(function(h){h!=="selectionchange"&&(NR.has(h)||Cp(h,!1,o),Cp(h,!0,o))});var s=o.nodeType===9?o:o.ownerDocument;s===null||s[Tc]||(s[Tc]=!0,Cp("selectionchange",!1,s))}}function m1(o,s,h,p){switch(U1(s)){case 2:var y=iA;break;case 8:y=oA;break;default:y=Up}h=y.bind(null,s,h,o),y=void 0,!Xh||s!=="touchstart"&&s!=="touchmove"&&s!=="wheel"||(y=!0),p?y!==void 0?o.addEventListener(s,h,{capture:!0,passive:y}):o.addEventListener(s,h,!0):y!==void 0?o.addEventListener(s,h,{passive:y}):o.addEventListener(s,h,!1)}function Ap(o,s,h,p,y){var x=p;if((s&1)===0&&(s&2)===0&&p!==null)e:for(;;){if(p===null)return;var T=p.tag;if(T===3||T===4){var O=p.stateNode.containerInfo;if(O===y)break;if(T===4)for(T=p.return;T!==null;){var z=T.tag;if((z===3||z===4)&&T.stateNode.containerInfo===y)return;T=T.return}for(;O!==null;){if(T=bo(O),T===null)return;if(z=T.tag,z===5||z===6||z===26||z===27){p=x=T;continue e}O=O.parentNode}}p=p.return}Sy(function(){var Q=x,le=qh(h),fe=[];e:{var Z=Qy.get(o);if(Z!==void 0){var re=Hl,Be=o;switch(o){case"keypress":if(Ul(h)===0)break e;case"keydown":case"keyup":re=RC;break;case"focusin":Be="focus",re=Zh;break;case"focusout":Be="blur",re=Zh;break;case"beforeblur":case"afterblur":re=Zh;break;case"click":if(h.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":re=Ry;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":re=pC;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":re=DC;break;case Ky:case Xy:case $y:re=gC;break;case Yy:re=OC;break;case"scroll":case"scrollend":re=hC;break;case"wheel":re=MC;break;case"copy":case"cut":case"paste":re=bC;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":re=Ty;break;case"toggle":case"beforetoggle":re=FC}var Me=(s&4)!==0,gt=!Me&&(o==="scroll"||o==="scrollend"),X=Me?Z!==null?Z+"Capture":null:Z;Me=[];for(var W=Q,$;W!==null;){var ce=W;if($=ce.stateNode,ce=ce.tag,ce!==5&&ce!==26&&ce!==27||$===null||X===null||(ce=Ks(W,X),ce!=null&&Me.push(Du(W,ce,$))),gt)break;W=W.return}0<Me.length&&(Z=new re(Z,Be,null,h,le),fe.push({event:Z,listeners:Me}))}}if((s&7)===0){e:{if(Z=o==="mouseover"||o==="pointerover",re=o==="mouseout"||o==="pointerout",Z&&h!==Gh&&(Be=h.relatedTarget||h.fromElement)&&(bo(Be)||Be[yo]))break e;if((re||Z)&&(Z=le.window===le?le:(Z=le.ownerDocument)?Z.defaultView||Z.parentWindow:window,re?(Be=h.relatedTarget||h.toElement,re=Q,Be=Be?bo(Be):null,Be!==null&&(gt=i(Be),Me=Be.tag,Be!==gt||Me!==5&&Me!==27&&Me!==6)&&(Be=null)):(re=null,Be=Q),re!==Be)){if(Me=Ry,ce="onMouseLeave",X="onMouseEnter",W="mouse",(o==="pointerout"||o==="pointerover")&&(Me=Ty,ce="onPointerLeave",X="onPointerEnter",W="pointer"),gt=re==null?Z:qs(re),$=Be==null?Z:qs(Be),Z=new Me(ce,W+"leave",re,h,le),Z.target=gt,Z.relatedTarget=$,ce=null,bo(le)===Q&&(Me=new Me(X,W+"enter",Be,h,le),Me.target=$,Me.relatedTarget=gt,ce=Me),gt=ce,re&&Be)t:{for(Me=re,X=Be,W=0,$=Me;$;$=Jo($))W++;for($=0,ce=X;ce;ce=Jo(ce))$++;for(;0<W-$;)Me=Jo(Me),W--;for(;0<$-W;)X=Jo(X),$--;for(;W--;){if(Me===X||X!==null&&Me===X.alternate)break t;Me=Jo(Me),X=Jo(X)}Me=null}else Me=null;re!==null&&g1(fe,Z,re,Me,!1),Be!==null&&gt!==null&&g1(fe,gt,Be,Me,!0)}}e:{if(Z=Q?qs(Q):window,re=Z.nodeName&&Z.nodeName.toLowerCase(),re==="select"||re==="input"&&Z.type==="file")var we=By;else if(Iy(Z))if(Ly)we=GC;else{we=jC;var $e=HC}else re=Z.nodeName,!re||re.toLowerCase()!=="input"||Z.type!=="checkbox"&&Z.type!=="radio"?Q&&Wh(Q.elementType)&&(we=By):we=WC;if(we&&(we=we(o,Q))){Fy(fe,we,h,le);break e}$e&&$e(o,Z,Q),o==="focusout"&&Q&&Z.type==="number"&&Q.memoizedProps.value!=null&&jh(Z,"number",Z.value)}switch($e=Q?qs(Q):window,o){case"focusin":(Iy($e)||$e.contentEditable==="true")&&(Do=$e,ad=Q,tu=null);break;case"focusout":tu=ad=Do=null;break;case"mousedown":id=!0;break;case"contextmenu":case"mouseup":case"dragend":id=!1,Gy(fe,h,le);break;case"selectionchange":if(KC)break;case"keydown":case"keyup":Gy(fe,h,le)}var Oe;if(ed)e:{switch(o){case"compositionstart":var Ie="onCompositionStart";break e;case"compositionend":Ie="onCompositionEnd";break e;case"compositionupdate":Ie="onCompositionUpdate";break e}Ie=void 0}else To?Ny(o,h)&&(Ie="onCompositionEnd"):o==="keydown"&&h.keyCode===229&&(Ie="onCompositionStart");Ie&&(Dy&&h.locale!=="ko"&&(To||Ie!=="onCompositionStart"?Ie==="onCompositionEnd"&&To&&(Oe=Ey()):(Ha=le,$h="value"in Ha?Ha.value:Ha.textContent,To=!0)),$e=Dc(Q,Ie),0<$e.length&&(Ie=new Ay(Ie,o,null,h,le),fe.push({event:Ie,listeners:$e}),Oe?Ie.data=Oe:(Oe=My(h),Oe!==null&&(Ie.data=Oe)))),(Oe=LC?PC(o,h):zC(o,h))&&(Ie=Dc(Q,"onBeforeInput"),0<Ie.length&&($e=new Ay("onBeforeInput","beforeinput",null,h,le),fe.push({event:$e,listeners:Ie}),$e.data=Oe)),DR(fe,o,Q,h,le)}v1(fe,s)})}function Du(o,s,h){return{instance:o,listener:s,currentTarget:h}}function Dc(o,s){for(var h=s+"Capture",p=[];o!==null;){var y=o,x=y.stateNode;if(y=y.tag,y!==5&&y!==26&&y!==27||x===null||(y=Ks(o,h),y!=null&&p.unshift(Du(o,y,x)),y=Ks(o,s),y!=null&&p.push(Du(o,y,x))),o.tag===3)return p;o=o.return}return[]}function Jo(o){if(o===null)return null;do o=o.return;while(o&&o.tag!==5&&o.tag!==27);return o||null}function g1(o,s,h,p,y){for(var x=s._reactName,T=[];h!==null&&h!==p;){var O=h,z=O.alternate,Q=O.stateNode;if(O=O.tag,z!==null&&z===p)break;O!==5&&O!==26&&O!==27||Q===null||(z=Q,y?(Q=Ks(h,x),Q!=null&&T.unshift(Du(h,Q,z))):y||(Q=Ks(h,x),Q!=null&&T.push(Du(h,Q,z)))),h=h.return}T.length!==0&&o.push({event:s,listeners:T})}var MR=/\r\n?/g,IR=/\u0000|\uFFFD/g;function y1(o){return(typeof o=="string"?o:""+o).replace(MR,`
`).replace(IR,"")}function b1(o,s){return s=y1(s),y1(o)===s}function kc(){}function mt(o,s,h,p,y,x){switch(h){case"children":typeof p=="string"?s==="body"||s==="textarea"&&p===""||Co(o,p):(typeof p=="number"||typeof p=="bigint")&&s!=="body"&&Co(o,""+p);break;case"className":Fl(o,"class",p);break;case"tabIndex":Fl(o,"tabindex",p);break;case"dir":case"role":case"viewBox":case"width":case"height":Fl(o,h,p);break;case"style":wy(o,p,x);break;case"data":if(s!=="object"){Fl(o,"data",p);break}case"src":case"href":if(p===""&&(s!=="a"||h!=="href")){o.removeAttribute(h);break}if(p==null||typeof p=="function"||typeof p=="symbol"||typeof p=="boolean"){o.removeAttribute(h);break}p=Pl(""+p),o.setAttribute(h,p);break;case"action":case"formAction":if(typeof p=="function"){o.setAttribute(h,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof x=="function"&&(h==="formAction"?(s!=="input"&&mt(o,s,"name",y.name,y,null),mt(o,s,"formEncType",y.formEncType,y,null),mt(o,s,"formMethod",y.formMethod,y,null),mt(o,s,"formTarget",y.formTarget,y,null)):(mt(o,s,"encType",y.encType,y,null),mt(o,s,"method",y.method,y,null),mt(o,s,"target",y.target,y,null)));if(p==null||typeof p=="symbol"||typeof p=="boolean"){o.removeAttribute(h);break}p=Pl(""+p),o.setAttribute(h,p);break;case"onClick":p!=null&&(o.onclick=kc);break;case"onScroll":p!=null&&Je("scroll",o);break;case"onScrollEnd":p!=null&&Je("scrollend",o);break;case"dangerouslySetInnerHTML":if(p!=null){if(typeof p!="object"||!("__html"in p))throw Error(r(61));if(h=p.__html,h!=null){if(y.children!=null)throw Error(r(60));o.innerHTML=h}}break;case"multiple":o.multiple=p&&typeof p!="function"&&typeof p!="symbol";break;case"muted":o.muted=p&&typeof p!="function"&&typeof p!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(p==null||typeof p=="function"||typeof p=="boolean"||typeof p=="symbol"){o.removeAttribute("xlink:href");break}h=Pl(""+p),o.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",h);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":p!=null&&typeof p!="function"&&typeof p!="symbol"?o.setAttribute(h,""+p):o.removeAttribute(h);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":p&&typeof p!="function"&&typeof p!="symbol"?o.setAttribute(h,""):o.removeAttribute(h);break;case"capture":case"download":p===!0?o.setAttribute(h,""):p!==!1&&p!=null&&typeof p!="function"&&typeof p!="symbol"?o.setAttribute(h,p):o.removeAttribute(h);break;case"cols":case"rows":case"size":case"span":p!=null&&typeof p!="function"&&typeof p!="symbol"&&!isNaN(p)&&1<=p?o.setAttribute(h,p):o.removeAttribute(h);break;case"rowSpan":case"start":p==null||typeof p=="function"||typeof p=="symbol"||isNaN(p)?o.removeAttribute(h):o.setAttribute(h,p);break;case"popover":Je("beforetoggle",o),Je("toggle",o),Il(o,"popover",p);break;case"xlinkActuate":ua(o,"http://www.w3.org/1999/xlink","xlink:actuate",p);break;case"xlinkArcrole":ua(o,"http://www.w3.org/1999/xlink","xlink:arcrole",p);break;case"xlinkRole":ua(o,"http://www.w3.org/1999/xlink","xlink:role",p);break;case"xlinkShow":ua(o,"http://www.w3.org/1999/xlink","xlink:show",p);break;case"xlinkTitle":ua(o,"http://www.w3.org/1999/xlink","xlink:title",p);break;case"xlinkType":ua(o,"http://www.w3.org/1999/xlink","xlink:type",p);break;case"xmlBase":ua(o,"http://www.w3.org/XML/1998/namespace","xml:base",p);break;case"xmlLang":ua(o,"http://www.w3.org/XML/1998/namespace","xml:lang",p);break;case"xmlSpace":ua(o,"http://www.w3.org/XML/1998/namespace","xml:space",p);break;case"is":Il(o,"is",p);break;case"innerText":case"textContent":break;default:(!(2<h.length)||h[0]!=="o"&&h[0]!=="O"||h[1]!=="n"&&h[1]!=="N")&&(h=cC.get(h)||h,Il(o,h,p))}}function Tp(o,s,h,p,y,x){switch(h){case"style":wy(o,p,x);break;case"dangerouslySetInnerHTML":if(p!=null){if(typeof p!="object"||!("__html"in p))throw Error(r(61));if(h=p.__html,h!=null){if(y.children!=null)throw Error(r(60));o.innerHTML=h}}break;case"children":typeof p=="string"?Co(o,p):(typeof p=="number"||typeof p=="bigint")&&Co(o,""+p);break;case"onScroll":p!=null&&Je("scroll",o);break;case"onScrollEnd":p!=null&&Je("scrollend",o);break;case"onClick":p!=null&&(o.onclick=kc);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!cy.hasOwnProperty(h))e:{if(h[0]==="o"&&h[1]==="n"&&(y=h.endsWith("Capture"),s=h.slice(2,y?h.length-7:void 0),x=o[On]||null,x=x!=null?x[h]:null,typeof x=="function"&&o.removeEventListener(s,x,y),typeof p=="function")){typeof x!="function"&&x!==null&&(h in o?o[h]=null:o.hasAttribute(h)&&o.removeAttribute(h)),o.addEventListener(s,p,y);break e}h in o?o[h]=p:p===!0?o.setAttribute(h,""):Il(o,h,p)}}}function dn(o,s,h){switch(s){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Je("error",o),Je("load",o);var p=!1,y=!1,x;for(x in h)if(h.hasOwnProperty(x)){var T=h[x];if(T!=null)switch(x){case"src":p=!0;break;case"srcSet":y=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(r(137,s));default:mt(o,s,x,T,h,null)}}y&&mt(o,s,"srcSet",h.srcSet,h,null),p&&mt(o,s,"src",h.src,h,null);return;case"input":Je("invalid",o);var O=x=T=y=null,z=null,Q=null;for(p in h)if(h.hasOwnProperty(p)){var le=h[p];if(le!=null)switch(p){case"name":y=le;break;case"type":T=le;break;case"checked":z=le;break;case"defaultChecked":Q=le;break;case"value":x=le;break;case"defaultValue":O=le;break;case"children":case"dangerouslySetInnerHTML":if(le!=null)throw Error(r(137,s));break;default:mt(o,s,p,le,h,null)}}gy(o,x,O,z,Q,T,y,!1),Bl(o);return;case"select":Je("invalid",o),p=T=x=null;for(y in h)if(h.hasOwnProperty(y)&&(O=h[y],O!=null))switch(y){case"value":x=O;break;case"defaultValue":T=O;break;case"multiple":p=O;default:mt(o,s,y,O,h,null)}s=x,h=T,o.multiple=!!p,s!=null?Eo(o,!!p,s,!1):h!=null&&Eo(o,!!p,h,!0);return;case"textarea":Je("invalid",o),x=y=p=null;for(T in h)if(h.hasOwnProperty(T)&&(O=h[T],O!=null))switch(T){case"value":p=O;break;case"defaultValue":y=O;break;case"children":x=O;break;case"dangerouslySetInnerHTML":if(O!=null)throw Error(r(91));break;default:mt(o,s,T,O,h,null)}by(o,p,y,x),Bl(o);return;case"option":for(z in h)if(h.hasOwnProperty(z)&&(p=h[z],p!=null))switch(z){case"selected":o.selected=p&&typeof p!="function"&&typeof p!="symbol";break;default:mt(o,s,z,p,h,null)}return;case"dialog":Je("beforetoggle",o),Je("toggle",o),Je("cancel",o),Je("close",o);break;case"iframe":case"object":Je("load",o);break;case"video":case"audio":for(p=0;p<Tu.length;p++)Je(Tu[p],o);break;case"image":Je("error",o),Je("load",o);break;case"details":Je("toggle",o);break;case"embed":case"source":case"link":Je("error",o),Je("load",o);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(Q in h)if(h.hasOwnProperty(Q)&&(p=h[Q],p!=null))switch(Q){case"children":case"dangerouslySetInnerHTML":throw Error(r(137,s));default:mt(o,s,Q,p,h,null)}return;default:if(Wh(s)){for(le in h)h.hasOwnProperty(le)&&(p=h[le],p!==void 0&&Tp(o,s,le,p,h,void 0));return}}for(O in h)h.hasOwnProperty(O)&&(p=h[O],p!=null&&mt(o,s,O,p,h,null))}function FR(o,s,h,p){switch(s){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var y=null,x=null,T=null,O=null,z=null,Q=null,le=null;for(re in h){var fe=h[re];if(h.hasOwnProperty(re)&&fe!=null)switch(re){case"checked":break;case"value":break;case"defaultValue":z=fe;default:p.hasOwnProperty(re)||mt(o,s,re,null,p,fe)}}for(var Z in p){var re=p[Z];if(fe=h[Z],p.hasOwnProperty(Z)&&(re!=null||fe!=null))switch(Z){case"type":x=re;break;case"name":y=re;break;case"checked":Q=re;break;case"defaultChecked":le=re;break;case"value":T=re;break;case"defaultValue":O=re;break;case"children":case"dangerouslySetInnerHTML":if(re!=null)throw Error(r(137,s));break;default:re!==fe&&mt(o,s,Z,re,p,fe)}}Hh(o,T,O,z,Q,le,x,y);return;case"select":re=T=O=Z=null;for(x in h)if(z=h[x],h.hasOwnProperty(x)&&z!=null)switch(x){case"value":break;case"multiple":re=z;default:p.hasOwnProperty(x)||mt(o,s,x,null,p,z)}for(y in p)if(x=p[y],z=h[y],p.hasOwnProperty(y)&&(x!=null||z!=null))switch(y){case"value":Z=x;break;case"defaultValue":O=x;break;case"multiple":T=x;default:x!==z&&mt(o,s,y,x,p,z)}s=O,h=T,p=re,Z!=null?Eo(o,!!h,Z,!1):!!p!=!!h&&(s!=null?Eo(o,!!h,s,!0):Eo(o,!!h,h?[]:"",!1));return;case"textarea":re=Z=null;for(O in h)if(y=h[O],h.hasOwnProperty(O)&&y!=null&&!p.hasOwnProperty(O))switch(O){case"value":break;case"children":break;default:mt(o,s,O,null,p,y)}for(T in p)if(y=p[T],x=h[T],p.hasOwnProperty(T)&&(y!=null||x!=null))switch(T){case"value":Z=y;break;case"defaultValue":re=y;break;case"children":break;case"dangerouslySetInnerHTML":if(y!=null)throw Error(r(91));break;default:y!==x&&mt(o,s,T,y,p,x)}yy(o,Z,re);return;case"option":for(var Be in h)if(Z=h[Be],h.hasOwnProperty(Be)&&Z!=null&&!p.hasOwnProperty(Be))switch(Be){case"selected":o.selected=!1;break;default:mt(o,s,Be,null,p,Z)}for(z in p)if(Z=p[z],re=h[z],p.hasOwnProperty(z)&&Z!==re&&(Z!=null||re!=null))switch(z){case"selected":o.selected=Z&&typeof Z!="function"&&typeof Z!="symbol";break;default:mt(o,s,z,Z,p,re)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Me in h)Z=h[Me],h.hasOwnProperty(Me)&&Z!=null&&!p.hasOwnProperty(Me)&&mt(o,s,Me,null,p,Z);for(Q in p)if(Z=p[Q],re=h[Q],p.hasOwnProperty(Q)&&Z!==re&&(Z!=null||re!=null))switch(Q){case"children":case"dangerouslySetInnerHTML":if(Z!=null)throw Error(r(137,s));break;default:mt(o,s,Q,Z,p,re)}return;default:if(Wh(s)){for(var gt in h)Z=h[gt],h.hasOwnProperty(gt)&&Z!==void 0&&!p.hasOwnProperty(gt)&&Tp(o,s,gt,void 0,p,Z);for(le in p)Z=p[le],re=h[le],!p.hasOwnProperty(le)||Z===re||Z===void 0&&re===void 0||Tp(o,s,le,Z,p,re);return}}for(var X in h)Z=h[X],h.hasOwnProperty(X)&&Z!=null&&!p.hasOwnProperty(X)&&mt(o,s,X,null,p,Z);for(fe in p)Z=p[fe],re=h[fe],!p.hasOwnProperty(fe)||Z===re||Z==null&&re==null||mt(o,s,fe,Z,p,re)}var Dp=null,kp=null;function Oc(o){return o.nodeType===9?o:o.ownerDocument}function x1(o){switch(o){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function w1(o,s){if(o===0)switch(s){case"svg":return 1;case"math":return 2;default:return 0}return o===1&&s==="foreignObject"?0:o}function Op(o,s){return o==="textarea"||o==="noscript"||typeof s.children=="string"||typeof s.children=="number"||typeof s.children=="bigint"||typeof s.dangerouslySetInnerHTML=="object"&&s.dangerouslySetInnerHTML!==null&&s.dangerouslySetInnerHTML.__html!=null}var Np=null;function BR(){var o=window.event;return o&&o.type==="popstate"?o===Np?!1:(Np=o,!0):(Np=null,!1)}var _1=typeof setTimeout=="function"?setTimeout:void 0,LR=typeof clearTimeout=="function"?clearTimeout:void 0,S1=typeof Promise=="function"?Promise:void 0,PR=typeof queueMicrotask=="function"?queueMicrotask:typeof S1<"u"?function(o){return S1.resolve(null).then(o).catch(zR)}:_1;function zR(o){setTimeout(function(){throw o})}function ai(o){return o==="head"}function E1(o,s){var h=s,p=0,y=0;do{var x=h.nextSibling;if(o.removeChild(h),x&&x.nodeType===8)if(h=x.data,h==="/$"){if(0<p&&8>p){h=p;var T=o.ownerDocument;if(h&1&&ku(T.documentElement),h&2&&ku(T.body),h&4)for(h=T.head,ku(h),T=h.firstChild;T;){var O=T.nextSibling,z=T.nodeName;T[Gs]||z==="SCRIPT"||z==="STYLE"||z==="LINK"&&T.rel.toLowerCase()==="stylesheet"||h.removeChild(T),T=O}}if(y===0){o.removeChild(x),Pu(s);return}y--}else h==="$"||h==="$?"||h==="$!"?y++:p=h.charCodeAt(0)-48;else p=0;h=x}while(h);Pu(s)}function Mp(o){var s=o.firstChild;for(s&&s.nodeType===10&&(s=s.nextSibling);s;){var h=s;switch(s=s.nextSibling,h.nodeName){case"HTML":case"HEAD":case"BODY":Mp(h),Ph(h);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(h.rel.toLowerCase()==="stylesheet")continue}o.removeChild(h)}}function UR(o,s,h,p){for(;o.nodeType===1;){var y=h;if(o.nodeName.toLowerCase()!==s.toLowerCase()){if(!p&&(o.nodeName!=="INPUT"||o.type!=="hidden"))break}else if(p){if(!o[Gs])switch(s){case"meta":if(!o.hasAttribute("itemprop"))break;return o;case"link":if(x=o.getAttribute("rel"),x==="stylesheet"&&o.hasAttribute("data-precedence"))break;if(x!==y.rel||o.getAttribute("href")!==(y.href==null||y.href===""?null:y.href)||o.getAttribute("crossorigin")!==(y.crossOrigin==null?null:y.crossOrigin)||o.getAttribute("title")!==(y.title==null?null:y.title))break;return o;case"style":if(o.hasAttribute("data-precedence"))break;return o;case"script":if(x=o.getAttribute("src"),(x!==(y.src==null?null:y.src)||o.getAttribute("type")!==(y.type==null?null:y.type)||o.getAttribute("crossorigin")!==(y.crossOrigin==null?null:y.crossOrigin))&&x&&o.hasAttribute("async")&&!o.hasAttribute("itemprop"))break;return o;default:return o}}else if(s==="input"&&o.type==="hidden"){var x=y.name==null?null:""+y.name;if(y.type==="hidden"&&o.getAttribute("name")===x)return o}else return o;if(o=Rr(o.nextSibling),o===null)break}return null}function VR(o,s,h){if(s==="")return null;for(;o.nodeType!==3;)if((o.nodeType!==1||o.nodeName!=="INPUT"||o.type!=="hidden")&&!h||(o=Rr(o.nextSibling),o===null))return null;return o}function Ip(o){return o.data==="$!"||o.data==="$?"&&o.ownerDocument.readyState==="complete"}function HR(o,s){var h=o.ownerDocument;if(o.data!=="$?"||h.readyState==="complete")s();else{var p=function(){s(),h.removeEventListener("DOMContentLoaded",p)};h.addEventListener("DOMContentLoaded",p),o._reactRetry=p}}function Rr(o){for(;o!=null;o=o.nextSibling){var s=o.nodeType;if(s===1||s===3)break;if(s===8){if(s=o.data,s==="$"||s==="$!"||s==="$?"||s==="F!"||s==="F")break;if(s==="/$")return null}}return o}var Fp=null;function C1(o){o=o.previousSibling;for(var s=0;o;){if(o.nodeType===8){var h=o.data;if(h==="$"||h==="$!"||h==="$?"){if(s===0)return o;s--}else h==="/$"&&s++}o=o.previousSibling}return null}function R1(o,s,h){switch(s=Oc(h),o){case"html":if(o=s.documentElement,!o)throw Error(r(452));return o;case"head":if(o=s.head,!o)throw Error(r(453));return o;case"body":if(o=s.body,!o)throw Error(r(454));return o;default:throw Error(r(451))}}function ku(o){for(var s=o.attributes;s.length;)o.removeAttributeNode(s[0]);Ph(o)}var pr=new Map,A1=new Set;function Nc(o){return typeof o.getRootNode=="function"?o.getRootNode():o.nodeType===9?o:o.ownerDocument}var _a=j.d;j.d={f:jR,r:WR,D:GR,C:qR,L:KR,m:XR,X:YR,S:$R,M:QR};function jR(){var o=_a.f(),s=Sc();return o||s}function WR(o){var s=xo(o);s!==null&&s.tag===5&&s.type==="form"?K0(s):_a.r(o)}var es=typeof document>"u"?null:document;function T1(o,s,h){var p=es;if(p&&typeof s=="string"&&s){var y=sr(s);y='link[rel="'+o+'"][href="'+y+'"]',typeof h=="string"&&(y+='[crossorigin="'+h+'"]'),A1.has(y)||(A1.add(y),o={rel:o,crossOrigin:h,href:s},p.querySelector(y)===null&&(s=p.createElement("link"),dn(s,"link",o),en(s),p.head.appendChild(s)))}}function GR(o){_a.D(o),T1("dns-prefetch",o,null)}function qR(o,s){_a.C(o,s),T1("preconnect",o,s)}function KR(o,s,h){_a.L(o,s,h);var p=es;if(p&&o&&s){var y='link[rel="preload"][as="'+sr(s)+'"]';s==="image"&&h&&h.imageSrcSet?(y+='[imagesrcset="'+sr(h.imageSrcSet)+'"]',typeof h.imageSizes=="string"&&(y+='[imagesizes="'+sr(h.imageSizes)+'"]')):y+='[href="'+sr(o)+'"]';var x=y;switch(s){case"style":x=ts(o);break;case"script":x=ns(o)}pr.has(x)||(o=d({rel:"preload",href:s==="image"&&h&&h.imageSrcSet?void 0:o,as:s},h),pr.set(x,o),p.querySelector(y)!==null||s==="style"&&p.querySelector(Ou(x))||s==="script"&&p.querySelector(Nu(x))||(s=p.createElement("link"),dn(s,"link",o),en(s),p.head.appendChild(s)))}}function XR(o,s){_a.m(o,s);var h=es;if(h&&o){var p=s&&typeof s.as=="string"?s.as:"script",y='link[rel="modulepreload"][as="'+sr(p)+'"][href="'+sr(o)+'"]',x=y;switch(p){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":x=ns(o)}if(!pr.has(x)&&(o=d({rel:"modulepreload",href:o},s),pr.set(x,o),h.querySelector(y)===null)){switch(p){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(h.querySelector(Nu(x)))return}p=h.createElement("link"),dn(p,"link",o),en(p),h.head.appendChild(p)}}}function $R(o,s,h){_a.S(o,s,h);var p=es;if(p&&o){var y=wo(p).hoistableStyles,x=ts(o);s=s||"default";var T=y.get(x);if(!T){var O={loading:0,preload:null};if(T=p.querySelector(Ou(x)))O.loading=5;else{o=d({rel:"stylesheet",href:o,"data-precedence":s},h),(h=pr.get(x))&&Bp(o,h);var z=T=p.createElement("link");en(z),dn(z,"link",o),z._p=new Promise(function(Q,le){z.onload=Q,z.onerror=le}),z.addEventListener("load",function(){O.loading|=1}),z.addEventListener("error",function(){O.loading|=2}),O.loading|=4,Mc(T,s,p)}T={type:"stylesheet",instance:T,count:1,state:O},y.set(x,T)}}}function YR(o,s){_a.X(o,s);var h=es;if(h&&o){var p=wo(h).hoistableScripts,y=ns(o),x=p.get(y);x||(x=h.querySelector(Nu(y)),x||(o=d({src:o,async:!0},s),(s=pr.get(y))&&Lp(o,s),x=h.createElement("script"),en(x),dn(x,"link",o),h.head.appendChild(x)),x={type:"script",instance:x,count:1,state:null},p.set(y,x))}}function QR(o,s){_a.M(o,s);var h=es;if(h&&o){var p=wo(h).hoistableScripts,y=ns(o),x=p.get(y);x||(x=h.querySelector(Nu(y)),x||(o=d({src:o,async:!0,type:"module"},s),(s=pr.get(y))&&Lp(o,s),x=h.createElement("script"),en(x),dn(x,"link",o),h.head.appendChild(x)),x={type:"script",instance:x,count:1,state:null},p.set(y,x))}}function D1(o,s,h,p){var y=(y=pe.current)?Nc(y):null;if(!y)throw Error(r(446));switch(o){case"meta":case"title":return null;case"style":return typeof h.precedence=="string"&&typeof h.href=="string"?(s=ts(h.href),h=wo(y).hoistableStyles,p=h.get(s),p||(p={type:"style",instance:null,count:0,state:null},h.set(s,p)),p):{type:"void",instance:null,count:0,state:null};case"link":if(h.rel==="stylesheet"&&typeof h.href=="string"&&typeof h.precedence=="string"){o=ts(h.href);var x=wo(y).hoistableStyles,T=x.get(o);if(T||(y=y.ownerDocument||y,T={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},x.set(o,T),(x=y.querySelector(Ou(o)))&&!x._p&&(T.instance=x,T.state.loading=5),pr.has(o)||(h={rel:"preload",as:"style",href:h.href,crossOrigin:h.crossOrigin,integrity:h.integrity,media:h.media,hrefLang:h.hrefLang,referrerPolicy:h.referrerPolicy},pr.set(o,h),x||ZR(y,o,h,T.state))),s&&p===null)throw Error(r(528,""));return T}if(s&&p!==null)throw Error(r(529,""));return null;case"script":return s=h.async,h=h.src,typeof h=="string"&&s&&typeof s!="function"&&typeof s!="symbol"?(s=ns(h),h=wo(y).hoistableScripts,p=h.get(s),p||(p={type:"script",instance:null,count:0,state:null},h.set(s,p)),p):{type:"void",instance:null,count:0,state:null};default:throw Error(r(444,o))}}function ts(o){return'href="'+sr(o)+'"'}function Ou(o){return'link[rel="stylesheet"]['+o+"]"}function k1(o){return d({},o,{"data-precedence":o.precedence,precedence:null})}function ZR(o,s,h,p){o.querySelector('link[rel="preload"][as="style"]['+s+"]")?p.loading=1:(s=o.createElement("link"),p.preload=s,s.addEventListener("load",function(){return p.loading|=1}),s.addEventListener("error",function(){return p.loading|=2}),dn(s,"link",h),en(s),o.head.appendChild(s))}function ns(o){return'[src="'+sr(o)+'"]'}function Nu(o){return"script[async]"+o}function O1(o,s,h){if(s.count++,s.instance===null)switch(s.type){case"style":var p=o.querySelector('style[data-href~="'+sr(h.href)+'"]');if(p)return s.instance=p,en(p),p;var y=d({},h,{"data-href":h.href,"data-precedence":h.precedence,href:null,precedence:null});return p=(o.ownerDocument||o).createElement("style"),en(p),dn(p,"style",y),Mc(p,h.precedence,o),s.instance=p;case"stylesheet":y=ts(h.href);var x=o.querySelector(Ou(y));if(x)return s.state.loading|=4,s.instance=x,en(x),x;p=k1(h),(y=pr.get(y))&&Bp(p,y),x=(o.ownerDocument||o).createElement("link"),en(x);var T=x;return T._p=new Promise(function(O,z){T.onload=O,T.onerror=z}),dn(x,"link",p),s.state.loading|=4,Mc(x,h.precedence,o),s.instance=x;case"script":return x=ns(h.src),(y=o.querySelector(Nu(x)))?(s.instance=y,en(y),y):(p=h,(y=pr.get(x))&&(p=d({},h),Lp(p,y)),o=o.ownerDocument||o,y=o.createElement("script"),en(y),dn(y,"link",p),o.head.appendChild(y),s.instance=y);case"void":return null;default:throw Error(r(443,s.type))}else s.type==="stylesheet"&&(s.state.loading&4)===0&&(p=s.instance,s.state.loading|=4,Mc(p,h.precedence,o));return s.instance}function Mc(o,s,h){for(var p=h.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),y=p.length?p[p.length-1]:null,x=y,T=0;T<p.length;T++){var O=p[T];if(O.dataset.precedence===s)x=O;else if(x!==y)break}x?x.parentNode.insertBefore(o,x.nextSibling):(s=h.nodeType===9?h.head:h,s.insertBefore(o,s.firstChild))}function Bp(o,s){o.crossOrigin==null&&(o.crossOrigin=s.crossOrigin),o.referrerPolicy==null&&(o.referrerPolicy=s.referrerPolicy),o.title==null&&(o.title=s.title)}function Lp(o,s){o.crossOrigin==null&&(o.crossOrigin=s.crossOrigin),o.referrerPolicy==null&&(o.referrerPolicy=s.referrerPolicy),o.integrity==null&&(o.integrity=s.integrity)}var Ic=null;function N1(o,s,h){if(Ic===null){var p=new Map,y=Ic=new Map;y.set(h,p)}else y=Ic,p=y.get(h),p||(p=new Map,y.set(h,p));if(p.has(o))return p;for(p.set(o,null),h=h.getElementsByTagName(o),y=0;y<h.length;y++){var x=h[y];if(!(x[Gs]||x[yn]||o==="link"&&x.getAttribute("rel")==="stylesheet")&&x.namespaceURI!=="http://www.w3.org/2000/svg"){var T=x.getAttribute(s)||"";T=o+T;var O=p.get(T);O?O.push(x):p.set(T,[x])}}return p}function M1(o,s,h){o=o.ownerDocument||o,o.head.insertBefore(h,s==="title"?o.querySelector("head > title"):null)}function JR(o,s,h){if(h===1||s.itemProp!=null)return!1;switch(o){case"meta":case"title":return!0;case"style":if(typeof s.precedence!="string"||typeof s.href!="string"||s.href==="")break;return!0;case"link":if(typeof s.rel!="string"||typeof s.href!="string"||s.href===""||s.onLoad||s.onError)break;switch(s.rel){case"stylesheet":return o=s.disabled,typeof s.precedence=="string"&&o==null;default:return!0}case"script":if(s.async&&typeof s.async!="function"&&typeof s.async!="symbol"&&!s.onLoad&&!s.onError&&s.src&&typeof s.src=="string")return!0}return!1}function I1(o){return!(o.type==="stylesheet"&&(o.state.loading&3)===0)}var Mu=null;function eA(){}function tA(o,s,h){if(Mu===null)throw Error(r(475));var p=Mu;if(s.type==="stylesheet"&&(typeof h.media!="string"||matchMedia(h.media).matches!==!1)&&(s.state.loading&4)===0){if(s.instance===null){var y=ts(h.href),x=o.querySelector(Ou(y));if(x){o=x._p,o!==null&&typeof o=="object"&&typeof o.then=="function"&&(p.count++,p=Fc.bind(p),o.then(p,p)),s.state.loading|=4,s.instance=x,en(x);return}x=o.ownerDocument||o,h=k1(h),(y=pr.get(y))&&Bp(h,y),x=x.createElement("link"),en(x);var T=x;T._p=new Promise(function(O,z){T.onload=O,T.onerror=z}),dn(x,"link",h),s.instance=x}p.stylesheets===null&&(p.stylesheets=new Map),p.stylesheets.set(s,o),(o=s.state.preload)&&(s.state.loading&3)===0&&(p.count++,s=Fc.bind(p),o.addEventListener("load",s),o.addEventListener("error",s))}}function nA(){if(Mu===null)throw Error(r(475));var o=Mu;return o.stylesheets&&o.count===0&&Pp(o,o.stylesheets),0<o.count?function(s){var h=setTimeout(function(){if(o.stylesheets&&Pp(o,o.stylesheets),o.unsuspend){var p=o.unsuspend;o.unsuspend=null,p()}},6e4);return o.unsuspend=s,function(){o.unsuspend=null,clearTimeout(h)}}:null}function Fc(){if(this.count--,this.count===0){if(this.stylesheets)Pp(this,this.stylesheets);else if(this.unsuspend){var o=this.unsuspend;this.unsuspend=null,o()}}}var Bc=null;function Pp(o,s){o.stylesheets=null,o.unsuspend!==null&&(o.count++,Bc=new Map,s.forEach(rA,o),Bc=null,Fc.call(o))}function rA(o,s){if(!(s.state.loading&4)){var h=Bc.get(o);if(h)var p=h.get(null);else{h=new Map,Bc.set(o,h);for(var y=o.querySelectorAll("link[data-precedence],style[data-precedence]"),x=0;x<y.length;x++){var T=y[x];(T.nodeName==="LINK"||T.getAttribute("media")!=="not all")&&(h.set(T.dataset.precedence,T),p=T)}p&&h.set(null,p)}y=s.instance,T=y.getAttribute("data-precedence"),x=h.get(T)||p,x===p&&h.set(null,y),h.set(T,y),this.count++,p=Fc.bind(this),y.addEventListener("load",p),y.addEventListener("error",p),x?x.parentNode.insertBefore(y,x.nextSibling):(o=o.nodeType===9?o.head:o,o.insertBefore(y,o.firstChild)),s.state.loading|=4}}var Iu={$$typeof:R,Provider:null,Consumer:null,_currentValue:K,_currentValue2:K,_threadCount:0};function aA(o,s,h,p,y,x,T,O){this.tag=1,this.containerInfo=o,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Ih(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ih(0),this.hiddenUpdates=Ih(null),this.identifierPrefix=p,this.onUncaughtError=y,this.onCaughtError=x,this.onRecoverableError=T,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=O,this.incompleteTransitions=new Map}function F1(o,s,h,p,y,x,T,O,z,Q,le,fe){return o=new aA(o,s,h,T,O,z,Q,fe),s=1,x===!0&&(s|=24),x=jn(3,null,null,s),o.current=x,x.stateNode=o,s=bd(),s.refCount++,o.pooledCache=s,s.refCount++,x.memoizedState={element:p,isDehydrated:h,cache:s},Sd(x),o}function B1(o){return o?(o=Mo,o):Mo}function L1(o,s,h,p,y,x){y=B1(y),p.context===null?p.context=y:p.pendingContext=y,p=Ga(s),p.payload={element:h},x=x===void 0?null:x,x!==null&&(p.callback=x),h=qa(o,p,s),h!==null&&(Xn(h,o,s),cu(h,o,s))}function P1(o,s){if(o=o.memoizedState,o!==null&&o.dehydrated!==null){var h=o.retryLane;o.retryLane=h!==0&&h<s?h:s}}function zp(o,s){P1(o,s),(o=o.alternate)&&P1(o,s)}function z1(o){if(o.tag===13){var s=No(o,67108864);s!==null&&Xn(s,o,67108864),zp(o,67108864)}}var Lc=!0;function iA(o,s,h,p){var y=P.T;P.T=null;var x=j.p;try{j.p=2,Up(o,s,h,p)}finally{j.p=x,P.T=y}}function oA(o,s,h,p){var y=P.T;P.T=null;var x=j.p;try{j.p=8,Up(o,s,h,p)}finally{j.p=x,P.T=y}}function Up(o,s,h,p){if(Lc){var y=Vp(p);if(y===null)Ap(o,s,p,Pc,h),V1(o,p);else if(uA(y,o,s,h,p))p.stopPropagation();else if(V1(o,p),s&4&&-1<sA.indexOf(o)){for(;y!==null;){var x=xo(y);if(x!==null)switch(x.tag){case 3:if(x=x.stateNode,x.current.memoizedState.isDehydrated){var T=Sr(x.pendingLanes);if(T!==0){var O=x;for(O.pendingLanes|=2,O.entangledLanes|=2;T;){var z=1<<31-cn(T);O.entanglements[1]|=z,T&=~z}Ur(x),(ht&6)===0&&(wc=Mt()+500,Au(0))}}break;case 13:O=No(x,2),O!==null&&Xn(O,x,2),Sc(),zp(x,2)}if(x=Vp(p),x===null&&Ap(o,s,p,Pc,h),x===y)break;y=x}y!==null&&p.stopPropagation()}else Ap(o,s,p,null,h)}}function Vp(o){return o=qh(o),Hp(o)}var Pc=null;function Hp(o){if(Pc=null,o=bo(o),o!==null){var s=i(o);if(s===null)o=null;else{var h=s.tag;if(h===13){if(o=u(s),o!==null)return o;o=null}else if(h===3){if(s.stateNode.current.memoizedState.isDehydrated)return s.tag===3?s.stateNode.containerInfo:null;o=null}else s!==o&&(o=null)}}return Pc=o,null}function U1(o){switch(o){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(ar()){case gn:return 2;case oa:return 8;case kn:case Fr:return 32;case ir:return 268435456;default:return 32}default:return 32}}var jp=!1,ii=null,oi=null,si=null,Fu=new Map,Bu=new Map,ui=[],sA="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function V1(o,s){switch(o){case"focusin":case"focusout":ii=null;break;case"dragenter":case"dragleave":oi=null;break;case"mouseover":case"mouseout":si=null;break;case"pointerover":case"pointerout":Fu.delete(s.pointerId);break;case"gotpointercapture":case"lostpointercapture":Bu.delete(s.pointerId)}}function Lu(o,s,h,p,y,x){return o===null||o.nativeEvent!==x?(o={blockedOn:s,domEventName:h,eventSystemFlags:p,nativeEvent:x,targetContainers:[y]},s!==null&&(s=xo(s),s!==null&&z1(s)),o):(o.eventSystemFlags|=p,s=o.targetContainers,y!==null&&s.indexOf(y)===-1&&s.push(y),o)}function uA(o,s,h,p,y){switch(s){case"focusin":return ii=Lu(ii,o,s,h,p,y),!0;case"dragenter":return oi=Lu(oi,o,s,h,p,y),!0;case"mouseover":return si=Lu(si,o,s,h,p,y),!0;case"pointerover":var x=y.pointerId;return Fu.set(x,Lu(Fu.get(x)||null,o,s,h,p,y)),!0;case"gotpointercapture":return x=y.pointerId,Bu.set(x,Lu(Bu.get(x)||null,o,s,h,p,y)),!0}return!1}function H1(o){var s=bo(o.target);if(s!==null){var h=i(s);if(h!==null){if(s=h.tag,s===13){if(s=u(h),s!==null){o.blockedOn=s,tC(o.priority,function(){if(h.tag===13){var p=Kn();p=Fh(p);var y=No(h,p);y!==null&&Xn(y,h,p),zp(h,p)}});return}}else if(s===3&&h.stateNode.current.memoizedState.isDehydrated){o.blockedOn=h.tag===3?h.stateNode.containerInfo:null;return}}}o.blockedOn=null}function zc(o){if(o.blockedOn!==null)return!1;for(var s=o.targetContainers;0<s.length;){var h=Vp(o.nativeEvent);if(h===null){h=o.nativeEvent;var p=new h.constructor(h.type,h);Gh=p,h.target.dispatchEvent(p),Gh=null}else return s=xo(h),s!==null&&z1(s),o.blockedOn=h,!1;s.shift()}return!0}function j1(o,s,h){zc(o)&&h.delete(s)}function lA(){jp=!1,ii!==null&&zc(ii)&&(ii=null),oi!==null&&zc(oi)&&(oi=null),si!==null&&zc(si)&&(si=null),Fu.forEach(j1),Bu.forEach(j1)}function Uc(o,s){o.blockedOn===s&&(o.blockedOn=null,jp||(jp=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,lA)))}var Vc=null;function W1(o){Vc!==o&&(Vc=o,n.unstable_scheduleCallback(n.unstable_NormalPriority,function(){Vc===o&&(Vc=null);for(var s=0;s<o.length;s+=3){var h=o[s],p=o[s+1],y=o[s+2];if(typeof p!="function"){if(Hp(p||h)===null)continue;break}var x=xo(h);x!==null&&(o.splice(s,3),s-=3,Hd(x,{pending:!0,data:y,method:h.method,action:p},p,y))}}))}function Pu(o){function s(z){return Uc(z,o)}ii!==null&&Uc(ii,o),oi!==null&&Uc(oi,o),si!==null&&Uc(si,o),Fu.forEach(s),Bu.forEach(s);for(var h=0;h<ui.length;h++){var p=ui[h];p.blockedOn===o&&(p.blockedOn=null)}for(;0<ui.length&&(h=ui[0],h.blockedOn===null);)H1(h),h.blockedOn===null&&ui.shift();if(h=(o.ownerDocument||o).$$reactFormReplay,h!=null)for(p=0;p<h.length;p+=3){var y=h[p],x=h[p+1],T=y[On]||null;if(typeof x=="function")T||W1(h);else if(T){var O=null;if(x&&x.hasAttribute("formAction")){if(y=x,T=x[On]||null)O=T.formAction;else if(Hp(y)!==null)continue}else O=T.action;typeof O=="function"?h[p+1]=O:(h.splice(p,3),p-=3),W1(h)}}}function Wp(o){this._internalRoot=o}Hc.prototype.render=Wp.prototype.render=function(o){var s=this._internalRoot;if(s===null)throw Error(r(409));var h=s.current,p=Kn();L1(h,p,o,s,null,null)},Hc.prototype.unmount=Wp.prototype.unmount=function(){var o=this._internalRoot;if(o!==null){this._internalRoot=null;var s=o.containerInfo;L1(o.current,2,null,o,null,null),Sc(),s[yo]=null}};function Hc(o){this._internalRoot=o}Hc.prototype.unstable_scheduleHydration=function(o){if(o){var s=sy();o={blockedOn:null,target:o,priority:s};for(var h=0;h<ui.length&&s!==0&&s<ui[h].priority;h++);ui.splice(h,0,o),h===0&&H1(o)}};var G1=t.version;if(G1!=="19.1.0")throw Error(r(527,G1,"19.1.0"));j.findDOMNode=function(o){var s=o._reactInternals;if(s===void 0)throw typeof o.render=="function"?Error(r(188)):(o=Object.keys(o).join(","),Error(r(268,o)));return o=c(s),o=o!==null?f(o):null,o=o===null?null:o.stateNode,o};var cA={bundleType:0,version:"19.1.0",rendererPackageName:"react-dom",currentDispatcherRef:P,reconcilerVersion:"19.1.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var jc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!jc.isDisabled&&jc.supportsFiber)try{sa=jc.inject(cA),Lt=jc}catch{}}return Uu.createRoot=function(o,s){if(!a(o))throw Error(r(299));var h=!1,p="",y=sb,x=ub,T=lb,O=null;return s!=null&&(s.unstable_strictMode===!0&&(h=!0),s.identifierPrefix!==void 0&&(p=s.identifierPrefix),s.onUncaughtError!==void 0&&(y=s.onUncaughtError),s.onCaughtError!==void 0&&(x=s.onCaughtError),s.onRecoverableError!==void 0&&(T=s.onRecoverableError),s.unstable_transitionCallbacks!==void 0&&(O=s.unstable_transitionCallbacks)),s=F1(o,1,!1,null,null,h,p,y,x,T,O,null),o[yo]=s.current,Rp(o),new Wp(s)},Uu.hydrateRoot=function(o,s,h){if(!a(o))throw Error(r(299));var p=!1,y="",x=sb,T=ub,O=lb,z=null,Q=null;return h!=null&&(h.unstable_strictMode===!0&&(p=!0),h.identifierPrefix!==void 0&&(y=h.identifierPrefix),h.onUncaughtError!==void 0&&(x=h.onUncaughtError),h.onCaughtError!==void 0&&(T=h.onCaughtError),h.onRecoverableError!==void 0&&(O=h.onRecoverableError),h.unstable_transitionCallbacks!==void 0&&(z=h.unstable_transitionCallbacks),h.formState!==void 0&&(Q=h.formState)),s=F1(o,1,!0,s,h??null,p,y,x,T,O,z,Q),s.context=B1(null),h=s.current,p=Kn(),p=Fh(p),y=Ga(p),y.callback=null,qa(h,y,p),h=p,s.current.lanes=h,Ws(s,h),Ur(s),o[yo]=s.current,Rp(o),new Hc(s)},Uu.version="19.1.0",Uu}var tx;function wA(){if(tx)return qp.exports;tx=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(t){console.error(t)}}return n(),qp.exports=xA(),qp.exports}var _A=wA();const SP=b2(_A);var Y=Im();const Pn=b2(Y);var sn=function(){return sn=Object.assign||function(t){for(var e,r=1,a=arguments.length;r<a;r++){e=arguments[r];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}return t},sn.apply(this,arguments)};function Ss(n,t,e){if(e||arguments.length===2)for(var r=0,a=t.length,i;r<a;r++)(i||!(r in t))&&(i||(i=Array.prototype.slice.call(t,0,r)),i[r]=t[r]);return n.concat(i||Array.prototype.slice.call(t))}var _t="-ms-",Qu="-moz-",ct="-webkit-",x2="comm",ih="rule",Fm="decl",SA="@import",w2="@keyframes",EA="@layer",_2=Math.abs,Bm=String.fromCharCode,Pv=Object.assign;function CA(n,t){return on(n,0)^45?(((t<<2^on(n,0))<<2^on(n,1))<<2^on(n,2))<<2^on(n,3):0}function S2(n){return n.trim()}function Ca(n,t){return(n=t.exec(n))?n[0]:n}function qe(n,t,e){return n.replace(t,e)}function hf(n,t,e){return n.indexOf(t,e)}function on(n,t){return n.charCodeAt(t)|0}function Es(n,t,e){return n.slice(t,e)}function Wr(n){return n.length}function E2(n){return n.length}function $u(n,t){return t.push(n),n}function RA(n,t){return n.map(t).join("")}function nx(n,t){return n.filter(function(e){return!Ca(e,t)})}var oh=1,Cs=1,C2=0,br=0,Ut=0,Ls="";function sh(n,t,e,r,a,i,u,l){return{value:n,root:t,parent:e,type:r,props:a,children:i,line:oh,column:Cs,length:u,return:"",siblings:l}}function hi(n,t){return Pv(sh("",null,null,"",null,null,0,n.siblings),n,{length:-n.length},t)}function rs(n){for(;n.root;)n=hi(n.root,{children:[n]});$u(n,n.siblings)}function AA(){return Ut}function TA(){return Ut=br>0?on(Ls,--br):0,Cs--,Ut===10&&(Cs=1,oh--),Ut}function kr(){return Ut=br<C2?on(Ls,br++):0,Cs++,Ut===10&&(Cs=1,oh++),Ut}function ro(){return on(Ls,br)}function df(){return br}function uh(n,t){return Es(Ls,n,t)}function zv(n){switch(n){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function DA(n){return oh=Cs=1,C2=Wr(Ls=n),br=0,[]}function kA(n){return Ls="",n}function Qp(n){return S2(uh(br-1,Uv(n===91?n+2:n===40?n+1:n)))}function OA(n){for(;(Ut=ro())&&Ut<33;)kr();return zv(n)>2||zv(Ut)>3?"":" "}function NA(n,t){for(;--t&&kr()&&!(Ut<48||Ut>102||Ut>57&&Ut<65||Ut>70&&Ut<97););return uh(n,df()+(t<6&&ro()==32&&kr()==32))}function Uv(n){for(;kr();)switch(Ut){case n:return br;case 34:case 39:n!==34&&n!==39&&Uv(Ut);break;case 40:n===41&&Uv(n);break;case 92:kr();break}return br}function MA(n,t){for(;kr()&&n+Ut!==57;)if(n+Ut===84&&ro()===47)break;return"/*"+uh(t,br-1)+"*"+Bm(n===47?n:kr())}function IA(n){for(;!zv(ro());)kr();return uh(n,br)}function FA(n){return kA(pf("",null,null,null,[""],n=DA(n),0,[0],n))}function pf(n,t,e,r,a,i,u,l,c){for(var f=0,d=0,v=u,m=0,g=0,b=0,w=1,S=1,_=1,E=0,R="",C=a,A=i,D=r,k=R;S;)switch(b=E,E=kr()){case 40:if(b!=108&&on(k,v-1)==58){hf(k+=qe(Qp(E),"&","&\f"),"&\f",_2(f?l[f-1]:0))!=-1&&(_=-1);break}case 34:case 39:case 91:k+=Qp(E);break;case 9:case 10:case 13:case 32:k+=OA(b);break;case 92:k+=NA(df()-1,7);continue;case 47:switch(ro()){case 42:case 47:$u(BA(MA(kr(),df()),t,e,c),c);break;default:k+="/"}break;case 123*w:l[f++]=Wr(k)*_;case 125*w:case 59:case 0:switch(E){case 0:case 125:S=0;case 59+d:_==-1&&(k=qe(k,/\f/g,"")),g>0&&Wr(k)-v&&$u(g>32?ax(k+";",r,e,v-1,c):ax(qe(k," ","")+";",r,e,v-2,c),c);break;case 59:k+=";";default:if($u(D=rx(k,t,e,f,d,a,l,R,C=[],A=[],v,i),i),E===123)if(d===0)pf(k,t,D,D,C,i,v,l,A);else switch(m===99&&on(k,3)===110?100:m){case 100:case 108:case 109:case 115:pf(n,D,D,r&&$u(rx(n,D,D,0,0,a,l,R,a,C=[],v,A),A),a,A,v,l,r?C:A);break;default:pf(k,D,D,D,[""],A,0,l,A)}}f=d=g=0,w=_=1,R=k="",v=u;break;case 58:v=1+Wr(k),g=b;default:if(w<1){if(E==123)--w;else if(E==125&&w++==0&&TA()==125)continue}switch(k+=Bm(E),E*w){case 38:_=d>0?1:(k+="\f",-1);break;case 44:l[f++]=(Wr(k)-1)*_,_=1;break;case 64:ro()===45&&(k+=Qp(kr())),m=ro(),d=v=Wr(R=k+=IA(df())),E++;break;case 45:b===45&&Wr(k)==2&&(w=0)}}return i}function rx(n,t,e,r,a,i,u,l,c,f,d,v){for(var m=a-1,g=a===0?i:[""],b=E2(g),w=0,S=0,_=0;w<r;++w)for(var E=0,R=Es(n,m+1,m=_2(S=u[w])),C=n;E<b;++E)(C=S2(S>0?g[E]+" "+R:qe(R,/&\f/g,g[E])))&&(c[_++]=C);return sh(n,t,e,a===0?ih:l,c,f,d,v)}function BA(n,t,e,r){return sh(n,t,e,x2,Bm(AA()),Es(n,2,-2),0,r)}function ax(n,t,e,r,a){return sh(n,t,e,Fm,Es(n,0,r),Es(n,r+1,-1),r,a)}function R2(n,t,e){switch(CA(n,t)){case 5103:return ct+"print-"+n+n;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return ct+n+n;case 4789:return Qu+n+n;case 5349:case 4246:case 4810:case 6968:case 2756:return ct+n+Qu+n+_t+n+n;case 5936:switch(on(n,t+11)){case 114:return ct+n+_t+qe(n,/[svh]\w+-[tblr]{2}/,"tb")+n;case 108:return ct+n+_t+qe(n,/[svh]\w+-[tblr]{2}/,"tb-rl")+n;case 45:return ct+n+_t+qe(n,/[svh]\w+-[tblr]{2}/,"lr")+n}case 6828:case 4268:case 2903:return ct+n+_t+n+n;case 6165:return ct+n+_t+"flex-"+n+n;case 5187:return ct+n+qe(n,/(\w+).+(:[^]+)/,ct+"box-$1$2"+_t+"flex-$1$2")+n;case 5443:return ct+n+_t+"flex-item-"+qe(n,/flex-|-self/g,"")+(Ca(n,/flex-|baseline/)?"":_t+"grid-row-"+qe(n,/flex-|-self/g,""))+n;case 4675:return ct+n+_t+"flex-line-pack"+qe(n,/align-content|flex-|-self/g,"")+n;case 5548:return ct+n+_t+qe(n,"shrink","negative")+n;case 5292:return ct+n+_t+qe(n,"basis","preferred-size")+n;case 6060:return ct+"box-"+qe(n,"-grow","")+ct+n+_t+qe(n,"grow","positive")+n;case 4554:return ct+qe(n,/([^-])(transform)/g,"$1"+ct+"$2")+n;case 6187:return qe(qe(qe(n,/(zoom-|grab)/,ct+"$1"),/(image-set)/,ct+"$1"),n,"")+n;case 5495:case 3959:return qe(n,/(image-set\([^]*)/,ct+"$1$`$1");case 4968:return qe(qe(n,/(.+:)(flex-)?(.*)/,ct+"box-pack:$3"+_t+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+ct+n+n;case 4200:if(!Ca(n,/flex-|baseline/))return _t+"grid-column-align"+Es(n,t)+n;break;case 2592:case 3360:return _t+qe(n,"template-","")+n;case 4384:case 3616:return e&&e.some(function(r,a){return t=a,Ca(r.props,/grid-\w+-end/)})?~hf(n+(e=e[t].value),"span",0)?n:_t+qe(n,"-start","")+n+_t+"grid-row-span:"+(~hf(e,"span",0)?Ca(e,/\d+/):+Ca(e,/\d+/)-+Ca(n,/\d+/))+";":_t+qe(n,"-start","")+n;case 4896:case 4128:return e&&e.some(function(r){return Ca(r.props,/grid-\w+-start/)})?n:_t+qe(qe(n,"-end","-span"),"span ","")+n;case 4095:case 3583:case 4068:case 2532:return qe(n,/(.+)-inline(.+)/,ct+"$1$2")+n;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(Wr(n)-1-t>6)switch(on(n,t+1)){case 109:if(on(n,t+4)!==45)break;case 102:return qe(n,/(.+:)(.+)-([^]+)/,"$1"+ct+"$2-$3$1"+Qu+(on(n,t+3)==108?"$3":"$2-$3"))+n;case 115:return~hf(n,"stretch",0)?R2(qe(n,"stretch","fill-available"),t,e)+n:n}break;case 5152:case 5920:return qe(n,/(.+?):(\d+)(\s*\/\s*(span)?\s*(\d+))?(.*)/,function(r,a,i,u,l,c,f){return _t+a+":"+i+f+(u?_t+a+"-span:"+(l?c:+c-+i)+f:"")+n});case 4949:if(on(n,t+6)===121)return qe(n,":",":"+ct)+n;break;case 6444:switch(on(n,on(n,14)===45?18:11)){case 120:return qe(n,/(.+:)([^;\s!]+)(;|(\s+)?!.+)?/,"$1"+ct+(on(n,14)===45?"inline-":"")+"box$3$1"+ct+"$2$3$1"+_t+"$2box$3")+n;case 100:return qe(n,":",":"+_t)+n}break;case 5719:case 2647:case 2135:case 3927:case 2391:return qe(n,"scroll-","scroll-snap-")+n}return n}function xf(n,t){for(var e="",r=0;r<n.length;r++)e+=t(n[r],r,n,t)||"";return e}function LA(n,t,e,r){switch(n.type){case EA:if(n.children.length)break;case SA:case Fm:return n.return=n.return||n.value;case x2:return"";case w2:return n.return=n.value+"{"+xf(n.children,r)+"}";case ih:if(!Wr(n.value=n.props.join(",")))return""}return Wr(e=xf(n.children,r))?n.return=n.value+"{"+e+"}":""}function PA(n){var t=E2(n);return function(e,r,a,i){for(var u="",l=0;l<t;l++)u+=n[l](e,r,a,i)||"";return u}}function zA(n){return function(t){t.root||(t=t.return)&&n(t)}}function UA(n,t,e,r){if(n.length>-1&&!n.return)switch(n.type){case Fm:n.return=R2(n.value,n.length,e);return;case w2:return xf([hi(n,{value:qe(n.value,"@","@"+ct)})],r);case ih:if(n.length)return RA(e=n.props,function(a){switch(Ca(a,r=/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":rs(hi(n,{props:[qe(a,/:(read-\w+)/,":"+Qu+"$1")]})),rs(hi(n,{props:[a]})),Pv(n,{props:nx(e,r)});break;case"::placeholder":rs(hi(n,{props:[qe(a,/:(plac\w+)/,":"+ct+"input-$1")]})),rs(hi(n,{props:[qe(a,/:(plac\w+)/,":"+Qu+"$1")]})),rs(hi(n,{props:[qe(a,/:(plac\w+)/,_t+"input-$1")]})),rs(hi(n,{props:[a]})),Pv(n,{props:nx(e,r)});break}return""})}}var VA={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},$n={},Rs=typeof process<"u"&&$n!==void 0&&($n.REACT_APP_SC_ATTR||$n.SC_ATTR)||"data-styled",A2="active",T2="data-styled-version",lh="6.1.19",Lm=`/*!sc*/
`,wf=typeof window<"u"&&typeof document<"u",HA=!!(typeof SC_DISABLE_SPEEDY=="boolean"?SC_DISABLE_SPEEDY:typeof process<"u"&&$n!==void 0&&$n.REACT_APP_SC_DISABLE_SPEEDY!==void 0&&$n.REACT_APP_SC_DISABLE_SPEEDY!==""?$n.REACT_APP_SC_DISABLE_SPEEDY!=="false"&&$n.REACT_APP_SC_DISABLE_SPEEDY:typeof process<"u"&&$n!==void 0&&$n.SC_DISABLE_SPEEDY!==void 0&&$n.SC_DISABLE_SPEEDY!==""&&$n.SC_DISABLE_SPEEDY!=="false"&&$n.SC_DISABLE_SPEEDY),jA={},ch=Object.freeze([]),As=Object.freeze({});function D2(n,t,e){return e===void 0&&(e=As),n.theme!==e.theme&&n.theme||t||e.theme}var k2=new Set(["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","tr","track","u","ul","use","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","marker","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"]),WA=/[!"#$%&'()*+,./:;<=>?@[\\\]^`{|}~-]+/g,GA=/(^-|-$)/g;function ix(n){return n.replace(WA,"-").replace(GA,"")}var qA=/(a)(d)/gi,Wc=52,ox=function(n){return String.fromCharCode(n+(n>25?39:97))};function Vv(n){var t,e="";for(t=Math.abs(n);t>Wc;t=t/Wc|0)e=ox(t%Wc)+e;return(ox(t%Wc)+e).replace(qA,"$1-$2")}var Zp,O2=5381,vs=function(n,t){for(var e=t.length;e;)n=33*n^t.charCodeAt(--e);return n},N2=function(n){return vs(O2,n)};function Pm(n){return Vv(N2(n)>>>0)}function KA(n){return n.displayName||n.name||"Component"}function Jp(n){return typeof n=="string"&&!0}var M2=typeof Symbol=="function"&&Symbol.for,I2=M2?Symbol.for("react.memo"):60115,XA=M2?Symbol.for("react.forward_ref"):60112,$A={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},YA={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},F2={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},QA=((Zp={})[XA]={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},Zp[I2]=F2,Zp);function sx(n){return("type"in(t=n)&&t.type.$$typeof)===I2?F2:"$$typeof"in n?QA[n.$$typeof]:$A;var t}var ZA=Object.defineProperty,JA=Object.getOwnPropertyNames,ux=Object.getOwnPropertySymbols,eT=Object.getOwnPropertyDescriptor,tT=Object.getPrototypeOf,lx=Object.prototype;function B2(n,t,e){if(typeof t!="string"){if(lx){var r=tT(t);r&&r!==lx&&B2(n,r,e)}var a=JA(t);ux&&(a=a.concat(ux(t)));for(var i=sx(n),u=sx(t),l=0;l<a.length;++l){var c=a[l];if(!(c in YA||e&&e[c]||u&&c in u||i&&c in i)){var f=eT(t,c);try{ZA(n,c,f)}catch{}}}}return n}function so(n){return typeof n=="function"}function zm(n){return typeof n=="object"&&"styledComponentId"in n}function eo(n,t){return n&&t?"".concat(n," ").concat(t):n||t||""}function _f(n,t){if(n.length===0)return"";for(var e=n[0],r=1;r<n.length;r++)e+=n[r];return e}function nl(n){return n!==null&&typeof n=="object"&&n.constructor.name===Object.name&&!("props"in n&&n.$$typeof)}function Hv(n,t,e){if(e===void 0&&(e=!1),!e&&!nl(n)&&!Array.isArray(n))return t;if(Array.isArray(t))for(var r=0;r<t.length;r++)n[r]=Hv(n[r],t[r]);else if(nl(t))for(var r in t)n[r]=Hv(n[r],t[r]);return n}function Um(n,t){Object.defineProperty(n,"toString",{value:t})}function Ci(n){for(var t=[],e=1;e<arguments.length;e++)t[e-1]=arguments[e];return new Error("An error occurred. See https://github.com/styled-components/styled-components/blob/main/packages/styled-components/src/utils/errors.md#".concat(n," for more information.").concat(t.length>0?" Args: ".concat(t.join(", ")):""))}var nT=function(){function n(t){this.groupSizes=new Uint32Array(512),this.length=512,this.tag=t}return n.prototype.indexOfGroup=function(t){for(var e=0,r=0;r<t;r++)e+=this.groupSizes[r];return e},n.prototype.insertRules=function(t,e){if(t>=this.groupSizes.length){for(var r=this.groupSizes,a=r.length,i=a;t>=i;)if((i<<=1)<0)throw Ci(16,"".concat(t));this.groupSizes=new Uint32Array(i),this.groupSizes.set(r),this.length=i;for(var u=a;u<i;u++)this.groupSizes[u]=0}for(var l=this.indexOfGroup(t+1),c=(u=0,e.length);u<c;u++)this.tag.insertRule(l,e[u])&&(this.groupSizes[t]++,l++)},n.prototype.clearGroup=function(t){if(t<this.length){var e=this.groupSizes[t],r=this.indexOfGroup(t),a=r+e;this.groupSizes[t]=0;for(var i=r;i<a;i++)this.tag.deleteRule(r)}},n.prototype.getGroup=function(t){var e="";if(t>=this.length||this.groupSizes[t]===0)return e;for(var r=this.groupSizes[t],a=this.indexOfGroup(t),i=a+r,u=a;u<i;u++)e+="".concat(this.tag.getRule(u)).concat(Lm);return e},n}(),vf=new Map,Sf=new Map,mf=1,Gc=function(n){if(vf.has(n))return vf.get(n);for(;Sf.has(mf);)mf++;var t=mf++;return vf.set(n,t),Sf.set(t,n),t},rT=function(n,t){mf=t+1,vf.set(n,t),Sf.set(t,n)},aT="style[".concat(Rs,"][").concat(T2,'="').concat(lh,'"]'),iT=new RegExp("^".concat(Rs,'\\.g(\\d+)\\[id="([\\w\\d-]+)"\\].*?"([^"]*)')),oT=function(n,t,e){for(var r,a=e.split(","),i=0,u=a.length;i<u;i++)(r=a[i])&&n.registerName(t,r)},sT=function(n,t){for(var e,r=((e=t.textContent)!==null&&e!==void 0?e:"").split(Lm),a=[],i=0,u=r.length;i<u;i++){var l=r[i].trim();if(l){var c=l.match(iT);if(c){var f=0|parseInt(c[1],10),d=c[2];f!==0&&(rT(d,f),oT(n,d,c[3]),n.getTag().insertRules(f,a)),a.length=0}else a.push(l)}}},cx=function(n){for(var t=document.querySelectorAll(aT),e=0,r=t.length;e<r;e++){var a=t[e];a&&a.getAttribute(Rs)!==A2&&(sT(n,a),a.parentNode&&a.parentNode.removeChild(a))}};function uT(){return typeof __webpack_nonce__<"u"?__webpack_nonce__:null}var L2=function(n){var t=document.head,e=n||t,r=document.createElement("style"),a=function(l){var c=Array.from(l.querySelectorAll("style[".concat(Rs,"]")));return c[c.length-1]}(e),i=a!==void 0?a.nextSibling:null;r.setAttribute(Rs,A2),r.setAttribute(T2,lh);var u=uT();return u&&r.setAttribute("nonce",u),e.insertBefore(r,i),r},lT=function(){function n(t){this.element=L2(t),this.element.appendChild(document.createTextNode("")),this.sheet=function(e){if(e.sheet)return e.sheet;for(var r=document.styleSheets,a=0,i=r.length;a<i;a++){var u=r[a];if(u.ownerNode===e)return u}throw Ci(17)}(this.element),this.length=0}return n.prototype.insertRule=function(t,e){try{return this.sheet.insertRule(e,t),this.length++,!0}catch{return!1}},n.prototype.deleteRule=function(t){this.sheet.deleteRule(t),this.length--},n.prototype.getRule=function(t){var e=this.sheet.cssRules[t];return e&&e.cssText?e.cssText:""},n}(),cT=function(){function n(t){this.element=L2(t),this.nodes=this.element.childNodes,this.length=0}return n.prototype.insertRule=function(t,e){if(t<=this.length&&t>=0){var r=document.createTextNode(e);return this.element.insertBefore(r,this.nodes[t]||null),this.length++,!0}return!1},n.prototype.deleteRule=function(t){this.element.removeChild(this.nodes[t]),this.length--},n.prototype.getRule=function(t){return t<this.length?this.nodes[t].textContent:""},n}(),fT=function(){function n(t){this.rules=[],this.length=0}return n.prototype.insertRule=function(t,e){return t<=this.length&&(this.rules.splice(t,0,e),this.length++,!0)},n.prototype.deleteRule=function(t){this.rules.splice(t,1),this.length--},n.prototype.getRule=function(t){return t<this.length?this.rules[t]:""},n}(),fx=wf,hT={isServer:!wf,useCSSOMInjection:!HA},Ef=function(){function n(t,e,r){t===void 0&&(t=As),e===void 0&&(e={});var a=this;this.options=sn(sn({},hT),t),this.gs=e,this.names=new Map(r),this.server=!!t.isServer,!this.server&&wf&&fx&&(fx=!1,cx(this)),Um(this,function(){return function(i){for(var u=i.getTag(),l=u.length,c="",f=function(v){var m=function(_){return Sf.get(_)}(v);if(m===void 0)return"continue";var g=i.names.get(m),b=u.getGroup(v);if(g===void 0||!g.size||b.length===0)return"continue";var w="".concat(Rs,".g").concat(v,'[id="').concat(m,'"]'),S="";g!==void 0&&g.forEach(function(_){_.length>0&&(S+="".concat(_,","))}),c+="".concat(b).concat(w,'{content:"').concat(S,'"}').concat(Lm)},d=0;d<l;d++)f(d);return c}(a)})}return n.registerId=function(t){return Gc(t)},n.prototype.rehydrate=function(){!this.server&&wf&&cx(this)},n.prototype.reconstructWithOptions=function(t,e){return e===void 0&&(e=!0),new n(sn(sn({},this.options),t),this.gs,e&&this.names||void 0)},n.prototype.allocateGSInstance=function(t){return this.gs[t]=(this.gs[t]||0)+1},n.prototype.getTag=function(){return this.tag||(this.tag=(t=function(e){var r=e.useCSSOMInjection,a=e.target;return e.isServer?new fT(a):r?new lT(a):new cT(a)}(this.options),new nT(t)));var t},n.prototype.hasNameForId=function(t,e){return this.names.has(t)&&this.names.get(t).has(e)},n.prototype.registerName=function(t,e){if(Gc(t),this.names.has(t))this.names.get(t).add(e);else{var r=new Set;r.add(e),this.names.set(t,r)}},n.prototype.insertRules=function(t,e,r){this.registerName(t,e),this.getTag().insertRules(Gc(t),r)},n.prototype.clearNames=function(t){this.names.has(t)&&this.names.get(t).clear()},n.prototype.clearRules=function(t){this.getTag().clearGroup(Gc(t)),this.clearNames(t)},n.prototype.clearTag=function(){this.tag=void 0},n}(),dT=/&/g,pT=/^\s*\/\/.*$/gm;function P2(n,t){return n.map(function(e){return e.type==="rule"&&(e.value="".concat(t," ").concat(e.value),e.value=e.value.replaceAll(",",",".concat(t," ")),e.props=e.props.map(function(r){return"".concat(t," ").concat(r)})),Array.isArray(e.children)&&e.type!=="@keyframes"&&(e.children=P2(e.children,t)),e})}function vT(n){var t,e,r,a=As,i=a.options,u=i===void 0?As:i,l=a.plugins,c=l===void 0?ch:l,f=function(m,g,b){return b.startsWith(e)&&b.endsWith(e)&&b.replaceAll(e,"").length>0?".".concat(t):m},d=c.slice();d.push(function(m){m.type===ih&&m.value.includes("&")&&(m.props[0]=m.props[0].replace(dT,e).replace(r,f))}),u.prefix&&d.push(UA),d.push(LA);var v=function(m,g,b,w){g===void 0&&(g=""),b===void 0&&(b=""),w===void 0&&(w="&"),t=w,e=g,r=new RegExp("\\".concat(e,"\\b"),"g");var S=m.replace(pT,""),_=FA(b||g?"".concat(b," ").concat(g," { ").concat(S," }"):S);u.namespace&&(_=P2(_,u.namespace));var E=[];return xf(_,PA(d.concat(zA(function(R){return E.push(R)})))),E};return v.hash=c.length?c.reduce(function(m,g){return g.name||Ci(15),vs(m,g.name)},O2).toString():"",v}var mT=new Ef,jv=vT(),z2=Pn.createContext({shouldForwardProp:void 0,styleSheet:mT,stylis:jv});z2.Consumer;Pn.createContext(void 0);function Wv(){return Y.useContext(z2)}var U2=function(){function n(t,e){var r=this;this.inject=function(a,i){i===void 0&&(i=jv);var u=r.name+i.hash;a.hasNameForId(r.id,u)||a.insertRules(r.id,u,i(r.rules,u,"@keyframes"))},this.name=t,this.id="sc-keyframes-".concat(t),this.rules=e,Um(this,function(){throw Ci(12,String(r.name))})}return n.prototype.getName=function(t){return t===void 0&&(t=jv),this.name+t.hash},n}(),gT=function(n){return n>="A"&&n<="Z"};function hx(n){for(var t="",e=0;e<n.length;e++){var r=n[e];if(e===1&&r==="-"&&n[0]==="-")return n;gT(r)?t+="-"+r.toLowerCase():t+=r}return t.startsWith("ms-")?"-"+t:t}var V2=function(n){return n==null||n===!1||n===""},H2=function(n){var t,e,r=[];for(var a in n){var i=n[a];n.hasOwnProperty(a)&&!V2(i)&&(Array.isArray(i)&&i.isCss||so(i)?r.push("".concat(hx(a),":"),i,";"):nl(i)?r.push.apply(r,Ss(Ss(["".concat(a," {")],H2(i),!1),["}"],!1)):r.push("".concat(hx(a),": ").concat((t=a,(e=i)==null||typeof e=="boolean"||e===""?"":typeof e!="number"||e===0||t in VA||t.startsWith("--")?String(e).trim():"".concat(e,"px")),";")))}return r};function bi(n,t,e,r){if(V2(n))return[];if(zm(n))return[".".concat(n.styledComponentId)];if(so(n)){if(!so(i=n)||i.prototype&&i.prototype.isReactComponent||!t)return[n];var a=n(t);return bi(a,t,e,r)}var i;return n instanceof U2?e?(n.inject(e,r),[n.getName(r)]):[n]:nl(n)?H2(n):Array.isArray(n)?Array.prototype.concat.apply(ch,n.map(function(u){return bi(u,t,e,r)})):[n.toString()]}function j2(n){for(var t=0;t<n.length;t+=1){var e=n[t];if(so(e)&&!zm(e))return!1}return!0}var yT=N2(lh),bT=function(){function n(t,e,r){this.rules=t,this.staticRulesId="",this.isStatic=(r===void 0||r.isStatic)&&j2(t),this.componentId=e,this.baseHash=vs(yT,e),this.baseStyle=r,Ef.registerId(e)}return n.prototype.generateAndInjectStyles=function(t,e,r){var a=this.baseStyle?this.baseStyle.generateAndInjectStyles(t,e,r):"";if(this.isStatic&&!r.hash)if(this.staticRulesId&&e.hasNameForId(this.componentId,this.staticRulesId))a=eo(a,this.staticRulesId);else{var i=_f(bi(this.rules,t,e,r)),u=Vv(vs(this.baseHash,i)>>>0);if(!e.hasNameForId(this.componentId,u)){var l=r(i,".".concat(u),void 0,this.componentId);e.insertRules(this.componentId,u,l)}a=eo(a,u),this.staticRulesId=u}else{for(var c=vs(this.baseHash,r.hash),f="",d=0;d<this.rules.length;d++){var v=this.rules[d];if(typeof v=="string")f+=v;else if(v){var m=_f(bi(v,t,e,r));c=vs(c,m+d),f+=m}}if(f){var g=Vv(c>>>0);e.hasNameForId(this.componentId,g)||e.insertRules(this.componentId,g,r(f,".".concat(g),void 0,this.componentId)),a=eo(a,g)}}return a},n}(),Ts=Pn.createContext(void 0);Ts.Consumer;function EP(){var n=Y.useContext(Ts);if(!n)throw Ci(18);return n}function CP(n){var t=Pn.useContext(Ts),e=Y.useMemo(function(){return function(r,a){if(!r)throw Ci(14);if(so(r)){var i=r(a);return i}if(Array.isArray(r)||typeof r!="object")throw Ci(8);return a?sn(sn({},a),r):r}(n.theme,t)},[n.theme,t]);return n.children?Pn.createElement(Ts.Provider,{value:e},n.children):null}var ev={};function xT(n,t,e){var r=zm(n),a=n,i=!Jp(n),u=t.attrs,l=u===void 0?ch:u,c=t.componentId,f=c===void 0?function(C,A){var D=typeof C!="string"?"sc":ix(C);ev[D]=(ev[D]||0)+1;var k="".concat(D,"-").concat(Pm(lh+D+ev[D]));return A?"".concat(A,"-").concat(k):k}(t.displayName,t.parentComponentId):c,d=t.displayName,v=d===void 0?function(C){return Jp(C)?"styled.".concat(C):"Styled(".concat(KA(C),")")}(n):d,m=t.displayName&&t.componentId?"".concat(ix(t.displayName),"-").concat(t.componentId):t.componentId||f,g=r&&a.attrs?a.attrs.concat(l).filter(Boolean):l,b=t.shouldForwardProp;if(r&&a.shouldForwardProp){var w=a.shouldForwardProp;if(t.shouldForwardProp){var S=t.shouldForwardProp;b=function(C,A){return w(C,A)&&S(C,A)}}else b=w}var _=new bT(e,m,r?a.componentStyle:void 0);function E(C,A){return function(D,k,I){var N=D.attrs,B=D.componentStyle,V=D.defaultProps,U=D.foldedComponentIds,J=D.styledComponentId,ee=D.target,te=Pn.useContext(Ts),P=Wv(),j=D.shouldForwardProp||P.shouldForwardProp,K=D2(k,te,V)||As,ne=function(me,pe,ke){for(var ye,Ne=sn(sn({},pe),{className:void 0,theme:ke}),at=0;at<me.length;at+=1){var Fe=so(ye=me[at])?ye(Ne):ye;for(var je in Fe)Ne[je]=je==="className"?eo(Ne[je],Fe[je]):je==="style"?sn(sn({},Ne[je]),Fe[je]):Fe[je]}return pe.className&&(Ne.className=eo(Ne.className,pe.className)),Ne}(N,k,K),M=ne.as||ee,G={};for(var ie in ne)ne[ie]===void 0||ie[0]==="$"||ie==="as"||ie==="theme"&&ne.theme===K||(ie==="forwardedAs"?G.as=ne.forwardedAs:j&&!j(ie,M)||(G[ie]=ne[ie]));var oe=function(me,pe){var ke=Wv(),ye=me.generateAndInjectStyles(pe,ke.styleSheet,ke.stylis);return ye}(B,ne),de=eo(U,J);return oe&&(de+=" "+oe),ne.className&&(de+=" "+ne.className),G[Jp(M)&&!k2.has(M)?"class":"className"]=de,I&&(G.ref=I),Y.createElement(M,G)}(R,C,A)}E.displayName=v;var R=Pn.forwardRef(E);return R.attrs=g,R.componentStyle=_,R.displayName=v,R.shouldForwardProp=b,R.foldedComponentIds=r?eo(a.foldedComponentIds,a.styledComponentId):"",R.styledComponentId=m,R.target=r?a.target:n,Object.defineProperty(R,"defaultProps",{get:function(){return this._foldedDefaultProps},set:function(C){this._foldedDefaultProps=r?function(A){for(var D=[],k=1;k<arguments.length;k++)D[k-1]=arguments[k];for(var I=0,N=D;I<N.length;I++)Hv(A,N[I],!0);return A}({},a.defaultProps,C):C}}),Um(R,function(){return".".concat(R.styledComponentId)}),i&&B2(R,n,{attrs:!0,componentStyle:!0,displayName:!0,foldedComponentIds:!0,shouldForwardProp:!0,styledComponentId:!0,target:!0}),R}function dx(n,t){for(var e=[n[0]],r=0,a=t.length;r<a;r+=1)e.push(t[r],n[r+1]);return e}var px=function(n){return Object.assign(n,{isCss:!0})};function Vm(n){for(var t=[],e=1;e<arguments.length;e++)t[e-1]=arguments[e];if(so(n)||nl(n))return px(bi(dx(ch,Ss([n],t,!0))));var r=n;return t.length===0&&r.length===1&&typeof r[0]=="string"?bi(r):px(bi(dx(r,t)))}function Gv(n,t,e){if(e===void 0&&(e=As),!t)throw Ci(1,t);var r=function(a){for(var i=[],u=1;u<arguments.length;u++)i[u-1]=arguments[u];return n(t,e,Vm.apply(void 0,Ss([a],i,!1)))};return r.attrs=function(a){return Gv(n,t,sn(sn({},e),{attrs:Array.prototype.concat(e.attrs,a).filter(Boolean)}))},r.withConfig=function(a){return Gv(n,t,sn(sn({},e),a))},r}var W2=function(n){return Gv(xT,n)},wT=W2;k2.forEach(function(n){wT[n]=W2(n)});var _T=function(){function n(t,e){this.rules=t,this.componentId=e,this.isStatic=j2(t),Ef.registerId(this.componentId+1)}return n.prototype.createStyles=function(t,e,r,a){var i=a(_f(bi(this.rules,e,r,a)),""),u=this.componentId+t;r.insertRules(u,u,i)},n.prototype.removeStyles=function(t,e){e.clearRules(this.componentId+t)},n.prototype.renderStyles=function(t,e,r,a){t>2&&Ef.registerId(this.componentId+t),this.removeStyles(t,r),this.createStyles(t,e,r,a)},n}();function RP(n){for(var t=[],e=1;e<arguments.length;e++)t[e-1]=arguments[e];var r=Vm.apply(void 0,Ss([n],t,!1)),a="sc-global-".concat(Pm(JSON.stringify(r))),i=new _T(r,a),u=function(c){var f=Wv(),d=Pn.useContext(Ts),v=Pn.useRef(f.styleSheet.allocateGSInstance(a)).current;return f.styleSheet.server&&l(v,c,f.styleSheet,d,f.stylis),Pn.useLayoutEffect(function(){if(!f.styleSheet.server)return l(v,c,f.styleSheet,d,f.stylis),function(){return i.removeStyles(v,f.styleSheet)}},[v,c,f.styleSheet,d,f.stylis]),null};function l(c,f,d,v,m){if(i.isStatic)i.renderStyles(c,jA,d,m);else{var g=sn(sn({},f),{theme:D2(f,v,u.defaultProps)});i.renderStyles(c,g,d,m)}}return Pn.memo(u)}function AP(n){for(var t=[],e=1;e<arguments.length;e++)t[e-1]=arguments[e];var r=_f(Vm.apply(void 0,Ss([n],t,!1))),a=Pm(r);return new U2(a,r)}var Vu={},vx;function ST(){if(vx)return Vu;vx=1,Object.defineProperty(Vu,"__esModule",{value:!0}),Vu.parse=u,Vu.serialize=f;const n=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,t=/^[\u0021-\u003A\u003C-\u007E]*$/,e=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,r=/^[\u0020-\u003A\u003D-\u007E]*$/,a=Object.prototype.toString,i=(()=>{const m=function(){};return m.prototype=Object.create(null),m})();function u(m,g){const b=new i,w=m.length;if(w<2)return b;const S=g?.decode||d;let _=0;do{const E=m.indexOf("=",_);if(E===-1)break;const R=m.indexOf(";",_),C=R===-1?w:R;if(E>C){_=m.lastIndexOf(";",E-1)+1;continue}const A=l(m,_,E),D=c(m,E,A),k=m.slice(A,D);if(b[k]===void 0){let I=l(m,E+1,C),N=c(m,C,I);const B=S(m.slice(I,N));b[k]=B}_=C+1}while(_<w);return b}function l(m,g,b){do{const w=m.charCodeAt(g);if(w!==32&&w!==9)return g}while(++g<b);return b}function c(m,g,b){for(;g>b;){const w=m.charCodeAt(--g);if(w!==32&&w!==9)return g+1}return b}function f(m,g,b){const w=b?.encode||encodeURIComponent;if(!n.test(m))throw new TypeError(`argument name is invalid: ${m}`);const S=w(g);if(!t.test(S))throw new TypeError(`argument val is invalid: ${g}`);let _=m+"="+S;if(!b)return _;if(b.maxAge!==void 0){if(!Number.isInteger(b.maxAge))throw new TypeError(`option maxAge is invalid: ${b.maxAge}`);_+="; Max-Age="+b.maxAge}if(b.domain){if(!e.test(b.domain))throw new TypeError(`option domain is invalid: ${b.domain}`);_+="; Domain="+b.domain}if(b.path){if(!r.test(b.path))throw new TypeError(`option path is invalid: ${b.path}`);_+="; Path="+b.path}if(b.expires){if(!v(b.expires)||!Number.isFinite(b.expires.valueOf()))throw new TypeError(`option expires is invalid: ${b.expires}`);_+="; Expires="+b.expires.toUTCString()}if(b.httpOnly&&(_+="; HttpOnly"),b.secure&&(_+="; Secure"),b.partitioned&&(_+="; Partitioned"),b.priority)switch(typeof b.priority=="string"?b.priority.toLowerCase():void 0){case"low":_+="; Priority=Low";break;case"medium":_+="; Priority=Medium";break;case"high":_+="; Priority=High";break;default:throw new TypeError(`option priority is invalid: ${b.priority}`)}if(b.sameSite)switch(typeof b.sameSite=="string"?b.sameSite.toLowerCase():b.sameSite){case!0:case"strict":_+="; SameSite=Strict";break;case"lax":_+="; SameSite=Lax";break;case"none":_+="; SameSite=None";break;default:throw new TypeError(`option sameSite is invalid: ${b.sameSite}`)}return _}function d(m){if(m.indexOf("%")===-1)return m;try{return decodeURIComponent(m)}catch{return m}}function v(m){return a.call(m)==="[object Date]"}return Vu}ST();var mx="popstate";function ET(n={}){function t(r,a){let{pathname:i,search:u,hash:l}=r.location;return qv("",{pathname:i,search:u,hash:l},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function e(r,a){return typeof a=="string"?a:rl(a)}return RT(t,e,null,n)}function Tt(n,t){if(n===!1||n===null||typeof n>"u")throw new Error(t)}function Nr(n,t){if(!n){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function CT(){return Math.random().toString(36).substring(2,10)}function gx(n,t){return{usr:n.state,key:n.key,idx:t}}function qv(n,t,e=null,r){return{pathname:typeof n=="string"?n:n.pathname,search:"",hash:"",...typeof t=="string"?Ps(t):t,state:e,key:t&&t.key||r||CT()}}function rl({pathname:n="/",search:t="",hash:e=""}){return t&&t!=="?"&&(n+=t.charAt(0)==="?"?t:"?"+t),e&&e!=="#"&&(n+=e.charAt(0)==="#"?e:"#"+e),n}function Ps(n){let t={};if(n){let e=n.indexOf("#");e>=0&&(t.hash=n.substring(e),n=n.substring(0,e));let r=n.indexOf("?");r>=0&&(t.search=n.substring(r),n=n.substring(0,r)),n&&(t.pathname=n)}return t}function RT(n,t,e,r={}){let{window:a=document.defaultView,v5Compat:i=!1}=r,u=a.history,l="POP",c=null,f=d();f==null&&(f=0,u.replaceState({...u.state,idx:f},""));function d(){return(u.state||{idx:null}).idx}function v(){l="POP";let S=d(),_=S==null?null:S-f;f=S,c&&c({action:l,location:w.location,delta:_})}function m(S,_){l="PUSH";let E=qv(w.location,S,_);f=d()+1;let R=gx(E,f),C=w.createHref(E);try{u.pushState(R,"",C)}catch(A){if(A instanceof DOMException&&A.name==="DataCloneError")throw A;a.location.assign(C)}i&&c&&c({action:l,location:w.location,delta:1})}function g(S,_){l="REPLACE";let E=qv(w.location,S,_);f=d();let R=gx(E,f),C=w.createHref(E);u.replaceState(R,"",C),i&&c&&c({action:l,location:w.location,delta:0})}function b(S){return AT(S)}let w={get action(){return l},get location(){return n(a,u)},listen(S){if(c)throw new Error("A history only accepts one active listener");return a.addEventListener(mx,v),c=S,()=>{a.removeEventListener(mx,v),c=null}},createHref(S){return t(a,S)},createURL:b,encodeLocation(S){let _=b(S);return{pathname:_.pathname,search:_.search,hash:_.hash}},push:m,replace:g,go(S){return u.go(S)}};return w}function AT(n,t=!1){let e="http://localhost";typeof window<"u"&&(e=window.location.origin!=="null"?window.location.origin:window.location.href),Tt(e,"No window.location.(origin|href) available to create URL");let r=typeof n=="string"?n:rl(n);return r=r.replace(/ $/,"%20"),!t&&r.startsWith("//")&&(r=e+r),new URL(r,e)}function G2(n,t,e="/"){return TT(n,t,e,!1)}function TT(n,t,e,r){let a=typeof t=="string"?Ps(t):t,i=Ta(a.pathname||"/",e);if(i==null)return null;let u=q2(n);DT(u);let l=null;for(let c=0;l==null&&c<u.length;++c){let f=UT(i);l=PT(u[c],f,r)}return l}function q2(n,t=[],e=[],r=""){let a=(i,u,l)=>{let c={relativePath:l===void 0?i.path||"":l,caseSensitive:i.caseSensitive===!0,childrenIndex:u,route:i};c.relativePath.startsWith("/")&&(Tt(c.relativePath.startsWith(r),`Absolute route path "${c.relativePath}" nested under path "${r}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),c.relativePath=c.relativePath.slice(r.length));let f=Aa([r,c.relativePath]),d=e.concat(c);i.children&&i.children.length>0&&(Tt(i.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${f}".`),q2(i.children,t,d,f)),!(i.path==null&&!i.index)&&t.push({path:f,score:BT(f,i.index),routesMeta:d})};return n.forEach((i,u)=>{if(i.path===""||!i.path?.includes("?"))a(i,u);else for(let l of K2(i.path))a(i,u,l)}),t}function K2(n){let t=n.split("/");if(t.length===0)return[];let[e,...r]=t,a=e.endsWith("?"),i=e.replace(/\?$/,"");if(r.length===0)return a?[i,""]:[i];let u=K2(r.join("/")),l=[];return l.push(...u.map(c=>c===""?i:[i,c].join("/"))),a&&l.push(...u),l.map(c=>n.startsWith("/")&&c===""?"/":c)}function DT(n){n.sort((t,e)=>t.score!==e.score?e.score-t.score:LT(t.routesMeta.map(r=>r.childrenIndex),e.routesMeta.map(r=>r.childrenIndex)))}var kT=/^:[\w-]+$/,OT=3,NT=2,MT=1,IT=10,FT=-2,yx=n=>n==="*";function BT(n,t){let e=n.split("/"),r=e.length;return e.some(yx)&&(r+=FT),t&&(r+=NT),e.filter(a=>!yx(a)).reduce((a,i)=>a+(kT.test(i)?OT:i===""?MT:IT),r)}function LT(n,t){return n.length===t.length&&n.slice(0,-1).every((r,a)=>r===t[a])?n[n.length-1]-t[t.length-1]:0}function PT(n,t,e=!1){let{routesMeta:r}=n,a={},i="/",u=[];for(let l=0;l<r.length;++l){let c=r[l],f=l===r.length-1,d=i==="/"?t:t.slice(i.length)||"/",v=Cf({path:c.relativePath,caseSensitive:c.caseSensitive,end:f},d),m=c.route;if(!v&&f&&e&&!r[r.length-1].route.index&&(v=Cf({path:c.relativePath,caseSensitive:c.caseSensitive,end:!1},d)),!v)return null;Object.assign(a,v.params),u.push({params:a,pathname:Aa([i,v.pathname]),pathnameBase:WT(Aa([i,v.pathnameBase])),route:m}),v.pathnameBase!=="/"&&(i=Aa([i,v.pathnameBase]))}return u}function Cf(n,t){typeof n=="string"&&(n={path:n,caseSensitive:!1,end:!0});let[e,r]=zT(n.path,n.caseSensitive,n.end),a=t.match(e);if(!a)return null;let i=a[0],u=i.replace(/(.)\/+$/,"$1"),l=a.slice(1);return{params:r.reduce((f,{paramName:d,isOptional:v},m)=>{if(d==="*"){let b=l[m]||"";u=i.slice(0,i.length-b.length).replace(/(.)\/+$/,"$1")}const g=l[m];return v&&!g?f[d]=void 0:f[d]=(g||"").replace(/%2F/g,"/"),f},{}),pathname:i,pathnameBase:u,pattern:n}}function zT(n,t=!1,e=!0){Nr(n==="*"||!n.endsWith("*")||n.endsWith("/*"),`Route path "${n}" will be treated as if it were "${n.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${n.replace(/\*$/,"/*")}".`);let r=[],a="^"+n.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(u,l,c)=>(r.push({paramName:l,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)"));return n.endsWith("*")?(r.push({paramName:"*"}),a+=n==="*"||n==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):e?a+="\\/*$":n!==""&&n!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,t?void 0:"i"),r]}function UT(n){try{return n.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return Nr(!1,`The URL path "${n}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${t}).`),n}}function Ta(n,t){if(t==="/")return n;if(!n.toLowerCase().startsWith(t.toLowerCase()))return null;let e=t.endsWith("/")?t.length-1:t.length,r=n.charAt(e);return r&&r!=="/"?null:n.slice(e)||"/"}function VT(n,t="/"){let{pathname:e,search:r="",hash:a=""}=typeof n=="string"?Ps(n):n;return{pathname:e?e.startsWith("/")?e:HT(e,t):t,search:GT(r),hash:qT(a)}}function HT(n,t){let e=t.replace(/\/+$/,"").split("/");return n.split("/").forEach(a=>{a===".."?e.length>1&&e.pop():a!=="."&&e.push(a)}),e.length>1?e.join("/"):"/"}function tv(n,t,e,r){return`Cannot include a '${n}' character in a manually specified \`to.${t}\` field [${JSON.stringify(r)}].  Please separate it out to the \`to.${e}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function jT(n){return n.filter((t,e)=>e===0||t.route.path&&t.route.path.length>0)}function X2(n){let t=jT(n);return t.map((e,r)=>r===t.length-1?e.pathname:e.pathnameBase)}function $2(n,t,e,r=!1){let a;typeof n=="string"?a=Ps(n):(a={...n},Tt(!a.pathname||!a.pathname.includes("?"),tv("?","pathname","search",a)),Tt(!a.pathname||!a.pathname.includes("#"),tv("#","pathname","hash",a)),Tt(!a.search||!a.search.includes("#"),tv("#","search","hash",a)));let i=n===""||a.pathname==="",u=i?"/":a.pathname,l;if(u==null)l=e;else{let v=t.length-1;if(!r&&u.startsWith("..")){let m=u.split("/");for(;m[0]==="..";)m.shift(),v-=1;a.pathname=m.join("/")}l=v>=0?t[v]:"/"}let c=VT(a,l),f=u&&u!=="/"&&u.endsWith("/"),d=(i||u===".")&&e.endsWith("/");return!c.pathname.endsWith("/")&&(f||d)&&(c.pathname+="/"),c}var Aa=n=>n.join("/").replace(/\/\/+/g,"/"),WT=n=>n.replace(/\/+$/,"").replace(/^\/*/,"/"),GT=n=>!n||n==="?"?"":n.startsWith("?")?n:"?"+n,qT=n=>!n||n==="#"?"":n.startsWith("#")?n:"#"+n;function KT(n){return n!=null&&typeof n.status=="number"&&typeof n.statusText=="string"&&typeof n.internal=="boolean"&&"data"in n}var Y2=["POST","PUT","PATCH","DELETE"];new Set(Y2);var XT=["GET",...Y2];new Set(XT);var zs=Y.createContext(null);zs.displayName="DataRouter";var fh=Y.createContext(null);fh.displayName="DataRouterState";var Q2=Y.createContext({isTransitioning:!1});Q2.displayName="ViewTransition";var $T=Y.createContext(new Map);$T.displayName="Fetchers";var YT=Y.createContext(null);YT.displayName="Await";var na=Y.createContext(null);na.displayName="Navigation";var xl=Y.createContext(null);xl.displayName="Location";var Oa=Y.createContext({outlet:null,matches:[],isDataRoute:!1});Oa.displayName="Route";var Hm=Y.createContext(null);Hm.displayName="RouteError";function QT(n,{relative:t}={}){Tt(wl(),"useHref() may be used only in the context of a <Router> component.");let{basename:e,navigator:r}=Y.useContext(na),{hash:a,pathname:i,search:u}=_l(n,{relative:t}),l=i;return e!=="/"&&(l=i==="/"?e:Aa([e,i])),r.createHref({pathname:l,search:u,hash:a})}function wl(){return Y.useContext(xl)!=null}function Di(){return Tt(wl(),"useLocation() may be used only in the context of a <Router> component."),Y.useContext(xl).location}var Z2="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function J2(n){Y.useContext(na).static||Y.useLayoutEffect(n)}function e_(){let{isDataRoute:n}=Y.useContext(Oa);return n?cD():ZT()}function ZT(){Tt(wl(),"useNavigate() may be used only in the context of a <Router> component.");let n=Y.useContext(zs),{basename:t,navigator:e}=Y.useContext(na),{matches:r}=Y.useContext(Oa),{pathname:a}=Di(),i=JSON.stringify(X2(r)),u=Y.useRef(!1);return J2(()=>{u.current=!0}),Y.useCallback((c,f={})=>{if(Nr(u.current,Z2),!u.current)return;if(typeof c=="number"){e.go(c);return}let d=$2(c,JSON.parse(i),a,f.relative==="path");n==null&&t!=="/"&&(d.pathname=d.pathname==="/"?t:Aa([t,d.pathname])),(f.replace?e.replace:e.push)(d,f.state,f)},[t,e,i,a,n])}Y.createContext(null);function _l(n,{relative:t}={}){let{matches:e}=Y.useContext(Oa),{pathname:r}=Di(),a=JSON.stringify(X2(e));return Y.useMemo(()=>$2(n,JSON.parse(a),r,t==="path"),[n,a,r,t])}function JT(n,t){return t_(n,t)}function t_(n,t,e,r){Tt(wl(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:a}=Y.useContext(na),{matches:i}=Y.useContext(Oa),u=i[i.length-1],l=u?u.params:{},c=u?u.pathname:"/",f=u?u.pathnameBase:"/",d=u&&u.route;{let _=d&&d.path||"";n_(c,!d||_.endsWith("*")||_.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${c}" (under <Route path="${_}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${_}"> to <Route path="${_==="/"?"*":`${_}/*`}">.`)}let v=Di(),m;if(t){let _=typeof t=="string"?Ps(t):t;Tt(f==="/"||_.pathname?.startsWith(f),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${f}" but pathname "${_.pathname}" was given in the \`location\` prop.`),m=_}else m=v;let g=m.pathname||"/",b=g;if(f!=="/"){let _=f.replace(/^\//,"").split("/");b="/"+g.replace(/^\//,"").split("/").slice(_.length).join("/")}let w=G2(n,{pathname:b});Nr(d||w!=null,`No routes matched location "${m.pathname}${m.search}${m.hash}" `),Nr(w==null||w[w.length-1].route.element!==void 0||w[w.length-1].route.Component!==void 0||w[w.length-1].route.lazy!==void 0,`Matched leaf route at location "${m.pathname}${m.search}${m.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let S=aD(w&&w.map(_=>Object.assign({},_,{params:Object.assign({},l,_.params),pathname:Aa([f,a.encodeLocation?a.encodeLocation(_.pathname).pathname:_.pathname]),pathnameBase:_.pathnameBase==="/"?f:Aa([f,a.encodeLocation?a.encodeLocation(_.pathnameBase).pathname:_.pathnameBase])})),i,e,r);return t&&S?Y.createElement(xl.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...m},navigationType:"POP"}},S):S}function eD(){let n=lD(),t=KT(n)?`${n.status} ${n.statusText}`:n instanceof Error?n.message:JSON.stringify(n),e=n instanceof Error?n.stack:null,r="rgba(200,200,200, 0.5)",a={padding:"0.5rem",backgroundColor:r},i={padding:"2px 4px",backgroundColor:r},u=null;return console.error("Error handled by React Router default ErrorBoundary:",n),u=Y.createElement(Y.Fragment,null,Y.createElement("p",null," Hey developer "),Y.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",Y.createElement("code",{style:i},"ErrorBoundary")," or"," ",Y.createElement("code",{style:i},"errorElement")," prop on your route.")),Y.createElement(Y.Fragment,null,Y.createElement("h2",null,"Unexpected Application Error!"),Y.createElement("h3",{style:{fontStyle:"italic"}},t),e?Y.createElement("pre",{style:a},e):null,u)}var tD=Y.createElement(eD,null),nD=class extends Y.Component{constructor(n){super(n),this.state={location:n.location,revalidation:n.revalidation,error:n.error}}static getDerivedStateFromError(n){return{error:n}}static getDerivedStateFromProps(n,t){return t.location!==n.location||t.revalidation!=="idle"&&n.revalidation==="idle"?{error:n.error,location:n.location,revalidation:n.revalidation}:{error:n.error!==void 0?n.error:t.error,location:t.location,revalidation:n.revalidation||t.revalidation}}componentDidCatch(n,t){console.error("React Router caught the following error during render",n,t)}render(){return this.state.error!==void 0?Y.createElement(Oa.Provider,{value:this.props.routeContext},Y.createElement(Hm.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function rD({routeContext:n,match:t,children:e}){let r=Y.useContext(zs);return r&&r.static&&r.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=t.route.id),Y.createElement(Oa.Provider,{value:n},e)}function aD(n,t=[],e=null,r=null){if(n==null){if(!e)return null;if(e.errors)n=e.matches;else if(t.length===0&&!e.initialized&&e.matches.length>0)n=e.matches;else return null}let a=n,i=e?.errors;if(i!=null){let c=a.findIndex(f=>f.route.id&&i?.[f.route.id]!==void 0);Tt(c>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(i).join(",")}`),a=a.slice(0,Math.min(a.length,c+1))}let u=!1,l=-1;if(e)for(let c=0;c<a.length;c++){let f=a[c];if((f.route.HydrateFallback||f.route.hydrateFallbackElement)&&(l=c),f.route.id){let{loaderData:d,errors:v}=e,m=f.route.loader&&!d.hasOwnProperty(f.route.id)&&(!v||v[f.route.id]===void 0);if(f.route.lazy||m){u=!0,l>=0?a=a.slice(0,l+1):a=[a[0]];break}}}return a.reduceRight((c,f,d)=>{let v,m=!1,g=null,b=null;e&&(v=i&&f.route.id?i[f.route.id]:void 0,g=f.route.errorElement||tD,u&&(l<0&&d===0?(n_("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),m=!0,b=null):l===d&&(m=!0,b=f.route.hydrateFallbackElement||null)));let w=t.concat(a.slice(0,d+1)),S=()=>{let _;return v?_=g:m?_=b:f.route.Component?_=Y.createElement(f.route.Component,null):f.route.element?_=f.route.element:_=c,Y.createElement(rD,{match:f,routeContext:{outlet:c,matches:w,isDataRoute:e!=null},children:_})};return e&&(f.route.ErrorBoundary||f.route.errorElement||d===0)?Y.createElement(nD,{location:e.location,revalidation:e.revalidation,component:g,error:v,children:S(),routeContext:{outlet:null,matches:w,isDataRoute:!0}}):S()},null)}function jm(n){return`${n} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function iD(n){let t=Y.useContext(zs);return Tt(t,jm(n)),t}function oD(n){let t=Y.useContext(fh);return Tt(t,jm(n)),t}function sD(n){let t=Y.useContext(Oa);return Tt(t,jm(n)),t}function Wm(n){let t=sD(n),e=t.matches[t.matches.length-1];return Tt(e.route.id,`${n} can only be used on routes that contain a unique "id"`),e.route.id}function uD(){return Wm("useRouteId")}function lD(){let n=Y.useContext(Hm),t=oD("useRouteError"),e=Wm("useRouteError");return n!==void 0?n:t.errors?.[e]}function cD(){let{router:n}=iD("useNavigate"),t=Wm("useNavigate"),e=Y.useRef(!1);return J2(()=>{e.current=!0}),Y.useCallback(async(a,i={})=>{Nr(e.current,Z2),e.current&&(typeof a=="number"?n.navigate(a):await n.navigate(a,{fromRouteId:t,...i}))},[n,t])}var bx={};function n_(n,t,e){!t&&!bx[n]&&(bx[n]=!0,Nr(!1,e))}Y.memo(fD);function fD({routes:n,future:t,state:e}){return t_(n,void 0,e,t)}function hD(n){Tt(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function dD({basename:n="/",children:t=null,location:e,navigationType:r="POP",navigator:a,static:i=!1}){Tt(!wl(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let u=n.replace(/^\/*/,"/"),l=Y.useMemo(()=>({basename:u,navigator:a,static:i,future:{}}),[u,a,i]);typeof e=="string"&&(e=Ps(e));let{pathname:c="/",search:f="",hash:d="",state:v=null,key:m="default"}=e,g=Y.useMemo(()=>{let b=Ta(c,u);return b==null?null:{location:{pathname:b,search:f,hash:d,state:v,key:m},navigationType:r}},[u,c,f,d,v,m,r]);return Nr(g!=null,`<Router basename="${u}"> is not able to match the URL "${c}${f}${d}" because it does not start with the basename, so the <Router> won't render anything.`),g==null?null:Y.createElement(na.Provider,{value:l},Y.createElement(xl.Provider,{children:t,value:g}))}function TP({children:n,location:t}){return JT(Kv(n),t)}function Kv(n,t=[]){let e=[];return Y.Children.forEach(n,(r,a)=>{if(!Y.isValidElement(r))return;let i=[...t,a];if(r.type===Y.Fragment){e.push.apply(e,Kv(r.props.children,i));return}Tt(r.type===hD,`[${typeof r.type=="string"?r.type:r.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),Tt(!r.props.index||!r.props.children,"An index route cannot have child routes.");let u={id:r.props.id||i.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,hydrateFallbackElement:r.props.hydrateFallbackElement,HydrateFallback:r.props.HydrateFallback,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.hasErrorBoundary===!0||r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(u.children=Kv(r.props.children,i)),e.push(u)}),e}var gf="get",yf="application/x-www-form-urlencoded";function hh(n){return n!=null&&typeof n.tagName=="string"}function pD(n){return hh(n)&&n.tagName.toLowerCase()==="button"}function vD(n){return hh(n)&&n.tagName.toLowerCase()==="form"}function mD(n){return hh(n)&&n.tagName.toLowerCase()==="input"}function gD(n){return!!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)}function yD(n,t){return n.button===0&&(!t||t==="_self")&&!gD(n)}function Xv(n=""){return new URLSearchParams(typeof n=="string"||Array.isArray(n)||n instanceof URLSearchParams?n:Object.keys(n).reduce((t,e)=>{let r=n[e];return t.concat(Array.isArray(r)?r.map(a=>[e,a]):[[e,r]])},[]))}function bD(n,t){let e=Xv(n);return t&&t.forEach((r,a)=>{e.has(a)||t.getAll(a).forEach(i=>{e.append(a,i)})}),e}var qc=null;function xD(){if(qc===null)try{new FormData(document.createElement("form"),0),qc=!1}catch{qc=!0}return qc}var wD=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function nv(n){return n!=null&&!wD.has(n)?(Nr(!1,`"${n}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${yf}"`),null):n}function _D(n,t){let e,r,a,i,u;if(vD(n)){let l=n.getAttribute("action");r=l?Ta(l,t):null,e=n.getAttribute("method")||gf,a=nv(n.getAttribute("enctype"))||yf,i=new FormData(n)}else if(pD(n)||mD(n)&&(n.type==="submit"||n.type==="image")){let l=n.form;if(l==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let c=n.getAttribute("formaction")||l.getAttribute("action");if(r=c?Ta(c,t):null,e=n.getAttribute("formmethod")||l.getAttribute("method")||gf,a=nv(n.getAttribute("formenctype"))||nv(l.getAttribute("enctype"))||yf,i=new FormData(l,n),!xD()){let{name:f,type:d,value:v}=n;if(d==="image"){let m=f?`${f}.`:"";i.append(`${m}x`,"0"),i.append(`${m}y`,"0")}else f&&i.append(f,v)}}else{if(hh(n))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');e=gf,r=null,a=yf,u=n}return i&&a==="text/plain"&&(u=i,i=void 0),{action:r,method:e.toLowerCase(),encType:a,formData:i,body:u}}function Gm(n,t){if(n===!1||n===null||typeof n>"u")throw new Error(t)}async function SD(n,t){if(n.id in t)return t[n.id];try{let e=await import(n.module);return t[n.id]=e,e}catch(e){return console.error(`Error loading route module \`${n.module}\`, reloading page...`),console.error(e),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function ED(n){return n==null?!1:n.href==null?n.rel==="preload"&&typeof n.imageSrcSet=="string"&&typeof n.imageSizes=="string":typeof n.rel=="string"&&typeof n.href=="string"}async function CD(n,t,e){let r=await Promise.all(n.map(async a=>{let i=t.routes[a.route.id];if(i){let u=await SD(i,e);return u.links?u.links():[]}return[]}));return DD(r.flat(1).filter(ED).filter(a=>a.rel==="stylesheet"||a.rel==="preload").map(a=>a.rel==="stylesheet"?{...a,rel:"prefetch",as:"style"}:{...a,rel:"prefetch"}))}function xx(n,t,e,r,a,i){let u=(c,f)=>e[f]?c.route.id!==e[f].route.id:!0,l=(c,f)=>e[f].pathname!==c.pathname||e[f].route.path?.endsWith("*")&&e[f].params["*"]!==c.params["*"];return i==="assets"?t.filter((c,f)=>u(c,f)||l(c,f)):i==="data"?t.filter((c,f)=>{let d=r.routes[c.route.id];if(!d||!d.hasLoader)return!1;if(u(c,f)||l(c,f))return!0;if(c.route.shouldRevalidate){let v=c.route.shouldRevalidate({currentUrl:new URL(a.pathname+a.search+a.hash,window.origin),currentParams:e[0]?.params||{},nextUrl:new URL(n,window.origin),nextParams:c.params,defaultShouldRevalidate:!0});if(typeof v=="boolean")return v}return!0}):[]}function RD(n,t,{includeHydrateFallback:e}={}){return AD(n.map(r=>{let a=t.routes[r.route.id];if(!a)return[];let i=[a.module];return a.clientActionModule&&(i=i.concat(a.clientActionModule)),a.clientLoaderModule&&(i=i.concat(a.clientLoaderModule)),e&&a.hydrateFallbackModule&&(i=i.concat(a.hydrateFallbackModule)),a.imports&&(i=i.concat(a.imports)),i}).flat(1))}function AD(n){return[...new Set(n)]}function TD(n){let t={},e=Object.keys(n).sort();for(let r of e)t[r]=n[r];return t}function DD(n,t){let e=new Set;return new Set(t),n.reduce((r,a)=>{let i=JSON.stringify(TD(a));return e.has(i)||(e.add(i),r.push({key:i,link:a})),r},[])}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var kD=new Set([100,101,204,205]);function OD(n,t){let e=typeof n=="string"?new URL(n,typeof window>"u"?"server://singlefetch/":window.location.origin):n;return e.pathname==="/"?e.pathname="_root.data":t&&Ta(e.pathname,t)==="/"?e.pathname=`${t.replace(/\/$/,"")}/_root.data`:e.pathname=`${e.pathname.replace(/\/$/,"")}.data`,e}function r_(){let n=Y.useContext(zs);return Gm(n,"You must render this element inside a <DataRouterContext.Provider> element"),n}function ND(){let n=Y.useContext(fh);return Gm(n,"You must render this element inside a <DataRouterStateContext.Provider> element"),n}var qm=Y.createContext(void 0);qm.displayName="FrameworkContext";function a_(){let n=Y.useContext(qm);return Gm(n,"You must render this element inside a <HydratedRouter> element"),n}function MD(n,t){let e=Y.useContext(qm),[r,a]=Y.useState(!1),[i,u]=Y.useState(!1),{onFocus:l,onBlur:c,onMouseEnter:f,onMouseLeave:d,onTouchStart:v}=t,m=Y.useRef(null);Y.useEffect(()=>{if(n==="render"&&u(!0),n==="viewport"){let w=_=>{_.forEach(E=>{u(E.isIntersecting)})},S=new IntersectionObserver(w,{threshold:.5});return m.current&&S.observe(m.current),()=>{S.disconnect()}}},[n]),Y.useEffect(()=>{if(r){let w=setTimeout(()=>{u(!0)},100);return()=>{clearTimeout(w)}}},[r]);let g=()=>{a(!0)},b=()=>{a(!1),u(!1)};return e?n!=="intent"?[i,m,{}]:[i,m,{onFocus:Hu(l,g),onBlur:Hu(c,b),onMouseEnter:Hu(f,g),onMouseLeave:Hu(d,b),onTouchStart:Hu(v,g)}]:[!1,m,{}]}function Hu(n,t){return e=>{n&&n(e),e.defaultPrevented||t(e)}}function ID({page:n,...t}){let{router:e}=r_(),r=Y.useMemo(()=>G2(e.routes,n,e.basename),[e.routes,n,e.basename]);return r?Y.createElement(BD,{page:n,matches:r,...t}):null}function FD(n){let{manifest:t,routeModules:e}=a_(),[r,a]=Y.useState([]);return Y.useEffect(()=>{let i=!1;return CD(n,t,e).then(u=>{i||a(u)}),()=>{i=!0}},[n,t,e]),r}function BD({page:n,matches:t,...e}){let r=Di(),{manifest:a,routeModules:i}=a_(),{basename:u}=r_(),{loaderData:l,matches:c}=ND(),f=Y.useMemo(()=>xx(n,t,c,a,r,"data"),[n,t,c,a,r]),d=Y.useMemo(()=>xx(n,t,c,a,r,"assets"),[n,t,c,a,r]),v=Y.useMemo(()=>{if(n===r.pathname+r.search+r.hash)return[];let b=new Set,w=!1;if(t.forEach(_=>{let E=a.routes[_.route.id];!E||!E.hasLoader||(!f.some(R=>R.route.id===_.route.id)&&_.route.id in l&&i[_.route.id]?.shouldRevalidate||E.hasClientLoader?w=!0:b.add(_.route.id))}),b.size===0)return[];let S=OD(n,u);return w&&b.size>0&&S.searchParams.set("_routes",t.filter(_=>b.has(_.route.id)).map(_=>_.route.id).join(",")),[S.pathname+S.search]},[u,l,r,a,f,t,n,i]),m=Y.useMemo(()=>RD(d,a),[d,a]),g=FD(d);return Y.createElement(Y.Fragment,null,v.map(b=>Y.createElement("link",{key:b,rel:"prefetch",as:"fetch",href:b,...e})),m.map(b=>Y.createElement("link",{key:b,rel:"modulepreload",href:b,...e})),g.map(({key:b,link:w})=>Y.createElement("link",{key:b,...w})))}function LD(...n){return t=>{n.forEach(e=>{typeof e=="function"?e(t):e!=null&&(e.current=t)})}}var i_=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{i_&&(window.__reactRouterVersion="7.6.3")}catch{}function DP({basename:n,children:t,window:e}){let r=Y.useRef();r.current==null&&(r.current=ET({window:e,v5Compat:!0}));let a=r.current,[i,u]=Y.useState({action:a.action,location:a.location}),l=Y.useCallback(c=>{Y.startTransition(()=>u(c))},[u]);return Y.useLayoutEffect(()=>a.listen(l),[a,l]),Y.createElement(dD,{basename:n,children:t,location:i.location,navigationType:i.action,navigator:a})}var o_=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,s_=Y.forwardRef(function({onClick:t,discover:e="render",prefetch:r="none",relative:a,reloadDocument:i,replace:u,state:l,target:c,to:f,preventScrollReset:d,viewTransition:v,...m},g){let{basename:b}=Y.useContext(na),w=typeof f=="string"&&o_.test(f),S,_=!1;if(typeof f=="string"&&w&&(S=f,i_))try{let N=new URL(window.location.href),B=f.startsWith("//")?new URL(N.protocol+f):new URL(f),V=Ta(B.pathname,b);B.origin===N.origin&&V!=null?f=V+B.search+B.hash:_=!0}catch{Nr(!1,`<Link to="${f}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let E=QT(f,{relative:a}),[R,C,A]=MD(r,m),D=VD(f,{replace:u,state:l,target:c,preventScrollReset:d,relative:a,viewTransition:v});function k(N){t&&t(N),N.defaultPrevented||D(N)}let I=Y.createElement("a",{...m,...A,href:S||E,onClick:_||i?t:k,ref:LD(g,C),target:c,"data-discover":!w&&e==="render"?"true":void 0});return R&&!w?Y.createElement(Y.Fragment,null,I,Y.createElement(ID,{page:E})):I});s_.displayName="Link";var PD=Y.forwardRef(function({"aria-current":t="page",caseSensitive:e=!1,className:r="",end:a=!1,style:i,to:u,viewTransition:l,children:c,...f},d){let v=_l(u,{relative:f.relative}),m=Di(),g=Y.useContext(fh),{navigator:b,basename:w}=Y.useContext(na),S=g!=null&&qD(v)&&l===!0,_=b.encodeLocation?b.encodeLocation(v).pathname:v.pathname,E=m.pathname,R=g&&g.navigation&&g.navigation.location?g.navigation.location.pathname:null;e||(E=E.toLowerCase(),R=R?R.toLowerCase():null,_=_.toLowerCase()),R&&w&&(R=Ta(R,w)||R);const C=_!=="/"&&_.endsWith("/")?_.length-1:_.length;let A=E===_||!a&&E.startsWith(_)&&E.charAt(C)==="/",D=R!=null&&(R===_||!a&&R.startsWith(_)&&R.charAt(_.length)==="/"),k={isActive:A,isPending:D,isTransitioning:S},I=A?t:void 0,N;typeof r=="function"?N=r(k):N=[r,A?"active":null,D?"pending":null,S?"transitioning":null].filter(Boolean).join(" ");let B=typeof i=="function"?i(k):i;return Y.createElement(s_,{...f,"aria-current":I,className:N,ref:d,style:B,to:u,viewTransition:l},typeof c=="function"?c(k):c)});PD.displayName="NavLink";var zD=Y.forwardRef(({discover:n="render",fetcherKey:t,navigate:e,reloadDocument:r,replace:a,state:i,method:u=gf,action:l,onSubmit:c,relative:f,preventScrollReset:d,viewTransition:v,...m},g)=>{let b=WD(),w=GD(l,{relative:f}),S=u.toLowerCase()==="get"?"get":"post",_=typeof l=="string"&&o_.test(l),E=R=>{if(c&&c(R),R.defaultPrevented)return;R.preventDefault();let C=R.nativeEvent.submitter,A=C?.getAttribute("formmethod")||u;b(C||R.currentTarget,{fetcherKey:t,method:A,navigate:e,replace:a,state:i,relative:f,preventScrollReset:d,viewTransition:v})};return Y.createElement("form",{ref:g,method:S,action:w,onSubmit:r?c:E,...m,"data-discover":!_&&n==="render"?"true":void 0})});zD.displayName="Form";function UD(n){return`${n} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function u_(n){let t=Y.useContext(zs);return Tt(t,UD(n)),t}function VD(n,{target:t,replace:e,state:r,preventScrollReset:a,relative:i,viewTransition:u}={}){let l=e_(),c=Di(),f=_l(n,{relative:i});return Y.useCallback(d=>{if(yD(d,t)){d.preventDefault();let v=e!==void 0?e:rl(c)===rl(f);l(n,{replace:v,state:r,preventScrollReset:a,relative:i,viewTransition:u})}},[c,l,f,e,r,t,n,a,i,u])}function kP(n){Nr(typeof URLSearchParams<"u","You cannot use the `useSearchParams` hook in a browser that does not support the URLSearchParams API. If you need to support Internet Explorer 11, we recommend you load a polyfill such as https://github.com/ungap/url-search-params.");let t=Y.useRef(Xv(n)),e=Y.useRef(!1),r=Di(),a=Y.useMemo(()=>bD(r.search,e.current?null:t.current),[r.search]),i=e_(),u=Y.useCallback((l,c)=>{const f=Xv(typeof l=="function"?l(a):l);e.current=!0,i("?"+f,c)},[i,a]);return[a,u]}var HD=0,jD=()=>`__${String(++HD)}__`;function WD(){let{router:n}=u_("useSubmit"),{basename:t}=Y.useContext(na),e=uD();return Y.useCallback(async(r,a={})=>{let{action:i,method:u,encType:l,formData:c,body:f}=_D(r,t);if(a.navigate===!1){let d=a.fetcherKey||jD();await n.fetch(d,e,a.action||i,{preventScrollReset:a.preventScrollReset,formData:c,body:f,formMethod:a.method||u,formEncType:a.encType||l,flushSync:a.flushSync})}else await n.navigate(a.action||i,{preventScrollReset:a.preventScrollReset,formData:c,body:f,formMethod:a.method||u,formEncType:a.encType||l,replace:a.replace,state:a.state,fromRouteId:e,flushSync:a.flushSync,viewTransition:a.viewTransition})},[n,t,e])}function GD(n,{relative:t}={}){let{basename:e}=Y.useContext(na),r=Y.useContext(Oa);Tt(r,"useFormAction must be used inside a RouteContext");let[a]=r.matches.slice(-1),i={..._l(n||".",{relative:t})},u=Di();if(n==null){i.search=u.search;let l=new URLSearchParams(i.search),c=l.getAll("index");if(c.some(d=>d==="")){l.delete("index"),c.filter(v=>v).forEach(v=>l.append("index",v));let d=l.toString();i.search=d?`?${d}`:""}}return(!n||n===".")&&a.route.index&&(i.search=i.search?i.search.replace(/^\?/,"?index&"):"?index"),e!=="/"&&(i.pathname=i.pathname==="/"?e:Aa([e,i.pathname])),rl(i)}function qD(n,t={}){let e=Y.useContext(Q2);Tt(e!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:r}=u_("useViewTransitionState"),a=_l(n,{relative:t.relative});if(!e.isTransitioning)return!1;let i=Ta(e.currentLocation.pathname,r)||e.currentLocation.pathname,u=Ta(e.nextLocation.pathname,r)||e.nextLocation.pathname;return Cf(a.pathname,u)!=null||Cf(a.pathname,i)!=null}[...kD];function KD(n={}){const{nonce:t,onScriptLoadSuccess:e,onScriptLoadError:r}=n,[a,i]=Y.useState(!1),u=Y.useRef(e);u.current=e;const l=Y.useRef(r);return l.current=r,Y.useEffect(()=>{const c=document.createElement("script");return c.src="https://accounts.google.com/gsi/client",c.async=!0,c.defer=!0,c.nonce=t,c.onload=()=>{var f;i(!0),(f=u.current)===null||f===void 0||f.call(u)},c.onerror=()=>{var f;i(!1),(f=l.current)===null||f===void 0||f.call(l)},document.body.appendChild(c),()=>{document.body.removeChild(c)}},[t]),a}const l_=Y.createContext(null);function OP({clientId:n,nonce:t,onScriptLoadSuccess:e,onScriptLoadError:r,children:a}){const i=KD({nonce:t,onScriptLoadSuccess:e,onScriptLoadError:r}),u=Y.useMemo(()=>({clientId:n,scriptLoadedSuccessfully:i}),[n,i]);return Pn.createElement(l_.Provider,{value:u},a)}function XD(){const n=Y.useContext(l_);if(!n)throw new Error("Google OAuth components must be used within GoogleOAuthProvider");return n}function NP({flow:n="implicit",scope:t="",onSuccess:e,onError:r,onNonOAuthError:a,overrideScope:i,state:u,...l}){const{clientId:c,scriptLoadedSuccessfully:f}=XD(),d=Y.useRef(),v=Y.useRef(e);v.current=e;const m=Y.useRef(r);m.current=r;const g=Y.useRef(a);g.current=a,Y.useEffect(()=>{var S,_;if(!f)return;const E=n==="implicit"?"initTokenClient":"initCodeClient",R=(_=(S=window?.google)===null||S===void 0?void 0:S.accounts)===null||_===void 0?void 0:_.oauth2[E]({client_id:c,scope:i?t:`openid profile email ${t}`,callback:C=>{var A,D;if(C.error)return(A=m.current)===null||A===void 0?void 0:A.call(m,C);(D=v.current)===null||D===void 0||D.call(v,C)},error_callback:C=>{var A;(A=g.current)===null||A===void 0||A.call(g,C)},state:u,...l});d.current=R},[c,f,n,t,u]);const b=Y.useCallback(S=>{var _;return(_=d.current)===null||_===void 0?void 0:_.requestAccessToken(S)},[]),w=Y.useCallback(()=>{var S;return(S=d.current)===null||S===void 0?void 0:S.requestCode()},[]);return n==="implicit"?b:w}var Us=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(n){return this.listeners.add(n),this.onSubscribe(),()=>{this.listeners.delete(n),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},uo=typeof window>"u"||"Deno"in globalThis;function Tn(){}function $D(n,t){return typeof n=="function"?n(t):n}function $v(n){return typeof n=="number"&&n>=0&&n!==1/0}function c_(n,t){return Math.max(n+(t||0)-Date.now(),0)}function xi(n,t){return typeof n=="function"?n(t):n}function Ar(n,t){return typeof n=="function"?n(t):n}function wx(n,t){const{type:e="all",exact:r,fetchStatus:a,predicate:i,queryKey:u,stale:l}=n;if(u){if(r){if(t.queryHash!==Km(u,t.options))return!1}else if(!al(t.queryKey,u))return!1}if(e!=="all"){const c=t.isActive();if(e==="active"&&!c||e==="inactive"&&c)return!1}return!(typeof l=="boolean"&&t.isStale()!==l||a&&a!==t.state.fetchStatus||i&&!i(t))}function _x(n,t){const{exact:e,status:r,predicate:a,mutationKey:i}=n;if(i){if(!t.options.mutationKey)return!1;if(e){if(lo(t.options.mutationKey)!==lo(i))return!1}else if(!al(t.options.mutationKey,i))return!1}return!(r&&t.state.status!==r||a&&!a(t))}function Km(n,t){return(t?.queryKeyHashFn||lo)(n)}function lo(n){return JSON.stringify(n,(t,e)=>Yv(e)?Object.keys(e).sort().reduce((r,a)=>(r[a]=e[a],r),{}):e)}function al(n,t){return n===t?!0:typeof n!=typeof t?!1:n&&t&&typeof n=="object"&&typeof t=="object"?Object.keys(t).every(e=>al(n[e],t[e])):!1}function f_(n,t){if(n===t)return n;const e=Sx(n)&&Sx(t);if(e||Yv(n)&&Yv(t)){const r=e?n:Object.keys(n),a=r.length,i=e?t:Object.keys(t),u=i.length,l=e?[]:{},c=new Set(r);let f=0;for(let d=0;d<u;d++){const v=e?d:i[d];(!e&&c.has(v)||e)&&n[v]===void 0&&t[v]===void 0?(l[v]=void 0,f++):(l[v]=f_(n[v],t[v]),l[v]===n[v]&&n[v]!==void 0&&f++)}return a===u&&f===a?n:l}return t}function Rf(n,t){if(!t||Object.keys(n).length!==Object.keys(t).length)return!1;for(const e in n)if(n[e]!==t[e])return!1;return!0}function Sx(n){return Array.isArray(n)&&n.length===Object.keys(n).length}function Yv(n){if(!Ex(n))return!1;const t=n.constructor;if(t===void 0)return!0;const e=t.prototype;return!(!Ex(e)||!e.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(n)!==Object.prototype)}function Ex(n){return Object.prototype.toString.call(n)==="[object Object]"}function YD(n){return new Promise(t=>{setTimeout(t,n)})}function Qv(n,t,e){return typeof e.structuralSharing=="function"?e.structuralSharing(n,t):e.structuralSharing!==!1?f_(n,t):t}function QD(n,t,e=0){const r=[...n,t];return e&&r.length>e?r.slice(1):r}function ZD(n,t,e=0){const r=[t,...n];return e&&r.length>e?r.slice(0,-1):r}var Xm=Symbol();function h_(n,t){return!n.queryFn&&t?.initialPromise?()=>t.initialPromise:!n.queryFn||n.queryFn===Xm?()=>Promise.reject(new Error(`Missing queryFn: '${n.queryHash}'`)):n.queryFn}function d_(n,t){return typeof n=="function"?n(...t):!!n}var JD=class extends Us{#t;#e;#n;constructor(){super(),this.#n=n=>{if(!uo&&window.addEventListener){const t=()=>n();return window.addEventListener("visibilitychange",t,!1),()=>{window.removeEventListener("visibilitychange",t)}}}}onSubscribe(){this.#e||this.setEventListener(this.#n)}onUnsubscribe(){this.hasListeners()||(this.#e?.(),this.#e=void 0)}setEventListener(n){this.#n=n,this.#e?.(),this.#e=n(t=>{typeof t=="boolean"?this.setFocused(t):this.onFocus()})}setFocused(n){this.#t!==n&&(this.#t=n,this.onFocus())}onFocus(){const n=this.isFocused();this.listeners.forEach(t=>{t(n)})}isFocused(){return typeof this.#t=="boolean"?this.#t:globalThis.document?.visibilityState!=="hidden"}},$m=new JD,ek=class extends Us{#t=!0;#e;#n;constructor(){super(),this.#n=n=>{if(!uo&&window.addEventListener){const t=()=>n(!0),e=()=>n(!1);return window.addEventListener("online",t,!1),window.addEventListener("offline",e,!1),()=>{window.removeEventListener("online",t),window.removeEventListener("offline",e)}}}}onSubscribe(){this.#e||this.setEventListener(this.#n)}onUnsubscribe(){this.hasListeners()||(this.#e?.(),this.#e=void 0)}setEventListener(n){this.#n=n,this.#e?.(),this.#e=n(this.setOnline.bind(this))}setOnline(n){this.#t!==n&&(this.#t=n,this.listeners.forEach(e=>{e(n)}))}isOnline(){return this.#t}},Af=new ek;function Zv(){let n,t;const e=new Promise((a,i)=>{n=a,t=i});e.status="pending",e.catch(()=>{});function r(a){Object.assign(e,a),delete e.resolve,delete e.reject}return e.resolve=a=>{r({status:"fulfilled",value:a}),n(a)},e.reject=a=>{r({status:"rejected",reason:a}),t(a)},e}function tk(n){return Math.min(1e3*2**n,3e4)}function p_(n){return(n??"online")==="online"?Af.isOnline():!0}var v_=class extends Error{constructor(n){super("CancelledError"),this.revert=n?.revert,this.silent=n?.silent}};function rv(n){return n instanceof v_}function m_(n){let t=!1,e=0,r=!1,a;const i=Zv(),u=w=>{r||(m(new v_(w)),n.abort?.())},l=()=>{t=!0},c=()=>{t=!1},f=()=>$m.isFocused()&&(n.networkMode==="always"||Af.isOnline())&&n.canRun(),d=()=>p_(n.networkMode)&&n.canRun(),v=w=>{r||(r=!0,n.onSuccess?.(w),a?.(),i.resolve(w))},m=w=>{r||(r=!0,n.onError?.(w),a?.(),i.reject(w))},g=()=>new Promise(w=>{a=S=>{(r||f())&&w(S)},n.onPause?.()}).then(()=>{a=void 0,r||n.onContinue?.()}),b=()=>{if(r)return;let w;const S=e===0?n.initialPromise:void 0;try{w=S??n.fn()}catch(_){w=Promise.reject(_)}Promise.resolve(w).then(v).catch(_=>{if(r)return;const E=n.retry??(uo?0:3),R=n.retryDelay??tk,C=typeof R=="function"?R(e,_):R,A=E===!0||typeof E=="number"&&e<E||typeof E=="function"&&E(e,_);if(t||!A){m(_);return}e++,n.onFail?.(e,_),YD(C).then(()=>f()?void 0:g()).then(()=>{t?m(_):b()})})};return{promise:i,cancel:u,continue:()=>(a?.(),i),cancelRetry:l,continueRetry:c,canStart:d,start:()=>(d()?b():g().then(b),i)}}var nk=n=>setTimeout(n,0);function rk(){let n=[],t=0,e=l=>{l()},r=l=>{l()},a=nk;const i=l=>{t?n.push(l):a(()=>{e(l)})},u=()=>{const l=n;n=[],l.length&&a(()=>{r(()=>{l.forEach(c=>{e(c)})})})};return{batch:l=>{let c;t++;try{c=l()}finally{t--,t||u()}return c},batchCalls:l=>(...c)=>{i(()=>{l(...c)})},schedule:i,setNotifyFunction:l=>{e=l},setBatchNotifyFunction:l=>{r=l},setScheduler:l=>{a=l}}}var Xt=rk(),g_=class{#t;destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),$v(this.gcTime)&&(this.#t=setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(n){this.gcTime=Math.max(this.gcTime||0,n??(uo?1/0:5*60*1e3))}clearGcTimeout(){this.#t&&(clearTimeout(this.#t),this.#t=void 0)}},ak=class extends g_{#t;#e;#n;#r;#a;#o;#s;constructor(n){super(),this.#s=!1,this.#o=n.defaultOptions,this.setOptions(n.options),this.observers=[],this.#r=n.client,this.#n=this.#r.getQueryCache(),this.queryKey=n.queryKey,this.queryHash=n.queryHash,this.#t=ik(this.options),this.state=n.state??this.#t,this.scheduleGc()}get meta(){return this.options.meta}get promise(){return this.#a?.promise}setOptions(n){this.options={...this.#o,...n},this.updateGcTime(this.options.gcTime)}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&this.#n.remove(this)}setData(n,t){const e=Qv(this.state.data,n,this.options);return this.#i({data:e,type:"success",dataUpdatedAt:t?.updatedAt,manual:t?.manual}),e}setState(n,t){this.#i({type:"setState",state:n,setStateOptions:t})}cancel(n){const t=this.#a?.promise;return this.#a?.cancel(n),t?t.then(Tn).catch(Tn):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(this.#t)}isActive(){return this.observers.some(n=>Ar(n.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===Xm||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(n=>xi(n.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(n=>n.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(n=0){return this.state.data===void 0?!0:n==="static"?!1:this.state.isInvalidated?!0:!c_(this.state.dataUpdatedAt,n)}onFocus(){this.observers.find(t=>t.shouldFetchOnWindowFocus())?.refetch({cancelRefetch:!1}),this.#a?.continue()}onOnline(){this.observers.find(t=>t.shouldFetchOnReconnect())?.refetch({cancelRefetch:!1}),this.#a?.continue()}addObserver(n){this.observers.includes(n)||(this.observers.push(n),this.clearGcTimeout(),this.#n.notify({type:"observerAdded",query:this,observer:n}))}removeObserver(n){this.observers.includes(n)&&(this.observers=this.observers.filter(t=>t!==n),this.observers.length||(this.#a&&(this.#s?this.#a.cancel({revert:!0}):this.#a.cancelRetry()),this.scheduleGc()),this.#n.notify({type:"observerRemoved",query:this,observer:n}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||this.#i({type:"invalidate"})}fetch(n,t){if(this.state.fetchStatus!=="idle"){if(this.state.data!==void 0&&t?.cancelRefetch)this.cancel({silent:!0});else if(this.#a)return this.#a.continueRetry(),this.#a.promise}if(n&&this.setOptions(n),!this.options.queryFn){const c=this.observers.find(f=>f.options.queryFn);c&&this.setOptions(c.options)}const e=new AbortController,r=c=>{Object.defineProperty(c,"signal",{enumerable:!0,get:()=>(this.#s=!0,e.signal)})},a=()=>{const c=h_(this.options,t),d=(()=>{const v={client:this.#r,queryKey:this.queryKey,meta:this.meta};return r(v),v})();return this.#s=!1,this.options.persister?this.options.persister(c,d,this):c(d)},u=(()=>{const c={fetchOptions:t,options:this.options,queryKey:this.queryKey,client:this.#r,state:this.state,fetchFn:a};return r(c),c})();this.options.behavior?.onFetch(u,this),this.#e=this.state,(this.state.fetchStatus==="idle"||this.state.fetchMeta!==u.fetchOptions?.meta)&&this.#i({type:"fetch",meta:u.fetchOptions?.meta});const l=c=>{rv(c)&&c.silent||this.#i({type:"error",error:c}),rv(c)||(this.#n.config.onError?.(c,this),this.#n.config.onSettled?.(this.state.data,c,this)),this.scheduleGc()};return this.#a=m_({initialPromise:t?.initialPromise,fn:u.fetchFn,abort:e.abort.bind(e),onSuccess:c=>{if(c===void 0){l(new Error(`${this.queryHash} data is undefined`));return}try{this.setData(c)}catch(f){l(f);return}this.#n.config.onSuccess?.(c,this),this.#n.config.onSettled?.(c,this.state.error,this),this.scheduleGc()},onError:l,onFail:(c,f)=>{this.#i({type:"failed",failureCount:c,error:f})},onPause:()=>{this.#i({type:"pause"})},onContinue:()=>{this.#i({type:"continue"})},retry:u.options.retry,retryDelay:u.options.retryDelay,networkMode:u.options.networkMode,canRun:()=>!0}),this.#a.start()}#i(n){const t=e=>{switch(n.type){case"failed":return{...e,fetchFailureCount:n.failureCount,fetchFailureReason:n.error};case"pause":return{...e,fetchStatus:"paused"};case"continue":return{...e,fetchStatus:"fetching"};case"fetch":return{...e,...y_(e.data,this.options),fetchMeta:n.meta??null};case"success":return this.#e=void 0,{...e,data:n.data,dataUpdateCount:e.dataUpdateCount+1,dataUpdatedAt:n.dataUpdatedAt??Date.now(),error:null,isInvalidated:!1,status:"success",...!n.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};case"error":const r=n.error;return rv(r)&&r.revert&&this.#e?{...this.#e,fetchStatus:"idle"}:{...e,error:r,errorUpdateCount:e.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:e.fetchFailureCount+1,fetchFailureReason:r,fetchStatus:"idle",status:"error"};case"invalidate":return{...e,isInvalidated:!0};case"setState":return{...e,...n.state}}};this.state=t(this.state),Xt.batch(()=>{this.observers.forEach(e=>{e.onQueryUpdate()}),this.#n.notify({query:this,type:"updated",action:n})})}};function y_(n,t){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:p_(t.networkMode)?"fetching":"paused",...n===void 0&&{error:null,status:"pending"}}}function ik(n){const t=typeof n.initialData=="function"?n.initialData():n.initialData,e=t!==void 0,r=e?typeof n.initialDataUpdatedAt=="function"?n.initialDataUpdatedAt():n.initialDataUpdatedAt:0;return{data:t,dataUpdateCount:0,dataUpdatedAt:e?r??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:e?"success":"pending",fetchStatus:"idle"}}var ok=class extends Us{constructor(n={}){super(),this.config=n,this.#t=new Map}#t;build(n,t,e){const r=t.queryKey,a=t.queryHash??Km(r,t);let i=this.get(a);return i||(i=new ak({client:n,queryKey:r,queryHash:a,options:n.defaultQueryOptions(t),state:e,defaultOptions:n.getQueryDefaults(r)}),this.add(i)),i}add(n){this.#t.has(n.queryHash)||(this.#t.set(n.queryHash,n),this.notify({type:"added",query:n}))}remove(n){const t=this.#t.get(n.queryHash);t&&(n.destroy(),t===n&&this.#t.delete(n.queryHash),this.notify({type:"removed",query:n}))}clear(){Xt.batch(()=>{this.getAll().forEach(n=>{this.remove(n)})})}get(n){return this.#t.get(n)}getAll(){return[...this.#t.values()]}find(n){const t={exact:!0,...n};return this.getAll().find(e=>wx(t,e))}findAll(n={}){const t=this.getAll();return Object.keys(n).length>0?t.filter(e=>wx(n,e)):t}notify(n){Xt.batch(()=>{this.listeners.forEach(t=>{t(n)})})}onFocus(){Xt.batch(()=>{this.getAll().forEach(n=>{n.onFocus()})})}onOnline(){Xt.batch(()=>{this.getAll().forEach(n=>{n.onOnline()})})}},sk=class extends g_{#t;#e;#n;constructor(n){super(),this.mutationId=n.mutationId,this.#e=n.mutationCache,this.#t=[],this.state=n.state||b_(),this.setOptions(n.options),this.scheduleGc()}setOptions(n){this.options=n,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(n){this.#t.includes(n)||(this.#t.push(n),this.clearGcTimeout(),this.#e.notify({type:"observerAdded",mutation:this,observer:n}))}removeObserver(n){this.#t=this.#t.filter(t=>t!==n),this.scheduleGc(),this.#e.notify({type:"observerRemoved",mutation:this,observer:n})}optionalRemove(){this.#t.length||(this.state.status==="pending"?this.scheduleGc():this.#e.remove(this))}continue(){return this.#n?.continue()??this.execute(this.state.variables)}async execute(n){const t=()=>{this.#r({type:"continue"})};this.#n=m_({fn:()=>this.options.mutationFn?this.options.mutationFn(n):Promise.reject(new Error("No mutationFn found")),onFail:(a,i)=>{this.#r({type:"failed",failureCount:a,error:i})},onPause:()=>{this.#r({type:"pause"})},onContinue:t,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>this.#e.canRun(this)});const e=this.state.status==="pending",r=!this.#n.canStart();try{if(e)t();else{this.#r({type:"pending",variables:n,isPaused:r}),await this.#e.config.onMutate?.(n,this);const i=await this.options.onMutate?.(n);i!==this.state.context&&this.#r({type:"pending",context:i,variables:n,isPaused:r})}const a=await this.#n.start();return await this.#e.config.onSuccess?.(a,n,this.state.context,this),await this.options.onSuccess?.(a,n,this.state.context),await this.#e.config.onSettled?.(a,null,this.state.variables,this.state.context,this),await this.options.onSettled?.(a,null,n,this.state.context),this.#r({type:"success",data:a}),a}catch(a){try{throw await this.#e.config.onError?.(a,n,this.state.context,this),await this.options.onError?.(a,n,this.state.context),await this.#e.config.onSettled?.(void 0,a,this.state.variables,this.state.context,this),await this.options.onSettled?.(void 0,a,n,this.state.context),a}finally{this.#r({type:"error",error:a})}}finally{this.#e.runNext(this)}}#r(n){const t=e=>{switch(n.type){case"failed":return{...e,failureCount:n.failureCount,failureReason:n.error};case"pause":return{...e,isPaused:!0};case"continue":return{...e,isPaused:!1};case"pending":return{...e,context:n.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:n.isPaused,status:"pending",variables:n.variables,submittedAt:Date.now()};case"success":return{...e,data:n.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...e,data:void 0,error:n.error,failureCount:e.failureCount+1,failureReason:n.error,isPaused:!1,status:"error"}}};this.state=t(this.state),Xt.batch(()=>{this.#t.forEach(e=>{e.onMutationUpdate(n)}),this.#e.notify({mutation:this,type:"updated",action:n})})}};function b_(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var uk=class extends Us{constructor(n={}){super(),this.config=n,this.#t=new Set,this.#e=new Map,this.#n=0}#t;#e;#n;build(n,t,e){const r=new sk({mutationCache:this,mutationId:++this.#n,options:n.defaultMutationOptions(t),state:e});return this.add(r),r}add(n){this.#t.add(n);const t=Kc(n);if(typeof t=="string"){const e=this.#e.get(t);e?e.push(n):this.#e.set(t,[n])}this.notify({type:"added",mutation:n})}remove(n){if(this.#t.delete(n)){const t=Kc(n);if(typeof t=="string"){const e=this.#e.get(t);if(e)if(e.length>1){const r=e.indexOf(n);r!==-1&&e.splice(r,1)}else e[0]===n&&this.#e.delete(t)}}this.notify({type:"removed",mutation:n})}canRun(n){const t=Kc(n);if(typeof t=="string"){const r=this.#e.get(t)?.find(a=>a.state.status==="pending");return!r||r===n}else return!0}runNext(n){const t=Kc(n);return typeof t=="string"?this.#e.get(t)?.find(r=>r!==n&&r.state.isPaused)?.continue()??Promise.resolve():Promise.resolve()}clear(){Xt.batch(()=>{this.#t.forEach(n=>{this.notify({type:"removed",mutation:n})}),this.#t.clear(),this.#e.clear()})}getAll(){return Array.from(this.#t)}find(n){const t={exact:!0,...n};return this.getAll().find(e=>_x(t,e))}findAll(n={}){return this.getAll().filter(t=>_x(n,t))}notify(n){Xt.batch(()=>{this.listeners.forEach(t=>{t(n)})})}resumePausedMutations(){const n=this.getAll().filter(t=>t.state.isPaused);return Xt.batch(()=>Promise.all(n.map(t=>t.continue().catch(Tn))))}};function Kc(n){return n.options.scope?.id}function Cx(n){return{onFetch:(t,e)=>{const r=t.options,a=t.fetchOptions?.meta?.fetchMore?.direction,i=t.state.data?.pages||[],u=t.state.data?.pageParams||[];let l={pages:[],pageParams:[]},c=0;const f=async()=>{let d=!1;const v=b=>{Object.defineProperty(b,"signal",{enumerable:!0,get:()=>(t.signal.aborted?d=!0:t.signal.addEventListener("abort",()=>{d=!0}),t.signal)})},m=h_(t.options,t.fetchOptions),g=async(b,w,S)=>{if(d)return Promise.reject();if(w==null&&b.pages.length)return Promise.resolve(b);const E=(()=>{const D={client:t.client,queryKey:t.queryKey,pageParam:w,direction:S?"backward":"forward",meta:t.options.meta};return v(D),D})(),R=await m(E),{maxPages:C}=t.options,A=S?ZD:QD;return{pages:A(b.pages,R,C),pageParams:A(b.pageParams,w,C)}};if(a&&i.length){const b=a==="backward",w=b?lk:Rx,S={pages:i,pageParams:u},_=w(r,S);l=await g(S,_,b)}else{const b=n??i.length;do{const w=c===0?u[0]??r.initialPageParam:Rx(r,l);if(c>0&&w==null)break;l=await g(l,w),c++}while(c<b)}return l};t.options.persister?t.fetchFn=()=>t.options.persister?.(f,{client:t.client,queryKey:t.queryKey,meta:t.options.meta,signal:t.signal},e):t.fetchFn=f}}}function Rx(n,{pages:t,pageParams:e}){const r=t.length-1;return t.length>0?n.getNextPageParam(t[r],t,e[r],e):void 0}function lk(n,{pages:t,pageParams:e}){return t.length>0?n.getPreviousPageParam?.(t[0],t,e[0],e):void 0}var MP=class{#t;#e;#n;#r;#a;#o;#s;#i;constructor(n={}){this.#t=n.queryCache||new ok,this.#e=n.mutationCache||new uk,this.#n=n.defaultOptions||{},this.#r=new Map,this.#a=new Map,this.#o=0}mount(){this.#o++,this.#o===1&&(this.#s=$m.subscribe(async n=>{n&&(await this.resumePausedMutations(),this.#t.onFocus())}),this.#i=Af.subscribe(async n=>{n&&(await this.resumePausedMutations(),this.#t.onOnline())}))}unmount(){this.#o--,this.#o===0&&(this.#s?.(),this.#s=void 0,this.#i?.(),this.#i=void 0)}isFetching(n){return this.#t.findAll({...n,fetchStatus:"fetching"}).length}isMutating(n){return this.#e.findAll({...n,status:"pending"}).length}getQueryData(n){const t=this.defaultQueryOptions({queryKey:n});return this.#t.get(t.queryHash)?.state.data}ensureQueryData(n){const t=this.defaultQueryOptions(n),e=this.#t.build(this,t),r=e.state.data;return r===void 0?this.fetchQuery(n):(n.revalidateIfStale&&e.isStaleByTime(xi(t.staleTime,e))&&this.prefetchQuery(t),Promise.resolve(r))}getQueriesData(n){return this.#t.findAll(n).map(({queryKey:t,state:e})=>{const r=e.data;return[t,r]})}setQueryData(n,t,e){const r=this.defaultQueryOptions({queryKey:n}),i=this.#t.get(r.queryHash)?.state.data,u=$D(t,i);if(u!==void 0)return this.#t.build(this,r).setData(u,{...e,manual:!0})}setQueriesData(n,t,e){return Xt.batch(()=>this.#t.findAll(n).map(({queryKey:r})=>[r,this.setQueryData(r,t,e)]))}getQueryState(n){const t=this.defaultQueryOptions({queryKey:n});return this.#t.get(t.queryHash)?.state}removeQueries(n){const t=this.#t;Xt.batch(()=>{t.findAll(n).forEach(e=>{t.remove(e)})})}resetQueries(n,t){const e=this.#t;return Xt.batch(()=>(e.findAll(n).forEach(r=>{r.reset()}),this.refetchQueries({type:"active",...n},t)))}cancelQueries(n,t={}){const e={revert:!0,...t},r=Xt.batch(()=>this.#t.findAll(n).map(a=>a.cancel(e)));return Promise.all(r).then(Tn).catch(Tn)}invalidateQueries(n,t={}){return Xt.batch(()=>(this.#t.findAll(n).forEach(e=>{e.invalidate()}),n?.refetchType==="none"?Promise.resolve():this.refetchQueries({...n,type:n?.refetchType??n?.type??"active"},t)))}refetchQueries(n,t={}){const e={...t,cancelRefetch:t.cancelRefetch??!0},r=Xt.batch(()=>this.#t.findAll(n).filter(a=>!a.isDisabled()&&!a.isStatic()).map(a=>{let i=a.fetch(void 0,e);return e.throwOnError||(i=i.catch(Tn)),a.state.fetchStatus==="paused"?Promise.resolve():i}));return Promise.all(r).then(Tn)}fetchQuery(n){const t=this.defaultQueryOptions(n);t.retry===void 0&&(t.retry=!1);const e=this.#t.build(this,t);return e.isStaleByTime(xi(t.staleTime,e))?e.fetch(t):Promise.resolve(e.state.data)}prefetchQuery(n){return this.fetchQuery(n).then(Tn).catch(Tn)}fetchInfiniteQuery(n){return n.behavior=Cx(n.pages),this.fetchQuery(n)}prefetchInfiniteQuery(n){return this.fetchInfiniteQuery(n).then(Tn).catch(Tn)}ensureInfiniteQueryData(n){return n.behavior=Cx(n.pages),this.ensureQueryData(n)}resumePausedMutations(){return Af.isOnline()?this.#e.resumePausedMutations():Promise.resolve()}getQueryCache(){return this.#t}getMutationCache(){return this.#e}getDefaultOptions(){return this.#n}setDefaultOptions(n){this.#n=n}setQueryDefaults(n,t){this.#r.set(lo(n),{queryKey:n,defaultOptions:t})}getQueryDefaults(n){const t=[...this.#r.values()],e={};return t.forEach(r=>{al(n,r.queryKey)&&Object.assign(e,r.defaultOptions)}),e}setMutationDefaults(n,t){this.#a.set(lo(n),{mutationKey:n,defaultOptions:t})}getMutationDefaults(n){const t=[...this.#a.values()],e={};return t.forEach(r=>{al(n,r.mutationKey)&&Object.assign(e,r.defaultOptions)}),e}defaultQueryOptions(n){if(n._defaulted)return n;const t={...this.#n.queries,...this.getQueryDefaults(n.queryKey),...n,_defaulted:!0};return t.queryHash||(t.queryHash=Km(t.queryKey,t)),t.refetchOnReconnect===void 0&&(t.refetchOnReconnect=t.networkMode!=="always"),t.throwOnError===void 0&&(t.throwOnError=!!t.suspense),!t.networkMode&&t.persister&&(t.networkMode="offlineFirst"),t.queryFn===Xm&&(t.enabled=!1),t}defaultMutationOptions(n){return n?._defaulted?n:{...this.#n.mutations,...n?.mutationKey&&this.getMutationDefaults(n.mutationKey),...n,_defaulted:!0}}clear(){this.#t.clear(),this.#e.clear()}},ck=class extends Us{constructor(n,t){super(),this.options=t,this.#t=n,this.#i=null,this.#s=Zv(),this.options.experimental_prefetchInRender||this.#s.reject(new Error("experimental_prefetchInRender feature flag is not enabled")),this.bindMethods(),this.setOptions(t)}#t;#e=void 0;#n=void 0;#r=void 0;#a;#o;#s;#i;#v;#h;#d;#l;#c;#u;#p=new Set;bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(this.#e.addObserver(this),Ax(this.#e,this.options)?this.#f():this.updateResult(),this.#b())}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return Jv(this.#e,this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return Jv(this.#e,this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,this.#x(),this.#w(),this.#e.removeObserver(this)}setOptions(n){const t=this.options,e=this.#e;if(this.options=this.#t.defaultQueryOptions(n),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof Ar(this.options.enabled,this.#e)!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");this.#_(),this.#e.setOptions(this.options),t._defaulted&&!Rf(this.options,t)&&this.#t.getQueryCache().notify({type:"observerOptionsUpdated",query:this.#e,observer:this});const r=this.hasListeners();r&&Tx(this.#e,e,this.options,t)&&this.#f(),this.updateResult(),r&&(this.#e!==e||Ar(this.options.enabled,this.#e)!==Ar(t.enabled,this.#e)||xi(this.options.staleTime,this.#e)!==xi(t.staleTime,this.#e))&&this.#m();const a=this.#g();r&&(this.#e!==e||Ar(this.options.enabled,this.#e)!==Ar(t.enabled,this.#e)||a!==this.#u)&&this.#y(a)}getOptimisticResult(n){const t=this.#t.getQueryCache().build(this.#t,n),e=this.createResult(t,n);return hk(this,e)&&(this.#r=e,this.#o=this.options,this.#a=this.#e.state),e}getCurrentResult(){return this.#r}trackResult(n,t){return new Proxy(n,{get:(e,r)=>(this.trackProp(r),t?.(r),Reflect.get(e,r))})}trackProp(n){this.#p.add(n)}getCurrentQuery(){return this.#e}refetch({...n}={}){return this.fetch({...n})}fetchOptimistic(n){const t=this.#t.defaultQueryOptions(n),e=this.#t.getQueryCache().build(this.#t,t);return e.fetch().then(()=>this.createResult(e,t))}fetch(n){return this.#f({...n,cancelRefetch:n.cancelRefetch??!0}).then(()=>(this.updateResult(),this.#r))}#f(n){this.#_();let t=this.#e.fetch(this.options,n);return n?.throwOnError||(t=t.catch(Tn)),t}#m(){this.#x();const n=xi(this.options.staleTime,this.#e);if(uo||this.#r.isStale||!$v(n))return;const e=c_(this.#r.dataUpdatedAt,n)+1;this.#l=setTimeout(()=>{this.#r.isStale||this.updateResult()},e)}#g(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(this.#e):this.options.refetchInterval)??!1}#y(n){this.#w(),this.#u=n,!(uo||Ar(this.options.enabled,this.#e)===!1||!$v(this.#u)||this.#u===0)&&(this.#c=setInterval(()=>{(this.options.refetchIntervalInBackground||$m.isFocused())&&this.#f()},this.#u))}#b(){this.#m(),this.#y(this.#g())}#x(){this.#l&&(clearTimeout(this.#l),this.#l=void 0)}#w(){this.#c&&(clearInterval(this.#c),this.#c=void 0)}createResult(n,t){const e=this.#e,r=this.options,a=this.#r,i=this.#a,u=this.#o,c=n!==e?n.state:this.#n,{state:f}=n;let d={...f},v=!1,m;if(t._optimisticResults){const I=this.hasListeners(),N=!I&&Ax(n,t),B=I&&Tx(n,e,t,r);(N||B)&&(d={...d,...y_(f.data,n.options)}),t._optimisticResults==="isRestoring"&&(d.fetchStatus="idle")}let{error:g,errorUpdatedAt:b,status:w}=d;m=d.data;let S=!1;if(t.placeholderData!==void 0&&m===void 0&&w==="pending"){let I;a?.isPlaceholderData&&t.placeholderData===u?.placeholderData?(I=a.data,S=!0):I=typeof t.placeholderData=="function"?t.placeholderData(this.#d?.state.data,this.#d):t.placeholderData,I!==void 0&&(w="success",m=Qv(a?.data,I,t),v=!0)}if(t.select&&m!==void 0&&!S)if(a&&m===i?.data&&t.select===this.#v)m=this.#h;else try{this.#v=t.select,m=t.select(m),m=Qv(a?.data,m,t),this.#h=m,this.#i=null}catch(I){this.#i=I}this.#i&&(g=this.#i,m=this.#h,b=Date.now(),w="error");const _=d.fetchStatus==="fetching",E=w==="pending",R=w==="error",C=E&&_,A=m!==void 0,k={status:w,fetchStatus:d.fetchStatus,isPending:E,isSuccess:w==="success",isError:R,isInitialLoading:C,isLoading:C,data:m,dataUpdatedAt:d.dataUpdatedAt,error:g,errorUpdatedAt:b,failureCount:d.fetchFailureCount,failureReason:d.fetchFailureReason,errorUpdateCount:d.errorUpdateCount,isFetched:d.dataUpdateCount>0||d.errorUpdateCount>0,isFetchedAfterMount:d.dataUpdateCount>c.dataUpdateCount||d.errorUpdateCount>c.errorUpdateCount,isFetching:_,isRefetching:_&&!E,isLoadingError:R&&!A,isPaused:d.fetchStatus==="paused",isPlaceholderData:v,isRefetchError:R&&A,isStale:Ym(n,t),refetch:this.refetch,promise:this.#s};if(this.options.experimental_prefetchInRender){const I=V=>{k.status==="error"?V.reject(k.error):k.data!==void 0&&V.resolve(k.data)},N=()=>{const V=this.#s=k.promise=Zv();I(V)},B=this.#s;switch(B.status){case"pending":n.queryHash===e.queryHash&&I(B);break;case"fulfilled":(k.status==="error"||k.data!==B.value)&&N();break;case"rejected":(k.status!=="error"||k.error!==B.reason)&&N();break}}return k}updateResult(){const n=this.#r,t=this.createResult(this.#e,this.options);if(this.#a=this.#e.state,this.#o=this.options,this.#a.data!==void 0&&(this.#d=this.#e),Rf(t,n))return;this.#r=t;const e=()=>{if(!n)return!0;const{notifyOnChangeProps:r}=this.options,a=typeof r=="function"?r():r;if(a==="all"||!a&&!this.#p.size)return!0;const i=new Set(a??this.#p);return this.options.throwOnError&&i.add("error"),Object.keys(this.#r).some(u=>{const l=u;return this.#r[l]!==n[l]&&i.has(l)})};this.#S({listeners:e()})}#_(){const n=this.#t.getQueryCache().build(this.#t,this.options);if(n===this.#e)return;const t=this.#e;this.#e=n,this.#n=n.state,this.hasListeners()&&(t?.removeObserver(this),n.addObserver(this))}onQueryUpdate(){this.updateResult(),this.hasListeners()&&this.#b()}#S(n){Xt.batch(()=>{n.listeners&&this.listeners.forEach(t=>{t(this.#r)}),this.#t.getQueryCache().notify({query:this.#e,type:"observerResultsUpdated"})})}};function fk(n,t){return Ar(t.enabled,n)!==!1&&n.state.data===void 0&&!(n.state.status==="error"&&t.retryOnMount===!1)}function Ax(n,t){return fk(n,t)||n.state.data!==void 0&&Jv(n,t,t.refetchOnMount)}function Jv(n,t,e){if(Ar(t.enabled,n)!==!1&&xi(t.staleTime,n)!=="static"){const r=typeof e=="function"?e(n):e;return r==="always"||r!==!1&&Ym(n,t)}return!1}function Tx(n,t,e,r){return(n!==t||Ar(r.enabled,n)===!1)&&(!e.suspense||n.state.status!=="error")&&Ym(n,e)}function Ym(n,t){return Ar(t.enabled,n)!==!1&&n.isStaleByTime(xi(t.staleTime,n))}function hk(n,t){return!Rf(n.getCurrentResult(),t)}var dk=class extends Us{#t;#e=void 0;#n;#r;constructor(t,e){super(),this.#t=t,this.setOptions(e),this.bindMethods(),this.#a()}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(t){const e=this.options;this.options=this.#t.defaultMutationOptions(t),Rf(this.options,e)||this.#t.getMutationCache().notify({type:"observerOptionsUpdated",mutation:this.#n,observer:this}),e?.mutationKey&&this.options.mutationKey&&lo(e.mutationKey)!==lo(this.options.mutationKey)?this.reset():this.#n?.state.status==="pending"&&this.#n.setOptions(this.options)}onUnsubscribe(){this.hasListeners()||this.#n?.removeObserver(this)}onMutationUpdate(t){this.#a(),this.#o(t)}getCurrentResult(){return this.#e}reset(){this.#n?.removeObserver(this),this.#n=void 0,this.#a(),this.#o()}mutate(t,e){return this.#r=e,this.#n?.removeObserver(this),this.#n=this.#t.getMutationCache().build(this.#t,this.options),this.#n.addObserver(this),this.#n.execute(t)}#a(){const t=this.#n?.state??b_();this.#e={...t,isPending:t.status==="pending",isSuccess:t.status==="success",isError:t.status==="error",isIdle:t.status==="idle",mutate:this.mutate,reset:this.reset}}#o(t){Xt.batch(()=>{if(this.#r&&this.hasListeners()){const e=this.#e.variables,r=this.#e.context;t?.type==="success"?(this.#r.onSuccess?.(t.data,e,r),this.#r.onSettled?.(t.data,null,e,r)):t?.type==="error"&&(this.#r.onError?.(t.error,e,r),this.#r.onSettled?.(void 0,t.error,e,r))}this.listeners.forEach(e=>{e(this.#e)})})}},x_=Y.createContext(void 0),w_=n=>{const t=Y.useContext(x_);if(!t)throw new Error("No QueryClient set, use QueryClientProvider to set one");return t},FP=({client:n,children:t})=>(Y.useEffect(()=>(n.mount(),()=>{n.unmount()}),[n]),pA.jsx(x_.Provider,{value:n,children:t})),__=Y.createContext(!1),pk=()=>Y.useContext(__);__.Provider;function vk(){let n=!1;return{clearReset:()=>{n=!1},reset:()=>{n=!0},isReset:()=>n}}var mk=Y.createContext(vk()),gk=()=>Y.useContext(mk),yk=(n,t)=>{(n.suspense||n.throwOnError||n.experimental_prefetchInRender)&&(t.isReset()||(n.retryOnMount=!1))},bk=n=>{Y.useEffect(()=>{n.clearReset()},[n])},xk=({result:n,errorResetBoundary:t,throwOnError:e,query:r,suspense:a})=>n.isError&&!t.isReset()&&!n.isFetching&&r&&(a&&n.data===void 0||d_(e,[n.error,r])),wk=n=>{if(n.suspense){const t=r=>r==="static"?r:Math.max(r??1e3,1e3),e=n.staleTime;n.staleTime=typeof e=="function"?(...r)=>t(e(...r)):t(e),typeof n.gcTime=="number"&&(n.gcTime=Math.max(n.gcTime,1e3))}},_k=(n,t)=>n.isLoading&&n.isFetching&&!t,Sk=(n,t)=>n?.suspense&&t.isPending,Dx=(n,t,e)=>t.fetchOptimistic(n).catch(()=>{e.clearReset()});function Ek(n,t,e){const r=pk(),a=gk(),i=w_(),u=i.defaultQueryOptions(n);i.getDefaultOptions().queries?._experimental_beforeQuery?.(u),u._optimisticResults=r?"isRestoring":"optimistic",wk(u),yk(u,a),bk(a);const l=!i.getQueryCache().get(u.queryHash),[c]=Y.useState(()=>new t(i,u)),f=c.getOptimisticResult(u),d=!r&&n.subscribed!==!1;if(Y.useSyncExternalStore(Y.useCallback(v=>{const m=d?c.subscribe(Xt.batchCalls(v)):Tn;return c.updateResult(),m},[c,d]),()=>c.getCurrentResult(),()=>c.getCurrentResult()),Y.useEffect(()=>{c.setOptions(u)},[u,c]),Sk(u,f))throw Dx(u,c,a);if(xk({result:f,errorResetBoundary:a,throwOnError:u.throwOnError,query:i.getQueryCache().get(u.queryHash),suspense:u.suspense}))throw f.error;return i.getDefaultOptions().queries?._experimental_afterQuery?.(u,f),u.experimental_prefetchInRender&&!uo&&_k(f,r)&&(l?Dx(u,c,a):i.getQueryCache().get(u.queryHash)?.promise)?.catch(Tn).finally(()=>{c.updateResult()}),u.notifyOnChangeProps?f:c.trackResult(f)}function BP(n,t){return Ek(n,ck)}function LP(n,t){const e=w_(),[r]=Y.useState(()=>new dk(e,n));Y.useEffect(()=>{r.setOptions(n)},[r,n]);const a=Y.useSyncExternalStore(Y.useCallback(u=>r.subscribe(Xt.batchCalls(u)),[r]),()=>r.getCurrentResult(),()=>r.getCurrentResult()),i=Y.useCallback((u,l)=>{r.mutate(u,l).catch(Tn)},[r]);if(a.error&&d_(r.options.throwOnError,[a.error]))throw a.error;return{...a,mutate:i,mutateAsync:a.mutate}}var PP=function(){return null};const Ck=(n,t,e,r)=>{const a=[e,{code:t,...r||{}}];if(n?.services?.logger?.forward)return n.services.logger.forward(a,"warn","react-i18next::",!0);ao(a[0])&&(a[0]=`react-i18next:: ${a[0]}`),n?.services?.logger?.warn?n.services.logger.warn(...a):console?.warn&&console.warn(...a)},kx={},em=(n,t,e,r)=>{ao(e)&&kx[e]||(ao(e)&&(kx[e]=new Date),Ck(n,t,e,r))},S_=(n,t)=>()=>{if(n.isInitialized)t();else{const e=()=>{setTimeout(()=>{n.off("initialized",e)},0),t()};n.on("initialized",e)}},tm=(n,t,e)=>{n.loadNamespaces(t,S_(n,e))},Ox=(n,t,e,r)=>{if(ao(e)&&(e=[e]),n.options.preload&&n.options.preload.indexOf(t)>-1)return tm(n,e,r);e.forEach(a=>{n.options.ns.indexOf(a)<0&&n.options.ns.push(a)}),n.loadLanguages(t,S_(n,r))},Rk=(n,t,e={})=>!t.languages||!t.languages.length?(em(t,"NO_LANGUAGES","i18n.languages were undefined or empty",{languages:t.languages}),!0):t.hasLoadedNamespace(n,{lng:e.lng,precheck:(r,a)=>{if(e.bindI18n?.indexOf("languageChanging")>-1&&r.services.backendConnector.backend&&r.isLanguageChangingTo&&!a(r.isLanguageChangingTo,n))return!1}}),ao=n=>typeof n=="string",Ak=n=>typeof n=="object"&&n!==null,Tk=/&(?:amp|#38|lt|#60|gt|#62|apos|#39|quot|#34|nbsp|#160|copy|#169|reg|#174|hellip|#8230|#x2F|#47);/g,Dk={"&amp;":"&","&#38;":"&","&lt;":"<","&#60;":"<","&gt;":">","&#62;":">","&apos;":"'","&#39;":"'","&quot;":'"',"&#34;":'"',"&nbsp;":" ","&#160;":" ","&copy;":"","&#169;":"","&reg;":"","&#174;":"","&hellip;":"","&#8230;":"","&#x2F;":"/","&#47;":"/"},kk=n=>Dk[n],Ok=n=>n.replace(Tk,kk);let nm={bindI18n:"languageChanged",bindI18nStore:"",transEmptyNodeValue:"",transSupportBasicHtmlNodes:!0,transWrapTextNodes:"",transKeepBasicHtmlNodesFor:["br","strong","i","p"],useSuspense:!0,unescape:Ok};const Nk=(n={})=>{nm={...nm,...n}},Mk=()=>nm;let E_;const Ik=n=>{E_=n},Fk=()=>E_,zP={type:"3rdParty",init(n){Nk(n.options.react),Ik(n)}},C_=Y.createContext();class Bk{constructor(){this.usedNamespaces={}}addUsedNamespaces(t){t.forEach(e=>{this.usedNamespaces[e]||(this.usedNamespaces[e]=!0)})}getUsedNamespaces(){return Object.keys(this.usedNamespaces)}}const Lk=(n,t)=>{const e=Y.useRef();return Y.useEffect(()=>{e.current=n},[n,t]),e.current},R_=(n,t,e,r)=>n.getFixedT(t,e,r),Pk=(n,t,e,r)=>Y.useCallback(R_(n,t,e,r),[n,t,e,r]),UP=(n,t={})=>{const{i18n:e}=t,{i18n:r,defaultNS:a}=Y.useContext(C_)||{},i=e||r||Fk();if(i&&!i.reportNamespaces&&(i.reportNamespaces=new Bk),!i){em(i,"NO_I18NEXT_INSTANCE","useTranslation: You will need to pass in an i18next instance by using initReactI18next");const C=(D,k)=>ao(k)?k:Ak(k)&&ao(k.defaultValue)?k.defaultValue:Array.isArray(D)?D[D.length-1]:D,A=[C,{},!1];return A.t=C,A.i18n={},A.ready=!1,A}i.options.react?.wait&&em(i,"DEPRECATED_OPTION","useTranslation: It seems you are still using the old wait option, you may migrate to the new useSuspense behaviour.");const u={...Mk(),...i.options.react,...t},{useSuspense:l,keyPrefix:c}=u;let f=a||i.options?.defaultNS;f=ao(f)?[f]:f||["translation"],i.reportNamespaces.addUsedNamespaces?.(f);const d=(i.isInitialized||i.initializedStoreOnce)&&f.every(C=>Rk(C,i,u)),v=Pk(i,t.lng||null,u.nsMode==="fallback"?f:f[0],c),m=()=>v,g=()=>R_(i,t.lng||null,u.nsMode==="fallback"?f:f[0],c),[b,w]=Y.useState(m);let S=f.join();t.lng&&(S=`${t.lng}${S}`);const _=Lk(S),E=Y.useRef(!0);Y.useEffect(()=>{const{bindI18n:C,bindI18nStore:A}=u;E.current=!0,!d&&!l&&(t.lng?Ox(i,t.lng,f,()=>{E.current&&w(g)}):tm(i,f,()=>{E.current&&w(g)})),d&&_&&_!==S&&E.current&&w(g);const D=()=>{E.current&&w(g)};return C&&i?.on(C,D),A&&i?.store.on(A,D),()=>{E.current=!1,i&&C?.split(" ").forEach(k=>i.off(k,D)),A&&i&&A.split(" ").forEach(k=>i.store.off(k,D))}},[i,S]),Y.useEffect(()=>{E.current&&d&&w(m)},[i,c,d]);const R=[b,i,d];if(R.t=b,R.i18n=i,R.ready=d,d||!d&&!l)return R;throw new Promise(C=>{t.lng?Ox(i,t.lng,f,()=>C()):tm(i,f,()=>C())})};function VP({i18n:n,defaultNS:t,children:e}){const r=Y.useMemo(()=>({i18n:n,defaultNS:t}),[n,t]);return Y.createElement(C_.Provider,{value:r},e)}function zk(n,t){if(n==null)return{};var e={};for(var r in n)if({}.hasOwnProperty.call(n,r)){if(t.indexOf(r)!==-1)continue;e[r]=n[r]}return e}function Tf(){return Tf=Object.assign?Object.assign.bind():function(n){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var r in e)({}).hasOwnProperty.call(e,r)&&(n[r]=e[r])}return n},Tf.apply(null,arguments)}function rm(n,t){return rm=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,r){return e.__proto__=r,e},rm(n,t)}function Uk(n,t){n.prototype=Object.create(t.prototype),n.prototype.constructor=n,rm(n,t)}function av(n,t,e){if(e||arguments.length===2)for(var r=0,a=t.length,i;r<a;r++)(i||!(r in t))&&(i||(i=Array.prototype.slice.call(t,0,r)),i[r]=t[r]);return n.concat(i||Array.prototype.slice.call(t))}var Xc={};/*!
 * content-type
 * Copyright(c) 2015 Douglas Christopher Wilson
 * MIT Licensed
 */var Nx;function Vk(){if(Nx)return Xc;Nx=1;var n=/; *([!#$%&'*+.^_`|~0-9A-Za-z-]+) *= *("(?:[\u000b\u0020\u0021\u0023-\u005b\u005d-\u007e\u0080-\u00ff]|\\[\u000b\u0020-\u00ff])*"|[!#$%&'*+.^_`|~0-9A-Za-z-]+) */g,t=/^[\u000b\u0020-\u007e\u0080-\u00ff]+$/,e=/^[!#$%&'*+.^_`|~0-9A-Za-z-]+$/,r=/\\([\u000b\u0020-\u00ff])/g,a=/([\\"])/g,i=/^[!#$%&'*+.^_`|~0-9A-Za-z-]+\/[!#$%&'*+.^_`|~0-9A-Za-z-]+$/;Xc.format=u,Xc.parse=l;function u(v){if(!v||typeof v!="object")throw new TypeError("argument obj is required");var m=v.parameters,g=v.type;if(!g||!i.test(g))throw new TypeError("invalid type");var b=g;if(m&&typeof m=="object")for(var w,S=Object.keys(m).sort(),_=0;_<S.length;_++){if(w=S[_],!e.test(w))throw new TypeError("invalid parameter name");b+="; "+w+"="+f(m[w])}return b}function l(v){if(!v)throw new TypeError("argument string is required");var m=typeof v=="object"?c(v):v;if(typeof m!="string")throw new TypeError("argument string is required to be a string");var g=m.indexOf(";"),b=g!==-1?m.slice(0,g).trim():m.trim();if(!i.test(b))throw new TypeError("invalid media type");var w=new d(b.toLowerCase());if(g!==-1){var S,_,E;for(n.lastIndex=g;_=n.exec(m);){if(_.index!==g)throw new TypeError("invalid parameter format");g+=_[0].length,S=_[1].toLowerCase(),E=_[2],E.charCodeAt(0)===34&&(E=E.slice(1,-1),E.indexOf("\\")!==-1&&(E=E.replace(r,"$1"))),w.parameters[S]=E}if(g!==m.length)throw new TypeError("invalid parameter format")}return w}function c(v){var m;if(typeof v.getHeader=="function"?m=v.getHeader("content-type"):typeof v.headers=="object"&&(m=v.headers&&v.headers["content-type"]),typeof m!="string")throw new TypeError("content-type header is missing from object");return m}function f(v){var m=String(v);if(e.test(m))return m;if(m.length>0&&!t.test(m))throw new TypeError("invalid parameter value");return'"'+m.replace(a,"\\$1")+'"'}function d(v){this.parameters=Object.create(null),this.type=v}return Xc}var Hk=Vk(),ls=new Map,A_=function(t){return t.cloneNode(!0)},Mx=function(){return window.location.protocol==="file:"},T_=function(t,e,r){var a=new XMLHttpRequest;a.onreadystatechange=function(){try{if(!/\.svg/i.test(t)&&a.readyState===2){var i=a.getResponseHeader("Content-Type");if(!i)throw new Error("Content type not found");var u=Hk.parse(i).type;if(!(u==="image/svg+xml"||u==="text/plain"))throw new Error("Invalid content type: ".concat(u))}if(a.readyState===4){if(a.status===404||a.responseXML===null)throw new Error(Mx()?"Note: SVG injection ajax calls do not work locally without adjusting security settings in your browser. Or consider using a local webserver.":"Unable to load SVG file: "+t);if(a.status===200||Mx()&&a.status===0)r(null,a);else throw new Error("There was a problem injecting the SVG: "+a.status+" "+a.statusText)}}catch(l){if(a.abort(),l instanceof Error)r(l,a);else throw l}},a.open("GET",t),a.withCredentials=e,a.overrideMimeType&&a.overrideMimeType("text/xml"),a.send()},pi={},Ix=function(t,e){pi[t]=pi[t]||[],pi[t].push(e)},jk=function(t){for(var e=function(u,l){setTimeout(function(){if(Array.isArray(pi[t])){var c=ls.get(t),f=pi[t][u];c instanceof SVGSVGElement&&f(null,A_(c)),c instanceof Error&&f(c),u===pi[t].length-1&&delete pi[t]}},0)},r=0,a=pi[t].length;r<a;r++)e(r)},Wk=function(t,e,r){if(ls.has(t)){var a=ls.get(t);if(a===void 0){Ix(t,r);return}if(a instanceof SVGSVGElement){r(null,A_(a));return}}ls.set(t,void 0),Ix(t,r),T_(t,e,function(i,u){var l;i?ls.set(t,i):((l=u.responseXML)===null||l===void 0?void 0:l.documentElement)instanceof SVGSVGElement&&ls.set(t,u.responseXML.documentElement),jk(t)})},Gk=function(t,e,r){T_(t,e,function(a,i){var u;a?r(a):((u=i.responseXML)===null||u===void 0?void 0:u.documentElement)instanceof SVGSVGElement&&r(null,i.responseXML.documentElement)})},qk=0,Kk=function(){return++qk},Vr=[],Fx={},Xk="http://www.w3.org/2000/svg",iv="http://www.w3.org/1999/xlink",Bx=function(t,e,r,a,i,u,l){var c=t.getAttribute("data-src")||t.getAttribute("src");if(!c){l(new Error("Invalid data-src or src attribute"));return}if(Vr.indexOf(t)!==-1){Vr.splice(Vr.indexOf(t),1),t=null;return}Vr.push(t),t.setAttribute("src","");var f=a?Wk:Gk;f(c,i,function(d,v){if(!v){Vr.splice(Vr.indexOf(t),1),t=null,l(d);return}var m=t.getAttribute("id");m&&v.setAttribute("id",m);var g=t.getAttribute("title");g&&v.setAttribute("title",g);var b=t.getAttribute("width");b&&v.setAttribute("width",b);var w=t.getAttribute("height");w&&v.setAttribute("height",w);var S=Array.from(new Set(av(av(av([],(v.getAttribute("class")||"").split(" "),!0),["injected-svg"],!1),(t.getAttribute("class")||"").split(" "),!0))).join(" ").trim();v.setAttribute("class",S);var _=t.getAttribute("style");_&&v.setAttribute("style",_),v.setAttribute("data-src",c);var E=[].filter.call(t.attributes,function(K){return/^data-\w[\w-]*$/.test(K.name)});if(Array.prototype.forEach.call(E,function(K){K.name&&K.value&&v.setAttribute(K.name,K.value)}),r){var R={clipPath:["clip-path"],"color-profile":["color-profile"],cursor:["cursor"],filter:["filter"],linearGradient:["fill","stroke"],marker:["marker","marker-start","marker-mid","marker-end"],mask:["mask"],path:[],pattern:["fill","stroke"],radialGradient:["fill","stroke"]},C,A,D,k,I;Object.keys(R).forEach(function(K){C=K,D=R[K],A=v.querySelectorAll(C+"[id]");for(var ne=function(oe,de){k=A[oe].id,I=k+"-"+Kk();var me;Array.prototype.forEach.call(D,function(Ke){me=v.querySelectorAll("["+Ke+'*="'+k+'"]');for(var ut=0,yt=me.length;ut<yt;ut++){var pt=me[ut].getAttribute(Ke);pt&&!pt.match(new RegExp('url\\("?#'+k+'"?\\)'))||me[ut].setAttribute(Ke,"url(#"+I+")")}});for(var pe=v.querySelectorAll("[*|href]"),ke=[],ye=0,Ne=pe.length;ye<Ne;ye++){var at=pe[ye].getAttributeNS(iv,"href");at&&at.toString()==="#"+A[oe].id&&ke.push(pe[ye])}for(var Fe=0,je=ke.length;Fe<je;Fe++)ke[Fe].setAttributeNS(iv,"href","#"+I);A[oe].id=I},M=0,G=A.length;M<G;M++)ne(M)})}v.removeAttribute("xmlns:a");for(var N=v.querySelectorAll("script"),B=[],V,U,J=0,ee=N.length;J<ee;J++)U=N[J].getAttribute("type"),(!U||U==="application/ecmascript"||U==="application/javascript"||U==="text/javascript")&&(V=N[J].innerText||N[J].textContent,V&&B.push(V),v.removeChild(N[J]));if(B.length>0&&(e==="always"||e==="once"&&!Fx[c])){for(var te=0,P=B.length;te<P;te++)new Function(B[te])(window);Fx[c]=!0}var j=v.querySelectorAll("style");if(Array.prototype.forEach.call(j,function(K){K.textContent+=""}),v.setAttribute("xmlns",Xk),v.setAttribute("xmlns:xlink",iv),u(v),!t.parentNode){Vr.splice(Vr.indexOf(t),1),t=null,l(new Error("Parent node is null"));return}t.parentNode.replaceChild(v,t),Vr.splice(Vr.indexOf(t),1),t=null,l(null,v)})},$k=function(t,e){var r=e===void 0?{}:e,a=r.afterAll,i=a===void 0?function(){}:a,u=r.afterEach,l=u===void 0?function(){}:u,c=r.beforeEach,f=c===void 0?function(){}:c,d=r.cacheRequests,v=d===void 0?!0:d,m=r.evalScripts,g=m===void 0?"never":m,b=r.httpRequestWithCredentials,w=b===void 0?!1:b,S=r.renumerateIRIElements,_=S===void 0?!0:S;if(t&&"length"in t)for(var E=0,R=0,C=t.length;R<C;R++)Bx(t[R],g,_,v,w,f,function(A,D){l(A,D),t&&"length"in t&&t.length===++E&&i(E)});else t?Bx(t,g,_,v,w,f,function(A,D){l(A,D),i(1),t=null}):i(0)},ov={exports:{}},sv,Lx;function Yk(){if(Lx)return sv;Lx=1;var n="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return sv=n,sv}var uv,Px;function Qk(){if(Px)return uv;Px=1;var n=Yk();function t(){}function e(){}return e.resetWarningCache=t,uv=function(){function r(u,l,c,f,d,v){if(v!==n){var m=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw m.name="Invariant Violation",m}}r.isRequired=r;function a(){return r}var i={array:r,bigint:r,bool:r,func:r,number:r,object:r,string:r,symbol:r,any:r,arrayOf:a,element:r,elementType:r,instanceOf:a,node:r,objectOf:a,oneOf:a,oneOfType:a,shape:a,exact:a,checkPropTypes:e,resetWarningCache:t};return i.PropTypes=i,i},uv}var zx;function Zk(){return zx||(zx=1,ov.exports=Qk()()),ov.exports}var Gt=Zk(),Jk=function(t){var e=t?.ownerDocument||document;return e.defaultView||window},eO=function(t,e){for(var r in t)if(!(r in e))return!0;for(var a in e)if(t[a]!==e[a])return!0;return!1},tO=["afterInjection","beforeInjection","desc","evalScripts","fallback","httpRequestWithCredentials","loading","renumerateIRIElements","src","title","useRequestCache","wrapper"],$c="http://www.w3.org/2000/svg",Ux="http://www.w3.org/1999/xlink",D_=function(n){function t(){for(var r,a=arguments.length,i=new Array(a),u=0;u<a;u++)i[u]=arguments[u];return r=n.call.apply(n,[this].concat(i))||this,r.initialState={hasError:!1,isLoading:!0},r.state=r.initialState,r._isMounted=!1,r.reactWrapper=void 0,r.nonReactWrapper=void 0,r.refCallback=function(l){r.reactWrapper=l},r}Uk(t,n);var e=t.prototype;return e.renderSVG=function(){var a=this;if(this.reactWrapper instanceof Jk(this.reactWrapper).Node){var i=this.props,u=i.desc,l=i.evalScripts,c=i.httpRequestWithCredentials,f=i.renumerateIRIElements,d=i.src,v=i.title,m=i.useRequestCache,g=this.props.onError,b=this.props.beforeInjection,w=this.props.afterInjection,S=this.props.wrapper,_,E;S==="svg"?(_=document.createElementNS($c,S),_.setAttribute("xmlns",$c),_.setAttribute("xmlns:xlink",Ux),E=document.createElementNS($c,S)):(_=document.createElement(S),E=document.createElement(S)),_.appendChild(E),E.dataset.src=d,this.nonReactWrapper=this.reactWrapper.appendChild(_);var R=function(k){if(a.removeSVG(),!a._isMounted){g(k);return}a.setState(function(){return{hasError:!0,isLoading:!1}},function(){g(k)})},C=function(k,I){if(k){R(k);return}a._isMounted&&a.setState(function(){return{isLoading:!1}},function(){try{w(I)}catch(N){R(N)}})},A=function(k){if(k.setAttribute("role","img"),u){var I=k.querySelector(":scope > desc");I&&k.removeChild(I);var N=document.createElement("desc");N.innerHTML=u,k.prepend(N)}if(v){var B=k.querySelector(":scope > title");B&&k.removeChild(B);var V=document.createElement("title");V.innerHTML=v,k.prepend(V)}try{b(k)}catch(U){R(U)}};$k(E,{afterEach:C,beforeEach:A,cacheRequests:m,evalScripts:l,httpRequestWithCredentials:c,renumerateIRIElements:f})}},e.removeSVG=function(){var a;(a=this.nonReactWrapper)!=null&&a.parentNode&&(this.nonReactWrapper.parentNode.removeChild(this.nonReactWrapper),this.nonReactWrapper=null)},e.componentDidMount=function(){this._isMounted=!0,this.renderSVG()},e.componentDidUpdate=function(a){var i=this;eO(Tf({},a),this.props)&&this.setState(function(){return i.initialState},function(){i.removeSVG(),i.renderSVG()})},e.componentWillUnmount=function(){this._isMounted=!1,this.removeSVG()},e.render=function(){var a=this.props;a.afterInjection,a.beforeInjection,a.desc,a.evalScripts;var i=a.fallback;a.httpRequestWithCredentials;var u=a.loading;a.renumerateIRIElements,a.src,a.title,a.useRequestCache;var l=a.wrapper,c=zk(a,tO),f=l;return Y.createElement(f,Tf({},c,{ref:this.refCallback},l==="svg"?{xmlns:$c,xmlnsXlink:Ux}:{}),this.state.isLoading&&u&&Y.createElement(u,null),this.state.hasError&&i&&Y.createElement(i,null))},t}(Y.Component);D_.defaultProps={afterInjection:function(){},beforeInjection:function(){},desc:"",evalScripts:"never",fallback:null,httpRequestWithCredentials:!1,loading:null,onError:function(){},renumerateIRIElements:!0,title:"",useRequestCache:!0,wrapper:"div"};D_.propTypes={afterInjection:Gt.func,beforeInjection:Gt.func,desc:Gt.string,evalScripts:Gt.oneOf(["always","once","never"]),fallback:Gt.oneOfType([Gt.func,Gt.object,Gt.string]),httpRequestWithCredentials:Gt.bool,loading:Gt.oneOfType([Gt.func,Gt.object,Gt.string]),onError:Gt.func,renumerateIRIElements:Gt.bool,src:Gt.string.isRequired,title:Gt.string,useRequestCache:Gt.bool,wrapper:Gt.oneOf(["div","span","svg"])};const Pe=n=>typeof n=="string",ju=()=>{let n,t;const e=new Promise((r,a)=>{n=r,t=a});return e.resolve=n,e.reject=t,e},Vx=n=>n==null?"":""+n,nO=(n,t,e)=>{n.forEach(r=>{t[r]&&(e[r]=t[r])})},rO=/###/g,Hx=n=>n&&n.indexOf("###")>-1?n.replace(rO,"."):n,jx=n=>!n||Pe(n),Zu=(n,t,e)=>{const r=Pe(t)?t.split("."):t;let a=0;for(;a<r.length-1;){if(jx(n))return{};const i=Hx(r[a]);!n[i]&&e&&(n[i]=new e),Object.prototype.hasOwnProperty.call(n,i)?n=n[i]:n={},++a}return jx(n)?{}:{obj:n,k:Hx(r[a])}},Wx=(n,t,e)=>{const{obj:r,k:a}=Zu(n,t,Object);if(r!==void 0||t.length===1){r[a]=e;return}let i=t[t.length-1],u=t.slice(0,t.length-1),l=Zu(n,u,Object);for(;l.obj===void 0&&u.length;)i=`${u[u.length-1]}.${i}`,u=u.slice(0,u.length-1),l=Zu(n,u,Object),l?.obj&&typeof l.obj[`${l.k}.${i}`]<"u"&&(l.obj=void 0);l.obj[`${l.k}.${i}`]=e},aO=(n,t,e,r)=>{const{obj:a,k:i}=Zu(n,t,Object);a[i]=a[i]||[],a[i].push(e)},Df=(n,t)=>{const{obj:e,k:r}=Zu(n,t);if(e&&Object.prototype.hasOwnProperty.call(e,r))return e[r]},iO=(n,t,e)=>{const r=Df(n,e);return r!==void 0?r:Df(t,e)},k_=(n,t,e)=>{for(const r in t)r!=="__proto__"&&r!=="constructor"&&(r in n?Pe(n[r])||n[r]instanceof String||Pe(t[r])||t[r]instanceof String?e&&(n[r]=t[r]):k_(n[r],t[r],e):n[r]=t[r]);return n},as=n=>n.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&");var oO={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};const sO=n=>Pe(n)?n.replace(/[&<>"'\/]/g,t=>oO[t]):n;class uO{constructor(t){this.capacity=t,this.regExpMap=new Map,this.regExpQueue=[]}getRegExp(t){const e=this.regExpMap.get(t);if(e!==void 0)return e;const r=new RegExp(t);return this.regExpQueue.length===this.capacity&&this.regExpMap.delete(this.regExpQueue.shift()),this.regExpMap.set(t,r),this.regExpQueue.push(t),r}}const lO=[" ",",","?","!",";"],cO=new uO(20),fO=(n,t,e)=>{t=t||"",e=e||"";const r=lO.filter(u=>t.indexOf(u)<0&&e.indexOf(u)<0);if(r.length===0)return!0;const a=cO.getRegExp(`(${r.map(u=>u==="?"?"\\?":u).join("|")})`);let i=!a.test(n);if(!i){const u=n.indexOf(e);u>0&&!a.test(n.substring(0,u))&&(i=!0)}return i},am=(n,t,e=".")=>{if(!n)return;if(n[t])return Object.prototype.hasOwnProperty.call(n,t)?n[t]:void 0;const r=t.split(e);let a=n;for(let i=0;i<r.length;){if(!a||typeof a!="object")return;let u,l="";for(let c=i;c<r.length;++c)if(c!==i&&(l+=e),l+=r[c],u=a[l],u!==void 0){if(["string","number","boolean"].indexOf(typeof u)>-1&&c<r.length-1)continue;i+=c-i+1;break}a=u}return a},il=n=>n?.replace("_","-"),hO={type:"logger",log(n){this.output("log",n)},warn(n){this.output("warn",n)},error(n){this.output("error",n)},output(n,t){console?.[n]?.apply?.(console,t)}};class kf{constructor(t,e={}){this.init(t,e)}init(t,e={}){this.prefix=e.prefix||"i18next:",this.logger=t||hO,this.options=e,this.debug=e.debug}log(...t){return this.forward(t,"log","",!0)}warn(...t){return this.forward(t,"warn","",!0)}error(...t){return this.forward(t,"error","")}deprecate(...t){return this.forward(t,"warn","WARNING DEPRECATED: ",!0)}forward(t,e,r,a){return a&&!this.debug?null:(Pe(t[0])&&(t[0]=`${r}${this.prefix} ${t[0]}`),this.logger[e](t))}create(t){return new kf(this.logger,{prefix:`${this.prefix}:${t}:`,...this.options})}clone(t){return t=t||this.options,t.prefix=t.prefix||this.prefix,new kf(this.logger,t)}}var Xr=new kf;class dh{constructor(){this.observers={}}on(t,e){return t.split(" ").forEach(r=>{this.observers[r]||(this.observers[r]=new Map);const a=this.observers[r].get(e)||0;this.observers[r].set(e,a+1)}),this}off(t,e){if(this.observers[t]){if(!e){delete this.observers[t];return}this.observers[t].delete(e)}}emit(t,...e){this.observers[t]&&Array.from(this.observers[t].entries()).forEach(([a,i])=>{for(let u=0;u<i;u++)a(...e)}),this.observers["*"]&&Array.from(this.observers["*"].entries()).forEach(([a,i])=>{for(let u=0;u<i;u++)a.apply(a,[t,...e])})}}class Gx extends dh{constructor(t,e={ns:["translation"],defaultNS:"translation"}){super(),this.data=t||{},this.options=e,this.options.keySeparator===void 0&&(this.options.keySeparator="."),this.options.ignoreJSONStructure===void 0&&(this.options.ignoreJSONStructure=!0)}addNamespaces(t){this.options.ns.indexOf(t)<0&&this.options.ns.push(t)}removeNamespaces(t){const e=this.options.ns.indexOf(t);e>-1&&this.options.ns.splice(e,1)}getResource(t,e,r,a={}){const i=a.keySeparator!==void 0?a.keySeparator:this.options.keySeparator,u=a.ignoreJSONStructure!==void 0?a.ignoreJSONStructure:this.options.ignoreJSONStructure;let l;t.indexOf(".")>-1?l=t.split("."):(l=[t,e],r&&(Array.isArray(r)?l.push(...r):Pe(r)&&i?l.push(...r.split(i)):l.push(r)));const c=Df(this.data,l);return!c&&!e&&!r&&t.indexOf(".")>-1&&(t=l[0],e=l[1],r=l.slice(2).join(".")),c||!u||!Pe(r)?c:am(this.data?.[t]?.[e],r,i)}addResource(t,e,r,a,i={silent:!1}){const u=i.keySeparator!==void 0?i.keySeparator:this.options.keySeparator;let l=[t,e];r&&(l=l.concat(u?r.split(u):r)),t.indexOf(".")>-1&&(l=t.split("."),a=e,e=l[1]),this.addNamespaces(e),Wx(this.data,l,a),i.silent||this.emit("added",t,e,r,a)}addResources(t,e,r,a={silent:!1}){for(const i in r)(Pe(r[i])||Array.isArray(r[i]))&&this.addResource(t,e,i,r[i],{silent:!0});a.silent||this.emit("added",t,e,r)}addResourceBundle(t,e,r,a,i,u={silent:!1,skipCopy:!1}){let l=[t,e];t.indexOf(".")>-1&&(l=t.split("."),a=r,r=e,e=l[1]),this.addNamespaces(e);let c=Df(this.data,l)||{};u.skipCopy||(r=JSON.parse(JSON.stringify(r))),a?k_(c,r,i):c={...c,...r},Wx(this.data,l,c),u.silent||this.emit("added",t,e,r)}removeResourceBundle(t,e){this.hasResourceBundle(t,e)&&delete this.data[t][e],this.removeNamespaces(e),this.emit("removed",t,e)}hasResourceBundle(t,e){return this.getResource(t,e)!==void 0}getResourceBundle(t,e){return e||(e=this.options.defaultNS),this.getResource(t,e)}getDataByLanguage(t){return this.data[t]}hasLanguageSomeTranslations(t){const e=this.getDataByLanguage(t);return!!(e&&Object.keys(e)||[]).find(a=>e[a]&&Object.keys(e[a]).length>0)}toJSON(){return this.data}}var O_={processors:{},addPostProcessor(n){this.processors[n.name]=n},handle(n,t,e,r,a){return n.forEach(i=>{t=this.processors[i]?.process(t,e,r,a)??t}),t}};const qx={},Kx=n=>!Pe(n)&&typeof n!="boolean"&&typeof n!="number";class Of extends dh{constructor(t,e={}){super(),nO(["resourceStore","languageUtils","pluralResolver","interpolator","backendConnector","i18nFormat","utils"],t,this),this.options=e,this.options.keySeparator===void 0&&(this.options.keySeparator="."),this.logger=Xr.create("translator")}changeLanguage(t){t&&(this.language=t)}exists(t,e={interpolation:{}}){const r={...e};return t==null?!1:this.resolve(t,r)?.res!==void 0}extractFromKey(t,e){let r=e.nsSeparator!==void 0?e.nsSeparator:this.options.nsSeparator;r===void 0&&(r=":");const a=e.keySeparator!==void 0?e.keySeparator:this.options.keySeparator;let i=e.ns||this.options.defaultNS||[];const u=r&&t.indexOf(r)>-1,l=!this.options.userDefinedKeySeparator&&!e.keySeparator&&!this.options.userDefinedNsSeparator&&!e.nsSeparator&&!fO(t,r,a);if(u&&!l){const c=t.match(this.interpolator.nestingRegexp);if(c&&c.length>0)return{key:t,namespaces:Pe(i)?[i]:i};const f=t.split(r);(r!==a||r===a&&this.options.ns.indexOf(f[0])>-1)&&(i=f.shift()),t=f.join(a)}return{key:t,namespaces:Pe(i)?[i]:i}}translate(t,e,r){let a=typeof e=="object"?{...e}:e;if(typeof a!="object"&&this.options.overloadTranslationOptionHandler&&(a=this.options.overloadTranslationOptionHandler(arguments)),typeof options=="object"&&(a={...a}),a||(a={}),t==null)return"";Array.isArray(t)||(t=[String(t)]);const i=a.returnDetails!==void 0?a.returnDetails:this.options.returnDetails,u=a.keySeparator!==void 0?a.keySeparator:this.options.keySeparator,{key:l,namespaces:c}=this.extractFromKey(t[t.length-1],a),f=c[c.length-1];let d=a.nsSeparator!==void 0?a.nsSeparator:this.options.nsSeparator;d===void 0&&(d=":");const v=a.lng||this.language,m=a.appendNamespaceToCIMode||this.options.appendNamespaceToCIMode;if(v?.toLowerCase()==="cimode")return m?i?{res:`${f}${d}${l}`,usedKey:l,exactUsedKey:l,usedLng:v,usedNS:f,usedParams:this.getUsedParamsDetails(a)}:`${f}${d}${l}`:i?{res:l,usedKey:l,exactUsedKey:l,usedLng:v,usedNS:f,usedParams:this.getUsedParamsDetails(a)}:l;const g=this.resolve(t,a);let b=g?.res;const w=g?.usedKey||l,S=g?.exactUsedKey||l,_=["[object Number]","[object Function]","[object RegExp]"],E=a.joinArrays!==void 0?a.joinArrays:this.options.joinArrays,R=!this.i18nFormat||this.i18nFormat.handleAsObject,C=a.count!==void 0&&!Pe(a.count),A=Of.hasDefaultValue(a),D=C?this.pluralResolver.getSuffix(v,a.count,a):"",k=a.ordinal&&C?this.pluralResolver.getSuffix(v,a.count,{ordinal:!1}):"",I=C&&!a.ordinal&&a.count===0,N=I&&a[`defaultValue${this.options.pluralSeparator}zero`]||a[`defaultValue${D}`]||a[`defaultValue${k}`]||a.defaultValue;let B=b;R&&!b&&A&&(B=N);const V=Kx(B),U=Object.prototype.toString.apply(B);if(R&&B&&V&&_.indexOf(U)<0&&!(Pe(E)&&Array.isArray(B))){if(!a.returnObjects&&!this.options.returnObjects){this.options.returnedObjectHandler||this.logger.warn("accessing an object - but returnObjects options is not enabled!");const J=this.options.returnedObjectHandler?this.options.returnedObjectHandler(w,B,{...a,ns:c}):`key '${l} (${this.language})' returned an object instead of string.`;return i?(g.res=J,g.usedParams=this.getUsedParamsDetails(a),g):J}if(u){const J=Array.isArray(B),ee=J?[]:{},te=J?S:w;for(const P in B)if(Object.prototype.hasOwnProperty.call(B,P)){const j=`${te}${u}${P}`;A&&!b?ee[P]=this.translate(j,{...a,defaultValue:Kx(N)?N[P]:void 0,joinArrays:!1,ns:c}):ee[P]=this.translate(j,{...a,joinArrays:!1,ns:c}),ee[P]===j&&(ee[P]=B[P])}b=ee}}else if(R&&Pe(E)&&Array.isArray(b))b=b.join(E),b&&(b=this.extendTranslation(b,t,a,r));else{let J=!1,ee=!1;!this.isValidLookup(b)&&A&&(J=!0,b=N),this.isValidLookup(b)||(ee=!0,b=l);const P=(a.missingKeyNoValueFallbackToKey||this.options.missingKeyNoValueFallbackToKey)&&ee?void 0:b,j=A&&N!==b&&this.options.updateMissing;if(ee||J||j){if(this.logger.log(j?"updateKey":"missingKey",v,f,l,j?N:b),u){const G=this.resolve(l,{...a,keySeparator:!1});G&&G.res&&this.logger.warn("Seems the loaded translations were in flat JSON format instead of nested. Either set keySeparator: false on init or make sure your translations are published in nested format.")}let K=[];const ne=this.languageUtils.getFallbackCodes(this.options.fallbackLng,a.lng||this.language);if(this.options.saveMissingTo==="fallback"&&ne&&ne[0])for(let G=0;G<ne.length;G++)K.push(ne[G]);else this.options.saveMissingTo==="all"?K=this.languageUtils.toResolveHierarchy(a.lng||this.language):K.push(a.lng||this.language);const M=(G,ie,oe)=>{const de=A&&oe!==b?oe:P;this.options.missingKeyHandler?this.options.missingKeyHandler(G,f,ie,de,j,a):this.backendConnector?.saveMissing&&this.backendConnector.saveMissing(G,f,ie,de,j,a),this.emit("missingKey",G,f,ie,b)};this.options.saveMissing&&(this.options.saveMissingPlurals&&C?K.forEach(G=>{const ie=this.pluralResolver.getSuffixes(G,a);I&&a[`defaultValue${this.options.pluralSeparator}zero`]&&ie.indexOf(`${this.options.pluralSeparator}zero`)<0&&ie.push(`${this.options.pluralSeparator}zero`),ie.forEach(oe=>{M([G],l+oe,a[`defaultValue${oe}`]||N)})}):M(K,l,N))}b=this.extendTranslation(b,t,a,g,r),ee&&b===l&&this.options.appendNamespaceToMissingKey&&(b=`${f}${d}${l}`),(ee||J)&&this.options.parseMissingKeyHandler&&(b=this.options.parseMissingKeyHandler(this.options.appendNamespaceToMissingKey?`${f}${d}${l}`:l,J?b:void 0,a))}return i?(g.res=b,g.usedParams=this.getUsedParamsDetails(a),g):b}extendTranslation(t,e,r,a,i){if(this.i18nFormat?.parse)t=this.i18nFormat.parse(t,{...this.options.interpolation.defaultVariables,...r},r.lng||this.language||a.usedLng,a.usedNS,a.usedKey,{resolved:a});else if(!r.skipInterpolation){r.interpolation&&this.interpolator.init({...r,interpolation:{...this.options.interpolation,...r.interpolation}});const c=Pe(t)&&(r?.interpolation?.skipOnVariables!==void 0?r.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables);let f;if(c){const v=t.match(this.interpolator.nestingRegexp);f=v&&v.length}let d=r.replace&&!Pe(r.replace)?r.replace:r;if(this.options.interpolation.defaultVariables&&(d={...this.options.interpolation.defaultVariables,...d}),t=this.interpolator.interpolate(t,d,r.lng||this.language||a.usedLng,r),c){const v=t.match(this.interpolator.nestingRegexp),m=v&&v.length;f<m&&(r.nest=!1)}!r.lng&&a&&a.res&&(r.lng=this.language||a.usedLng),r.nest!==!1&&(t=this.interpolator.nest(t,(...v)=>i?.[0]===v[0]&&!r.context?(this.logger.warn(`It seems you are nesting recursively key: ${v[0]} in key: ${e[0]}`),null):this.translate(...v,e),r)),r.interpolation&&this.interpolator.reset()}const u=r.postProcess||this.options.postProcess,l=Pe(u)?[u]:u;return t!=null&&l?.length&&r.applyPostProcessor!==!1&&(t=O_.handle(l,t,e,this.options&&this.options.postProcessPassResolved?{i18nResolved:{...a,usedParams:this.getUsedParamsDetails(r)},...r}:r,this)),t}resolve(t,e={}){let r,a,i,u,l;return Pe(t)&&(t=[t]),t.forEach(c=>{if(this.isValidLookup(r))return;const f=this.extractFromKey(c,e),d=f.key;a=d;let v=f.namespaces;this.options.fallbackNS&&(v=v.concat(this.options.fallbackNS));const m=e.count!==void 0&&!Pe(e.count),g=m&&!e.ordinal&&e.count===0,b=e.context!==void 0&&(Pe(e.context)||typeof e.context=="number")&&e.context!=="",w=e.lngs?e.lngs:this.languageUtils.toResolveHierarchy(e.lng||this.language,e.fallbackLng);v.forEach(S=>{this.isValidLookup(r)||(l=S,!qx[`${w[0]}-${S}`]&&this.utils?.hasLoadedNamespace&&!this.utils?.hasLoadedNamespace(l)&&(qx[`${w[0]}-${S}`]=!0,this.logger.warn(`key "${a}" for languages "${w.join(", ")}" won't get resolved as namespace "${l}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!")),w.forEach(_=>{if(this.isValidLookup(r))return;u=_;const E=[d];if(this.i18nFormat?.addLookupKeys)this.i18nFormat.addLookupKeys(E,d,_,S,e);else{let C;m&&(C=this.pluralResolver.getSuffix(_,e.count,e));const A=`${this.options.pluralSeparator}zero`,D=`${this.options.pluralSeparator}ordinal${this.options.pluralSeparator}`;if(m&&(E.push(d+C),e.ordinal&&C.indexOf(D)===0&&E.push(d+C.replace(D,this.options.pluralSeparator)),g&&E.push(d+A)),b){const k=`${d}${this.options.contextSeparator}${e.context}`;E.push(k),m&&(E.push(k+C),e.ordinal&&C.indexOf(D)===0&&E.push(k+C.replace(D,this.options.pluralSeparator)),g&&E.push(k+A))}}let R;for(;R=E.pop();)this.isValidLookup(r)||(i=R,r=this.getResource(_,S,R,e))}))})}),{res:r,usedKey:a,exactUsedKey:i,usedLng:u,usedNS:l}}isValidLookup(t){return t!==void 0&&!(!this.options.returnNull&&t===null)&&!(!this.options.returnEmptyString&&t==="")}getResource(t,e,r,a={}){return this.i18nFormat?.getResource?this.i18nFormat.getResource(t,e,r,a):this.resourceStore.getResource(t,e,r,a)}getUsedParamsDetails(t={}){const e=["defaultValue","ordinal","context","replace","lng","lngs","fallbackLng","ns","keySeparator","nsSeparator","returnObjects","returnDetails","joinArrays","postProcess","interpolation"],r=t.replace&&!Pe(t.replace);let a=r?t.replace:t;if(r&&typeof t.count<"u"&&(a.count=t.count),this.options.interpolation.defaultVariables&&(a={...this.options.interpolation.defaultVariables,...a}),!r){a={...a};for(const i of e)delete a[i]}return a}static hasDefaultValue(t){const e="defaultValue";for(const r in t)if(Object.prototype.hasOwnProperty.call(t,r)&&e===r.substring(0,e.length)&&t[r]!==void 0)return!0;return!1}}class Xx{constructor(t){this.options=t,this.supportedLngs=this.options.supportedLngs||!1,this.logger=Xr.create("languageUtils")}getScriptPartFromCode(t){if(t=il(t),!t||t.indexOf("-")<0)return null;const e=t.split("-");return e.length===2||(e.pop(),e[e.length-1].toLowerCase()==="x")?null:this.formatLanguageCode(e.join("-"))}getLanguagePartFromCode(t){if(t=il(t),!t||t.indexOf("-")<0)return t;const e=t.split("-");return this.formatLanguageCode(e[0])}formatLanguageCode(t){if(Pe(t)&&t.indexOf("-")>-1){let e;try{e=Intl.getCanonicalLocales(t)[0]}catch{}return e&&this.options.lowerCaseLng&&(e=e.toLowerCase()),e||(this.options.lowerCaseLng?t.toLowerCase():t)}return this.options.cleanCode||this.options.lowerCaseLng?t.toLowerCase():t}isSupportedCode(t){return(this.options.load==="languageOnly"||this.options.nonExplicitSupportedLngs)&&(t=this.getLanguagePartFromCode(t)),!this.supportedLngs||!this.supportedLngs.length||this.supportedLngs.indexOf(t)>-1}getBestMatchFromCodes(t){if(!t)return null;let e;return t.forEach(r=>{if(e)return;const a=this.formatLanguageCode(r);(!this.options.supportedLngs||this.isSupportedCode(a))&&(e=a)}),!e&&this.options.supportedLngs&&t.forEach(r=>{if(e)return;const a=this.getScriptPartFromCode(r);if(this.isSupportedCode(a))return e=a;const i=this.getLanguagePartFromCode(r);if(this.isSupportedCode(i))return e=i;e=this.options.supportedLngs.find(u=>{if(u===i)return u;if(!(u.indexOf("-")<0&&i.indexOf("-")<0)&&(u.indexOf("-")>0&&i.indexOf("-")<0&&u.substring(0,u.indexOf("-"))===i||u.indexOf(i)===0&&i.length>1))return u})}),e||(e=this.getFallbackCodes(this.options.fallbackLng)[0]),e}getFallbackCodes(t,e){if(!t)return[];if(typeof t=="function"&&(t=t(e)),Pe(t)&&(t=[t]),Array.isArray(t))return t;if(!e)return t.default||[];let r=t[e];return r||(r=t[this.getScriptPartFromCode(e)]),r||(r=t[this.formatLanguageCode(e)]),r||(r=t[this.getLanguagePartFromCode(e)]),r||(r=t.default),r||[]}toResolveHierarchy(t,e){const r=this.getFallbackCodes((e===!1?[]:e)||this.options.fallbackLng||[],t),a=[],i=u=>{u&&(this.isSupportedCode(u)?a.push(u):this.logger.warn(`rejecting language code not found in supportedLngs: ${u}`))};return Pe(t)&&(t.indexOf("-")>-1||t.indexOf("_")>-1)?(this.options.load!=="languageOnly"&&i(this.formatLanguageCode(t)),this.options.load!=="languageOnly"&&this.options.load!=="currentOnly"&&i(this.getScriptPartFromCode(t)),this.options.load!=="currentOnly"&&i(this.getLanguagePartFromCode(t))):Pe(t)&&i(this.formatLanguageCode(t)),r.forEach(u=>{a.indexOf(u)<0&&i(this.formatLanguageCode(u))}),a}}const $x={zero:0,one:1,two:2,few:3,many:4,other:5},Yx={select:n=>n===1?"one":"other",resolvedOptions:()=>({pluralCategories:["one","other"]})};class dO{constructor(t,e={}){this.languageUtils=t,this.options=e,this.logger=Xr.create("pluralResolver"),this.pluralRulesCache={}}addRule(t,e){this.rules[t]=e}clearCache(){this.pluralRulesCache={}}getRule(t,e={}){const r=il(t==="dev"?"en":t),a=e.ordinal?"ordinal":"cardinal",i=JSON.stringify({cleanedCode:r,type:a});if(i in this.pluralRulesCache)return this.pluralRulesCache[i];let u;try{u=new Intl.PluralRules(r,{type:a})}catch{if(!Intl)return this.logger.error("No Intl support, please use an Intl polyfill!"),Yx;if(!t.match(/-|_/))return Yx;const c=this.languageUtils.getLanguagePartFromCode(t);u=this.getRule(c,e)}return this.pluralRulesCache[i]=u,u}needsPlural(t,e={}){let r=this.getRule(t,e);return r||(r=this.getRule("dev",e)),r?.resolvedOptions().pluralCategories.length>1}getPluralFormsOfKey(t,e,r={}){return this.getSuffixes(t,r).map(a=>`${e}${a}`)}getSuffixes(t,e={}){let r=this.getRule(t,e);return r||(r=this.getRule("dev",e)),r?r.resolvedOptions().pluralCategories.sort((a,i)=>$x[a]-$x[i]).map(a=>`${this.options.prepend}${e.ordinal?`ordinal${this.options.prepend}`:""}${a}`):[]}getSuffix(t,e,r={}){const a=this.getRule(t,r);return a?`${this.options.prepend}${r.ordinal?`ordinal${this.options.prepend}`:""}${a.select(e)}`:(this.logger.warn(`no plural rule found for: ${t}`),this.getSuffix("dev",e,r))}}const Qx=(n,t,e,r=".",a=!0)=>{let i=iO(n,t,e);return!i&&a&&Pe(e)&&(i=am(n,e,r),i===void 0&&(i=am(t,e,r))),i},lv=n=>n.replace(/\$/g,"$$$$");class pO{constructor(t={}){this.logger=Xr.create("interpolator"),this.options=t,this.format=t?.interpolation?.format||(e=>e),this.init(t)}init(t={}){t.interpolation||(t.interpolation={escapeValue:!0});const{escape:e,escapeValue:r,useRawValueToEscape:a,prefix:i,prefixEscaped:u,suffix:l,suffixEscaped:c,formatSeparator:f,unescapeSuffix:d,unescapePrefix:v,nestingPrefix:m,nestingPrefixEscaped:g,nestingSuffix:b,nestingSuffixEscaped:w,nestingOptionsSeparator:S,maxReplaces:_,alwaysFormat:E}=t.interpolation;this.escape=e!==void 0?e:sO,this.escapeValue=r!==void 0?r:!0,this.useRawValueToEscape=a!==void 0?a:!1,this.prefix=i?as(i):u||"{{",this.suffix=l?as(l):c||"}}",this.formatSeparator=f||",",this.unescapePrefix=d?"":v||"-",this.unescapeSuffix=this.unescapePrefix?"":d||"",this.nestingPrefix=m?as(m):g||as("$t("),this.nestingSuffix=b?as(b):w||as(")"),this.nestingOptionsSeparator=S||",",this.maxReplaces=_||1e3,this.alwaysFormat=E!==void 0?E:!1,this.resetRegExp()}reset(){this.options&&this.init(this.options)}resetRegExp(){const t=(e,r)=>e?.source===r?(e.lastIndex=0,e):new RegExp(r,"g");this.regexp=t(this.regexp,`${this.prefix}(.+?)${this.suffix}`),this.regexpUnescape=t(this.regexpUnescape,`${this.prefix}${this.unescapePrefix}(.+?)${this.unescapeSuffix}${this.suffix}`),this.nestingRegexp=t(this.nestingRegexp,`${this.nestingPrefix}(.+?)${this.nestingSuffix}`)}interpolate(t,e,r,a){let i,u,l;const c=this.options&&this.options.interpolation&&this.options.interpolation.defaultVariables||{},f=g=>{if(g.indexOf(this.formatSeparator)<0){const _=Qx(e,c,g,this.options.keySeparator,this.options.ignoreJSONStructure);return this.alwaysFormat?this.format(_,void 0,r,{...a,...e,interpolationkey:g}):_}const b=g.split(this.formatSeparator),w=b.shift().trim(),S=b.join(this.formatSeparator).trim();return this.format(Qx(e,c,w,this.options.keySeparator,this.options.ignoreJSONStructure),S,r,{...a,...e,interpolationkey:w})};this.resetRegExp();const d=a?.missingInterpolationHandler||this.options.missingInterpolationHandler,v=a?.interpolation?.skipOnVariables!==void 0?a.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables;return[{regex:this.regexpUnescape,safeValue:g=>lv(g)},{regex:this.regexp,safeValue:g=>this.escapeValue?lv(this.escape(g)):lv(g)}].forEach(g=>{for(l=0;i=g.regex.exec(t);){const b=i[1].trim();if(u=f(b),u===void 0)if(typeof d=="function"){const S=d(t,i,a);u=Pe(S)?S:""}else if(a&&Object.prototype.hasOwnProperty.call(a,b))u="";else if(v){u=i[0];continue}else this.logger.warn(`missed to pass in variable ${b} for interpolating ${t}`),u="";else!Pe(u)&&!this.useRawValueToEscape&&(u=Vx(u));const w=g.safeValue(u);if(t=t.replace(i[0],w),v?(g.regex.lastIndex+=u.length,g.regex.lastIndex-=i[0].length):g.regex.lastIndex=0,l++,l>=this.maxReplaces)break}}),t}nest(t,e,r={}){let a,i,u;const l=(c,f)=>{const d=this.nestingOptionsSeparator;if(c.indexOf(d)<0)return c;const v=c.split(new RegExp(`${d}[ ]*{`));let m=`{${v[1]}`;c=v[0],m=this.interpolate(m,u);const g=m.match(/'/g),b=m.match(/"/g);((g?.length??0)%2===0&&!b||b.length%2!==0)&&(m=m.replace(/'/g,'"'));try{u=JSON.parse(m),f&&(u={...f,...u})}catch(w){return this.logger.warn(`failed parsing options string in nesting for key ${c}`,w),`${c}${d}${m}`}return u.defaultValue&&u.defaultValue.indexOf(this.prefix)>-1&&delete u.defaultValue,c};for(;a=this.nestingRegexp.exec(t);){let c=[];u={...r},u=u.replace&&!Pe(u.replace)?u.replace:u,u.applyPostProcessor=!1,delete u.defaultValue;const f=/{.*}/.test(a[1])?a[1].lastIndexOf("}")+1:a[1].indexOf(this.formatSeparator);if(f!==-1&&(c=a[1].slice(f).split(this.formatSeparator).map(d=>d.trim()).filter(Boolean),a[1]=a[1].slice(0,f)),i=e(l.call(this,a[1].trim(),u),u),i&&a[0]===t&&!Pe(i))return i;Pe(i)||(i=Vx(i)),i||(this.logger.warn(`missed to resolve ${a[1]} for nesting ${t}`),i=""),c.length&&(i=c.reduce((d,v)=>this.format(d,v,r.lng,{...r,interpolationkey:a[1].trim()}),i.trim())),t=t.replace(a[0],i),this.regexp.lastIndex=0}return t}}const vO=n=>{let t=n.toLowerCase().trim();const e={};if(n.indexOf("(")>-1){const r=n.split("(");t=r[0].toLowerCase().trim();const a=r[1].substring(0,r[1].length-1);t==="currency"&&a.indexOf(":")<0?e.currency||(e.currency=a.trim()):t==="relativetime"&&a.indexOf(":")<0?e.range||(e.range=a.trim()):a.split(";").forEach(u=>{if(u){const[l,...c]=u.split(":"),f=c.join(":").trim().replace(/^'+|'+$/g,""),d=l.trim();e[d]||(e[d]=f),f==="false"&&(e[d]=!1),f==="true"&&(e[d]=!0),isNaN(f)||(e[d]=parseInt(f,10))}})}return{formatName:t,formatOptions:e}},Zx=n=>{const t={};return(e,r,a)=>{let i=a;a&&a.interpolationkey&&a.formatParams&&a.formatParams[a.interpolationkey]&&a[a.interpolationkey]&&(i={...i,[a.interpolationkey]:void 0});const u=r+JSON.stringify(i);let l=t[u];return l||(l=n(il(r),a),t[u]=l),l(e)}},mO=n=>(t,e,r)=>n(il(e),r)(t);class gO{constructor(t={}){this.logger=Xr.create("formatter"),this.options=t,this.init(t)}init(t,e={interpolation:{}}){this.formatSeparator=e.interpolation.formatSeparator||",";const r=e.cacheInBuiltFormats?Zx:mO;this.formats={number:r((a,i)=>{const u=new Intl.NumberFormat(a,{...i});return l=>u.format(l)}),currency:r((a,i)=>{const u=new Intl.NumberFormat(a,{...i,style:"currency"});return l=>u.format(l)}),datetime:r((a,i)=>{const u=new Intl.DateTimeFormat(a,{...i});return l=>u.format(l)}),relativetime:r((a,i)=>{const u=new Intl.RelativeTimeFormat(a,{...i});return l=>u.format(l,i.range||"day")}),list:r((a,i)=>{const u=new Intl.ListFormat(a,{...i});return l=>u.format(l)})}}add(t,e){this.formats[t.toLowerCase().trim()]=e}addCached(t,e){this.formats[t.toLowerCase().trim()]=Zx(e)}format(t,e,r,a={}){const i=e.split(this.formatSeparator);if(i.length>1&&i[0].indexOf("(")>1&&i[0].indexOf(")")<0&&i.find(l=>l.indexOf(")")>-1)){const l=i.findIndex(c=>c.indexOf(")")>-1);i[0]=[i[0],...i.splice(1,l)].join(this.formatSeparator)}return i.reduce((l,c)=>{const{formatName:f,formatOptions:d}=vO(c);if(this.formats[f]){let v=l;try{const m=a?.formatParams?.[a.interpolationkey]||{},g=m.locale||m.lng||a.locale||a.lng||r;v=this.formats[f](l,g,{...d,...a,...m})}catch(m){this.logger.warn(m)}return v}else this.logger.warn(`there was no format function for ${f}`);return l},t)}}const yO=(n,t)=>{n.pending[t]!==void 0&&(delete n.pending[t],n.pendingCount--)};class bO extends dh{constructor(t,e,r,a={}){super(),this.backend=t,this.store=e,this.services=r,this.languageUtils=r.languageUtils,this.options=a,this.logger=Xr.create("backendConnector"),this.waitingReads=[],this.maxParallelReads=a.maxParallelReads||10,this.readingCalls=0,this.maxRetries=a.maxRetries>=0?a.maxRetries:5,this.retryTimeout=a.retryTimeout>=1?a.retryTimeout:350,this.state={},this.queue=[],this.backend?.init?.(r,a.backend,a)}queueLoad(t,e,r,a){const i={},u={},l={},c={};return t.forEach(f=>{let d=!0;e.forEach(v=>{const m=`${f}|${v}`;!r.reload&&this.store.hasResourceBundle(f,v)?this.state[m]=2:this.state[m]<0||(this.state[m]===1?u[m]===void 0&&(u[m]=!0):(this.state[m]=1,d=!1,u[m]===void 0&&(u[m]=!0),i[m]===void 0&&(i[m]=!0),c[v]===void 0&&(c[v]=!0)))}),d||(l[f]=!0)}),(Object.keys(i).length||Object.keys(u).length)&&this.queue.push({pending:u,pendingCount:Object.keys(u).length,loaded:{},errors:[],callback:a}),{toLoad:Object.keys(i),pending:Object.keys(u),toLoadLanguages:Object.keys(l),toLoadNamespaces:Object.keys(c)}}loaded(t,e,r){const a=t.split("|"),i=a[0],u=a[1];e&&this.emit("failedLoading",i,u,e),!e&&r&&this.store.addResourceBundle(i,u,r,void 0,void 0,{skipCopy:!0}),this.state[t]=e?-1:2,e&&r&&(this.state[t]=0);const l={};this.queue.forEach(c=>{aO(c.loaded,[i],u),yO(c,t),e&&c.errors.push(e),c.pendingCount===0&&!c.done&&(Object.keys(c.loaded).forEach(f=>{l[f]||(l[f]={});const d=c.loaded[f];d.length&&d.forEach(v=>{l[f][v]===void 0&&(l[f][v]=!0)})}),c.done=!0,c.errors.length?c.callback(c.errors):c.callback())}),this.emit("loaded",l),this.queue=this.queue.filter(c=>!c.done)}read(t,e,r,a=0,i=this.retryTimeout,u){if(!t.length)return u(null,{});if(this.readingCalls>=this.maxParallelReads){this.waitingReads.push({lng:t,ns:e,fcName:r,tried:a,wait:i,callback:u});return}this.readingCalls++;const l=(f,d)=>{if(this.readingCalls--,this.waitingReads.length>0){const v=this.waitingReads.shift();this.read(v.lng,v.ns,v.fcName,v.tried,v.wait,v.callback)}if(f&&d&&a<this.maxRetries){setTimeout(()=>{this.read.call(this,t,e,r,a+1,i*2,u)},i);return}u(f,d)},c=this.backend[r].bind(this.backend);if(c.length===2){try{const f=c(t,e);f&&typeof f.then=="function"?f.then(d=>l(null,d)).catch(l):l(null,f)}catch(f){l(f)}return}return c(t,e,l)}prepareLoading(t,e,r={},a){if(!this.backend)return this.logger.warn("No backend was added via i18next.use. Will not load resources."),a&&a();Pe(t)&&(t=this.languageUtils.toResolveHierarchy(t)),Pe(e)&&(e=[e]);const i=this.queueLoad(t,e,r,a);if(!i.toLoad.length)return i.pending.length||a(),null;i.toLoad.forEach(u=>{this.loadOne(u)})}load(t,e,r){this.prepareLoading(t,e,{},r)}reload(t,e,r){this.prepareLoading(t,e,{reload:!0},r)}loadOne(t,e=""){const r=t.split("|"),a=r[0],i=r[1];this.read(a,i,"read",void 0,void 0,(u,l)=>{u&&this.logger.warn(`${e}loading namespace ${i} for language ${a} failed`,u),!u&&l&&this.logger.log(`${e}loaded namespace ${i} for language ${a}`,l),this.loaded(t,u,l)})}saveMissing(t,e,r,a,i,u={},l=()=>{}){if(this.services?.utils?.hasLoadedNamespace&&!this.services?.utils?.hasLoadedNamespace(e)){this.logger.warn(`did not save key "${r}" as the namespace "${e}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!");return}if(!(r==null||r==="")){if(this.backend?.create){const c={...u,isUpdate:i},f=this.backend.create.bind(this.backend);if(f.length<6)try{let d;f.length===5?d=f(t,e,r,a,c):d=f(t,e,r,a),d&&typeof d.then=="function"?d.then(v=>l(null,v)).catch(l):l(null,d)}catch(d){l(d)}else f(t,e,r,a,l,c)}!t||!t[0]||this.store.addResource(t[0],e,r,a)}}}const Jx=()=>({debug:!1,initAsync:!0,ns:["translation"],defaultNS:["translation"],fallbackLng:["dev"],fallbackNS:!1,supportedLngs:!1,nonExplicitSupportedLngs:!1,load:"all",preload:!1,simplifyPluralSuffix:!0,keySeparator:".",nsSeparator:":",pluralSeparator:"_",contextSeparator:"_",partialBundledLanguages:!1,saveMissing:!1,updateMissing:!1,saveMissingTo:"fallback",saveMissingPlurals:!0,missingKeyHandler:!1,missingInterpolationHandler:!1,postProcess:!1,postProcessPassResolved:!1,returnNull:!1,returnEmptyString:!0,returnObjects:!1,joinArrays:!1,returnedObjectHandler:!1,parseMissingKeyHandler:!1,appendNamespaceToMissingKey:!1,appendNamespaceToCIMode:!1,overloadTranslationOptionHandler:n=>{let t={};if(typeof n[1]=="object"&&(t=n[1]),Pe(n[1])&&(t.defaultValue=n[1]),Pe(n[2])&&(t.tDescription=n[2]),typeof n[2]=="object"||typeof n[3]=="object"){const e=n[3]||n[2];Object.keys(e).forEach(r=>{t[r]=e[r]})}return t},interpolation:{escapeValue:!0,format:n=>n,prefix:"{{",suffix:"}}",formatSeparator:",",unescapePrefix:"-",nestingPrefix:"$t(",nestingSuffix:")",nestingOptionsSeparator:",",maxReplaces:1e3,skipOnVariables:!0},cacheInBuiltFormats:!0}),ew=n=>(Pe(n.ns)&&(n.ns=[n.ns]),Pe(n.fallbackLng)&&(n.fallbackLng=[n.fallbackLng]),Pe(n.fallbackNS)&&(n.fallbackNS=[n.fallbackNS]),n.supportedLngs?.indexOf?.("cimode")<0&&(n.supportedLngs=n.supportedLngs.concat(["cimode"])),typeof n.initImmediate=="boolean"&&(n.initAsync=n.initImmediate),n),Yc=()=>{},xO=n=>{Object.getOwnPropertyNames(Object.getPrototypeOf(n)).forEach(e=>{typeof n[e]=="function"&&(n[e]=n[e].bind(n))})};class ol extends dh{constructor(t={},e){if(super(),this.options=ew(t),this.services={},this.logger=Xr,this.modules={external:[]},xO(this),e&&!this.isInitialized&&!t.isClone){if(!this.options.initAsync)return this.init(t,e),this;setTimeout(()=>{this.init(t,e)},0)}}init(t={},e){this.isInitializing=!0,typeof t=="function"&&(e=t,t={}),t.defaultNS==null&&t.ns&&(Pe(t.ns)?t.defaultNS=t.ns:t.ns.indexOf("translation")<0&&(t.defaultNS=t.ns[0]));const r=Jx();this.options={...r,...this.options,...ew(t)},this.options.interpolation={...r.interpolation,...this.options.interpolation},t.keySeparator!==void 0&&(this.options.userDefinedKeySeparator=t.keySeparator),t.nsSeparator!==void 0&&(this.options.userDefinedNsSeparator=t.nsSeparator);const a=f=>f?typeof f=="function"?new f:f:null;if(!this.options.isClone){this.modules.logger?Xr.init(a(this.modules.logger),this.options):Xr.init(null,this.options);let f;this.modules.formatter?f=this.modules.formatter:f=gO;const d=new Xx(this.options);this.store=new Gx(this.options.resources,this.options);const v=this.services;v.logger=Xr,v.resourceStore=this.store,v.languageUtils=d,v.pluralResolver=new dO(d,{prepend:this.options.pluralSeparator,simplifyPluralSuffix:this.options.simplifyPluralSuffix}),f&&(!this.options.interpolation.format||this.options.interpolation.format===r.interpolation.format)&&(v.formatter=a(f),v.formatter.init(v,this.options),this.options.interpolation.format=v.formatter.format.bind(v.formatter)),v.interpolator=new pO(this.options),v.utils={hasLoadedNamespace:this.hasLoadedNamespace.bind(this)},v.backendConnector=new bO(a(this.modules.backend),v.resourceStore,v,this.options),v.backendConnector.on("*",(m,...g)=>{this.emit(m,...g)}),this.modules.languageDetector&&(v.languageDetector=a(this.modules.languageDetector),v.languageDetector.init&&v.languageDetector.init(v,this.options.detection,this.options)),this.modules.i18nFormat&&(v.i18nFormat=a(this.modules.i18nFormat),v.i18nFormat.init&&v.i18nFormat.init(this)),this.translator=new Of(this.services,this.options),this.translator.on("*",(m,...g)=>{this.emit(m,...g)}),this.modules.external.forEach(m=>{m.init&&m.init(this)})}if(this.format=this.options.interpolation.format,e||(e=Yc),this.options.fallbackLng&&!this.services.languageDetector&&!this.options.lng){const f=this.services.languageUtils.getFallbackCodes(this.options.fallbackLng);f.length>0&&f[0]!=="dev"&&(this.options.lng=f[0])}!this.services.languageDetector&&!this.options.lng&&this.logger.warn("init: no languageDetector is used and no lng is defined"),["getResource","hasResourceBundle","getResourceBundle","getDataByLanguage"].forEach(f=>{this[f]=(...d)=>this.store[f](...d)}),["addResource","addResources","addResourceBundle","removeResourceBundle"].forEach(f=>{this[f]=(...d)=>(this.store[f](...d),this)});const l=ju(),c=()=>{const f=(d,v)=>{this.isInitializing=!1,this.isInitialized&&!this.initializedStoreOnce&&this.logger.warn("init: i18next is already initialized. You should call init just once!"),this.isInitialized=!0,this.options.isClone||this.logger.log("initialized",this.options),this.emit("initialized",this.options),l.resolve(v),e(d,v)};if(this.languages&&!this.isInitialized)return f(null,this.t.bind(this));this.changeLanguage(this.options.lng,f)};return this.options.resources||!this.options.initAsync?c():setTimeout(c,0),l}loadResources(t,e=Yc){let r=e;const a=Pe(t)?t:this.language;if(typeof t=="function"&&(r=t),!this.options.resources||this.options.partialBundledLanguages){if(a?.toLowerCase()==="cimode"&&(!this.options.preload||this.options.preload.length===0))return r();const i=[],u=l=>{if(!l||l==="cimode")return;this.services.languageUtils.toResolveHierarchy(l).forEach(f=>{f!=="cimode"&&i.indexOf(f)<0&&i.push(f)})};a?u(a):this.services.languageUtils.getFallbackCodes(this.options.fallbackLng).forEach(c=>u(c)),this.options.preload?.forEach?.(l=>u(l)),this.services.backendConnector.load(i,this.options.ns,l=>{!l&&!this.resolvedLanguage&&this.language&&this.setResolvedLanguage(this.language),r(l)})}else r(null)}reloadResources(t,e,r){const a=ju();return typeof t=="function"&&(r=t,t=void 0),typeof e=="function"&&(r=e,e=void 0),t||(t=this.languages),e||(e=this.options.ns),r||(r=Yc),this.services.backendConnector.reload(t,e,i=>{a.resolve(),r(i)}),a}use(t){if(!t)throw new Error("You are passing an undefined module! Please check the object you are passing to i18next.use()");if(!t.type)throw new Error("You are passing a wrong module! Please check the object you are passing to i18next.use()");return t.type==="backend"&&(this.modules.backend=t),(t.type==="logger"||t.log&&t.warn&&t.error)&&(this.modules.logger=t),t.type==="languageDetector"&&(this.modules.languageDetector=t),t.type==="i18nFormat"&&(this.modules.i18nFormat=t),t.type==="postProcessor"&&O_.addPostProcessor(t),t.type==="formatter"&&(this.modules.formatter=t),t.type==="3rdParty"&&this.modules.external.push(t),this}setResolvedLanguage(t){if(!(!t||!this.languages)&&!(["cimode","dev"].indexOf(t)>-1)){for(let e=0;e<this.languages.length;e++){const r=this.languages[e];if(!(["cimode","dev"].indexOf(r)>-1)&&this.store.hasLanguageSomeTranslations(r)){this.resolvedLanguage=r;break}}!this.resolvedLanguage&&this.languages.indexOf(t)<0&&this.store.hasLanguageSomeTranslations(t)&&(this.resolvedLanguage=t,this.languages.unshift(t))}}changeLanguage(t,e){this.isLanguageChangingTo=t;const r=ju();this.emit("languageChanging",t);const a=l=>{this.language=l,this.languages=this.services.languageUtils.toResolveHierarchy(l),this.resolvedLanguage=void 0,this.setResolvedLanguage(l)},i=(l,c)=>{c?this.isLanguageChangingTo===t&&(a(c),this.translator.changeLanguage(c),this.isLanguageChangingTo=void 0,this.emit("languageChanged",c),this.logger.log("languageChanged",c)):this.isLanguageChangingTo=void 0,r.resolve((...f)=>this.t(...f)),e&&e(l,(...f)=>this.t(...f))},u=l=>{!t&&!l&&this.services.languageDetector&&(l=[]);const c=Pe(l)?l:l&&l[0],f=this.store.hasLanguageSomeTranslations(c)?c:this.services.languageUtils.getBestMatchFromCodes(Pe(l)?[l]:l);f&&(this.language||a(f),this.translator.language||this.translator.changeLanguage(f),this.services.languageDetector?.cacheUserLanguage?.(f)),this.loadResources(f,d=>{i(d,f)})};return!t&&this.services.languageDetector&&!this.services.languageDetector.async?u(this.services.languageDetector.detect()):!t&&this.services.languageDetector&&this.services.languageDetector.async?this.services.languageDetector.detect.length===0?this.services.languageDetector.detect().then(u):this.services.languageDetector.detect(u):u(t),r}getFixedT(t,e,r){const a=(i,u,...l)=>{let c;typeof u!="object"?c=this.options.overloadTranslationOptionHandler([i,u].concat(l)):c={...u},c.lng=c.lng||a.lng,c.lngs=c.lngs||a.lngs,c.ns=c.ns||a.ns,c.keyPrefix!==""&&(c.keyPrefix=c.keyPrefix||r||a.keyPrefix);const f=this.options.keySeparator||".";let d;return c.keyPrefix&&Array.isArray(i)?d=i.map(v=>`${c.keyPrefix}${f}${v}`):d=c.keyPrefix?`${c.keyPrefix}${f}${i}`:i,this.t(d,c)};return Pe(t)?a.lng=t:a.lngs=t,a.ns=e,a.keyPrefix=r,a}t(...t){return this.translator?.translate(...t)}exists(...t){return this.translator?.exists(...t)}setDefaultNamespace(t){this.options.defaultNS=t}hasLoadedNamespace(t,e={}){if(!this.isInitialized)return this.logger.warn("hasLoadedNamespace: i18next was not initialized",this.languages),!1;if(!this.languages||!this.languages.length)return this.logger.warn("hasLoadedNamespace: i18n.languages were undefined or empty",this.languages),!1;const r=e.lng||this.resolvedLanguage||this.languages[0],a=this.options?this.options.fallbackLng:!1,i=this.languages[this.languages.length-1];if(r.toLowerCase()==="cimode")return!0;const u=(l,c)=>{const f=this.services.backendConnector.state[`${l}|${c}`];return f===-1||f===0||f===2};if(e.precheck){const l=e.precheck(this,u);if(l!==void 0)return l}return!!(this.hasResourceBundle(r,t)||!this.services.backendConnector.backend||this.options.resources&&!this.options.partialBundledLanguages||u(r,t)&&(!a||u(i,t)))}loadNamespaces(t,e){const r=ju();return this.options.ns?(Pe(t)&&(t=[t]),t.forEach(a=>{this.options.ns.indexOf(a)<0&&this.options.ns.push(a)}),this.loadResources(a=>{r.resolve(),e&&e(a)}),r):(e&&e(),Promise.resolve())}loadLanguages(t,e){const r=ju();Pe(t)&&(t=[t]);const a=this.options.preload||[],i=t.filter(u=>a.indexOf(u)<0&&this.services.languageUtils.isSupportedCode(u));return i.length?(this.options.preload=a.concat(i),this.loadResources(u=>{r.resolve(),e&&e(u)}),r):(e&&e(),Promise.resolve())}dir(t){if(t||(t=this.resolvedLanguage||(this.languages?.length>0?this.languages[0]:this.language)),!t)return"rtl";if(Intl.Locale){const a=new Intl.Locale(t);if(a&&a.getTextInfo){const i=a.getTextInfo();if(i&&i.direction)return i.direction}}const e=["ar","shu","sqr","ssh","xaa","yhd","yud","aao","abh","abv","acm","acq","acw","acx","acy","adf","ads","aeb","aec","afb","ajp","apc","apd","arb","arq","ars","ary","arz","auz","avl","ayh","ayl","ayn","ayp","bbz","pga","he","iw","ps","pbt","pbu","pst","prp","prd","ug","ur","ydd","yds","yih","ji","yi","hbo","men","xmn","fa","jpr","peo","pes","prs","dv","sam","ckb"],r=this.services?.languageUtils||new Xx(Jx());return t.toLowerCase().indexOf("-latn")>1?"ltr":e.indexOf(r.getLanguagePartFromCode(t))>-1||t.toLowerCase().indexOf("-arab")>1?"rtl":"ltr"}static createInstance(t={},e){return new ol(t,e)}cloneInstance(t={},e=Yc){const r=t.forkResourceStore;r&&delete t.forkResourceStore;const a={...this.options,...t,isClone:!0},i=new ol(a);if((t.debug!==void 0||t.prefix!==void 0)&&(i.logger=i.logger.clone(t)),["store","services","language"].forEach(l=>{i[l]=this[l]}),i.services={...this.services},i.services.utils={hasLoadedNamespace:i.hasLoadedNamespace.bind(i)},r){const l=Object.keys(this.store.data).reduce((c,f)=>(c[f]={...this.store.data[f]},c[f]=Object.keys(c[f]).reduce((d,v)=>(d[v]={...c[f][v]},d),c[f]),c),{});i.store=new Gx(l,a),i.services.resourceStore=i.store}return i.translator=new Of(i.services,a),i.translator.on("*",(l,...c)=>{i.emit(l,...c)}),i.init(a,e),i.translator.options=a,i.translator.backendConnector.services.utils={hasLoadedNamespace:i.hasLoadedNamespace.bind(i)},i}toJSON(){return{options:this.options,store:this.store,language:this.language,languages:this.languages,resolvedLanguage:this.resolvedLanguage}}}const Dn=ol.createInstance();Dn.createInstance=ol.createInstance;Dn.createInstance;Dn.dir;Dn.init;Dn.loadResources;Dn.reloadResources;Dn.use;Dn.changeLanguage;Dn.getFixedT;Dn.t;Dn.exists;Dn.setDefaultNamespace;Dn.hasLoadedNamespace;Dn.loadNamespaces;Dn.loadLanguages;const tw=n=>{let t;const e=new Set,r=(f,d)=>{const v=typeof f=="function"?f(t):f;if(!Object.is(v,t)){const m=t;t=d??(typeof v!="object"||v===null)?v:Object.assign({},t,v),e.forEach(g=>g(t,m))}},a=()=>t,l={setState:r,getState:a,getInitialState:()=>c,subscribe:f=>(e.add(f),()=>e.delete(f))},c=t=n(r,a,l);return l},wO=n=>n?tw(n):tw,_O=n=>n;function SO(n,t=_O){const e=Pn.useSyncExternalStore(n.subscribe,()=>t(n.getState()),()=>t(n.getInitialState()));return Pn.useDebugValue(e),e}const EO=n=>{const t=wO(n),e=r=>SO(t,r);return Object.assign(e,t),e},HP=n=>EO;function CO(n,t){let e;try{e=n()}catch{return}return{getItem:a=>{var i;const u=c=>c===null?null:JSON.parse(c,void 0),l=(i=e.getItem(a))!=null?i:null;return l instanceof Promise?l.then(u):u(l)},setItem:(a,i)=>e.setItem(a,JSON.stringify(i,void 0)),removeItem:a=>e.removeItem(a)}}const im=n=>t=>{try{const e=n(t);return e instanceof Promise?e:{then(r){return im(r)(e)},catch(r){return this}}}catch(e){return{then(r){return this},catch(r){return im(r)(e)}}}},RO=(n,t)=>(e,r,a)=>{let i={storage:CO(()=>localStorage),partialize:w=>w,version:0,merge:(w,S)=>({...S,...w}),...t},u=!1;const l=new Set,c=new Set;let f=i.storage;if(!f)return n((...w)=>{console.warn(`[zustand persist middleware] Unable to update item '${i.name}', the given storage is currently unavailable.`),e(...w)},r,a);const d=()=>{const w=i.partialize({...r()});return f.setItem(i.name,{state:w,version:i.version})},v=a.setState;a.setState=(w,S)=>{v(w,S),d()};const m=n((...w)=>{e(...w),d()},r,a);a.getInitialState=()=>m;let g;const b=()=>{var w,S;if(!f)return;u=!1,l.forEach(E=>{var R;return E((R=r())!=null?R:m)});const _=((S=i.onRehydrateStorage)==null?void 0:S.call(i,(w=r())!=null?w:m))||void 0;return im(f.getItem.bind(f))(i.name).then(E=>{if(E)if(typeof E.version=="number"&&E.version!==i.version){if(i.migrate){const R=i.migrate(E.state,E.version);return R instanceof Promise?R.then(C=>[!0,C]):[!0,R]}console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,E.state];return[!1,void 0]}).then(E=>{var R;const[C,A]=E;if(g=i.merge(A,(R=r())!=null?R:m),e(g,!0),C)return d()}).then(()=>{_?.(g,void 0),g=r(),u=!0,c.forEach(E=>E(g))}).catch(E=>{_?.(void 0,E)})};return a.persist={setOptions:w=>{i={...i,...w},w.storage&&(f=w.storage)},clearStorage:()=>{f?.removeItem(i.name)},getOptions:()=>i,rehydrate:()=>b(),hasHydrated:()=>u,onHydrate:w=>(l.add(w),()=>{l.delete(w)}),onFinishHydration:w=>(c.add(w),()=>{c.delete(w)})},i.skipHydration||b(),g||m},jP=RO;var ot;(function(n){n.assertEqual=a=>{};function t(a){}n.assertIs=t;function e(a){throw new Error}n.assertNever=e,n.arrayToEnum=a=>{const i={};for(const u of a)i[u]=u;return i},n.getValidEnumValues=a=>{const i=n.objectKeys(a).filter(l=>typeof a[a[l]]!="number"),u={};for(const l of i)u[l]=a[l];return n.objectValues(u)},n.objectValues=a=>n.objectKeys(a).map(function(i){return a[i]}),n.objectKeys=typeof Object.keys=="function"?a=>Object.keys(a):a=>{const i=[];for(const u in a)Object.prototype.hasOwnProperty.call(a,u)&&i.push(u);return i},n.find=(a,i)=>{for(const u of a)if(i(u))return u},n.isInteger=typeof Number.isInteger=="function"?a=>Number.isInteger(a):a=>typeof a=="number"&&Number.isFinite(a)&&Math.floor(a)===a;function r(a,i=" | "){return a.map(u=>typeof u=="string"?`'${u}'`:u).join(i)}n.joinValues=r,n.jsonStringifyReplacer=(a,i)=>typeof i=="bigint"?i.toString():i})(ot||(ot={}));var nw;(function(n){n.mergeShapes=(t,e)=>({...t,...e})})(nw||(nw={}));const Ee=ot.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),di=n=>{switch(typeof n){case"undefined":return Ee.undefined;case"string":return Ee.string;case"number":return Number.isNaN(n)?Ee.nan:Ee.number;case"boolean":return Ee.boolean;case"function":return Ee.function;case"bigint":return Ee.bigint;case"symbol":return Ee.symbol;case"object":return Array.isArray(n)?Ee.array:n===null?Ee.null:n.then&&typeof n.then=="function"&&n.catch&&typeof n.catch=="function"?Ee.promise:typeof Map<"u"&&n instanceof Map?Ee.map:typeof Set<"u"&&n instanceof Set?Ee.set:typeof Date<"u"&&n instanceof Date?Ee.date:Ee.object;default:return Ee.unknown}},ve=ot.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]);class Da extends Error{get errors(){return this.issues}constructor(t){super(),this.issues=[],this.addIssue=r=>{this.issues=[...this.issues,r]},this.addIssues=(r=[])=>{this.issues=[...this.issues,...r]};const e=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,e):this.__proto__=e,this.name="ZodError",this.issues=t}format(t){const e=t||function(i){return i.message},r={_errors:[]},a=i=>{for(const u of i.issues)if(u.code==="invalid_union")u.unionErrors.map(a);else if(u.code==="invalid_return_type")a(u.returnTypeError);else if(u.code==="invalid_arguments")a(u.argumentsError);else if(u.path.length===0)r._errors.push(e(u));else{let l=r,c=0;for(;c<u.path.length;){const f=u.path[c];c===u.path.length-1?(l[f]=l[f]||{_errors:[]},l[f]._errors.push(e(u))):l[f]=l[f]||{_errors:[]},l=l[f],c++}}};return a(this),r}static assert(t){if(!(t instanceof Da))throw new Error(`Not a ZodError: ${t}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,ot.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(t=e=>e.message){const e={},r=[];for(const a of this.issues)if(a.path.length>0){const i=a.path[0];e[i]=e[i]||[],e[i].push(t(a))}else r.push(t(a));return{formErrors:r,fieldErrors:e}}get formErrors(){return this.flatten()}}Da.create=n=>new Da(n);const om=(n,t)=>{let e;switch(n.code){case ve.invalid_type:n.received===Ee.undefined?e="Required":e=`Expected ${n.expected}, received ${n.received}`;break;case ve.invalid_literal:e=`Invalid literal value, expected ${JSON.stringify(n.expected,ot.jsonStringifyReplacer)}`;break;case ve.unrecognized_keys:e=`Unrecognized key(s) in object: ${ot.joinValues(n.keys,", ")}`;break;case ve.invalid_union:e="Invalid input";break;case ve.invalid_union_discriminator:e=`Invalid discriminator value. Expected ${ot.joinValues(n.options)}`;break;case ve.invalid_enum_value:e=`Invalid enum value. Expected ${ot.joinValues(n.options)}, received '${n.received}'`;break;case ve.invalid_arguments:e="Invalid function arguments";break;case ve.invalid_return_type:e="Invalid function return type";break;case ve.invalid_date:e="Invalid date";break;case ve.invalid_string:typeof n.validation=="object"?"includes"in n.validation?(e=`Invalid input: must include "${n.validation.includes}"`,typeof n.validation.position=="number"&&(e=`${e} at one or more positions greater than or equal to ${n.validation.position}`)):"startsWith"in n.validation?e=`Invalid input: must start with "${n.validation.startsWith}"`:"endsWith"in n.validation?e=`Invalid input: must end with "${n.validation.endsWith}"`:ot.assertNever(n.validation):n.validation!=="regex"?e=`Invalid ${n.validation}`:e="Invalid";break;case ve.too_small:n.type==="array"?e=`Array must contain ${n.exact?"exactly":n.inclusive?"at least":"more than"} ${n.minimum} element(s)`:n.type==="string"?e=`String must contain ${n.exact?"exactly":n.inclusive?"at least":"over"} ${n.minimum} character(s)`:n.type==="number"?e=`Number must be ${n.exact?"exactly equal to ":n.inclusive?"greater than or equal to ":"greater than "}${n.minimum}`:n.type==="bigint"?e=`Number must be ${n.exact?"exactly equal to ":n.inclusive?"greater than or equal to ":"greater than "}${n.minimum}`:n.type==="date"?e=`Date must be ${n.exact?"exactly equal to ":n.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(n.minimum))}`:e="Invalid input";break;case ve.too_big:n.type==="array"?e=`Array must contain ${n.exact?"exactly":n.inclusive?"at most":"less than"} ${n.maximum} element(s)`:n.type==="string"?e=`String must contain ${n.exact?"exactly":n.inclusive?"at most":"under"} ${n.maximum} character(s)`:n.type==="number"?e=`Number must be ${n.exact?"exactly":n.inclusive?"less than or equal to":"less than"} ${n.maximum}`:n.type==="bigint"?e=`BigInt must be ${n.exact?"exactly":n.inclusive?"less than or equal to":"less than"} ${n.maximum}`:n.type==="date"?e=`Date must be ${n.exact?"exactly":n.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(n.maximum))}`:e="Invalid input";break;case ve.custom:e="Invalid input";break;case ve.invalid_intersection_types:e="Intersection results could not be merged";break;case ve.not_multiple_of:e=`Number must be a multiple of ${n.multipleOf}`;break;case ve.not_finite:e="Number must be finite";break;default:e=t.defaultError,ot.assertNever(n)}return{message:e}};let AO=om;function TO(){return AO}const DO=n=>{const{data:t,path:e,errorMaps:r,issueData:a}=n,i=[...e,...a.path||[]],u={...a,path:i};if(a.message!==void 0)return{...a,path:i,message:a.message};let l="";const c=r.filter(f=>!!f).slice().reverse();for(const f of c)l=f(u,{data:t,defaultError:l}).message;return{...a,path:i,message:l}};function be(n,t){const e=TO(),r=DO({issueData:t,data:n.data,path:n.path,errorMaps:[n.common.contextualErrorMap,n.schemaErrorMap,e,e===om?void 0:om].filter(a=>!!a)});n.common.issues.push(r)}class nr{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(t,e){const r=[];for(const a of e){if(a.status==="aborted")return Ve;a.status==="dirty"&&t.dirty(),r.push(a.value)}return{status:t.value,value:r}}static async mergeObjectAsync(t,e){const r=[];for(const a of e){const i=await a.key,u=await a.value;r.push({key:i,value:u})}return nr.mergeObjectSync(t,r)}static mergeObjectSync(t,e){const r={};for(const a of e){const{key:i,value:u}=a;if(i.status==="aborted"||u.status==="aborted")return Ve;i.status==="dirty"&&t.dirty(),u.status==="dirty"&&t.dirty(),i.value!=="__proto__"&&(typeof u.value<"u"||a.alwaysSet)&&(r[i.value]=u.value)}return{status:t.value,value:r}}}const Ve=Object.freeze({status:"aborted"}),Yu=n=>({status:"dirty",value:n}),xr=n=>({status:"valid",value:n}),rw=n=>n.status==="aborted",aw=n=>n.status==="dirty",Ds=n=>n.status==="valid",Nf=n=>typeof Promise<"u"&&n instanceof Promise;var Re;(function(n){n.errToObj=t=>typeof t=="string"?{message:t}:t||{},n.toString=t=>typeof t=="string"?t:t?.message})(Re||(Re={}));class Ri{constructor(t,e,r,a){this._cachedPath=[],this.parent=t,this.data=e,this._path=r,this._key=a}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const iw=(n,t)=>{if(Ds(t))return{success:!0,data:t.value};if(!n.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const e=new Da(n.common.issues);return this._error=e,this._error}}};function Qe(n){if(!n)return{};const{errorMap:t,invalid_type_error:e,required_error:r,description:a}=n;if(t&&(e||r))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return t?{errorMap:t,description:a}:{errorMap:(u,l)=>{const{message:c}=n;return u.code==="invalid_enum_value"?{message:c??l.defaultError}:typeof l.data>"u"?{message:c??r??l.defaultError}:u.code!=="invalid_type"?{message:l.defaultError}:{message:c??e??l.defaultError}},description:a}}class rt{get description(){return this._def.description}_getType(t){return di(t.data)}_getOrReturnCtx(t,e){return e||{common:t.parent.common,data:t.data,parsedType:di(t.data),schemaErrorMap:this._def.errorMap,path:t.path,parent:t.parent}}_processInputParams(t){return{status:new nr,ctx:{common:t.parent.common,data:t.data,parsedType:di(t.data),schemaErrorMap:this._def.errorMap,path:t.path,parent:t.parent}}}_parseSync(t){const e=this._parse(t);if(Nf(e))throw new Error("Synchronous parse encountered promise.");return e}_parseAsync(t){const e=this._parse(t);return Promise.resolve(e)}parse(t,e){const r=this.safeParse(t,e);if(r.success)return r.data;throw r.error}safeParse(t,e){const r={common:{issues:[],async:e?.async??!1,contextualErrorMap:e?.errorMap},path:e?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:di(t)},a=this._parseSync({data:t,path:r.path,parent:r});return iw(r,a)}"~validate"(t){const e={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:di(t)};if(!this["~standard"].async)try{const r=this._parseSync({data:t,path:[],parent:e});return Ds(r)?{value:r.value}:{issues:e.common.issues}}catch(r){r?.message?.toLowerCase()?.includes("encountered")&&(this["~standard"].async=!0),e.common={issues:[],async:!0}}return this._parseAsync({data:t,path:[],parent:e}).then(r=>Ds(r)?{value:r.value}:{issues:e.common.issues})}async parseAsync(t,e){const r=await this.safeParseAsync(t,e);if(r.success)return r.data;throw r.error}async safeParseAsync(t,e){const r={common:{issues:[],contextualErrorMap:e?.errorMap,async:!0},path:e?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:di(t)},a=this._parse({data:t,path:r.path,parent:r}),i=await(Nf(a)?a:Promise.resolve(a));return iw(r,i)}refine(t,e){const r=a=>typeof e=="string"||typeof e>"u"?{message:e}:typeof e=="function"?e(a):e;return this._refinement((a,i)=>{const u=t(a),l=()=>i.addIssue({code:ve.custom,...r(a)});return typeof Promise<"u"&&u instanceof Promise?u.then(c=>c?!0:(l(),!1)):u?!0:(l(),!1)})}refinement(t,e){return this._refinement((r,a)=>t(r)?!0:(a.addIssue(typeof e=="function"?e(r,a):e),!1))}_refinement(t){return new Os({schema:this,typeName:He.ZodEffects,effect:{type:"refinement",refinement:t}})}superRefine(t){return this._refinement(t)}constructor(t){this.spa=this.safeParseAsync,this._def=t,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:e=>this["~validate"](e)}}optional(){return wi.create(this,this._def)}nullable(){return Ns.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return Yr.create(this)}promise(){return Bf.create(this,this._def)}or(t){return If.create([this,t],this._def)}and(t){return Ff.create(this,t,this._def)}transform(t){return new Os({...Qe(this._def),schema:this,typeName:He.ZodEffects,effect:{type:"transform",transform:t}})}default(t){const e=typeof t=="function"?t:()=>t;return new um({...Qe(this._def),innerType:this,defaultValue:e,typeName:He.ZodDefault})}brand(){return new ZO({typeName:He.ZodBranded,type:this,...Qe(this._def)})}catch(t){const e=typeof t=="function"?t:()=>t;return new lm({...Qe(this._def),innerType:this,catchValue:e,typeName:He.ZodCatch})}describe(t){const e=this.constructor;return new e({...this._def,description:t})}pipe(t){return Qm.create(this,t)}readonly(){return cm.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const kO=/^c[^\s-]{8,}$/i,OO=/^[0-9a-z]+$/,NO=/^[0-9A-HJKMNP-TV-Z]{26}$/i,MO=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,IO=/^[a-z0-9_-]{21}$/i,FO=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,BO=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,LO=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,PO="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let cv;const zO=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,UO=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,VO=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,HO=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,jO=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,WO=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,N_="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",GO=new RegExp(`^${N_}$`);function M_(n){let t="[0-5]\\d";n.precision?t=`${t}\\.\\d{${n.precision}}`:n.precision==null&&(t=`${t}(\\.\\d+)?`);const e=n.precision?"+":"?";return`([01]\\d|2[0-3]):[0-5]\\d(:${t})${e}`}function qO(n){return new RegExp(`^${M_(n)}$`)}function KO(n){let t=`${N_}T${M_(n)}`;const e=[];return e.push(n.local?"Z?":"Z"),n.offset&&e.push("([+-]\\d{2}:?\\d{2})"),t=`${t}(${e.join("|")})`,new RegExp(`^${t}$`)}function XO(n,t){return!!((t==="v4"||!t)&&zO.test(n)||(t==="v6"||!t)&&VO.test(n))}function $O(n,t){if(!FO.test(n))return!1;try{const[e]=n.split(".");if(!e)return!1;const r=e.replace(/-/g,"+").replace(/_/g,"/").padEnd(e.length+(4-e.length%4)%4,"="),a=JSON.parse(atob(r));return!(typeof a!="object"||a===null||"typ"in a&&a?.typ!=="JWT"||!a.alg||t&&a.alg!==t)}catch{return!1}}function YO(n,t){return!!((t==="v4"||!t)&&UO.test(n)||(t==="v6"||!t)&&HO.test(n))}class vi extends rt{_parse(t){if(this._def.coerce&&(t.data=String(t.data)),this._getType(t)!==Ee.string){const i=this._getOrReturnCtx(t);return be(i,{code:ve.invalid_type,expected:Ee.string,received:i.parsedType}),Ve}const r=new nr;let a;for(const i of this._def.checks)if(i.kind==="min")t.data.length<i.value&&(a=this._getOrReturnCtx(t,a),be(a,{code:ve.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),r.dirty());else if(i.kind==="max")t.data.length>i.value&&(a=this._getOrReturnCtx(t,a),be(a,{code:ve.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),r.dirty());else if(i.kind==="length"){const u=t.data.length>i.value,l=t.data.length<i.value;(u||l)&&(a=this._getOrReturnCtx(t,a),u?be(a,{code:ve.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}):l&&be(a,{code:ve.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}),r.dirty())}else if(i.kind==="email")LO.test(t.data)||(a=this._getOrReturnCtx(t,a),be(a,{validation:"email",code:ve.invalid_string,message:i.message}),r.dirty());else if(i.kind==="emoji")cv||(cv=new RegExp(PO,"u")),cv.test(t.data)||(a=this._getOrReturnCtx(t,a),be(a,{validation:"emoji",code:ve.invalid_string,message:i.message}),r.dirty());else if(i.kind==="uuid")MO.test(t.data)||(a=this._getOrReturnCtx(t,a),be(a,{validation:"uuid",code:ve.invalid_string,message:i.message}),r.dirty());else if(i.kind==="nanoid")IO.test(t.data)||(a=this._getOrReturnCtx(t,a),be(a,{validation:"nanoid",code:ve.invalid_string,message:i.message}),r.dirty());else if(i.kind==="cuid")kO.test(t.data)||(a=this._getOrReturnCtx(t,a),be(a,{validation:"cuid",code:ve.invalid_string,message:i.message}),r.dirty());else if(i.kind==="cuid2")OO.test(t.data)||(a=this._getOrReturnCtx(t,a),be(a,{validation:"cuid2",code:ve.invalid_string,message:i.message}),r.dirty());else if(i.kind==="ulid")NO.test(t.data)||(a=this._getOrReturnCtx(t,a),be(a,{validation:"ulid",code:ve.invalid_string,message:i.message}),r.dirty());else if(i.kind==="url")try{new URL(t.data)}catch{a=this._getOrReturnCtx(t,a),be(a,{validation:"url",code:ve.invalid_string,message:i.message}),r.dirty()}else i.kind==="regex"?(i.regex.lastIndex=0,i.regex.test(t.data)||(a=this._getOrReturnCtx(t,a),be(a,{validation:"regex",code:ve.invalid_string,message:i.message}),r.dirty())):i.kind==="trim"?t.data=t.data.trim():i.kind==="includes"?t.data.includes(i.value,i.position)||(a=this._getOrReturnCtx(t,a),be(a,{code:ve.invalid_string,validation:{includes:i.value,position:i.position},message:i.message}),r.dirty()):i.kind==="toLowerCase"?t.data=t.data.toLowerCase():i.kind==="toUpperCase"?t.data=t.data.toUpperCase():i.kind==="startsWith"?t.data.startsWith(i.value)||(a=this._getOrReturnCtx(t,a),be(a,{code:ve.invalid_string,validation:{startsWith:i.value},message:i.message}),r.dirty()):i.kind==="endsWith"?t.data.endsWith(i.value)||(a=this._getOrReturnCtx(t,a),be(a,{code:ve.invalid_string,validation:{endsWith:i.value},message:i.message}),r.dirty()):i.kind==="datetime"?KO(i).test(t.data)||(a=this._getOrReturnCtx(t,a),be(a,{code:ve.invalid_string,validation:"datetime",message:i.message}),r.dirty()):i.kind==="date"?GO.test(t.data)||(a=this._getOrReturnCtx(t,a),be(a,{code:ve.invalid_string,validation:"date",message:i.message}),r.dirty()):i.kind==="time"?qO(i).test(t.data)||(a=this._getOrReturnCtx(t,a),be(a,{code:ve.invalid_string,validation:"time",message:i.message}),r.dirty()):i.kind==="duration"?BO.test(t.data)||(a=this._getOrReturnCtx(t,a),be(a,{validation:"duration",code:ve.invalid_string,message:i.message}),r.dirty()):i.kind==="ip"?XO(t.data,i.version)||(a=this._getOrReturnCtx(t,a),be(a,{validation:"ip",code:ve.invalid_string,message:i.message}),r.dirty()):i.kind==="jwt"?$O(t.data,i.alg)||(a=this._getOrReturnCtx(t,a),be(a,{validation:"jwt",code:ve.invalid_string,message:i.message}),r.dirty()):i.kind==="cidr"?YO(t.data,i.version)||(a=this._getOrReturnCtx(t,a),be(a,{validation:"cidr",code:ve.invalid_string,message:i.message}),r.dirty()):i.kind==="base64"?jO.test(t.data)||(a=this._getOrReturnCtx(t,a),be(a,{validation:"base64",code:ve.invalid_string,message:i.message}),r.dirty()):i.kind==="base64url"?WO.test(t.data)||(a=this._getOrReturnCtx(t,a),be(a,{validation:"base64url",code:ve.invalid_string,message:i.message}),r.dirty()):ot.assertNever(i);return{status:r.value,value:t.data}}_regex(t,e,r){return this.refinement(a=>t.test(a),{validation:e,code:ve.invalid_string,...Re.errToObj(r)})}_addCheck(t){return new vi({...this._def,checks:[...this._def.checks,t]})}email(t){return this._addCheck({kind:"email",...Re.errToObj(t)})}url(t){return this._addCheck({kind:"url",...Re.errToObj(t)})}emoji(t){return this._addCheck({kind:"emoji",...Re.errToObj(t)})}uuid(t){return this._addCheck({kind:"uuid",...Re.errToObj(t)})}nanoid(t){return this._addCheck({kind:"nanoid",...Re.errToObj(t)})}cuid(t){return this._addCheck({kind:"cuid",...Re.errToObj(t)})}cuid2(t){return this._addCheck({kind:"cuid2",...Re.errToObj(t)})}ulid(t){return this._addCheck({kind:"ulid",...Re.errToObj(t)})}base64(t){return this._addCheck({kind:"base64",...Re.errToObj(t)})}base64url(t){return this._addCheck({kind:"base64url",...Re.errToObj(t)})}jwt(t){return this._addCheck({kind:"jwt",...Re.errToObj(t)})}ip(t){return this._addCheck({kind:"ip",...Re.errToObj(t)})}cidr(t){return this._addCheck({kind:"cidr",...Re.errToObj(t)})}datetime(t){return typeof t=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:t}):this._addCheck({kind:"datetime",precision:typeof t?.precision>"u"?null:t?.precision,offset:t?.offset??!1,local:t?.local??!1,...Re.errToObj(t?.message)})}date(t){return this._addCheck({kind:"date",message:t})}time(t){return typeof t=="string"?this._addCheck({kind:"time",precision:null,message:t}):this._addCheck({kind:"time",precision:typeof t?.precision>"u"?null:t?.precision,...Re.errToObj(t?.message)})}duration(t){return this._addCheck({kind:"duration",...Re.errToObj(t)})}regex(t,e){return this._addCheck({kind:"regex",regex:t,...Re.errToObj(e)})}includes(t,e){return this._addCheck({kind:"includes",value:t,position:e?.position,...Re.errToObj(e?.message)})}startsWith(t,e){return this._addCheck({kind:"startsWith",value:t,...Re.errToObj(e)})}endsWith(t,e){return this._addCheck({kind:"endsWith",value:t,...Re.errToObj(e)})}min(t,e){return this._addCheck({kind:"min",value:t,...Re.errToObj(e)})}max(t,e){return this._addCheck({kind:"max",value:t,...Re.errToObj(e)})}length(t,e){return this._addCheck({kind:"length",value:t,...Re.errToObj(e)})}nonempty(t){return this.min(1,Re.errToObj(t))}trim(){return new vi({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new vi({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new vi({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(t=>t.kind==="datetime")}get isDate(){return!!this._def.checks.find(t=>t.kind==="date")}get isTime(){return!!this._def.checks.find(t=>t.kind==="time")}get isDuration(){return!!this._def.checks.find(t=>t.kind==="duration")}get isEmail(){return!!this._def.checks.find(t=>t.kind==="email")}get isURL(){return!!this._def.checks.find(t=>t.kind==="url")}get isEmoji(){return!!this._def.checks.find(t=>t.kind==="emoji")}get isUUID(){return!!this._def.checks.find(t=>t.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(t=>t.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(t=>t.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(t=>t.kind==="cuid2")}get isULID(){return!!this._def.checks.find(t=>t.kind==="ulid")}get isIP(){return!!this._def.checks.find(t=>t.kind==="ip")}get isCIDR(){return!!this._def.checks.find(t=>t.kind==="cidr")}get isBase64(){return!!this._def.checks.find(t=>t.kind==="base64")}get isBase64url(){return!!this._def.checks.find(t=>t.kind==="base64url")}get minLength(){let t=null;for(const e of this._def.checks)e.kind==="min"&&(t===null||e.value>t)&&(t=e.value);return t}get maxLength(){let t=null;for(const e of this._def.checks)e.kind==="max"&&(t===null||e.value<t)&&(t=e.value);return t}}vi.create=n=>new vi({checks:[],typeName:He.ZodString,coerce:n?.coerce??!1,...Qe(n)});function QO(n,t){const e=(n.toString().split(".")[1]||"").length,r=(t.toString().split(".")[1]||"").length,a=e>r?e:r,i=Number.parseInt(n.toFixed(a).replace(".","")),u=Number.parseInt(t.toFixed(a).replace(".",""));return i%u/10**a}class sl extends rt{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(t){if(this._def.coerce&&(t.data=Number(t.data)),this._getType(t)!==Ee.number){const i=this._getOrReturnCtx(t);return be(i,{code:ve.invalid_type,expected:Ee.number,received:i.parsedType}),Ve}let r;const a=new nr;for(const i of this._def.checks)i.kind==="int"?ot.isInteger(t.data)||(r=this._getOrReturnCtx(t,r),be(r,{code:ve.invalid_type,expected:"integer",received:"float",message:i.message}),a.dirty()):i.kind==="min"?(i.inclusive?t.data<i.value:t.data<=i.value)&&(r=this._getOrReturnCtx(t,r),be(r,{code:ve.too_small,minimum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),a.dirty()):i.kind==="max"?(i.inclusive?t.data>i.value:t.data>=i.value)&&(r=this._getOrReturnCtx(t,r),be(r,{code:ve.too_big,maximum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),a.dirty()):i.kind==="multipleOf"?QO(t.data,i.value)!==0&&(r=this._getOrReturnCtx(t,r),be(r,{code:ve.not_multiple_of,multipleOf:i.value,message:i.message}),a.dirty()):i.kind==="finite"?Number.isFinite(t.data)||(r=this._getOrReturnCtx(t,r),be(r,{code:ve.not_finite,message:i.message}),a.dirty()):ot.assertNever(i);return{status:a.value,value:t.data}}gte(t,e){return this.setLimit("min",t,!0,Re.toString(e))}gt(t,e){return this.setLimit("min",t,!1,Re.toString(e))}lte(t,e){return this.setLimit("max",t,!0,Re.toString(e))}lt(t,e){return this.setLimit("max",t,!1,Re.toString(e))}setLimit(t,e,r,a){return new sl({...this._def,checks:[...this._def.checks,{kind:t,value:e,inclusive:r,message:Re.toString(a)}]})}_addCheck(t){return new sl({...this._def,checks:[...this._def.checks,t]})}int(t){return this._addCheck({kind:"int",message:Re.toString(t)})}positive(t){return this._addCheck({kind:"min",value:0,inclusive:!1,message:Re.toString(t)})}negative(t){return this._addCheck({kind:"max",value:0,inclusive:!1,message:Re.toString(t)})}nonpositive(t){return this._addCheck({kind:"max",value:0,inclusive:!0,message:Re.toString(t)})}nonnegative(t){return this._addCheck({kind:"min",value:0,inclusive:!0,message:Re.toString(t)})}multipleOf(t,e){return this._addCheck({kind:"multipleOf",value:t,message:Re.toString(e)})}finite(t){return this._addCheck({kind:"finite",message:Re.toString(t)})}safe(t){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:Re.toString(t)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:Re.toString(t)})}get minValue(){let t=null;for(const e of this._def.checks)e.kind==="min"&&(t===null||e.value>t)&&(t=e.value);return t}get maxValue(){let t=null;for(const e of this._def.checks)e.kind==="max"&&(t===null||e.value<t)&&(t=e.value);return t}get isInt(){return!!this._def.checks.find(t=>t.kind==="int"||t.kind==="multipleOf"&&ot.isInteger(t.value))}get isFinite(){let t=null,e=null;for(const r of this._def.checks){if(r.kind==="finite"||r.kind==="int"||r.kind==="multipleOf")return!0;r.kind==="min"?(e===null||r.value>e)&&(e=r.value):r.kind==="max"&&(t===null||r.value<t)&&(t=r.value)}return Number.isFinite(e)&&Number.isFinite(t)}}sl.create=n=>new sl({checks:[],typeName:He.ZodNumber,coerce:n?.coerce||!1,...Qe(n)});class ul extends rt{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(t){if(this._def.coerce)try{t.data=BigInt(t.data)}catch{return this._getInvalidInput(t)}if(this._getType(t)!==Ee.bigint)return this._getInvalidInput(t);let r;const a=new nr;for(const i of this._def.checks)i.kind==="min"?(i.inclusive?t.data<i.value:t.data<=i.value)&&(r=this._getOrReturnCtx(t,r),be(r,{code:ve.too_small,type:"bigint",minimum:i.value,inclusive:i.inclusive,message:i.message}),a.dirty()):i.kind==="max"?(i.inclusive?t.data>i.value:t.data>=i.value)&&(r=this._getOrReturnCtx(t,r),be(r,{code:ve.too_big,type:"bigint",maximum:i.value,inclusive:i.inclusive,message:i.message}),a.dirty()):i.kind==="multipleOf"?t.data%i.value!==BigInt(0)&&(r=this._getOrReturnCtx(t,r),be(r,{code:ve.not_multiple_of,multipleOf:i.value,message:i.message}),a.dirty()):ot.assertNever(i);return{status:a.value,value:t.data}}_getInvalidInput(t){const e=this._getOrReturnCtx(t);return be(e,{code:ve.invalid_type,expected:Ee.bigint,received:e.parsedType}),Ve}gte(t,e){return this.setLimit("min",t,!0,Re.toString(e))}gt(t,e){return this.setLimit("min",t,!1,Re.toString(e))}lte(t,e){return this.setLimit("max",t,!0,Re.toString(e))}lt(t,e){return this.setLimit("max",t,!1,Re.toString(e))}setLimit(t,e,r,a){return new ul({...this._def,checks:[...this._def.checks,{kind:t,value:e,inclusive:r,message:Re.toString(a)}]})}_addCheck(t){return new ul({...this._def,checks:[...this._def.checks,t]})}positive(t){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:Re.toString(t)})}negative(t){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:Re.toString(t)})}nonpositive(t){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:Re.toString(t)})}nonnegative(t){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:Re.toString(t)})}multipleOf(t,e){return this._addCheck({kind:"multipleOf",value:t,message:Re.toString(e)})}get minValue(){let t=null;for(const e of this._def.checks)e.kind==="min"&&(t===null||e.value>t)&&(t=e.value);return t}get maxValue(){let t=null;for(const e of this._def.checks)e.kind==="max"&&(t===null||e.value<t)&&(t=e.value);return t}}ul.create=n=>new ul({checks:[],typeName:He.ZodBigInt,coerce:n?.coerce??!1,...Qe(n)});class ow extends rt{_parse(t){if(this._def.coerce&&(t.data=!!t.data),this._getType(t)!==Ee.boolean){const r=this._getOrReturnCtx(t);return be(r,{code:ve.invalid_type,expected:Ee.boolean,received:r.parsedType}),Ve}return xr(t.data)}}ow.create=n=>new ow({typeName:He.ZodBoolean,coerce:n?.coerce||!1,...Qe(n)});class Mf extends rt{_parse(t){if(this._def.coerce&&(t.data=new Date(t.data)),this._getType(t)!==Ee.date){const i=this._getOrReturnCtx(t);return be(i,{code:ve.invalid_type,expected:Ee.date,received:i.parsedType}),Ve}if(Number.isNaN(t.data.getTime())){const i=this._getOrReturnCtx(t);return be(i,{code:ve.invalid_date}),Ve}const r=new nr;let a;for(const i of this._def.checks)i.kind==="min"?t.data.getTime()<i.value&&(a=this._getOrReturnCtx(t,a),be(a,{code:ve.too_small,message:i.message,inclusive:!0,exact:!1,minimum:i.value,type:"date"}),r.dirty()):i.kind==="max"?t.data.getTime()>i.value&&(a=this._getOrReturnCtx(t,a),be(a,{code:ve.too_big,message:i.message,inclusive:!0,exact:!1,maximum:i.value,type:"date"}),r.dirty()):ot.assertNever(i);return{status:r.value,value:new Date(t.data.getTime())}}_addCheck(t){return new Mf({...this._def,checks:[...this._def.checks,t]})}min(t,e){return this._addCheck({kind:"min",value:t.getTime(),message:Re.toString(e)})}max(t,e){return this._addCheck({kind:"max",value:t.getTime(),message:Re.toString(e)})}get minDate(){let t=null;for(const e of this._def.checks)e.kind==="min"&&(t===null||e.value>t)&&(t=e.value);return t!=null?new Date(t):null}get maxDate(){let t=null;for(const e of this._def.checks)e.kind==="max"&&(t===null||e.value<t)&&(t=e.value);return t!=null?new Date(t):null}}Mf.create=n=>new Mf({checks:[],coerce:n?.coerce||!1,typeName:He.ZodDate,...Qe(n)});class sw extends rt{_parse(t){if(this._getType(t)!==Ee.symbol){const r=this._getOrReturnCtx(t);return be(r,{code:ve.invalid_type,expected:Ee.symbol,received:r.parsedType}),Ve}return xr(t.data)}}sw.create=n=>new sw({typeName:He.ZodSymbol,...Qe(n)});class uw extends rt{_parse(t){if(this._getType(t)!==Ee.undefined){const r=this._getOrReturnCtx(t);return be(r,{code:ve.invalid_type,expected:Ee.undefined,received:r.parsedType}),Ve}return xr(t.data)}}uw.create=n=>new uw({typeName:He.ZodUndefined,...Qe(n)});class lw extends rt{_parse(t){if(this._getType(t)!==Ee.null){const r=this._getOrReturnCtx(t);return be(r,{code:ve.invalid_type,expected:Ee.null,received:r.parsedType}),Ve}return xr(t.data)}}lw.create=n=>new lw({typeName:He.ZodNull,...Qe(n)});class cw extends rt{constructor(){super(...arguments),this._any=!0}_parse(t){return xr(t.data)}}cw.create=n=>new cw({typeName:He.ZodAny,...Qe(n)});class fw extends rt{constructor(){super(...arguments),this._unknown=!0}_parse(t){return xr(t.data)}}fw.create=n=>new fw({typeName:He.ZodUnknown,...Qe(n)});class Ai extends rt{_parse(t){const e=this._getOrReturnCtx(t);return be(e,{code:ve.invalid_type,expected:Ee.never,received:e.parsedType}),Ve}}Ai.create=n=>new Ai({typeName:He.ZodNever,...Qe(n)});class hw extends rt{_parse(t){if(this._getType(t)!==Ee.undefined){const r=this._getOrReturnCtx(t);return be(r,{code:ve.invalid_type,expected:Ee.void,received:r.parsedType}),Ve}return xr(t.data)}}hw.create=n=>new hw({typeName:He.ZodVoid,...Qe(n)});class Yr extends rt{_parse(t){const{ctx:e,status:r}=this._processInputParams(t),a=this._def;if(e.parsedType!==Ee.array)return be(e,{code:ve.invalid_type,expected:Ee.array,received:e.parsedType}),Ve;if(a.exactLength!==null){const u=e.data.length>a.exactLength.value,l=e.data.length<a.exactLength.value;(u||l)&&(be(e,{code:u?ve.too_big:ve.too_small,minimum:l?a.exactLength.value:void 0,maximum:u?a.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:a.exactLength.message}),r.dirty())}if(a.minLength!==null&&e.data.length<a.minLength.value&&(be(e,{code:ve.too_small,minimum:a.minLength.value,type:"array",inclusive:!0,exact:!1,message:a.minLength.message}),r.dirty()),a.maxLength!==null&&e.data.length>a.maxLength.value&&(be(e,{code:ve.too_big,maximum:a.maxLength.value,type:"array",inclusive:!0,exact:!1,message:a.maxLength.message}),r.dirty()),e.common.async)return Promise.all([...e.data].map((u,l)=>a.type._parseAsync(new Ri(e,u,e.path,l)))).then(u=>nr.mergeArray(r,u));const i=[...e.data].map((u,l)=>a.type._parseSync(new Ri(e,u,e.path,l)));return nr.mergeArray(r,i)}get element(){return this._def.type}min(t,e){return new Yr({...this._def,minLength:{value:t,message:Re.toString(e)}})}max(t,e){return new Yr({...this._def,maxLength:{value:t,message:Re.toString(e)}})}length(t,e){return new Yr({...this._def,exactLength:{value:t,message:Re.toString(e)}})}nonempty(t){return this.min(1,t)}}Yr.create=(n,t)=>new Yr({type:n,minLength:null,maxLength:null,exactLength:null,typeName:He.ZodArray,...Qe(t)});function cs(n){if(n instanceof Kt){const t={};for(const e in n.shape){const r=n.shape[e];t[e]=wi.create(cs(r))}return new Kt({...n._def,shape:()=>t})}else return n instanceof Yr?new Yr({...n._def,type:cs(n.element)}):n instanceof wi?wi.create(cs(n.unwrap())):n instanceof Ns?Ns.create(cs(n.unwrap())):n instanceof co?co.create(n.items.map(t=>cs(t))):n}class Kt extends rt{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const t=this._def.shape(),e=ot.objectKeys(t);return this._cached={shape:t,keys:e},this._cached}_parse(t){if(this._getType(t)!==Ee.object){const f=this._getOrReturnCtx(t);return be(f,{code:ve.invalid_type,expected:Ee.object,received:f.parsedType}),Ve}const{status:r,ctx:a}=this._processInputParams(t),{shape:i,keys:u}=this._getCached(),l=[];if(!(this._def.catchall instanceof Ai&&this._def.unknownKeys==="strip"))for(const f in a.data)u.includes(f)||l.push(f);const c=[];for(const f of u){const d=i[f],v=a.data[f];c.push({key:{status:"valid",value:f},value:d._parse(new Ri(a,v,a.path,f)),alwaysSet:f in a.data})}if(this._def.catchall instanceof Ai){const f=this._def.unknownKeys;if(f==="passthrough")for(const d of l)c.push({key:{status:"valid",value:d},value:{status:"valid",value:a.data[d]}});else if(f==="strict")l.length>0&&(be(a,{code:ve.unrecognized_keys,keys:l}),r.dirty());else if(f!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const f=this._def.catchall;for(const d of l){const v=a.data[d];c.push({key:{status:"valid",value:d},value:f._parse(new Ri(a,v,a.path,d)),alwaysSet:d in a.data})}}return a.common.async?Promise.resolve().then(async()=>{const f=[];for(const d of c){const v=await d.key,m=await d.value;f.push({key:v,value:m,alwaysSet:d.alwaysSet})}return f}).then(f=>nr.mergeObjectSync(r,f)):nr.mergeObjectSync(r,c)}get shape(){return this._def.shape()}strict(t){return Re.errToObj,new Kt({...this._def,unknownKeys:"strict",...t!==void 0?{errorMap:(e,r)=>{const a=this._def.errorMap?.(e,r).message??r.defaultError;return e.code==="unrecognized_keys"?{message:Re.errToObj(t).message??a}:{message:a}}}:{}})}strip(){return new Kt({...this._def,unknownKeys:"strip"})}passthrough(){return new Kt({...this._def,unknownKeys:"passthrough"})}extend(t){return new Kt({...this._def,shape:()=>({...this._def.shape(),...t})})}merge(t){return new Kt({unknownKeys:t._def.unknownKeys,catchall:t._def.catchall,shape:()=>({...this._def.shape(),...t._def.shape()}),typeName:He.ZodObject})}setKey(t,e){return this.augment({[t]:e})}catchall(t){return new Kt({...this._def,catchall:t})}pick(t){const e={};for(const r of ot.objectKeys(t))t[r]&&this.shape[r]&&(e[r]=this.shape[r]);return new Kt({...this._def,shape:()=>e})}omit(t){const e={};for(const r of ot.objectKeys(this.shape))t[r]||(e[r]=this.shape[r]);return new Kt({...this._def,shape:()=>e})}deepPartial(){return cs(this)}partial(t){const e={};for(const r of ot.objectKeys(this.shape)){const a=this.shape[r];t&&!t[r]?e[r]=a:e[r]=a.optional()}return new Kt({...this._def,shape:()=>e})}required(t){const e={};for(const r of ot.objectKeys(this.shape))if(t&&!t[r])e[r]=this.shape[r];else{let i=this.shape[r];for(;i instanceof wi;)i=i._def.innerType;e[r]=i}return new Kt({...this._def,shape:()=>e})}keyof(){return I_(ot.objectKeys(this.shape))}}Kt.create=(n,t)=>new Kt({shape:()=>n,unknownKeys:"strip",catchall:Ai.create(),typeName:He.ZodObject,...Qe(t)});Kt.strictCreate=(n,t)=>new Kt({shape:()=>n,unknownKeys:"strict",catchall:Ai.create(),typeName:He.ZodObject,...Qe(t)});Kt.lazycreate=(n,t)=>new Kt({shape:n,unknownKeys:"strip",catchall:Ai.create(),typeName:He.ZodObject,...Qe(t)});class If extends rt{_parse(t){const{ctx:e}=this._processInputParams(t),r=this._def.options;function a(i){for(const l of i)if(l.result.status==="valid")return l.result;for(const l of i)if(l.result.status==="dirty")return e.common.issues.push(...l.ctx.common.issues),l.result;const u=i.map(l=>new Da(l.ctx.common.issues));return be(e,{code:ve.invalid_union,unionErrors:u}),Ve}if(e.common.async)return Promise.all(r.map(async i=>{const u={...e,common:{...e.common,issues:[]},parent:null};return{result:await i._parseAsync({data:e.data,path:e.path,parent:u}),ctx:u}})).then(a);{let i;const u=[];for(const c of r){const f={...e,common:{...e.common,issues:[]},parent:null},d=c._parseSync({data:e.data,path:e.path,parent:f});if(d.status==="valid")return d;d.status==="dirty"&&!i&&(i={result:d,ctx:f}),f.common.issues.length&&u.push(f.common.issues)}if(i)return e.common.issues.push(...i.ctx.common.issues),i.result;const l=u.map(c=>new Da(c));return be(e,{code:ve.invalid_union,unionErrors:l}),Ve}}get options(){return this._def.options}}If.create=(n,t)=>new If({options:n,typeName:He.ZodUnion,...Qe(t)});function sm(n,t){const e=di(n),r=di(t);if(n===t)return{valid:!0,data:n};if(e===Ee.object&&r===Ee.object){const a=ot.objectKeys(t),i=ot.objectKeys(n).filter(l=>a.indexOf(l)!==-1),u={...n,...t};for(const l of i){const c=sm(n[l],t[l]);if(!c.valid)return{valid:!1};u[l]=c.data}return{valid:!0,data:u}}else if(e===Ee.array&&r===Ee.array){if(n.length!==t.length)return{valid:!1};const a=[];for(let i=0;i<n.length;i++){const u=n[i],l=t[i],c=sm(u,l);if(!c.valid)return{valid:!1};a.push(c.data)}return{valid:!0,data:a}}else return e===Ee.date&&r===Ee.date&&+n==+t?{valid:!0,data:n}:{valid:!1}}class Ff extends rt{_parse(t){const{status:e,ctx:r}=this._processInputParams(t),a=(i,u)=>{if(rw(i)||rw(u))return Ve;const l=sm(i.value,u.value);return l.valid?((aw(i)||aw(u))&&e.dirty(),{status:e.value,value:l.data}):(be(r,{code:ve.invalid_intersection_types}),Ve)};return r.common.async?Promise.all([this._def.left._parseAsync({data:r.data,path:r.path,parent:r}),this._def.right._parseAsync({data:r.data,path:r.path,parent:r})]).then(([i,u])=>a(i,u)):a(this._def.left._parseSync({data:r.data,path:r.path,parent:r}),this._def.right._parseSync({data:r.data,path:r.path,parent:r}))}}Ff.create=(n,t,e)=>new Ff({left:n,right:t,typeName:He.ZodIntersection,...Qe(e)});class co extends rt{_parse(t){const{status:e,ctx:r}=this._processInputParams(t);if(r.parsedType!==Ee.array)return be(r,{code:ve.invalid_type,expected:Ee.array,received:r.parsedType}),Ve;if(r.data.length<this._def.items.length)return be(r,{code:ve.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),Ve;!this._def.rest&&r.data.length>this._def.items.length&&(be(r,{code:ve.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),e.dirty());const i=[...r.data].map((u,l)=>{const c=this._def.items[l]||this._def.rest;return c?c._parse(new Ri(r,u,r.path,l)):null}).filter(u=>!!u);return r.common.async?Promise.all(i).then(u=>nr.mergeArray(e,u)):nr.mergeArray(e,i)}get items(){return this._def.items}rest(t){return new co({...this._def,rest:t})}}co.create=(n,t)=>{if(!Array.isArray(n))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new co({items:n,typeName:He.ZodTuple,rest:null,...Qe(t)})};class dw extends rt{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(t){const{status:e,ctx:r}=this._processInputParams(t);if(r.parsedType!==Ee.map)return be(r,{code:ve.invalid_type,expected:Ee.map,received:r.parsedType}),Ve;const a=this._def.keyType,i=this._def.valueType,u=[...r.data.entries()].map(([l,c],f)=>({key:a._parse(new Ri(r,l,r.path,[f,"key"])),value:i._parse(new Ri(r,c,r.path,[f,"value"]))}));if(r.common.async){const l=new Map;return Promise.resolve().then(async()=>{for(const c of u){const f=await c.key,d=await c.value;if(f.status==="aborted"||d.status==="aborted")return Ve;(f.status==="dirty"||d.status==="dirty")&&e.dirty(),l.set(f.value,d.value)}return{status:e.value,value:l}})}else{const l=new Map;for(const c of u){const f=c.key,d=c.value;if(f.status==="aborted"||d.status==="aborted")return Ve;(f.status==="dirty"||d.status==="dirty")&&e.dirty(),l.set(f.value,d.value)}return{status:e.value,value:l}}}}dw.create=(n,t,e)=>new dw({valueType:t,keyType:n,typeName:He.ZodMap,...Qe(e)});class ll extends rt{_parse(t){const{status:e,ctx:r}=this._processInputParams(t);if(r.parsedType!==Ee.set)return be(r,{code:ve.invalid_type,expected:Ee.set,received:r.parsedType}),Ve;const a=this._def;a.minSize!==null&&r.data.size<a.minSize.value&&(be(r,{code:ve.too_small,minimum:a.minSize.value,type:"set",inclusive:!0,exact:!1,message:a.minSize.message}),e.dirty()),a.maxSize!==null&&r.data.size>a.maxSize.value&&(be(r,{code:ve.too_big,maximum:a.maxSize.value,type:"set",inclusive:!0,exact:!1,message:a.maxSize.message}),e.dirty());const i=this._def.valueType;function u(c){const f=new Set;for(const d of c){if(d.status==="aborted")return Ve;d.status==="dirty"&&e.dirty(),f.add(d.value)}return{status:e.value,value:f}}const l=[...r.data.values()].map((c,f)=>i._parse(new Ri(r,c,r.path,f)));return r.common.async?Promise.all(l).then(c=>u(c)):u(l)}min(t,e){return new ll({...this._def,minSize:{value:t,message:Re.toString(e)}})}max(t,e){return new ll({...this._def,maxSize:{value:t,message:Re.toString(e)}})}size(t,e){return this.min(t,e).max(t,e)}nonempty(t){return this.min(1,t)}}ll.create=(n,t)=>new ll({valueType:n,minSize:null,maxSize:null,typeName:He.ZodSet,...Qe(t)});class pw extends rt{get schema(){return this._def.getter()}_parse(t){const{ctx:e}=this._processInputParams(t);return this._def.getter()._parse({data:e.data,path:e.path,parent:e})}}pw.create=(n,t)=>new pw({getter:n,typeName:He.ZodLazy,...Qe(t)});class vw extends rt{_parse(t){if(t.data!==this._def.value){const e=this._getOrReturnCtx(t);return be(e,{received:e.data,code:ve.invalid_literal,expected:this._def.value}),Ve}return{status:"valid",value:t.data}}get value(){return this._def.value}}vw.create=(n,t)=>new vw({value:n,typeName:He.ZodLiteral,...Qe(t)});function I_(n,t){return new ks({values:n,typeName:He.ZodEnum,...Qe(t)})}class ks extends rt{_parse(t){if(typeof t.data!="string"){const e=this._getOrReturnCtx(t),r=this._def.values;return be(e,{expected:ot.joinValues(r),received:e.parsedType,code:ve.invalid_type}),Ve}if(this._cache||(this._cache=new Set(this._def.values)),!this._cache.has(t.data)){const e=this._getOrReturnCtx(t),r=this._def.values;return be(e,{received:e.data,code:ve.invalid_enum_value,options:r}),Ve}return xr(t.data)}get options(){return this._def.values}get enum(){const t={};for(const e of this._def.values)t[e]=e;return t}get Values(){const t={};for(const e of this._def.values)t[e]=e;return t}get Enum(){const t={};for(const e of this._def.values)t[e]=e;return t}extract(t,e=this._def){return ks.create(t,{...this._def,...e})}exclude(t,e=this._def){return ks.create(this.options.filter(r=>!t.includes(r)),{...this._def,...e})}}ks.create=I_;class mw extends rt{_parse(t){const e=ot.getValidEnumValues(this._def.values),r=this._getOrReturnCtx(t);if(r.parsedType!==Ee.string&&r.parsedType!==Ee.number){const a=ot.objectValues(e);return be(r,{expected:ot.joinValues(a),received:r.parsedType,code:ve.invalid_type}),Ve}if(this._cache||(this._cache=new Set(ot.getValidEnumValues(this._def.values))),!this._cache.has(t.data)){const a=ot.objectValues(e);return be(r,{received:r.data,code:ve.invalid_enum_value,options:a}),Ve}return xr(t.data)}get enum(){return this._def.values}}mw.create=(n,t)=>new mw({values:n,typeName:He.ZodNativeEnum,...Qe(t)});class Bf extends rt{unwrap(){return this._def.type}_parse(t){const{ctx:e}=this._processInputParams(t);if(e.parsedType!==Ee.promise&&e.common.async===!1)return be(e,{code:ve.invalid_type,expected:Ee.promise,received:e.parsedType}),Ve;const r=e.parsedType===Ee.promise?e.data:Promise.resolve(e.data);return xr(r.then(a=>this._def.type.parseAsync(a,{path:e.path,errorMap:e.common.contextualErrorMap})))}}Bf.create=(n,t)=>new Bf({type:n,typeName:He.ZodPromise,...Qe(t)});class Os extends rt{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===He.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(t){const{status:e,ctx:r}=this._processInputParams(t),a=this._def.effect||null,i={addIssue:u=>{be(r,u),u.fatal?e.abort():e.dirty()},get path(){return r.path}};if(i.addIssue=i.addIssue.bind(i),a.type==="preprocess"){const u=a.transform(r.data,i);if(r.common.async)return Promise.resolve(u).then(async l=>{if(e.value==="aborted")return Ve;const c=await this._def.schema._parseAsync({data:l,path:r.path,parent:r});return c.status==="aborted"?Ve:c.status==="dirty"||e.value==="dirty"?Yu(c.value):c});{if(e.value==="aborted")return Ve;const l=this._def.schema._parseSync({data:u,path:r.path,parent:r});return l.status==="aborted"?Ve:l.status==="dirty"||e.value==="dirty"?Yu(l.value):l}}if(a.type==="refinement"){const u=l=>{const c=a.refinement(l,i);if(r.common.async)return Promise.resolve(c);if(c instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return l};if(r.common.async===!1){const l=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});return l.status==="aborted"?Ve:(l.status==="dirty"&&e.dirty(),u(l.value),{status:e.value,value:l.value})}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(l=>l.status==="aborted"?Ve:(l.status==="dirty"&&e.dirty(),u(l.value).then(()=>({status:e.value,value:l.value}))))}if(a.type==="transform")if(r.common.async===!1){const u=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});if(!Ds(u))return Ve;const l=a.transform(u.value,i);if(l instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:e.value,value:l}}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(u=>Ds(u)?Promise.resolve(a.transform(u.value,i)).then(l=>({status:e.value,value:l})):Ve);ot.assertNever(a)}}Os.create=(n,t,e)=>new Os({schema:n,typeName:He.ZodEffects,effect:t,...Qe(e)});Os.createWithPreprocess=(n,t,e)=>new Os({schema:t,effect:{type:"preprocess",transform:n},typeName:He.ZodEffects,...Qe(e)});class wi extends rt{_parse(t){return this._getType(t)===Ee.undefined?xr(void 0):this._def.innerType._parse(t)}unwrap(){return this._def.innerType}}wi.create=(n,t)=>new wi({innerType:n,typeName:He.ZodOptional,...Qe(t)});class Ns extends rt{_parse(t){return this._getType(t)===Ee.null?xr(null):this._def.innerType._parse(t)}unwrap(){return this._def.innerType}}Ns.create=(n,t)=>new Ns({innerType:n,typeName:He.ZodNullable,...Qe(t)});class um extends rt{_parse(t){const{ctx:e}=this._processInputParams(t);let r=e.data;return e.parsedType===Ee.undefined&&(r=this._def.defaultValue()),this._def.innerType._parse({data:r,path:e.path,parent:e})}removeDefault(){return this._def.innerType}}um.create=(n,t)=>new um({innerType:n,typeName:He.ZodDefault,defaultValue:typeof t.default=="function"?t.default:()=>t.default,...Qe(t)});class lm extends rt{_parse(t){const{ctx:e}=this._processInputParams(t),r={...e,common:{...e.common,issues:[]}},a=this._def.innerType._parse({data:r.data,path:r.path,parent:{...r}});return Nf(a)?a.then(i=>({status:"valid",value:i.status==="valid"?i.value:this._def.catchValue({get error(){return new Da(r.common.issues)},input:r.data})})):{status:"valid",value:a.status==="valid"?a.value:this._def.catchValue({get error(){return new Da(r.common.issues)},input:r.data})}}removeCatch(){return this._def.innerType}}lm.create=(n,t)=>new lm({innerType:n,typeName:He.ZodCatch,catchValue:typeof t.catch=="function"?t.catch:()=>t.catch,...Qe(t)});class gw extends rt{_parse(t){if(this._getType(t)!==Ee.nan){const r=this._getOrReturnCtx(t);return be(r,{code:ve.invalid_type,expected:Ee.nan,received:r.parsedType}),Ve}return{status:"valid",value:t.data}}}gw.create=n=>new gw({typeName:He.ZodNaN,...Qe(n)});class ZO extends rt{_parse(t){const{ctx:e}=this._processInputParams(t),r=e.data;return this._def.type._parse({data:r,path:e.path,parent:e})}unwrap(){return this._def.type}}class Qm extends rt{_parse(t){const{status:e,ctx:r}=this._processInputParams(t);if(r.common.async)return(async()=>{const i=await this._def.in._parseAsync({data:r.data,path:r.path,parent:r});return i.status==="aborted"?Ve:i.status==="dirty"?(e.dirty(),Yu(i.value)):this._def.out._parseAsync({data:i.value,path:r.path,parent:r})})();{const a=this._def.in._parseSync({data:r.data,path:r.path,parent:r});return a.status==="aborted"?Ve:a.status==="dirty"?(e.dirty(),{status:"dirty",value:a.value}):this._def.out._parseSync({data:a.value,path:r.path,parent:r})}}static create(t,e){return new Qm({in:t,out:e,typeName:He.ZodPipeline})}}class cm extends rt{_parse(t){const e=this._def.innerType._parse(t),r=a=>(Ds(a)&&(a.value=Object.freeze(a.value)),a);return Nf(e)?e.then(a=>r(a)):r(e)}unwrap(){return this._def.innerType}}cm.create=(n,t)=>new cm({innerType:n,typeName:He.ZodReadonly,...Qe(t)});var He;(function(n){n.ZodString="ZodString",n.ZodNumber="ZodNumber",n.ZodNaN="ZodNaN",n.ZodBigInt="ZodBigInt",n.ZodBoolean="ZodBoolean",n.ZodDate="ZodDate",n.ZodSymbol="ZodSymbol",n.ZodUndefined="ZodUndefined",n.ZodNull="ZodNull",n.ZodAny="ZodAny",n.ZodUnknown="ZodUnknown",n.ZodNever="ZodNever",n.ZodVoid="ZodVoid",n.ZodArray="ZodArray",n.ZodObject="ZodObject",n.ZodUnion="ZodUnion",n.ZodDiscriminatedUnion="ZodDiscriminatedUnion",n.ZodIntersection="ZodIntersection",n.ZodTuple="ZodTuple",n.ZodRecord="ZodRecord",n.ZodMap="ZodMap",n.ZodSet="ZodSet",n.ZodFunction="ZodFunction",n.ZodLazy="ZodLazy",n.ZodLiteral="ZodLiteral",n.ZodEnum="ZodEnum",n.ZodEffects="ZodEffects",n.ZodNativeEnum="ZodNativeEnum",n.ZodOptional="ZodOptional",n.ZodNullable="ZodNullable",n.ZodDefault="ZodDefault",n.ZodCatch="ZodCatch",n.ZodPromise="ZodPromise",n.ZodBranded="ZodBranded",n.ZodPipeline="ZodPipeline",n.ZodReadonly="ZodReadonly"})(He||(He={}));const WP=vi.create;Ai.create;Yr.create;If.create;Ff.create;co.create;ks.create;Bf.create;wi.create;Ns.create;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var F_=function(n,t){return(F_=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var a in r)r.hasOwnProperty(a)&&(e[a]=r[a])})(n,t)};function Mr(n,t){function e(){this.constructor=n}F_(n,t),n.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}function _e(n,t,e,r){return new(e||(e=Promise))(function(a,i){function u(f){try{c(r.next(f))}catch(d){i(d)}}function l(f){try{c(r.throw(f))}catch(d){i(d)}}function c(f){f.done?a(f.value):new e(function(d){d(f.value)}).then(u,l)}c((r=r.apply(n,[])).next())})}function Se(n,t){var e,r,a,i,u={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},typeof Symbol=="function"&&(i[Symbol.iterator]=function(){return this}),i;function l(c){return function(f){return function(d){if(e)throw new TypeError("Generator is already executing.");for(;u;)try{if(e=1,r&&(a=2&d[0]?r.return:d[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,d[1])).done)return a;switch(r=0,a&&(d=[2&d[0],a.value]),d[0]){case 0:case 1:a=d;break;case 4:return u.label++,{value:d[1],done:!1};case 5:u.label++,r=d[1],d=[0];continue;case 7:d=u.ops.pop(),u.trys.pop();continue;default:if(!(a=(a=u.trys).length>0&&a[a.length-1])&&(d[0]===6||d[0]===2)){u=0;continue}if(d[0]===3&&(!a||d[1]>a[0]&&d[1]<a[3])){u.label=d[1];break}if(d[0]===6&&u.label<a[1]){u.label=a[1],a=d;break}if(a&&u.label<a[2]){u.label=a[2],u.ops.push(d);break}a[2]&&u.ops.pop(),u.trys.pop();continue}d=t.call(n,u)}catch(v){d=[6,v],r=0}finally{e=a=0}if(5&d[0])throw d[1];return{value:d[0]?d[1]:void 0,done:!0}}([c,f])}}}var JO=function(){function n(t){this.global=t,this.flags={},this.flagRegistry={},this.urlFlags={},this.populateURLFlags()}return n.prototype.setPlatform=function(t,e){this.platform!=null&&console.warn("Platform "+this.platformName+" has already been set. Overwriting the platform with "+e+"."),this.platformName=t,this.platform=e},n.prototype.registerFlag=function(t,e,r){if(this.flagRegistry[t]={evaluationFn:e,setHook:r},this.urlFlags[t]!=null){var a=this.urlFlags[t];console.warn("Setting feature override from URL "+t+": "+a+"."),this.set(t,a)}},n.prototype.get=function(t){return t in this.flags?this.flags[t]:(this.flags[t]=this.evaluateFlag(t),this.flags[t])},n.prototype.getNumber=function(t){return this.get(t)},n.prototype.getBool=function(t){return this.get(t)},n.prototype.getFlags=function(){return this.flags},Object.defineProperty(n.prototype,"features",{get:function(){return this.flags},enumerable:!0,configurable:!0}),n.prototype.set=function(t,e){if(this.flagRegistry[t]==null)throw new Error("Cannot set flag "+t+" as it has not been registered.");this.flags[t]=e,this.flagRegistry[t].setHook!=null&&this.flagRegistry[t].setHook(e)},n.prototype.evaluateFlag=function(t){if(this.flagRegistry[t]==null)throw new Error("Cannot evaluate flag '"+t+"': no evaluation function found.");return this.flagRegistry[t].evaluationFn()},n.prototype.setFlags=function(t){this.flags=Object.assign({},t)},n.prototype.reset=function(){this.flags={},this.urlFlags={},this.populateURLFlags()},n.prototype.populateURLFlags=function(){var t=this;if(this.global!==void 0&&this.global.location!==void 0&&this.global.location.search!==void 0){var e,r,a=(e=this.global.location.search,r={},e.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,function(i){for(var u=[],l=1;l<arguments.length;l++)u[l-1]=arguments[l];return eN(r,u[0],u[1]),u.join("=")}),r);"tfjsflags"in a&&a.tfjsflags.split(",").forEach(function(i){var u=i.split(":"),l=u[0],c=u[1];t.urlFlags[l]=function(f,d){if((d=d.toLowerCase())==="true"||d==="false")return d==="true";if(""+ +d===d)return+d;throw new Error("Could not parse value flag value "+d+" for flag "+f+".")}(l,c)})}},n}();function eN(n,t,e){n[decodeURIComponent(t)]=decodeURIComponent(e||"")}function ue(){return B_}var B_=null,Lf=new Map,fm=new Map;function L_(n,t){var e=z_(n,t);return Lf.get(e)}function tN(n){return fm.get(n)}function yw(n){for(var t=Lf.entries(),e=[];;){var r=t.next(),a=r.done,i=r.value;if(a)break;var u=i[0],l=i[1];u.split("_")[0]===n&&e.push(l)}return e}function P_(n){var t=n.kernelName,e=n.backendName,r=z_(t,e);if(Lf.has(r))throw new Error("The kernel '"+t+"' for backend '"+e+"' is already registered");Lf.set(r,n)}function nN(n){var t=n.kernelName;fm.has(t)&&console.warn("Overriding the gradient for '"+t+"'"),fm.set(t,n)}function z_(n,t){return t+"_"+n}function hm(n,t,e){return Math.max(n,Math.min(t,e))}function U_(n){return n%2==0?n:n+1}function rN(n){for(var t=0,e=0;e<n.length;e++)t+=n[e];return t}function L(n,t){if(!n)throw new Error(typeof t=="string"?t:t())}function ft(n,t,e){e===void 0&&(e=""),L(un(n,t),function(){return e+" Shapes "+n+" and "+t+" must match"})}function Vs(n){L(n!=null,function(){return"The input to the tensor constructor must be a non-null value."})}function Ms(n,t,e){if(t===void 0&&(t=[]),e===void 0&&(e=!1),t==null&&(t=[]),Array.isArray(n)||Qr(n)&&!e)for(var r=0;r<n.length;++r)Ms(n[r],t,e);else t.push(n);return t}function Ce(n){if(n.length===0)return 1;for(var t=n[0],e=1;e<n.length;e++)t*=n[e];return t}function un(n,t){if(n===t)return!0;if(n==null||t==null||n.length!==t.length)return!1;for(var e=0;e<n.length;e++)if(n[e]!==t[e])return!1;return!0}function Bt(n){return n%1==0}function aN(n){if(Math.tanh!=null)return Math.tanh(n);if(n===1/0)return 1;if(n===-1/0)return-1;var t=Math.exp(2*n);return(t-1)/(t+1)}function dm(n){var t=Math.ceil(Math.sqrt(n));return[t,Math.ceil(n/t)]}function ms(n,t){return t<=n.length?n:n+" ".repeat(t-n.length)}function bw(n,t,e){return t===void 0&&(t=function(r){return 0}),new Promise(function(r,a){var i=0,u=function(){if(n())r();else{i++;var l=t(i);e!=null&&i>=e?a():setTimeout(u,l)}};u()})}function iN(n,t){for(var e=1,r=-1,a=0;a<n.length;++a)if(n[a]>=0)e*=n[a];else if(n[a]===-1){if(r!==-1)throw Error("Shapes can only have 1 implicit size. Found -1 at dim "+r+" and dim "+a);r=a}else if(n[a]<0)throw Error("Shapes can not be < 0. Found "+n[a]+" at dim "+a);if(r===-1){if(t>0&&t!==e)throw Error("Size("+t+") must match the product of shape "+n);return n}if(e===0)throw Error("Cannot infer the missing size in ["+n+"] when there are 0 elements");if(t%e!=0)throw Error("The implicit shape can't be a fractional number. Got "+t+" / "+e);var i=n.slice();return i[r]=t/e,i}function Jt(n,t){var e=t.length;return L((n=n==null?t.map(function(r,a){return a}):[].concat(n)).every(function(r){return r>=-e&&r<e}),function(){return"All values in axis param must be in range [-"+e+", "+e+") but got axis "+n}),L(n.every(function(r){return Bt(r)}),function(){return"All values in axis param must be integers but got axis "+n}),n.map(function(r){return r<0?e+r:r})}function Ji(n,t){for(var e=[],r=[],a=t!=null&&Array.isArray(t)&&t.length===0,i=t==null||a?null:Jt(t,n).sort(),u=0,l=0;l<n.length;++l){if(i!=null){if(i[u]===l&&n[l]!==1)throw new Error("Can't squeeze axis "+l+" since its dim '"+n[l]+"' is not 1");(i[u]==null||i[u]>l)&&n[l]===1&&(e.push(n[l]),r.push(l)),i[u]<=l&&u++}n[l]!==1&&(e.push(n[l]),r.push(l))}return{newShape:e,keptDims:r}}function cl(n,t){var e=null;if(n==null||n==="float32")e=new Float32Array(t);else if(n==="int32")e=new Int32Array(t);else{if(n!=="bool")throw new Error("Unknown data type "+n);e=new Uint8Array(t)}return e}function Pf(n,t){var e=null;if(n==null||n==="float32")e=new Float32Array(t);else if(n==="int32")e=new Int32Array(t);else if(n==="bool")e=new Uint8Array(t);else{if(n!=="string")throw new Error("Unknown data type "+n);e=new Array(t)}return e}function oN(n,t){for(var e=0;e<n.length;e++){var r=n[e];if(isNaN(r)||!isFinite(r))throw Error("A tensor of type "+t+" being uploaded contains "+r+".")}}function sN(n){return n==="bool"||n==="complex64"||n==="float32"||n==="int32"||n==="string"}function uN(n,t){return t!=="complex64"&&(t!=="float32"||n==="complex64")&&(t!=="int32"||n==="float32"||n==="complex64")&&(t!=="bool"||n!=="bool")}function Qr(n){return n instanceof Float32Array||n instanceof Int32Array||n instanceof Uint8Array}function V_(n){if(n==="float32"||n==="int32")return 4;if(n==="complex64")return 8;if(n==="bool")return 1;throw new Error("Unknown dtype "+n)}function lN(n){if(n==null)return 0;var t=0;return n.forEach(function(e){return t+=e.length}),t}function Zm(n){return typeof n=="string"||n instanceof String}function cN(n){return typeof n=="boolean"}function fN(n){return typeof n=="number"}function Sl(n){return Array.isArray(n)?Sl(n[0]):n instanceof Float32Array?"float32":n instanceof Int32Array||n instanceof Uint8Array?"int32":fN(n)?"float32":Zm(n)?"string":cN(n)?"bool":"float32"}function pm(n){return!!(n&&n.constructor&&n.call&&n.apply)}function vm(n,t){for(var e=t;e<n;++e)if(n%e==0)return e;return n}function Zr(n){var t=n.length;if(t<2)return[];var e=new Array(t-1);e[t-2]=n[t-1];for(var r=t-3;r>=0;--r)e[r]=e[r+1]*n[r+1];return e}function H_(n,t,e){if(t==="string")throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(n)&&(n=Ms(n)),e&&oN(n,t),function(i,u){return i instanceof Float32Array&&u==="float32"||i instanceof Int32Array&&u==="int32"||i instanceof Uint8Array&&u==="bool"}(n,t))return n;if(t==null||t==="float32"||t==="complex64")return new Float32Array(n);if(t==="int32")return new Int32Array(n);if(t==="bool"){for(var r=new Uint8Array(n.length),a=0;a<r.length;++a)Math.round(n[a])!==0&&(r[a]=1);return r}throw new Error("Unknown data type "+t)}function xw(n,t){if(n.length===0)return t[0];var e=n.reduce(function(r,a){return r*a});if(e===0)return[];if(e!==t.length)throw new Error("["+n+"] does not match the input size.");return function r(a,i,u){var l=new Array;if(i.length===1)for(var c=i[0],f=0;f<c;f++)l[f]=u[a+f];else{c=i[0];var d=i.slice(1),v=d.reduce(function(m,g){return m*g});for(f=0;f<c;f++)l[f]=r(a+f*v,d,u)}return l}(0,n,t)}function j_(n,t){for(var e=El(n,t),r=0;r<e.length;r++)e[r]=1;return e}function El(n,t){if(t==null||t==="float32"||t==="complex64")return new Float32Array(n);if(t==="int32")return new Int32Array(n);if(t==="bool")return new Uint8Array(n);throw new Error("Unknown data type "+t)}function Gr(){return ue().platform.now()}function W_(n){n.forEach(function(t){L(Number.isInteger(t)&&t>=0,function(){return"Tensor must have a shape comprised of positive integers but got shape ["+n+"]."})})}function hN(n,t){return t===void 0&&(t="utf-8"),t=t||"utf-8",ue().platform.encode(n,t)}function zf(n,t){return t===void 0&&(t="utf-8"),t=t||"utf-8",ue().platform.decode(n,t)}function ww(n,t,e){if(t===0)return 0;if(t===1)return n[0];for(var r=n[n.length-1],a=0;a<n.length-1;++a)r+=e[a]*n[a];return r}function dN(n,t,e){if(t===0)return[];if(t===1)return[n];for(var r=new Array(t),a=0;a<r.length-1;++a)r[a]=Math.floor(n/e[a]),n-=r[a]*e[a];return r[r.length-1]=n,r}var pN=function(){function n(t,e){this.backendTimer=t,this.logger=e,e==null&&(this.logger=new vN)}return n.prototype.profileKernel=function(t,e,r){var a,i=this,u=this.backendTimer.time(function(){a=r()});return a.forEach(function(l){l.data().then(function(c){(function(f,d,v){if(d!=="float32")return!1;for(var m=0;m<f.length;m++){var g=f[m];if(isNaN(g)||!isFinite(g))return console.warn("Found "+g+" in the result of '"+v+"'"),!0}})(c,l.dtype,t),u.then(function(f){var d="";f.getExtraProfileInfo!=null&&(d=f.getExtraProfileInfo()),i.logger.logKernelProfile(t,l,c,f.kernelMs,e,d)})})}),a},n}(),vN=function(){function n(){}return n.prototype.logKernelProfile=function(t,e,r,a,i,u){var l=typeof a=="number"?ms(a+"ms",9):a.error,c=ms(t,25),f=e.rank,d=e.size,v=ms(e.shape.toString(),14),m="";for(var g in i){var b=i[g].shape||e.shape,w=b.length;m+=g+": "+w+"D "+(w>0?b:"")+" "}console.log("%c"+c+"	%c"+l+"	%c"+f+"D "+v+"	%c"+d+"	%c"+m+"	%c"+u,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")},n}(),_w=20,Wu=3,fv=7;function mN(n,t,e,r){var a=Zr(t),i=function(f,d,v,m){var g=Ce(d),b=m[m.length-1],w=new Array(b).fill(0),S=d.length,_=v==="complex64"?qu(f):f;if(S>1)for(var E=0;E<g/b;E++)for(var R=E*b,C=0;C<b;C++)w[C]=Math.max(w[C],Gu(_[R+C],0,v).length);return w}(n,t,e,a),u=t.length,l=function f(d,v,m,g,b,w){w===void 0&&(w=!0);var S=m==="complex64"?2:1,_=v[0],E=v.length;if(E===0)return m==="complex64"?[Gu(qu(d)[0],0,m)]:m==="bool"?[G_(d[0])]:[d[0].toString()];if(E===1){if(_>_w){var R=Wu*S,C=Array.from(d.slice(0,R)),A=Array.from(d.slice((_-Wu)*S,_*S));return m==="complex64"&&(C=qu(C),A=qu(A)),["["+C.map(function(te,P){return Gu(te,b[P],m)}).join(", ")+", ..., "+A.map(function(te,P){return Gu(te,b[_-Wu+P],m)}).join(", ")+"]"]}return["["+(m==="complex64"?qu(d):Array.from(d)).map(function(te,P){return Gu(te,b[P],m)}).join(", ")+"]"]}var D=v.slice(1),k=g.slice(1),I=g[0]*S,N=[];if(_>_w){for(var B=0;B<Wu;B++){var V=(U=B*I)+I;N.push.apply(N,f(d.slice(U,V),D,m,k,b,!1))}for(N.push("..."),B=_-Wu;B<_;B++)V=(U=B*I)+I,N.push.apply(N,f(d.slice(U,V),D,m,k,b,B===_-1))}else for(B=0;B<_;B++){var U;V=(U=B*I)+I,N.push.apply(N,f(d.slice(U,V),D,m,k,b,B===_-1))}var J=E===2?",":"";for(N[0]="["+N[0]+J,B=1;B<N.length-1;B++)N[B]=" "+N[B]+J;var ee=`,
`;for(B=2;B<E;B++)ee+=`
`;return N[N.length-1]=" "+N[N.length-1]+"]"+(w?"":ee),N}(n,t,e,a,i),c=["Tensor"];return r&&(c.push("  dtype: "+e),c.push("  rank: "+u),c.push("  shape: ["+t+"]"),c.push("  values:")),c.push(l.map(function(f){return"    "+f}).join(`
`)),c.join(`
`)}function Gu(n,t,e){return ms(Array.isArray(n)?parseFloat(n[0].toFixed(fv))+" + "+parseFloat(n[1].toFixed(fv))+"j":Zm(n)?"'"+n+"'":e==="bool"?G_(n):parseFloat(n.toFixed(fv)).toString(),t)}function G_(n){return n===0?"false":"true"}function qu(n){for(var t=[],e=0;e<n.length;e+=2)t.push([n[e],n[e+1]]);return t}var fl=function(){function n(t,e,r){var a=this;if(this.dtype=e,this.shape=t.slice(),this.size=Ce(t),r!=null){var i=r.length;L(i===this.size,function(){return"Length of values '"+i+"' does not match the size inferred by the shape '"+a.size+"'."})}if(e==="complex64")throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=r||Pf(e,this.size),this.strides=Zr(t)}return n.prototype.set=function(t){for(var e=this,r=[],a=1;a<arguments.length;a++)r[a-1]=arguments[a];r.length===0&&(r=[0]),L(r.length===this.rank,function(){return"The number of provided coordinates ("+r.length+") must match the rank ("+e.rank+")"});var i=this.locToIndex(r);this.values[i]=t},n.prototype.get=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];t.length===0&&(t=[0]);for(var r=0,a=0,i=t;a<i.length;a++){var u=i[a];if(u<0||u>=this.shape[r]){var l="Requested out of range element at "+t+".   Buffer shape="+this.shape;throw new Error(l)}r++}for(var c=t[t.length-1],f=0;f<t.length-1;++f)c+=this.strides[f]*t[f];return this.values[c]},n.prototype.locToIndex=function(t){if(this.rank===0)return 0;if(this.rank===1)return t[0];for(var e=t[t.length-1],r=0;r<t.length-1;++r)e+=this.strides[r]*t[r];return e},n.prototype.indexToLoc=function(t){if(this.rank===0)return[];if(this.rank===1)return[t];for(var e=new Array(this.shape.length),r=0;r<e.length-1;++r)e[r]=Math.floor(t/this.strides[r]),t-=e[r]*this.strides[r];return e[e.length-1]=t,e},Object.defineProperty(n.prototype,"rank",{get:function(){return this.shape.length},enumerable:!0,configurable:!0}),n.prototype.toTensor=function(){return qr().makeTensor(this.values,this.shape,this.dtype)},n}(),qr=null,se=null,q_=null,Rt=function(){function n(t,e,r,a){this.kept=!1,this.isDisposedInternal=!1,this.shape=t.slice(),this.dtype=e||"float32",this.size=Ce(t),this.strides=Zr(t),this.dataId=r,this.id=a,this.rankType=this.rank<5?this.rank.toString():"higher"}return n.prototype.flatten=function(){return this.throwIfDisposed(),this.as1D()},n.prototype.asScalar=function(){return this.throwIfDisposed(),L(this.size===1,function(){return"The array must have only 1 element."}),this.reshape([])},n.prototype.as1D=function(){return this.throwIfDisposed(),this.reshape([this.size])},n.prototype.as2D=function(t,e){return this.throwIfDisposed(),this.reshape([t,e])},n.prototype.as3D=function(t,e,r){return this.throwIfDisposed(),this.reshape([t,e,r])},n.prototype.as4D=function(t,e,r,a){return this.throwIfDisposed(),this.reshape([t,e,r,a])},n.prototype.as5D=function(t,e,r,a,i){return this.throwIfDisposed(),this.reshape([t,e,r,a,i])},n.prototype.asType=function(t){return this.throwIfDisposed(),se.cast(this,t)},Object.defineProperty(n.prototype,"rank",{get:function(){return this.shape.length},enumerable:!0,configurable:!0}),n.prototype.buffer=function(){return _e(this,void 0,void 0,function(){var t;return Se(this,function(e){switch(e.label){case 0:return[4,this.data()];case 1:return t=e.sent(),[2,se.buffer(this.shape,this.dtype,t)]}})})},n.prototype.bufferSync=function(){return se.buffer(this.shape,this.dtype,this.dataSync())},n.prototype.array=function(){return _e(this,void 0,void 0,function(){var t;return Se(this,function(e){switch(e.label){case 0:return[4,this.data()];case 1:return t=e.sent(),[2,xw(this.shape,t)]}})})},n.prototype.arraySync=function(){return xw(this.shape,this.dataSync())},n.prototype.data=function(){return _e(this,void 0,void 0,function(){var t,e;return Se(this,function(r){switch(r.label){case 0:return this.throwIfDisposed(),t=qr().read(this.dataId),this.dtype!=="string"?[3,2]:[4,t];case 1:e=r.sent();try{return[2,e.map(function(a){return zf(a)})]}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}r.label=2;case 2:return[2,t]}})})},n.prototype.dataSync=function(){this.throwIfDisposed();var t=qr().readSync(this.dataId);if(this.dtype==="string")try{return t.map(function(e){return zf(e)})}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return t},n.prototype.bytes=function(){return _e(this,void 0,void 0,function(){var t;return Se(this,function(e){switch(e.label){case 0:return this.throwIfDisposed(),[4,qr().read(this.dataId)];case 1:return t=e.sent(),this.dtype==="string"?[2,t]:[2,new Uint8Array(t.buffer)]}})})},n.prototype.dispose=function(){this.isDisposed||(qr().disposeTensor(this),this.isDisposedInternal=!0)},Object.defineProperty(n.prototype,"isDisposed",{get:function(){return this.isDisposedInternal},enumerable:!0,configurable:!0}),n.prototype.throwIfDisposed=function(){if(this.isDisposed)throw new Error("Tensor is disposed.")},n.prototype.toFloat=function(){return this.asType("float32")},n.prototype.toInt=function(){return this.asType("int32")},n.prototype.toBool=function(){return this.asType("bool")},n.prototype.print=function(t){return t===void 0&&(t=!1),se.print(this,t)},n.prototype.reshape=function(t){return this.throwIfDisposed(),se.reshape(this,t)},n.prototype.reshapeAs=function(t){return this.throwIfDisposed(),this.reshape(t.shape)},n.prototype.expandDims=function(t){return t===void 0&&(t=0),se.expandDims(this,t)},n.prototype.cumsum=function(t,e,r){return t===void 0&&(t=0),e===void 0&&(e=!1),r===void 0&&(r=!1),se.cumsum(this,t,e,r)},n.prototype.squeeze=function(t){return this.throwIfDisposed(),se.squeeze(this,t)},n.prototype.clone=function(){return this.throwIfDisposed(),se.clone(this)},n.prototype.oneHot=function(t,e,r){return this.throwIfDisposed(),se.oneHot(this,t,e,r)},n.prototype.toString=function(t){return t===void 0&&(t=!1),mN(this.dataSync(),this.shape,this.dtype,t)},n.prototype.tile=function(t){return this.throwIfDisposed(),se.tile(this,t)},n.prototype.gather=function(t,e){return e===void 0&&(e=0),this.throwIfDisposed(),se.gather(this,t,e)},n.prototype.matMul=function(t,e,r){return e===void 0&&(e=!1),r===void 0&&(r=!1),this.throwIfDisposed(),se.matMul(this,t,e,r)},n.prototype.dot=function(t){return this.throwIfDisposed(),se.dot(this,t)},n.prototype.norm=function(t,e,r){return t===void 0&&(t="euclidean"),e===void 0&&(e=null),r===void 0&&(r=!1),this.throwIfDisposed(),se.norm(this,t,e,r)},n.prototype.slice=function(t,e){return this.throwIfDisposed(),se.slice(this,t,e)},n.prototype.reverse=function(t){return this.throwIfDisposed(),se.reverse(this,t)},n.prototype.concat=function(t,e){return e===void 0&&(e=0),this.throwIfDisposed(),t instanceof n&&(t=[t]),se.concat([this].concat(t),e)},n.prototype.split=function(t,e){return e===void 0&&(e=0),this.throwIfDisposed(),se.split(this,t,e)},n.prototype.stack=function(t,e){return e===void 0&&(e=0),se.stack([this,t],e)},n.prototype.unstack=function(t){return t===void 0&&(t=0),se.unstack(this,t)},n.prototype.pad=function(t,e){return e===void 0&&(e=0),se.pad(this,t,e)},n.prototype.batchNormalization=function(t,e,r,a,i){return r===void 0&&(r=.001),q_("tf.batchNormalization() is going away. Use tf.batchNorm() instead, and note the positional argument change of scale, offset, and varianceEpsilon"),this.batchNorm(t,e,i,a,r)},n.prototype.batchNorm=function(t,e,r,a,i){return i===void 0&&(i=.001),this.throwIfDisposed(),se.batchNorm(this,t,e,r,a,i)},n.prototype.all=function(t,e){return t===void 0&&(t=null),e===void 0&&(e=!1),this.throwIfDisposed(),se.all(this,t,e)},n.prototype.any=function(t,e){return t===void 0&&(t=null),e===void 0&&(e=!1),this.throwIfDisposed(),se.any(this,t,e)},n.prototype.logSumExp=function(t,e){return t===void 0&&(t=null),e===void 0&&(e=!1),this.throwIfDisposed(),se.logSumExp(this,t,e)},n.prototype.sum=function(t,e){return t===void 0&&(t=null),e===void 0&&(e=!1),this.throwIfDisposed(),se.sum(this,t,e)},n.prototype.prod=function(t,e){return t===void 0&&(t=null),e===void 0&&(e=!1),this.throwIfDisposed(),se.prod(this,t,e)},n.prototype.mean=function(t,e){return t===void 0&&(t=null),e===void 0&&(e=!1),this.throwIfDisposed(),se.mean(this,t,e)},n.prototype.min=function(t,e){return t===void 0&&(t=null),e===void 0&&(e=!1),this.throwIfDisposed(),se.min(this,t,e)},n.prototype.max=function(t,e){return t===void 0&&(t=null),e===void 0&&(e=!1),this.throwIfDisposed(),se.max(this,t,e)},n.prototype.argMin=function(t){return t===void 0&&(t=null),this.throwIfDisposed(),se.argMin(this,t)},n.prototype.argMax=function(t){return t===void 0&&(t=null),this.throwIfDisposed(),se.argMax(this,t)},n.prototype.cast=function(t){return this.throwIfDisposed(),se.cast(this,t)},n.prototype.add=function(t){return this.throwIfDisposed(),se.add(this,t)},n.prototype.addStrict=function(t){return this.throwIfDisposed(),se.addStrict(this,t)},n.prototype.atan2=function(t){return this.throwIfDisposed(),se.atan2(this,t)},n.prototype.sub=function(t){return this.throwIfDisposed(),se.sub(this,t)},n.prototype.subStrict=function(t){return this.throwIfDisposed(),se.subStrict(this,t)},n.prototype.pow=function(t){return this.throwIfDisposed(),se.pow(this,t)},n.prototype.powStrict=function(t){return this.throwIfDisposed(),se.powStrict(this,t)},n.prototype.mul=function(t){return this.throwIfDisposed(),se.mul(this,t)},n.prototype.mulStrict=function(t){return this.throwIfDisposed(),se.mulStrict(this,t)},n.prototype.div=function(t){return this.throwIfDisposed(),se.div(this,t)},n.prototype.divNoNan=function(t){return this.throwIfDisposed(),se.divNoNan(this,t)},n.prototype.floorDiv=function(t){return this.throwIfDisposed(),se.floorDiv(this,t)},n.prototype.divStrict=function(t){return this.throwIfDisposed(),se.divStrict(this,t)},n.prototype.minimum=function(t){return this.throwIfDisposed(),se.minimum(this,t)},n.prototype.minimumStrict=function(t){return this.throwIfDisposed(),se.minimumStrict(this,t)},n.prototype.maximum=function(t){return this.throwIfDisposed(),se.maximum(this,t)},n.prototype.maximumStrict=function(t){return this.throwIfDisposed(),se.maximumStrict(this,t)},n.prototype.mod=function(t){return this.throwIfDisposed(),se.mod(this,t)},n.prototype.modStrict=function(t){return this.throwIfDisposed(),se.modStrict(this,t)},n.prototype.squaredDifferenceStrict=function(t){return this.throwIfDisposed(),se.squaredDifferenceStrict(this,t)},n.prototype.transpose=function(t){return this.throwIfDisposed(),se.transpose(this,t)},n.prototype.notEqual=function(t){return this.throwIfDisposed(),se.notEqual(this,t)},n.prototype.notEqualStrict=function(t){return this.throwIfDisposed(),se.notEqualStrict(this,t)},n.prototype.less=function(t){return this.throwIfDisposed(),se.less(this,t)},n.prototype.lessStrict=function(t){return this.throwIfDisposed(),se.lessStrict(this,t)},n.prototype.equal=function(t){return this.throwIfDisposed(),se.equal(this,t)},n.prototype.equalStrict=function(t){return this.throwIfDisposed(),se.equalStrict(this,t)},n.prototype.lessEqual=function(t){return this.throwIfDisposed(),se.lessEqual(this,t)},n.prototype.lessEqualStrict=function(t){return this.throwIfDisposed(),se.lessEqualStrict(this,t)},n.prototype.greater=function(t){return this.throwIfDisposed(),se.greater(this,t)},n.prototype.greaterStrict=function(t){return this.throwIfDisposed(),se.greaterStrict(this,t)},n.prototype.greaterEqual=function(t){return this.throwIfDisposed(),se.greaterEqual(this,t)},n.prototype.greaterEqualStrict=function(t){return this.throwIfDisposed(),se.greaterEqualStrict(this,t)},n.prototype.logicalAnd=function(t){return this.throwIfDisposed(),se.logicalAnd(this,t)},n.prototype.logicalOr=function(t){return this.throwIfDisposed(),se.logicalOr(this,t)},n.prototype.logicalNot=function(){return this.throwIfDisposed(),se.logicalNot(this)},n.prototype.logicalXor=function(t){return this.throwIfDisposed(),se.logicalXor(this,t)},n.prototype.where=function(t,e){return this.throwIfDisposed(),se.where(t,this,e)},n.prototype.neg=function(){return this.throwIfDisposed(),se.neg(this)},n.prototype.ceil=function(){return this.throwIfDisposed(),se.ceil(this)},n.prototype.floor=function(){return this.throwIfDisposed(),se.floor(this)},n.prototype.sign=function(){return this.throwIfDisposed(),se.sign(this)},n.prototype.isNaN=function(){return this.throwIfDisposed(),se.isNaN(this)},n.prototype.isInf=function(){return this.throwIfDisposed(),se.isInf(this)},n.prototype.isFinite=function(){return this.throwIfDisposed(),se.isFinite(this)},n.prototype.exp=function(){return this.throwIfDisposed(),se.exp(this)},n.prototype.expm1=function(){return this.throwIfDisposed(),se.expm1(this)},n.prototype.log=function(){return this.throwIfDisposed(),se.log(this)},n.prototype.log1p=function(){return this.throwIfDisposed(),se.log1p(this)},n.prototype.sqrt=function(){return this.throwIfDisposed(),se.sqrt(this)},n.prototype.rsqrt=function(){return this.throwIfDisposed(),se.rsqrt(this)},n.prototype.square=function(){return this.throwIfDisposed(),se.square(this)},n.prototype.reciprocal=function(){return this.throwIfDisposed(),se.reciprocal(this)},n.prototype.abs=function(){return this.throwIfDisposed(),se.abs(this)},n.prototype.clipByValue=function(t,e){return this.throwIfDisposed(),se.clipByValue(this,t,e)},n.prototype.relu=function(){return this.throwIfDisposed(),se.relu(this)},n.prototype.relu6=function(){return this.throwIfDisposed(),se.relu6(this)},n.prototype.elu=function(){return this.throwIfDisposed(),se.elu(this)},n.prototype.selu=function(){return this.throwIfDisposed(),se.selu(this)},n.prototype.leakyRelu=function(t){return t===void 0&&(t=.2),this.throwIfDisposed(),se.leakyRelu(this,t)},n.prototype.prelu=function(t){return this.throwIfDisposed(),se.prelu(this,t)},n.prototype.sigmoid=function(){return this.throwIfDisposed(),se.sigmoid(this)},n.prototype.logSigmoid=function(){return this.throwIfDisposed(),se.logSigmoid(this)},n.prototype.softplus=function(){return this.throwIfDisposed(),se.softplus(this)},n.prototype.zerosLike=function(){return this.throwIfDisposed(),se.zerosLike(this)},n.prototype.onesLike=function(){return this.throwIfDisposed(),se.onesLike(this)},n.prototype.sin=function(){return this.throwIfDisposed(),se.sin(this)},n.prototype.cos=function(){return this.throwIfDisposed(),se.cos(this)},n.prototype.tan=function(){return this.throwIfDisposed(),se.tan(this)},n.prototype.asin=function(){return this.throwIfDisposed(),se.asin(this)},n.prototype.acos=function(){return this.throwIfDisposed(),se.acos(this)},n.prototype.atan=function(){return this.throwIfDisposed(),se.atan(this)},n.prototype.sinh=function(){return this.throwIfDisposed(),se.sinh(this)},n.prototype.cosh=function(){return this.throwIfDisposed(),se.cosh(this)},n.prototype.tanh=function(){return this.throwIfDisposed(),se.tanh(this)},n.prototype.asinh=function(){return this.throwIfDisposed(),se.asinh(this)},n.prototype.acosh=function(){return this.throwIfDisposed(),se.acosh(this)},n.prototype.atanh=function(){return this.throwIfDisposed(),se.atanh(this)},n.prototype.erf=function(){return this.throwIfDisposed(),se.erf(this)},n.prototype.round=function(){return this.throwIfDisposed(),se.round(this)},n.prototype.step=function(t){return t===void 0&&(t=0),this.throwIfDisposed(),se.step(this,t)},n.prototype.softmax=function(t){return t===void 0&&(t=-1),this.throwIfDisposed(),se.softmax(this,t)},n.prototype.logSoftmax=function(t){return t===void 0&&(t=-1),this.throwIfDisposed(),se.logSoftmax(this,t)},n.prototype.resizeBilinear=function(t,e){return e===void 0&&(e=!1),this.throwIfDisposed(),se.image.resizeBilinear(this,t,e)},n.prototype.resizeNearestNeighbor=function(t,e){return e===void 0&&(e=!1),this.throwIfDisposed(),se.image.resizeNearestNeighbor(this,t,e)},n.prototype.conv1d=function(t,e,r,a,i,u){return a===void 0&&(a="NWC"),i===void 0&&(i=1),this.throwIfDisposed(),se.conv1d(this,t,e,r,a,i,u)},n.prototype.conv2d=function(t,e,r,a,i,u){return a===void 0&&(a="NHWC"),i===void 0&&(i=[1,1]),this.throwIfDisposed(),se.conv2d(this,t,e,r,a,i,u)},n.prototype.conv2dTranspose=function(t,e,r,a,i){return this.throwIfDisposed(),se.conv2dTranspose(this,t,e,r,a,i)},n.prototype.depthwiseConv2D=function(t,e,r,a,i,u){return a===void 0&&(a="NHWC"),i===void 0&&(i=[1,1]),this.throwIfDisposed(),se.depthwiseConv2d(this,t,e,r,a,i,u)},n.prototype.separableConv2d=function(t,e,r,a,i,u){return i===void 0&&(i=[1,1]),u===void 0&&(u="NHWC"),this.throwIfDisposed(),se.separableConv2d(this,t,e,r,a,i,u)},n.prototype.avgPool=function(t,e,r,a){return this.throwIfDisposed(),se.avgPool(this,t,e,r,a)},n.prototype.maxPool=function(t,e,r,a){return this.throwIfDisposed(),se.maxPool(this,t,e,r,a)},n.prototype.localResponseNormalization=function(t,e,r,a){return t===void 0&&(t=5),e===void 0&&(e=1),r===void 0&&(r=1),a===void 0&&(a=.5),se.localResponseNormalization(this,t,e,r,a)},n.prototype.pool=function(t,e,r,a,i){return this.throwIfDisposed(),se.pool(this,t,e,r,a,i)},n.prototype.variable=function(t,e,r){return t===void 0&&(t=!0),this.throwIfDisposed(),qr().makeVariable(this,t,e,r)},n.prototype.unsortedSegmentSum=function(t,e){return this.throwIfDisposed(),se.unsortedSegmentSum(this,t,e)},n.prototype.batchToSpaceND=function(t,e){return this.throwIfDisposed(),se.batchToSpaceND(this,t,e)},n.prototype.spaceToBatchND=function(t,e){return this.throwIfDisposed(),se.spaceToBatchND(this,t,e)},n.prototype.topk=function(t,e){return t===void 0&&(t=1),e===void 0&&(e=!0),this.throwIfDisposed(),se.topk(this,t,e)},n.prototype.stridedSlice=function(t,e,r,a,i,u,l,c){return a===void 0&&(a=0),i===void 0&&(i=0),u===void 0&&(u=0),l===void 0&&(l=0),c===void 0&&(c=0),this.throwIfDisposed(),se.stridedSlice(this,t,e,r,a,i,u,l,c)},n.prototype.depthToSpace=function(t,e){return this.throwIfDisposed(),se.depthToSpace(this,t,e)},n.prototype.fft=function(){return this.throwIfDisposed(),se.spectral.fft(this)},n.prototype.ifft=function(){return this.throwIfDisposed(),se.spectral.ifft(this)},n.prototype.rfft=function(){return this.throwIfDisposed(),se.spectral.rfft(this)},n.prototype.irfft=function(){return this.throwIfDisposed(),se.spectral.irfft(this)},n}();Object.defineProperty(Rt,Symbol.hasInstance,{value:function(n){return!!n&&n.dataId!=null&&n.shape!=null&&n.dtype!=null}});var Sw,mm,gm,ym,bm,Is=function(n){function t(e,r,a,i){var u=n.call(this,e.shape,e.dtype,e.dataId,i)||this;return u.trainable=r,u.name=a,u}return Mr(t,n),t.prototype.assign=function(e){if(e.dtype!==this.dtype)throw new Error("dtype of the new value ("+e.dtype+") and previous value ("+this.dtype+") must match");if(!un(e.shape,this.shape))throw new Error("shape of the new value ("+e.shape+") and previous value ("+this.shape+") must match");qr().disposeTensor(this),this.dataId=e.dataId,qr().incRef(this,null)},t.prototype.dispose=function(){qr().disposeVariable(this),this.isDisposedInternal=!0},t}(Rt);Object.defineProperty(Is,Symbol.hasInstance,{value:function(n){return n instanceof Rt&&n.assign!=null&&n.assign instanceof Function}}),function(n){n.R0="R0",n.R1="R1",n.R2="R2",n.R3="R3",n.R4="R4",n.R5="R5",n.R6="R6"}(Sw||(Sw={})),function(n){n.float32="float32",n.int32="int32",n.bool="int32",n.complex64="complex64"}(mm||(mm={})),function(n){n.float32="float32",n.int32="int32",n.bool="bool",n.complex64="complex64"}(gm||(gm={})),function(n){n.float32="float32",n.int32="float32",n.bool="float32",n.complex64="complex64"}(ym||(ym={})),function(n){n.float32="complex64",n.int32="complex64",n.bool="complex64",n.complex64="complex64"}(bm||(bm={}));var gN={float32:ym,int32:mm,bool:gm,complex64:bm};function vn(n,t){if(n==="string"||t==="string"){if(n==="string"&&t==="string")return"string";throw new Error("Can not upcast "+n+" with "+t)}return gN[n][t]}function hv(n){return vn(n,"int32")}function Dt(n,t){if(n.dtype===t.dtype)return[n,t];var e=vn(n.dtype,t.dtype);return[n.cast(e),t.cast(e)]}function yN(n,t){L(n.dtype===t.dtype,function(){return"The dtypes of the first("+n.dtype+") and second("+t.dtype+") input must match"})}function K_(n){var t=[];return function e(r,a,i){if(r!=null){if(r instanceof Rt)return void a.push(r);if(u=r,!(!Array.isArray(u)&&typeof u!="object")){var u,l=r;for(var c in l){var f=l[c];i.has(f)||(i.add(f),e(f,a,i))}}}}(n,t,new Set),t}var dv,Ew=function(){function n(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null}}return n.prototype.dispose=function(){for(var t in this.registeredVariables)this.registeredVariables[t].dispose()},n}(),bN=function(){function n(t){this.ENV=t,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new Ew}return n.prototype.ready=function(){return _e(this,void 0,void 0,function(){var t,e,r;return Se(this,function(a){switch(a.label){case 0:if(this.pendingBackendInit!=null)return[2,this.pendingBackendInit.then(function(){})];if(this.backendInstance!=null)return[2];t=this.getSortedBackends(),e=0,a.label=1;case 1:return e<t.length?(r=t[e],[4,this.initializeBackend(r).success]):[3,5];case 2:return a.sent()?[4,this.setBackend(r)]:[3,4];case 3:return a.sent(),[2];case 4:return e++,[3,1];case 5:throw new Error("Could not initialize any backends, all backend initializations failed.")}})})},Object.defineProperty(n.prototype,"backend",{get:function(){if(this.pendingBackendInit!=null)throw new Error("Backend '"+this.backendName+"' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods");if(this.backendInstance==null){var t=this.initializeBackendsAndReturnBest(),e=t.name;if(t.asyncInit)throw new Error("The highest priority backend '"+e+"' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods");this.setBackend(e)}return this.backendInstance},enumerable:!0,configurable:!0}),n.prototype.backendNames=function(){return Object.keys(this.registryFactory)},n.prototype.findBackend=function(t){return!(t in this.registry)&&(!(t in this.registryFactory)||this.initializeBackend(t).asyncInit)?null:this.registry[t]},n.prototype.findBackendFactory=function(t){return t in this.registryFactory?this.registryFactory[t].factory:null},n.prototype.registerBackend=function(t,e,r){return r===void 0&&(r=1),t in this.registryFactory?(console.warn(t+" backend was already registered. Reusing existing backend factory."),!1):(this.registryFactory[t]={factory:e,priority:r},!0)},n.prototype.setBackend=function(t){return _e(this,void 0,void 0,function(){var e,r,a;return Se(this,function(i){switch(i.label){case 0:if(this.registryFactory[t]==null)throw new Error("Backend name '"+t+"' not found in registry");return this.backendName=t,this.registry[t]!=null?[3,4]:(this.backendInstance=null,e=this.initializeBackend(t),r=e.success,e.asyncInit?[4,r]:[3,2]);case 1:return a=i.sent(),[3,3];case 2:a=r,i.label=3;case 3:if(!a)return[2,!1];i.label=4;case 4:return this.backendInstance=this.registry[t],this.setupRegisteredKernels(),this.profiler=new pN(this.backendInstance),[2,!0]}})})},n.prototype.setupRegisteredKernels=function(){var t=this;yw(this.backendName).forEach(function(e){e.setupFunc!=null&&e.setupFunc(t.backendInstance)})},n.prototype.disposeRegisteredKernels=function(t){var e=this;yw(t).forEach(function(r){r.disposeFunc!=null&&r.disposeFunc(e.registry[t])})},n.prototype.initializeBackend=function(t){var e=this,r=this.registryFactory[t];if(r==null)throw new Error("Cannot initialize backend "+t+", no registration found.");try{var a=r.factory();if(Promise.resolve(a)===a){var i=++this.pendingBackendInitId,u=a.then(function(l){return!(i<e.pendingBackendInitId)&&(e.registry[t]=l,e.pendingBackendInit=null,!0)}).catch(function(l){return!(i<e.pendingBackendInitId)&&(e.pendingBackendInit=null,console.warn("Initialization of backend "+t+" failed"),console.warn(l.stack||l.message),!1)});return this.pendingBackendInit=u,{success:u,asyncInit:!0}}return this.registry[t]=a,{success:!0,asyncInit:!1}}catch(l){return console.warn("Initialization of backend "+t+" failed"),console.warn(l.stack||l.message),{success:!1,asyncInit:!1}}},n.prototype.removeBackend=function(t){if(!(t in this.registryFactory))throw new Error(t+" backend not found in registry");this.backendName===t&&this.pendingBackendInit!=null&&this.pendingBackendInitId++,t in this.registry&&(this.disposeRegisteredKernels(t),this.registry[t].dispose(),delete this.registry[t]),delete this.registryFactory[t],this.backendName===t&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)},n.prototype.getSortedBackends=function(){var t=this;if(Object.keys(this.registryFactory).length===0)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort(function(e,r){return t.registryFactory[r].priority-t.registryFactory[e].priority})},n.prototype.initializeBackendsAndReturnBest=function(){for(var t=this.getSortedBackends(),e=0;e<t.length;e++){var r=t[e],a=this.initializeBackend(r),i=a.success,u=a.asyncInit;if(u||i)return{name:r,asyncInit:u}}throw new Error("Could not initialize any backends, all backend initializations failed.")},n.prototype.moveData=function(t,e){var r=this.state.tensorInfo.get(e),a=r.backend,i=this.readSync(e);a.disposeData(e),r.backend=t,t.move(e,i,r.shape,r.dtype),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++},n.prototype.tidy=function(t,e){var r,a=this,i=null;if(e==null){if(typeof t!="function")throw new Error("Please provide a function to tidy()");e=t}else{if(typeof t!="string"&&!(t instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if(typeof e!="function")throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");i=t}return this.scopedRun(function(){return a.startScope(i)},function(){return a.endScope(r)},function(){return(r=e())instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),r})},n.prototype.scopedRun=function(t,e,r){t();try{var a=r();return e(),a}catch(i){throw e(),i}},n.prototype.nextTensorId=function(){return n.nextTensorId++},n.prototype.nextVariableId=function(){return n.nextVariableId++},n.prototype.clone=function(t){var e=this.makeTensorFromDataId(t.dataId,t.shape,t.dtype),r={x:t};return this.addTapeNode(this.state.activeScope.name,r,[e],function(a){return{x:function(){return a.toFloat()}}},[]),e},n.prototype.runKernel=function(t,e,r,a,i){return this.runKernelFunc(null,e,null,t,r,a,i)},n.prototype.shouldCheckForMemLeaks=function(){return this.ENV.getBool("IS_TEST")},n.prototype.checkKernelForMemLeak=function(t,e,r){var a=this.backend.numDataIds(),i=0;r.forEach(function(c){i+=c.dtype==="complex64"?3:1});var u=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],l=a-e-i-u;if(l>0)throw new Error("Backend '"+this.backendName+"' has an internal memory leak ("+l+" data ids) after running '"+t+"'")},n.prototype.runKernelFunc=function(t,e,r,a,i,u,l){var c,f=this;u===void 0&&(u=[]),l===void 0&&(l=[]);var d=[],v=this.isTapeOn();a==null&&(a=this.state.activeScope!=null?this.state.activeScope.name:"");var m,g=function(E){v&&(d=E.map(function(R){return f.keep(f.clone(R))}))},b=this.state.numBytes,w=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0);var S,_=L_(a,this.backendName);return m=_!=null?function(){var E=f.backend.numDataIds();S=_.kernelFunc({inputs:e,attrs:i,backend:f.backend});var R=Array.isArray(S)?S:[S];f.shouldCheckForMemLeaks()&&f.checkKernelForMemLeak(a,E,R);var C=R.map(function(D){var k=D.dataId,I=D.shape,N=D.dtype;return f.makeTensorFromDataId(k,I,N)}),A=C.filter(function(D,k){return l[k]});return g((u||[]).slice().concat(A)),C}:function(){var E=f.backend.numDataIds();S=f.tidy(function(){return t(f.backend,g)});var R=Array.isArray(S)?S:[S];return f.shouldCheckForMemLeaks()&&f.checkKernelForMemLeak(a,E,R),R},this.scopedRun(function(){return f.state.kernelDepth++},function(){return f.state.kernelDepth--},function(){c=f.ENV.getBool("DEBUG")?f.profiler.profileKernel(a,e,function(){return m()}):m()}),v&&this.addTapeNode(a,e,c,r,d),this.state.profiling&&this.state.activeProfile.kernels.push({name:a,bytesAdded:this.state.numBytes-b,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-w,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(e).map(function(E){return e[E].shape}),outputShapes:c.map(function(E){return E.shape})}),Array.isArray(S)?c:c[0]},n.prototype.makeTensor=function(t,e,r,a){if(t==null)throw new Error("Values passed to engine.makeTensor() are null");r=r||"float32",a=a||this.backend;var i=t;r==="string"&&Zm(t[0])&&(i=t.map(function(d){return hN(d)}));var u=a.write(i,e,r),l=new Rt(e,r,u,this.nextTensorId());if(this.incRef(l,a),r==="string"){var c=this.state.tensorInfo.get(u),f=lN(i);this.state.numBytes+=f-c.bytes,c.bytes=f}return l},n.prototype.makeTensorFromDataId=function(t,e,r,a){var i=new Rt(e,r=r||"float32",t,this.nextTensorId());return this.incRef(i,a),i},n.prototype.makeVariable=function(t,e,r,a){e===void 0&&(e=!0),r=r||this.nextVariableId().toString(),a!=null&&a!==t.dtype&&(t=t.asType(a));var i=new Is(t,e,r,this.nextTensorId());if(this.state.registeredVariables[i.name]!=null)throw new Error("Variable with name "+i.name+" was already registered");return this.state.registeredVariables[i.name]=i,this.incRef(i,this.backend),i},n.prototype.incRef=function(t,e){var r=this.state.tensorInfo.has(t.dataId)?this.state.tensorInfo.get(t.dataId).refCount:0;if(this.state.numTensors++,t.dtype==="string"&&this.state.numStringTensors++,r===0){this.state.numDataBuffers++;var a=0;t.dtype!=="complex64"&&t.dtype!=="string"&&(a=t.size*V_(t.dtype)),this.state.tensorInfo.set(t.dataId,{backend:e||this.backend,dtype:t.dtype,shape:t.shape,bytes:a,refCount:0}),this.state.numBytes+=a}this.state.tensorInfo.get(t.dataId).refCount++,t instanceof Is||this.track(t)},n.prototype.disposeTensor=function(t){if(this.state.tensorInfo.has(t.dataId)){this.state.numTensors--,t.dtype==="string"&&this.state.numStringTensors--;var e=this.state.tensorInfo.get(t.dataId);e.refCount<=1?(t.dtype!=="complex64"&&(this.state.numBytes-=e.bytes),this.state.numDataBuffers--,e.backend.disposeData(t.dataId),this.state.tensorInfo.delete(t.dataId)):this.state.tensorInfo.get(t.dataId).refCount--}},n.prototype.disposeVariables=function(){for(var t in this.state.registeredVariables){var e=this.state.registeredVariables[t];this.disposeVariable(e)}},n.prototype.disposeVariable=function(t){this.disposeTensor(t),this.state.registeredVariables[t.name]!=null&&delete this.state.registeredVariables[t.name]},n.prototype.memory=function(){var t=this.backend.memory();return t.numTensors=this.state.numTensors,t.numDataBuffers=this.state.numDataBuffers,t.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(t.unreliable=!0,t.reasons==null&&(t.reasons=[]),t.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),t},n.prototype.profile=function(t){return _e(this,void 0,void 0,function(){var e,r;return Se(this,function(a){return this.state.profiling=!0,e=this.state.numBytes,r=this.state.numTensors,this.state.activeProfile.kernels=[],this.state.activeProfile.result=t(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max.apply(Math,this.state.activeProfile.kernels.map(function(i){return i.totalBytesSnapshot})),this.state.activeProfile.newBytes=this.state.numBytes-e,this.state.activeProfile.newTensors=this.state.numTensors-r,[2,this.state.activeProfile]})})},n.prototype.isTapeOn=function(){return this.state.gradientDepth>0&&this.state.kernelDepth===0},n.prototype.addTapeNode=function(t,e,r,a,i){var u=this,l={id:this.state.nextTapeNodeId++,kernelName:t,inputs:e,outputs:r,saved:i},c=tN(t);c!=null&&(a=c.gradFunc),a!=null&&(l.gradient=function(f){return f=f.map(function(d,v){if(d==null){var m=r[v],g=El(m.size,m.dtype);return u.makeTensor(g,m.shape,m.dtype)}return d}),a(f.length>1?f:f[0],i)}),this.state.activeTape.push(l)},n.prototype.keep=function(t){return t.kept=!0,t},n.prototype.startTape=function(){this.state.gradientDepth===0&&(this.state.activeTape=[]),this.state.gradientDepth++},n.prototype.endTape=function(){this.state.gradientDepth--},n.prototype.startScope=function(t){var e={track:[],name:"unnamed scope",id:this.state.nextScopeId++};t&&(e.name=t),this.state.scopeStack.push(e),this.state.activeScope=e},n.prototype.endScope=function(t){for(var e=this,r=K_(t),a=new Set(r.map(function(c){return c.id})),i=0;i<this.state.activeScope.track.length;i++){var u=this.state.activeScope.track[i];u.kept||a.has(u.id)||u.dispose()}var l=this.state.scopeStack.pop();this.state.activeScope=this.state.scopeStack.length===0?null:this.state.scopeStack[this.state.scopeStack.length-1],r.forEach(function(c){c.kept||c.scopeId!==l.id||e.track(c)})},n.prototype.gradients=function(t,e,r,a){var i=this;if(a===void 0&&(a=!1),L(e.length>0,function(){return"gradients() received an empty list of xs."}),r!=null&&r.dtype!=="float32")throw new Error("dy must have 'float32' dtype, but has '"+r.dtype+"'");var u=this.scopedRun(function(){return i.startTape()},function(){return i.endTape()},function(){return i.tidy("forward",t)});L(u instanceof Rt,function(){return"The result y returned by f() must be a tensor."});var l=function(c,f,d){for(var v={},m={},g=0;g<f.length;g++)v[f[g].id]=!0;for(g=0;g<c.length;g++){var b=(D=c[g]).inputs;for(var w in b){for(var S=b[w],_=!1,E=0;E<f.length;E++)if(v[S.id]){D.outputs.forEach(function(B){return v[B.id]=!0}),_=!0,m[D.id]=!0;break}if(_)break}}var R={};R[d.id]=!0;var C={};for(g=c.length-1;g>=0;g--)for(b=(D=c[g]).inputs,E=0;E<D.outputs.length;E++)if(R[D.outputs[E].id]){for(var w in b)R[b[w].id]=!0,C[D.id]=!0;break}var A=[];for(g=0;g<c.length;g++){var D;if(m[(D=c[g]).id]&&C[D.id]){var k={};for(var w in D.inputs){var I=D.inputs[w];v[I.id]&&(k[w]=I)}var N=Object.assign({},D);N.inputs=k,N.outputs=D.outputs,A.push(N)}}return A}(this.state.activeTape,e,u);if(!a&&l.length===0&&e.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",function(){var c,f,d={};d[u.id]=r??(c=u.shape,f=j_(Ce(c),"float32"),q.makeTensor(f,c,"float32")),function(m,g,b){for(var w=function(_){var E=g[_],R=[];if(E.outputs.forEach(function(k){var I=m[k.id];I!=null?R.push(I):R.push(null)}),E.gradient==null)throw new Error("Cannot compute gradient: gradient function not found for "+E.kernelName+".");var C=E.gradient(R),A=function(k){if(!(k in C))throw new Error("Cannot backprop through input "+k+". Available gradients found: "+Object.keys(C)+".");var I=b(function(){return C[k]()});if(I.dtype!=="float32")throw new Error("Error in gradient for op "+E.kernelName+". The gradient of input "+k+" must have 'float32' dtype, but has '"+I.dtype+"'");var N=E.inputs[k];if(!un(I.shape,N.shape))throw new Error("Error in gradient for op "+E.kernelName+". The gradient of input '"+k+"' has shape '"+I.shape+"', which does not match the shape of the input '"+N.shape+"'");if(m[N.id]==null)m[N.id]=I;else{var B=m[N.id];m[N.id]=B.add(I),B.dispose()}};for(var D in E.inputs)A(D)},S=g.length-1;S>=0;S--)w(S)}(d,l,function(m){return i.tidy(m)});var v=e.map(function(m){return d[m.id]});return i.state.gradientDepth===0&&(i.state.activeTape.forEach(function(m){for(var g=0,b=m.saved;g<b.length;g++)b[g].dispose()}),i.state.activeTape=null),{value:u,grads:v}})},n.prototype.customGrad=function(t){var e=this;return L(pm(t),function(){return"The f passed in customGrad(f) must be a function."}),function(){for(var r,a=[],i=0;i<arguments.length;i++)a[i]=arguments[i];L(a.every(function(l){return l instanceof Rt}),function(){return"The args passed in customGrad(f)(x1, x2,...) must all be tensors"});var u={};return a.forEach(function(l,c){u[c]=l}),e.runKernelFunc(function(l,c){return L((r=t.apply(void 0,a.concat([c]))).value instanceof Rt,function(){return"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"}),L(pm(r.gradFunc),function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."}),r.value},u,function(l,c){var f=r.gradFunc(l,c),d=Array.isArray(f)?f:[f];L(d.length===a.length,function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."}),L(d.every(function(m){return m instanceof Rt}),function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors."});var v={};return d.forEach(function(m,g){v[g]=function(){return m}}),v})}},n.prototype.readSync=function(t){return this.state.tensorInfo.get(t).backend.readSync(t)},n.prototype.read=function(t){return this.state.tensorInfo.get(t).backend.read(t)},n.prototype.time=function(t){return _e(this,void 0,void 0,function(){var e,r;return Se(this,function(a){switch(a.label){case 0:return e=Gr(),[4,this.backend.time(t)];case 1:return(r=a.sent()).wallMs=Gr()-e,[2,r]}})})},n.prototype.track=function(t){return this.state.activeScope!=null&&(t.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(t)),t},Object.defineProperty(n.prototype,"registeredVariables",{get:function(){return this.state.registeredVariables},enumerable:!0,configurable:!0}),n.prototype.reset=function(){for(var t in this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new Ew,this.registry)this.disposeRegisteredKernels(t),this.registry[t].dispose(),delete this.registry[t];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null},n.nextTensorId=0,n.nextVariableId=0,n}(),q=function(){var n=function(){if(dv==null){var e=void 0;if(typeof window<"u")e=window;else if(typeof global<"u")e=global;else if(typeof process<"u")e=process;else{if(typeof self>"u")throw new Error("Could not find a global object");e=self}dv=e}return dv}();if(n._tfengine==null){var t=new JO(n);n._tfengine=new bN(t)}return function(e){B_=e}(n._tfengine.ENV),qr=function(){return n._tfengine},n._tfengine}();function X_(){return typeof window<"u"&&window.document!=null||typeof WorkerGlobalScope<"u"}var Sa=ue();Sa.registerFlag("DEBUG",function(){return!1},function(n){n&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")}),Sa.registerFlag("IS_BROWSER",function(){return X_()}),Sa.registerFlag("IS_NODE",function(){return typeof process<"u"&&process.versions!==void 0&&process.versions.node!==void 0}),Sa.registerFlag("IS_CHROME",function(){return typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)}),Sa.registerFlag("PROD",function(){return!1}),Sa.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",function(){return Sa.getBool("DEBUG")}),Sa.registerFlag("DEPRECATION_WARNINGS_ENABLED",function(){return!0}),Sa.registerFlag("IS_TEST",function(){return!1});var hl,Zn,Qn,Qi={},pv={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function xN(n,t){Qi[n]=t}function ra(n){n in Qi||(Qi[n]=function(e){if(e!==1&&e!==2)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");var r=function(a){if(typeof OffscreenCanvas<"u"&&a===2)return new OffscreenCanvas(300,150);if(typeof document<"u")return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}(e);return r.addEventListener("webglcontextlost",function(a){a.preventDefault(),delete Qi[e]},!1),e===1?r.getContext("webgl",pv)||r.getContext("experimental-webgl",pv):r.getContext("webgl2",pv)}(n));var t=Qi[n];return t.isContextLost()?(delete Qi[n],ra(n)):(t.disable(t.DEPTH_TEST),t.disable(t.STENCIL_TEST),t.disable(t.BLEND),t.disable(t.DITHER),t.disable(t.POLYGON_OFFSET_FILL),t.disable(t.SAMPLE_COVERAGE),t.enable(t.SCISSOR_TEST),t.enable(t.CULL_FACE),t.cullFace(t.BACK),Qi[n])}function ph(n,t){return[t,n]}function Ju(n){var t=Ce(n);return dm(Math.ceil(t/4))}function Cl(n,t){return[Math.max(1,Math.ceil(t/2)),Math.max(1,Math.ceil(n/2))]}function Jm(n,t){var e,r,a,i,u,l,c,f,d,v=n;return ue().getNumber("WEBGL_VERSION")===2?(e=v.R32F,r=v.R16F,a=v.RGBA16F,i=v.RGBA32F,u=v.RED,l=4,c=1,f=v.HALF_FLOAT,d=v.FLOAT):(e=n.RGBA,r=n.RGBA,a=n.RGBA,i=v.RGBA,u=n.RGBA,l=4,c=4,f=t!=null?t.HALF_FLOAT_OES:null,d=n.FLOAT),{internalFormatFloat:e,internalFormatHalfFloat:r,internalFormatPackedHalfFloat:a,internalFormatPackedFloat:i,textureFormatFloat:u,downloadTextureFormat:n.RGBA,downloadUnpackNumChannels:l,defaultNumChannels:c,textureTypeHalfFloat:f,textureTypeFloat:d}}function Ae(n,t,e){var r=e();return t&&function(a){var i=a.getError();if(i!==a.NO_ERROR)throw new Error("WebGL Error: "+EN(a,i))}(n),r}(function(n){n[n.DENSE=0]="DENSE",n[n.SHARED_BATCH=1]="SHARED_BATCH"})(hl||(hl={})),function(n){n[n.RENDER=0]="RENDER",n[n.UPLOAD=1]="UPLOAD",n[n.PIXELS=2]="PIXELS",n[n.DOWNLOAD=3]="DOWNLOAD"}(Zn||(Zn={})),function(n){n[n.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",n[n.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",n[n.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",n[n.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",n[n.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"}(Qn||(Qn={}));var wN=596e-10,_N=65504;function SN(n){return!!(ue().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||n===0||wN<Math.abs(n)&&Math.abs(n)<_N)}function EN(n,t){switch(t){case n.NO_ERROR:return"NO_ERROR";case n.INVALID_ENUM:return"INVALID_ENUM";case n.INVALID_VALUE:return"INVALID_VALUE";case n.INVALID_OPERATION:return"INVALID_OPERATION";case n.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case n.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case n.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return"Unknown error code "+t}}function Qc(n,t,e){return Na(n,t,function(){return n.getExtension(e)},'Extension "'+e+'" not supported on this browser.')}function CN(n,t,e){var r=Na(n,t,function(){return n.createShader(n.VERTEX_SHADER)},"Unable to create vertex WebGLShader.");if(Ae(n,t,function(){return n.shaderSource(r,e)}),Ae(n,t,function(){return n.compileShader(r)}),n.getShaderParameter(r,n.COMPILE_STATUS)===!1)throw console.log(n.getShaderInfoLog(r)),new Error("Failed to compile vertex shader.");return r}function RN(n,t,e){var r=Na(n,t,function(){return n.createShader(n.FRAGMENT_SHADER)},"Unable to create fragment WebGLShader.");if(Ae(n,t,function(){return n.shaderSource(r,e)}),Ae(n,t,function(){return n.compileShader(r)}),n.getShaderParameter(r,n.COMPILE_STATUS)===!1)throw function(a,i){var u=AN.exec(i);if(u==null)return console.log("Couldn't parse line number in error: "+i),void console.log(a);for(var l=+u[1],c=a.split(`
`),f=c.length.toString().length+2,d=c.map(function(S,_){return ms((_+1).toString(),f)+S}),v=0,m=0;m<d.length;m++)v=Math.max(d[m].length,v);var g=d.slice(0,l-1),b=d.slice(l-1,l),w=d.slice(l);console.log(g.join(`
`)),console.log(i.split(`
`)[0]),console.log("%c "+ms(b[0],v),"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(w.join(`
`))}(e,n.getShaderInfoLog(r)),new Error("Failed to compile fragment shader.");return r}var vv,mv,AN=/ERROR: [0-9]+:([0-9]+):/g;function TN(n,t){return Na(n,t,function(){return n.createProgram()},"Unable to create WebGLProgram.")}function DN(n,t,e){if(Ae(n,t,function(){return n.linkProgram(e)}),n.getProgramParameter(e,n.LINK_STATUS)===!1)throw console.log(n.getProgramInfoLog(e)),new Error("Failed to link vertex and fragment shaders.")}function gv(n,t,e){if(Ae(n,t,function(){return n.validateProgram(e)}),n.getProgramParameter(e,n.VALIDATE_STATUS)===!1)throw console.log(n.getProgramInfoLog(e)),new Error("Shader program validation failed.")}function kN(n,t,e){var r=Na(n,t,function(){return n.createBuffer()},"Unable to create WebGLBuffer");return Ae(n,t,function(){return n.bindBuffer(n.ARRAY_BUFFER,r)}),Ae(n,t,function(){return n.bufferData(n.ARRAY_BUFFER,e,n.STATIC_DRAW)}),r}function ON(n,t,e){var r=Na(n,t,function(){return n.createBuffer()},"Unable to create WebGLBuffer");return Ae(n,t,function(){return n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,r)}),Ae(n,t,function(){return n.bufferData(n.ELEMENT_ARRAY_BUFFER,e,n.STATIC_DRAW)}),r}function NN(n,t){return Na(n,t,function(){return n.createTexture()},"Unable to create WebGLTexture.")}function MN(n,t){var e=ue().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(n<=0||t<=0){var r="["+n+"x"+t+"]";throw new Error("Requested texture size "+r+" is invalid.")}if(n>e||t>e)throw r="["+n+"x"+t+"]",new Error("Requested texture size "+r+" greater than WebGL maximum on this browser / GPU "+("["+e+"x"+e+"]")+".")}function IN(n,t){return Na(n,t,function(){return n.createFramebuffer()},"Unable to create WebGLFramebuffer.")}function Cw(n,t,e,r,a,i,u,l){var c=n.getAttribLocation(e,r);return c!==-1&&(Ae(n,t,function(){return n.bindBuffer(n.ARRAY_BUFFER,a)}),Ae(n,t,function(){return n.vertexAttribPointer(c,i,n.FLOAT,!1,u,l)}),Ae(n,t,function(){return n.enableVertexAttribArray(c)}),!0)}function FN(n,t,e,r){UN(n,r),Ae(n,t,function(){return n.activeTexture(n.TEXTURE0+r)}),Ae(n,t,function(){return n.bindTexture(n.TEXTURE_2D,e)})}function BN(n,t,e,r){return Na(n,t,function(){return n.getUniformLocation(e,r)},'uniform "'+r+'" not present in program.')}function LN(n,t,e){return n.getUniformLocation(t,e)}function PN(n,t,e,r,a,i){Ae(n,t,function(){return FN(n,t,r,i)}),Ae(n,t,function(){return n.uniform1i(a,i)})}function yv(n,t,e,r){Ae(n,t,function(){return n.bindFramebuffer(n.FRAMEBUFFER,r)}),Ae(n,t,function(){return n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,e,0)})}function Rw(n,t,e){Ae(n,t,function(){return n.bindFramebuffer(n.FRAMEBUFFER,e)}),Ae(n,t,function(){return n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,null,0)})}function Zc(n){var t=n.checkFramebufferStatus(n.FRAMEBUFFER);if(t!==n.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+zN(n,t))}function zN(n,t){switch(t){case n.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case n.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case n.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case n.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return"unknown error "+t}}function Na(n,t,e,r){var a=Ae(n,t,function(){return e()});if(a==null)throw new Error(r);return a}function UN(n,t){var e=n.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,r=t+n.TEXTURE0;if(r<n.TEXTURE0||r>e)throw new Error("textureUnit must be in "+("[gl.TEXTURE0, gl.TEXTURE"+e+"]")+".")}function Uf(n,t){return t===void 0&&(t=2),Ce(n.slice(0,n.length-t))}function Vf(n){if(n.length===0)throw Error("Cannot get rows and columns of an empty shape array.");return[n.length>1?n[n.length-2]:1,n[n.length-1]]}function bv(n){var t=[1,1,1];return n.length===0||n.length===1&&n[0]===1||(t=[Uf(n)].concat(Vf(n))),t}function VN(n,t){var e;t===void 0&&(t=!1);var r=ue().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(t&&(r*=2,(n=n.map(function(f,d){return d>=n.length-2?U_(n[d]):n[d]})).length===1&&(n=[2,n[0]])),n.length!==2){var a=Ji(n);n=a.newShape}var i=Ce(n);if(n.length<=1&&i<=r)return[1,i];if(n.length===2&&n[0]<=r&&n[1]<=r)return n;if(n.length===3&&n[0]*n[1]<=r&&n[2]<=r)return[n[0]*n[1],n[2]];if(n.length===3&&n[0]<=r&&n[1]*n[2]<=r)return[n[0],n[1]*n[2]];if(n.length===4&&n[0]*n[1]*n[2]<=r&&n[3]<=r)return[n[0]*n[1]*n[2],n[3]];if(n.length===4&&n[0]<=r&&n[1]*n[2]*n[3]<=r)return[n[0],n[1]*n[2]*n[3]];if(t){var u=Uf(n),l=2,c=2;return n.length&&(l=(e=Vf(n))[0],c=e[1]),dm(i=u*(l/2)*(c/2)).map(function(f){return 2*f})}return dm(i)}function Jc(n){return n%2==0}function ef(n,t){if(un(n=n.slice(-2),t=t.slice(-2))||!n.length||!t.length||n[0]===0||n[1]===0||t[0]===0||t[1]===0)return!0;if(n.length!==t.length){var e=n.slice(-1)[0],r=t.slice(-1)[0];if(e===r||Jc(e)&&Jc(r)&&(n[0]===1||t[0]===1))return!0}return n[1]===t[1]&&Jc(n[0])&&Jc(t[0])}function HN(n){if(vv==null){var t=ra(n);vv=t.getParameter(t.MAX_TEXTURE_SIZE)}return vv}function jN(n){if(mv==null){var t=ra(n);mv=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,mv)}function WN(n){if(n===0)return 0;var t=ra(n);return gr(t,"EXT_disjoint_timer_query_webgl2")&&n===2?2:gr(t,"EXT_disjoint_timer_query")?1:0}function gr(n,t){return n.getExtension(t)!=null}function Aw(n){try{if(ra(n)!=null)return!0}catch{return!1}return!1}function GN(n){if(n===0)return!1;var t=ra(n);if(n===1){if(!gr(t,"OES_texture_float"))return!1}else if(!gr(t,"EXT_color_buffer_float"))return!1;return xm(t)}function qN(n){if(n===0)return!1;var t=ra(n);if(n!==1){if(gr(t,"EXT_color_buffer_float"))return xm(t);if(gr(t,"EXT_color_buffer_half_float")){var e=t.getExtension("EXT_color_buffer_half_float");return function(r,a){var i=Jm(r,a),u=r.createTexture();r.bindTexture(r.TEXTURE_2D,u),r.texImage2D(r.TEXTURE_2D,0,i.internalFormatHalfFloat,1,1,0,i.textureFormatFloat,i.textureTypeHalfFloat,null);var l=r.createFramebuffer();r.bindFramebuffer(r.FRAMEBUFFER,l),r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,u,0);var c=r.checkFramebufferStatus(r.FRAMEBUFFER)===r.FRAMEBUFFER_COMPLETE;return r.bindTexture(r.TEXTURE_2D,null),r.bindFramebuffer(r.FRAMEBUFFER,null),r.deleteTexture(u),r.deleteFramebuffer(l),c}(t,e)}return!1}return!!gr(t,"OES_texture_float")&&!!gr(t,"WEBGL_color_buffer_float")&&xm(t)}function xm(n){var t=Jm(n),e=n.createTexture();n.bindTexture(n.TEXTURE_2D,e),n.texImage2D(n.TEXTURE_2D,0,t.internalFormatFloat,1,1,0,t.textureFormatFloat,t.textureTypeFloat,null);var r=n.createFramebuffer();n.bindFramebuffer(n.FRAMEBUFFER,r),n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,e,0);var a=n.checkFramebufferStatus(n.FRAMEBUFFER)===n.FRAMEBUFFER_COMPLETE;return n.bindTexture(n.TEXTURE_2D,null),n.bindFramebuffer(n.FRAMEBUFFER,null),n.deleteTexture(e),n.deleteFramebuffer(r),a}function KN(n){return n===2&&ra(n).fenceSync!=null}var Le=ue();function $_(n){ue().getBool("DEPRECATION_WARNINGS_ENABLED")&&console.warn(n+" You can disable deprecation warnings with tf.disableDeprecationWarnings().")}function xe(n,t){return q.tidy(n,t)}function zn(n){K_(n).forEach(function(t){return t.dispose()})}function XN(n){return q.keep(n)}function Hf(){for(var n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];ue().getBool("IS_TEST")||console.warn.apply(console,n)}function ki(n,t){var e=n;if(Qr(n))return t==="string"?[]:[n.length];if(!Array.isArray(n))return[];for(var r=[];Array.isArray(e)||Qr(e)&&t!=="string";)r.push(e.length),e=e[0];return Array.isArray(n)&&ue().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&function a(i,u,l){if(l=l||[],!Array.isArray(i)&&!Qr(i))return void L(u.length===0,function(){return"Element arr["+l.join("][")+"] is a primitive, but should be an array/TypedArray of "+u[0]+" elements"});L(u.length>0,function(){return"Element arr["+l.join("][")+"] should be a primitive, but is an array of "+i.length+" elements"}),L(i.length===u[0],function(){return"Element arr["+l.join("][")+"] should have "+u[0]+" elements, but has "+i.length+" elements"});for(var c=u.slice(1),f=0;f<i.length;++f)a(i[f],c,l.concat(f))}(n,r,[]),r}function Tw(n,t,e,r){if(n!=null&&(n!=="numeric"&&n!==t||n==="numeric"&&t==="string"))throw new Error("Argument '"+e+"' passed to '"+r+"' must be "+n+" tensor, but got "+t+" tensor")}function F(n,t,e,r){if(r===void 0&&(r="numeric"),n instanceof Rt)return Tw(r,n.dtype,t,e),n;var a=Sl(n);if(a!=="string"&&["bool","int32","float32"].indexOf(r)>=0&&(a=r),Tw(r,a,t,e),n==null||!Qr(n)&&!Array.isArray(n)&&typeof n!="number"&&typeof n!="boolean"&&typeof n!="string"){var i=n==null?"null":n.constructor.name;throw new Error("Argument '"+t+"' passed to '"+e+"' must be a Tensor or TensorLike, but got '"+i+"'")}var u=ki(n,a);Qr(n)||Array.isArray(n)||(n=[n]);var l=a!=="string"?H_(n,a,ue().getBool("DEBUG")):Ms(n,[],!0);return q.makeTensor(l,u,a)}function jf(n,t,e,r){if(r===void 0&&(r="numeric"),!Array.isArray(n))throw new Error("Argument "+t+" passed to "+e+" must be a `Tensor[]` or `TensorLike[]`");return n.map(function(a,i){return F(a,t+"["+i+"]",e)},r)}function Y_(n,t){for(var e=0;e<n.length;++e)if(n[n.length-e-1]!==t-1-e)return!1;return!0}function $N(n,t,e){for(var r=n.length+t.length,a=[],i=0,u=0,l=0;l<r;l++)e.indexOf(l)===-1?a.push(n[i++]):a.push(t[u++]);return a}function wn(n,t){for(var e=[],r=n.length,a=0;a<r;a++)t.indexOf(a)===-1&&e.push(n[a]);return[e,t.map(function(i){return n[i]})]}function Un(n,t){return $N(n,t.map(function(e){return 1}),t)}function Yn(n,t,e){L(Y_(t,e),function(){return n+" supports only inner-most axes for now. Got axes "+t+" and rank-"+e+" input."})}function aa(n,t){if(Y_(n,t))return null;for(var e=[],r=0;r<t;++r)n.indexOf(r)===-1&&e.push(r);return n.forEach(function(a){return e.push(a)}),e}function eg(n){return n.map(function(t,e){return[e,t]}).sort(function(t,e){return t[1]-e[1]}).map(function(t){return t[0]})}function ia(n,t){for(var e=[],r=t-n;r<t;++r)e.push(r);return e}function YN(n,t){var e=n[0].length;n.forEach(function(a,i){L(a.length===e,function(){return"Error in concat"+e+"D: rank of tensors["+i+"] must be the same as the rank of the rest ("+e+")"})}),L(t>=0&&t<e,function(){return"Error in concat"+e+"D: axis must be between 0 and "+(e-1)+"."});var r=n[0];n.forEach(function(a,i){for(var u=0;u<e;u++)L(u===t||a[u]===r[u],function(){return"Error in concat"+e+"D: Shape of tensors["+i+"] ("+a+") does not match the shape of the rest ("+r+") along the non-concatenated axis "+i+"."})})}function Fs(n,t){for(var e=n[0].slice(),r=1;r<n.length;r++)e[t]+=n[r][t];return e}function H(n){var t=Object.keys(n);if(t.length!==1)throw new Error("Please provide an object with a single key (operation name) mapping to a function. Got an object with "+t.length+" keys.");var e=t[0],r=n[e];e.endsWith("_")&&(e=e.substring(0,e.length-1));var a=function(){for(var i=[],u=0;u<arguments.length;u++)i[u]=arguments[u];q.startScope(e);try{var l=r.apply(void 0,i);return l instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),q.endScope(l),l}catch(c){throw q.endScope(null),c}};return Object.defineProperty(a,"name",{value:e,configurable:!0}),a}Le.registerFlag("HAS_WEBGL",function(){return Le.getNumber("WEBGL_VERSION")>0}),Le.registerFlag("WEBGL_VERSION",function(){return Aw(2)?2:Aw(1)?1:0}),Le.registerFlag("WEBGL_BUFFER_SUPPORTED",function(){return Le.get("WEBGL_VERSION")===2}),Le.registerFlag("WEBGL_CPU_FORWARD",function(){return!0}),Le.registerFlag("WEBGL_FORCE_F16_TEXTURES",function(){return!1}),Le.registerFlag("WEBGL_PACK",function(){return Le.getBool("HAS_WEBGL")}),Le.registerFlag("WEBGL_PACK_NORMALIZATION",function(){return Le.getBool("WEBGL_PACK")}),Le.registerFlag("WEBGL_PACK_CLIP",function(){return Le.getBool("WEBGL_PACK")}),Le.registerFlag("WEBGL_PACK_DEPTHWISECONV",function(){return!1}),Le.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",function(){return Le.getBool("WEBGL_PACK")}),Le.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",function(){return Le.getBool("WEBGL_PACK")}),Le.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",function(){return Le.getBool("WEBGL_PACK")}),Le.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",function(){return Le.getBool("WEBGL_PACK")}),Le.registerFlag("WEBGL_PACK_REDUCE",function(){return Le.getBool("WEBGL_PACK")}),Le.registerFlag("WEBGL_LAZILY_UNPACK",function(){return Le.getBool("WEBGL_PACK")}),Le.registerFlag("WEBGL_CONV_IM2COL",function(){return Le.getBool("WEBGL_PACK")}),Le.registerFlag("WEBGL_MAX_TEXTURE_SIZE",function(){return HN(Le.getNumber("WEBGL_VERSION"))}),Le.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",function(){return jN(Le.getNumber("WEBGL_VERSION"))}),Le.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",function(){var n=Le.getNumber("WEBGL_VERSION");return n===0?0:WN(n)}),Le.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",function(){return Le.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&(n=navigator.userAgent||navigator.vendor||window.opera,!(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(n)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(n.substr(0,4))));var n}),Le.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",function(){return GN(Le.getNumber("WEBGL_VERSION"))}),Le.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",function(){return!Le.getBool("WEBGL_FORCE_F16_TEXTURES")&&Le.getBool("WEBGL_RENDER_FLOAT32_CAPABLE")}),Le.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",function(){return qN(Le.getNumber("WEBGL_VERSION"))}),Le.registerFlag("WEBGL_FENCE_API_ENABLED",function(){return KN(Le.getNumber("WEBGL_VERSION"))}),Le.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",function(){return Le.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0}),q_=$_;var pn=H({complex_:function(n,t){var e=F(n,"real","complex"),r=F(t,"imag","complex");return ft(e.shape,r.shape,"real and imag shapes, "+e.shape+" and "+r.shape+", must match in call to tf.complex()."),q.runKernelFunc(function(a){return a.complex(e,r)},{$real:e,$imag:r})}}),mr=H({real_:function(n){var t=F(n,"input","real");return q.runKernelFunc(function(e){return e.real(t)},{$input:t})}}),Kr=H({imag_:function(n){var t=F(n,"input","imag");return q.runKernelFunc(function(e){return e.imag(t)},{$input:t})}});function mn(n,t,e){return Oi(n,t,ki(n,e),e)}function Oi(n,t,e,r){if(r==null&&(r=Sl(n)),r==="complex64")throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(!Qr(n)&&!Array.isArray(n)&&typeof n!="number"&&typeof n!="boolean"&&typeof n!="string")throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(t!=null){W_(t);var a=Ce(t),i=Ce(e);L(a===i,function(){return"Based on the provided shape, ["+t+"], the tensor should have "+a+" values but has "+i});for(var u=0;u<e.length;++u){var l=e[u],c=u!==e.length-1||l!==Ce(t.slice(u));L(e[u]===t[u]||!c,function(){return"Error creating a new Tensor. Inferred shape ("+e+") does not match the provided shape ("+t+"). "})}}return Qr(n)||Array.isArray(n)||(n=[n]),t=t||e,n=r!=="string"?H_(n,r,ue().getBool("DEBUG")):Ms(n,[],!0),q.makeTensor(n,t,r)}function ge(n,t){if((Qr(n)&&t!=="string"||Array.isArray(n))&&t!=="complex64")throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if(t==="string"&&Qr(n)&&!(n instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return Oi(n,[],[],t)}function Vt(n,t){Vs(n);var e=ki(n,t);if(e.length!==1)throw new Error("tensor1d() requires values to be a flat/TypedArray");return Oi(n,null,e,t)}function _i(n,t,e){if(Vs(n),t!=null&&t.length!==2)throw new Error("tensor2d() requires shape to have two numbers");var r=ki(n,e);if(r.length!==2&&r.length!==1)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(r.length===1&&t==null)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return Oi(n,t,r,e)}function tg(n,t,e){if(Vs(n),t!=null&&t.length!==3)throw new Error("tensor3d() requires shape to have three numbers");var r=ki(n,e);if(r.length!==3&&r.length!==1)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(r.length===1&&t==null)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return Oi(n,t,r,e)}function Bn(n,t,e){if(Vs(n),t!=null&&t.length!==4)throw new Error("tensor4d() requires shape to have four numbers");var r=ki(n,e);if(r.length!==4&&r.length!==1)throw new Error("tensor4d() requires values to be number[][][][] or flat/TypedArray");if(r.length===1&&t==null)throw new Error("tensor4d() requires shape to be provided when `values` are a flat array");return Oi(n,t,r,e)}function QN(n,t,e){if(Vs(n),t!=null&&t.length!==5)throw new Error("tensor5d() requires shape to have five numbers");var r=ki(n,e);if(r.length!==5&&r.length!==1)throw new Error("tensor5d() requires values to be number[][][][][] or flat/TypedArray");if(r.length===1&&t==null)throw new Error("tensor5d() requires shape to be provided when `values` are a flat array");return Oi(n,t,r,e)}function ZN(n,t,e){if(Vs(n),t!=null&&t.length!==6)throw new Error("tensor6d() requires shape to have six numbers");var r=ki(n,e);if(r.length!==6&&r.length!==1)throw new Error("tensor6d() requires values to be number[][][][][][] or flat/TypedArray");if(r.length===1&&t==null)throw new Error("tensor6d() requires shape to be provided when `values` are a flat array");return Oi(n,t=t||r,r,e)}function JN(n,t,e,r){return t===void 0&&(t=!0),q.makeVariable(n,t,e,r)}function Hs(n,t){if(t===void 0&&(t="float32"),t==="complex64"){var e=Hs(n,"float32"),r=St(n,"float32");return pn(e,r)}var a=j_(Ce(n),t);return q.makeTensor(a,n,t)}function St(n,t){if(t===void 0&&(t="float32"),t==="complex64"){var e=St(n,"float32"),r=St(n,"float32");return pn(e,r)}var a=El(Ce(n),t);return q.makeTensor(a,n,t)}function Jr(n,t,e){return q.runKernelFunc(function(r){return r.fill(n,t,e)},{})}function e3(n,t,e){if(e<=0)throw new Error("The number of values should be positive.");return q.runKernelFunc(function(r){return r.linspace(n,t,e)},{})}function Wf(n,t,e,r){if(e===void 0&&(e=1),r===void 0&&(r="float32"),e===0)throw new Error("Cannot have a step of zero");if(n===t||n<t&&e<0||t<n&&e>1)return St([0],r);var a=El(Math.abs(Math.ceil((t-n)/e)),r);t<n&&e===1&&(e=-1),a[0]=n;for(var i=1;i<a.length;i++)a[i]=a[i-1]+e;return Vt(a,r)}var Q_=H({onesLike_:function(n){var t=F(n,"x","onesLike");if(t.dtype==="complex64"){var e=Q_(mr(t)),r=nt(Kr(t));return pn(e,r)}return q.runKernelFunc(function(a){return a.onesLike(t)},{$x:t},function(a,i){return{$x:function(){return nt(a)}}})}}),nt=H({zerosLike_:function(n){var t=F(n,"x","zerosLike");return q.runKernelFunc(function(e){return e.zerosLike(t)},{$x:t},function(e,r){return{$x:function(){return nt(e)}}})}}),$t=H({concat_:function(n,t){t===void 0&&(t=0),L(n.length>=1,function(){return"Pass at least one tensor to concat"});var e=jf(n,"tensors","concat");e[0].dtype==="complex64"&&e.forEach(function(l){if(l.dtype!=="complex64")throw new Error(`Cannot concatenate complex64 tensors with a tensor
          with dtype `+l.dtype+". ")}),t=Jt(t,e[0].shape)[0];var r=Fs(e.map(function(l){return l.shape}),t);if(Ce(r)===0)return mn([],r);if((e=e.filter(function(l){return l.size>0})).length===1)return e[0];var a=e.map(function(l){return l.shape});YN(a,t);var i=e,u={axis:t};return q.runKernelFunc(function(l){return l.concat(e,t)},i,function(l){var c=a.map(function(f){return f[t]});return ng(l,c,t).map(function(f){return function(){return f}})},"Concat",u)}}),t3=H({concat1d_:function(n){return $t(n,0)}}),n3=H({concat2d_:function(n,t){return $t(n,t)}}),r3=H({concat3d_:function(n,t){return $t(n,t)}}),a3=H({concat4d_:function(n,t){return $t(n,t)}}),ng=H({split_:function(n,t,e){e===void 0&&(e=0);var r,a=F(n,"x","split");return e=Jt(e,a.shape)[0],typeof t=="number"?(L(a.shape[e]%t==0,function(){return"Number of splits must evenly divide the axis."}),r=new Array(t).fill(a.shape[e]/t)):(L(a.shape[e]===t.reduce(function(i,u){return i+u}),function(){return"The sum of sizes must match the size of the axis dimension."}),r=t),q.runKernelFunc(function(i){return i.split(a,r,e)},{$x:a},function(i){return{$x:function(){return $t(i,e)}}})}});function ho(n,t){return n(t={exports:{}},t.exports),t.exports}var i3=ho(function(n){(function(t,e,r){function a(l){var c,f=this,d=(c=4022871197,function(v){v=v.toString();for(var m=0;m<v.length;m++){var g=.02519603282416938*(c+=v.charCodeAt(m));g-=c=g>>>0,c=(g*=c)>>>0,c+=4294967296*(g-=c)}return 23283064365386963e-26*(c>>>0)});f.next=function(){var v=2091639*f.s0+23283064365386963e-26*f.c;return f.s0=f.s1,f.s1=f.s2,f.s2=v-(f.c=0|v)},f.c=1,f.s0=d(" "),f.s1=d(" "),f.s2=d(" "),f.s0-=d(l),f.s0<0&&(f.s0+=1),f.s1-=d(l),f.s1<0&&(f.s1+=1),f.s2-=d(l),f.s2<0&&(f.s2+=1),d=null}function i(l,c){return c.c=l.c,c.s0=l.s0,c.s1=l.s1,c.s2=l.s2,c}function u(l,c){var f=new a(l),d=c&&c.state,v=f.next;return v.int32=function(){return 4294967296*f.next()|0},v.double=function(){return v()+11102230246251565e-32*(2097152*v()|0)},v.quick=v,d&&(typeof d=="object"&&i(d,f),v.state=function(){return i(f,{})}),v}e&&e.exports?e.exports=u:this.alea=u})(0,n)}),o3=ho(function(n){(function(t,e,r){function a(l){var c=this,f="";c.x=0,c.y=0,c.z=0,c.w=0,c.next=function(){var v=c.x^c.x<<11;return c.x=c.y,c.y=c.z,c.z=c.w,c.w^=c.w>>>19^v^v>>>8},l===(0|l)?c.x=l:f+=l;for(var d=0;d<f.length+64;d++)c.x^=0|f.charCodeAt(d),c.next()}function i(l,c){return c.x=l.x,c.y=l.y,c.z=l.z,c.w=l.w,c}function u(l,c){var f=new a(l),d=c&&c.state,v=function(){return(f.next()>>>0)/4294967296};return v.double=function(){do var m=((f.next()>>>11)+(f.next()>>>0)/4294967296)/2097152;while(m===0);return m},v.int32=f.next,v.quick=v,d&&(typeof d=="object"&&i(d,f),v.state=function(){return i(f,{})}),v}e&&e.exports?e.exports=u:this.xor128=u})(0,n)}),s3=ho(function(n){(function(t,e,r){function a(l){var c=this,f="";c.next=function(){var v=c.x^c.x>>>2;return c.x=c.y,c.y=c.z,c.z=c.w,c.w=c.v,(c.d=c.d+362437|0)+(c.v=c.v^c.v<<4^v^v<<1)|0},c.x=0,c.y=0,c.z=0,c.w=0,c.v=0,l===(0|l)?c.x=l:f+=l;for(var d=0;d<f.length+64;d++)c.x^=0|f.charCodeAt(d),d==f.length&&(c.d=c.x<<10^c.x>>>4),c.next()}function i(l,c){return c.x=l.x,c.y=l.y,c.z=l.z,c.w=l.w,c.v=l.v,c.d=l.d,c}function u(l,c){var f=new a(l),d=c&&c.state,v=function(){return(f.next()>>>0)/4294967296};return v.double=function(){do var m=((f.next()>>>11)+(f.next()>>>0)/4294967296)/2097152;while(m===0);return m},v.int32=f.next,v.quick=v,d&&(typeof d=="object"&&i(d,f),v.state=function(){return i(f,{})}),v}e&&e.exports?e.exports=u:this.xorwow=u})(0,n)}),u3=ho(function(n){(function(t,e,r){function a(l){var c=this;c.next=function(){var f,d,v=c.x,m=c.i;return f=v[m],d=(f^=f>>>7)^f<<24,d^=(f=v[m+1&7])^f>>>10,d^=(f=v[m+3&7])^f>>>3,d^=(f=v[m+4&7])^f<<7,f=v[m+7&7],d^=(f^=f<<13)^f<<9,v[m]=d,c.i=m+1&7,d},function(f,d){var v,m=[];if(d===(0|d))m[0]=d;else for(d=""+d,v=0;v<d.length;++v)m[7&v]=m[7&v]<<15^d.charCodeAt(v)+m[v+1&7]<<13;for(;m.length<8;)m.push(0);for(v=0;v<8&&m[v]===0;++v);for(v==8?m[7]=-1:m[v],f.x=m,f.i=0,v=256;v>0;--v)f.next()}(c,l)}function i(l,c){return c.x=l.x.slice(),c.i=l.i,c}function u(l,c){l==null&&(l=+new Date);var f=new a(l),d=c&&c.state,v=function(){return(f.next()>>>0)/4294967296};return v.double=function(){do var m=((f.next()>>>11)+(f.next()>>>0)/4294967296)/2097152;while(m===0);return m},v.int32=f.next,v.quick=v,d&&(d.x&&i(d,f),v.state=function(){return i(f,{})}),v}e&&e.exports?e.exports=u:this.xorshift7=u})(0,n)}),l3=ho(function(n){(function(t,e,r){function a(l){var c=this;c.next=function(){var f,d,v=c.w,m=c.X,g=c.i;return c.w=v=v+1640531527|0,d=m[g+34&127],f=m[g=g+1&127],d^=d<<13,f^=f<<17,d^=d>>>15,f^=f>>>12,d=m[g]=d^f,c.i=g,d+(v^v>>>16)|0},function(f,d){var v,m,g,b,w,S=[],_=128;for(d===(0|d)?(m=d,d=null):(d+="\0",m=0,_=Math.max(_,d.length)),g=0,b=-32;b<_;++b)d&&(m^=d.charCodeAt((b+32)%d.length)),b===0&&(w=m),m^=m<<10,m^=m>>>15,m^=m<<4,m^=m>>>13,b>=0&&(w=w+1640531527|0,g=(v=S[127&b]^=m+w)==0?g+1:0);for(g>=128&&(S[127&(d&&d.length||0)]=-1),g=127,b=512;b>0;--b)m=S[g+34&127],v=S[g=g+1&127],m^=m<<13,v^=v<<17,m^=m>>>15,v^=v>>>12,S[g]=m^v;f.w=w,f.X=S,f.i=g}(c,l)}function i(l,c){return c.i=l.i,c.w=l.w,c.X=l.X.slice(),c}function u(l,c){l==null&&(l=+new Date);var f=new a(l),d=c&&c.state,v=function(){return(f.next()>>>0)/4294967296};return v.double=function(){do var m=((f.next()>>>11)+(f.next()>>>0)/4294967296)/2097152;while(m===0);return m},v.int32=f.next,v.quick=v,d&&(d.X&&i(d,f),v.state=function(){return i(f,{})}),v}e&&e.exports?e.exports=u:this.xor4096=u})(0,n)}),c3=ho(function(n){(function(t,e,r){function a(l){var c=this,f="";c.next=function(){var v=c.b,m=c.c,g=c.d,b=c.a;return v=v<<25^v>>>7^m,m=m-g|0,g=g<<24^g>>>8^b,b=b-v|0,c.b=v=v<<20^v>>>12^m,c.c=m=m-g|0,c.d=g<<16^m>>>16^b,c.a=b-v|0},c.a=0,c.b=0,c.c=-1640531527,c.d=1367130551,l===Math.floor(l)?(c.a=l/4294967296|0,c.b=0|l):f+=l;for(var d=0;d<f.length+20;d++)c.b^=0|f.charCodeAt(d),c.next()}function i(l,c){return c.a=l.a,c.b=l.b,c.c=l.c,c.d=l.d,c}function u(l,c){var f=new a(l),d=c&&c.state,v=function(){return(f.next()>>>0)/4294967296};return v.double=function(){do var m=((f.next()>>>11)+(f.next()>>>0)/4294967296)/2097152;while(m===0);return m},v.int32=f.next,v.quick=v,d&&(typeof d=="object"&&i(d,f),v.state=function(){return i(f,{})}),v}e&&e.exports?e.exports=u:this.tychei=u})(0,n)}),Zi=ho(function(n){(function(t,e){var r,a=this,i=256,u=6,l="random",c=e.pow(i,u),f=e.pow(2,52),d=2*f,v=i-1;function m(_,E,R){var C=[],A=w(function I(N,B){var V,U=[],J=typeof N;if(B&&J=="object")for(V in N)try{U.push(I(N[V],B-1))}catch{}return U.length?U:J=="string"?N:N+"\0"}((E=E==1?{entropy:!0}:E||{}).entropy?[_,S(t)]:_??function(){try{var I;return r&&(I=r.randomBytes)?I=I(i):(I=new Uint8Array(i),(a.crypto||a.msCrypto).getRandomValues(I)),S(I)}catch{var N=a.navigator,B=N&&N.plugins;return[+new Date,a,B,a.screen,S(t)]}}(),3),C),D=new g(C),k=function(){for(var I=D.g(u),N=c,B=0;I<f;)I=(I+B)*i,N*=i,B=D.g(1);for(;I>=d;)I/=2,N/=2,B>>>=1;return(I+B)/N};return k.int32=function(){return 0|D.g(4)},k.quick=function(){return D.g(4)/4294967296},k.double=k,w(S(D.S),t),(E.pass||R||function(I,N,B,V){return V&&(V.S&&b(V,D),I.state=function(){return b(D,{})}),B?(e[l]=I,N):I})(k,A,"global"in E?E.global:this==e,E.state)}function g(_){var E,R=_.length,C=this,A=0,D=C.i=C.j=0,k=C.S=[];for(R||(_=[R++]);A<i;)k[A]=A++;for(A=0;A<i;A++)k[A]=k[D=v&D+_[A%R]+(E=k[A])],k[D]=E;(C.g=function(I){for(var N,B=0,V=C.i,U=C.j,J=C.S;I--;)N=J[V=v&V+1],B=B*i+J[v&(J[V]=J[U=v&U+N])+(J[U]=N)];return C.i=V,C.j=U,B})(i)}function b(_,E){return E.i=_.i,E.j=_.j,E.S=_.S.slice(),E}function w(_,E){for(var R,C=_+"",A=0;A<C.length;)E[v&A]=v&(R^=19*E[v&A])+C.charCodeAt(A++);return S(E)}function S(_){return String.fromCharCode.apply(0,_)}if(e["seed"+l]=m,w(e.random(),t),n.exports){n.exports=m;try{r=require("crypto")}catch{}}})([],Math)});Zi.alea=i3,Zi.xor128=o3,Zi.xorwow=s3,Zi.xorshift7=u3,Zi.xor4096=l3,Zi.tychei=c3;var vh=Zi.alea,rg=function(){function n(t,e,r,a,i){this.mean=t,this.stdDev=e,this.dtype=r,this.nextVal=NaN,this.truncated=a,this.truncated&&(this.upper=this.mean+2*this.stdDev,this.lower=this.mean-2*this.stdDev);var u=i||Math.random();this.random=vh(u.toString())}return n.prototype.nextValue=function(){if(!isNaN(this.nextVal)){var t=this.nextVal;return this.nextVal=NaN,t}for(var e,r,a=!1;!a;){var i=void 0,u=void 0,l=void 0;do l=(i=2*this.random()-1)*i+(u=2*this.random()-1)*u;while(l>=1||l===0);var c=Math.sqrt(-2*Math.log(l)/l);e=this.mean+this.stdDev*i*c,r=this.mean+this.stdDev*u*c,this.truncated&&!this.isValidTruncated(e)||(a=!0)}return this.truncated&&!this.isValidTruncated(r)||(this.nextVal=this.convertValue(r)),this.convertValue(e)},n.prototype.convertValue=function(t){return this.dtype==null||this.dtype==="float32"?t:Math.round(t)},n.prototype.isValidTruncated=function(t){return t<=this.upper&&t>=this.lower},n}(),f3=function(){function n(t,e,r,a){this.alpha=t,this.beta=1/e,this.dtype=r;var i=a||Math.random();this.randu=vh(i.toString()),this.randn=new rg(0,1,r,!1,this.randu()),this.d=t<1?t+2/3:t-1/3,this.c=1/Math.sqrt(9*this.d)}return n.prototype.nextValue=function(){for(var t,e,r,a,i,u;;){do a=this.randn.nextValue(),u=1+this.c*a;while(u<=0);if(u*=u*u,e=1-.331*(t=a*a)*t,r=.5*t+this.d*(1-u+Math.log(u)),(i=this.randu())<e||Math.log(i)<r)break}return u=1/this.beta*this.d*u,this.alpha<1&&(u*=Math.pow(this.randu(),1/this.alpha)),this.convertValue(u)},n.prototype.convertValue=function(t){return this.dtype==="float32"?t:Math.round(t)},n}(),h3=function(){function n(t,e,r,a){var i=this;if(t===void 0&&(t=0),e===void 0&&(e=1),this.canReturnFloat=function(){return i.dtype==null||i.dtype==="float32"},this.min=t,this.range=e-t,this.dtype=r,a==null&&(a=Math.random()),typeof a=="number"&&(a=a.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error("The difference between "+t+" - "+e+" <= 1 and dtype is not float");this.random=vh(a)}return n.prototype.convertValue=function(t){return this.canReturnFloat()?t:Math.round(t)},n.prototype.nextValue=function(){return this.convertValue(this.min+this.range*this.random())},n}();function Ue(n,t,e){return t===void 0&&(t="float32"),t=t||"float32",W_(n),new fl(n,t,e)}function d3(n,t){t===void 0&&(t=!1),console.log(n.toString(t))}var Z_=H({batchToSpaceND_:function(n,t,e){var r=F(n,"x","batchToSpaceND"),a=t.reduce(function(i,u){return i*u});return L(r.rank>=1+t.length,function(){return"input rank is "+r.rank+" but should be > than blockShape.length "+t.length}),L(e.length===t.length,function(){return"crops.length is "+e.length+" but should be equal to blockShape.length  "+t.length}),L(r.shape[0]%a==0,function(){return"input tensor batch is "+r.shape[0]+" but is not divisible by the product of the elements of blockShape "+t.join(" * ")+" === "+a}),q.runKernelFunc(function(i){return i.batchToSpaceND(r,t,e)},{$x:r},function(i){return{$x:function(){return i.spaceToBatchND(t,e)}}})}}),p3=H({broadcastTo_:function(n,t){var e=F(n,"broadcastTo","x"),r=e.shape;if(t.some(function(c){return!(c>0)||c%1!=0}))throw new Error("broadcastTo(): Invalid broadcast shape ["+t+"].");if(t.length<e.rank)throw new Error("broadcastTo(): shape.length="+t.length+" < input.rank="+e.rank+".");if(t.length>e.rank){for(var a=e.shape.slice();a.length<t.length;)a.unshift(1);e=e.reshape(a)}for(var i=Array.from(t),u=t.length-1;u>=0;u--)if(e.shape[u]===t[u])i[u]=1;else if(e.shape[u]!==1)throw new Error("broadcastTo(): ["+r+"] cannot be broadcast to ["+t+"].");var l=i.map(function(c,f){return c>1?f:-1}).filter(function(c){return c>=0});return l.length===0?e.clone():q.runKernelFunc(function(c){return c.tile(e,i)},{input:e},function(c){return{input:function(){return c.sum(l,!0)}}})}}),v3=H({cast_:function(n,t){var e=F(n,"x","cast");if(!sN(t))throw new Error("Failed to cast to unknown dtype "+t);if(t==="string"&&e.dtype!=="string"||t!=="string"&&e.dtype==="string")throw new Error("Only strings can be casted to strings");var r={dtype:t};return q.runKernelFunc(function(a){return a.cast(e,t)},{x:e},function(a){return{x:function(){return a.clone()}}},"Cast",r)}}),m3=H({clone_:function(n){var t=F(n,"x","clone",null);return q.runKernelFunc(function(){return q.makeTensorFromDataId(t.dataId,t.shape,t.dtype)},{$x:t},function(e){return{$x:function(){return e.toFloat()}}})}}),g3=H({cumsum_:function(n,t,e,r){t===void 0&&(t=0),e===void 0&&(e=!1),r===void 0&&(r=!1);var a=F(n,"x","cumsum"),i=aa([t|=0],a.rank),u=a;i!=null&&(u=a.transpose(i));var l=ia(1,a.rank)[0],c=q.runKernelFunc(function(f){return f.cumsum(u,l,e,r)},{permutedX:u},function(f){return{permutedX:function(){return f.cumsum(t,e,!r)}}});return i!=null&&(c=c.transpose(i)),c}}),y3=H({depthToSpace_:function(n,t,e){e===void 0&&(e="NHWC");var r=F(n,"x","depthToSpace"),a=e==="NHWC"?r.shape[1]:r.shape[2],i=e==="NHWC"?r.shape[2]:r.shape[3],u=e==="NHWC"?r.shape[3]:r.shape[1];return L(a*t>=0,function(){return`Negative dimension size caused by overflow when multiplying
      `+a+" and "+t+`  for depthToSpace with input shape
      `+r.shape}),L(i*t>=0,function(){return`Negative dimension size caused by overflow when multiplying
      `+i+" and "+t+` for depthToSpace with input shape
          `+r.shape}),L(u%(t*t)==0,function(){return"Dimension size must be evenly divisible by "+t*t+" but is "+u+" for depthToSpace with input shape "+r.shape}),q.runKernelFunc(function(l){return l.depthToSpace(r,t,e)},{$x:r})}}),vr=H({expandDims_:function(n,t){t===void 0&&(t=0);var e=F(n,"x","expandDims",null);L(t<=e.rank,function(){return"Axis must be <= rank of the tensor"});var r=e.shape.slice();return t<0&&(L(-(e.rank+1)<=t,function(){return"Axis must be in the interval ["+-(e.rank+1)+", "+e.rank+"]"}),t=e.rank+t+1),r.splice(t,0,1),Dr(e,r)}}),J_=H({eye_:function(n,t,e,r){r===void 0&&(r="float32"),t==null&&(t=n);for(var a=Ue([n,t],r),i=n<=t?n:t,u=0;u<i;++u)a.set(1,u,u);var l=a.toTensor().as2D(n,t);if(e==null)return l;if(e.length===1)return gs(vr(l,0),[e[0],1,1]);if(e.length===2)return gs(vr(vr(l,0),0),[e[0],e[1],1,1]);if(e.length===3)return gs(vr(vr(vr(l,0),0),0),[e[0],e[1],e[2],1,1]);throw new Error("eye() currently supports only 1D and 2D batchShapes, but received "+e.length+"D.")}}),b3=H({multinomial_:function(n,t,e,r){r===void 0&&(r=!1);var a=F(n,"logits","multinomial"),i=a.size,u=a.rank;if(i<2)throw new Error("Error in multinomial: you need at least 2 outcomes, but got "+i+".");if(u>2)throw new Error("Rank of probabilities must be 1 or 2, but is "+u);e=e||Math.random();var l=u===1?a.as2D(1,-1):a,c=q.runKernelFunc(function(f){return f.multinomial(l,r,t,e)},{logits2D:l});return u===1?c.as1D():c}}),wm=H({oneHot_:function(n,t,e,r){if(e===void 0&&(e=1),r===void 0&&(r=0),t<2)throw new Error("Error in oneHot: depth must be >=2, but it is "+t);var a=F(n,"indices","oneHot","int32"),i=a.shape.concat([t]);return a=a.flatten(),q.runKernelFunc(function(u){return u.oneHot(a,t,e,r)},{$indices:a},function(u){return{$indices:function(){return St(a.shape,"float32")}}}).reshape(i)}}),po=H({pad_:function(n,t,e){e===void 0&&(e=0);var r=F(n,"x","pad");if(r.rank===0)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");var a={paddings:t,constantValue:e};return q.runKernelFunc(function(i){return i.pad(r,t,e)},{x:r},function(i){var u=t.map(function(l){return l[0]});return{x:function(){return i.slice(u,r.shape)}}},"PadV2",a)}}),x3=H({pad1d_:function(n,t,e){return e===void 0&&(e=0),L(t.length===2,function(){return"Invalid number of paddings. Must be length of 2."}),po(n,[t],e)}}),w3=H({pad2d_:function(n,t,e){return e===void 0&&(e=0),L(t.length===2&&t[0].length===2&&t[1].length===2,function(){return"Invalid number of paddings. Must be length of 2 each."}),po(n,t,e)}}),_3=H({pad3d_:function(n,t,e){return e===void 0&&(e=0),L(t.length===3&&t[0].length===2&&t[1].length===2&&t[2].length===2,function(){return"Invalid number of paddings. Must be length of 2 each."}),po(n,t,e)}}),S3=H({pad4d_:function(n,t,e){return e===void 0&&(e=0),L(t.length===4&&t[0].length===2&&t[1].length===2&&t[2].length===2&&t[3].length===2,function(){return"Invalid number of paddings. Must be length of 2 each."}),po(n,t,e)}}),E3=H({rand_:function(n,t,e){var r=Ce(n),a=null;if(e==null||e==="float32")a=new Float32Array(r);else if(e==="int32")a=new Int32Array(r);else{if(e!=="bool")throw new Error("Unknown data type "+e);a=new Uint8Array(r)}for(var i=0;i<r;i++)a[i]=t();return q.makeTensor(a,n,e)}}),C3=H({randomNormal_:function(n,t,e,r,a){if(t===void 0&&(t=0),e===void 0&&(e=1),r!=null&&r==="bool")throw new Error("Unsupported data type "+r);for(var i=new rg(t,e,r,!1,a),u=Ue(n,r),l=0;l<u.values.length;l++)u.values[l]=i.nextValue();return u.toTensor()}}),R3=H({randomGamma_:function(n,t,e,r,a){if(e===void 0&&(e=1),r===void 0&&(r="float32"),e==null&&(e=1),r==null&&(r="float32"),r!=="float32"&&r!=="int32")throw new Error("Unsupported data type "+r);for(var i=new f3(t,e,r,a),u=Ue(n,r),l=0;l<u.values.length;l++)u.values[l]=i.nextValue();return u.toTensor()}}),eS=H({randomUniform_:function(n,t,e,r,a){t===void 0&&(t=0),e===void 0&&(e=1),r===void 0&&(r="float32");for(var i=Ue(n,r),u=new h3(t,e,null,a),l=0;l<i.values.length;l++)i.values[l]=u.nextValue();return i.toTensor()}}),Dr=H({reshape_:function(n,t){var e=F(n,"x","reshape",null);t=iN(t,e.size),L(e.size===Ce(t),function(){return"new shape and old shape must have the same number of elements."});var r={shape:t};return q.runKernelFunc(function(a){return a.reshape(e,t)},{x:e},function(a){return{x:function(){return a.reshape(e.shape)}}},"Reshape",r)}}),tS=H({spaceToBatchND_:function(n,t,e){var r=F(n,"x","spaceToBatchND");return L(r.rank>=1+t.length,function(){return"input rank "+r.rank+" should be > than [blockShape] "+t.length}),L(e.length===t.length,function(){return"paddings.shape[0] "+e.length+" must be equal to [blockShape] "+t.length}),L(r.shape.reduce(function(a,i,u){return u>0&&u<=t.length?a&&(i+e[u-1][0]+e[u-1][1])%t[u-1]==0:a},!0),function(){return"input spatial dimensions "+r.shape.slice(1)+" with paddings "+e.toString()+" must be divisible by blockShapes "+t.toString()}),q.runKernelFunc(function(a){return a.spaceToBatchND(r,t,e)},{$x:r},function(a){return{$x:function(){return a.batchToSpaceND(t,e)}}})}}),nS=H({squeeze_:function(n,t){var e=F(n,"x","squeeze");return Dr(e,Ji(e.shape,t).newShape)}}),tr=H({stack_:function(n,t){t===void 0&&(t=0);var e=jf(n,"tensors","stack");if(L(e.length>=1,function(){return"Pass at least one tensor to tf.stack"}),e.length===1)return e[0].expandDims(t);var r=e[0].rank,a=e[0].shape,i=e[0].dtype;L(t<=r,function(){return"Axis must be <= rank of the tensor"}),e.forEach(function(l){ft(a,l.shape,"All tensors passed to stack must have matching shapes")}),e.forEach(function(l){L(i===l.dtype,function(){return"All tensors passed to stack must have matching dtypes"})});var u=e.map(function(l){return l.expandDims(t)});return $t(u,t)}}),gs=H({tile_:function(n,t){var e=F(n,"x","tile",null);L(e.rank===t.length,function(){return"Error in transpose: rank of input "+e.rank+" must match length of reps "+t+"."});var r=[e],a={reps:t};return q.runKernelFunc(function(i,u){var l=i.tile(e,t);return u([e]),l},{x:e},function(i,u){var l=u[0];return{x:function(){var c=nt(l);if(l.rank===1)for(var f=0;f<t[0];++f)c=c.add(i.slice([f*l.shape[0]],[l.shape[0]]));else if(l.rank===2)for(f=0;f<t[0];++f)for(var d=0;d<t[1];++d)c=c.add(i.slice([f*l.shape[0],d*l.shape[1]],[l.shape[0],l.shape[1]]));else if(l.rank===3)for(f=0;f<t[0];++f)for(d=0;d<t[1];++d)for(var v=0;v<t[2];++v)c=c.add(i.slice([f*l.shape[0],d*l.shape[1],v*l.shape[2]],[l.shape[0],l.shape[1],l.shape[2]]));else{if(l.rank!==4)throw new Error("Gradient for tile operation is not implemented for rank-"+l.rank+" tensors yet.");for(f=0;f<t[0];++f)for(d=0;d<t[1];++d)for(v=0;v<t[2];++v)for(var m=0;m<t[3];++m)c=c.add(i.slice([f*l.shape[0],d*l.shape[1],v*l.shape[2],m*l.shape[3]],[l.shape[0],l.shape[1],l.shape[2],l.shape[3]]))}return c}}},"Tile",a,r)}}),A3=H({truncatedNormal_:function(n,t,e,r,a){if(t===void 0&&(t=0),e===void 0&&(e=1),r!=null&&r==="bool")throw new Error("Unsupported data type "+r);for(var i=new rg(t,e,r,!0,a),u=Ue(n,r),l=0;l<u.values.length;l++)u.values[l]=i.nextValue();return u.toTensor()}}),Yt=H({unstack_:function(n,t){t===void 0&&(t=0),t=t||0;var e=F(n,"x","unstack");L(t>=-e.shape.length&&t<e.shape.length,function(){return"Axis = "+t+" is not in [-"+e.shape.length+", "+e.shape.length+")"}),t<0&&(t+=e.shape.length);var r={axis:t};return q.runKernelFunc(function(a){return a.unstack(e,t)},{x:e},function(a){return{x:function(){return tr(a,t)}}},"Unpack",r)}}),T3=function(n,t){return _e(this,void 0,void 0,function(){var e,r,a,i,u,l,c,f,d,v;return Se(this,function(m){switch(m.label){case 0:return e=F(n,"x","setdiff1d"),r=F(t,"y","setdiff1d"),L(e.dtype===r.dtype,function(){return"x and y should have the same dtype, but got x ("+e.dtype+") and y ("+r.dtype+")."}),L(e.rank===1,function(){return"x should be 1D tensor, but got x ("+e.shape+")."}),L(r.rank===1,function(){return"y should be 1D tensor, but got y ("+r.shape+")."}),[4,e.data()];case 1:return a=m.sent(),[4,r.data()];case 2:for(i=m.sent(),u=new Set(i),l=0,d=0;d<a.length;d++)u.has(a[d])||l++;for(c=new fl([l],e.dtype),f=new fl([l],"int32"),d=0,v=0;d<a.length;d++)u.has(a[d])||(c.values[v]=a[d],f.values[v]=d,v++);return[2,[c.toTensor(),f.toTensor()]]}})})};function Gf(n,t,e,r){r===void 0&&(r=!0);var a=[];if(r)(a=a.concat(t.slice(0))).push(n[0]/e),a=a.concat(n.slice(1));else{a=a.concat(n[0]);for(var i=t.length,u=0;u<i;++u)a=a.concat([n[u+1]/t[u],t[u]]);a=a.concat(n.slice(i+1))}return a}function qf(n,t,e){e===void 0&&(e=!0);var r=[];if(e){r.push(t);for(var a=t+1;a<n;++a)a<=2*t?(r.push(a),r.push(a-(t+1))):r.push(a)}else{var i=[],u=[];for(a=1;a<n;++a)a>=2*t+1||a%2==1?u.push(a):i.push(a);r.push.apply(r,i),r.push(0),r.push.apply(r,u)}return r}function Kf(n,t,e,r){r===void 0&&(r=!0);var a=[];r?a.push(n[0]/e):a.push(n[0]*e);for(var i=1;i<n.length;++i)i<=t.length?r?a.push(t[i-1]*n[i]):a.push(n[i]/t[i-1]):a.push(n[i]);return a}function rS(n,t){for(var e=[0],r=0;r<t;++r)e.push(n[r][0]);return e}function aS(n,t,e){for(var r=n.slice(0,1),a=0;a<e;++a)r.push(n[a+1]-t[a][0]-t[a][1]);return r}function iS(n,t){if(n.rank<1)throw new Error("tf.gatherND() expects the input to be rank 1 or higher, but the rank was "+n.rank+".");if(t.rank<1)throw new Error("tf.gatherND() expects the indices to be rank 1 or higher, but the rank was "+t.rank+".");if(t.dtype!=="int32")throw new Error("tf.gatherND() expects the indices to be int32 type, but the dtype was "+t.dtype+".");if(t.shape[t.rank-1]>n.rank)throw new Error("index innermost dimension length must be <= tensor rank; saw: "+t.shape[t.rank-1]+" vs. "+n.rank);if(n.size===0)throw new Error("Requested more than 0 entries, but input is empty. Input shape: "+n.shape+".");for(var e=t.shape,r=e[e.length-1],a=1,i=0;i<e.length-1;++i)a*=e[i];var u=n.shape,l=e.slice();l.pop();var c=1;for(i=r;i<n.rank;++i)c*=u[i],l.push(u[i]);var f=Zr(n.shape).map(function(d){return d/c}).concat([1]).slice(0,r);return[l,a,c,f]}var oS=30;function xv(n){return n<=oS?n:vm(n,Math.floor(Math.sqrt(n)))}function D3(n,t,e){var r=t.rank>1?t.shape[t.rank-1]:1,a=t.rank>1?t.rank-1:1,i="Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: "+e.shape+", indices.shape: "+t.shape+", shape: "+n+", sliceDim: "+r+", and batchDim: "+a+".";if(e.rank<a)throw new Error(i+" update.rank < "+a+". ");if(n.length<r+(e.rank-a))throw new Error(i+" Output shape length < "+(r+(e.rank-a)));if(e.rank!==a+n.length-r)throw new Error(i+" update.rank != "+(a+n.length-r));for(var u=0;u<a;++u)if(e.shape[u]!==t.shape[u])throw new Error(i+" updates.shape["+u+"] ("+e.shape[u]+") != indices.shape["+u+"] ("+t.shape[u]+").");for(u=0;u<e.rank-a;++u)if(e.shape[u+a]!==n[u+r])throw new Error(i+" updates.shape["+(u+a)+"] ("+e.shape[u+a]+") != shape["+(u+a)+"] ("+n[u+a]+")")}function k3(n,t,e){if(t.rank<1)throw new Error("tf.scatterND() expects the indices to be rank 1 or higher, but the rank was "+t.rank+".");if(n.rank<1)throw new Error("tf.scatterND() expects the updates to be rank 1 or higher, but the rank was "+n.rank+".");if(t.dtype!=="int32")throw new Error("The dtype of 'indices' should be int32, but got dtype: "+t.dtype);if(e.length<1)throw new Error("Output rank must be greater or equal to 1, but got shape: "+e);if(e.length===0){if(t.size===0)throw new Error("Indices specified for empty output. indices shape: "+t.shape);if(n.size===0)throw new Error("Updates specified for empty output. updates shape: "+n.shape)}D3(e,t,n)}function Xf(n,t,e){for(var r=t.shape.length,a=r>1?t.shape[r-1]:1,i=e.length,u=1,l=a;l<i;++l)u*=e[l];var c=a<1?1:a;return{sliceRank:a,numUpdates:Ce(t.shape)/c,sliceSize:u,strides:Zr(e.slice(0,a)).concat([1]),outputSize:Ce(e)}}function O3(n,t,e){L(n.rank===t.length,function(){return"Error in slice"+n.rank+"D: Length of begin "+t+" must match the rank of the array ("+n.rank+")."}),L(n.rank===e.length,function(){return"Error in slice"+n.rank+"D: Length of size "+e+" must match the rank of the array ("+n.rank+")."});for(var r=function(i){L(t[i]+e[i]<=n.shape[i],function(){return"Error in slice"+n.rank+"D: begin["+i+"] + size["+i+"] ("+(t[i]+e[i])+") would overflow input.shape["+i+"] ("+n.shape[i]+")"})},a=0;a<n.rank;++a)r(a)}function Dw(n){for(var t=[],e=0;n>0;)1&n&&t.push(e),n/=2,e++;return t}function ag(n,t,e){for(var r=[],a=0;a<n.length;a++)r[a]=Math.ceil((t[a]-n[a])/e[a]);return r}function N3(n,t,e,r,a){var i=t[a],u=e[a]||1;(n&1<<a||i==null)&&(i=u>0?Number.MIN_SAFE_INTEGER:Number.MAX_SAFE_INTEGER);var l=r[a];return i<0&&(i+=l),i=hm(0,i,l-1)}function M3(n,t,e,r,a){var i=t[a],u=e[a]||1;(n&1<<a||i==null)&&(i=u>0?Number.MAX_SAFE_INTEGER:Number.MIN_SAFE_INTEGER);var l=r[a];return i<0&&(i+=l),i=u>0?hm(0,i,l):hm(-1,i,l-1)}function sS(n,t,e){for(var r=e.length,a=0;a<e.length;a++)if(e[a]>1){r=a;break}for(a=r+1;a<e.length;a++)if(t[a]>0||e[a]!==n[a])return!1;return!0}function uS(n,t){for(var e=n.length>0?n[n.length-1]:1,r=0;r<n.length-1;r++)e+=n[r]*t[r];return e}function I3(n,t){L(pm(n),function(){return"The f passed in variableGrads(f) must be a function"}),L(t==null||Array.isArray(t)&&t.every(function(d){return d instanceof Is}),function(){return"The varList passed in variableGrads(f, varList) must be an array of variables"});var e=t!=null;if(!e)for(var r in t=[],q.registeredVariables)t.push(q.registeredVariables[r]);var a=e?t.filter(function(d){return!d.trainable}):null,i=t.length;L((t=t.filter(function(d){return d.trainable})).length>0,function(){return"variableGrads() expects at least one of the input variables to be trainable, but none of the "+i+" variables is trainable."});var u=q.gradients(n,t,null,!0),l=u.value,c=u.grads;L(c.some(function(d){return d!=null}),function(){return"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."}),L(l.rank===0,function(){return"The f passed in variableGrads(f) must return a scalar, but it returned a rank-"+l.rank+" tensor"});var f={};return t.forEach(function(d,v){c[v]!=null&&(f[d.name]=c[v])}),a?.forEach(function(d){return f[d.name]=null}),{value:l,grads:f}}function mh(n){return q.customGrad(n)}var Ma=H({softmax_:function(n,t){t===void 0&&(t=-1);var e=F(n,"logits","softmax","float32");if(t===-1&&(t=e.rank-1),t!==e.rank-1)throw Error("Softmax along a non-last dimension is not yet supported. Logits was rank "+e.rank+" and dim was "+t);return q.runKernelFunc(function(r,a){var i=r.softmax(e,t);return a([i]),i},{logits:e},function(r,a){var i=a[0],u=r.mul(i);return{logits:function(){return u.sub(u.sum([t],!0).mul(i))}}},"Softmax",{dim:t},[],[!0])}}),F3=H({logSoftmax_:function(n,t){t===void 0&&(t=-1);var e=F(n,"logits","logSoftmax");if(t===-1&&(t=e.rank-1),t!==e.rank-1)throw Error("Log Softmax along a non-last dimension is not yet supported. Logits was rank "+e.rank+" and axis was "+t);return mh(function(r,a){var i=r.max(t,!0),u=r.sub(i),l=u.toFloat().sub(u.exp().sum(t,!0).log());return a([l]),{value:l,gradFunc:function(c,f){var d=f[0].exp();return c.sub(c.sum(t,!0).mul(d))}}})(e)}}),lS=function(){function n(t,e){this.backend=t,this.dataMover=e,this.data=new WeakMap,this.dataIdsCount=0}return n.prototype.get=function(t){return this.data.has(t)||this.dataMover.moveData(this.backend,t),this.data.get(t)},n.prototype.set=function(t,e){this.dataIdsCount++,this.data.set(t,e)},n.prototype.has=function(t){return this.data.has(t)},n.prototype.delete=function(t){return this.dataIdsCount--,this.data.delete(t)},n.prototype.numDataIds=function(){return this.dataIdsCount},n}(),cS=function(){function n(){}return n.prototype.time=function(t){return ae("time")},n.prototype.read=function(t){return ae("read")},n.prototype.readSync=function(t){return ae("readSync")},n.prototype.numDataIds=function(){return ae("numDataIds")},n.prototype.disposeData=function(t){return ae("disposeData")},n.prototype.write=function(t,e,r){return ae("write")},n.prototype.move=function(t,e,r,a){return ae("move")},n.prototype.memory=function(){return ae("memory")},n.prototype.floatPrecision=function(){return ae("floatPrecision")},n.prototype.epsilon=function(){return this.floatPrecision()===32?1e-7:1e-4},n.prototype.batchMatMul=function(t,e,r,a){return ae("batchMatMul")},n.prototype.fusedBatchMatMul=function(t){return t.a,t.b,t.transposeA,t.transposeB,t.bias,t.activation,t.preluActivationWeights,ae("fusedBatchMatMul")},n.prototype.slice=function(t,e,r){return ae("slice")},n.prototype.stridedSlice=function(t,e,r,a){return ae("stridedSlice")},n.prototype.unstack=function(t,e){return ae("unstack")},n.prototype.reverse=function(t,e){return ae("reverse")},n.prototype.concat=function(t,e){return ae("concat")},n.prototype.neg=function(t){return ae("neg")},n.prototype.add=function(t,e){return ae("add")},n.prototype.addN=function(t){return ae("addN")},n.prototype.subtract=function(t,e){return ae("subtract")},n.prototype.multiply=function(t,e){return ae("multiply")},n.prototype.realDivide=function(t,e){return ae("realDivide")},n.prototype.floorDiv=function(t,e){return ae("floorDiv")},n.prototype.sum=function(t,e){return ae("sum")},n.prototype.prod=function(t,e){return ae("prod")},n.prototype.unsortedSegmentSum=function(t,e,r){return ae("unsortedSegmentSum")},n.prototype.argMin=function(t,e){return ae("argMin")},n.prototype.argMax=function(t,e){return ae("argMax")},n.prototype.equal=function(t,e){return ae("equal")},n.prototype.notEqual=function(t,e){return ae("notEqual")},n.prototype.less=function(t,e){return ae("less")},n.prototype.lessEqual=function(t,e){return ae("lessEqual")},n.prototype.greater=function(t,e){return ae("greater")},n.prototype.greaterEqual=function(t,e){return ae("greaterEqual")},n.prototype.logicalNot=function(t){return ae("logicalNot")},n.prototype.logicalAnd=function(t,e){return ae("logicalAnd")},n.prototype.logicalOr=function(t,e){return ae("logicalOr")},n.prototype.where=function(t){return ae("where")},n.prototype.select=function(t,e,r){return ae("select")},n.prototype.topk=function(t,e,r){return ae("topk")},n.prototype.min=function(t,e){return ae("min")},n.prototype.minimum=function(t,e){return ae("minimum")},n.prototype.mod=function(t,e){return ae("mod")},n.prototype.max=function(t,e){return ae("max")},n.prototype.maximum=function(t,e){return ae("maximum")},n.prototype.all=function(t,e){return ae("all")},n.prototype.any=function(t,e){return ae("any")},n.prototype.squaredDifference=function(t,e){return ae("squaredDifference")},n.prototype.ceil=function(t){return ae("ceil")},n.prototype.floor=function(t){return ae("floor")},n.prototype.round=function(t){return ae("round")},n.prototype.sign=function(t){return ae("sign")},n.prototype.isNaN=function(t){return ae("isNaN")},n.prototype.isInf=function(t){return ae("isInf")},n.prototype.isFinite=function(t){return ae("isFinite")},n.prototype.pow=function(t,e){return ae("pow")},n.prototype.exp=function(t){return ae("exp")},n.prototype.expm1=function(t){return ae("expm1")},n.prototype.softmax=function(t,e){return ae("softmax")},n.prototype.log=function(t){return ae("log")},n.prototype.log1p=function(t){return ae("log1p")},n.prototype.sqrt=function(t){return ae("sqrt")},n.prototype.rsqrt=function(t){return ae("rsqrt")},n.prototype.square=function(t){return ae("square")},n.prototype.reciprocal=function(t){return ae("reciprocal")},n.prototype.relu=function(t){return ae("relu")},n.prototype.relu6=function(t){return ae("relu6")},n.prototype.prelu=function(t,e){return ae("prelu")},n.prototype.elu=function(t){return ae("elu")},n.prototype.eluDer=function(t,e){return ae("eluDer")},n.prototype.selu=function(t){return ae("selu")},n.prototype.int=function(t){return ae("int")},n.prototype.clip=function(t,e,r){return ae("clip")},n.prototype.abs=function(t){return ae("abs")},n.prototype.complexAbs=function(t){return ae("complexAbs")},n.prototype.sigmoid=function(t){return ae("sigmoid")},n.prototype.softplus=function(t){return ae("softplus")},n.prototype.sin=function(t){return ae("sin")},n.prototype.cos=function(t){return ae("cos")},n.prototype.tan=function(t){return ae("tan")},n.prototype.asin=function(t){return ae("asin")},n.prototype.acos=function(t){return ae("acos")},n.prototype.atan=function(t){return ae("atan")},n.prototype.atan2=function(t,e){return ae("atan2")},n.prototype.sinh=function(t){return ae("sinh")},n.prototype.cosh=function(t){return ae("cosh")},n.prototype.tanh=function(t){return ae("tanh")},n.prototype.asinh=function(t){return ae("asinh")},n.prototype.acosh=function(t){return ae("acosh")},n.prototype.atanh=function(t){return ae("atanh")},n.prototype.erf=function(t){return ae("erf")},n.prototype.step=function(t,e){return ae("step")},n.prototype.fusedConv2d=function(t){return t.input,t.filter,t.convInfo,t.bias,t.activation,t.preluActivationWeights,ae("fusedConv2d")},n.prototype.conv2d=function(t,e,r){return ae("conv2d")},n.prototype.conv2dDerInput=function(t,e,r){return ae("conv2dDerInput")},n.prototype.conv2dDerFilter=function(t,e,r){return ae("conv2dDerFilter")},n.prototype.fusedDepthwiseConv2D=function(t){return t.input,t.filter,t.convInfo,t.bias,t.activation,t.preluActivationWeights,ae("fusedDepthwiseConv2D")},n.prototype.depthwiseConv2D=function(t,e,r){return ae("depthwiseConv2D")},n.prototype.depthwiseConv2DDerInput=function(t,e,r){return ae("depthwiseConv2DDerInput")},n.prototype.depthwiseConv2DDerFilter=function(t,e,r){return ae("depthwiseConv2DDerFilter")},n.prototype.conv3d=function(t,e,r){return ae("conv3d")},n.prototype.conv3dDerInput=function(t,e,r){return ae("conv3dDerInput")},n.prototype.conv3dDerFilter=function(t,e,r){return ae("conv3dDerFilter")},n.prototype.maxPool=function(t,e){return ae("maxPool")},n.prototype.maxPoolBackprop=function(t,e,r,a){return ae("maxPoolBackprop")},n.prototype.avgPool=function(t,e){return ae("avgPool")},n.prototype.avgPoolBackprop=function(t,e,r){return ae("avgPoolBackprop")},n.prototype.avgPool3d=function(t,e){return ae("avgPool3d")},n.prototype.avgPool3dBackprop=function(t,e,r){return ae("avgPool3dBackprop")},n.prototype.maxPool3d=function(t,e){return ae("maxPool3d")},n.prototype.maxPool3dBackprop=function(t,e,r,a){return ae("maxPool3dBackprop")},n.prototype.reshape=function(t,e){return ae("reshape")},n.prototype.cast=function(t,e){return ae("cast")},n.prototype.tile=function(t,e){return ae("tile")},n.prototype.pad=function(t,e,r){return ae("pad")},n.prototype.transpose=function(t,e){return ae("transpose")},n.prototype.gather=function(t,e,r){return ae("gather")},n.prototype.gatherND=function(t,e){return ae("gatherND")},n.prototype.scatterND=function(t,e,r){return ae("scatterND")},n.prototype.batchToSpaceND=function(t,e,r){return ae("batchToSpaceND")},n.prototype.spaceToBatchND=function(t,e,r){return ae("spaceToBatchND")},n.prototype.resizeBilinear=function(t,e,r,a){return ae("resizeBilinear")},n.prototype.resizeBilinearBackprop=function(t,e,r){return ae("resizeBilinearBackprop")},n.prototype.resizeNearestNeighbor=function(t,e,r,a){return ae("resizeNearestNeighbor")},n.prototype.resizeNearestNeighborBackprop=function(t,e,r){return ae("resizeNearestNeighborBackprop")},n.prototype.batchNormalization=function(t,e,r,a,i,u){return ae("batchNormalization")},n.prototype.localResponseNormalization4D=function(t,e,r,a,i){return ae("localResponseNormalization4D")},n.prototype.LRNGrad=function(t,e,r,a,i,u,l){return ae("LRNGrad")},n.prototype.multinomial=function(t,e,r,a){return ae("multinomial")},n.prototype.oneHot=function(t,e,r,a){return ae("oneHot")},n.prototype.cumsum=function(t,e,r,a){return ae("cumsum")},n.prototype.nonMaxSuppression=function(t,e,r,a,i){return ae("nonMaxSuppression")},n.prototype.fft=function(t){return ae("fft")},n.prototype.ifft=function(t){return ae("ifft")},n.prototype.complex=function(t,e){return ae("complex")},n.prototype.real=function(t){return ae("real")},n.prototype.imag=function(t){return ae("imag")},n.prototype.cropAndResize=function(t,e,r,a,i,u){return ae("cropAndResize")},n.prototype.depthToSpace=function(t,e,r){return ae("depthToSpace")},n.prototype.split=function(t,e,r){return ae("split")},n.prototype.sparseToDense=function(t,e,r,a){return ae("sparseToDense")},n.prototype.diag=function(t){return ae("diag")},n.prototype.fill=function(t,e,r){return ae("fill")},n.prototype.onesLike=function(t){return ae("onesLike")},n.prototype.zerosLike=function(t){return ae("zerosLike")},n.prototype.linspace=function(t,e,r){return ae("linspace")},n.prototype.dispose=function(){return ae("dispose")},n}();function ae(n){throw new Error("'"+n+"' not yet implemented or not found in the registry. Did you forget to import the kernel?")}function mi(n,t){for(var e=n.length,r=[],a=0;a<e;a++){var i=e-1-a,u=n[i]||1;(t[t.length-1-a]||1)>1&&u===1&&r.unshift(i)}return r}function Qt(n,t){for(var e=[],r=0;r<t.length;r++){var a=n[n.length-r-1],i=t.length-r-1,u=t[i];(a==null||a===1&&u>1)&&e.unshift(i)}return e}function et(n,t){for(var e=[],r=Math.max(n.length,t.length),a=0;a<r;a++){var i=n[n.length-a-1];i==null&&(i=1);var u=t[t.length-a-1];if(u==null&&(u=1),i===1)e.unshift(u);else if(u===1)e.unshift(i);else{if(i!==u)throw Error("Operands could not be broadcast together with shapes "+n+" and "+t+".");e.unshift(i)}}return e}function dl(n,t,e,r,a,i,u){u===void 0&&(u="channelsLast");var l,c=Qf(t),f=c[0],d=c[1];if(u==="channelsLast")l=[f,d,n[3],n[3]];else{if(u!=="channelsFirst")throw new Error("Unknown dataFormat "+u);l=[f,d,n[1],n[1]]}return vo(n,l,e,r,a,i,!1,u)}function $f(n,t,e,r,a,i,u){u===void 0&&(u="NDHWC");var l,c,f=_m(t),d=f[0],v=f[1],m=f[2];if(u==="NDHWC")c="channelsLast",l=[d,v,m,n[4],n[4]];else{if(u!=="NCDHW")throw new Error("Unknown dataFormat "+u);c="channelsFirst",l=[d,v,m,n[1],n[1]]}return Yf(n,l,e,r,a,!1,c,i)}function vo(n,t,e,r,a,i,u,l){u===void 0&&(u=!1),l===void 0&&(l="channelsLast");var c=[-1,-1,-1,-1],f=c[0],d=c[1],v=c[2],m=c[3];if(l==="channelsLast")f=n[0],d=n[1],v=n[2],m=n[3];else{if(l!=="channelsFirst")throw new Error("Unknown dataFormat "+l);f=n[0],m=n[1],d=n[2],v=n[3]}var g,b=t[0],w=t[1],S=t[3],_=Qf(e),E=_[0],R=_[1],C=Qf(r),A=C[0],D=C[1],k=ys(b,A),I=ys(w,D),N=function(ee,te,P,j,K,ne,M,G){var ie,oe,de;if(typeof ee=="number"){ie={top:ee,bottom:ee,left:ee,right:ee,type:ee===0?"VALID":"NUMBER"};var me=function(Fe,je,Ke,ut,yt){ut==null&&(ut=fS(Fe,je,Ke));var pt=Fe[0],Mt=Fe[1],ar=el((pt-je+2*ut)/Ke+1,yt);L(Bt(ar),function(){return"The output # of rows ("+ar+") must be an integer. Change the stride and/or zero pad parameters"});var gn=el((Mt-je+2*ut)/Ke+1,yt);return L(Bt(gn),function(){return"The output # of columns ("+gn+") must be an integer. Change the stride and/or zero pad parameters"}),[ar,gn]}([te,P],ne,j,ee,G);oe=me[0],de=me[1]}else if(ee==="same"){oe=Math.ceil(te/j),de=Math.ceil(P/K);var pe=Math.max(0,(oe-1)*j+ne-te),ke=Math.max(0,(de-1)*K+M-P),ye=Math.floor(pe/2),Ne=pe-ye,at=Math.floor(ke/2);ie={top:ye,bottom:Ne,left:at,right:ke-at,type:"SAME"}}else{if(ee!=="valid")throw Error("Unknown padding parameter: "+ee);ie={top:0,bottom:0,left:0,right:0,type:"VALID"},oe=Math.ceil((te-ne+1)/j),de=Math.ceil((P-M+1)/K)}return{padInfo:ie,outHeight:oe,outWidth:de}}(a,d,v,E,R,k,I,i),B=N.padInfo,V=N.outHeight,U=N.outWidth,J=u?S*m:S;return l==="channelsFirst"?g=[f,J,V,U]:l==="channelsLast"&&(g=[f,V,U,J]),{batchSize:f,dataFormat:l,inHeight:d,inWidth:v,inChannels:m,outHeight:V,outWidth:U,outChannels:J,padInfo:B,strideHeight:E,strideWidth:R,filterHeight:b,filterWidth:w,effectiveFilterHeight:k,effectiveFilterWidth:I,dilationHeight:A,dilationWidth:D,inShape:n,outShape:g,filterShape:t}}function Yf(n,t,e,r,a,i,u,l){i===void 0&&(i=!1),u===void 0&&(u="channelsLast");var c=[-1,-1,-1,-1,-1],f=c[0],d=c[1],v=c[2],m=c[3],g=c[4];if(u==="channelsLast")f=n[0],d=n[1],v=n[2],m=n[3],g=n[4];else{if(u!=="channelsFirst")throw new Error("Unknown dataFormat "+u);f=n[0],g=n[1],d=n[2],v=n[3],m=n[4]}var b,w=t[0],S=t[1],_=t[2],E=t[4],R=_m(e),C=R[0],A=R[1],D=R[2],k=_m(r),I=k[0],N=k[1],B=k[2],V=ys(w,I),U=ys(S,N),J=ys(_,B),ee=function(M,G,ie,oe,de,me,pe,ke,ye,Ne,at){var Fe,je,Ke,ut;if(typeof M=="number"){Fe={top:M,bottom:M,left:M,right:M,front:M,back:M,type:M===0?"VALID":"NUMBER"};var yt=function(Pa,_r,sa,Lt,Ht,cn){Ht==null&&(Ht=fS(Pa,_r,Lt));var Oh=Pa[0],Nh=Pa[1],Mh=Pa[2],za=el((Oh-_r+2*Ht)/Lt+1,cn);L(Bt(za),function(){return"The output # of depths ("+za+") must be an integer. Change the stride and/or zero pad parameters"});var Ua=el((Nh-_r+2*Ht)/Lt+1,cn);L(Bt(Ua),function(){return"The output # of rows ("+Ua+") must be an integer. Change the stride and/or zero pad parameters"});var Sr=el((Mh-_r+2*Ht)/Lt+1,cn);return L(Bt(Sr),function(){return"The output # of columns ("+Sr+") must be an integer. Change the stride and/or zero pad parameters"}),[za,Ua,Sr,sa]}([G,ie,oe,1],ke,1,de,M,at);je=yt[0],Ke=yt[1],ut=yt[2]}else if(M==="same"){je=Math.ceil(G/de),Ke=Math.ceil(ie/me),ut=Math.ceil(oe/pe);var pt=(je-1)*de+ke-G,Mt=(Ke-1)*me+ye-ie,ar=(ut-1)*pe+Ne-oe,gn=Math.floor(pt/2),oa=pt-gn,kn=Math.floor(Mt/2),Fr=Mt-kn,ir=Math.floor(ar/2);Fe={top:kn,bottom:Fr,left:ir,right:ar-ir,front:gn,back:oa,type:"SAME"}}else{if(M!=="valid")throw Error("Unknown padding parameter: "+M);Fe={top:0,bottom:0,left:0,right:0,front:0,back:0,type:"VALID"},je=Math.ceil((G-ke+1)/de),Ke=Math.ceil((ie-ye+1)/me),ut=Math.ceil((oe-Ne+1)/pe)}return{padInfo:Fe,outDepth:je,outHeight:Ke,outWidth:ut}}(a,d,v,m,C,A,D,V,U,J,l),te=ee.padInfo,P=ee.outDepth,j=ee.outHeight,K=ee.outWidth,ne=i?E*g:E;return u==="channelsFirst"?b=[f,ne,P,j,K]:u==="channelsLast"&&(b=[f,P,j,K,ne]),{batchSize:f,dataFormat:u,inDepth:d,inHeight:v,inWidth:m,inChannels:g,outDepth:P,outHeight:j,outWidth:K,outChannels:ne,padInfo:te,strideDepth:C,strideHeight:A,strideWidth:D,filterDepth:w,filterHeight:S,filterWidth:_,effectiveFilterDepth:V,effectiveFilterHeight:U,effectiveFilterWidth:J,dilationDepth:I,dilationHeight:N,dilationWidth:B,inShape:n,outShape:b,filterShape:t}}function fS(n,t,e,r){r===void 0&&(r=1);var a=ys(t,r);return Math.floor((n[0]*(e-1)-e+a)/2)}function Qf(n){return typeof n=="number"?[n,n,n]:n.length===2?[n[0],n[1],1]:n}function _m(n){return typeof n=="number"?[n,n,n]:n}function ys(n,t){return t<=1?n:n+(n-1)*(t-1)}function el(n,t){if(!t)return n;switch(t){case"round":return Math.round(n);case"ceil":return Math.ceil(n);case"floor":return Math.floor(n);default:throw new Error("Unknown roundingMode "+t)}}function Bs(n){var t=Qf(n),e=t[0],r=t[1],a=t[2];return e===1&&r===1&&a===1}function Vn(n,t){return Bs(n)||Bs(t)}function ig(n){if(n==="NHWC")return"channelsLast";if(n==="NCHW")return"channelsFirst";throw new Error("Unknown dataFormat "+n)}function hS(n,t,e){if(t==="complex64"){if(n.dtype==="complex64")return n.clone();var r=St(n.shape),a=n.toFloat(),i=e.complex(a,r);return r.dispose(),a.dispose(),i}if(!uN(n.dtype,t))return q.makeTensorFromDataId(n.dataId,n.shape,t);if(n.dtype==="complex64"){var u=e.real(n);return i=u.cast(t),u.dispose(),i}if(t==="int32")return e.int(n);if(t==="bool"){var l=ge(0,n.dtype);return i=e.notEqual(n,l),l.dispose(),i}throw new Error("Error in Cast: failed to cast "+n.dtype+" to "+t)}function Sm(n,t){return q.makeTensorFromDataId(n.dataId,t,n.dtype)}function dS(n,t,e){var r=(t-n)/(e-1),a=El(e,"float32");a[0]=n;for(var i=1;i<a.length;i++)a[i]=a[i-1]+r;return Vt(a,"float32")}function Em(n,t){if(n.length!==t.length)throw new Error("Cannot merge real and imag arrays of different lengths. real:"+n.length+", imag: "+t.length+".");for(var e=new Float32Array(2*n.length),r=0;r<e.length;r+=2)e[r]=n[r/2],e[r+1]=t[r/2];return e}function kw(n,t){return{real:n[2*t],imag:n[2*t+1]}}function B3(n,t,e,r){n[2*r]=t,n[2*r+1]=e}function L3(n,t,e){var r=(e?2:-2)*Math.PI*(n/t);return{real:Math.cos(r),imag:Math.sin(r)}}function P3(n,t,e){var r=function(i,u,l){return function(c,f,d){for(var v=0,m=c.length,g=0,b=!1;v<m;){var w=d(f,c[g=v+(m-v>>>1)]);w>0?v=g+1:(m=g,b=!w)}return b?v:-v-1}(i,u,l||z3)}(n,t,e),a=r<0?-(r+1):r;n.splice(a,0,t)}function z3(n,t){return n>t?1:n<t?-1:0}function og(n,t,e,r,a){return pS(n,t,e,r,a,0).selectedIndices}function sg(n,t,e,r,a,i){var u=pS(n,t,e,r,a,i);return u.numValidOutputs.dispose(),{selectedIndices:u.selectedIndices,selectedScores:u.selectedScores}}function pS(n,t,e,r,a,i,u,l){l===void 0&&(l=!1);for(var c=Array.from(t).map(function(C,A){return{score:C,boxIndex:A,suppressBeginIndex:0}}).filter(function(C){return C.score>a}).sort(Ow),f=i>0?-.5/i:0,d=[],v=[];d.length<e&&c.length>0;){var m=c.pop(),g=m.score,b=m.boxIndex,w=m.suppressBeginIndex;if(g<a)break;for(var S=!1,_=d.length-1;_>=w;--_){var E=U3(n,b,d[_]);if(E>=r){S=!0;break}if(m.score=m.score*V3(r,f,E),m.score<=a)break}m.suppressBeginIndex=d.length,S||(m.score===g?(d.push(b),v.push(m.score)):m.score>a&&P3(c,m,Ow))}var R=d.length;return l&&(d.fill(0,R),v.fill(0,R)),{selectedIndices:Vt(d,"int32"),selectedScores:Vt(v,"float32"),numValidOutputs:ge(R,"int32")}}function U3(n,t,e){var r=n.subarray(4*t,4*t+4),a=n.subarray(4*e,4*e+4),i=Math.min(r[0],r[2]),u=Math.min(r[1],r[3]),l=Math.max(r[0],r[2]),c=Math.max(r[1],r[3]),f=Math.min(a[0],a[2]),d=Math.min(a[1],a[3]),v=Math.max(a[0],a[2]),m=Math.max(a[1],a[3]),g=(l-i)*(c-u),b=(v-f)*(m-d);if(g<=0||b<=0)return 0;var w=Math.max(i,f),S=Math.max(u,d),_=Math.min(l,v),E=Math.min(c,m),R=Math.max(_-w,0)*Math.max(E-S,0);return R/(g+b-R)}function V3(n,t,e){var r=Math.exp(t*e*e);return e<=n?r:0}function Ow(n,t){return n.score-t.score||n.score===t.score&&t.boxIndex-n.boxIndex}function vS(n,t,e){var r=new Array(n.rank).fill(0),a=n.shape.slice();return t.map(function(i){a[e]=i;var u=n.slice(r,a);return r[e]+=i,u})}function mS(n,t){for(var e=new Array(n.rank),r=0;r<e.length;r++)e[r]=n.shape[r]*t[r];var a=Ue(e,n.dtype);for(r=0;r<a.values.length;++r){for(var i=a.indexToLoc(r),u=new Array(n.rank),l=0;l<u.length;l++)u[l]=i[l]%n.shape[l];var c=n.locToIndex(u);a.values[r]=n.values[c]}return a.toTensor()}function gS(n,t,e,r,a){for(var i=t[t.length-1],u=[n.length/i,i],l=u[0],c=u[1],f=cl(e,l*r),d=cl("int32",l*r),v=0;v<l;v++){for(var m=v*c,g=n.subarray(m,m+c),b=[],w=0;w<g.length;w++)b.push({value:g[w],index:w});b.sort(function(C,A){return A.value-C.value});var S=v*r,_=f.subarray(S,S+r),E=d.subarray(S,S+r);for(w=0;w<r;w++)_[w]=b[w].value,E[w]=b[w].index}var R=t.slice();return R[R.length-1]=r,[mn(f,R,e),mn(d,R,"int32")]}function ug(n,t){for(var e=[],r=0;r<t.length;r++)t[r]&&e.push(r);var a=Ue(n,"int32"),i=Ue([e.length,n.length],"int32");for(r=0;r<e.length;r++){var u=a.indexToLoc(e[r]),l=r*n.length;i.values.set(u,l)}return i.toTensor()}var H3=function(n,t){this.outputShape=[],this.outputShape=n,this.variableNames=t.map(function(a,i){return"T"+i});var e=[];this.variableNames.forEach(function(a){e.push("float v"+a+" = get"+a+"AtOutCoords();")});var r=this.variableNames.map(function(a){return"v"+a}).join(" + ");this.userCode=`
      void main() {
        `+e.join(`
        `)+`

        float result = `+r+`;
        setOutput(result);
      }
    `},j3=function(n,t){this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n,this.variableNames=t.map(function(a,i){return"T"+i});var e=[];this.variableNames.forEach(function(a){e.push("vec4 v"+a+" = get"+a+"AtOutCoords();")});var r=this.variableNames.map(function(a){return"v"+a}).join(" + ");this.userCode=`
      void main() {
        `+e.join(`
        `)+`

        vec4 result = `+r+`;
        setOutput(result);
      }
    `},W3=function(n,t,e){this.variableNames=["A"];var r=n.windowSize,a=n.batchSize,i=n.inSize,u=Math.ceil(i/r);e||this.variableNames.push("bestIndicesA"),this.outputShape=[a,u];var l=t==="max"?">":"<",c=e?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));";this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * `+r+`;

        int bestIndex = inOffset;
        float bestValue = getA(batch, bestIndex);

        for (int i = 0; i < `+r+`; i++) {
          int inIdx = `+c+`;
          float candidate = getA(batch, inIdx);
          if (candidate `+l+` bestValue) {
            bestValue = candidate;
            bestIndex = inIdx;
          }
        }
        setOutput(float(bestIndex));
      }
    `};function yS(n,t){return["x","y","z","w","u","v"].slice(0,t).map(function(e){return n+"."+e})}function Ln(n,t){return t===1?[n]:yS(n,t)}function Sn(){var n,t,e,r,a,i,u,l,c,f;return ue().getNumber("WEBGL_VERSION")===2?(n="#version 300 es",t="in",e="out",r="in",a="texture",i="outputColor",u="out vec4 outputColor;",l=`
      bool isnan_custom(float val) {
        return (val > 0.0 || val < 0.0) ? false : val != 0.0;
      }

      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan_custom(val.x),
          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));
      }

      #define isnan(value) isnan_custom(value)
    `,c="",f=`
      #define round(value) newRound(value)
      int newRound(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 newRound(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `):(n="",t="attribute",e="varying",r="varying",a="texture2D",i="gl_FragColor",u="",l=`
      #define isnan(value) isnan_custom(value)
      bool isnan_custom(float val) {
        return (val > 0. || val < 1. || val == 0.) ? false : true;
      }
      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));
      }
    `,c=`
      uniform float INFINITY;

      bool isinf(float val) {
        return abs(val) == INFINITY;
      }
      bvec4 isinf(vec4 val) {
        return equal(abs(val), vec4(INFINITY));
      }
    `,f=`
      int round(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 round(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `),{version:n,attribute:t,varyingVs:e,varyingFs:r,texture2D:a,output:i,defineOutput:u,defineSpecialNaN:l,defineSpecialInf:c,defineRound:f}}function to(n,t,e){e===void 0&&(e="index");var r=Zr(t);return r.map(function(a,i){return"int "+n[i]+" = "+e+" / "+a+"; "+(i===r.length-1?"int "+n[i+1]+" = "+e+" - "+n[i]+" * "+a:"index -= "+n[i]+" * "+a)+";"}).join("")}function lg(n){var t=Zr(n).map(function(e){return e.toString()});return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * `+t[0]+" + coords.y * "+t[1]+` + coords.z;
  }
`}var bS=`
  const float FLOAT_MAX = 1.70141184e38;
  const float FLOAT_MIN = 1.17549435e-38;

  lowp vec4 encode_float(highp float v) {
    if (isnan(v)) {
      return vec4(255, 255, 255, 255);
    }

    highp float av = abs(v);

    if(av < FLOAT_MIN) {
      return vec4(0.0, 0.0, 0.0, 0.0);
    } else if(v > FLOAT_MAX) {
      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;
    } else if(v < -FLOAT_MAX) {
      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;
    }

    highp vec4 c = vec4(0,0,0,0);

    highp float e = floor(log2(av));
    highp float m = exp2(fract(log2(av))) - 1.0;

    c[2] = floor(128.0 * m);
    m -= c[2] / 128.0;
    c[1] = floor(32768.0 * m);
    m -= c[1] / 32768.0;
    c[0] = floor(8388608.0 * m);

    highp float ebias = e + 127.0;
    c[3] = floor(ebias / 2.0);
    ebias -= c[3] * 2.0;
    c[2] += floor(ebias) * 128.0;

    c[3] += 128.0 * step(0.0, -v);

    return c / 255.0;
  }
`;function G3(n,t,e,r){var a=[];n.forEach(function(g){var b=Ce(g.shapeInfo.logicalShape);g.shapeInfo.isUniform?a.push("uniform float "+g.name+(b>1?"["+b+"]":"")+";"):(a.push("uniform sampler2D "+g.name+";"),a.push("uniform int offset"+g.name+";"))});var i,u,l=a.join(`
`),c=n.map(function(g){return function(b,w,S){S===void 0&&(S=!1);var _="";_+=S?xS(b):fs(b);var E=b.shapeInfo.logicalShape,R=w.logicalShape;return E.length<=R.length&&(_+=S?function(C,A){var D,k=C.name,I=k.charAt(0).toUpperCase()+k.slice(1),N="get"+I+"AtOutCoords",B=C.shapeInfo.logicalShape.length,V=A.logicalShape.length,U=mi(C.shapeInfo.logicalShape,A.logicalShape),J=wt(V),ee=V-B,te=["x","y","z","w","u","v"];D=B===0?"":V<2&&U.length>=1?"coords = 0;":U.map(function(ie){return"coords."+te[ie+ee]+" = 0;"}).join(`
`);var P="";P=V<2&&B>0?"coords":C.shapeInfo.logicalShape.map(function(ie,oe){return"coords."+te[oe+ee]}).join(", ");var j="return outputValue;",K=Ce(C.shapeInfo.logicalShape)===1,ne=Ce(A.logicalShape)===1;if(B!==1||K||ne){if(K&&!ne)j=V===1?`
        return vec4(outputValue.x, outputValue.x, 0., 0.);
      `:`
        return vec4(outputValue.x);
      `;else if(U.length){var M=B-2,G=B-1;U.indexOf(M)>-1&&U.indexOf(G)>-1?j="return vec4(outputValue.x);":U.indexOf(M)>-1?j="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":U.indexOf(G)>-1&&(j="return vec4(outputValue.xx, outputValue.zz);")}}else j=`
      return vec4(outputValue.xy, outputValue.xy);
    `;return`
    vec4 `+N+`() {
      `+J+` coords = getOutputCoords();
      `+D+`
      vec4 outputValue = get`+I+"("+P+`);
      `+j+`
    }
  `}(b,w):function(C,A){var D=C.name,k=D.charAt(0).toUpperCase()+D.slice(1),I="get"+k+"AtOutCoords",N=A.texShape,B=C.shapeInfo.texShape,V=C.shapeInfo.logicalShape.length,U=A.logicalShape.length;if(!C.shapeInfo.isUniform&&V===U&&C.shapeInfo.flatOffset==null&&un(B,N))return`
      float `+I+`() {
        return sampleTexture(`+D+`, resultUV);
      }
    `;var J,ee=wt(U),te=mi(C.shapeInfo.logicalShape,A.logicalShape),P=U-V,j=["x","y","z","w","u","v"];J=V===0?"":U<2&&te.length>=1?"coords = 0;":te.map(function(ne){return"coords."+j[ne+P]+" = 0;"}).join(`
`);var K="";return K=U<2&&V>0?"coords":C.shapeInfo.logicalShape.map(function(ne,M){return"coords."+j[M+P]}).join(", "),`
    float `+I+`() {
      `+ee+` coords = getOutputCoords();
      `+J+`
      return get`+k+"("+K+`);
    }
  `}(b,w)),_}(g,t,r)}).join(`
`),f=t.texShape,d=Sn(),v=function(g){return`
    float sampleTexture(sampler2D textureSampler, vec2 uv) {
      return `+g.texture2D+`(textureSampler, uv).r;
    }
  `}(d),m=function(g){return g.version+`
    precision highp float;
    precision highp int;
    precision highp sampler2D;
    `+g.varyingFs+` vec2 resultUV;
    `+g.defineOutput+`
    const vec2 halfCR = vec2(0.5, 0.5);

    struct ivec5
    {
      int x;
      int y;
      int z;
      int w;
      int u;
    };

    struct ivec6
    {
      int x;
      int y;
      int z;
      int w;
      int u;
      int v;
    };

    uniform float NAN;
    `+g.defineSpecialNaN+`
    `+g.defineSpecialInf+`
    `+g.defineRound+`

    int imod(int x, int y) {
      return x - y * (x / y);
    }

    int idiv(int a, int b, float sign) {
      int res = a / b;
      int mod = imod(a, b);
      if (sign < 0. && mod != 0) {
        res -= 1;
      }
      return res;
    }

    //Based on the work of Dave Hoskins
    //https://www.shadertoy.com/view/4djSRW
    #define HASHSCALE1 443.8975
    float random(float seed){
      vec2 p = resultUV * seed;
      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);
      p3 += dot(p3, p3.yzx + 19.19);
      return fract((p3.x + p3.y) * p3.z);
    }

    `+q3+`
    `+K3+`
    `+X3+`
  `}(d);return t.isPacked?(i=function(g,b){switch(g.length){case 0:return`
    int getOutputCoords() {
      return 0;
    }
  `;case 1:return function(C,A){var D=[Math.ceil(A[0]/2),Math.ceil(A[1]/2)];return D[0]===1?`
      int getOutputCoords() {
        return 2 * int(resultUV.x * `+D[1]+`.0);
      }
    `:D[1]===1?`
      int getOutputCoords() {
        return 2 * int(resultUV.y * `+D[0]+`.0);
      }
    `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+D[0]+", "+D[1]+`));
      return 2 * (resTexRC.x * `+D[1]+` + resTexRC.y);
    }
  `}(0,b);case 2:return function(C,A){var D=[Math.ceil(A[0]/2),Math.ceil(A[1]/2)];if(un(C,A))return`
      ivec2 getOutputCoords() {
        return 2 * ivec2(resultUV.yx * vec2(`+D[0]+", "+D[1]+`));
      }
    `;var k=Math.ceil(C[1]/2);return`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+D[0]+", "+D[1]+`));

      int index = resTexRC.x * `+D[1]+` + resTexRC.y;
      int r = 2 * (index / `+k+`);
      int c = imod(index, `+k+`) * 2;

      return ivec2(r, c);
    }
  `}(g,b);case 3:return w=g,S=b,_=[Math.ceil(S[0]/2),Math.ceil(S[1]/2)],E=Math.ceil(w[2]/2),R=E*Math.ceil(w[1]/2),`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+_[0]+", "+_[1]+`));
      int index = resTexRC.x * `+_[1]+` + resTexRC.y;

      int b = index / `+R+`;
      index -= b * `+R+`;

      int r = 2 * (index / `+E+`);
      int c = imod(index, `+E+`) * 2;

      return ivec3(b, r, c);
    }
  `;default:return function(C,A){for(var D=[Math.ceil(A[0]/2),Math.ceil(A[1]/2)],k=Math.ceil(C[C.length-1]/2),I=k*Math.ceil(C[C.length-2]/2),N=I,B="",V="b, r, c",U=2;U<C.length-1;U++)N*=C[C.length-U-1],B=`
      int b`+U+" = index / "+N+`;
      index -= b`+U+" * "+N+`;
    `+B,V="b"+U+", "+V;return`
    ivec`+C.length+` getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+D[0]+", "+D[1]+`));
      int index = resTexRC.x * `+D[1]+` + resTexRC.y;

      `+B+`

      int b = index / `+I+`;
      index -= b * `+I+`;

      int r = 2 * (index / `+k+`);
      int c = imod(index, `+k+`) * 2;

      return ivec`+C.length+"("+V+`);
    }
  `}(g,b)}var w,S,_,E,R}(t.logicalShape,f),u=function(g){return`
    void setOutput(vec4 val) {
      `+g.output+` = val;
    }
  `}(d)):(i=function(g,b){switch(g.length){case 0:return`
    int getOutputCoords() {
      return 0;
    }
  `;case 1:return function(_,E){return E[0]===1?`
      int getOutputCoords() {
        return int(resultUV.x * `+E[1]+`.0);
      }
    `:E[1]===1?`
      int getOutputCoords() {
        return int(resultUV.y * `+E[0]+`.0);
      }
    `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+E[0]+", "+E[1]+`));
      return resTexRC.x * `+E[1]+` + resTexRC.y;
    }
  `}(0,b);case 2:return function(_,E){return un(_,E)?`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(`+E[0]+", "+E[1]+`));
      }
    `:_[1]===1?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(`+E[0]+", "+E[1]+`));
        int index = resTexRC.x * `+E[1]+` + resTexRC.y;
        return ivec2(index, 0);
      }
    `:_[0]===1?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(`+E[0]+", "+E[1]+`));
        int index = resTexRC.x * `+E[1]+` + resTexRC.y;
        return ivec2(0, index);
      }
    `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+E[0]+", "+E[1]+`));
      int index = resTexRC.x * `+E[1]+` + resTexRC.y;
      int r = index / `+_[1]+`;
      int c = index - r * `+_[1]+`;
      return ivec2(r, c);
    }
  `}(g,b);case 3:return w=b,S=to(["r","c","d"],g),`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+w[0]+", "+w[1]+`));
      int index = resTexRC.x * `+w[1]+` + resTexRC.y;
      `+S+`
      return ivec3(r, c, d);
    }
  `;case 4:return function(_,E){var R=to(["r","c","d","d2"],_);return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(`+E[0]+", "+E[1]+`));
      int index = resTexRC.x * `+E[1]+` + resTexRC.y;
      `+R+`
      return ivec4(r, c, d, d2);
    }
  `}(g,b);case 5:return function(_,E){var R=to(["r","c","d","d2","d3"],_);return`
    ivec5 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx * vec2(`+E[0]+`,
                             `+E[1]+`));

      int index = resTexRC.x * `+E[1]+` + resTexRC.y;

      `+R+`

      ivec5 outShape = ivec5(r, c, d, d2, d3);
      return outShape;
    }
  `}(g,b);case 6:return function(_,E){var R=to(["r","c","d","d2","d3","d4"],_);return`
    ivec6 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(`+E[0]+", "+E[1]+`));
      int index = resTexRC.x * `+E[1]+` + resTexRC.y;

      `+R+`

      ivec6 result = ivec6(r, c, d, d2, d3, d4);
      return result;
    }
  `}(g,b);default:throw new Error(g.length+"-D output sampling is not yet supported")}var w,S}(t.logicalShape,f),u=function(g){return`
    void setOutput(float val) {
      `+g.output+` = vec4(val, 0, 0, 0);
    }
  `}(d)),r&&(m+=$3),[m,v,u,l,i,c,e].join(`
`)}function fs(n){var t=n.shapeInfo.logicalShape;switch(t.length){case 0:return function(e){var r=e.name,a="get"+r.charAt(0).toUpperCase()+r.slice(1);if(e.shapeInfo.isUniform)return"float "+a+"() {return "+r+";}";var i=e.shapeInfo.texShape,u=i[0],l=i[1];if(u===1&&l===1)return`
      float `+a+`() {
        return sampleTexture(`+r+`, halfCR);
      }
    `;var c=e.shapeInfo.texShape,f=c[0],d=c[1],v=Yi(r);return`
    float `+a+`() {
      vec2 uv = uvFromFlat(`+f+", "+d+", "+v+`);
      return sampleTexture(`+r+`, uv);
    }
  `}(n);case 1:return function(e){var r=e.name,a="get"+r.charAt(0).toUpperCase()+r.slice(1);if(e.shapeInfo.isUniform)return`
      float `+a+`(int index) {
        `+is(e)+`
      }
    `;var i=e.shapeInfo.texShape,u=i[0],l=i[1];if(l===1&&u===1)return`
      float `+a+`(int index) {
        return sampleTexture(`+r+`, halfCR);
      }
    `;var c=Yi(r);return l===1?`
      float `+a+`(int index) {
        vec2 uv = vec2(0.5, (float(index + `+c+") + 0.5) / "+u+`.0);
        return sampleTexture(`+r+`, uv);
      }
    `:u===1?`
      float `+a+`(int index) {
        vec2 uv = vec2((float(index + `+c+") + 0.5) / "+l+`.0, 0.5);
        return sampleTexture(`+r+`, uv);
      }
    `:`
    float `+a+`(int index) {
      vec2 uv = uvFromFlat(`+u+", "+l+", index + "+c+`);
      return sampleTexture(`+r+`, uv);
    }
  `}(n);case 2:return function(e){var r=e.shapeInfo.logicalShape,a=e.name,i="get"+a.charAt(0).toUpperCase()+a.slice(1),u=e.shapeInfo.texShape;if(u!=null&&un(r,u)){var l=u[0],c=u[1];return`
    float `+i+`(int row, int col) {
      vec2 uv = (vec2(col, row) + halfCR) / vec2(`+c+".0, "+l+`.0);
      return sampleTexture(`+a+`, uv);
    }
  `}var f=Ji(r),d=f.newShape,v=f.keptDims,m=d;if(m.length<r.length){var g=hs(e,m);return`
      `+fs(g)+`
      float `+i+`(int row, int col) {
        return `+i+"("+ds(["row","col"],v)+`);
      }
    `}if(e.shapeInfo.isUniform)return`
      float `+i+`(int row, int col) {
        int index = round(dot(vec2(row, col), vec2(`+r[1]+`, 1)));
        `+is(e)+`
      }
    `;var b=u[0],w=u[1],S=Yi(a);return w===1?`
    float `+i+`(int row, int col) {
      float index = dot(vec3(row, col, `+S+"), vec3("+r[1]+`, 1, 1));
      vec2 uv = vec2(0.5, (index + 0.5) / `+b+`.0);
      return sampleTexture(`+a+`, uv);
    }
  `:b===1?`
    float `+i+`(int row, int col) {
      float index = dot(vec3(row, col, `+S+"), vec3("+r[1]+`, 1, 1));
      vec2 uv = vec2((index + 0.5) / `+w+`.0, 0.5);
      return sampleTexture(`+a+`, uv);
    }
  `:`
  float `+i+`(int row, int col) {
    // Explicitly use integer operations as dot() only works on floats.
    int index = row * `+r[1]+" + col + "+S+`;
    vec2 uv = uvFromFlat(`+b+", "+w+`, index);
    return sampleTexture(`+a+`, uv);
  }
`}(n);case 3:return function(e){var r=e.shapeInfo.logicalShape,a=e.name,i="get"+a.charAt(0).toUpperCase()+a.slice(1),u=r[1]*r[2],l=r[2],c=Ji(r),f=c.newShape,d=c.keptDims,v=f;if(v.length<r.length){var m=hs(e,v);return`
        `+fs(m)+`
        float `+i+`(int row, int col, int depth) {
          return `+i+"("+ds(["row","col","depth"],d)+`);
        }
      `}if(e.shapeInfo.isUniform)return`
      float `+i+`(int row, int col, int depth) {
        int index = round(dot(vec3(row, col, depth),
                          vec3(`+u+", "+l+`, 1)));
        `+is(e)+`
      }
    `;var g=e.shapeInfo.texShape,b=g[0],w=g[1],S=e.shapeInfo.flatOffset;if(w===u&&S==null)return`
        float `+i+`(int row, int col, int depth) {
          float texR = float(row);
          float texC = dot(vec2(col, depth), vec2(`+l+`, 1));
          vec2 uv = (vec2(texC, texR) + halfCR) /
                     vec2(`+w+".0, "+b+`.0);
          return sampleTexture(`+a+`, uv);
        }
      `;if(w===l&&S==null)return`
    float `+i+`(int row, int col, int depth) {
      float texR = dot(vec2(row, col), vec2(`+r[1]+`, 1));
      float texC = float(depth);
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(`+w+".0, "+b+`.0);
      return sampleTexture(`+a+`, uv);
    }
  `;var _=Yi(a);return`
      float `+i+`(int row, int col, int depth) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * `+u+" + col * "+l+" + depth + "+_+`;
        vec2 uv = uvFromFlat(`+b+", "+w+`, index);
        return sampleTexture(`+a+`, uv);
      }
  `}(n);case 4:return function(e){var r=e.shapeInfo.logicalShape,a=e.name,i="get"+a.charAt(0).toUpperCase()+a.slice(1),u=r[3],l=r[2]*u,c=r[1]*l,f=Ji(r),d=f.newShape,v=f.keptDims;if(d.length<r.length){var m=hs(e,d);return`
      `+fs(m)+`
      float `+i+`(int row, int col, int depth, int depth2) {
        return `+i+"("+ds(["row","col","depth","depth2"],v)+`);
      }
    `}if(e.shapeInfo.isUniform)return`
      float `+i+`(int row, int col, int depth, int depth2) {
        int index = round(dot(vec4(row, col, depth, depth2),
                          vec4(`+c+", "+l+", "+u+`, 1)));
        `+is(e)+`
      }
    `;var g=e.shapeInfo.flatOffset,b=e.shapeInfo.texShape,w=b[0],S=b[1];if(S===c&&g==null)return`
      float `+i+`(int row, int col, int depth, int depth2) {
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(`+l+", "+u+`, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(`+S+".0, "+w+`.0);
        return sampleTexture(`+a+`, uv);
      }
    `;if(S===u&&g==null)return`
      float `+i+`(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(`+r[1]*r[2]+", "+r[2]+`, 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(`+S+".0, "+w+`.0);
        return sampleTexture(`+a+`, uv);
      }
    `;var _=Yi(a);return`
    float `+i+`(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * `+c+" + col * "+l+` +
          depth * `+u+` + depth2;
      vec2 uv = uvFromFlat(`+w+", "+S+", index + "+_+`);
      return sampleTexture(`+a+`, uv);
    }
  `}(n);case 5:return function(e){var r=e.shapeInfo.logicalShape,a=e.name,i="get"+a.charAt(0).toUpperCase()+a.slice(1),u=r[4],l=r[3]*u,c=r[2]*l,f=r[1]*c,d=Ji(r),v=d.newShape,m=d.keptDims;if(v.length<r.length){var g=hs(e,v);return`
      `+fs(g)+`
      float `+i+`(int row, int col, int depth, int depth2, int depth3) {
        return `+i+"("+ds(["row","col","depth","depth2","depth3"],m)+`);
      }
    `}if(e.shapeInfo.isUniform)return`
      float `+i+`(int row, int col, int depth, int depth2, int depth3) {
        float index = dot(
          vec4(row, col, depth, depth2),
          vec4(`+f+", "+c+", "+l+", "+u+`)) +
          depth3;
        `+is(e)+`
      }
    `;var b=e.shapeInfo.flatOffset,w=e.shapeInfo.texShape,S=w[0],_=w[1];if(_===f&&b==null)return`
      float `+i+`(int row, int col, int depth, int depth2, int depth3) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
                         vec4(`+c+", "+l+", "+u+`, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(`+_+".0, "+S+`.0);
        return sampleTexture(`+a+`, uv);
      }
    `;if(_===u&&b==null)return`
      float `+i+`(int row, int col, int depth, int depth2, int depth3) {
        float texR = dot(
          vec4(row, col, depth, depth2),
          vec4(`+r[1]*r[2]*r[3]+`,
               `+r[2]*r[3]+", "+r[3]+`, 1));
        int texC = depth3;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(`+_+".0, "+S+`.0);
        return sampleTexture(`+a+`, uv);
      }
    `;var E=Yi(a);return`
    float `+i+`(int row, int col, int depth, int depth2, int depth3) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * `+f+" + col * "+c+" + depth * "+l+` +
          depth2 * `+u+" + depth3 + "+E+`;
      vec2 uv = uvFromFlat(`+S+", "+_+`, index);
      return sampleTexture(`+a+`, uv);
    }
  `}(n);case 6:return function(e){var r=e.shapeInfo.logicalShape,a=e.name,i="get"+a.charAt(0).toUpperCase()+a.slice(1),u=Ji(r),l=u.newShape,c=u.keptDims;if(l.length<r.length){var f=hs(e,l);return`
      `+fs(f)+`
      float `+i+`(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        return `+i+"("+ds(["row","col","depth","depth2","depth3","depth4"],c)+`);
      }
    `}var d=r[5],v=r[4]*d,m=r[3]*v,g=r[2]*m,b=r[1]*g;if(e.shapeInfo.isUniform)return`
      float `+i+`(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
        int index = round(dot(
          vec4(row, col, depth, depth2),
          vec4(`+b+", "+g+", "+m+", "+v+`)) +
          dot(
            vec2(depth3, depth4),
            vec2(`+d+`, 1)));
        `+is(e)+`
      }
    `;var w=e.shapeInfo.flatOffset,S=e.shapeInfo.texShape,_=S[0],E=S[1];if(E===b&&w==null)return`
      float `+i+`(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
          vec4(`+g+", "+m+", "+v+", "+d+`)) +
               float(depth4);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(`+E+".0, "+_+`.0);
        return sampleTexture(`+a+`, uv);
      }
    `;if(E===d&&w==null)return`
      float `+i+`(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        float texR = dot(vec4(row, col, depth, depth2),
          vec4(`+r[1]*r[2]*r[3]*r[4]+`,
               `+r[2]*r[3]*r[4]+`,
               `+r[3]*r[4]+`,
               `+r[4]+`)) + float(depth3);
        int texC = depth4;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(`+E+".0, "+_+`.0);
        return sampleTexture(`+a+`, uv);
      }
    `;var R=Yi(a);return`
    float `+i+`(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * `+b+" + col * "+g+" + depth * "+m+` +
          depth2 * `+v+" + depth3 * "+d+" + depth4 + "+R+`;
      vec2 uv = uvFromFlat(`+_+", "+E+`, index);
      return sampleTexture(`+a+`, uv);
    }
  `}(n);default:throw new Error(t.length+"-D input sampling is not yet supported")}}function xS(n){var t,e,r;switch(n.shapeInfo.logicalShape.length){case 0:return t=n.name,e="get"+t.charAt(0).toUpperCase()+t.slice(1),r=Sn(),`
    vec4 `+e+`() {
      return `+r.texture2D+"("+t+`, halfCR);
    }
  `;case 1:return function(a){var i=a.name,u="get"+i.charAt(0).toUpperCase()+i.slice(1),l=a.shapeInfo.texShape,c=[Math.ceil(l[0]/2),Math.ceil(l[1]/2)],f=Sn();return`
    vec4 `+u+`(int index) {
      vec2 uv = packedUVfrom1D(
        `+c[0]+", "+c[1]+`, index);
      return `+f.texture2D+"("+i+`, uv);
    }
  `}(n);case 2:return function(a){var i=a.shapeInfo.logicalShape,u=a.name,l="get"+u.charAt(0).toUpperCase()+u.slice(1),c=a.shapeInfo.texShape,f=c[0],d=c[1],v=Sn();if(c!=null&&un(i,c))return`
      vec4 `+l+`(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(`+d+".0, "+f+`.0);

        return `+v.texture2D+"("+u+`, uv);
      }
    `;var m=[Math.ceil(c[0]/2),Math.ceil(c[1]/2)],g=Math.ceil(i[1]/2);return`
    vec4 `+l+`(int row, int col) {
      vec2 uv = packedUVfrom2D(`+g+", "+m[0]+", "+m[1]+`, row, col);
      return `+v.texture2D+"("+u+`, uv);
    }
  `}(n);case 3:return function(a){var i=a.shapeInfo.logicalShape,u=a.name,l="get"+u.charAt(0).toUpperCase()+u.slice(1),c=a.shapeInfo.texShape,f=[Math.ceil(c[0]/2),Math.ceil(c[1]/2)];if(i[0]===1){var d=i.slice(1),v=hs(a,d);return`
        `+xS(v)+`
        vec4 `+l+`(int b, int row, int col) {
          return `+l+"("+ds(["b","row","col"],[1,2])+`);
        }
      `}var m=f[0],g=f[1],b=Math.ceil(i[2]/2),w=b*Math.ceil(i[1]/2),S=Sn();return`
    vec4 `+l+`(int b, int row, int col) {
      vec2 uv = packedUVfrom3D(
        `+m+", "+g+", "+w+", "+b+`, b, row, col);
      return `+S.texture2D+"("+u+`, uv);
    }
  `}(n);default:return function(a){for(var i=a.shapeInfo.logicalShape,u=i.length,l=a.name,c="get"+l.charAt(0).toUpperCase()+l.slice(1),f=a.shapeInfo.texShape,d=[Math.ceil(f[0]/2),Math.ceil(f[1]/2)],v=d[0],m=d[1],g=Math.ceil(i[u-1]/2),b=g*Math.ceil(i[u-2]/2),w="int b, int row, int col",S="b * "+b+" + (row / 2) * "+g+" + (col / 2)",_=2;_<u-1;_++)w="int b"+_+", "+w,b*=i[u-_-1],S="b"+_+" * "+b+" + "+S;var E=Sn();return`
    vec4 `+c+"("+w+`) {
      int index = `+S+`;
      int texR = index / `+m+`;
      int texC = index - texR * `+m+`;
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(`+m+", "+v+`);
      return `+E.texture2D+"("+l+`, uv);
    }
  `}(n)}}var q3=`
vec2 uvFromFlat(int texNumR, int texNumC, int index) {
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
vec2 packedUVfrom1D(int texNumR, int texNumC, int index) {
  int texelIndex = index / 2;
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,K3=`
vec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,
  int texNumC, int row, int col) {
  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,X3=`
vec2 packedUVfrom3D(int texNumR, int texNumC,
    int texelsInBatch, int texelsInLogicalRow, int b,
    int row, int col) {
  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,$3=`
  float getChannel(vec4 frag, vec2 innerDims) {
    vec2 modCoord = mod(innerDims, 2.);
    return modCoord.x == 0. ?
      (modCoord.y == 0. ? frag.r : frag.g) :
      (modCoord.y == 0. ? frag.b : frag.a);
  }
  float getChannel(vec4 frag, int dim) {
    float modCoord = mod(float(dim), 2.);
    return modCoord == 0. ? frag.r : frag.g;
  }
`;function Yi(n){return"offset"+n}function is(n){var t=n.name,e=Ce(n.shapeInfo.logicalShape);return e<2?"return "+t+";":`
    for (int i = 0; i < `+e+`; i++) {
      if (i == index) {
        return `+t+`[i];
      }
    }
  `}function wt(n){if(n<=1)return"int";if(n===2)return"ivec2";if(n===3)return"ivec3";if(n===4)return"ivec4";if(n===5)return"ivec5";if(n===6)return"ivec6";throw Error("GPU for rank "+n+" is not yet supported")}function hs(n,t){var e=JSON.parse(JSON.stringify(n));return e.shapeInfo.logicalShape=t,e}function ds(n,t){return t.map(function(e){return n[e]}).join(", ")}var Y3=function(n,t,e,r){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,L(n.length>2,function(){return"Packed arg"+(e.charAt(0).toUpperCase()+e.slice(1))+" supports only inputs with rank above 2."});var a=n[n.length-1],i=Math.ceil(a/t);this.outputShape=n.slice(0,-1),i>1&&this.outputShape.push(i),r||this.variableNames.push("bestIndicesA");var u,l,c=this.outputShape,f=c.length,d=wt(f),v=Ln("coords",f);if(i===1){var m=wt(l=f+1);u=`
        `+m+" sourceLocR = "+m+"("+v.join()+`, 0);
        ++`+v[f-1]+`;
        `+m+" sourceLocG = "+m+"("+v.join()+`, 0);
        ++`+v[f-2]+`;
        `+m+" sourceLocA = "+m+"("+v.join()+`, 0);
        --`+v[f-1]+`;
        `+m+" sourceLocB = "+m+"("+v.join()+`, 0);
        --`+v[f-2]+";"}else l=f,u=`
        `+d+` sourceLocR = coords;
        ++`+v[f-1]+`;
        `+d+` sourceLocG = coords;
        ++`+v[f-2]+`;
        `+d+` sourceLocA = coords;
        --`+v[f-1]+`;
        `+d+` sourceLocB = coords;
        --`+v[f-2]+";";var g=["x","y","z","w","u","v"].slice(0,l),b="."+g[l-1],w=g.map(function(I){return"int "+I}),S=Ln("sourceLocR",l-1).concat("inIdx.r"),_=Ln("sourceLocG",l-1).concat("inIdx.g"),E=Ln("sourceLocB",l-1).concat("inIdx.b"),R=Ln("sourceLocA",l-1).concat("inIdx.a"),C=e==="max"?"greaterThan":"lessThan",A=r?"":`
          inIdx = round(vec4(getBestIndicesAChannel(`+S.join()+`),
                             getBestIndicesAChannel(`+_.join()+`),
                             getBestIndicesAChannel(`+E.join()+`),
                             getBestIndicesAChannel(`+R.join()+")));",D=`vec4(
            getAChannel(`+S.join()+`),
            hasNextCol ? getAChannel(`+_.join()+`) : 0.,
            hasNextRow ? getAChannel(`+E.join()+`) : 0.,
            hasNextRow && hasNextCol ? getAChannel(`+R.join()+") : 0.)",k=r?"":`
      float getBestIndicesAChannel(`+w.join()+`) {
        return getChannel(getBestIndicesA(`+g.join()+`),
                                          vec2(`+g.slice(-2).join()+`));
      }`;this.userCode=`
      float getAChannel(`+w.join()+`) {
        return getChannel(getA(`+g.join()+`),
                               vec2(`+g.slice(-2).join()+`));
      }
      `+k+`
      void main() {
        `+d+` coords = getOutputCoords();
        bool hasNextCol = `+v[f-1]+" < "+(c[f-1]-1)+`;
        bool hasNextRow = `+v[f-2]+" < "+(c[f-2]-1)+`;
        `+u+`
        ivec4 srcIdx = ivec4(sourceLocR`+b+", sourceLocG"+b+`,
          sourceLocB`+b+", sourceLocA"+b+") * "+t+`;
        ivec4 inIdx = srcIdx;
        vec4 bestIndex = vec4(inIdx);
        vec4 bestValue = `+D+`;

        for (int i = 0; i < `+t+`; i++) {
          inIdx = srcIdx;
          `+A+`
          vec4 candidate = `+D+`;
          bvec4 nan = isnan(candidate);
          bvec4 replace = bvec4(
            vec4(`+C+`(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));

          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,
                           replace.y  ? candidate.y : bestValue.y,
                           replace.z  ? candidate.z : bestValue.z,
                           replace.w  ? candidate.w : bestValue.w);
          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));
          srcIdx++;
        }
        setOutput(bestIndex);
      }
    `},Q3=function(n){this.variableNames=["dy"],this.outputShape=n.inShape;var t=n.filterHeight,e=n.filterWidth,r=n.strideHeight,a=n.strideWidth,i=n.dilationHeight,u=n.dilationWidth,l=n.effectiveFilterHeight,c=n.effectiveFilterWidth,f=l-1-n.padInfo.top,d=c-1-n.padInfo.left,v=1/(t*e);this.userCode=`
      const ivec2 pads = ivec2(`+f+", "+d+`);
      const float avgMultiplier = float(`+v+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < `+l+`;
            wR += `+i+`) {
          float dyR = float(dyRCorner + wR) / `+r+`.0;

          if (dyR < 0.0 || dyR >= `+n.outHeight+`.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < `+c+`;
            wC+= `+u+`) {
            float dyC = float(dyCCorner + wC) / `+a+`.0;

            if (dyC < 0.0 || dyC >= `+n.outWidth+`.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);

            dotProd += dyValue * avgMultiplier;
          }
        }
        setOutput(dotProd);
      }
    `},Z3=function(n){this.variableNames=["dy"],this.outputShape=n.inShape;var t=n.filterDepth,e=n.filterHeight,r=n.filterWidth,a=n.strideDepth,i=n.strideHeight,u=n.strideWidth,l=n.dilationDepth,c=n.dilationHeight,f=n.dilationWidth,d=n.effectiveFilterDepth,v=n.effectiveFilterHeight,m=n.effectiveFilterWidth,g=d-1-n.padInfo.front,b=v-1-n.padInfo.top,w=m-1-n.padInfo.left,S=1/(t*e*r);this.userCode=`
      const ivec3 pads = ivec3(`+g+", "+b+", "+w+`);
      const float avgMultiplier = float(`+S+`);

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < `+d+`;
            wD += `+l+`) {
          float dyD = float(dyDCorner + wD) / `+a+`.0;

          if (dyD < 0.0 || dyD >= `+n.outDepth+`.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < `+v+`;
              wR += `+c+`) {
            float dyR = float(dyRCorner + wR) / `+i+`.0;

            if (dyR < 0.0 || dyR >= `+n.outHeight+`.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < `+m+`;
                wC += `+f+`) {
              float dyC = float(dyCCorner + wC) / `+u+`.0;

              if (dyC < 0.0 || dyC >= `+n.outWidth+`.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);

              dotProd += dyValue * avgMultiplier;
            }
          }
        }
        setOutput(dotProd);
      }
    `},J3=function(n,t,e,r,a,i){this.outputShape=[],this.variableNames=["x","mean","variance"],et(n,t),et(n,e);var u="0.0";r!=null&&(et(n,r),this.variableNames.push("offset"),u="getOffsetAtOutCoords()");var l="1.0";a!=null&&(et(n,a),this.variableNames.push("scale"),l="getScaleAtOutCoords()"),this.outputShape=n,this.userCode=`
      void main() {
        float x = getXAtOutCoords();
        float mean = getMeanAtOutCoords();
        float variance = getVarianceAtOutCoords();
        float offset = `+u+`;
        float scale = `+l+`;
        float inv = scale * inversesqrt(variance + float(`+i+`));
        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));
      }
    `},e4=function(n,t,e,r,a,i){this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],et(n,t),et(n,e);var u="vec4(0.0)";r!=null&&(et(n,r),this.variableNames.push("offset"),u="getOffsetAtOutCoords()");var l="vec4(1.0)";a!=null&&(et(n,a),this.variableNames.push("scale"),l="getScaleAtOutCoords()"),this.outputShape=n,this.userCode=`
      void main() {
        vec4 offset = `+u+`;
        vec4 scale = `+l+`;

        vec4 x = getXAtOutCoords();
        vec4 mean = getMeanAtOutCoords();
        vec4 variance = getVarianceAtOutCoords();

        vec4 inv = scale * inversesqrt(variance + vec4(`+i+`));

        setOutput((x - mean) * inv + offset);
      }
    `},t4="return areal * breal - aimag * bimag;",n4="return areal * bimag + aimag * breal;",Nw=function(n,t,e){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=et(t,e),this.userCode=`
      float binaryOpComplex(
          float areal, float aimag, float breal, float bimag) {
        `+n+`
      }

      void main() {
        float areal = getARealAtOutCoords();
        float aimag = getAImagAtOutCoords();
        float breal = getBRealAtOutCoords();
        float bimag = getBImagAtOutCoords();
        setOutput(binaryOpComplex(areal, aimag, breal, bimag));
      }
    `},wv="return a + b;",_v="return a - b;",Mw="return a * b;",wS="return (a < 0.) ? b * a : a;",Nt=function(n,t,e){this.variableNames=["A","B"],this.outputShape=et(t,e),this.userCode=`
      float binaryOperation(float a, float b) {
        `+n+`
      }

      void main() {
        float a = getAAtOutCoords();
        float b = getBAtOutCoords();
        setOutput(binaryOperation(a, b));
      }
    `},_S=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`,Ea=function(n,t,e,r){r===void 0&&(r=!1),this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=et(t,e);var a=this.outputShape.length,i="";if(r)if(a===0||Ce(this.outputShape)===1)i=`
          result.y = 0.;
          result.z = 0.;
          result.w = 0.;
        `;else if(i=`
          `+wt(a)+` coords = getOutputCoords();
        `,a===1)i+=`
            result.y = (coords + 1) >= `+this.outputShape[0]+` ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `;else{var u=Ln("coords",a);i+=`
            bool nextRowOutOfBounds =
              (`+u[a-2]+" + 1) >= "+this.outputShape[a-2]+`;
            bool nextColOutOfBounds =
              (`+u[a-1]+" + 1) >= "+this.outputShape[a-1]+`;
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `}this.userCode=`
      vec4 binaryOperation(vec4 a, vec4 b) {
        `+n+`
      }

      void main() {
        vec4 a = getAAtOutCoords();
        vec4 b = getBAtOutCoords();

        vec4 result = binaryOperation(a, b);
        `+i+`

        setOutput(result);
      }
    `},r4=function(){function n(t){this.variableNames=["A"],this.outputShape=t,this.userCode=`
      uniform float minVal;
      uniform float maxVal;

      void main() {
        float value = getAAtOutCoords();
        if (isnan(value)) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, minVal, maxVal));
      }
    `}return n.prototype.getCustomSetupFunc=function(t,e){var r=this;return function(a,i){r.minLoc==null&&(r.minLoc=a.getUniformLocationNoThrow(i,"minVal"),r.maxLoc=a.getUniformLocationNoThrow(i,"maxVal")),a.gl.uniform1f(r.minLoc,t),a.gl.uniform1f(r.maxLoc,e)}},n}(),a4=function(){function n(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.userCode=`
      uniform float minVal;
      uniform float maxVal;

      void main() {
        vec4 value = getAAtOutCoords();

        if (any(isnan(value))) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));
      }
    `}return n.prototype.getCustomSetupFunc=function(t,e){var r=this;return function(a,i){r.minLoc==null&&(r.minLoc=a.getUniformLocationNoThrow(i,"minVal"),r.maxLoc=a.getUniformLocationNoThrow(i,"maxVal")),a.gl.uniform1f(r.minLoc,t),a.gl.uniform1f(r.maxLoc,e)}},n}(),i4=function(n){this.variableNames=["real","imag"],this.outputShape=n,this.userCode=`
      void main() {
        float re = abs(getRealAtOutCoords());
        float im = abs(getImagAtOutCoords());
        float mx = max(re, im);

        // sadly the length function in glsl is not underflow-safe
        // (at least not on Intel GPUs). So the safe solution is
        // to ensure underflow-safety in all cases.
        setOutput(
          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))
        );
      }
    `},o4=function(n){this.outputShape=[],this.outputShape=Fs(n,1),this.variableNames=n.map(function(l,c){return"T"+c});var t=new Array(n.length-1);t[0]=n[0][1];for(var e=1;e<t.length;e++)t[e]=t[e-1]+n[e][1];var r=["if (yC < "+t[0]+") setOutput(getT0(yR, yC));"];for(e=1;e<t.length;e++){var a=t[e-1];r.push("else if (yC < "+t[e]+") setOutput(getT"+e+"(yR, yC-"+a+"));")}var i=t.length,u=t[t.length-1];r.push("else setOutput(getT"+i+"(yR, yC-"+u+"));"),this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int yR = coords.x;
        int yC = coords.y;

        `+r.join(`
        `)+`
      }
    `},s4=function(n,t){this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=Fs(n,t);var e=this.outputShape,r=e.length,a=wt(r),i=Ln("coords",r),u=["x","y","z","w","u","v"].slice(0,r);this.variableNames=n.map(function(S,_){return"T"+_});var l=new Array(n.length-1);l[0]=n[0][t];for(var c=1;c<l.length;c++)l[c]=l[c-1]+n[c][t];var f=u[t],d=u.slice(-2),v=u.join(),m="if ("+f+" < "+l[0]+`) {
        return getChannel(
            getT0(`+v+"), vec2("+d.join()+`));
        }`;for(c=1;c<l.length;c++){var g=l[c-1];m+=`
        if (`+f+" < "+l[c]+"  && "+f+" >= "+l[c-1]+`) {
          return getChannel(
            getT`+c+"("+tf(u,f,g)+`),
            vec2(`+tf(d,f,g)+`));
        }`}var b=l.length,w=l[l.length-1];m+=`
        return getChannel(
          getT`+b+"("+tf(u,f,w)+`),
          vec2(`+tf(d,f,w)+"));",this.userCode=`
      float getValue(`+u.map(function(S){return"int "+S})+`) {
        `+m+`
      }

      void main() {
        `+a+` coords = getOutputCoords();
        vec4 result = vec4(getValue(`+i+`), 0., 0., 0.);

        `+i[r-1]+" = "+i[r-1]+` + 1;
        if (`+i[r-1]+" < "+e[r-1]+`) {
          result.g = getValue(`+i+`);
        }

        `+i[r-2]+" = "+i[r-2]+` + 1;
        if (`+i[r-2]+" < "+e[r-2]+`) {
          result.a = getValue(`+i+`);
        }

        `+i[r-1]+" = "+i[r-1]+` - 1;
        if (`+i[r-2]+" < "+e[r-2]+` &&
            `+i[r-1]+" < "+e[r-1]+`) {
          result.b = getValue(`+i+`);
        }
        setOutput(result);
      }
    `};function tf(n,t,e){var r=n.indexOf(t);return n.map(function(a,i){return i===r?a+" - "+e:a}).join()}var u4=function(n){this.variableNames=["x","dy"],this.outputShape=n.filterShape;var t=n.strideHeight,e=n.strideWidth,r=n.padInfo.top,a=n.padInfo.left,i=n.dataFormat==="channelsLast";this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int d2 = coords.w;

        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int b = 0; b < `+n.batchSize+`; b++) {
          for (int yR = 0; yR < `+n.outHeight+`; yR++) {
            int xR = wR + yR * `+t+" - "+r+`;

            if (xR < 0 || xR >= `+n.inHeight+`) {
              continue;
            }

            for (int yC = 0; yC < `+n.outWidth+`; yC++) {
              int xC = wC + yC * `+e+" - "+a+`;

              if (xC < 0 || xC >= `+n.inWidth+`) {
                continue;
              }

              if (`+i+`) {
                float dyValue = getDy(b, yR, yC, d2);
                float xValue = getX(b, xR, xC, d1);
                dotProd += (xValue * dyValue);
              } else {
                float dyValue = getDy(b, d2, yR, yC);
                float xValue = getX(b, d1, xR, xC);
                dotProd += (xValue * dyValue);
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `},l4=function(n){this.variableNames=["dy","W"],this.outputShape=n.inShape;var t=n.filterHeight,e=n.filterWidth,r=n.strideHeight,a=n.strideWidth,i=n.dataFormat==="channelsLast",u=t-1-n.padInfo.top,l=e-1-n.padInfo.left,c=i?1:2,f=i?2:3,d=i?3:1;this.userCode=`
      const ivec2 pads = ivec2(`+u+", "+l+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[`+d+`];

        ivec2 dyCorner = ivec2(coords[`+c+"], coords["+f+`]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < `+t+`; wR++) {
          float dyR = float(dyRCorner + wR) / `+r+`.0;

          if (dyR < 0.0 || dyR >= `+n.outHeight+`.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = `+t+` - 1 - wR;

          for (int wC = 0; wC < `+e+`; wC++) {
            float dyC = float(dyCCorner + wC) / `+a+`.0;

            if (dyC < 0.0 || dyC >= `+n.outWidth+`.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = `+e+` - 1 - wC;

            for (int d2 = 0; d2 < `+n.outChannels+`; d2++) {

              if (`+i+`) {
                float xValue = getDy(batch, idyR, idyC, d2);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              } else {
                float xValue = getDy(batch, d2, idyR, idyC);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `},c4=function(n){this.variableNames=["x","dy"],this.outputShape=n.filterShape;var t=n.strideDepth,e=n.strideHeight,r=n.strideWidth,a=n.padInfo.front,i=n.padInfo.top,u=n.padInfo.left;this.userCode=`
      void main() {
        ivec5 coords = getOutputCoords();
        int wF = coords.x;
        int wR = coords.y;
        int wC = coords.z;
        int d1 = coords.w;
        int d2 = coords.u;

        float dotProd = 0.0;

        for (int b = 0; b < `+n.batchSize+`; b++) {
          for (int yF = 0; yF < `+n.outDepth+`; yF++) {
            int xF = wF + yF * `+t+" - "+a+`;

            if (xF < 0 || xF >= `+n.inDepth+`) {
              continue;
            }

            for (int yR = 0; yR < `+n.outHeight+`; yR++) {
              int xR = wR + yR * `+e+" - "+i+`;

              if (xR < 0 || xR >= `+n.inHeight+`) {
                continue;
              }

              for (int yC = 0; yC < `+n.outWidth+`; yC++) {
                int xC = wC + yC * `+r+" - "+u+`;

                if (xC < 0 || xC >= `+n.inWidth+`) {
                  continue;
                }

                float dyValue = getDy(b, yF, yR, yC, d2);
                float xValue = getX(b, xF, xR, xC, d1);
                dotProd += (xValue * dyValue);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `},f4=function(n){this.variableNames=["dy","W"],this.outputShape=n.inShape;var t=n.filterDepth,e=n.filterHeight,r=n.filterWidth,a=n.strideDepth,i=n.strideHeight,u=n.strideWidth,l=t-1-n.padInfo.front,c=e-1-n.padInfo.top,f=r-1-n.padInfo.left;this.userCode=`
      const ivec3 pads = ivec3(`+l+", "+c+", "+f+`);

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.u;


        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyFCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        float dotProd = 0.0;
        for (int wF = 0; wF < `+t+`; wF++) {
          float dyF = float(dyFCorner + wF) / `+a+`.0;

          if (dyF < 0.0 || dyF >= `+n.outDepth+`.0 || fract(dyF) > 0.0) {
            continue;
          }
          int idyF = int(dyF);

          int wFPerm = `+t+` - 1 - wF;

          for (int wR = 0; wR < `+e+`; wR++) {
            float dyR = float(dyRCorner + wR) / `+i+`.0;

            if (dyR < 0.0 || dyR >= `+n.outHeight+`.0 ||
              fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            int wRPerm = `+e+` - 1 - wR;

            for (int wC = 0; wC < `+r+`; wC++) {
              float dyC = float(dyCCorner + wC) / `+u+`.0;

              if (dyC < 0.0 || dyC >= `+n.outWidth+`.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              int wCPerm = `+r+` - 1 - wC;

              for (int d2 = 0; d2 < `+n.outChannels+`; d2++) {
                float xValue = getDy(batch, idyF, idyR, idyC, d2);
                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `},h4=function(n){this.variableNames=["x","dy"],this.outputShape=n.filterShape;var t=n.strideHeight,e=n.strideWidth,r=n.padInfo.top,a=n.padInfo.left,i=n.outChannels/n.inChannels;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int dm = coords.w;
        int d2 = d1 * `+i+` + dm;

        float dotProd = 0.0;

        // TO DO: Vec4 over the batch size
        for (int b = 0; b < `+n.batchSize+`; b++) {
          for (int yR = 0; yR < `+n.outHeight+`; yR++) {
            int xR = wR + yR * `+t+" - "+r+`;

            if (xR < 0 || xR >= `+n.inHeight+`) {
              continue;
            }

            for (int yC = 0; yC < `+n.outWidth+`; yC++) {
              int xC = wC + yC * `+e+" - "+a+`;

              if (xC < 0 || xC >= `+n.inWidth+`) {
                continue;
              }

              float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);
            }
          }
        }
        setOutput(dotProd);
      }
    `},d4=function(n){this.variableNames=["dy","W"],this.outputShape=n.inShape;var t=n.filterHeight,e=n.filterWidth,r=n.strideHeight,a=n.strideWidth,i=t-1-n.padInfo.top,u=e-1-n.padInfo.left,l=n.outChannels/n.inChannels;this.userCode=`
      const ivec2 pads = ivec2(`+i+", "+u+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];
        ivec2 dyCorner = coords.yz - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        float dotProd = 0.0;

        for (int wR = 0; wR < `+t+`; wR++) {
          float dyR = float(dyRCorner + wR) / `+r+`.0;

          if (dyR < 0.0 || dyR >= `+n.outHeight+`.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = `+t+` - 1 - wR;

          for (int wC = 0; wC < `+e+`; wC++) {
            float dyC = float(dyCCorner + wC) / `+a+`.0;

            if (dyC < 0.0 || dyC >= `+n.outWidth+`.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = `+e+` - 1 - wC;

            // TO DO: Vec4 over the channelMul
            for (int dm = 0; dm < `+l+`; dm++) {
              int d2 = d1 * `+l+` + dm;
              float xValue = getDy(batch, idyR, idyC, d2);
              float wValue = getW(wRPerm, wCPerm, d1, dm);
              dotProd += xValue * wValue;
            }
          }
        }
        setOutput(dotProd);
      }
    `},Iw=function(n,t,e,r){t===void 0&&(t=!1),e===void 0&&(e=null),r===void 0&&(r=!1),this.variableNames=["x","W"],this.outputShape=n.outShape;var a=n.padInfo.top,i=n.padInfo.left,u=n.strideHeight,l=n.strideWidth,c=n.dilationHeight,f=n.dilationWidth,d=n.filterHeight,v=n.filterWidth,m=4*Math.floor(n.inChannels/4),g=n.inChannels%4,b=n.dataFormat==="channelsLast",w=b?1:2,S=b?2:3,_=b?3:1,E="",R="";e&&(E=r?`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          `+e+`
        }`:`
          float activation(float x) {
            `+e+`
          }
        `,R="result = activation(result);");var C=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),this.userCode=`
      `+E+`

      const ivec2 strides = ivec2(`+u+", "+l+`);
      const ivec2 pads = ivec2(`+a+", "+i+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d2 = coords[`+_+`];

        ivec2 xRCCorner =
            ivec2(coords[`+w+"], coords["+S+`]) * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < `+d+`; wR++) {
          int xR = xRCorner + wR * `+c+`;

          if (xR < 0 || xR >= `+n.inHeight+`) {
            continue;
          }

          for (int wC = 0; wC < `+v+`; wC++) {
            int xC = xCCorner + wC * `+f+`;

            if (xC < 0 || xC >= `+n.inWidth+`) {
              continue;
            }

            for (int d1 = 0; d1 < `+m+`; d1 += 4) {
              vec4 wValues = vec4(
                getW(wR, wC, d1, d2),
                getW(wR, wC, d1 + 1, d2),
                getW(wR, wC, d1 + 2, d2),
                getW(wR, wC, d1 + 3, d2)
              );

              if (`+b+`) {
                vec4 xValues = vec4(
                  getX(batch, xR, xC, d1),
                  getX(batch, xR, xC, d1 + 1),
                  getX(batch, xR, xC, d1 + 2),
                  getX(batch, xR, xC, d1 + 3)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec4 xValues = vec4(
                  getX(batch, d1, xR, xC),
                  getX(batch, d1 + 1, xR, xC),
                  getX(batch, d1 + 2, xR, xC),
                  getX(batch, d1 + 3, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }
            }

            if (`+(g===1)+`) {

              if (`+b+`) {
                dotProd +=
                    getX(batch, xR, xC, `+m+`) *
                    getW(wR, wC, `+m+`, d2);
              } else {
                dotProd +=
                    getX(batch, `+m+`, xR, xC) *
                    getW(wR, wC, `+m+`, d2);
              }

            } else if (`+(g===2)+`) {
              vec2 wValues = vec2(
                getW(wR, wC, `+m+`, d2),
                getW(wR, wC, `+m+` + 1, d2)
              );

              if (`+b+`) {
                vec2 xValues = vec2(
                  getX(batch, xR, xC, `+m+`),
                  getX(batch, xR, xC, `+m+` + 1)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec2 xValues = vec2(
                  getX(batch, `+m+`, xR, xC),
                  getX(batch, `+m+` + 1, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            } else if (`+(g===3)+`) {
              vec3 wValues = vec3(
                getW(wR, wC, `+m+`, d2),
                getW(wR, wC, `+m+` + 1, d2),
                getW(wR, wC, `+m+` + 2, d2)
              );

              if (`+b+`) {
                vec3 xValues = vec3(
                  getX(batch, xR, xC, `+m+`),
                  getX(batch, xR, xC, `+m+` + 1),
                  getX(batch, xR, xC, `+m+` + 2)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec3 xValues = vec3(
                  getX(batch, `+m+`, xR, xC),
                  getX(batch, `+m+` + 1, xR, xC),
                  getX(batch, `+m+` + 2, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            }
          }
        }

        float result = dotProd;
        `+C+`
        `+R+`
        setOutput(result);
      }
    `},p4=function(n){this.variableNames=["x","W"],this.outputShape=n.outShape;var t=n.padInfo.front,e=n.padInfo.top,r=n.padInfo.left,a=n.strideDepth,i=n.strideHeight,u=n.strideWidth,l=n.dilationDepth,c=n.dilationHeight,f=n.dilationWidth,d=n.filterDepth,v=n.filterHeight,m=n.filterWidth,g=4*Math.floor(n.inChannels/4),b=n.inChannels%4;this.userCode=`
      const ivec3 strides = ivec3(`+a+", "+i+", "+u+`);
      const ivec3 pads = ivec3(`+t+", "+e+", "+r+`);

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d2 = coords.u;

        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xFCorner = xFRCCorner.x;
        int xRCorner = xFRCCorner.y;
        int xCCorner = xFRCCorner.z;

        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get
        // y(yF, yR, yC, d2). ? = to be determined. : = across all
        // values in that axis.
        float dotProd = 0.0;
        for (int wF = 0; wF < `+d+`; wF++) {
          int xF = xFCorner + wF * `+l+`;

          if (xF < 0 || xF >= `+n.inDepth+`) {
            continue;
          }

          for (int wR = 0; wR < `+v+`; wR++) {
            int xR = xRCorner + wR * `+c+`;

            if (xR < 0 || xR >= `+n.inHeight+`) {
              continue;
            }

            for (int wC = 0; wC < `+m+`; wC++) {
              int xC = xCCorner + wC * `+f+`;

              if (xC < 0 || xC >= `+n.inWidth+`) {
                continue;
              }

              for (int d1 = 0; d1 < `+g+`; d1 += 4) {
                vec4 xValues = vec4(
                  getX(batch, xF, xR, xC, d1),
                  getX(batch, xF, xR, xC, d1 + 1),
                  getX(batch, xF, xR, xC, d1 + 2),
                  getX(batch, xF, xR, xC, d1 + 3)
                );
                vec4 wValues = vec4(
                  getW(wF, wR, wC, d1, d2),
                  getW(wF, wR, wC, d1 + 1, d2),
                  getW(wF, wR, wC, d1 + 2, d2),
                  getW(wF, wR, wC, d1 + 3, d2)
                );

                dotProd += dot(xValues, wValues);
              }

              if (`+(b===1)+`) {
                dotProd +=
                  getX(batch, xF, xR, xC, `+g+`) *
                  getW(wF, wR, wC, `+g+`, d2);
              } else if (`+(b===2)+`) {
                vec2 xValues = vec2(
                  getX(batch, xF, xR, xC, `+g+`),
                  getX(batch, xF, xR, xC, `+g+` + 1)
                );
                vec2 wValues = vec2(
                  getW(wF, wR, wC, `+g+`, d2),
                  getW(wF, wR, wC, `+g+` + 1, d2)
                );
                dotProd += dot(xValues, wValues);
              } else if (`+(b===3)+`) {
                vec3 xValues = vec3(
                  getX(batch, xF, xR, xC, `+g+`),
                  getX(batch, xF, xR, xC, `+g+` + 1),
                  getX(batch, xF, xR, xC, `+g+` + 2)
                );
                vec3 wValues = vec3(
                  getW(wF, wR, wC, `+g+`, d2),
                  getW(wF, wR, wC, `+g+` + 1, d2),
                  getW(wF, wR, wC, `+g+` + 2, d2)
                );
                dotProd += dot(xValues, wValues);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `},Fw=function(n,t,e,r){t===void 0&&(t=!1),e===void 0&&(e=null),r===void 0&&(r=!1),this.variableNames=["x","W"],this.outputShape=n.outShape;var a=n.inHeight,i=n.inWidth,u=n.padInfo.top,l=n.padInfo.left,c=n.strideHeight,f=n.strideWidth,d=n.dilationHeight,v=n.dilationWidth,m=n.filterHeight,g=n.filterWidth,b=n.outChannels/n.inChannels,w="",S="";e&&(w=r?`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          `+e+`
        }`:`
          float activation(float x) {
            `+e+`
          }
        `,S="result = activation(result);");var _=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),this.userCode=`
      `+w+`

      const ivec2 strides = ivec2(`+c+", "+f+`);
      const ivec2 pads = ivec2(`+u+", "+l+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / `+b+`;
        int q = d2 - d1 * `+b+`;

        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.
        for (int wR = 0; wR < `+m+`; wR++) {
          int xR = xRCorner + wR * `+d+`;

          if (xR < 0 || xR >= `+a+`) {
            continue;
          }

          for (int wC = 0; wC < `+g+`; wC++) {
            int xC = xCCorner + wC * `+v+`;

            if (xC < 0 || xC >= `+i+`) {
              continue;
            }

            float xVal = getX(batch, xR, xC, d1);
            float wVal = getW(wR, wC, d1, q);
            dotProd += xVal * wVal;
          }
        }

        float result = dotProd;
        `+_+`
        `+S+`
        setOutput(result);
      }
    `},Bw=function(n,t,e,r){t===void 0&&(t=!1),e===void 0&&(e=null),r===void 0&&(r=!1),this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n.outShape;for(var a=n.inHeight,i=n.inWidth,u=n.padInfo.top,l=n.padInfo.left,c=n.strideHeight,f=n.strideWidth,d=n.dilationHeight,v=n.dilationWidth,m=n.filterHeight,g=n.filterWidth,b=g,w="int xR; int xC; int xCOffset;",S=0;S<m;S++)for(var _=0;_<g;_++)w+=`
          vec4 xTexelR`+S+"C"+2*_+` = vec4(0.);
          vec4 wR`+S+"C"+_+` = vec4(0.);
          vec4 xR`+S+"C"+_+" = vec4(0.);";for(S=0;S<m;S++)for(var E=0;E<b;E++){if(w+=`
          xR = xRCorner + `+S*d+`;
          xC = xCCorner + `+(_=2*E)*v+`;
        `,f===1){if(_<g&&(w+=l%2==1?`
                xCOffset = xC + 1;
                if(xR >= 0 && xR < `+a+" && xCOffset >= 0 && xCOffset < "+i+`) {
                  xTexelR`+S+"C"+_+` = getX(batch, xR, xCOffset, d1);

                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if(xCOffset + 1 >= `+i+`) {
                    xTexelR`+S+"C"+_+`.zw = vec2(0.);
                  }
                } else {
                  xTexelR`+S+"C"+_+` = vec4(0.);
                }

                xCOffset = xC + 1 - 2;
                if(xR >= 0 && xR < `+a+" && xCOffset >= 0 && xCOffset < "+i+`) {
                  vec4 previous = getX(batch, xR, xCOffset, d1);

                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if(xCOffset + 1 >= `+i+`) {
                    previous.zw = vec2(0.);
                  }

                  xR`+S+"C"+_+" = vec4(previous.zw, xTexelR"+S+"C"+_+`.xy);
                } else {
                  xR`+S+"C"+_+" = vec4(0, 0, xTexelR"+S+"C"+_+`.xy);
                }
              `:`
                if(xR >= 0 && xR < `+a+" && xC >= 0 && xC < "+i+`) {
                  xTexelR`+S+"C"+_+` = getX(batch, xR, xC, d1);
                } else {
                  xTexelR`+S+"C"+_+` = vec4(0.);
                }

                xR`+S+"C"+_+" = xTexelR"+S+"C"+_+`;
              `,_+1<g)){var R=l%2==0?U_(v):v;v%2==0&&l%2==1||v%2!=0&&l%2!=1?(w+=`
                  xCOffset = xC + `+l%2+" + "+R+`;

                  if(xR >= 0 && xR < `+a+` &&
                    xCOffset >= 0 && xCOffset < `+i+`) {
                    xTexelR`+S+"C"+(_+2)+` = getX(batch, xR, xCOffset, d1);
                  }
                `,v>1&&(w+=`
                    xCOffset -= 2;
                    if(xR >= 0 && xR < `+a+` &&
                      xCOffset >= 0 && xCOffset < `+i+`) {
                      xTexelR`+S+"C"+_+` = getX(batch, xR, xCOffset, d1);
                    } else {
                      xTexelR`+S+"C"+_+` = vec4(0.);
                    }
                  `),w+=`
                  xR`+S+"C"+(_+1)+` = vec4(
                    xTexelR`+S+"C"+_+".zw, xTexelR"+S+"C"+(_+2)+`.xy);
                `):w+=`
                  xCOffset = xC + `+R+`;

                  if(xR >= 0 && xR < `+a+` &&
                    xCOffset >= 0 && xCOffset < `+i+`) {
                    xTexelR`+S+"C"+(_+2)+` = getX(batch, xR, xCOffset, d1);
                  }

                  xR`+S+"C"+(_+1)+" = xTexelR"+S+"C"+(_+2)+`;
                `}}else _<g&&(w+=`
              if(xR >= 0 && xR < `+a+`) {
            `,l%2==1?(w+=`
                xCOffset = xC + 1 - `+f+`;
                if(xCOffset >= 0 && xCOffset < `+i+`) {
                  xTexelR`+S+"C"+_+` = getX(batch, xR, xCOffset, d1);
                } else {
                  xTexelR`+S+"C"+_+` = vec4(0.);
                }

                if(xC + 1 >= 0 && xC + 1 < `+i+`) {
                  xTexelR`+S+"C"+(_+2)+` = getX(batch, xR, xC + 1, d1);
                } else {
                  xTexelR`+S+"C"+(_+2)+` = vec4(0.);
                }

                xR`+S+"C"+_+` = vec4(
                  xTexelR`+S+"C"+_+".zw, xTexelR"+S+"C"+(_+2)+`.zw);
              `,_+1<g&&(w+=`
                  vec4 final = vec4(0.);
                  xCOffset = xC + 1 + `+f+`;
                  if(xCOffset >= 0 && xCOffset < `+i+`) {
                    final = getX(batch, xR, xCOffset, d1);
                  }
                  xR`+S+"C"+(_+1)+" = vec4(xTexelR"+S+"C"+(_+2)+`.xy, final.xy);
                `)):(w+=`
                if(xC >= 0 && xC < `+i+`) {
                  xTexelR`+S+"C"+_+` = getX(batch, xR, xC, d1);
                } else {
                  xTexelR`+S+"C"+_+` = vec4(0.);
                }

                xCOffset = xC + `+f+`;
                if(xCOffset >= 0 && xCOffset < `+i+`) {
                  xTexelR`+S+"C"+(_+2)+` = getX(batch, xR, xCOffset, d1);
                } else {
                  xTexelR`+S+"C"+(_+2)+` = vec4(0.);
                }

                xR`+S+"C"+_+` = vec4(
                  xTexelR`+S+"C"+_+".xy, xTexelR"+S+"C"+(_+2)+`.xy);
              `,_+1<g&&(w+=`
                  xR`+S+"C"+(_+1)+` = vec4(
                    xTexelR`+S+"C"+_+".zw, xTexelR"+S+"C"+(_+2)+`.zw);
                `)),w+="}");_<g&&(w+=`
            vec4 wTexelR`+S+"C"+_+" = getW("+S+", "+_+`, d1, q);
            wR`+S+"C"+_+" = vec4(wTexelR"+S+"C"+_+".xz, wTexelR"+S+"C"+_+`.xz);
          `,_+1<g&&(w+=`
              vec4 wTexelR`+S+"C"+(_+1)+" = getW("+S+", "+(_+1)+`, d1, q);
              wR`+S+"C"+(_+1)+` =
                vec4(wTexelR`+S+"C"+(_+1)+".xz, wTexelR"+S+"C"+(_+1)+".xz);"))}for(S=0;S<m;S++)for(_=0;_<g;_++)w+="dotProd += xR"+S+"C"+_+" * wR"+S+"C"+_+";";var C="",A="";e&&(C=r?`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          `+e+`
        }`:`vec4 activation(vec4 x) {
          `+e+`
        }`,A="result = activation(result);");var D=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),this.userCode=`
      `+C+`

      const ivec2 strides = ivec2(`+c+", "+f+`);
      const ivec2 pads = ivec2(`+u+", "+l+`);

      void main() {

        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2;
        int q = 0;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        vec4 dotProd = vec4(0.);

        `+w+`

        vec4 result = dotProd;
        `+D+`
        `+A+`
        setOutput(result);
      }
    `},v4=function(n,t,e,r,a){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];var i=n[0],u=n[1],l=n[2],c=n[3],f=t[0],d=e[0],v=e[1];this.outputShape=[f,d,v,c];var m=r==="bilinear"?1:0,g=[u-1+".0",l-1+".0"],b=g[0],w=g[1],S=d>1?[""+(u-1)/(d-1),"(y2-y1) * height_ratio","y1*"+b+" + float(y)*(height_scale)"]:["0.0","0.0","0.5 * (y1+y2) * "+b],_=S[0],E=S[1],R=S[2],C=v>1?[""+(l-1)/(v-1),"(x2-x1) * width_ratio","x1*"+w+" + float(x)*(width_scale)"]:["0.0","0.0","0.5 * (x1+x2) * "+w],A=C[0],D=C[1],k=C[2];this.userCode=`
      const float height_ratio = float(`+_+`);
      const float width_ratio = float(`+A+`);
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int y = coords[1];
        int x = coords[2];
        int d = coords[3];

        // get box vals
        float y1 = getBoxes(b,0);
        float x1 = getBoxes(b,1);
        float y2 = getBoxes(b,2);
        float x2 = getBoxes(b,3);

        // get image in batch index
        int bInd = round(getBoxInd(b));
        if(bInd < 0 || bInd >= `+i+`) {
          return;
        }

        float height_scale = `+E+`;
        float width_scale = `+D+`;

        float in_y = `+R+`;
        if( in_y < 0.0 || in_y > `+b+` ) {
          setOutput(float(`+a+`));
          return;
        }
        float in_x = `+k+`;
        if( in_x < 0.0 || in_x > `+w+` ) {
          setOutput(float(`+a+`));
          return;
        }

        vec2 sourceFracIndexCR = vec2(in_x,in_y);
        if(`+m+` == 1) {
          // Compute the four integer indices.
          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);
          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));

          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);
          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);
          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);
          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);

          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);

          float top = topLeft + (topRight - topLeft) * fracCR.x;
          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;
          float newValue = top + (bottom - top) * fracCR.y;
          setOutput(newValue);
        } else {
          // Compute the coordinators of nearest neighbor point.
          ivec2 sourceNearestCR = ivec2(floor(
            sourceFracIndexCR + vec2(0.5,0.5)));
          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);
          setOutput(newValue);
        }
      }
    `},m4=function(n,t,e){this.variableNames=["x"],this.outputShape=n;var r=n.length,a=n[n.length-1],i=e?"<":">";this.userCode=`
      int getIndex(int i) {
        `+(e?"return "+a+" -i - 1;":"return i;")+`
      }

      void main() {
        `+wt(r)+` coords = getOutputCoords();
        int end = `+Lw(r,"coords")+`;
        float val = 0.0;
        for (int i = `+a+` - 1; i >= 0; i -= 1) {
          int idx = getIndex(i);
          if (idx `+i+` end) {
            continue;
          }
          if (idx == end && `+t+`) {
            continue;
          }
          `+Lw(r,"coords")+` = idx;
          val += getX(`+function(u,l){if(u===1)return""+l;if(u===2)return l+".x, "+l+".y";if(u===3)return l+".x, "+l+".y, "+l+".z";if(u===4)return l+".x, "+l+".y, "+l+".z, "+l+".w";throw Error("Cumulative sum for rank "+u+" is not yet supported")}(r,"coords")+`);
        }
        setOutput(val);
      }
    `};function Lw(n,t){if(n===1)return""+t;if(n===2)return t+".y";if(n===3)return t+".z";if(n===4)return t+".w";throw Error("Cumulative sum for rank "+n+" is not yet supported")}var g4=function(n){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=hl.DENSE;var t=Ju(n),e=Sn();this.outputShape=n,this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        `+to(["r","c","d"],n)+`
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx *
          vec2(`+t[0]+", "+t[1]+`));
        int index = 4 * (resTexRC.x * `+t[1]+` + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getA(rc.x, rc.y, rc.z);
        }

        `+e.output+` = result;
      }
    `},y4=function(n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=hl.DENSE;var t=Ju(n),e=Sn();this.outputShape=n,this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        `+to(["r","c","d"],n)+`
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx *
          vec2(`+t[0]+", "+t[1]+`));
        int index = 4 * (resTexRC.x * `+t[1]+` + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));
        }

        `+e.output+` = result;
      }
    `},b4=function(){function n(t,e,r){this.variableNames=["x"],this.outputShape=[],this.outputShape=t,this.blockSize=e,this.dataFormat=r,this.userCode=`
    void main() {
      ivec4 coords = getOutputCoords();
      int b = coords[0];
      int h = `+this.getHeightCoordString()+`;
      int w = `+this.getWidthCoordString()+`;
      int d = `+this.getDepthCoordString()+`;

      int in_h = h / `+e+`;
      int offset_h = imod(h, `+e+`);
      int in_w = w / `+e+`;
      int offset_w = imod(w, `+e+`);
      int offset_d = (offset_h * `+e+` + offset_w) *
        `+this.getOutputDepthSize()+`;
      int in_d = d + offset_d;

      float result = `+this.getInputSamplingString()+`;
      setOutput(result);
    }
  `}return n.prototype.getHeightCoordString=function(){return this.dataFormat==="NHWC"?"coords[1]":"coords[2]"},n.prototype.getWidthCoordString=function(){return this.dataFormat==="NHWC"?"coords[2]":"coords[3]"},n.prototype.getDepthCoordString=function(){return this.dataFormat==="NHWC"?"coords[3]":"coords[1]"},n.prototype.getOutputDepthSize=function(){return this.dataFormat==="NHWC"?this.outputShape[3]:this.outputShape[1]},n.prototype.getInputSamplingString=function(){return this.dataFormat==="NHWC"?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"},n}(),x4=function(n){this.variableNames=["X"],this.outputShape=[n,n],this.userCode=`
      void main() {
          ivec2 coords = getOutputCoords();
          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;
          setOutput(val);
      }
    `},w4=function(n){this.variableNames=["A"],this.outTexUsage=Zn.DOWNLOAD;var t=Sn();this.outputShape=n,this.userCode=`
      `+bS+`

      void main() {
        float x = getAAtOutCoords();
        `+t.output+` = encode_float(x);
      }
    `},_4=function(n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=Zn.DOWNLOAD;var t=Sn();this.outputShape=n,this.userCode=`
      `+bS+`

      void main() {
        ivec3 coords = getOutputCoords();
        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));
        `+t.output+` = encode_float(x);
      }
    `},S4=function(n,t,e){e===void 0&&(e=!1),this.variableNames=["A"];var r=Sn(),a=t[0],i=t[1];this.outputShape=n;var u="result";e&&(u="floor(result * 255. + 0.5)"),this.userCode=`
      `+lg(n)+`

      void main() {
        ivec3 coords = getOutputCoords();

        int flatIndex = getFlatIndex(coords);
        int offset = imod(flatIndex, 4);

        flatIndex = idiv(flatIndex, 4, 1.);
        
        int r = flatIndex / `+i+`;
        int c = imod(flatIndex, `+i+`);
        vec2 uv = (vec2(c, r) + halfCR) / vec2(`+i+".0, "+a+`.0);
        vec4 values = `+r.texture2D+`(A, uv);

        float result;

        if(offset == 0) {
          result = values[0];
        } else if(offset == 1) {
          result = values[1];
        } else if(offset == 2) {
          result = values[2];
        } else {
          result = values[3];
        }

        `+r.output+" = vec4("+u+`, 0., 0., 0.);
      }
    `},E4=function(n,t,e){e===void 0&&(e=!1),this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;var r=Sn(),a=t[0],i=t[1];this.outputShape=n;var u="",l="result";e&&(l="floor(result * 255. + 0.5)");for(var c=0;c<=1;c++)for(var f=0;f<=1;f++){var d=2*c+f;u+=`
          localCoords = coords;
          if(localCoords[2] + `+f+" < "+n[2]+`) {
            localCoords[2] += `+f+`;
            if(localCoords[1] + `+c+" < "+n[1]+`) {
              localCoords[1] += `+c+`;

              flatIndex = getFlatIndex(localCoords);
              offset = imod(flatIndex, 4);

              flatIndex = idiv(flatIndex, 4, 1.);

              r = flatIndex / `+i+`;
              c = imod(flatIndex, `+i+`);
              uv = (vec2(c, r) + halfCR) / vec2(`+i+".0, "+a+`.0);
              values = `+r.texture2D+`(A, uv);

              if(offset == 0) {
                result[`+d+`] = values[0];
              } else if(offset == 1) {
                result[`+d+`] = values[1];
              } else if(offset == 2) {
                result[`+d+`] = values[2];
              } else {
                result[`+d+`] = values[3];
              }
            }
          }
        `}this.userCode=`
      `+lg(n)+`

      void main() {
        ivec3 coords = getOutputCoords();

        vec4 result = vec4(0.);
        int flatIndex, r, c, offset;
        ivec3 localCoords;
        vec2 uv;
        vec4 values;

        `+u+`

        `+r.output+" = "+l+`;
      }
    `},C4="return real * expR - imag * expI;",R4="return real * expI + imag * expR;",Pw=function(n,t,e){this.variableNames=["real","imag"];var r=t[1];this.outputShape=t;var a=e?"2.0 * "+Math.PI:"-2.0 * "+Math.PI,i=e?r+".0":"1.0";this.userCode=`
      const float exponentMultiplier = `+a+`;

      float unaryOpComplex(float real, float expR, float imag, float expI) {
        `+n+`
      }

      float mulMatDFT(int batch, int index) {
        float indexRatio = float(index) / float(`+r+`);
        float exponentMultiplierTimesIndexRatio =
            exponentMultiplier * indexRatio;

        float result = 0.0;

        for (int i = 0; i < `+r+`; i++) {
          // x = (-2|2 * PI / N) * index * i;
          float x = exponentMultiplierTimesIndexRatio * float(i);
          float expR = cos(x);
          float expI = sin(x);
          float real = getReal(batch, i);
          float imag = getImag(batch, i);

          result +=
              unaryOpComplex(real, expR, imag, expI) / `+i+`;
        }

        return result;
      }

      void main() {
        ivec2 coords = getOutputCoords();
        setOutput(mulMatDFT(coords[0], coords[1]));
      }
    `},A4=function(){function n(t,e){this.outputShape=[],this.variableNames=["x"],this.outputShape=t,this.userCode=`
      uniform float value;
      void main() {
        // Input can be obtained from uniform value.
        setOutput(value);
      }
    `}return n.prototype.getCustomSetupFunc=function(t){var e=this;return function(r,a){e.valueLoc==null&&(e.valueLoc=r.getUniformLocationNoThrow(a,"value")),r.gl.uniform1f(e.valueLoc,t)}},n}(),T4=function(n,t,e){this.variableNames=["A","indices"];var r=n.slice();r[e]=t,this.outputShape=r,this.rank=r.length;var a=wt(this.rank),i=function(u,l){var c=u.length;if(c>4)throw Error("Gather for rank "+c+" is not yet supported");if(c===1)return"int(getIndices(resRC))";for(var f=["resRC.x","resRC.y","resRC.z","resRC.w"],d=[],v=0;v<u.length;v++)v===l?d.push("int(getIndices("+f[v]+"))"):d.push(""+f[v]);return d.join()}(n,e);this.userCode=`
      void main() {
        `+a+` resRC = getOutputCoords();
        setOutput(getA(`+i+`));
      }
    `},D4=function(n,t,e){this.sliceDim=n,this.strides=t,this.variableNames=["x","indices"],this.outputShape=e;var r=wt(t.length),a=wt(e.length),i=this.sliceDim>1?"strides[j]":"strides";this.userCode=`
        `+r+" strides = "+r+"("+this.strides+`);
         void main() {
          `+a+` coords = getOutputCoords();
          int flattenIndex = 0;
          for (int j = 0; j < `+this.sliceDim+`; j++) {
            int index = round(getIndices(coords[0], j));
            flattenIndex += index * `+i+`;
          }
          setOutput(getX(flattenIndex, coords[1]));
        }
      `};function k4(n,t){var e=Sn();return CN(n,t,e.version+`
    precision highp float;
    `+e.attribute+` vec3 clipSpacePos;
    `+e.attribute+` vec2 uv;
    `+e.varyingVs+` vec2 resultUV;

    void main() {
      gl_Position = vec4(clipSpacePos, 1);
      resultUV = uv;
    }`)}function O4(n,t){return kN(n,t,new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]))}function N4(n,t){return ON(n,t,new Uint16Array([0,1,2,2,1,3]))}function Rl(n,t,e,r,a,i,u){MN(e,r);var l=NN(n,t),c=n.TEXTURE_2D;return Ae(n,t,function(){return n.bindTexture(c,l)}),Ae(n,t,function(){return n.texParameteri(c,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE)}),Ae(n,t,function(){return n.texParameteri(c,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE)}),Ae(n,t,function(){return n.texParameteri(c,n.TEXTURE_MIN_FILTER,n.NEAREST)}),Ae(n,t,function(){return n.texParameteri(c,n.TEXTURE_MAG_FILTER,n.NEAREST)}),Ae(n,t,function(){return n.texImage2D(c,0,a,e,r,0,i,u,null)}),Ae(n,t,function(){return n.bindTexture(n.TEXTURE_2D,null)}),l}function M4(n,t,e,r,a){var i=ph(e,r);return Rl(n,t,i[0],i[1],a.internalFormatFloat,a.textureFormatFloat,n.FLOAT)}function I4(n,t,e,r,a){var i=ph(e,r);return Rl(n,t,i[0],i[1],a.internalFormatHalfFloat,a.textureFormatFloat,a.textureTypeHalfFloat)}function F4(n,t,e,r,a){var i=ph(e,r);return Rl(n,t,i[0],i[1],n.RGBA,n.RGBA,n.UNSIGNED_BYTE)}function B4(n,t,e,r,a){var i=Cl(e,r);return Rl(n,t,i[0],i[1],a.internalFormatPackedFloat,n.RGBA,n.FLOAT)}function L4(n,t,e,r,a){var i=Cl(e,r);return Rl(n,t,i[0],i[1],a.internalFormatPackedHalfFloat,n.RGBA,a.textureTypeHalfFloat)}function P4(n,t,e,r){return Ae(n,t,function(){return n.bindBuffer(n.ARRAY_BUFFER,r)}),Cw(n,t,e,"clipSpacePos",r,3,20,0)&&Cw(n,t,e,"uv",r,2,20,12)}function z4(n,t,e,r,a,i,u){var l,c,f;Ae(n,t,function(){return n.bindTexture(n.TEXTURE_2D,e)}),i instanceof Uint8Array?(l=new Uint8Array(r*a*4),c=n.UNSIGNED_BYTE,f=n.RGBA):(l=new Float32Array(r*a*4),c=n.FLOAT,f=u.internalFormatPackedFloat),l.set(i),Ae(n,t,function(){return n.texImage2D(n.TEXTURE_2D,0,f,r,a,0,n.RGBA,c,l)}),Ae(n,t,function(){return n.bindTexture(n.TEXTURE_2D,null)})}function U4(n,t,e,r){Ae(n,t,function(){return n.bindTexture(n.TEXTURE_2D,e)}),r.data instanceof Uint8Array?Ae(n,t,function(){return n.texImage2D(n.TEXTURE_2D,0,n.RGBA,r.width,r.height,0,n.RGBA,n.UNSIGNED_BYTE,r.data)}):Ae(n,t,function(){return n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,r)}),Ae(n,t,function(){return n.bindTexture(n.TEXTURE_2D,null)})}function V4(n,t,e,r,a){var i=n.createBuffer();Ae(n,t,function(){return n.bindBuffer(n.PIXEL_PACK_BUFFER,i)});var u=16*e*r;return Ae(n,t,function(){return n.bufferData(n.PIXEL_PACK_BUFFER,u,n.STREAM_READ)}),Ae(n,t,function(){return n.readPixels(0,0,r,e,n.RGBA,n.FLOAT,0)}),Ae(n,t,function(){return n.bindBuffer(n.PIXEL_PACK_BUFFER,null)}),i}function H4(n,t,e){var r=n,a=new Float32Array(e);return r.bindBuffer(r.PIXEL_PACK_BUFFER,t),r.getBufferSubData(r.PIXEL_PACK_BUFFER,0,a),r.bindBuffer(r.PIXEL_PACK_BUFFER,null),a}function j4(n,t,e,r,a){var i=ph(e,r),u=i[0],l=i[1],c=new Uint8Array(e*r*4);return Ae(n,t,function(){return n.readPixels(0,0,u,l,a.downloadTextureFormat,n.UNSIGNED_BYTE,c)}),new Float32Array(c.buffer)}function W4(n,t,e,r,a,i,u,l){var c=n,f=new Float32Array(function(d,v){var m=Cl(d,v);return m[0]*m[1]*4}(i,u));return c.bindBuffer(c.PIXEL_PACK_BUFFER,t),c.getBufferSubData(c.PIXEL_PACK_BUFFER,0,f),c.bindBuffer(c.PIXEL_PACK_BUFFER,null),f}function G4(n,t,e,r){var a=new Float32Array(e*r*4);return Ae(n,t,function(){return n.readPixels(0,0,r,e,n.RGBA,n.FLOAT,a)}),a}var q4=function(){function n(t){this.outputTexture=null,this.program=null,this.disposed=!1,this.vertexAttrsAreBound=!1,this.itemsToPoll=[];var e=ue().getNumber("WEBGL_VERSION");t!=null?(this.gl=t,xN(e,t)):this.gl=ra(e);var r="WEBGL_color_buffer_float";if(ue().getNumber("WEBGL_VERSION")===1){if(this.textureFloatExtension=Qc(this.gl,this.debug,"OES_texture_float"),gr(this.gl,"OES_texture_half_float"))this.textureHalfFloatExtension=Qc(this.gl,this.debug,"OES_texture_half_float");else if(ue().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(r),gr(this.gl,"EXT_color_buffer_half_float"))this.colorBufferHalfFloatExtension=Qc(this.gl,this.debug,"EXT_color_buffer_half_float");else if(ue().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(r="EXT_color_buffer_float",gr(this.gl,r))this.colorBufferFloatExtension=this.gl.getExtension(r);else{if(!gr(this.gl,"EXT_color_buffer_half_float"))throw new Error("GL context does not support color renderable floats");this.colorBufferHalfFloatExtension=this.gl.getExtension("EXT_color_buffer_half_float")}this.vertexBuffer=O4(this.gl,this.debug),this.indexBuffer=N4(this.gl,this.debug),this.framebuffer=IN(this.gl,this.debug),this.textureConfig=Jm(this.gl,this.textureHalfFloatExtension)}return Object.defineProperty(n.prototype,"debug",{get:function(){return ue().getBool("DEBUG")},enumerable:!0,configurable:!0}),n.prototype.dispose=function(){var t=this;if(!this.disposed){this.program!=null&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),this.outputTexture!=null&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");var e=this.gl;Ae(e,this.debug,function(){return e.finish()}),Ae(e,this.debug,function(){return e.bindFramebuffer(e.FRAMEBUFFER,null)}),Ae(e,this.debug,function(){return e.deleteFramebuffer(t.framebuffer)}),Ae(e,this.debug,function(){return e.bindBuffer(e.ARRAY_BUFFER,null)}),Ae(e,this.debug,function(){return e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null)}),Ae(e,this.debug,function(){return e.deleteBuffer(t.indexBuffer)}),this.disposed=!0}},n.prototype.createFloat32MatrixTexture=function(t,e){return this.throwIfDisposed(),M4(this.gl,this.debug,t,e,this.textureConfig)},n.prototype.createFloat16MatrixTexture=function(t,e){return this.throwIfDisposed(),I4(this.gl,this.debug,t,e,this.textureConfig)},n.prototype.createUnsignedBytesMatrixTexture=function(t,e){return this.throwIfDisposed(),F4(this.gl,this.debug,t,e,this.textureConfig)},n.prototype.uploadPixelDataToTexture=function(t,e){this.throwIfDisposed(),U4(this.gl,this.debug,t,e)},n.prototype.uploadDenseMatrixToTexture=function(t,e,r,a){this.throwIfDisposed(),z4(this.gl,this.debug,t,e,r,a,this.textureConfig)},n.prototype.createFloat16PackedMatrixTexture=function(t,e){return this.throwIfDisposed(),L4(this.gl,this.debug,t,e,this.textureConfig)},n.prototype.createPackedMatrixTexture=function(t,e){return this.throwIfDisposed(),B4(this.gl,this.debug,t,e,this.textureConfig)},n.prototype.deleteMatrixTexture=function(t){var e=this;this.throwIfDisposed(),this.outputTexture===t&&(Rw(this.gl,this.debug,this.framebuffer),this.outputTexture=null),Ae(this.gl,this.debug,function(){return e.gl.deleteTexture(t)})},n.prototype.downloadByteEncodedFloatMatrixFromOutputTexture=function(t,e,r){var a=this;return this.downloadMatrixDriver(t,function(){return j4(a.gl,a.debug,e,r,a.textureConfig)})},n.prototype.downloadPackedMatrixFromBuffer=function(t,e,r,a,i,u){return W4(this.gl,t,0,0,0,i,u,this.textureConfig)},n.prototype.downloadFloat32MatrixFromBuffer=function(t,e){return H4(this.gl,t,e)},n.prototype.createBufferFromTexture=function(t,e,r){this.bindTextureToFrameBuffer(t);var a=V4(this.gl,this.debug,e,r,this.textureConfig);return this.unbindTextureToFrameBuffer(),a},n.prototype.createAndWaitForFence=function(){var t=this.createFence(this.gl);return this.pollFence(t)},n.prototype.createFence=function(t){var e,r,a=this;if(ue().getBool("WEBGL_FENCE_API_ENABLED")){var i=t,u=i.fenceSync(i.SYNC_GPU_COMMANDS_COMPLETE,0);t.flush(),r=function(){var l=i.clientWaitSync(u,0,0);return l===i.ALREADY_SIGNALED||l===i.CONDITION_SATISFIED},e=u}else ue().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(e=this.beginQuery(),this.endQuery(),r=function(){return a.isQueryAvailable(e,ue().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}):r=function(){return!0};return{query:e,isFencePassed:r}},n.prototype.downloadMatrixFromPackedTexture=function(t,e,r){var a=this;return this.downloadMatrixDriver(t,function(){return G4(a.gl,a.debug,e,r)})},n.prototype.createProgram=function(t){this.throwIfDisposed();var e=this.gl,r=RN(e,this.debug,t),a=k4(e,this.debug),i=TN(e,this.debug);return Ae(e,this.debug,function(){return e.attachShader(i,a)}),Ae(e,this.debug,function(){return e.attachShader(i,r)}),DN(e,this.debug,i),this.debug&&gv(e,this.debug,i),this.vertexAttrsAreBound||(this.setProgram(i),this.vertexAttrsAreBound=P4(e,this.debug,this.program,this.vertexBuffer)),i},n.prototype.deleteProgram=function(t){var e=this;this.throwIfDisposed(),t===this.program&&(this.program=null),t!=null&&Ae(this.gl,this.debug,function(){return e.gl.deleteProgram(t)})},n.prototype.setProgram=function(t){var e=this;this.throwIfDisposed(),this.program=t,this.program!=null&&this.debug&&gv(this.gl,this.debug,this.program),Ae(this.gl,this.debug,function(){return e.gl.useProgram(t)})},n.prototype.getUniformLocation=function(t,e,r){return r===void 0&&(r=!0),this.throwIfDisposed(),r?BN(this.gl,this.debug,t,e):LN(this.gl,t,e)},n.prototype.getAttributeLocation=function(t,e){var r=this;return this.throwIfDisposed(),Ae(this.gl,this.debug,function(){return r.gl.getAttribLocation(t,e)})},n.prototype.getUniformLocationNoThrow=function(t,e){return this.throwIfDisposed(),this.gl.getUniformLocation(t,e)},n.prototype.setInputMatrixTexture=function(t,e,r){this.throwIfDisposed(),this.throwIfNoProgram(),PN(this.gl,this.debug,this.program,t,e,r)},n.prototype.setOutputMatrixTexture=function(t,e,r){this.setOutputMatrixTextureDriver(t,r,e)},n.prototype.setOutputPackedMatrixTexture=function(t,e,r){this.throwIfDisposed();var a=Cl(e,r),i=a[0],u=a[1];this.setOutputMatrixTextureDriver(t,i,u)},n.prototype.setOutputMatrixWriteRegion=function(t,e,r,a){this.setOutputMatrixWriteRegionDriver(r,t,a,e)},n.prototype.setOutputPackedMatrixWriteRegion=function(t,e,r,a){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")},n.prototype.debugValidate=function(){this.program!=null&&gv(this.gl,this.debug,this.program),Zc(this.gl)},n.prototype.executeProgram=function(){this.throwIfDisposed(),this.throwIfNoProgram();var t=this.gl;this.debug&&this.debugValidate(),Ae(t,this.debug,function(){return t.drawElements(t.TRIANGLES,6,t.UNSIGNED_SHORT,0)})},n.prototype.blockUntilAllProgramsCompleted=function(){var t=this;this.throwIfDisposed(),Ae(this.gl,this.debug,function(){return t.gl.finish()})},n.prototype.getQueryTimerExtension=function(){return this.disjointQueryTimerExtension==null&&(this.disjointQueryTimerExtension=Qc(this.gl,this.debug,ue().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension},n.prototype.getQueryTimerExtensionWebGL2=function(){return this.getQueryTimerExtension()},n.prototype.getQueryTimerExtensionWebGL1=function(){return this.getQueryTimerExtension()},n.prototype.beginQuery=function(){if(ue().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){var t=this.gl,e=this.getQueryTimerExtensionWebGL2(),r=t.createQuery();return t.beginQuery(e.TIME_ELAPSED_EXT,r),r}var a=this.getQueryTimerExtensionWebGL1(),i=a.createQueryEXT();return a.beginQueryEXT(a.TIME_ELAPSED_EXT,i),i},n.prototype.endQuery=function(){if(ue().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")!==2){var t=this.getQueryTimerExtensionWebGL1();t.endQueryEXT(t.TIME_ELAPSED_EXT)}else{var e=this.gl,r=this.getQueryTimerExtensionWebGL2();e.endQuery(r.TIME_ELAPSED_EXT)}},n.prototype.waitForQueryAndGetTime=function(t){return _e(this,void 0,void 0,function(){var e=this;return Se(this,function(r){switch(r.label){case 0:return[4,bw(function(){return e.disposed||e.isQueryAvailable(t,ue().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))})];case 1:return r.sent(),[2,this.getQueryTime(t,ue().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))]}})})},n.prototype.getQueryTime=function(t,e){if(e===0)return null;if(e===2){var r=this.gl;return r.getQueryParameter(t,r.QUERY_RESULT)/1e6}var a=this.getQueryTimerExtensionWebGL1();return a.getQueryObjectEXT(t,a.QUERY_RESULT_EXT)/1e6},n.prototype.isQueryAvailable=function(t,e){if(e===0)return!0;if(e===2){var r=this.gl,a=this.getQueryTimerExtensionWebGL2(),i=r.getQueryParameter(t,r.QUERY_RESULT_AVAILABLE);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(a.GPU_DISJOINT_EXT)),i&&!this.disjoint}return i=(a=this.getQueryTimerExtensionWebGL1()).getQueryObjectEXT(t,a.QUERY_RESULT_AVAILABLE_EXT),this.disjoint==null&&(this.disjoint=this.gl.getParameter(a.GPU_DISJOINT_EXT)),i&&!this.disjoint},n.prototype.pollFence=function(t){var e=this;return new Promise(function(r){e.addItemToPoll(function(){return t.isFencePassed()},function(){return r()})})},n.prototype.pollItems=function(){for(var t=function(r){for(var a=0;a<r.length&&r[a]();++a);return a-1}(this.itemsToPoll.map(function(r){return r.isDoneFn})),e=0;e<=t;++e)(0,this.itemsToPoll[e].resolveFn)();this.itemsToPoll=this.itemsToPoll.slice(t+1)},n.prototype.addItemToPoll=function(t,e){var r=this;this.itemsToPoll.push({isDoneFn:t,resolveFn:e}),this.itemsToPoll.length>1||bw(function(){return r.pollItems(),r.itemsToPoll.length===0})},n.prototype.bindTextureToFrameBuffer=function(t){this.throwIfDisposed(),yv(this.gl,this.debug,t,this.framebuffer),this.debug&&Zc(this.gl)},n.prototype.unbindTextureToFrameBuffer=function(){this.outputTexture!=null?(yv(this.gl,this.debug,this.outputTexture,this.framebuffer),this.debug&&Zc(this.gl)):Rw(this.gl,this.debug,this.framebuffer)},n.prototype.downloadMatrixDriver=function(t,e){this.bindTextureToFrameBuffer(t);var r=e();return this.unbindTextureToFrameBuffer(),r},n.prototype.setOutputMatrixTextureDriver=function(t,e,r){this.throwIfDisposed();var a=this.gl;yv(a,this.debug,t,this.framebuffer),this.debug&&Zc(a),this.outputTexture=t,Ae(a,this.debug,function(){return a.viewport(0,0,e,r)}),Ae(a,this.debug,function(){return a.scissor(0,0,e,r)})},n.prototype.setOutputMatrixWriteRegionDriver=function(t,e,r,a){var i=this;this.throwIfDisposed(),Ae(this.gl,this.debug,function(){return i.gl.scissor(t,e,r,a)})},n.prototype.throwIfDisposed=function(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")},n.prototype.throwIfNoProgram=function(){if(this.program==null)throw new Error("No GPU program is currently set.")},n}();function zw(n,t){if(n.length!==t.length)throw Error("Binary was compiled with "+n.length+" inputs, but was executed with "+t.length+" inputs");n.forEach(function(e,r){var a=e.logicalShape,i=t[r],u=i.shape;if(!un(a,u))throw Error("Binary was compiled with different shapes than the current args. Shapes "+a+" and "+u+" must match");if(!e.isUniform||!i.isUniform){var l=e.texShape,c=i.isUniform?null:i.texData.texShape;if(!un(l,c))throw Error("Binary was compiled with different texture shapes than the current args. Shape "+l+" and "+c+" must match")}})}var K4=function(n,t,e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n;for(var r=e.filterWidth,a=e.inChannels,i=e.strideWidth,u=e.strideHeight,l=e.padInfo,c=e.outWidth,f=e.dilationWidth,d=e.dilationHeight,v=e.dataFormat,m=l.left,g=l.top,b=a*r,w=Sn(),S=v==="channelsLast",_=S?0:1,E=S?1:2,R="",C=0;C<=1;C++)for(var A=0;A<=1;A++)R+=`
          blockIndex = rc.y + `+A+`;
          pos = rc.x + `+C+`;

          if(blockIndex < `+n[1]+" && pos < "+n[0]+`) {
            offsetY = int(blockIndex / (`+c+")) * "+u+" - "+g+`;
            d0 = offsetY + `+d+" * (pos / "+b+`);

            if(d0 < `+t[_]+` && d0 >= 0) {

              offsetX = int(mod(float(blockIndex), `+c+".) * "+i+". - "+m+`.);
              d1 = offsetX + `+f+" * (int(mod(float(pos), "+b+".) / "+a+`.));

              if(d1 < `+t[E]+` && d1 >= 0) {

                ch = int(mod(float(pos), `+a+`.));

                if (`+S+`) {
                  innerDims = vec2(d1, ch);
                  result[`+(2*C+A)+`] = getChannel(
                    getA(d0, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                } else {
                  innerDims = vec2(d0, d1);
                  result[`+(2*C+A)+`] = getChannel(
                    getA(ch, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                }
              }
            }
          }
        `;this.userCode=`
      void main() {
        ivec2 rc = getOutputCoords();

        vec4 result = vec4(0);

        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;
        vec2 innerDims;

        `+R+`

        `+w.output+` = result;
      }
    `},X4=function(n,t,e,r,a){this.variableNames=["x"],this.outputShape=[];var i,u=t,l=n[3]-1;this.outputShape=n;var c="float("+e+") + float("+r+") * sum";i=a===.5?"inversesqrt("+c+")":a===1?"1.0/("+c+")":"exp(log("+c+") * float(-"+a+"));",this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];
        int d = coords[3];
        float x = getX(b, r, c, d);
        float sum = 0.0;
        for (int j = -`+u+"; j <= "+u+`; j++) {
          int idx = d + j;
          if (idx >= 0 && idx <=  `+l+`) {
            float z = getX(b, r, c, idx);
            sum += z * z;
          }
        }
        float val = x * `+i+`;
        setOutput(val);
      }
    `},$4=function(n,t,e,r,a){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=n,this.depth=n[3],this.depthRadius=t,this.bias=e,this.alpha=r,this.beta=a,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];

        float result = 0.0;
        for (int d = 0; d < `+this.depth+`; ++d) {
          int depthBegin = int(max(0.0, float(d - `+t+`)));
          int depthEnd = int(min(float(`+this.depth+`),
              float(d + `+t+` + 1)));

          const int MIN_DEPTH_BEGIN = 0;
          const int MAX_DEPTH_END = `+this.depth+`;

          float norm = 0.0;
          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd) {
              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);
            }
            else {
              break;
            }
          }

          norm = float(`+r+") * norm + float("+e+`);

          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd){
              float dyi = -2.0 * float(`+r+`)
                * float(`+a+`)
                * getInputImage(b ,r ,c, k) * getOutputImage(b, r, c, d)
                / norm;
              if (k == d) {
                dyi += pow(norm, -1.0 * `+a+`);
              }
              if (k == coords[3]) {
                dyi *= getDy(b, r, c, d);
                result += dyi;
              }
            }
            else {
              break;
            }
          }
      }
      setOutput(result);
      }
    `},Y4=function(n,t,e,r,a){this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;var i,u=t,l=n[3]-1;this.outputShape=n;var c="float("+e+") + float("+r+") * sum";i=a===.5?"inversesqrt("+c+")":a===1?"1.0/("+c+")":"exp(log("+c+") * float(-"+a+"));",this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords.x;
        int r = coords.y;
        int c = coords.z;
        int d = coords.w;

        bool hasNextCol = d < `+this.outputShape[3]+`;
        bool hasNextRow = c < `+this.outputShape[2]+`;

        vec4 sum = vec4(0.);
        vec4 xFragAtOutputCoords = getX(b, r, c, d);

        vec4 xAtOutputCoords = vec4(
          getChannel(xFragAtOutputCoords, vec2(c, d)),
          hasNextCol ?
            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,
          hasNextRow ?
            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,
          (hasNextRow && hasNextCol) ?
            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0
        );

        int firstChannel = d - `+u+`;
        vec2 cache = vec2(0.);
        if(firstChannel >= 0){
          vec4 firstChannelFrag = getX(b, r, c, firstChannel);
          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));
            if(hasNextRow){
              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));
            }
        }

        ivec2 depth = ivec2(d, d + 1);
        for (int j = - `+u+"; j <= "+u+`; j++) {
          ivec2 idx = depth + j;
          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));
          bvec2 belowUpperBound = lessThanEqual(idx, ivec2(`+l+`));

          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;
          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;

          if(depthInRange || depthPlusOneInRange){
            vec4 z = vec4(0.);
            vec4 xFragAtCurrentDepth;
            z.xz = cache.xy;
            if(depthPlusOneInRange && hasNextCol){
              xFragAtCurrentDepth = idx.y != d ?
                getX(b, r, c, idx.y) : xFragAtOutputCoords;
              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));
              if(hasNextRow){
                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));
              }
            }
            cache.xy = z.yw;
            sum += z * z;
          }
        }
        vec4 result = xAtOutputCoords * `+i+`;
        setOutput(result);
      }
    `},Q4=function(n){this.variableNames=["dy","maxPos"],this.outputShape=n.inShape;var t=n.strideHeight,e=n.strideWidth,r=n.dilationHeight,a=n.effectiveFilterHeight,i=n.effectiveFilterWidth,u=a-1-n.padInfo.top,l=i-1-n.padInfo.left,c=a*i-1;this.userCode=`
      const ivec2 pads = ivec2(`+u+", "+l+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < `+a+`;
          wR += `+r+`) {
          float dyR = float(dyRCorner + wR) / `+t+`.0;

          if (dyR < 0.0 || dyR >= `+n.outHeight+`.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < `+i+`; wC++) {
            float dyC = float(dyCCorner + wC) / `+e+`.0;

            if (dyC < 0.0 || dyC >= `+n.outWidth+`.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);
            int maxPosValue = `+c+` - int(getMaxPos(b, idyR, idyC, d));

            // Get the current value, check it against the value from the
            // position matrix.
            int curPosValue = wR * `+i+` + wC;
            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

            dotProd += dyValue * mask;
          }
        }
        setOutput(dotProd);
      }
    `},Z4=function(n){this.variableNames=["dy","maxPos"],this.outputShape=n.inShape;var t=n.strideDepth,e=n.strideHeight,r=n.strideWidth,a=n.dilationDepth,i=n.dilationHeight,u=n.dilationWidth,l=n.effectiveFilterDepth,c=n.effectiveFilterHeight,f=n.effectiveFilterWidth,d=l-1-n.padInfo.front,v=c-1-n.padInfo.top,m=f-1-n.padInfo.left,g=l*c*f-1;this.userCode=`
      const ivec3 pads = ivec3(`+d+", "+v+", "+m+`);

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < `+l+`;
           wD += `+a+`) {
          float dyD = float(dyDCorner + wD) / `+t+`.0;

          if (dyD < 0.0 || dyD >= `+n.outDepth+`.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < `+c+`;
              wR += `+i+`) {
            float dyR = float(dyRCorner + wR) / `+e+`.0;

            if (dyR < 0.0 || dyR >= `+n.outHeight+`.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < `+f+`;
                wC += `+u+`) {
              float dyC = float(dyCCorner + wC) / `+r+`.0;

              if (dyC < 0.0 || dyC >= `+n.outWidth+`.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);
              int maxPosValue = `+g+` -
                  int(getMaxPos(batch, idyD, idyR, idyC, ch));

              // Get the current value, check it against the value from the
              // position matrix.
              int curPosValue =
                  wD * `+c+" * "+f+` +
                  wR * `+f+` + wC;
              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

              dotProd += dyValue * mask;
            }
          }
        }
        setOutput(dotProd);
      }
    `},Sv=function(n,t,e,r,a,i,u){e===void 0&&(e=!1),r===void 0&&(r=!1),a===void 0&&(a=!1),i===void 0&&(i=null),u===void 0&&(u=!1),this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t;var l=e?n[1]:n[2],c=Math.ceil(l/2),f=e?"i * 2, rc.y":"rc.y, i * 2",d=r?"rc.z, i * 2":"i * 2, rc.z",v=e?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],m=r?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"],g="",b="";i&&(g=u?`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          `+i+`
        }`:`vec4 activation(vec4 x) {
          `+i+`
        }`,b="result = activation(result);");var w=a?"result += getBiasAtOutCoords();":"";a&&this.variableNames.push("bias"),u&&this.variableNames.push("preluActivationWeights"),this.userCode=`
      `+g+`

      const float sharedDimension = `+c+`.0;

      vec4 dot2x2ARowBCol(ivec3 rc) {
        vec4 result = vec4(0);
        for (int i = 0; i < `+c+`; i++) {
          vec4 a = getMatrixA(rc.x, `+f+`);
          vec4 b = getMatrixB(rc.x, `+d+`);

          // These swizzled products need to be separately added.
          // See: https://github.com/tensorflow/tfjs/issues/1735
          result += (`+v[0]+" * "+m[0]+`);
          result += (`+v[1]+" * "+m[1]+`);
        }
        return result;
      }

      void main() {
        ivec3 rc = getOutputCoords();
        vec4 result = dot2x2ARowBCol(rc);

        `+w+`

        `+b+`

        setOutput(result);
      }
    `},J4=function(){function n(t,e,r){this.variableNames=["probs"],this.outputShape=[t,r],this.userCode=`
      uniform float seed;

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];

        float r = random(seed);
        float cdf = 0.0;

        for (int i = 0; i < `+(e-1)+`; i++) {
          cdf += getProbs(batch, i);

          if (r < cdf) {
            setOutput(float(i));
            return;
          }
        }

        // If no other event happened, last event happened.
        setOutput(float(`+(e-1)+`));
      }
    `}return n.prototype.getCustomSetupFunc=function(t){var e=this;return function(r,a){e.seedLoc==null&&(e.seedLoc=r.getUniformLocation(a,"seed")),r.gl.uniform1f(e.seedLoc,t)}},n}(),eM=function(n,t,e,r){this.variableNames=["indices"],this.outputShape=[n,t],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int index = round(getIndices(coords.x));
        setOutput(mix(float(`+r+"), float("+e+`),
                      float(index == coords.y)));
      }
    `},tM=function(n){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=n;var t=n.length;if(t===0)this.userCode=`
        void main() {
          setOutput(vec4(getA(), 0., 0., 0.));
        }
      `;else{var e=Ln("rc",t),r=wt(t),a=function(l,c,f){if(l===1)return"rc > "+c[0];for(var d="",v=l-2;v<l;v++)d+=f[v]+" >= "+c[v],v<l-1&&(d+="||");return d}(t,n,e),i=function(l,c,f,d){if(l===1)return"";var v=d.slice(-2);return`
    int r = `+v[0]+`;
    int c = `+v[1]+`;
    int rp1 = r + 1;
    int cp1 = c + 1;

    bool cEdge = cp1 >= `+c+`;
    bool rEdge = rp1 >= `+f+`;
  `}(t,n[n.length-1],n[n.length-2],e),u=function(l,c){var f=l.length,d=function(v,m){for(var g=[],b=0;b<=1;b++)for(var w=0;w<=1;w++){for(var S=(b===0?"r":"rp1")+", "+(w===0?"c":"cp1"),_=2;_<v;_++)S=m[m.length-1-_]+","+S;g.push(S)}return g}(f,c);return f===1?`getA(rc),
            rc + 1 >= `+l[0]+` ? 0. : getA(rc + 1),
            0, 0`:"getA("+d[0]+`),
          cEdge ? 0. : getA(`+d[1]+`),
          rEdge ? 0. : getA(`+d[2]+`),
          rEdge || cEdge ? 0. : getA(`+d[3]+")"}(n,e);this.userCode=`
        void main() {
          `+r+` rc = getOutputCoords();

          if(`+a+`) {
            setOutput(vec4(0));
          } else {
            `+i+`

            setOutput(vec4(`+u+`));
          }
        }
      `}},nM=function(n,t,e){this.variableNames=["x"],this.outputShape=t.map(function(c,f){return c[0]+n[f]+c[1]});var r=n.length,a=wt(r),i=t.map(function(c){return c[0]}).join(","),u=t.map(function(c,f){return c[0]+n[f]}).join(","),l=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,r);this.userCode=r!==1?`
      `+a+" start = "+a+"("+i+`);
      `+a+" end = "+a+"("+u+`);

      void main() {
        `+a+` outC = getOutputCoords();
        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {
          setOutput(float(`+e+`));
        } else {
          `+a+` coords = outC - start;
          setOutput(getX(`+l+`));
        }
      }
    `:`
        int start = `+i+`;
        int end = `+u+`;

        void main() {
          int outC = getOutputCoords();
          if (outC < start || outC >= end) {
            setOutput(float(`+e+`));
          } else {
            setOutput(getX(outC - start));
          }
        }
      `},rM=function(n,t,e){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t.map(function(S,_){return S[0]+n[_]+S[1]});for(var r=n.length,a=wt(r),i=t.map(function(S){return S[0]}).join(","),u=t.map(function(S,_){return S[0]+n[_]}).join(","),l=Ln("rc",r),c=Ln("source",r),f=l[r-1]+" < "+this.outputShape[r-1],d=r===1?"source":"vec2("+c.slice(-2).join()+")",v=[a+" rc = outputLoc;",l[r-1]+` += 1;
       if(`+f+`) {
      `,r===1?"":`}
       rc = outputLoc;
       `+l[r-2]+` += 1;
       if(`+l[r-2]+" < "+this.outputShape[r-2]+") {",r===1?"":"  "+l[r-1]+` += 1;
         if(`+f+") {"],m=r===1?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))",g="",b=0,w=r===1?2:4;b<w;b++)g+=`
        `+v[b]+`
        if (`+m+`) {
          result[`+b+"] = float("+e+`);
        } else {
          `+a+` source = rc - start;
          result[`+b+"] = getChannel(getX("+c.join()+"), "+d+`);
        }
      `;g+=r===1?"} ":"}}",this.userCode=`
      const `+a+" start = "+a+"("+i+`);
      const `+a+" end = "+a+"("+u+`);

      void main() {
        `+a+` outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        `+g+`
        setOutput(result);
      }
    `},Ev=function(n,t,e){if(this.variableNames=["x"],t==="avg"&&e)throw new Error("Cannot compute positions for average pool.");var r=n.filterWidth,a=n.strideHeight,i=n.strideWidth,u=n.dilationHeight,l=n.dilationWidth,c=n.effectiveFilterHeight,f=n.effectiveFilterWidth,d=n.padInfo.top,v=n.padInfo.left;this.outputShape=n.outShape;var m=t==="avg",g="0.0";if(m||(g="-1.0 / 1e-20"),e)this.userCode=`
        const ivec2 strides = ivec2(`+a+", "+i+`);
        const ivec2 pads = ivec2(`+d+", "+v+`);

        void main() {
          ivec4 coords = getOutputCoords();
          int batch = coords[0];
          int d = coords[3];

          ivec2 xRCCorner = coords.yz * strides - pads;
          int xRCorner = xRCCorner.x;
          int xCCorner = xRCCorner.y;

          // max/min x(?, ?, d) to get y(yR, yC, d).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;
          float avgValue = 0.0;

          for (int wR = 0; wR < `+c+`;
              wR += `+u+`) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= `+n.inHeight+`) {
              continue;
            }

            for (int wC = 0; wC < `+f+`;
                wC += `+l+`) {
              int xC = xCCorner + wC;

              if (xC < 0 || xC >= `+n.inWidth+`) {
                continue;
              }

              float value = getX(batch, xR, xC, d);

              // If a min / max value has already been found, use it. If not,
              // use the current value.
              float currMinMaxValue = mix(
                  value, minMaxValue, minMaxValueFound);
              if (value >= currMinMaxValue) {
                minMaxValue = value;
                minMaxValueFound = 1.0;
                minMaxPosition = wR * `+f+` + wC;
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;else{var b=t+"("+t+"("+t+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";t==="avg"&&(b="avgValue / count");var w=4*Math.floor(r/4),S=r%4,_=`
      if (`+m+`) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = max(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec2 strides = ivec2(`+a+", "+i+`);
      const ivec2 pads = ivec2(`+d+", "+v+`);
      const float initializationValue = `+g+`;
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xR, int xC, int d) {
        if (xC < 0 || xC >= `+n.inWidth+`) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xR, xC, d);
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d = coords[3];

        ivec2 xRCCorner = coords.yz * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // max/min x(?, ?, d) to get y(yR, yC, d).
        // ? = to be determined
        vec4 minMaxValue = vec4(`+g+`);
        float avgValue = 0.0;
        count = 0.0;

        for (int wR = 0; wR < `+c+`;
            wR += `+u+`) {
          int xR = xRCorner + wR;

          if (xR < 0 || xR >= `+n.inHeight+`) {
            continue;
          }

          for (int wC = 0; wC < `+w+`; wC += 4) {
            int xC = xCCorner + wC * `+l+`;

            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + `+l+`, d),
              getValue(batch, xR, xC + 2 * `+l+`, d),
              getValue(batch, xR, xC + 3 * `+l+`, d)
            );

            `+_+`
          }

          int xC = xCCorner + `+w+`;
          if (`+(S===1)+`) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              initializationValue,
              initializationValue,
              initializationValue
            );

            `+_+`
          } else if (`+(S===2)+`) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + `+l+`, d),
              initializationValue,
              initializationValue
            );

            `+_+`
          } else if (`+(S===3)+`) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + `+l+`, d),
              getValue(batch, xR, xC + 2 * `+l+`, d),
              initializationValue
            );

            `+_+`
          }
        }
        setOutput(`+b+`);
      }
    `}},Cv=function(n,t,e){if(this.variableNames=["x"],t==="avg"&&e)throw new Error("Cannot compute positions for average pool.");var r=n.filterWidth,a=n.strideDepth,i=n.strideHeight,u=n.strideWidth,l=n.dilationDepth,c=n.dilationHeight,f=n.dilationWidth,d=n.effectiveFilterDepth,v=n.effectiveFilterHeight,m=n.effectiveFilterWidth,g=n.padInfo.front,b=n.padInfo.top,w=n.padInfo.left;this.outputShape=n.outShape;var S=t==="avg",_="0.0";if(S||(_="-1.0 / 1e-20"),e)this.userCode=`
        const ivec3 strides =
            ivec3(`+a+", "+i+", "+u+`);
        const ivec3 pads = ivec3(`+g+", "+b+", "+w+`);

        void main() {
          ivec5 coords = getOutputCoords();
          int batch = coords.x;
          int ch = coords.u;

          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
          int xDCorner = xCorner.x;
          int xRCorner = xCorner.y;
          int xCCorner = xCorner.z;

          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;

          for (int wD = 0; wD < `+d+`;
              wD += `+l+`) {
            int xD = xDCorner + wD;

            if (xD < 0 || xD >= `+n.inDepth+`) {
              continue;
            }

            for (int wR = 0; wR < `+v+`;
                wR += `+c+`) {
              int xR = xRCorner + wR;

              if (xR < 0 || xR >= `+n.inHeight+`) {
                continue;
              }

              for (int wC = 0; wC < `+m+`;
                  wC += `+f+`) {
                int xC = xCCorner + wC;

                if (xC < 0 || xC >= `+n.inWidth+`) {
                  continue;
                }

                float value = getX(batch, xD, xR, xC, ch);

                // If a min / max value has already been found, use it. If not,
                // use the current value.
                float currMinMaxValue = mix(
                    value, minMaxValue, minMaxValueFound);
                if (value >= currMinMaxValue) {
                  minMaxValue = value;
                  minMaxValueFound = 1.0;
                  minMaxPosition =
                      wD * `+v+" * "+m+` +
                      wR * `+m+` + wC;;
                }
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;else{var E=t+"("+t+"("+t+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";t==="avg"&&(E="avgValue / count");var R=4*Math.floor(r/4),C=r%4,A=`
      if (`+S+`) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = max(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec3 strides =
        ivec3(`+a+", "+i+", "+u+`);
      const ivec3 pads = ivec3(`+g+", "+b+", "+w+`);
      const float initializationValue = `+_+`;
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xD, int xR, int xC, int ch) {
        if (xC < 0 || xC >= `+n.inWidth+`) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xD, xR, xC, ch);
      }

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xDCorner = xCorner.x;
        int xRCorner = xCorner.y;
        int xCCorner = xCorner.z;

        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).
        // ? = to be determined
        vec4 minMaxValue = vec4(`+_+`);
        float avgValue = 0.0;
        count = 0.0;

        for (int wD = 0; wD < `+d+`;
            wD += `+l+`) {
          int xD = xDCorner + wD;

          if (xD < 0 || xD >= `+n.inDepth+`) {
            continue;
          }

          for (int wR = 0; wR < `+v+`;
            wR += `+c+`) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= `+n.inHeight+`) {
              continue;
            }

            for (int wC = 0; wC < `+R+`; wC += 4) {
              int xC = xCCorner + wC * `+f+`;

              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + `+f+`, ch),
                getValue(batch, xD, xR, xC + 2 * `+f+`, ch),
                getValue(batch, xD, xR, xC + 3 * `+f+`, ch)
              );

              `+A+`
            }

            int xC = xCCorner + `+R+`;
            if (`+(C===1)+`) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                initializationValue,
                initializationValue,
                initializationValue
              );

              `+A+`
            } else if (`+(C===2)+`) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + `+f+`, ch),
                initializationValue,
                initializationValue
              );

              `+A+`
            } else if (`+(C===3)+`) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + `+f+`, ch),
                getValue(batch, xD, xR, xC + 2 * `+f+`, ch),
                initializationValue
              );

              `+A+`
            }
          }
          setOutput(`+E+`);
        }
      }
    `}},aM=function(n,t){this.variableNames=["x"];var e=n.windowSize,r=n.batchSize,a=n.inSize,i=Math.ceil(a/e);this.outputShape=[r,i];var u="0.0",l="";t==="prod"?u="1.0":t==="min"?(u="1.0 / 1e-20",l="min"):t==="max"&&(u="-1.0 / 1e-20",l="max");var c=t+"("+t+"("+t+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";t==="sum"?c="sumValue":t==="prod"?c="prodValue":t==="all"?c="allValue":t==="any"&&(c="anyValue");var f=4*Math.floor(e/4),d=e%4,v=`
      if (`+(t==="sum")+`) {
        sumValue += dot(values, ones);
      } else if (`+(t==="prod")+`) {
        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);
        prodValue *= tmp[0] * tmp[1];
      } else {
        minMaxValue = `+l+`(values, minMaxValue);
      }
    `,m="vec4";t==="all"?(u="1.0",v=`
        bool reducedAllValue = all(values);
        float floatedReducedAllValue = float(reducedAllValue);
        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);
      `,m="bvec4"):t==="any"&&(u="0.0",v=`
        bool reducedAnyValue = any(values);
        float floatedReducedAnyValue = float(reducedAnyValue);
        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);
      `,m="bvec4");var g="";a%e>0&&(g=`
        if (inIdx < 0 || inIdx >= `+a+`) {
          return initializationValue;
        }
      `),this.userCode=`
      const float initializationValue = `+u+`;
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        `+g+`
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * `+e+`;

        vec4 minMaxValue = vec4(`+u+`);
        float prodValue = 1.0;
        float sumValue = 0.0;
        float allValue = 1.0;
        float anyValue = 0.0;

        for (int i = 0; i < `+f+`; i += 4) {
          int inIdx = inOffset + i;
          `+m+" values = "+m+`(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          `+v+`
        }

        int inIdx = inOffset + `+f+`;
        if (`+(d===1)+`) {
          `+m+" values = "+m+`(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          `+v+`
        } else if (`+(d===2)+`) {
          `+m+" values = "+m+`(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          `+v+`
        } else if (`+(d===3)+`) {
          `+m+" values = "+m+`(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          `+v+`
        }
        setOutput(`+c+`);
      }
    `},iM=function(n,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n;for(var e="",r=0;r<4;r++){var a="thisRC = rc;";r%2==1&&(a+="thisRC.z += 1;"),r>1&&(a+="thisRC.y += 1;"),e+=`
        `+a+`
        `+(r>0?"if(thisRC.y < rows && thisRC.z < cols){":"")+`
          int flatIndex = getFlatIndex(thisRC);

          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);
          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));

          result[`+r+`] =
            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);
        `+(r>0?"}":"")+`
      `}this.userCode=`
      
    ivec3 inputCoordsFromReshapedOutCoords(int index) {
      `+to(["r","c","d"],t)+`
      return ivec3(r, c, d);
    }
  
      `+lg(n)+`

      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0.);

        ivec3 thisRC;
        int rows = `+n[1]+`;
        int cols = `+n[2]+`;

        `+e+`

        setOutput(result);
      }
    `},oM=function(n,t,e){this.variableNames=["dy"],this.outputShape=[],this.outputShape=t.shape;var r=t.shape,a=r[1],i=r[2],u=n.shape,l=u[1],c=u[2],f=[e&&l>1?a-1:a,e&&c>1?i-1:i],d=[e&&l>1?l-1:l,e&&c>1?c-1:c],v=f[0]/d[0],m=f[1]/d[1],g=1/v,b=1/m,w=2*Math.ceil(g)+2,S=2*Math.ceil(b)+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(`+v+`);
        const float widthScale = float(`+m+`);

        const float invHeightScale = float(`+g+`);
        const float invWidthScale = float(`+b+`);

        const int winHeight = int(`+w+`);
        const int winWidth = int(`+S+`);

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(startRLerp - float(winHeight / 2));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(startCLerp - float(winWidth / 2));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= `+l+`) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= `+c+`) {
              continue;
            }

            float dxR = float(dyR) * heightScale;
            int topDxRIndex = int(floor(dxR));
            int bottomDxRIndex = int(min(ceil(dxR), `+(a-1)+`.0));
            float dxRLerp = dxR - float(topDxRIndex);
            float inverseDxRLerp = 1.0 - dxRLerp;

            float dxC = float(dyC) * widthScale;
            int leftDxCIndex = int(floor(dxC));
            int rightDxCIndex = int(min(ceil(dxC), `+(i-1)+`.0));
            float dxCLerp = dxC - float(leftDxCIndex);
            float inverseDxCLerp = 1.0 - dxCLerp;

            if (r == topDxRIndex && c == leftDxCIndex) {
              // topLeft
              accumulator +=
                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;
            }

            if (r == topDxRIndex && c == rightDxCIndex) {
              // topRight
              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;
            }

            if (r == bottomDxRIndex && c == leftDxCIndex) {
              // bottomLeft
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;
            }

            if (r == bottomDxRIndex && c == rightDxCIndex) {
              // bottomRight
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `},sM=function(n,t,e,r){this.variableNames=["A"],this.outputShape=[];var a=n[0],i=n[1],u=n[2],l=n[3];this.outputShape=[a,t,e,l];var c=[r&&t>1?i-1:i,r&&e>1?u-1:u],f=[r&&t>1?t-1:t,r&&e>1?e-1:e];this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          `+c[0]/f[0]+`,
          `+c[1]/f[1]+`);
      const vec2 inputShapeRC = vec2(`+i+".0, "+u+`.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = vec2(yRC) * effectiveInputOverOutputRatioRC;

        // Compute the four integer indices.
        ivec2 sourceFloorRC = ivec2(sourceFracIndexRC);
        ivec2 sourceCeilRC = ivec2(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);
        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);
        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);
        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);

        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);

        float top = topLeft + (topRight - topLeft) * fracRC.y;
        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;
        float newValue = top + (bottom - top) * fracRC.x;

        setOutput(newValue);
      }
    `},uM=function(n,t,e,r){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];var a=n[0],i=n[1],u=n[2],l=n[3];this.outputShape=[a,t,e,l];var c=[r&&t>1?i-1:i,r&&e>1?u-1:u],f=[r&&t>1?t-1:t,r&&e>1?e-1:e];this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          `+c[0]/f[0]+`,
          `+c[1]/f[1]+`,
          `+c[1]/f[1]+`);
      const vec3 inputShapeRC = vec3(`+i+".0, "+u+`.0,
                                     `+u+`.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = vec3(yRC) * effectiveInputOverOutputRatioRC;

        // Compute the four integer indices.
        ivec3 sourceFloorRC = ivec3(sourceFracIndexRC);
        ivec3 sourceCeilRC = ivec3(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < `+(l-1)+`;
        bool hasNextRow = coords.z < `+(e-1)+`;

        // In parallel, construct four corners for all four components in
        // packed 2x2 cell.
        vec4 topLeft = vec4(
          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 bottomLeft = vec4(
          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 topRight = vec4(
          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec4 bottomRight = vec4(
          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);

        vec4 top = mix(topLeft, topRight, fracRC.yyzz);
        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);
        vec4 newValue = mix(top, bottom, fracRC.x);

        setOutput(newValue);
      }
    `},lM=function(n,t,e){this.variableNames=["dy"],this.outputShape=[],this.outputShape=t.shape;var r=t.shape,a=r[1],i=r[2],u=n.shape,l=u[1],c=u[2],f=[e&&l>1?a-1:a,e&&c>1?i-1:i],d=[e&&l>1?l-1:l,e&&c>1?c-1:c],v=f[0]/d[0],m=f[1]/d[1],g=1/v,b=1/m,w=2*Math.ceil(g)+2,S=2*Math.ceil(b)+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(`+v+`);
        const float widthScale = float(`+m+`);

        const float invHeightScale = float(`+g+`);
        const float invWidthScale = float(`+b+`);

        const int winHeight = int(`+w+`);
        const int winWidth = int(`+S+`);

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(floor(startRLerp - float(winHeight / 2)));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(floor(startCLerp - float(winWidth / 2)));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= `+l+`) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= `+c+`) {
              continue;
            }

            float sourceFracRow =
              float(`+f[0]+`) *
                (float(dyR) / float(`+d[0]+`));

            float sourceFracCol =
                float(`+f[1]+`) *
                  (float(dyC) / float(`+d[1]+`));

            int sourceNearestRow = int(min(
                float(int(`+a+`) - 1),
                `+e+` ? float(round(sourceFracRow)) :
                                  float(floor(sourceFracRow))));

            int sourceNearestCol = int(min(
                float(int(`+i+`) - 1),
                `+e+` ? float(round(sourceFracCol)) :
                                  float(floor(sourceFracCol))));

            if (r == sourceNearestRow && c == sourceNearestCol) {
              accumulator += getDy(b, dyR, dyC, d);
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `},cM=function(n,t,e,r){this.variableNames=["A"],this.outputShape=[];var a=n[0],i=n[1],u=n[2],l=n[3];this.outputShape=[a,t,e,l];var c=[r&&t>1?i-1:i,r&&e>1?u-1:u],f=[r&&t>1?t-1:t,r&&e>1?e-1:e],d=r?"0.5":"0.0";this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          `+c[0]/f[0]+`,
          `+c[1]/f[1]+`);
      const vec2 inputShapeRC = vec2(`+i+".0, "+u+`.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = vec2(yRC) * effectiveInputOverOutputRatioRC;

        // Compute the coordinators of nearest neighbor point.
        ivec2 sourceNearestRC = ivec2(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + `+d+`)));

        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);

        setOutput(newValue);
      }
    `},fM=function(n,t){this.variableNames=["x"];var e=n.length;if(e>4)throw new Error("WebGL backend: Reverse of rank-"+e+" tensor is not yet supported");if(this.outputShape=n,e!==1){var r=n.map(function(i,u){return function(l){return t.indexOf(l)!==-1&&n[l]!==1?n[l]+" - coords["+l+"] - 1":"coords["+l+"]"}(u)}).join(","),a=wt(e);this.userCode=`
      void main() {
        `+a+` coords = getOutputCoords();
        setOutput(getX(`+r+`));
      }
    `}else this.userCode=`
        void main() {
          int coord = getOutputCoords();
          setOutput(getX(`+n[0]+` - coord - 1));
        }
      `},hM=function(n,t){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;var e=n.length;if(e>4)throw new Error("WebGL backend: Reverse of rank-"+e+" tensor is not yet supported");this.outputShape=n;var r=Ln("rc",e),a=r[e-1]+" + 1 < "+this.outputShape[e-1],i=r[e-2]+" + 1 < "+this.outputShape[e-2],u=wt(e);function l(c){var f=n.map(function(d,v){return function(m,g){return t.indexOf(m)!==-1&&n[m]!==1?n[m]+" - "+g[m]+" - 1":""+g[m]}(v,c)});return"getChannel(getX("+f.join(",")+"), vec2("+f.slice(-2).join(",")+"))"}this.userCode=e===1?`
        void main(){
          int rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = getChannel(getX(`+n[0]+` - rc - 1),
            `+n[0]+` - rc - 1);
          if(`+a+`){
              result.g = getChannel(getX(`+n[0]+` - (rc  + 1) - 1),
                `+n[0]+` - (rc  + 1) - 1);
          }
          setOutput(result);
        }
      `:`
        void main() {
          `+u+` rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = `+function(c){return l(c)}(r.slice())+`;
          if(`+a+`){
            result.g = `+function(c){return c[e-1]="("+c[e-1]+" + 1)",l(c)}(r.slice())+`;
          }
          if(`+i+`) {
            result.b = `+function(c){return c[e-2]="("+c[e-2]+" + 1)",l(c)}(r.slice())+`;
            if(`+a+`) {
              result.a = `+function(c){return c[e-1]="("+c[e-1]+" + 1)",c[e-2]="("+c[e-2]+" + 1)",l(c)}(r.slice())+`;
            }
          }
          setOutput(result);
        }
    `},Uw=function(n,t,e,r,a,i,u){this.variableNames=["updates","indices","defaultValue"],this.outputShape=i;var l=wt(a.length),c=wt(i.length),f="";e===1?f="i":e===2&&(f="i, j");var d="getIndices("+f+")",v="";r===1?v="i":r===2&&(v="i, coords[1]");var m="getUpdates("+v+")",g=t>1?"strides[j]":"strides";this.userCode=`
        `+l+" strides = "+l+"("+a+`);

        void main() {
          `+c+` coords = getOutputCoords();
          float sum = 0.0;
          bool found = false;
          for (int i = 0; i < `+n+`; i++) {
            int flattenedIndex = 0;
            for (int j = 0; j < `+t+`; j++) {
              int index = round(`+d+`);
              flattenedIndex += index * `+g+`;
            }
            if (flattenedIndex == coords[0]) {
              sum += `+m+`;
              found = true;
            }
          }
          setOutput(mix(getDefaultValue(), sum, float(found)));
        }
      `},dM=function(n,t){this.variableNames=["x","segmentIds"];var e=n.windowSize,r=n.batchSize,a=n.inSize,i=n.numSegments,u=i*Math.ceil(a/e);this.outputShape=[r,u];var l=4*Math.floor(e/4),c=e%4,f=`
        sumValue += dot(values, segFilter);
    `,d="";a%e>0&&(d=`
        if (inIdx < 0 || inIdx >= `+a+`) {
          return initializationValue;
        }
      `);var v="";a%e>0&&(v=`
        if (inIdx < 0 || inIdx >= `+a+`) {
          return -1.0;
        }
      `),this.userCode=`
      const float initializationValue = 0.0;

      float getValue(int batch, int inIdx) {
        `+d+`
        return getX(batch, inIdx);
      }

      float getSegmentIdAtIndex(int inIdx) {
        `+v+`
        return getSegmentIds(inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = int(floor(float(outIdx) / float(
          `+i+")) * float("+e+`));
        int currentSeg = int(mod(float(outIdx), float(`+i+`)));

        float sumValue = 0.0;

        for (int i = 0; i < `+l+`; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0
          );

          `+f+`
        }

        int inIdx = inOffset + `+l+`;
        if (`+(c===1)+`) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            0,
            0,
            0
          );

          `+f+`
        } else if (`+(c===2)+`) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
              0,
              0
          );

          `+f+`
        } else if (`+(c===3)+`) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            0
          );

          `+f+`
        }
        setOutput(sumValue);
      }
    `},pM=function(n,t,e){var r,a;if(this.variableNames=["c","a","b"],this.outputShape=t,e>4)throw Error("Where for rank "+e+" is not yet supported");if(e===1)a="resRC",r="resRC";else{for(var i=["resRC.x","resRC.y","resRC.z","resRC.w"],u=[],l=[],c=0;c<t.length;c++)l.push(""+i[c]),c<n&&u.push(""+i[c]);r=u.join(),a=l.join()}var f=wt(e);this.userCode=`
      void main() {
        `+f+` resRC = getOutputCoords();
        float cVal = getC(`+r+`);
        if (cVal >= 1.0) {
          setOutput(getA(`+a+`));
        } else {
          setOutput(getB(`+a+`));
        }
      }
    `},vM=function(){function n(t){this.variableNames=["source"],this.outputShape=t,this.rank=t.length;var e,r=wt(this.rank),a="uniform int start["+this.rank+"];",i=function(u){if(u===1)return"sourceLoc";if(u<=6)return Rv.slice(0,u).map(function(l){return"sourceLoc."+l}).join(",");throw Error("Slicing for rank "+u+" is not yet supported")}(this.rank);e=`
        `+r+` sourceLoc;
        `+r+` coords = getOutputCoords();
        `+t.map(function(u,l){return"sourceLoc."+Rv[l]+" = start["+l+"] + coords."+Rv[l]+";"}).join(`
`)+`
      `,this.userCode=`
      `+a+`
      void main() {
        `+e+`
        setOutput(getSource(`+i+`));
      }
    `}return n.prototype.getCustomSetupFunc=function(t){var e=this;if(t.length!==this.rank)throw Error("The rank ("+this.rank+") of the program must match the length of start ("+t.length+")");return function(r,a){e.startLoc==null&&(e.startLoc=r.getUniformLocationNoThrow(a,"start"),e.startLoc==null)||r.gl.uniform1iv(e.startLoc,t)}},n}(),Rv=["x","y","z","w","u","v"],mM=function(){function n(t){this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.rank=t.length;var e=wt(this.rank),r=Ln("coords",this.rank),a=Ln("sourceLoc",this.rank),i=this.rank===1?"sourceLoc":"vec2("+a.slice(-2).join()+")",u="getChannel(getSource("+a.join()+"), "+i+")",l=`
      result.x = `+u+`;
      if (++`+r[this.rank-1]+" < "+t[this.rank-1]+`) {
        ++`+a[this.rank-1]+`;
        result.y = `+u+`;
        --`+a[this.rank-1]+`;
      }
    `,c=this.rank===1?"":`
      --`+r[this.rank-1]+`;
      if (++`+r[this.rank-2]+" < "+t[this.rank-2]+`) {
        ++`+a[this.rank-2]+`;
        result.z = `+u+`;
        if (++`+r[this.rank-1]+" < "+t[this.rank-1]+`) {
          ++`+a[this.rank-1]+`;
          result.w = `+u+`;
        }
      }
    `,f=this.rank<=4?`sourceLoc = coords +
            `+e+"("+t.map(function(d,v){return"start["+v+"]"}).join()+");":t.map(function(d,v){return a[v]+" = "+r[v]+" + start["+v+"];"}).join(`
`);this.userCode=`
      uniform int start[`+this.rank+`];
      void main() {
        `+e+` coords = getOutputCoords();
        `+e+` sourceLoc;
        `+f+`
        vec4 result = vec4(0.);
        `+l+`
        `+c+`
        setOutput(result);
      }
    `}return n.prototype.getCustomSetupFunc=function(t){var e=this;if(t.length!==this.rank)throw Error("The rank ("+this.rank+") of the program must match the length of start ("+t.length+")");return function(r,a){e.startLoc==null&&(e.startLoc=r.getUniformLocationNoThrow(a,"start"),e.startLoc==null)||r.gl.uniform1iv(e.startLoc,t)}},n}(),gM=function(n,t,e){this.variableNames=["x"],this.outputShape=e;var r=e.length,a=wt(e.length),i=wt(e.length),u="";if(r===1)u="coords * strides + begin";else{var l=0;u=e.map(function(c,f){return l++,e.length===1?"coords * strides["+f+"] + begin["+f+"]":"coords["+(l-1)+"] * strides["+f+"] + begin["+f+"]"}).join(",")}this.userCode=`
      `+a+" begin = "+a+"("+n+`);
      `+a+" strides = "+a+"("+t+`);

      void main() {
        `+i+` coords = getOutputCoords();
        setOutput(getX(`+u+`));
      }
    `},yM=function(){function n(t){this.gpgpu=t,this.numUsedTextures=0,this.numFreeTextures=0,this.freeTextures={},this.logEnabled=!1,this.usedTextures={}}return n.prototype.acquireTexture=function(t,e,r){var a,i=Vw(e,r),u=Hw(t,i,r);if(u in this.freeTextures||(this.freeTextures[u]=[]),u in this.usedTextures||(this.usedTextures[u]=[]),this.freeTextures[u].length>0){this.numFreeTextures--,this.numUsedTextures++,this.log();var l=this.freeTextures[u].shift();return this.usedTextures[u].push(l),l}return this.numUsedTextures++,this.log(),i===Qn.PACKED_2X2_FLOAT32?a=this.gpgpu.createPackedMatrixTexture(t[0],t[1]):i===Qn.PACKED_2X2_FLOAT16?a=this.gpgpu.createFloat16PackedMatrixTexture(t[0],t[1]):i===Qn.UNPACKED_FLOAT32?a=this.gpgpu.createFloat32MatrixTexture(t[0],t[1]):i===Qn.UNPACKED_FLOAT16?a=this.gpgpu.createFloat16MatrixTexture(t[0],t[1]):i===Qn.PACKED_4X1_UNSIGNED_BYTE&&(a=this.gpgpu.createUnsignedBytesMatrixTexture(t[0],t[1])),this.usedTextures[u].push(a),a},n.prototype.releaseTexture=function(t,e,r,a){if(this.freeTextures!=null){var i=Hw(e,Vw(r,a),a);i in this.freeTextures||(this.freeTextures[i]=[]),this.freeTextures[i].push(t),this.numFreeTextures++,this.numUsedTextures--;var u=this.usedTextures[i],l=u.indexOf(t);if(l<0)throw new Error("Cannot release a texture that was never provided by this texture manager");u.splice(l,1),this.log()}},n.prototype.log=function(){if(this.logEnabled){var t=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used",this.numFreeTextures+" / "+this.numUsedTextures,"("+t+")")}},n.prototype.getNumUsedTextures=function(){return this.numUsedTextures},n.prototype.getNumFreeTextures=function(){return this.numFreeTextures},n.prototype.dispose=function(){var t=this;if(this.freeTextures!=null){for(var e in this.freeTextures)this.freeTextures[e].forEach(function(r){t.gpgpu.deleteMatrixTexture(r)});for(var e in this.usedTextures)this.usedTextures[e].forEach(function(a){t.gpgpu.deleteMatrixTexture(a)});this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0}},n}();function Vw(n,t){if(n===Zn.UPLOAD)return Qn.PACKED_2X2_FLOAT32;if(n===Zn.RENDER||n==null)return function(e){return ue().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?e?Qn.PACKED_2X2_FLOAT32:Qn.UNPACKED_FLOAT32:e?Qn.PACKED_2X2_FLOAT16:Qn.UNPACKED_FLOAT16}(t);if(n===Zn.DOWNLOAD||n===Zn.PIXELS)return Qn.PACKED_4X1_UNSIGNED_BYTE;throw new Error("Unknown logical texture type "+n)}function Hw(n,t,e){return n[0]+"_"+n[1]+"_"+t+"_"+e}var bM=function(n,t){this.variableNames=["A"];for(var e=new Array(n.length),r=0;r<e.length;r++)e[r]=n[r]*t[r];this.outputShape=e,this.rank=e.length;var a=wt(this.rank),i=function(u){var l=u.length;if(l>5)throw Error("Tile for rank "+l+" is not yet supported");if(l===1)return"imod(resRC, "+u[0]+")";for(var c=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],f=[],d=0;d<u.length;d++)f.push("imod("+c[d]+", "+u[d]+")");return f.join()}(n);this.userCode=`
      void main() {
        `+a+` resRC = getOutputCoords();
        setOutput(getA(`+i+`));
      }
    `},xM=function(n,t){this.variableNames=["A"];for(var e=new Array(n.length),r=0;r<e.length;r++)e[r]=n[t[r]];this.outputShape=e,this.rank=e.length;var a=wt(this.rank),i=function(u){var l=u.length;if(l>6)throw Error("Transpose for rank "+l+" is not yet supported");for(var c=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],f=new Array(l),d=0;d<u.length;d++)f[u[d]]=c[d];return f.join()}(t);this.userCode=`
    void main() {
      `+a+` resRC = getOutputCoords();
      setOutput(getA(`+i+`));
    }
    `},wM=function(n,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;for(var e=new Array(n.length),r=0;r<e.length;r++)e[r]=n[t[r]];if(this.outputShape=e,this.rank=e.length,this.rank>6)throw Error("Packed transpose for rank "+this.rank+" is not yet supported.");var a=wt(this.rank),i=yS("rc",this.rank),u=new Array(this.rank);for(r=0;r<t.length;r++)u[t[r]]=i[r];var l="vec2("+u.slice(-2).join()+")",c="++"+i[this.rank-1]+" < "+e[this.rank-1],f="getChannel(getA("+u.join()+"), "+l+")";this.userCode=`
    void main() {
      `+a+` rc = getOutputCoords();
      vec4 result = vec4(0.);
      result[0] = `+f+`;
      if(`+c+`) {
        result[1] = `+f+`;
      }
      --`+i[this.rank-1]+`;
      if(++`+i[this.rank-2]+" < "+e[this.rank-2]+`) {
        result[2] = `+f+`;
        if(`+c+`) {
          result[3] = `+f+`;
        }
      }
      setOutput(result);
    }
    `},cg=1.7580993408473768,fg=1.0507009873554805,Ge=function(n,t){this.variableNames=["A"],this.outputShape=n,this.userCode=`
      float unaryOperation(float x) {
        `+t+`
      }

      void main() {
        float x = getAAtOutCoords();
        float y = unaryOperation(x);

        setOutput(y);
      }
    `},Ir="if (isnan(x)) return x;",_M="return x;",jw="return abs(x);",SS=Ir+`
  return (x < 0.0) ? 0.0 : x;
`,ES=Ir+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,CS="return (x >= 0.0) ? x : (exp(x) - 1.0);",SM=`
  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.
  // see: https://arxiv.org/abs/1706.02515
  float scaleAlpha = `+cg+`;
  float scale = `+fg+`;
  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);
`,Ww="return -x;",Gw="return ceil(x);",qw="return floor(x);",Kw="return exp(x);",Xw="return exp(x) - 1.0;",EM=Ir+`
  return sin(x);
`,CM=Ir+`
  return cos(x);
`,RM=Ir+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return asin(x);
`,AM=Ir+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return acos(x);
`,TM=Ir+`
  return atan(x);
`,DM=Ir+"return log(x + sqrt(x * x + 1.0));",kM=Ir+`
  if (x < 1.0) return NAN;
  return log(x + sqrt(x * x - 1.0));`,OM=Ir+`
  if ((x < -1.0) || (x > 1.0)) return NAN;
  return (log(1.0 + x) - log(1.0 - x)) / 2.0;`,nf="return x;",NM="return x;",RS=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,AS=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,TS=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,Ku=function(n,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n,this.userCode=`
      vec4 unaryOperation(vec4 x) {
        `+t+`
      }

      void main() {
        vec4 x = getAAtOutCoords();
        vec4 y = unaryOperation(x);

        setOutput(y);
      }
    `},MM=function(n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=n;var t=n.length,e=Ln("rc",t),r=wt(t),a=function(l,c){if(l===1)return"rc";for(var f="",d=0;d<l;d++)f+=c[d],d<l-1&&(f+=",");return f}(t,e),i=e.slice(-2),u=t<=1?"rc":"vec2("+i.join(",")+")";this.userCode=`
      void main() {
        `+r+` rc = getOutputCoords();
        vec4 packedInput = getA(`+a+`);

        setOutput(getChannel(packedInput, `+u+`));
      }
    `},rf={};function af(n,t){if(t===void 0&&(t=!1),n==="linear")return t?NM:_M;if(n==="relu")return t?RS:SS;if(n==="elu")return t?TS:CS;if(n==="relu6")return t?AS:ES;if(n==="prelu")return t?_S:wS;throw new Error("Activation "+n+" has not been implemented for the WebGL backend.")}var IM=600,FM=function(n){function t(e){var r,a=n.call(this)||this;if(a.pendingRead=new WeakMap,a.pendingDisposal=new WeakSet,a.dataRefCount=new WeakMap,a.numBytesInGPU=0,a.uploadWaitMs=0,a.downloadWaitMs=0,a.warnedAboutMemory=!1,a.pendingDeletes=0,a.disposed=!1,!ue().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");if(e==null){var i=ra(ue().getNumber("WEBGL_VERSION"));a.binaryCache=((r=ue().getNumber("WEBGL_VERSION"))in rf||(rf[r]={}),rf[r]),a.gpgpu=new q4(i),a.canvas=i.canvas,a.gpgpuCreatedLocally=!0}else a.gpgpu=e,a.binaryCache={},a.gpgpuCreatedLocally=!1,a.canvas=e.gl.canvas;return a.textureManager=new yM(a.gpgpu),a.numMBBeforeWarning=ue().global.screen==null?1024:ue().global.screen.height*ue().global.screen.width*window.devicePixelRatio*IM/1024/1024,a.texData=new lS(a,q),a}return Mr(t,n),t.prototype.numDataIds=function(){return this.texData.numDataIds()+(this.cpuBackend?this.cpuBackend.numDataIds():0)-this.pendingDeletes},t.prototype.write=function(e,r,a){if(ue().getBool("DEBUG")&&this.checkNumericalProblems(e),a==="complex64"&&e!=null)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");var i={};return this.texData.set(i,{shape:r,dtype:a,values:e,usage:Zn.UPLOAD}),i},t.prototype.move=function(e,r,a,i){if(ue().getBool("DEBUG")&&this.checkNumericalProblems(r),i==="complex64")throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(e,{shape:a,dtype:i,values:r,usage:Zn.UPLOAD})},t.prototype.readSync=function(e){var r=this.texData.get(e),a=r.values,i=r.dtype,u=r.complexTensors,l=r.slice,c=r.shape,f=r.isPacked;if(l!=null){var d=void 0;d=f?new Ku(c,nf):new Ge(c,nf);var v=this.runWebGLProgram(d,[{dataId:e,shape:c,dtype:i}],i),m=this.readSync(v.dataId);return this.disposeData(v.dataId),m}if(a!=null)return this.convertAndCacheOnCPU(e);if(i==="string")return a;var g,b,w=this.activeTimers!=null;return w&&(g=Gr()),i==="complex64"?b=Em(u.real.dataSync(),u.imag.dataSync()):b=this.getValuesFromTexture(e),w&&(this.downloadWaitMs+=Gr()-g),this.convertAndCacheOnCPU(e,b)},t.prototype.read=function(e){return _e(this,void 0,void 0,function(){var r,a,i,u,l,c,f,d,v,m,g,b,w,S,_,E,R,C,A,D,k,I;return Se(this,function(N){switch(N.label){case 0:if(this.pendingRead.has(e))return r=this.pendingRead.get(e),[2,new Promise(function(B){return r.push(B)})];if(a=this.texData.get(e),i=a.values,u=a.shape,l=a.slice,c=a.dtype,f=a.complexTensors,d=a.isPacked,l!=null)return v=void 0,v=d?new Ku(u,nf):new Ge(u,nf),m=this.runWebGLProgram(v,[{dataId:e,shape:u,dtype:c}],c),g=this.read(m.dataId),this.disposeData(m.dataId),[2,g];if(i!=null)return[2,this.convertAndCacheOnCPU(e)];if(!ue().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&ue().getNumber("WEBGL_VERSION")===2)throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");return b=null,c!=="complex64"&&ue().get("WEBGL_BUFFER_SUPPORTED")&&(w=this.decode(e),S=this.texData.get(w.dataId),b=(I=this.gpgpu).createBufferFromTexture.apply(I,[S.texture].concat(Ju(u)))),this.pendingRead.set(e,[]),c==="complex64"?[3,2]:[4,this.gpgpu.createAndWaitForFence()];case 1:N.sent(),N.label=2;case 2:return c!=="complex64"?[3,4]:[4,Promise.all([f.real.data(),f.imag.data()])];case 3:return E=N.sent(),R=E[0],C=E[1],_=Em(R,C),[3,5];case 4:b==null?_=this.getValuesFromTexture(e):(A=Ce(u),_=this.gpgpu.downloadFloat32MatrixFromBuffer(b,A)),N.label=5;case 5:return w!=null&&this.disposeData(w.dataId),D=this.convertAndCacheOnCPU(e,_),k=this.pendingRead.get(e),this.pendingRead.delete(e),k.forEach(function(B){return B(D)}),this.pendingDisposal.has(e)&&(this.pendingDisposal.delete(e),this.disposeData(e),this.pendingDeletes--),[2,D]}})})},t.prototype.checkNumericalProblems=function(e){if(e!=null)for(var r=0;r<e.length;r++){var a=e[r];if(!SN(a))throw ue().getBool("WEBGL_RENDER_FLOAT32_CAPABLE")?Error("The value "+a+" cannot be represented with your current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'"):Error("The value "+a+" cannot be represented on this device.")}},t.prototype.getValuesFromTexture=function(e){var r,a=this.texData.get(e),i=a.shape,u=a.dtype,l=a.isPacked,c=Ce(i);if(ue().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){var f=this.decode(e),d=this.texData.get(f.dataId),v=(r=this.gpgpu).downloadMatrixFromPackedTexture.apply(r,[d.texture].concat(Ju(i))).subarray(0,c);return this.disposeData(f.dataId),v}var m=ue().getBool("WEBGL_PACK")&&l===!0,g=m?bv(i):i,b=m?new _4(g):new w4(g),w=this.runWebGLProgram(b,[{shape:g,dtype:u,dataId:e}],"float32"),S=this.texData.get(w.dataId),_=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(S.texture,S.texShape[0],S.texShape[1]).subarray(0,c);return this.disposeData(w.dataId),_},t.prototype.time=function(e){return _e(this,void 0,void 0,function(){var r,a,i,u,l,c,f;return Se(this,function(d){switch(d.label){case 0:return r=this.activeTimers,a=[],i=!1,this.programTimersStack==null?(this.programTimersStack=a,i=!0):this.activeTimers.push(a),this.activeTimers=a,e(),u=Ms(this.activeTimers.map(function(v){return v.query})).filter(function(v){return v!=null}),l=Ms(this.activeTimers.map(function(v){return v.name})).filter(function(v){return v!=null}),this.activeTimers=r,i&&(this.programTimersStack=null),c={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null},ue().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?[4,Promise.all(u)]:[3,2];case 1:return f=d.sent(),c.kernelMs=rN(f),c.getExtraProfileInfo=function(){return f.map(function(v,m){return{name:l[m],ms:v}}).map(function(v){return v.name+": "+v.ms}).join(", ")},[3,3];case 2:c.kernelMs={error:"WebGL query timers are not supported in this environment."},d.label=3;case 3:return this.uploadWaitMs=0,this.downloadWaitMs=0,[2,c]}})})},t.prototype.memory=function(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU}},t.prototype.startTimer=function(){return ue().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:Gr(),endMs:null}},t.prototype.endTimer=function(e){return ue().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),e):(e.endMs=Gr(),e)},t.prototype.getQueryTime=function(e){return _e(this,void 0,void 0,function(){var r;return Se(this,function(a){return ue().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?[2,this.gpgpu.waitForQueryAndGetTime(e)]:[2,(r=e).endMs-r.startMs]})})},t.prototype.disposeData=function(e){if(!this.pendingDisposal.has(e)){if(this.pendingRead.has(e))return this.pendingDisposal.add(e),void this.pendingDeletes++;if(this.texData.has(e)){this.releaseGPUData(e);var r=this.texData.get(e).complexTensors;r!=null&&(r.real.dispose(),r.imag.dispose()),this.texData.delete(e)}}},t.prototype.releaseGPUData=function(e){var r=this.texData.get(e),a=r.texture,i=r.dtype,u=r.texShape,l=r.usage,c=r.isPacked,f=r.slice,d=f&&f.origDataId||e,v=this.dataRefCount.get(d);v>1?this.dataRefCount.set(d,v-1):(this.dataRefCount.delete(d),a!=null&&(this.numBytesInGPU-=this.computeBytes(u,i),this.textureManager.releaseTexture(a,u,l,c)));var m=this.texData.get(e);m.texture=null,m.texShape=null,m.isPacked=!1,m.slice=null},t.prototype.getTexture=function(e){return this.uploadToGPU(e),this.texData.get(e).texture},t.prototype.getDataInfo=function(e){return this.texData.get(e)},t.prototype.getCPUBackend=function(){return ue().getBool("WEBGL_CPU_FORWARD")?(this.cpuBackend==null&&(this.cpuBackend=q.findBackend("cpu")),this.cpuBackend):null},t.prototype.shouldExecuteOnCPU=function(e,r){var a=this;return r===void 0&&(r=128),this.getCPUBackend()!=null&&e.every(function(i){return a.texData.get(i.dataId).texture==null&&i.size<r})},t.prototype.getGPGPUContext=function(){return this.gpgpu},t.prototype.complex=function(e,r){var a=this.makeOutput(e.shape,"complex64");return this.texData.get(a.dataId).complexTensors={real:q.keep(e.clone()),imag:q.keep(r.clone())},a},t.prototype.real=function(e){return this.texData.get(e.dataId).complexTensors.real.clone()},t.prototype.imag=function(e){return this.texData.get(e.dataId).complexTensors.imag.clone()},t.prototype.slice=function(e,r,a){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.slice(e,r,a);if(Ce(a)===0)return mn([],a,e.dtype);var i=this.texData.get(e.dataId).isPacked,u=sS(e.shape,r,a);if(i||!u){var l=ue().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new mM(a):new vM(a),c=l.getCustomSetupFunc(r);return this.compileAndRun(l,[e],null,c)}return this.uploadToGPU(e.dataId),this.shallowSlice(e,r,a)},t.prototype.shallowSlice=function(e,r,a){var i=this.texData.get(e.dataId),u=this.makeOutput(a,e.dtype),l=this.texData.get(u.dataId);Object.assign(l,i),l.shape=a,l.dtype=e.dtype;var c=uS(r,e.strides);i.slice&&(c+=i.slice.flatOffset),l.slice={flatOffset:c,origDataId:i.slice&&i.slice.origDataId||e.dataId};var f=this.dataRefCount.get(l.slice.origDataId)||1;return this.dataRefCount.set(l.slice.origDataId,f+1),u},t.prototype.stridedSlice=function(e,r,a,i){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.stridedSlice(e,r,a,i);var u=ag(r,a,i);if(u.some(function(c){return c===0}))return mn([],u);var l=new gM(r,i,u);return this.compileAndRun(l,[e])},t.prototype.reverse=function(e,r){var a=ue().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new hM(e.shape,r):new fM(e.shape,r);return this.compileAndRun(a,[e])},t.prototype.concat=function(e,r){if(e[0].dtype==="complex64"){var a=e.map(function(g){return mr(g)}),i=e.map(function(g){return Kr(g)});return pn(this.concat(a,r),this.concat(i,r))}if(this.shouldExecuteOnCPU(e))return this.cpuBackend.concat(e,r);if(e.length===1)return e[0];if(e.length>ue().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER")){var u=Math.floor(e.length/2),l=this.concat(e.slice(0,u),r),c=this.concat(e.slice(u),r);return this.concat([l,c],r)}if(ue().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&e[0].rank>1){var f=new s4(e.map(function(g){return g.shape}),r);return this.compileAndRun(f,e)}var d=Fs(e.map(function(g){return g.shape}),r),v=e.map(function(g){return g.as2D(-1,Ce(g.shape.slice(r)))}),m=new o4(v.map(function(g){return g.shape}));return this.compileAndRun(m,v).reshape(d)},t.prototype.neg=function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.neg(e);if(ue().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,Ww,e.dtype);var r=new Ge(e.shape,Ww);return this.compileAndRun(r,[e])},t.prototype.batchMatMul=function(e,r,a,i){var u=a?e.shape[2]:e.shape[1],l=i?r.shape[1]:r.shape[2],c=a?e.shape[1]:e.shape[2],f=e.shape[0];if((u===1||l===1)&&c>1e3){a&&(e=e.transpose([0,2,1])),i&&(r=r.transpose([0,2,1]));var d=l===1?e:e.as3D(f,c,1),v=l===1?2:1,m=l===1?r.as3D(f,1,c):r;return this.multiply(d,m).sum(v,!0)}var g=vn(e.dtype,r.dtype),b=new Sv(e.shape,[f,u,l],a,i);return this.compileAndRun(b,[e,r],g)},t.prototype.fusedBatchMatMul=function(e){var r=e.a,a=e.b,i=e.transposeA,u=e.transposeB,l=e.bias,c=e.activation,f=e.preluActivationWeights,d=i?r.shape[2]:r.shape[1],v=u?a.shape[1]:a.shape[2],m=r.shape[0],g=vn(r.dtype,a.dtype),b=l!=null,w=f!=null,S=c?af(c,!0):null,_=new Sv(r.shape,[m,d,v],i,u,b,S,w),E=[r,a];return l&&E.push(l),f&&E.push(f),this.compileAndRun(_,E,g)},t.prototype.multiply=function(e,r){if(e.dtype==="complex64"){var a=this.texData.get(e.dataId),i=this.texData.get(r.dataId),u=new Nw(t4,e.shape,r.shape),l=new Nw(n4,e.shape,r.shape),c=[this.makeComplexComponentTensorInfo(e,a.complexTensors.real),this.makeComplexComponentTensorInfo(e,a.complexTensors.imag),this.makeComplexComponentTensorInfo(r,i.complexTensors.real),this.makeComplexComponentTensorInfo(r,i.complexTensors.imag)],f=this.compileAndRun(u,c),d=this.compileAndRun(l,c),v=this.complex(f,d);return f.dispose(),d.dispose(),v}if(this.shouldExecuteOnCPU([e,r]))return this.cpuBackend.multiply(e,r);if(ue().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,r,Mw,e.dtype);var m=new Nt(Mw,e.shape,r.shape);return this.compileAndRun(m,[e,r],e.dtype)},t.prototype.batchNormalization=function(e,r,a,i,u,l){var c=[e,r,a],f=null;l!=null&&(f=l.shape,c.push(l));var d=null;if(u!=null&&(d=u.shape,c.push(u)),ue().getBool("WEBGL_PACK_NORMALIZATION")){var v=new e4(e.shape,r.shape,a.shape,f,d,i);return this.compileAndRun(v,c)}var m=new J3(e.shape,r.shape,a.shape,f,d,i);return this.compileAndRun(m,c)},t.prototype.localResponseNormalization4D=function(e,r,a,i,u){var l=ue().getBool("WEBGL_PACK_NORMALIZATION")?new Y4(e.shape,r,a,i,u):new X4(e.shape,r,a,i,u);return this.compileAndRun(l,[e])},t.prototype.LRNGrad=function(e,r,a,i,u,l,c){var f=new $4(r.shape,i,u,l,c);return this.compileAndRun(f,[r,a,e])},t.prototype.tile=function(e,r){if(e.dtype==="string"){var a=this.readSync(e.dataId).map(function(u){return zf(u)});return mS(Ue(e.shape,e.dtype,a),r)}var i=new bM(e.shape,r);return this.compileAndRun(i,[e])},t.prototype.pad=function(e,r,a){var i=ue().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new rM(e.shape,r,a):new nM(e.shape,r,a);return this.compileAndRun(i,[e])},t.prototype.transpose=function(e,r){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.transpose(e,r);var a=ue().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new wM(e.shape,r):new xM(e.shape,r);return this.compileAndRun(a,[e])},t.prototype.gather=function(e,r,a){if(this.shouldExecuteOnCPU([e,r]))return this.cpuBackend.gather(e,r,a);var i=new T4(e.shape,r.size,a);return this.compileAndRun(i,[e,r])},t.prototype.batchToSpaceND=function(e,r,a){L(e.rank<=4,function(){return"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet"});var i=r.reduce(function(v,m){return v*m}),u=Gf(e.shape,r,i),l=qf(u.length,r.length),c=Kf(e.shape,r,i),f=rS(a,r.length),d=aS(c,a,r.length);return e.reshape(u).transpose(l).reshape(c).slice(f,d)},t.prototype.spaceToBatchND=function(e,r,a){L(e.rank<=4,function(){return"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet"});var i=r.reduce(function(m,g){return m*g}),u=[[0,0]];u.push.apply(u,a);for(var l=1+r.length;l<e.shape.length;++l)u.push([0,0]);var c=e.pad(u),f=Gf(c.shape,r,i,!1),d=qf(f.length,r.length,!1),v=Kf(c.shape,r,i,!1);return c.reshape(f).transpose(d).reshape(v)},t.prototype.reduce=function(e,r,a){var i=e.shape[0],u=e.shape[1],l=xv(u),c=new aM({windowSize:l,inSize:u,batchSize:i},r),f=this.compileAndRun(c,[e],a);return f.shape[1]===1?f:this.reduce(f,r,a)},t.prototype.argReduce=function(e,r,a){a===void 0&&(a=null);var i=e.shape[0],u=e.shape[1];a!=null&&(i=a.shape[0],u=a.shape[1]);var l=xv(u),c=new W3({windowSize:l,inSize:u,batchSize:i},r,a==null),f=[e];a!=null&&f.push(a);var d=this.compileAndRun(c,f,"int32");return d.shape[1]===1?d:this.argReduce(e,r,d)},t.prototype.argReducePacked=function(e,r,a){a===void 0&&(a=null);var i=a!=null?a.shape:e.shape,u=xv(i[i.length-1]),l=new Y3(i,u,r,a==null),c=a==null?[e]:[e,a],f=this.compileAndRun(l,c,"int32");return f.rank===e.rank?this.argReducePacked(e,r,f):f},t.prototype.sum=function(e,r){Yn("sum",r,e.rank);var a=wn(e.shape,r),i=a[0],u=Ce(a[1]),l=e.as2D(-1,u),c=hv(e.dtype);return this.reduce(l,"sum",c).reshape(i)},t.prototype.prod=function(e,r){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.prod(e,r);var a=wn(e.shape,r),i=a[0],u=Ce(a[1]),l=e.as2D(-1,u),c=hv(e.dtype);return this.reduce(l,"prod",c).reshape(i)},t.prototype.unsortedSegmentSum=function(e,r,a){var i=0,u=aa([i],e.rank),l=e;u!=null&&(l=e.transpose(u),i=ia(1,e.rank)[0]);var c=function(g,b,w){for(var S=[],_=g.length,E=0;E<_;E++)E!==b?S.push(g[E]):S.push(w);return S}(l.shape,i,a),f=Ce([l.shape[i]]),d=l.as2D(-1,f),v=hv(e.dtype),m=this.segOpCompute(d,"unsortedSegmentSum",r,v,a).reshape(c);return u!=null&&(m=m.transpose(eg(u))),m},t.prototype.segOpCompute=function(e,r,a,i,u){var l=e.shape[0],c=e.shape[1],f=function(m,g){var b,w=!1;for(m<=oS?(b=m,w=!0):b=vm(m,Math.floor(Math.sqrt(m)));!w;)b>g||b===m?w=!0:b=vm(m,b+1);return b}(c,u),d=new dM({windowSize:f,inSize:c,batchSize:l,numSegments:u}),v=this.compileAndRun(d,[e,a],i);return v.shape[1]===u?v:(a=Wf(0,u).tile([c/f]),this.segOpCompute(v,r,a,i,u))},t.prototype.argMinMaxReduce=function(e,r,a){var i=[r];if(Yn("arg"+a.charAt(0).toUpperCase()+a.slice(1),i,e.rank),!ue().getBool("WEBGL_PACK_REDUCE")||e.rank<=2){var u=wn(e.shape,i),l=u[0],c=Ce(u[1]),f=e.as2D(-1,c);return this.argReduce(f,a).reshape(l)}return this.argReducePacked(e,a)},t.prototype.argMin=function(e,r){return this.argMinMaxReduce(e,r,"min")},t.prototype.argMax=function(e,r){return this.argMinMaxReduce(e,r,"max")},t.prototype.cumsum=function(e,r,a,i){if(r!==e.rank-1)throw new Error("WebGL cumsum shader expects an inner-most axis="+(e.rank-1)+" but got axis="+r);var u=new m4(e.shape,a,i);return this.compileAndRun(u,[e])},t.prototype.equal=function(e,r){if(ue().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,r,`
  return vec4(equal(a, b));
`,"bool");var a=new Nt("return float(a == b);",e.shape,r.shape);return this.compileAndRun(a,[e,r],"bool")},t.prototype.notEqual=function(e,r){if(ue().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,r,`
  return vec4(notEqual(a, b));
`,"bool");var a=new Nt("return float(a != b);",e.shape,r.shape);return this.compileAndRun(a,[e,r],"bool")},t.prototype.less=function(e,r){if(this.shouldExecuteOnCPU([e,r]))return this.cpuBackend.less(e,r);if(ue().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,r,`
  return vec4(lessThan(a, b));
`,"bool");var a=new Nt("return float(a < b);",e.shape,r.shape);return this.compileAndRun(a,[e,r],"bool")},t.prototype.lessEqual=function(e,r){if(ue().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,r,`
  return vec4(lessThanEqual(a, b));
`,"bool");var a=new Nt("return float(a <= b);",e.shape,r.shape);return this.compileAndRun(a,[e,r],"bool")},t.prototype.greater=function(e,r){if(this.shouldExecuteOnCPU([e,r]))return this.cpuBackend.greater(e,r);if(ue().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,r,`
  return vec4(greaterThan(a, b));
`,"bool");var a=new Nt("return float(a > b);",e.shape,r.shape);return this.compileAndRun(a,[e,r],"bool")},t.prototype.greaterEqual=function(e,r){if(ue().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,r,`
  return vec4(greaterThanEqual(a, b));
`,"bool");var a=new Nt("return float(a >= b);",e.shape,r.shape);return this.compileAndRun(a,[e,r],"bool")},t.prototype.logicalNot=function(e){var r=new Ge(e.shape,"return float(!(x >= 1.0));");return this.compileAndRun(r,[e])},t.prototype.logicalAnd=function(e,r){if(ue().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,r,`
  return vec4(
    vec4(greaterThanEqual(a, vec4(1.0))) *
    vec4(greaterThanEqual(b, vec4(1.0))));
`,"bool");var a=new Nt("return float(a >= 1.0 && b >= 1.0);",e.shape,r.shape);return this.compileAndRun(a,[e,r],"bool")},t.prototype.logicalOr=function(e,r){if(ue().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,r,`
  return min(
    vec4(greaterThanEqual(a, vec4(1.0))) +
    vec4(greaterThanEqual(b, vec4(1.0))),
    vec4(1.0));
`,"bool");var a=new Nt("return float(a >= 1.0 || b >= 1.0);",e.shape,r.shape);return this.compileAndRun(a,[e,r],"bool")},t.prototype.select=function(e,r,a){var i=new pM(e.rank,r.shape,r.rank);return this.compileAndRun(i,[e,r,a],vn(r.dtype,a.dtype))},t.prototype.where=function(e){Hf("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");var r=e.dataSync();return ug(e.shape,r)},t.prototype.topk=function(e,r,a){return gS(e.dataSync(),e.shape,e.dtype,r)},t.prototype.min=function(e,r){Yn("min",r,e.rank);var a=wn(e.shape,r),i=a[0],u=Ce(a[1]),l=e.as2D(-1,u);return this.reduce(l,"min",l.dtype).reshape(i)},t.prototype.minimum=function(e,r){if(this.shouldExecuteOnCPU([e,r]))return this.cpuBackend.minimum(e,r);var a=ue().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Ea(`
  vec4 result = vec4(min(a, b));
  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,e.shape,r.shape):new Nt(`
  if (isnan(a)) return a;
  if (isnan(b)) return b;

  return min(a, b);
`,e.shape,r.shape);return this.compileAndRun(a,[e,r])},t.prototype.mod=function(e,r){var a=ue().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Ea(`
  vec4 result = mod(a, b);
  vec4 isNaN = vec4(equal(b, vec4(0.0)));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,e.shape,r.shape):new Nt(`if (b == 0.0) return NAN;
  return mod(a, b);`,e.shape,r.shape);return this.compileAndRun(a,[e,r])},t.prototype.max=function(e,r){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.max(e,r);Yn("max",r,e.rank);var a=wn(e.shape,r),i=a[0],u=Ce(a[1]),l=e.as2D(-1,u);return this.reduce(l,"max",l.dtype).reshape(i)},t.prototype.maximum=function(e,r){if(this.shouldExecuteOnCPU([e,r]))return this.cpuBackend.maximum(e,r);var a=ue().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Ea(`
  vec4 result = vec4(max(a, b));
  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,e.shape,r.shape):new Nt(`
  if (isnan(a)) return a;
  if (isnan(b)) return b;

  return max(a, b);
`,e.shape,r.shape);return this.compileAndRun(a,[e,r])},t.prototype.all=function(e,r){Yn("all",r,e.rank);var a=wn(e.shape,r),i=a[0],u=Ce(a[1]),l=e.as2D(-1,u);return this.reduce(l,"all",l.dtype).reshape(i)},t.prototype.any=function(e,r){Yn("any",r,e.rank);var a=wn(e.shape,r),i=a[0],u=Ce(a[1]),l=e.as2D(-1,u);return this.reduce(l,"any",l.dtype).reshape(i)},t.prototype.realDivide=function(e,r){if(ue().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,r,`
  // vec4 one = vec4(equal(a, b));
  // return one + (vec4(1.0) - one) * a / b;
  vec4 result = a / b;
  if(a.x == b.x) {
    result.x = 1.;
  }
  if(a.y == b.y) {
    result.y = 1.;
  }
  if(a.z == b.z) {
    result.z = 1.;
  }
  if(a.w == b.w) {
    result.w = 1.;
  }

  return result;
`,"float32",!0);var a=new Nt(`
if (a == b) {
  return 1.0;
};
return a / b;`,e.shape,r.shape);return this.compileAndRun(a,[e,r],"float32")},t.prototype.floorDiv=function(e,r){if(ue().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,r,`
  ivec4 ia = round(a);
  ivec4 ib = round(b);
  bvec4 cond = notEqual(ib, ivec4(0));
  ivec4 result = ivec4(0);
  vec4 s = sign(a) * sign(b);

  // Windows (D3D) wants guaranteed non-zero int division at compile-time.
  if (cond[0]) {
    result[0] = idiv(ia[0], ib[0], s[0]);
  }
  if (cond[1]) {
    result[1] = idiv(ia[1], ib[1], s[1]);
  }
  if (cond[2]) {
    result[2] = idiv(ia[2], ib[2], s[2]);
  }
  if (cond[3]) {
    result[3] = idiv(ia[3], ib[3], s[3]);
  }
  return vec4(result);
`,"int32");var a=new Nt(`
  float s = sign(a) * sign(b);
  int ia = round(a);
  int ib = round(b);
  if (ib != 0) {
    // Windows (D3D) wants guaranteed non-zero int division at compile-time.
    return float(idiv(ia, ib, s));
  } else {
    return NAN;
  }
`,e.shape,r.shape);return this.compileAndRun(a,[e,r],"int32")},t.prototype.add=function(e,r){if(e.dtype==="complex64"&&r.dtype==="complex64")return this.complexSeparableBinaryOp(e,r,wv);if(this.shouldExecuteOnCPU([e,r]))return this.cpuBackend.add(e,r);var a=vn(e.dtype,r.dtype);if(ue().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,r,wv,a);var i=new Nt(wv,e.shape,r.shape);return this.compileAndRun(i,[e,r],a)},t.prototype.packedUnaryOp=function(e,r,a){var i=new Ku(e.shape,r);return this.compileAndRun(i,[e],a)},t.prototype.packedBinaryOp=function(e,r,a,i,u){u===void 0&&(u=!1);var l=new Ea(a,e.shape,r.shape,u);return this.compileAndRun(l,[e,r],i)},t.prototype.complexSeparableBinaryOp=function(e,r,a){var i=this,u=this.texData.get(e.dataId),l=this.texData.get(r.dataId),c=[[u.complexTensors.real,l.complexTensors.real],[u.complexTensors.imag,l.complexTensors.imag]].map(function(m){var g=m[0],b=m[1],w=i.makeComplexComponentTensorInfo(e,g),S=i.makeComplexComponentTensorInfo(r,b),_=new Nt(a,e.shape,r.shape);return i.compileAndRun(_,[w,S],vn(g.dtype,b.dtype))}),f=c[0],d=c[1],v=this.complex(f,d);return f.dispose(),d.dispose(),v},t.prototype.makeComplexComponentTensorInfo=function(e,r){return{dataId:r.dataId,dtype:r.dtype,shape:e.shape}},t.prototype.addN=function(e){if(e.length===1)return e[0];if(e.length>ue().get("WEBGL_MAX_TEXTURES_IN_SHADER")){var r=Math.floor(e.length/2),a=this.addN(e.slice(0,r)),i=this.addN(e.slice(r));return this.addN([a,i])}var u=e.map(function(f){return f.dtype}).reduce(function(f,d){return vn(f,d)}),l=e.map(function(f){return f.shape}),c=ue().getBool("WEBGL_PACK")?new j3(e[0].shape,l):new H3(e[0].shape,l);return this.compileAndRun(c,e,u)},t.prototype.subtract=function(e,r){if(e.dtype==="complex64"&&r.dtype==="complex64")return this.complexSeparableBinaryOp(e,r,_v);if(this.shouldExecuteOnCPU([e,r]))return this.cpuBackend.subtract(e,r);var a=vn(e.dtype,r.dtype);if(ue().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,r,_v,e.dtype);var i=new Nt(_v,e.shape,r.shape);return this.compileAndRun(i,[e,r],a)},t.prototype.pow=function(e,r){var a=ue().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Ea(`
  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.
  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));
  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);
  vec4 result = multiplier * pow(abs(a), b);

  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS
  bvec4 isExpZero = equal(b, vec4(0.0));
  result.r = isExpZero.r ? 1.0 : result.r;
  result.g = isExpZero.g ? 1.0 : result.g;
  result.b = isExpZero.b ? 1.0 : result.b;
  result.a = isExpZero.a ? 1.0 : result.a;

  vec4 isNaN = vec4(lessThan(a, vec4(0.0))) * vec4(lessThan(floor(b), b));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,e.shape,r.shape):new Nt(`
if(a < 0.0 && floor(b) < b){
  return NAN;
}
if (b == 0.0) {
  return 1.0;
}
return (round(mod(b, 2.0)) != 1) ?
    pow(abs(a), b) : sign(a) * pow(abs(a), b);
`,e.shape,r.shape),i=vn(e.dtype,r.dtype);return this.compileAndRun(a,[e,r],i)},t.prototype.ceil=function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.ceil(e);if(ue().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,Gw,e.dtype);var r=new Ge(e.shape,Gw);return this.compileAndRun(r,[e])},t.prototype.floor=function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.floor(e);if(ue().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,qw,e.dtype);var r=new Ge(e.shape,qw);return this.compileAndRun(r,[e])},t.prototype.sign=function(e){var r=new Ge(e.shape,`
  if (isnan(x)) { return 0.0; }
  return sign(x);
`);return this.compileAndRun(r,[e])},t.prototype.isNaN=function(e){var r=new Ge(e.shape,"return float(isnan(x));");return this.compileAndRun(r,[e],"bool")},t.prototype.isInf=function(e){var r=new Ge(e.shape,"return float(isinf(x));");return this.compileAndRun(r,[e],"bool")},t.prototype.isFinite=function(e){var r=new Ge(e.shape,"return float(!isnan(x) && !isinf(x));");return this.compileAndRun(r,[e],"bool")},t.prototype.round=function(e){var r=new Ge(e.shape,`
  // OpenGL ES does not support round function.
  // The algorithm is based on banker's rounding.
  float base = floor(x);
  if ((x - base) < 0.5) {
    return floor(x);
  } else if ((x - base) > 0.5) {
    return ceil(x);
  } else {
    if (mod(base, 2.0) == 0.0) {
      return base;
    } else {
      return base + 1.0;
    }
  }
`);return this.compileAndRun(r,[e])},t.prototype.exp=function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.exp(e);if(ue().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,Kw,e.dtype);var r=new Ge(e.shape,Kw);return this.compileAndRun(r,[e])},t.prototype.expm1=function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.expm1(e);if(ue().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,Xw,e.dtype);var r=new Ge(e.shape,Xw);return this.compileAndRun(r,[e])},t.prototype.softmax=function(e,r){var a=Jt([r],e.shape),i=this.max(e,a),u=Un(i.shape,a),l=this.subtract(e,i.reshape(u)),c=this.exp(l),f=this.sum(c,a).reshape(u);return this.realDivide(c,f)},t.prototype.log=function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.log(e);if(ue().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,`
  vec4 result = log(x);
  vec4 isNaN = vec4(lessThan(x, vec4(0.0)));
  result.r = isNaN.r == 1.0 ? NAN : result.r;
  result.g = isNaN.g == 1.0 ? NAN : result.g;
  result.b = isNaN.b == 1.0 ? NAN : result.b;
  result.a = isNaN.a == 1.0 ? NAN : result.a;

  return result;
`,e.dtype);var r=new Ge(e.shape,`if (x < 0.0) return NAN;
  return log(x);`);return this.compileAndRun(r,[e])},t.prototype.log1p=function(e){var r=new Ge(e.shape,"return log(1.0 + x);");return this.compileAndRun(r,[e])},t.prototype.sqrt=function(e){var r=new Ge(e.shape,"return sqrt(x);");return this.compileAndRun(r,[e])},t.prototype.rsqrt=function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.rsqrt(e);var r=new Ge(e.shape,"return inversesqrt(x);");return this.compileAndRun(r,[e])},t.prototype.reciprocal=function(e){var r=new Ge(e.shape,"return 1.0 / x;");return this.compileAndRun(r,[e])},t.prototype.relu=function(e){var r;return r=ue().getBool("WEBGL_PACK")?new Ku(e.shape,RS):new Ge(e.shape,SS),this.compileAndRun(r,[e])},t.prototype.relu6=function(e){var r;return r=ue().getBool("WEBGL_PACK")?new Ku(e.shape,AS):new Ge(e.shape,ES),this.compileAndRun(r,[e])},t.prototype.prelu=function(e,r){var a=ue().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Ea(_S,e.shape,r.shape):new Nt(wS,e.shape,r.shape);return this.compileAndRun(a,[e,r])},t.prototype.elu=function(e){if(ue().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,TS,e.dtype);var r=new Ge(e.shape,CS);return this.compileAndRun(r,[e])},t.prototype.eluDer=function(e,r){var a=ue().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Ea(`
  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));
  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));
`,e.shape,r.shape):new Nt("return (b >= 1.0) ? a : a * (b + 1.0);",e.shape,r.shape);return this.compileAndRun(a,[e,r])},t.prototype.selu=function(e){var r=new Ge(e.shape,SM);return this.compileAndRun(r,[e])},t.prototype.int=function(e){var r=new Ge(e.shape,"return float(int(x));");return this.compileAndRun(r,[e],"int32")},t.prototype.clip=function(e,r,a){var i,u=(i=ue().getBool("WEBGL_PACK_CLIP")?new a4(e.shape):new r4(e.shape)).getCustomSetupFunc(r,a);return this.compileAndRun(i,[e],null,u)},t.prototype.abs=function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.abs(e);if(ue().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,jw,e.dtype);var r=new Ge(e.shape,jw);return this.compileAndRun(r,[e])},t.prototype.complexAbs=function(e){var r=this.texData.get(e.dataId),a=new i4(e.shape),i=[this.makeComplexComponentTensorInfo(e,r.complexTensors.real),this.makeComplexComponentTensorInfo(e,r.complexTensors.imag)];return this.compileAndRun(a,i)},t.prototype.sigmoid=function(e){var r=new Ge(e.shape,"return 1.0 / (1.0 + exp(-1.0 * x));");return this.compileAndRun(r,[e])},t.prototype.softplus=function(e){var r=new Ge(e.shape,`
  float epsilon = 1.1920928955078125e-7;
  float threshold = log(epsilon) + 2.0;

  bool too_large = x > -threshold;
  bool too_small = x < threshold;

  float result;
  float exp_x = exp(x);

  if (too_large){
    result = x;
  }
  else if (too_small){
    result = exp_x;
  }
  else{
    result = log(exp_x + 1.0);
  }
  return result;
`);return this.compileAndRun(r,[e])},t.prototype.sin=function(e){var r=new Ge(e.shape,EM);return this.compileAndRun(r,[e])},t.prototype.cos=function(e){var r=new Ge(e.shape,CM);return this.compileAndRun(r,[e])},t.prototype.tan=function(e){var r=new Ge(e.shape,"return tan(x);");return this.compileAndRun(r,[e])},t.prototype.asin=function(e){var r=new Ge(e.shape,RM);return this.compileAndRun(r,[e])},t.prototype.acos=function(e){var r=new Ge(e.shape,AM);return this.compileAndRun(r,[e])},t.prototype.atan=function(e){var r=new Ge(e.shape,TM);return this.compileAndRun(r,[e])},t.prototype.atan2=function(e,r){var a=ue().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Ea(`
  vec4 result = atan(a, b);
  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,e.shape,r.shape):new Nt(`
  if (isnan(a)) return a;
  if (isnan(b)) return b;

  return atan(a, b);
`,e.shape,r.shape);return this.compileAndRun(a,[e,r])},t.prototype.sinh=function(e){var r=new Ge(e.shape,`
  float e2x = exp(x);
  return (e2x - 1.0 / e2x) / 2.0;
`);return this.compileAndRun(r,[e])},t.prototype.cosh=function(e){var r=new Ge(e.shape,`
  float e2x = exp(-x);
  return (e2x + 1.0 / e2x) / 2.0;
`);return this.compileAndRun(r,[e])},t.prototype.tanh=function(e){var r=new Ge(e.shape,`
  float e2x = exp(-2.0 * abs(x));
  return sign(x) * (1.0 - e2x) / (1.0 + e2x);
`);return this.compileAndRun(r,[e])},t.prototype.asinh=function(e){var r=new Ge(e.shape,DM);return this.compileAndRun(r,[e])},t.prototype.acosh=function(e){var r=new Ge(e.shape,kM);return this.compileAndRun(r,[e])},t.prototype.atanh=function(e){var r=new Ge(e.shape,OM);return this.compileAndRun(r,[e])},t.prototype.erf=function(e){var r=new Ge(e.shape,`
  // Error function is calculated approximately with elementary function.
  // See "Handbook of Mathematical Functions with Formulas,
  // Graphs, and Mathematical Tables", Abramowitz and Stegun.
  float p = 0.3275911;
  float a1 = 0.254829592;
  float a2 = -0.284496736;
  float a3 = 1.421413741;
  float a4 = -1.453152027;
  float a5 = 1.061405429;

  float sign = sign(x);
  x = abs(x);
  float t = 1.0 / (1.0 + p * x);
  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));
`);return this.compileAndRun(r,[e])},t.prototype.step=function(e,r){var a=new Ge(e.shape,function(i){return i===void 0&&(i=0),Ir+`
    return x > 0.0 ? 1.0 : float(`+i+`);
  `}(r));return this.compileAndRun(a,[e])},t.prototype.conv2dByMatMul=function(e,r,a,i,u,l){var c=e.shape,f=this.texData.get(e.dataId),d=a.inChannels,v=c[0]*c[1]*c[2],m=a.outChannels,g=a.dataFormat==="channelsLast",b=(v===1||m===1)&&d>1e3,w=c[2]%2!=0&&!!f.isPacked;if(b||!ue().getBool("WEBGL_LAZILY_UNPACK")||!ue().getBool("WEBGL_PACK_BINARY_OPERATIONS")||!w){var S=g?c[0]*c[1]*c[2]:c[0]*c[2]*c[3],_=this.reshape(e,[1,S,a.inChannels]),E=this.reshape(r,[1,a.inChannels,a.outChannels]);return this.reshape(this.fusedBatchMatMul({a:_,b:E,transposeA:!1,transposeB:!1,bias:i,activation:u,preluActivationWeights:l}),a.outShape)}var R=g?c[0]*c[1]*(c[2]+1):c[0]*c[2]*(c[3]+1),C={dataId:e.dataId,shape:[1,R,a.inChannels],dtype:e.dtype},A=f.shape;f.shape=f.shape.slice(),f.shape[f.shape.length-2]++,L(ef(f.shape,C.shape),function(){return"packed reshape "+f.shape+" to "+C.shape+" isn't free"});var D=this.reshape(r,[1,a.inChannels,a.outChannels]),k=this.fusedBatchMatMul({a:C,b:D,transposeA:!1,transposeB:!1,bias:i,activation:u,preluActivationWeights:l}),I=this.texData.get(k.dataId);return L(I.isPacked,function(){return"batchMatMul result is expected to be packed"}),f.shape=A,I.shape=a.outShape,q.makeTensorFromDataId(k.dataId,a.outShape,k.dtype)},t.prototype.conv2dWithIm2Row=function(e,r,a,i,u,l){var c=a.filterWidth,f=a.filterHeight,d=a.inChannels,v=a.outWidth,m=a.outHeight,g=a.dataFormat==="channelsLast",b=c*f*d,w=m*v,S=[b,w],_=e.squeeze([0]),E=r.reshape([1,b,-1]),R=new K4(S,_.shape,a),C=this.compileAndRun(R,[_]).reshape([1,S[0],S[1]]),A=i!=null,D=l!=null,k=u?af(u,!0):null,I=new Sv(C.shape,[1,w,a.outChannels],!0,!1,A,k,D),N=[C,E];i&&N.push(i),D&&N.push(l);var B=this.compileAndRun(I,N);return g?B.reshape([1,m,v,a.outChannels]):B.reshape([1,a.outChannels,m,v])},t.prototype.fusedConv2d=function(e){var r=e.input,a=e.filter,i=e.convInfo,u=e.bias,l=e.activation,c=e.preluActivationWeights;if(i.filterHeight===1&&i.filterWidth===1&&i.dilationHeight===1&&i.dilationWidth===1&&i.strideHeight===1&&i.strideWidth===1&&(i.padInfo.type==="SAME"||i.padInfo.type==="VALID"))return this.conv2dByMatMul(r,a,i,u,l,c);if(ue().getBool("WEBGL_CONV_IM2COL")&&r.shape[0]===1)return this.conv2dWithIm2Row(r,a,i,u,l,c);var f=u!=null,d=c!=null,v=l?af(l,!1):null,m=new Iw(i,f,v,d),g=[r,a];return u&&g.push(u),c&&g.push(c),this.compileAndRun(m,g)},t.prototype.conv2d=function(e,r,a){if(a.filterHeight===1&&a.filterWidth===1&&a.dilationHeight===1&&a.dilationWidth===1&&a.strideHeight===1&&a.strideWidth===1&&(a.padInfo.type==="SAME"||a.padInfo.type==="VALID"))return this.conv2dByMatMul(e,r,a);if(ue().getBool("WEBGL_CONV_IM2COL")&&e.shape[0]===1)return this.conv2dWithIm2Row(e,r,a);var i=new Iw(a);return this.compileAndRun(i,[e,r])},t.prototype.conv2dDerInput=function(e,r,a){var i=new l4(a);return this.compileAndRun(i,[e,r])},t.prototype.conv2dDerFilter=function(e,r,a){var i=new u4(a);return this.compileAndRun(i,[e,r])},t.prototype.fusedDepthwiseConv2D=function(e){var r,a=e.input,i=e.filter,u=e.convInfo,l=e.bias,c=e.activation,f=e.preluActivationWeights,d=ue().getBool("WEBGL_PACK_DEPTHWISECONV")&&u.strideWidth<=2&&u.outChannels/u.inChannels==1,v=c?af(c,d):null,m=[a,i],g=l!=null,b=f!=null;return g&&m.push(l),b&&m.push(f),d?(r=new Bw(u,g,v,b),this.compileAndRun(r,m)):(r=new Fw(u,g,v,b),this.compileAndRun(r,m))},t.prototype.depthwiseConv2D=function(e,r,a){var i;return ue().getBool("WEBGL_PACK_DEPTHWISECONV")&&a.strideWidth<=2&&a.outChannels/a.inChannels==1?(i=new Bw(a),this.compileAndRun(i,[e,r])):(i=new Fw(a),this.compileAndRun(i,[e,r]))},t.prototype.depthwiseConv2DDerInput=function(e,r,a){var i=new d4(a);return this.compileAndRun(i,[e,r])},t.prototype.depthwiseConv2DDerFilter=function(e,r,a){var i=new h4(a);return this.compileAndRun(i,[e,r])},t.prototype.conv3d=function(e,r,a){var i=new p4(a);return this.compileAndRun(i,[e,r])},t.prototype.conv3dDerInput=function(e,r,a){var i=new f4(a);return this.compileAndRun(i,[e,r])},t.prototype.conv3dDerFilter=function(e,r,a){var i=new c4(a);return this.compileAndRun(i,[e,r])},t.prototype.maxPool=function(e,r){var a=new Ev(r,"max",!1);return this.compileAndRun(a,[e])},t.prototype.avgPool=function(e,r){var a=new Ev(r,"avg",!1);return this.compileAndRun(a,[e],"float32")},t.prototype.maxPoolBackprop=function(e,r,a,i){var u=new Ev(i,"max",!0),l=this.compileAndRun(u,[r]),c=new Q4(i),f=this.compileAndRun(c,[e,l],r.dtype);return l.dispose(),f},t.prototype.avgPoolBackprop=function(e,r,a){var i=new Q3(a);return this.compileAndRun(i,[e],r.dtype)},t.prototype.cast=function(e,r){return hS(e,r,this)},t.prototype.unstack=function(e,r){for(var a=e.shape[r],i=new Array(e.rank-1),u=0,l=0;l<e.rank;l++)l!==r&&(i[u++]=e.shape[l]);var c=new Array(e.rank).fill(0),f=e.shape.slice();f[r]=1;var d=new Array(a);for(l=0;l<d.length;l++)c[r]=l,d[l]=this.slice(e,c,f).reshape(i);return d},t.prototype.avgPool3d=function(e,r){var a=new Cv(r,"avg",!1);return this.compileAndRun(a,[e],"float32")},t.prototype.avgPool3dBackprop=function(e,r,a){var i=new Z3(a);return this.compileAndRun(i,[e],r.dtype)},t.prototype.maxPool3d=function(e,r){var a=new Cv(r,"max",!1);return this.compileAndRun(a,[e],"float32")},t.prototype.maxPool3dBackprop=function(e,r,a,i){var u=new Cv(i,"max",!0),l=this.compileAndRun(u,[r]),c=new Z4(i),f=this.compileAndRun(c,[e,l],r.dtype);return l.dispose(),f},t.prototype.reshape=function(e,r){var a=this.texData.get(e.dataId);if(a.isPacked&&!ef(e.shape,r)&&(a.texture===null||!ef(a.shape,r))){var i=this.packedReshape(e,r);return q.makeTensorFromDataId(i.dataId,i.shape,i.dtype)}return Sm(e,r)},t.prototype.resizeBilinear=function(e,r,a,i){var u=ue().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new uM(e.shape,r,a,i):new sM(e.shape,r,a,i);return this.compileAndRun(u,[e],"float32")},t.prototype.resizeBilinearBackprop=function(e,r,a){var i=new oM(e,r,a);return this.compileAndRun(i,[e])},t.prototype.resizeNearestNeighbor=function(e,r,a,i){var u=new cM(e.shape,r,a,i);return this.compileAndRun(u,[e])},t.prototype.resizeNearestNeighborBackprop=function(e,r,a){var i=new lM(e,r,a);return this.compileAndRun(i,[e])},t.prototype.multinomial=function(e,r,a,i){var u=r?e:Ma(e),l=u.shape[0],c=u.shape[1],f=new J4(l,c,a),d=f.getCustomSetupFunc(i);return this.compileAndRun(f,[u],"int32",d)},t.prototype.oneHot=function(e,r,a,i){var u=new eM(e.size,r,a,i);return this.compileAndRun(u,[e])},t.prototype.diag=function(e){var r=new x4(e.size);return this.compileAndRun(r,[e])},t.prototype.nonMaxSuppression=function(e,r,a,i,u){return Hf("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead"),og(e.dataSync(),r.dataSync(),a,i,u)},t.prototype.cropAndResize=function(e,r,a,i,u,l){var c=new v4(e.shape,r.shape,i,u,l);return this.compileAndRun(c,[e,r,a],"float32")},t.prototype.depthToSpace=function(e,r,a){L(r>1,function(){return"blockSize should be > 1 for depthToSpace, but was: "+r});var i=e.shape[0],u=a==="NHWC"?e.shape[1]:e.shape[2],l=a==="NHWC"?e.shape[2]:e.shape[3],c=a==="NHWC"?e.shape[3]:e.shape[1],f=u*r,d=l*r,v=c/(r*r),m=new b4(a==="NHWC"?[i,f,d,v]:[i,v,f,d],r,a);return this.compileAndRun(m,[e])},t.prototype.split=function(e,r,a){return vS(e,r,a)},t.prototype.scatterND=function(e,r,a){var i=Xf(0,e,a),u=i.sliceRank,l=i.numUpdates,c=i.sliceSize,f=i.strides,d=i.outputSize,v=[d/c,c],m=e.reshape([l,u]),g=r.reshape([l,c]);if(d===0)return Sm(mn([]),a);var b=ge(0),w=new Uw(l,u,m.rank,g.rank,f,v);return this.compileAndRun(w,[g,m,b]).reshape(a)},t.prototype.sparseToDense=function(e,r,a,i){var u=Xf(0,e,a),l=u.sliceRank,c=u.numUpdates,f=u.strides,d=u.outputSize,v=new Uw(c,l,e.rank,r.rank,f,[d,1]);return this.compileAndRun(v,[r,e,i]).reshape(a)},t.prototype.fft=function(e){return this.fftImpl(e,!1)},t.prototype.ifft=function(e){return this.fftImpl(e,!0)},t.prototype.fftImpl=function(e,r){var a=this.texData.get(e.dataId),i=new Pw(C4,e.shape,r),u=new Pw(R4,e.shape,r),l=[this.makeComplexComponentTensorInfo(e,a.complexTensors.real),this.makeComplexComponentTensorInfo(e,a.complexTensors.imag)],c=this.compileAndRun(i,l),f=this.compileAndRun(u,l),d=this.complex(c,f).as2D(e.shape[0],e.shape[1]);return c.dispose(),f.dispose(),d},t.prototype.gatherND=function(e,r){var a=r.shape,i=a[a.length-1],u=iS(e,r),l=u[0],c=u[1],f=u[2],d=u[3],v=r.reshape([c,i]),m=e.reshape([e.size/f,f]),g=new D4(i,d,[c,f]);return this.compileAndRun(g,[m,v]).reshape(l)},t.prototype.fill=function(e,r,a){if((a=a||Sl(r))==="string"){var i=Pf(a,Ce(e));return i.fill(r),q.makeTensor(i,e,a,this)}var u=new A4(e,r),l=u.getCustomSetupFunc(r);return this.compileAndRun(u,[],a,l)},t.prototype.onesLike=function(e){if(e.dtype==="string")throw new Error("onesLike is not supported under string dtype");return this.fill(e.shape,1,e.dtype)},t.prototype.zerosLike=function(e){return this.fill(e.shape,e.dtype==="string"?"":0,e.dtype)},t.prototype.linspace=function(e,r,a){return dS(e,r,a)},t.prototype.makeTensorInfo=function(e,r){var a=this.write(null,e,r);return this.texData.get(a).usage=null,{dataId:a,shape:e,dtype:r}},t.prototype.makeOutput=function(e,r){var a=this.makeTensorInfo(e,r).dataId;return q.makeTensorFromDataId(a,e,r,this)},t.prototype.unpackTensor=function(e){var r=new MM(e.shape);return this.runWebGLProgram(r,[e],e.dtype)},t.prototype.packTensor=function(e){var r=new tM(e.shape);return this.runWebGLProgram(r,[e],e.dtype,null,!0)},t.prototype.packedReshape=function(e,r){var a=[Uf(e.shape)].concat(Vf(e.shape)),i={dtype:e.dtype,shape:a,dataId:e.dataId},u=[Uf(r)].concat(Vf(r)),l=new iM(u,a),c=this.runWebGLProgram(l,[i],e.dtype,null,!0);return{dataId:c.dataId,shape:r,dtype:c.dtype}},t.prototype.decode=function(e){var r,a=this.texData.get(e),i=a.isPacked,u=a.shape,l=a.dtype,c=bv(u);return r=i?new y4(c):new g4(c),{dtype:l,shape:u,dataId:this.runWebGLProgram(r,[{shape:c,dtype:l,dataId:e}],l,null,!0).dataId}},t.prototype.runWebGLProgram=function(e,r,a,i,u){var l=this;u===void 0&&(u=!1);var c=this.makeTensorInfo(e.outputShape,a),f=this.texData.get(c.dataId);if(e.packedOutput&&(f.isPacked=!0),e.outPackingScheme===hl.DENSE){var d=Ju(e.outputShape);f.texShape=d.map(function(R){return 2*R})}if(e.outTexUsage!=null&&(f.usage=e.outTexUsage),Ce(c.shape)===0)return f.values=cl(c.dtype,0),c;var v=[],m=r.map(function(R){if(R.dtype==="complex64")throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");var C=l.texData.get(R.dataId);if(C.texture==null){if(!e.packedInputs&&Ce(R.shape)<=ue().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:R.shape,texData:null,isUniform:!0,uniformValues:C.values};e.packedInputs&&(C.isPacked=!0,C.shape=R.shape)}else if(!!C.isPacked!=!!e.packedInputs)R=C.isPacked?l.unpackTensor(R):l.packTensor(R),v.push(R),C=l.texData.get(R.dataId);else if(C.isPacked&&!ef(C.shape,R.shape)){var A=R,D=R.shape;R.shape=C.shape,R=l.packedReshape(R,D),v.push(R),C=l.texData.get(R.dataId),A.shape=D}return l.uploadToGPU(R.dataId),{shape:R.shape,texData:C,isUniform:!1}});this.uploadToGPU(c.dataId);var g,b={shape:c.shape,texData:f,isUniform:!1},w=function(R,C,A){var D="";C.concat(A).forEach(function(N){var B=N.texData!=null&&N.texData.slice!=null&&N.texData.slice.flatOffset>0,V=N.isUniform?"uniform":N.texData.texShape;D+=N.shape+"_"+V+"_"+B});var k=R.userCode,I=R.constructor.name;return I+="_"+D+"_"+k}(e,m,b),S=this.getAndSaveBinary(w,function(){return function(R,C,A,D){var k=C.userCode,I=A.map(function(K,ne){var M={logicalShape:K.shape,texShape:K.isUniform?null:K.texData.texShape,isUniform:K.isUniform,isPacked:!K.isUniform&&K.texData.isPacked,flatOffset:null};return K.texData!=null&&K.texData.slice!=null&&K.texData.slice.flatOffset>0&&(M.flatOffset=K.texData.slice.flatOffset),{name:C.variableNames[ne],shapeInfo:M}}),N=I.map(function(K){return K.shapeInfo}),B={logicalShape:D.shape,texShape:D.texData.texShape,isUniform:!1,isPacked:D.texData.isPacked,flatOffset:null},V=G3(I,B,k,C.packedInputs),U=R.createProgram(V),J=null,ee=R.getUniformLocation(U,"NAN",!1);ue().getNumber("WEBGL_VERSION")===1&&(J=R.getUniformLocation(U,"INFINITY",!1));for(var te={},P=0;P<C.variableNames.length;P++){var j=C.variableNames[P];te[j]=R.getUniformLocation(U,j,!1),te["offset"+j]=R.getUniformLocation(U,"offset"+j,!1)}return{program:C,source:V,webGLProgram:U,uniformLocations:te,inShapeInfos:N,outShapeInfo:B,infLoc:J,nanLoc:ee}}(l.gpgpu,e,m,b)}),_=this.activeTimers!=null;if(_&&(g=this.startTimer()),function(R,C,A,D,k){zw(C.inShapeInfos,A),zw([C.outShapeInfo],[D]);var I=D.texData.texture,N=D.texData.texShape;D.texData.isPacked?R.setOutputPackedMatrixTexture(I,N[0],N[1]):R.setOutputMatrixTexture(I,N[0],N[1]),R.setProgram(C.webGLProgram),ue().getNumber("WEBGL_VERSION")===1&&C.infLoc!==null&&R.gl.uniform1f(C.infLoc,1/0),C.nanLoc!==null&&R.gl.uniform1f(C.nanLoc,NaN),A.forEach(function(B,V){var U=C.program.variableNames[V],J=C.uniformLocations[U],ee=C.uniformLocations["offset"+U];if(J!=null)if(B.isUniform)if(Ce(B.shape)<2)R.gl.uniform1f(J,B.uniformValues[0]);else{var te=B.uniformValues;te instanceof Float32Array||(te=new Float32Array(te)),R.gl.uniform1fv(J,te)}else B.texData.slice!=null&&ee!=null&&R.gl.uniform1i(ee,B.texData.slice.flatOffset),R.setInputMatrixTexture(B.texData.texture,J,V)}),k?.(R,C.webGLProgram),R.executeProgram()}(this.gpgpu,S,m,b,i),v.forEach(function(R){return l.disposeData(R.dataId)}),_&&(g=this.endTimer(g),this.activeTimers.push({name:e.constructor.name,query:this.getQueryTime(g)})),!ue().getBool("WEBGL_LAZILY_UNPACK")&&f.isPacked&&u===!1){var E=this.unpackTensor(c);return this.disposeData(c.dataId),E}return c},t.prototype.compileAndRun=function(e,r,a,i,u){u===void 0&&(u=!1),a=a||r[0].dtype;var l=this.runWebGLProgram(e,r,a,i,u);return q.makeTensorFromDataId(l.dataId,l.shape,l.dtype)},t.prototype.getAndSaveBinary=function(e,r){return e in this.binaryCache||(this.binaryCache[e]=r()),this.binaryCache[e]},t.prototype.getTextureManager=function(){return this.textureManager},t.prototype.dispose=function(){var e=this;this.disposed||(ue().getBool("IS_TEST")||Object.keys(this.binaryCache).forEach(function(r){e.gpgpu.deleteProgram(e.binaryCache[r].webGLProgram),delete e.binaryCache[r]}),this.textureManager.dispose(),this.canvas!=null&&typeof HTMLCanvasElement<"u"&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0)},t.prototype.floatPrecision=function(){var e=this;return this.floatPrecisionValue==null&&(this.floatPrecisionValue=xe(function(){if(!ue().get("WEBGL_RENDER_FLOAT32_ENABLED")){var r=ue().getBool("DEBUG");ue().set("DEBUG",!1);var a=e.abs(ge(1e-8)).dataSync()[0];if(ue().set("DEBUG",r),a>0)return 32}return 16})),this.floatPrecisionValue},t.prototype.epsilon=function(){return this.floatPrecision()===32?1e-7:1e-4},t.prototype.uploadToGPU=function(e){var r,a=this.texData.get(e),i=a.shape,u=a.dtype,l=a.values,c=a.texture,f=a.usage,d=a.isPacked;if(c==null){var v,m=this.activeTimers!=null;m&&(v=Gr());var g=a.texShape;if(g==null&&(g=VN(i,d),a.texShape=g),l!=null){var b=bv(i),w=void 0,S=g[1],_=g[0],E=l instanceof Uint8Array;d?(S=(r=Cl(g[0],g[1]))[0],_=r[1],w=new E4(b,[_,S],E)):w=new S4(b,[_,S],E);var R=this.makeTensorInfo([_,S],u);this.texData.get(R.dataId).usage=E?Zn.PIXELS:Zn.UPLOAD,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(R.dataId),S,_,l);var C=this.runWebGLProgram(w,[R],u,null,!0),A=this.texData.get(C.dataId);a.texture=A.texture,a.texShape=A.texShape,a.isPacked=A.isPacked,a.usage=A.usage,this.disposeData(R.dataId),this.texData.delete(C.dataId),a.values=null,m&&(this.uploadWaitMs+=Gr()-v)}else{var D=this.acquireTexture(g,f,u,d);a.texture=D}}},t.prototype.convertAndCacheOnCPU=function(e,r){var a=this.texData.get(e),i=a.dtype;return this.releaseGPUData(e),r!=null&&(a.values=function(u,l){if(l==="float32"||l==="complex64")return u;if(l==="int32"||l==="bool"){for(var c=l==="int32"?new Int32Array(u.length):new Uint8Array(u.length),f=0;f<c.length;++f)c[f]=Math.round(u[f]);return c}throw new Error("Unknown dtype "+l)}(r,i)),a.values},t.prototype.acquireTexture=function(e,r,a,i){if(this.numBytesInGPU+=this.computeBytes(e,a),!this.warnedAboutMemory&&this.numBytesInGPU>1024*this.numMBBeforeWarning*1024){var u=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn("High memory usage in GPU: "+u+" MB, most likely due to a memory leak")}return this.textureManager.acquireTexture(e,r,i)},t.prototype.computeBytes=function(e,r){return e[0]*e[1]*V_(r)},t}(cS);X_()&&q.registerBackend("webgl",function(){return new FM},2);var BM=H({square_:function(n){var t=F(n,"x","square"),e=[t];return q.runKernelFunc(function(r,a){return a([t]),r.square(t)},{x:t},null,"Square",{},e,[])}}),pl="SquaredDifference",DS=H({squaredDifference_:function(n,t){var e,r=F(n,"a","squaredDifference"),a=F(t,"b","squaredDifference");e=Dt(r,a),r=e[0],a=e[1],et(r.shape,a.shape);var i={a:r,b:a},u=[r,a];return q.runKernelFunc(function(l,c){var f=l.squaredDifference(r,a);return c([r,a]),f},i,function(l,c){var f=c[0],d=c[1],v=ge(2);return{a:function(){return l.mul(f.sub(d).mul(v))},b:function(){return l.mul(d.sub(f).mul(v))}}},pl,{},u,[])}}),LM=H({abs_:function(n){var t=F(n,"x","abs");return t.dtype==="complex64"?q.runKernelFunc(function(e){return e.complexAbs(t)},{$x:t}):q.runKernelFunc(function(e,r){var a=e.abs(t);return r([t]),a},{x:t},function(e,r){var a=r[0];return{x:function(){return e.mul(a.toFloat().step(-1))}}},"Abs")}}),PM=H({acos_:function(n){var t=F(n,"x","acos");return q.runKernelFunc(function(e,r){var a=e.acos(t);return r([t]),a},{$x:t},function(e,r){var a=r[0];return{$x:function(){return e.divStrict(ge(1).sub(a.toFloat().square()).sqrt()).neg()}}})}}),zM=H({acosh_:function(n){var t=F(n,"x","acosh");return q.runKernelFunc(function(e,r){var a=e.acosh(t);return r([t]),a},{$x:t},function(e,r){var a=r[0];return{$x:function(){return e.divStrict(a.toFloat().square().sub(1).sqrt())}}})}}),UM=H({asin_:function(n){var t=F(n,"x","asin");return q.runKernelFunc(function(e,r){var a=e.asin(t);return r([t]),a},{$x:t},function(e,r){var a=r[0];return{$x:function(){return e.divStrict(ge(1).sub(a.toFloat().square()).sqrt())}}})}}),VM=H({asinh_:function(n){var t=F(n,"x","asinh");return q.runKernelFunc(function(e,r){var a=e.asinh(t);return r([t]),a},{$x:t},function(e,r){var a=r[0];return{$x:function(){return e.divStrict(ge(1).add(a.toFloat().square()).sqrt())}}})}}),HM=H({atan_:function(n){var t=F(n,"x","atan");return q.runKernelFunc(function(e,r){var a=e.atan(t);return r([t]),a},{$x:t},function(e,r){var a=r[0];return{$x:function(){return e.div(a.toFloat().square().add(1))}}})}}),jM=H({atanh_:function(n){var t=F(n,"x","atanh");return q.runKernelFunc(function(e,r){var a=e.atanh(t);return r([t]),a},{$x:t},function(e,r){var a=r[0];return{$x:function(){return e.div(ge(1).sub(a.toFloat().square()))}}})}}),WM=H({ceil_:function(n){var t=F(n,"x","ceil");return q.runKernelFunc(function(e){return e.ceil(t)},{$x:t},function(e){return{$x:function(){return nt(e)}}})}}),hg=H({clipByValue_:function(n,t,e){var r=F(n,"x","clipByValue");L(t<=e,function(){return"Error in clip: min ("+t+") must be less than or equal to max ("+e+")."});var a=[r],i={min:t,max:e};return q.runKernelFunc(function(u,l){var c=u.clip(r,t,e);return l([r]),c},{x:r},function(u,l){var c=l[0];return{x:function(){return u.where(c.greaterEqual(t).logicalAnd(c.lessEqual(e)),nt(u))}}},"ClipByValue",i,a)}}),GM=H({cos_:function(n){var t=F(n,"x","cos"),e=[t];return q.runKernelFunc(function(r,a){var i=r.cos(t);return a([t]),i},{x:t},function(r,a){var i=a[0];return{x:function(){return i.toFloat().sin().neg().mul(r)}}},"Cos",{},e)}}),qM=H({cosh_:function(n){var t=F(n,"x","cosh");return q.runKernelFunc(function(e,r){var a=e.cosh(t);return r([t]),a},{$x:t},function(e,r){var a=r[0];return{$x:function(){return a.toFloat().sinh().mulStrict(e)}}})}}),KM=H({erf_:function(n){var t=F(n,"x","erf");return L(t.dtype==="int32"||t.dtype==="float32",function(){return"Input dtype must be `int32` or `float32`."}),t.dtype==="int32"&&(t=t.toFloat()),q.runKernelFunc(function(e,r){var a=e.erf(t);return r([t]),a},{$x:t},function(e,r){var a=r[0];return{$x:function(){return e.mul(a.square().neg().exp().mul(2/Math.sqrt(Math.PI)))}}})}}),Cm=H({exp_:function(n){var t=F(n,"x","exp");return q.runKernelFunc(function(e,r){var a=e.exp(t);return r([a]),a},{x:t},function(e,r){return{x:function(){return e.mulStrict(r[0])}}},"Exp",{},[],[!0])}}),XM=H({expm1_:function(n){var t=F(n,"x","expm1");return q.runKernelFunc(function(e,r){var a=e.expm1(t);return r([t]),a},{$x:t},function(e,r){var a=r[0];return{$x:function(){return e.mul(a.exp())}}})}}),$M=H({floor_:function(n){var t=F(n,"x","floor");return q.runKernelFunc(function(e){return e.floor(t)},{$x:t},function(e){return{$x:function(){return nt(e)}}})}}),YM=H({log_:function(n){var t=F(n,"x","log"),e=[t];return q.runKernelFunc(function(r,a){var i=r.log(t);return a([t]),i},{x:t},function(r,a){var i=a[0];return{x:function(){return r.div(i.toFloat())}}},"Log",{},e)}}),QM=H({log1p_:function(n){var t=F(n,"x","log1p");return q.runKernelFunc(function(e,r){var a=e.log1p(t);return r([t]),a},{$x:t},function(e,r){var a=r[0];return{$x:function(){return e.div(a.add(1))}}})}}),ZM=H({logSigmoid_:function(n){var t=F(n,"x","logSigmoid");return q.runKernelFunc(function(e,r){var a=e.softplus(t.neg()).neg();return r([t]),a},{$x:t},function(e,r){var a=r[0];return{$x:function(){return e.mul(a.neg().sigmoid())}}})}}),Zf=H({neg_:function(n){var t=F(n,"x","neg"),e=[t];return q.runKernelFunc(function(r){return r.neg(t)},{x:t},function(r){return{x:function(){return r.neg()}}},"Neg",{},e)}}),JM=H({reciprocal_:function(n){var t=F(n,"x","reciprocal");return q.runKernelFunc(function(e,r){var a=e.reciprocal(t);return r([t]),a},{$x:t},function(e,r){var a=r[0];return{$x:function(){return e.div(a.square().neg())}}})}}),eI=H({round_:function(n){var t=F(n,"x","round");return q.runKernelFunc(function(e){return e.round(t)},{$x:t},function(e){return{$x:function(){return nt(e)}}})}}),kS=H({rsqrt_:function(n){var t=F(n,"x","rsqrt"),e=[t];return q.runKernelFunc(function(r,a){var i=r.rsqrt(t);return a([t]),i},{x:t},function(r,a){var i=a[0];return{x:function(){return r.div(i.pow(1.5).mul(2)).neg()}}},"Rsqrt",{},e)}}),OS=H({sigmoid_:function(n){var t=F(n,"x","sigmoid");return q.runKernelFunc(function(e,r){var a=e.sigmoid(t);return r([a]),a},{x:t},function(e,r){var a=r[0];return{x:function(){return e.mul(a.mul(ge(1).sub(a)))}}},"Sigmoid")}}),tI=H({sign_:function(n){var t=F(n,"x","sign");return q.runKernelFunc(function(e){return e.sign(t)},{$x:t},function(e){return{$x:function(){return nt(e)}}})}}),nI=H({isNaN_:function(n){var t=F(n,"x","isNaN");return q.runKernelFunc(function(e){return e.isNaN(t)},{$x:t},function(e){return{$x:function(){return nt(e)}}})}}),rI=H({isInf_:function(n){var t=F(n,"x","isInf");return q.runKernelFunc(function(e){return e.isInf(t)},{$x:t},function(e){return{$x:function(){return nt(e)}}})}}),aI=H({isFinite_:function(n){var t=F(n,"x","isFinite");return q.runKernelFunc(function(e){return e.isFinite(t)},{$x:t},function(e){return{$x:function(){return nt(e)}}})}}),iI=H({sin_:function(n){var t=F(n,"x","sin"),e=[t];return q.runKernelFunc(function(r,a){var i=r.sin(t);return a([t]),i},{x:t},function(r,a){var i=a[0];return{x:function(){return i.toFloat().cos().mul(r)}}},"Sin",{},e)}}),oI=H({sinh_:function(n){var t=F(n,"x","sinh");return q.runKernelFunc(function(e,r){var a=e.sinh(t);return r([t]),a},{$x:t},function(e,r){var a=r[0];return{$x:function(){return a.toFloat().cosh().mulStrict(e)}}})}}),sI=H({softplus_:function(n){var t=F(n,"x","softplus");return q.runKernelFunc(function(e,r){var a=e.softplus(t);return r([t]),a},{$x:t},function(e,r){var a=r[0];return{$x:function(){return e.mul(a.sigmoid())}}})}}),uI=H({sqrt_:function(n){var t=F(n,"x","sqrt");return q.runKernelFunc(function(e,r){var a=e.sqrt(t);return r([t]),a},{$x:t},function(e,r){var a=r[0];return{$x:function(){return e.div(a.toFloat().sqrt().mul(2))}}})}}),lI=H({step_:function(n,t){t===void 0&&(t=0);var e=F(n,"x","step");return q.runKernelFunc(function(r){return r.step(e,t)},{$x:e},function(r){return{$x:function(){return nt(r)}}})}}),cI=H({tan_:function(n){var t=F(n,"x","tan");return q.runKernelFunc(function(e,r){var a=e.tan(t);return r([t]),a},{$x:t},function(e,r){var a=r[0];return{$x:function(){return e.div(a.cos().square())}}})}}),fI=H({tanh_:function(n){var t=F(n,"x","tanh");return q.runKernelFunc(function(e,r){var a=e.tanh(t);return r([a]),a},{x:t},function(e,r){var a=r[0];return{x:function(){return ge(1).sub(a.square()).mulStrict(e)}}},"Tanh",{},null,[!0])}});function NS(n,t,e,r,a,i){var u,l,c=F(n,"x","batchNorm"),f=F(t,"mean","batchNorm"),d=F(e,"variance","batchNorm");return a!=null&&(u=F(a,"scale","batchNorm")),r!=null&&(l=F(r,"offset","batchNorm")),L(c.rank===2,function(){return"Error in batchNorm3D: x must be rank 3 but got rank "+c.rank+"."}),L(f.rank===2||f.rank===1,function(){return"Error in batchNorm2D: mean must be rank 2 or rank 1 but got rank "+f.rank+"."}),L(d.rank===2||d.rank===1,function(){return"Error in batchNorm2D: variance must be rank 2 or rank 1 but got rank "+d.rank+"."}),u!=null&&L(u.rank===2||u.rank===1,function(){return"Error in batchNorm2D: scale must be rank 2 or rank 1 but got rank "+u.rank+"."}),l!=null&&L(l.rank===2||l.rank===1,function(){return"Error in batchNorm2D: offset must be rank 2 or rank 1 but got rank "+l.rank+"."}),Al(c,f,d,l,u,i)}function MS(n,t,e,r,a,i){var u,l,c=F(n,"x","batchNorm"),f=F(t,"mean","batchNorm"),d=F(e,"variance","batchNorm");return a!=null&&(u=F(a,"scale","batchNorm")),r!=null&&(l=F(r,"offset","batchNorm")),L(c.rank===3,function(){return"Error in batchNorm3D: x must be rank 3 but got rank "+c.rank+"."}),L(f.rank===3||f.rank===1,function(){return"Error in batchNorm3D: mean must be rank 3 or rank 1 but got rank "+f.rank+"."}),L(d.rank===3||d.rank===1,function(){return"Error in batchNorm3D: variance must be rank 3 or rank 1 but got rank "+d.rank+"."}),u!=null&&L(u.rank===3||u.rank===1,function(){return"Error in batchNorm3D: scale must be rank 3 or rank 1 but got rank "+u.rank+"."}),l!=null&&L(l.rank===3||l.rank===1,function(){return"Error in batchNorm3D: offset must be rank 3 or rank 1 but got rank "+l.rank+"."}),Al(c,f,d,l,u,i)}function IS(n,t,e,r,a,i){var u,l,c=F(n,"x","batchNorm"),f=F(t,"mean","batchNorm"),d=F(e,"variance","batchNorm");return a!=null&&(u=F(a,"scale","batchNorm")),r!=null&&(l=F(r,"offset","batchNorm")),L(c.rank===4,function(){return"Error in batchNorm4D: x must be rank 4 but got rank "+c.rank+"."}),L(f.rank===4||f.rank===1,function(){return"Error in batchNorm4D: mean must be rank 4 or rank 1 but got rank "+f.rank+"."}),L(d.rank===4||d.rank===1,function(){return"Error in batchNorm4D: variance must be rank 4 or rank 1 but got rank "+d.rank+"."}),u!=null&&L(u.rank===4||u.rank===1,function(){return"Error in batchNorm4D: scale must be rank 4 or rank 1 but got rank "+u.rank+"."}),l!=null&&L(l.rank===4||l.rank===1,function(){return"Error in batchNorm4D: offset must be rank 4 or rank 1 but got rank "+l.rank+"."}),Al(c,f,d,l,u,i)}function Al(n,t,e,r,a,i){i==null&&(i=.001);var u,l,c,f=F(n,"x","batchNorm"),d=F(t,"mean","batchNorm"),v=F(e,"variance","batchNorm");a!=null&&(u=F(a,"scale","batchNorm")),r!=null&&(l=F(r,"offset","batchNorm")),L(d.rank===v.rank,function(){return"Batch normalization gradient requires mean and variance to have equal ranks."}),L(l==null||d.rank===l.rank,function(){return"Batch normalization gradient requires mean and offset to have equal ranks."}),L(u==null||d.rank===u.rank,function(){return"Batch normalization gradient requires mean and scale to have equal ranks."}),c=f.rank===0||f.rank===1?f.as4D(1,1,1,f.size):f.rank===2?f.as4D(1,1,f.shape[0],f.shape[1]):f.rank===3?f.as4D(1,f.shape[0],f.shape[1],f.shape[2]):f;var m=[f,d,v,u];return q.runKernelFunc(function(g,b){var w=g.batchNormalization(c,of(d),of(v),i,of(u),of(l));return b([f,d,v,u]),w},{x:f,mean:d,variance:v,scale:u,offset:l},function(g,b){var w=b,S=w[0],_=w[1],E=w[2],R=w[3],C=R??ge(1),A=Qt(_.shape,c.shape),D=[];if(_.rank===1){for(var k=0;k<c.shape.length-1;++k)D.push(c.shape[k]);D.push(1)}var I=S.sub(_),N=g.mul(C),B=kS(E.add(ge(i))),V=B.mul(B).mul(B).mul(ge(-.5));return{x:function(){return _.rank===1?g.mul(gs(B.as4D(1,1,1,_.shape[0]),D)).mul(C).reshape(S.shape):g.mul(B).mul(C).reshape(S.shape)},mean:function(){var U=B.mul(ge(-1)).mul(N);return _.rank===1&&(U=U.sum(A)),U.reshape(_.shape)},variance:function(){var U=V.mul(I).mul(N);return _.rank===1&&(U=U.sum(A)),U.reshape(_.shape)},scale:function(){var U=I.mul(B),J=g.mul(U);return _.rank===1&&(J=J.sum(A)),J.reshape(_.shape)},offset:function(){var U=g;return _.rank===1&&(U=U.sum(A)),U.reshape(_.shape)}}},"BatchNormalization",{varianceEpsilon:i},m).reshape(f.shape)}function of(n){return n==null?null:n.rank===0?n.as1D():n.rank===1?n:n.rank===2?n.as4D(1,1,n.shape[0],n.shape[1]):n.rank===3?n.as4D(1,n.shape[0],n.shape[1],n.shape[2]):n}function gh(){$_("tf.batchNormalization() is going away. Use tf.batchNorm() instead, and note the positional argument change of scale, offset, and varianceEpsilon")}var hI=H({batchNormalization2d_:function(n,t,e,r,a,i){return r===void 0&&(r=.001),gh(),NS(n,t,e,i,a,r)}}),dI=H({batchNormalization3d_:function(n,t,e,r,a,i){return r===void 0&&(r=.001),gh(),MS(n,t,e,i,a,r)}}),pI=H({batchNormalization4d_:function(n,t,e,r,a,i){return r===void 0&&(r=.001),gh(),IS(n,t,e,i,a,r)}}),vI=H({batchNormalization_:function(n,t,e,r,a,i){return r===void 0&&(r=.001),gh(),Al(n,t,e,i,a,r)}}),FS=H({batchNorm_:Al}),mI=H({batchNorm2d_:NS}),gI=H({batchNorm3d_:MS}),yI=H({batchNorm4d_:IS}),yh=H({logicalAnd_:function(n,t){var e=F(n,"a","logicalAnd","bool"),r=F(t,"b","logicalAnd","bool");return et(e.shape,r.shape),q.runKernelFunc(function(a){return a.logicalAnd(e,r)},{a:e,b:r},null,"LogicalAnd")}}),bI=H({logicalNot_:function(n){var t=F(n,"x","logicalNot","bool");return q.runKernelFunc(function(e){return e.logicalNot(t)},{$x:t})}}),BS=H({logicalOr_:function(n,t){var e=F(n,"a","logicalOr","bool"),r=F(t,"b","logicalOr","bool");return et(e.shape,r.shape),q.runKernelFunc(function(a){return a.logicalOr(e,r)},{$a:e,$b:r})}}),xI=H({logicalXor_:function(n,t){var e=F(n,"a","logicalXor","bool"),r=F(t,"b","logicalXor","bool");return et(e.shape,r.shape),BS(n,t).logicalAnd(yh(n,t).logicalNot())}}),fo=H({where_:function(n,t,e){var r=F(t,"a","where"),a=F(e,"b","where"),i=F(n,"condition","where","bool");return ft(r.shape,a.shape,"Error in where: "),i.rank===1?L(i.shape[0]===r.shape[0],function(){return"The first dimension of `a` must match the size of `condition`."}):ft(i.shape,a.shape,"Error in where: "),q.runKernelFunc(function(u,l){var c=u.select(i,r,a);return l([i]),c},{$condition:i,$a:r,$b:a},function(u,l){var c=l[0];return{$condition:function(){return nt(c).toFloat()},$a:function(){return u.mul(c.cast(u.dtype))},$b:function(){return u.mul(c.logicalNot().cast(u.dtype))}}})}}),LS=function(n){return _e(this,void 0,void 0,function(){var t,e,r;return Se(this,function(a){switch(a.label){case 0:return[4,(t=F(n,"condition","whereAsync","bool")).data()];case 1:return e=a.sent(),r=ug(t.shape,e),n!==t&&t.dispose(),[2,r]}})})},Ye=H({add_:function(n,t){var e,r=F(n,"a","add"),a=F(t,"b","add");e=Dt(r,a),r=e[0],a=e[1];var i=et(r.shape,a.shape);return q.runKernelFunc(function(u){return u.add(r,a)},{a:r,b:a},function(u){return{a:function(){var l=u,c=Qt(r.shape,i);return c.length>0&&(l=l.sum(c)),l.reshape(r.shape)},b:function(){var l=u,c=Qt(a.shape,i);return c.length>0&&(l=l.sum(c)),l.reshape(a.shape)}}},"Add")}}),wI=H({addN_:function(n){L(Array.isArray(n),function(){return"The argument passed to tf.addN() must be a list of tensors"}),L(n.length>=1,function(){return"Must pass at least one tensor to tf.addN(), but got "+n.length});var t=n.map(function(a,i){return F(a,"tensors"+i,"addN")}),e=t[0];t.forEach(function(a){if(a.dtype!==e.dtype)throw new Error("All tensors passed to tf.addN() must have the same dtype")}),t.forEach(function(a){if(!un(a.shape,e.shape))throw new Error("All tensors passed to tf.addN() must have the same shape")});var r=t;return q.runKernelFunc(function(a){return a.addN(t)},r,function(a){var i={};return t.forEach(function(u,l){i[l]=function(){return a.clone()}}),i},"AddN")}}),_I=H({addStrict_:function(n,t){var e=F(n,"a","addStrict"),r=F(t,"b","addStrict");return ft(e.shape,r.shape,"Error in addStrict: "),e.add(r)}}),SI=H({atan2_:function(n,t){var e,r=F(n,"a","atan2"),a=F(t,"b","atan2");e=Dt(r,a),r=e[0],a=e[1];var i=et(r.shape,a.shape);return q.runKernelFunc(function(u,l){var c=u.atan2(r,a);return l([r,a]),c},{$a:r,$b:a},function(u,l){var c=l[0],f=l[1];return{$a:function(){var d=Ye(c.square(),f.square()),v=u.mul(f.div(d)),m=Qt(c.shape,i);return m.length>0&&(v=v.sum(m)),v.reshape(c.shape)},$b:function(){var d=Ye(c.square(),f.square()),v=Zf(u.mul(c.div(d))),m=Qt(f.shape,i);return m.length>0&&(v=v.sum(m)),v.reshape(f.shape)}}})}}),Tr=H({div_:function(n,t){var e,r=F(n,"a","div"),a=F(t,"b","div");if(e=Dt(r,a),r=e[0],a=e[1],r.dtype==="int32"&&a.dtype==="int32")return PS(r,a);var i=et(r.shape,a.shape);return q.runKernelFunc(function(u,l){var c=u.realDivide(r,a);return l([r,a]),c},{a:r,b:a},function(u,l){var c=l[0],f=l[1];return{a:function(){var d=u.div(f.toFloat()),v=Qt(c.shape,i);return v.length>0?d.sum(v).reshape(c.shape):d},b:function(){var d=u.mul(c.toFloat()),v=Qt(f.shape,i);v.length>0&&(d=d.sum(v).reshape(f.shape));var m=f.square();return d.div(m.toFloat()).neg()}}},"Div")}}),EI=H({divNoNan_:function(n,t){var e,r=F(n,"a","div"),a=F(t,"b","div");r=(e=Dt(r,a))[0],a=e[1];var i=Tr(r,a),u=nt(i),l=a.equal(u);return fo(l,u,i)}}),CI=H({divStrict_:function(n,t){var e=F(n,"a","div"),r=F(t,"b","div");return ft(e.shape,r.shape,"Error in divideStrict: "),e.div(r)}}),PS=H({floorDiv_:function(n,t){var e,r=F(n,"a","floorDiv"),a=F(t,"b","floorDiv");e=Dt(r,a),r=e[0],a=e[1];var i=et(r.shape,a.shape);return q.runKernelFunc(function(u,l){var c=u.floorDiv(r,a);return l([r,a]),c},{a:r,b:a},function(u,l){var c=l[0],f=l[1];return{a:function(){var d=u.div(f.toFloat()),v=Qt(c.shape,i);return v.length>0?d.sum(v).reshape(c.shape):d},b:function(){var d=u.mul(c.toFloat()),v=Qt(f.shape,i);v.length>0&&(d=d.sum(v).reshape(f.shape));var m=f.square();return d.div(m.toFloat()).neg()}}},"FloorDiv")}}),dg=H({maximum_:function(n,t){var e,r=F(n,"a","maximum"),a=F(t,"b","maximum");return e=Dt(r,a),r=e[0],a=e[1],r.dtype==="bool"&&(r=r.toInt(),a=a.toInt()),et(r.shape,a.shape),q.runKernelFunc(function(i,u){var l=i.maximum(r,a);return u([r,a]),l},{a:r,b:a},function(i,u){var l=u[0],c=u[1];return{a:function(){return i.mul(l.greaterEqual(c).toFloat())},b:function(){return i.mul(l.less(c).toFloat())}}},"Maximum")}}),RI=H({maximumStrict_:function(n,t){var e=F(n,"a","maximumStrict"),r=F(t,"b","maximumStrict");return ft(e.shape,r.shape,"Error in maximumStrict: "),e.maximum(r)}}),zS=H({minimum_:function(n,t){var e,r=F(n,"a","minimum"),a=F(t,"b","minimum");return e=Dt(r,a),r=e[0],a=e[1],r.dtype==="bool"&&(r=r.toInt(),a=a.toInt()),et(r.shape,a.shape),q.runKernelFunc(function(i,u){var l=i.minimum(r,a);return u([r,a]),l},{a:r,b:a},function(i,u){var l=u[0],c=u[1];return{a:function(){return i.mul(l.lessEqual(c).toFloat())},b:function(){return i.mul(l.greater(c).toFloat())}}},"Minimum")}}),AI=H({minimumStrict_:function(n,t){var e=F(n,"a","minimumStrict"),r=F(t,"b","minimumStrict");return ft(e.shape,r.shape,"Error in minimumStrict: "),e.minimum(r)}}),TI=H({mod_:function(n,t){var e,r=F(n,"a","mod"),a=F(t,"b","mod");e=Dt(r,a),r=e[0],a=e[1];var i=et(r.shape,a.shape);return q.runKernelFunc(function(u,l){var c=u.mod(r,a);return l([r,a]),c},{$a:r,$b:a},function(u,l){var c=l[0],f=l[1];return{$a:function(){var d=Qt(c.shape,i);return d.length>0?u.sum(d).reshape(c.shape):u},$b:function(){var d=u.mul(c.div(f).floor().neg()),v=Qt(f.shape,i);return v.length>0?d.sum(v).reshape(f.shape):d}}})}}),DI=H({modStrict_:function(n,t){var e=F(n,"a","modStrict"),r=F(t,"b","modStrict");return ft(e.shape,r.shape,"Error in modStrict: "),e.mod(r)}}),Cn=H({mul_:function(n,t){var e,r=F(n,"a","mul"),a=F(t,"b","mul");e=Dt(r,a),r=e[0],a=e[1];var i=et(r.shape,a.shape);return q.runKernelFunc(function(u,l){var c=u.multiply(r,a);return l([r,a]),c},{a:r,b:a},function(u,l){var c=l[0],f=l[1];return{a:function(){var d=u.mul(f.toFloat()),v=Qt(c.shape,i);return v.length>0?d.sum(v).reshape(c.shape):d},b:function(){var d=u.mul(c.toFloat()),v=Qt(f.shape,i);return v.length>0?d.sum(v).reshape(f.shape):d}}},"Mul")}}),kI=H({mulStrict_:function(n,t){var e=F(n,"a","mul"),r=F(t,"b","mul");return ft(e.shape,r.shape,"Error in multiplyStrict: "),e.mul(r)}}),Jf=H({pow_:function(n,t){var e,r=F(n,"base","pow"),a=F(t,"exp","pow");e=Dt(r,a),r=e[0],a=e[1];var i=et(r.shape,a.shape),u=[r,a];return q.runKernelFunc(function(l,c){var f=l.pow(r,a);return c([r,a,f]),f},{a:r,b:a},function(l,c){var f=c[0],d=c[1],v=c[2];return{a:function(){var m=d.toFloat(),g=l.mul(m.mul(f.pow(m.sub(ge(1))))),b=Qt(f.shape,i);return b.length>0&&(g=g.sum(b)),g.reshape(f.shape)},b:function(){var m=f.greater(0),g=f.log().where(m,nt(f)),b=l.mul(v.mul(g)),w=Qt(d.shape,i);return w.length>0&&(b=b.sum(w)),b.reshape(d.shape)}}},"Pow",{},u,[!0])}}),OI=H({powStrict_:function(n,t){return ft(n.shape,t.shape,"Error in powStrict: "),n.pow(t)}}),NI=H({squaredDifferenceStrict_:function(n,t){var e=F(n,"a","squaredDifferenceStrict"),r=F(t,"b","squaredDifferenceStrict");return ft(e.shape,r.shape,"Error in squaredDifferenceStrict: "),e.squaredDifference(r)}}),Zt=H({sub_:function(n,t){var e,r=F(n,"a","sub"),a=F(t,"b","sub");e=Dt(r,a),r=e[0],a=e[1];var i=et(r.shape,a.shape);return q.runKernelFunc(function(u){return u.subtract(r,a)},{a:r,b:a},function(u){return{a:function(){var l=u,c=Qt(r.shape,i);return c.length>0&&(l=l.sum(c)),l.reshape(r.shape)},b:function(){var l=u,c=Qt(a.shape,i);return c.length>0&&(l=l.sum(c)),l.neg().reshape(a.shape)}}},"Sub")}}),MI=H({subStrict_:function(n,t){var e=F(n,"a","subStrict"),r=F(t,"b","subStrict");return ft(e.shape,r.shape,"Error in subStrict: "),e.sub(r)}}),US=H({equal_:function(n,t){var e,r=F(n,"a","equal"),a=F(t,"b","equal");return e=Dt(r,a),r=e[0],a=e[1],et(r.shape,a.shape),q.runKernelFunc(function(i){return i.equal(r,a)},{$a:r,$b:a})}}),II=H({equalStrict_:function(n,t){var e=F(n,"a","equalStrict"),r=F(t,"b","equalStrict");return ft(e.shape,r.shape,"Error in equalStrict: "),e.equal(r)}}),FI=H({greater_:function(n,t){var e,r=F(n,"a","greater"),a=F(t,"b","greater");return e=Dt(r,a),r=e[0],a=e[1],et(r.shape,a.shape),q.runKernelFunc(function(i){return i.greater(r,a)},{a:r,b:a},null,"Greater")}}),VS=H({greaterEqual_:function(n,t){var e,r=F(n,"a","greaterEqual"),a=F(t,"b","greaterEqual");return e=Dt(r,a),r=e[0],a=e[1],et(r.shape,a.shape),q.runKernelFunc(function(i,u){var l=i.greaterEqual(r,a);return u([r,a]),l},{a:r,b:a},function(i,u){var l=u[0],c=u[1];return{a:function(){return nt(l)},b:function(){return nt(c)}}},"GreaterEqual")}}),BI=H({greaterEqualStrict_:function(n,t){var e=F(n,"a","greaterEqualStrict"),r=F(t,"b","greaterEqualStrict");return ft(e.shape,r.shape,"Error in greaterEqualStrict: "),e.greaterEqual(r)}}),LI=H({greaterStrict_:function(n,t){var e=F(n,"a","greaterStrict"),r=F(t,"b","greaterStrict");return ft(e.shape,r.shape,"Error in greaterStrict: "),e.greater(r)}}),PI=H({less_:function(n,t){var e,r=F(n,"a","less"),a=F(t,"b","less");return e=Dt(r,a),r=e[0],a=e[1],et(r.shape,a.shape),q.runKernelFunc(function(i){return i.less(r,a)},{a:r,b:a},null,"Less")}}),zI=H({lessEqual_:function(n,t){var e,r=F(n,"a","lessEqual"),a=F(t,"b","lessEqual");return e=Dt(r,a),r=e[0],a=e[1],et(r.shape,a.shape),q.runKernelFunc(function(i,u){var l=i.lessEqual(r,a);return u([r,a]),l},{a:r,b:a},null,"LessEqual")}}),UI=H({lessEqualStrict_:function(n,t){var e=F(n,"a","lessEqualStrict"),r=F(t,"b","lessEqualStrict");return ft(e.shape,r.shape,"Error in lessEqualStrict: "),e.lessEqual(r)}}),VI=H({lessStrict_:function(n,t){var e=F(n,"a","lessStrict"),r=F(t,"b","lessStrict");return ft(e.shape,r.shape,"Error in lessStrict: "),e.less(r)}}),HI=H({notEqual_:function(n,t){var e,r=F(n,"a","notEqual"),a=F(t,"b","notEqual");return e=Dt(r,a),r=e[0],a=e[1],et(r.shape,a.shape),q.runKernelFunc(function(i){return i.notEqual(r,a)},{a:r,b:a},null,"NotEqual")}}),jI=H({notEqualStrict_:function(n,t){var e=F(n,"a","notEqualStrict"),r=F(t,"b","notEqualStrict");return ft(e.shape,r.shape,"Error in notEqualStrict: "),e.notEqual(r)}});function $w(n,t){for(var e=[],r=n;r<t;++r)e.push(r);return e}function Yw(n){for(var t=[],e=0;e<n.length;++e)for(var r=0;r<n[e].length;++r)t.push(n[e][r]);return t}var pg=H({gather_:function(n,t,e){e===void 0&&(e=0);var r=F(n,"x","gather"),a=F(t,"indices","gather","int32");e=Jt(e,r.shape)[0];var i=function(u,l,c){for(var f=u.shape[c],d=[],v=1,m=1,g=0;g<c;g++)d.push(u.shape[g]),v*=u.shape[g];for(g=0;g<l.rank;g++)d.push(l.shape[g]);for(g=c+1;g<u.rank;g++)d.push(u.shape[g]),m*=u.shape[g];return{batchSize:v,sliceSize:m,dimSize:f,outputShape:d}}(r,a,e);return q.runKernelFunc(function(u,l){var c=u.gather(r,a.flatten(),e);return l([a]),c},{x:r,indices:a},function(u,l){var c=l[0];return{x:function(){var f=r.shape,d=c.size,v=f.slice(0,e),m=v.length,g=f.slice(e,f.length).slice(1),b=g.length,w=$w(0,m),S=$w(m+1,m+1+b),_=Yw([v,[d],g]),E=u.reshape(_),R=c.reshape([d]),C=Yw([[m],w,S]),A=E.transpose(C),D=HS(A,R,r.shape[e]),k=eg(C);return D=D.transpose(k)},indices:function(){return c}}},"Gather",{axis:e}).reshape(i.outputShape)}}),HS=H({unsortedSegmentSum_:function(n,t,e){var r=F(n,"x","unsortedSegmentSum"),a=F(t,"segmentIds","unsortedSegmentSum","int32");return L(Bt(e),function(){return"numSegments must be of dtype int"}),q.runKernelFunc(function(i,u){var l=i.unsortedSegmentSum(r,a,e);return u([a]),l},{$x:r},function(i,u){var l=u[0];return{$x:function(){return function(c,f){for(var d=dg(f,nt(f)),v=pg(c,d),m=VS(f,ge(0,"int32")),g=v.rank-m.rank,b=0;b<g;++b)m=vr(m,b+1);m=yh(m,Hs(v.shape,"bool"));var w=nt(v);return fo(m,v,w)}(i,l)}}})}}),WI=function(n,t,e){return _e(this,void 0,void 0,function(){var r,a,i,u,l,c,f,d,v,m,g,b,w;return Se(this,function(S){switch(S.label){case 0:for(r=F(n,"tensor","boolMask"),a=F(t,"mask","boolMask","bool"),i=e??0,u=a.rank,l=r.shape,L(u>0,function(){return"mask cannot be scalar"}),ft(l.slice(i,i+u),a.shape,"mask's shape must match the first K dimensions of tensor's shape,"),c=1,f=i;f<i+u;f++)c*=l[f];return d=l.slice(0,i).concat([c],l.slice(i+u)),v=r.reshape(d),m=a.reshape([-1]),[4,LS(m)];case 1:return g=S.sent(),b=g.squeeze([1]),w=pg(v,b,i),n!==r&&r.dispose(),t!==a&&a.dispose(),b.dispose(),v.dispose(),m.dispose(),g.dispose(),[2,w]}})})};function jS(n,t,e,r,a,i,u){i===void 0&&(i="NHWC"),L(n.length===t.rank,function(){return"Length of inShape ("+n.length+") and rank of dy ("+t.rank+") must match"});var l=n,c=t,f=!1;t.rank===3&&(f=!0,c=t.as4D(1,t.shape[0],t.shape[1],t.shape[2]),l=[1,n[0],n[1],n[2]]),L(l.length===4,function(){return"Error in conv2dDerInput: inShape must be length 4, but got length "+l.length+"."}),L(c.rank===4,function(){return"Error in conv2dDerInput: dy must be rank 4, but got rank "+c.rank}),L(e.rank===4,function(){return"Error in conv2dDerInput: filter must be rank 4, but got rank "+e.rank});var d=i==="NHWC"?l[3]:l[1],v=i==="NHWC"?c.shape[3]:c.shape[1];L(d===e.shape[2],function(){return"Error in conv2dDerInput: depth of input ("+d+") must match input depth for filter "+e.shape[2]+"."}),L(v===e.shape[3],function(){return"Error in conv2dDerInput: depth of output ("+v+") must match output depth for filter "+e.shape[3]+"."}),u!=null&&L(Bt(a),function(){return"Error in conv2dDerInput: pad must be an integer when using, dimRoundingMode "+u+" but got pad "+a+"."});var m=ig(i),g=vo(l,e.shape,r,1,a,u,!1,m),b=q.runKernelFunc(function(w,S){var _=w.conv2dDerInput(c,e,g);return S([e,c]),_},{dy4D:c,filter:e},function(w,S){var _=S[0],E=S[1];return{dy4D:function(){return wr(w,_,r,a,i,1,u)},filter:function(){return vg(w,E,_.shape,r,a,i,u)}}});return f?b.as3D(b.shape[1],b.shape[2],b.shape[3]):b}function Av(n){var t=function(i){return typeof i=="number"?[i,i,i]:i.length===2?[i[0],i[1],1]:i}(n),e=t[0],r=t[1],a=t[2];return e===1&&r===1&&a===1}function WS(n,t,e,r,a){L(n.length===t.rank,function(){return"Length of inShape ("+n.length+") and rank of dy ("+t.rank+") must match"});var i=n,u=t,l=!1;t.rank===4&&(l=!0,u=t.as5D(1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]),i=[1,n[0],n[1],n[2],n[3]]);var c=i[4],f=u.shape[4];L(i.length===5,function(){return"Error in conv3dDerInput: inShape must be length 5, but got length "+i.length+"."}),L(u.rank===5,function(){return"Error in conv3dDerInput: dy must be rank 5, but got rank "+u.rank}),L(e.rank===5,function(){return"Error in conv3dDerInput: filter must be rank 5, but got rank "+e.rank}),L(c===e.shape[3],function(){return"Error in conv3dDerInput: depth of input ("+c+") must match input depth for filter "+e.shape[3]+"."}),L(f===e.shape[4],function(){return"Error in conv3dDerInput: depth of output ("+f+") must match output depth for filter "+e.shape[4]+"."});var d=Yf(i,e.shape,r,1,a),v=q.runKernelFunc(function(m){return m.conv3dDerInput(u,e,d)},{dy5D:u});return l?v.as4D(v.shape[1],v.shape[2],v.shape[3],v.shape[4]):v}var GI=H({conv1d_:function(n,t,e,r,a,i,u){a===void 0&&(a="NWC"),i===void 0&&(i=1);var l=F(n,"x","conv1d"),c=F(t,"filter","conv1d"),f=l,d=!1;l.rank===2&&(d=!0,f=l.as3D(1,l.shape[0],l.shape[1])),L(f.rank===3,function(){return"Error in conv1d: input must be rank 3, but got rank "+f.rank+"."}),L(c.rank===3,function(){return"Error in conv1d: filter must be rank 3, but got rank "+c.rank+"."}),u!=null&&L(Bt(r),function(){return"Error in conv1d: pad must be an integer when using, dimRoundingMode "+u+" but got pad "+r+"."}),L(f.shape[2]===c.shape[1],function(){return"Error in conv1d: depth of input ("+f.shape[2]+") must match input depth for filter "+c.shape[1]+"."}),L(Vn(e,i),function(){return"Error in conv1D: Either stride or dilation must be 1. Got stride "+e+" and dilation '"+i+"'"}),L(a==="NWC",function(){return"Error in conv1d: got dataFormat of "+a+" but only NWC is currently supported."});var v=c.as4D(1,c.shape[0],c.shape[1],c.shape[2]),m=f.as4D(f.shape[0],1,f.shape[1],f.shape[2]),g=wr(m,v,[1,e],r,"NHWC",[1,i],u);return d?g.as2D(g.shape[2],g.shape[3]):g.as3D(g.shape[0],g.shape[2],g.shape[3])}}),wr=H({conv2d_:function(n,t,e,r,a,i,u){a===void 0&&(a="NHWC"),i===void 0&&(i=[1,1]);var l=F(n,"x","conv2d"),c=F(t,"filter","conv2d"),f=l,d=!1;l.rank===3&&(d=!0,f=l.as4D(1,l.shape[0],l.shape[1],l.shape[2])),L(f.rank===4,function(){return"Error in conv2d: input must be rank 4, but got rank "+f.rank+"."}),L(c.rank===4,function(){return"Error in conv2d: filter must be rank 4, but got rank "+c.rank+"."}),u!=null&&L(Bt(r),function(){return"Error in conv2d: pad must be an integer when using, dimRoundingMode "+u+" but got pad "+r+"."});var v=a==="NHWC"?f.shape[3]:f.shape[1];L(v===c.shape[2],function(){return"Error in conv2d: depth of input ("+v+") must match input depth for filter "+c.shape[2]+"."}),L(Vn(e,i),function(){return"Error in conv2D: Either strides or dilations must be 1. Got strides "+e+" and dilations '"+i+"'"});var m=ig(a),g=vo(f.shape,c.shape,e,i,r,u,!1,m),b=[c,f],w=q.runKernelFunc(function(S,_){var E=S.conv2d(f,c,g);return _([c,f]),E},{x:f,filter:c},function(S,_){var E=_,R=E[0],C=E[1];return L(Bs(i),function(){return"Error in gradient of conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+i+"'"}),{x:function(){return GS(C.shape,S,R,e,r,a)},filter:function(){return vg(C,S,R.shape,e,r,a)}}},"Conv2D",g,b);return d?w.as3D(w.shape[1],w.shape[2],w.shape[3]):w}}),qI=H({conv3d_:function(n,t,e,r,a,i){a===void 0&&(a="NDHWC"),i===void 0&&(i=[1,1,1]);var u=F(n,"x","conv3d"),l=F(t,"filter","conv3d"),c=u,f=!1;u.rank===4&&(f=!0,c=u.as5D(1,u.shape[0],u.shape[1],u.shape[2],u.shape[3])),L(c.rank===5,function(){return"Error in conv3d: input must be rank 5, but got rank "+c.rank+"."}),L(l.rank===5,function(){return"Error in conv3d: filter must be rank 5, but got rank "+l.rank+"."}),L(c.shape[4]===l.shape[3],function(){return"Error in conv3d: depth of input ("+c.shape[4]+") must match input depth for filter "+l.shape[3]+"."}),L(function(m,g){return Av(m)||Av(g)}(e,i),function(){return"Error in conv3D: Either strides or dilations must be 1. Got strides "+e+" and dilations '"+i+"'"}),L(a==="NDHWC",function(){return"Error in conv3d: got dataFormat of "+a+" but only NDHWC is currently supported."});var d=Yf(c.shape,l.shape,e,i,r),v=q.runKernelFunc(function(m,g){var b=m.conv3d(c,l,d);return g([c,l]),b},{x:c,$filter:l},function(m,g){L(Av(i),function(){return"Error in gradient of conv3D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+i+"'"});var b=g[0],w=g[1];return{x:function(){return WS(b.shape,m,w,e,r)},$filter:function(){return function(S,_,E,R,C){var A=S;S.rank===4&&(A=S.as5D(1,S.shape[0],S.shape[1],S.shape[2],S.shape[3]));var D=_;D.rank===4&&(D=_.as5D(1,_.shape[0],_.shape[1],_.shape[2],_.shape[3])),L(A.rank===5,function(){return"Error in conv3dDerFilter: input must be rank 5, but got shape "+A.shape+"."}),L(D.rank===5,function(){return"Error in conv3dDerFilter: dy must be rank 5, but got shape "+D.shape+"."}),L(E.length===5,function(){return"Error in conv3dDerFilter: filterShape must be length 5, but got "+E+"."}),L(A.shape[4]===E[3],function(){return"Error in conv3dDerFilter: depth of input "+A.shape[4]+") must match input depth in filter ("+E[3]+"."}),L(D.shape[4]===E[4],function(){return"Error in conv3dDerFilter: depth of dy ("+D.shape[4]+") must match output depth for filter ("+E[4]+")."});var k=Yf(A.shape,E,R,1,C);return q.runKernelFunc(function(I){return I.conv3dDerFilter(A,D,k)},{x5D:A,dy5D:D})}(b,m,w.shape,e,r)}}});return f?v.as4D(v.shape[1],v.shape[2],v.shape[3],v.shape[4]):v}}),vg=H({conv2dDerFilter_:function(n,t,e,r,a,i,u){i===void 0&&(i="NHWC");var l=n;n.rank===3&&(l=n.as4D(1,n.shape[0],n.shape[1],n.shape[2]));var c=t;c.rank===3&&(c=t.as4D(1,t.shape[0],t.shape[1],t.shape[2])),L(l.rank===4,function(){return"Error in conv2dDerFilter: input must be rank 4, but got shape "+l.shape+"."}),L(c.rank===4,function(){return"Error in conv2dDerFilter: dy must be rank 4, but got shape "+c.shape+"."}),L(e.length===4,function(){return"Error in conv2dDerFilter: filterShape must be length 4, but got "+e+"."});var f=i==="NHWC"?l.shape[3]:l.shape[1],d=i==="NHWC"?c.shape[3]:c.shape[1];L(f===e[2],function(){return"Error in conv2dDerFilter: depth of input "+f+") must match input depth in filter ("+e[2]+"."}),L(d===e[3],function(){return"Error in conv2dDerFilter: depth of dy ("+d+") must match output depth for filter ("+e[3]+")."}),u!=null&&L(Bt(a),function(){return"Error in conv2dDerFilter: pad must be an integer when using, dimRoundingMode "+u+" but got pad "+a+"."});var v=ig(i),m=vo(l.shape,e,r,1,a,u,!1,v);return q.runKernelFunc(function(g){return g.conv2dDerFilter(l,c,m)},{x4D:l,dy4D:c})}}),GS=H({conv2dDerInput_:jS}),bh=H({depthwiseConv2d_:function(n,t,e,r,a,i,u){i===void 0&&(i=[1,1]);var l=F(n,"x","depthwiseConv2d"),c=F(t,"filter","depthwiseConv2d"),f=l,d=!1;l.rank===3&&(d=!0,f=l.as4D(1,l.shape[0],l.shape[1],l.shape[2])),L(f.rank===4,function(){return"Error in depthwiseConv2d: input must be rank 4, but got rank "+f.rank+"."}),L(c.rank===4,function(){return"Error in depthwiseConv2d: filter must be rank 4, but got rank "+c.rank+"."}),L(f.shape[3]===c.shape[2],function(){return"Error in depthwiseConv2d: number of input channels ("+f.shape[3]+") must match the inChannels dimension in filter "+c.shape[2]+"."}),i==null&&(i=[1,1]),L(Vn(e,i),function(){return"Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides "+e+" and dilations '"+i+"'"}),u!=null&&L(Bt(r),function(){return"Error in depthwiseConv2d: pad must be an integer when using, dimRoundingMode "+u+" but got pad "+r+"."});var v=vo(f.shape,c.shape,e,i,r,u,!0),m=[f,c],g=q.runKernelFunc(function(b,w){var S=b.depthwiseConv2D(f,c,v);return w([f,c]),S},{x:f,filter:c},function(b,w){L(Bs(i),function(){return"Error in gradient of depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '"+i+"'"});var S=w[0],_=w[1];return{x:function(){return qS(S.shape,b,_,v)},filter:function(){return KS(S,b,_.shape,v)}}},"DepthwiseConv2dNative",v,m);return d?g.as3D(g.shape[1],g.shape[2],g.shape[3]):g}}),qS=H({depthwiseConv2dDerInput_:function(n,t,e,r){var a=t,i=!1;t.rank===3&&(i=!0,a=t.as4D(1,t.shape[0],t.shape[1],t.shape[2]));var u=q.runKernelFunc(function(l){return l.depthwiseConv2DDerInput(a,e,r)},{dy4D:a});return i?u.as3D(u.shape[1],u.shape[2],u.shape[3]):u}}),KS=H({depthwiseConv2dDerFilter_:function(n,t,e,r){var a=n;n.rank===3&&(a=n.as4D(1,n.shape[0],n.shape[1],n.shape[2]));var i=t;return i.rank===3&&(i=t.as4D(1,t.shape[0],t.shape[1],t.shape[2])),q.runKernelFunc(function(u){return u.depthwiseConv2DDerFilter(a,i,r)},{x4D:a,dy4D:i})}}),mg=H({separableConv2d_:function(n,t,e,r,a,i,u){i===void 0&&(i=[1,1]),u===void 0&&(u="NHWC");var l=F(n,"x","separableConv2d"),c=F(t,"depthwiseFilter","separableConv2d"),f=F(e,"pointwiseFilter","separableConv2d"),d=l,v=!1;if(l.rank===3&&(v=!0,d=l.as4D(1,l.shape[0],l.shape[1],l.shape[2])),u==="NCHW")throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");L(d.rank===4,function(){return"Error in separableConv2d: input must be rank 4, but got rank "+d.rank+"."}),L(c.rank===4,function(){return"Error in separableConv2d: depthwise filter must be rank 4, but got rank "+c.rank+"."}),L(f.rank===4,function(){return"Error in separableConv2d: pointwise filter must be rank 4, but got rank "+c.rank+"."}),L(f.shape[0]===1,function(){return"Error in separableConv2d: the first dimension of pointwise filter  must be 1, but got "+f.shape[0]+"."}),L(f.shape[1]===1,function(){return"Error in separableConv2d: the second dimension of pointwise filter must be 1, but got "+f.shape[1]+"."});var m=c.shape[2],g=c.shape[3];L(f.shape[2]===m*g,function(){return"Error in separableConv2d: the third dimension of pointwise filter must be "+m*g+", but got "+f.shape[2]+"."});var b=bh(d,c,r,a,u,i),w=wr(b,f,1,"valid",u);return v?w.as3D(w.shape[1],w.shape[2],w.shape[3]):w}}),KI=H({conv2dTranspose_:function(n,t,e,r,a,i){return jS(e,F(n,"x","conv2dTranspose"),F(t,"filter","conv2dTranspose"),r,a,"NHWC",i)}}),XI=H({conv3dTranspose_:function(n,t,e,r,a){return WS(e,F(n,"x","conv3dTranspose"),F(t,"filter","conv3dTranspose"),r,a)}}),xh=H({matMul_:function(n,t,e,r){var a;e===void 0&&(e=!1),r===void 0&&(r=!1);var i=F(n,"a","matMul"),u=F(t,"b","matMul");a=Dt(i,u),i=a[0],u=a[1];var l=e?i.shape[i.rank-2]:i.shape[i.rank-1],c=r?u.shape[u.rank-1]:u.shape[u.rank-2],f=e?i.shape[i.rank-1]:i.shape[i.rank-2],d=r?u.shape[u.rank-2]:u.shape[u.rank-1],v=i.shape.slice(0,-2),m=u.shape.slice(0,-2),g=Ce(v),b=Ce(m);L(i.rank>=2&&u.rank>=2&&i.rank===u.rank,function(){return"Error in matMul: inputs must have the same rank of at least 2, got ranks "+i.rank+" and "+u.rank+"."}),L(un(v,m),function(){return"Error in matMul: outer dimensions ("+v+") and ("+m+") of Tensors with shapes "+i.shape+" and "+u.shape+" must match."}),L(l===c,function(){return"Error in matMul: inner shapes ("+l+") and ("+c+") of Tensors with shapes "+i.shape+" and "+u.shape+" and transposeA="+e+" and transposeB="+r+" must match."});var w=i.shape.slice(0,-2).concat([f,d]),S=e?i.as3D(g,l,f):i.as3D(g,f,l),_=r?u.as3D(b,d,c):u.as3D(b,c,d),E={transposeA:e,transposeB:r};return q.runKernelFunc(function(R,C){var A=R.batchMatMul(S,_,e,r);return C([S,_]),A},{a:S,b:_},function(R,C){var A=C,D=A[0],k=A[1];return e||r?!e&&r?{a:function(){return R.matMul(k,!1,!1)},b:function(){return R.matMul(D,!0,!1)}}:e&&!r?{a:function(){return k.matMul(R,!1,!0)},b:function(){return D.matMul(R,!1,!1)}}:{a:function(){return k.matMul(R,!0,!0)},b:function(){return R.matMul(D,!0,!0)}}:{a:function(){return R.matMul(k,!1,!0)},b:function(){return D.matMul(R,!0,!1)}}},"BatchMatMul",E).reshape(w)}}),$I=H({dot_:function(n,t){var e=F(n,"t1","dot"),r=F(t,"t2","dot");L(!(e.rank!==1&&e.rank!==2||r.rank!==1&&r.rank!==2),function(){return"Error in dot: inputs must all be rank 1 or 2, but got ranks "+e.rank+" and "+r.rank+"."});var a=e.rank===1?e.size:e.shape[1],i=r.rank===1?r.size:r.shape[0];return L(a===i,function(){return"Error in dot: inner dimensions of inputs must match, but got "+a+" and "+i+"."}),e.rank===1&&r.rank===1?e.as2D(1,-1).matMul(r.as2D(-1,1)).asScalar():e.rank===1&&r.rank===2?e.as2D(1,-1).matMul(r.as2D(r.shape[0],r.shape[1])).as1D():e.rank===2&&r.rank===1?e.matMul(r.as2D(-1,1)).as1D():e.matMul(r.as2D(r.shape[0],r.shape[1]))}}),YI=H({outerProduct_:function(n,t){var e=F(n,"v1","outerProduct"),r=F(t,"v2","outerProduct");return L(e.rank===1&&r.rank===1,function(){return"Error in outerProduct: inputs must be rank 1, but got ranks "+e.rank+" and "+r.rank+"."}),e.as2D(-1,1).matMul(r.as2D(1,-1))}}),Tl=H({reverse_:function(n,t){var e=F(n,"x","reverse");if(e.rank===0)return e.clone();var r=Jt(t,e.shape);return q.runKernelFunc(function(a){return a.reverse(e,r)},{$x:e},function(a){return{$x:function(){return a.reverse(r)}}}).reshapeAs(e)}}),QI=H({reverse1d_:function(n){var t=F(n,"x","reverse");return L(t.rank===1,function(){return"Error in reverse1D: x must be rank 1 but got rank "+t.rank+"."}),Tl(t,0)}}),ZI=H({reverse2d_:function(n,t){var e=F(n,"x","reverse");return L(e.rank===2,function(){return"Error in reverse2D: x must be rank 2 but got rank "+e.rank+"."}),Tl(e,t)}}),JI=H({reverse3d_:function(n,t){var e=F(n,"x","reverse");return L(e.rank===3,function(){return"Error in reverse3D: x must be rank 3 but got rank "+e.rank+"."}),Tl(e,t)}}),eF=H({reverse4d_:function(n,t){var e=F(n,"x","reverse");return L(e.rank===4,function(){return"Error in reverse4D: x must be rank 4 but got rank "+e.rank+"."}),Tl(e,t)}});function XS(n,t,e,r,a,i){var u=F(n,"x","maxPool"),l=u,c=!1;u.rank===3&&(c=!0,l=u.as4D(1,u.shape[0],u.shape[1],u.shape[2])),L(l.rank===4,function(){return"Error in maxPool: input must be rank 4 but got rank "+l.rank+"."}),L(Vn(e,r),function(){return"Error in maxPool: Either strides or dilations must be 1. Got strides "+e+" and dilations '"+r+"'"}),i!=null&&L(Bt(a),function(){return"Error in maxPool: pad must be an integer when using, dimRoundingMode "+i+" but got pad "+a+"."});var f=dl(l.shape,t,e,r,a,i);if(f.filterWidth===1&&f.filterHeight===1&&un(f.inShape,f.outShape))return u.clone();var d=[l],v=q.runKernelFunc(function(m,g){var b=m.maxPool(l,f);return g([l,b]),b},{x:l},function(m,g){var b=g[0],w=g[1];return{x:function(){return function(S,_,E,R,C,A,D,k){var I=F(S,"dy","maxPoolBackprop"),N=F(_,"input","maxPoolBackprop"),B=F(E,"output","maxPoolBackprop");L(N.rank===I.rank,function(){return"Rank of input ("+N.rank+") does not match rank of dy ("+I.rank+")"}),L(Vn(C,A),function(){return"Error in maxPoolBackProp: Either strides or dilations must be 1. Got strides "+C+" and dilations '"+A+"'"}),L(I.rank===4,function(){return"Error in maxPoolBackprop: dy must be rank 4 but got rank "+I.rank+"."}),L(N.rank===4,function(){return"Error in maxPoolBackprop: input must be rank 4 but got rank "+N.rank+"."});var V=dl(N.shape,R,C,A,D,k);return q.runKernelFunc(function(U){return U.maxPoolBackprop(I,N,B,V)},{$dy:I,$input:N})}(m,b,w,t,e,r,a)}}},"MaxPool",f,d);return c?v.as3D(v.shape[1],v.shape[2],v.shape[3]):v}function $S(n,t,e,r,a,i){var u=F(n,"x","avgPool","float32");L(Vn(e,r),function(){return"Error in avgPool: Either strides or dilations must be 1. Got strides "+e+" and dilations '"+r+"'"});var l=u,c=!1;u.rank===3&&(c=!0,l=u.as4D(1,u.shape[0],u.shape[1],u.shape[2])),L(l.rank===4,function(){return"Error in avgPool: x must be rank 4 but got rank "+l.rank+"."}),i!=null&&L(Bt(a),function(){return"Error in avgPool: pad must be an integer when using, dimRoundingMode "+i+" but got pad "+a+"."});var f=dl(l.shape,t,e,r,a,i);if(f.filterWidth===1&&f.filterHeight===1&&un(f.inShape,f.outShape))return u.clone();var d=q.runKernelFunc(function(v){return v.avgPool(l,f)},{x:l},function(v){return{x:function(){return function(m,g,b,w,S,_){var E=F(m,"dy","avgPoolBackprop"),R=F(g,"input","avgPoolBackprop");L(R.rank===E.rank,function(){return"Rank of input ("+R.rank+") does not match rank of dy ("+E.rank+")"}),L(Vn(w,S),function(){return"Error in avgPoolBackprop: Either strides or dilations must be 1. Got strides "+w+" and dilations '"+S+"'"});var C=R,A=E,D=!1;R.rank===3&&(D=!0,C=R.as4D(1,R.shape[0],R.shape[1],R.shape[2]),A=E.as4D(1,E.shape[0],E.shape[1],E.shape[2])),L(A.rank===4,function(){return"Error in avgPoolBackprop: dy must be rank 4 but got rank "+A.rank+"."}),L(C.rank===4,function(){return"Error in avgPoolBackprop: input must be rank 4 but got rank "+C.rank+"."});var k=dl(C.shape,b,w,S,_),I=q.runKernelFunc(function(N){return N.avgPoolBackprop(A,C,k)},{dy4D:A,input4D:C});return D?I.as3D(I.shape[1],I.shape[2],I.shape[3]):I}(v,l,t,e,r,a)}}},"AvgPool",f);return d=d.cast(u.dtype),c?d.as3D(d.shape[1],d.shape[2],d.shape[3]):d}var an=H({maxPool_:function(n,t,e,r,a){return XS(n,t,e,1,r,a)}}),Dl=H({avgPool_:function(n,t,e,r,a){return $S(n,t,e,1,r,a)}}),tF=H({pool_:function(n,t,e,r,a,i){a==null&&(a=[1,1]),i==null&&(i=1),r===0&&(r="valid");var u=F(n,"x","maxPool"),l=u,c=!1;u.rank===3&&(c=!0,l=u.as4D(1,u.shape[0],u.shape[1],u.shape[2])),L(Vn(i,a),function(){return"Error in pool: Either strides or dilations must be 1. Got strides "+i+" and dilations '"+a+"'"});var f,d=dl(l.shape,t,i,a,r),v=[d.dilationHeight,d.dilationWidth];f=r==="same"?function(C,A){var D=C.map(function(N,B){return N+(N-1)*(A[B]-1)}).map(function(N){return N-1}),k=D.map(function(N){return Math.floor(N/2)}),I=D.map(function(N,B){return N-k[B]});return D.map(function(N,B){return[k[B],I[B]]})}([d.filterHeight,d.filterWidth],v):[[0,0],[0,0]];var m=v[0]===1&&v[1]===1,g=function(C,A,D){var k=D.map(function(ee){return ee[0]}),I=D.map(function(ee){return ee[1]}),N=C.concat(k,I),B=A.map(function(ee,te){return(ee-N[te]%ee)%ee}),V=I.map(function(ee,te){return ee+B[te]}),U=A.map(function(ee,te){return[k[te],V[te]]}),J=A.map(function(ee,te){return[0,B[te]]});return[U,J]}([d.inHeight,d.inWidth],v,f),b=g[0],w=g[1],S=m?r:"valid",_=m?l:tS(l,v,b),E=(e==="avg"?function(){return $S(_,t,i,1,S)}:function(){return XS(_,t,i,1,S)})(),R=m?E:Z_(E,v,w);return c?R.as3D(R.shape[1],R.shape[2],R.shape[3]):R}}),nF=H({maxPool3d_:function(n,t,e,r,a,i,u){i===void 0&&(i="NDHWC");var l=F(n,"x","maxPool3d"),c=l,f=!1;l.rank===4&&(f=!0,c=l.as5D(1,l.shape[0],l.shape[1],l.shape[2],l.shape[3])),u==null&&(u=[1,1,1]),L(c.rank===5,function(){return"Error in maxPool3d: x must be rank 5 but got rank "+c.rank+"."}),L(i==="NDHWC",function(){return"Error in maxPool3d: Only NDHWC is currently supported, but got dataFormat of "+i}),L(Vn(e,u),function(){return"Error in maxPool3d: Either strides or dilations must be 1. Got strides "+e+" and dilations '"+u+"'"}),a!=null&&L(Bt(r),function(){return"Error in maxPool3d: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+r+"."});var d=$f(c.shape,t,e,u,r,a,i),v=q.runKernelFunc(function(m,g){var b=m.maxPool3d(c,d);return g([c,b]),b},{x:c},function(m,g){var b=g[0],w=g[1];return{x:function(){return function(S,_,E,R,C,A,D,k){var I=F(S,"dy","maxPool3dBackprop"),N=F(_,"input","maxPool3dBackprop"),B=F(E,"output","maxPool3dBackprop"),V=I,U=N,J=B,ee=!1;N.rank===4&&(ee=!0,V=I.as5D(1,I.shape[0],I.shape[1],I.shape[2],I.shape[3]),U=N.as5D(1,N.shape[0],N.shape[1],N.shape[2],N.shape[3]),J=B.as5D(1,B.shape[0],B.shape[1],B.shape[2],B.shape[3])),L(V.rank===5,function(){return"Error in maxPool3dBackprop: dy must be rank 5 but got rank "+V.rank+"."}),L(U.rank===5,function(){return"Error in maxPool3dBackprop: input must be rank 5 but got rank "+U.rank+"."}),L(J.rank===5,function(){return"Error in maxPool3dBackprop: output must be rank 5 but got rank "+J.rank+"."}),A==null&&(A=[1,1,1]),L(Vn(C,A),function(){return"Error in maxPool3dBackprop: Either strides or dilations must be 1. Got strides "+C+" and dilations '"+A+"'"}),k!=null&&L(Bt(D),function(){return"Error in maxPool3dBackprop: pad must be an integer when using, dimRoundingMode "+k+" but got pad "+D+"."});var te=$f(U.shape,R,C,A,D,k),P=q.runKernelFunc(function(j){return j.maxPool3dBackprop(V,U,J,te)},{dy5D:V,input5D:U});return ee?P.as4D(P.shape[1],P.shape[2],P.shape[3],P.shape[4]):P}(m,b,w,t,e,u,r,a)}}});return f?v.as4D(v.shape[1],v.shape[2],v.shape[3],v.shape[4]):v}}),rF=H({avgPool3d_:function(n,t,e,r,a,i,u){i===void 0&&(i="NDHWC");var l=F(n,"x","avgPool3d","float32"),c=l,f=!1;l.rank===4&&(f=!0,c=l.as5D(1,l.shape[0],l.shape[1],l.shape[2],l.shape[3])),u==null&&(u=[1,1,1]),L(c.rank===5,function(){return"Error in avgPool3d: x must be rank 5 but got rank "+c.rank+"."}),L(i==="NDHWC",function(){return"Error in avgPool3d: Only NDHWC is currently supported, but got dataFormat of "+i}),L(Vn(e,u),function(){return"Error in avgPool3d: Either strides or dilations must be 1. Got strides "+e+" and dilations '"+u+"'"}),a!=null&&L(Bt(r),function(){return"Error in avgPool3d: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+r+"."});var d=$f(c.shape,t,e,u,r,a,i),v=q.runKernelFunc(function(m){return m.avgPool3d(c,d)},{x:c},function(m){return{x:function(){return function(g,b,w,S,_,E,R){var C=F(g,"dy","avgPool3dBackprop"),A=F(b,"input","avgPool3dBackprop"),D=C,k=A,I=!1;A.rank===4&&(I=!0,D=C.as5D(1,C.shape[0],C.shape[1],C.shape[2],C.shape[3]),k=A.as5D(1,A.shape[0],A.shape[1],A.shape[2],A.shape[3])),L(D.rank===5,function(){return"Error in avgPool3dBackprop: dy must be rank 5 but got rank "+D.rank+"."}),L(k.rank===5,function(){return"Error in avgPool3dBackprop: input must be rank 5 but got rank "+k.rank+"."}),_==null&&(_=[1,1,1]),L(Vn(S,_),function(){return"Error in avgPool3dBackprop: Either strides or dilations must be 1. Got strides "+S+" and dilations '"+_+"'"}),R!=null&&L(Bt(E),function(){return"Error in maxPool3dBackprop: pad must be an integer when using, dimRoundingMode "+R+" but got pad "+E+"."});var N=$f(k.shape,w,S,_,E,R),B=q.runKernelFunc(function(V){return V.avgPool3dBackprop(D,k,N)},{dy5D:D,input5D:k});return I?B.as4D(B.shape[1],B.shape[2],B.shape[3],B.shape[4]):B}(m,c,t,e,u,r,a)}}});return v=v.cast(c.dtype),f?v.as4D(v.shape[1],v.shape[2],v.shape[3],v.shape[4]):v}}),ea=H({slice_:function(n,t,e){var r,a,i=F(n,"x","slice");if(i.rank===0)throw new Error("Slicing scalar is not possible");(r=typeof t=="number"?[t].concat(new Array(i.rank-1).fill(0)):t.length<i.rank?t.concat(new Array(i.rank-t.length).fill(0)):t.slice()).forEach(function(c){L(c!==-1,function(){return"slice() does not support negative begin indexing."})}),a=(a=e==null?new Array(i.rank).fill(-1):typeof e=="number"?[e].concat(new Array(i.rank-1).fill(-1)):e.length<i.rank?e.concat(new Array(i.rank-e.length).fill(-1)):e).map(function(c,f){return c>=0?c:(L(c===-1,function(){return"Negative size values should be exactly -1 but got "+c+" for the slice() size at index "+f+"."}),i.shape[f]-r[f])}),O3(i,r,a);var u=i.shape,l={begin:r,size:a};return q.runKernelFunc(function(c){return c.slice(i,r,a)},{x:i},function(c){for(var f=[],d=0;d<c.rank;d++)f.push([r[d],u[d]-r[d]-a[d]]);return{x:function(){return c.pad(f)}}},"Slice",l)}}),aF=H({slice1d_:function(n,t,e){var r=F(n,"x","slice1d");return L(r.rank===1,function(){return"slice1d expects a rank-1 tensor, but got a rank-"+r.rank+" tensor"}),ea(r,[t],[e])}}),iF=H({slice2d_:function(n,t,e){var r=F(n,"x","slice2d");return L(r.rank===2,function(){return"slice2d expects a rank-2 tensor, but got a rank-"+r.rank+" tensor"}),ea(r,t,e)}}),YS=H({slice3d_:function(n,t,e){var r=F(n,"x","slice3d");return L(r.rank===3,function(){return"slice3d expects a rank-3 tensor, but got a rank-"+r.rank+" tensor"}),ea(r,t,e)}}),oF=H({slice4d_:function(n,t,e){var r=F(n,"x","slice4d");return L(r.rank===4,function(){return"slice4d expects a rank-4 tensor, but got a rank-"+r.rank+" tensor"}),ea(r,t,e)}});function QS(n,t,e,r,a){return t.rank<e.rank&&(t=t.reshape(Un(t.shape,r))),n.rank<e.rank&&(n=n.reshape(Un(n.shape,r))),{x:function(){var i=n.mul(e.equal(t).cast(n.dtype));return a==null?i:i.transpose(a)}}}var sF=H({all_:function(n,t,e){t===void 0&&(t=null),e===void 0&&(e=!1);var r=F(n,"x","all","bool"),a=Jt(t,r.shape),i=a,u=aa(i,r.rank);u!=null&&(r=r.transpose(u),i=ia(i.length,r.rank));var l=q.runKernelFunc(function(f){return f.all(r,i)},{$x:r});if(e){var c=Un(l.shape,a);return l.reshape(c)}return l}}),uF=H({any_:function(n,t,e){t===void 0&&(t=null),e===void 0&&(e=!1);var r=F(n,"x","any","bool"),a=Jt(t,r.shape),i=a,u=aa(i,r.rank);u!=null&&(r=r.transpose(u),i=ia(i.length,r.rank));var l=q.runKernelFunc(function(f){return f.any(r,i)},{$x:r});if(e){var c=Un(l.shape,a);return l.reshape(c)}return l}}),lF=H({argMax_:function(n,t){t===void 0&&(t=0);var e=F(n,"x","argMax");t==null&&(t=0);var r=Jt(t,e.shape),a=aa(r,e.rank);a!=null&&(e=e.transpose(a),r=ia(r.length,e.rank));var i={axis:r[0]},u=[e];return q.runKernelFunc(function(l,c){var f=l.argMax(e,r[0]);return c([e]),f},{x:e},function(l,c){var f=c[0];return{x:function(){return nt(f)}}},"ArgMax",i,u)}}),cF=H({argMin_:function(n,t){t===void 0&&(t=0);var e=F(n,"x","argMin");t==null&&(t=0);var r=Jt(t,e.shape),a=aa(r,e.rank);return a!=null&&(e=e.transpose(a),r=ia(r.length,e.rank)),q.runKernelFunc(function(i,u){var l=i.argMin(e,r[0]);return u([e]),l},{$x:e},function(i,u){var l=u[0];return{$x:function(){return nt(l)}}})}}),fF=H({logSumExp_:function(n,t,e){t===void 0&&(t=null),e===void 0&&(e=!1);var r=F(n,"x","logSumExp"),a=Jt(t,r.shape),i=r.max(a,!0),u=r.sub(i).exp().sum(a).log(),l=i.reshape(u.shape).add(u);if(e){var c=Un(l.shape,a);return l.reshape(c)}return l}}),wh=H({max_:function(n,t,e){t===void 0&&(t=null),e===void 0&&(e=!1);var r=F(n,"x","max"),a=r,i=Jt(t,r.shape),u=i,l=aa(u,r.rank);l!=null&&(r=r.transpose(l),u=ia(u.length,r.rank));var c=[r],f=q.runKernelFunc(function(v,m){var g=v.max(r,u);return m([a,g]),g},{x:r},function(v,m){return QS(v,m[1],m[0],i,l)},"Max",{axes:u},c,[!0]);if(e){var d=Un(f.shape,i);f=f.reshape(d)}return f}}),hF=H({mean_:function(n,t,e){t===void 0&&(t=null),e===void 0&&(e=!1);var r=F(n,"x","mean"),a=Jt(t,r.shape),i=Ce(wn(r.shape,a)[1]);return mh(function(u){var l=ge(i);return{value:(l.dtype===u.dtype?u:u.cast(l.dtype)).div(l).sum(t,e),gradFunc:function(c){var f=u.shape.slice();return a.forEach(function(d){f[d]=1}),c.reshape(f).mul(Hs(u.shape,"float32")).div(i)}}})(r)}}),dF=H({min_:function(n,t,e){t===void 0&&(t=null),e===void 0&&(e=!1);var r=F(n,"x","min"),a=r,i=Jt(t,r.shape),u=i,l=aa(u,r.rank);l!=null&&(r=r.transpose(l),u=ia(u.length,r.rank));var c=[r],f=q.runKernelFunc(function(v,m){var g=v.min(r,u);return m([a,g]),g},{x:r},function(v,m){return QS(v,m[1],m[0],i,l)},"Min",{axes:u},c,[!0]);if(e){var d=Un(f.shape,i);f=f.reshape(d)}return f}}),pF=H({moments_:function(n,t,e){t===void 0&&(t=null),e===void 0&&(e=!1);var r=Jt(t,(n=F(n,"x","moments")).shape),a=n.mean(r,e),i=a.shape;e||(i=Un(a.shape,r));var u=n.toFloat().sub(a.reshape(i)).square();return{mean:a,variance:u.mean(r,e)}}}),ZS=H({sum_:function(n,t,e){t===void 0&&(t=null),e===void 0&&(e=!1);var r=F(n,"x","sum");r.dtype==="bool"&&(r=r.toInt());var a=Jt(t,r.shape);return mh(function(i){var u=aa(a,i.rank),l=a,c=i;u!=null&&(c=i.transpose(u),l=ia(l.length,i.rank));var f=function(g){var b=i.shape.slice();return a.forEach(function(w){b[w]=1}),g.reshape(b).mul(Hs(i.shape,"float32"))},d={axes:l},v=q.runKernelFunc(function(g){return g.sum(c,l)},{x:c},function(g){return{x:function(){return f(g)}}},"Sum",d);if(e){var m=Un(v.shape,a);v=v.reshape(m)}return{value:v,gradFunc:f}})(r)}}),vF=H({prod_:function(n,t,e){t===void 0&&(t=null),e===void 0&&(e=!1);var r=F(n,"x","prod");r.dtype==="bool"&&(r=r.toInt());var a=Jt(t,r.shape),i=aa(a,r.rank),u=a,l=r;i!=null&&(l=r.transpose(i),u=ia(u.length,r.rank));var c=q.runKernelFunc(function(d){return d.prod(l,u)},{permutedX:l});if(e){var f=Un(c.shape,a);c=c.reshape(f)}return c}}),JS=H({elu_:function(n){var t=F(n,"x","elu");return q.runKernelFunc(function(e,r){var a=e.elu(t);return r([a]),a},{$x:t},function(e,r){var a=r[0];return{$x:function(){return q.runKernelFunc(function(i){return i.eluDer(e,a)},{dy:e,y:a})}}})}}),mF=H({leakyRelu_:function(n,t){t===void 0&&(t=.2);var e=F(n,"x","leakyRelu");return dg(ge(t).mul(e),e)}}),eE=H({prelu_:function(n,t){var e=F(n,"x","prelu"),r=F(t,"alpha","prelu");return q.runKernelFunc(function(a,i){var u=a.prelu(e,r);return i([e,r]),u},{x:e,alpha:r},function(a,i){var u=i[0],l=i[1],c=u.greater(0);return{x:function(){return fo(c,a,a.mul(l))},alpha:function(){var f=fo(c,nt(a),a.mul(u)),d=Qt(l.shape,a.shape);return d.length>0&&(f=f.sum(d)),f.reshape(l.shape)}}},"Prelu")}}),At=H({relu_:function(n){var t=F(n,"x","relu");return t.dtype==="bool"?t.toInt():q.runKernelFunc(function(e,r){var a=e.relu(t);return r([t]),a},{x:t},function(e,r){var a=r[0];return{x:function(){return e.mulStrict(a.step().toFloat())}}},"Relu")}}),tE=H({relu6_:function(n){var t=F(n,"x","relu6");return t.dtype==="bool"?t.toInt():q.runKernelFunc(function(e,r){var a=e.relu6(t);return r([t]),a},{x:t},function(e,r){var a=r[0],i=a.lessEqual(6).mul(a.step());return{x:function(){return e.mulStrict(i.toFloat())}}},"Relu6")}}),gF=H({selu_:function(n){var t=F(n,"x","selu");return q.runKernelFunc(function(e,r){var a=e.selu(t);return r([t]),a},{$x:t},function(e,r){var a=r[0];return{$x:function(){var i=a.greater(ge(0)),u=ge(cg),l=ge(fg),c=e.mul(l),f=e.mul(u).mul(a.toFloat().exp());return fo(i,c,f)}}})}}),Ti=H({transpose_:function(n,t){var e=F(n,"x","transpose");if(t==null&&(t=e.shape.map(function(a,i){return i}).reverse()),L(e.rank===t.length,function(){return"Error in transpose: rank of input "+e.rank+" must match length of perm "+t+"."}),t.forEach(function(a){L(a>=0&&a<e.rank,function(){return"All entries in 'perm' must be between 0 and "+(e.rank-1)+" but got "+t})}),e.rank<=1)return e.clone();var r={perm:t};return q.runKernelFunc(function(a){return a.transpose(e,t)},{x:e},function(a){var i=eg(t);return{x:function(){return a.transpose(i)}}},"Transpose",r)}}),yF=H({localResponseNormalization_:function(n,t,e,r,a){t===void 0&&(t=5),e===void 0&&(e=1),r===void 0&&(r=1),a===void 0&&(a=.5);var i=F(n,"x","localResponseNormalization");L(i.rank===4||i.rank===3,function(){return`Error in localResponseNormalization: x must be rank 3 or 4 but got
               rank `+i.rank+"."}),L(Bt(t),function(){return"Error in localResponseNormalization: depthRadius must be an integer but got depthRadius "+t+"."});var u=i,l=!1;i.rank===3&&(l=!0,u=i.as4D(1,i.shape[0],i.shape[1],i.shape[2]));var c=q.runKernelFunc(function(f,d){var v=f.localResponseNormalization4D(u,t,e,r,a);return d([u,v]),v},{x4D:u},function(f,d){var v=d[0],m=d[1];return{x4D:function(){return q.runKernelFunc(function(g){return g.LRNGrad(f,v,m,t,e,r,a)},{})}}});return l?c.as3D(c.shape[1],c.shape[2],c.shape[3]):c}}),nE=H({norm_:function(n,t,e,r){t===void 0&&(t="euclidean"),e===void 0&&(e=null),r===void 0&&(r=!1);var a=function l(c,f,d){if(d===void 0&&(d=null),c.rank===0)return c.abs();if(c.rank!==1&&d===null)return l(c.reshape([-1]),f,d);if(c.rank===1||typeof d=="number"||Array.isArray(d)&&d.length===1){if(f===1)return c.abs().sum(d);if(f===1/0)return c.abs().max(d);if(f===-1/0)return c.abs().min(d);if(f==="euclidean"||f===2)return c.abs().pow(ge(2,"int32")).sum(d).sqrt();throw new Error("Error in norm: invalid ord value: "+f)}if(Array.isArray(d)&&d.length===2){if(f===1)return c.abs().sum(d[0]).max(d[1]-1);if(f===1/0)return c.abs().sum(d[1]).max(d[0]);if(f===-1/0)return c.abs().sum(d[1]).min(d[0]);if(f==="fro"||f==="euclidean")return c.square().sum(d).sqrt();throw new Error("Error in norm: invalid ord value: "+f)}throw new Error("Error in norm: invalid axis: "+d)}(n=F(n,"x","norm"),t,e),i=a.shape;if(r){var u=Jt(e,n.shape);i=Un(a.shape,u)}return a.reshape(i)}}),bF=H({basicLSTMCell_:function(n,t,e,r,a,i){var u=F(n,"forgetBias","basicLSTMCell"),l=F(t,"lstmKernel","basicLSTMCell"),c=F(e,"lstmBias","basicLSTMCell"),f=F(r,"data","basicLSTMCell"),d=F(a,"c","basicLSTMCell"),v=F(i,"h","basicLSTMCell"),m=f.concat(v,1).matMul(l).add(c),g=m.shape[0],b=m.shape[1]/4,w=[g,b],S=m.slice([0,0],w),_=m.slice([0,b],w),E=m.slice([0,2*b],w),R=m.slice([0,3*b],w),C=S.sigmoid().mulStrict(_.tanh()).addStrict(d.mulStrict(u.add(E).sigmoid())),A=C.tanh().mulStrict(R.sigmoid());return[C,A]}}),xF=H({multiRNNCell_:function(n,t,e,r){for(var a=F(t,"data","multiRNNCell"),i=jf(e,"c","multiRNNCell"),u=jf(r,"h","multiRNNCell"),l=a,c=[],f=0;f<n.length;f++){var d=n[f](l,i[f],u[f]);c.push(d[0]),c.push(d[1]),l=d[1]}var v=[],m=[];for(f=0;f<c.length;f+=2)v.push(c[f]),m.push(c[f+1]);return[v,m]}}),wF=H({movingAverage_:function(n,t,e,r,a){a===void 0&&(a=!0);var i=F(n,"v","movingAverage"),u=F(t,"x","movingAverage"),l=F(e,"decay","movingAverage");yN(i,u),L(un(i.shape,u.shape),function(){return"Shape mismatch in v and x"});var c=ge(1),f=c.sub(l),d=u.sub(i).mul(f);if(a){L(r!=null,function(){return"When using zeroDebias: true, step is required."});var v=F(r,"step","movingAverage");d=d.div(c.sub(Jf(l,v)))}return i.add(d)}}),_F=H({stridedSlice_:function(n,t,e,r,a,i,u,l,c){if(a===void 0&&(a=0),i===void 0&&(i=0),u===void 0&&(u=0),l===void 0&&(l=0),c===void 0&&(c=0),r==null&&(r=new Array(t.length)),u!==0)throw new Error("ellipsis mask is not yet supported");var f=F(n,"x","stridedSlice"),d=Dw(l),v=f.shape.slice();d.forEach(function(S){t[S]=0,e[S]=1,v.splice(S,0,1)}),f=f.reshape(v);for(var m=0;m<f.rank;m++)t[m]=N3(a,t,r,f.shape,m),e[m]=M3(i,e,r,f.shape,m),r[m]=r[m]||1;var g=Dw(c);g.forEach(function(S){e[S]=t[S]+1,r[S]=1});var b=ag(t,e,r),w=b.filter(function(S,_){return g.indexOf(_)===-1});return r.every(function(S){return S===1})?ea(f,t,b).reshape(w):q.runKernelFunc(function(S){return S.stridedSlice(f,t,e,r)},{$x:f}).reshape(w)}}),SF=H({topk_:function(n,t,e){t===void 0&&(t=1),e===void 0&&(e=!0);var r=F(n,"x","topk");if(r.rank===0)throw new Error("topk() expects the input to be of rank 1 or higher");var a=r.shape[r.shape.length-1];if(t>a)throw new Error("'k' passed to topk() must be <= the last dimension ("+a+") but got "+t);var i=q.runKernelFunc(function(u){return u.topk(r,t,e)},{$x:r});return{values:i[0],indices:i[1]}}}),EF=H({scatterND_:function(n,t,e){var r=F(n,"indices","scatterND","int32"),a=F(t,"updates","scatterND");return k3(a,r,e),q.runKernelFunc(function(i){return i.scatterND(r,a,e)},{indices:r,updates:a},null,"ScatterNd",{shape:e})}}),gg=H({fft_:function(n){L(n.dtype==="complex64",function(){return"The dtype for tf.spectral.fft() must be complex64 but got "+n.dtype+"."});var t=n.shape[n.shape.length-1],e=n.size/t,r=n.as2D(e,t);return q.runKernelFunc(function(a){return a.fft(r)},{input:n}).reshape(n.shape)}}),eh=H({ifft_:function(n){L(n.dtype==="complex64",function(){return"The dtype for tf.spectral.ifft() must be complex64 but got "+n.dtype+"."});var t=n.shape[n.shape.length-1],e=n.size/t,r=n.as2D(e,t);return q.runKernelFunc(function(a){return a.ifft(r)},{input:n}).reshape(n.shape)}}),yg=H({rfft_:function(n,t){L(n.dtype==="float32",function(){return"The dtype for rfft() must be real value but got "+n.dtype});var e,r=n.shape[n.shape.length-1],a=n.size/r;if(t!=null&&t<r){var i=n.shape.map(function(_){return 0}),u=n.shape.map(function(_){return _});u[n.shape.length-1]=t,e=n.slice(i,u),r=t}else if(t!=null&&t>r){var l=n.shape.map(function(_){return _});l[n.shape.length-1]=t-r,e=n.concat(St(l),n.shape.length-1),r=t}else e=n;var c=e.zerosLike(),f=pn(e,c).as2D(a,r),d=gg(f),v=Math.floor(r/2)+1,m=mr(d),g=Kr(d),b=m.split([v,r-v],m.shape.length-1),w=g.split([v,r-v],g.shape.length-1),S=e.shape.slice();return S[e.shape.length-1]=v,pn(b[0],w[0]).reshape(S)}}),rE=H({irfft_:function(n){var t=n.shape[n.shape.length-1],e=n.size/t;if(t<=2){var r=n.as2D(e,t),a=eh(r);return mr(a)}var i=[e,2*(t-1)],u=mr(n).as2D(e,t),l=Kr(n).as2D(e,t),c=u.slice([0,1],[e,t-2]).reverse(1),f=l.slice([0,1],[e,t-2]).reverse(1).mul(ge(-1)),d=u.concat(c,1),v=l.concat(f,1);return r=pn(d,v).as2D(i[0],i[1]),a=eh(r),mr(a)}}),CF=Object.freeze({fft:gg,ifft:eh,rfft:yg,irfft:rE}),RF=H({sparseToDense_:function(n,t,e,r){r===void 0&&(r=0);var a=F(n,"sparseIndices","sparseToDense","int32"),i=F(t,"sparseValues","sparseToDense"),u=F(r,"defaultValue","sparseToDense",i.dtype);return function(l,c,f,d){if(l.dtype!=="int32")throw new Error("tf.sparseToDense() expects the indices to be int32 type, but the dtype was "+l.dtype+".");if(l.rank>2)throw new Error("sparseIndices should be a scalar, vector, or matrix, but got shape "+l.shape+".");var v=l.rank>0?l.shape[0]:1,m=l.rank>1?l.shape[1]:1;if(f.length!==m)throw new Error("outputShape has incorrect number of elements:, "+f.length+", should be: "+m+".");var g=c.size;if(c.rank!==0&&(c.rank!==1||g!==v))throw new Error("sparseValues has incorrect shape "+c.shape+", should be [] or ["+v+"]");if(c.dtype!==d.dtype)throw new Error("sparseValues.dtype must match defaultValues.dtype")}(a,i,e,u),q.runKernelFunc(function(l){return l.sparseToDense(a,i,e,u)},{$sparseIndices:a,$sparseValues:i,$defaultValue:u})}}),AF=H({gatherND_:function(n,t){var e=F(t,"indices","gatherND","int32"),r=F(n,"x","gatherND");return q.runKernelFunc(function(a){return a.gatherND(r,e)},{x:r,indices:e},null,"GatherNd")}}),TF=H({diag_:function(n){var t=F(n,"x","diag").flatten(),e=n.shape.concat(n.shape);return q.runKernelFunc(function(r){return r.diag(t)},{$x:t}).reshape(e)}}),DF=H({dropout_:function(n,t,e,r){var a=F(n,"x","dropout");if(L(a.dtype==="float32",function(){return"x has to be a floating point tensor since it's going to be scaled, but got a "+a.dtype+" tensor instead."}),L(t>=0&&t<1,function(){return"rate must be a float in the range [0, 1), but got "+t+"."}),t===0)return n instanceof Rt?a.clone():a;var i=function(c,f){if(f==null)return c.shape.slice();if(un(c.shape,f))return f;if(c.shape.length===f.length){for(var d=[],v=0;v<c.shape.length;v++)f[v]==null&&c.shape[v]!=null?d.push(c.shape[v]):d.push(f[v]);return d}return f}(a,e),u=1-t,l=eS(i,0,1,"float32",r).add(u).floor().div(u);return a.mul(l)}});function aE(n,t,e){for(var r=1-n%2,a=new Float32Array(n),i=0;i<n;++i){var u=2*Math.PI*i/(n+r-1);a[i]=t-e*Math.cos(u)}return Vt(a,"float32")}var bg=H({hannWindow_:function(n){return aE(n,.5,.5)}}),iE=H({hammingWindow_:function(n){return aE(n,.54,.46)}}),xg=H({frame_:function(n,t,e,r,a){r===void 0&&(r=!1),a===void 0&&(a=0);for(var i=0,u=[];i+t<=n.size;)u.push(ea(n,i,t)),i+=e;if(r)for(;i<n.size;){var l=i+t-n.size,c=$t([ea(n,i,t-l),Jr([l],a)]);u.push(c),i+=e}return u.length===0?_i([],[0,t]):$t(u).as2D(u.length,t)}}),oE=H({stft_:function(n,t,e,r,a){var i;a===void 0&&(a=bg),r==null&&(i=t,r=Math.floor(Math.pow(2,Math.ceil(Math.log(i)/Math.log(2)))));for(var u=xg(n,t,e),l=Cn(u,a(t)),c=[],f=0;f<u.shape[0];f++)c.push(yg(l.slice([f,0],[1,t]),r));return $t(c)}}),kF=Object.freeze({hannWindow:bg,hammingWindow:iE,frame:xg,stft:oE}),En,OF=function(n,t,e){return e===void 0&&(e=1),_e(this,void 0,void 0,function(){var r,a,i,u,l,c,f,d,v,m,g,b,w,S;return Se(this,function(_){switch(_.label){case 0:return r=F(n,"predictions","inTopK"),a=F(t,"targets","inTopK"),L(r.rank>1,function(){return"inTopK() expects the predictions to be of rank 2 or higher, but got "+r.rank}),L(r.rank-1===a.rank,function(){return"predictions rank should be 1 larger than targets rank, but got predictions rank "+r.rank+" and targets rank "+a.rank}),ft(r.shape.slice(0,r.shape.length-1),a.shape,"predictions's shape should be align with the targets' shape, except the last dimension."),i=r.shape[r.shape.length-1],L(e>0&&e<=i,function(){return"'k' passed to inTopK() must be > 0 && <= the predictions last dimension ("+i+"), but got "+e}),[4,r.data()];case 1:return u=_.sent(),[4,a.data()];case 2:for(l=_.sent(),c=[u.length/i,i],d=c[1],v=cl("bool",f=c[0]),m=0;m<f;m++){for(g=m*d,b=u.subarray(g,g+d),w=[],S=0;S<b.length;S++)w.push({value:b[S],index:S});for(w.sort(function(E,R){return R.value-E.value}),v[m]=0,S=0;S<e;S++)if(w[S].index===l[m]){v[m]=1;break}}return n!==r&&r.dispose(),t!==a&&a.dispose(),[2,mn(v,a.shape,"bool")]}})})};(function(n){n[n.NONE=0]="NONE",n[n.MEAN=1]="MEAN",n[n.SUM=2]="SUM",n[n.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"})(En||(En={}));var NF=H({absoluteDifference_:function(n,t,e,r){r===void 0&&(r=En.SUM_BY_NONZERO_WEIGHTS);var a=F(n,"labels","absoluteDifference"),i=F(t,"predictions","absoluteDifference"),u=null;e!=null&&(u=F(e,"weights","absoluteDifference")),ft(a.shape,i.shape,"Error in absoluteDifference: ");var l=a.sub(i).abs();return Ia(l,u,r)}}),Ia=H({computeWeightedLoss_:function(n,t,e){e===void 0&&(e=En.SUM_BY_NONZERO_WEIGHTS);var r=F(n,"losses","computeWeightedLoss"),a=null;t!=null&&(a=F(t,"weights","computeWeightedLoss"));var i=a==null?r:r.mul(a);if(e===En.NONE)return i;if(e===En.SUM)return i.sum();if(e===En.MEAN){if(a==null)return i.mean();var u=r.size/a.size,l=i.sum().div(a.sum());return u>1?l.div(ge(u)):l}if(e===En.SUM_BY_NONZERO_WEIGHTS){if(a==null)return i.sum().div(ge(r.size));var c=a.mul(Hs(r.shape)).notEqual(ge(0)).sum().toFloat();return i.sum().div(c)}throw Error("Unknown reduction: "+e)}}),MF=H({cosineDistance_:function(n,t,e,r,a){a===void 0&&(a=En.SUM_BY_NONZERO_WEIGHTS);var i=F(n,"labels","cosineDistance"),u=F(t,"predictions","cosineDistance"),l=null;r!=null&&(l=F(r,"weights","cosineDistance")),ft(i.shape,u.shape,"Error in cosineDistance: ");var c=ge(1).sub(i.mul(u).sum(e,!0));return Ia(c,l,a)}}),IF=H({hingeLoss_:function(n,t,e,r){r===void 0&&(r=En.SUM_BY_NONZERO_WEIGHTS);var a=F(n,"labels","hingeLoss"),i=F(t,"predictions","hingeLoss"),u=null;e!=null&&(u=F(e,"weights","hingeLoss")),ft(a.shape,i.shape,"Error in hingeLoss: ");var l=ge(1);a=ge(2).mul(a).sub(l);var c=l.sub(a.mul(i)).relu();return Ia(c,u,r)}}),FF=H({huberLoss_:function(n,t,e,r,a){r===void 0&&(r=1),a===void 0&&(a=En.SUM_BY_NONZERO_WEIGHTS);var i=F(n,"labels","huberLoss"),u=F(t,"predictions","huberLoss"),l=null;e!=null&&(l=F(e,"weights","huberLoss")),ft(i.shape,u.shape,"Error in huberLoss: ");var c=ge(r),f=u.sub(i).abs(),d=zS(f,c),v=f.sub(d),m=ge(.5).mul(d.square()).add(c.mul(v));return Ia(m,l,a)}}),BF=H({logLoss_:function(n,t,e,r,a){r===void 0&&(r=1e-7),a===void 0&&(a=En.SUM_BY_NONZERO_WEIGHTS);var i=F(n,"labels","logLoss"),u=F(t,"predictions","logLoss"),l=null;e!=null&&(l=F(e,"weights","logLoss")),ft(i.shape,u.shape,"Error in logLoss: ");var c=ge(1),f=ge(r),d=i.mul(u.add(f).log()).neg().sub(c.sub(i).mul(c.sub(u).add(f).log()));return Ia(d,l,a)}}),LF=H({meanSquaredError_:function(n,t,e,r){r===void 0&&(r=En.SUM_BY_NONZERO_WEIGHTS);var a=F(n,"labels","meanSquaredError"),i=F(t,"predictions","meanSquaredError"),u=null;e!=null&&(u=F(e,"weights","meanSquaredError")),ft(a.shape,i.shape,"Error in meanSquaredError: ");var l=a.squaredDifference(i);return Ia(l,u,r)}}),PF=H({sigmoidCrossEntropy_:function(n,t,e,r,a){r===void 0&&(r=0),a===void 0&&(a=En.SUM_BY_NONZERO_WEIGHTS);var i=F(n,"multiClassLabels","sigmoidCrossEntropy"),u=F(t,"logits","sigmoidCrossEntropy"),l=null;if(e!=null&&(l=F(e,"weights","sigmoidCrossEntropy")),ft(i.shape,u.shape,"Error in sigmoidCrossEntropy: "),r>0){var c=ge(r),f=ge(1),d=ge(.5);i=i.mul(f.sub(c)).add(d.mul(c))}var v=function(m,g){var b=F(m,"labels","sigmoidCrossEntropyWithLogits"),w=F(g,"logits","sigmoidCrossEntropyWithLogits");ft(b.shape,w.shape,"Error in sigmoidCrossEntropyWithLogits: ");var S=w.relu(),_=w.mul(b),E=w.abs().neg().exp().log1p();return S.sub(_).add(E)}(i,u);return Ia(v,l,a)}}),zF=H({softmaxCrossEntropy_:function(n,t,e,r,a){r===void 0&&(r=0),a===void 0&&(a=En.SUM_BY_NONZERO_WEIGHTS);var i=F(n,"onehotLabels","softmaxCrossEntropy"),u=F(t,"logits","softmaxCrossEntropy"),l=null;if(e!=null&&(l=F(e,"weights","softmaxCrossEntropy")),ft(i.shape,u.shape,"Error in softmaxCrossEntropy: "),r>0){var c=ge(r),f=ge(1),d=ge(i.shape[1]);i=i.mul(f.sub(c)).add(c.div(d))}var v=function(m,g,b){if(b===void 0&&(b=-1),b===-1&&(b=g.rank-1),b!==g.rank-1)throw Error("Softmax cross entropy along a non-last dimension is not yet supported. Labels / logits was rank "+g.rank+" and dim was "+b);return mh(function(w,S,_){var E=S.logSumExp([b],!0),R=S.toFloat().sub(E);return _([w,R]),{value:R.mul(w).neg().sum([b]),gradFunc:function(C,A){var D=A[0],k=A[1],I=Un(C.shape,[b]);return[C.reshape(I).mul(D.toFloat().sub(k.exp())),C.reshape(I).mul(k.exp().sub(D.toFloat()))]}}})(m,g)}(i,u);return Ia(v,l,a)}}),UF=Object.freeze({get Reduction(){return En},absoluteDifference:NF,computeWeightedLoss:Ia,cosineDistance:MF,hingeLoss:IF,huberLoss:FF,logLoss:BF,meanSquaredError:LF,sigmoidCrossEntropy:PF,softmaxCrossEntropy:zF});function Qw(n,t){return t===void 0&&(t=!1),q.tidy(function(){if(n.shape.length!==2)throw new Error("qr2d() requires a 2D Tensor, but got a "+n.shape.length+"D Tensor.");for(var e=n.shape[0],r=n.shape[1],a=J_(e),i=n.clone(),u=_i([[1]],[1,1]),l=u.clone(),c=e>=r?r:e,f=function(v){var m,g=i,b=l,w=a;m=q.tidy(function(){var S=i.slice([v,v],[e-v,1]),_=S.norm(),E=i.slice([v,v],[1,1]),R=_i([[-1]]).where(E.greater(0),_i([[1]])),C=E.sub(R.mul(_)),A=S.div(C);l=A.shape[0]===1?u.clone():u.concat(A.slice([1,0],[A.shape[0]-1,A.shape[1]]),0);var D=R.matMul(C).div(_).neg(),k=i.slice([v,0],[e-v,r]),I=D.mul(l);if(v===0)i=k.sub(I.matMul(l.transpose().matMul(k)));else{var N=k.sub(I.matMul(l.transpose().matMul(k)));i=i.slice([0,0],[v,r]).concat(N,0)}var B=a.slice([0,v],[e,a.shape[1]-v]);if(v===0)a=B.sub(B.matMul(l).matMul(I.transpose()));else{var V=B.sub(B.matMul(l).matMul(I.transpose()));a=a.slice([0,0],[e,v]).concat(V,1)}return[l,i,a]}),l=m[0],i=m[1],a=m[2],zn([g,b,w])},d=0;d<c;++d)f(d);return!t&&e>r&&(a=a.slice([0,0],[e,r]),i=i.slice([0,0],[r,r])),[a,i]})}var VF=H({bandPart_:function(n,t,e){if(t%1!=0)throw new Error("bandPart(): numLower must be an integer, got "+t+".");if(e%1!=0)throw new Error("bandPart(): numUpper must be an integer, got "+e+".");var r=F(n,"a","bandPart");if(r.rank<2)throw new Error("bandPart(): Rank must be at least 2, got "+r.rank+".");var a=r.shape,i=r.shape.slice(-2),u=i[0],l=i[1];if(!(t<=u))throw new Error("bandPart(): numLower ("+t+") must not be greater than the number of rows ("+u+").");if(!(e<=l))throw new Error("bandPart(): numUpper ("+e+") must not be greater than the number of columns ("+l+").");t<0&&(t=u),e<0&&(e=l);var c=Wf(0,u,1,"int32").reshape([-1,1]),f=Wf(0,l,1,"int32"),d=Zt(c,f),v=yh(d.lessEqual(ge(+t,"int32")),d.greaterEqual(ge(-e,"int32"))),m=St([u,l],r.dtype);return tr(Yt(r.reshape([-1,u,l])).map(function(g){return fo(v,g,m)})).reshape(a)}}),HF=H({gramSchmidt_:function(n){var t;if(Array.isArray(n)){t=!1,L(n!=null&&n.length>0,function(){return"Gram-Schmidt process: input must not be null, undefined, or empty"});for(var e=n[0].shape[0],r=function(c){L(n[c].shape[0]===e,function(){return"Gram-Schmidt: Non-unique lengths found in the input vectors: ("+n[c].shape[0]+" vs. "+e+")"})},a=1;a<n.length;++a)r(a)}else t=!0,n=ng(n,n.shape[0],0).map(function(c){return nS(c,[0])});L(n.length<=n[0].shape[0],function(){return"Gram-Schmidt: Number of vectors ("+n.length+") exceeds number of dimensions ("+n[0].shape[0]+")."});var i=[],u=n,l=function(c){i.push(q.tidy(function(){var f=u[c];if(c>0)for(var d=0;d<c;++d){var v=ZS(i[d].mulStrict(f)).mul(i[d]);f=f.sub(v)}return f.div(nE(f,"euclidean"))}))};for(a=0;a<n.length;++a)l(a);return t?tr(i,0):i}}),jF=H({qr_:function(n,t){if(t===void 0&&(t=!1),n.rank<2)throw new Error("qr() requires input tensor to have a rank >= 2, but got rank "+n.rank);if(n.rank===2)return Qw(n,t);var e=n.shape.slice(0,n.shape.length-2).reduce(function(u,l){return u*l}),r=Yt(n.reshape([e,n.shape[n.shape.length-2],n.shape[n.shape.length-1]]),0),a=[],i=[];return r.forEach(function(u){var l=Qw(u,t),c=l[0],f=l[1];a.push(c),i.push(f)}),[tr(a,0).reshape(n.shape),tr(i,0).reshape(n.shape)]}}),WF=Object.freeze({bandPart:VF,gramSchmidt:HF,qr:jF});function _h(n,t,e,r,a,i){r==null&&(r=.5),a==null&&(a=Number.NEGATIVE_INFINITY),i==null&&(i=0);var u=n.shape[0];return e=Math.min(e,u),L(0<=r&&r<=1,function(){return"iouThreshold must be in [0, 1], but was '"+r+"'"}),L(n.rank===2,function(){return"boxes must be a 2D tensor, but was of rank '"+n.rank+"'"}),L(n.shape[1]===4,function(){return"boxes must have 4 columns, but 2nd dimension was "+n.shape[1]}),L(t.rank===1,function(){return"scores must be a 1D tensor"}),L(t.shape[0]===u,function(){return"scores has incompatible shape with boxes. Expected "+u+", but was "+t.shape[0]}),L(0<=i&&i<=1,function(){return"softNmsSigma must be in [0, 1], but was '"+i+"'"}),{maxOutputSize:e,iouThreshold:r,scoreThreshold:a,softNmsSigma:i}}var GF=H({resizeBilinear_:function(n,t,e){e===void 0&&(e=!1);var r=F(n,"images","resizeBilinear");L(r.rank===3||r.rank===4,function(){return"Error in resizeBilinear: x must be rank 3 or 4, but got rank "+r.rank+"."}),L(t.length===2,function(){return"Error in resizeBilinear: new shape must 2D, but got shape "+t+"."});var a=r,i=!1;r.rank===3&&(i=!0,a=r.as4D(1,r.shape[0],r.shape[1],r.shape[2]));var u=t[0],l=t[1],c=q.runKernelFunc(function(f,d){return d([a]),f.resizeBilinear(a,u,l,e)},{x:a},function(f,d){return{x:function(){return q.runKernelFunc(function(v){return v.resizeBilinearBackprop(f,d[0],e)},{})}}},"ResizeBilinear",{alignCorners:e,newHeight:u,newWidth:l});return i?c.as3D(c.shape[1],c.shape[2],c.shape[3]):c}}),qF=H({resizeNearestNeighbor_:function(n,t,e){e===void 0&&(e=!1);var r=F(n,"images","resizeNearestNeighbor");L(r.rank===3||r.rank===4,function(){return"Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank "+r.rank+"."}),L(t.length===2,function(){return"Error in resizeNearestNeighbor: new shape must 2D, but got shape "+t+"."}),L(r.dtype==="float32"||r.dtype==="int32",function(){return"`images` must have `int32` or `float32` as dtype"});var a=r,i=!1;r.rank===3&&(i=!0,a=r.as4D(1,r.shape[0],r.shape[1],r.shape[2]));var u=t[0],l=t[1],c=q.runKernelFunc(function(f,d){return d([a]),f.resizeNearestNeighbor(a,u,l,e)},{batchImages:a},function(f,d){return{batchImages:function(){return q.runKernelFunc(function(v){return v.resizeNearestNeighborBackprop(f,d[0],e)},{})}}});return i?c.as3D(c.shape[1],c.shape[2],c.shape[3]):c}}),KF=H({nonMaxSuppression_:function(n,t,e,r,a){r===void 0&&(r=.5),a===void 0&&(a=Number.NEGATIVE_INFINITY);var i=F(n,"boxes","nonMaxSuppression"),u=F(t,"scores","nonMaxSuppression"),l=_h(i,u,e,r,a);e=l.maxOutputSize,r=l.iouThreshold,a=l.scoreThreshold;var c={maxOutputSize:e,iouThreshold:r,scoreThreshold:a};return q.runKernelFunc(function(f){return f.nonMaxSuppression(i,u,e,r,a)},{boxes:i,scores:u},null,"NonMaxSuppressionV3",c)}}),XF=function(n,t,e,r,a){return r===void 0&&(r=.5),a===void 0&&(a=Number.NEGATIVE_INFINITY),_e(this,void 0,void 0,function(){var i,u,l,c,f,d,v;return Se(this,function(m){switch(m.label){case 0:return i=F(n,"boxes","nonMaxSuppressionAsync"),u=F(t,"scores","nonMaxSuppressionAsync"),l=_h(i,u,e,r,a),e=l.maxOutputSize,r=l.iouThreshold,a=l.scoreThreshold,[4,Promise.all([i.data(),u.data()])];case 1:return c=m.sent(),f=c[0],d=c[1],v=og(f,d,e,r,a),i!==n&&i.dispose(),u!==t&&u.dispose(),[2,v]}})})},$F=H({nonMaxSuppressionWithScore_:function(n,t,e,r,a,i){r===void 0&&(r=.5),a===void 0&&(a=Number.NEGATIVE_INFINITY),i===void 0&&(i=0);var u=F(n,"boxes","nonMaxSuppression"),l=F(t,"scores","nonMaxSuppression"),c=_h(u,l,e,r,a,i),f={maxOutputSize:e=c.maxOutputSize,iouThreshold:r=c.iouThreshold,scoreThreshold:a=c.scoreThreshold,softNmsSigma:i=c.softNmsSigma},d=q.runKernel("NonMaxSuppressionV5",{boxes:u,scores:l},f);return{selectedIndices:d[0],selectedScores:d[1]}}}),YF=function(n,t,e,r,a,i){return r===void 0&&(r=.5),a===void 0&&(a=Number.NEGATIVE_INFINITY),i===void 0&&(i=0),_e(this,void 0,void 0,function(){var u,l,c,f,d,v,m;return Se(this,function(g){switch(g.label){case 0:return u=F(n,"boxes","nonMaxSuppressionAsync"),l=F(t,"scores","nonMaxSuppressionAsync"),c=_h(u,l,e,r,a,i),e=c.maxOutputSize,r=c.iouThreshold,a=c.scoreThreshold,i=c.softNmsSigma,[4,Promise.all([u.data(),l.data()])];case 1:return f=g.sent(),d=f[0],v=f[1],m=sg(d,v,e,r,a,i),u!==n&&u.dispose(),l!==t&&l.dispose(),[2,m]}})})},QF=H({cropAndResize_:function(n,t,e,r,a,i){var u=F(n,"image","cropAndResize"),l=F(t,"boxes","cropAndResize","float32"),c=F(e,"boxInd","cropAndResize","int32");a=a||"bilinear",i=i||0;var f=l.shape[0];return L(u.rank===4,function(){return"Error in cropAndResize: image must be rank 4,but got rank "+u.rank+"."}),L(l.rank===2&&l.shape[1]===4,function(){return"Error in cropAndResize: boxes must be have size ["+f+",4] but had shape "+l.shape+"."}),L(c.rank===1&&c.shape[0]===f,function(){return"Error in cropAndResize: boxInd must be have size ["+f+"] but had shape "+l.shape+"."}),L(r.length===2,function(){return"Error in cropAndResize: cropSize must be of length 2, but got length "+r.length+"."}),L(r[0]>=1&&r[1]>=1,function(){return"cropSize must be atleast [1,1], but was "+r}),L(a==="bilinear"||a==="nearest",function(){return"method must be bilinear or nearest, but was "+a}),q.runKernelFunc(function(d,v){return d.cropAndResize(u,l,c,r,a,i)},{images:u,boxes:l,boxInd:c},null,"CropAndResize",{method:a,extrapolationValue:i,cropSize:r})}}),wg=Object.freeze({resizeBilinear:GF,resizeNearestNeighbor:qF,nonMaxSuppression:KF,nonMaxSuppressionAsync:XF,nonMaxSuppressionWithScore:$F,nonMaxSuppressionWithScoreAsync:YF,cropAndResize:QF}),_g=function(n,t){return!(n>0)||t==="linear"},Sg=function(n,t,e){if(e==null||e==="linear")return n;if(e==="relu")return n.mul(t.step());throw new Error("Gradient for activation "+e+" has not been implemented yet.")},Eg=function(n,t){var e=t,r=Qt(n.shape,t.shape);return r.length>0&&(e=e.sum(r)),e.reshape(n.shape)},Cg=function(n,t,e){if(t==="linear")return n;if(t==="relu")return At(n);if(t==="elu")return JS(n);if(t==="relu6")return tE(n);if(t==="prelu")return eE(n,e);throw new Error("Unknown fused activation "+t+".")},ZF=H({fusedMatMul_:function(n){var t,e=n.a,r=n.b,a=n.transposeA,i=a!==void 0&&a,u=n.transposeB,l=u!==void 0&&u,c=n.bias,f=n.activation,d=f===void 0?"linear":f,v=n.preluActivationWeights;if(_g(q.state.gradientDepth,d)===!1){var m=xh(e,r,i,l);return c!=null&&(m=Ye(m,c)),Cg(m,d,v)}var g=F(e,"a","fused matMul"),b=F(r,"b","fused matMul");t=Dt(g,b),g=t[0],b=t[1];var w=i?g.shape[g.rank-2]:g.shape[g.rank-1],S=l?b.shape[b.rank-1]:b.shape[b.rank-2],_=i?g.shape[g.rank-1]:g.shape[g.rank-2],E=l?b.shape[b.rank-2]:b.shape[b.rank-1],R=g.shape.slice(0,-2),C=b.shape.slice(0,-2),A=Ce(R),D=Ce(C);L(g.rank>=2&&b.rank>=2&&g.rank===b.rank,function(){return"Error in fused matMul: inputs must have the same rank of at least 2, got ranks "+g.rank+" and "+b.rank+"."}),L(un(R,C),function(){return"Error in fused matMul: outer dimensions ("+R+") and ("+C+") of Tensors with shapes "+g.shape+" and "+b.shape+" must match."}),L(w===S,function(){return"Error in fused matMul: inner shapes ("+w+") and ("+S+") of Tensors with shapes "+g.shape+" and "+b.shape+" and transposeA="+i+" and transposeB="+l+" must match."});var k,I,N=g.shape.slice(0,-2).concat([_,E]),B=i?g.as3D(A,w,_):g.as3D(A,_,w),V=l?b.as3D(D,E,S):b.as3D(D,S,E);c!=null&&et(N,(k=Dt(k=F(c,"bias","fused matMul"),g)[0]).shape),v!=null&&(I=F(v,"prelu weights","fused matMul"));var U={a:B,b:V};c!=null&&(U.bias=k),v!=null&&(U.preluActivationWeights=I);var J=[B,V];return q.runKernelFunc(function(ee,te){var P=ee.fusedBatchMatMul({a:B,b:V,transposeA:i,transposeB:l,bias:k,activation:d,preluActivationWeights:I});return te([B,V,P]),P},U,function(ee,te){var P=te[0],j=te[1],K=te[2],ne=Sg(ee,K,d),M={};return c!=null&&(M={bias:function(){return Eg(k,ne)}}),Object.assign(i||l?!i&&l?{a:function(){return ne.matMul(j,!1,!1)},b:function(){return ne.matMul(P,!0,!1)}}:i&&!l?{a:function(){return j.matMul(ne,!1,!0)},b:function(){return P.matMul(ne,!1,!1)}}:{a:function(){return j.matMul(ne,!0,!0)},b:function(){return ne.matMul(P,!0,!0)}}:{a:function(){return ne.matMul(j,!1,!0)},b:function(){return P.matMul(ne,!0,!1)}},M)},"_FusedMatMul",{transposeA:i,transposeB:l,activation:d},J,[!0]).reshape(N)}}),JF=H({fusedConv2d_:function(n){var t=n.x,e=n.filter,r=n.strides,a=n.pad,i=n.dataFormat,u=i===void 0?"NHWC":i,l=n.dilations,c=l===void 0?[1,1]:l,f=n.dimRoundingMode,d=n.bias,v=n.activation,m=v===void 0?"linear":v,g=n.preluActivationWeights;if(m=m||"linear",_g(q.state.gradientDepth,m)===!1){var b=wr(t,e,r,a,u,c,f);return d!=null&&(b=Ye(b,d)),Cg(b,m,g)}var w=F(t,"x","conv2d"),S=F(e,"filter","conv2d"),_=w,E=!1;w.rank===3&&(E=!0,_=w.as4D(1,w.shape[0],w.shape[1],w.shape[2])),L(_.rank===4,function(){return"Error in fused conv2d: input must be rank 4, but got rank "+_.rank+"."}),L(S.rank===4,function(){return"Error in fused conv2d: filter must be rank 4, but got rank "+S.rank+"."}),f!=null&&L(Bt(a),function(){return"Error in fused conv2d: pad must be an integer when using, dimRoundingMode "+f+" but got pad "+a+"."}),L(_.shape[3]===S.shape[2],function(){return"Error in conv2d: depth of input ("+_.shape[3]+") must match input depth for filter "+S.shape[2]+"."}),L(Vn(r,c),function(){return"Error in conv2D: Either strides or dilations must be 1. Got strides "+r+" and dilations '"+c+"'"}),L(u==="NHWC",function(){return"Error in conv2d: got dataFormat of "+u+" but only NHWC is currently supported."});var R,C,A=vo(_.shape,S.shape,r,c,a,f);d!=null&&(R=Dt(R=F(d,"bias","fused conv2d"),w)[0],et(A.outShape,R.shape)),g!=null&&(C=F(g,"prelu weights","fused conv2d"));var D={x:_,filter:S};d!=null&&(D.bias=R),g!=null&&(D.preluActivationWeights=C);var k=[S,_],I=q.runKernelFunc(function(N,B){var V=N.fusedConv2d({input:_,filter:S,convInfo:A,bias:R,activation:m,preluActivationWeights:C});return B([S,_,V]),V},D,function(N,B){var V=B,U=V[0],J=V[1],ee=V[2],te=Sg(N,ee,m);L(Bs(c),function(){return"Error in gradient of fused conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+c+"'"});var P={};return d!=null&&(P={bias:function(){return Eg(R,te)}}),Object.assign({x:function(){return GS(J.shape,te,U,r,a)},filter:function(){return vg(J,te,U.shape,r,a)}},P)},"FusedConv2D",{convInfo:A,activation:m},k,[!0]);return E?I.as3D(I.shape[1],I.shape[2],I.shape[3]):I}}),eB=H({fusedDepthwiseConv2d_:function(n){var t=n.x,e=n.filter,r=n.strides,a=n.pad,i=n.dataFormat,u=i===void 0?"NHWC":i,l=n.dilations,c=l===void 0?[1,1]:l,f=n.dimRoundingMode,d=n.bias,v=n.activation,m=v===void 0?"linear":v,g=n.preluActivationWeights;if(_g(q.state.gradientDepth,m)===!1){var b=bh(t,e,r,a,u,c,f);return d!=null&&(b=Ye(b,d)),Cg(b,m,g)}var w=F(t,"x","depthwiseConv2d"),S=F(e,"filter","depthwiseConv2d"),_=w,E=!1;w.rank===3&&(E=!0,_=w.as4D(1,w.shape[0],w.shape[1],w.shape[2])),L(_.rank===4,function(){return"Error in fused depthwiseConv2d: input must be rank 4, but got rank "+_.rank+"."}),L(S.rank===4,function(){return"Error in fused depthwiseConv2d: filter must be rank 4, but got rank "+S.rank+"."}),L(_.shape[3]===S.shape[2],function(){return"Error in fused depthwiseConv2d: number of input channels ("+_.shape[3]+") must match the inChannels dimension in filter "+S.shape[2]+"."}),c==null&&(c=[1,1]),L(Vn(r,c),function(){return"Error in fused depthwiseConv2d: Either strides or dilations must be 1. Got strides "+r+" and dilations '"+c+"'"}),f!=null&&L(Bt(a),function(){return"Error in fused depthwiseConv2d: pad must be an integer when using dimRoundingMode "+f+" but got pad "+a+"."});var R,C,A=vo(_.shape,S.shape,r,c,a,f,!0);d!=null&&(R=Dt(R=F(d,"bias","fused conv2d"),w)[0],et(A.outShape,R.shape)),g!=null&&(C=F(g,"prelu weights","fused depthwiseConv2d"));var D={x:_,filter:S};d!=null&&(D.bias=R),g!=null&&(D.preluActivationWeights=C);var k=[S,_],I=q.runKernelFunc(function(N,B){var V=N.fusedDepthwiseConv2D({input:_,filter:S,convInfo:A,bias:R,activation:m,preluActivationWeights:C});return B([S,_,V]),V},D,function(N,B){L(Bs(c),function(){return"Error in gradient of fused depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '"+c+"'"});var V=B[0],U=B[1],J=B[2],ee=Sg(N,J,m),te={};return d!=null&&(te={bias:function(){return Eg(R,ee)}}),Object.assign({x:function(){return qS(U.shape,ee,V,A)},filter:function(){return KS(U,ee,V.shape,A)}},te)},"FusedDepthwiseConv2D",{convInfo:A,activation:m},k,[!0]);return E?I.as3D(I.shape[1],I.shape[2],I.shape[3]):I}}),tB=Object.freeze({matMul:ZF,conv2d:JF,depthwiseConv2d:eB}),nB=Object.freeze({image:wg,linalg:WF,losses:UF,spectral:CF,fused:tB,signal:kF,square:BM,squaredDifference:DS,conv1d:GI,conv2d:wr,conv3d:qI,depthwiseConv2d:bh,separableConv2d:mg,conv2dTranspose:KI,conv3dTranspose:XI,op:H,batchNormalization2d:hI,batchNormalization3d:dI,batchNormalization4d:pI,batchNormalization:vI,batchNorm:FS,batchNorm2d:mI,batchNorm3d:gI,batchNorm4d:yI,booleanMaskAsync:WI,complex:pn,real:mr,imag:Kr,concat:$t,concat1d:t3,concat2d:n3,concat3d:r3,concat4d:a3,split:ng,matMul:xh,dot:$I,outerProduct:YI,reverse:Tl,reverse1d:QI,reverse2d:ZI,reverse3d:JI,reverse4d:eF,maxPool:an,avgPool:Dl,pool:tF,maxPool3d:nF,avgPool3d:rF,slice:ea,slice1d:aF,slice2d:iF,slice3d:YS,slice4d:oF,abs:LM,acos:PM,acosh:zM,asin:UM,asinh:VM,atan:HM,atanh:jM,ceil:WM,clipByValue:hg,cos:GM,cosh:qM,erf:KM,exp:Cm,expm1:XM,floor:$M,log:YM,log1p:QM,logSigmoid:ZM,neg:Zf,reciprocal:JM,round:eI,rsqrt:kS,sigmoid:OS,sign:tI,isNaN:nI,isInf:rI,isFinite:aI,sin:iI,sinh:oI,softplus:sI,sqrt:uI,step:lI,tan:cI,tanh:fI,all:sF,any:uF,argMax:lF,argMin:cF,logSumExp:fF,max:wh,mean:hF,min:dF,moments:pF,sum:ZS,prod:vF,equal:US,equalStrict:II,greater:FI,greaterEqual:VS,greaterEqualStrict:BI,greaterStrict:LI,less:PI,lessEqual:zI,lessEqualStrict:UI,lessStrict:VI,notEqual:HI,notEqualStrict:jI,add:Ye,addN:wI,addStrict:_I,atan2:SI,div:Tr,divNoNan:EI,divStrict:CI,floorDiv:PS,maximum:dg,maximumStrict:RI,minimum:zS,minimumStrict:AI,mod:TI,modStrict:DI,mul:Cn,mulStrict:kI,pow:Jf,powStrict:OI,squaredDifferenceStrict:NI,sub:Zt,subStrict:MI,elu:JS,leakyRelu:mF,prelu:eE,relu:At,relu6:tE,selu:gF,logicalAnd:yh,logicalNot:bI,logicalOr:BS,logicalXor:xI,where:fo,whereAsync:LS,buffer:Ue,print:d3,batchToSpaceND:Z_,broadcastTo:p3,cast:v3,clone:m3,cumsum:g3,depthToSpace:y3,expandDims:vr,eye:J_,multinomial:b3,oneHot:wm,pad:po,pad1d:x3,pad2d:w3,pad3d:_3,pad4d:S3,rand:E3,randomNormal:C3,randomGamma:R3,randomUniform:eS,reshape:Dr,spaceToBatchND:tS,squeeze:nS,stack:tr,tile:gs,truncatedNormal:A3,unstack:Yt,setdiff1dAsync:T3,fill:Jr,linspace:e3,ones:Hs,range:Wf,scalar:ge,tensor:mn,tensor1d:Vt,tensor2d:_i,tensor3d:tg,tensor4d:Bn,tensor5d:QN,tensor6d:ZN,variable:JN,zeros:St,onesLike:Q_,zerosLike:nt,transpose:Ti,softmax:Ma,logSoftmax:F3,localResponseNormalization:yF,norm:nE,gather:pg,unsortedSegmentSum:HS,basicLSTMCell:bF,multiRNNCell:xF,movingAverage:wF,stridedSlice:_F,topk:SF,scatterND:EF,fft:gg,ifft:eh,rfft:yg,irfft:rE,sparseToDense:RF,gatherND:AF,diag:TF,dropout:DF,hannWindow:bg,hammingWindow:iE,frame:xg,stft:oE,inTopKAsync:OF});function he(n,t){Array.isArray(n)||(n=[n]),n.forEach(function(e){e!=null&&L(e.dtype!=="complex64",function(){return t+" does not support complex64 tensors."})})}function Tv(n,t,e,r){if(e==="linear")return n.linear(t);if(e==="relu")return n.relu(t);if(e==="elu")return n.elu(t);if(e==="relu6")return n.relu6(t);if(e==="prelu")return n.prelu(t,r);throw new Error("Activation "+e+" has not been implemented for the CPU backend.")}var rB=function(n){function t(){var e=n.call(this)||this;return e.blockSize=48,e.firstUse=!0,e.data=new lS(e,q),e}return Mr(t,n),t.prototype.write=function(e,r,a){this.firstUse&&(this.firstUse=!1,ue().get("IS_NODE")&&Hf(`
============================
Hi there . Looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, which binds to TensorFlow C++, by running npm i @tensorflow/tfjs-node, or npm i @tensorflow/tfjs-node-gpu if you have CUDA. Then call require('@tensorflow/tfjs-node'); (-gpu suffix for CUDA) at the start of your program. Visit https://github.com/tensorflow/tfjs-node for more details.
============================`));var i={};return this.data.set(i,{values:e,dtype:a}),i},t.prototype.move=function(e,r,a,i){this.data.set(e,{values:r,dtype:i})},t.prototype.numDataIds=function(){return this.data.numDataIds()},t.prototype.read=function(e){return _e(this,void 0,void 0,function(){return Se(this,function(r){return[2,this.readSync(e)]})})},t.prototype.readSync=function(e){var r=this.data.get(e),a=r.dtype,i=r.complexTensors;return a==="complex64"?Em(this.readSync(i.real.dataId),this.readSync(i.imag.dataId)):this.data.get(e).values},t.prototype.bufferSync=function(e){var r=this.readSync(e.dataId),a=r;if(e.dtype==="string")try{a=r.map(function(i){return zf(i)})}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return Ue(e.shape,e.dtype,a)},t.prototype.makeOutput=function(e,r,a){var i=this.write(e,r,a);return q.makeTensorFromDataId(i,r,a,this)},t.prototype.disposeData=function(e){if(this.data.has(e)){var r=this.data.get(e).complexTensors;r!=null&&(r.real.dispose(),r.imag.dispose()),this.data.delete(e)}},t.prototype.time=function(e){return _e(this,void 0,void 0,function(){var r;return Se(this,function(a){return r=Gr(),e(),[2,{kernelMs:Gr()-r}]})})},t.prototype.memory=function(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}},t.prototype.complex=function(e,r){var a=this.makeOutput(null,e.shape,"complex64");return this.data.get(a.dataId).complexTensors={real:q.keep(e.clone()),imag:q.keep(r.clone())},a},t.prototype.real=function(e){return this.data.get(e.dataId).complexTensors.real.clone()},t.prototype.imag=function(e){return this.data.get(e.dataId).complexTensors.imag.clone()},t.prototype.slice=function(e,r,a){if(he(e,"slice"),sS(e.shape,r,a)){var i=uS(r,e.strides),u=Ce(a);return mn(this.readSync(e.dataId).subarray(i,i+u),a,e.dtype)}for(var l=Ue(a,e.dtype),c=this.bufferSync(e),f=0;f<l.size;++f){var d=l.indexToLoc(f).map(function(v,m){return v+r[m]});l.values[f]=c.get.apply(c,d)}return l.toTensor()},t.prototype.stridedSlice=function(e,r,a,i){he(e,"stridedSlice");var u=ag(r,a,i);if(u.some(function(g){return g===0}))return mn([],u);for(var l=Ue(u,e.dtype),c=this.bufferSync(e),f=0;f<l.size;f++){for(var d=l.indexToLoc(f),v=new Array(d.length),m=0;m<v.length;m++)v[m]=d[m]*i[m]+r[m];l.set.apply(l,[c.get.apply(c,v)].concat(d))}return l.toTensor()},t.prototype.diag=function(e){for(var r=this.readSync(e.dataId),a=Ue([e.size,e.size],e.dtype),i=a.values,u=0;u<r.length;u++)i[u*e.size+u]=r[u];return a.toTensor()},t.prototype.unstack=function(e,r){for(var a=e.shape[r],i=new Array(e.rank-1),u=0,l=0;l<e.rank;l++)l!==r&&(i[u++]=e.shape[l]);var c=new Array(e.rank).fill(0),f=e.shape.slice();f[r]=1;var d=new Array(a);for(l=0;l<d.length;l++)c[r]=l,d[l]=this.slice(e,c,f).reshape(i);return d},t.prototype.reverse=function(e,r){he(e,"reverse");for(var a=Ue(e.shape,e.dtype),i=this.bufferSync(e),u=function(c){var f=a.indexToLoc(c),d=f.slice();r.forEach(function(v){return d[v]=e.shape[v]-1-d[v]}),a.set.apply(a,[i.get.apply(i,d)].concat(f))},l=0;l<a.size;l++)u(l);return a.toTensor()},t.prototype.concat=function(e,r){var a=this;if(e[0].dtype==="complex64"){var i=e.map(function(g){return mr(g)}),u=e.map(function(g){return Kr(g)});return pn(this.concat(i,r),this.concat(u,r))}var l=e.map(function(g){var b=Ce(g.shape.slice(r));return g.as2D(-1,b)}),c=Fs(l.map(function(g){return g.shape}),1),f=Ue(c,e[0].dtype).values;if(l[0].shape[0]===1){var d=0;l.forEach(function(g){f.set(a.readSync(g.dataId),d),d+=g.size})}else{var v=0;l.forEach(function(g){for(var b=a.readSync(g.dataId),w=0,S=0;S<g.shape[0];++S)for(var _=S*c[1]+v,E=0;E<g.shape[1];++E)f[_+E]=b[w++];v+=g.shape[1]})}var m=Fs(e.map(function(g){return g.shape}),r);return mn(f,m,e[0].dtype)},t.prototype.neg=function(e){return he(e,"neg"),this.multiply(ge(-1),e)},t.prototype.add=function(e,r){return e.dtype==="complex64"||r.dtype==="complex64"?this.broadcastedBinaryComplexOp(e.cast("complex64"),r.cast("complex64"),function(a,i,u,l){return{real:a+u,imag:i+l}}):this.broadcastedBinaryOp(e,r,vn(e.dtype,r.dtype),function(a,i){return a+i})},t.prototype.addN=function(e){var r=this;he(e,"addN");for(var a=e.map(function(d){return r.readSync(d.dataId)}),i=Ue(e[0].shape,e[0].dtype),u=i.values,l=0;l<e.length;l++)for(var c=a[l],f=0;f<u.length;f++)u[f]+=c[f];return i.toTensor()},t.prototype.softmax=function(e,r){var a=Jt([r],e.shape),i=this.max(e,a),u=Un(i.shape,a),l=this.subtract(e,i.reshape(u)),c=this.exp(l),f=this.sum(c,a).reshape(u);return this.realDivide(c,f)},t.prototype.subtract=function(e,r){return e.dtype==="complex64"||r.dtype==="complex64"?this.broadcastedBinaryComplexOp(e.cast("complex64"),r.cast("complex64"),function(a,i,u,l){return{real:a-u,imag:i-l}}):this.broadcastedBinaryOp(e,r,vn(e.dtype,r.dtype),function(a,i){return a-i})},t.prototype.pow=function(e,r){return he([e,r],"pow"),this.broadcastedBinaryOp(e,r,e.dtype,function(a,i){return Math.pow(a,i)})},t.prototype.batchMatMul=function(e,r,a,i){he([e,r],"matMul");for(var u=a?e.shape[1]:e.shape[2],l=a?e.shape[2]:e.shape[1],c=i?r.shape[1]:r.shape[2],f=e.shape[0],d=this.readSync(e.dataId),v=this.readSync(r.dataId),m=a?[e.strides[0],1,e.strides[1]]:[e.strides[0],e.strides[1],1],g=m[0],b=m[1],w=m[2],S=i?[1,r.strides[1],r.strides[0]]:[r.strides[1],1,r.strides[0]],_=S[0],E=S[1],R=S[2],C=l*c,A=Ue([f,l,c],e.dtype),D=A.values,k=this.blockSize,I=0;I<f;I++)for(var N=0;N<l;N+=k)for(var B=0;B<c;B+=k)for(var V=0;V<u;V+=k)for(var U=Math.min(N+k,l),J=Math.min(B+k,c),ee=Math.min(V+k,u),te=N;te<U;te++)for(var P=B;P<J;P++){for(var j=0,K=V;K<ee;K++)j+=d[I*g+te*b+K*w]*v[K*_+P*E+I*R];D[I*C+(te*c+P)]+=j}return A.toTensor()},t.prototype.fusedBatchMatMul=function(e){var r=e.a,a=e.b,i=e.transposeA,u=e.transposeB,l=e.bias,c=e.activation,f=e.preluActivationWeights,d=this.batchMatMul(r,a,i,u);return l&&(d=this.add(d,l)),c&&(d=Tv(this,d,c,f)),d},t.prototype.multiply=function(e,r){return e.dtype==="complex64"||r.dtype==="complex64"?this.broadcastedBinaryComplexOp(e.cast("complex64"),r.cast("complex64"),function(a,i,u,l){return{real:a*u-i*l,imag:a*l+i*u}}):this.broadcastedBinaryOp(e,r,vn(e.dtype,r.dtype),function(a,i){return a*i})},t.prototype.realDivide=function(e,r){return he([e,r],"realDivide"),this.broadcastedBinaryOp(e,r,"float32",function(a,i){return a/i})},t.prototype.floorDiv=function(e,r){return he([e,r],"floorDiv"),this.broadcastedBinaryOp(e,r,"int32",function(a,i){return Math.floor(a/i)})},t.prototype.sum=function(e,r){he(e,"sum"),Yn("sum",r,e.rank);for(var a=wn(e.shape,r),i=a[0],u=a[1],l=St(i,vn(e.dtype,"int32")),c=Ce(u),f=this.readSync(l.dataId),d=this.readSync(e.dataId),v=0;v<f.length;++v){for(var m=v*c,g=0,b=0;b<c;++b)g+=d[m+b];f[v]=g}return l},t.prototype.prod=function(e,r){he(e,"sum");for(var a=wn(e.shape,r),i=a[0],u=a[1],l=St(i,vn(e.dtype,"int32")),c=Ce(u),f=this.readSync(l.dataId),d=this.readSync(e.dataId),v=0;v<f.length;++v){for(var m=v*c,g=1,b=0;b<c;++b)g*=d[m+b];f[v]=g}return l},t.prototype.unsortedSegmentSum=function(e,r,a){he(e,"unsortedSegmentSum");for(var i=[],u=e.rank-r.rank,l=0;l<u;++l)r=r.expandDims(l+1);for(l=0;l<a;++l){var c=ge(l,"int32"),f=US(c,r).asType("float32").mul(e).sum(0);i.push(f)}return tr(i)},t.prototype.argMin=function(e,r){he(e,"argMin");var a=[r];Yn("argMin",a,e.rank);for(var i=wn(e.shape,a),u=i[0],l=i[1],c=St(u,"int32"),f=Ce(l),d=this.readSync(c.dataId),v=this.readSync(e.dataId),m=0;m<d.length;++m){for(var g=m*f,b=v[g],w=0,S=0;S<f;++S){var _=v[g+S];_<b&&(b=_,w=S)}d[m]=w}return c},t.prototype.argMax=function(e,r){he(e,"argMax");var a=[r];Yn("argMax",a,e.rank);for(var i=wn(e.shape,a),u=i[0],l=i[1],c=St(u,"int32"),f=Ce(l),d=this.readSync(c.dataId),v=this.readSync(e.dataId),m=0;m<d.length;++m){for(var g=m*f,b=v[g],w=0,S=0;S<f;++S){var _=v[g+S];_>b&&(b=_,w=S)}d[m]=w}return c},t.prototype.cumsum=function(e,r,a,i){if(he(e,"cumsum"),r!==e.rank-1)throw new Error("backend.cumsum in CPU expects an inner-most axis="+(e.rank-1)+" but got axis="+r);for(var u=vn(e.dtype,"int32"),l=St(e.shape,u),c=this.readSync(l.dataId),f=this.readSync(e.dataId),d=e.shape[e.rank-1],v=i?function(S,_){return S+d-_-1}:function(S,_){return S+_},m=0;m<f.length;m+=d)for(var g=0;g<d;g++){var b=v(m,g);if(g===0)c[b]=a?0:f[b];else{var w=v(m,g-1);c[b]=a?f[w]+c[w]:f[b]+c[w]}}return l},t.prototype.equal=function(e,r){return he([e,r],"equal"),this.broadcastedBinaryOp(e,r,"bool",function(a,i){return a===i?1:0})},t.prototype.notEqual=function(e,r){return he([e,r],"notEqual"),this.broadcastedBinaryOp(e,r,"bool",function(a,i){return a!==i?1:0})},t.prototype.less=function(e,r){return he([e,r],"less"),this.broadcastedBinaryOp(e,r,"bool",function(a,i){return a<i?1:0})},t.prototype.lessEqual=function(e,r){return he([e,r],"lessEqual"),this.broadcastedBinaryOp(e,r,"bool",function(a,i){return a<=i?1:0})},t.prototype.greater=function(e,r){return he([e,r],"greater"),this.broadcastedBinaryOp(e,r,"bool",function(a,i){return a>i?1:0})},t.prototype.greaterEqual=function(e,r){return he([e,r],"greaterEqual"),this.broadcastedBinaryOp(e,r,"bool",function(a,i){return a>=i?1:0})},t.prototype.logicalNot=function(e){he(e,"logicalNot");for(var r=this.readSync(e.dataId),a=new Uint8Array(r.length),i=0;i<r.length;++i)a[i]=r[i]?0:1;return this.makeOutput(a,e.shape,"bool")},t.prototype.logicalAnd=function(e,r){return he([e,r],"logicalAnd"),this.broadcastedBinaryOp(e,r,"bool",function(a,i){return a&&i})},t.prototype.logicalOr=function(e,r){return he([e,r],"logicalOr"),this.broadcastedBinaryOp(e,r,"bool",function(a,i){return a||i})},t.prototype.select=function(e,r,a){he([e,r,a],"select");for(var i=this.readSync(e.dataId),u=this.readSync(r.dataId),l=this.readSync(a.dataId),c=St(r.shape,vn(r.dtype,a.dtype)),f=this.readSync(c.dataId),d=0,v=e.rank===0||e.rank>1||r.rank===1?1:Ce(r.shape.slice(1)),m=0;m<i.length;m++)for(var g=0;g<v;g++)i[m]===1?f[d++]=u[m]:f[d++]=l[m];return c},t.prototype.where=function(e){he([e],"where");var r=this.readSync(e.dataId);return ug(e.shape,r)},t.prototype.topk=function(e,r,a){return he(e,"topk"),gS(this.readSync(e.dataId),e.shape,e.dtype,r)},t.prototype.min=function(e,r){he(e,"min"),Yn("min",r,e.rank);for(var a=wn(e.shape,r),i=a[0],u=a[1],l=St(i,e.dtype),c=Ce(u),f=this.readSync(l.dataId),d=this.readSync(e.dataId),v=0;v<f.length;++v){for(var m=v*c,g=d[m],b=0;b<c;++b){var w=d[m+b];w<g&&(g=w)}f[v]=g}return l},t.prototype.minimum=function(e,r){return he([e,r],"minimum"),this.broadcastedBinaryOp(e,r,e.dtype,function(a,i){return Math.min(a,i)})},t.prototype.mod=function(e,r){return he([e,r],"mod"),this.broadcastedBinaryOp(e,r,e.dtype,function(a,i){var u=a%i;return a<0&&i<0||a>=0&&i>=0?u:(u+i)%i})},t.prototype.max=function(e,r){he(e,"max"),Yn("max",r,e.rank);for(var a=wn(e.shape,r),i=a[0],u=a[1],l=St(i,e.dtype),c=Ce(u),f=this.readSync(l.dataId),d=this.readSync(e.dataId),v=0;v<f.length;++v){for(var m=v*c,g=d[m],b=0;b<c;++b){var w=d[m+b];w>g&&(g=w)}f[v]=g}return l},t.prototype.maximum=function(e,r){return he([e,r],"maximum"),this.broadcastedBinaryOp(e,r,e.dtype,function(a,i){return Math.max(a,i)})},t.prototype.all=function(e,r){he(e,"all"),Yn("all",r,e.rank);for(var a=wn(e.shape,r),i=a[0],u=a[1],l=St(i,e.dtype),c=Ce(u),f=this.readSync(l.dataId),d=this.readSync(e.dataId),v=0;v<f.length;++v){for(var m=v*c,g=d[m],b=0;b<c;++b){var w=d[m+b];g=g&&w}f[v]=g}return l},t.prototype.any=function(e,r){he(e,"any"),Yn("any",r,e.rank);for(var a=wn(e.shape,r),i=a[0],u=a[1],l=St(i,e.dtype),c=Ce(u),f=this.readSync(l.dataId),d=this.readSync(e.dataId),v=0;v<f.length;++v){for(var m=v*c,g=d[m],b=0;b<c;++b){var w=d[m+b];g=g||w}f[v]=g}return l},t.prototype.squaredDifference=function(e,r){return he([e,r],"squaredDifference"),this.broadcastedBinaryOp(e,r,e.dtype,function(a,i){var u=a-i;return u*u})},t.prototype.ceil=function(e){he(e,"ceil");for(var r=this.readSync(e.dataId),a=new Float32Array(r.length),i=0;i<r.length;++i)a[i]=Math.ceil(r[i]);return this.makeOutput(a,e.shape,"float32")},t.prototype.floor=function(e){he(e,"floor");for(var r=this.readSync(e.dataId),a=new Float32Array(r.length),i=0;i<r.length;++i)a[i]=Math.floor(r[i]);return this.makeOutput(a,e.shape,"float32")},t.prototype.sign=function(e){he(e,"x");for(var r=this.readSync(e.dataId),a=new Float32Array(r.length),i=0;i<r.length;++i)r[i]<0?a[i]=-1:r[i]>0?a[i]=1:a[i]=0;return this.makeOutput(a,e.shape,"float32")},t.prototype.isNaN=function(e){he(e,"x");for(var r=this.readSync(e.dataId),a=new Uint8Array(r.length),i=0;i<r.length;++i)Number.isNaN(r[i])&&(a[i]=1);return this.makeOutput(a,e.shape,"bool")},t.prototype.isInf=function(e){he(e,"x");for(var r=this.readSync(e.dataId),a=new Uint8Array(r.length),i=0;i<r.length;++i)Math.abs(r[i])===1/0&&(a[i]=1);return this.makeOutput(a,e.shape,"bool")},t.prototype.isFinite=function(e){he(e,"x");for(var r=this.readSync(e.dataId),a=new Uint8Array(r.length),i=0;i<r.length;++i)Number.isFinite(r[i])&&(a[i]=1);return this.makeOutput(a,e.shape,"bool")},t.prototype.round=function(e){he(e,"round");for(var r=this.readSync(e.dataId),a=new Float32Array(r.length),i=0;i<r.length;++i){var u=Math.floor(r[i]);r[i]-u<.5?a[i]=Math.floor(r[i]):r[i]-u>.5?a[i]=Math.ceil(r[i]):a[i]=u%2==0?u:u+1}return this.makeOutput(a,e.shape,"float32")},t.prototype.exp=function(e){he(e,"exp");for(var r=this.readSync(e.dataId),a=new Float32Array(r.length),i=0;i<r.length;++i)a[i]=Math.exp(r[i]);return this.makeOutput(a,e.shape,"float32")},t.prototype.expm1=function(e){he(e,"expm1");for(var r=this.readSync(e.dataId),a=new Float32Array(r.length),i=0;i<r.length;++i)a[i]=Math.expm1(r[i]);return this.makeOutput(a,e.shape,"float32")},t.prototype.log=function(e){he(e,"log");for(var r=this.readSync(e.dataId),a=new Float32Array(r.length),i=0;i<r.length;++i){var u=r[i];a[i]=Math.log(u)}return this.makeOutput(a,e.shape,"float32")},t.prototype.log1p=function(e){he(e,"log1p");for(var r=this.readSync(e.dataId),a=new Float32Array(r.length),i=0;i<r.length;++i){var u=r[i];a[i]=Math.log1p(u)}return this.makeOutput(a,e.shape,"float32")},t.prototype.sqrt=function(e){he(e,"sqrt");for(var r=this.readSync(e.dataId),a=new Float32Array(r.length),i=0;i<r.length;++i){var u=r[i];a[i]=Math.sqrt(u)}return this.makeOutput(a,e.shape,"float32")},t.prototype.rsqrt=function(e){he(e,"rsqrt");for(var r=this.readSync(e.dataId),a=new Float32Array(r.length),i=0;i<r.length;++i){var u=r[i];a[i]=1/Math.sqrt(u)}return this.makeOutput(a,e.shape,"float32")},t.prototype.reciprocal=function(e){he(e,"reciprocal");for(var r=this.readSync(e.dataId),a=new Float32Array(r.length),i=0;i<r.length;++i)a[i]=1/r[i];return this.makeOutput(a,e.shape,"float32")},t.prototype.linear=function(e){return e},t.prototype.relu=function(e){he(e,"relu");for(var r=St(e.shape,e.dtype),a=this.readSync(r.dataId),i=this.readSync(e.dataId),u=0;u<i.length;++u)a[u]=Math.max(0,i[u]);return r},t.prototype.relu6=function(e){he(e,"relu");for(var r=St(e.shape,e.dtype),a=this.readSync(r.dataId),i=this.readSync(e.dataId),u=0;u<i.length;++u)a[u]=Math.min(Math.max(0,i[u]),6);return r},t.prototype.prelu=function(e,r){return he([e,r],"prelu"),this.broadcastedBinaryOp(e,r,e.dtype,function(a,i){return a<0?i*a:a})},t.prototype.elu=function(e){he(e,"elu");for(var r=new Float32Array(e.size),a=this.readSync(e.dataId),i=0;i<a.length;++i){var u=a[i];r[i]=u>=0?u:Math.exp(u)-1}return this.makeOutput(r,e.shape,"float32")},t.prototype.eluDer=function(e,r){he([e,r],"eluDer");for(var a=new Float32Array(r.size),i=this.readSync(r.dataId),u=this.readSync(e.dataId),l=0;l<i.length;++l){var c=i[l];a[l]=c>=1?u[l]:u[l]*(c+1)}return this.makeOutput(a,r.shape,"float32")},t.prototype.selu=function(e){he(e,"selu");for(var r=cg,a=fg,i=new Float32Array(e.size),u=this.readSync(e.dataId),l=0;l<u.length;++l){var c=u[l];i[l]=c>=0?a*c:r*(Math.exp(c)-1)}return this.makeOutput(i,e.shape,"float32")},t.prototype.clip=function(e,r,a){he(e,"clip");for(var i=new Float32Array(e.size),u=this.readSync(e.dataId),l=0;l<u.length;++l){var c=u[l];i[l]=c>a?a:c<r?r:c}return this.makeOutput(i,e.shape,"float32")},t.prototype.abs=function(e){for(var r=new Float32Array(e.size),a=this.readSync(e.dataId),i=0;i<a.length;++i)r[i]=Math.abs(a[i]);return this.makeOutput(r,e.shape,"float32")},t.prototype.complexAbs=function(e){for(var r=new Float32Array(e.size),a=this.readSync(e.dataId),i=0;i<e.size;++i){var u=a[2*i],l=a[2*i+1];r[i]=Math.hypot(u,l)}return this.makeOutput(r,e.shape,"float32")},t.prototype.int=function(e){he(e,"int");for(var r=new Int32Array(e.size),a=this.readSync(e.dataId),i=0;i<a.length;++i)r[i]=a[i];return this.makeOutput(r,e.shape,"int32")},t.prototype.sigmoid=function(e){he(e,"sigmoid");for(var r=new Float32Array(e.size),a=this.readSync(e.dataId),i=0;i<a.length;++i)r[i]=1/(1+Math.exp(-a[i]));return this.makeOutput(r,e.shape,"float32")},t.prototype.softplus=function(e){he(e,"softplus");for(var r=Math.log(11920928955078125e-23)+2,a=new Float32Array(e.size),i=this.readSync(e.dataId),u=0;u<i.length;++u){var l=i[u]>-r,c=i[u]<r,f=Math.exp(i[u]),d=void 0;d=c?f:l?i[u]:Math.log(1+f),a[u]=d}return this.makeOutput(a,e.shape,"float32")},t.prototype.sin=function(e){he(e,"sin");for(var r=new Float32Array(e.size),a=this.readSync(e.dataId),i=0;i<a.length;++i)r[i]=Math.sin(a[i]);return this.makeOutput(r,e.shape,"float32")},t.prototype.cos=function(e){he(e,"cos");for(var r=new Float32Array(e.size),a=this.readSync(e.dataId),i=0;i<a.length;++i)r[i]=Math.cos(a[i]);return this.makeOutput(r,e.shape,"float32")},t.prototype.tan=function(e){he(e,"tan");for(var r=new Float32Array(e.size),a=this.readSync(e.dataId),i=0;i<a.length;++i)r[i]=Math.tan(a[i]);return this.makeOutput(r,e.shape,"float32")},t.prototype.asin=function(e){he(e,"asin");for(var r=new Float32Array(e.size),a=this.readSync(e.dataId),i=0;i<a.length;++i)r[i]=Math.asin(a[i]);return this.makeOutput(r,e.shape,"float32")},t.prototype.acos=function(e){he(e,"acos");for(var r=new Float32Array(e.size),a=this.readSync(e.dataId),i=0;i<a.length;++i)r[i]=Math.acos(a[i]);return this.makeOutput(r,e.shape,"float32")},t.prototype.atan=function(e){he(e,"atan");for(var r=new Float32Array(e.size),a=this.readSync(e.dataId),i=0;i<a.length;++i)r[i]=Math.atan(a[i]);return this.makeOutput(r,e.shape,"float32")},t.prototype.atan2=function(e,r){return he([e,r],"atan2"),this.broadcastedBinaryOp(e,r,e.dtype,function(a,i){return Math.atan2(a,i)})},t.prototype.sinh=function(e){he(e,"sinh");for(var r=new Float32Array(e.size),a=this.readSync(e.dataId),i=0;i<a.length;++i)r[i]=Math.sinh(a[i]);return this.makeOutput(r,e.shape,"float32")},t.prototype.cosh=function(e){he(e,"cosh");for(var r=new Float32Array(e.size),a=this.readSync(e.dataId),i=0;i<a.length;++i)r[i]=Math.cosh(a[i]);return this.makeOutput(r,e.shape,"float32")},t.prototype.tanh=function(e){he(e,"tanh");for(var r=new Float32Array(e.size),a=this.readSync(e.dataId),i=0;i<a.length;++i)r[i]=aN(a[i]);return this.makeOutput(r,e.shape,"float32")},t.prototype.asinh=function(e){he(e,"asinh");for(var r=new Float32Array(e.size),a=this.readSync(e.dataId),i=0;i<a.length;++i)r[i]=Math.asinh(a[i]);return this.makeOutput(r,e.shape,"float32")},t.prototype.acosh=function(e){he(e,"acosh");for(var r=new Float32Array(e.size),a=this.readSync(e.dataId),i=0;i<a.length;++i)r[i]=Math.acosh(a[i]);return this.makeOutput(r,e.shape,"float32")},t.prototype.atanh=function(e){he(e,"atanh");for(var r=new Float32Array(e.size),a=this.readSync(e.dataId),i=0;i<a.length;++i)r[i]=Math.atanh(a[i]);return this.makeOutput(r,e.shape,"float32")},t.prototype.erf=function(e){he(e,"erf");for(var r=new Float32Array(e.size),a=this.readSync(e.dataId),i=0;i<a.length;++i){var u=Math.sign(a[i]),l=Math.abs(a[i]),c=1/(1+.3275911*l);r[i]=u*(1-((((1.061405429*c-1.453152027)*c+1.421413741)*c-.284496736)*c+.254829592)*c*Math.exp(-l*l))}return this.makeOutput(r,e.shape,"float32")},t.prototype.step=function(e,r){r===void 0&&(r=0),he(e,"step");for(var a=new Float32Array(e.size),i=this.readSync(e.dataId),u=0;u<i.length;++u){var l=i[u];isNaN(l)?a[u]=NaN:a[u]=l>0?1:r}return this.makeOutput(a,e.shape,"float32")},t.prototype.fusedConv2d=function(e){var r=e.input,a=e.filter,i=e.convInfo,u=e.bias,l=e.activation,c=e.preluActivationWeights,f=this.conv2d(r,a,i);return u&&(f=this.add(f,u)),l&&(f=Tv(this,f,l,c)),f},t.prototype.conv2d=function(e,r,a){he([e,r],"conv2d");for(var i=a.filterHeight,u=a.filterWidth,l=a.dilationHeight,c=a.dilationWidth,f=a.padInfo.left,d=a.padInfo.top,v=a.dataFormat==="channelsLast",m=Ue(a.outShape,e.dtype),g=e.strides[0],b=v?e.strides[1]:e.strides[2],w=v?e.strides[2]:1,S=v?1:e.strides[1],_=m.strides[0],E=v?m.strides[1]:m.strides[2],R=v?m.strides[2]:1,C=v?1:m.strides[1],A=this.readSync(e.dataId),D=this.readSync(r.dataId),k=m.values,I=0;I<a.batchSize;++I)for(var N=I*g,B=I*_,V=0;V<a.outHeight;++V)for(var U=B+V*E,J=V*a.strideHeight-d,ee=0;ee<i;ee++){var te=J+ee*l;if(!(te<0||te>=a.inHeight))for(var P=ee*r.strides[0],j=N+te*b,K=0;K<a.outWidth;++K)for(var ne=U+K*R,M=K*a.strideWidth-f,G=0;G<u;G++){var ie=M+G*c;if(!(ie<0||ie>=a.inWidth))for(var oe=j+ie*w,de=P+G*r.strides[1],me=0;me<a.inChannels;++me){for(var pe=A[oe+me*S],ke=0;ke<a.outChannels;++ke)k[ne+ke*C]+=pe*D[de+ke];de+=a.outChannels}}}return m.toTensor()},t.prototype.conv3d=function(e,r,a){for(var i=a.filterDepth,u=a.filterHeight,l=a.filterWidth,c=a.dilationDepth,f=a.dilationHeight,d=a.dilationWidth,v=a.padInfo.front,m=a.padInfo.left,g=a.padInfo.top,b=Ue(a.outShape,e.dtype),w=this.readSync(e.dataId),S=this.readSync(r.dataId),_=b.values,E=0;E<a.batchSize;++E)for(var R=E*e.strides[0],C=E*b.strides[0],A=0;A<a.outDepth;++A)for(var D=C+A*b.strides[1],k=A*a.strideDepth-v,I=0;I<i;I++){var N=k+I*c;if(!(N<0||N>=a.inDepth))for(var B=I*r.strides[0],V=R+N*e.strides[1],U=0;U<a.outHeight;++U)for(var J=D+U*b.strides[2],ee=U*a.strideHeight-g,te=0;te<u;te++){var P=ee+te*f;if(!(P<0||P>=a.inHeight))for(var j=B+te*r.strides[1],K=V+P*e.strides[2],ne=0;ne<a.outWidth;++ne)for(var M=J+ne*a.outChannels,G=ne*a.strideWidth-m,ie=0;ie<l;ie++){var oe=G+ie*d;if(!(oe<0||oe>=a.inWidth))for(var de=j+ie*r.strides[2],me=K+oe*a.inChannels,pe=de,ke=0;ke<a.inChannels;++ke){for(var ye=w[me+ke],Ne=0;Ne<a.outChannels;++Ne)_[M+Ne]+=ye*S[pe+Ne];pe+=a.outChannels}}}}return b.toTensor()},t.prototype.conv2dDerInput=function(e,r,a){he([e,r],"conv2dDerInput");for(var i=Ue(a.inShape,"float32"),u=i.values,l=this.readSync(e.dataId),c=this.readSync(r.dataId),f=r.strides,d=f[0],v=f[1],m=f[2],g=a.batchSize,b=a.filterHeight,w=a.filterWidth,S=a.inChannels,_=a.inHeight,E=a.inWidth,R=a.outChannels,C=a.outHeight,A=a.outWidth,D=a.strideHeight,k=a.strideWidth,I=a.dataFormat,N=b-1-a.padInfo.top,B=w-1-a.padInfo.left,V=I==="channelsLast",U=i.strides[0],J=V?i.strides[1]:i.strides[2],ee=V?i.strides[2]:1,te=V?1:i.strides[1],P=e.strides[0],j=V?e.strides[1]:e.strides[2],K=V?e.strides[2]:1,ne=V?1:e.strides[1],M=0;M<g;++M)for(var G=0;G<S;++G)for(var ie=0;ie<_;++ie)for(var oe=ie-N,de=Math.max(0,Math.ceil(oe/D)),me=Math.min(C,(b+oe)/D),pe=0;pe<E;++pe){for(var ke=pe-B,ye=Math.max(0,Math.ceil(ke/k)),Ne=Math.min(A,(w+ke)/k),at=0,Fe=de;Fe<me;++Fe)for(var je=Fe*D-oe,Ke=ye;Ke<Ne;++Ke)for(var ut=P*M+j*Fe+K*Ke,yt=d*(b-1-je)+v*(w-1-(Ke*k-ke))+m*G,pt=0;pt<R;++pt)at+=l[ut+ne*pt]*c[yt+pt];u[U*M+J*ie+ee*pe+te*G]=at}return i.toTensor()},t.prototype.conv3dDerInput=function(e,r,a){for(var i=Ue(a.inShape,"float32"),u=i.values,l=i.strides,c=l[0],f=l[1],d=l[2],v=l[3],m=this.readSync(e.dataId),g=e.strides,b=g[0],w=g[1],S=g[2],_=g[3],E=this.readSync(r.dataId),R=r.strides,C=R[0],A=R[1],D=R[2],k=R[3],I=a.batchSize,N=a.filterDepth,B=a.filterHeight,V=a.filterWidth,U=a.inChannels,J=a.inDepth,ee=a.inHeight,te=a.inWidth,P=a.outChannels,j=a.outDepth,K=a.outHeight,ne=a.outWidth,M=a.strideDepth,G=a.strideHeight,ie=a.strideWidth,oe=N-1-a.padInfo.front,de=B-1-a.padInfo.top,me=V-1-a.padInfo.left,pe=0;pe<I;++pe)for(var ke=0;ke<U;++ke)for(var ye=0;ye<J;++ye)for(var Ne=ye-oe,at=Math.max(0,Math.ceil(Ne/M)),Fe=Math.min(j,(N+Ne)/M),je=0;je<ee;++je)for(var Ke=je-de,ut=Math.max(0,Math.ceil(Ke/G)),yt=Math.min(K,(B+Ke)/G),pt=0;pt<te;++pt){for(var Mt=pt-me,ar=Math.max(0,Math.ceil(Mt/ie)),gn=Math.min(ne,(V+Mt)/ie),oa=0,kn=at;kn<Fe;++kn)for(var Fr=kn*M-Ne,ir=ut;ir<yt;++ir)for(var Pa=ir*G-Ke,_r=ar;_r<gn;++_r)for(var sa=b*pe+w*kn+S*ir+_*_r,Lt=C*(N-1-Fr)+A*(B-1-Pa)+D*(V-1-(_r*ie-Mt))+k*ke,Ht=0;Ht<P;++Ht)oa+=m[sa+Ht]*E[Lt+Ht];u[c*pe+f*ye+d*je+v*pt+ke]=oa}return i.toTensor()},t.prototype.conv2dDerFilter=function(e,r,a){he([e,r],"conv2dDerFilter");for(var i=a.strideHeight,u=a.strideWidth,l=a.filterHeight,c=a.filterWidth,f=a.dataFormat==="channelsLast",d=Ue(a.filterShape,"float32"),v=a.padInfo.left,m=a.padInfo.top,g=this.bufferSync(e),b=this.bufferSync(r),w=0;w<l;++w)for(var S=Math.max(0,Math.ceil((m-w)/i)),_=Math.min(a.outHeight,(a.inHeight+m-w)/i),E=0;E<c;++E)for(var R=Math.max(0,Math.ceil((v-E)/u)),C=Math.min(a.outWidth,(a.inWidth+v-E)/u),A=0;A<a.inChannels;++A)for(var D=0;D<a.outChannels;++D){for(var k=0,I=0;I<a.batchSize;++I)for(var N=S;N<_;++N)for(var B=w+N*i-m,V=R;V<C;++V){var U=E+V*u-v;k+=f?g.get(I,B,U,A)*b.get(I,N,V,D):g.get(I,A,B,U)*b.get(I,D,N,V)}d.set(k,w,E,A,D)}return d.toTensor()},t.prototype.conv3dDerFilter=function(e,r,a){for(var i=a.strideDepth,u=a.strideHeight,l=a.strideWidth,c=a.filterDepth,f=a.filterHeight,d=a.filterWidth,v=Ue(a.filterShape,"float32"),m=v.values,g=v.strides,b=g[0],w=g[1],S=g[2],_=g[3],E=this.readSync(r.dataId),R=r.strides,C=R[0],A=R[1],D=R[2],k=R[3],I=this.readSync(e.dataId),N=e.strides,B=N[0],V=N[1],U=N[2],J=N[3],ee=a.padInfo.front,te=a.padInfo.left,P=a.padInfo.top,j=0;j<c;++j)for(var K=Math.max(0,Math.ceil((ee-j)/i)),ne=Math.min(a.outDepth,(a.inDepth+ee-j)/i),M=j*b,G=0;G<f;++G)for(var ie=Math.max(0,Math.ceil((P-G)/u)),oe=Math.min(a.outHeight,(a.inHeight+P-G)/u),de=G*w+M,me=0;me<d;++me)for(var pe=Math.max(0,Math.ceil((te-me)/l)),ke=Math.min(a.outWidth,(a.inWidth+te-me)/l),ye=me*S+de,Ne=0;Ne<a.inChannels;++Ne)for(var at=Ne*_+ye,Fe=0;Fe<a.outChannels;++Fe){for(var je=0,Ke=0;Ke<a.batchSize;++Ke)for(var ut=Ke*B,yt=Ke*C,pt=K;pt<ne;++pt)for(var Mt=(j+pt*i-ee)*V+ut,ar=pt*A+yt,gn=ie;gn<oe;++gn)for(var oa=(G+gn*u-P)*U+Mt,kn=gn*D+ar,Fr=pe;Fr<ke;++Fr){var ir=Fr*k+kn;je+=I[(me+Fr*l-te)*J+oa+Ne]*E[ir+Fe]}m[at+Fe]=je}return v.toTensor()},t.prototype.fusedDepthwiseConv2D=function(e){var r=e.input,a=e.filter,i=e.convInfo,u=e.bias,l=e.activation,c=e.preluActivationWeights,f=this.depthwiseConv2D(r,a,i);return u&&(f=this.add(f,u)),l&&(f=Tv(this,f,l,c)),f},t.prototype.depthwiseConv2D=function(e,r,a){he([e,r],"depthwiseConv2D");for(var i=a.filterHeight,u=a.filterWidth,l=a.dilationHeight,c=a.dilationWidth,f=a.padInfo.left,d=a.padInfo.top,v=a.outChannels/a.inChannels,m=Ue(a.outShape,e.dtype),g=this.readSync(e.dataId),b=this.readSync(r.dataId),w=m.values,S=0;S<a.batchSize;++S)for(var _=S*e.strides[0],E=S*m.strides[0],R=0;R<a.outHeight;++R)for(var C=E+R*m.strides[1],A=R*a.strideHeight-f,D=0;D<i;++D){var k=A+D*l;if(!(k<0||k>=a.inHeight))for(var I=D*r.strides[0],N=_+k*e.strides[1],B=0;B<a.outWidth;++B)for(var V=C+B*m.strides[2],U=B*a.strideWidth-d,J=0;J<u;++J){var ee=U+J*c;if(!(ee<0||ee>=a.inWidth))for(var te=I+J*r.strides[1],P=N+ee*a.inChannels,j=V,K=te,ne=0;ne<a.inChannels;++ne){for(var M=g[P+ne],G=0;G<v;++G)w[j+G]+=M*b[K+G];j+=v,K+=v}}}return m.toTensor()},t.prototype.depthwiseConv2DDerInput=function(e,r,a){he([e,r],"depthwiseConv2DDerInput");for(var i=Ue(a.inShape,"float32"),u=i.values,l=i.strides,c=l[0],f=l[1],d=l[2],v=this.readSync(e.dataId),m=e.strides,g=m[0],b=m[1],w=m[2],S=this.readSync(r.dataId),_=r.strides,E=_[0],R=_[1],C=_[2],A=a.batchSize,D=a.filterHeight,k=a.filterWidth,I=a.inChannels,N=a.inHeight,B=a.inWidth,V=a.outChannels,U=a.outHeight,J=a.outWidth,ee=a.strideHeight,te=a.strideWidth,P=D-1-a.padInfo.top,j=k-1-a.padInfo.left,K=V/I,ne=0;ne<A;++ne)for(var M=0;M<I;++M)for(var G=0;G<N;++G)for(var ie=G-P,oe=Math.max(0,Math.ceil(ie/ee)),de=Math.min(U,(D+ie)/ee),me=0;me<B;++me){for(var pe=me-j,ke=Math.max(0,Math.ceil(pe/te)),ye=Math.min(J,(k+pe)/te),Ne=0,at=oe;at<de;++at)for(var Fe=at*ee-ie,je=ke;je<ye;++je)for(var Ke=g*ne+b*at+w*je,ut=E*(D-1-Fe)+R*(k-1-(je*te-pe))+C*M,yt=0;yt<K;++yt)Ne+=v[Ke+(M*K+yt)]*S[ut+yt];u[c*ne+f*G+d*me+M]=Ne}return i.toTensor()},t.prototype.depthwiseConv2DDerFilter=function(e,r,a){he([e,r],"depthwiseConv2DDerFilter");for(var i=a.strideHeight,u=a.strideWidth,l=a.filterHeight,c=a.filterWidth,f=Ue(a.filterShape,"float32"),d=a.padInfo.left,v=a.padInfo.top,m=a.outChannels/a.inChannels,g=this.bufferSync(e),b=this.bufferSync(r),w=0;w<l;++w)for(var S=Math.max(0,Math.ceil((v-w)/i)),_=Math.min(a.outHeight,(a.inHeight+v-w)/i),E=0;E<c;++E)for(var R=Math.max(0,Math.ceil((d-E)/u)),C=Math.min(a.outWidth,(a.inWidth+d-E)/u),A=0;A<a.outChannels;++A){for(var D=Math.trunc(A/m),k=A%m,I=0,N=0;N<a.batchSize;++N)for(var B=S;B<_;++B)for(var V=w+B*i-v,U=R;U<C;++U){var J=E+U*u-d;I+=g.get(N,V,J,D)*b.get(N,B,U,A)}f.set(I,w,E,D,k)}return f.toTensor()},t.prototype.tile=function(e,r){return he(e,"tile"),mS(this.bufferSync(e),r)},t.prototype.pad=function(e,r,a){he(e,"pad");var i=r.map(function(m,g){return m[0]+e.shape[g]+m[1]}),u=r.map(function(m){return m[0]}),l=this.bufferSync(e),c=Ue(i,e.dtype);a!==0&&c.values.fill(a);for(var f=0;f<e.size;f++){var d=l.indexToLoc(f),v=d.map(function(m,g){return m+u[g]});c.set.apply(c,[l.get.apply(l,d)].concat(v))}return c.toTensor()},t.prototype.transpose=function(e,r){he(e,"transpose");for(var a=new Array(e.rank),i=0;i<a.length;i++)a[i]=e.shape[r[i]];var u=this.readSync(e.dataId),l=Ue(a,e.dtype),c=this.bufferSync(e);for(i=0;i<e.size;++i){for(var f=c.indexToLoc(i),d=new Array(f.length),v=0;v<d.length;v++)d[v]=f[r[v]];var m=l.locToIndex(d);l.values[m]=u[i]}return l.toTensor()},t.prototype.gather=function(e,r,a){he([e,r],"gather");var i=e.shape.slice(),u=this.readSync(r.dataId);i[a]=u.length;for(var l=Ue(i,e.dtype),c=this.bufferSync(e),f=0;f<l.size;++f){var d=l.indexToLoc(f),v=d.slice();v[a]=u[d[a]];var m=c.locToIndex(v);l.values[f]=c.values[m]}return l.toTensor()},t.prototype.batchToSpaceND=function(e,r,a){he([e],"batchToSpaceND");var i=r.reduce(function(v,m){return v*m}),u=Gf(e.shape,r,i),l=qf(u.length,r.length),c=Kf(e.shape,r,i),f=rS(a,r.length),d=aS(c,a,r.length);return e.reshape(u).transpose(l).reshape(c).slice(f,d)},t.prototype.spaceToBatchND=function(e,r,a){he([e],"spaceToBatchND");var i=r.reduce(function(m,g){return m*g}),u=[[0,0]];u.push.apply(u,a);for(var l=1+r.length;l<e.shape.length;++l)u.push([0,0]);var c=e.pad(u),f=Gf(c.shape,r,i,!1),d=qf(f.length,r.length,!1),v=Kf(c.shape,r,i,!1);return c.reshape(f).transpose(d).reshape(v)},t.prototype.pool=function(e,r,a){he(e,"pool");for(var i=r.strideHeight,u=r.strideWidth,l=r.dilationHeight,c=r.dilationWidth,f=r.effectiveFilterHeight,d=r.effectiveFilterWidth,v=r.padInfo.top,m=r.padInfo.left,g=a==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,b=this.readSync(e.dataId),w=Ue(r.outShape,e.dtype),S=w.values,_=r.outShape[1]*r.outShape[2]*r.outShape[3],E=r.outShape[2]*r.outShape[3],R=r.outShape[3],C=0;C<r.batchSize;++C)for(var A=C*_,D=C*e.strides[0],k=0;k<r.inChannels;++k)for(var I=0;I<r.outHeight;++I)for(var N=I*i-v,B=Math.max(0,N),V=Math.min(r.inHeight,f+N),U=A+I*E,J=0;J<r.outWidth;++J){for(var ee=J*u-m,te=Math.max(0,ee),P=Math.min(r.inWidth,d+ee),j=g,K=0,ne=0,M=B;M<V;M+=l){for(var G=D+M*e.strides[1],ie=te;ie<P;ie+=c){var oe=b[G+ie*e.strides[2]+k];a==="max"&&oe>j?j=oe:a==="avg"&&(K+=oe,ne++)}if(isNaN(j))break}S[U+J*R+k]=a==="avg"?K/ne:j}return w.toTensor()},t.prototype.maxPool=function(e,r){return this.pool(e,r,"max")},t.prototype.maxPoolPositions=function(e,r){for(var a=Ue(r.outShape,"int32"),i=r.strideHeight,u=r.strideWidth,l=r.dilationHeight,c=r.dilationWidth,f=r.effectiveFilterHeight,d=r.effectiveFilterWidth,v=r.padInfo.top,m=r.padInfo.left,g=this.bufferSync(e),b=0;b<r.batchSize;++b)for(var w=0;w<r.inChannels;++w)for(var S=0;S<r.outHeight;++S){for(var _=S*i-v,E=_;E<0;)E+=l;for(var R=Math.min(r.inHeight,f+_),C=0;C<r.outWidth;++C){for(var A=C*u-m,D=A;D<0;)D+=c;for(var k=Math.min(r.inWidth,d+A),I=Number.NEGATIVE_INFINITY,N=-1,B=E;B<R;B+=l)for(var V=B-_,U=D;U<k;U+=c){var J=U-A,ee=g.get(b,B,U,w);ee>I&&(I=ee,N=V*d+J)}a.set(N,b,S,C,w)}}return a.toTensor()},t.prototype.maxPoolBackprop=function(e,r,a,i){he([r,a],"maxPoolBackprop");for(var u=this.maxPoolPositions(r,i),l=i.strideHeight,c=i.strideWidth,f=i.dilationHeight,d=i.dilationWidth,v=i.effectiveFilterHeight,m=i.effectiveFilterWidth,g=m-1-i.padInfo.left,b=v-1-i.padInfo.top,w=Ue(r.shape,"float32"),S=this.bufferSync(u),_=this.bufferSync(e),E=0;E<i.batchSize;++E)for(var R=0;R<i.inChannels;++R)for(var C=0;C<i.inHeight;++C)for(var A=0;A<i.inWidth;++A){for(var D=C-b,k=A-g,I=0,N=0;N<v;N+=f){var B=(D+N)/l;if(!(B<0||B>=i.outHeight||Math.floor(B)!==B))for(var V=0;V<m;V+=d){var U=(k+V)/c;if(!(U<0||U>=i.outWidth||Math.floor(U)!==U)){var J=v*m-1-S.get(E,B,U,R)===N*m+V?1:0;J!==0&&(I+=_.get(E,B,U,R)*J)}}}w.set(I,E,C,A,R)}return w.toTensor()},t.prototype.avgPoolBackprop=function(e,r,a){he([e,r],"avgPoolBackprop");for(var i=a.strideHeight,u=a.strideWidth,l=a.filterHeight,c=a.filterWidth,f=a.dilationHeight,d=a.dilationWidth,v=a.effectiveFilterHeight,m=a.effectiveFilterWidth,g=m-1-a.padInfo.left,b=v-1-a.padInfo.top,w=Ue(r.shape,"float32"),S=1/(l*c),_=this.bufferSync(e),E=0;E<a.batchSize;++E)for(var R=0;R<a.inChannels;++R)for(var C=0;C<a.inHeight;++C)for(var A=0;A<a.inWidth;++A){for(var D=C-b,k=A-g,I=0,N=0;N<v;N+=f){var B=(D+N)/i;if(!(B<0||B>=a.outHeight||Math.floor(B)!==B))for(var V=0;V<m;V+=d){var U=(k+V)/u;U<0||U>=a.outWidth||Math.floor(U)!==U||(I+=_.get(E,B,U,R))}}w.set(I*S,E,C,A,R)}return w.toTensor()},t.prototype.pool3d=function(e,r,a){he(e,"pool3d");for(var i=r.strideDepth,u=r.strideHeight,l=r.strideWidth,c=r.dilationDepth,f=r.dilationHeight,d=r.dilationWidth,v=r.effectiveFilterDepth,m=r.effectiveFilterHeight,g=r.effectiveFilterWidth,b=r.padInfo.front,w=r.padInfo.top,S=r.padInfo.left,_=a==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,E=this.readSync(e.dataId),R=Ue(r.outShape,e.dtype),C=R.values,A=r.outShape[1]*r.outShape[2]*r.outShape[3]*r.outShape[4],D=r.outShape[2]*r.outShape[3]*r.outShape[4],k=r.outShape[3]*r.outShape[4],I=r.outShape[4],N=0;N<r.batchSize;++N)for(var B=N*A,V=N*e.strides[0],U=0;U<r.inChannels;++U)for(var J=0;J<r.outDepth;++J){for(var ee=J*i-b,te=ee;te<0;)te+=c;for(var P=Math.min(r.inDepth,v+ee),j=B+J*D,K=0;K<r.outHeight;++K){for(var ne=K*u-w,M=ne;M<0;)M+=f;for(var G=Math.min(r.inHeight,m+ne),ie=j+K*k,oe=0;oe<r.outWidth;++oe){for(var de=oe*l-S,me=de;me<0;)me+=d;for(var pe=Math.min(r.inWidth,g+de),ke=ie+oe*I,ye=_,Ne=0,at=0,Fe=te;Fe<P;Fe+=c){for(var je=V+Fe*e.strides[1],Ke=M;Ke<G;Ke+=f){for(var ut=je+Ke*e.strides[2],yt=me;yt<pe;yt+=d){var pt=E[ut+yt*e.strides[3]+U];if(a==="max"&&pt>ye?ye=pt:a==="avg"&&(Ne+=pt,at++),isNaN(ye))break}if(isNaN(ye))break}if(isNaN(ye))break}C[ke+U]=a==="avg"?Ne/at:ye}}}return R.toTensor()},t.prototype.avgPool3d=function(e,r){return he(e,"avgPool3d"),this.pool3d(e,r,"avg").toFloat()},t.prototype.avgPool3dBackprop=function(e,r,a){he([e,r],"avgPool3dBackprop");for(var i=a.strideDepth,u=a.strideHeight,l=a.strideWidth,c=a.filterDepth,f=a.filterHeight,d=a.filterWidth,v=a.dilationDepth,m=a.dilationHeight,g=a.dilationWidth,b=a.effectiveFilterDepth,w=a.effectiveFilterHeight,S=a.effectiveFilterWidth,_=b-1-a.padInfo.front,E=S-1-a.padInfo.left,R=w-1-a.padInfo.top,C=Ue(r.shape,"float32"),A=1/(c*f*d),D=this.bufferSync(e),k=0;k<a.batchSize;++k)for(var I=0;I<a.inChannels;++I)for(var N=0;N<a.inDepth;++N)for(var B=0;B<a.inHeight;++B)for(var V=0;V<a.inWidth;++V){for(var U=N-_,J=B-R,ee=V-E,te=0,P=0;P<b;P+=v){var j=(U+P)/i;if(!(j<0||j>=a.outDepth||Math.floor(j)!==j))for(var K=0;K<w;K+=m){var ne=(J+K)/u;if(!(ne<0||ne>=a.outHeight||Math.floor(ne)!==ne))for(var M=0;M<S;M+=g){var G=(ee+M)/l;G<0||G>=a.outWidth||Math.floor(G)!==G||(te+=D.get(k,j,ne,G,I))}}}C.set(te*A,k,N,B,V,I)}return C.toTensor()},t.prototype.maxPool3d=function(e,r){return he(e,"maxPool3d"),this.pool3d(e,r,"max").toFloat()},t.prototype.maxPool3dPositions=function(e,r){for(var a=Ue(r.outShape,"int32"),i=r.strideDepth,u=r.strideHeight,l=r.strideWidth,c=r.dilationDepth,f=r.dilationHeight,d=r.dilationWidth,v=r.effectiveFilterDepth,m=r.effectiveFilterHeight,g=r.effectiveFilterWidth,b=r.padInfo.front,w=r.padInfo.top,S=r.padInfo.left,_=this.bufferSync(e),E=0;E<r.batchSize;++E)for(var R=0;R<r.inChannels;++R)for(var C=0;C<r.outDepth;++C){for(var A=C*i-b,D=A;D<0;)D+=c;for(var k=Math.min(r.inDepth,v+A),I=0;I<r.outHeight;++I){for(var N=I*u-w,B=N;B<0;)B+=f;for(var V=Math.min(r.inHeight,m+N),U=0;U<r.outWidth;++U){for(var J=U*l-S,ee=J;ee<0;)ee+=d;for(var te=Math.min(r.inWidth,g+J),P=Number.NEGATIVE_INFINITY,j=-1,K=D;K<k;K+=c)for(var ne=K-A,M=B;M<V;M+=f)for(var G=M-N,ie=ee;ie<te;ie+=d){var oe=ie-J,de=_.get(E,K,M,ie,R);de>=P&&(P=de,j=ne*m*g+G*m+oe)}a.set(j,E,C,I,U,R)}}}return a.toTensor()},t.prototype.maxPool3dBackprop=function(e,r,a,i){he([r,a],"maxPool3dBackprop");for(var u=this.maxPool3dPositions(r,i),l=i.strideDepth,c=i.strideHeight,f=i.strideWidth,d=i.dilationDepth,v=i.dilationHeight,m=i.dilationWidth,g=i.effectiveFilterDepth,b=i.effectiveFilterHeight,w=i.effectiveFilterWidth,S=g-1-i.padInfo.front,_=w-1-i.padInfo.left,E=b-1-i.padInfo.top,R=Ue(r.shape,"float32"),C=this.bufferSync(u),A=this.bufferSync(e),D=0;D<i.batchSize;++D)for(var k=0;k<i.inChannels;++k)for(var I=0;I<i.inDepth;++I)for(var N=0;N<i.inHeight;++N)for(var B=0;B<i.inWidth;++B){for(var V=I-S,U=N-E,J=B-_,ee=0,te=0;te<g;te+=d){var P=(V+te)/l;if(!(P<0||P>=i.outDepth||Math.floor(P)!==P))for(var j=0;j<b;j+=v){var K=(U+j)/c;if(!(K<0||K>=i.outHeight||Math.floor(K)!==K))for(var ne=0;ne<w;ne+=m){var M=(J+ne)/f;if(!(M<0||M>=i.outWidth||Math.floor(M)!==M)){var G=g*b*w-1-C.get(D,P,K,M,k)===te*b*w+j*w+ne?1:0;G!==0&&(ee+=A.get(D,P,K,M,k)*G)}}}}R.set(ee,D,I,N,B,k)}return R.toTensor()},t.prototype.cast=function(e,r){return hS(e,r,this)},t.prototype.reshape=function(e,r){return Sm(e,r)},t.prototype.avgPool=function(e,r){return he(e,"avgPool"),this.pool(e,r,"avg").toFloat()},t.prototype.resizeBilinear=function(e,r,a,i){he(e,"resizeBilinear");for(var u=e.shape,l=u[0],c=u[1],f=u[2],d=u[3],v=this.readSync(e.dataId),m=new Float32Array(Ce([l,r,a,d])),g=[i&&r>1?c-1:c,i&&a>1?f-1:f],b=[i&&r>1?r-1:r,i&&a>1?a-1:a],w=0,S=g[0]/b[0],_=g[1]/b[1],E=0;E<l;E++)for(var R=0;R<r;R++)for(var C=S*R,A=Math.floor(C),D=C-A,k=Math.min(c-1,Math.ceil(C)),I=E*e.strides[0]+A*e.strides[1],N=E*e.strides[0]+k*e.strides[1],B=0;B<a;B++)for(var V=_*B,U=Math.floor(V),J=V-U,ee=Math.min(f-1,Math.ceil(V)),te=I+U*e.strides[2],P=N+U*e.strides[2],j=I+ee*e.strides[2],K=N+ee*e.strides[2],ne=0;ne<d;ne++){var M=v[te+ne],G=v[P+ne],ie=M+(v[j+ne]-M)*J,oe=ie+(G+(v[K+ne]-G)*J-ie)*D;m[w++]=oe}return mn(m,[l,r,a,d])},t.prototype.resizeBilinearBackprop=function(e,r,a){he([e,r],"resizeBilinearBackprop");for(var i=r.shape,u=i[0],l=i[1],c=i[2],f=i[3],d=e.shape,v=d[1],m=d[2],g=new Float32Array(u*l*c*f),b=[a&&v>1?l-1:l,a&&m>1?c-1:c],w=[a&&v>1?v-1:v,a&&m>1?m-1:m],S=b[0]/w[0],_=b[1]/w[1],E=this.readSync(e.dataId),R=0,C=0;C<u;C++)for(var A=C*r.strides[0],D=0;D<v;D++)for(var k=D*S,I=Math.floor(k),N=Math.min(Math.ceil(k),l-1),B=A+I*r.strides[1],V=A+N*r.strides[1],U=k-I,J=1-U,ee=0;ee<m;ee++)for(var te=ee*_,P=Math.floor(te),j=Math.min(Math.ceil(te),c-1),K=te-P,ne=1-K,M=B+P*r.strides[2],G=B+j*r.strides[2],ie=V+P*r.strides[2],oe=V+j*r.strides[2],de=J*ne,me=J*K,pe=U*ne,ke=U*K,ye=0;ye<f;ye++){var Ne=E[R++];g[M+ye]+=Ne*de,g[G+ye]+=Ne*me,g[ie+ye]+=Ne*pe,g[oe+ye]+=Ne*ke}return Bn(g,[u,c,l,f],r.dtype)},t.prototype.resizeNearestNeighbor=function(e,r,a,i){he(e,"resizeNearestNeighbor");for(var u=e.shape,l=u[0],c=u[1],f=u[2],d=u[3],v=this.readSync(e.dataId),m=new Float32Array(l*r*a*d),g=[i&&r>1?c-1:c,i&&a>1?f-1:f],b=[i&&r>1?r-1:r,i&&a>1?a-1:a],w=g[0]/b[0],S=g[1]/b[1],_=0,E=0;E<l;E++)for(var R=E*e.strides[0],C=0;C<r;C++)for(var A=w*C,D=R+Math.min(c-1,i?Math.round(A):Math.floor(A))*e.strides[1],k=0;k<a;k++)for(var I=S*k,N=D+Math.min(f-1,i?Math.round(I):Math.floor(I))*e.strides[2],B=0;B<d;B++){var V=v[N+B];m[_++]=V}return mn(m,[l,r,a,d],e.dtype)},t.prototype.resizeNearestNeighborBackprop=function(e,r,a){he([e,r],"resizeNearestNeighborBackprop");for(var i=r.shape,u=i[0],l=i[1],c=i[2],f=i[3],d=e.shape,v=d[1],m=d[2],g=new Float32Array(u*l*c*f),b=this.readSync(e.dataId),w=[a&&v>1?l-1:l,a&&m>1?c-1:c],S=[a&&v>1?v-1:v,a&&m>1?m-1:m],_=w[0]/S[0],E=w[1]/S[1],R=1/_,C=1/E,A=2*Math.ceil(R)+2,D=2*Math.ceil(C)+2,k=0;k<u;k++)for(var I=k*r.strides[0],N=0;N<l;N++)for(var B=I+N*r.strides[1],V=Math.floor(N*R),U=Math.floor(V-A/2),J=0;J<c;J++)for(var ee=B+J*r.strides[2],te=Math.floor(J*C),P=Math.floor(te-D/2),j=0;j<f;j++){for(var K=0,ne=0;ne<A;ne++){var M=ne+U;if(!(M<0||M>=v)){var G=I+M*e.strides[1],ie=M*_;if(N===Math.min(l-1,a?Math.round(ie):Math.floor(ie)))for(var oe=0;oe<D;oe++){var de=oe+P;if(!(de<0||de>=m)){var me=G+de*e.strides[2],pe=de*E;J===Math.min(c-1,a?Math.round(pe):Math.floor(pe))&&(K+=b[me+j])}}}}g[ee+j]=K}return Bn(g,r.shape,r.dtype)},t.prototype.batchNormalization=function(e,r,a,i,u,l){he([e,r,a,u,l],"batchNorm");for(var c=this.readSync(e.dataId),f=this.readSync(r.dataId),d=this.readSync(a.dataId),v=u?this.readSync(u.dataId):new Float32Array([1]),m=l?this.readSync(l.dataId):new Float32Array([0]),g=new Float32Array(c.length),b=m.length,w=v.length,S=d.length,_=f.length,E=0,R=0,C=0,A=0,D=0;D<c.length;++D)g[D]=m[E++]+(c[D]-f[R++])*v[C++]/Math.sqrt(d[A++]+i),E>=b&&(E=0),R>=_&&(R=0),C>=w&&(C=0),A>=S&&(A=0);return Bn(g,e.shape)},t.prototype.localResponseNormalization4D=function(e,r,a,i,u){he(e,"localResponseNormalization4D");var l=e.shape[3],c=l-1,f=this.readSync(e.dataId),d=e.size,v=new Float32Array(d);function m(S){for(var _=S%l,E=S-_+Math.max(0,_-r),R=S-_+Math.min(_+r,c),C=0;E<=R;E++){var A=f[E];C+=A*A}return C}for(var g=0;g<d;g++){var b=m(g),w=f[g]*Math.pow(a+i*b,-u);v[g]=w}return Bn(v,e.shape)},t.prototype.LRNGrad=function(e,r,a,i,u,l,c){he(e,"LRNGrad");for(var f=e.shape[3],d=this.readSync(e.dataId),v=this.readSync(r.dataId),m=this.readSync(a.dataId),g=new Float32Array(e.size),b=e.size,w=0;w<b;w++){for(var S=w%f,_=w-S+Math.max(0,S-i),E=w-S+Math.min(f,S+i+1),R=0,C=_;C<E;C++)R+=Math.pow(v[C],2);for(R=l*R+u,C=_;C<E;C++){var A=-2*l*c*v[C]*m[w]/R;w===C&&(A+=Math.pow(R,-c)),A*=d[w],g[C]+=A}}return Bn(g,e.shape)},t.prototype.multinomial=function(e,r,a,i){he(e,"multinomial");for(var u=r?e:Ma(e),l=u.shape[0],c=u.shape[1],f=St([l,a],"int32"),d=this.readSync(f.dataId),v=this.readSync(u.dataId),m=0;m<l;++m){var g=m*c,b=new Float32Array(c-1);b[0]=v[g];for(var w=1;w<b.length;++w)b[w]=b[w-1]+v[g+w];for(var S=vh(i.toString()),_=m*a,E=0;E<a;++E){var R=S();d[_+E]=b.length;for(var C=0;C<b.length;C++)if(R<b[C]){d[_+E]=C;break}}}return f},t.prototype.oneHot=function(e,r,a,i){he(e,"oneHot");var u=new Float32Array(e.size*r);u.fill(i);for(var l=this.readSync(e.dataId),c=0;c<e.size;++c)l[c]>=0&&l[c]<r&&(u[c*r+l[c]]=a);return _i(u,[e.size,r],"int32")},t.prototype.nonMaxSuppression=function(e,r,a,i,u){return he(e,"nonMaxSuppression"),og(this.readSync(e.dataId),this.readSync(r.dataId),a,i,u)},t.prototype.fft=function(e){return this.fftBatch(e,!1)},t.prototype.ifft=function(e){return this.fftBatch(e,!0)},t.prototype.fftBatch=function(e,r){for(var a=e.shape[0],i=e.shape[1],u=Ue(e.shape,"float32"),l=Ue(e.shape,"float32"),c=mr(e).as2D(a,i),f=Kr(e).as2D(a,i),d=0;d<a;d++)for(var v=c.slice([d,0],[1,i]),m=f.slice([d,0],[1,i]),g=pn(v,m),b=this.readSync(this.fftImpl(g,r).dataId),w=0;w<i;w++){var S=kw(b,w);u.values[d*i+w]=S.real,l.values[d*i+w]=S.imag}return pn(u.toTensor(),l.toTensor()).as2D(a,i)},t.prototype.fftImpl=function(e,r){var a=e.as1D(),i=a.size;if(this.isExponentOf2(i)){var u=this.fftRadix2(a,i,r).as2D(e.shape[0],e.shape[1]);return r&&(u=pn(mr(u).div(ge(i)),Kr(u).div(ge(i)))),u}var l=this.readSync(e.dataId),c=function(f){for(var d=new Float32Array(f.length/2),v=new Float32Array(f.length/2),m=0;m<f.length;m+=2)d[m/2]=f[m],v[m/2]=f[m+1];return{real:d,imag:v}}(this.fourierTransformByMatmul(l,i,r));return pn(c.real,c.imag).as2D(e.shape[0],e.shape[1])},t.prototype.isExponentOf2=function(e){return(e&e-1)==0},t.prototype.fftRadix2=function(e,r,a){if(r===1)return e;var i=this.readSync(e.dataId),u=r/2,l=function(_){for(var E=Math.ceil(_.length/4),R=new Float32Array(E),C=new Float32Array(E),A=0;A<_.length;A+=4)R[Math.floor(A/4)]=_[A],C[Math.floor(A/4)]=_[A+1];return{real:R,imag:C}}(i),c=pn(l.real,l.imag).as1D(),f=function(_){for(var E=Math.floor(_.length/4),R=new Float32Array(E),C=new Float32Array(E),A=2;A<_.length;A+=4)R[Math.floor(A/4)]=_[A],C[Math.floor(A/4)]=_[A+1];return{real:R,imag:C}}(i),d=pn(f.real,f.imag).as1D();c=this.fftRadix2(c,u,a),d=this.fftRadix2(d,u,a);var v=function(_,E){for(var R=new Float32Array(_/2),C=new Float32Array(_/2),A=0;A<Math.ceil(_/2);A++){var D=(E?2:-2)*Math.PI*(A/_);R[A]=Math.cos(D),C[A]=Math.sin(D)}return{real:R,imag:C}}(r,a),m=pn(v.real,v.imag).mul(d),g=c.add(m),b=c.sub(m),w=mr(g).concat(mr(b)),S=Kr(g).concat(Kr(b));return pn(w,S).as1D()},t.prototype.fourierTransformByMatmul=function(e,r,a){for(var i=new Float32Array(2*r),u=0;u<r;u++){for(var l=0,c=0,f=0;f<r;f++){var d=L3(u*f,r,a),v=kw(e,f);l+=v.real*d.real-v.imag*d.imag,c+=v.real*d.imag+v.imag*d.real}a&&(l/=r,c/=r),B3(i,l,c,u)}return i},t.prototype.depthToSpace=function(e,r,a){L(a==="NHWC",function(){return"Only NHWC dataFormat supported on CPU for depthToSpace. Got "+a}),L(r>1,function(){return"blockSize should be > 1 for depthToSpace, but was: "+r});for(var i=e.shape[0],u=e.shape[1],l=e.shape[2],c=e.shape[3],f=u*r,d=l*r,v=c/(r*r),m=this.readSync(e.dataId),g=new Float32Array(i*f*d*v),b=0,w=0;w<i;++w)for(var S=0;S<f;++S)for(var _=Math.floor(S/r),E=S%r,R=0;R<d;++R)for(var C=Math.floor(R/r),A=(E*r+R%r)*v,D=0;D<v;++D){var k=D+A+c*(C+l*(_+u*w));g[b++]=m[k]}return Bn(g,[i,f,d,v])},t.prototype.broadcastedBinaryOp=function(e,r,a,i){var u=et(e.shape,r.shape),l=Ue(u,a),c=this.readSync(e.dataId),f=this.readSync(r.dataId),d=mi(e.shape,u),v=mi(r.shape,u),m=l.values;if(d.length+v.length===0)for(var g=0;g<m.length;++g)m[g]=i(c[g%c.length],f[g%f.length]);else{var b=this.bufferSync(e),w=this.bufferSync(r),S=function(_){var E=l.indexToLoc(_),R=E.slice(-e.rank);d.forEach(function(k){return R[k]=0});var C=b.locToIndex(R),A=E.slice(-r.rank);v.forEach(function(k){return A[k]=0});var D=w.locToIndex(A);m[_]=i(c[C],f[D])};for(g=0;g<m.length;++g)S(g)}return l.toTensor()},t.prototype.broadcastedBinaryComplexOp=function(e,r,a){var i=et(e.shape,r.shape),u=Ue(i,"float32"),l=Ue(i,"float32"),c=this.readSync(e.dataId),f=this.readSync(r.dataId),d=mi(e.shape,i),v=mi(r.shape,i),m=u.values,g=l.values;if(d.length+v.length===0)for(var b=0;b<m.length;b++){var w=b%c.length,S=b%f.length,_=a(c[2*w],c[2*w+1],f[2*S],f[2*S+1]);m[b]=_.real,g[b]=_.imag}else{var E=this.bufferSync(this.data.get(e.dataId).complexTensors.real),R=this.bufferSync(this.data.get(r.dataId).complexTensors.real),C=function(A){var D=u.indexToLoc(A),k=D.slice(-e.rank);d.forEach(function(U){return k[U]=0});var I=E.locToIndex(k),N=D.slice(-r.rank);v.forEach(function(U){return N[U]=0});var B=R.locToIndex(N),V=a(c[2*I],c[2*I+1],f[2*B],f[2*B+1]);m[A]=V.real,g[A]=V.imag};for(b=0;b<m.length;b++)C(b)}return this.complex(u.toTensor(),l.toTensor())},t.prototype.split=function(e,r,a){return vS(e,r,a)},t.prototype.dispose=function(){},t.prototype.floatPrecision=function(){return 32},t.prototype.epsilon=function(){return 1e-7},t.prototype.cropAndResize=function(e,r,a,i,u,l){for(var c=e.shape,f=c[0],d=c[1],v=c[2],m=c[3],g=r.shape[0],b=i[0],w=i[1],S=Ue([g,b,w,m],"float32"),_=this.readSync(r.dataId),E=this.readSync(a.dataId),R=this.readSync(e.dataId),C=e.strides,A=S.strides,D=0;D<g;D++){var k=4*D,I=_[k],N=_[k+1],B=_[k+2],V=_[k+3],U=E[D];if(!(U>=f))for(var J=b>1?(B-I)*(d-1)/(b-1):0,ee=w>1?(V-N)*(v-1)/(w-1):0,te=0;te<b;te++){var P=b>1?I*(d-1)+te*J:.5*(I+B)*(d-1);if(P<0||P>d-1)for(var j=0;j<w;j++)for(var K=0;K<m;K++){var ne=K+j*A[2]+te*A[1]+D*A[0];S.values[ne]=l}else if(u==="bilinear"){var M=Math.floor(P),G=Math.ceil(P),ie=P-M;for(j=0;j<w;j++)if((Fe=w>1?N*(v-1)+j*ee:.5*(N+V)*(v-1))<0||Fe>v-1)for(K=0;K<m;K++)ne=K+j*A[2]+te*A[1]+D*A[0],S.values[ne]=l;else{var oe=Math.floor(Fe),de=Math.ceil(Fe),me=Fe-oe;for(K=0;K<m;K++){var pe=R[ne=K+oe*C[2]+M*C[1]+U*C[0]],ke=R[ne=K+de*C[2]+M*C[1]+U*C[0]],ye=R[ne=K+oe*C[2]+G*C[1]+U*C[0]],Ne=pe+(ke-pe)*me,at=ye+(R[ne=K+de*C[2]+G*C[1]+U*C[0]]-ye)*me;ne=K+j*A[2]+te*A[1]+D*A[0],S.values[ne]=Ne+(at-Ne)*ie}}}else for(j=0;j<w;++j){var Fe;if((Fe=w>1?N*(v-1)+j*ee:.5*(N+V)*(v-1))<0||Fe>v-1)for(K=0;K<m;K++)ne=K+j*A[2]+te*A[1]+D*A[0],S.values[ne]=l;else{var je=Math.round(Fe),Ke=Math.round(P);for(K=0;K<m;K++){var ut=K+je*C[2]+Ke*C[1]+U*C[0],yt=K+j*A[2]+te*A[1]+D*A[0];S.values[yt]=R[ut]}}}}}return S.toTensor()},t.prototype.sparseToDense=function(e,r,a,i){var u=Xf(0,e,a),l=u.sliceRank,c=u.numUpdates,f=u.sliceSize,d=u.strides,v=u.outputSize;return this.scatter(e,r,a,v,f,c,l,d,i,!1)},t.prototype.gatherND=function(e,r){var a=r.shape,i=a[a.length-1],u=iS(e,r),l=u[0],c=u[1],f=u[2],d=u[3];if(c===0)return mn([],l,e.dtype);for(var v=new fl([c,f],e.dtype),m=this.readSync(r.dataId),g=this.readSync(e.dataId),b=0;b<c;b++){for(var w=[],S=0,_=0;_<i;_++){var E=m[b*i+_];S+=E*d[_],w.push(E)}if(S<0||S>=e.size/f)throw new Error("Invalid indices: "+w+" does not index into "+e.shape);for(var R=0;R<f;R++)v.values[b*f+R]=g[S*f+R]}return v.toTensor().reshape(l)},t.prototype.scatterND=function(e,r,a){var i=Xf(0,e,a),u=i.sliceRank,l=i.numUpdates,c=i.sliceSize,f=i.strides,d=i.outputSize,v=ge(0);return this.scatter(e,r,a,d,c,l,u,f,v,!0)},t.prototype.fill=function(e,r,a){var i=Pf(a=a||Sl(r),Ce(e));return i.fill(r),q.makeTensor(i,e,a,this)},t.prototype.onesLike=function(e){if(e.dtype==="string")throw new Error("onesLike is not supported for string tensors");return this.fill(e.shape,1,e.dtype)},t.prototype.zerosLike=function(e){var r=Pf(e.dtype,Ce(e.shape));return this.makeOutput(r,e.shape,e.dtype)},t.prototype.linspace=function(e,r,a){return dS(e,r,a)},t.prototype.scatter=function(e,r,a,i,u,l,c,f,d,v){var m=[i/u,u],g=this.readSync(e.dataId),b=this.readSync(r.dataId);if(i===0)return mn([],a,r.dtype);var w=new fl(m,r.dtype);w.values.fill(this.readSync(d.dataId)[0]);for(var S=0;S<l;S++){for(var _=[],E=0,R=0;R<c;R++){var C=g[S*c+R];_.push(C),E+=C*f[R]}if(E<0||E>=i/u)throw new Error("Invalid indices: "+_+" does not index into "+a);for(var A=0;A<u;A++)v?w.values[E*u+A]+=b[S*u+A]:w.values[E*u+A]=r.rank===0?b[0]:b[S*u+A]}return w.toTensor().reshape(a)},t}(cS);q.registerBackend("cpu",function(){return new rB},1);for(var Dv=0,Zw=[{kernelName:"NonMaxSuppressionV5",backendName:"cpu",kernelFunc:function(n){var t=n.inputs,e=n.backend,r=n.attrs,a=t,i=a.boxes,u=a.scores,l=r,c=l.maxOutputSize,f=l.iouThreshold,d=l.scoreThreshold,v=l.softNmsSigma,m=e;he(i,"NonMaxSuppressionWithScore");var g=sg(m.data.get(i.dataId).values,m.data.get(u.dataId).values,c,f,d,v);return[g.selectedIndices,g.selectedScores]}},{kernelName:"Square",backendName:"cpu",kernelFunc:function(n){var t=n.inputs,e=n.backend,r=t.x,a=e;he(r,"square");for(var i=a.data.get(r.dataId).values,u=new Float32Array(i.length),l=0;l<i.length;++l){var c=i[l];u[l]=c*c}return{dataId:a.write(u,r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}},{kernelName:pl,backendName:"cpu",kernelFunc:function(n){var t=n.inputs,e=n.backend,r=t,a=r.a,i=r.b,u=e;he([a,i],pl);var l=u.data.get(a.dataId).values,c=u.data.get(i.dataId).values,f=function(m,g,b,w,S,_){var E=et(m,g),R=E.length,C=Zr(E),A=cl(S,Ce(E)),D=m.length,k=g.length,I=Zr(m),N=Zr(g),B=mi(m,E),V=mi(g,E);if(B.length+V.length===0)for(var U=0;U<A.length;++U)A[U]=_(b[U%b.length],w[U%w.length]);else{var J=function(ee){var te=dN(ee,R,C),P=te.slice(-D);B.forEach(function(M){return P[M]=0});var j=ww(P,D,I),K=te.slice(-k);V.forEach(function(M){return K[M]=0});var ne=ww(K,k,N);A[ee]=_(b[j],w[ne])};for(U=0;U<A.length;++U)J(U)}return[A,E]}(a.shape,i.shape,l,c,a.dtype,function(m,g){var b=m-g;return b*b}),d=f[0],v=f[1];return{dataId:u.write(d,v,a.dtype),shape:v,dtype:a.dtype}}}];Dv<Zw.length;Dv++)P_(Zw[Dv]);var os,aB=function(n){this.variableNames=["A"];var t=Sn(),e=n[0],r=n[1];this.outputShape=n,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(`+r+".0, "+e+`.0);

        vec4 values = `+t.texture2D+`(A, uv);
        float value;
        if (depth == 0) {
          value = values.r;
        } else if (depth == 1) {
          value = values.g;
        } else if (depth == 2) {
          value = values.b;
        } else if (depth == 3) {
          value = values.a;
        }

        setOutput(floor(value * 255.0 + 0.5));
      }
    `},iB=function(n){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;var t=Sn(),e=n[0],r=n[1];this.outputShape=n,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];

        vec4 result = vec4(0.);

        for(int row=0; row<=1; row++) {
          for(int col=0; col<=1; col++) {
            texC = coords[1] + row;
            depth = coords[2] + col;

            vec2 uv = (vec2(texC, texR) + halfCR) /
                       vec2(`+r+".0, "+e+`.0);
            vec4 values = `+t.texture2D+`(A, uv);
            float value;
            if (depth == 0) {
              value = values.r;
            } else if (depth == 1) {
              value = values.g;
            } else if (depth == 2) {
              value = values.b;
            } else if (depth == 3) {
              value = values.a;
            }

            result[row * 2 + col] = floor(value * 255.0 + 0.5);
          }
        }

        `+t.output+` = result;
      }
    `};for(var kv=0,Jw=[{kernelName:"FromPixels",backendName:"webgl",kernelFunc:function(n){var t=n.inputs,e=n.backend,r=n.attrs,a=t.pixels,i=r.numChannels,u=typeof HTMLVideoElement<"u"&&a instanceof HTMLVideoElement,l=typeof HTMLImageElement<"u"&&a instanceof HTMLImageElement,c=u?[a.videoWidth,a.videoHeight]:[a.width,a.height],f=c[0],d=c[1],v=[d,f],m=[d,f,i];(l||u)&&(os==null&&(os=document.createElement("canvas").getContext("2d")),os.canvas.width=f,os.canvas.height=d,os.drawImage(a,0,0,f,d),a=os.canvas);var g=e.makeTensorInfo(v,"int32");e.texData.get(g.dataId).usage=Zn.PIXELS,e.gpgpu.uploadPixelDataToTexture(e.getTexture(g.dataId),a);var b=ue().getBool("WEBGL_PACK")?new iB(m):new aB(m),w=e.runWebGLProgram(b,[g],"int32");return e.disposeData(g.dataId),w}},{kernelName:"NonMaxSuppressionV5",backendName:"webgl",kernelFunc:function(n){var t=n.inputs,e=n.backend,r=n.attrs;Hf("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");var a=t,i=a.boxes,u=a.scores,l=r,c=l.maxOutputSize,f=l.iouThreshold,d=l.scoreThreshold,v=l.softNmsSigma,m=e,g=sg(m.readSync(i.dataId),m.readSync(u.dataId),c,f,d,v);return[g.selectedIndices,g.selectedScores]}},{kernelName:"Square",backendName:"webgl",kernelFunc:function(n){var t=n.inputs,e=n.backend,r=t.x,a=e,i=new Ge(r.shape,"return x * x;");return a.runWebGLProgram(i,[r],r.dtype)}},{kernelName:pl,backendName:"webgl",kernelFunc:function(n){var t=n.inputs,e=n.backend,r=t,a=r.a,i=r.b,u=e,l=ue().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Ea("return (a - b) * (a - b);",a.shape,i.shape):new Nt("return (a - b) * (a - b);",a.shape,i.shape);return u.compileAndRun(l,[a,i])}}];kv<Jw.length;kv++)P_(Jw[kv]);for(var Ov=0,e2=[{kernelName:"Square",gradFunc:function(n,t){var e=t[0];return{x:function(){return n.mul(e.toFloat().mul(2))}}}},{kernelName:pl,gradFunc:function(n,t){var e=t[0],r=t[1],a=ge(2);return{a:function(){return Cn(n,Cn(a,Zt(e,r)))},b:function(){return Cn(n,Cn(a,Zt(r,e)))}}}}];Ov<e2.length;Ov++)nN(e2[Ov]);var oB=function(){function n(){}return n.prototype.fetch=function(t,e){return fetch(t,e)},n.prototype.now=function(){return performance.now()},n.prototype.encode=function(t,e){if(e!=="utf-8"&&e!=="utf8")throw new Error("Browser's encoder only supports utf-8, but got "+e);return this.textEncoder==null&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(t)},n.prototype.decode=function(t,e){return new TextDecoder(e).decode(t)},n}();ue().get("IS_BROWSER")&&ue().setPlatform("browser",new oB);var Nv,sB=function(){return require("node-fetch")},uB=function(){function n(){this.util=require("util"),this.textEncoder=new this.util.TextEncoder}return n.prototype.fetch=function(t,e){return ue().global.fetch!=null?ue().global.fetch(t,e):(Nv==null&&(Nv=sB()),Nv(t,e))},n.prototype.now=function(){var t=process.hrtime();return 1e3*t[0]+t[1]/1e6},n.prototype.encode=function(t,e){if(e!=="utf-8"&&e!=="utf8")throw new Error("Node built-in encoder only supports utf-8, but got "+e);return this.textEncoder.encode(t)},n.prototype.decode=function(t,e){return t.length===0?"":new this.util.TextDecoder(e).decode(t)},n}();ue().get("IS_NODE")&&ue().setPlatform("node",new uB);var Rm={float32:4,int32:4,uint16:2,uint8:1,bool:1},th=4;function sE(n,t){for(var e={},r=0,a=function(l){var c=l.name,f=l.dtype,d=l.shape,v=Ce(d),m=void 0;if("quantization"in l){var g=l.quantization;if(g.dtype!=="uint8"&&g.dtype!=="uint16")throw new Error("Weight "+l.name+" has unknown quantization dtype "+g.dtype+". Supported quantization dtypes are: 'uint8' and 'uint16'.");var b=Rm[g.dtype],w=n.slice(r,r+v*b),S=g.dtype==="uint8"?new Uint8Array(w):new Uint16Array(w);if(f==="float32")m=Float32Array.from(S,function(D){return D*g.scale+g.min});else{if(f!=="int32")throw new Error("Unsupported dtype in weight '"+c+"': "+f);m=Int32Array.from(S,function(D){return Math.round(D*g.scale+g.min)})}r+=v*b}else if(f==="string"){var _=Ce(l.shape);m=[];for(var E=0;E<_;E++){var R=new Uint32Array(n.slice(r,r+th))[0];r+=th;var C=new Uint8Array(n.slice(r,r+R));m.push(C),r+=R}}else{var A=Rm[f];if(w=n.slice(r,r+v*A),f==="float32")m=new Float32Array(w);else if(f==="int32")m=new Int32Array(w);else{if(f!=="bool")throw new Error("Unsupported dtype in weight '"+c+"': "+f);m=new Uint8Array(w)}r+=v*A}e[c]=mn(m,d,f)},i=0,u=t;i<u.length;i++)a(u[i]);return e}function lB(n){if(n===null)throw new Error("Invalid input value: "+JSON.stringify(n));var t=0,e=[];n.forEach(function(i){if(t+=i.byteLength,e.push(i.byteLength===i.buffer.byteLength?i:new i.constructor(i)),!(i instanceof Float32Array||i instanceof Int32Array||i instanceof Uint8Array))throw new Error("Unsupported TypedArray subtype: "+i.constructor.name)});var r=new Uint8Array(t),a=0;return e.forEach(function(i){r.set(new Uint8Array(i.buffer),a),a+=i.byteLength}),r.buffer}var Am=typeof Buffer<"u"&&(typeof Blob>"u"||typeof atob>"u"||typeof btoa>"u");function t2(n){return Am?Buffer.byteLength(n):new Blob([n]).size}function Rg(n){var t=0;n.forEach(function(a){t+=a.byteLength});var e=new Uint8Array(t),r=0;return n.forEach(function(a){e.set(new Uint8Array(a),r),r+=a.byteLength}),e.buffer}function n2(n){for(n=n.trim();n.endsWith("/");)n=n.slice(0,n.length-1);var t=n.split("/");return t[t.length-1]}function kl(n){if(n.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:n.modelTopology==null?0:t2(JSON.stringify(n.modelTopology)),weightSpecsBytes:n.weightSpecs==null?0:t2(JSON.stringify(n.weightSpecs)),weightDataBytes:n.weightData==null?0:n.weightData.byteLength}}var Jn=function(){function n(){this.saveRouters=[],this.loadRouters=[]}return n.getInstance=function(){return n.instance==null&&(n.instance=new n),n.instance},n.registerSaveRouter=function(t){n.getInstance().saveRouters.push(t)},n.registerLoadRouter=function(t){n.getInstance().loadRouters.push(t)},n.getSaveHandlers=function(t){return n.getHandlers(t,"save")},n.getLoadHandlers=function(t,e){return n.getHandlers(t,"load",e)},n.getHandlers=function(t,e,r){var a=[];return(e==="load"?n.getInstance().loadRouters:n.getInstance().saveRouters).forEach(function(i){var u=i(t,r);u!==null&&a.push(u)}),a},n}(),bs="://",Si=function(){function n(){this.managers={}}return n.getInstance=function(){return n.instance==null&&(n.instance=new n),n.instance},n.registerManager=function(t,e){L(t!=null,function(){return"scheme must not be undefined or null."}),t.endsWith(bs)&&(t=t.slice(0,t.indexOf(bs))),L(t.length>0,function(){return"scheme must not be an empty string."});var r=n.getInstance();L(r.managers[t]==null,function(){return"A model store manager is already registered for scheme '"+t+"'."}),r.managers[t]=e},n.getManager=function(t){var e=this.getInstance().managers[t];if(e==null)throw new Error("Cannot find model manager for scheme '"+t+"'");return e},n.getSchemes=function(){return Object.keys(this.getInstance().managers)},n}();function bf(n){if(n.indexOf(bs)===-1)throw new Error("The url string provided does not contain a scheme. Supported schemes are: "+Si.getSchemes().join(","));return{scheme:n.split(bs)[0],path:n.split(bs)[1]}}function r2(n,t,e){return e===void 0&&(e=!1),_e(this,void 0,void 0,function(){var r,a,i,u,l,c,f,d,v;return Se(this,function(m){switch(m.label){case 0:return L(n!==t,function(){return"Old path and new path are the same: '"+n+"'"}),L((r=Jn.getLoadHandlers(n)).length>0,function(){return"Copying failed because no load handler is found for source URL "+n+"."}),L(r.length<2,function(){return"Copying failed because more than one ("+r.length+") load handlers for source URL "+n+"."}),a=r[0],L((i=Jn.getSaveHandlers(t)).length>0,function(){return"Copying failed because no save handler is found for destination URL "+t+"."}),L(i.length<2,function(){return"Copying failed because more than one ("+r.length+") save handlers for destination URL "+t+"."}),u=i[0],l=bf(n).scheme,c=bf(n).path,f=l===bf(n).scheme,[4,a.load()];case 1:return d=m.sent(),e&&f?[4,Si.getManager(l).removeModel(c)]:[3,3];case 2:m.sent(),m.label=3;case 3:return[4,u.save(d)];case 4:return v=m.sent(),!e||f?[3,6]:[4,Si.getManager(l).removeModel(c)];case 5:m.sent(),m.label=6;case 6:return[2,v.modelArtifactsInfo]}})})}var no="models_store",gi="model_info_store";function uE(){if(!ue().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");var n=window||self,t=n.indexedDB||n.mozIndexedDB||n.webkitIndexedDB||n.msIndexedDB||n.shimIndexedDB;if(t==null)throw new Error("The current browser does not appear to support IndexedDB.");return t}function Tm(n){var t=n.result;t.createObjectStore(no,{keyPath:"modelPath"}),t.createObjectStore(gi,{keyPath:"modelPath"})}var xs=function(){function n(t){if(this.indexedDB=uE(),t==null||!t)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=t}return n.prototype.save=function(t){return _e(this,void 0,void 0,function(){return Se(this,function(e){if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return[2,this.databaseAction(this.modelPath,t)]})})},n.prototype.load=function(){return _e(this,void 0,void 0,function(){return Se(this,function(t){return[2,this.databaseAction(this.modelPath)]})})},n.prototype.databaseAction=function(t,e){var r=this;return new Promise(function(a,i){var u=r.indexedDB.open("tensorflowjs",1);u.onupgradeneeded=function(){return Tm(u)},u.onsuccess=function(){var l=u.result;if(e==null){var c=l.transaction(no,"readonly"),f=c.objectStore(no).get(r.modelPath);f.onsuccess=function(){if(f.result==null)return l.close(),i(new Error("Cannot find model with path '"+r.modelPath+"' in IndexedDB."));a(f.result.modelArtifacts)},f.onerror=function(w){return l.close(),i(f.error)},c.oncomplete=function(){return l.close()}}else{var d,v=kl(e),m=l.transaction(gi,"readwrite"),g=m.objectStore(gi),b=g.put({modelPath:r.modelPath,modelArtifactsInfo:v});b.onsuccess=function(){var w=(d=l.transaction(no,"readwrite")).objectStore(no).put({modelPath:r.modelPath,modelArtifacts:e,modelArtifactsInfo:v});w.onsuccess=function(){return a({modelArtifactsInfo:v})},w.onerror=function(S){var _=(g=m.objectStore(gi)).delete(r.modelPath);_.onsuccess=function(){return l.close(),i(w.error)},_.onerror=function(E){return l.close(),i(w.error)}}},b.onerror=function(w){return l.close(),i(b.error)},m.oncomplete=function(){d==null?l.close():d.oncomplete=function(){return l.close()}}}},u.onerror=function(l){return i(u.error)}})},n.URL_SCHEME="indexeddb://",n}(),a2=function(n){return ue().getBool("IS_BROWSER")&&!Array.isArray(n)&&n.startsWith(xs.URL_SCHEME)?(t=n.slice(xs.URL_SCHEME.length),new xs(t)):null;var t};Jn.registerSaveRouter(a2),Jn.registerLoadRouter(a2);var cB=function(){function n(){this.indexedDB=uE()}return n.prototype.listModels=function(){return _e(this,void 0,void 0,function(){var t=this;return Se(this,function(e){return[2,new Promise(function(r,a){var i=t.indexedDB.open("tensorflowjs",1);i.onupgradeneeded=function(){return Tm(i)},i.onsuccess=function(){var u=i.result,l=u.transaction(gi,"readonly"),c=l.objectStore(gi).getAll();c.onsuccess=function(){for(var f={},d=0,v=c.result;d<v.length;d++){var m=v[d];f[m.modelPath]=m.modelArtifactsInfo}r(f)},c.onerror=function(f){return u.close(),a(c.error)},l.oncomplete=function(){return u.close()}},i.onerror=function(u){return a(i.error)}})]})})},n.prototype.removeModel=function(t){return _e(this,void 0,void 0,function(){var e=this;return Se(this,function(r){var a;return t=(a=t).startsWith(xs.URL_SCHEME)?a.slice(xs.URL_SCHEME.length):a,[2,new Promise(function(i,u){var l=e.indexedDB.open("tensorflowjs",1);l.onupgradeneeded=function(){return Tm(l)},l.onsuccess=function(){var c,f=l.result,d=f.transaction(gi,"readwrite"),v=d.objectStore(gi),m=v.get(t);m.onsuccess=function(){if(m.result==null)return f.close(),u(new Error("Cannot find model with path '"+t+"' in IndexedDB."));var g=v.delete(t),b=function(){var w=(c=f.transaction(no,"readwrite")).objectStore(no).delete(t);w.onsuccess=function(){return i(m.result.modelArtifactsInfo)},w.onerror=function(S){return u(m.error)}};g.onsuccess=b,g.onerror=function(w){return b(),f.close(),u(m.error)}},m.onerror=function(g){return f.close(),u(m.error)},d.oncomplete=function(){c==null?f.close():c.oncomplete=function(){return f.close()}}},l.onerror=function(c){return u(l.error)}})]})})},n}();if(ue().getBool("IS_BROWSER"))try{Si.registerManager(xs.URL_SCHEME,new cB)}catch{}var Ra="/",ps="tensorflowjs_models",lE="info",fB="model_topology",hB="weight_specs",dB="weight_data",pB="model_metadata";function cE(n){return{info:[ps,n,lE].join(Ra),topology:[ps,n,fB].join(Ra),weightSpecs:[ps,n,hB].join(Ra),weightData:[ps,n,dB].join(Ra),modelMetadata:[ps,n,pB].join(Ra)}}function vB(n){var t=n.split(Ra);if(t.length<3)throw new Error("Invalid key format: "+n);return t.slice(1,t.length-1).join(Ra)}var ws=function(){function n(t){if(!ue().getBool("IS_BROWSER")||typeof window>"u"||window.localStorage===void 0)throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,t==null||!t)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=t,this.keys=cE(this.modelPath)}return n.prototype.save=function(t){return _e(this,void 0,void 0,function(){var e,r,a;return Se(this,function(i){if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");e=JSON.stringify(t.modelTopology),r=JSON.stringify(t.weightSpecs),a=kl(t);try{return this.LS.setItem(this.keys.info,JSON.stringify(a)),this.LS.setItem(this.keys.topology,e),this.LS.setItem(this.keys.weightSpecs,r),this.LS.setItem(this.keys.weightData,function(u){if(Am)return Buffer.from(u).toString("base64");for(var l=new Uint8Array(u),c="",f=0,d=l.length;f<d;f++)c+=String.fromCharCode(l[f]);return btoa(c)}(t.weightData)),this.LS.setItem(this.keys.modelMetadata,JSON.stringify({format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,userDefinedMetadata:t.userDefinedMetadata})),[2,{modelArtifactsInfo:a}]}catch{throw this.LS.removeItem(this.keys.info),this.LS.removeItem(this.keys.topology),this.LS.removeItem(this.keys.weightSpecs),this.LS.removeItem(this.keys.weightData),this.LS.removeItem(this.keys.modelMetadata),new Error("Failed to save model '"+this.modelPath+"' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes="+a.modelTopologyBytes+", weightSpecsBytes="+a.weightSpecsBytes+", weightDataBytes="+a.weightDataBytes+".")}return[2]})})},n.prototype.load=function(){return _e(this,void 0,void 0,function(){var t,e,r,a,i,u,l;return Se(this,function(c){if((t=JSON.parse(this.LS.getItem(this.keys.info)))==null)throw new Error("In local storage, there is no model with name '"+this.modelPath+"'");if(t.modelTopologyType!=="JSON")throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");if(e={},(r=JSON.parse(this.LS.getItem(this.keys.topology)))==null)throw new Error("In local storage, the topology of model '"+this.modelPath+"' is missing.");if(e.modelTopology=r,(a=JSON.parse(this.LS.getItem(this.keys.weightSpecs)))==null)throw new Error("In local storage, the weight specs of model '"+this.modelPath+"' are missing.");if(e.weightSpecs=a,(i=this.LS.getItem(this.keys.modelMetadata))!=null&&(u=JSON.parse(i),e.format=u.format,e.generatedBy=u.generatedBy,e.convertedBy=u.convertedBy,e.userDefinedMetadata=u.userDefinedMetadata),(l=this.LS.getItem(this.keys.weightData))==null)throw new Error("In local storage, the binary weight values of model '"+this.modelPath+"' are missing.");return e.weightData=function(f){if(Am){var d=Buffer.from(f,"base64");return d.buffer.slice(d.byteOffset,d.byteOffset+d.byteLength)}for(var v=atob(f),m=new Uint8Array(v.length),g=0;g<v.length;++g)m.set([v.charCodeAt(g)],g);return m.buffer}(l),[2,e]})})},n.URL_SCHEME="localstorage://",n}(),i2=function(n){return ue().getBool("IS_BROWSER")&&!Array.isArray(n)&&n.startsWith(ws.URL_SCHEME)?(t=n.slice(ws.URL_SCHEME.length),new ws(t)):null;var t};Jn.registerSaveRouter(i2),Jn.registerLoadRouter(i2);var mB=function(){function n(){L(ue().getBool("IS_BROWSER"),function(){return"Current environment is not a web browser"}),L(typeof window>"u"||window.localStorage!==void 0,function(){return"Current browser does not appear to support localStorage"}),this.LS=window.localStorage}return n.prototype.listModels=function(){return _e(this,void 0,void 0,function(){var t,e,r,a,i,u;return Se(this,function(l){for(t={},e=ps+Ra,r=Ra+lE,a=0;a<this.LS.length;++a)(i=this.LS.key(a)).startsWith(e)&&i.endsWith(r)&&(u=vB(i),t[u]=JSON.parse(this.LS.getItem(i)));return[2,t]})})},n.prototype.removeModel=function(t){return _e(this,void 0,void 0,function(){var e,r;return Se(this,function(a){var i;if(t=(i=t).startsWith(ws.URL_SCHEME)?i.slice(ws.URL_SCHEME.length):i,e=cE(t),this.LS.getItem(e.info)==null)throw new Error("Cannot find model at path '"+t+"'");return r=JSON.parse(this.LS.getItem(e.info)),this.LS.removeItem(e.info),this.LS.removeItem(e.topology),this.LS.removeItem(e.weightSpecs),this.LS.removeItem(e.weightData),[2,r]})})},n}();if(ue().getBool("IS_BROWSER"))try{Si.registerManager(ws.URL_SCHEME,new mB)}catch{}var gB="model",yB=".json",bB=".weights.bin";function o2(n){return new Promise(function(t){return setTimeout(t)}).then(n)}var Mv=function(){function n(t){if(!ue().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");t.startsWith(n.URL_SCHEME)&&(t=t.slice(n.URL_SCHEME.length)),t!=null&&t.length!==0||(t=gB),this.modelTopologyFileName=t+yB,this.weightDataFileName=t+bB}return n.prototype.save=function(t){return _e(this,void 0,void 0,function(){var e,r,a,i,u,l;return Se(this,function(c){switch(c.label){case 0:if(typeof document>"u")throw new Error("Browser downloads are not supported in this environment since `document` is not present");if(e=window.URL.createObjectURL(new Blob([t.weightData],{type:"application/octet-stream"})),!(t.modelTopology instanceof ArrayBuffer))return[3,1];throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");case 1:return r=[{paths:["./"+this.weightDataFileName],weights:t.weightSpecs}],a={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,weightsManifest:r},i=window.URL.createObjectURL(new Blob([JSON.stringify(a)],{type:"application/json"})),(u=this.jsonAnchor==null?document.createElement("a"):this.jsonAnchor).download=this.modelTopologyFileName,u.href=i,[4,o2(function(){return u.dispatchEvent(new MouseEvent("click"))})];case 2:return c.sent(),t.weightData==null?[3,4]:((l=this.weightDataAnchor==null?document.createElement("a"):this.weightDataAnchor).download=this.weightDataFileName,l.href=e,[4,o2(function(){return l.dispatchEvent(new MouseEvent("click"))})]);case 3:c.sent(),c.label=4;case 4:return[2,{modelArtifactsInfo:kl(t)}]}})})},n.URL_SCHEME="downloads://",n}(),xB=function(){function n(t){if(t==null||t.length<1)throw new Error("When calling browserFiles, at least 1 file is required, but received "+t);this.files=t}return n.prototype.load=function(){return _e(this,void 0,void 0,function(){var t,e,r=this;return Se(this,function(a){return t=this.files[0],e=this.files.slice(1),[2,new Promise(function(i,u){var l=new FileReader;l.onload=function(c){var f=JSON.parse(c.target.result),d=f.modelTopology;if(d!=null){e.length===0&&i({modelTopology:d});var v=f.weightsManifest;if(v!=null){var m;try{m=r.checkManifestAndWeightFiles(v,e)}catch(S){return void u(S)}var g=[],b=[],w=[];v.forEach(function(S){S.paths.forEach(function(_){b.push(_),w.push(null)}),g.push.apply(g,S.weights)}),v.forEach(function(S){S.paths.forEach(function(_){var E=new FileReader;E.onload=function(R){var C=R.target.result,A=b.indexOf(_);w[A]=C,w.indexOf(null)===-1&&i({modelTopology:d,weightSpecs:g,weightData:Rg(w),format:f.format,generatedBy:f.generatedBy,convertedBy:f.convertedBy,userDefinedMetadata:f.userDefinedMetadata})},E.onerror=function(R){return u("Failed to weights data from file of path '"+_+"'.")},E.readAsArrayBuffer(m[_])})})}else u(new Error("weightManifest field is missing from file "+t.name))}else u(new Error("modelTopology field is missing from file "+t.name))},l.onerror=function(c){return u("Failed to read model topology and weights manifest JSON from file '"+t.name+"'. BrowserFiles supports loading Keras-style tf.Model artifacts only.")},l.readAsText(t)})]})})},n.prototype.checkManifestAndWeightFiles=function(t,e){for(var r=[],a=e.map(function(c){return n2(c.name)}),i={},u=0,l=t;u<l.length;u++)l[u].paths.forEach(function(c){var f=n2(c);if(r.indexOf(f)!==-1)throw new Error("Duplicate file basename found in weights manifest: '"+f+"'");if(r.push(f),a.indexOf(f)===-1)throw new Error("Weight file with basename '"+f+"' is not provided.");i[c]=e[a.indexOf(f)]});if(r.length!==e.length)throw new Error("Mismatch in the number of files in weights manifest ("+r.length+") and the number of weight files provided ("+e.length+").");return i},n}();function s2(n,t,e,r){(function(i){L(i!=null&&Array.isArray(i)&&i.length>0,function(){return"promises must be a none empty array"})})(n),function(i,u){L(i>=0&&i<=1,function(){return"Progress fraction must be in range [0, 1], but got startFraction "+i}),L(u>=0&&u<=1,function(){return"Progress fraction must be in range [0, 1], but got endFraction "+u}),L(u>=i,function(){return"startFraction must be no more than endFraction, but got startFraction "+i+" and endFraction "+u})}(e=e??0,r=r??1);var a=0;return Promise.all(n.map(function(i){return i.then(function(u){var l=e+ ++a/n.length*(r-e);return t(l),u}),i}))}function fE(n,t){return _e(this,void 0,void 0,function(){var e,r,a,i,u,l,c,f,d;return Se(this,function(v){switch(v.label){case 0:return t==null&&(t={}),e=t.fetchFunc==null?ue().platform.fetch:t.fetchFunc,r=n.map(function(m){return e(m,t.requestInit,{isBinary:!0})}),a=0,i=.5,t.onProgress!=null?[3,2]:[4,Promise.all(r)];case 1:return u=v.sent(),[3,4];case 2:return[4,s2(r,t.onProgress,a,i)];case 3:u=v.sent(),v.label=4;case 4:return l=u.map(function(m){return m.arrayBuffer()}),c=.5,f=1,t.onProgress!=null?[3,6]:[4,Promise.all(l)];case 5:return d=v.sent(),[3,8];case 6:return[4,s2(l,t.onProgress,c,f)];case 7:d=v.sent(),v.label=8;case 8:return[2,d]}})})}function u2(n){var t=this;return function(e,r,a){return r===void 0&&(r=""),_e(t,void 0,void 0,function(){var i,u,l,c,f,d,v,m,g,b;return Se(this,function(w){switch(w.label){case 0:if(i=e.map(function(){return!1}),u={},l=a!=null?a.map(function(){return!1}):[],c=[],e.forEach(function(S,_){var E=0;S.weights.forEach(function(R){var C="quantization"in R?R.quantization.dtype:R.dtype,A=Rm[C]*Ce(R.shape),D=function(){i[_]=!0,u[_]==null&&(u[_]=[]),u[_].push({manifestEntry:R,groupOffset:E,sizeBytes:A})};a!=null?a.forEach(function(k,I){k===R.name&&(D(),l[I]=!0)}):D(),c.push(R.name),E+=A})}),!l.every(function(S){return S}))throw f=a.filter(function(S,_){return!l[_]}),new Error("Could not find weights in manifest with names: "+f.join(", ")+`. 
Manifest JSON has weights with names: `+c.join(", ")+".");return d=i.reduce(function(S,_,E){return _&&S.push(E),S},[]),v=[],d.forEach(function(S){e[S].paths.forEach(function(_){var E=r+(r.endsWith("/")?"":"/")+_;v.push(E)})}),[4,n(v)];case 1:return m=w.sent(),g={},b=0,d.forEach(function(S){for(var _=e[S].paths.length,E=0,R=0;R<_;R++)E+=m[b+R].byteLength;for(var C=new ArrayBuffer(E),A=new Uint8Array(C),D=0,k=0;k<_;k++){var I=new Uint8Array(m[b+k]);A.set(I,D),D+=I.byteLength}u[S].forEach(function(N){var B=sE(C.slice(N.groupOffset,N.groupOffset+N.sizeBytes),[N.manifestEntry]);for(var V in B)g[V]=B[V]}),b+=_}),[2,g]}})})}}Jn.registerSaveRouter(function(n){return ue().getBool("IS_BROWSER")&&!Array.isArray(n)&&n.startsWith(Mv.URL_SCHEME)?function(t){return t===void 0&&(t="model"),new Mv(t)}(n.slice(Mv.URL_SCHEME.length)):null});var hE=function(){function n(t,e){if(this.DEFAULT_METHOD="POST",e==null&&(e={}),this.weightPathPrefix=e.weightPathPrefix,this.onProgress=e.onProgress,e.fetchFunc!=null?(L(typeof e.fetchFunc=="function",function(){return"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"}),this.fetch=e.fetchFunc):this.fetch=ue().platform.fetch,L(t!=null&&t.length>0,function(){return"URL path for http must not be null, undefined or empty."}),Array.isArray(t)&&L(t.length===2,function(){return"URL paths for http must have a length of 2, (actual length is "+t.length+")."}),this.path=t,e.requestInit!=null&&e.requestInit.body!=null)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=e.requestInit||{}}return n.prototype.save=function(t){return _e(this,void 0,void 0,function(){var e,r,a,i;return Se(this,function(u){switch(u.label){case 0:if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");return(e=Object.assign({method:this.DEFAULT_METHOD},this.requestInit)).body=new FormData,r=[{paths:["./model.weights.bin"],weights:t.weightSpecs}],a={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,userDefinedMetadata:t.userDefinedMetadata,weightsManifest:r},e.body.append("model.json",new Blob([JSON.stringify(a)],{type:"application/json"}),"model.json"),t.weightData!=null&&e.body.append("model.weights.bin",new Blob([t.weightData],{type:"application/octet-stream"}),"model.weights.bin"),[4,this.fetch(this.path,e)];case 1:if((i=u.sent()).ok)return[2,{modelArtifactsInfo:kl(t),responses:[i]}];throw new Error("BrowserHTTPRequest.save() failed due to HTTP response status "+i.status+".")}})})},n.prototype.load=function(){return _e(this,void 0,void 0,function(){var t,e,r,a,i,u,l,c,f,d,v,m;return Se(this,function(g){switch(g.label){case 0:return[4,this.fetch(this.path,this.requestInit)];case 1:if(!(t=g.sent()).ok)throw new Error("Request to "+this.path+" failed with status code "+t.status+". Please verify this URL points to the model JSON of the model to load.");g.label=2;case 2:return g.trys.push([2,4,,5]),[4,t.json()];case 3:return e=g.sent(),[3,5];case 4:throw g.sent(),r="Failed to parse model JSON of response from "+this.path+".",this.path.endsWith(".pb")?r+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":r+=" Please make sure the server is serving valid JSON for this request.",new Error(r);case 5:if(a=e.modelTopology,i=e.weightsManifest,u=e.generatedBy,l=e.convertedBy,c=e.format,f=e.userDefinedMetadata,a==null&&i==null)throw new Error("The JSON from HTTP path "+this.path+" contains neither model topology or manifest for weights.");return i==null?[3,7]:[4,this.loadWeights(i)];case 6:m=g.sent(),d=m[0],v=m[1],g.label=7;case 7:return[2,{modelTopology:a,weightSpecs:d,weightData:v,userDefinedMetadata:f,generatedBy:u,convertedBy:l,format:c}]}})})},n.prototype.loadWeights=function(t){return _e(this,void 0,void 0,function(){var e,r,a,i,u,l,c,f,d,v,m;return Se(this,function(g){switch(g.label){case 0:for(e=Array.isArray(this.path)?this.path[1]:this.path,r=function(b){var w=b.lastIndexOf("/"),S=b.lastIndexOf("?"),_=b.substring(0,w),E=S>w?b.substring(S):"";return[_+"/",E]}(e),a=r[0],i=r[1],u=this.weightPathPrefix||a,l=[],c=0,f=t;c<f.length;c++)d=f[c],l.push.apply(l,d.weights);return v=[],t.forEach(function(b){b.paths.forEach(function(w){v.push(u+w+i)})}),[4,fE(v,{requestInit:this.requestInit,fetchFunc:this.fetch,onProgress:this.onProgress})];case 1:return m=g.sent(),[2,[l,Rg(m)]]}})})},n.URL_SCHEME_REGEX=/^https?:\/\//,n}();function Dm(n){return n.match(hE.URL_SCHEME_REGEX)!=null}var l2=function(n,t){return typeof fetch>"u"?null:(Array.isArray(n)?n.every(function(e){return Dm(e)}):Dm(n))?km(n,{onProgress:t}):null};function km(n,t){return new hE(n,t)}Jn.registerSaveRouter(l2),Jn.registerLoadRouter(l2);var Iv=function(){function n(t){this.modelArtifacts=t}return n.prototype.load=function(){return _e(this,void 0,void 0,function(){return Se(this,function(t){return[2,this.modelArtifacts]})})},n}(),wB=function(){function n(t){this.saveHandler=t}return n.prototype.save=function(t){return _e(this,void 0,void 0,function(){return Se(this,function(e){return[2,this.saveHandler(t)]})})},n}(),dE=Object.freeze({browserFiles:function(n){return new xB(n)},browserHTTPRequest:function(n,t){return km(n,t)},concatenateArrayBuffers:Rg,decodeWeights:sE,encodeWeights:function(n,t){return _e(this,void 0,void 0,function(){var e,r,a,i,u,l=this;return Se(this,function(c){switch(c.label){case 0:for(e=[],r=[],a=Array.isArray(n)?n.map(function(f){return f.name}):Object.keys(n),i=function(f){var d=a[f],v=Array.isArray(n)?n[f].tensor:n[d];if(v.dtype!=="float32"&&v.dtype!=="int32"&&v.dtype!=="bool"&&v.dtype!=="string")throw new Error("Unsupported dtype in weight '"+d+"': "+v.dtype);var m={name:d,shape:v.shape,dtype:v.dtype};if(v.dtype==="string"){var g=new Promise(function(b){return _e(l,void 0,void 0,function(){var w,S,_,E,R,C,A;return Se(this,function(D){switch(D.label){case 0:return[4,v.bytes()];case 1:for(w=D.sent(),S=w.reduce(function(k,I){return k+I.length},0)+th*w.length,_=new Uint8Array(S),E=0,R=0;R<w.length;R++)C=w[R],A=new Uint8Array(new Uint32Array([C.length]).buffer),_.set(A,E),E+=th,_.set(C,E),E+=C.length;return b(_),[2]}})})});r.push(g)}else r.push(v.data());t!=null&&(m.group=t),e.push(m)},u=0;u<a.length;++u)i(u);return[4,Promise.all(r)];case 1:return[2,{data:lB(c.sent()),specs:e}]}})})},fromMemory:function(n,t,e,r){return arguments.length===1?n.modelTopology!=null||n.weightSpecs!=null?new Iv(n):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new Iv({modelTopology:n})):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new Iv({modelTopology:n,weightSpecs:t,weightData:e,trainingConfig:r}))},getLoadHandlers:function(n,t){return Jn.getLoadHandlers(n,t)},getModelArtifactsInfoForJSON:kl,getSaveHandlers:function(n){return Jn.getSaveHandlers(n)},http:km,isHTTPScheme:Dm,loadWeights:function(n,t,e,r){return t===void 0&&(t=""),_e(this,void 0,void 0,function(){return Se(this,function(a){return[2,u2(function(i){return fE(i,{requestInit:r})})(n,t,e)]})})},registerLoadRouter:function(n){return Jn.registerLoadRouter(n)},registerSaveRouter:function(n){return Jn.registerSaveRouter(n)},weightsLoaderFactory:u2,withSaveHandler:function(n){return new wB(n)},copyModel:function(n,t){return _e(this,void 0,void 0,function(){return Se(this,function(e){return[2,r2(n,t,!1)]})})},listModels:function(){return _e(this,void 0,void 0,function(){var n,t,e,r,a,i,u;return Se(this,function(l){switch(l.label){case 0:n=Si.getSchemes(),t={},e=0,r=n,l.label=1;case 1:return e<r.length?(a=r[e],[4,Si.getManager(a).listModels()]):[3,4];case 2:for(u in i=l.sent())t[a+bs+u]=i[u];l.label=3;case 3:return e++,[3,1];case 4:return[2,t]}})})},moveModel:function(n,t){return _e(this,void 0,void 0,function(){return Se(this,function(e){return[2,r2(n,t,!0)]})})},removeModel:function(n){return _e(this,void 0,void 0,function(){var t;return Se(this,function(e){return t=bf(n),[2,Si.getManager(t.scheme).removeModel(t.path)]})})}}),ss;H({confusionMatrix_:function(n,t,e){var r=F(n,"labels","confusionMatrix"),a=F(t,"predictions","confusionMatrix");L(e==null||e>0&&Number.isInteger(e),function(){return"If provided, numClasses must be a positive integer, but got "+e}),L(r.rank===1,function(){return"Expected the rank of labels to be 1, but got "+r.rank}),L(a.rank===1,function(){return"Expected the rank of predictions to be 1, but got "+a.rank}),L(r.shape[0]===a.shape[0],function(){return"Mismatch in the number of examples: "+r.shape[0]+" vs. "+a.shape[0]+". Labels and predictions should have the same number of elements."}),L(e>0&&Number.isInteger(e),function(){return"numClasses is required to be a positive integer, but got "+e});var i=wm(r.asType("int32"),e),u=wm(a.asType("int32"),e);return i.transpose().matMul(u).asType("int32")}});var _B=H({fromPixels_:function(n,t){if(t===void 0&&(t=3),t>4)throw new Error("Cannot construct Tensor with more than 4 channels from pixels.");if(n==null)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");var e=!1,r=!1,a=!1,i=!1,u=!1;if(n.data instanceof Uint8Array)e=!0;else if(typeof ImageData<"u"&&n instanceof ImageData)r=!0;else if(typeof HTMLVideoElement<"u"&&n instanceof HTMLVideoElement)a=!0;else if(typeof HTMLImageElement<"u"&&n instanceof HTMLImageElement)i=!0;else{if(n.getContext==null)throw new Error("pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData in browser, or OffscreenCanvas, ImageData in webworker or {data: Uint32Array, width: number, height: number}, but was "+n.constructor.name);u=!0}if(a&&a&&n.readyState<2)throw new Error("The video element has not loaded data yet. Please wait for `loadeddata` event on the <video> element.");if(L_("FromPixels",q.backendName)!=null)return q.runKernel("FromPixels",{pixels:n},{numChannels:t});var l,c,f=a?[n.videoWidth,n.videoHeight]:[n.width,n.height],d=f[0],v=f[1];if(u?l=n.getContext("2d").getImageData(0,0,d,v).data:r||e?l=n.data:(i||a)&&(ss==null&&(ss=document.createElement("canvas").getContext("2d")),ss.canvas.width=d,ss.canvas.height=v,ss.drawImage(n,0,0,d,v),l=ss.getImageData(0,0,d,v).data),t===4)c=new Int32Array(l);else{var m=d*v;c=new Int32Array(m*t);for(var g=0;g<m;g++)for(var b=0;b<t;++b)c[g*t+b]=l[4*g+b]}return tg(c,[v,d,t],"int32")}}),Ag=Object.freeze({toPixels:function(n,t){return _e(this,void 0,void 0,function(){var e,r,a,i,u,l,c,f,d,v,m,g,b,w,S,_,E,R,C,A,D,k,I;return Se(this,function(N){switch(N.label){case 0:if(e=F(n,"img","toPixels"),n instanceof Rt||(e=e.toInt()),e.rank!==2&&e.rank!==3)throw new Error("toPixels only supports rank 2 or 3 tensors, got rank "+e.rank+".");if(r=e.shape.slice(0,2),a=r[0],i=r[1],(u=e.rank===2?1:e.shape[2])>4||u===2)throw new Error("toPixels only supports depth of size 1, 3 or 4 but got "+u);return[4,e.data()];case 1:return l=N.sent(),c=e.min(),f=e.max(),[4,Promise.all([c.data(),f.data()])];case 2:if(d=N.sent(),v=d[0],m=d[1],g=v[0],b=m[0],c.dispose(),f.dispose(),e.dtype==="float32"){if(g<0||b>1)throw new Error("Tensor values for a float32 Tensor must be in the range [0 - 1] but got range ["+g+" - "+b+"].")}else{if(e.dtype!=="int32")throw new Error("Unsupported type for toPixels: "+e.dtype+". Please use float32 or int32 tensors.");if(g<0||b>255)throw new Error("Tensor values for a int32 Tensor must be in the range [0 - 255] but got range ["+g+" - "+b+"].")}for(w=e.dtype==="float32"?255:1,S=new Uint8ClampedArray(i*a*4),_=0;_<a*i;++_)E=void 0,R=void 0,C=void 0,A=void 0,u===1?(E=l[_]*w,R=l[_]*w,C=l[_]*w,A=255):u===3?(E=l[3*_]*w,R=l[3*_+1]*w,C=l[3*_+2]*w,A=255):u===4&&(E=l[4*_]*w,R=l[4*_+1]*w,C=l[4*_+2]*w,A=l[4*_+3]*w),S[(D=4*_)+0]=Math.round(E),S[D+1]=Math.round(R),S[D+2]=Math.round(C),S[D+3]=Math.round(A);return t!=null&&(t.width=i,t.height=a,k=t.getContext("2d"),I=new ImageData(S,i,a),k.putImageData(I,0,0)),e!==n&&e.dispose(),[2,S]}})})},fromPixels:_B}),SB=function(){function n(){}return n.prototype.getClassName=function(){return this.constructor.className},n.fromConfig=function(t,e){return new t(e)},n}(),EB=function(){function n(){this.classNameMap={}}return n.getMap=function(){return n.instance==null&&(n.instance=new n),n.instance},n.register=function(t){n.getMap().classNameMap[t.className]=[t,t.fromConfig]},n}();function mo(n){L(n.className!=null,function(){return"Class being registered does not have the static className property defined."}),L(typeof n.className=="string",function(){return"className is required to be a string, but got type "+typeof n.className}),L(n.className.length>0,function(){return"Class being registered has an empty-string as its className, which is disallowed."}),EB.register(n)}var go=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return Mr(t,n),t.prototype.minimize=function(e,r,a){r===void 0&&(r=!1);var i=this.computeGradients(e,a),u=i.value,l=i.grads;if(a!=null){var c=a.map(function(f){return{name:f.name,tensor:l[f.name]}});this.applyGradients(c)}else this.applyGradients(l);return zn(l),r?u:(u.dispose(),null)},Object.defineProperty(t.prototype,"iterations",{get:function(){return this.iterations_==null&&(this.iterations_=0),this.iterations_},enumerable:!0,configurable:!0}),t.prototype.incrementIterations=function(){this.iterations_=this.iterations+1},t.prototype.computeGradients=function(e,r){return I3(e,r)},t.prototype.dispose=function(){this.iterations_!=null&&zn(this.iterations_)},t.prototype.saveIterations=function(){return _e(this,void 0,void 0,function(){return Se(this,function(e){return this.iterations_==null&&(this.iterations_=0),[2,{name:"iter",tensor:ge(this.iterations_,"int32")}]})})},t.prototype.getWeights=function(){return _e(this,void 0,void 0,function(){return Se(this,function(e){throw new Error("getWeights() is not implemented for this optimizer yet.")})})},t.prototype.setWeights=function(e){return _e(this,void 0,void 0,function(){return Se(this,function(r){throw new Error("setWeights() is not implemented for this optimizer class "+this.getClassName())})})},t.prototype.extractIterations=function(e){return _e(this,void 0,void 0,function(){var r;return Se(this,function(a){switch(a.label){case 0:return r=this,[4,e[0].tensor.data()];case 1:return r.iterations_=a.sent()[0],[2,e.slice(1)]}})})},t}(SB);Object.defineProperty(go,Symbol.hasInstance,{value:function(n){return n.minimize!=null&&n.computeGradients!=null&&n.applyGradients!=null}});var CB=function(n){function t(e,r,a){a===void 0&&(a=null);var i=n.call(this)||this;return i.learningRate=e,i.rho=r,i.epsilon=a,i.accumulatedGrads=[],i.accumulatedUpdates=[],a==null&&(i.epsilon=q.backend.epsilon()),i}return Mr(t,n),t.prototype.applyGradients=function(e){var r=this;(Array.isArray(e)?e.map(function(a){return a.name}):Object.keys(e)).forEach(function(a,i){var u=q.registeredVariables[a];r.accumulatedGrads[i]==null&&(r.accumulatedGrads[i]={originalName:a+"/accum_grad",variable:xe(function(){return nt(u).variable(!1)})}),r.accumulatedUpdates[i]==null&&(r.accumulatedUpdates[i]={originalName:a+"/accum_var",variable:xe(function(){return nt(u).variable(!1)})});var l=Array.isArray(e)?e[i].tensor:e[a];if(l!=null){var c=r.accumulatedGrads[i].variable,f=r.accumulatedUpdates[i].variable;xe(function(){var d=c.mul(r.rho).add(l.square().mul(1-r.rho)),v=f.add(r.epsilon).sqrt().div(c.add(r.epsilon).sqrt()).mul(l),m=f.mul(r.rho).add(v.square().mul(1-r.rho));c.assign(d),f.assign(m);var g=v.mul(-r.learningRate).add(u);u.assign(g)})}}),this.incrementIterations()},t.prototype.dispose=function(){this.accumulatedUpdates!=null&&(zn(this.accumulatedGrads.map(function(e){return e.variable})),zn(this.accumulatedUpdates.map(function(e){return e.variable})))},t.prototype.getWeights=function(){return _e(this,void 0,void 0,function(){var e;return Se(this,function(r){switch(r.label){case 0:return e=this.accumulatedGrads.concat(this.accumulatedUpdates),[4,this.saveIterations()];case 1:return[2,[r.sent()].concat(e.map(function(a){return{name:a.originalName,tensor:a.variable}}))]}})})},t.prototype.setWeights=function(e){return _e(this,void 0,void 0,function(){var r;return Se(this,function(a){switch(a.label){case 0:return[4,this.extractIterations(e)];case 1:return e=a.sent(),r=e.length/2,this.accumulatedGrads=e.slice(0,r).map(function(i){return{originalName:i.name,variable:i.tensor.variable(!1)}}),this.accumulatedUpdates=e.slice(r,2*r).map(function(i){return{originalName:i.name,variable:i.tensor.variable(!1)}}),[2]}})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}},t.fromConfig=function(e,r){return new e(r.learningRate,r.rho,r.epsilon)},t.className="Adadelta",t}(go);mo(CB);var RB=function(n){function t(e,r){r===void 0&&(r=.1);var a=n.call(this)||this;return a.learningRate=e,a.initialAccumulatorValue=r,a.accumulatedGrads=[],a}return Mr(t,n),t.prototype.applyGradients=function(e){var r=this;(Array.isArray(e)?e.map(function(a){return a.name}):Object.keys(e)).forEach(function(a,i){var u=q.registeredVariables[a];r.accumulatedGrads[i]==null&&(r.accumulatedGrads[i]={originalName:a+"/accumulator",variable:xe(function(){return Jr(u.shape,r.initialAccumulatorValue).variable(!1)})});var l=Array.isArray(e)?e[i].tensor:e[a];if(l!=null){var c=r.accumulatedGrads[i].variable;xe(function(){var f=c.add(l.square());c.assign(f);var d=l.div(f.add(q.backend.epsilon()).sqrt()).mul(-r.learningRate).add(u);u.assign(d)})}}),this.incrementIterations()},t.prototype.dispose=function(){this.accumulatedGrads!=null&&zn(this.accumulatedGrads.map(function(e){return e.variable}))},t.prototype.getWeights=function(){return _e(this,void 0,void 0,function(){return Se(this,function(e){switch(e.label){case 0:return[4,this.saveIterations()];case 1:return[2,[e.sent()].concat(this.accumulatedGrads.map(function(r){return{name:r.originalName,tensor:r.variable}}))]}})})},t.prototype.setWeights=function(e){return _e(this,void 0,void 0,function(){return Se(this,function(r){switch(r.label){case 0:return[4,this.extractIterations(e)];case 1:return e=r.sent(),this.accumulatedGrads=e.map(function(a){return{originalName:a.name,variable:a.tensor.variable(!1)}}),[2]}})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}},t.fromConfig=function(e,r){return new e(r.learningRate,r.initialAccumulatorValue)},t.className="Adagrad",t}(go);mo(RB);var AB=function(n){function t(e,r,a,i){i===void 0&&(i=null);var u=n.call(this)||this;return u.learningRate=e,u.beta1=r,u.beta2=a,u.epsilon=i,u.accumulatedFirstMoment=[],u.accumulatedSecondMoment=[],xe(function(){u.accBeta1=ge(r).variable(),u.accBeta2=ge(a).variable()}),i==null&&(u.epsilon=q.backend.epsilon()),u}return Mr(t,n),t.prototype.applyGradients=function(e){var r=this,a=Array.isArray(e)?e.map(function(i){return i.name}):Object.keys(e);xe(function(){var i=Zt(1,r.accBeta1),u=Zt(1,r.accBeta2);a.forEach(function(l,c){var f=q.registeredVariables[l];r.accumulatedFirstMoment[c]==null&&(r.accumulatedFirstMoment[c]={originalName:l+"/m",variable:xe(function(){return nt(f).variable(!1)})}),r.accumulatedSecondMoment[c]==null&&(r.accumulatedSecondMoment[c]={originalName:l+"/v",variable:xe(function(){return nt(f).variable(!1)})});var d=Array.isArray(e)?e[c].tensor:e[l];if(d!=null){var v=r.accumulatedFirstMoment[c].variable,m=r.accumulatedSecondMoment[c].variable,g=v.mul(r.beta1).add(d.mul(1-r.beta1)),b=m.mul(r.beta2).add(d.square().mul(1-r.beta2)),w=g.div(i),S=b.div(u);v.assign(g),m.assign(b);var _=w.div(S.sqrt().add(r.epsilon)).mul(-r.learningRate).add(f);f.assign(_)}}),r.accBeta1.assign(r.accBeta1.mul(r.beta1)),r.accBeta2.assign(r.accBeta2.mul(r.beta2))}),this.incrementIterations()},t.prototype.dispose=function(){this.accBeta1.dispose(),this.accBeta2.dispose(),this.accumulatedFirstMoment!=null&&zn(this.accumulatedFirstMoment.map(function(e){return e.variable})),this.accumulatedSecondMoment!=null&&zn(this.accumulatedSecondMoment.map(function(e){return e.variable}))},t.prototype.getWeights=function(){return _e(this,void 0,void 0,function(){var e;return Se(this,function(r){switch(r.label){case 0:return e=this.accumulatedFirstMoment.concat(this.accumulatedSecondMoment),[4,this.saveIterations()];case 1:return[2,[r.sent()].concat(e.map(function(a){return{name:a.originalName,tensor:a.variable}}))]}})})},t.prototype.setWeights=function(e){return _e(this,void 0,void 0,function(){var r,a=this;return Se(this,function(i){switch(i.label){case 0:return[4,this.extractIterations(e)];case 1:return e=i.sent(),xe(function(){a.accBeta1.assign(Jf(a.beta1,a.iterations_+1)),a.accBeta2.assign(Jf(a.beta2,a.iterations_+1))}),r=e.length/2,this.accumulatedFirstMoment=e.slice(0,r).map(function(u){return{originalName:u.name,variable:u.tensor.variable(!1)}}),this.accumulatedSecondMoment=e.slice(r,2*r).map(function(u){return{originalName:u.name,variable:u.tensor.variable(!1)}}),[2]}})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}},t.fromConfig=function(e,r){return new e(r.learningRate,r.beta1,r.beta2,r.epsilon)},t.className="Adam",t}(go);mo(AB);var TB=function(n){function t(e,r,a,i,u){i===void 0&&(i=null),u===void 0&&(u=0);var l=n.call(this)||this;return l.learningRate=e,l.beta1=r,l.beta2=a,l.epsilon=i,l.decay=u,l.accumulatedFirstMoment=[],l.accumulatedWeightedInfNorm=[],xe(function(){l.iteration=ge(0).variable(),l.accBeta1=ge(r).variable()}),i==null&&(l.epsilon=q.backend.epsilon()),l}return Mr(t,n),t.prototype.applyGradients=function(e){var r=this,a=Array.isArray(e)?e.map(function(i){return i.name}):Object.keys(e);xe(function(){var i=Zt(1,r.accBeta1),u=Tr(-r.learningRate,r.iteration.mul(r.decay).add(1));a.forEach(function(l,c){var f=q.registeredVariables[l];r.accumulatedFirstMoment[c]==null&&(r.accumulatedFirstMoment[c]={originalName:l+"/m",variable:nt(f).variable(!1)}),r.accumulatedWeightedInfNorm[c]==null&&(r.accumulatedWeightedInfNorm[c]={originalName:l+"/v",variable:nt(f).variable(!1)});var d=Array.isArray(e)?e[c].tensor:e[l];if(d!=null){var v=r.accumulatedFirstMoment[c].variable,m=r.accumulatedWeightedInfNorm[c].variable,g=v.mul(r.beta1).add(d.mul(1-r.beta1)),b=m.mul(r.beta2),w=d.abs(),S=b.maximum(w);v.assign(g),m.assign(S);var _=u.div(i).mul(g.div(S.add(r.epsilon))).add(f);f.assign(_)}}),r.iteration.assign(r.iteration.add(1)),r.accBeta1.assign(r.accBeta1.mul(r.beta1))}),this.incrementIterations()},t.prototype.dispose=function(){this.accBeta1.dispose(),this.iteration.dispose(),this.accumulatedFirstMoment!=null&&zn(this.accumulatedFirstMoment.map(function(e){return e.variable})),this.accumulatedWeightedInfNorm!=null&&zn(this.accumulatedWeightedInfNorm.map(function(e){return e.variable}))},t.prototype.getWeights=function(){return _e(this,void 0,void 0,function(){return Se(this,function(e){throw new Error("getWeights() is not implemented for Adamax yet.")})})},t.prototype.setWeights=function(e){return _e(this,void 0,void 0,function(){return Se(this,function(r){throw new Error("setWeights() is not implemented for Adamax yet.")})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}},t.fromConfig=function(e,r){return new e(r.learningRate,r.beta1,r.beta2,r.epsilon,r.decay)},t.className="Adamax",t}(go);mo(TB);var pE=function(n){function t(e){var r=n.call(this)||this;return r.learningRate=e,r.setLearningRate(e),r}return Mr(t,n),t.prototype.applyGradients=function(e){var r=this;(Array.isArray(e)?e.map(function(a){return a.name}):Object.keys(e)).forEach(function(a,i){var u=Array.isArray(e)?e[i].tensor:e[a];if(u!=null){var l=q.registeredVariables[a];xe(function(){var c=r.c.mul(u).add(l);l.assign(c)})}}),this.incrementIterations()},t.prototype.setLearningRate=function(e){this.learningRate=e,this.c!=null&&this.c.dispose(),this.c=XN(ge(-e))},t.prototype.dispose=function(){this.c.dispose()},t.prototype.getWeights=function(){return _e(this,void 0,void 0,function(){return Se(this,function(e){switch(e.label){case 0:return[4,this.saveIterations()];case 1:return[2,[e.sent()]]}})})},t.prototype.setWeights=function(e){return _e(this,void 0,void 0,function(){return Se(this,function(r){switch(r.label){case 0:return[4,this.extractIterations(e)];case 1:if((e=r.sent()).length!==0)throw new Error("SGD optimizer does not have settable weights.");return[2]}})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate}},t.fromConfig=function(e,r){return new e(r.learningRate)},t.className="SGD",t}(go);mo(pE);var DB=function(n){function t(e,r,a){a===void 0&&(a=!1);var i=n.call(this,e)||this;return i.learningRate=e,i.momentum=r,i.useNesterov=a,i.accumulations=[],i.m=ge(i.momentum),i}return Mr(t,n),t.prototype.applyGradients=function(e){var r=this;(Array.isArray(e)?e.map(function(a){return a.name}):Object.keys(e)).forEach(function(a,i){var u=q.registeredVariables[a];r.accumulations[i]==null&&(r.accumulations[i]={originalName:a+"/momentum",variable:xe(function(){return nt(u).variable(!1)})});var l=r.accumulations[i].variable,c=Array.isArray(e)?e[i].tensor:e[a];c!=null&&xe(function(){var f,d=r.m.mul(l).add(c);f=r.useNesterov?r.c.mul(c.add(d.mul(r.m))).add(u):r.c.mul(d).add(u),l.assign(d),u.assign(f)})}),this.incrementIterations()},t.prototype.dispose=function(){this.m.dispose(),this.accumulations!=null&&zn(this.accumulations.map(function(e){return e.variable}))},t.prototype.setMomentum=function(e){this.momentum=e},t.prototype.getWeights=function(){return _e(this,void 0,void 0,function(){return Se(this,function(e){switch(e.label){case 0:return[4,this.saveIterations()];case 1:return[2,[e.sent()].concat(this.accumulations.map(function(r){return{name:r.originalName,tensor:r.variable}}))]}})})},t.prototype.setWeights=function(e){return _e(this,void 0,void 0,function(){return Se(this,function(r){switch(r.label){case 0:return[4,this.extractIterations(e)];case 1:return e=r.sent(),this.accumulations=e.map(function(a){return{originalName:a.name,variable:a.tensor.variable(!1)}}),[2]}})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}},t.fromConfig=function(e,r){return new e(r.learningRate,r.momentum,r.useNesterov)},t.className="Momentum",t}(pE);mo(DB);var kB=function(n){function t(e,r,a,i,u){r===void 0&&(r=.9),a===void 0&&(a=0),i===void 0&&(i=null),u===void 0&&(u=!1);var l=n.call(this)||this;if(l.learningRate=e,l.decay=r,l.momentum=a,l.epsilon=i,l.accumulatedMeanSquares=[],l.accumulatedMoments=[],l.accumulatedMeanGrads=[],l.centered=u,i==null&&(l.epsilon=q.backend.epsilon()),e==null)throw new Error("learningRate for RMSPropOptimizer must be defined.");return l}return Mr(t,n),t.prototype.applyGradients=function(e){var r=this;(Array.isArray(e)?e.map(function(a){return a.name}):Object.keys(e)).forEach(function(a,i){var u=q.registeredVariables[a];r.accumulatedMeanSquares[i]==null&&(r.accumulatedMeanSquares[i]={originalName:a+"/rms",variable:xe(function(){return nt(u).variable(!1)})}),r.accumulatedMoments[i]==null&&(r.accumulatedMoments[i]={originalName:a+"/momentum",variable:xe(function(){return nt(u).variable(!1)})}),r.accumulatedMeanGrads[i]==null&&r.centered&&(r.accumulatedMeanGrads[i]={originalName:a+"/mg",variable:xe(function(){return nt(u).variable(!1)})});var l=Array.isArray(e)?e[i].tensor:e[a];if(l!=null){var c=r.accumulatedMeanSquares[i].variable,f=r.accumulatedMoments[i].variable;xe(function(){var d=c.mul(r.decay).add(l.square().mul(1-r.decay));if(r.centered){var v=r.accumulatedMeanGrads[i].variable,m=v.mul(r.decay).add(l.mul(1-r.decay)),g=f.mul(r.momentum).add(l.mul(r.learningRate).div(d.sub(m.square().add(r.epsilon)).sqrt()));c.assign(d),v.assign(m),f.assign(g);var b=u.sub(g);u.assign(b)}else{var w=c.mul(r.decay).add(l.square().mul(1-r.decay));g=f.mul(r.momentum).add(l.mul(r.learningRate).div(w.add(r.epsilon).sqrt())),c.assign(w),f.assign(g),b=u.sub(g),u.assign(b)}})}}),this.incrementIterations()},t.prototype.dispose=function(){this.accumulatedMeanSquares!=null&&zn(this.accumulatedMeanSquares.map(function(e){return e.variable})),this.accumulatedMeanGrads!=null&&this.centered&&zn(this.accumulatedMeanGrads.map(function(e){return e.variable})),this.accumulatedMoments!=null&&zn(this.accumulatedMoments.map(function(e){return e.variable}))},t.prototype.getWeights=function(){return _e(this,void 0,void 0,function(){var e;return Se(this,function(r){switch(r.label){case 0:return e=this.accumulatedMeanSquares.concat(this.accumulatedMoments),this.centered&&e.push.apply(e,this.accumulatedMeanGrads),[4,this.saveIterations()];case 1:return[2,[r.sent()].concat(e.map(function(a){return{name:a.originalName,tensor:a.variable}}))]}})})},t.prototype.setWeights=function(e){return _e(this,void 0,void 0,function(){var r;return Se(this,function(a){switch(a.label){case 0:return[4,this.extractIterations(e)];case 1:return e=a.sent(),r=this.centered?e.length/3:e.length/2,this.accumulatedMeanSquares=e.slice(0,r).map(function(i){return{originalName:i.name,variable:i.tensor.variable(!1)}}),this.accumulatedMoments=e.slice(r,2*r).map(function(i){return{originalName:i.name,variable:i.tensor.variable(!1)}}),this.centered&&(this.accumulatedMeanGrads=e.slice(2*r,3*r).map(function(i){return{originalName:i.name,variable:i.tensor.variable(!1)}})),[2]}})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}},t.fromConfig=function(e,r){return new e(r.learningRate,r.decay,r.momentum,r.epsilon,r.centered)},t.className="RMSProp",t}(go);mo(kB);Rt.prototype.squaredDifference=function(n){return DS(this,n)},se=nB;/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var Om=function(n,t){return Om=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var a in r)r.hasOwnProperty(a)&&(e[a]=r[a])},Om(n,t)};function ze(n,t){Om(n,t);function e(){this.constructor=n}n.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}var _n=function(){return _n=Object.assign||function(t){for(var e,r=1,a=arguments.length;r<a;r++){e=arguments[r];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}return t},_n.apply(this,arguments)};function Te(n,t,e,r){function a(i){return i instanceof e?i:new e(function(u){u(i)})}return new(e||(e=Promise))(function(i,u){function l(d){try{f(r.next(d))}catch(v){u(v)}}function c(d){try{f(r.throw(d))}catch(v){u(v)}}function f(d){d.done?i(d.value):a(d.value).then(l,c)}f((r=r.apply(n,[])).next())})}function De(n,t){var e={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},r,a,i,u;return u={next:l(0),throw:l(1),return:l(2)},typeof Symbol=="function"&&(u[Symbol.iterator]=function(){return this}),u;function l(f){return function(d){return c([f,d])}}function c(f){if(r)throw new TypeError("Generator is already executing.");for(;e;)try{if(r=1,a&&(i=f[0]&2?a.return:f[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,f[1])).done)return i;switch(a=0,i&&(f=[f[0]&2,i.value]),f[0]){case 0:case 1:i=f;break;case 4:return e.label++,{value:f[1],done:!1};case 5:e.label++,a=f[1],f=[0];continue;case 7:f=e.ops.pop(),e.trys.pop();continue;default:if(i=e.trys,!(i=i.length>0&&i[i.length-1])&&(f[0]===6||f[0]===2)){e=0;continue}if(f[0]===3&&(!i||f[1]>i[0]&&f[1]<i[3])){e.label=f[1];break}if(f[0]===6&&e.label<i[1]){e.label=i[1],i=f;break}if(i&&e.label<i[2]){e.label=i[2],e.ops.push(f);break}i[2]&&e.ops.pop(),e.trys.pop();continue}f=t.call(n,e)}catch(d){f=[6,d],a=0}finally{r=i=0}if(f[0]&5)throw f[1];return{value:f[0]?f[1]:void 0,done:!0}}}function tl(){for(var n=0,t=0,e=arguments.length;t<e;t++)n+=arguments[t].length;for(var r=Array(n),a=0,t=0;t<e;t++)for(var i=arguments[t],u=0,l=i.length;u<l;u++,a++)r[a]=i[u];return r}var io=function(){function n(t,e){if(!oo(t)||!oo(e))throw new Error("Dimensions.constructor - expected width and height to be valid numbers, instead have "+JSON.stringify({width:t,height:e}));this._width=t,this._height=e}return Object.defineProperty(n.prototype,"width",{get:function(){return this._width},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"height",{get:function(){return this._height},enumerable:!0,configurable:!0}),n.prototype.reverse=function(){return new n(1/this.width,1/this.height)},n}();function Sh(n,t){return n instanceof Rt&&n.shape.length===t}function OB(n){return Sh(n,2)}function Eh(n){return Sh(n,3)}function Ei(n){return Sh(n,4)}function NB(n){return n%1!==0}function c2(n){return n%2===0}function Tg(n,t){t===void 0&&(t=2);var e=Math.pow(10,t);return Math.floor(n*e)/e}function f2(n){return n&&n.width&&n.height}function MB(n,t){var e=n.width,r=n.height,a=t/Math.max(r,e);return new io(Math.round(e*a),Math.round(r*a))}function Dg(n){return n.reduce(function(t,e){return t.add(e)},new st(0,0)).div(new st(n.length,n.length))}function vl(n,t,e){return Array(n).fill(0).map(function(r,a){return t+a*e})}function oo(n){return!!n&&n!==1/0&&n!==-1/0&&!isNaN(n)||n===0}function h2(n){return oo(n)&&0<=n&&n<=1}var st=function(){function n(t,e){this._x=t,this._y=e}return Object.defineProperty(n.prototype,"x",{get:function(){return this._x},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"y",{get:function(){return this._y},enumerable:!0,configurable:!0}),n.prototype.add=function(t){return new n(this.x+t.x,this.y+t.y)},n.prototype.sub=function(t){return new n(this.x-t.x,this.y-t.y)},n.prototype.mul=function(t){return new n(this.x*t.x,this.y*t.y)},n.prototype.div=function(t){return new n(this.x/t.x,this.y/t.y)},n.prototype.abs=function(){return new n(Math.abs(this.x),Math.abs(this.y))},n.prototype.magnitude=function(){return Math.sqrt(Math.pow(this.x,2)+Math.pow(this.y,2))},n.prototype.floor=function(){return new n(Math.floor(this.x),Math.floor(this.y))},n}(),ta=function(){function n(t,e){e===void 0&&(e=!0);var r=t||{},a=[r.left,r.top,r.right,r.bottom].every(oo),i=[r.x,r.y,r.width,r.height].every(oo);if(!i&&!a)throw new Error("Box.constructor - expected box to be IBoundingBox | IRect, instead have "+JSON.stringify(r));var u=i?[r.x,r.y,r.width,r.height]:[r.left,r.top,r.right-r.left,r.bottom-r.top],l=u[0],c=u[1],f=u[2],d=u[3];n.assertIsValidBox({x:l,y:c,width:f,height:d},"Box.constructor",e),this._x=l,this._y=c,this._width=f,this._height=d}return n.isRect=function(t){return!!t&&[t.x,t.y,t.width,t.height].every(oo)},n.assertIsValidBox=function(t,e,r){if(r===void 0&&(r=!1),!n.isRect(t))throw new Error(e+" - invalid box: "+JSON.stringify(t)+", expected object with properties x, y, width, height");if(!r&&(t.width<0||t.height<0))throw new Error(e+" - width ("+t.width+") and height ("+t.height+") must be positive numbers")},Object.defineProperty(n.prototype,"x",{get:function(){return this._x},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"y",{get:function(){return this._y},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"width",{get:function(){return this._width},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"height",{get:function(){return this._height},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"left",{get:function(){return this.x},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"top",{get:function(){return this.y},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"right",{get:function(){return this.x+this.width},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"bottom",{get:function(){return this.y+this.height},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"area",{get:function(){return this.width*this.height},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"topLeft",{get:function(){return new st(this.left,this.top)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"topRight",{get:function(){return new st(this.right,this.top)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"bottomLeft",{get:function(){return new st(this.left,this.bottom)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"bottomRight",{get:function(){return new st(this.right,this.bottom)},enumerable:!0,configurable:!0}),n.prototype.round=function(){var t=[this.x,this.y,this.width,this.height].map(function(u){return Math.round(u)}),e=t[0],r=t[1],a=t[2],i=t[3];return new n({x:e,y:r,width:a,height:i})},n.prototype.floor=function(){var t=[this.x,this.y,this.width,this.height].map(function(u){return Math.floor(u)}),e=t[0],r=t[1],a=t[2],i=t[3];return new n({x:e,y:r,width:a,height:i})},n.prototype.toSquare=function(){var t=this,e=t.x,r=t.y,a=t.width,i=t.height,u=Math.abs(a-i);return a<i&&(e-=u/2,a+=u),i<a&&(r-=u/2,i+=u),new n({x:e,y:r,width:a,height:i})},n.prototype.rescale=function(t){var e=f2(t)?t.width:t,r=f2(t)?t.height:t;return new n({x:this.x*e,y:this.y*r,width:this.width*e,height:this.height*r})},n.prototype.pad=function(t,e){var r=[this.x-t/2,this.y-e/2,this.width+t,this.height+e],a=r[0],i=r[1],u=r[2],l=r[3];return new n({x:a,y:i,width:u,height:l})},n.prototype.clipAtImageBorders=function(t,e){var r=this,a=r.x,i=r.y,u=r.right,l=r.bottom,c=Math.max(a,0),f=Math.max(i,0),d=u-c,v=l-f,m=Math.min(d,t-c),g=Math.min(v,e-f);return new n({x:c,y:f,width:m,height:g}).floor()},n.prototype.shift=function(t,e){var r=this,a=r.width,i=r.height,u=this.x+t,l=this.y+e;return new n({x:u,y:l,width:a,height:i})},n.prototype.padAtBorders=function(t,e){var r=this.width+1,a=this.height+1,i=1,u=1,l=r,c=a,f=this.left,d=this.top,v=this.right,m=this.bottom;return v>e&&(l=-v+e+r,v=e),m>t&&(c=-m+t+a,m=t),f<1&&(c=2-f,f=1),d<1&&(c=2-d,d=1),{dy:u,edy:c,dx:i,edx:l,y:d,ey:m,x:f,ex:v,w:r,h:a}},n.prototype.calibrate=function(t){return new n({left:this.left+t.left*this.width,top:this.top+t.top*this.height,right:this.right+t.right*this.width,bottom:this.bottom+t.bottom*this.height}).toSquare().round()},n}(),Ch=function(n){ze(t,n);function t(e,r,a,i,u){return u===void 0&&(u=!1),n.call(this,{left:e,top:r,right:a,bottom:i},u)||this}return t}(ta),vE=function(){function n(t,e,r,a,i){this._imageDims=new io(i.width,i.height),this._score=t,this._classScore=e,this._className=r,this._box=new ta(a).rescale(this._imageDims)}return Object.defineProperty(n.prototype,"score",{get:function(){return this._score},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"classScore",{get:function(){return this._classScore},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"className",{get:function(){return this._className},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"box",{get:function(){return this._box},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"imageDims",{get:function(){return this._imageDims},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"imageWidth",{get:function(){return this.imageDims.width},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"imageHeight",{get:function(){return this.imageDims.height},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"relativeBox",{get:function(){return new ta(this._box).rescale(this.imageDims.reverse())},enumerable:!0,configurable:!0}),n.prototype.forSize=function(t,e){return new n(this.score,this.classScore,this.className,this.relativeBox,{width:t,height:e})},n}(),rr=function(n){ze(t,n);function t(e,r,a){return n.call(this,e,e,"",r,a)||this}return t.prototype.forSize=function(e,r){var a=n.prototype.forSize.call(this,e,r),i=a.score,u=a.relativeBox,l=a.imageDims;return new t(i,u,l)},t}(vE);function IB(n,t,e){e===void 0&&(e=!0);var r=Math.max(0,Math.min(n.right,t.right)-Math.max(n.left,t.left)),a=Math.max(0,Math.min(n.bottom,t.bottom)-Math.max(n.top,t.top)),i=r*a;return e?i/(n.area+t.area-i):i/Math.min(n.area,t.area)}function FB(n){var t=n.map(function(l){return l.x}),e=n.map(function(l){return l.y}),r=t.reduce(function(l,c){return c<l?c:l},1/0),a=e.reduce(function(l,c){return c<l?c:l},1/0),i=t.reduce(function(l,c){return l<c?c:l},0),u=e.reduce(function(l,c){return l<c?c:l},0);return new Ch(r,a,i,u)}function ml(n,t,e,r){r===void 0&&(r=!0);for(var a=t.map(function(l,c){return{score:l,boxIndex:c}}).sort(function(l,c){return l.score-c.score}).map(function(l){return l.boxIndex}),i=[],u=function(){var l=a.pop();i.push(l);for(var c=a,f=[],d=0;d<c.length;d++){var v=c[d],m=n[l],g=n[v];f.push(IB(m,g,r))}a=a.filter(function(b,w){return f[w]<=e})};a.length>0;)u();return i}function Ol(n,t){return xe(function(){var e=t[0],r=t[1],a=t[2],i=Jr(tl(n.shape.slice(0,3),[1]),e),u=Jr(tl(n.shape.slice(0,3),[1]),r),l=Jr(tl(n.shape.slice(0,3),[1]),a),c=$t([i,u,l],3);return Zt(n,c)})}function BB(n,t){return t===void 0&&(t=!1),xe(function(){var e=n.shape.slice(1),r=e[0],a=e[1];if(r===a)return n;var i=Math.abs(r-a),u=Math.round(i*(t?.5:1)),l=r>a?2:1,c=function(g){var b=n.shape.slice();return b[l]=g,Jr(b,0)},f=c(u),d=i-f.shape[l],v=t&&d?c(d):null,m=[v,n,f].filter(function(g){return!!g}).map(function(g){return g.toFloat()});return $t(m,l)})}function Fv(n){return 1/(1+Math.exp(-n))}var kg=function(n){ze(t,n);function t(e,r,a,i,u){return u===void 0&&(u=!1),n.call(this,{x:e,y:r,width:a,height:i},u)||this}return t}(ta),LB=.5,PB=.43,zB=.45,gl=function(){function n(t,e,r){r===void 0&&(r=new st(0,0));var a=e.width,i=e.height;this._imgDims=new io(a,i),this._shift=r,this._positions=t.map(function(u){return u.mul(new st(a,i)).add(r)})}return Object.defineProperty(n.prototype,"shift",{get:function(){return new st(this._shift.x,this._shift.y)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"imageWidth",{get:function(){return this._imgDims.width},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"imageHeight",{get:function(){return this._imgDims.height},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"positions",{get:function(){return this._positions},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"relativePositions",{get:function(){var t=this;return this._positions.map(function(e){return e.sub(t._shift).div(new st(t.imageWidth,t.imageHeight))})},enumerable:!0,configurable:!0}),n.prototype.forSize=function(t,e){return new this.constructor(this.relativePositions,{width:t,height:e})},n.prototype.shiftBy=function(t,e){return new this.constructor(this.relativePositions,this._imgDims,new st(t,e))},n.prototype.shiftByPoint=function(t){return this.shiftBy(t.x,t.y)},n.prototype.align=function(t,e){if(e===void 0&&(e={}),t){var r=t instanceof rr?t.box.floor():new ta(t);return this.shiftBy(r.x,r.y).align(null,e)}var a=Object.assign({},{useDlibAlignment:!1,minBoxPadding:.2},e),i=a.useDlibAlignment,u=a.minBoxPadding;return i?this.alignDlib():this.alignMinBbox(u)},n.prototype.alignDlib=function(){var t=this.getRefPointsForAlignment(),e=t[0],r=t[1],a=t[2],i=function(v){return a.sub(v).magnitude()},u=(i(e)+i(r))/2,l=Math.floor(u/zB),c=Dg(t),f=Math.floor(Math.max(0,c.x-LB*l)),d=Math.floor(Math.max(0,c.y-PB*l));return new kg(f,d,Math.min(l,this.imageWidth+f),Math.min(l,this.imageHeight+d))},n.prototype.alignMinBbox=function(t){var e=FB(this.positions);return e.pad(e.width*t,e.height*t)},n.prototype.getRefPointsForAlignment=function(){throw new Error("getRefPointsForAlignment not implemented by base class")},n}(),UB=function(n){ze(t,n);function t(){return n!==null&&n.apply(this,arguments)||this}return t.prototype.getRefPointsForAlignment=function(){var e=this.positions;return[e[0],e[1],Dg([e[3],e[4]])]},t}(gl),VB=function(n){ze(t,n);function t(){return n!==null&&n.apply(this,arguments)||this}return t.prototype.getJawOutline=function(){return this.positions.slice(0,17)},t.prototype.getLeftEyeBrow=function(){return this.positions.slice(17,22)},t.prototype.getRightEyeBrow=function(){return this.positions.slice(22,27)},t.prototype.getNose=function(){return this.positions.slice(27,36)},t.prototype.getLeftEye=function(){return this.positions.slice(36,42)},t.prototype.getRightEye=function(){return this.positions.slice(42,48)},t.prototype.getMouth=function(){return this.positions.slice(48,68)},t.prototype.getRefPointsForAlignment=function(){return[this.getLeftEye(),this.getRightEye(),this.getMouth()].map(Dg)},t}(gl),d2=function(){function n(t,e){this._label=t,this._distance=e}return Object.defineProperty(n.prototype,"label",{get:function(){return this._label},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"distance",{get:function(){return this._distance},enumerable:!0,configurable:!0}),n.prototype.toString=function(t){return t===void 0&&(t=!0),""+this.label+(t?" ("+Tg(this.distance)+")":"")},n}(),p2=function(n){ze(t,n);function t(e,r){var a=n.call(this,e)||this;return a._label=r,a}return t.assertIsValidLabeledBox=function(e,r){if(ta.assertIsValidBox(e,r),!oo(e.label))throw new Error(r+" - expected property label ("+e.label+") to be a number")},Object.defineProperty(t.prototype,"label",{get:function(){return this._label},enumerable:!0,configurable:!0}),t}(ta),sf=function(){function n(t,e){if(typeof t!="string")throw new Error("LabeledFaceDescriptors - constructor expected label to be a string");if(!Array.isArray(e)||e.some(function(r){return!(r instanceof Float32Array)}))throw new Error("LabeledFaceDescriptors - constructor expected descriptors to be an array of Float32Array");this._label=t,this._descriptors=e}return Object.defineProperty(n.prototype,"label",{get:function(){return this._label},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"descriptors",{get:function(){return this._descriptors},enumerable:!0,configurable:!0}),n.prototype.toJSON=function(){return{label:this.label,descriptors:this.descriptors.map(function(t){return Array.from(t)})}},n.fromJSON=function(t){var e=t.descriptors.map(function(r){return new Float32Array(r)});return new n(t.label,e)},n}();(function(n){ze(t,n);function t(e,r,a,i){var u=n.call(this,e,r)||this;return u._score=a,u._classScore=i,u}return t.assertIsValidPredictedBox=function(e,r){if(p2.assertIsValidLabeledBox(e,r),!h2(e.score)||!h2(e.classScore))throw new Error(r+" - expected properties score ("+e.score+") and ("+e.classScore+") to be a number between [0, 1]")},Object.defineProperty(t.prototype,"score",{get:function(){return this._score},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"classScore",{get:function(){return this._classScore},enumerable:!0,configurable:!0}),t})(p2);function yl(n){return n.detection instanceof rr}function bl(n,t){var e={detection:t};return Object.assign({},n,e)}function mE(){var n=window.fetch||function(){throw new Error("fetch - missing fetch implementation for browser environment")},t=function(){throw new Error("readFile - filesystem not available for browser environment")};return{Canvas:HTMLCanvasElement,CanvasRenderingContext2D,Image:HTMLImageElement,ImageData,Video:HTMLVideoElement,createCanvasElement:function(){return document.createElement("canvas")},createImageElement:function(){return document.createElement("img")},fetch:n,readFile:t}}function gE(n){var t="";if(!n)try{n=require("fs")}catch(r){t=r.toString()}var e=n?function(r){return new Promise(function(a,i){n.readFile(r,function(u,l){return u?i(u):a(l)})})}:function(){throw new Error("readFile - failed to require fs in nodejs environment with error: "+t)};return{readFile:e}}function yE(){var n=global.Canvas||global.HTMLCanvasElement,t=global.Image||global.HTMLImageElement,e=function(){if(n)return new n;throw new Error("createCanvasElement - missing Canvas implementation for nodejs environment")},r=function(){if(t)return new t;throw new Error("createImageElement - missing Image implementation for nodejs environment")},a=global.fetch||function(){throw new Error("fetch - missing fetch implementation for nodejs environment")},i=gE();return _n({Canvas:n||function(){function u(){}return u}(),CanvasRenderingContext2D:global.CanvasRenderingContext2D||function(){function u(){}return u}(),Image:t||function(){function u(){}return u}(),ImageData:global.ImageData||function(){function u(){}return u}(),Video:global.HTMLVideoElement||function(){function u(){}return u}(),createCanvasElement:e,createImageElement:r,fetch:a},i)}function bE(){return typeof window=="object"&&typeof document<"u"&&typeof HTMLImageElement<"u"&&typeof HTMLCanvasElement<"u"&&typeof HTMLVideoElement<"u"&&typeof ImageData<"u"&&typeof CanvasRenderingContext2D<"u"}function xE(){return typeof global=="object"&&typeof require=="function"&&typeof module<"u"&&typeof process<"u"&&!!process.version}var qt;function HB(){if(!qt)throw new Error("getEnv - environment is not defined, check isNodejs() and isBrowser()");return qt}function Nm(n){qt=n}function Og(){bE()&&Nm(mE()),xE()&&Nm(yE())}function jB(n){if(qt||Og(),!qt)throw new Error("monkeyPatch - environment is not defined, check isNodejs() and isBrowser()");var t=n.Canvas,e=t===void 0?qt.Canvas:t,r=n.Image,a=r===void 0?qt.Image:r;qt.Canvas=e,qt.Image=a,qt.createCanvasElement=n.createCanvasElement||function(){return new e},qt.createImageElement=n.createImageElement||function(){return new a},qt.ImageData=n.ImageData||qt.ImageData,qt.Video=n.Video||qt.Video,qt.fetch=n.fetch||qt.fetch,qt.readFile=n.readFile||qt.readFile}var Rn={getEnv:HB,setEnv:Nm,initialize:Og,createBrowserEnv:mE,createFileSystem:gE,createNodejsEnv:yE,monkeyPatch:jB,isBrowser:bE,isNodejs:xE};Og();function Ng(n){return!Rn.isNodejs()&&typeof n=="string"?document.getElementById(n):n}function ka(n){var t=Rn.getEnv(),e=t.Canvas,r=t.CanvasRenderingContext2D;if(n instanceof r)return n;var a=Ng(n);if(!(a instanceof e))throw new Error("resolveContext2d - expected canvas to be of instance of Canvas");var i=a.getContext("2d");if(!i)throw new Error("resolveContext2d - canvas 2d context is null");return i}var yi;(function(n){n.TOP_LEFT="TOP_LEFT",n.TOP_RIGHT="TOP_RIGHT",n.BOTTOM_LEFT="BOTTOM_LEFT",n.BOTTOM_RIGHT="BOTTOM_RIGHT"})(yi||(yi={}));var wE=function(){function n(t){t===void 0&&(t={});var e=t.anchorPosition,r=t.backgroundColor,a=t.fontColor,i=t.fontSize,u=t.fontStyle,l=t.padding;this.anchorPosition=e||yi.TOP_LEFT,this.backgroundColor=r||"rgba(0, 0, 0, 0.5)",this.fontColor=a||"rgba(255, 255, 255, 1)",this.fontSize=i||14,this.fontStyle=u||"Georgia",this.padding=l||4}return n}(),_E=function(){function n(t,e,r){r===void 0&&(r={}),this.text=typeof t=="string"?[t]:t instanceof n?t.text:t,this.anchor=e,this.options=new wE(r)}return n.prototype.measureWidth=function(t){var e=this.options.padding;return this.text.map(function(r){return t.measureText(r).width}).reduce(function(r,a){return r<a?a:r},0)+2*e},n.prototype.measureHeight=function(){var t=this.options,e=t.fontSize,r=t.padding;return this.text.length*e+2*r},n.prototype.getUpperLeft=function(t,e){var r=this.options.anchorPosition,a=r===yi.BOTTOM_RIGHT||r===yi.TOP_RIGHT,i=r===yi.BOTTOM_LEFT||r===yi.BOTTOM_RIGHT,u=this.measureWidth(t),l=this.measureHeight(),c=a?this.anchor.x-u:this.anchor.x,f=i?this.anchor.y-l:this.anchor.y;if(e){var d=e.width,v=e.height,m=Math.max(Math.min(c,d-u),0),g=Math.max(Math.min(f,v-l),0);return{x:m,y:g}}return{x:c,y:f}},n.prototype.draw=function(t){var e=Ng(t),r=ka(e),a=this.options,i=a.backgroundColor,u=a.fontColor,l=a.fontSize,c=a.fontStyle,f=a.padding;r.font=l+"px "+c;var d=this.measureWidth(r),v=this.measureHeight();r.fillStyle=i;var m=this.getUpperLeft(r,e);r.fillRect(m.x,m.y,d,v),r.fillStyle=u,this.text.forEach(function(g,b){var w=f+m.x,S=f+m.y+(b+1)*l;r.fillText(g,w,S)})},n}(),WB=function(){function n(t){t===void 0&&(t={});var e=t.boxColor,r=t.lineWidth,a=t.label,i=t.drawLabelOptions;this.boxColor=e||"rgba(0, 0, 255, 1)",this.lineWidth=r||2,this.label=a;var u={anchorPosition:yi.BOTTOM_LEFT,backgroundColor:this.boxColor};this.drawLabelOptions=new wE(Object.assign({},u,i))}return n}(),GB=function(){function n(t,e){e===void 0&&(e={}),this.box=new ta(t),this.options=new WB(e)}return n.prototype.draw=function(t){var e=ka(t),r=this.options,a=r.boxColor,i=r.lineWidth,u=this.box,l=u.x,c=u.y,f=u.width,d=u.height;e.strokeStyle=a,e.lineWidth=i,e.strokeRect(l,c,f,d);var v=this.options.label;v&&new _E([v],{x:l-i/2,y:c},this.options.drawLabelOptions).draw(t)},n}();function GP(n,t){var e=Array.isArray(t)?t:[t];e.forEach(function(r){var a=r instanceof rr?r.score:yl(r)?r.detection.score:void 0,i=r instanceof rr?r.box:yl(r)?r.detection.box:new ta(r),u=a?""+Tg(a):void 0;new GB(i,{label:u}).draw(n)})}function SE(n){var t=Rn.getEnv(),e=t.Image,r=t.Video;return n instanceof e&&n.complete||n instanceof r&&n.readyState>=3}function qB(n){return new Promise(function(t,e){if(n instanceof Rn.getEnv().Canvas||SE(n))return t();function r(i){i.currentTarget&&(i.currentTarget.removeEventListener("load",r),i.currentTarget.removeEventListener("error",a),t(i))}function a(i){i.currentTarget&&(i.currentTarget.removeEventListener("load",r),i.currentTarget.removeEventListener("error",a),e(i))}n.addEventListener("load",r),n.addEventListener("error",a)})}function Mg(n){var t=Rn.getEnv(),e=t.Image,r=t.Video;return n instanceof e?new io(n.naturalWidth,n.naturalHeight):n instanceof r?new io(n.videoWidth,n.videoHeight):new io(n.width,n.height)}function Rh(n){var t=n.width,e=n.height,r=Rn.getEnv().createCanvasElement,a=r();return a.width=t,a.height=e,a}function Ig(n,t){var e=Rn.getEnv().ImageData;if(!(n instanceof e)&&!SE(n))throw new Error("createCanvasFromMedia - media has not finished loading yet");var r=Mg(n),a=r.width,i=r.height,u=Rh({width:a,height:i});return n instanceof e?ka(u).putImageData(n,0,0):ka(u).drawImage(n,0,0,a,i),u}function KB(n,t){return Te(this,void 0,void 0,function(){var e,r,a,i,u,l;return De(this,function(c){switch(c.label){case 0:return e=Rn.getEnv().createCanvasElement(),r=n.shape.slice(Ei(n)?1:0),a=r[0],i=r[1],u=r[2],l=xe(function(){return n.as3D(a,i,u).toInt()}),[4,Ag.toPixels(l,e)];case 1:return c.sent(),l.dispose(),[2,e]}})})}function v2(n){var t=Rn.getEnv(),e=t.Image,r=t.Canvas,a=t.Video;return n instanceof e||n instanceof r||n instanceof a}function XB(n,t,e){e===void 0&&(e=!1);var r=Rn.getEnv(),a=r.Image,i=r.Canvas;if(!(n instanceof a||n instanceof i))throw new Error("imageToSquare - expected arg0 to be HTMLImageElement | HTMLCanvasElement");var u=Mg(n),l=t/Math.max(u.height,u.width),c=l*u.width,f=l*u.height,d=Rh({width:t,height:t}),v=n instanceof i?n:Ig(n),m=Math.abs(c-f)/2,g=e&&c<f?m:0,b=e&&f<c?m:0;return ka(d).drawImage(v,g,b,c,f),d}var nh=function(){function n(t,e){var r=this;if(e===void 0&&(e=!1),this._imageTensors=[],this._canvases=[],this._treatAsBatchInput=!1,this._inputDimensions=[],!Array.isArray(t))throw new Error("NetInput.constructor - expected inputs to be an Array of TResolvedNetInput or to be instanceof tf.Tensor4D, instead have "+t);this._treatAsBatchInput=e,this._batchSize=t.length,t.forEach(function(a,i){if(Eh(a)){r._imageTensors[i]=a,r._inputDimensions[i]=a.shape;return}if(Ei(a)){var u=a.shape[0];if(u!==1)throw new Error("NetInput - tf.Tensor4D with batchSize "+u+" passed, but not supported in input array");r._imageTensors[i]=a,r._inputDimensions[i]=a.shape.slice(1);return}var l=a instanceof Rn.getEnv().Canvas?a:Ig(a);r._canvases[i]=l,r._inputDimensions[i]=[l.height,l.width,3]})}return Object.defineProperty(n.prototype,"imageTensors",{get:function(){return this._imageTensors},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"canvases",{get:function(){return this._canvases},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"isBatchInput",{get:function(){return this.batchSize>1||this._treatAsBatchInput},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"batchSize",{get:function(){return this._batchSize},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"inputDimensions",{get:function(){return this._inputDimensions},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"inputSize",{get:function(){return this._inputSize},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"reshapedInputDimensions",{get:function(){var t=this;return vl(this.batchSize,0,1).map(function(e,r){return t.getReshapedInputDimensions(r)})},enumerable:!0,configurable:!0}),n.prototype.getInput=function(t){return this.canvases[t]||this.imageTensors[t]},n.prototype.getInputDimensions=function(t){return this._inputDimensions[t]},n.prototype.getInputHeight=function(t){return this._inputDimensions[t][0]},n.prototype.getInputWidth=function(t){return this._inputDimensions[t][1]},n.prototype.getReshapedInputDimensions=function(t){if(typeof this.inputSize!="number")throw new Error("getReshapedInputDimensions - inputSize not set, toBatchTensor has not been called yet");var e=this.getInputWidth(t),r=this.getInputHeight(t);return MB({width:e,height:r},this.inputSize)},n.prototype.toBatchTensor=function(t,e){var r=this;return e===void 0&&(e=!0),this._inputSize=t,xe(function(){var a=vl(r.batchSize,0,1).map(function(u){var l=r.getInput(u);if(l instanceof Rt){var c=Ei(l)?l:l.expandDims();return c=BB(c,e),(c.shape[1]!==t||c.shape[2]!==t)&&(c=wg.resizeBilinear(c,[t,t])),c.as3D(t,t,3)}if(l instanceof Rn.getEnv().Canvas)return Ag.fromPixels(XB(l,t,e));throw new Error("toBatchTensor - at batchIdx "+u+", expected input to be instanceof tf.Tensor or instanceof HTMLCanvasElement, instead have "+l)}),i=tr(a.map(function(u){return u.toFloat()})).as4D(r.batchSize,t,t,3);return i})},n}();function ln(n){return Te(this,void 0,void 0,function(){var t,e,r;return De(this,function(a){switch(a.label){case 0:if(n instanceof nh)return[2,n];if(t=Array.isArray(n)?n:[n],!t.length)throw new Error("toNetInput - empty array passed as input");return e=function(i){return Array.isArray(n)?" at input index "+i+":":""},r=t.map(Ng),r.forEach(function(i,u){if(!v2(i)&&!Eh(i)&&!Ei(i))throw typeof t[u]=="string"?new Error("toNetInput -"+e(u)+" string passed, but could not resolve HTMLElement for element id "+t[u]):new Error("toNetInput -"+e(u)+" expected media to be of type HTMLImageElement | HTMLVideoElement | HTMLCanvasElement | tf.Tensor3D, or to be an element id");if(Ei(i)){var l=i.shape[0];if(l!==1)throw new Error("toNetInput -"+e(u)+" tf.Tensor4D with batchSize "+l+" passed, but not supported in input array")}}),[4,Promise.all(r.map(function(i){return v2(i)&&qB(i)}))];case 1:return a.sent(),[2,new nh(r,Array.isArray(n))]}})})}function Fg(n,t){return Te(this,void 0,void 0,function(){var e,r,a,i,u,l,c;return De(this,function(f){switch(f.label){case 0:return e=Rn.getEnv().Canvas,r=n,n instanceof e?[3,5]:[4,ln(n)];case 1:if(a=f.sent(),a.batchSize>1)throw new Error("extractFaces - batchSize > 1 not supported");return i=a.getInput(0),i instanceof e?(u=i,[3,4]):[3,2];case 2:return[4,KB(i)];case 3:u=f.sent(),f.label=4;case 4:r=u,f.label=5;case 5:return l=ka(r),c=t.map(function(d){return d instanceof rr?d.forSize(r.width,r.height).box.floor():d}).map(function(d){return d.clipAtImageBorders(r.width,r.height)}),[2,c.map(function(d){var v=d.x,m=d.y,g=d.width,b=d.height,w=Rh({width:g,height:b});return ka(w).putImageData(l.getImageData(v,m,g,b),0,0),w})]}})})}function Bg(n,t){return Te(this,void 0,void 0,function(){return De(this,function(e){if(!Eh(n)&&!Ei(n))throw new Error("extractFaceTensors - expected image tensor to be 3D or 4D");if(Ei(n)&&n.shape[0]>1)throw new Error("extractFaceTensors - batchSize > 1 not supported");return[2,xe(function(){var r=n.shape.slice(Ei(n)?1:0),a=r[0],i=r[1],u=r[2],l=t.map(function(f){return f instanceof rr?f.forSize(i,a).box:f}).map(function(f){return f.clipAtImageBorders(i,a)}),c=l.map(function(f){var d=f.x,v=f.y,m=f.width,g=f.height;return YS(n.as3D(a,i,u),[v,d,0],[g,m,u])});return c})]})})}function $B(n,t){return Te(this,void 0,void 0,function(){var e,r;return De(this,function(a){switch(a.label){case 0:return e=Rn.getEnv().fetch,[4,e(n,t)];case 1:if(r=a.sent(),!(r.status<400))throw new Error("failed to fetch: ("+r.status+") "+r.statusText+", from url: "+r.url);return[2,r]}})})}function YB(n){return Te(this,void 0,void 0,function(){return De(this,function(t){switch(t.label){case 0:return[4,$B(n)];case 1:return[2,t.sent().json()]}})})}function EE(n,t){var e=t+"-weights_manifest.json";if(!n)return{modelBaseUri:"",manifestUri:e};if(n==="/")return{modelBaseUri:"/",manifestUri:"/"+e};var r=n.startsWith("http://")?"http://":n.startsWith("https://")?"https://":"";n=n.replace(r,"");var a=n.split("/").filter(function(l){return l}),i=n.endsWith(".json")?a[a.length-1]:e,u=r+(n.endsWith(".json")?a.slice(0,a.length-1):a).join("/");return u=n.startsWith("/")?"/"+u:u,{modelBaseUri:u,manifestUri:u==="/"?"/"+i:u+"/"+i}}function QB(n,t){return Te(this,void 0,void 0,function(){var e,r,a,i;return De(this,function(u){switch(u.label){case 0:return e=EE(n,t),r=e.manifestUri,a=e.modelBaseUri,[4,YB(r)];case 1:return i=u.sent(),[2,dE.loadWeights(i,a)]}})})}function qP(n,t,e){e===void 0&&(e=!1);var r=e?Mg(t):t,a=r.width,i=r.height;return n.width=a,n.height=i,{width:a,height:i}}var Fa=function(){function n(t){this._name=t,this._params=void 0,this._paramMappings=[]}return Object.defineProperty(n.prototype,"params",{get:function(){return this._params},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"paramMappings",{get:function(){return this._paramMappings},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"isLoaded",{get:function(){return!!this.params},enumerable:!0,configurable:!0}),n.prototype.getParamFromPath=function(t){var e=this.traversePropertyPath(t),r=e.obj,a=e.objProp;return r[a]},n.prototype.reassignParamFromPath=function(t,e){var r=this.traversePropertyPath(t),a=r.obj,i=r.objProp;a[i].dispose(),a[i]=e},n.prototype.getParamList=function(){var t=this;return this._paramMappings.map(function(e){var r=e.paramPath;return{path:r,tensor:t.getParamFromPath(r)}})},n.prototype.getTrainableParams=function(){return this.getParamList().filter(function(t){return t.tensor instanceof Is})},n.prototype.getFrozenParams=function(){return this.getParamList().filter(function(t){return!(t.tensor instanceof Is)})},n.prototype.variable=function(){var t=this;this.getFrozenParams().forEach(function(e){var r=e.path,a=e.tensor;t.reassignParamFromPath(r,a.variable())})},n.prototype.freeze=function(){var t=this;this.getTrainableParams().forEach(function(e){var r=e.path,a=e.tensor,i=mn(a.dataSync());a.dispose(),t.reassignParamFromPath(r,i)})},n.prototype.dispose=function(t){t===void 0&&(t=!0),this.getParamList().forEach(function(e){if(t&&e.tensor.isDisposed)throw new Error("param tensor has already been disposed for path "+e.path);e.tensor.dispose()}),this._params=void 0},n.prototype.serializeParams=function(){return new Float32Array(this.getParamList().map(function(t){var e=t.tensor;return Array.from(e.dataSync())}).reduce(function(t,e){return t.concat(e)}))},n.prototype.load=function(t){return Te(this,void 0,void 0,function(){return De(this,function(e){switch(e.label){case 0:return t instanceof Float32Array?(this.extractWeights(t),[2]):[4,this.loadFromUri(t)];case 1:return e.sent(),[2]}})})},n.prototype.loadFromUri=function(t){return Te(this,void 0,void 0,function(){var e;return De(this,function(r){switch(r.label){case 0:if(t&&typeof t!="string")throw new Error(this._name+".loadFromUri - expected model uri");return[4,QB(t,this.getDefaultModelName())];case 1:return e=r.sent(),this.loadFromWeightMap(e),[2]}})})},n.prototype.loadFromDisk=function(t){return Te(this,void 0,void 0,function(){var e,r,a,i,u,l,c,f,d,v;return De(this,function(m){switch(m.label){case 0:if(t&&typeof t!="string")throw new Error(this._name+".loadFromDisk - expected model file path");return e=Rn.getEnv().readFile,r=EE(t,this.getDefaultModelName()),a=r.manifestUri,i=r.modelBaseUri,u=function(g){return Promise.all(g.map(function(b){return e(b).then(function(w){return w.buffer})}))},l=dE.weightsLoaderFactory(u),d=(f=JSON).parse,[4,e(a)];case 1:return c=d.apply(f,[m.sent().toString()]),[4,l(c,i)];case 2:return v=m.sent(),this.loadFromWeightMap(v),[2]}})})},n.prototype.loadFromWeightMap=function(t){var e=this.extractParamsFromWeigthMap(t),r=e.paramMappings,a=e.params;this._paramMappings=r,this._params=a},n.prototype.extractWeights=function(t){var e=this.extractParams(t),r=e.paramMappings,a=e.params;this._paramMappings=r,this._params=a},n.prototype.traversePropertyPath=function(t){if(!this.params)throw new Error("traversePropertyPath - model has no loaded params");var e=t.split("/").reduce(function(i,u){if(!i.nextObj.hasOwnProperty(u))throw new Error("traversePropertyPath - object does not have property "+u+", for path "+t);return{obj:i.nextObj,objProp:u,nextObj:i.nextObj[u]}},{nextObj:this.params}),r=e.obj,a=e.objProp;if(!r||!a||!(r[a]instanceof Rt))throw new Error("traversePropertyPath - parameter is not a tensor, for path "+t);return{obj:r,objProp:a}},n}();function er(n,t,e){return xe(function(){var r=mg(n,t.depthwise_filter,t.pointwise_filter,e,"same");return r=Ye(r,t.bias),r})}function Bv(n,t,e){return e===void 0&&(e=!1),xe(function(){var r=At(e?Ye(wr(n,t.conv0.filters,[2,2],"same"),t.conv0.bias):er(n,t.conv0,[2,2])),a=er(r,t.conv1,[1,1]),i=At(Ye(r,a)),u=er(i,t.conv2,[1,1]);return At(Ye(r,Ye(a,u)))})}function uf(n,t,e,r){return e===void 0&&(e=!1),r===void 0&&(r=!0),xe(function(){var a=At(e?Ye(wr(n,t.conv0.filters,r?[2,2]:[1,1],"same"),t.conv0.bias):er(n,t.conv0,r?[2,2]:[1,1])),i=er(a,t.conv1,[1,1]),u=At(Ye(a,i)),l=er(u,t.conv2,[1,1]),c=At(Ye(a,Ye(i,l))),f=er(c,t.conv3,[1,1]);return At(Ye(a,Ye(i,Ye(l,f))))})}function Or(n,t,e,r){return e===void 0&&(e="same"),r===void 0&&(r=!1),xe(function(){var a=Ye(wr(n,t.filters,[1,1],e),t.bias);return r?At(a):a})}function Ba(n,t){Object.keys(n).forEach(function(e){t.some(function(r){return r.originalPath===e})||n[e].dispose()})}function Ah(n,t){return function(e,r,a,i){var u=Bn(n(e*r*a*a),[a,a,e,r]),l=Vt(n(r));return t.push({paramPath:i+"/filters"},{paramPath:i+"/bias"}),{filters:u,bias:l}}}function Lg(n,t){return function(e,r,a){var i=_i(n(e*r),[e,r]),u=Vt(n(r));return t.push({paramPath:a+"/weights"},{paramPath:a+"/bias"}),{weights:i,bias:u}}}var CE=function(){function n(t,e,r){this.depthwise_filter=t,this.pointwise_filter=e,this.bias=r}return n}();function Pg(n,t){return function(e,r,a){var i=Bn(n(9*e),[3,3,e,1]),u=Bn(n(e*r),[1,1,e,r]),l=Vt(n(r));return t.push({paramPath:a+"/depthwise_filter"},{paramPath:a+"/pointwise_filter"},{paramPath:a+"/bias"}),new CE(i,u,l)}}function zg(n){return function(t){var e=n(t+"/depthwise_filter",4),r=n(t+"/pointwise_filter",4),a=n(t+"/bias",1);return new CE(e,r,a)}}function Ni(n,t){return function(e,r,a){var i=n[e];if(!Sh(i,r))throw new Error("expected weightMap["+e+"] to be a Tensor"+r+"D, instead have "+i);return t.push({originalPath:e,paramPath:a||e}),i}}function La(n){var t=n;function e(a){var i=t.slice(0,a);return t=t.slice(a),i}function r(){return t}return{extractWeights:e,getRemainingWeights:r}}function RE(n,t){var e=Ah(n,t),r=Pg(n,t);function a(u,l,c,f){f===void 0&&(f=!1);var d=f?e(u,l,3,c+"/conv0"):r(u,l,c+"/conv0"),v=r(l,l,c+"/conv1"),m=r(l,l,c+"/conv2");return{conv0:d,conv1:v,conv2:m}}function i(u,l,c,f){f===void 0&&(f=!1);var d=a(u,l,c,f),v=d.conv0,m=d.conv1,g=d.conv2,b=r(l,l,c+"/conv3");return{conv0:v,conv1:m,conv2:g,conv3:b}}return{extractDenseBlock3Params:a,extractDenseBlock4Params:i}}function ZB(n){var t=[],e=La(n),r=e.extractWeights,a=e.getRemainingWeights,i=RE(r,t).extractDenseBlock4Params,u=i(3,32,"dense0",!0),l=i(32,64,"dense1"),c=i(64,128,"dense2"),f=i(128,256,"dense3");if(a().length!==0)throw new Error("weights remaing after extract: "+a().length);return{paramMappings:t,params:{dense0:u,dense1:l,dense2:c,dense3:f}}}function AE(n){return function(t){var e=n(t+"/filters",4),r=n(t+"/bias",1);return{filters:e,bias:r}}}function TE(n,t){var e=Ni(n,t),r=AE(e),a=zg(e);function i(l,c){c===void 0&&(c=!1);var f=c?r(l+"/conv0"):a(l+"/conv0"),d=a(l+"/conv1"),v=a(l+"/conv2");return{conv0:f,conv1:d,conv2:v}}function u(l,c){c===void 0&&(c=!1);var f=c?r(l+"/conv0"):a(l+"/conv0"),d=a(l+"/conv1"),v=a(l+"/conv2"),m=a(l+"/conv3");return{conv0:f,conv1:d,conv2:v,conv3:m}}return{extractDenseBlock3Params:i,extractDenseBlock4Params:u}}function JB(n){var t=[],e=TE(n,t).extractDenseBlock4Params,r={dense0:e("dense0",!0),dense1:e("dense1"),dense2:e("dense2"),dense3:e("dense3")};return Ba(n,t),{params:r,paramMappings:t}}var DE=function(n){ze(t,n);function t(){return n.call(this,"FaceFeatureExtractor")||this}return t.prototype.forwardInput=function(e){var r=this.params;if(!r)throw new Error("FaceFeatureExtractor - load model before inference");return xe(function(){var a=e.toBatchTensor(112,!0),i=[122.782,117.001,104.298],u=Ol(a,i).div(ge(255)),l=uf(u,r.dense0,!0);return l=uf(l,r.dense1),l=uf(l,r.dense2),l=uf(l,r.dense3),l=Dl(l,[7,7],[2,2],"valid"),l})},t.prototype.forward=function(e){return Te(this,void 0,void 0,function(){var r;return De(this,function(a){switch(a.label){case 0:return r=this.forwardInput,[4,ln(e)];case 1:return[2,r.apply(this,[a.sent()])]}})})},t.prototype.getDefaultModelName=function(){return"face_feature_extractor_model"},t.prototype.extractParamsFromWeigthMap=function(e){return JB(e)},t.prototype.extractParams=function(e){return ZB(e)},t}(Fa);function $r(n,t){return xe(function(){return Ye(xh(n,t.weights),t.bias)})}function eL(n,t,e){var r=[],a=La(n),i=a.extractWeights,u=a.getRemainingWeights,l=Lg(i,r),c=l(t,e,"fc");if(u().length!==0)throw new Error("weights remaing after extract: "+u().length);return{paramMappings:r,params:{fc:c}}}function tL(n){var t=[],e=Ni(n,t);function r(i){var u=e(i+"/weights",2),l=e(i+"/bias",1);return{weights:u,bias:l}}var a={fc:r("fc")};return Ba(n,t),{params:a,paramMappings:t}}function kE(n){var t={},e={};return Object.keys(n).forEach(function(r){var a=r.startsWith("fc")?e:t;a[r]=n[r]}),{featureExtractorMap:t,classifierMap:e}}var OE=function(n){ze(t,n);function t(e,r){var a=n.call(this,e)||this;return a._faceFeatureExtractor=r,a}return Object.defineProperty(t.prototype,"faceFeatureExtractor",{get:function(){return this._faceFeatureExtractor},enumerable:!0,configurable:!0}),t.prototype.runNet=function(e){var r=this,a=this.params;if(!a)throw new Error(this._name+" - load model before inference");return xe(function(){var i=e instanceof nh?r.faceFeatureExtractor.forwardInput(e):e;return $r(i.as2D(i.shape[0],-1),a.fc)})},t.prototype.dispose=function(e){e===void 0&&(e=!0),this.faceFeatureExtractor.dispose(e),n.prototype.dispose.call(this,e)},t.prototype.loadClassifierParams=function(e){var r=this.extractClassifierParams(e),a=r.params,i=r.paramMappings;this._params=a,this._paramMappings=i},t.prototype.extractClassifierParams=function(e){return eL(e,this.getClassifierChannelsIn(),this.getClassifierChannelsOut())},t.prototype.extractParamsFromWeigthMap=function(e){var r=kE(e),a=r.featureExtractorMap,i=r.classifierMap;return this.faceFeatureExtractor.loadFromWeightMap(a),tL(i)},t.prototype.extractParams=function(e){var r=this.getClassifierChannelsIn(),a=this.getClassifierChannelsOut(),i=a*r+a,u=e.slice(0,e.length-i),l=e.slice(e.length-i);return this.faceFeatureExtractor.extractWeights(u),this.extractClassifierParams(l)},t}(Fa),m2=["neutral","happy","sad","angry","fearful","disgusted","surprised"],Ug=function(){function n(t){var e=this;if(t.length!==7)throw new Error("FaceExpressions.constructor - expected probabilities.length to be 7, have: "+t.length);m2.forEach(function(r,a){e[r]=t[a]})}return n.prototype.asSortedArray=function(){var t=this;return m2.map(function(e){return{expression:e,probability:t[e]}}).sort(function(e,r){return r.probability-e.probability})},n}(),nL=function(n){ze(t,n);function t(e){return e===void 0&&(e=new DE),n.call(this,"FaceExpressionNet",e)||this}return t.prototype.forwardInput=function(e){var r=this;return xe(function(){return Ma(r.runNet(e))})},t.prototype.forward=function(e){return Te(this,void 0,void 0,function(){var r;return De(this,function(a){switch(a.label){case 0:return r=this.forwardInput,[4,ln(e)];case 1:return[2,r.apply(this,[a.sent()])]}})})},t.prototype.predictExpressions=function(e){return Te(this,void 0,void 0,function(){var r,a,i,u,l=this;return De(this,function(c){switch(c.label){case 0:return[4,ln(e)];case 1:return r=c.sent(),[4,this.forwardInput(r)];case 2:return a=c.sent(),[4,Promise.all(Yt(a).map(function(f){return Te(l,void 0,void 0,function(){var d;return De(this,function(v){switch(v.label){case 0:return[4,f.data()];case 1:return d=v.sent(),f.dispose(),[2,d]}})})}))];case 3:return i=c.sent(),a.dispose(),u=i.map(function(f){return new Ug(f)}),[2,r.isBatchInput?u:u[0]]}})})},t.prototype.getDefaultModelName=function(){return"face_expression_model"},t.prototype.getClassifierChannelsIn=function(){return 256},t.prototype.getClassifierChannelsOut=function(){return 7},t}(OE);function rL(n){return n.expressions instanceof Ug}function NE(n,t){var e={expressions:t};return Object.assign({},n,e)}function KP(n,t,e,r){e===void 0&&(e=.1);var a=Array.isArray(t)?t:[t];a.forEach(function(i){var u=i instanceof Ug?i:rL(i)?i.expressions:void 0;if(!u)throw new Error("drawFaceExpressions - expected faceExpressions to be FaceExpressions | WithFaceExpressions<{}> or array thereof");var l=u.asSortedArray(),c=l.filter(function(v){return v.probability>e}),f=yl(i)?i.detection.box.bottomLeft:new st(0,0),d=new _E(c.map(function(v){return v.expression+" ("+Tg(v.probability)+")"}),f);d.draw(n)})}function ME(n){return yl(n)&&n.landmarks instanceof gl&&n.unshiftedLandmarks instanceof gl&&n.alignedRect instanceof rr}function Th(n,t){var e=n.detection.box,r=t.shiftBy(e.x,e.y),a=r.align(),i=n.detection.imageDims,u=new rr(n.detection.score,a.rescale(i.reverse()),i),l={landmarks:r,unshiftedLandmarks:t,alignedRect:u};return Object.assign({},n,l)}function aL(n,t){var e=Ah(n,t),r=Pg(n,t);function a(u,l,c){var f=r(u,l,c+"/separable_conv0"),d=r(l,l,c+"/separable_conv1"),v=e(u,l,1,c+"/expansion_conv");return{separable_conv0:f,separable_conv1:d,expansion_conv:v}}function i(u,l){var c=r(u,u,l+"/separable_conv0"),f=r(u,u,l+"/separable_conv1"),d=r(u,u,l+"/separable_conv2");return{separable_conv0:c,separable_conv1:f,separable_conv2:d}}return{extractConvParams:e,extractSeparableConvParams:r,extractReductionBlockParams:a,extractMainBlockParams:i}}function iL(n,t){var e=[],r=La(n),a=r.extractWeights,i=r.getRemainingWeights,u=aL(a,e),l=u.extractConvParams,c=u.extractSeparableConvParams,f=u.extractReductionBlockParams,d=u.extractMainBlockParams,v=l(3,32,3,"entry_flow/conv_in"),m=f(32,64,"entry_flow/reduction_block_0"),g=f(64,128,"entry_flow/reduction_block_1"),b={conv_in:v,reduction_block_0:m,reduction_block_1:g},w={};vl(t,0,1).forEach(function(R){w["main_block_"+R]=d(128,"middle_flow/main_block_"+R)});var S=f(128,256,"exit_flow/reduction_block"),_=c(256,512,"exit_flow/separable_conv"),E={reduction_block:S,separable_conv:_};if(i().length!==0)throw new Error("weights remaing after extract: "+i().length);return{paramMappings:e,params:{entry_flow:b,middle_flow:w,exit_flow:E}}}function oL(n,t){var e=Ni(n,t),r=AE(e),a=zg(e);function i(l){var c=a(l+"/separable_conv0"),f=a(l+"/separable_conv1"),d=r(l+"/expansion_conv");return{separable_conv0:c,separable_conv1:f,expansion_conv:d}}function u(l){var c=a(l+"/separable_conv0"),f=a(l+"/separable_conv1"),d=a(l+"/separable_conv2");return{separable_conv0:c,separable_conv1:f,separable_conv2:d}}return{extractConvParams:r,extractSeparableConvParams:a,extractReductionBlockParams:i,extractMainBlockParams:u}}function sL(n,t){var e=[],r=oL(n,e),a=r.extractConvParams,i=r.extractSeparableConvParams,u=r.extractReductionBlockParams,l=r.extractMainBlockParams,c=a("entry_flow/conv_in"),f=u("entry_flow/reduction_block_0"),d=u("entry_flow/reduction_block_1"),v={conv_in:c,reduction_block_0:f,reduction_block_1:d},m={};vl(t,0,1).forEach(function(S){m["main_block_"+S]=l("middle_flow/main_block_"+S)});var g=u("exit_flow/reduction_block"),b=i("exit_flow/separable_conv"),w={reduction_block:g,separable_conv:b};return Ba(n,e),{params:{entry_flow:v,middle_flow:m,exit_flow:w},paramMappings:e}}function IE(n,t,e){return Ye(wr(n,t.filters,e,"same"),t.bias)}function Lv(n,t,e){e===void 0&&(e=!0);var r=e?At(n):n;return r=er(r,t.separable_conv0,[1,1]),r=er(At(r),t.separable_conv1,[1,1]),r=an(r,[3,3],[2,2],"same"),r=Ye(r,IE(n,t.expansion_conv,[2,2])),r}function uL(n,t){var e=er(At(n),t.separable_conv0,[1,1]);return e=er(At(e),t.separable_conv1,[1,1]),e=er(At(e),t.separable_conv2,[1,1]),e=Ye(e,n),e}var lL=function(n){ze(t,n);function t(e){var r=n.call(this,"TinyXception")||this;return r._numMainBlocks=e,r}return t.prototype.forwardInput=function(e){var r=this,a=this.params;if(!a)throw new Error("TinyXception - load model before inference");return xe(function(){var i=e.toBatchTensor(112,!0),u=[122.782,117.001,104.298],l=Ol(i,u).div(ge(256)),c=At(IE(l,a.entry_flow.conv_in,[2,2]));return c=Lv(c,a.entry_flow.reduction_block_0,!1),c=Lv(c,a.entry_flow.reduction_block_1),vl(r._numMainBlocks,0,1).forEach(function(f){c=uL(c,a.middle_flow["main_block_"+f])}),c=Lv(c,a.exit_flow.reduction_block),c=At(er(c,a.exit_flow.separable_conv,[1,1])),c})},t.prototype.forward=function(e){return Te(this,void 0,void 0,function(){var r;return De(this,function(a){switch(a.label){case 0:return r=this.forwardInput,[4,ln(e)];case 1:return[2,r.apply(this,[a.sent()])]}})})},t.prototype.getDefaultModelName=function(){return"tiny_xception_model"},t.prototype.extractParamsFromWeigthMap=function(e){return sL(e,this._numMainBlocks)},t.prototype.extractParams=function(e){return iL(e,this._numMainBlocks)},t}(Fa);function cL(n){var t=[],e=La(n),r=e.extractWeights,a=e.getRemainingWeights,i=Lg(r,t),u=i(512,1,"fc/age"),l=i(512,2,"fc/gender");if(a().length!==0)throw new Error("weights remaing after extract: "+a().length);return{paramMappings:t,params:{fc:{age:u,gender:l}}}}function fL(n){var t=[],e=Ni(n,t);function r(i){var u=e(i+"/weights",2),l=e(i+"/bias",1);return{weights:u,bias:l}}var a={fc:{age:r("fc/age"),gender:r("fc/gender")}};return Ba(n,t),{params:a,paramMappings:t}}var rh;(function(n){n.FEMALE="female",n.MALE="male"})(rh||(rh={}));var hL=function(n){ze(t,n);function t(e){e===void 0&&(e=new lL(2));var r=n.call(this,"AgeGenderNet")||this;return r._faceFeatureExtractor=e,r}return Object.defineProperty(t.prototype,"faceFeatureExtractor",{get:function(){return this._faceFeatureExtractor},enumerable:!0,configurable:!0}),t.prototype.runNet=function(e){var r=this,a=this.params;if(!a)throw new Error(this._name+" - load model before inference");return xe(function(){var i=e instanceof nh?r.faceFeatureExtractor.forwardInput(e):e,u=Dl(i,[7,7],[2,2],"valid").as2D(i.shape[0],-1),l=$r(u,a.fc.age).as1D(),c=$r(u,a.fc.gender);return{age:l,gender:c}})},t.prototype.forwardInput=function(e){var r=this;return xe(function(){var a=r.runNet(e),i=a.age,u=a.gender;return{age:i,gender:Ma(u)}})},t.prototype.forward=function(e){return Te(this,void 0,void 0,function(){var r;return De(this,function(a){switch(a.label){case 0:return r=this.forwardInput,[4,ln(e)];case 1:return[2,r.apply(this,[a.sent()])]}})})},t.prototype.predictAgeAndGender=function(e){return Te(this,void 0,void 0,function(){var r,a,i,u,l,c,f=this;return De(this,function(d){switch(d.label){case 0:return[4,ln(e)];case 1:return r=d.sent(),[4,this.forwardInput(r)];case 2:return a=d.sent(),i=Yt(a.age),u=Yt(a.gender),l=i.map(function(v,m){return{ageTensor:v,genderTensor:u[m]}}),[4,Promise.all(l.map(function(v){var m=v.ageTensor,g=v.genderTensor;return Te(f,void 0,void 0,function(){var b,w,S,_,E;return De(this,function(R){switch(R.label){case 0:return[4,m.data()];case 1:return b=R.sent()[0],[4,g.data()];case 2:return w=R.sent()[0],S=w>.5,_=S?rh.MALE:rh.FEMALE,E=S?w:1-w,m.dispose(),g.dispose(),[2,{age:b,gender:_,genderProbability:E}]}})})}))];case 3:return c=d.sent(),a.age.dispose(),a.gender.dispose(),[2,r.isBatchInput?c:c[0]]}})})},t.prototype.getDefaultModelName=function(){return"age_gender_model"},t.prototype.dispose=function(e){e===void 0&&(e=!0),this.faceFeatureExtractor.dispose(e),n.prototype.dispose.call(this,e)},t.prototype.loadClassifierParams=function(e){var r=this.extractClassifierParams(e),a=r.params,i=r.paramMappings;this._params=a,this._paramMappings=i},t.prototype.extractClassifierParams=function(e){return cL(e)},t.prototype.extractParamsFromWeigthMap=function(e){var r=kE(e),a=r.featureExtractorMap,i=r.classifierMap;return this.faceFeatureExtractor.loadFromWeightMap(a),fL(i)},t.prototype.extractParams=function(e){var r=1539,a=e.slice(0,e.length-r),i=e.slice(e.length-r);return this.faceFeatureExtractor.extractWeights(a),this.extractClassifierParams(i)},t}(Fa),FE=function(n){ze(t,n);function t(){return n!==null&&n.apply(this,arguments)||this}return t.prototype.postProcess=function(e,r,a){var i=a.map(function(l){var c=l.width,f=l.height,d=r/Math.max(f,c);return{width:c*d,height:f*d}}),u=i.length;return xe(function(){var l=function(m,g){return tr([Jr([68],m),Jr([68],g)],1).as2D(1,136).as1D()},c=function(m,g){var b=i[m],w=b.width,S=b.height;return g(w,S)?Math.abs(w-S)/2:0},f=function(m){return c(m,function(g,b){return g<b})},d=function(m){return c(m,function(g,b){return b<g})},v=e.mul(Jr([u,136],r)).sub(tr(Array.from(Array(u),function(m,g){return l(f(g),d(g))}))).div(tr(Array.from(Array(u),function(m,g){return l(i[g].width,i[g].height)})));return v})},t.prototype.forwardInput=function(e){var r=this;return xe(function(){var a=r.runNet(e);return r.postProcess(a,e.inputSize,e.inputDimensions.map(function(i){var u=i[0],l=i[1];return{height:u,width:l}}))})},t.prototype.forward=function(e){return Te(this,void 0,void 0,function(){var r;return De(this,function(a){switch(a.label){case 0:return r=this.forwardInput,[4,ln(e)];case 1:return[2,r.apply(this,[a.sent()])]}})})},t.prototype.detectLandmarks=function(e){return Te(this,void 0,void 0,function(){var r,a,i,u=this;return De(this,function(l){switch(l.label){case 0:return[4,ln(e)];case 1:return r=l.sent(),a=xe(function(){return Yt(u.forwardInput(r))}),[4,Promise.all(a.map(function(c,f){return Te(u,void 0,void 0,function(){var d,v,m,g,b;return De(this,function(w){switch(w.label){case 0:return m=(v=Array).from,[4,c.data()];case 1:return d=m.apply(v,[w.sent()]),g=d.filter(function(S,_){return c2(_)}),b=d.filter(function(S,_){return!c2(_)}),[2,new VB(Array(68).fill(0).map(function(S,_){return new st(g[_],b[_])}),{height:r.getInputHeight(f),width:r.getInputWidth(f)})]}})})}))];case 2:return i=l.sent(),a.forEach(function(c){return c.dispose()}),[2,r.isBatchInput?i:i[0]]}})})},t.prototype.getClassifierChannelsOut=function(){return 136},t}(OE),BE=function(n){ze(t,n);function t(e){return e===void 0&&(e=new DE),n.call(this,"FaceLandmark68Net",e)||this}return t.prototype.getDefaultModelName=function(){return"face_landmark_68_model"},t.prototype.getClassifierChannelsIn=function(){return 256},t}(FE);function dL(n){var t=[],e=TE(n,t).extractDenseBlock3Params,r={dense0:e("dense0",!0),dense1:e("dense1"),dense2:e("dense2")};return Ba(n,t),{params:r,paramMappings:t}}function pL(n){var t=[],e=La(n),r=e.extractWeights,a=e.getRemainingWeights,i=RE(r,t).extractDenseBlock3Params,u=i(3,32,"dense0",!0),l=i(32,64,"dense1"),c=i(64,128,"dense2");if(a().length!==0)throw new Error("weights remaing after extract: "+a().length);return{paramMappings:t,params:{dense0:u,dense1:l,dense2:c}}}var vL=function(n){ze(t,n);function t(){return n.call(this,"TinyFaceFeatureExtractor")||this}return t.prototype.forwardInput=function(e){var r=this.params;if(!r)throw new Error("TinyFaceFeatureExtractor - load model before inference");return xe(function(){var a=e.toBatchTensor(112,!0),i=[122.782,117.001,104.298],u=Ol(a,i).div(ge(255)),l=Bv(u,r.dense0,!0);return l=Bv(l,r.dense1),l=Bv(l,r.dense2),l=Dl(l,[14,14],[2,2],"valid"),l})},t.prototype.forward=function(e){return Te(this,void 0,void 0,function(){var r;return De(this,function(a){switch(a.label){case 0:return r=this.forwardInput,[4,ln(e)];case 1:return[2,r.apply(this,[a.sent()])]}})})},t.prototype.getDefaultModelName=function(){return"face_feature_extractor_tiny_model"},t.prototype.extractParamsFromWeigthMap=function(e){return dL(e)},t.prototype.extractParams=function(e){return pL(e)},t}(Fa),mL=function(n){ze(t,n);function t(e){return e===void 0&&(e=new vL),n.call(this,"FaceLandmark68TinyNet",e)||this}return t.prototype.getDefaultModelName=function(){return"face_landmark_68_tiny_model"},t.prototype.getClassifierChannelsIn=function(){return 128},t}(FE);(function(n){ze(t,n);function t(){return n!==null&&n.apply(this,arguments)||this}return t})(BE);function gL(n,t){return Ye(Cn(n,t.weights),t.biases)}function Vg(n,t,e,r,a){a===void 0&&(a="same");var i=t.conv,u=i.filters,l=i.bias,c=wr(n,u,e,a);return c=Ye(c,l),c=gL(c,t.scale),r?At(c):c}function yL(n,t){return Vg(n,t,[1,1],!0)}function LE(n,t){return Vg(n,t,[1,1],!1)}function PE(n,t){return Vg(n,t,[2,2],!0,"valid")}function bL(n,t){function e(l,c,f){var d=n(l),v=d.length/(c*f*f);if(NB(v))throw new Error("depth has to be an integer: "+v+", weights.length: "+d.length+", numFilters: "+c+", filterSize: "+f);return xe(function(){return Ti(Bn(d,[c,v,f,f]),[2,3,1,0])})}function r(l,c,f,d){var v=e(l,c,f),m=Vt(n(c));return t.push({paramPath:d+"/filters"},{paramPath:d+"/bias"}),{filters:v,bias:m}}function a(l,c){var f=Vt(n(l)),d=Vt(n(l));return t.push({paramPath:c+"/weights"},{paramPath:c+"/biases"}),{weights:f,biases:d}}function i(l,c,f,d){var v=r(l,c,f,d+"/conv"),m=a(c,d+"/scale");return{conv:v,scale:m}}function u(l,c,f,d,v){v===void 0&&(v=!1);var m=i((v?.5:1)*l,c,f,d+"/conv1"),g=i(l,c,f,d+"/conv2");return{conv1:m,conv2:g}}return{extractConvLayerParams:i,extractResidualLayerParams:u}}function xL(n){var t=La(n),e=t.extractWeights,r=t.getRemainingWeights,a=[],i=bL(e,a),u=i.extractConvLayerParams,l=i.extractResidualLayerParams,c=u(4704,32,7,"conv32_down"),f=l(9216,32,3,"conv32_1"),d=l(9216,32,3,"conv32_2"),v=l(9216,32,3,"conv32_3"),m=l(36864,64,3,"conv64_down",!0),g=l(36864,64,3,"conv64_1"),b=l(36864,64,3,"conv64_2"),w=l(36864,64,3,"conv64_3"),S=l(147456,128,3,"conv128_down",!0),_=l(147456,128,3,"conv128_1"),E=l(147456,128,3,"conv128_2"),R=l(589824,256,3,"conv256_down",!0),C=l(589824,256,3,"conv256_1"),A=l(589824,256,3,"conv256_2"),D=l(589824,256,3,"conv256_down_out"),k=xe(function(){return Ti(_i(e(256*128),[128,256]),[1,0])});if(a.push({paramPath:"fc"}),r().length!==0)throw new Error("weights remaing after extract: "+r().length);var I={conv32_down:c,conv32_1:f,conv32_2:d,conv32_3:v,conv64_down:m,conv64_1:g,conv64_2:b,conv64_3:w,conv128_down:S,conv128_1:_,conv128_2:E,conv256_down:R,conv256_1:C,conv256_2:A,conv256_down_out:D,fc:k};return{params:I,paramMappings:a}}function wL(n,t){var e=Ni(n,t);function r(u){var l=e(u+"/scale/weights",1),c=e(u+"/scale/biases",1);return{weights:l,biases:c}}function a(u){var l=e(u+"/conv/filters",4),c=e(u+"/conv/bias",1),f=r(u);return{conv:{filters:l,bias:c},scale:f}}function i(u){return{conv1:a(u+"/conv1"),conv2:a(u+"/conv2")}}return{extractConvLayerParams:a,extractResidualLayerParams:i}}function _L(n){var t=[],e=wL(n,t),r=e.extractConvLayerParams,a=e.extractResidualLayerParams,i=r("conv32_down"),u=a("conv32_1"),l=a("conv32_2"),c=a("conv32_3"),f=a("conv64_down"),d=a("conv64_1"),v=a("conv64_2"),m=a("conv64_3"),g=a("conv128_down"),b=a("conv128_1"),w=a("conv128_2"),S=a("conv256_down"),_=a("conv256_1"),E=a("conv256_2"),R=a("conv256_down_out"),C=n.fc;if(t.push({originalPath:"fc",paramPath:"fc"}),!OB(C))throw new Error("expected weightMap[fc] to be a Tensor2D, instead have "+C);var A={conv32_down:i,conv32_1:u,conv32_2:l,conv32_3:c,conv64_down:f,conv64_1:d,conv64_2:v,conv64_3:m,conv128_down:g,conv128_1:b,conv128_2:w,conv256_down:S,conv256_1:_,conv256_2:E,conv256_down_out:R,fc:C};return Ba(n,t),{params:A,paramMappings:t}}function Hr(n,t){var e=yL(n,t.conv1);return e=LE(e,t.conv2),e=Ye(e,n),e=At(e),e}function lf(n,t){var e=PE(n,t.conv1);e=LE(e,t.conv2);var r=Dl(n,2,2,"valid"),a=St(r.shape),i=r.shape[3]!==e.shape[3],u=r.shape[1]!==e.shape[1]||r.shape[2]!==e.shape[2];if(u){var l=tl(e.shape);l[1]=1;var c=St(l);e=$t([e,c],1);var f=tl(e.shape);f[2]=1;var d=St(f);e=$t([e,d],2)}return r=i?$t([r,a],3):r,e=Ye(r,e),e=At(e),e}var SL=function(n){ze(t,n);function t(){return n.call(this,"FaceRecognitionNet")||this}return t.prototype.forwardInput=function(e){var r=this.params;if(!r)throw new Error("FaceRecognitionNet - load model before inference");return xe(function(){var a=e.toBatchTensor(150,!0).toFloat(),i=[122.782,117.001,104.298],u=Ol(a,i).div(ge(256)),l=PE(u,r.conv32_down);l=an(l,3,2,"valid"),l=Hr(l,r.conv32_1),l=Hr(l,r.conv32_2),l=Hr(l,r.conv32_3),l=lf(l,r.conv64_down),l=Hr(l,r.conv64_1),l=Hr(l,r.conv64_2),l=Hr(l,r.conv64_3),l=lf(l,r.conv128_down),l=Hr(l,r.conv128_1),l=Hr(l,r.conv128_2),l=lf(l,r.conv256_down),l=Hr(l,r.conv256_1),l=Hr(l,r.conv256_2),l=lf(l,r.conv256_down_out);var c=l.mean([1,2]),f=xh(c,r.fc);return f})},t.prototype.forward=function(e){return Te(this,void 0,void 0,function(){var r;return De(this,function(a){switch(a.label){case 0:return r=this.forwardInput,[4,ln(e)];case 1:return[2,r.apply(this,[a.sent()])]}})})},t.prototype.computeFaceDescriptor=function(e){return Te(this,void 0,void 0,function(){var r,a,i,u=this;return De(this,function(l){switch(l.label){case 0:return[4,ln(e)];case 1:return r=l.sent(),a=xe(function(){return Yt(u.forwardInput(r))}),[4,Promise.all(a.map(function(c){return c.data()}))];case 2:return i=l.sent(),a.forEach(function(c){return c.dispose()}),[2,r.isBatchInput?i:i[0]]}})})},t.prototype.getDefaultModelName=function(){return"face_recognition_model"},t.prototype.extractParamsFromWeigthMap=function(e){return _L(e)},t.prototype.extractParams=function(e){return xL(e)},t}(Fa);function zE(n,t){var e={descriptor:t};return Object.assign({},n,e)}function UE(n,t){var e={age:t};return Object.assign({},n,e)}function VE(n,t,e){var r={gender:t,genderProbability:e};return Object.assign({},n,r)}var HE=function(){function n(t){var e=t===void 0?{}:t,r=e.minFaceSize,a=e.scaleFactor,i=e.maxNumScales,u=e.scoreThresholds,l=e.scaleSteps;if(this._name="MtcnnOptions",this._minFaceSize=r||20,this._scaleFactor=a||.709,this._maxNumScales=i||10,this._scoreThresholds=u||[.6,.7,.7],this._scaleSteps=l,typeof this._minFaceSize!="number"||this._minFaceSize<0)throw new Error(this._name+" - expected minFaceSize to be a number > 0");if(typeof this._scaleFactor!="number"||this._scaleFactor<=0||this._scaleFactor>=1)throw new Error(this._name+" - expected scaleFactor to be a number between 0 and 1");if(typeof this._maxNumScales!="number"||this._maxNumScales<0)throw new Error(this._name+" - expected maxNumScales to be a number > 0");if(!Array.isArray(this._scoreThresholds)||this._scoreThresholds.length!==3||this._scoreThresholds.some(function(c){return typeof c!="number"}))throw new Error(this._name+" - expected scoreThresholds to be an array of numbers of length 3");if(this._scaleSteps&&(!Array.isArray(this._scaleSteps)||this._scaleSteps.some(function(c){return typeof c!="number"})))throw new Error(this._name+" - expected scaleSteps to be an array of numbers")}return Object.defineProperty(n.prototype,"minFaceSize",{get:function(){return this._minFaceSize},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"scaleFactor",{get:function(){return this._scaleFactor},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"maxNumScales",{get:function(){return this._maxNumScales},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"scoreThresholds",{get:function(){return this._scoreThresholds},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"scaleSteps",{get:function(){return this._scaleSteps},enumerable:!0,configurable:!0}),n}();function EL(n,t){function e(c,f){var d=Bn(n(9*c),[3,3,c,1]),v=Vt(n(c)),m=Vt(n(c)),g=Vt(n(c)),b=Vt(n(c));return t.push({paramPath:f+"/filters"},{paramPath:f+"/batch_norm_scale"},{paramPath:f+"/batch_norm_offset"},{paramPath:f+"/batch_norm_mean"},{paramPath:f+"/batch_norm_variance"}),{filters:d,batch_norm_scale:v,batch_norm_offset:m,batch_norm_mean:g,batch_norm_variance:b}}function r(c,f,d,v,m){var g=Bn(n(c*f*d*d),[d,d,c,f]),b=Vt(n(f));return t.push({paramPath:v+"/filters"},{paramPath:v+"/"+(m?"batch_norm_offset":"bias")}),{filters:g,bias:b}}function a(c,f,d,v){var m=r(c,f,d,v,!0),g=m.filters,b=m.bias;return{filters:g,batch_norm_offset:b}}function i(c,f,d){var v=e(c,d+"/depthwise_conv"),m=a(c,f,1,d+"/pointwise_conv");return{depthwise_conv:v,pointwise_conv:m}}function u(){var c=a(3,32,3,"mobilenetv1/conv_0"),f=i(32,64,"mobilenetv1/conv_1"),d=i(64,128,"mobilenetv1/conv_2"),v=i(128,128,"mobilenetv1/conv_3"),m=i(128,256,"mobilenetv1/conv_4"),g=i(256,256,"mobilenetv1/conv_5"),b=i(256,512,"mobilenetv1/conv_6"),w=i(512,512,"mobilenetv1/conv_7"),S=i(512,512,"mobilenetv1/conv_8"),_=i(512,512,"mobilenetv1/conv_9"),E=i(512,512,"mobilenetv1/conv_10"),R=i(512,512,"mobilenetv1/conv_11"),C=i(512,1024,"mobilenetv1/conv_12"),A=i(1024,1024,"mobilenetv1/conv_13");return{conv_0:c,conv_1:f,conv_2:d,conv_3:v,conv_4:m,conv_5:g,conv_6:b,conv_7:w,conv_8:S,conv_9:_,conv_10:E,conv_11:R,conv_12:C,conv_13:A}}function l(){var c=a(1024,256,1,"prediction_layer/conv_0"),f=a(256,512,3,"prediction_layer/conv_1"),d=a(512,128,1,"prediction_layer/conv_2"),v=a(128,256,3,"prediction_layer/conv_3"),m=a(256,128,1,"prediction_layer/conv_4"),g=a(128,256,3,"prediction_layer/conv_5"),b=a(256,64,1,"prediction_layer/conv_6"),w=a(64,128,3,"prediction_layer/conv_7"),S=r(512,12,1,"prediction_layer/box_predictor_0/box_encoding_predictor"),_=r(512,9,1,"prediction_layer/box_predictor_0/class_predictor"),E=r(1024,24,1,"prediction_layer/box_predictor_1/box_encoding_predictor"),R=r(1024,18,1,"prediction_layer/box_predictor_1/class_predictor"),C=r(512,24,1,"prediction_layer/box_predictor_2/box_encoding_predictor"),A=r(512,18,1,"prediction_layer/box_predictor_2/class_predictor"),D=r(256,24,1,"prediction_layer/box_predictor_3/box_encoding_predictor"),k=r(256,18,1,"prediction_layer/box_predictor_3/class_predictor"),I=r(256,24,1,"prediction_layer/box_predictor_4/box_encoding_predictor"),N=r(256,18,1,"prediction_layer/box_predictor_4/class_predictor"),B=r(128,24,1,"prediction_layer/box_predictor_5/box_encoding_predictor"),V=r(128,18,1,"prediction_layer/box_predictor_5/class_predictor"),U={box_encoding_predictor:S,class_predictor:_},J={box_encoding_predictor:E,class_predictor:R},ee={box_encoding_predictor:C,class_predictor:A},te={box_encoding_predictor:D,class_predictor:k},P={box_encoding_predictor:I,class_predictor:N},j={box_encoding_predictor:B,class_predictor:V};return{conv_0:c,conv_1:f,conv_2:d,conv_3:v,conv_4:m,conv_5:g,conv_6:b,conv_7:w,box_predictor_0:U,box_predictor_1:J,box_predictor_2:ee,box_predictor_3:te,box_predictor_4:P,box_predictor_5:j}}return{extractMobilenetV1Params:u,extractPredictionLayerParams:l}}function CL(n){var t=[],e=La(n),r=e.extractWeights,a=e.getRemainingWeights,i=EL(r,t),u=i.extractMobilenetV1Params,l=i.extractPredictionLayerParams,c=u(),f=l(),d=tg(r(5118*4),[1,5118,4]),v={extra_dim:d};if(t.push({paramPath:"output_layer/extra_dim"}),a().length!==0)throw new Error("weights remaing after extract: "+a().length);return{params:{mobilenetv1:c,prediction_layer:f,output_layer:v},paramMappings:t}}function RL(n,t){var e=Ni(n,t);function r(f,d,v){var m=e(f+"/Conv2d_"+d+"_pointwise/weights",4,v+"/filters"),g=e(f+"/Conv2d_"+d+"_pointwise/convolution_bn_offset",1,v+"/batch_norm_offset");return{filters:m,batch_norm_offset:g}}function a(f){var d="mobilenetv1/conv_"+f,v="MobilenetV1/Conv2d_"+f+"_depthwise",m=d+"/depthwise_conv",g=d+"/pointwise_conv",b=e(v+"/depthwise_weights",4,m+"/filters"),w=e(v+"/BatchNorm/gamma",1,m+"/batch_norm_scale"),S=e(v+"/BatchNorm/beta",1,m+"/batch_norm_offset"),_=e(v+"/BatchNorm/moving_mean",1,m+"/batch_norm_mean"),E=e(v+"/BatchNorm/moving_variance",1,m+"/batch_norm_variance");return{depthwise_conv:{filters:b,batch_norm_scale:w,batch_norm_offset:S,batch_norm_mean:_,batch_norm_variance:E},pointwise_conv:r("MobilenetV1",f,g)}}function i(){return{conv_0:r("MobilenetV1",0,"mobilenetv1/conv_0"),conv_1:a(1),conv_2:a(2),conv_3:a(3),conv_4:a(4),conv_5:a(5),conv_6:a(6),conv_7:a(7),conv_8:a(8),conv_9:a(9),conv_10:a(10),conv_11:a(11),conv_12:a(12),conv_13:a(13)}}function u(f,d){var v=e(f+"/weights",4,d+"/filters"),m=e(f+"/biases",1,d+"/bias");return{filters:v,bias:m}}function l(f){var d=u("Prediction/BoxPredictor_"+f+"/BoxEncodingPredictor","prediction_layer/box_predictor_"+f+"/box_encoding_predictor"),v=u("Prediction/BoxPredictor_"+f+"/ClassPredictor","prediction_layer/box_predictor_"+f+"/class_predictor");return{box_encoding_predictor:d,class_predictor:v}}function c(){return{conv_0:r("Prediction",0,"prediction_layer/conv_0"),conv_1:r("Prediction",1,"prediction_layer/conv_1"),conv_2:r("Prediction",2,"prediction_layer/conv_2"),conv_3:r("Prediction",3,"prediction_layer/conv_3"),conv_4:r("Prediction",4,"prediction_layer/conv_4"),conv_5:r("Prediction",5,"prediction_layer/conv_5"),conv_6:r("Prediction",6,"prediction_layer/conv_6"),conv_7:r("Prediction",7,"prediction_layer/conv_7"),box_predictor_0:l(0),box_predictor_1:l(1),box_predictor_2:l(2),box_predictor_3:l(3),box_predictor_4:l(4),box_predictor_5:l(5)}}return{extractMobilenetV1Params:i,extractPredictionLayerParams:c}}function AL(n){var t=[],e=RL(n,t),r=e.extractMobilenetV1Params,a=e.extractPredictionLayerParams,i=n["Output/extra_dim"];if(t.push({originalPath:"Output/extra_dim",paramPath:"output_layer/extra_dim"}),!Eh(i))throw new Error("expected weightMap['Output/extra_dim'] to be a Tensor3D, instead have "+i);var u={mobilenetv1:r(),prediction_layer:a(),output_layer:{extra_dim:i}};return Ba(n,t),{params:u,paramMappings:t}}function jr(n,t,e){return xe(function(){var r=wr(n,t.filters,e,"same");return r=Ye(r,t.batch_norm_offset),hg(r,0,6)})}var TL=.0010000000474974513;function DL(n,t,e){return xe(function(){var r=bh(n,t.filters,e,"same");return r=FS(r,t.batch_norm_mean,t.batch_norm_variance,t.batch_norm_offset,t.batch_norm_scale,TL),hg(r,0,6)})}function kL(n){return[2,4,6,12].some(function(t){return t===n})?[2,2]:[1,1]}function OL(n,t){return xe(function(){var e=null,r=jr(n,t.conv_0,[2,2]),a=[t.conv_1,t.conv_2,t.conv_3,t.conv_4,t.conv_5,t.conv_6,t.conv_7,t.conv_8,t.conv_9,t.conv_10,t.conv_11,t.conv_12,t.conv_13];if(a.forEach(function(i,u){var l=u+1,c=kL(l);r=DL(r,i.depthwise_conv,c),r=jr(r,i.pointwise_conv,[1,1]),l===11&&(e=r)}),e===null)throw new Error("mobileNetV1 - output of conv layer 11 is null");return{out:r,conv11:e}})}function NL(n,t,e,r,a){var i=n.shape[0],u=Math.min(e,i),l=t.map(function(d,v){return{score:d,boxIndex:v}}).filter(function(d){return d.score>a}).sort(function(d,v){return v.score-d.score}),c=function(d){return d<=r?1:0},f=[];return l.forEach(function(d){if(!(f.length>=u)){for(var v=d.score,m=f.length-1;m>=0;--m){var g=ML(n,d.boxIndex,f[m]);if(g!==0&&(d.score*=c(g),d.score<=a))break}v===d.score&&f.push(d.boxIndex)}}),f}function ML(n,t,e){var r=n.arraySync(),a=Math.min(r[t][0],r[t][2]),i=Math.min(r[t][1],r[t][3]),u=Math.max(r[t][0],r[t][2]),l=Math.max(r[t][1],r[t][3]),c=Math.min(r[e][0],r[e][2]),f=Math.min(r[e][1],r[e][3]),d=Math.max(r[e][0],r[e][2]),v=Math.max(r[e][1],r[e][3]),m=(u-a)*(l-i),g=(d-c)*(v-f);if(m<=0||g<=0)return 0;var b=Math.max(a,c),w=Math.max(i,f),S=Math.min(u,d),_=Math.min(l,v),E=Math.max(S-b,0)*Math.max(_-w,0);return E/(m+g-E)}function IL(n){var t=Yt(Ti(n,[1,0])),e=[Zt(t[2],t[0]),Zt(t[3],t[1])],r=[Ye(t[0],Tr(e[0],ge(2))),Ye(t[1],Tr(e[1],ge(2)))];return{sizes:e,centers:r}}function FL(n,t){var e=IL(n),r=e.sizes,a=e.centers,i=Yt(Ti(t,[1,0])),u=Tr(Cn(Cm(Tr(i[2],ge(5))),r[0]),ge(2)),l=Ye(Cn(Tr(i[0],ge(10)),r[0]),a[0]),c=Tr(Cn(Cm(Tr(i[3],ge(5))),r[1]),ge(2)),f=Ye(Cn(Tr(i[1],ge(10)),r[1]),a[1]);return Ti(tr([Zt(l,u),Zt(f,c),Ye(l,u),Ye(f,c)]),[1,0])}function BL(n,t,e){return xe(function(){var r=n.shape[0],a=FL(Dr(gs(e.extra_dim,[r,1,1]),[-1,4]),Dr(n,[-1,4]));a=Dr(a,[r,a.shape[0]/r,4]);var i=OS(ea(t,[0,0,1],[-1,-1,-1])),u=ea(i,[0,0,0],[-1,-1,1]);u=Dr(u,[r,u.shape[1]]);var l=Yt(a),c=Yt(u);return{boxes:l,scores:c}})}function us(n,t){return xe(function(){var e=n.shape[0],r=Dr(Or(n,t.box_encoding_predictor),[e,-1,1,4]),a=Dr(Or(n,t.class_predictor),[e,-1,3]);return{boxPredictionEncoding:r,classPrediction:a}})}function LL(n,t,e){return xe(function(){var r=jr(n,e.conv_0,[1,1]),a=jr(r,e.conv_1,[2,2]),i=jr(a,e.conv_2,[1,1]),u=jr(i,e.conv_3,[2,2]),l=jr(u,e.conv_4,[1,1]),c=jr(l,e.conv_5,[2,2]),f=jr(c,e.conv_6,[1,1]),d=jr(f,e.conv_7,[2,2]),v=us(t,e.box_predictor_0),m=us(n,e.box_predictor_1),g=us(a,e.box_predictor_2),b=us(u,e.box_predictor_3),w=us(c,e.box_predictor_4),S=us(d,e.box_predictor_5),_=$t([v.boxPredictionEncoding,m.boxPredictionEncoding,g.boxPredictionEncoding,b.boxPredictionEncoding,w.boxPredictionEncoding,S.boxPredictionEncoding],1),E=$t([v.classPrediction,m.classPrediction,g.classPrediction,b.classPrediction,w.classPrediction,S.classPrediction],1);return{boxPredictions:_,classPredictions:E}})}var Dh=function(){function n(t){var e=t===void 0?{}:t,r=e.minConfidence,a=e.maxResults;if(this._name="SsdMobilenetv1Options",this._minConfidence=r||.5,this._maxResults=a||100,typeof this._minConfidence!="number"||this._minConfidence<=0||this._minConfidence>=1)throw new Error(this._name+" - expected minConfidence to be a number between 0 and 1");if(typeof this._maxResults!="number")throw new Error(this._name+" - expected maxResults to be a number")}return Object.defineProperty(n.prototype,"minConfidence",{get:function(){return this._minConfidence},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"maxResults",{get:function(){return this._maxResults},enumerable:!0,configurable:!0}),n}(),jE=function(n){ze(t,n);function t(){return n.call(this,"SsdMobilenetv1")||this}return t.prototype.forwardInput=function(e){var r=this.params;if(!r)throw new Error("SsdMobilenetv1 - load model before inference");return xe(function(){var a=e.toBatchTensor(512,!1).toFloat(),i=Zt(Cn(a,ge(.007843137718737125)),ge(1)),u=OL(i,r.mobilenetv1),l=LL(u.out,u.conv11,r.prediction_layer),c=l.boxPredictions,f=l.classPredictions;return BL(c,f,r.output_layer)})},t.prototype.forward=function(e){return Te(this,void 0,void 0,function(){var r;return De(this,function(a){switch(a.label){case 0:return r=this.forwardInput,[4,ln(e)];case 1:return[2,r.apply(this,[a.sent()])]}})})},t.prototype.locateFaces=function(e,r){return r===void 0&&(r={}),Te(this,void 0,void 0,function(){var a,i,u,l,c,f,d,v,m,g,b,w,S,_,E,R,C,A,D,k,I;return De(this,function(N){switch(N.label){case 0:return a=new Dh(r),i=a.maxResults,u=a.minConfidence,[4,ln(e)];case 1:for(l=N.sent(),c=this.forwardInput(l),f=c.boxes,d=c.scores,v=f[0],m=d[0],g=1;g<f.length;g++)f[g].dispose(),d[g].dispose();return S=(w=Array).from,[4,m.data()];case 2:return b=S.apply(w,[N.sent()]),_=.5,E=NL(v,b,i,_,u),R=l.getReshapedInputDimensions(0),C=l.inputSize,A=C/R.width,D=C/R.height,k=v.arraySync(),I=E.map(function(B){var V=[Math.max(0,k[B][0]),Math.min(1,k[B][2])].map(function(j){return j*D}),U=V[0],J=V[1],ee=[Math.max(0,k[B][1]),Math.min(1,k[B][3])].map(function(j){return j*A}),te=ee[0],P=ee[1];return new rr(b[B],new kg(te,U,P-te,J-U),{height:l.getInputHeight(0),width:l.getInputWidth(0)})}),v.dispose(),m.dispose(),[2,I]}})})},t.prototype.getDefaultModelName=function(){return"ssd_mobilenetv1_model"},t.prototype.extractParamsFromWeigthMap=function(e){return AL(e)},t.prototype.extractParams=function(e){return CL(e)},t}(Fa);(function(n){ze(t,n);function t(){return n!==null&&n.apply(this,arguments)||this}return t})(jE);var PL=.4,zL=[new st(.738768,.874946),new st(2.42204,2.65704),new st(4.30971,7.04493),new st(10.246,4.59428),new st(12.6868,11.8741)],UL=[new st(1.603231,2.094468),new st(6.041143,7.080126),new st(2.882459,3.518061),new st(4.266906,5.178857),new st(9.041765,10.66308)],VL=[117.001,114.697,97.404],HL="tiny_yolov2_model",jL="tiny_yolov2_separable_conv_model",cf=function(n){return typeof n=="number"};function WL(n){if(!n)throw new Error("invalid config: "+n);if(typeof n.withSeparableConvs!="boolean")throw new Error("config.withSeparableConvs has to be a boolean, have: "+n.withSeparableConvs);if(!cf(n.iouThreshold)||n.iouThreshold<0||n.iouThreshold>1)throw new Error("config.iouThreshold has to be a number between [0, 1], have: "+n.iouThreshold);if(!Array.isArray(n.classes)||!n.classes.length||!n.classes.every(function(t){return typeof t=="string"}))throw new Error("config.classes has to be an array class names: string[], have: "+JSON.stringify(n.classes));if(!Array.isArray(n.anchors)||!n.anchors.length||!n.anchors.map(function(t){return t||{}}).every(function(t){return cf(t.x)&&cf(t.y)}))throw new Error("config.anchors has to be an array of { x: number, y: number }, have: "+JSON.stringify(n.anchors));if(n.meanRgb&&(!Array.isArray(n.meanRgb)||n.meanRgb.length!==3||!n.meanRgb.every(cf)))throw new Error("config.meanRgb has to be an array of shape [number, number, number], have: "+JSON.stringify(n.meanRgb))}function Hg(n){return xe(function(){var t=Cn(n,ge(.10000000149011612));return Ye(At(Zt(n,t)),t)})}function ci(n,t){return xe(function(){var e=po(n,[[0,0],[1,1],[1,1],[0,0]]);return e=wr(e,t.conv.filters,[1,1],"valid"),e=Zt(e,t.bn.sub),e=Cn(e,t.bn.truediv),e=Ye(e,t.conv.bias),Hg(e)})}function fi(n,t){return xe(function(){var e=po(n,[[0,0],[1,1],[1,1],[0,0]]);return e=mg(e,t.depthwise_filter,t.pointwise_filter,[1,1],"valid"),e=Ye(e,t.bias),Hg(e)})}function GL(n,t){var e=Ah(n,t);function r(u,l){var c=Vt(n(u)),f=Vt(n(u));return t.push({paramPath:l+"/sub"},{paramPath:l+"/truediv"}),{sub:c,truediv:f}}function a(u,l,c){var f=e(u,l,3,c+"/conv"),d=r(l,c+"/bn");return{conv:f,bn:d}}var i=Pg(n,t);return{extractConvParams:e,extractConvWithBatchNormParams:a,extractSeparableConvParams:i}}function qL(n,t,e,r){var a=La(n),i=a.extractWeights,u=a.getRemainingWeights,l=[],c=GL(i,l),f=c.extractConvParams,d=c.extractConvWithBatchNormParams,v=c.extractSeparableConvParams,m;if(t.withSeparableConvs){var g=r[0],b=r[1],w=r[2],S=r[3],_=r[4],E=r[5],R=r[6],C=r[7],A=r[8],D=t.isFirstLayerConv2d?f(g,b,3,"conv0"):v(g,b,"conv0"),k=v(b,w,"conv1"),I=v(w,S,"conv2"),N=v(S,_,"conv3"),B=v(_,E,"conv4"),V=v(E,R,"conv5"),U=C?v(R,C,"conv6"):void 0,J=A?v(C,A,"conv7"):void 0,ee=f(A||C||R,5*e,1,"conv8");m={conv0:D,conv1:k,conv2:I,conv3:N,conv4:B,conv5:V,conv6:U,conv7:J,conv8:ee}}else{var g=r[0],b=r[1],w=r[2],S=r[3],_=r[4],E=r[5],R=r[6],C=r[7],A=r[8],D=d(g,b,"conv0"),k=d(b,w,"conv1"),I=d(w,S,"conv2"),N=d(S,_,"conv3"),B=d(_,E,"conv4"),V=d(E,R,"conv5"),U=d(R,C,"conv6"),J=d(C,A,"conv7"),ee=f(A,5*e,1,"conv8");m={conv0:D,conv1:k,conv2:I,conv3:N,conv4:B,conv5:V,conv6:U,conv7:J,conv8:ee}}if(u().length!==0)throw new Error("weights remaing after extract: "+u().length);return{params:m,paramMappings:l}}function KL(n,t){var e=Ni(n,t);function r(l){var c=e(l+"/sub",1),f=e(l+"/truediv",1);return{sub:c,truediv:f}}function a(l){var c=e(l+"/filters",4),f=e(l+"/bias",1);return{filters:c,bias:f}}function i(l){var c=a(l+"/conv"),f=r(l+"/bn");return{conv:c,bn:f}}var u=zg(e);return{extractConvParams:a,extractConvWithBatchNormParams:i,extractSeparableConvParams:u}}function XL(n,t){var e=[],r=KL(n,e),a=r.extractConvParams,i=r.extractConvWithBatchNormParams,u=r.extractSeparableConvParams,l;if(t.withSeparableConvs){var c=t.filterSizes&&t.filterSizes.length||9;l={conv0:t.isFirstLayerConv2d?a("conv0"):u("conv0"),conv1:u("conv1"),conv2:u("conv2"),conv3:u("conv3"),conv4:u("conv4"),conv5:u("conv5"),conv6:c>7?u("conv6"):void 0,conv7:c>8?u("conv7"):void 0,conv8:a("conv8")}}else l={conv0:i("conv0"),conv1:i("conv1"),conv2:i("conv2"),conv3:i("conv3"),conv4:i("conv4"),conv5:i("conv5"),conv6:i("conv6"),conv7:i("conv7"),conv8:a("conv8")};return Ba(n,e),{params:l,paramMappings:e}}var g2;(function(n){n[n.XS=224]="XS",n[n.SM=320]="SM",n[n.MD=416]="MD",n[n.LG=608]="LG"})(g2||(g2={}));var jg=function(){function n(t){var e=t===void 0?{}:t,r=e.inputSize,a=e.scoreThreshold;if(this._name="TinyYolov2Options",this._inputSize=r||416,this._scoreThreshold=a||.5,typeof this._inputSize!="number"||this._inputSize%32!==0)throw new Error(this._name+" - expected inputSize to be a number divisible by 32");if(typeof this._scoreThreshold!="number"||this._scoreThreshold<=0||this._scoreThreshold>=1)throw new Error(this._name+" - expected scoreThreshold to be a number between 0 and 1")}return Object.defineProperty(n.prototype,"inputSize",{get:function(){return this._inputSize},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"scoreThreshold",{get:function(){return this._scoreThreshold},enumerable:!0,configurable:!0}),n}(),WE=function(n){ze(t,n);function t(e){var r=n.call(this,"TinyYolov2")||this;return WL(e),r._config=e,r}return Object.defineProperty(t.prototype,"config",{get:function(){return this._config},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"withClassScores",{get:function(){return this.config.withClassScores||this.config.classes.length>1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"boxEncodingSize",{get:function(){return 5+(this.withClassScores?this.config.classes.length:0)},enumerable:!0,configurable:!0}),t.prototype.runTinyYolov2=function(e,r){var a=ci(e,r.conv0);return a=an(a,[2,2],[2,2],"same"),a=ci(a,r.conv1),a=an(a,[2,2],[2,2],"same"),a=ci(a,r.conv2),a=an(a,[2,2],[2,2],"same"),a=ci(a,r.conv3),a=an(a,[2,2],[2,2],"same"),a=ci(a,r.conv4),a=an(a,[2,2],[2,2],"same"),a=ci(a,r.conv5),a=an(a,[2,2],[1,1],"same"),a=ci(a,r.conv6),a=ci(a,r.conv7),Or(a,r.conv8,"valid",!1)},t.prototype.runMobilenet=function(e,r){var a=this.config.isFirstLayerConv2d?Hg(Or(e,r.conv0,"valid",!1)):fi(e,r.conv0);return a=an(a,[2,2],[2,2],"same"),a=fi(a,r.conv1),a=an(a,[2,2],[2,2],"same"),a=fi(a,r.conv2),a=an(a,[2,2],[2,2],"same"),a=fi(a,r.conv3),a=an(a,[2,2],[2,2],"same"),a=fi(a,r.conv4),a=an(a,[2,2],[2,2],"same"),a=fi(a,r.conv5),a=an(a,[2,2],[1,1],"same"),a=r.conv6?fi(a,r.conv6):a,a=r.conv7?fi(a,r.conv7):a,Or(a,r.conv8,"valid",!1)},t.prototype.forwardInput=function(e,r){var a=this,i=this.params;if(!i)throw new Error("TinyYolov2 - load model before inference");return xe(function(){var u=e.toBatchTensor(r,!1).toFloat();return u=a.config.meanRgb?Ol(u,a.config.meanRgb):u,u=u.div(ge(256)),a.config.withSeparableConvs?a.runMobilenet(u,i):a.runTinyYolov2(u,i)})},t.prototype.forward=function(e,r){return Te(this,void 0,void 0,function(){var a;return De(this,function(i){switch(i.label){case 0:return a=this.forwardInput,[4,ln(e)];case 1:return[4,a.apply(this,[i.sent(),r])];case 2:return[2,i.sent()]}})})},t.prototype.detect=function(e,r){return r===void 0&&(r={}),Te(this,void 0,void 0,function(){var a,i,u,l,c,f,d,v,m,g,b,w,S,_,E=this;return De(this,function(R){switch(R.label){case 0:return a=new jg(r),i=a.inputSize,u=a.scoreThreshold,[4,ln(e)];case 1:return l=R.sent(),[4,this.forwardInput(l,i)];case 2:return c=R.sent(),f=xe(function(){return Yt(c)[0].expandDims()}),d={width:l.getInputWidth(0),height:l.getInputHeight(0)},[4,this.extractBoxes(f,l.getReshapedInputDimensions(0),u)];case 3:return v=R.sent(),c.dispose(),f.dispose(),m=v.map(function(C){return C.box}),g=v.map(function(C){return C.score}),b=v.map(function(C){return C.classScore}),w=v.map(function(C){return E.config.classes[C.label]}),S=ml(m.map(function(C){return C.rescale(i)}),g,this.config.iouThreshold,!0),_=S.map(function(C){return new vE(g[C],b[C],w[C],m[C],d)}),[2,_]}})})},t.prototype.getDefaultModelName=function(){return""},t.prototype.extractParamsFromWeigthMap=function(e){return XL(e,this.config)},t.prototype.extractParams=function(e){var r=this.config.filterSizes||t.DEFAULT_FILTER_SIZES,a=r?r.length:void 0;if(a!==7&&a!==8&&a!==9)throw new Error("TinyYolov2 - expected 7 | 8 | 9 convolutional filters, but found "+a+" filterSizes in config");return qL(e,this.config,this.boxEncodingSize,r)},t.prototype.extractBoxes=function(e,r,a){return Te(this,void 0,void 0,function(){var i,u,l,c,f,d,v,m,g,b,w,S,_,E,R,C,A,D,k,I,N,B,V,U,J,ee,te,P,j,K=this;return De(this,function(ne){switch(ne.label){case 0:return i=r.width,u=r.height,l=Math.max(i,u),c=l/i,f=l/u,d=e.shape[1],v=this.config.anchors.length,m=xe(function(){var M=e.reshape([d,d,v,K.boxEncodingSize]),G=M.slice([0,0,0,0],[d,d,v,4]),ie=M.slice([0,0,0,4],[d,d,v,1]),oe=K.withClassScores?Ma(M.slice([0,0,0,5],[d,d,v,K.config.classes.length]),3):ge(0);return[G,ie,oe]}),g=m[0],b=m[1],w=m[2],S=[],[4,b.array()];case 1:return _=ne.sent(),[4,g.array()];case 2:E=ne.sent(),R=0,ne.label=3;case 3:if(!(R<d))return[3,12];C=0,ne.label=4;case 4:if(!(C<d))return[3,11];A=0,ne.label=5;case 5:return A<v?(D=Fv(_[R][C][A][0]),!a||D>a?(k=(C+Fv(E[R][C][A][0]))/d*c,I=(R+Fv(E[R][C][A][1]))/d*f,N=Math.exp(E[R][C][A][2])*this.config.anchors[A].x/d*c,B=Math.exp(E[R][C][A][3])*this.config.anchors[A].y/d*f,V=k-N/2,U=I-B/2,J={row:R,col:C,anchor:A},this.withClassScores?[4,this.extractPredictedClass(w,J)]:[3,7]):[3,9]):[3,10];case 6:return j=ne.sent(),[3,8];case 7:j={classScore:1,label:0},ne.label=8;case 8:ee=j,te=ee.classScore,P=ee.label,S.push(_n({box:new Ch(V,U,V+N,U+B),score:D,classScore:D*te,label:P},J)),ne.label=9;case 9:return A++,[3,5];case 10:return C++,[3,4];case 11:return R++,[3,3];case 12:return g.dispose(),b.dispose(),w.dispose(),[2,S]}})})},t.prototype.extractPredictedClass=function(e,r){return Te(this,void 0,void 0,function(){var a,i,u,l;return De(this,function(c){switch(c.label){case 0:return a=r.row,i=r.col,u=r.anchor,[4,e.array()];case 1:return l=c.sent(),[2,Array(this.config.classes.length).fill(0).map(function(f,d){return l[a][i][u][d]}).map(function(f,d){return{classScore:f,label:d}}).reduce(function(f,d){return f.classScore>d.classScore?f:d})]}})})},t.DEFAULT_FILTER_SIZES=[3,16,32,64,128,256,512,1024,1024],t}(Fa),$L=function(n){ze(t,n);function t(e){e===void 0&&(e=!0);var r=this,a=Object.assign({},{withSeparableConvs:e,iouThreshold:PL,classes:["face"]},e?{anchors:UL,meanRgb:VL}:{anchors:zL,withClassScores:!0});return r=n.call(this,a)||this,r}return Object.defineProperty(t.prototype,"withSeparableConvs",{get:function(){return this.config.withSeparableConvs},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"anchors",{get:function(){return this.config.anchors},enumerable:!0,configurable:!0}),t.prototype.locateFaces=function(e,r){return Te(this,void 0,void 0,function(){var a;return De(this,function(i){switch(i.label){case 0:return[4,this.detect(e,r)];case 1:return a=i.sent(),[2,a.map(function(u){return new rr(u.score,u.relativeBox,{width:u.imageWidth,height:u.imageHeight})})]}})})},t.prototype.getDefaultModelName=function(){return this.withSeparableConvs?jL:HL},t.prototype.extractParamsFromWeigthMap=function(e){return n.prototype.extractParamsFromWeigthMap.call(this,e)},t}(WE),YL=function(n){ze(t,n);function t(){var e=n!==null&&n.apply(this,arguments)||this;return e._name="TinyFaceDetectorOptions",e}return t}(jg),Nl=function(){function n(){}return n.prototype.then=function(t){return Te(this,void 0,void 0,function(){var e;return De(this,function(r){switch(r.label){case 0:return e=t,[4,this.run()];case 1:return[2,e.apply(void 0,[r.sent()])]}})})},n.prototype.run=function(){return Te(this,void 0,void 0,function(){return De(this,function(t){throw new Error("ComposableTask - run is not implemented")})})},n}();function kh(n,t,e,r,a){return a===void 0&&(a=function(i){var u=i.alignedRect;return u}),Te(this,void 0,void 0,function(){var i,u,l,c,f;return De(this,function(d){switch(d.label){case 0:return i=n.map(function(v){return ME(v)?a(v):v.detection}),l=r,l?[3,5]:t instanceof Rt?[4,Bg(t,i)]:[3,2];case 1:return c=d.sent(),[3,4];case 2:return[4,Fg(t,i)];case 3:c=d.sent(),d.label=4;case 4:l=c,d.label=5;case 5:return u=l,[4,e(u)];case 6:return f=d.sent(),u.forEach(function(v){return v instanceof Rt&&v.dispose()}),[2,f]}})})}function Wg(n,t,e,r,a){return Te(this,void 0,void 0,function(){var i=this;return De(this,function(u){return[2,kh([n],t,function(l){return Te(i,void 0,void 0,function(){return De(this,function(c){return[2,e(l[0])]})})},r,a)]})})}function QL(n){return xe(function(){return tr(Yt(n,3).reverse(),3)})}var ff=2,ah=12;function ZL(n,t){var e=Ah(n,t),r=Lg(n,t);function a(f,d){var v=Vt(n(f));return t.push({paramPath:d}),v}function i(f,d,v){v===void 0&&(v=!1);var m=e(f[0],f[1],3,d+"/conv1"),g=a(f[1],d+"/prelu1_alpha"),b=e(f[1],f[2],3,d+"/conv2"),w=a(f[2],d+"/prelu2_alpha"),S=e(f[2],f[3],v?2:3,d+"/conv3"),_=a(f[3],d+"/prelu3_alpha");return{conv1:m,prelu1_alpha:g,conv2:b,prelu2_alpha:w,conv3:S,prelu3_alpha:_}}function u(){var f=i([3,10,16,32],"pnet"),d=e(32,2,1,"pnet/conv4_1"),v=e(32,4,1,"pnet/conv4_2");return _n(_n({},f),{conv4_1:d,conv4_2:v})}function l(){var f=i([3,28,48,64],"rnet",!0),d=r(576,128,"rnet/fc1"),v=a(128,"rnet/prelu4_alpha"),m=r(128,2,"rnet/fc2_1"),g=r(128,4,"rnet/fc2_2");return _n(_n({},f),{fc1:d,prelu4_alpha:v,fc2_1:m,fc2_2:g})}function c(){var f=i([3,32,64,64],"onet"),d=e(64,128,2,"onet/conv4"),v=a(128,"onet/prelu4_alpha"),m=r(1152,256,"onet/fc1"),g=a(256,"onet/prelu5_alpha"),b=r(256,2,"onet/fc2_1"),w=r(256,4,"onet/fc2_2"),S=r(256,10,"onet/fc2_3");return _n(_n({},f),{conv4:d,prelu4_alpha:v,fc1:m,prelu5_alpha:g,fc2_1:b,fc2_2:w,fc2_3:S})}return{extractPNetParams:u,extractRNetParams:l,extractONetParams:c}}function JL(n){var t=La(n),e=t.extractWeights,r=t.getRemainingWeights,a=[],i=ZL(e,a),u=i.extractPNetParams,l=i.extractRNetParams,c=i.extractONetParams,f=u(),d=l(),v=c();if(r().length!==0)throw new Error("weights remaing after extract: "+r().length);return{params:{pnet:f,rnet:d,onet:v},paramMappings:a}}function eP(n,t){var e=Ni(n,t);function r(d){var v=e(d+"/weights",4,d+"/filters"),m=e(d+"/bias",1);return{filters:v,bias:m}}function a(d){var v=e(d+"/weights",2),m=e(d+"/bias",1);return{weights:v,bias:m}}function i(d){return e(d,1)}function u(d){var v=r(d+"/conv1"),m=i(d+"/prelu1_alpha"),g=r(d+"/conv2"),b=i(d+"/prelu2_alpha"),w=r(d+"/conv3"),S=i(d+"/prelu3_alpha");return{conv1:v,prelu1_alpha:m,conv2:g,prelu2_alpha:b,conv3:w,prelu3_alpha:S}}function l(){var d=u("pnet"),v=r("pnet/conv4_1"),m=r("pnet/conv4_2");return _n(_n({},d),{conv4_1:v,conv4_2:m})}function c(){var d=u("rnet"),v=a("rnet/fc1"),m=i("rnet/prelu4_alpha"),g=a("rnet/fc2_1"),b=a("rnet/fc2_2");return _n(_n({},d),{fc1:v,prelu4_alpha:m,fc2_1:g,fc2_2:b})}function f(){var d=u("onet"),v=r("onet/conv4"),m=i("onet/prelu4_alpha"),g=a("onet/fc1"),b=i("onet/prelu5_alpha"),w=a("onet/fc2_1"),S=a("onet/fc2_2"),_=a("onet/fc2_3");return _n(_n({},d),{conv4:v,prelu4_alpha:m,fc1:g,prelu5_alpha:b,fc2_1:w,fc2_2:S,fc2_3:_})}return{extractPNetParams:l,extractRNetParams:c,extractONetParams:f}}function tP(n){var t=[],e=eP(n,t),r=e.extractPNetParams,a=e.extractRNetParams,i=e.extractONetParams,u=r(),l=a(),c=i();return Ba(n,t),{params:{pnet:u,rnet:l,onet:c},paramMappings:t}}function Mm(n,t){var e=t[0],r=t[1];return{height:Math.floor(e*n),width:Math.floor(r*n)}}function nP(n,t,e){for(var r=e[0],a=e[1],i=ah/n,u=[],l=Math.min(r,a)*i,c=0;l>=12;)u.push(i*Math.pow(t,c)),l=l*t,c+=1;return u}var Gg=function(n){ze(t,n);function t(e,r,a,i){return n.call(this,{left:e,top:r,right:a,bottom:i},!0)||this}return t}(ta);function GE(n){return xe(function(){return Cn(Zt(n,ge(127.5)),ge(.0078125))})}function _s(n,t){return xe(function(){return Ye(At(n),Cn(t,Zf(At(Zf(n)))))})}function qg(n,t,e){return e===void 0&&(e=!1),xe(function(){var r=Or(n,t.conv1,"valid");return r=_s(r,t.prelu1_alpha),r=an(r,e?[2,2]:[3,3],[2,2],"same"),r=Or(r,t.conv2,"valid"),r=_s(r,t.prelu2_alpha),r=e?r:an(r,[3,3],[2,2],"valid"),r=Or(r,t.conv3,"valid"),r=_s(r,t.prelu3_alpha),r})}function rP(n,t){return xe(function(){var e=qg(n,t,!0),r=Or(e,t.conv4_1,"valid"),a=vr(wh(r,3),3),i=Ma(Zt(r,a),3),u=Or(e,t.conv4_2,"valid");return{prob:i,regions:u}})}function aP(n,t){return xe(function(){var e=Mm(t,n.shape.slice(1)),r=e.height,a=e.width,i=wg.resizeBilinear(n,[r,a]),u=GE(i);return Ti(u,[0,2,1,3])})}function iP(n,t,e,r){for(var a=[],i=n.arraySync(),u=0;u<n.shape[0];u++)for(var l=0;l<n.shape[1];l++)i[u][l]>=r&&a.push(new st(l,u));var c=a.map(function(f){var d=new Ch(Math.round((f.y*ff+1)/e),Math.round((f.x*ff+1)/e),Math.round((f.y*ff+ah)/e),Math.round((f.x*ff+ah)/e)),v=i[f.y][f.x],m=t.arraySync(),g=new Gg(m[f.y][f.x][0],m[f.y][f.x][1],m[f.y][f.x][2],m[f.y][f.x][3]);return{cell:d,score:v,region:g}});return c}function oP(n,t,e,r,a){a.stage1=[];var i=t.map(function(m){return xe(function(){var g={scale:m},b=aP(n,m),w=Date.now(),S=rP(b,r),_=S.prob,E=S.regions;g.pnet=Date.now()-w;var R=Yt(Yt(_,3)[1])[0],C=Yt(E)[0];return{scoresTensor:R,regionsTensor:C,scale:m,statsForScale:g}})}),u=i.map(function(m){var g=m.scoresTensor,b=m.regionsTensor,w=m.scale,S=m.statsForScale,_=iP(g,b,w,e);if(g.dispose(),b.dispose(),!_.length)return a.stage1.push(S),[];var E=Date.now(),R=ml(_.map(function(C){return C.cell}),_.map(function(C){return C.score}),.5);return S.nms=Date.now()-E,S.numBoxes=R.length,a.stage1.push(S),R.map(function(C){return _[C]})}),l=u.reduce(function(m,g){return m.concat(g)},[]),c=[],f=[];if(l.length>0){var d=Date.now(),v=ml(l.map(function(m){return m.cell}),l.map(function(m){return m.score}),.7);a.stage1_nms=Date.now()-d,f=v.map(function(m){return l[m].score}),c=v.map(function(m){return l[m]}).map(function(m){var g=m.cell,b=m.region;return new Ch(g.left+b.left*g.width,g.top+b.top*g.height,g.right+b.right*g.width,g.bottom+b.bottom*g.height).toSquare().round()})}return{boxes:c,scores:f}}function qE(n,t,e){var r=e.width,a=e.height;return Te(this,void 0,void 0,function(){var i,u,l,c=this;return De(this,function(f){switch(f.label){case 0:return i=ka(n),[4,Promise.all(t.map(function(d){return Te(c,void 0,void 0,function(){var v,m,g,b,w,S,_,E;return De(this,function(R){return v=d.padAtBorders(n.height,n.width),m=v.y,g=v.ey,b=v.x,w=v.ex,S=b-1,_=m-1,E=i.getImageData(S,_,w-S,g-_),[2,Rn.isNodejs()?Ig(E):createImageBitmap(E)]})})}))];case 1:return u=f.sent(),l=[],u.forEach(function(d){var v=Rh({width:r,height:a}),m=ka(v);m.drawImage(d,0,0,r,a);for(var g=m.getImageData(0,0,r,a).data,b=[],w=0;w<g.length;w+=4)b.push(g[w+2]),b.push(g[w+1]),b.push(g[w]);l.push(b)}),[2,l.map(function(d){var v=xe(function(){var m=Ti(Bn(d,[1,r,a,3]),[0,2,1,3]).toFloat();return GE(m)});return v})]}})})}function sP(n,t){return xe(function(){var e=qg(n,t),r=Dr(e,[e.shape[0],t.fc1.weights.shape[0]]),a=$r(r,t.fc1),i=_s(a,t.prelu4_alpha),u=$r(i,t.fc2_1),l=vr(wh(u,1),1),c=Ma(Zt(u,l),1),f=$r(i,t.fc2_2),d=Yt(c,1)[1];return{scores:d,regions:f}})}function uP(n,t,e,r,a){return Te(this,void 0,void 0,function(){var i,u,l,c,f,d,v,m,g,b,w,S,_,E;return De(this,function(R){switch(R.label){case 0:return i=Date.now(),[4,qE(n,t,{width:24,height:24})];case 1:return u=R.sent(),a.stage2_extractImagePatches=Date.now()-i,i=Date.now(),l=u.map(function(C){var A=sP(C,r);return C.dispose(),A}),a.stage2_rnet=Date.now()-i,c=l.length>1?$t(l.map(function(C){return C.scores})):l[0].scores,v=(d=Array).from,[4,c.data()];case 2:return f=v.apply(d,[R.sent()]),c.dispose(),m=f.map(function(C,A){return{score:C,idx:A}}).filter(function(C){return C.score>e}).map(function(C){var A=C.idx;return A}),g=m.map(function(C){return t[C]}),b=m.map(function(C){return f[C]}),w=[],S=[],g.length>0&&(i=Date.now(),_=ml(g,b,.7),a.stage2_nms=Date.now()-i,E=_.map(function(C){var A=l[m[C]].regions.arraySync();return new Gg(A[0][0],A[0][1],A[0][2],A[0][3])}),S=_.map(function(C){return b[C]}),w=_.map(function(C,A){return g[C].calibrate(E[A])})),l.forEach(function(C){C.regions.dispose(),C.scores.dispose()}),[2,{boxes:w,scores:S}]}})})}function lP(n,t){return xe(function(){var e=qg(n,t);e=an(e,[2,2],[2,2],"same"),e=Or(e,t.conv4,"valid"),e=_s(e,t.prelu4_alpha);var r=Dr(e,[e.shape[0],t.fc1.weights.shape[0]]),a=$r(r,t.fc1),i=_s(a,t.prelu5_alpha),u=$r(i,t.fc2_1),l=vr(wh(u,1),1),c=Ma(Zt(u,l),1),f=$r(i,t.fc2_2),d=$r(i,t.fc2_3),v=Yt(c,1)[1];return{scores:v,regions:f,points:d}})}function cP(n,t,e,r,a){return Te(this,void 0,void 0,function(){var i,u,l,c,f,d,v,m,g,b,w,S,_,E,R;return De(this,function(C){switch(C.label){case 0:return i=Date.now(),[4,qE(n,t,{width:48,height:48})];case 1:return u=C.sent(),a.stage3_extractImagePatches=Date.now()-i,i=Date.now(),l=u.map(function(A){var D=lP(A,r);return A.dispose(),D}),a.stage3_onet=Date.now()-i,c=l.length>1?$t(l.map(function(A){return A.scores})):l[0].scores,v=(d=Array).from,[4,c.data()];case 2:return f=v.apply(d,[C.sent()]),c.dispose(),m=f.map(function(A,D){return{score:A,idx:D}}).filter(function(A){return A.score>e}).map(function(A){var D=A.idx;return D}),g=m.map(function(A){var D=l[A].regions.arraySync();return new Gg(D[0][0],D[0][1],D[0][2],D[0][3])}),b=m.map(function(A,D){return t[A].calibrate(g[D])}),w=m.map(function(A){return f[A]}),S=[],_=[],E=[],b.length>0&&(i=Date.now(),R=ml(b,w,.7,!1),a.stage3_nms=Date.now()-i,S=R.map(function(A){return b[A]}),_=R.map(function(A){return w[A]}),E=R.map(function(A,D){return Array(5).fill(0).map(function(k,I){var N=l[A].points.arraySync();return new st(N[0][I]*(S[D].width+1)+S[D].left,N[0][I+5]*(S[D].height+1)+S[D].top)})})),l.forEach(function(A){A.regions.dispose(),A.scores.dispose(),A.points.dispose()}),[2,{boxes:S,scores:_,points:E}]}})})}var fP=function(n){ze(t,n);function t(){return n.call(this,"Mtcnn")||this}return t.prototype.load=function(e){return Te(this,void 0,void 0,function(){return De(this,function(r){return console.warn("mtcnn is deprecated and will be removed soon"),[2,n.prototype.load.call(this,e)]})})},t.prototype.loadFromDisk=function(e){return Te(this,void 0,void 0,function(){return De(this,function(r){return console.warn("mtcnn is deprecated and will be removed soon"),[2,n.prototype.loadFromDisk.call(this,e)]})})},t.prototype.forwardInput=function(e,r){return r===void 0&&(r={}),Te(this,void 0,void 0,function(){var a,i,u,l,c,f,d,v,m,g,b,w,S,_,E,R,C,A,D,k,I;return De(this,function(N){switch(N.label){case 0:if(a=this.params,!a)throw new Error("Mtcnn - load model before inference");if(i=e.canvases[0],!i)throw new Error("Mtcnn - inputCanvas is not defined, note that passing tensors into Mtcnn.forwardInput is not supported yet.");return u={},l=Date.now(),c=xe(function(){return QL(vr(Ag.fromPixels(i)).toFloat())}),f=function(B){return c.dispose(),u.total=Date.now()-l,B},d=c.shape.slice(1),v=d[0],m=d[1],g=new HE(r),b=g.minFaceSize,w=g.scaleFactor,S=g.maxNumScales,_=g.scoreThresholds,E=g.scaleSteps,R=(E||nP(b,w,[v,m])).filter(function(B){var V=Mm(B,[v,m]);return Math.min(V.width,V.height)>ah}).slice(0,S),u.scales=R,u.pyramid=R.map(function(B){return Mm(B,[v,m])}),C=Date.now(),[4,oP(c,R,_[0],a.pnet,u)];case 1:return A=N.sent(),u.total_stage1=Date.now()-C,A.boxes.length?(u.stage2_numInputBoxes=A.boxes.length,C=Date.now(),[4,uP(i,A.boxes,_[1],a.rnet,u)]):[2,f({results:[],stats:u})];case 2:return D=N.sent(),u.total_stage2=Date.now()-C,D.boxes.length?(u.stage3_numInputBoxes=D.boxes.length,C=Date.now(),[4,cP(i,D.boxes,_[2],a.onet,u)]):[2,f({results:[],stats:u})];case 3:return k=N.sent(),u.total_stage3=Date.now()-C,I=k.boxes.map(function(B,V){return Th(bl({},new rr(k.scores[V],new kg(B.left/m,B.top/v,B.width/m,B.height/v),{height:v,width:m})),new UB(k.points[V].map(function(U){return U.sub(new st(B.left,B.top)).div(new st(B.width,B.height))}),{width:B.width,height:B.height}))}),[2,f({results:I,stats:u})]}})})},t.prototype.forward=function(e,r){return r===void 0&&(r={}),Te(this,void 0,void 0,function(){var a;return De(this,function(i){switch(i.label){case 0:return a=this.forwardInput,[4,ln(e)];case 1:return[4,a.apply(this,[i.sent(),r])];case 2:return[2,i.sent().results]}})})},t.prototype.forwardWithStats=function(e,r){return r===void 0&&(r={}),Te(this,void 0,void 0,function(){var a;return De(this,function(i){switch(i.label){case 0:return a=this.forwardInput,[4,ln(e)];case 1:return[2,a.apply(this,[i.sent(),r])]}})})},t.prototype.getDefaultModelName=function(){return"mtcnn_model"},t.prototype.extractParamsFromWeigthMap=function(e){return tP(e)},t.prototype.extractParams=function(e){return JL(e)},t}(Fa),hP=.4,dP=[new st(1.603231,2.094468),new st(6.041143,7.080126),new st(2.882459,3.518061),new st(4.266906,5.178857),new st(9.041765,10.66308)],pP=[117.001,114.697,97.404],vP=function(n){ze(t,n);function t(){var e=this,r={withSeparableConvs:!0,iouThreshold:hP,classes:["face"],anchors:dP,meanRgb:pP,isFirstLayerConv2d:!0,filterSizes:[3,16,32,64,128,256,512]};return e=n.call(this,r)||this,e}return Object.defineProperty(t.prototype,"anchors",{get:function(){return this.config.anchors},enumerable:!0,configurable:!0}),t.prototype.locateFaces=function(e,r){return Te(this,void 0,void 0,function(){var a;return De(this,function(i){switch(i.label){case 0:return[4,this.detect(e,r)];case 1:return a=i.sent(),[2,a.map(function(u){return new rr(u.score,u.relativeBox,{width:u.imageWidth,height:u.imageHeight})})]}})})},t.prototype.getDefaultModelName=function(){return"tiny_face_detector_model"},t.prototype.extractParamsFromWeigthMap=function(e){return n.prototype.extractParamsFromWeigthMap.call(this,e)},t}(WE),yr={ssdMobilenetv1:new jE,tinyFaceDetector:new vP,tinyYolov2:new $L,mtcnn:new fP,faceLandmark68Net:new BE,faceLandmark68TinyNet:new mL,faceRecognitionNet:new SL,faceExpressionNet:new nL,ageGenderNet:new hL},KE=function(n){ze(t,n);function t(e,r,a){var i=n.call(this)||this;return i.parentTask=e,i.input=r,i.extractedFaces=a,i}return t}(Nl),Kg=function(n){ze(t,n);function t(){return n!==null&&n.apply(this,arguments)||this}return t.prototype.run=function(){return Te(this,void 0,void 0,function(){var e,r,a=this;return De(this,function(i){switch(i.label){case 0:return[4,this.parentTask];case 1:return e=i.sent(),[4,kh(e,this.input,function(u){return Te(a,void 0,void 0,function(){return De(this,function(l){switch(l.label){case 0:return[4,Promise.all(u.map(function(c){return yr.faceExpressionNet.predictExpressions(c)}))];case 1:return[2,l.sent()]}})})},this.extractedFaces)];case 2:return r=i.sent(),[2,e.map(function(u,l){return NE(u,r[l])})]}})})},t.prototype.withAgeAndGender=function(){return new Qg(this,this.input)},t}(KE),Xg=function(n){ze(t,n);function t(){return n!==null&&n.apply(this,arguments)||this}return t.prototype.run=function(){return Te(this,void 0,void 0,function(){var e,r;return De(this,function(a){switch(a.label){case 0:return[4,this.parentTask];case 1:return e=a.sent(),e?[4,Wg(e,this.input,function(i){return yr.faceExpressionNet.predictExpressions(i)},this.extractedFaces)]:[2];case 2:return r=a.sent(),[2,NE(e,r)]}})})},t.prototype.withAgeAndGender=function(){return new Zg(this,this.input)},t}(KE),$g=function(n){ze(t,n);function t(){return n!==null&&n.apply(this,arguments)||this}return t.prototype.withAgeAndGender=function(){return new Jg(this,this.input)},t.prototype.withFaceDescriptors=function(){return new ty(this,this.input)},t}(Kg),Yg=function(n){ze(t,n);function t(){return n!==null&&n.apply(this,arguments)||this}return t.prototype.withAgeAndGender=function(){return new ey(this,this.input)},t.prototype.withFaceDescriptor=function(){return new ny(this,this.input)},t}(Xg),XE=function(n){ze(t,n);function t(e,r,a){var i=n.call(this)||this;return i.parentTask=e,i.input=r,i.extractedFaces=a,i}return t}(Nl),Qg=function(n){ze(t,n);function t(){return n!==null&&n.apply(this,arguments)||this}return t.prototype.run=function(){return Te(this,void 0,void 0,function(){var e,r,a=this;return De(this,function(i){switch(i.label){case 0:return[4,this.parentTask];case 1:return e=i.sent(),[4,kh(e,this.input,function(u){return Te(a,void 0,void 0,function(){return De(this,function(l){switch(l.label){case 0:return[4,Promise.all(u.map(function(c){return yr.ageGenderNet.predictAgeAndGender(c)}))];case 1:return[2,l.sent()]}})})},this.extractedFaces)];case 2:return r=i.sent(),[2,e.map(function(u,l){var c=r[l],f=c.age,d=c.gender,v=c.genderProbability;return UE(VE(u,d,v),f)})]}})})},t.prototype.withFaceExpressions=function(){return new Kg(this,this.input)},t}(XE),Zg=function(n){ze(t,n);function t(){return n!==null&&n.apply(this,arguments)||this}return t.prototype.run=function(){return Te(this,void 0,void 0,function(){var e,r,a,i,u;return De(this,function(l){switch(l.label){case 0:return[4,this.parentTask];case 1:return e=l.sent(),e?[4,Wg(e,this.input,function(c){return yr.ageGenderNet.predictAgeAndGender(c)},this.extractedFaces)]:[2];case 2:return r=l.sent(),a=r.age,i=r.gender,u=r.genderProbability,[2,UE(VE(e,i,u),a)]}})})},t.prototype.withFaceExpressions=function(){return new Xg(this,this.input)},t}(XE),Jg=function(n){ze(t,n);function t(){return n!==null&&n.apply(this,arguments)||this}return t.prototype.withFaceExpressions=function(){return new $g(this,this.input)},t.prototype.withFaceDescriptors=function(){return new ty(this,this.input)},t}(Qg),ey=function(n){ze(t,n);function t(){return n!==null&&n.apply(this,arguments)||this}return t.prototype.withFaceExpressions=function(){return new Yg(this,this.input)},t.prototype.withFaceDescriptor=function(){return new ny(this,this.input)},t}(Zg),$E=function(n){ze(t,n);function t(e,r){var a=n.call(this)||this;return a.parentTask=e,a.input=r,a}return t}(Nl),ty=function(n){ze(t,n);function t(){return n!==null&&n.apply(this,arguments)||this}return t.prototype.run=function(){return Te(this,void 0,void 0,function(){var e,r;return De(this,function(a){switch(a.label){case 0:return[4,this.parentTask];case 1:return e=a.sent(),[4,kh(e,this.input,function(i){return Promise.all(i.map(function(u){return yr.faceRecognitionNet.computeFaceDescriptor(u)}))},null,function(i){return i.landmarks.align(null,{useDlibAlignment:!0})})];case 2:return r=a.sent(),[2,r.map(function(i,u){return zE(e[u],i)})]}})})},t.prototype.withFaceExpressions=function(){return new $g(this,this.input)},t.prototype.withAgeAndGender=function(){return new Jg(this,this.input)},t}($E),ny=function(n){ze(t,n);function t(){return n!==null&&n.apply(this,arguments)||this}return t.prototype.run=function(){return Te(this,void 0,void 0,function(){var e,r;return De(this,function(a){switch(a.label){case 0:return[4,this.parentTask];case 1:return e=a.sent(),e?[4,Wg(e,this.input,function(i){return yr.faceRecognitionNet.computeFaceDescriptor(i)},null,function(i){return i.landmarks.align(null,{useDlibAlignment:!0})})]:[2];case 2:return r=a.sent(),[2,zE(e,r)]}})})},t.prototype.withFaceExpressions=function(){return new Yg(this,this.input)},t.prototype.withAgeAndGender=function(){return new ey(this,this.input)},t}($E),YE=function(n){ze(t,n);function t(e,r,a){var i=n.call(this)||this;return i.parentTask=e,i.input=r,i.useTinyLandmarkNet=a,i}return Object.defineProperty(t.prototype,"landmarkNet",{get:function(){return this.useTinyLandmarkNet?yr.faceLandmark68TinyNet:yr.faceLandmark68Net},enumerable:!0,configurable:!0}),t}(Nl),mP=function(n){ze(t,n);function t(){return n!==null&&n.apply(this,arguments)||this}return t.prototype.run=function(){return Te(this,void 0,void 0,function(){var e,r,a,i,u,l=this;return De(this,function(c){switch(c.label){case 0:return[4,this.parentTask];case 1:return e=c.sent(),r=e.map(function(f){return f.detection}),this.input instanceof Rt?[4,Bg(this.input,r)]:[3,3];case 2:return i=c.sent(),[3,5];case 3:return[4,Fg(this.input,r)];case 4:i=c.sent(),c.label=5;case 5:return a=i,[4,Promise.all(a.map(function(f){return l.landmarkNet.detectLandmarks(f)}))];case 6:return u=c.sent(),a.forEach(function(f){return f instanceof Rt&&f.dispose()}),[2,e.map(function(f,d){return Th(f,u[d])})]}})})},t.prototype.withFaceExpressions=function(){return new $g(this,this.input)},t.prototype.withAgeAndGender=function(){return new Jg(this,this.input)},t.prototype.withFaceDescriptors=function(){return new ty(this,this.input)},t}(YE),gP=function(n){ze(t,n);function t(){return n!==null&&n.apply(this,arguments)||this}return t.prototype.run=function(){return Te(this,void 0,void 0,function(){var e,r,a,i,u;return De(this,function(l){switch(l.label){case 0:return[4,this.parentTask];case 1:return e=l.sent(),e?(r=e.detection,this.input instanceof Rt?[4,Bg(this.input,[r])]:[3,3]):[2];case 2:return i=l.sent(),[3,5];case 3:return[4,Fg(this.input,[r])];case 4:i=l.sent(),l.label=5;case 5:return a=i,[4,this.landmarkNet.detectLandmarks(a[0])];case 6:return u=l.sent(),a.forEach(function(c){return c instanceof Rt&&c.dispose()}),[2,Th(e,u)]}})})},t.prototype.withFaceExpressions=function(){return new Yg(this,this.input)},t.prototype.withAgeAndGender=function(){return new ey(this,this.input)},t.prototype.withFaceDescriptor=function(){return new ny(this,this.input)},t}(YE),QE=function(n){ze(t,n);function t(e,r){r===void 0&&(r=new Dh);var a=n.call(this)||this;return a.input=e,a.options=r,a}return t}(Nl),ZE=function(n){ze(t,n);function t(){return n!==null&&n.apply(this,arguments)||this}return t.prototype.run=function(){return Te(this,void 0,void 0,function(){var e,r,a,i;return De(this,function(u){switch(u.label){case 0:return e=this,r=e.input,a=e.options,a instanceof HE?[4,yr.mtcnn.forward(r,a)]:[3,2];case 1:return[2,u.sent().map(function(l){return l.detection})];case 2:if(i=a instanceof YL?function(l){return yr.tinyFaceDetector.locateFaces(l,a)}:a instanceof Dh?function(l){return yr.ssdMobilenetv1.locateFaces(l,a)}:a instanceof jg?function(l){return yr.tinyYolov2.locateFaces(l,a)}:null,!i)throw new Error("detectFaces - expected options to be instance of TinyFaceDetectorOptions | SsdMobilenetv1Options | MtcnnOptions | TinyYolov2Options");return[2,i(r)]}})})},t.prototype.runAndExtendWithFaceDetections=function(){var e=this;return new Promise(function(r){return Te(e,void 0,void 0,function(){var a;return De(this,function(i){switch(i.label){case 0:return[4,this.run()];case 1:return a=i.sent(),[2,r(a.map(function(u){return bl({},u)}))]}})})})},t.prototype.withFaceLandmarks=function(e){return e===void 0&&(e=!1),new mP(this.runAndExtendWithFaceDetections(),this.input,e)},t.prototype.withFaceExpressions=function(){return new Kg(this.runAndExtendWithFaceDetections(),this.input)},t.prototype.withAgeAndGender=function(){return new Qg(this.runAndExtendWithFaceDetections(),this.input)},t}(QE);(function(n){ze(t,n);function t(){return n!==null&&n.apply(this,arguments)||this}return t.prototype.run=function(){return Te(this,void 0,void 0,function(){var e,r;return De(this,function(a){switch(a.label){case 0:return[4,new ZE(this.input,this.options)];case 1:return e=a.sent(),r=e[0],e.forEach(function(i){i.score>r.score&&(r=i)}),[2,r]}})})},t.prototype.runAndExtendWithFaceDetection=function(){var e=this;return new Promise(function(r){return Te(e,void 0,void 0,function(){var a;return De(this,function(i){switch(i.label){case 0:return[4,this.run()];case 1:return a=i.sent(),[2,r(a?bl({},a):void 0)]}})})})},t.prototype.withFaceLandmarks=function(e){return e===void 0&&(e=!1),new gP(this.runAndExtendWithFaceDetection(),this.input,e)},t.prototype.withFaceExpressions=function(){return new Xg(this.runAndExtendWithFaceDetection(),this.input)},t.prototype.withAgeAndGender=function(){return new Zg(this.runAndExtendWithFaceDetection(),this.input)},t})(QE);function XP(n,t){return t===void 0&&(t=new Dh),new ZE(n,t)}function yP(n,t){if(n.length!==t.length)throw new Error("euclideanDistance: arr1.length !== arr2.length");var e=Array.from(n),r=Array.from(t);return Math.sqrt(e.map(function(a,i){return a-r[i]}).reduce(function(a,i){return a+Math.pow(i,2)},0))}(function(){function n(t,e){e===void 0&&(e=.6),this._distanceThreshold=e;var r=Array.isArray(t)?t:[t];if(!r.length)throw new Error("FaceRecognizer.constructor - expected atleast one input");var a=1,i=function(){return"person "+a++};this._labeledDescriptors=r.map(function(u){if(u instanceof sf)return u;if(u instanceof Float32Array)return new sf(i(),[u]);if(u.descriptor&&u.descriptor instanceof Float32Array)return new sf(i(),[u.descriptor]);throw new Error("FaceRecognizer.constructor - expected inputs to be of type LabeledFaceDescriptors | WithFaceDescriptor<any> | Float32Array | Array<LabeledFaceDescriptors | WithFaceDescriptor<any> | Float32Array>")})}return Object.defineProperty(n.prototype,"labeledDescriptors",{get:function(){return this._labeledDescriptors},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"distanceThreshold",{get:function(){return this._distanceThreshold},enumerable:!0,configurable:!0}),n.prototype.computeMeanDistance=function(t,e){return e.map(function(r){return yP(r,t)}).reduce(function(r,a){return r+a},0)/(e.length||1)},n.prototype.matchDescriptor=function(t){var e=this;return this.labeledDescriptors.map(function(r){var a=r.descriptors,i=r.label;return new d2(i,e.computeMeanDistance(t,a))}).reduce(function(r,a){return r.distance<a.distance?r:a})},n.prototype.findBestMatch=function(t){var e=this.matchDescriptor(t);return e.distance<this.distanceThreshold?e:new d2("unknown",e.distance)},n.prototype.toJSON=function(){return{distanceThreshold:this.distanceThreshold,labeledDescriptors:this.labeledDescriptors.map(function(t){return t.toJSON()})}},n.fromJSON=function(t){var e=t.labeledDescriptors.map(function(r){return sf.fromJSON(r)});return new n(e,t.distanceThreshold)},n})();function bP(n,t){var e=new io(t.width,t.height),r=e.width,a=e.height;if(r<=0||a<=0)throw new Error("resizeResults - invalid dimensions: "+JSON.stringify({width:r,height:a}));if(Array.isArray(n))return n.map(function(l){return bP(l,{width:r,height:a})});if(ME(n)){var i=n.detection.forSize(r,a),u=n.unshiftedLandmarks.forSize(i.box.width,i.box.height);return Th(bl(n,i),u)}return yl(n)?bl(n,n.detection.forSize(r,a)):n instanceof gl||n instanceof rr?n.forSize(r,a):n}var Xu={},y2;function xP(){if(y2)return Xu;y2=1,Object.defineProperty(Xu,"__esModule",{value:!0}),Xu.styleq=void 0;var n=new WeakMap,t="$$css";function e(a){var i,u,l;return a!=null&&(i=a.disableCache===!0,u=a.disableMix===!0,l=a.transform),function(){for(var f=[],d="",v=null,m="",g=i?null:n,b=new Array(arguments.length),w=0;w<arguments.length;w++)b[w]=arguments[w];for(;b.length>0;){var S=b.pop();if(!(S==null||S===!1)){if(Array.isArray(S)){for(var _=0;_<S.length;_++)b.push(S[_]);continue}var E=l!=null?l(S):S;if(E.$$css!=null){var R="";if(g!=null&&g.has(E)){var C=g.get(E);C!=null&&(R=C[0],m=C[2],f.push.apply(f,C[1]),g=C[3])}else{var A=[];for(var D in E){var k=E[D];if(D===t){var I=E[D];I!==!0&&(m=m?I+"; "+m:I);continue}typeof k=="string"||k===null?f.includes(D)||(f.push(D),g!=null&&A.push(D),typeof k=="string"&&(R+=R?" "+k:k)):console.error("styleq: ".concat(D," typeof ").concat(String(k),' is not "string" or "null".'))}if(g!=null){var N=new WeakMap;g.set(E,[R,A,m,N]),g=N}}R&&(d=d?R+" "+d:R)}else if(u)v==null&&(v={}),v=Object.assign({},E,v);else{var B=null;for(var V in E){var U=E[V];U!==void 0&&(f.includes(V)||(U!=null&&(v==null&&(v={}),B==null&&(B={}),B[V]=U),f.push(V),g=null))}B!=null&&(v=Object.assign(B,v))}}}var J=[d,v,m];return J}}var r=Xu.styleq=e();return r.factory=e,Xu}var wP=xP();function $P(){for(var n=arguments.length,t=new Array(n),e=0;e<n;e++)t[e]=arguments[e];const[r,a,i]=wP.styleq(t),u={};return r!=null&&r!==""&&(u.className=r),a!=null&&Object.keys(a).length>0&&(u.style=a),i!=null&&i!==""&&(u["data-style-src"]=i),u}export{Pn as A,$P as B,DP as C,FP as D,TP as E,hD as F,OP as G,PP as H,VP as I,SP as J,MP as Q,D_ as R,YL as T,zP as a,UP as b,HP as c,wT as d,CO as e,RP as f,kP as g,LP as h,Dn as i,pA as j,BP as k,Vm as l,AP as m,EP as n,CP as o,jP as p,NP as q,Y as r,WP as s,yr as t,e_ as u,qP as v,XP as w,bP as x,GP as y,KP as z};
